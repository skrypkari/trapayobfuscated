'use strict';const a87_0x2d64c1=a87_0x26fd;(function(_0xe9a3b6,_0x25c77a){const _0x3f6c55=a87_0x26fd,_0x2d7136=_0xe9a3b6();while(!![]){try{const _0x3e599b=-parseInt(_0x3f6c55(0x1d2))/0x1+parseInt(_0x3f6c55(0x226))/0x2+-parseInt(_0x3f6c55(0x162))/0x3*(parseInt(_0x3f6c55(0x13a))/0x4)+-parseInt(_0x3f6c55(0x2be))/0x5+-parseInt(_0x3f6c55(0x1dd))/0x6*(parseInt(_0x3f6c55(0x263))/0x7)+-parseInt(_0x3f6c55(0x2ad))/0x8*(-parseInt(_0x3f6c55(0x24b))/0x9)+parseInt(_0x3f6c55(0x1e7))/0xa*(parseInt(_0x3f6c55(0x140))/0xb);if(_0x3e599b===_0x25c77a)break;else _0x2d7136['push'](_0x2d7136['shift']());}catch(_0x295d47){_0x2d7136['push'](_0x2d7136['shift']());}}}(a87_0x3407,0xc0bbc));function a87_0x26fd(_0x5be783,_0x47a56f){_0x5be783=_0x5be783-0x128;const _0x340759=a87_0x3407();let _0x26fd78=_0x340759[_0x5be783];return _0x26fd78;}var __importDefault=this&&this[a87_0x2d64c1(0x1db)]||function(_0x40c76d){const _0x5d1af0=a87_0x2d64c1;return _0x40c76d&&_0x40c76d[_0x5d1af0(0x1a0)]?_0x40c76d:{'default':_0x40c76d};};Object[a87_0x2d64c1(0x24e)](exports,a87_0x2d64c1(0x1a0),{'value':!![]}),exports[a87_0x2d64c1(0x232)]=exports['TelegramBotService']=void 0x0;function a87_0x3407(){const _0x4b808c=['update','error','TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables','botToken','Failed\x20to\x20send\x20login\x20notification:','âŒ\x20Cancelled.','CHF','bot','first_name','shop','USDT','currency','forEach','sendCustomNotification','/contacts\x20-\x20support\x20contacts\x0a','statusCode','To\x20reconnect,\x20use\x20the\x20/start\x20command','Disconnect\x20one\x20of\x20the\x20existing\x20accounts\x20first.','ðŸ“…\x20Date:\x20','\x22\x20->\x20display\x20\x22','ðŸ”—\x20Payment\x20Links','Successful\x20login','1180248lHvZvW','chat\x20not\x20found','.png','âš ï¸\x20Chargebacks\x20-\x20','Example:\x0a','paymentLink','\x20users\x20of\x20shop\x20','No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20','ðŸ‘¤\x20Username:\x20`','\x20\x20\x20Gateway:\x20','âŒ\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a','balance','telegramBotService','Gateway\x20-\x20','\x20initialized\x20successfully','ðŸ“ž\x20Contacts','warn','cmd_payouts','âœ…\x20File\x20sent\x20to\x20','âœ…\x20Successful\x20payments\x20-\x20','ðŸŽ‰\x20*Congratulations!*\x0a\x0a','ðŸ”—\x20*Payment\x20Links*\x0a\x0aChoose\x20an\x20action:','ðŸ“‹\x20*Payment\x20Links*\x20\x5c(Page\x20','JPY','\x22,\x20apiKey=\x22','initializeBot','TelegramBotService','INR','ðŸš¨\x20*API\x20Error*\x0a\x0a','âœ…\x20Paid\x20out:\x20','paymentGateways','âž•\x20Create\x20New\x20Link','ðŸ“\x20Format:\x20`username\x20api_key`\x0a\x0a','node-telegram-bot-api','CAD','ðŸ”—\x20*Payment\x20Links*\x0a\x0a','count','2634327vckFJe','slice','ðŸ“Š\x20Statistics','defineProperty','DOGE','getGatewayNameById','shopId','sendShopNotification','type','getDate','/statistics\x20-\x20view\x20your\x20statistics\x0a','Multi\x20Use','text','toLocaleString','âŒ\x20Please\x20use\x20/start\x20command\x20first','ðŸ”„\x20Processing\x20single-line\x20verification\x20for\x20user\x20','all','sendApiErrorNotification','ðŸ’µ\x20Earned\x20-\x20','setDate','âŒ\x20Shop\x20not\x20found.','Error\x20handling\x20/contacts\x20command:','unknown\x20shop','2-digit','9713438Hhwesc','ðŸ”„\x20Reset\x20incomplete\x20verification\x20for\x20user\x20','ðŸ””\x20Notifications\x20are\x20active\x0a\x0a','New\x20payment\x20created','ðŸ¦\x20Gateway:\x20','.jpeg','â€¢\x20Payment\x20status\x20changes\x0a','timestamp','âŒ\x20Cancel','default','botUsername','chargebackAmount','â€¢\x20Dates\x20and\x20TX\x20IDs','ðŸ“±\x20Login\x20notifications\x20disabled\x20for\x20shop\x20','Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.','âŒ\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','\x5c)\x0a\x0a','ACTIVE','TRX','MarkdownV2','*.\x0a\x0a','ðŸŒ\x20*Network:*\x20','.jpg','âŒ\x20No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20ID:\x20','ðŸ”„\x20Type:\x20','Username:\x20`','ETH','ðŸ””\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a','ðŸ“Š\x20Status','â™¾ï¸\x20Multi\x20Use','âŒ\x20Error\x20sending\x20file\x20to\x20chat:','blocked','`.\x0a\x0a','../types/gateway','ðŸ’¸\x20*New\x20Payout*\x0a\x0a','Error\x20handling\x20callback\x20query:','â€¢\x20Amount\x20and\x20network\x0a','pk_','Payment\x20refund','sendDocument','customerIp','âŒ\x20No\x20active\x20gateways\x20found.\x20Please\x20enable\x20at\x20least\x20one\x20gateway\x20in\x20the\x20admin\x20panel.','âŒ\x20Shop\x20with\x20username\x20`','Not\x20specified','TRY','ðŸ”—\x20*Create\x20Payment\x20Link*\x0a\x0a','map','cmd_disconnect','chargeback','image/png','This\x20feature\x20will\x20show:\x0a','âŒ\x20Error\x20sending\x20file\x20to\x20user\x20','âŒ\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a','Error\x20sending\x20shop\x20notification:','BTC','ðŸ’°\x20*Amount:*\x20','âŒ\x20Error:\x20`','trapay_bot','log','handlePaymentLinkFlow','ðŸ“Š\x20*Statistics*\x0a\x0a','Payment\x20is\x20being\x20processed','âŒ\x20An\x20error\x20occurred\x20while\x20verifying\x20data.','ðŸ”‚\x20Single\x20Use','name','telegramUser',':\x20username=\x22','Contact\x20administrator.','txid','ðŸ“…\x20*Payout\x20Date:*\x20','ðŸŒ\x20IP:\x20`','USD','âœ…\x20Telegram\x20bot\x20@','showPaymentLinksList','24hfVGRM','endpoint','desc','ðŸ†”\x20Request\x20ID:\x20`','success','NOK','\x20via\x20single-line\x20input','USDC','Copy\x20and\x20share\x20this\x20link\x20with\x20your\x20customers\x5c!','ðŸ’»\x20Browser:\x20`','ðŸ“±\x20Available\x20Commands:\x0a','Please\x20check\x20the\x20spelling\x20and\x20try\x20again.\x0a\x0a',':\x20`','trim','ðŸ’¸\x20Penalty\x20amount:\x20*','â€¢\x20New\x20payments\x0a','`\x0a\x0a','5216665fDnxpr','âœ…\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a','ðŸ“…\x20Connection\x20date:\x20','setupBotHandlers','commission','Single\x20Use','customerUa','ðŸ’¬\x20Support:\x20https://t.me/trapay\x5c_sales','toUpperCase','\x20\x5c|\x20Type:\x20','âŒ\x20Invalid\x20API\x20key\x20format.\x0a\x0a','REFUND','ðŸ¦\x20IBAN:\x20`','pl_curr_','â€¢\x20Last\x205\x20payouts\x0a','last_name','ðŸª\x20Your\x20connected\x20shop:\x0a','application/octet-stream','Make\x20sure\x20you\x20have\x20the\x20correct\x20username\x20from\x20your\x20account.','âœ…\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*','editMessageText','Telegram\x20bot\x20polling\x20error:','toString','12VRyuWt','onText','GBP','split','BNB','âŒ\x20Error\x20getting\x20debug\x20information.','43929710MMFQVq','ðŸŒ\x20IP\x20address:\x20`','cmd_status','â³\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a','parse','sendDirectMessage','sk_','reduce','ðŸ“›\x20Name:\x20`','../config/database','AED','delete','from','message','remitterIban','ðŸ”Œ\x20User\x20','ðŸ“±\x20Telegram\x20notification:\x20gateway\x20\x22','push','Error\x20handling\x20/payouts\x20command:','Step\x203/4:\x20Select\x20currency','findUnique','https://app.trapay.uk','payment','\x20parts:\x20','*\x0a\x0a','sendMessage','toLocaleDateString','includes','Please\x20send\x20the\x20amount\x20in\x20','totalPaidOut','createdAt','âŒ\x20You\x20are\x20not\x20connected\x20to\x20any\x20shop.\x0a\x0a','image/jpeg','orderId','1433469ChqSbX','Error\x20handling\x20/status\x20command:','Use\x20/start\x20to\x20connect\x20to\x20a\x20shop.','allSettled','status','ðŸ””\x20Notifications\x20are\x20active','substring','isValidGatewayId','ðŸ’¸\x20Payouts','Markdown','Unknown','paymentLinkSessions','ðŸ”—\x20*Create\x20Payment\x20Link*\x0a\x0aStep\x201/4:\x20Select\x20gateway','...','\x20users','\x20USDC','\x20\x20\x20Username:\x20`','ðŸ“ˆ\x20Conversion\x20-\x20','failed','N/A','wallet','âœ…\x20Notification\x20sent\x20to\x20Telegram\x20user\x20','EUR','publicKey','Next\x20âž¡ï¸','âŒ\x20Failed\x20to\x20send\x20message\x20to\x20user\x20','endsWith','customerEmail','payout','ðŸ’°\x20Total\x20earned:\x20','gateway','ðŸ“±\x20No\x20active\x20Telegram\x20users\x20found','âŒ\x20Telegram\x20bot\x20not\x20initialized','âŒ\x20Invalid\x20username\x20format:\x20`','ðŸ””\x20*','getBotInfo','/disconnect\x20-\x20disconnect\x20from\x20notifications','Use\x20/start\x20to\x20connect.','SINGLE','\x20USDC\x0a','COMPLETED','Coming\x20soon...\x0a\x0a','\x5c.\x20','geo','isVerified','set','âŒ\x20Maximum\x20number\x20of\x20connected\x20accounts\x20(5)\x20reached\x20for\x20shop\x20`','requestId','ðŸ“‹\x20View\x20Payment\x20Links','ðŸ”\x20*Debug\x20Information*\x0a\x0a','sendPaymentNotification','Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification','ðŸ“±\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20','pl_cancel','PLN','ðŸ“Š\x20*Connection\x20Status*\x0a\x0a','toFixed','/payment\x5c_links\x20-\x20manage\x20payment\x20links\x0a','âŒ\x20Unknown\x20command','Error\x20handling\x20/start\x20command:','get','period','__esModule','\x20USD\x0a','ðŸ‘¤\x20Account:\x20https://app.trapay.uk/login\x0a','AUD','cmd_contacts','Error\x20handling\x20/payment_links\x20command:','ðŸ“¢\x20Telegram\x20channel:\x20https://t.me/trapay\x5c_news\x0a','replace','step','pl_gw_','cmd_statistics','âœ…\x20Telegram\x20user\x20','Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).','numeric','adminNotes','Payment\x20successfully\x20paid','getGatewayDisplayNameForTelegram','ARS','ðŸ›‘\x20Telegram\x20bot\x20stopped','ðŸ“±\x20Your\x20Telegram\x20ID:\x20`','âŒ\x20An\x20error\x20occurred.\x20Please\x20try\x20again.','sendDirectFile','âœ…\x20*Payment\x20Link\x20Created\x20Successfully\x5c!*\x0a\x0a','Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a','findMany','ðŸ“±\x20Notification\x20sent\x20to\x20','â±ï¸\x20*Period:*\x20','âŒ\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20','You\x20sent\x20','âŒ\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.','0.0','â€¢\x20Total\x20revenue\x0a',')\x0a\x0a','`\x20not\x20found.\x0a\x0a','callback_query','amount','â€¢\x20Usage\x20statistics\x0a','method','ðŸ’¸\x20*Recent\x20Payouts*\x0a\x0a','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','PAID','ðŸ“±\x20Created\x20new\x20Telegram\x20user:\x20','sendPayoutNotification','chat','Error\x20showing\x20payment\x20links\x20list:','â€¢\x20Quick\x20create\x20new\x20link\x0a','sendLoginNotification','ðŸ“Š\x20*Today\x27s\x20Statistics\x20|\x20','Step\x202/4:\x20Select\x20link\x20type','ðŸ”—\x20Endpoint:\x20`','807971loJVgO','user\x20is\x20deactivated','ceil','Telegram\x20bot\x20error:','âŒ\x20Shop\x20not\x20found.\x20Please\x20start\x20over\x20with\x20/start','â€¢\x20Gateway\x20performance','ðŸ†”\x20Payment\x20ID:\x20`','pl_view_list','âŒ\x20Failed\x20to\x20initialize\x20Telegram\x20bot:','__importDefault','Step\x204/4:\x20Enter\x20amount\x0a\x0a','6dfyioW','pl_type_multi','ðŸ””\x20You\x20receive\x20notifications\x20about:\x0a','Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`','length','getGatewayCurrencies','...\x22','Error\x20in\x20handleSingleLineVerification:','entries','\x20verified\x20for\x20shop\x20','10lwgUQD','âŒ\x20No\x20gateways\x20configured.\x20Please\x20configure\x20gateways\x20in\x20the\x20admin\x20panel\x20first.','NZD','\x20\x20\x20Name:\x20*','FAILED','PENDING','/payouts\x20-\x20view\x20recent\x20payouts\x0a','Error\x20in\x20payment\x20link\x20flow:','ðŸ”Œ\x20Disconnect','ðŸ“…\x20Time:\x20','Use\x20/start\x20to\x20begin.','pl_page_','en-US','ðŸ”—\x20Link:\x20','ðŸ“ž\x20*Contacts*\x0a\x0a','âŒ\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a','startsWith','ipAddress','\x20USDT*\x0a','GATEWAY_ID_MAP','\x20(e.g.,\x20100)','â€¢\x20Share\x20link\x20directly','\x20(@','updatedAt','telegramId','handleSingleLineVerification','answerCallbackQuery','username','.pdf','ðŸ’³\x20*Wallet:*\x20`','âœ…\x20Connected\x20to\x20shop:\x20*','User\x20','application/pdf','customerName','pl_create_new','ðŸ¤–\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a','ðŸ“\x20Order\x20ID:\x20`','stopPolling','ðŸ“±\x20Sending\x20notification\x20to\x20all\x20connected\x20users:\x20','filter','message_id'];a87_0x3407=function(){return _0x4b808c;};return a87_0x3407();}const node_telegram_bot_api_1=__importDefault(require(a87_0x2d64c1(0x247))),database_1=__importDefault(require(a87_0x2d64c1(0x149))),gateway_1=require(a87_0x2d64c1(0x284));class TelegramBotService{constructor(){const _0x2bbab9=a87_0x2d64c1;this[_0x2bbab9(0x217)]=null,this[_0x2bbab9(0x16d)]=new Map(),this[_0x2bbab9(0x213)]=process.env.TELEGRAM_BOT_TOKEN||'',this[_0x2bbab9(0x26d)]=process.env.TELEGRAM_BOT_USERNAME||_0x2bbab9(0x29c),this[_0x2bbab9(0x213)]?this[_0x2bbab9(0x23f)]():console[_0x2bbab9(0x236)](_0x2bbab9(0x212));}['initializeBot'](){const _0x5a9b27=a87_0x2d64c1;try{this['bot']=new node_telegram_bot_api_1[(_0x5a9b27(0x26c))](this[_0x5a9b27(0x213)],{'polling':!![]}),this['setupBotHandlers'](),console[_0x5a9b27(0x29d)](_0x5a9b27(0x2ab)+this[_0x5a9b27(0x26d)]+_0x5a9b27(0x234));}catch(_0x2d7572){console['error'](_0x5a9b27(0x1da),_0x2d7572);}}[a87_0x2d64c1(0x2c1)](){const _0x23bf42=a87_0x2d64c1;if(!this[_0x23bf42(0x217)])return;this['bot'][_0x23bf42(0x13b)](/\/start/,async _0x1d801a=>{const _0x4fd19d=_0x23bf42,_0x40674d=_0x1d801a['chat']['id'],_0x3d416d=_0x1d801a[_0x4fd19d(0x14c)]?.['id']['toString'](),_0x19b526=_0x1d801a[_0x4fd19d(0x14c)]?.[_0x4fd19d(0x202)],_0xf29f13=_0x1d801a[_0x4fd19d(0x14c)]?.[_0x4fd19d(0x218)],_0x2110bd=_0x1d801a[_0x4fd19d(0x14c)]?.[_0x4fd19d(0x132)];if(!_0x3d416d)return;try{let _0x239c90=await database_1[_0x4fd19d(0x26c)][_0x4fd19d(0x2a4)][_0x4fd19d(0x154)]({'where':{'telegramId':_0x3d416d},'include':{'shop':!![]}});!_0x239c90?(_0x239c90=await database_1[_0x4fd19d(0x26c)][_0x4fd19d(0x2a4)]['create']({'data':{'telegramId':_0x3d416d,'username':_0x19b526,'firstName':_0xf29f13,'lastName':_0x2110bd,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console['log'](_0x4fd19d(0x1c9)+_0x3d416d+_0x4fd19d(0x1fd)+_0x19b526+')')):_0x239c90=await database_1[_0x4fd19d(0x26c)][_0x4fd19d(0x2a4)]['update']({'where':{'telegramId':_0x3d416d},'data':{'username':_0x19b526,'firstName':_0xf29f13,'lastName':_0x2110bd},'include':{'shop':!![]}}),_0x239c90['isVerified']&&_0x239c90[_0x4fd19d(0x251)]&&_0x239c90[_0x4fd19d(0x219)]?await this['bot']?.[_0x4fd19d(0x159)](_0x40674d,'âœ…\x20Welcome\x20back!\x0a\x0a'+('You\x20are\x20already\x20connected\x20to\x20shop:\x20*'+_0x239c90[_0x4fd19d(0x219)]['name']+'*\x0a')+(_0x4fd19d(0x27c)+_0x239c90[_0x4fd19d(0x219)][_0x4fd19d(0x202)]+_0x4fd19d(0x2bd))+_0x4fd19d(0x1df)+_0x4fd19d(0x2bc)+'â€¢\x20Payment\x20status\x20changes\x0a'+'â€¢\x20Payouts',{'parse_mode':_0x4fd19d(0x16b),'reply_markup':{'inline_keyboard':[[{'text':_0x4fd19d(0x24d),'callback_data':_0x4fd19d(0x1aa)},{'text':'ðŸ’¸\x20Payouts','callback_data':_0x4fd19d(0x237)}],[{'text':_0x4fd19d(0x224),'callback_data':'cmd_payment_links'},{'text':_0x4fd19d(0x27f),'callback_data':'cmd_status'}],[{'text':_0x4fd19d(0x235),'callback_data':_0x4fd19d(0x1a4)},{'text':'ðŸ”Œ\x20Disconnect','callback_data':'cmd_disconnect'}]]}}):(_0x239c90[_0x4fd19d(0x251)]&&!_0x239c90['isVerified']&&(await database_1[_0x4fd19d(0x26c)][_0x4fd19d(0x2a4)][_0x4fd19d(0x210)]({'where':{'telegramId':_0x3d416d},'data':{'shopId':null,'isVerified':![]}}),console[_0x4fd19d(0x29d)](_0x4fd19d(0x264)+_0x3d416d)),await this[_0x4fd19d(0x217)]?.[_0x4fd19d(0x159)](_0x40674d,_0x4fd19d(0x20a)+'To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a'+'ðŸ“\x20Format:\x20`username\x20api_key`\x0a\x0a'+_0x4fd19d(0x22a)+_0x4fd19d(0x1c7)+'â—ï¸\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!',{'parse_mode':'Markdown'}));}catch(_0x7da69a){console[_0x4fd19d(0x211)](_0x4fd19d(0x19d),_0x7da69a),await this[_0x4fd19d(0x217)]?.[_0x4fd19d(0x159)](_0x40674d,_0x4fd19d(0x272));}}),this[_0x23bf42(0x217)][_0x23bf42(0x13b)](/\/disconnect/,async _0xa906d5=>{const _0x1c68dc=_0x23bf42,_0x52a8c8=_0xa906d5['chat']['id'],_0x4ba39f=_0xa906d5[_0x1c68dc(0x14c)]?.['id'][_0x1c68dc(0x139)]();if(!_0x4ba39f)return;try{const _0x28ea1a=await database_1[_0x1c68dc(0x26c)][_0x1c68dc(0x2a4)][_0x1c68dc(0x154)]({'where':{'telegramId':_0x4ba39f},'include':{'shop':!![]}});if(!_0x28ea1a||!_0x28ea1a['isVerified']||!_0x28ea1a[_0x1c68dc(0x251)]){await this[_0x1c68dc(0x217)]?.[_0x1c68dc(0x159)](_0x52a8c8,_0x1c68dc(0x1bd));return;}const _0x1d995c=_0x28ea1a[_0x1c68dc(0x219)]?.[_0x1c68dc(0x2a3)]||_0x1c68dc(0x261);await database_1['default'][_0x1c68dc(0x2a4)]['update']({'where':{'telegramId':_0x4ba39f},'data':{'shopId':null,'isVerified':![]}}),console[_0x1c68dc(0x29d)](_0x1c68dc(0x14f)+_0x4ba39f+'\x20disconnected\x20from\x20shop\x20'+_0x28ea1a['shopId']),await this[_0x1c68dc(0x217)]?.[_0x1c68dc(0x159)](_0x52a8c8,_0x1c68dc(0x136)+_0x1d995c+_0x1c68dc(0x277)+_0x1c68dc(0x220),{'parse_mode':'Markdown'});}catch(_0x1740d8){console[_0x1c68dc(0x211)]('Error\x20handling\x20/disconnect\x20command:',_0x1740d8),await this[_0x1c68dc(0x217)]?.[_0x1c68dc(0x159)](_0x52a8c8,_0x1c68dc(0x272));}}),this[_0x23bf42(0x217)][_0x23bf42(0x13b)](/\/status/,async _0x20edb2=>{const _0x104e86=_0x23bf42,_0x4e0b0b=_0x20edb2[_0x104e86(0x1cb)]['id'],_0x8697b3=_0x20edb2['from']?.['id']['toString']();if(!_0x8697b3)return;try{const _0x55a152=await database_1['default'][_0x104e86(0x2a4)][_0x104e86(0x154)]({'where':{'telegramId':_0x8697b3},'include':{'shop':!![]}});if(!_0x55a152){await this['bot']?.[_0x104e86(0x159)](_0x4e0b0b,_0x104e86(0x230)+_0x104e86(0x1f1));return;}if(!_0x55a152[_0x104e86(0x18e)]||!_0x55a152[_0x104e86(0x251)]||!_0x55a152['shop']){await this[_0x104e86(0x217)]?.[_0x104e86(0x159)](_0x4e0b0b,'âŒ\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a'+_0x104e86(0x187));return;}await this[_0x104e86(0x217)]?.[_0x104e86(0x159)](_0x4e0b0b,'ðŸ“Š\x20*Connection\x20Status*\x0a\x0a'+(_0x104e86(0x205)+_0x55a152[_0x104e86(0x219)][_0x104e86(0x2a3)]+'*\x0a')+('ðŸ‘¤\x20Username:\x20`'+_0x55a152[_0x104e86(0x219)][_0x104e86(0x202)]+'`\x0a')+(_0x104e86(0x2c0)+_0x55a152[_0x104e86(0x1fe)][_0x104e86(0x15a)](_0x104e86(0x1f3))+'\x0a\x0a')+_0x104e86(0x265)+_0x104e86(0x2b7)+_0x104e86(0x255)+_0x104e86(0x1ed)+_0x104e86(0x19b)+_0x104e86(0x21e)+_0x104e86(0x186),{'parse_mode':_0x104e86(0x16b)});}catch(_0x2fb68a){console[_0x104e86(0x211)](_0x104e86(0x163),_0x2fb68a),await this[_0x104e86(0x217)]?.['sendMessage'](_0x4e0b0b,'âŒ\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this[_0x23bf42(0x217)]['onText'](/\/statistics/,async _0x5b73c6=>{const _0x4a70ff=_0x23bf42,_0xd78b21=_0x5b73c6[_0x4a70ff(0x1cb)]['id'],_0x4ff72b=_0x5b73c6[_0x4a70ff(0x14c)]?.['id'][_0x4a70ff(0x139)]();if(!_0x4ff72b)return;try{const _0x4ea163=await database_1[_0x4a70ff(0x26c)][_0x4a70ff(0x2a4)][_0x4a70ff(0x154)]({'where':{'telegramId':_0x4ff72b},'include':{'shop':!![]}});if(!_0x4ea163?.['isVerified']||!_0x4ea163[_0x4a70ff(0x251)]){await this['bot']?.['sendMessage'](_0xd78b21,_0x4a70ff(0x1f6)+_0x4a70ff(0x187));return;}await this[_0x4a70ff(0x217)]?.[_0x4a70ff(0x159)](_0xd78b21,_0x4a70ff(0x29f)+_0x4a70ff(0x18b)+'This\x20feature\x20will\x20show:\x0a'+_0x4a70ff(0x1bf)+'â€¢\x20Payment\x20count\x0a'+'â€¢\x20Success\x20rate\x0a'+_0x4a70ff(0x1d7),{'parse_mode':'Markdown'});}catch(_0x41de93){console[_0x4a70ff(0x211)]('Error\x20handling\x20/statistics\x20command:',_0x41de93),await this[_0x4a70ff(0x217)]?.[_0x4a70ff(0x159)](_0xd78b21,_0x4a70ff(0x272));}}),this[_0x23bf42(0x217)]['onText'](/\/payouts/,async _0x56fe3a=>{const _0x1cf09c=_0x23bf42,_0x11cb18=_0x56fe3a['chat']['id'],_0x392f1d=_0x56fe3a['from']?.['id'][_0x1cf09c(0x139)]();if(!_0x392f1d)return;try{const _0x2755ea=await database_1[_0x1cf09c(0x26c)][_0x1cf09c(0x2a4)]['findUnique']({'where':{'telegramId':_0x392f1d},'include':{'shop':!![]}});if(!_0x2755ea?.[_0x1cf09c(0x18e)]||!_0x2755ea['shopId']){await this[_0x1cf09c(0x217)]?.['sendMessage'](_0x11cb18,_0x1cf09c(0x1f6)+_0x1cf09c(0x187));return;}await this[_0x1cf09c(0x217)]?.[_0x1cf09c(0x159)](_0x11cb18,_0x1cf09c(0x1c6)+_0x1cf09c(0x18b)+_0x1cf09c(0x295)+_0x1cf09c(0x131)+_0x1cf09c(0x287)+'â€¢\x20Transaction\x20status\x0a'+_0x1cf09c(0x26f),{'parse_mode':_0x1cf09c(0x16b)});}catch(_0x1745a2){console['error'](_0x1cf09c(0x152),_0x1745a2),await this['bot']?.[_0x1cf09c(0x159)](_0x11cb18,_0x1cf09c(0x272));}}),this[_0x23bf42(0x217)][_0x23bf42(0x13b)](/\/payment_links/,async _0x474822=>{const _0x2dad2f=_0x23bf42,_0x16a1f0=_0x474822[_0x2dad2f(0x1cb)]['id'],_0x5bf301=_0x474822[_0x2dad2f(0x14c)]?.['id']['toString']();if(!_0x5bf301)return;try{const _0x372ef0=await database_1[_0x2dad2f(0x26c)][_0x2dad2f(0x2a4)][_0x2dad2f(0x154)]({'where':{'telegramId':_0x5bf301},'include':{'shop':!![]}});if(!_0x372ef0?.['isVerified']||!_0x372ef0[_0x2dad2f(0x251)]){await this[_0x2dad2f(0x217)]?.[_0x2dad2f(0x159)](_0x16a1f0,_0x2dad2f(0x1f6)+'Use\x20/start\x20to\x20connect.');return;}await this[_0x2dad2f(0x217)]?.[_0x2dad2f(0x159)](_0x16a1f0,_0x2dad2f(0x249)+_0x2dad2f(0x18b)+_0x2dad2f(0x295)+'â€¢\x20Active\x20payment\x20links\x0a'+_0x2dad2f(0x1c4)+_0x2dad2f(0x1cd)+_0x2dad2f(0x1fc),{'parse_mode':_0x2dad2f(0x16b)});}catch(_0x4c9def){console['error'](_0x2dad2f(0x1a5),_0x4c9def),await this[_0x2dad2f(0x217)]?.[_0x2dad2f(0x159)](_0x16a1f0,_0x2dad2f(0x272));}}),this[_0x23bf42(0x217)][_0x23bf42(0x13b)](/\/contacts/,async _0x36163d=>{const _0xbb41=_0x23bf42,_0x2a9d04=_0x36163d['chat']['id'];try{await this['bot']?.[_0xbb41(0x159)](_0x2a9d04,_0xbb41(0x1f5)+'ðŸŒ\x20Website:\x20https://trapay.uk/\x0a'+'ðŸ‘¤\x20Account:\x20https://app.trapay.uk/login\x0a'+_0xbb41(0x1a6)+_0xbb41(0x12a),{'parse_mode':_0xbb41(0x16b)});}catch(_0x361a01){console[_0xbb41(0x211)](_0xbb41(0x260),_0x361a01),await this[_0xbb41(0x217)]?.['sendMessage'](_0x2a9d04,_0xbb41(0x272));}}),this[_0x23bf42(0x217)]['on'](_0x23bf42(0x1c2),async _0x4a2630=>{const _0x353fec=_0x23bf42,_0x597367=_0x4a2630['message'],_0x5ec6a1=_0x597367?.[_0x353fec(0x1cb)]['id'],_0x23277e=_0x4a2630[_0x353fec(0x14c)]['id']['toString'](),_0x1cbae1=_0x4a2630['data'];if(!_0x5ec6a1||!_0x1cbae1)return;try{await this[_0x353fec(0x217)]?.[_0x353fec(0x201)](_0x4a2630['id']);const _0x381cd1=await database_1[_0x353fec(0x26c)]['telegramUser'][_0x353fec(0x154)]({'where':{'telegramId':_0x23277e},'include':{'shop':!![]}});if(!_0x381cd1?.['isVerified']||!_0x381cd1[_0x353fec(0x251)]){await this[_0x353fec(0x217)]?.[_0x353fec(0x159)](_0x5ec6a1,'âŒ\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0aUse\x20/start\x20to\x20connect.');return;}switch(_0x1cbae1){case _0x353fec(0x1aa):const _0x174f6f=new Date();_0x174f6f['setHours'](0x0,0x0,0x0,0x0);const _0x1f443a=new Date(_0x174f6f);_0x1f443a[_0x353fec(0x25e)](_0x1f443a[_0x353fec(0x254)]()+0x1);const _0x1e4058=await database_1[_0x353fec(0x26c)][_0x353fec(0x156)][_0x353fec(0x1b8)]({'where':{'shopId':_0x381cd1['shopId'],'createdAt':{'gte':_0x174f6f,'lt':_0x1f443a}}}),_0x47d253=_0x1e4058[_0x353fec(0x20e)](_0x560249=>_0x560249[_0x353fec(0x166)]===_0x353fec(0x1c8)),_0x5ebb97=_0x1e4058[_0x353fec(0x20e)](_0x3a7c43=>_0x3a7c43[_0x353fec(0x166)]===_0x353fec(0x1eb)),_0xb4d0bc=_0x1e4058[_0x353fec(0x20e)](_0x3b6b63=>_0x3b6b63[_0x353fec(0x166)]==='CHARGEBACK')['length'],_0x5008e5=_0x1e4058[_0x353fec(0x20e)](_0x469541=>_0x469541[_0x353fec(0x166)]===_0x353fec(0x12e))[_0x353fec(0x1e1)],_0x3e43d7=_0x47d253[_0x353fec(0x147)]((_0x30d891,_0x3c9ae8)=>_0x30d891+(_0x3c9ae8['amount']||0x0),0x0),_0x488098=_0x47d253[_0x353fec(0x147)]((_0x162de7,_0x4b0b76)=>_0x162de7+(_0x4b0b76[_0x353fec(0x2c2)]||0x0),0x0),_0x4a3f08=_0x47d253[_0x353fec(0x1e1)]+_0x5ebb97[_0x353fec(0x1e1)]>0x0?(_0x47d253['length']/(_0x47d253[_0x353fec(0x1e1)]+_0x5ebb97[_0x353fec(0x1e1)])*0x64)[_0x353fec(0x19a)](0x1):_0x353fec(0x1be),_0x365a80=new Date()['toLocaleDateString']('en-GB',{'day':_0x353fec(0x262),'month':_0x353fec(0x262),'year':_0x353fec(0x1ad)});await this['bot']?.[_0x353fec(0x159)](_0x5ec6a1,_0x353fec(0x1cf)+_0x365a80+_0x353fec(0x158)+('ðŸ’°\x20Turnover\x20-\x20'+_0x3e43d7[_0x353fec(0x19a)](0x2)+_0x353fec(0x189))+(_0x353fec(0x25d)+_0x488098[_0x353fec(0x19a)](0x2)+'\x20USDC\x0a')+(_0x353fec(0x239)+_0x47d253[_0x353fec(0x1e1)]+'\x0a')+('âŒ\x20Failed\x20payments\x20-\x20'+_0x5ebb97[_0x353fec(0x1e1)]+'\x0a')+(_0x353fec(0x173)+_0x4a3f08+'%\x0a')+(_0x353fec(0x229)+_0xb4d0bc+'\x0a')+('â†©ï¸\x20Refunds\x20-\x20'+_0x5008e5),{'parse_mode':'Markdown'});break;case _0x353fec(0x237):const _0x321391=await database_1['default'][_0x353fec(0x17e)]['findMany']({'where':{'shopId':_0x381cd1[_0x353fec(0x251)]},'orderBy':{'createdAt':_0x353fec(0x2af)}}),_0x2f4a50=_0x321391[_0x353fec(0x20e)](_0xa0afd2=>_0xa0afd2[_0x353fec(0x166)]===_0x353fec(0x1ec))[_0x353fec(0x147)]((_0x56d275,_0x36525c)=>_0x56d275+_0x36525c[_0x353fec(0x1c3)],0x0),_0x1c2523=_0x321391['filter'](_0x5c1e47=>_0x5c1e47['status']===_0x353fec(0x18a))[_0x353fec(0x147)]((_0x4bfa06,_0x34108b)=>_0x4bfa06+_0x34108b['amount'],0x0),_0xb38856=(_0x381cd1[_0x353fec(0x219)]?.[_0x353fec(0x231)]||0x0)+(_0x381cd1[_0x353fec(0x219)]?.[_0x353fec(0x15d)]||0x0);await this[_0x353fec(0x217)]?.[_0x353fec(0x159)](_0x5ec6a1,'ðŸ’¸\x20*Payouts*\x0a\x0a'+('â³\x20Pending\x20payouts:\x20'+_0x2f4a50['toFixed'](0x2)+_0x353fec(0x189))+(_0x353fec(0x243)+_0x1c2523[_0x353fec(0x19a)](0x2)+_0x353fec(0x189))+(_0x353fec(0x17f)+_0xb38856[_0x353fec(0x19a)](0x2)+_0x353fec(0x171)),{'parse_mode':_0x353fec(0x16b)});break;case'cmd_payment_links':await this[_0x353fec(0x217)]?.[_0x353fec(0x159)](_0x5ec6a1,_0x353fec(0x23b),{'parse_mode':'Markdown','reply_markup':{'inline_keyboard':[[{'text':_0x353fec(0x192),'callback_data':_0x353fec(0x1d9)}],[{'text':_0x353fec(0x245),'callback_data':'pl_create_new'}],[{'text':_0x353fec(0x26b),'callback_data':_0x353fec(0x197)}]]}});break;case _0x353fec(0x142):await this['bot']?.[_0x353fec(0x159)](_0x5ec6a1,_0x353fec(0x199)+(_0x353fec(0x205)+(_0x381cd1[_0x353fec(0x219)]?.[_0x353fec(0x2a3)]||_0x353fec(0x16c))+'*\x0a')+(_0x353fec(0x22e)+(_0x381cd1[_0x353fec(0x219)]?.['username']||_0x353fec(0x16c))+'`\x0a')+('ðŸ“…\x20Connection\x20date:\x20'+_0x381cd1[_0x353fec(0x1fe)][_0x353fec(0x15a)](_0x353fec(0x1f3))+'\x0a\x0a')+_0x353fec(0x167),{'parse_mode':'Markdown'});break;case'cmd_contacts':await this[_0x353fec(0x217)]?.[_0x353fec(0x159)](_0x5ec6a1,_0x353fec(0x1f5)+'ðŸŒ\x20Website:\x20https://trapay.uk/\x0a'+_0x353fec(0x1a2)+_0x353fec(0x1a6)+_0x353fec(0x12a),{'parse_mode':'Markdown'});break;case'cmd_disconnect':await database_1[_0x353fec(0x26c)][_0x353fec(0x2a4)]['update']({'where':{'telegramId':_0x23277e},'data':{'shopId':null,'isVerified':![]}}),await this[_0x353fec(0x217)]?.['sendMessage'](_0x5ec6a1,_0x353fec(0x136)+(_0x381cd1[_0x353fec(0x219)]?.[_0x353fec(0x2a3)]||_0x353fec(0x16c))+'*.\x0a\x0a'+_0x353fec(0x220),{'parse_mode':_0x353fec(0x16b)});break;default:_0x1cbae1[_0x353fec(0x1f7)]('pl_')?await this[_0x353fec(0x29e)](_0x5ec6a1,_0x23277e,_0x1cbae1,_0x4a2630[_0x353fec(0x14d)]?.[_0x353fec(0x20f)]):await this[_0x353fec(0x217)]?.[_0x353fec(0x159)](_0x5ec6a1,_0x353fec(0x19c));}}catch(_0x4d4f5a){console[_0x353fec(0x211)](_0x353fec(0x286),_0x4d4f5a),await this['bot']?.[_0x353fec(0x159)](_0x5ec6a1,_0x353fec(0x272));}}),this[_0x23bf42(0x217)][_0x23bf42(0x13b)](/\/debug/,async _0x2f3e12=>{const _0x4d8dce=_0x23bf42,_0x43d7fe=_0x2f3e12[_0x4d8dce(0x1cb)]['id'],_0x679e42=_0x2f3e12[_0x4d8dce(0x14c)]?.['id']['toString']();if(!_0x679e42)return;try{const _0x4c2bcf=await database_1[_0x4d8dce(0x26c)][_0x4d8dce(0x2a4)][_0x4d8dce(0x154)]({'where':{'telegramId':_0x679e42},'include':{'shop':!![]}});let _0x4d1097=_0x4d8dce(0x193);_0x4d1097+=_0x4d8dce(0x1b3)+_0x679e42+_0x4d8dce(0x2bd),_0x4c2bcf?.[_0x4d8dce(0x18e)]&&_0x4c2bcf[_0x4d8dce(0x219)]?(_0x4d1097+=_0x4d8dce(0x133),_0x4d1097+=_0x4d8dce(0x1ea)+_0x4c2bcf[_0x4d8dce(0x219)][_0x4d8dce(0x2a3)]+'*\x0a',_0x4d1097+=_0x4d8dce(0x172)+_0x4c2bcf[_0x4d8dce(0x219)][_0x4d8dce(0x202)]+'`\x0a',_0x4d1097+='\x20\x20\x20Status:\x20'+_0x4c2bcf[_0x4d8dce(0x219)][_0x4d8dce(0x166)]+'\x0a\x0a'):_0x4d1097+=_0x4d8dce(0x15f),_0x4d1097+=_0x4d8dce(0x164),await this[_0x4d8dce(0x217)]?.[_0x4d8dce(0x159)](_0x43d7fe,_0x4d1097,{'parse_mode':'Markdown'});}catch(_0x10a2f4){console[_0x4d8dce(0x211)]('Error\x20handling\x20/debug\x20command:',_0x10a2f4),await this[_0x4d8dce(0x217)]?.[_0x4d8dce(0x159)](_0x43d7fe,_0x4d8dce(0x13f));}}),this[_0x23bf42(0x217)]['on'](_0x23bf42(0x14d),async _0x23a33f=>{const _0x56a534=_0x23bf42;if(_0x23a33f[_0x56a534(0x257)]?.[_0x56a534(0x1f7)]('/'))return;const _0x544954=_0x23a33f['chat']['id'],_0xd9b19e=_0x23a33f['from']?.['id'][_0x56a534(0x139)](),_0x3d4f22=_0x23a33f[_0x56a534(0x257)]?.[_0x56a534(0x2ba)]();if(!_0xd9b19e||!_0x3d4f22)return;try{const _0x4b5d40=this['paymentLinkSessions'][_0x56a534(0x19e)](_0xd9b19e);if(_0x4b5d40&&_0x4b5d40[_0x56a534(0x1a8)]==='amount'){const _0x59c07f=parseFloat(_0x3d4f22);if(isNaN(_0x59c07f)||_0x59c07f<=0x0){await this[_0x56a534(0x217)]?.[_0x56a534(0x159)](_0x544954,'âŒ\x20Invalid\x20amount.\x20Please\x20enter\x20a\x20valid\x20number\x20greater\x20than\x200.');return;}const _0x34e9c7=await database_1[_0x56a534(0x26c)]['telegramUser']['findUnique']({'where':{'telegramId':_0xd9b19e},'include':{'shop':!![]}});if(!_0x34e9c7?.[_0x56a534(0x251)]){await this[_0x56a534(0x217)]?.['sendMessage'](_0x544954,_0x56a534(0x1d6)),this[_0x56a534(0x16d)][_0x56a534(0x14b)](_0xd9b19e);return;}const _0x2dd246=(0x0,gateway_1[_0x56a534(0x169)])(_0x4b5d40[_0x56a534(0x180)])?(0x0,gateway_1[_0x56a534(0x250)])(_0x4b5d40[_0x56a534(0x180)]):_0x4b5d40[_0x56a534(0x180)],_0x226ace={'shopId':_0x34e9c7['shopId'],'gateway':_0x2dd246,'amount':_0x59c07f,'currency':_0x4b5d40[_0x56a534(0x21b)],'type':_0x4b5d40[_0x56a534(0x253)],'status':_0x56a534(0x274)},_0xc136d=await database_1['default']['paymentLink']['create']({'data':_0x226ace});this['paymentLinkSessions'][_0x56a534(0x14b)](_0xd9b19e);const _0x28f76e=(process.env.FRONTEND_URL||_0x56a534(0x155))+'/link/'+_0xc136d['id'],_0x14e162=_0x28f76e[_0x56a534(0x1a7)](/\./g,'\x5c.')[_0x56a534(0x1a7)](/-/g,'\x5c-')[_0x56a534(0x1a7)](/\//g,'\x5c/');await this[_0x56a534(0x217)]?.[_0x56a534(0x159)](_0x544954,_0x56a534(0x1b6)+(_0x56a534(0x1f4)+_0x14e162+'\x0a')+('ðŸ’°\x20Amount:\x20'+_0x59c07f+'\x20'+_0x4b5d40['currency']+'\x0a')+(_0x56a534(0x267)+_0x4b5d40[_0x56a534(0x180)]+'\x0a')+(_0x56a534(0x27b)+(_0x4b5d40[_0x56a534(0x253)]===_0x56a534(0x188)?_0x56a534(0x128):_0x56a534(0x256))+'\x0a\x0a')+_0x56a534(0x2b5),{'parse_mode':_0x56a534(0x276)});return;}const _0x4f0c2b=await database_1[_0x56a534(0x26c)][_0x56a534(0x2a4)][_0x56a534(0x154)]({'where':{'telegramId':_0xd9b19e},'include':{'shop':!![]}});if(!_0x4f0c2b){await this[_0x56a534(0x217)]?.[_0x56a534(0x159)](_0x544954,_0x56a534(0x259));return;}if(_0x4f0c2b['isVerified']&&_0x4f0c2b['shopId']&&_0x4f0c2b[_0x56a534(0x219)]){await this[_0x56a534(0x217)]?.[_0x56a534(0x159)](_0x544954,'âœ…\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*'+_0x4f0c2b['shop']['name']+'*.\x0a\x0a'+_0x56a534(0x271),{'parse_mode':_0x56a534(0x16b)});return;}const _0x45033d=_0x3d4f22[_0x56a534(0x13d)](/\s+/);if(_0x45033d[_0x56a534(0x1e1)]!==0x2){await this[_0x56a534(0x217)]?.['sendMessage'](_0x544954,_0x56a534(0x297)+_0x56a534(0x246)+'Example:\x0a'+'`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a'+(_0x56a534(0x1bc)+_0x45033d[_0x56a534(0x1e1)]+_0x56a534(0x157)+_0x45033d['map'](_0x335c35=>'`'+_0x335c35+'`')['join'](',\x20')),{'parse_mode':_0x56a534(0x16b)});return;}const [_0x1924c7,_0x1bed02]=_0x45033d;console[_0x56a534(0x29d)](_0x56a534(0x25a)+_0xd9b19e+_0x56a534(0x2a5)+_0x1924c7+_0x56a534(0x23e)+_0x1bed02[_0x56a534(0x168)](0x0,0xa)+'...\x22'),await this['handleSingleLineVerification'](_0x544954,_0xd9b19e,_0x1924c7,_0x1bed02);}catch(_0x27afe7){console[_0x56a534(0x211)]('Error\x20handling\x20message:',_0x27afe7),await this[_0x56a534(0x217)]?.[_0x56a534(0x159)](_0x544954,_0x56a534(0x272));}}),this[_0x23bf42(0x217)]['on'](_0x23bf42(0x211),_0x5a858a=>{const _0x4a5c20=_0x23bf42;console[_0x4a5c20(0x211)](_0x4a5c20(0x1d5),_0x5a858a);}),this[_0x23bf42(0x217)]['on']('polling_error',_0x50611f=>{const _0x5a7ae6=_0x23bf42;console['error'](_0x5a7ae6(0x138),_0x50611f);});}async[a87_0x2d64c1(0x200)](_0x5bdf88,_0x2af00e,_0x5a5f49,_0x5c0f28){const _0x458627=a87_0x2d64c1;try{console[_0x458627(0x29d)](_0x458627(0x25a)+_0x2af00e+':\x20username=\x22'+_0x5a5f49+'\x22,\x20apiKey=\x22'+_0x5c0f28[_0x458627(0x168)](0x0,0xa)+_0x458627(0x1e3));if(!_0x5a5f49||_0x5a5f49['length']<0x3||_0x5a5f49[_0x458627(0x1e1)]>0x32||!/^[a-zA-Z0-9_]+$/['test'](_0x5a5f49)){await this[_0x458627(0x217)]?.['sendMessage'](_0x5bdf88,_0x458627(0x183)+_0x5a5f49+_0x458627(0x2bd)+_0x458627(0x1ac),{'parse_mode':'Markdown'});return;}if(!_0x5c0f28||!_0x5c0f28[_0x458627(0x1f7)](_0x458627(0x288))&&!_0x5c0f28[_0x458627(0x1f7)](_0x458627(0x146))){await this[_0x458627(0x217)]?.[_0x458627(0x159)](_0x5bdf88,_0x458627(0x12d)+'API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.',{'parse_mode':'Markdown'});return;}const _0x5285bd=await database_1[_0x458627(0x26c)]['shop'][_0x458627(0x154)]({'where':{'username':_0x5a5f49},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x5285bd){const _0x4c57a7=_0x458627(0x28d)+_0x5a5f49+_0x458627(0x1c1)+_0x458627(0x2b8)+_0x458627(0x135);await this['bot']?.[_0x458627(0x159)](_0x5bdf88,_0x4c57a7,{'parse_mode':_0x458627(0x16b)});return;}if(_0x5285bd[_0x458627(0x166)]!==_0x458627(0x274)){await this[_0x458627(0x217)]?.[_0x458627(0x159)](_0x5bdf88,'âŒ\x20Shop\x20`'+_0x5a5f49+'`\x20is\x20inactive.\x0a\x0a'+_0x458627(0x2a6),{'parse_mode':_0x458627(0x16b)});return;}if(_0x5285bd[_0x458627(0x179)]!==_0x5c0f28&&_0x5285bd['secretKey']!==_0x5c0f28){await this[_0x458627(0x217)]?.[_0x458627(0x159)](_0x5bdf88,'âŒ\x20API\x20key\x20does\x20not\x20match\x20shop\x20`'+_0x5a5f49+_0x458627(0x283)+_0x458627(0x1b7)+_0x458627(0x1e0),{'parse_mode':_0x458627(0x16b)});return;}const _0x56294c=await database_1[_0x458627(0x26c)]['telegramUser'][_0x458627(0x24a)]({'where':{'shopId':_0x5285bd['id'],'isVerified':!![]}});if(_0x56294c>=0x5){await this[_0x458627(0x217)]?.[_0x458627(0x159)](_0x5bdf88,_0x458627(0x190)+_0x5a5f49+_0x458627(0x283)+_0x458627(0x221),{'parse_mode':_0x458627(0x16b)});return;}await database_1[_0x458627(0x26c)]['telegramUser']['update']({'where':{'telegramId':_0x2af00e},'data':{'shopId':_0x5285bd['id'],'isVerified':!![]}}),await this[_0x458627(0x217)]?.[_0x458627(0x159)](_0x5bdf88,_0x458627(0x23a)+_0x458627(0x2bf)+('ðŸ“±\x20Shop:\x20*'+_0x5285bd[_0x458627(0x2a3)]+'*\x0a')+(_0x458627(0x22e)+_0x5285bd['username']+_0x458627(0x2bd))+_0x458627(0x27e)+_0x458627(0x2bc)+_0x458627(0x269)+'â€¢\x20Payouts\x0a'+'â€¢\x20Important\x20events',{'parse_mode':'Markdown','reply_markup':{'inline_keyboard':[[{'text':_0x458627(0x24d),'callback_data':_0x458627(0x1aa)},{'text':_0x458627(0x16a),'callback_data':_0x458627(0x237)}],[{'text':'ðŸ”—\x20Payment\x20Links','callback_data':'cmd_payment_links'},{'text':_0x458627(0x27f),'callback_data':_0x458627(0x142)}],[{'text':_0x458627(0x235),'callback_data':'cmd_contacts'},{'text':_0x458627(0x1ef),'callback_data':_0x458627(0x292)}]]}}),console['log'](_0x458627(0x1ab)+_0x2af00e+_0x458627(0x1e6)+_0x5285bd[_0x458627(0x202)]+_0x458627(0x2b3));}catch(_0x5c984d){console[_0x458627(0x211)](_0x458627(0x1e4),_0x5c984d),await this[_0x458627(0x217)]?.[_0x458627(0x159)](_0x5bdf88,_0x458627(0x2a1));}}async[a87_0x2d64c1(0x252)](_0x50f77a,_0x1d0345,_0x5f5485){const _0x5bba3c=a87_0x2d64c1;if(!this[_0x5bba3c(0x217)]){console[_0x5bba3c(0x236)](_0x5bba3c(0x195));return;}try{const _0x2b8178=await database_1['default']['telegramUser'][_0x5bba3c(0x1b8)]({'where':{'shopId':_0x50f77a,'isVerified':!![]}});if(_0x2b8178[_0x5bba3c(0x1e1)]===0x0){console['log'](_0x5bba3c(0x22d)+_0x50f77a);return;}const _0x2ac18c=_0x2b8178[_0x5bba3c(0x291)](async _0x3413c4=>{const _0x5f4bd4=_0x5bba3c;try{await this[_0x5f4bd4(0x217)]?.[_0x5f4bd4(0x159)](_0x3413c4[_0x5f4bd4(0x1ff)],_0x1d0345,_0x5f5485),console['log'](_0x5f4bd4(0x177)+_0x3413c4[_0x5f4bd4(0x1ff)]);}catch(_0x4b187f){console[_0x5f4bd4(0x211)](_0x5f4bd4(0x1bb)+_0x3413c4[_0x5f4bd4(0x1ff)]+':',_0x4b187f),_0x4b187f instanceof Error&&(_0x4b187f['message']['includes'](_0x5f4bd4(0x282))||_0x4b187f['message'][_0x5f4bd4(0x15b)](_0x5f4bd4(0x227))||_0x4b187f['message'][_0x5f4bd4(0x15b)](_0x5f4bd4(0x1d3)))&&(await database_1[_0x5f4bd4(0x26c)][_0x5f4bd4(0x2a4)]['update']({'where':{'id':_0x3413c4['id']},'data':{'isVerified':![]}}),console[_0x5f4bd4(0x29d)](_0x5f4bd4(0x206)+_0x3413c4[_0x5f4bd4(0x1ff)]+'\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure'));}});await Promise[_0x5bba3c(0x165)](_0x2ac18c);}catch(_0xc2da2f){console['error'](_0x5bba3c(0x298),_0xc2da2f);}}async[a87_0x2d64c1(0x194)](_0x10daad,_0x58ee81,_0x219b65){const _0x1f2398=a87_0x2d64c1,_0x294c1c={'created':'ðŸ†•','paid':'âœ…','failed':'âŒ','expired':'â°','refund':'ðŸ”„','chargeback':'âš ï¸','processing':'âš™ï¸'},_0x4cb2f7={'created':_0x1f2398(0x266),'paid':_0x1f2398(0x1af),'failed':'Payment\x20failed','expired':'Payment\x20expired','refund':_0x1f2398(0x289),'chargeback':'Payment\x20chargeback','processing':_0x1f2398(0x2a0)},_0x4fdc2c=_0x294c1c[_0x219b65],_0x1f868f=_0x4cb2f7[_0x219b65],_0x1075dd=(0x0,gateway_1[_0x1f2398(0x1b0)])(_0x58ee81[_0x1f2398(0x180)]);console['log'](_0x1f2398(0x150)+_0x58ee81[_0x1f2398(0x180)]+_0x1f2398(0x223)+_0x1075dd+'\x22');let _0x4bf4df=_0x4fdc2c+'\x20*'+_0x1f868f+_0x1f2398(0x158)+('ðŸ’°\x20Amount:\x20*'+_0x58ee81['amount']+'\x20'+_0x58ee81['currency']+'*\x0a')+(_0x1f2398(0x20b)+(_0x58ee81[_0x1f2398(0x161)]||_0x58ee81['id'])+'`\x0a')+(_0x1f2398(0x1d8)+_0x58ee81['id']+'`\x0a')+('ðŸª\x20Gateway:\x20`'+_0x1075dd+'`\x0a')+(_0x1f2398(0x222)+new Date(_0x58ee81['createdAt'])[_0x1f2398(0x258)](_0x1f2398(0x1f3))+'\x0a');if(_0x58ee81[_0x1f2398(0x208)]||_0x58ee81[_0x1f2398(0x17d)]||_0x58ee81[_0x1f2398(0x14e)]||_0x58ee81[_0x1f2398(0x28b)]||_0x58ee81[_0x1f2398(0x129)]){_0x4bf4df+='\x0aðŸ‘¤\x20*Customer\x20Information:*\x0a';_0x58ee81[_0x1f2398(0x208)]&&(_0x4bf4df+=_0x1f2398(0x148)+_0x58ee81['customerName']+'`\x0a');_0x58ee81['customerEmail']&&(_0x4bf4df+='ðŸ“§\x20Email:\x20`'+_0x58ee81[_0x1f2398(0x17d)]+'`\x0a');_0x58ee81[_0x1f2398(0x14e)]&&(_0x4bf4df+=_0x1f2398(0x12f)+_0x58ee81[_0x1f2398(0x14e)]+'`\x0a');_0x58ee81[_0x1f2398(0x28b)]&&(_0x4bf4df+=_0x1f2398(0x2a9)+_0x58ee81[_0x1f2398(0x28b)]+'`\x0a');if(_0x58ee81[_0x1f2398(0x129)]){const _0x2f1694=_0x58ee81['customerUa']['length']>0x32?_0x58ee81[_0x1f2398(0x129)][_0x1f2398(0x168)](0x0,0x32)+_0x1f2398(0x16f):_0x58ee81['customerUa'];_0x4bf4df+=_0x1f2398(0x2b6)+_0x2f1694+'`\x0a';}}_0x219b65===_0x1f2398(0x293)&&_0x58ee81[_0x1f2398(0x26e)]&&(_0x4bf4df+=_0x1f2398(0x2bb)+_0x58ee81['chargebackAmount']+_0x1f2398(0x1f9)),_0x219b65==='processing'&&(_0x4bf4df+=_0x1f2398(0x143)),_0x58ee81[_0x1f2398(0x1ae)]&&(_0x4bf4df+='ðŸ“\x20Notes:\x20'+_0x58ee81[_0x1f2398(0x1ae)]+'\x0a'),await this[_0x1f2398(0x252)](_0x10daad,_0x4bf4df,{'parse_mode':_0x1f2398(0x16b)});}async[a87_0x2d64c1(0x1ca)](_0x22897d,_0x1f43c2){const _0x57db49=a87_0x2d64c1,_0xd071a4=new Date(_0x1f43c2[_0x57db49(0x15e)])[_0x57db49(0x258)](_0x57db49(0x1f3),{'year':_0x57db49(0x1ad),'month':_0x57db49(0x262),'day':_0x57db49(0x262),'hour':_0x57db49(0x262),'minute':_0x57db49(0x262),'second':_0x57db49(0x262)}),_0x2da2c7=_0x57db49(0x285)+(_0x57db49(0x2a8)+_0xd071a4+'\x0a')+(_0x57db49(0x29a)+_0x1f43c2[_0x57db49(0x1c3)]+_0x57db49(0x1a1))+(_0x57db49(0x1ba)+(_0x1f43c2[_0x57db49(0x19f)]||_0x57db49(0x28e))+'\x0a')+(_0x57db49(0x278)+(_0x1f43c2['network']||_0x57db49(0x28e))+'\x0a')+(_0x57db49(0x204)+(_0x1f43c2[_0x57db49(0x176)]||_0x57db49(0x28e))+'`\x0a')+(_0x1f43c2['txid']?'ðŸ”—\x20*Transaction\x20Link:*\x20`'+_0x1f43c2[_0x57db49(0x2a7)]+'`':'ðŸ”—\x20*Transaction\x20Link:*\x20Pending');await this[_0x57db49(0x252)](_0x22897d,_0x2da2c7,{'parse_mode':_0x57db49(0x16b)});}async[a87_0x2d64c1(0x1ce)](_0x1f696f,_0x1d9597){const _0xc3005a=a87_0x2d64c1;try{const _0x179e79=await database_1[_0xc3005a(0x26c)]['shopSettings']['findUnique']({'where':{'shopId':_0x1f696f},'select':{'notificationLogin':!![]}});if(!_0x179e79?.['notificationLogin']){console['log'](_0xc3005a(0x270)+_0x1f696f);return;}const _0x59b62b=_0x1d9597[_0xc3005a(0x2b1)]?'ðŸ”':'ðŸš¨',_0x67ddf9=_0x1d9597[_0xc3005a(0x2b1)]?_0xc3005a(0x225):'Failed\x20login\x20attempt';let _0x29dfe7=_0x59b62b+'\x20*'+_0x67ddf9+'*\x0a\x0a'+(_0xc3005a(0x22e)+_0x1d9597['username']+'`\x0a')+(_0xc3005a(0x1f0)+_0x1d9597['timestamp'][_0xc3005a(0x258)](_0xc3005a(0x1f3))+'\x0a');_0x1d9597[_0xc3005a(0x1f8)]&&(_0x29dfe7+=_0xc3005a(0x141)+_0x1d9597['ipAddress']+'`\x0a');_0x1d9597[_0xc3005a(0x18d)]&&(_0x29dfe7+='ðŸŒ\x20Country:\x20'+_0x1d9597[_0xc3005a(0x18d)]+'\x0a');if(_0x1d9597['userAgent']){const _0x165bff=_0x1d9597['userAgent'][_0xc3005a(0x1e1)]>0x32?_0x1d9597['userAgent'][_0xc3005a(0x168)](0x0,0x32)+_0xc3005a(0x16f):_0x1d9597['userAgent'];_0x29dfe7+=_0xc3005a(0x2b6)+_0x165bff+'`\x0a';}!_0x1d9597[_0xc3005a(0x2b1)]&&(_0x29dfe7+='\x0aâš ï¸\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!'),await this[_0xc3005a(0x252)](_0x1f696f,_0x29dfe7,{'parse_mode':_0xc3005a(0x16b)}),console['log']('âœ…\x20Login\x20notification\x20sent\x20for\x20shop\x20'+_0x1f696f+':\x20'+(_0x1d9597[_0xc3005a(0x2b1)]?_0xc3005a(0x2b1):_0xc3005a(0x174)));}catch(_0x235cae){console[_0xc3005a(0x211)](_0xc3005a(0x214),_0x235cae);}}async[a87_0x2d64c1(0x25c)](_0x28b930,_0x301561){const _0x409bd3=a87_0x2d64c1;try{const _0x57713b=await database_1[_0x409bd3(0x26c)]['shopSettings']['findUnique']({'where':{'shopId':_0x28b930},'select':{'notificationApiError':!![]}});if(!_0x57713b?.['notificationApiError']){console[_0x409bd3(0x29d)](_0x409bd3(0x196)+_0x28b930);return;}let _0x2c747f=_0x409bd3(0x242)+(_0x409bd3(0x1d1)+_0x301561[_0x409bd3(0x1c5)]+'\x20'+_0x301561[_0x409bd3(0x2ae)]+'`\x0a')+(_0x409bd3(0x1f0)+_0x301561[_0x409bd3(0x26a)][_0x409bd3(0x258)](_0x409bd3(0x1f3))+'\x0a');_0x301561[_0x409bd3(0x21f)]&&(_0x2c747f+='ðŸ“Š\x20Error\x20code:\x20`'+_0x301561[_0x409bd3(0x21f)]+'`\x0a'),_0x2c747f+=_0x409bd3(0x29b)+_0x301561['errorMessage']+'`\x0a',_0x301561[_0x409bd3(0x191)]&&(_0x2c747f+=_0x409bd3(0x2b0)+_0x301561[_0x409bd3(0x191)]+'`\x0a'),_0x2c747f+='\x0aðŸ’¡\x20Check\x20your\x20request\x20or\x20contact\x20support.',await this['sendShopNotification'](_0x28b930,_0x2c747f,{'parse_mode':_0x409bd3(0x16b)}),console['log']('âœ…\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20'+_0x28b930+':\x20'+_0x301561[_0x409bd3(0x2ae)]);}catch(_0x457f5e){console[_0x409bd3(0x211)]('Failed\x20to\x20send\x20API\x20error\x20notification:',_0x457f5e);}}async[a87_0x2d64c1(0x21d)](_0x2c080b,_0x5553e6,_0x362fcf){const _0x233b9f=a87_0x2d64c1;let _0x10f1f6=_0x233b9f(0x184)+_0x5553e6+_0x233b9f(0x158);for(const [_0x128c8d,_0x1606f6]of Object[_0x233b9f(0x1e5)](_0x362fcf)){_0x1606f6!==null&&_0x1606f6!==undefined&&(_0x10f1f6+=_0x128c8d+_0x233b9f(0x2b9)+_0x1606f6+'`\x0a');}await this[_0x233b9f(0x252)](_0x2c080b,_0x10f1f6,{'parse_mode':'Markdown'});}async['sendNotificationToAll'](_0x293b03){const _0x2eaa68=a87_0x2d64c1;try{console['log'](_0x2eaa68(0x20d)+_0x293b03[_0x2eaa68(0x168)](0x0,0x32)+'...');const _0x57ba48=await database_1[_0x2eaa68(0x26c)][_0x2eaa68(0x2a4)][_0x2eaa68(0x1b8)]({'select':{'telegramId':!![]}});if(_0x57ba48[_0x2eaa68(0x1e1)]===0x0){console[_0x2eaa68(0x29d)](_0x2eaa68(0x181));return;}for(const _0x3ddb01 of _0x57ba48){try{await this[_0x2eaa68(0x217)]?.[_0x2eaa68(0x159)](_0x3ddb01['telegramId'],_0x293b03,{'parse_mode':_0x2eaa68(0x16b)});}catch(_0x239290){console[_0x2eaa68(0x211)](_0x2eaa68(0x17b)+_0x3ddb01[_0x2eaa68(0x1ff)]+':',_0x239290);}}console[_0x2eaa68(0x29d)](_0x2eaa68(0x1b9)+_0x57ba48[_0x2eaa68(0x1e1)]+_0x2eaa68(0x170));}catch(_0x3ae211){console[_0x2eaa68(0x211)]('âŒ\x20Failed\x20to\x20send\x20notification\x20to\x20all\x20users:',_0x3ae211);}}[a87_0x2d64c1(0x185)](){const _0x2dfb59=a87_0x2d64c1;return{'isActive':!!this[_0x2dfb59(0x217)],'username':this[_0x2dfb59(0x26d)]};}async['sendShopFile'](_0xe153b7,_0x6982e4,_0xdd76d6,_0xf6d70f){const _0x17a17d=a87_0x2d64c1;try{if(!this[_0x17a17d(0x217)])return console[_0x17a17d(0x211)](_0x17a17d(0x182)),![];const _0x304d4a=await database_1[_0x17a17d(0x26c)]['telegramUser'][_0x17a17d(0x1b8)]({'where':{'shopId':_0xe153b7,'isVerified':!![]},'select':{'telegramId':!![]}});if(_0x304d4a[_0x17a17d(0x1e1)]===0x0)return console['error'](_0x17a17d(0x27a)+_0xe153b7),![];let _0x26c5a5=0x0;for(const _0x1a3c57 of _0x304d4a){try{await this['bot']['sendDocument'](_0x1a3c57[_0x17a17d(0x1ff)],_0x6982e4,{},{'filename':_0xdd76d6,'contentType':_0xdd76d6['endsWith'](_0x17a17d(0x228))?_0x17a17d(0x294):_0xdd76d6['endsWith']('.jpg')||_0xdd76d6['endsWith'](_0x17a17d(0x268))?'image/jpeg':_0xdd76d6[_0x17a17d(0x17c)]('.pdf')?'application/pdf':_0x17a17d(0x134)}),_0xf6d70f&&await this[_0x17a17d(0x217)]['sendMessage'](_0x1a3c57['telegramId'],_0xf6d70f),_0x26c5a5++;}catch(_0x1ad298){console[_0x17a17d(0x211)](_0x17a17d(0x296)+_0x1a3c57['telegramId']+':',_0x1ad298);}}return console['log'](_0x17a17d(0x238)+_0x26c5a5+'/'+_0x304d4a[_0x17a17d(0x1e1)]+_0x17a17d(0x22c)+_0xe153b7+':\x20'+_0xdd76d6),_0x26c5a5>0x0;}catch(_0x5680e3){return console[_0x17a17d(0x211)]('âŒ\x20Error\x20sending\x20file\x20to\x20shop:',_0x5680e3),![];}}async[a87_0x2d64c1(0x145)](_0x4251bc,_0x399a0c){const _0x532cc3=a87_0x2d64c1;try{if(!this['bot'])return console[_0x532cc3(0x211)]('âŒ\x20Telegram\x20bot\x20not\x20initialized'),![];return await this['bot'][_0x532cc3(0x159)](_0x4251bc,_0x399a0c),console[_0x532cc3(0x29d)]('âœ…\x20Direct\x20message\x20sent\x20to\x20chat\x20'+_0x4251bc),!![];}catch(_0x2e16c8){return console[_0x532cc3(0x211)]('âŒ\x20Error\x20sending\x20direct\x20message:',_0x2e16c8),![];}}async[a87_0x2d64c1(0x1b5)](_0x146dbb,_0x409fd9,_0x4e44d5,_0x959d25){const _0x5ce095=a87_0x2d64c1;try{if(!this[_0x5ce095(0x217)])return console['error'](_0x5ce095(0x182)),![];return await this[_0x5ce095(0x217)][_0x5ce095(0x28a)](_0x146dbb,_0x409fd9,{},{'filename':_0x4e44d5,'contentType':_0x4e44d5[_0x5ce095(0x17c)](_0x5ce095(0x228))?'image/png':_0x4e44d5[_0x5ce095(0x17c)](_0x5ce095(0x279))||_0x4e44d5[_0x5ce095(0x17c)](_0x5ce095(0x268))?_0x5ce095(0x160):_0x4e44d5[_0x5ce095(0x17c)](_0x5ce095(0x203))?_0x5ce095(0x207):_0x5ce095(0x134)}),_0x959d25&&await this['bot']['sendMessage'](_0x146dbb,_0x959d25),console[_0x5ce095(0x29d)]('âœ…\x20File\x20sent\x20to\x20chat\x20'+_0x146dbb+':\x20'+_0x4e44d5),!![];}catch(_0xe1d33e){return console[_0x5ce095(0x211)](_0x5ce095(0x281),_0xe1d33e),![];}}async[a87_0x2d64c1(0x29e)](_0xeb329e,_0x9ceda6,_0x1bc852,_0x285df){const _0x163fe9=a87_0x2d64c1,_0xff8dcf=this['paymentLinkSessions'][_0x163fe9(0x19e)](_0x9ceda6)||{};try{if(_0x1bc852===_0x163fe9(0x197)){this['paymentLinkSessions'][_0x163fe9(0x14b)](_0x9ceda6),await this[_0x163fe9(0x217)]?.[_0x163fe9(0x137)](_0x163fe9(0x215),{'chat_id':_0xeb329e,'message_id':_0x285df});return;}if(_0x1bc852===_0x163fe9(0x1d9)){await this[_0x163fe9(0x2ac)](_0xeb329e,_0x9ceda6,_0x285df,0x1);return;}if(_0x1bc852[_0x163fe9(0x1f7)](_0x163fe9(0x1f2))){const _0x30ebd9=parseInt(_0x1bc852[_0x163fe9(0x1a7)]('pl_page_',''));await this[_0x163fe9(0x2ac)](_0xeb329e,_0x9ceda6,_0x285df,_0x30ebd9);return;}if(_0x1bc852==='pl_create_new'){const _0x24bf6d=await database_1[_0x163fe9(0x26c)][_0x163fe9(0x2a4)][_0x163fe9(0x154)]({'where':{'telegramId':_0x9ceda6},'include':{'shop':!![]}});if(!_0x24bf6d?.['shop']?.[_0x163fe9(0x244)]){await this['bot']?.[_0x163fe9(0x137)](_0x163fe9(0x1e8),{'chat_id':_0xeb329e,'message_id':_0x285df});return;}let _0x2d58f3;try{_0x2d58f3=JSON[_0x163fe9(0x144)](_0x24bf6d['shop'][_0x163fe9(0x244)]);}catch{_0x2d58f3=_0x24bf6d['shop'][_0x163fe9(0x244)][_0x163fe9(0x13d)](',')[_0x163fe9(0x20e)](_0x4d0179=>_0x4d0179[_0x163fe9(0x2ba)]());}if(_0x2d58f3[_0x163fe9(0x1e1)]===0x0){await this[_0x163fe9(0x217)]?.['editMessageText'](_0x163fe9(0x28c),{'chat_id':_0xeb329e,'message_id':_0x285df});return;}this[_0x163fe9(0x16d)]['set'](_0x9ceda6,{'step':_0x163fe9(0x180)});const _0x4abf15=_0x2d58f3[_0x163fe9(0x291)](_0x55bbc6=>{const _0xd18d4b=_0x163fe9,_0x2c5946=Object['keys'](gateway_1[_0xd18d4b(0x1fa)])['find'](_0x182854=>gateway_1[_0xd18d4b(0x1fa)][_0x182854]===_0x55bbc6)||_0x55bbc6;return[{'text':_0xd18d4b(0x233)+_0x2c5946,'callback_data':_0xd18d4b(0x1a9)+_0x2c5946}];});await this[_0x163fe9(0x217)]?.[_0x163fe9(0x137)](_0x163fe9(0x16e),{'chat_id':_0xeb329e,'message_id':_0x285df,'parse_mode':'Markdown','reply_markup':{'inline_keyboard':[..._0x4abf15,[{'text':_0x163fe9(0x26b),'callback_data':_0x163fe9(0x197)}]]}});return;}if(_0x1bc852[_0x163fe9(0x1f7)]('pl_gw_')){const _0x25c590=_0x1bc852[_0x163fe9(0x1a7)]('pl_gw_','');_0xff8dcf[_0x163fe9(0x180)]=_0x25c590,_0xff8dcf[_0x163fe9(0x1a8)]=_0x163fe9(0x253),this[_0x163fe9(0x16d)][_0x163fe9(0x18f)](_0x9ceda6,_0xff8dcf),await this[_0x163fe9(0x217)]?.[_0x163fe9(0x137)]('ðŸ”—\x20*Create\x20Payment\x20Link*\x0a\x0a'+_0x163fe9(0x1d0),{'chat_id':_0xeb329e,'message_id':_0x285df,'parse_mode':_0x163fe9(0x16b),'reply_markup':{'inline_keyboard':[[{'text':_0x163fe9(0x2a2),'callback_data':'pl_type_single'}],[{'text':_0x163fe9(0x280),'callback_data':_0x163fe9(0x1de)}],[{'text':_0x163fe9(0x26b),'callback_data':_0x163fe9(0x197)}]]}});return;}if(_0x1bc852[_0x163fe9(0x1f7)]('pl_type_')){const _0x8bddf1=_0x1bc852[_0x163fe9(0x1a7)]('pl_type_','')[_0x163fe9(0x12b)]();_0xff8dcf[_0x163fe9(0x253)]=_0x8bddf1,_0xff8dcf['step']='currency',this[_0x163fe9(0x16d)]['set'](_0x9ceda6,_0xff8dcf);const _0x5c6473=this[_0x163fe9(0x1e2)](_0xff8dcf[_0x163fe9(0x180)]),_0x3f1a9d=_0x5c6473[_0x163fe9(0x24c)](0x0,0x14)['map'](_0x18d547=>[{'text':_0x18d547,'callback_data':'pl_curr_'+_0x18d547}]);await this[_0x163fe9(0x217)]?.[_0x163fe9(0x137)](_0x163fe9(0x290)+_0x163fe9(0x153),{'chat_id':_0xeb329e,'message_id':_0x285df,'parse_mode':'Markdown','reply_markup':{'inline_keyboard':[..._0x3f1a9d,[{'text':_0x163fe9(0x26b),'callback_data':_0x163fe9(0x197)}]]}});return;}if(_0x1bc852[_0x163fe9(0x1f7)]('pl_curr_')){const _0x2e9324=_0x1bc852[_0x163fe9(0x1a7)](_0x163fe9(0x130),'');_0xff8dcf['currency']=_0x2e9324,_0xff8dcf['step']='amount',this[_0x163fe9(0x16d)][_0x163fe9(0x18f)](_0x9ceda6,_0xff8dcf),await this[_0x163fe9(0x217)]?.[_0x163fe9(0x137)](_0x163fe9(0x290)+_0x163fe9(0x1dc)+(_0x163fe9(0x15c)+_0x2e9324+_0x163fe9(0x1fb)),{'chat_id':_0xeb329e,'message_id':_0x285df,'parse_mode':'Markdown'});return;}}catch(_0x1e66d3){console[_0x163fe9(0x211)](_0x163fe9(0x1ee),_0x1e66d3),await this[_0x163fe9(0x217)]?.[_0x163fe9(0x159)](_0xeb329e,_0x163fe9(0x1b4)),this[_0x163fe9(0x16d)][_0x163fe9(0x14b)](_0x9ceda6);}}async[a87_0x2d64c1(0x2ac)](_0x31e3fa,_0x3882fa,_0x3f3520,_0x2ca1c2=0x1){const _0x4dd692=a87_0x2d64c1;try{const _0x5c6049=await database_1[_0x4dd692(0x26c)][_0x4dd692(0x2a4)][_0x4dd692(0x154)]({'where':{'telegramId':_0x3882fa},'include':{'shop':!![]}});if(!_0x5c6049?.[_0x4dd692(0x251)]){await this['bot']?.[_0x4dd692(0x159)](_0x31e3fa,_0x4dd692(0x25f));return;}const _0x45a2c9=0x5,_0x17c86d=(_0x2ca1c2-0x1)*_0x45a2c9,[_0x2f2d7f,_0x154dee]=await Promise[_0x4dd692(0x25b)]([database_1[_0x4dd692(0x26c)][_0x4dd692(0x22b)]['findMany']({'where':{'shopId':_0x5c6049[_0x4dd692(0x251)]},'orderBy':{'createdAt':_0x4dd692(0x2af)},'take':_0x45a2c9,'skip':_0x17c86d}),database_1['default']['paymentLink'][_0x4dd692(0x24a)]({'where':{'shopId':_0x5c6049[_0x4dd692(0x251)]}})]),_0x116dd2=Math[_0x4dd692(0x1d4)](_0x154dee/_0x45a2c9);if(_0x2f2d7f[_0x4dd692(0x1e1)]===0x0){const _0xf09115='ðŸ“‹\x20*Payment\x20Links*\x0a\x0aNo\x20payment\x20links\x20found\x5c.\x0a\x0aCreate\x20your\x20first\x20payment\x20link\x5c!';_0x3f3520?await this[_0x4dd692(0x217)]?.[_0x4dd692(0x137)](_0xf09115,{'chat_id':_0x31e3fa,'message_id':_0x3f3520,'parse_mode':_0x4dd692(0x276),'reply_markup':{'inline_keyboard':[[{'text':'âž•\x20Create\x20New\x20Link','callback_data':_0x4dd692(0x209)}]]}}):await this[_0x4dd692(0x217)]?.['sendMessage'](_0x31e3fa,_0xf09115,{'parse_mode':_0x4dd692(0x276),'reply_markup':{'inline_keyboard':[[{'text':_0x4dd692(0x245),'callback_data':_0x4dd692(0x209)}]]}});return;}let _0x5e30b2=_0x4dd692(0x23c)+_0x2ca1c2+'/'+_0x116dd2+_0x4dd692(0x273);_0x2f2d7f[_0x4dd692(0x21c)]((_0x4d779e,_0x59f24b)=>{const _0x506bc2=_0x4dd692,_0x32a94d=_0x17c86d+_0x59f24b+0x1,_0xe658b6=_0x4d779e[_0x506bc2(0x1c3)]?_0x4d779e[_0x506bc2(0x1c3)]+'\x20'+_0x4d779e[_0x506bc2(0x21b)]:_0x506bc2(0x175),_0x23263b=_0x4d779e['status']===_0x506bc2(0x274)?'âœ…':'âŒ',_0x25922d=(process.env.FRONTEND_URL||'https://app.trapay.uk')+'/link/'+_0x4d779e['id'],_0x249fa1=_0x25922d[_0x506bc2(0x1a7)](/\./g,'\x5c.')[_0x506bc2(0x1a7)](/-/g,'\x5c-')[_0x506bc2(0x1a7)](/\//g,'\x5c/');_0x5e30b2+=_0x32a94d+_0x506bc2(0x18c)+_0x23263b+'\x20*'+_0xe658b6+'*\x0a',_0x5e30b2+=_0x506bc2(0x22f)+_0x4d779e[_0x506bc2(0x180)]+_0x506bc2(0x12c)+_0x4d779e[_0x506bc2(0x253)]+'\x0a',_0x5e30b2+='\x20\x20\x20[LINK]('+_0x249fa1+_0x506bc2(0x1c0);});const _0xd1c4c2=[];_0x2ca1c2>0x1&&_0xd1c4c2[_0x4dd692(0x151)]({'text':'â¬…ï¸\x20Previous','callback_data':'pl_page_'+(_0x2ca1c2-0x1)});_0x2ca1c2<_0x116dd2&&_0xd1c4c2[_0x4dd692(0x151)]({'text':_0x4dd692(0x17a),'callback_data':'pl_page_'+(_0x2ca1c2+0x1)});const _0x3dabf4=[];_0xd1c4c2[_0x4dd692(0x1e1)]>0x0&&_0x3dabf4['push'](_0xd1c4c2),_0x3dabf4[_0x4dd692(0x151)]([{'text':'âž•\x20Create\x20New\x20Link','callback_data':_0x4dd692(0x209)}]),_0x3dabf4[_0x4dd692(0x151)]([{'text':'âŒ\x20Close','callback_data':_0x4dd692(0x197)}]),_0x3f3520?await this[_0x4dd692(0x217)]?.[_0x4dd692(0x137)](_0x5e30b2,{'chat_id':_0x31e3fa,'message_id':_0x3f3520,'parse_mode':_0x4dd692(0x276),'reply_markup':{'inline_keyboard':_0x3dabf4}}):await this[_0x4dd692(0x217)]?.[_0x4dd692(0x159)](_0x31e3fa,_0x5e30b2,{'parse_mode':'MarkdownV2','reply_markup':{'inline_keyboard':_0x3dabf4}});}catch(_0x5fad61){console['error'](_0x4dd692(0x1cc),_0x5fad61),await this[_0x4dd692(0x217)]?.[_0x4dd692(0x159)](_0x31e3fa,'âŒ\x20An\x20error\x20occurred\x20while\x20loading\x20payment\x20links.');}}['getGatewayCurrencies'](_0x3df088){const _0x5479d8=a87_0x2d64c1,_0x51f436={'1000':[_0x5479d8(0x178),_0x5479d8(0x13c),'USD'],'0001':[_0x5479d8(0x2aa),_0x5479d8(0x178),_0x5479d8(0x13c),_0x5479d8(0x248),'AUD'],'0010':[_0x5479d8(0x2aa),_0x5479d8(0x178),'GBP',_0x5479d8(0x248),'AUD'],'1111':[_0x5479d8(0x178)],'0000':['EUR','USD',_0x5479d8(0x1a3),_0x5479d8(0x248),_0x5479d8(0x13c),_0x5479d8(0x2b2),_0x5479d8(0x23d)],'1110':['EUR',_0x5479d8(0x2aa),_0x5479d8(0x13c)],'2000':['EUR'],'2001':['EUR'],'2010':[_0x5479d8(0x178)],'2011':[_0x5479d8(0x248)],'2002':['TRY'],'3000':[_0x5479d8(0x28f),_0x5479d8(0x14a),'EUR',_0x5479d8(0x2aa),'AUD',_0x5479d8(0x198),_0x5479d8(0x1e9),_0x5479d8(0x248),_0x5479d8(0x13c),_0x5479d8(0x1b1),_0x5479d8(0x241)],'3001':[_0x5479d8(0x2aa),_0x5479d8(0x178)],'3002':[_0x5479d8(0x178),_0x5479d8(0x2aa),'AED',_0x5479d8(0x13c),_0x5479d8(0x1a3),_0x5479d8(0x248),_0x5479d8(0x216),_0x5479d8(0x23d)],'3004':[_0x5479d8(0x21a),_0x5479d8(0x299),_0x5479d8(0x27d),_0x5479d8(0x2b4),_0x5479d8(0x13e),_0x5479d8(0x24f),'POL','LTC','SOL',_0x5479d8(0x275)]};return _0x51f436[_0x3df088]||[_0x5479d8(0x2aa)];}['stopBot'](){const _0x8511f4=a87_0x2d64c1;this[_0x8511f4(0x217)]&&(this[_0x8511f4(0x217)][_0x8511f4(0x20c)](),this['bot']=null,console['log'](_0x8511f4(0x1b2)));}}exports[a87_0x2d64c1(0x240)]=TelegramBotService,exports['telegramBotService']=new TelegramBotService();