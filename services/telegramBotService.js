'use strict';const a53_0x5c6e97=a53_0x3be7;(function(_0x4f8eca,_0xc01f47){const _0xecefe8=a53_0x3be7,_0x49d5c5=_0x4f8eca();while(!![]){try{const _0x4eec36=-parseInt(_0xecefe8(0x285))/0x1+-parseInt(_0xecefe8(0x1c6))/0x2*(-parseInt(_0xecefe8(0x220))/0x3)+parseInt(_0xecefe8(0x1f5))/0x4*(parseInt(_0xecefe8(0x241))/0x5)+parseInt(_0xecefe8(0x200))/0x6+parseInt(_0xecefe8(0x202))/0x7*(-parseInt(_0xecefe8(0x288))/0x8)+-parseInt(_0xecefe8(0x24f))/0x9*(parseInt(_0xecefe8(0x22a))/0xa)+-parseInt(_0xecefe8(0x1d8))/0xb*(-parseInt(_0xecefe8(0x1d3))/0xc);if(_0x4eec36===_0xc01f47)break;else _0x49d5c5['push'](_0x49d5c5['shift']());}catch(_0x4d32aa){_0x49d5c5['push'](_0x49d5c5['shift']());}}}(a53_0x195d,0x36bbf));var __importDefault=this&&this[a53_0x5c6e97(0x262)]||function(_0x6789b0){const _0x4e3dfd=a53_0x5c6e97;return _0x6789b0&&_0x6789b0[_0x4e3dfd(0x233)]?_0x6789b0:{'default':_0x6789b0};};Object[a53_0x5c6e97(0x1f4)](exports,'__esModule',{'value':!![]}),exports[a53_0x5c6e97(0x1f2)]=exports[a53_0x5c6e97(0x24a)]=void 0x0;function a53_0x3be7(_0x547238,_0x1c12f6){const _0x195da1=a53_0x195d();return a53_0x3be7=function(_0x3be7a3,_0x1a19fe){_0x3be7a3=_0x3be7a3-0x1ac;let _0x31f38c=_0x195da1[_0x3be7a3];return _0x31f38c;},a53_0x3be7(_0x547238,_0x1c12f6);}const node_telegram_bot_api_1=__importDefault(require(a53_0x5c6e97(0x212))),database_1=__importDefault(require(a53_0x5c6e97(0x249))),gateway_1=require('../types/gateway');class TelegramBotService{constructor(){const _0x39448c=a53_0x5c6e97;this['bot']=null,this[_0x39448c(0x261)]=process[_0x39448c(0x276)]['TELEGRAM_BOT_TOKEN']||'',this[_0x39448c(0x25c)]=process[_0x39448c(0x276)][_0x39448c(0x1ce)]||_0x39448c(0x231),this[_0x39448c(0x261)]?this['initializeBot']():console['warn'](_0x39448c(0x21d));}[a53_0x5c6e97(0x1d6)](){const _0x5f1850=a53_0x5c6e97;try{this[_0x5f1850(0x1bd)]=new node_telegram_bot_api_1['default'](this['botToken'],{'polling':!![]}),this[_0x5f1850(0x21b)](),console[_0x5f1850(0x21f)](_0x5f1850(0x1b9)+this['botUsername']+'\x20initialized\x20successfully');}catch(_0x52d9e2){console[_0x5f1850(0x24b)](_0x5f1850(0x24e),_0x52d9e2);}}[a53_0x5c6e97(0x21b)](){const _0x29bc4b=a53_0x5c6e97;if(!this[_0x29bc4b(0x1bd)])return;this['bot'][_0x29bc4b(0x1e1)](/\/start/,async _0x43af32=>{const _0x176b27=_0x29bc4b,_0x35bab6=_0x43af32[_0x176b27(0x20f)]['id'],_0x516e91=_0x43af32[_0x176b27(0x20d)]?.['id'][_0x176b27(0x1b4)](),_0x48d82f=_0x43af32[_0x176b27(0x20d)]?.[_0x176b27(0x1cf)],_0x10e04b=_0x43af32[_0x176b27(0x20d)]?.[_0x176b27(0x21c)],_0x2fcf9f=_0x43af32[_0x176b27(0x20d)]?.['last_name'];if(!_0x516e91)return;try{let _0x19fb5a=await database_1[_0x176b27(0x1d9)][_0x176b27(0x21e)][_0x176b27(0x1ee)]({'where':{'telegramId':_0x516e91},'include':{'shop':!![]}});!_0x19fb5a?(_0x19fb5a=await database_1['default'][_0x176b27(0x21e)][_0x176b27(0x247)]({'data':{'telegramId':_0x516e91,'username':_0x48d82f,'firstName':_0x10e04b,'lastName':_0x2fcf9f,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console['log'](_0x176b27(0x238)+_0x516e91+_0x176b27(0x260)+_0x48d82f+')')):_0x19fb5a=await database_1['default']['telegramUser'][_0x176b27(0x201)]({'where':{'telegramId':_0x516e91},'data':{'username':_0x48d82f,'firstName':_0x10e04b,'lastName':_0x2fcf9f},'include':{'shop':!![]}}),_0x19fb5a[_0x176b27(0x1cb)]&&_0x19fb5a[_0x176b27(0x1f1)]&&_0x19fb5a[_0x176b27(0x258)]?await this[_0x176b27(0x1bd)]?.[_0x176b27(0x235)](_0x35bab6,_0x176b27(0x244)+(_0x176b27(0x24d)+_0x19fb5a[_0x176b27(0x258)][_0x176b27(0x1db)]+'*\x0a')+(_0x176b27(0x252)+_0x19fb5a[_0x176b27(0x258)][_0x176b27(0x1cf)]+'`\x0a\x0a')+_0x176b27(0x26e)+_0x176b27(0x203)+'•\x20Payment\x20status\x20changes\x0a'+'•\x20Payouts\x0a\x0a'+_0x176b27(0x243)+_0x176b27(0x1ed)+_0x176b27(0x1ae),{'parse_mode':_0x176b27(0x211)}):(_0x19fb5a[_0x176b27(0x1f1)]&&!_0x19fb5a[_0x176b27(0x1cb)]&&(await database_1[_0x176b27(0x1d9)][_0x176b27(0x21e)][_0x176b27(0x201)]({'where':{'telegramId':_0x516e91},'data':{'shopId':null,'isVerified':![]}}),console['log'](_0x176b27(0x1e9)+_0x516e91)),await this['bot']?.[_0x176b27(0x235)](_0x35bab6,_0x176b27(0x1c1)+_0x176b27(0x263)+_0x176b27(0x216)+'Example:\x0a'+_0x176b27(0x1dd)+_0x176b27(0x23f),{'parse_mode':_0x176b27(0x211)}));}catch(_0x494bfd){console['error'](_0x176b27(0x217),_0x494bfd),await this[_0x176b27(0x1bd)]?.[_0x176b27(0x235)](_0x35bab6,_0x176b27(0x1d7));}}),this[_0x29bc4b(0x1bd)][_0x29bc4b(0x1e1)](/\/disconnect/,async _0x5eca42=>{const _0x289b6d=_0x29bc4b,_0x1e68fa=_0x5eca42[_0x289b6d(0x20f)]['id'],_0x277927=_0x5eca42[_0x289b6d(0x20d)]?.['id']['toString']();if(!_0x277927)return;try{const _0x39f1e2=await database_1[_0x289b6d(0x1d9)]['telegramUser']['findUnique']({'where':{'telegramId':_0x277927},'include':{'shop':!![]}});if(!_0x39f1e2||!_0x39f1e2[_0x289b6d(0x1cb)]||!_0x39f1e2[_0x289b6d(0x1f1)]){await this['bot']?.['sendMessage'](_0x1e68fa,'❌\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.');return;}const _0x522e23=_0x39f1e2[_0x289b6d(0x258)]?.[_0x289b6d(0x1db)]||_0x289b6d(0x26d);await database_1[_0x289b6d(0x1d9)]['telegramUser']['update']({'where':{'telegramId':_0x277927},'data':{'shopId':null,'isVerified':![]}}),console[_0x289b6d(0x21f)](_0x289b6d(0x264)+_0x277927+_0x289b6d(0x225)+_0x39f1e2[_0x289b6d(0x1f1)]),await this[_0x289b6d(0x1bd)]?.[_0x289b6d(0x235)](_0x1e68fa,_0x289b6d(0x273)+_0x522e23+_0x289b6d(0x26a)+_0x289b6d(0x1e2),{'parse_mode':_0x289b6d(0x211)});}catch(_0x1aa658){console[_0x289b6d(0x24b)](_0x289b6d(0x21a),_0x1aa658),await this[_0x289b6d(0x1bd)]?.[_0x289b6d(0x235)](_0x1e68fa,_0x289b6d(0x1d7));}}),this['bot'][_0x29bc4b(0x1e1)](/\/status/,async _0x3d754f=>{const _0x16d9c1=_0x29bc4b,_0x342f89=_0x3d754f['chat']['id'],_0x3befba=_0x3d754f[_0x16d9c1(0x20d)]?.['id'][_0x16d9c1(0x1b4)]();if(!_0x3befba)return;try{const _0xecbe22=await database_1[_0x16d9c1(0x1d9)][_0x16d9c1(0x21e)][_0x16d9c1(0x1ee)]({'where':{'telegramId':_0x3befba},'include':{'shop':!![]}});if(!_0xecbe22){await this['bot']?.['sendMessage'](_0x342f89,_0x16d9c1(0x23b)+_0x16d9c1(0x219));return;}if(!_0xecbe22[_0x16d9c1(0x1cb)]||!_0xecbe22[_0x16d9c1(0x1f1)]||!_0xecbe22[_0x16d9c1(0x258)]){await this[_0x16d9c1(0x1bd)]?.['sendMessage'](_0x342f89,'❌\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a'+'Use\x20/start\x20to\x20connect.');return;}await this[_0x16d9c1(0x1bd)]?.[_0x16d9c1(0x235)](_0x342f89,'📊\x20*Connection\x20Status*\x0a\x0a'+(_0x16d9c1(0x236)+_0xecbe22[_0x16d9c1(0x258)][_0x16d9c1(0x1db)]+'*\x0a')+(_0x16d9c1(0x1fd)+_0xecbe22[_0x16d9c1(0x258)][_0x16d9c1(0x1cf)]+'`\x0a')+(_0x16d9c1(0x1df)+_0xecbe22[_0x16d9c1(0x20a)][_0x16d9c1(0x1fa)](_0x16d9c1(0x215))+'\x0a\x0a')+_0x16d9c1(0x237)+_0x16d9c1(0x243)+_0x16d9c1(0x1ae),{'parse_mode':'Markdown'});}catch(_0x178047){console[_0x16d9c1(0x24b)](_0x16d9c1(0x204),_0x178047),await this[_0x16d9c1(0x1bd)]?.[_0x16d9c1(0x235)](_0x342f89,'❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this['bot']['onText'](/\/debug/,async _0x29ccc9=>{const _0x5f454f=_0x29bc4b,_0x388f61=_0x29ccc9[_0x5f454f(0x20f)]['id'],_0x4ee960=_0x29ccc9[_0x5f454f(0x20d)]?.['id'][_0x5f454f(0x1b4)]();if(!_0x4ee960)return;try{const _0x4a53f8=await database_1[_0x5f454f(0x1d9)][_0x5f454f(0x258)][_0x5f454f(0x1d0)]({'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![]},'take':0xa});let _0x53db68=_0x5f454f(0x1fb);_0x53db68+=_0x5f454f(0x284)+_0x4ee960+'`\x0a\x0a',_0x53db68+=_0x5f454f(0x213),_0x4a53f8[_0x5f454f(0x226)]((_0x3b5842,_0x17a95d)=>{const _0x1579b2=_0x5f454f;_0x53db68+=_0x17a95d+0x1+_0x1579b2(0x224)+_0x3b5842[_0x1579b2(0x1db)]+'*\x0a',_0x53db68+='\x20\x20\x20Username:\x20`'+_0x3b5842['username']+'`\x0a',_0x53db68+=_0x1579b2(0x1c5)+_0x3b5842[_0x1579b2(0x1cc)]+'\x0a',_0x53db68+=_0x1579b2(0x283)+_0x3b5842[_0x1579b2(0x234)][_0x1579b2(0x27b)](0x0,0xf)+_0x1579b2(0x1b8);}),await this[_0x5f454f(0x1bd)]?.[_0x5f454f(0x235)](_0x388f61,_0x53db68,{'parse_mode':'Markdown'});}catch(_0x18eead){console[_0x5f454f(0x24b)](_0x5f454f(0x1da),_0x18eead),await this[_0x5f454f(0x1bd)]?.[_0x5f454f(0x235)](_0x388f61,_0x5f454f(0x1f3));}}),this[_0x29bc4b(0x1bd)]['on']('message',async _0x1a07fc=>{const _0x42a802=_0x29bc4b;if(_0x1a07fc[_0x42a802(0x1dc)]?.[_0x42a802(0x25b)]('/'))return;const _0x2e2c9f=_0x1a07fc[_0x42a802(0x20f)]['id'],_0x3fc4e8=_0x1a07fc[_0x42a802(0x20d)]?.['id']['toString'](),_0xb44b42=_0x1a07fc[_0x42a802(0x1dc)]?.[_0x42a802(0x246)]();if(!_0x3fc4e8||!_0xb44b42)return;try{const _0x329a02=await database_1['default']['telegramUser'][_0x42a802(0x1ee)]({'where':{'telegramId':_0x3fc4e8},'include':{'shop':!![]}});if(!_0x329a02){await this['bot']?.[_0x42a802(0x235)](_0x2e2c9f,_0x42a802(0x229));return;}if(_0x329a02[_0x42a802(0x1cb)]&&_0x329a02[_0x42a802(0x1f1)]&&_0x329a02[_0x42a802(0x258)]){await this[_0x42a802(0x1bd)]?.[_0x42a802(0x235)](_0x2e2c9f,_0x42a802(0x1e4)+_0x329a02[_0x42a802(0x258)]['name']+_0x42a802(0x26a)+'Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.',{'parse_mode':_0x42a802(0x211)});return;}const _0x52cd0f=_0xb44b42[_0x42a802(0x206)](/\s+/);if(_0x52cd0f['length']!==0x2){await this[_0x42a802(0x1bd)]?.[_0x42a802(0x235)](_0x2e2c9f,'❌\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a'+'📝\x20Format:\x20`username\x20api_key`\x0a\x0a'+_0x42a802(0x28a)+_0x42a802(0x1dd)+(_0x42a802(0x259)+_0x52cd0f[_0x42a802(0x1b5)]+_0x42a802(0x1fe)+_0x52cd0f['map'](_0x51603f=>'`'+_0x51603f+'`')[_0x42a802(0x23a)](',\x20')),{'parse_mode':_0x42a802(0x211)});return;}const [_0x469289,_0x1782e0]=_0x52cd0f;console[_0x42a802(0x21f)](_0x42a802(0x251)+_0x3fc4e8+_0x42a802(0x20e)+_0x469289+_0x42a802(0x257)+_0x1782e0['substring'](0x0,0xa)+_0x42a802(0x1b6)),await this[_0x42a802(0x239)](_0x2e2c9f,_0x3fc4e8,_0x469289,_0x1782e0);}catch(_0x5ae304){console[_0x42a802(0x24b)]('Error\x20handling\x20message:',_0x5ae304),await this['bot']?.[_0x42a802(0x235)](_0x2e2c9f,_0x42a802(0x1d7));}}),this[_0x29bc4b(0x1bd)]['on'](_0x29bc4b(0x24b),_0x2596a7=>{console['error']('Telegram\x20bot\x20error:',_0x2596a7);}),this[_0x29bc4b(0x1bd)]['on'](_0x29bc4b(0x1bc),_0x4942f9=>{const _0x5da0a1=_0x29bc4b;console['error'](_0x5da0a1(0x1e6),_0x4942f9);});}async[a53_0x5c6e97(0x239)](_0x1941df,_0x1b4f80,_0xf70357,_0x40b7f2){const _0xc9efd6=a53_0x5c6e97;try{console[_0xc9efd6(0x21f)]('🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20'+_0x1b4f80+_0xc9efd6(0x20e)+_0xf70357+_0xc9efd6(0x257)+_0x40b7f2['substring'](0x0,0xa)+'...\x22');if(!_0xf70357||_0xf70357[_0xc9efd6(0x1b5)]<0x3||_0xf70357[_0xc9efd6(0x1b5)]>0x32||!/^[a-zA-Z0-9_]+$/[_0xc9efd6(0x265)](_0xf70357)){await this[_0xc9efd6(0x1bd)]?.[_0xc9efd6(0x235)](_0x1941df,'❌\x20Invalid\x20username\x20format:\x20`'+_0xf70357+'`\x0a\x0a'+'Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).',{'parse_mode':'Markdown'});return;}if(!_0x40b7f2||!_0x40b7f2['startsWith']('pk_')&&!_0x40b7f2[_0xc9efd6(0x25b)](_0xc9efd6(0x275))){await this[_0xc9efd6(0x1bd)]?.[_0xc9efd6(0x235)](_0x1941df,'❌\x20Invalid\x20API\x20key\x20format.\x0a\x0a'+_0xc9efd6(0x1be),{'parse_mode':'Markdown'});return;}const _0x3daa6c=await database_1[_0xc9efd6(0x1d9)]['shop'][_0xc9efd6(0x1ee)]({'where':{'username':_0xf70357},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x3daa6c){const _0x3b9601=await database_1['default']['shop'][_0xc9efd6(0x1d0)]({'select':{'username':!![],'name':!![]},'take':0x5});let _0x193949='❌\x20Shop\x20with\x20username\x20`'+_0xf70357+'`\x20not\x20found.\x0a\x0a';_0x3b9601['length']>0x0?(_0x193949+=_0xc9efd6(0x232),_0x3b9601[_0xc9efd6(0x226)](_0x12e938=>{const _0xea068d=_0xc9efd6;_0x193949+='•\x20`'+_0x12e938[_0xea068d(0x1cf)]+_0xea068d(0x222)+_0x12e938[_0xea068d(0x1db)]+')\x0a';}),_0x193949+=_0xc9efd6(0x282)):_0x193949+=_0xc9efd6(0x267);await this[_0xc9efd6(0x1bd)]?.[_0xc9efd6(0x235)](_0x1941df,_0x193949,{'parse_mode':_0xc9efd6(0x211)});return;}if(_0x3daa6c[_0xc9efd6(0x1cc)]!=='ACTIVE'){await this[_0xc9efd6(0x1bd)]?.[_0xc9efd6(0x235)](_0x1941df,_0xc9efd6(0x26b)+_0xf70357+'`\x20is\x20inactive.\x0a\x0a'+_0xc9efd6(0x1b2),{'parse_mode':_0xc9efd6(0x211)});return;}if(_0x3daa6c[_0xc9efd6(0x234)]!==_0x40b7f2&&_0x3daa6c['secretKey']!==_0x40b7f2){await this[_0xc9efd6(0x1bd)]?.['sendMessage'](_0x1941df,_0xc9efd6(0x1ad)+_0xf70357+_0xc9efd6(0x26c)+_0xc9efd6(0x1c2)+_0xc9efd6(0x1d1),{'parse_mode':_0xc9efd6(0x211)});return;}const _0x8ead51=await database_1[_0xc9efd6(0x1d9)]['telegramUser']['findFirst']({'where':{'shopId':_0x3daa6c['id'],'isVerified':!![],'telegramId':{'not':_0x1b4f80}}});if(_0x8ead51){await this[_0xc9efd6(0x1bd)]?.[_0xc9efd6(0x235)](_0x1941df,_0xc9efd6(0x1ba)+_0xf70357+_0xc9efd6(0x26c)+_0xc9efd6(0x1de),{'parse_mode':_0xc9efd6(0x211)});return;}await database_1[_0xc9efd6(0x1d9)]['telegramUser'][_0xc9efd6(0x201)]({'where':{'telegramId':_0x1b4f80},'data':{'shopId':_0x3daa6c['id'],'isVerified':!![]}}),await this[_0xc9efd6(0x1bd)]?.[_0xc9efd6(0x235)](_0x1941df,_0xc9efd6(0x228)+_0xc9efd6(0x25d)+(_0xc9efd6(0x1ac)+_0x3daa6c[_0xc9efd6(0x1db)]+'*\x0a')+('👤\x20Username:\x20`'+_0x3daa6c['username']+_0xc9efd6(0x22d))+_0xc9efd6(0x269)+_0xc9efd6(0x203)+'•\x20Payment\x20status\x20changes\x0a'+_0xc9efd6(0x218)+_0xc9efd6(0x27a)+'Commands:\x0a'+'/status\x20-\x20check\x20connection\x20status\x0a'+_0xc9efd6(0x1ae),{'parse_mode':_0xc9efd6(0x211)}),console[_0xc9efd6(0x21f)](_0xc9efd6(0x1ef)+_0x1b4f80+'\x20verified\x20for\x20shop\x20'+_0x3daa6c[_0xc9efd6(0x1cf)]+_0xc9efd6(0x286));}catch(_0xbbf1da){console[_0xc9efd6(0x24b)](_0xc9efd6(0x25a),_0xbbf1da),await this['bot']?.[_0xc9efd6(0x235)](_0x1941df,_0xc9efd6(0x28d));}}async[a53_0x5c6e97(0x245)](_0x3b144f,_0x44d0ba,_0x2b1259){const _0x4f3db6=a53_0x5c6e97;if(!this[_0x4f3db6(0x1bd)]){console[_0x4f3db6(0x1ff)]('Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification');return;}try{const _0x5d46a6=await database_1[_0x4f3db6(0x1d9)][_0x4f3db6(0x21e)]['findMany']({'where':{'shopId':_0x3b144f,'isVerified':!![]}});if(_0x5d46a6[_0x4f3db6(0x1b5)]===0x0){console[_0x4f3db6(0x21f)](_0x4f3db6(0x23d)+_0x3b144f);return;}const _0x5c961c=_0x5d46a6[_0x4f3db6(0x26f)](async _0x1b253c=>{const _0x4e29cd=_0x4f3db6;try{await this[_0x4e29cd(0x1bd)]?.[_0x4e29cd(0x235)](_0x1b253c[_0x4e29cd(0x289)],_0x44d0ba,_0x2b1259),console[_0x4e29cd(0x21f)]('✅\x20Notification\x20sent\x20to\x20Telegram\x20user\x20'+_0x1b253c[_0x4e29cd(0x289)]);}catch(_0x1e3c91){console[_0x4e29cd(0x24b)](_0x4e29cd(0x1ea)+_0x1b253c['telegramId']+':',_0x1e3c91),_0x1e3c91 instanceof Error&&(_0x1e3c91['message'][_0x4e29cd(0x1d2)]('blocked')||_0x1e3c91[_0x4e29cd(0x1b7)][_0x4e29cd(0x1d2)](_0x4e29cd(0x230))||_0x1e3c91['message'][_0x4e29cd(0x1d2)](_0x4e29cd(0x1fc)))&&(await database_1[_0x4e29cd(0x1d9)][_0x4e29cd(0x21e)]['update']({'where':{'id':_0x1b253c['id']},'data':{'isVerified':![]}}),console[_0x4e29cd(0x21f)](_0x4e29cd(0x22f)+_0x1b253c[_0x4e29cd(0x289)]+_0x4e29cd(0x254)));}});await Promise[_0x4f3db6(0x227)](_0x5c961c);}catch(_0x37a9bd){console[_0x4f3db6(0x24b)](_0x4f3db6(0x266),_0x37a9bd);}}async[a53_0x5c6e97(0x28c)](_0x3d9707,_0x27dc93,_0x56406f){const _0xcf46ea=a53_0x5c6e97,_0x4a3fef={'created':'🆕','paid':'✅','failed':'❌','expired':'⏰','refund':'🔄','chargeback':'⚠️','processing':'⚙️'},_0x56762c={'created':_0xcf46ea(0x280),'paid':_0xcf46ea(0x1ca),'failed':_0xcf46ea(0x1e8),'expired':_0xcf46ea(0x27f),'refund':_0xcf46ea(0x1e3),'chargeback':_0xcf46ea(0x1ec),'processing':_0xcf46ea(0x221)},_0x20f51c=_0x4a3fef[_0x56406f],_0x5296e3=_0x56762c[_0x56406f],_0x1ab9cf=(0x0,gateway_1[_0xcf46ea(0x25f)])(_0x27dc93[_0xcf46ea(0x290)]);console[_0xcf46ea(0x21f)](_0xcf46ea(0x28b)+_0x27dc93[_0xcf46ea(0x290)]+'\x22\x20->\x20display\x20\x22'+_0x1ab9cf+'\x22');let _0x2abd00=_0x20f51c+'\x20*'+_0x5296e3+_0xcf46ea(0x1cd)+(_0xcf46ea(0x1c0)+_0x27dc93['amount']+'\x20'+_0x27dc93['currency']+'*\x0a')+(_0xcf46ea(0x1bf)+(_0x27dc93['orderId']||_0x27dc93['id'])+'`\x0a')+(_0xcf46ea(0x270)+_0x27dc93['id']+'`\x0a')+('🏪\x20Gateway:\x20`'+_0x1ab9cf+'`\x0a')+(_0xcf46ea(0x24c)+new Date(_0x27dc93[_0xcf46ea(0x250)])[_0xcf46ea(0x253)](_0xcf46ea(0x215))+'\x0a');(_0x27dc93[_0xcf46ea(0x28f)]||_0x27dc93[_0xcf46ea(0x27d)])&&(_0x2abd00+=_0xcf46ea(0x205),_0x27dc93[_0xcf46ea(0x28f)]&&(_0x2abd00+='📛\x20Name:\x20`'+_0x27dc93[_0xcf46ea(0x28f)]+'`\x0a'),_0x27dc93[_0xcf46ea(0x27d)]&&(_0x2abd00+=_0xcf46ea(0x271)+_0x27dc93[_0xcf46ea(0x27d)]+'`\x0a')),_0x56406f===_0xcf46ea(0x1d4)&&_0x27dc93[_0xcf46ea(0x28e)]&&(_0x2abd00+='💸\x20Penalty\x20amount:\x20*'+_0x27dc93['chargebackAmount']+'\x20USDT*\x0a'),_0x56406f==='processing'&&(_0x2abd00+=_0xcf46ea(0x1c4)),_0x27dc93[_0xcf46ea(0x1e0)]&&(_0x2abd00+=_0xcf46ea(0x1bb)+_0x27dc93['adminNotes']+'\x0a'),await this['sendShopNotification'](_0x3d9707,_0x2abd00,{'parse_mode':_0xcf46ea(0x211)});}async[a53_0x5c6e97(0x210)](_0x1cf19a,_0x5de3c9,_0x3ffaad){const _0x365103=a53_0x5c6e97,_0x4d624a={'created':'📤','completed':'✅','rejected':'❌'},_0x4103e0={'created':_0x365103(0x20b),'completed':_0x365103(0x22b),'rejected':_0x365103(0x1f6)},_0x3712a1=_0x4d624a[_0x3ffaad],_0x494131=_0x4103e0[_0x3ffaad],_0x290a09=_0x3712a1+'\x20*'+_0x494131+_0x365103(0x1cd)+(_0x365103(0x278)+_0x5de3c9[_0x365103(0x287)]+_0x365103(0x208))+(_0x365103(0x207)+_0x5de3c9['method']+'`\x0a')+(_0x365103(0x281)+_0x5de3c9['id']+'`\x0a')+(_0x365103(0x24c)+new Date(_0x5de3c9[_0x365103(0x250)])[_0x365103(0x253)](_0x365103(0x215))+'\x0a')+(_0x5de3c9['txid']?_0x365103(0x22c)+_0x5de3c9['txid']+'`':'');await this['sendShopNotification'](_0x1cf19a,_0x290a09,{'parse_mode':'Markdown'});}async['sendLoginNotification'](_0x584252,_0xf0296b){const _0x5eee13=a53_0x5c6e97;try{const _0x17b00c=await database_1[_0x5eee13(0x1d9)][_0x5eee13(0x1f8)][_0x5eee13(0x1ee)]({'where':{'shopId':_0x584252},'select':{'notificationLogin':!![]}});if(!_0x17b00c?.['notificationLogin']){console[_0x5eee13(0x21f)](_0x5eee13(0x1c3)+_0x584252);return;}const _0x4e0cb6=_0xf0296b['success']?'🔐':'🚨',_0x249a61=_0xf0296b[_0x5eee13(0x1c7)]?_0x5eee13(0x1b3):_0x5eee13(0x23c);let _0x4de105=_0x4e0cb6+'\x20*'+_0x249a61+_0x5eee13(0x1cd)+(_0x5eee13(0x1fd)+_0xf0296b[_0x5eee13(0x1cf)]+'`\x0a')+(_0x5eee13(0x272)+_0xf0296b[_0x5eee13(0x1b1)][_0x5eee13(0x253)](_0x5eee13(0x215))+'\x0a');_0xf0296b[_0x5eee13(0x1b0)]&&(_0x4de105+=_0x5eee13(0x274)+_0xf0296b[_0x5eee13(0x1b0)]+'`\x0a');if(_0xf0296b[_0x5eee13(0x20c)]){const _0x35433c=_0xf0296b[_0x5eee13(0x20c)][_0x5eee13(0x1b5)]>0x32?_0xf0296b[_0x5eee13(0x20c)]['substring'](0x0,0x32)+_0x5eee13(0x25e):_0xf0296b['userAgent'];_0x4de105+=_0x5eee13(0x1e5)+_0x35433c+'`\x0a';}!_0xf0296b[_0x5eee13(0x1c7)]&&(_0x4de105+=_0x5eee13(0x223)),await this[_0x5eee13(0x245)](_0x584252,_0x4de105,{'parse_mode':_0x5eee13(0x211)}),console[_0x5eee13(0x21f)](_0x5eee13(0x256)+_0x584252+':\x20'+(_0xf0296b['success']?_0x5eee13(0x1c7):'failed'));}catch(_0x521524){console[_0x5eee13(0x24b)](_0x5eee13(0x1c9),_0x521524);}}async[a53_0x5c6e97(0x255)](_0x4eb837,_0x201025){const _0x1826bb=a53_0x5c6e97;try{const _0x37fafe=await database_1['default'][_0x1826bb(0x1f8)][_0x1826bb(0x1ee)]({'where':{'shopId':_0x4eb837},'select':{'notificationApiError':!![]}});if(!_0x37fafe?.[_0x1826bb(0x27e)]){console[_0x1826bb(0x21f)](_0x1826bb(0x1f7)+_0x4eb837);return;}let _0x138e5e=_0x1826bb(0x23e)+(_0x1826bb(0x1af)+_0x201025[_0x1826bb(0x240)]+'\x20'+_0x201025[_0x1826bb(0x214)]+'`\x0a')+('📅\x20Time:\x20'+_0x201025[_0x1826bb(0x1b1)][_0x1826bb(0x253)]('en-US')+'\x0a');_0x201025[_0x1826bb(0x1e7)]&&(_0x138e5e+=_0x1826bb(0x209)+_0x201025['statusCode']+'`\x0a'),_0x138e5e+='❌\x20Error:\x20`'+_0x201025[_0x1826bb(0x242)]+'`\x0a',_0x201025[_0x1826bb(0x1c8)]&&(_0x138e5e+='🆔\x20Request\x20ID:\x20`'+_0x201025[_0x1826bb(0x1c8)]+'`\x0a'),_0x138e5e+=_0x1826bb(0x279),await this[_0x1826bb(0x245)](_0x4eb837,_0x138e5e,{'parse_mode':'Markdown'}),console['log'](_0x1826bb(0x22e)+_0x4eb837+':\x20'+_0x201025[_0x1826bb(0x214)]);}catch(_0x3b2201){console[_0x1826bb(0x24b)](_0x1826bb(0x268),_0x3b2201);}}async[a53_0x5c6e97(0x1f9)](_0x2f702d,_0x45f9e4,_0x14ca5e){const _0x2ea52a=a53_0x5c6e97;let _0x45b867=_0x2ea52a(0x1f0)+_0x45f9e4+_0x2ea52a(0x1cd);for(const [_0x3cbe65,_0x536dee]of Object[_0x2ea52a(0x248)](_0x14ca5e)){_0x536dee!==null&&_0x536dee!==undefined&&(_0x45b867+=_0x3cbe65+':\x20`'+_0x536dee+'`\x0a');}await this['sendShopNotification'](_0x2f702d,_0x45b867,{'parse_mode':_0x2ea52a(0x211)});}[a53_0x5c6e97(0x27c)](){const _0x3ea19f=a53_0x5c6e97;return{'isActive':!!this['bot'],'username':this[_0x3ea19f(0x25c)]};}[a53_0x5c6e97(0x277)](){const _0x5d318c=a53_0x5c6e97;this['bot']&&(this[_0x5d318c(0x1bd)][_0x5d318c(0x1d5)](),this[_0x5d318c(0x1bd)]=null,console[_0x5d318c(0x21f)](_0x5d318c(0x1eb)));}}exports[a53_0x5c6e97(0x24a)]=TelegramBotService,exports[a53_0x5c6e97(0x1f2)]=new TelegramBotService();function a53_0x195d(){const _0x5e4923=['trapay_bot','Available\x20usernames:\x0a','__esModule','publicKey','sendMessage','✅\x20Connected\x20to\x20shop:\x20*','🔔\x20Notifications\x20are\x20active\x0a\x0a','📱\x20Created\x20new\x20Telegram\x20user:\x20','handleSingleLineVerification','join','❌\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a','Failed\x20login\x20attempt','No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20','🚨\x20*API\x20Error*\x0a\x0a','❗️\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!','method','11320MOSvPR','errorMessage','Commands:\x0a','✅\x20Welcome\x20back!\x0a\x0a','sendShopNotification','trim','create','entries','../config/database','TelegramBotService','error','📅\x20Date:\x20','You\x20are\x20already\x20connected\x20to\x20shop:\x20*','❌\x20Failed\x20to\x20initialize\x20Telegram\x20bot:','95868zMemOY','createdAt','🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20','Username:\x20`','toLocaleString','\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure','sendApiErrorNotification','✅\x20Login\x20notification\x20sent\x20for\x20shop\x20','\x22,\x20apiKey=\x22','shop','You\x20sent\x20','Error\x20in\x20handleSingleLineVerification:','startsWith','botUsername','✅\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a','...','getGatewayDisplayNameForTelegram','\x20(@','botToken','__importDefault','To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a','🔌\x20User\x20','test','Error\x20sending\x20shop\x20notification:','Check\x20spelling\x20and\x20try\x20again.','Failed\x20to\x20send\x20API\x20error\x20notification:','🔔\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a','*.\x0a\x0a','❌\x20Shop\x20`','`.\x0a\x0a','unknown\x20shop','🔔\x20You\x20receive\x20notifications\x20about:\x0a','map','🆔\x20Payment\x20ID:\x20`','📧\x20Email:\x20`','📅\x20Time:\x20','✅\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*','🌐\x20IP\x20address:\x20`','sk_','env','stopBot','💸\x20Amount:\x20*','\x0a💡\x20Check\x20your\x20request\x20or\x20contact\x20support.','•\x20Important\x20events\x0a\x0a','substring','getBotInfo','customerEmail','notificationApiError','Payment\x20expired','New\x20payment\x20created','🆔\x20Payout\x20ID:\x20`','\x0aCheck\x20spelling\x20and\x20try\x20again.','\x20\x20\x20Public\x20Key:\x20`','📱\x20Your\x20Telegram\x20ID:\x20`','201148lSrRMX','\x20via\x20single-line\x20input','amount','79896WYjKCo','telegramId','Example:\x0a','📱\x20Telegram\x20notification:\x20gateway\x20\x22','sendPaymentNotification','❌\x20An\x20error\x20occurred\x20while\x20verifying\x20data.','chargebackAmount','customerName','gateway','📱\x20Shop:\x20*','❌\x20API\x20key\x20does\x20not\x20match\x20shop\x20`','/disconnect\x20-\x20disconnect\x20from\x20notifications','🔗\x20Endpoint:\x20`','ipAddress','timestamp','Contact\x20administrator.','Successful\x20login','toString','length','...\x22','message','...`\x0a\x0a','✅\x20Telegram\x20bot\x20@','❌\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`','📝\x20Notes:\x20','polling_error','bot','API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','📝\x20Order\x20ID:\x20`','💰\x20Amount:\x20*','🤖\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a','Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a','📱\x20Login\x20notifications\x20disabled\x20for\x20shop\x20','⏳\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a','\x20\x20\x20Status:\x20','262534YILGOo','success','requestId','Failed\x20to\x20send\x20login\x20notification:','Payment\x20successfully\x20paid','isVerified','status','*\x0a\x0a','TELEGRAM_BOT_USERNAME','username','findMany','Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`','includes','12ykbiXt','chargeback','stopPolling','initializeBot','❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','5471961KCzZfi','default','Error\x20handling\x20/debug\x20command:','name','text','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.','📅\x20Connection\x20date:\x20','adminNotes','onText','To\x20reconnect,\x20use\x20the\x20/start\x20command','Payment\x20refund','✅\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*','💻\x20Browser:\x20`','Telegram\x20bot\x20polling\x20error:','statusCode','Payment\x20failed','🔄\x20Reset\x20incomplete\x20verification\x20for\x20user\x20','❌\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20','🛑\x20Telegram\x20bot\x20stopped','Payment\x20chargeback','/status\x20-\x20check\x20connection\x20status\x0a','findUnique','✅\x20Telegram\x20user\x20','🔔\x20*','shopId','telegramBotService','❌\x20Error\x20getting\x20debug\x20information.','defineProperty','32DLYAZN','Payout\x20rejected','📱\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20','shopSettings','sendCustomNotification','toLocaleDateString','🔍\x20*Debug\x20Information*\x0a\x0a','user\x20is\x20deactivated','👤\x20Username:\x20`','\x20parts:\x20','warn','1595046BpwWuV','update','28SzEMok','•\x20New\x20payments\x0a','Error\x20handling\x20/status\x20command:','\x0a👤\x20*Customer\x20Information:*\x0a','split','🏦\x20Method:\x20`','\x20USD*\x0a','📊\x20Error\x20code:\x20`','updatedAt','New\x20payout\x20created','userAgent','from',':\x20username=\x22','chat','sendPayoutNotification','Markdown','node-telegram-bot-api','🏪\x20Available\x20shops\x20in\x20system:\x0a','endpoint','en-US','📝\x20Format:\x20`username\x20api_key`\x0a\x0a','Error\x20handling\x20/start\x20command:','•\x20Payouts\x0a','Use\x20/start\x20to\x20begin.','Error\x20handling\x20/disconnect\x20command:','setupBotHandlers','first_name','TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables','telegramUser','log','3ElxEMt','Payment\x20is\x20being\x20processed','`\x20(','\x0a⚠️\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!','.\x20*','\x20disconnected\x20from\x20shop\x20','forEach','allSettled','🎉\x20*Congratulations!*\x0a\x0a','❌\x20Please\x20use\x20/start\x20command\x20first','420DUCvjZ','Payout\x20completed','🔗\x20TXID:\x20`','`\x0a\x0a','✅\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20','User\x20','chat\x20not\x20found'];a53_0x195d=function(){return _0x5e4923;};return a53_0x195d();}