'use strict';const a57_0x2756f2=a57_0x4a20;(function(_0x283af2,_0x21c80d){const _0x2a65ea=a57_0x4a20,_0x288cac=_0x283af2();while(!![]){try{const _0x5c90f5=-parseInt(_0x2a65ea(0xb7))/0x1*(parseInt(_0x2a65ea(0x112))/0x2)+-parseInt(_0x2a65ea(0xd6))/0x3*(-parseInt(_0x2a65ea(0x126))/0x4)+-parseInt(_0x2a65ea(0xf2))/0x5+parseInt(_0x2a65ea(0x183))/0x6+parseInt(_0x2a65ea(0xf3))/0x7*(-parseInt(_0x2a65ea(0x123))/0x8)+parseInt(_0x2a65ea(0x104))/0x9+parseInt(_0x2a65ea(0x111))/0xa*(parseInt(_0x2a65ea(0x196))/0xb);if(_0x5c90f5===_0x21c80d)break;else _0x288cac['push'](_0x288cac['shift']());}catch(_0x267d93){_0x288cac['push'](_0x288cac['shift']());}}}(a57_0x58c1,0xc92c7));function a57_0x4a20(_0x347477,_0x10e02d){const _0x58c195=a57_0x58c1();return a57_0x4a20=function(_0x4a2051,_0x30b114){_0x4a2051=_0x4a2051-0xb2;let _0x1b0514=_0x58c195[_0x4a2051];return _0x1b0514;},a57_0x4a20(_0x347477,_0x10e02d);}var __importDefault=this&&this[a57_0x2756f2(0x17e)]||function(_0x4918e6){const _0x4a01be=a57_0x2756f2;return _0x4918e6&&_0x4918e6[_0x4a01be(0xc7)]?_0x4918e6:{'default':_0x4918e6};};Object[a57_0x2756f2(0x130)](exports,'__esModule',{'value':!![]}),exports[a57_0x2756f2(0xf1)]=exports[a57_0x2756f2(0x113)]=void 0x0;const node_telegram_bot_api_1=__importDefault(require(a57_0x2756f2(0x13f))),database_1=__importDefault(require(a57_0x2756f2(0x167))),gateway_1=require(a57_0x2756f2(0x16e));function a57_0x58c1(){const _0xff52f2=['blocked','chat\x20not\x20found','❌\x20Invalid\x20API\x20key\x20format.\x0a\x0a','•\x20Important\x20events\x0a\x0a','success','remitterIban','1UbYOzU','endpoint','✅\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a','📊\x20Error\x20code:\x20`','Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`','👤\x20Username:\x20`','processing','join','gateway','Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.','📝\x20Format:\x20`username\x20api_key`\x0a\x0a','*\x0a\x0a','getGatewayDisplayNameForTelegram','findMany','✅\x20Telegram\x20user\x20','❌\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a','__esModule','initializeBot','failed','No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20','🏦\x20IBAN:\x20`','\x20USDT*\x0a','handleSingleLineVerification','telegramUser','Error\x20handling\x20/start\x20command:','🔔\x20*','🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20','requestId','orderId','user\x20is\x20deactivated','🔗\x20Endpoint:\x20`','1430589kGPhJn','You\x20are\x20already\x20connected\x20to\x20shop:\x20*','txid','forEach','\x20\x20\x20Status:\x20','chat','\x20initialized\x20successfully','\x20verified\x20for\x20shop\x20','Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification','Payout\x20rejected','TELEGRAM_BOT_TOKEN','📱\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20','🔔\x20You\x20receive\x20notifications\x20about:\x0a','Payment\x20is\x20being\x20processed','📅\x20Time:\x20','💸\x20Amount:\x20*','🔗\x20TXID:\x20`','API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','en-US','Telegram\x20bot\x20polling\x20error:','❌\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a','❌\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20','notificationApiError','customerEmail','\x20(@','🔔\x20Notifications\x20are\x20active\x0a\x0a','substring','telegramBotService','3996165DZecbf','1637468yXAdFO','name','*.\x0a\x0a','env','...','userAgent','shopSettings','error','customerName','startsWith','toString','❌\x20An\x20error\x20occurred\x20while\x20verifying\x20data.','Markdown','log','To\x20reconnect,\x20use\x20the\x20/start\x20command','TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables','`\x0a\x0a','12200769WoQLZa','✅\x20Telegram\x20bot\x20@','message','❌\x20Failed\x20to\x20initialize\x20Telegram\x20bot:',':\x20username=\x22','customerIp','trapay_bot','telegramId','✅\x20Login\x20notification\x20sent\x20for\x20shop\x20','📱\x20Shop:\x20*','\x20\x20\x20Public\x20Key:\x20`','`\x20(','toLocaleDateString','10hFJlxV','2251636lfWYkT','TelegramBotService','Contact\x20administrator.','Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.','🛑\x20Telegram\x20bot\x20stopped','✅\x20Connected\x20to\x20shop:\x20*','ipAddress','updatedAt','❌\x20Please\x20use\x20/start\x20command\x20first','sendMessage','update','🌐\x20IP\x20address:\x20`','Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a','📱\x20Telegram\x20notification:\x20gateway\x20\x22','✅\x20Welcome\x20back!\x0a\x0a','Payment\x20chargeback','❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','8TXukps','/disconnect\x20-\x20disconnect\x20from\x20notifications','status','4zDPRNH','getBotInfo','...\x22','text','Error\x20handling\x20/debug\x20command:','length','✅\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*','Error\x20handling\x20/disconnect\x20command:','•\x20Payouts\x0a\x0a','Example:\x0a','defineProperty','ACTIVE','publicKey','Failed\x20login\x20attempt','✅\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*','🏦\x20Method:\x20`','❌\x20Error:\x20`','shopId','🆔\x20Payout\x20ID:\x20`','🚨\x20*API\x20Error*\x0a\x0a','first_name','✅\x20Notification\x20sent\x20to\x20Telegram\x20user\x20','`.\x0a\x0a','method','currency','node-telegram-bot-api','📧\x20Email:\x20`','notificationLogin','last_name','•\x20New\x20payments\x0a','📝\x20Order\x20ID:\x20`','from','❗️\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!','Payment\x20successfully\x20paid','Payment\x20refund','\x20USD*\x0a','includes','📝\x20Notes:\x20','errorMessage','botUsername','customerUa','polling_error','shop','findUnique','Username:\x20`','onText','•\x20`','Check\x20spelling\x20and\x20try\x20again.','Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).','findFirst','`\x20not\x20found.\x0a\x0a','You\x20sent\x20','📊\x20*Connection\x20Status*\x0a\x0a','Payment\x20expired','sendApiErrorNotification','adminNotes','🔍\x20*Debug\x20Information*\x0a\x0a','Commands:\x0a','🌐\x20IP:\x20`','timestamp','❌\x20Error\x20getting\x20debug\x20information.','📅\x20Date:\x20','❌\x20API\x20key\x20does\x20not\x20match\x20shop\x20`','entries','stopPolling','../config/database','User\x20','chargebackAmount','amount','statusCode','map','\x20disconnected\x20from\x20shop\x20','../types/gateway','setupBotHandlers','/status\x20-\x20check\x20connection\x20status\x0a','createdAt','🎉\x20*Congratulations!*\x0a\x0a','❌\x20Shop\x20`','\x0a👤\x20*Customer\x20Information:*\x0a','toLocaleString','sendPayoutNotification','❌\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`','📛\x20Name:\x20`','Failed\x20to\x20send\x20login\x20notification:','\x20\x20\x20Username:\x20`','bot','sk_','📱\x20Login\x20notifications\x20disabled\x20for\x20shop\x20','__importDefault','❌\x20Invalid\x20username\x20format:\x20`','isVerified','warn','\x0a⚠️\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!','1217478SVSbgZ','sendShopNotification','Error\x20handling\x20message:','Error\x20in\x20handleSingleLineVerification:','botToken','Successful\x20login','\x20via\x20single-line\x20input','✅\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20','Error\x20sending\x20shop\x20notification:','\x20parts:\x20','📱\x20Your\x20Telegram\x20ID:\x20`','⏳\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a','💰\x20Amount:\x20*','`\x20is\x20inactive.\x0a\x0a','💸\x20Penalty\x20amount:\x20*','🤖\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a','...`\x0a\x0a','username','\x0a💡\x20Check\x20your\x20request\x20or\x20contact\x20support.','10423215HZEojF','•\x20Payment\x20status\x20changes\x0a','default','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','\x22,\x20apiKey=\x22','.\x20*'];a57_0x58c1=function(){return _0xff52f2;};return a57_0x58c1();}class TelegramBotService{constructor(){const _0x564d07=a57_0x2756f2;this['bot']=null,this[_0x564d07(0x187)]=process[_0x564d07(0xf6)][_0x564d07(0xe0)]||'',this['botUsername']=process[_0x564d07(0xf6)]['TELEGRAM_BOT_USERNAME']||_0x564d07(0x10a),this[_0x564d07(0x187)]?this[_0x564d07(0xc8)]():console[_0x564d07(0x181)](_0x564d07(0x102));}[a57_0x2756f2(0xc8)](){const _0x42de55=a57_0x2756f2;try{this['bot']=new node_telegram_bot_api_1['default'](this[_0x42de55(0x187)],{'polling':!![]}),this[_0x42de55(0x16f)](),console[_0x42de55(0x100)](_0x42de55(0x105)+this['botUsername']+_0x42de55(0xdc));}catch(_0x7460e8){console['error'](_0x42de55(0x107),_0x7460e8);}}[a57_0x2756f2(0x16f)](){const _0x147223=a57_0x2756f2;if(!this[_0x147223(0x17b)])return;this['bot'][_0x147223(0x153)](/\/start/,async _0x5f1daa=>{const _0x30e600=_0x147223,_0xbe991a=_0x5f1daa[_0x30e600(0xdb)]['id'],_0x2af65e=_0x5f1daa[_0x30e600(0x145)]?.['id']['toString'](),_0xc12653=_0x5f1daa[_0x30e600(0x145)]?.[_0x30e600(0x194)],_0x1f740b=_0x5f1daa[_0x30e600(0x145)]?.[_0x30e600(0x13a)],_0x2d019a=_0x5f1daa[_0x30e600(0x145)]?.[_0x30e600(0x142)];if(!_0x2af65e)return;try{let _0x58dc94=await database_1[_0x30e600(0x198)][_0x30e600(0xce)][_0x30e600(0x151)]({'where':{'telegramId':_0x2af65e},'include':{'shop':!![]}});!_0x58dc94?(_0x58dc94=await database_1[_0x30e600(0x198)][_0x30e600(0xce)]['create']({'data':{'telegramId':_0x2af65e,'username':_0xc12653,'firstName':_0x1f740b,'lastName':_0x2d019a,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console['log']('📱\x20Created\x20new\x20Telegram\x20user:\x20'+_0x2af65e+_0x30e600(0xee)+_0xc12653+')')):_0x58dc94=await database_1[_0x30e600(0x198)][_0x30e600(0xce)][_0x30e600(0x11c)]({'where':{'telegramId':_0x2af65e},'data':{'username':_0xc12653,'firstName':_0x1f740b,'lastName':_0x2d019a},'include':{'shop':!![]}}),_0x58dc94[_0x30e600(0x180)]&&_0x58dc94[_0x30e600(0x137)]&&_0x58dc94[_0x30e600(0x150)]?await this['bot']?.[_0x30e600(0x11b)](_0xbe991a,_0x30e600(0x120)+(_0x30e600(0xd7)+_0x58dc94['shop'][_0x30e600(0xf4)]+'*\x0a')+(_0x30e600(0x152)+_0x58dc94[_0x30e600(0x150)][_0x30e600(0x194)]+_0x30e600(0x103))+_0x30e600(0xe2)+'•\x20New\x20payments\x0a'+'•\x20Payment\x20status\x20changes\x0a'+_0x30e600(0x12e)+_0x30e600(0x15f)+_0x30e600(0x170)+'/disconnect\x20-\x20disconnect\x20from\x20notifications',{'parse_mode':_0x30e600(0xff)}):(_0x58dc94[_0x30e600(0x137)]&&!_0x58dc94[_0x30e600(0x180)]&&(await database_1[_0x30e600(0x198)][_0x30e600(0xce)][_0x30e600(0x11c)]({'where':{'telegramId':_0x2af65e},'data':{'shopId':null,'isVerified':![]}}),console[_0x30e600(0x100)]('🔄\x20Reset\x20incomplete\x20verification\x20for\x20user\x20'+_0x2af65e)),await this['bot']?.[_0x30e600(0x11b)](_0xbe991a,_0x30e600(0x192)+'To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a'+_0x30e600(0xc1)+_0x30e600(0x12f)+_0x30e600(0x199)+_0x30e600(0x146),{'parse_mode':_0x30e600(0xff)}));}catch(_0x56a8a9){console['error'](_0x30e600(0xcf),_0x56a8a9),await this[_0x30e600(0x17b)]?.[_0x30e600(0x11b)](_0xbe991a,'❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this[_0x147223(0x17b)]['onText'](/\/disconnect/,async _0x4ce908=>{const _0x35dfb4=_0x147223,_0x3d455d=_0x4ce908[_0x35dfb4(0xdb)]['id'],_0x5b51bf=_0x4ce908[_0x35dfb4(0x145)]?.['id']['toString']();if(!_0x5b51bf)return;try{const _0x418adb=await database_1[_0x35dfb4(0x198)]['telegramUser'][_0x35dfb4(0x151)]({'where':{'telegramId':_0x5b51bf},'include':{'shop':!![]}});if(!_0x418adb||!_0x418adb[_0x35dfb4(0x180)]||!_0x418adb['shopId']){await this[_0x35dfb4(0x17b)]?.[_0x35dfb4(0x11b)](_0x3d455d,'❌\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.');return;}const _0xa79750=_0x418adb[_0x35dfb4(0x150)]?.[_0x35dfb4(0xf4)]||'unknown\x20shop';await database_1[_0x35dfb4(0x198)][_0x35dfb4(0xce)][_0x35dfb4(0x11c)]({'where':{'telegramId':_0x5b51bf},'data':{'shopId':null,'isVerified':![]}}),console['log']('🔌\x20User\x20'+_0x5b51bf+_0x35dfb4(0x16d)+_0x418adb[_0x35dfb4(0x137)]),await this[_0x35dfb4(0x17b)]?.[_0x35dfb4(0x11b)](_0x3d455d,_0x35dfb4(0x12c)+_0xa79750+_0x35dfb4(0xf5)+_0x35dfb4(0x101),{'parse_mode':_0x35dfb4(0xff)});}catch(_0x1648dd){console[_0x35dfb4(0xfa)](_0x35dfb4(0x12d),_0x1648dd),await this['bot']?.['sendMessage'](_0x3d455d,_0x35dfb4(0x122));}}),this[_0x147223(0x17b)][_0x147223(0x153)](/\/status/,async _0x17817f=>{const _0x330ddd=_0x147223,_0x7859d8=_0x17817f[_0x330ddd(0xdb)]['id'],_0x4b3df5=_0x17817f[_0x330ddd(0x145)]?.['id']['toString']();if(!_0x4b3df5)return;try{const _0x4668bb=await database_1[_0x330ddd(0x198)][_0x330ddd(0xce)][_0x330ddd(0x151)]({'where':{'telegramId':_0x4b3df5},'include':{'shop':!![]}});if(!_0x4668bb){await this[_0x330ddd(0x17b)]?.[_0x330ddd(0x11b)](_0x7859d8,'❌\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a'+'Use\x20/start\x20to\x20begin.');return;}if(!_0x4668bb[_0x330ddd(0x180)]||!_0x4668bb[_0x330ddd(0x137)]||!_0x4668bb['shop']){await this[_0x330ddd(0x17b)]?.[_0x330ddd(0x11b)](_0x7859d8,_0x330ddd(0xc6)+'Use\x20/start\x20to\x20connect.');return;}await this[_0x330ddd(0x17b)]?.[_0x330ddd(0x11b)](_0x7859d8,_0x330ddd(0x15a)+(_0x330ddd(0x117)+_0x4668bb[_0x330ddd(0x150)][_0x330ddd(0xf4)]+'*\x0a')+('👤\x20Username:\x20`'+_0x4668bb['shop'][_0x330ddd(0x194)]+'`\x0a')+('📅\x20Connection\x20date:\x20'+_0x4668bb[_0x330ddd(0x119)][_0x330ddd(0x110)](_0x330ddd(0xe8))+'\x0a\x0a')+_0x330ddd(0xef)+'Commands:\x0a'+_0x330ddd(0x124),{'parse_mode':_0x330ddd(0xff)});}catch(_0x2138eb){console['error']('Error\x20handling\x20/status\x20command:',_0x2138eb),await this[_0x330ddd(0x17b)]?.[_0x330ddd(0x11b)](_0x7859d8,'❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this[_0x147223(0x17b)][_0x147223(0x153)](/\/debug/,async _0xf5e9c=>{const _0x3263a4=_0x147223,_0x431fc5=_0xf5e9c[_0x3263a4(0xdb)]['id'],_0x13257d=_0xf5e9c[_0x3263a4(0x145)]?.['id'][_0x3263a4(0xfd)]();if(!_0x13257d)return;try{const _0x1e35d0=await database_1[_0x3263a4(0x198)][_0x3263a4(0x150)][_0x3263a4(0xc4)]({'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![]},'take':0xa});let _0xcbf32a=_0x3263a4(0x15e);_0xcbf32a+=_0x3263a4(0x18d)+_0x13257d+_0x3263a4(0x103),_0xcbf32a+='🏪\x20Available\x20shops\x20in\x20system:\x0a',_0x1e35d0['forEach']((_0x322cc9,_0x3536ab)=>{const _0x1a8fcc=_0x3263a4;_0xcbf32a+=_0x3536ab+0x1+_0x1a8fcc(0x19b)+_0x322cc9[_0x1a8fcc(0xf4)]+'*\x0a',_0xcbf32a+=_0x1a8fcc(0x17a)+_0x322cc9[_0x1a8fcc(0x194)]+'`\x0a',_0xcbf32a+=_0x1a8fcc(0xda)+_0x322cc9[_0x1a8fcc(0x125)]+'\x0a',_0xcbf32a+=_0x1a8fcc(0x10e)+_0x322cc9[_0x1a8fcc(0x132)][_0x1a8fcc(0xf0)](0x0,0xf)+_0x1a8fcc(0x193);}),await this[_0x3263a4(0x17b)]?.['sendMessage'](_0x431fc5,_0xcbf32a,{'parse_mode':'Markdown'});}catch(_0x1d66b1){console[_0x3263a4(0xfa)](_0x3263a4(0x12a),_0x1d66b1),await this[_0x3263a4(0x17b)]?.[_0x3263a4(0x11b)](_0x431fc5,_0x3263a4(0x162));}}),this[_0x147223(0x17b)]['on'](_0x147223(0x106),async _0x3bc9f7=>{const _0x35bc64=_0x147223;if(_0x3bc9f7[_0x35bc64(0x129)]?.[_0x35bc64(0xfc)]('/'))return;const _0x3858a9=_0x3bc9f7[_0x35bc64(0xdb)]['id'],_0x551904=_0x3bc9f7[_0x35bc64(0x145)]?.['id'][_0x35bc64(0xfd)](),_0x5273e6=_0x3bc9f7['text']?.['trim']();if(!_0x551904||!_0x5273e6)return;try{const _0xd5a73b=await database_1['default'][_0x35bc64(0xce)]['findUnique']({'where':{'telegramId':_0x551904},'include':{'shop':!![]}});if(!_0xd5a73b){await this[_0x35bc64(0x17b)]?.[_0x35bc64(0x11b)](_0x3858a9,_0x35bc64(0x11a));return;}if(_0xd5a73b[_0x35bc64(0x180)]&&_0xd5a73b[_0x35bc64(0x137)]&&_0xd5a73b[_0x35bc64(0x150)]){await this[_0x35bc64(0x17b)]?.[_0x35bc64(0x11b)](_0x3858a9,_0x35bc64(0x134)+_0xd5a73b[_0x35bc64(0x150)][_0x35bc64(0xf4)]+_0x35bc64(0xf5)+_0x35bc64(0xc0),{'parse_mode':'Markdown'});return;}const _0x388883=_0x5273e6['split'](/\s+/);if(_0x388883[_0x35bc64(0x12b)]!==0x2){await this[_0x35bc64(0x17b)]?.[_0x35bc64(0x11b)](_0x3858a9,_0x35bc64(0xea)+_0x35bc64(0xc1)+_0x35bc64(0x12f)+_0x35bc64(0x199)+(_0x35bc64(0x159)+_0x388883[_0x35bc64(0x12b)]+_0x35bc64(0x18c)+_0x388883[_0x35bc64(0x16c)](_0x4c7399=>'`'+_0x4c7399+'`')[_0x35bc64(0xbe)](',\x20')),{'parse_mode':_0x35bc64(0xff)});return;}const [_0x394ff9,_0xbe5185]=_0x388883;console['log'](_0x35bc64(0xd1)+_0x551904+_0x35bc64(0x108)+_0x394ff9+_0x35bc64(0x19a)+_0xbe5185['substring'](0x0,0xa)+_0x35bc64(0x128)),await this[_0x35bc64(0xcd)](_0x3858a9,_0x551904,_0x394ff9,_0xbe5185);}catch(_0x30af82){console[_0x35bc64(0xfa)](_0x35bc64(0x185),_0x30af82),await this[_0x35bc64(0x17b)]?.[_0x35bc64(0x11b)](_0x3858a9,_0x35bc64(0x122));}}),this[_0x147223(0x17b)]['on'](_0x147223(0xfa),_0x1a9ffe=>{console['error']('Telegram\x20bot\x20error:',_0x1a9ffe);}),this[_0x147223(0x17b)]['on'](_0x147223(0x14f),_0x5c9842=>{const _0x24b56d=_0x147223;console[_0x24b56d(0xfa)](_0x24b56d(0xe9),_0x5c9842);});}async['handleSingleLineVerification'](_0x19b871,_0xb7b361,_0x1a232a,_0x4c0153){const _0x2c7aaa=a57_0x2756f2;try{console[_0x2c7aaa(0x100)](_0x2c7aaa(0xd1)+_0xb7b361+_0x2c7aaa(0x108)+_0x1a232a+_0x2c7aaa(0x19a)+_0x4c0153[_0x2c7aaa(0xf0)](0x0,0xa)+_0x2c7aaa(0x128));if(!_0x1a232a||_0x1a232a[_0x2c7aaa(0x12b)]<0x3||_0x1a232a[_0x2c7aaa(0x12b)]>0x32||!/^[a-zA-Z0-9_]+$/['test'](_0x1a232a)){await this[_0x2c7aaa(0x17b)]?.[_0x2c7aaa(0x11b)](_0x19b871,_0x2c7aaa(0x17f)+_0x1a232a+_0x2c7aaa(0x103)+_0x2c7aaa(0x156),{'parse_mode':_0x2c7aaa(0xff)});return;}if(!_0x4c0153||!_0x4c0153[_0x2c7aaa(0xfc)]('pk_')&&!_0x4c0153[_0x2c7aaa(0xfc)](_0x2c7aaa(0x17c))){await this[_0x2c7aaa(0x17b)]?.[_0x2c7aaa(0x11b)](_0x19b871,_0x2c7aaa(0xb3)+_0x2c7aaa(0xe7),{'parse_mode':_0x2c7aaa(0xff)});return;}const _0x403650=await database_1[_0x2c7aaa(0x198)][_0x2c7aaa(0x150)][_0x2c7aaa(0x151)]({'where':{'username':_0x1a232a},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x403650){const _0x15a18f=await database_1['default'][_0x2c7aaa(0x150)]['findMany']({'select':{'username':!![],'name':!![]},'take':0x5});let _0x504cd8='❌\x20Shop\x20with\x20username\x20`'+_0x1a232a+_0x2c7aaa(0x158);_0x15a18f[_0x2c7aaa(0x12b)]>0x0?(_0x504cd8+='Available\x20usernames:\x0a',_0x15a18f[_0x2c7aaa(0xd9)](_0x5f4b95=>{const _0x1a9b36=_0x2c7aaa;_0x504cd8+=_0x1a9b36(0x154)+_0x5f4b95['username']+_0x1a9b36(0x10f)+_0x5f4b95[_0x1a9b36(0xf4)]+')\x0a';}),_0x504cd8+='\x0aCheck\x20spelling\x20and\x20try\x20again.'):_0x504cd8+=_0x2c7aaa(0x155);await this['bot']?.[_0x2c7aaa(0x11b)](_0x19b871,_0x504cd8,{'parse_mode':_0x2c7aaa(0xff)});return;}if(_0x403650[_0x2c7aaa(0x125)]!==_0x2c7aaa(0x131)){await this['bot']?.['sendMessage'](_0x19b871,_0x2c7aaa(0x173)+_0x1a232a+_0x2c7aaa(0x190)+_0x2c7aaa(0x114),{'parse_mode':_0x2c7aaa(0xff)});return;}if(_0x403650[_0x2c7aaa(0x132)]!==_0x4c0153&&_0x403650['secretKey']!==_0x4c0153){await this[_0x2c7aaa(0x17b)]?.[_0x2c7aaa(0x11b)](_0x19b871,_0x2c7aaa(0x164)+_0x1a232a+_0x2c7aaa(0x13c)+_0x2c7aaa(0x11e)+_0x2c7aaa(0xbb),{'parse_mode':_0x2c7aaa(0xff)});return;}const _0x2cd5f6=await database_1['default'][_0x2c7aaa(0xce)][_0x2c7aaa(0x157)]({'where':{'shopId':_0x403650['id'],'isVerified':!![],'telegramId':{'not':_0xb7b361}}});if(_0x2cd5f6){await this[_0x2c7aaa(0x17b)]?.[_0x2c7aaa(0x11b)](_0x19b871,_0x2c7aaa(0x177)+_0x1a232a+_0x2c7aaa(0x13c)+_0x2c7aaa(0x115),{'parse_mode':_0x2c7aaa(0xff)});return;}await database_1['default'][_0x2c7aaa(0xce)][_0x2c7aaa(0x11c)]({'where':{'telegramId':_0xb7b361},'data':{'shopId':_0x403650['id'],'isVerified':!![]}}),await this['bot']?.['sendMessage'](_0x19b871,_0x2c7aaa(0x172)+_0x2c7aaa(0xb9)+(_0x2c7aaa(0x10d)+_0x403650[_0x2c7aaa(0xf4)]+'*\x0a')+(_0x2c7aaa(0xbc)+_0x403650[_0x2c7aaa(0x194)]+_0x2c7aaa(0x103))+'🔔\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a'+_0x2c7aaa(0x143)+_0x2c7aaa(0x197)+'•\x20Payouts\x0a'+_0x2c7aaa(0xb4)+_0x2c7aaa(0x15f)+_0x2c7aaa(0x170)+_0x2c7aaa(0x124),{'parse_mode':'Markdown'}),console[_0x2c7aaa(0x100)](_0x2c7aaa(0xc5)+_0xb7b361+_0x2c7aaa(0xdd)+_0x403650['username']+_0x2c7aaa(0x189));}catch(_0x5bd16a){console[_0x2c7aaa(0xfa)](_0x2c7aaa(0x186),_0x5bd16a),await this[_0x2c7aaa(0x17b)]?.[_0x2c7aaa(0x11b)](_0x19b871,_0x2c7aaa(0xfe));}}async[a57_0x2756f2(0x184)](_0x2e6ec6,_0x1b6b0c,_0x22e4bc){const _0x411bd2=a57_0x2756f2;if(!this[_0x411bd2(0x17b)]){console[_0x411bd2(0x181)](_0x411bd2(0xde));return;}try{const _0x448cc7=await database_1[_0x411bd2(0x198)]['telegramUser'][_0x411bd2(0xc4)]({'where':{'shopId':_0x2e6ec6,'isVerified':!![]}});if(_0x448cc7[_0x411bd2(0x12b)]===0x0){console['log'](_0x411bd2(0xca)+_0x2e6ec6);return;}const _0x32d1ce=_0x448cc7['map'](async _0x589300=>{const _0x53661e=_0x411bd2;try{await this['bot']?.['sendMessage'](_0x589300[_0x53661e(0x10b)],_0x1b6b0c,_0x22e4bc),console[_0x53661e(0x100)](_0x53661e(0x13b)+_0x589300[_0x53661e(0x10b)]);}catch(_0x33324d){console[_0x53661e(0xfa)](_0x53661e(0xeb)+_0x589300['telegramId']+':',_0x33324d),_0x33324d instanceof Error&&(_0x33324d[_0x53661e(0x106)][_0x53661e(0x14a)](_0x53661e(0x19c))||_0x33324d[_0x53661e(0x106)][_0x53661e(0x14a)](_0x53661e(0xb2))||_0x33324d[_0x53661e(0x106)][_0x53661e(0x14a)](_0x53661e(0xd4)))&&(await database_1['default'][_0x53661e(0xce)][_0x53661e(0x11c)]({'where':{'id':_0x589300['id']},'data':{'isVerified':![]}}),console[_0x53661e(0x100)](_0x53661e(0x168)+_0x589300[_0x53661e(0x10b)]+'\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure'));}});await Promise['allSettled'](_0x32d1ce);}catch(_0x46ca55){console[_0x411bd2(0xfa)](_0x411bd2(0x18b),_0x46ca55);}}async['sendPaymentNotification'](_0x3f8247,_0x5c2527,_0x2a98e9){const _0x325123=a57_0x2756f2,_0x4c6792={'created':'🆕','paid':'✅','failed':'❌','expired':'⏰','refund':'🔄','chargeback':'⚠️','processing':'⚙️'},_0x58737f={'created':'New\x20payment\x20created','paid':_0x325123(0x147),'failed':'Payment\x20failed','expired':_0x325123(0x15b),'refund':_0x325123(0x148),'chargeback':_0x325123(0x121),'processing':_0x325123(0xe3)},_0x8298fe=_0x4c6792[_0x2a98e9],_0x1be71e=_0x58737f[_0x2a98e9],_0x24ca13=(0x0,gateway_1[_0x325123(0xc3)])(_0x5c2527['gateway']);console['log'](_0x325123(0x11f)+_0x5c2527[_0x325123(0xbf)]+'\x22\x20->\x20display\x20\x22'+_0x24ca13+'\x22');let _0x512b82=_0x8298fe+'\x20*'+_0x1be71e+_0x325123(0xc2)+(_0x325123(0x18f)+_0x5c2527[_0x325123(0x16a)]+'\x20'+_0x5c2527[_0x325123(0x13e)]+'*\x0a')+(_0x325123(0x144)+(_0x5c2527[_0x325123(0xd3)]||_0x5c2527['id'])+'`\x0a')+('🆔\x20Payment\x20ID:\x20`'+_0x5c2527['id']+'`\x0a')+('🏪\x20Gateway:\x20`'+_0x24ca13+'`\x0a')+(_0x325123(0x163)+new Date(_0x5c2527[_0x325123(0x171)])[_0x325123(0x175)](_0x325123(0xe8))+'\x0a');if(_0x5c2527[_0x325123(0xfb)]||_0x5c2527['customerEmail']||_0x5c2527[_0x325123(0xb6)]||_0x5c2527[_0x325123(0x109)]||_0x5c2527[_0x325123(0x14e)]){_0x512b82+=_0x325123(0x174);_0x5c2527[_0x325123(0xfb)]&&(_0x512b82+=_0x325123(0x178)+_0x5c2527[_0x325123(0xfb)]+'`\x0a');_0x5c2527[_0x325123(0xed)]&&(_0x512b82+=_0x325123(0x140)+_0x5c2527[_0x325123(0xed)]+'`\x0a');_0x5c2527[_0x325123(0xb6)]&&(_0x512b82+=_0x325123(0xcb)+_0x5c2527[_0x325123(0xb6)]+'`\x0a');_0x5c2527['customerIp']&&(_0x512b82+=_0x325123(0x160)+_0x5c2527[_0x325123(0x109)]+'`\x0a');if(_0x5c2527['customerUa']){const _0x39fa79=_0x5c2527[_0x325123(0x14e)]['length']>0x32?_0x5c2527[_0x325123(0x14e)][_0x325123(0xf0)](0x0,0x32)+_0x325123(0xf7):_0x5c2527[_0x325123(0x14e)];_0x512b82+='💻\x20Browser:\x20`'+_0x39fa79+'`\x0a';}}_0x2a98e9==='chargeback'&&_0x5c2527[_0x325123(0x169)]&&(_0x512b82+=_0x325123(0x191)+_0x5c2527[_0x325123(0x169)]+_0x325123(0xcc)),_0x2a98e9===_0x325123(0xbd)&&(_0x512b82+=_0x325123(0x18e)),_0x5c2527['adminNotes']&&(_0x512b82+=_0x325123(0x14b)+_0x5c2527[_0x325123(0x15d)]+'\x0a'),await this[_0x325123(0x184)](_0x3f8247,_0x512b82,{'parse_mode':'Markdown'});}async[a57_0x2756f2(0x176)](_0x516e64,_0x247863,_0x5099f9){const _0x39f39f=a57_0x2756f2,_0x326b89={'created':'📤','completed':'✅','rejected':'❌'},_0x4a8b57={'created':'New\x20payout\x20created','completed':'Payout\x20completed','rejected':_0x39f39f(0xdf)},_0x2e661c=_0x326b89[_0x5099f9],_0x9544de=_0x4a8b57[_0x5099f9],_0x21c4ed=_0x2e661c+'\x20*'+_0x9544de+_0x39f39f(0xc2)+(_0x39f39f(0xe5)+_0x247863[_0x39f39f(0x16a)]+_0x39f39f(0x149))+(_0x39f39f(0x135)+_0x247863[_0x39f39f(0x13d)]+'`\x0a')+(_0x39f39f(0x138)+_0x247863['id']+'`\x0a')+('📅\x20Date:\x20'+new Date(_0x247863[_0x39f39f(0x171)])[_0x39f39f(0x175)](_0x39f39f(0xe8))+'\x0a')+(_0x247863[_0x39f39f(0xd8)]?_0x39f39f(0xe6)+_0x247863[_0x39f39f(0xd8)]+'`':'');await this[_0x39f39f(0x184)](_0x516e64,_0x21c4ed,{'parse_mode':_0x39f39f(0xff)});}async['sendLoginNotification'](_0x1788f6,_0x32c65d){const _0x2713be=a57_0x2756f2;try{const _0x5ab261=await database_1['default'][_0x2713be(0xf9)]['findUnique']({'where':{'shopId':_0x1788f6},'select':{'notificationLogin':!![]}});if(!_0x5ab261?.[_0x2713be(0x141)]){console[_0x2713be(0x100)](_0x2713be(0x17d)+_0x1788f6);return;}const _0x56f0b4=_0x32c65d[_0x2713be(0xb5)]?'🔐':'🚨',_0x471545=_0x32c65d['success']?_0x2713be(0x188):_0x2713be(0x133);let _0x157f10=_0x56f0b4+'\x20*'+_0x471545+_0x2713be(0xc2)+(_0x2713be(0xbc)+_0x32c65d['username']+'`\x0a')+(_0x2713be(0xe4)+_0x32c65d[_0x2713be(0x161)][_0x2713be(0x175)]('en-US')+'\x0a');_0x32c65d['ipAddress']&&(_0x157f10+=_0x2713be(0x11d)+_0x32c65d[_0x2713be(0x118)]+'`\x0a');if(_0x32c65d[_0x2713be(0xf8)]){const _0x540150=_0x32c65d[_0x2713be(0xf8)][_0x2713be(0x12b)]>0x32?_0x32c65d[_0x2713be(0xf8)][_0x2713be(0xf0)](0x0,0x32)+_0x2713be(0xf7):_0x32c65d[_0x2713be(0xf8)];_0x157f10+='💻\x20Browser:\x20`'+_0x540150+'`\x0a';}!_0x32c65d[_0x2713be(0xb5)]&&(_0x157f10+=_0x2713be(0x182)),await this['sendShopNotification'](_0x1788f6,_0x157f10,{'parse_mode':_0x2713be(0xff)}),console[_0x2713be(0x100)](_0x2713be(0x10c)+_0x1788f6+':\x20'+(_0x32c65d[_0x2713be(0xb5)]?_0x2713be(0xb5):_0x2713be(0xc9)));}catch(_0x1a352f){console[_0x2713be(0xfa)](_0x2713be(0x179),_0x1a352f);}}async[a57_0x2756f2(0x15c)](_0x55e379,_0x4cce1b){const _0x38a15a=a57_0x2756f2;try{const _0x22d9ea=await database_1[_0x38a15a(0x198)]['shopSettings'][_0x38a15a(0x151)]({'where':{'shopId':_0x55e379},'select':{'notificationApiError':!![]}});if(!_0x22d9ea?.[_0x38a15a(0xec)]){console[_0x38a15a(0x100)](_0x38a15a(0xe1)+_0x55e379);return;}let _0x14b46e=_0x38a15a(0x139)+(_0x38a15a(0xd5)+_0x4cce1b[_0x38a15a(0x13d)]+'\x20'+_0x4cce1b[_0x38a15a(0xb8)]+'`\x0a')+(_0x38a15a(0xe4)+_0x4cce1b['timestamp'][_0x38a15a(0x175)]('en-US')+'\x0a');_0x4cce1b[_0x38a15a(0x16b)]&&(_0x14b46e+=_0x38a15a(0xba)+_0x4cce1b[_0x38a15a(0x16b)]+'`\x0a'),_0x14b46e+=_0x38a15a(0x136)+_0x4cce1b[_0x38a15a(0x14c)]+'`\x0a',_0x4cce1b[_0x38a15a(0xd2)]&&(_0x14b46e+='🆔\x20Request\x20ID:\x20`'+_0x4cce1b[_0x38a15a(0xd2)]+'`\x0a'),_0x14b46e+=_0x38a15a(0x195),await this[_0x38a15a(0x184)](_0x55e379,_0x14b46e,{'parse_mode':_0x38a15a(0xff)}),console[_0x38a15a(0x100)](_0x38a15a(0x18a)+_0x55e379+':\x20'+_0x4cce1b[_0x38a15a(0xb8)]);}catch(_0x5281fd){console[_0x38a15a(0xfa)]('Failed\x20to\x20send\x20API\x20error\x20notification:',_0x5281fd);}}async['sendCustomNotification'](_0x19234a,_0x34c1b8,_0x482611){const _0xe8bfcf=a57_0x2756f2;let _0x5e30f2=_0xe8bfcf(0xd0)+_0x34c1b8+_0xe8bfcf(0xc2);for(const [_0x32643f,_0x215263]of Object[_0xe8bfcf(0x165)](_0x482611)){_0x215263!==null&&_0x215263!==undefined&&(_0x5e30f2+=_0x32643f+':\x20`'+_0x215263+'`\x0a');}await this[_0xe8bfcf(0x184)](_0x19234a,_0x5e30f2,{'parse_mode':_0xe8bfcf(0xff)});}[a57_0x2756f2(0x127)](){const _0x3e6cbc=a57_0x2756f2;return{'isActive':!!this[_0x3e6cbc(0x17b)],'username':this[_0x3e6cbc(0x14d)]};}['stopBot'](){const _0x54c8df=a57_0x2756f2;this['bot']&&(this[_0x54c8df(0x17b)][_0x54c8df(0x166)](),this[_0x54c8df(0x17b)]=null,console[_0x54c8df(0x100)](_0x54c8df(0x116)));}}exports['TelegramBotService']=TelegramBotService,exports[a57_0x2756f2(0xf1)]=new TelegramBotService();