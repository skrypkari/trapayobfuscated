'use strict';const a52_0x3ef74d=a52_0x503a;(function(_0x32c26e,_0x4567e1){const _0x379e98=a52_0x503a,_0x123e1d=_0x32c26e();while(!![]){try{const _0x24d263=parseInt(_0x379e98(0x24a))/0x1+-parseInt(_0x379e98(0x1e5))/0x2*(parseInt(_0x379e98(0x1f3))/0x3)+parseInt(_0x379e98(0x289))/0x4*(parseInt(_0x379e98(0x25e))/0x5)+-parseInt(_0x379e98(0x1d5))/0x6*(-parseInt(_0x379e98(0x218))/0x7)+parseInt(_0x379e98(0x268))/0x8*(parseInt(_0x379e98(0x1ce))/0x9)+parseInt(_0x379e98(0x1dd))/0xa+-parseInt(_0x379e98(0x1f2))/0xb;if(_0x24d263===_0x4567e1)break;else _0x123e1d['push'](_0x123e1d['shift']());}catch(_0x540d06){_0x123e1d['push'](_0x123e1d['shift']());}}}(a52_0x1220,0x3777f));var __importDefault=this&&this[a52_0x3ef74d(0x1e3)]||function(_0x148a11){const _0x24b89d=a52_0x3ef74d;return _0x148a11&&_0x148a11[_0x24b89d(0x271)]?_0x148a11:{'default':_0x148a11};};Object[a52_0x3ef74d(0x1fe)](exports,'__esModule',{'value':!![]}),exports[a52_0x3ef74d(0x22c)]=exports[a52_0x3ef74d(0x1c7)]=void 0x0;const node_telegram_bot_api_1=__importDefault(require(a52_0x3ef74d(0x1c0))),database_1=__importDefault(require(a52_0x3ef74d(0x1b6))),gateway_1=require(a52_0x3ef74d(0x24e));class TelegramBotService{constructor(){const _0x12567b=a52_0x3ef74d;this[_0x12567b(0x1ec)]=null,this[_0x12567b(0x223)]=process[_0x12567b(0x260)][_0x12567b(0x26a)]||'',this[_0x12567b(0x201)]=process[_0x12567b(0x260)]['TELEGRAM_BOT_USERNAME']||_0x12567b(0x247),this[_0x12567b(0x223)]?this[_0x12567b(0x1c1)]():console[_0x12567b(0x245)]('TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables');}[a52_0x3ef74d(0x1c1)](){const _0x2b1a8c=a52_0x3ef74d;try{this[_0x2b1a8c(0x1ec)]=new node_telegram_bot_api_1['default'](this[_0x2b1a8c(0x223)],{'polling':!![]}),this[_0x2b1a8c(0x200)](),console[_0x2b1a8c(0x23f)]('✅\x20Telegram\x20bot\x20@'+this[_0x2b1a8c(0x201)]+_0x2b1a8c(0x23e));}catch(_0xe6e4bf){console[_0x2b1a8c(0x248)](_0x2b1a8c(0x220),_0xe6e4bf);}}[a52_0x3ef74d(0x200)](){const _0x32d594=a52_0x3ef74d;if(!this[_0x32d594(0x1ec)])return;this['bot'][_0x32d594(0x27f)](/\/start/,async _0x53545f=>{const _0x20487a=_0x32d594,_0x5b417a=_0x53545f['chat']['id'],_0xedf1b0=_0x53545f[_0x20487a(0x281)]?.['id'][_0x20487a(0x215)](),_0x1f19f9=_0x53545f[_0x20487a(0x281)]?.[_0x20487a(0x24b)],_0x53985b=_0x53545f[_0x20487a(0x281)]?.['first_name'],_0x3eccd7=_0x53545f[_0x20487a(0x281)]?.[_0x20487a(0x244)];if(!_0xedf1b0)return;try{let _0x33d027=await database_1[_0x20487a(0x26b)][_0x20487a(0x209)][_0x20487a(0x237)]({'where':{'telegramId':_0xedf1b0},'include':{'shop':!![]}});!_0x33d027?(_0x33d027=await database_1[_0x20487a(0x26b)][_0x20487a(0x209)][_0x20487a(0x1fc)]({'data':{'telegramId':_0xedf1b0,'username':_0x1f19f9,'firstName':_0x53985b,'lastName':_0x3eccd7,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console['log'](_0x20487a(0x1e7)+_0xedf1b0+'\x20(@'+_0x1f19f9+')')):_0x33d027=await database_1[_0x20487a(0x26b)][_0x20487a(0x209)][_0x20487a(0x1e6)]({'where':{'telegramId':_0xedf1b0},'data':{'username':_0x1f19f9,'firstName':_0x53985b,'lastName':_0x3eccd7},'include':{'shop':!![]}}),_0x33d027[_0x20487a(0x274)]&&_0x33d027[_0x20487a(0x22d)]&&_0x33d027[_0x20487a(0x1dc)]?await this[_0x20487a(0x1ec)]?.[_0x20487a(0x211)](_0x5b417a,_0x20487a(0x20b)+('You\x20are\x20already\x20connected\x20to\x20shop:\x20*'+_0x33d027[_0x20487a(0x1dc)][_0x20487a(0x21f)]+'*\x0a')+(_0x20487a(0x226)+_0x33d027[_0x20487a(0x1dc)][_0x20487a(0x24b)]+'`\x0a\x0a')+_0x20487a(0x1e9)+'•\x20New\x20payments\x0a'+_0x20487a(0x266)+_0x20487a(0x257)+_0x20487a(0x1f8)+_0x20487a(0x272)+_0x20487a(0x20a),{'parse_mode':'Markdown'}):(_0x33d027[_0x20487a(0x22d)]&&!_0x33d027[_0x20487a(0x274)]&&(await database_1[_0x20487a(0x26b)][_0x20487a(0x209)][_0x20487a(0x1e6)]({'where':{'telegramId':_0xedf1b0},'data':{'shopId':null,'isVerified':![]}}),console['log'](_0x20487a(0x1ae)+_0xedf1b0)),await this[_0x20487a(0x1ec)]?.[_0x20487a(0x211)](_0x5b417a,'🤖\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a'+_0x20487a(0x284)+_0x20487a(0x253)+_0x20487a(0x21a)+_0x20487a(0x232)+_0x20487a(0x26e),{'parse_mode':_0x20487a(0x1af)}));}catch(_0x3efe1d){console[_0x20487a(0x248)]('Error\x20handling\x20/start\x20command:',_0x3efe1d),await this[_0x20487a(0x1ec)]?.[_0x20487a(0x211)](_0x5b417a,_0x20487a(0x1f7));}}),this[_0x32d594(0x1ec)]['onText'](/\/disconnect/,async _0x1ec454=>{const _0x20e58c=_0x32d594,_0x4b959d=_0x1ec454[_0x20e58c(0x240)]['id'],_0x2fc256=_0x1ec454['from']?.['id'][_0x20e58c(0x215)]();if(!_0x2fc256)return;try{const _0x1e4d9c=await database_1[_0x20e58c(0x26b)][_0x20e58c(0x209)]['findUnique']({'where':{'telegramId':_0x2fc256},'include':{'shop':!![]}});if(!_0x1e4d9c||!_0x1e4d9c[_0x20e58c(0x274)]||!_0x1e4d9c[_0x20e58c(0x22d)]){await this['bot']?.['sendMessage'](_0x4b959d,_0x20e58c(0x288));return;}const _0x1a0f7c=_0x1e4d9c[_0x20e58c(0x1dc)]?.['name']||_0x20e58c(0x25a);await database_1[_0x20e58c(0x26b)]['telegramUser']['update']({'where':{'telegramId':_0x2fc256},'data':{'shopId':null,'isVerified':![]}}),console[_0x20e58c(0x23f)](_0x20e58c(0x238)+_0x2fc256+_0x20e58c(0x203)+_0x1e4d9c['shopId']),await this[_0x20e58c(0x1ec)]?.[_0x20e58c(0x211)](_0x4b959d,_0x20e58c(0x20f)+_0x1a0f7c+_0x20e58c(0x1c8)+'To\x20reconnect,\x20use\x20the\x20/start\x20command',{'parse_mode':_0x20e58c(0x1af)});}catch(_0x4abbe4){console[_0x20e58c(0x248)]('Error\x20handling\x20/disconnect\x20command:',_0x4abbe4),await this['bot']?.['sendMessage'](_0x4b959d,_0x20e58c(0x1f7));}}),this['bot'][_0x32d594(0x27f)](/\/status/,async _0x5f3c20=>{const _0x2ab099=_0x32d594,_0x42d8d1=_0x5f3c20[_0x2ab099(0x240)]['id'],_0x2021b2=_0x5f3c20[_0x2ab099(0x281)]?.['id'][_0x2ab099(0x215)]();if(!_0x2021b2)return;try{const _0x5b80b2=await database_1[_0x2ab099(0x26b)][_0x2ab099(0x209)]['findUnique']({'where':{'telegramId':_0x2021b2},'include':{'shop':!![]}});if(!_0x5b80b2){await this[_0x2ab099(0x1ec)]?.[_0x2ab099(0x211)](_0x42d8d1,_0x2ab099(0x26c)+_0x2ab099(0x1b4));return;}if(!_0x5b80b2[_0x2ab099(0x274)]||!_0x5b80b2[_0x2ab099(0x22d)]||!_0x5b80b2[_0x2ab099(0x1dc)]){await this[_0x2ab099(0x1ec)]?.[_0x2ab099(0x211)](_0x42d8d1,_0x2ab099(0x251)+_0x2ab099(0x1f1));return;}await this[_0x2ab099(0x1ec)]?.['sendMessage'](_0x42d8d1,_0x2ab099(0x1fb)+(_0x2ab099(0x249)+_0x5b80b2[_0x2ab099(0x1dc)][_0x2ab099(0x21f)]+'*\x0a')+(_0x2ab099(0x205)+_0x5b80b2[_0x2ab099(0x1dc)]['username']+'`\x0a')+(_0x2ab099(0x22f)+_0x5b80b2[_0x2ab099(0x27c)][_0x2ab099(0x22e)](_0x2ab099(0x25f))+'\x0a\x0a')+'🔔\x20Notifications\x20are\x20active\x0a\x0a'+'Commands:\x0a'+'/disconnect\x20-\x20disconnect\x20from\x20notifications',{'parse_mode':'Markdown'});}catch(_0x5e5e87){console['error'](_0x2ab099(0x23a),_0x5e5e87),await this[_0x2ab099(0x1ec)]?.[_0x2ab099(0x211)](_0x42d8d1,_0x2ab099(0x1f7));}}),this['bot']['onText'](/\/debug/,async _0x15f4c2=>{const _0x35dd94=_0x32d594,_0x3f7c48=_0x15f4c2[_0x35dd94(0x240)]['id'],_0xbde53f=_0x15f4c2['from']?.['id'][_0x35dd94(0x215)]();if(!_0xbde53f)return;try{const _0x27187e=await database_1[_0x35dd94(0x26b)]['shop'][_0x35dd94(0x270)]({'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![]},'take':0xa});let _0x8f72e6=_0x35dd94(0x1e0);_0x8f72e6+=_0x35dd94(0x229)+_0xbde53f+_0x35dd94(0x282),_0x8f72e6+=_0x35dd94(0x1cb),_0x27187e[_0x35dd94(0x25d)]((_0x3c04b9,_0x2f89b8)=>{const _0x82bfb6=_0x35dd94;_0x8f72e6+=_0x2f89b8+0x1+_0x82bfb6(0x1bd)+_0x3c04b9[_0x82bfb6(0x21f)]+'*\x0a',_0x8f72e6+=_0x82bfb6(0x1ad)+_0x3c04b9['username']+'`\x0a',_0x8f72e6+=_0x82bfb6(0x1e8)+_0x3c04b9[_0x82bfb6(0x202)]+'\x0a',_0x8f72e6+='\x20\x20\x20Public\x20Key:\x20`'+_0x3c04b9[_0x82bfb6(0x263)][_0x82bfb6(0x1b5)](0x0,0xf)+'...`\x0a\x0a';}),await this[_0x35dd94(0x1ec)]?.['sendMessage'](_0x3f7c48,_0x8f72e6,{'parse_mode':_0x35dd94(0x1af)});}catch(_0x38aa48){console['error'](_0x35dd94(0x1de),_0x38aa48),await this[_0x35dd94(0x1ec)]?.['sendMessage'](_0x3f7c48,_0x35dd94(0x22a));}}),this[_0x32d594(0x1ec)]['on']('message',async _0x5f03eb=>{const _0x38150d=_0x32d594;if(_0x5f03eb[_0x38150d(0x1ff)]?.[_0x38150d(0x228)]('/'))return;const _0x204913=_0x5f03eb[_0x38150d(0x240)]['id'],_0x53c53a=_0x5f03eb[_0x38150d(0x281)]?.['id'][_0x38150d(0x215)](),_0x5ec74f=_0x5f03eb['text']?.[_0x38150d(0x27b)]();if(!_0x53c53a||!_0x5ec74f)return;try{const _0x2f8ae0=await database_1[_0x38150d(0x26b)]['telegramUser'][_0x38150d(0x237)]({'where':{'telegramId':_0x53c53a},'include':{'shop':!![]}});if(!_0x2f8ae0){await this[_0x38150d(0x1ec)]?.['sendMessage'](_0x204913,_0x38150d(0x1d7));return;}if(_0x2f8ae0[_0x38150d(0x274)]&&_0x2f8ae0[_0x38150d(0x22d)]&&_0x2f8ae0[_0x38150d(0x1dc)]){await this['bot']?.['sendMessage'](_0x204913,_0x38150d(0x21c)+_0x2f8ae0[_0x38150d(0x1dc)][_0x38150d(0x21f)]+_0x38150d(0x1c8)+_0x38150d(0x1d9),{'parse_mode':_0x38150d(0x1af)});return;}const _0x3dceef=_0x5ec74f[_0x38150d(0x26f)](/\s+/);if(_0x3dceef[_0x38150d(0x275)]!==0x2){await this[_0x38150d(0x1ec)]?.[_0x38150d(0x211)](_0x204913,_0x38150d(0x246)+_0x38150d(0x253)+_0x38150d(0x21a)+_0x38150d(0x232)+('You\x20sent\x20'+_0x3dceef[_0x38150d(0x275)]+'\x20parts:\x20'+_0x3dceef[_0x38150d(0x1c5)](_0x59719e=>'`'+_0x59719e+'`')[_0x38150d(0x23c)](',\x20')),{'parse_mode':_0x38150d(0x1af)});return;}const [_0x49ee01,_0x5e4fd2]=_0x3dceef;console['log'](_0x38150d(0x21d)+_0x53c53a+_0x38150d(0x285)+_0x49ee01+'\x22,\x20apiKey=\x22'+_0x5e4fd2['substring'](0x0,0xa)+'...\x22'),await this[_0x38150d(0x250)](_0x204913,_0x53c53a,_0x49ee01,_0x5e4fd2);}catch(_0x4c28ce){console[_0x38150d(0x248)](_0x38150d(0x231),_0x4c28ce),await this[_0x38150d(0x1ec)]?.[_0x38150d(0x211)](_0x204913,_0x38150d(0x1f7));}}),this[_0x32d594(0x1ec)]['on'](_0x32d594(0x248),_0x518337=>{const _0x4d5c8a=_0x32d594;console[_0x4d5c8a(0x248)](_0x4d5c8a(0x224),_0x518337);}),this[_0x32d594(0x1ec)]['on'](_0x32d594(0x21e),_0x1320d3=>{const _0x1395ae=_0x32d594;console[_0x1395ae(0x248)](_0x1395ae(0x1e2),_0x1320d3);});}async[a52_0x3ef74d(0x250)](_0x5d705a,_0x30bfa6,_0x11cf3e,_0x2d4262){const _0x381b7c=a52_0x3ef74d;try{console['log'](_0x381b7c(0x21d)+_0x30bfa6+':\x20username=\x22'+_0x11cf3e+_0x381b7c(0x221)+_0x2d4262[_0x381b7c(0x1b5)](0x0,0xa)+_0x381b7c(0x1f5));if(!_0x11cf3e||_0x11cf3e['length']<0x3||_0x11cf3e[_0x381b7c(0x275)]>0x32||!/^[a-zA-Z0-9_]+$/[_0x381b7c(0x1b7)](_0x11cf3e)){await this[_0x381b7c(0x1ec)]?.[_0x381b7c(0x211)](_0x5d705a,_0x381b7c(0x280)+_0x11cf3e+_0x381b7c(0x282)+_0x381b7c(0x25b),{'parse_mode':_0x381b7c(0x1af)});return;}if(!_0x2d4262||!_0x2d4262[_0x381b7c(0x228)]('pk_')&&!_0x2d4262[_0x381b7c(0x228)](_0x381b7c(0x1bb))){await this['bot']?.['sendMessage'](_0x5d705a,_0x381b7c(0x256)+_0x381b7c(0x1d8),{'parse_mode':_0x381b7c(0x1af)});return;}const _0x543f75=await database_1['default'][_0x381b7c(0x1dc)][_0x381b7c(0x237)]({'where':{'username':_0x11cf3e},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x543f75){const _0x1656f2=await database_1[_0x381b7c(0x26b)]['shop'][_0x381b7c(0x270)]({'select':{'username':!![],'name':!![]},'take':0x5});let _0x1baffd='❌\x20Shop\x20with\x20username\x20`'+_0x11cf3e+_0x381b7c(0x212);_0x1656f2[_0x381b7c(0x275)]>0x0?(_0x1baffd+=_0x381b7c(0x206),_0x1656f2['forEach'](_0x3decfb=>{const _0x2861a7=_0x381b7c;_0x1baffd+=_0x2861a7(0x1cf)+_0x3decfb['username']+_0x2861a7(0x210)+_0x3decfb[_0x2861a7(0x21f)]+')\x0a';}),_0x1baffd+='\x0aCheck\x20spelling\x20and\x20try\x20again.'):_0x1baffd+=_0x381b7c(0x1f4);await this[_0x381b7c(0x1ec)]?.[_0x381b7c(0x211)](_0x5d705a,_0x1baffd,{'parse_mode':_0x381b7c(0x1af)});return;}if(_0x543f75[_0x381b7c(0x202)]!=='ACTIVE'){await this['bot']?.['sendMessage'](_0x5d705a,_0x381b7c(0x265)+_0x11cf3e+_0x381b7c(0x1bc)+'Contact\x20administrator.',{'parse_mode':_0x381b7c(0x1af)});return;}if(_0x543f75['publicKey']!==_0x2d4262&&_0x543f75[_0x381b7c(0x1b0)]!==_0x2d4262){await this['bot']?.[_0x381b7c(0x211)](_0x5d705a,_0x381b7c(0x261)+_0x11cf3e+_0x381b7c(0x24d)+'Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a'+'Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`',{'parse_mode':'Markdown'});return;}const _0x4f1a7e=await database_1[_0x381b7c(0x26b)][_0x381b7c(0x209)][_0x381b7c(0x1fa)]({'where':{'shopId':_0x543f75['id'],'isVerified':!![],'telegramId':{'not':_0x30bfa6}}});if(_0x4f1a7e){await this['bot']?.[_0x381b7c(0x211)](_0x5d705a,_0x381b7c(0x242)+_0x11cf3e+_0x381b7c(0x24d)+'Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.',{'parse_mode':_0x381b7c(0x1af)});return;}await database_1[_0x381b7c(0x26b)]['telegramUser'][_0x381b7c(0x1e6)]({'where':{'telegramId':_0x30bfa6},'data':{'shopId':_0x543f75['id'],'isVerified':!![]}}),await this[_0x381b7c(0x1ec)]?.[_0x381b7c(0x211)](_0x5d705a,_0x381b7c(0x1e1)+'✅\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a'+(_0x381b7c(0x24f)+_0x543f75[_0x381b7c(0x21f)]+'*\x0a')+('👤\x20Username:\x20`'+_0x543f75[_0x381b7c(0x24b)]+_0x381b7c(0x282))+_0x381b7c(0x1db)+_0x381b7c(0x273)+'•\x20Payment\x20status\x20changes\x0a'+_0x381b7c(0x269)+_0x381b7c(0x233)+'Commands:\x0a'+_0x381b7c(0x272)+_0x381b7c(0x20a),{'parse_mode':'Markdown'}),console[_0x381b7c(0x23f)](_0x381b7c(0x222)+_0x30bfa6+_0x381b7c(0x27e)+_0x543f75['username']+_0x381b7c(0x254));}catch(_0x89bab9){console[_0x381b7c(0x248)]('Error\x20in\x20handleSingleLineVerification:',_0x89bab9),await this['bot']?.[_0x381b7c(0x211)](_0x5d705a,'❌\x20An\x20error\x20occurred\x20while\x20verifying\x20data.');}}async[a52_0x3ef74d(0x204)](_0x17cb2e,_0x45ad63,_0x136bde){const _0x12a670=a52_0x3ef74d;if(!this['bot']){console[_0x12a670(0x245)]('Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification');return;}try{const _0x729915=await database_1[_0x12a670(0x26b)]['telegramUser'][_0x12a670(0x270)]({'where':{'shopId':_0x17cb2e,'isVerified':!![]}});if(_0x729915['length']===0x0){console[_0x12a670(0x23f)](_0x12a670(0x278)+_0x17cb2e);return;}const _0xf08b71=_0x729915[_0x12a670(0x1c5)](async _0x525130=>{const _0x26a16e=_0x12a670;try{await this['bot']?.[_0x26a16e(0x211)](_0x525130[_0x26a16e(0x23d)],_0x45ad63,_0x136bde),console[_0x26a16e(0x23f)]('✅\x20Notification\x20sent\x20to\x20Telegram\x20user\x20'+_0x525130[_0x26a16e(0x23d)]);}catch(_0x2063e6){console[_0x26a16e(0x248)](_0x26a16e(0x1ee)+_0x525130[_0x26a16e(0x23d)]+':',_0x2063e6),_0x2063e6 instanceof Error&&(_0x2063e6[_0x26a16e(0x1f9)][_0x26a16e(0x20e)](_0x26a16e(0x1b2))||_0x2063e6[_0x26a16e(0x1f9)][_0x26a16e(0x20e)]('chat\x20not\x20found')||_0x2063e6[_0x26a16e(0x1f9)][_0x26a16e(0x20e)](_0x26a16e(0x1d6)))&&(await database_1[_0x26a16e(0x26b)][_0x26a16e(0x209)]['update']({'where':{'id':_0x525130['id']},'data':{'isVerified':![]}}),console[_0x26a16e(0x23f)]('User\x20'+_0x525130['telegramId']+_0x26a16e(0x1cd)));}});await Promise[_0x12a670(0x1cc)](_0xf08b71);}catch(_0x44268c){console[_0x12a670(0x248)](_0x12a670(0x255),_0x44268c);}}async[a52_0x3ef74d(0x1f0)](_0x619a0a,_0x101ceb,_0x1ca8f9){const _0x268797=a52_0x3ef74d,_0x12d709={'created':'🆕','paid':'✅','failed':'❌','expired':'⏰','refund':'🔄','chargeback':'⚠️','processing':'⚙️'},_0x2dbd86={'created':_0x268797(0x219),'paid':_0x268797(0x28a),'failed':_0x268797(0x230),'expired':_0x268797(0x1df),'refund':_0x268797(0x1ef),'chargeback':_0x268797(0x1ac),'processing':'Payment\x20is\x20being\x20processed'},_0x454da4=_0x12d709[_0x1ca8f9],_0x17f4eb=_0x2dbd86[_0x1ca8f9],_0x5b9330=(0x0,gateway_1[_0x268797(0x1eb)])(_0x101ceb['gateway']);console[_0x268797(0x23f)]('📱\x20Telegram\x20notification:\x20gateway\x20\x22'+_0x101ceb[_0x268797(0x225)]+_0x268797(0x23b)+_0x5b9330+'\x22');let _0x207b8c=_0x454da4+'\x20*'+_0x17f4eb+'*\x0a\x0a'+('💰\x20Amount:\x20*'+_0x101ceb[_0x268797(0x1ca)]+'\x20'+_0x101ceb[_0x268797(0x227)]+'*\x0a')+(_0x268797(0x1c6)+(_0x101ceb[_0x268797(0x258)]||_0x101ceb['id'])+'`\x0a')+(_0x268797(0x1bf)+_0x101ceb['id']+'`\x0a')+('🏪\x20Gateway:\x20`'+_0x5b9330+'`\x0a')+(_0x268797(0x1b8)+new Date(_0x101ceb['createdAt'])[_0x268797(0x21b)](_0x268797(0x25f))+'\x0a');(_0x101ceb['customerName']||_0x101ceb[_0x268797(0x1ba)])&&(_0x207b8c+='\x0a👤\x20*Customer\x20Information:*\x0a',_0x101ceb[_0x268797(0x1b9)]&&(_0x207b8c+=_0x268797(0x207)+_0x101ceb[_0x268797(0x1b9)]+'`\x0a'),_0x101ceb[_0x268797(0x1ba)]&&(_0x207b8c+=_0x268797(0x1c9)+_0x101ceb['customerEmail']+'`\x0a')),_0x1ca8f9===_0x268797(0x283)&&_0x101ceb[_0x268797(0x1d0)]&&(_0x207b8c+=_0x268797(0x259)+_0x101ceb[_0x268797(0x1d0)]+'\x20USDT*\x0a'),_0x1ca8f9===_0x268797(0x262)&&(_0x207b8c+=_0x268797(0x1b3)),_0x101ceb[_0x268797(0x236)]&&(_0x207b8c+=_0x268797(0x27d)+_0x101ceb['adminNotes']+'\x0a'),await this['sendShopNotification'](_0x619a0a,_0x207b8c,{'parse_mode':_0x268797(0x1af)});}async[a52_0x3ef74d(0x213)](_0x1b6b2a,_0xbda1f4,_0x5e34a6){const _0x3a6951=a52_0x3ef74d,_0x1bd1e7={'created':'📤','completed':'✅','rejected':'❌'},_0x49382f={'created':_0x3a6951(0x24c),'completed':_0x3a6951(0x1be),'rejected':_0x3a6951(0x1d2)},_0x308b52=_0x1bd1e7[_0x5e34a6],_0x4b2024=_0x49382f[_0x5e34a6],_0x347b8d=_0x308b52+'\x20*'+_0x4b2024+_0x3a6951(0x279)+(_0x3a6951(0x25c)+_0xbda1f4[_0x3a6951(0x1ca)]+'\x20USD*\x0a')+(_0x3a6951(0x1da)+_0xbda1f4['method']+'`\x0a')+(_0x3a6951(0x208)+_0xbda1f4['id']+'`\x0a')+(_0x3a6951(0x1b8)+new Date(_0xbda1f4[_0x3a6951(0x1d3)])['toLocaleString'](_0x3a6951(0x25f))+'\x0a')+(_0xbda1f4[_0x3a6951(0x286)]?_0x3a6951(0x241)+_0xbda1f4[_0x3a6951(0x286)]+'`':'');await this[_0x3a6951(0x204)](_0x1b6b2a,_0x347b8d,{'parse_mode':_0x3a6951(0x1af)});}async['sendLoginNotification'](_0x37f033,_0x5156f4){const _0x520b8d=a52_0x3ef74d;try{const _0x2c06e4=await database_1[_0x520b8d(0x26b)][_0x520b8d(0x1ed)]['findUnique']({'where':{'shopId':_0x37f033},'select':{'notificationLogin':!![]}});if(!_0x2c06e4?.[_0x520b8d(0x234)]){console['log'](_0x520b8d(0x287)+_0x37f033);return;}const _0x4f225a=_0x5156f4['success']?'🔐':'🚨',_0x58f1dd=_0x5156f4[_0x520b8d(0x252)]?'Successful\x20login':'Failed\x20login\x20attempt';let _0x4c7b94=_0x4f225a+'\x20*'+_0x58f1dd+'*\x0a\x0a'+(_0x520b8d(0x205)+_0x5156f4[_0x520b8d(0x24b)]+'`\x0a')+(_0x520b8d(0x217)+_0x5156f4[_0x520b8d(0x1fd)][_0x520b8d(0x21b)](_0x520b8d(0x25f))+'\x0a');_0x5156f4['ipAddress']&&(_0x4c7b94+='🌐\x20IP\x20address:\x20`'+_0x5156f4[_0x520b8d(0x1d4)]+'`\x0a');if(_0x5156f4[_0x520b8d(0x276)]){const _0x26467f=_0x5156f4[_0x520b8d(0x276)][_0x520b8d(0x275)]>0x32?_0x5156f4[_0x520b8d(0x276)]['substring'](0x0,0x32)+_0x520b8d(0x1d1):_0x5156f4['userAgent'];_0x4c7b94+=_0x520b8d(0x216)+_0x26467f+'`\x0a';}!_0x5156f4['success']&&(_0x4c7b94+=_0x520b8d(0x26d)),await this[_0x520b8d(0x204)](_0x37f033,_0x4c7b94,{'parse_mode':'Markdown'}),console[_0x520b8d(0x23f)]('✅\x20Login\x20notification\x20sent\x20for\x20shop\x20'+_0x37f033+':\x20'+(_0x5156f4[_0x520b8d(0x252)]?'success':'failed'));}catch(_0x1c9ff7){console['error']('Failed\x20to\x20send\x20login\x20notification:',_0x1c9ff7);}}async['sendApiErrorNotification'](_0x2790d4,_0x5da84b){const _0x2bef0c=a52_0x3ef74d;try{const _0x9848b4=await database_1[_0x2bef0c(0x26b)]['shopSettings'][_0x2bef0c(0x237)]({'where':{'shopId':_0x2790d4},'select':{'notificationApiError':!![]}});if(!_0x9848b4?.[_0x2bef0c(0x239)]){console[_0x2bef0c(0x23f)](_0x2bef0c(0x20c)+_0x2790d4);return;}let _0x30d00e=_0x2bef0c(0x267)+('🔗\x20Endpoint:\x20`'+_0x5da84b[_0x2bef0c(0x1ea)]+'\x20'+_0x5da84b[_0x2bef0c(0x1c3)]+'`\x0a')+(_0x2bef0c(0x217)+_0x5da84b[_0x2bef0c(0x1fd)][_0x2bef0c(0x21b)]('en-US')+'\x0a');_0x5da84b[_0x2bef0c(0x1b1)]&&(_0x30d00e+='📊\x20Error\x20code:\x20`'+_0x5da84b[_0x2bef0c(0x1b1)]+'`\x0a'),_0x30d00e+=_0x2bef0c(0x214)+_0x5da84b['errorMessage']+'`\x0a',_0x5da84b['requestId']&&(_0x30d00e+=_0x2bef0c(0x1c2)+_0x5da84b['requestId']+'`\x0a'),_0x30d00e+=_0x2bef0c(0x235),await this[_0x2bef0c(0x204)](_0x2790d4,_0x30d00e,{'parse_mode':'Markdown'}),console['log'](_0x2bef0c(0x1f6)+_0x2790d4+':\x20'+_0x5da84b[_0x2bef0c(0x1c3)]);}catch(_0x10b4df){console['error'](_0x2bef0c(0x264),_0x10b4df);}}async[a52_0x3ef74d(0x243)](_0x2c6b2d,_0xc9fa79,_0x878a3f){const _0x1fb6ed=a52_0x3ef74d;let _0x38c476=_0x1fb6ed(0x22b)+_0xc9fa79+'*\x0a\x0a';for(const [_0x46e7fd,_0x32375f]of Object['entries'](_0x878a3f)){_0x32375f!==null&&_0x32375f!==undefined&&(_0x38c476+=_0x46e7fd+_0x1fb6ed(0x1c4)+_0x32375f+'`\x0a');}await this[_0x1fb6ed(0x204)](_0x2c6b2d,_0x38c476,{'parse_mode':_0x1fb6ed(0x1af)});}[a52_0x3ef74d(0x20d)](){const _0x4781ff=a52_0x3ef74d;return{'isActive':!!this[_0x4781ff(0x1ec)],'username':this[_0x4781ff(0x201)]};}[a52_0x3ef74d(0x1e4)](){const _0x365dc2=a52_0x3ef74d;this['bot']&&(this[_0x365dc2(0x1ec)][_0x365dc2(0x277)](),this[_0x365dc2(0x1ec)]=null,console['log'](_0x365dc2(0x27a)));}}function a52_0x503a(_0x597444,_0x55dcc4){const _0x1220a0=a52_0x1220();return a52_0x503a=function(_0x503a0b,_0x58a5e1){_0x503a0b=_0x503a0b-0x1ac;let _0x189370=_0x1220a0[_0x503a0b];return _0x189370;},a52_0x503a(_0x597444,_0x55dcc4);}function a52_0x1220(){const _0x34422a=['updatedAt','📝\x20Notes:\x20','\x20verified\x20for\x20shop\x20','onText','❌\x20Invalid\x20username\x20format:\x20`','from','`\x0a\x0a','chargeback','To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a',':\x20username=\x22','txid','📱\x20Login\x20notifications\x20disabled\x20for\x20shop\x20','❌\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.','25392IkQopr','Payment\x20successfully\x20paid','Payment\x20chargeback','\x20\x20\x20Username:\x20`','🔄\x20Reset\x20incomplete\x20verification\x20for\x20user\x20','Markdown','secretKey','statusCode','blocked','⏳\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a','Use\x20/start\x20to\x20begin.','substring','../config/database','test','📅\x20Date:\x20','customerName','customerEmail','sk_','`\x20is\x20inactive.\x0a\x0a','.\x20*','Payout\x20completed','🆔\x20Payment\x20ID:\x20`','node-telegram-bot-api','initializeBot','🆔\x20Request\x20ID:\x20`','endpoint',':\x20`','map','📝\x20Order\x20ID:\x20`','TelegramBotService','*.\x0a\x0a','📧\x20Email:\x20`','amount','🏪\x20Available\x20shops\x20in\x20system:\x0a','allSettled','\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure','153ogxryX','•\x20`','chargebackAmount','...','Payout\x20rejected','createdAt','ipAddress','66RNxAjw','user\x20is\x20deactivated','❌\x20Please\x20use\x20/start\x20command\x20first','API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.','🏦\x20Method:\x20`','🔔\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a','shop','1998320ZcJgCh','Error\x20handling\x20/debug\x20command:','Payment\x20expired','🔍\x20*Debug\x20Information*\x0a\x0a','🎉\x20*Congratulations!*\x0a\x0a','Telegram\x20bot\x20polling\x20error:','__importDefault','stopBot','145422IECjNh','update','📱\x20Created\x20new\x20Telegram\x20user:\x20','\x20\x20\x20Status:\x20','🔔\x20You\x20receive\x20notifications\x20about:\x0a','method','getGatewayDisplayNameForTelegram','bot','shopSettings','❌\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20','Payment\x20refund','sendPaymentNotification','Use\x20/start\x20to\x20connect.','5831012DrdQYb','6cSkqba','Check\x20spelling\x20and\x20try\x20again.','...\x22','✅\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20','❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','Commands:\x0a','message','findFirst','📊\x20*Connection\x20Status*\x0a\x0a','create','timestamp','defineProperty','text','setupBotHandlers','botUsername','status','\x20disconnected\x20from\x20shop\x20','sendShopNotification','👤\x20Username:\x20`','Available\x20usernames:\x0a','📛\x20Name:\x20`','🆔\x20Payout\x20ID:\x20`','telegramUser','/disconnect\x20-\x20disconnect\x20from\x20notifications','✅\x20Welcome\x20back!\x0a\x0a','📱\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20','getBotInfo','includes','✅\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*','`\x20(','sendMessage','`\x20not\x20found.\x0a\x0a','sendPayoutNotification','❌\x20Error:\x20`','toString','💻\x20Browser:\x20`','📅\x20Time:\x20','241171NnyDXK','New\x20payment\x20created','Example:\x0a','toLocaleString','✅\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*','🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20','polling_error','name','❌\x20Failed\x20to\x20initialize\x20Telegram\x20bot:','\x22,\x20apiKey=\x22','✅\x20Telegram\x20user\x20','botToken','Telegram\x20bot\x20error:','gateway','Username:\x20`','currency','startsWith','📱\x20Your\x20Telegram\x20ID:\x20`','❌\x20Error\x20getting\x20debug\x20information.','🔔\x20*','telegramBotService','shopId','toLocaleDateString','📅\x20Connection\x20date:\x20','Payment\x20failed','Error\x20handling\x20message:','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','•\x20Important\x20events\x0a\x0a','notificationLogin','\x0a💡\x20Check\x20your\x20request\x20or\x20contact\x20support.','adminNotes','findUnique','🔌\x20User\x20','notificationApiError','Error\x20handling\x20/status\x20command:','\x22\x20->\x20display\x20\x22','join','telegramId','\x20initialized\x20successfully','log','chat','🔗\x20TXID:\x20`','❌\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`','sendCustomNotification','last_name','warn','❌\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a','trapay_bot','error','✅\x20Connected\x20to\x20shop:\x20*','3541LSexfY','username','New\x20payout\x20created','`.\x0a\x0a','../types/gateway','📱\x20Shop:\x20*','handleSingleLineVerification','❌\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a','success','📝\x20Format:\x20`username\x20api_key`\x0a\x0a','\x20via\x20single-line\x20input','Error\x20sending\x20shop\x20notification:','❌\x20Invalid\x20API\x20key\x20format.\x0a\x0a','•\x20Payouts\x0a\x0a','orderId','💸\x20Penalty\x20amount:\x20*','unknown\x20shop','Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).','💸\x20Amount:\x20*','forEach','140dLthvr','en-US','env','❌\x20API\x20key\x20does\x20not\x20match\x20shop\x20`','processing','publicKey','Failed\x20to\x20send\x20API\x20error\x20notification:','❌\x20Shop\x20`','•\x20Payment\x20status\x20changes\x0a','🚨\x20*API\x20Error*\x0a\x0a','67112hdQwgl','•\x20Payouts\x0a','TELEGRAM_BOT_TOKEN','default','❌\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a','\x0a⚠️\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!','❗️\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!','split','findMany','__esModule','/status\x20-\x20check\x20connection\x20status\x0a','•\x20New\x20payments\x0a','isVerified','length','userAgent','stopPolling','No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20','*\x0a\x0a','🛑\x20Telegram\x20bot\x20stopped','trim'];a52_0x1220=function(){return _0x34422a;};return a52_0x1220();}exports[a52_0x3ef74d(0x1c7)]=TelegramBotService,exports[a52_0x3ef74d(0x22c)]=new TelegramBotService();