'use strict';const a55_0x1198e8=a55_0x2f63;(function(_0x245be5,_0x3946f7){const _0x39fa9a=a55_0x2f63,_0x41c050=_0x245be5();while(!![]){try{const _0x1da756=-parseInt(_0x39fa9a(0x245))/0x1+-parseInt(_0x39fa9a(0x2b8))/0x2+parseInt(_0x39fa9a(0x256))/0x3*(-parseInt(_0x39fa9a(0x298))/0x4)+-parseInt(_0x39fa9a(0x21b))/0x5*(-parseInt(_0x39fa9a(0x2b5))/0x6)+parseInt(_0x39fa9a(0x1ef))/0x7+parseInt(_0x39fa9a(0x27e))/0x8*(parseInt(_0x39fa9a(0x25e))/0x9)+parseInt(_0x39fa9a(0x216))/0xa;if(_0x1da756===_0x3946f7)break;else _0x41c050['push'](_0x41c050['shift']());}catch(_0x152436){_0x41c050['push'](_0x41c050['shift']());}}}(a55_0x1b1b,0x6426d));function a55_0x1b1b(){const _0x53893a=['/disconnect\x20-\x20disconnect\x20from\x20notifications','chat','❌\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a','customerIp','5LmRwfG','🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20','Error\x20handling\x20/disconnect\x20command:','Example:\x0a','📱\x20Telegram\x20notification:\x20gateway\x20\x22','startsWith','findMany','txid','substring','`\x20(','Commands:\x0a','🏪\x20Available\x20shops\x20in\x20system:\x0a','bot','orderId','💸\x20Amount:\x20*','failed','length','📛\x20Name:\x20`','❌\x20Shop\x20with\x20username\x20`','endpoint','/status\x20-\x20check\x20connection\x20status\x0a','shop','❗️\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!','requestId','TELEGRAM_BOT_USERNAME','publicKey','✅\x20Telegram\x20user\x20','map','No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20','Payment\x20chargeback','✅\x20Welcome\x20back!\x0a\x0a','statusCode','...','pk_','unknown\x20shop','sendShopNotification','chat\x20not\x20found','\x20USD*\x0a','`\x20is\x20inactive.\x0a\x0a','__esModule','shopSettings','You\x20sent\x20','429971QTblQR','toString','Error\x20handling\x20message:','🔔\x20You\x20receive\x20notifications\x20about:\x0a','🆔\x20Request\x20ID:\x20`','first_name','•\x20Payment\x20status\x20changes\x0a','*\x0a\x0a','•\x20Payouts\x0a','ACTIVE','env','from','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','✅\x20Telegram\x20bot\x20@','•\x20Important\x20events\x0a\x0a','User\x20','secretKey','6114GHjkmk','📝\x20Order\x20ID:\x20`','errorMessage','❌\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a','📧\x20Email:\x20`','onText','🔄\x20Reset\x20incomplete\x20verification\x20for\x20user\x20','entries','2552211CePnKD','📅\x20Time:\x20','allSettled','log','🔗\x20TXID:\x20`','toLocaleDateString','Successful\x20login','Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification','👤\x20Username:\x20`','💰\x20Amount:\x20*','📱\x20Created\x20new\x20Telegram\x20user:\x20','findFirst','username','message','❌\x20Error:\x20`','forEach','method','✅\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*','.\x20*','Payout\x20completed','Failed\x20login\x20attempt','TelegramBotService','telegramId','🔔\x20Notifications\x20are\x20active\x0a\x0a','default','🛑\x20Telegram\x20bot\x20stopped','Markdown','...\x22','🏦\x20Method:\x20`','Username:\x20`','name','gateway','8wxXrzL','amount','isVerified','🔌\x20User\x20','timestamp','Use\x20/start\x20to\x20begin.','🔔\x20*','❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','Payment\x20successfully\x20paid','setupBotHandlers','📅\x20Date:\x20','✅\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a','✅\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20','TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables','defineProperty','...`\x0a\x0a','`\x20not\x20found.\x0a\x0a','initializeBot','botToken','Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a','\x0a💡\x20Check\x20your\x20request\x20or\x20contact\x20support.','chargeback','\x0a⚠️\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!','\x0aCheck\x20spelling\x20and\x20try\x20again.','•\x20Payouts\x0a\x0a','trim','1028nwevWk','❌\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`','test','TELEGRAM_BOT_TOKEN','\x20via\x20single-line\x20input','trapay_bot','update','Failed\x20to\x20send\x20login\x20notification:','❌\x20API\x20key\x20does\x20not\x20match\x20shop\x20`','sendCustomNotification','🆔\x20Payout\x20ID:\x20`','\x20verified\x20for\x20shop\x20','📱\x20Login\x20notifications\x20disabled\x20for\x20shop\x20','findUnique','split','🏪\x20Gateway:\x20`','../types/gateway','🔍\x20*Debug\x20Information*\x0a\x0a','updatedAt','customerEmail','`\x0a\x0a','create','remitterIban',':\x20`','API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','❌\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.','Check\x20spelling\x20and\x20try\x20again.','sendMessage','error','3029772hcufgs','getBotInfo','❌\x20Invalid\x20username\x20format:\x20`','801128HsePdU','en-US','\x22\x20->\x20display\x20\x22','customerUa','\x22,\x20apiKey=\x22','adminNotes','Payment\x20is\x20being\x20processed','Error\x20handling\x20/status\x20command:','includes','📱\x20Your\x20Telegram\x20ID:\x20`','handleSingleLineVerification','telegramBotService','createdAt','Failed\x20to\x20send\x20API\x20error\x20notification:','sendPaymentNotification','status','join','Available\x20usernames:\x0a',':\x20username=\x22','../config/database','getGatewayDisplayNameForTelegram','482937XldBJf','Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`','\x20USDT*\x0a','\x20disconnected\x20from\x20shop\x20','Payment\x20refund','•\x20New\x20payments\x0a','❌\x20Shop\x20`','📝\x20Format:\x20`username\x20api_key`\x0a\x0a','stopBot','`.\x0a\x0a','Error\x20in\x20handleSingleLineVerification:','telegramUser','❌\x20Error\x20getting\x20debug\x20information.','✅\x20Connected\x20to\x20shop:\x20*','\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure','last_name','toLocaleString','❌\x20Please\x20use\x20/start\x20command\x20first','\x20\x20\x20Public\x20Key:\x20`','📱\x20Shop:\x20*','Payout\x20rejected','shopId','🔔\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a','success','\x20\x20\x20Status:\x20','🚨\x20*API\x20Error*\x0a\x0a','❌\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20','⏳\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a','💻\x20Browser:\x20`','To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a','userAgent','*.\x0a\x0a','📅\x20Connection\x20date:\x20','🆔\x20Payment\x20ID:\x20`','Error\x20handling\x20/debug\x20command:','node-telegram-bot-api','📊\x20Error\x20code:\x20`','Payment\x20expired','New\x20payout\x20created','9069900ZYbBwf'];a55_0x1b1b=function(){return _0x53893a;};return a55_0x1b1b();}var __importDefault=this&&this['__importDefault']||function(_0x4d236e){const _0x3d4119=a55_0x2f63;return _0x4d236e&&_0x4d236e[_0x3d4119(0x242)]?_0x4d236e:{'default':_0x4d236e};};function a55_0x2f63(_0x2f2f82,_0x184444){const _0x1b1bc4=a55_0x1b1b();return a55_0x2f63=function(_0x2f6376,_0x1232f3){_0x2f6376=_0x2f6376-0x1e3;let _0x2d4e43=_0x1b1bc4[_0x2f6376];return _0x2d4e43;},a55_0x2f63(_0x2f2f82,_0x184444);}Object[a55_0x1198e8(0x28c)](exports,'__esModule',{'value':!![]}),exports[a55_0x1198e8(0x1e5)]=exports[a55_0x1198e8(0x273)]=void 0x0;const node_telegram_bot_api_1=__importDefault(require(a55_0x1198e8(0x212))),database_1=__importDefault(require(a55_0x1198e8(0x1ed))),gateway_1=require(a55_0x1198e8(0x2a8));class TelegramBotService{constructor(){const _0x11f645=a55_0x1198e8;this[_0x11f645(0x227)]=null,this[_0x11f645(0x290)]=process[_0x11f645(0x24f)][_0x11f645(0x29b)]||'',this['botUsername']=process['env'][_0x11f645(0x233)]||_0x11f645(0x29d),this[_0x11f645(0x290)]?this[_0x11f645(0x28f)]():console['warn'](_0x11f645(0x28b));}['initializeBot'](){const _0x3c5b41=a55_0x1198e8;try{this[_0x3c5b41(0x227)]=new node_telegram_bot_api_1[(_0x3c5b41(0x276))](this[_0x3c5b41(0x290)],{'polling':!![]}),this[_0x3c5b41(0x287)](),console[_0x3c5b41(0x261)](_0x3c5b41(0x252)+this['botUsername']+'\x20initialized\x20successfully');}catch(_0x4f8df3){console[_0x3c5b41(0x2b4)]('❌\x20Failed\x20to\x20initialize\x20Telegram\x20bot:',_0x4f8df3);}}[a55_0x1198e8(0x287)](){const _0x34e6af=a55_0x1198e8;if(!this[_0x34e6af(0x227)])return;this['bot'][_0x34e6af(0x25b)](/\/start/,async _0x22bcd8=>{const _0x393101=_0x34e6af,_0x26dc72=_0x22bcd8[_0x393101(0x218)]['id'],_0x557ca6=_0x22bcd8[_0x393101(0x250)]?.['id'][_0x393101(0x246)](),_0x48eb3a=_0x22bcd8[_0x393101(0x250)]?.[_0x393101(0x26a)],_0x3ece5d=_0x22bcd8[_0x393101(0x250)]?.[_0x393101(0x24a)],_0x3cd498=_0x22bcd8[_0x393101(0x250)]?.[_0x393101(0x1fe)];if(!_0x557ca6)return;try{let _0x33c8c5=await database_1[_0x393101(0x276)]['telegramUser']['findUnique']({'where':{'telegramId':_0x557ca6},'include':{'shop':!![]}});!_0x33c8c5?(_0x33c8c5=await database_1[_0x393101(0x276)][_0x393101(0x1fa)][_0x393101(0x2ad)]({'data':{'telegramId':_0x557ca6,'username':_0x48eb3a,'firstName':_0x3ece5d,'lastName':_0x3cd498,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console[_0x393101(0x261)](_0x393101(0x268)+_0x557ca6+'\x20(@'+_0x48eb3a+')')):_0x33c8c5=await database_1[_0x393101(0x276)][_0x393101(0x1fa)]['update']({'where':{'telegramId':_0x557ca6},'data':{'username':_0x48eb3a,'firstName':_0x3ece5d,'lastName':_0x3cd498},'include':{'shop':!![]}}),_0x33c8c5['isVerified']&&_0x33c8c5[_0x393101(0x204)]&&_0x33c8c5[_0x393101(0x230)]?await this['bot']?.[_0x393101(0x2b3)](_0x26dc72,_0x393101(0x239)+('You\x20are\x20already\x20connected\x20to\x20shop:\x20*'+_0x33c8c5[_0x393101(0x230)][_0x393101(0x27c)]+'*\x0a')+(_0x393101(0x27b)+_0x33c8c5['shop']['username']+_0x393101(0x2ac))+_0x393101(0x248)+_0x393101(0x1f4)+'•\x20Payment\x20status\x20changes\x0a'+_0x393101(0x296)+'Commands:\x0a'+_0x393101(0x22f)+_0x393101(0x217),{'parse_mode':_0x393101(0x278)}):(_0x33c8c5[_0x393101(0x204)]&&!_0x33c8c5[_0x393101(0x280)]&&(await database_1[_0x393101(0x276)][_0x393101(0x1fa)][_0x393101(0x29e)]({'where':{'telegramId':_0x557ca6},'data':{'shopId':null,'isVerified':![]}}),console[_0x393101(0x261)](_0x393101(0x25c)+_0x557ca6)),await this['bot']?.[_0x393101(0x2b3)](_0x26dc72,'🤖\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a'+_0x393101(0x20c)+_0x393101(0x1f6)+_0x393101(0x21e)+_0x393101(0x251)+_0x393101(0x231),{'parse_mode':_0x393101(0x278)}));}catch(_0x154d7f){console[_0x393101(0x2b4)]('Error\x20handling\x20/start\x20command:',_0x154d7f),await this[_0x393101(0x227)]?.[_0x393101(0x2b3)](_0x26dc72,_0x393101(0x285));}}),this[_0x34e6af(0x227)][_0x34e6af(0x25b)](/\/disconnect/,async _0x4623e2=>{const _0x2fd062=_0x34e6af,_0x2a673e=_0x4623e2['chat']['id'],_0x17d61e=_0x4623e2['from']?.['id'][_0x2fd062(0x246)]();if(!_0x17d61e)return;try{const _0x3ef5d3=await database_1[_0x2fd062(0x276)]['telegramUser'][_0x2fd062(0x2a5)]({'where':{'telegramId':_0x17d61e},'include':{'shop':!![]}});if(!_0x3ef5d3||!_0x3ef5d3[_0x2fd062(0x280)]||!_0x3ef5d3[_0x2fd062(0x204)]){await this['bot']?.[_0x2fd062(0x2b3)](_0x2a673e,_0x2fd062(0x2b1));return;}const _0x4b2573=_0x3ef5d3[_0x2fd062(0x230)]?.[_0x2fd062(0x27c)]||_0x2fd062(0x23d);await database_1['default'][_0x2fd062(0x1fa)][_0x2fd062(0x29e)]({'where':{'telegramId':_0x17d61e},'data':{'shopId':null,'isVerified':![]}}),console[_0x2fd062(0x261)](_0x2fd062(0x281)+_0x17d61e+_0x2fd062(0x1f2)+_0x3ef5d3['shopId']),await this['bot']?.[_0x2fd062(0x2b3)](_0x2a673e,_0x2fd062(0x26f)+_0x4b2573+_0x2fd062(0x20e)+'To\x20reconnect,\x20use\x20the\x20/start\x20command',{'parse_mode':'Markdown'});}catch(_0x7155be){console[_0x2fd062(0x2b4)](_0x2fd062(0x21d),_0x7155be),await this['bot']?.['sendMessage'](_0x2a673e,_0x2fd062(0x285));}}),this['bot'][_0x34e6af(0x25b)](/\/status/,async _0x5c7a0e=>{const _0x2eabb5=_0x34e6af,_0x2a1d72=_0x5c7a0e[_0x2eabb5(0x218)]['id'],_0x561bc1=_0x5c7a0e['from']?.['id'][_0x2eabb5(0x246)]();if(!_0x561bc1)return;try{const _0x1f425c=await database_1[_0x2eabb5(0x276)][_0x2eabb5(0x1fa)][_0x2eabb5(0x2a5)]({'where':{'telegramId':_0x561bc1},'include':{'shop':!![]}});if(!_0x1f425c){await this[_0x2eabb5(0x227)]?.[_0x2eabb5(0x2b3)](_0x2a1d72,'❌\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a'+_0x2eabb5(0x283));return;}if(!_0x1f425c[_0x2eabb5(0x280)]||!_0x1f425c[_0x2eabb5(0x204)]||!_0x1f425c[_0x2eabb5(0x230)]){await this[_0x2eabb5(0x227)]?.[_0x2eabb5(0x2b3)](_0x2a1d72,_0x2eabb5(0x259)+'Use\x20/start\x20to\x20connect.');return;}await this[_0x2eabb5(0x227)]?.[_0x2eabb5(0x2b3)](_0x2a1d72,'📊\x20*Connection\x20Status*\x0a\x0a'+(_0x2eabb5(0x1fc)+_0x1f425c[_0x2eabb5(0x230)][_0x2eabb5(0x27c)]+'*\x0a')+(_0x2eabb5(0x266)+_0x1f425c[_0x2eabb5(0x230)]['username']+'`\x0a')+(_0x2eabb5(0x20f)+_0x1f425c[_0x2eabb5(0x2aa)][_0x2eabb5(0x263)](_0x2eabb5(0x2b9))+'\x0a\x0a')+_0x2eabb5(0x275)+_0x2eabb5(0x225)+_0x2eabb5(0x217),{'parse_mode':_0x2eabb5(0x278)});}catch(_0x50b07c){console['error'](_0x2eabb5(0x2bf),_0x50b07c),await this['bot']?.[_0x2eabb5(0x2b3)](_0x2a1d72,_0x2eabb5(0x285));}}),this[_0x34e6af(0x227)][_0x34e6af(0x25b)](/\/debug/,async _0x41a3fe=>{const _0x465670=_0x34e6af,_0xa709ab=_0x41a3fe[_0x465670(0x218)]['id'],_0x40e9c8=_0x41a3fe['from']?.['id'][_0x465670(0x246)]();if(!_0x40e9c8)return;try{const _0x4e0c66=await database_1['default'][_0x465670(0x230)][_0x465670(0x221)]({'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![]},'take':0xa});let _0x51dc87=_0x465670(0x2a9);_0x51dc87+=_0x465670(0x1e3)+_0x40e9c8+'`\x0a\x0a',_0x51dc87+=_0x465670(0x226),_0x4e0c66[_0x465670(0x26d)]((_0x1c83f0,_0x2dcbd4)=>{const _0x35191e=_0x465670;_0x51dc87+=_0x2dcbd4+0x1+_0x35191e(0x270)+_0x1c83f0[_0x35191e(0x27c)]+'*\x0a',_0x51dc87+='\x20\x20\x20Username:\x20`'+_0x1c83f0[_0x35191e(0x26a)]+'`\x0a',_0x51dc87+=_0x35191e(0x207)+_0x1c83f0[_0x35191e(0x1e9)]+'\x0a',_0x51dc87+=_0x35191e(0x201)+_0x1c83f0[_0x35191e(0x234)][_0x35191e(0x223)](0x0,0xf)+_0x35191e(0x28d);}),await this['bot']?.['sendMessage'](_0xa709ab,_0x51dc87,{'parse_mode':_0x465670(0x278)});}catch(_0x13983d){console[_0x465670(0x2b4)](_0x465670(0x211),_0x13983d),await this[_0x465670(0x227)]?.[_0x465670(0x2b3)](_0xa709ab,_0x465670(0x1fb));}}),this[_0x34e6af(0x227)]['on'](_0x34e6af(0x26b),async _0x557935=>{const _0x48159f=_0x34e6af;if(_0x557935['text']?.['startsWith']('/'))return;const _0x474849=_0x557935[_0x48159f(0x218)]['id'],_0x1e0fa9=_0x557935['from']?.['id'][_0x48159f(0x246)](),_0x12908b=_0x557935['text']?.[_0x48159f(0x297)]();if(!_0x1e0fa9||!_0x12908b)return;try{const _0x44e9df=await database_1['default'][_0x48159f(0x1fa)][_0x48159f(0x2a5)]({'where':{'telegramId':_0x1e0fa9},'include':{'shop':!![]}});if(!_0x44e9df){await this[_0x48159f(0x227)]?.[_0x48159f(0x2b3)](_0x474849,_0x48159f(0x200));return;}if(_0x44e9df[_0x48159f(0x280)]&&_0x44e9df[_0x48159f(0x204)]&&_0x44e9df[_0x48159f(0x230)]){await this[_0x48159f(0x227)]?.[_0x48159f(0x2b3)](_0x474849,'✅\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*'+_0x44e9df['shop'][_0x48159f(0x27c)]+'*.\x0a\x0a'+'Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.',{'parse_mode':_0x48159f(0x278)});return;}const _0x46702e=_0x12908b[_0x48159f(0x2a6)](/\s+/);if(_0x46702e[_0x48159f(0x22b)]!==0x2){await this['bot']?.[_0x48159f(0x2b3)](_0x474849,_0x48159f(0x219)+_0x48159f(0x1f6)+_0x48159f(0x21e)+_0x48159f(0x251)+(_0x48159f(0x244)+_0x46702e[_0x48159f(0x22b)]+'\x20parts:\x20'+_0x46702e[_0x48159f(0x236)](_0x36c0b4=>'`'+_0x36c0b4+'`')[_0x48159f(0x1ea)](',\x20')),{'parse_mode':_0x48159f(0x278)});return;}const [_0x1ae890,_0x38e942]=_0x46702e;console[_0x48159f(0x261)](_0x48159f(0x21c)+_0x1e0fa9+_0x48159f(0x1ec)+_0x1ae890+_0x48159f(0x2bc)+_0x38e942[_0x48159f(0x223)](0x0,0xa)+_0x48159f(0x279)),await this[_0x48159f(0x1e4)](_0x474849,_0x1e0fa9,_0x1ae890,_0x38e942);}catch(_0x28240a){console[_0x48159f(0x2b4)](_0x48159f(0x247),_0x28240a),await this['bot']?.[_0x48159f(0x2b3)](_0x474849,'❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this['bot']['on'](_0x34e6af(0x2b4),_0x3fea99=>{console['error']('Telegram\x20bot\x20error:',_0x3fea99);}),this[_0x34e6af(0x227)]['on']('polling_error',_0x3f9299=>{const _0x19274e=_0x34e6af;console[_0x19274e(0x2b4)]('Telegram\x20bot\x20polling\x20error:',_0x3f9299);});}async['handleSingleLineVerification'](_0x33b03a,_0x575df8,_0xdb68c5,_0x422484){const _0x3b08dc=a55_0x1198e8;try{console[_0x3b08dc(0x261)](_0x3b08dc(0x21c)+_0x575df8+_0x3b08dc(0x1ec)+_0xdb68c5+_0x3b08dc(0x2bc)+_0x422484['substring'](0x0,0xa)+_0x3b08dc(0x279));if(!_0xdb68c5||_0xdb68c5[_0x3b08dc(0x22b)]<0x3||_0xdb68c5[_0x3b08dc(0x22b)]>0x32||!/^[a-zA-Z0-9_]+$/[_0x3b08dc(0x29a)](_0xdb68c5)){await this[_0x3b08dc(0x227)]?.[_0x3b08dc(0x2b3)](_0x33b03a,_0x3b08dc(0x2b7)+_0xdb68c5+_0x3b08dc(0x2ac)+'Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).',{'parse_mode':'Markdown'});return;}if(!_0x422484||!_0x422484[_0x3b08dc(0x220)](_0x3b08dc(0x23c))&&!_0x422484[_0x3b08dc(0x220)]('sk_')){await this[_0x3b08dc(0x227)]?.[_0x3b08dc(0x2b3)](_0x33b03a,'❌\x20Invalid\x20API\x20key\x20format.\x0a\x0a'+_0x3b08dc(0x2b0),{'parse_mode':_0x3b08dc(0x278)});return;}const _0x336d6a=await database_1[_0x3b08dc(0x276)][_0x3b08dc(0x230)][_0x3b08dc(0x2a5)]({'where':{'username':_0xdb68c5},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x336d6a){const _0x3d5dfb=await database_1[_0x3b08dc(0x276)][_0x3b08dc(0x230)][_0x3b08dc(0x221)]({'select':{'username':!![],'name':!![]},'take':0x5});let _0x1eda5f=_0x3b08dc(0x22d)+_0xdb68c5+_0x3b08dc(0x28e);_0x3d5dfb[_0x3b08dc(0x22b)]>0x0?(_0x1eda5f+=_0x3b08dc(0x1eb),_0x3d5dfb[_0x3b08dc(0x26d)](_0x57ef82=>{const _0x4b28b0=_0x3b08dc;_0x1eda5f+='•\x20`'+_0x57ef82['username']+_0x4b28b0(0x224)+_0x57ef82['name']+')\x0a';}),_0x1eda5f+=_0x3b08dc(0x295)):_0x1eda5f+=_0x3b08dc(0x2b2);await this['bot']?.[_0x3b08dc(0x2b3)](_0x33b03a,_0x1eda5f,{'parse_mode':_0x3b08dc(0x278)});return;}if(_0x336d6a['status']!==_0x3b08dc(0x24e)){await this[_0x3b08dc(0x227)]?.['sendMessage'](_0x33b03a,_0x3b08dc(0x1f5)+_0xdb68c5+_0x3b08dc(0x241)+'Contact\x20administrator.',{'parse_mode':'Markdown'});return;}if(_0x336d6a[_0x3b08dc(0x234)]!==_0x422484&&_0x336d6a[_0x3b08dc(0x255)]!==_0x422484){await this[_0x3b08dc(0x227)]?.[_0x3b08dc(0x2b3)](_0x33b03a,_0x3b08dc(0x2a0)+_0xdb68c5+_0x3b08dc(0x1f8)+_0x3b08dc(0x291)+_0x3b08dc(0x1f0),{'parse_mode':'Markdown'});return;}const _0x256c88=await database_1[_0x3b08dc(0x276)][_0x3b08dc(0x1fa)][_0x3b08dc(0x269)]({'where':{'shopId':_0x336d6a['id'],'isVerified':!![],'telegramId':{'not':_0x575df8}}});if(_0x256c88){await this[_0x3b08dc(0x227)]?.[_0x3b08dc(0x2b3)](_0x33b03a,_0x3b08dc(0x299)+_0xdb68c5+'`.\x0a\x0a'+'Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.',{'parse_mode':'Markdown'});return;}await database_1[_0x3b08dc(0x276)]['telegramUser']['update']({'where':{'telegramId':_0x575df8},'data':{'shopId':_0x336d6a['id'],'isVerified':!![]}}),await this[_0x3b08dc(0x227)]?.['sendMessage'](_0x33b03a,'🎉\x20*Congratulations!*\x0a\x0a'+_0x3b08dc(0x289)+(_0x3b08dc(0x202)+_0x336d6a[_0x3b08dc(0x27c)]+'*\x0a')+(_0x3b08dc(0x266)+_0x336d6a['username']+_0x3b08dc(0x2ac))+_0x3b08dc(0x205)+_0x3b08dc(0x1f4)+_0x3b08dc(0x24b)+_0x3b08dc(0x24d)+_0x3b08dc(0x253)+_0x3b08dc(0x225)+'/status\x20-\x20check\x20connection\x20status\x0a'+_0x3b08dc(0x217),{'parse_mode':_0x3b08dc(0x278)}),console['log'](_0x3b08dc(0x235)+_0x575df8+_0x3b08dc(0x2a3)+_0x336d6a[_0x3b08dc(0x26a)]+_0x3b08dc(0x29c));}catch(_0x58a1c9){console[_0x3b08dc(0x2b4)](_0x3b08dc(0x1f9),_0x58a1c9),await this[_0x3b08dc(0x227)]?.['sendMessage'](_0x33b03a,'❌\x20An\x20error\x20occurred\x20while\x20verifying\x20data.');}}async[a55_0x1198e8(0x23e)](_0x118cb2,_0x309f84,_0x3a0281){const _0x3e5483=a55_0x1198e8;if(!this[_0x3e5483(0x227)]){console['warn'](_0x3e5483(0x265));return;}try{const _0xa3a2d=await database_1[_0x3e5483(0x276)]['telegramUser']['findMany']({'where':{'shopId':_0x118cb2,'isVerified':!![]}});if(_0xa3a2d[_0x3e5483(0x22b)]===0x0){console[_0x3e5483(0x261)](_0x3e5483(0x237)+_0x118cb2);return;}const _0x5eb793=_0xa3a2d['map'](async _0x25292d=>{const _0x2a9fda=_0x3e5483;try{await this[_0x2a9fda(0x227)]?.[_0x2a9fda(0x2b3)](_0x25292d[_0x2a9fda(0x274)],_0x309f84,_0x3a0281),console[_0x2a9fda(0x261)]('✅\x20Notification\x20sent\x20to\x20Telegram\x20user\x20'+_0x25292d[_0x2a9fda(0x274)]);}catch(_0x1bd3d2){console[_0x2a9fda(0x2b4)](_0x2a9fda(0x209)+_0x25292d[_0x2a9fda(0x274)]+':',_0x1bd3d2),_0x1bd3d2 instanceof Error&&(_0x1bd3d2['message']['includes']('blocked')||_0x1bd3d2['message'][_0x2a9fda(0x2c0)](_0x2a9fda(0x23f))||_0x1bd3d2['message'][_0x2a9fda(0x2c0)]('user\x20is\x20deactivated'))&&(await database_1[_0x2a9fda(0x276)]['telegramUser']['update']({'where':{'id':_0x25292d['id']},'data':{'isVerified':![]}}),console['log'](_0x2a9fda(0x254)+_0x25292d[_0x2a9fda(0x274)]+_0x2a9fda(0x1fd)));}});await Promise[_0x3e5483(0x260)](_0x5eb793);}catch(_0x6b93e5){console['error']('Error\x20sending\x20shop\x20notification:',_0x6b93e5);}}async[a55_0x1198e8(0x1e8)](_0x5009ab,_0x526090,_0x520126){const _0x4a0247=a55_0x1198e8,_0x324412={'created':'🆕','paid':'✅','failed':'❌','expired':'⏰','refund':'🔄','chargeback':'⚠️','processing':'⚙️'},_0x380101={'created':'New\x20payment\x20created','paid':_0x4a0247(0x286),'failed':'Payment\x20failed','expired':_0x4a0247(0x214),'refund':_0x4a0247(0x1f3),'chargeback':_0x4a0247(0x238),'processing':_0x4a0247(0x2be)},_0x56dd90=_0x324412[_0x520126],_0x2dbaa4=_0x380101[_0x520126],_0x277870=(0x0,gateway_1[_0x4a0247(0x1ee)])(_0x526090[_0x4a0247(0x27d)]);console[_0x4a0247(0x261)](_0x4a0247(0x21f)+_0x526090[_0x4a0247(0x27d)]+_0x4a0247(0x2ba)+_0x277870+'\x22');let _0x1d1040=_0x56dd90+'\x20*'+_0x2dbaa4+_0x4a0247(0x24c)+(_0x4a0247(0x267)+_0x526090[_0x4a0247(0x27f)]+'\x20'+_0x526090['currency']+'*\x0a')+(_0x4a0247(0x257)+(_0x526090[_0x4a0247(0x228)]||_0x526090['id'])+'`\x0a')+(_0x4a0247(0x210)+_0x526090['id']+'`\x0a')+(_0x4a0247(0x2a7)+_0x277870+'`\x0a')+(_0x4a0247(0x288)+new Date(_0x526090[_0x4a0247(0x1e6)])[_0x4a0247(0x1ff)](_0x4a0247(0x2b9))+'\x0a');if(_0x526090['customerName']||_0x526090[_0x4a0247(0x2ab)]||_0x526090[_0x4a0247(0x2ae)]||_0x526090['customerIp']||_0x526090[_0x4a0247(0x2bb)]){_0x1d1040+='\x0a👤\x20*Customer\x20Information:*\x0a';_0x526090['customerName']&&(_0x1d1040+=_0x4a0247(0x22c)+_0x526090['customerName']+'`\x0a');_0x526090['customerEmail']&&(_0x1d1040+=_0x4a0247(0x25a)+_0x526090[_0x4a0247(0x2ab)]+'`\x0a');_0x526090[_0x4a0247(0x2ae)]&&(_0x1d1040+='🏦\x20IBAN:\x20`'+_0x526090[_0x4a0247(0x2ae)]+'`\x0a');_0x526090['customerIp']&&(_0x1d1040+='🌐\x20IP:\x20`'+_0x526090[_0x4a0247(0x21a)]+'`\x0a');if(_0x526090['customerUa']){const _0x40d9ff=_0x526090['customerUa'][_0x4a0247(0x22b)]>0x32?_0x526090[_0x4a0247(0x2bb)][_0x4a0247(0x223)](0x0,0x32)+_0x4a0247(0x23b):_0x526090[_0x4a0247(0x2bb)];_0x1d1040+='💻\x20Browser:\x20`'+_0x40d9ff+'`\x0a';}}_0x520126===_0x4a0247(0x293)&&_0x526090['chargebackAmount']&&(_0x1d1040+='💸\x20Penalty\x20amount:\x20*'+_0x526090['chargebackAmount']+_0x4a0247(0x1f1)),_0x520126==='processing'&&(_0x1d1040+=_0x4a0247(0x20a)),_0x526090[_0x4a0247(0x2bd)]&&(_0x1d1040+='📝\x20Notes:\x20'+_0x526090[_0x4a0247(0x2bd)]+'\x0a'),await this[_0x4a0247(0x23e)](_0x5009ab,_0x1d1040,{'parse_mode':_0x4a0247(0x278)});}async['sendPayoutNotification'](_0x396a8f,_0x27b143,_0x21a632){const _0x5258b4=a55_0x1198e8,_0x2cd3aa={'created':'📤','completed':'✅','rejected':'❌'},_0x210972={'created':_0x5258b4(0x215),'completed':_0x5258b4(0x271),'rejected':_0x5258b4(0x203)},_0x5c16bc=_0x2cd3aa[_0x21a632],_0x394b47=_0x210972[_0x21a632],_0x2416fc=_0x5c16bc+'\x20*'+_0x394b47+_0x5258b4(0x24c)+(_0x5258b4(0x229)+_0x27b143['amount']+_0x5258b4(0x240))+(_0x5258b4(0x27a)+_0x27b143[_0x5258b4(0x26e)]+'`\x0a')+(_0x5258b4(0x2a2)+_0x27b143['id']+'`\x0a')+(_0x5258b4(0x288)+new Date(_0x27b143[_0x5258b4(0x1e6)])['toLocaleString'](_0x5258b4(0x2b9))+'\x0a')+(_0x27b143[_0x5258b4(0x222)]?_0x5258b4(0x262)+_0x27b143[_0x5258b4(0x222)]+'`':'');await this[_0x5258b4(0x23e)](_0x396a8f,_0x2416fc,{'parse_mode':_0x5258b4(0x278)});}async['sendLoginNotification'](_0x284a61,_0x10f862){const _0x38de2=a55_0x1198e8;try{const _0x24453c=await database_1[_0x38de2(0x276)][_0x38de2(0x243)][_0x38de2(0x2a5)]({'where':{'shopId':_0x284a61},'select':{'notificationLogin':!![]}});if(!_0x24453c?.['notificationLogin']){console[_0x38de2(0x261)](_0x38de2(0x2a4)+_0x284a61);return;}const _0xa4ef83=_0x10f862['success']?'🔐':'🚨',_0xa7e581=_0x10f862[_0x38de2(0x206)]?_0x38de2(0x264):_0x38de2(0x272);let _0x435af0=_0xa4ef83+'\x20*'+_0xa7e581+_0x38de2(0x24c)+(_0x38de2(0x266)+_0x10f862[_0x38de2(0x26a)]+'`\x0a')+(_0x38de2(0x25f)+_0x10f862[_0x38de2(0x282)][_0x38de2(0x1ff)](_0x38de2(0x2b9))+'\x0a');_0x10f862['ipAddress']&&(_0x435af0+='🌐\x20IP\x20address:\x20`'+_0x10f862['ipAddress']+'`\x0a');if(_0x10f862[_0x38de2(0x20d)]){const _0x562be8=_0x10f862[_0x38de2(0x20d)][_0x38de2(0x22b)]>0x32?_0x10f862['userAgent'][_0x38de2(0x223)](0x0,0x32)+'...':_0x10f862[_0x38de2(0x20d)];_0x435af0+=_0x38de2(0x20b)+_0x562be8+'`\x0a';}!_0x10f862['success']&&(_0x435af0+=_0x38de2(0x294)),await this['sendShopNotification'](_0x284a61,_0x435af0,{'parse_mode':_0x38de2(0x278)}),console[_0x38de2(0x261)]('✅\x20Login\x20notification\x20sent\x20for\x20shop\x20'+_0x284a61+':\x20'+(_0x10f862['success']?'success':_0x38de2(0x22a)));}catch(_0x30d5f4){console[_0x38de2(0x2b4)](_0x38de2(0x29f),_0x30d5f4);}}async['sendApiErrorNotification'](_0x212523,_0x2b1ecf){const _0x5a34c8=a55_0x1198e8;try{const _0x58efe6=await database_1[_0x5a34c8(0x276)]['shopSettings'][_0x5a34c8(0x2a5)]({'where':{'shopId':_0x212523},'select':{'notificationApiError':!![]}});if(!_0x58efe6?.['notificationApiError']){console[_0x5a34c8(0x261)]('📱\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20'+_0x212523);return;}let _0x117031=_0x5a34c8(0x208)+('🔗\x20Endpoint:\x20`'+_0x2b1ecf[_0x5a34c8(0x26e)]+'\x20'+_0x2b1ecf[_0x5a34c8(0x22e)]+'`\x0a')+('📅\x20Time:\x20'+_0x2b1ecf[_0x5a34c8(0x282)][_0x5a34c8(0x1ff)](_0x5a34c8(0x2b9))+'\x0a');_0x2b1ecf[_0x5a34c8(0x23a)]&&(_0x117031+=_0x5a34c8(0x213)+_0x2b1ecf['statusCode']+'`\x0a'),_0x117031+=_0x5a34c8(0x26c)+_0x2b1ecf[_0x5a34c8(0x258)]+'`\x0a',_0x2b1ecf[_0x5a34c8(0x232)]&&(_0x117031+=_0x5a34c8(0x249)+_0x2b1ecf[_0x5a34c8(0x232)]+'`\x0a'),_0x117031+=_0x5a34c8(0x292),await this[_0x5a34c8(0x23e)](_0x212523,_0x117031,{'parse_mode':_0x5a34c8(0x278)}),console[_0x5a34c8(0x261)](_0x5a34c8(0x28a)+_0x212523+':\x20'+_0x2b1ecf[_0x5a34c8(0x22e)]);}catch(_0x1f75d8){console[_0x5a34c8(0x2b4)](_0x5a34c8(0x1e7),_0x1f75d8);}}async[a55_0x1198e8(0x2a1)](_0x4a7449,_0x1d91ca,_0x4a562a){const _0x373bd8=a55_0x1198e8;let _0x1ae34e=_0x373bd8(0x284)+_0x1d91ca+_0x373bd8(0x24c);for(const [_0x44b7d4,_0x103a0e]of Object[_0x373bd8(0x25d)](_0x4a562a)){_0x103a0e!==null&&_0x103a0e!==undefined&&(_0x1ae34e+=_0x44b7d4+_0x373bd8(0x2af)+_0x103a0e+'`\x0a');}await this[_0x373bd8(0x23e)](_0x4a7449,_0x1ae34e,{'parse_mode':_0x373bd8(0x278)});}[a55_0x1198e8(0x2b6)](){const _0x517ffa=a55_0x1198e8;return{'isActive':!!this[_0x517ffa(0x227)],'username':this['botUsername']};}[a55_0x1198e8(0x1f7)](){const _0x4292b3=a55_0x1198e8;this[_0x4292b3(0x227)]&&(this[_0x4292b3(0x227)]['stopPolling'](),this['bot']=null,console[_0x4292b3(0x261)](_0x4292b3(0x277)));}}exports[a55_0x1198e8(0x273)]=TelegramBotService,exports[a55_0x1198e8(0x1e5)]=new TelegramBotService();