'use strict';function a55_0x533e(){const _0x1f060a=['❌\x20Invalid\x20username\x20format:\x20`','failed','User\x20','substring','3165320eYFrah','Payout\x20rejected','Payment\x20refund','findMany','timestamp','\x20via\x20single-line\x20input','📝\x20Notes:\x20','error','chat','warn','❗️\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!','New\x20payment\x20created','📧\x20Email:\x20`','❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','sendMessage','__importDefault','currency','🏪\x20Gateway:\x20`','status','16847842pRcEsu','📝\x20Order\x20ID:\x20`','sendPaymentNotification','🔔\x20*','🏦\x20IBAN:\x20`','*.\x0a\x0a','getGatewayDisplayNameForTelegram','env','initializeBot','🔌\x20User\x20','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','success','startsWith','telegramId','Error\x20in\x20handleSingleLineVerification:','unknown\x20shop','💸\x20Amount:\x20*','onText','Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.','✅\x20Telegram\x20user\x20','🔔\x20You\x20receive\x20notifications\x20about:\x0a','Markdown','chargebackAmount','❌\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a','Error\x20sending\x20shop\x20notification:','userAgent','log','\x20verified\x20for\x20shop\x20','\x0a👤\x20*Customer\x20Information:*\x0a','errorMessage','node-telegram-bot-api','Error\x20handling\x20/status\x20command:','\x22,\x20apiKey=\x22','•\x20Payouts\x0a\x0a','sendShopNotification','❌\x20API\x20key\x20does\x20not\x20match\x20shop\x20`','📱\x20Shop:\x20*','•\x20Important\x20events\x0a\x0a','endpoint','370LvlgJo',':\x20username=\x22','shopSettings','botUsername','entries','`\x20(','Failed\x20to\x20send\x20API\x20error\x20notification:','findFirst','ipAddress','❌\x20Error\x20getting\x20debug\x20information.','botToken','Username:\x20`','Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.','map','🔄\x20Reset\x20incomplete\x20verification\x20for\x20user\x20','adminNotes','📅\x20Time:\x20','Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).','New\x20payout\x20created','764289JhCjVd','Failed\x20login\x20attempt','en-US','method','join','🛑\x20Telegram\x20bot\x20stopped','/status\x20-\x20check\x20connection\x20status\x0a','username','To\x20reconnect,\x20use\x20the\x20/start\x20command','../types/gateway','\x0a💡\x20Check\x20your\x20request\x20or\x20contact\x20support.','Telegram\x20bot\x20polling\x20error:','🚨\x20*API\x20Error*\x0a\x0a','split','Commands:\x0a','\x20\x20\x20Public\x20Key:\x20`','⏳\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a','❌\x20Shop\x20with\x20username\x20`','API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','txid','trim','📱\x20Login\x20notifications\x20disabled\x20for\x20shop\x20','/disconnect\x20-\x20disconnect\x20from\x20notifications','text','customerIp','orderId','Use\x20/start\x20to\x20connect.','default','`.\x0a\x0a','3ZdjDNI','•\x20Payouts\x0a','Example:\x0a','🔔\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a','name','.\x20*','getBotInfo','🌐\x20IP\x20address:\x20`','setupBotHandlers','💻\x20Browser:\x20`','`\x0a\x0a','✅\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*','❌\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a','*\x0a\x0a','No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20','customerName','allSettled','❌\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`','telegramUser','processing','shop','first_name','trapay_bot','❌\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.','Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a','🏪\x20Available\x20shops\x20in\x20system:\x0a','customerUa','Payment\x20failed','gateway','TELEGRAM_BOT_TOKEN','\x20USD*\x0a','80OYNOFj','from','Payment\x20successfully\x20paid','Error\x20handling\x20/disconnect\x20command:','createdAt','user\x20is\x20deactivated','🔔\x20Notifications\x20are\x20active\x0a\x0a','Successful\x20login','notificationLogin','TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables','...\x22','📝\x20Format:\x20`username\x20api_key`\x0a\x0a','🆔\x20Payout\x20ID:\x20`','length','pk_','📱\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20','You\x20sent\x20','420jpCIsP','✅\x20Notification\x20sent\x20to\x20Telegram\x20user\x20','requestId','🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20','4024895tdGUJA','stopBot','📊\x20Error\x20code:\x20`','❌\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a','shopId','✅\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20','message','includes','toLocaleString','\x20parts:\x20','🆔\x20Request\x20ID:\x20`','sk_','✅\x20Telegram\x20bot\x20@','update','📊\x20*Connection\x20Status*\x0a\x0a','toString','toLocaleDateString','sendPayoutNotification','To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a','🔍\x20*Debug\x20Information*\x0a\x0a','publicKey','❌\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20','\x20initialized\x20successfully','📅\x20Connection\x20date:\x20','isVerified','Telegram\x20bot\x20error:','telegramBotService','sendCustomNotification','remitterIban','Error\x20handling\x20message:','You\x20are\x20already\x20connected\x20to\x20shop:\x20*','\x22\x20->\x20display\x20\x22','...','stopPolling','amount','🏦\x20Method:\x20`','📅\x20Date:\x20','8316536rOjKGC','\x20\x20\x20Status:\x20','handleSingleLineVerification','bot','❌\x20Failed\x20to\x20initialize\x20Telegram\x20bot:','2866rqqNNf','52590rIjePw','blocked','findUnique','📱\x20Created\x20new\x20Telegram\x20user:\x20','🤖\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a','chat\x20not\x20found','../config/database','📱\x20Your\x20Telegram\x20ID:\x20`','sendLoginNotification','`\x20not\x20found.\x0a\x0a','🆔\x20Payment\x20ID:\x20`','•\x20New\x20payments\x0a','❌\x20An\x20error\x20occurred\x20while\x20verifying\x20data.','✅\x20Welcome\x20back!\x0a\x0a','🔗\x20TXID:\x20`','📱\x20Telegram\x20notification:\x20gateway\x20\x22','🎉\x20*Congratulations!*\x0a\x0a','Payment\x20expired','customerEmail','polling_error','✅\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*','❌\x20Please\x20use\x20/start\x20command\x20first','Payment\x20is\x20being\x20processed','💸\x20Penalty\x20amount:\x20*','Payout\x20completed','❌\x20Invalid\x20API\x20key\x20format.\x0a\x0a','__esModule','statusCode','Error\x20handling\x20/debug\x20command:','Available\x20usernames:\x0a','👤\x20Username:\x20`','•\x20Payment\x20status\x20changes\x0a'];a55_0x533e=function(){return _0x1f060a;};return a55_0x533e();}const a55_0x3f14fa=a55_0x730a;(function(_0x432403,_0x4a908c){const _0x467db4=a55_0x730a,_0x4ebf67=_0x432403();while(!![]){try{const _0x5a947c=-parseInt(_0x467db4(0x1a9))/0x1*(parseInt(_0x467db4(0x208))/0x2)+parseInt(_0x467db4(0x238))/0x3*(-parseInt(_0x467db4(0x1ce))/0x4)+-parseInt(_0x467db4(0x1aa))/0x5*(-parseInt(_0x467db4(0x268))/0x6)+-parseInt(_0x467db4(0x26c))/0x7+parseInt(_0x467db4(0x291))/0x8+parseInt(_0x467db4(0x21b))/0x9*(-parseInt(_0x467db4(0x257))/0xa)+parseInt(_0x467db4(0x1e1))/0xb;if(_0x5a947c===_0x4a908c)break;else _0x4ebf67['push'](_0x4ebf67['shift']());}catch(_0x4255ce){_0x4ebf67['push'](_0x4ebf67['shift']());}}}(a55_0x533e,0xb29a4));function a55_0x730a(_0x171264,_0x2eac2b){const _0x533e01=a55_0x533e();return a55_0x730a=function(_0x730aaa,_0x49feb6){_0x730aaa=_0x730aaa-0x1a8;let _0x24b764=_0x533e01[_0x730aaa];return _0x24b764;},a55_0x730a(_0x171264,_0x2eac2b);}var __importDefault=this&&this[a55_0x3f14fa(0x1dd)]||function(_0x2af758){const _0x1632bc=a55_0x3f14fa;return _0x2af758&&_0x2af758[_0x1632bc(0x1c4)]?_0x2af758:{'default':_0x2af758};};Object['defineProperty'](exports,a55_0x3f14fa(0x1c4),{'value':!![]}),exports[a55_0x3f14fa(0x286)]=exports['TelegramBotService']=void 0x0;const node_telegram_bot_api_1=__importDefault(require(a55_0x3f14fa(0x1ff))),database_1=__importDefault(require(a55_0x3f14fa(0x1b0))),gateway_1=require(a55_0x3f14fa(0x224));class TelegramBotService{constructor(){const _0x37ca51=a55_0x3f14fa;this['bot']=null,this[_0x37ca51(0x212)]=process[_0x37ca51(0x1e8)][_0x37ca51(0x255)]||'',this[_0x37ca51(0x20b)]=process[_0x37ca51(0x1e8)]['TELEGRAM_BOT_USERNAME']||_0x37ca51(0x24e),this['botToken']?this[_0x37ca51(0x1e9)]():console[_0x37ca51(0x1d7)](_0x37ca51(0x260));}['initializeBot'](){const _0x2850ab=a55_0x3f14fa;try{this[_0x2850ab(0x294)]=new node_telegram_bot_api_1[(_0x2850ab(0x236))](this[_0x2850ab(0x212)],{'polling':!![]}),this['setupBotHandlers'](),console[_0x2850ab(0x1fb)](_0x2850ab(0x278)+this[_0x2850ab(0x20b)]+_0x2850ab(0x282));}catch(_0x1ead04){console[_0x2850ab(0x1d5)](_0x2850ab(0x1a8),_0x1ead04);}}[a55_0x3f14fa(0x240)](){const _0x4c00d5=a55_0x3f14fa;if(!this[_0x4c00d5(0x294)])return;this[_0x4c00d5(0x294)][_0x4c00d5(0x1f2)](/\/start/,async _0x26eb93=>{const _0x281c23=_0x4c00d5,_0x3b796c=_0x26eb93[_0x281c23(0x1d6)]['id'],_0x482541=_0x26eb93[_0x281c23(0x258)]?.['id']['toString'](),_0x73f211=_0x26eb93['from']?.[_0x281c23(0x222)],_0x33af0e=_0x26eb93[_0x281c23(0x258)]?.[_0x281c23(0x24d)],_0x1f9d57=_0x26eb93[_0x281c23(0x258)]?.['last_name'];if(!_0x482541)return;try{let _0x382a05=await database_1[_0x281c23(0x236)]['telegramUser'][_0x281c23(0x1ac)]({'where':{'telegramId':_0x482541},'include':{'shop':!![]}});!_0x382a05?(_0x382a05=await database_1['default'][_0x281c23(0x24a)]['create']({'data':{'telegramId':_0x482541,'username':_0x73f211,'firstName':_0x33af0e,'lastName':_0x1f9d57,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console['log'](_0x281c23(0x1ad)+_0x482541+'\x20(@'+_0x73f211+')')):_0x382a05=await database_1[_0x281c23(0x236)]['telegramUser'][_0x281c23(0x279)]({'where':{'telegramId':_0x482541},'data':{'username':_0x73f211,'firstName':_0x33af0e,'lastName':_0x1f9d57},'include':{'shop':!![]}}),_0x382a05[_0x281c23(0x284)]&&_0x382a05[_0x281c23(0x270)]&&_0x382a05[_0x281c23(0x24c)]?await this[_0x281c23(0x294)]?.[_0x281c23(0x1dc)](_0x3b796c,_0x281c23(0x1b7)+(_0x281c23(0x28a)+_0x382a05['shop'][_0x281c23(0x23c)]+'*\x0a')+(_0x281c23(0x213)+_0x382a05[_0x281c23(0x24c)][_0x281c23(0x222)]+'`\x0a\x0a')+_0x281c23(0x1f5)+_0x281c23(0x1b5)+'•\x20Payment\x20status\x20changes\x0a'+_0x281c23(0x202)+_0x281c23(0x229)+_0x281c23(0x221)+_0x281c23(0x231),{'parse_mode':_0x281c23(0x1f6)}):(_0x382a05[_0x281c23(0x270)]&&!_0x382a05[_0x281c23(0x284)]&&(await database_1[_0x281c23(0x236)][_0x281c23(0x24a)][_0x281c23(0x279)]({'where':{'telegramId':_0x482541},'data':{'shopId':null,'isVerified':![]}}),console['log'](_0x281c23(0x216)+_0x482541)),await this[_0x281c23(0x294)]?.['sendMessage'](_0x3b796c,_0x281c23(0x1ae)+_0x281c23(0x27e)+'📝\x20Format:\x20`username\x20api_key`\x0a\x0a'+'Example:\x0a'+'`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a'+_0x281c23(0x1d8),{'parse_mode':_0x281c23(0x1f6)}));}catch(_0x374e52){console['error']('Error\x20handling\x20/start\x20command:',_0x374e52),await this[_0x281c23(0x294)]?.[_0x281c23(0x1dc)](_0x3b796c,_0x281c23(0x1db));}}),this[_0x4c00d5(0x294)][_0x4c00d5(0x1f2)](/\/disconnect/,async _0x5cd818=>{const _0xe2beae=_0x4c00d5,_0x2cfa50=_0x5cd818[_0xe2beae(0x1d6)]['id'],_0x446495=_0x5cd818[_0xe2beae(0x258)]?.['id'][_0xe2beae(0x27b)]();if(!_0x446495)return;try{const _0x2f00eb=await database_1[_0xe2beae(0x236)][_0xe2beae(0x24a)][_0xe2beae(0x1ac)]({'where':{'telegramId':_0x446495},'include':{'shop':!![]}});if(!_0x2f00eb||!_0x2f00eb[_0xe2beae(0x284)]||!_0x2f00eb[_0xe2beae(0x270)]){await this[_0xe2beae(0x294)]?.['sendMessage'](_0x2cfa50,_0xe2beae(0x24f));return;}const _0xda2d3d=_0x2f00eb[_0xe2beae(0x24c)]?.['name']||_0xe2beae(0x1f0);await database_1['default'][_0xe2beae(0x24a)][_0xe2beae(0x279)]({'where':{'telegramId':_0x446495},'data':{'shopId':null,'isVerified':![]}}),console[_0xe2beae(0x1fb)](_0xe2beae(0x1ea)+_0x446495+'\x20disconnected\x20from\x20shop\x20'+_0x2f00eb[_0xe2beae(0x270)]),await this['bot']?.[_0xe2beae(0x1dc)](_0x2cfa50,_0xe2beae(0x1be)+_0xda2d3d+_0xe2beae(0x1e6)+_0xe2beae(0x223),{'parse_mode':_0xe2beae(0x1f6)});}catch(_0x51b090){console[_0xe2beae(0x1d5)](_0xe2beae(0x25a),_0x51b090),await this['bot']?.['sendMessage'](_0x2cfa50,_0xe2beae(0x1db));}}),this[_0x4c00d5(0x294)][_0x4c00d5(0x1f2)](/\/status/,async _0x31087a=>{const _0x3e9ff0=_0x4c00d5,_0x4b68f1=_0x31087a[_0x3e9ff0(0x1d6)]['id'],_0x6f9b8e=_0x31087a['from']?.['id']['toString']();if(!_0x6f9b8e)return;try{const _0x27417f=await database_1[_0x3e9ff0(0x236)]['telegramUser'][_0x3e9ff0(0x1ac)]({'where':{'telegramId':_0x6f9b8e},'include':{'shop':!![]}});if(!_0x27417f){await this['bot']?.[_0x3e9ff0(0x1dc)](_0x4b68f1,_0x3e9ff0(0x1f8)+'Use\x20/start\x20to\x20begin.');return;}if(!_0x27417f['isVerified']||!_0x27417f[_0x3e9ff0(0x270)]||!_0x27417f[_0x3e9ff0(0x24c)]){await this[_0x3e9ff0(0x294)]?.[_0x3e9ff0(0x1dc)](_0x4b68f1,_0x3e9ff0(0x244)+_0x3e9ff0(0x235));return;}await this['bot']?.['sendMessage'](_0x4b68f1,_0x3e9ff0(0x27a)+('✅\x20Connected\x20to\x20shop:\x20*'+_0x27417f[_0x3e9ff0(0x24c)][_0x3e9ff0(0x23c)]+'*\x0a')+(_0x3e9ff0(0x1c8)+_0x27417f[_0x3e9ff0(0x24c)][_0x3e9ff0(0x222)]+'`\x0a')+(_0x3e9ff0(0x283)+_0x27417f['updatedAt'][_0x3e9ff0(0x27c)](_0x3e9ff0(0x21d))+'\x0a\x0a')+_0x3e9ff0(0x25d)+_0x3e9ff0(0x229)+_0x3e9ff0(0x231),{'parse_mode':_0x3e9ff0(0x1f6)});}catch(_0x203d6c){console[_0x3e9ff0(0x1d5)](_0x3e9ff0(0x200),_0x203d6c),await this[_0x3e9ff0(0x294)]?.['sendMessage'](_0x4b68f1,_0x3e9ff0(0x1db));}}),this[_0x4c00d5(0x294)][_0x4c00d5(0x1f2)](/\/debug/,async _0x3e9196=>{const _0x3c2683=_0x4c00d5,_0x422770=_0x3e9196[_0x3c2683(0x1d6)]['id'],_0x549e2b=_0x3e9196[_0x3c2683(0x258)]?.['id'][_0x3c2683(0x27b)]();if(!_0x549e2b)return;try{const _0x5de6aa=await database_1[_0x3c2683(0x236)][_0x3c2683(0x24c)][_0x3c2683(0x1d1)]({'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![]},'take':0xa});let _0x51ea71=_0x3c2683(0x27f);_0x51ea71+=_0x3c2683(0x1b1)+_0x549e2b+'`\x0a\x0a',_0x51ea71+=_0x3c2683(0x251),_0x5de6aa['forEach']((_0x58880f,_0x4720d5)=>{const _0x35bb26=_0x3c2683;_0x51ea71+=_0x4720d5+0x1+_0x35bb26(0x23d)+_0x58880f[_0x35bb26(0x23c)]+'*\x0a',_0x51ea71+='\x20\x20\x20Username:\x20`'+_0x58880f[_0x35bb26(0x222)]+'`\x0a',_0x51ea71+=_0x35bb26(0x292)+_0x58880f[_0x35bb26(0x1e0)]+'\x0a',_0x51ea71+=_0x35bb26(0x22a)+_0x58880f[_0x35bb26(0x280)][_0x35bb26(0x1cd)](0x0,0xf)+'...`\x0a\x0a';}),await this[_0x3c2683(0x294)]?.[_0x3c2683(0x1dc)](_0x422770,_0x51ea71,{'parse_mode':_0x3c2683(0x1f6)});}catch(_0x2cf6ae){console[_0x3c2683(0x1d5)](_0x3c2683(0x1c6),_0x2cf6ae),await this[_0x3c2683(0x294)]?.['sendMessage'](_0x422770,_0x3c2683(0x211));}}),this[_0x4c00d5(0x294)]['on'](_0x4c00d5(0x272),async _0x275f73=>{const _0x546383=_0x4c00d5;if(_0x275f73[_0x546383(0x232)]?.['startsWith']('/'))return;const _0x26b43e=_0x275f73[_0x546383(0x1d6)]['id'],_0x22fc19=_0x275f73['from']?.['id']['toString'](),_0x5a75c3=_0x275f73[_0x546383(0x232)]?.[_0x546383(0x22f)]();if(!_0x22fc19||!_0x5a75c3)return;try{const _0x324bcd=await database_1['default']['telegramUser'][_0x546383(0x1ac)]({'where':{'telegramId':_0x22fc19},'include':{'shop':!![]}});if(!_0x324bcd){await this['bot']?.[_0x546383(0x1dc)](_0x26b43e,_0x546383(0x1bf));return;}if(_0x324bcd['isVerified']&&_0x324bcd[_0x546383(0x270)]&&_0x324bcd[_0x546383(0x24c)]){await this[_0x546383(0x294)]?.[_0x546383(0x1dc)](_0x26b43e,_0x546383(0x243)+_0x324bcd[_0x546383(0x24c)]['name']+_0x546383(0x1e6)+_0x546383(0x214),{'parse_mode':_0x546383(0x1f6)});return;}const _0x4ef94e=_0x5a75c3[_0x546383(0x228)](/\s+/);if(_0x4ef94e[_0x546383(0x264)]!==0x2){await this[_0x546383(0x294)]?.[_0x546383(0x1dc)](_0x26b43e,_0x546383(0x26f)+_0x546383(0x262)+_0x546383(0x23a)+_0x546383(0x1eb)+(_0x546383(0x267)+_0x4ef94e[_0x546383(0x264)]+_0x546383(0x275)+_0x4ef94e[_0x546383(0x215)](_0x157453=>'`'+_0x157453+'`')[_0x546383(0x21f)](',\x20')),{'parse_mode':'Markdown'});return;}const [_0x309287,_0x481e00]=_0x4ef94e;console['log'](_0x546383(0x26b)+_0x22fc19+_0x546383(0x209)+_0x309287+_0x546383(0x201)+_0x481e00[_0x546383(0x1cd)](0x0,0xa)+_0x546383(0x261)),await this[_0x546383(0x293)](_0x26b43e,_0x22fc19,_0x309287,_0x481e00);}catch(_0x34dcd0){console[_0x546383(0x1d5)](_0x546383(0x289),_0x34dcd0),await this[_0x546383(0x294)]?.[_0x546383(0x1dc)](_0x26b43e,'❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this['bot']['on']('error',_0x1a472e=>{const _0x551ef4=_0x4c00d5;console[_0x551ef4(0x1d5)](_0x551ef4(0x285),_0x1a472e);}),this[_0x4c00d5(0x294)]['on'](_0x4c00d5(0x1bd),_0x9750a1=>{const _0x49c45f=_0x4c00d5;console[_0x49c45f(0x1d5)](_0x49c45f(0x226),_0x9750a1);});}async[a55_0x3f14fa(0x293)](_0x191642,_0x3a58b5,_0x20a004,_0x18b756){const _0x5c858f=a55_0x3f14fa;try{console[_0x5c858f(0x1fb)]('🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20'+_0x3a58b5+_0x5c858f(0x209)+_0x20a004+_0x5c858f(0x201)+_0x18b756[_0x5c858f(0x1cd)](0x0,0xa)+_0x5c858f(0x261));if(!_0x20a004||_0x20a004['length']<0x3||_0x20a004[_0x5c858f(0x264)]>0x32||!/^[a-zA-Z0-9_]+$/['test'](_0x20a004)){await this[_0x5c858f(0x294)]?.[_0x5c858f(0x1dc)](_0x191642,_0x5c858f(0x1ca)+_0x20a004+_0x5c858f(0x242)+_0x5c858f(0x219),{'parse_mode':_0x5c858f(0x1f6)});return;}if(!_0x18b756||!_0x18b756['startsWith'](_0x5c858f(0x265))&&!_0x18b756[_0x5c858f(0x1ed)](_0x5c858f(0x277))){await this['bot']?.[_0x5c858f(0x1dc)](_0x191642,_0x5c858f(0x1c3)+_0x5c858f(0x22d),{'parse_mode':_0x5c858f(0x1f6)});return;}const _0x5bf480=await database_1[_0x5c858f(0x236)][_0x5c858f(0x24c)]['findUnique']({'where':{'username':_0x20a004},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x5bf480){const _0x5f0ad6=await database_1[_0x5c858f(0x236)][_0x5c858f(0x24c)]['findMany']({'select':{'username':!![],'name':!![]},'take':0x5});let _0x10d4ef=_0x5c858f(0x22c)+_0x20a004+_0x5c858f(0x1b3);_0x5f0ad6[_0x5c858f(0x264)]>0x0?(_0x10d4ef+=_0x5c858f(0x1c7),_0x5f0ad6['forEach'](_0x3f1bd2=>{const _0x13d734=_0x5c858f;_0x10d4ef+='•\x20`'+_0x3f1bd2['username']+_0x13d734(0x20d)+_0x3f1bd2[_0x13d734(0x23c)]+')\x0a';}),_0x10d4ef+='\x0aCheck\x20spelling\x20and\x20try\x20again.'):_0x10d4ef+='Check\x20spelling\x20and\x20try\x20again.';await this['bot']?.[_0x5c858f(0x1dc)](_0x191642,_0x10d4ef,{'parse_mode':_0x5c858f(0x1f6)});return;}if(_0x5bf480[_0x5c858f(0x1e0)]!=='ACTIVE'){await this[_0x5c858f(0x294)]?.[_0x5c858f(0x1dc)](_0x191642,'❌\x20Shop\x20`'+_0x20a004+'`\x20is\x20inactive.\x0a\x0a'+'Contact\x20administrator.',{'parse_mode':_0x5c858f(0x1f6)});return;}if(_0x5bf480[_0x5c858f(0x280)]!==_0x18b756&&_0x5bf480['secretKey']!==_0x18b756){await this[_0x5c858f(0x294)]?.[_0x5c858f(0x1dc)](_0x191642,_0x5c858f(0x204)+_0x20a004+_0x5c858f(0x237)+_0x5c858f(0x250)+'Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`',{'parse_mode':_0x5c858f(0x1f6)});return;}const _0x358ca2=await database_1['default'][_0x5c858f(0x24a)][_0x5c858f(0x20f)]({'where':{'shopId':_0x5bf480['id'],'isVerified':!![],'telegramId':{'not':_0x3a58b5}}});if(_0x358ca2){await this[_0x5c858f(0x294)]?.[_0x5c858f(0x1dc)](_0x191642,_0x5c858f(0x249)+_0x20a004+'`.\x0a\x0a'+_0x5c858f(0x1f3),{'parse_mode':_0x5c858f(0x1f6)});return;}await database_1[_0x5c858f(0x236)]['telegramUser'][_0x5c858f(0x279)]({'where':{'telegramId':_0x3a58b5},'data':{'shopId':_0x5bf480['id'],'isVerified':!![]}}),await this[_0x5c858f(0x294)]?.[_0x5c858f(0x1dc)](_0x191642,_0x5c858f(0x1ba)+'✅\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a'+(_0x5c858f(0x205)+_0x5bf480[_0x5c858f(0x23c)]+'*\x0a')+('👤\x20Username:\x20`'+_0x5bf480[_0x5c858f(0x222)]+_0x5c858f(0x242))+_0x5c858f(0x23b)+_0x5c858f(0x1b5)+_0x5c858f(0x1c9)+_0x5c858f(0x239)+_0x5c858f(0x206)+_0x5c858f(0x229)+_0x5c858f(0x221)+_0x5c858f(0x231),{'parse_mode':'Markdown'}),console[_0x5c858f(0x1fb)](_0x5c858f(0x1f4)+_0x3a58b5+_0x5c858f(0x1fc)+_0x5bf480[_0x5c858f(0x222)]+_0x5c858f(0x1d3));}catch(_0x11532a){console[_0x5c858f(0x1d5)](_0x5c858f(0x1ef),_0x11532a),await this[_0x5c858f(0x294)]?.[_0x5c858f(0x1dc)](_0x191642,_0x5c858f(0x1b6));}}async[a55_0x3f14fa(0x203)](_0x35144d,_0x2c218e,_0x5493ab){const _0x294cb4=a55_0x3f14fa;if(!this['bot']){console[_0x294cb4(0x1d7)]('Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification');return;}try{const _0x24a34e=await database_1[_0x294cb4(0x236)][_0x294cb4(0x24a)][_0x294cb4(0x1d1)]({'where':{'shopId':_0x35144d,'isVerified':!![]}});if(_0x24a34e[_0x294cb4(0x264)]===0x0){console['log'](_0x294cb4(0x246)+_0x35144d);return;}const _0x103799=_0x24a34e['map'](async _0x381686=>{const _0x2a168d=_0x294cb4;try{await this[_0x2a168d(0x294)]?.[_0x2a168d(0x1dc)](_0x381686[_0x2a168d(0x1ee)],_0x2c218e,_0x5493ab),console[_0x2a168d(0x1fb)](_0x2a168d(0x269)+_0x381686[_0x2a168d(0x1ee)]);}catch(_0x21de3f){console[_0x2a168d(0x1d5)](_0x2a168d(0x281)+_0x381686[_0x2a168d(0x1ee)]+':',_0x21de3f),_0x21de3f instanceof Error&&(_0x21de3f[_0x2a168d(0x272)][_0x2a168d(0x273)](_0x2a168d(0x1ab))||_0x21de3f[_0x2a168d(0x272)][_0x2a168d(0x273)](_0x2a168d(0x1af))||_0x21de3f[_0x2a168d(0x272)][_0x2a168d(0x273)](_0x2a168d(0x25c)))&&(await database_1[_0x2a168d(0x236)][_0x2a168d(0x24a)][_0x2a168d(0x279)]({'where':{'id':_0x381686['id']},'data':{'isVerified':![]}}),console[_0x2a168d(0x1fb)](_0x2a168d(0x1cc)+_0x381686[_0x2a168d(0x1ee)]+'\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure'));}});await Promise[_0x294cb4(0x248)](_0x103799);}catch(_0x10152e){console['error'](_0x294cb4(0x1f9),_0x10152e);}}async[a55_0x3f14fa(0x1e3)](_0x195544,_0xc7c1c6,_0x3ab060){const _0x5130d4=a55_0x3f14fa,_0x311f8b={'created':'🆕','paid':'✅','failed':'❌','expired':'⏰','refund':'🔄','chargeback':'⚠️','processing':'⚙️'},_0x4d5e0b={'created':_0x5130d4(0x1d9),'paid':_0x5130d4(0x259),'failed':_0x5130d4(0x253),'expired':_0x5130d4(0x1bb),'refund':_0x5130d4(0x1d0),'chargeback':'Payment\x20chargeback','processing':_0x5130d4(0x1c0)},_0x1db792=_0x311f8b[_0x3ab060],_0x2eb173=_0x4d5e0b[_0x3ab060],_0xc1a7a0=(0x0,gateway_1[_0x5130d4(0x1e7)])(_0xc7c1c6['gateway']);console[_0x5130d4(0x1fb)](_0x5130d4(0x1b9)+_0xc7c1c6[_0x5130d4(0x254)]+_0x5130d4(0x28b)+_0xc1a7a0+'\x22');let _0x5ee4d8=_0x1db792+'\x20*'+_0x2eb173+_0x5130d4(0x245)+('💰\x20Amount:\x20*'+_0xc7c1c6[_0x5130d4(0x28e)]+'\x20'+_0xc7c1c6[_0x5130d4(0x1de)]+'*\x0a')+(_0x5130d4(0x1e2)+(_0xc7c1c6[_0x5130d4(0x234)]||_0xc7c1c6['id'])+'`\x0a')+(_0x5130d4(0x1b4)+_0xc7c1c6['id']+'`\x0a')+(_0x5130d4(0x1df)+_0xc1a7a0+'`\x0a')+(_0x5130d4(0x290)+new Date(_0xc7c1c6[_0x5130d4(0x25b)])[_0x5130d4(0x274)](_0x5130d4(0x21d))+'\x0a');if(_0xc7c1c6['customerName']||_0xc7c1c6['customerEmail']||_0xc7c1c6[_0x5130d4(0x288)]||_0xc7c1c6['customerIp']||_0xc7c1c6['customerUa']){_0x5ee4d8+=_0x5130d4(0x1fd);_0xc7c1c6[_0x5130d4(0x247)]&&(_0x5ee4d8+='📛\x20Name:\x20`'+_0xc7c1c6[_0x5130d4(0x247)]+'`\x0a');_0xc7c1c6[_0x5130d4(0x1bc)]&&(_0x5ee4d8+=_0x5130d4(0x1da)+_0xc7c1c6[_0x5130d4(0x1bc)]+'`\x0a');_0xc7c1c6[_0x5130d4(0x288)]&&(_0x5ee4d8+=_0x5130d4(0x1e5)+_0xc7c1c6[_0x5130d4(0x288)]+'`\x0a');_0xc7c1c6['customerIp']&&(_0x5ee4d8+='🌐\x20IP:\x20`'+_0xc7c1c6[_0x5130d4(0x233)]+'`\x0a');if(_0xc7c1c6[_0x5130d4(0x252)]){const _0x1d82f7=_0xc7c1c6['customerUa'][_0x5130d4(0x264)]>0x32?_0xc7c1c6[_0x5130d4(0x252)][_0x5130d4(0x1cd)](0x0,0x32)+'...':_0xc7c1c6[_0x5130d4(0x252)];_0x5ee4d8+=_0x5130d4(0x241)+_0x1d82f7+'`\x0a';}}_0x3ab060==='chargeback'&&_0xc7c1c6[_0x5130d4(0x1f7)]&&(_0x5ee4d8+=_0x5130d4(0x1c1)+_0xc7c1c6[_0x5130d4(0x1f7)]+'\x20USDT*\x0a'),_0x3ab060===_0x5130d4(0x24b)&&(_0x5ee4d8+=_0x5130d4(0x22b)),_0xc7c1c6[_0x5130d4(0x217)]&&(_0x5ee4d8+=_0x5130d4(0x1d4)+_0xc7c1c6[_0x5130d4(0x217)]+'\x0a'),await this[_0x5130d4(0x203)](_0x195544,_0x5ee4d8,{'parse_mode':_0x5130d4(0x1f6)});}async[a55_0x3f14fa(0x27d)](_0x58edb4,_0xaa0539,_0x551a08){const _0x4f1916=a55_0x3f14fa,_0x5b5273={'created':'📤','completed':'✅','rejected':'❌'},_0x438e75={'created':_0x4f1916(0x21a),'completed':_0x4f1916(0x1c2),'rejected':_0x4f1916(0x1cf)},_0x3402e4=_0x5b5273[_0x551a08],_0x29fafe=_0x438e75[_0x551a08],_0x5ce616=_0x3402e4+'\x20*'+_0x29fafe+_0x4f1916(0x245)+(_0x4f1916(0x1f1)+_0xaa0539[_0x4f1916(0x28e)]+_0x4f1916(0x256))+(_0x4f1916(0x28f)+_0xaa0539[_0x4f1916(0x21e)]+'`\x0a')+(_0x4f1916(0x263)+_0xaa0539['id']+'`\x0a')+(_0x4f1916(0x290)+new Date(_0xaa0539[_0x4f1916(0x25b)])[_0x4f1916(0x274)](_0x4f1916(0x21d))+'\x0a')+(_0xaa0539[_0x4f1916(0x22e)]?_0x4f1916(0x1b8)+_0xaa0539[_0x4f1916(0x22e)]+'`':'');await this[_0x4f1916(0x203)](_0x58edb4,_0x5ce616,{'parse_mode':'Markdown'});}async[a55_0x3f14fa(0x1b2)](_0x55db8a,_0x2f81d8){const _0x31740d=a55_0x3f14fa;try{const _0x314be2=await database_1['default'][_0x31740d(0x20a)][_0x31740d(0x1ac)]({'where':{'shopId':_0x55db8a},'select':{'notificationLogin':!![]}});if(!_0x314be2?.[_0x31740d(0x25f)]){console['log'](_0x31740d(0x230)+_0x55db8a);return;}const _0x1a0ad9=_0x2f81d8[_0x31740d(0x1ec)]?'🔐':'🚨',_0x5f4e92=_0x2f81d8[_0x31740d(0x1ec)]?_0x31740d(0x25e):_0x31740d(0x21c);let _0x5bb989=_0x1a0ad9+'\x20*'+_0x5f4e92+_0x31740d(0x245)+(_0x31740d(0x1c8)+_0x2f81d8[_0x31740d(0x222)]+'`\x0a')+(_0x31740d(0x218)+_0x2f81d8['timestamp'][_0x31740d(0x274)](_0x31740d(0x21d))+'\x0a');_0x2f81d8[_0x31740d(0x210)]&&(_0x5bb989+=_0x31740d(0x23f)+_0x2f81d8[_0x31740d(0x210)]+'`\x0a');if(_0x2f81d8[_0x31740d(0x1fa)]){const _0x34ea83=_0x2f81d8[_0x31740d(0x1fa)][_0x31740d(0x264)]>0x32?_0x2f81d8[_0x31740d(0x1fa)][_0x31740d(0x1cd)](0x0,0x32)+_0x31740d(0x28c):_0x2f81d8['userAgent'];_0x5bb989+=_0x31740d(0x241)+_0x34ea83+'`\x0a';}!_0x2f81d8['success']&&(_0x5bb989+='\x0a⚠️\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!'),await this[_0x31740d(0x203)](_0x55db8a,_0x5bb989,{'parse_mode':'Markdown'}),console[_0x31740d(0x1fb)]('✅\x20Login\x20notification\x20sent\x20for\x20shop\x20'+_0x55db8a+':\x20'+(_0x2f81d8[_0x31740d(0x1ec)]?_0x31740d(0x1ec):_0x31740d(0x1cb)));}catch(_0x45b434){console[_0x31740d(0x1d5)]('Failed\x20to\x20send\x20login\x20notification:',_0x45b434);}}async['sendApiErrorNotification'](_0x23529f,_0x36a322){const _0x395495=a55_0x3f14fa;try{const _0x408dab=await database_1[_0x395495(0x236)][_0x395495(0x20a)][_0x395495(0x1ac)]({'where':{'shopId':_0x23529f},'select':{'notificationApiError':!![]}});if(!_0x408dab?.['notificationApiError']){console['log'](_0x395495(0x266)+_0x23529f);return;}let _0x597906=_0x395495(0x227)+('🔗\x20Endpoint:\x20`'+_0x36a322[_0x395495(0x21e)]+'\x20'+_0x36a322[_0x395495(0x207)]+'`\x0a')+('📅\x20Time:\x20'+_0x36a322[_0x395495(0x1d2)][_0x395495(0x274)](_0x395495(0x21d))+'\x0a');_0x36a322[_0x395495(0x1c5)]&&(_0x597906+=_0x395495(0x26e)+_0x36a322[_0x395495(0x1c5)]+'`\x0a'),_0x597906+='❌\x20Error:\x20`'+_0x36a322[_0x395495(0x1fe)]+'`\x0a',_0x36a322[_0x395495(0x26a)]&&(_0x597906+=_0x395495(0x276)+_0x36a322[_0x395495(0x26a)]+'`\x0a'),_0x597906+=_0x395495(0x225),await this[_0x395495(0x203)](_0x23529f,_0x597906,{'parse_mode':_0x395495(0x1f6)}),console[_0x395495(0x1fb)](_0x395495(0x271)+_0x23529f+':\x20'+_0x36a322['endpoint']);}catch(_0x45d691){console[_0x395495(0x1d5)](_0x395495(0x20e),_0x45d691);}}async[a55_0x3f14fa(0x287)](_0xba17ea,_0x165a3a,_0x52bff4){const _0x2e9473=a55_0x3f14fa;let _0x2edda8=_0x2e9473(0x1e4)+_0x165a3a+_0x2e9473(0x245);for(const [_0x23ba60,_0x122ac9]of Object[_0x2e9473(0x20c)](_0x52bff4)){_0x122ac9!==null&&_0x122ac9!==undefined&&(_0x2edda8+=_0x23ba60+':\x20`'+_0x122ac9+'`\x0a');}await this['sendShopNotification'](_0xba17ea,_0x2edda8,{'parse_mode':_0x2e9473(0x1f6)});}[a55_0x3f14fa(0x23e)](){const _0x224847=a55_0x3f14fa;return{'isActive':!!this['bot'],'username':this[_0x224847(0x20b)]};}[a55_0x3f14fa(0x26d)](){const _0x5a4db8=a55_0x3f14fa;this[_0x5a4db8(0x294)]&&(this['bot'][_0x5a4db8(0x28d)](),this['bot']=null,console[_0x5a4db8(0x1fb)](_0x5a4db8(0x220)));}}exports['TelegramBotService']=TelegramBotService,exports[a55_0x3f14fa(0x286)]=new TelegramBotService();