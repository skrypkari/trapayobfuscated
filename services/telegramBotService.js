'use strict';function a61_0x20b5(_0x279539,_0x17e77e){const _0x38bacd=a61_0x38ba();return a61_0x20b5=function(_0x20b526,_0x26fef6){_0x20b526=_0x20b526-0xf5;let _0x17af92=_0x38bacd[_0x20b526];return _0x17af92;},a61_0x20b5(_0x279539,_0x17e77e);}const a61_0x249a7f=a61_0x20b5;(function(_0x314bf2,_0x3f4600){const _0x22773e=a61_0x20b5,_0x4f87e6=_0x314bf2();while(!![]){try{const _0x4c62d1=parseInt(_0x22773e(0x146))/0x1+parseInt(_0x22773e(0x152))/0x2*(-parseInt(_0x22773e(0x1b1))/0x3)+parseInt(_0x22773e(0x1d6))/0x4*(-parseInt(_0x22773e(0x172))/0x5)+parseInt(_0x22773e(0x1d0))/0x6*(parseInt(_0x22773e(0x14b))/0x7)+-parseInt(_0x22773e(0x1bc))/0x8*(-parseInt(_0x22773e(0x19b))/0x9)+-parseInt(_0x22773e(0x1be))/0xa*(parseInt(_0x22773e(0x160))/0xb)+parseInt(_0x22773e(0x134))/0xc;if(_0x4c62d1===_0x3f4600)break;else _0x4f87e6['push'](_0x4f87e6['shift']());}catch(_0x27940b){_0x4f87e6['push'](_0x4f87e6['shift']());}}}(a61_0x38ba,0xec222));function a61_0x38ba(){const _0x24b176=['gateway','📝\x20Notes:\x20','You\x20are\x20already\x20connected\x20to\x20shop:\x20*','Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.','remitterIban',':\x20`','chat\x20not\x20found','📱\x20No\x20active\x20Telegram\x20users\x20found','success','initializeBot','notificationLogin','trim','👤\x20Username:\x20`','1809763ROnElJ','ipAddress','📱\x20Sending\x20notification\x20to\x20all\x20connected\x20users:\x20','requestId','🏪\x20Available\x20shops\x20in\x20system:\x0a','14LchyHW','🆔\x20Payment\x20ID:\x20`','shopId','...','TelegramBotService','*.\x0a\x0a','botUsername','2KDImpa','__importDefault','✅\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a','`\x20not\x20found.\x0a\x0a','\x20users','❌\x20Invalid\x20API\x20key\x20format.\x0a\x0a','🏦\x20IBAN:\x20`','amount','stopPolling','❌\x20Failed\x20to\x20send\x20notification\x20to\x20all\x20users:','customerUa','\x20(@','\x22\x20->\x20display\x20\x22','`.\x0a\x0a','9988869wQrIEv','sendNotificationToAll','timestamp','💻\x20Browser:\x20`','endpoint','chat','telegramId','📧\x20Email:\x20`','✅\x20Connected\x20to\x20shop:\x20*','🤖\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a','text','🔗\x20Endpoint:\x20`','userAgent','telegramBotService','en-US','`\x20is\x20inactive.\x0a\x0a','🔔\x20Notifications\x20are\x20active\x0a\x0a','💸\x20Amount:\x20*','284285keASnC','from','\x0a👤\x20*Customer\x20Information:*\x0a','ACTIVE','chargebackAmount','sendPayoutNotification','`\x0a\x0a','API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','❌\x20Error:\x20`','Payment\x20chargeback','📱\x20Shop:\x20*','Error\x20handling\x20message:','🏪\x20Gateway:\x20`','findUnique','•\x20Payouts\x0a','orderId','\x0a💡\x20Check\x20your\x20request\x20or\x20contact\x20support.','map','\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure','\x20\x20\x20Username:\x20`','Error\x20handling\x20/status\x20command:','sendMessage','Failed\x20to\x20send\x20login\x20notification:','TELEGRAM_BOT_USERNAME','`\x20(','Error\x20sending\x20shop\x20notification:','❌\x20API\x20key\x20does\x20not\x20match\x20shop\x20`','processing','TELEGRAM_BOT_TOKEN','secretKey','update','env','❌\x20Failed\x20to\x20initialize\x20Telegram\x20bot:','🔗\x20TXID:\x20`','🔄\x20Reset\x20incomplete\x20verification\x20for\x20user\x20','test','username','You\x20sent\x20','📊\x20*Connection\x20Status*\x0a\x0a','Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).','Example:\x0a','16760664liNKIg','entries','customerIp','currency','allSettled','To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a','•\x20Payment\x20status\x20changes\x0a','Successful\x20login','Failed\x20to\x20send\x20API\x20error\x20notification:','🆔\x20Request\x20ID:\x20`','customerName','default','Payout\x20completed','Payment\x20expired','includes','❌\x20Invalid\x20username\x20format:\x20`','name','/disconnect\x20-\x20disconnect\x20from\x20notifications','📝\x20Format:\x20`username\x20api_key`\x0a\x0a','botToken','setupBotHandlers','❌\x20Please\x20use\x20/start\x20command\x20first','5140833TPugXU','📱\x20Created\x20new\x20Telegram\x20user:\x20','\x20\x20\x20Public\x20Key:\x20`','✅\x20Telegram\x20user\x20','substring','errorMessage','New\x20payout\x20created','Telegram\x20bot\x20error:','Payout\x20rejected','📛\x20Name:\x20`','method','8cBzTBf','../config/database','20YxrBwn','❌\x20An\x20error\x20occurred\x20while\x20verifying\x20data.','log','📱\x20Notification\x20sent\x20to\x20','Payment\x20failed','🛑\x20Telegram\x20bot\x20stopped','❌\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`','statusCode','Error\x20handling\x20/debug\x20command:','unknown\x20shop','sendApiErrorNotification','customerEmail','\x22,\x20apiKey=\x22','✅\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','Error\x20in\x20handleSingleLineVerification:','🔍\x20*Debug\x20Information*\x0a\x0a','Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a','36252cBWImt','stopBot','Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`','❌\x20Shop\x20with\x20username\x20`','message','❌\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a','28VMaiyx','📱\x20Your\x20Telegram\x20ID:\x20`','sendShopNotification','\x20parts:\x20',':\x20username=\x22','sendLoginNotification','📝\x20Order\x20ID:\x20`','last_name','Payment\x20is\x20being\x20processed','🏦\x20Method:\x20`','*\x0a\x0a','Markdown','Telegram\x20bot\x20polling\x20error:','🚨\x20*API\x20Error*\x0a\x0a','\x0a⚠️\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!','New\x20payment\x20created','startsWith','status','toLocaleString','length','🔌\x20User\x20','❌\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a','onText','shop','❌\x20Error\x20getting\x20debug\x20information.','No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20','User\x20','sendPaymentNotification','🔔\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a','💰\x20Amount:\x20*','...\x22','isVerified','✅\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*','\x20\x20\x20Status:\x20','telegramUser','updatedAt','createdAt','notificationApiError','shopSettings','error','Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.','\x20via\x20single-line\x20input','/status\x20-\x20check\x20connection\x20status\x0a','📱\x20Login\x20notifications\x20disabled\x20for\x20shop\x20','\x20USD*\x0a','bot','✅\x20Login\x20notification\x20sent\x20for\x20shop\x20','✅\x20Telegram\x20bot\x20@','❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','📅\x20Connection\x20date:\x20','🎉\x20*Congratulations!*\x0a\x0a','getGatewayDisplayNameForTelegram','📅\x20Time:\x20','❗️\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!','toString','first_name','🌐\x20IP:\x20`','findMany','🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20','Check\x20spelling\x20and\x20try\x20again.','handleSingleLineVerification','•\x20Payouts\x0a\x0a','📊\x20Error\x20code:\x20`','•\x20New\x20payments\x0a','💸\x20Penalty\x20amount:\x20*','Username:\x20`','Commands:\x0a','To\x20reconnect,\x20use\x20the\x20/start\x20command','❌\x20Failed\x20to\x20send\x20message\x20to\x20user\x20','•\x20Important\x20events\x0a\x0a','📅\x20Date:\x20','../types/gateway','pk_','forEach','Use\x20/start\x20to\x20connect.','Failed\x20login\x20attempt','•\x20`','14529924mCFVwD','txid','Contact\x20administrator.','❌\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.','❌\x20Shop\x20`'];a61_0x38ba=function(){return _0x24b176;};return a61_0x38ba();}var __importDefault=this&&this[a61_0x249a7f(0x153)]||function(_0x47fba6){return _0x47fba6&&_0x47fba6['__esModule']?_0x47fba6:{'default':_0x47fba6};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a61_0x249a7f(0x16d)]=exports[a61_0x249a7f(0x14f)]=void 0x0;const node_telegram_bot_api_1=__importDefault(require('node-telegram-bot-api')),database_1=__importDefault(require(a61_0x249a7f(0x1bd))),gateway_1=require(a61_0x249a7f(0x12e));class TelegramBotService{constructor(){const _0x13aa7c=a61_0x249a7f;this[_0x13aa7c(0x114)]=null,this['botToken']=process[_0x13aa7c(0x191)][_0x13aa7c(0x18e)]||'',this[_0x13aa7c(0x151)]=process[_0x13aa7c(0x191)][_0x13aa7c(0x189)]||'trapay_bot',this['botToken']?this['initializeBot']():console['warn']('TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables');}[a61_0x249a7f(0x142)](){const _0x6c6d0f=a61_0x249a7f;try{this[_0x6c6d0f(0x114)]=new node_telegram_bot_api_1['default'](this[_0x6c6d0f(0x1ae)],{'polling':!![]}),this[_0x6c6d0f(0x1af)](),console[_0x6c6d0f(0x1c0)](_0x6c6d0f(0x116)+this['botUsername']+'\x20initialized\x20successfully');}catch(_0x5b6f06){console[_0x6c6d0f(0x10e)](_0x6c6d0f(0x192),_0x5b6f06);}}[a61_0x249a7f(0x1af)](){const _0xcbb193=a61_0x249a7f;if(!this[_0xcbb193(0x114)])return;this[_0xcbb193(0x114)][_0xcbb193(0xfd)](/\/start/,async _0x1000fd=>{const _0xb38ae=_0xcbb193,_0x23972e=_0x1000fd[_0xb38ae(0x165)]['id'],_0x2c5c05=_0x1000fd[_0xb38ae(0x173)]?.['id']['toString'](),_0x4f868f=_0x1000fd[_0xb38ae(0x173)]?.[_0xb38ae(0x196)],_0x4c3fad=_0x1000fd['from']?.[_0xb38ae(0x11e)],_0x538d22=_0x1000fd['from']?.[_0xb38ae(0x1dd)];if(!_0x2c5c05)return;try{let _0x3dbe79=await database_1[_0xb38ae(0x1a6)][_0xb38ae(0x109)]['findUnique']({'where':{'telegramId':_0x2c5c05},'include':{'shop':!![]}});!_0x3dbe79?(_0x3dbe79=await database_1[_0xb38ae(0x1a6)][_0xb38ae(0x109)]['create']({'data':{'telegramId':_0x2c5c05,'username':_0x4f868f,'firstName':_0x4c3fad,'lastName':_0x538d22,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console[_0xb38ae(0x1c0)](_0xb38ae(0x1b2)+_0x2c5c05+_0xb38ae(0x15d)+_0x4f868f+')')):_0x3dbe79=await database_1['default'][_0xb38ae(0x109)][_0xb38ae(0x190)]({'where':{'telegramId':_0x2c5c05},'data':{'username':_0x4f868f,'firstName':_0x4c3fad,'lastName':_0x538d22},'include':{'shop':!![]}}),_0x3dbe79[_0xb38ae(0x106)]&&_0x3dbe79[_0xb38ae(0x14d)]&&_0x3dbe79[_0xb38ae(0xfe)]?await this[_0xb38ae(0x114)]?.['sendMessage'](_0x23972e,'✅\x20Welcome\x20back!\x0a\x0a'+(_0xb38ae(0x13b)+_0x3dbe79[_0xb38ae(0xfe)][_0xb38ae(0x1ab)]+'*\x0a')+(_0xb38ae(0x128)+_0x3dbe79[_0xb38ae(0xfe)][_0xb38ae(0x196)]+_0xb38ae(0x178))+'🔔\x20You\x20receive\x20notifications\x20about:\x0a'+'•\x20New\x20payments\x0a'+_0xb38ae(0x1a1)+_0xb38ae(0x124)+_0xb38ae(0x129)+_0xb38ae(0x111)+_0xb38ae(0x1ac),{'parse_mode':_0xb38ae(0x1e1)}):(_0x3dbe79[_0xb38ae(0x14d)]&&!_0x3dbe79[_0xb38ae(0x106)]&&(await database_1[_0xb38ae(0x1a6)][_0xb38ae(0x109)][_0xb38ae(0x190)]({'where':{'telegramId':_0x2c5c05},'data':{'shopId':null,'isVerified':![]}}),console['log'](_0xb38ae(0x194)+_0x2c5c05)),await this[_0xb38ae(0x114)]?.[_0xb38ae(0x187)](_0x23972e,_0xb38ae(0x169)+_0xb38ae(0x1a0)+_0xb38ae(0x1ad)+_0xb38ae(0x19a)+_0xb38ae(0x1cc)+_0xb38ae(0x11c),{'parse_mode':_0xb38ae(0x1e1)}));}catch(_0x33c1f3){console[_0xb38ae(0x10e)]('Error\x20handling\x20/start\x20command:',_0x33c1f3),await this[_0xb38ae(0x114)]?.[_0xb38ae(0x187)](_0x23972e,_0xb38ae(0x117));}}),this[_0xcbb193(0x114)]['onText'](/\/disconnect/,async _0x5575e8=>{const _0x87844=_0xcbb193,_0x3c63a2=_0x5575e8[_0x87844(0x165)]['id'],_0xce34c8=_0x5575e8[_0x87844(0x173)]?.['id'][_0x87844(0x11d)]();if(!_0xce34c8)return;try{const _0x5a8240=await database_1[_0x87844(0x1a6)][_0x87844(0x109)][_0x87844(0x17f)]({'where':{'telegramId':_0xce34c8},'include':{'shop':!![]}});if(!_0x5a8240||!_0x5a8240[_0x87844(0x106)]||!_0x5a8240[_0x87844(0x14d)]){await this[_0x87844(0x114)]?.[_0x87844(0x187)](_0x3c63a2,_0x87844(0x137));return;}const _0x327232=_0x5a8240['shop']?.[_0x87844(0x1ab)]||_0x87844(0x1c7);await database_1[_0x87844(0x1a6)][_0x87844(0x109)][_0x87844(0x190)]({'where':{'telegramId':_0xce34c8},'data':{'shopId':null,'isVerified':![]}}),console[_0x87844(0x1c0)](_0x87844(0xfb)+_0xce34c8+'\x20disconnected\x20from\x20shop\x20'+_0x5a8240[_0x87844(0x14d)]),await this[_0x87844(0x114)]?.['sendMessage'](_0x3c63a2,'✅\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*'+_0x327232+_0x87844(0x150)+_0x87844(0x12a),{'parse_mode':_0x87844(0x1e1)});}catch(_0x5d76b3){console[_0x87844(0x10e)]('Error\x20handling\x20/disconnect\x20command:',_0x5d76b3),await this[_0x87844(0x114)]?.[_0x87844(0x187)](_0x3c63a2,_0x87844(0x117));}}),this[_0xcbb193(0x114)][_0xcbb193(0xfd)](/\/status/,async _0x302386=>{const _0x576a81=_0xcbb193,_0x14123d=_0x302386[_0x576a81(0x165)]['id'],_0xb44f32=_0x302386[_0x576a81(0x173)]?.['id'][_0x576a81(0x11d)]();if(!_0xb44f32)return;try{const _0x4106a5=await database_1['default'][_0x576a81(0x109)][_0x576a81(0x17f)]({'where':{'telegramId':_0xb44f32},'include':{'shop':!![]}});if(!_0x4106a5){await this['bot']?.['sendMessage'](_0x14123d,_0x576a81(0x1d5)+'Use\x20/start\x20to\x20begin.');return;}if(!_0x4106a5[_0x576a81(0x106)]||!_0x4106a5[_0x576a81(0x14d)]||!_0x4106a5[_0x576a81(0xfe)]){await this[_0x576a81(0x114)]?.[_0x576a81(0x187)](_0x14123d,_0x576a81(0xfc)+_0x576a81(0x131));return;}await this[_0x576a81(0x114)]?.[_0x576a81(0x187)](_0x14123d,_0x576a81(0x198)+(_0x576a81(0x168)+_0x4106a5[_0x576a81(0xfe)][_0x576a81(0x1ab)]+'*\x0a')+(_0x576a81(0x145)+_0x4106a5[_0x576a81(0xfe)][_0x576a81(0x196)]+'`\x0a')+(_0x576a81(0x118)+_0x4106a5[_0x576a81(0x10a)]['toLocaleDateString'](_0x576a81(0x16e))+'\x0a\x0a')+_0x576a81(0x170)+_0x576a81(0x129)+_0x576a81(0x1ac),{'parse_mode':_0x576a81(0x1e1)});}catch(_0x53d2fe){console[_0x576a81(0x10e)](_0x576a81(0x186),_0x53d2fe),await this['bot']?.[_0x576a81(0x187)](_0x14123d,'❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this[_0xcbb193(0x114)]['onText'](/\/debug/,async _0xf02bb7=>{const _0x54564a=_0xcbb193,_0x31bd7c=_0xf02bb7['chat']['id'],_0x3bdb79=_0xf02bb7[_0x54564a(0x173)]?.['id'][_0x54564a(0x11d)]();if(!_0x3bdb79)return;try{const _0x5d921f=await database_1[_0x54564a(0x1a6)][_0x54564a(0xfe)][_0x54564a(0x120)]({'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![]},'take':0xa});let _0x41a365=_0x54564a(0x1ce);_0x41a365+=_0x54564a(0x1d7)+_0x3bdb79+_0x54564a(0x178),_0x41a365+=_0x54564a(0x14a),_0x5d921f['forEach']((_0x196620,_0x12ebb2)=>{const _0xe6cdf1=_0x54564a;_0x41a365+=_0x12ebb2+0x1+'.\x20*'+_0x196620[_0xe6cdf1(0x1ab)]+'*\x0a',_0x41a365+=_0xe6cdf1(0x185)+_0x196620[_0xe6cdf1(0x196)]+'`\x0a',_0x41a365+=_0xe6cdf1(0x108)+_0x196620['status']+'\x0a',_0x41a365+=_0xe6cdf1(0x1b3)+_0x196620['publicKey'][_0xe6cdf1(0x1b5)](0x0,0xf)+'...`\x0a\x0a';}),await this[_0x54564a(0x114)]?.[_0x54564a(0x187)](_0x31bd7c,_0x41a365,{'parse_mode':_0x54564a(0x1e1)});}catch(_0x526627){console['error'](_0x54564a(0x1c6),_0x526627),await this[_0x54564a(0x114)]?.['sendMessage'](_0x31bd7c,_0x54564a(0xff));}}),this[_0xcbb193(0x114)]['on'](_0xcbb193(0x1d4),async _0x167595=>{const _0x2aecff=_0xcbb193;if(_0x167595[_0x2aecff(0x16a)]?.[_0x2aecff(0xf7)]('/'))return;const _0xbe272f=_0x167595[_0x2aecff(0x165)]['id'],_0x3dc9a6=_0x167595[_0x2aecff(0x173)]?.['id'][_0x2aecff(0x11d)](),_0x14e68b=_0x167595['text']?.[_0x2aecff(0x144)]();if(!_0x3dc9a6||!_0x14e68b)return;try{const _0x2848ae=await database_1[_0x2aecff(0x1a6)][_0x2aecff(0x109)][_0x2aecff(0x17f)]({'where':{'telegramId':_0x3dc9a6},'include':{'shop':!![]}});if(!_0x2848ae){await this[_0x2aecff(0x114)]?.[_0x2aecff(0x187)](_0xbe272f,_0x2aecff(0x1b0));return;}if(_0x2848ae[_0x2aecff(0x106)]&&_0x2848ae[_0x2aecff(0x14d)]&&_0x2848ae['shop']){await this[_0x2aecff(0x114)]?.[_0x2aecff(0x187)](_0xbe272f,_0x2aecff(0x107)+_0x2848ae[_0x2aecff(0xfe)][_0x2aecff(0x1ab)]+_0x2aecff(0x150)+_0x2aecff(0x13c),{'parse_mode':_0x2aecff(0x1e1)});return;}const _0x52e792=_0x14e68b['split'](/\s+/);if(_0x52e792['length']!==0x2){await this[_0x2aecff(0x114)]?.[_0x2aecff(0x187)](_0xbe272f,'❌\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a'+_0x2aecff(0x1ad)+_0x2aecff(0x19a)+_0x2aecff(0x1cc)+(_0x2aecff(0x197)+_0x52e792[_0x2aecff(0xfa)]+_0x2aecff(0x1d9)+_0x52e792[_0x2aecff(0x183)](_0x317b32=>'`'+_0x317b32+'`')['join'](',\x20')),{'parse_mode':_0x2aecff(0x1e1)});return;}const [_0x4658a3,_0x170ba8]=_0x52e792;console[_0x2aecff(0x1c0)]('🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20'+_0x3dc9a6+_0x2aecff(0x1da)+_0x4658a3+_0x2aecff(0x1ca)+_0x170ba8[_0x2aecff(0x1b5)](0x0,0xa)+'...\x22'),await this[_0x2aecff(0x123)](_0xbe272f,_0x3dc9a6,_0x4658a3,_0x170ba8);}catch(_0x41bb5e){console[_0x2aecff(0x10e)](_0x2aecff(0x17d),_0x41bb5e),await this['bot']?.[_0x2aecff(0x187)](_0xbe272f,_0x2aecff(0x117));}}),this[_0xcbb193(0x114)]['on'](_0xcbb193(0x10e),_0x30361d=>{const _0x42210f=_0xcbb193;console[_0x42210f(0x10e)](_0x42210f(0x1b8),_0x30361d);}),this[_0xcbb193(0x114)]['on']('polling_error',_0x456fe3=>{const _0x5b041b=_0xcbb193;console[_0x5b041b(0x10e)](_0x5b041b(0x1e2),_0x456fe3);});}async[a61_0x249a7f(0x123)](_0x3e4690,_0xc062e3,_0x2178ea,_0x285c9e){const _0x53da88=a61_0x249a7f;try{console[_0x53da88(0x1c0)](_0x53da88(0x121)+_0xc062e3+':\x20username=\x22'+_0x2178ea+_0x53da88(0x1ca)+_0x285c9e['substring'](0x0,0xa)+_0x53da88(0x105));if(!_0x2178ea||_0x2178ea[_0x53da88(0xfa)]<0x3||_0x2178ea[_0x53da88(0xfa)]>0x32||!/^[a-zA-Z0-9_]+$/[_0x53da88(0x195)](_0x2178ea)){await this[_0x53da88(0x114)]?.[_0x53da88(0x187)](_0x3e4690,_0x53da88(0x1aa)+_0x2178ea+_0x53da88(0x178)+_0x53da88(0x199),{'parse_mode':_0x53da88(0x1e1)});return;}if(!_0x285c9e||!_0x285c9e[_0x53da88(0xf7)](_0x53da88(0x12f))&&!_0x285c9e[_0x53da88(0xf7)]('sk_')){await this[_0x53da88(0x114)]?.[_0x53da88(0x187)](_0x3e4690,_0x53da88(0x157)+_0x53da88(0x179),{'parse_mode':_0x53da88(0x1e1)});return;}const _0x1863fe=await database_1[_0x53da88(0x1a6)]['shop']['findUnique']({'where':{'username':_0x2178ea},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x1863fe){const _0x6dd394=await database_1[_0x53da88(0x1a6)][_0x53da88(0xfe)][_0x53da88(0x120)]({'select':{'username':!![],'name':!![]},'take':0x5});let _0x3792d5=_0x53da88(0x1d3)+_0x2178ea+_0x53da88(0x155);_0x6dd394[_0x53da88(0xfa)]>0x0?(_0x3792d5+='Available\x20usernames:\x0a',_0x6dd394[_0x53da88(0x130)](_0x5473e2=>{const _0x47f72d=_0x53da88;_0x3792d5+=_0x47f72d(0x133)+_0x5473e2[_0x47f72d(0x196)]+_0x47f72d(0x18a)+_0x5473e2[_0x47f72d(0x1ab)]+')\x0a';}),_0x3792d5+='\x0aCheck\x20spelling\x20and\x20try\x20again.'):_0x3792d5+=_0x53da88(0x122);await this[_0x53da88(0x114)]?.[_0x53da88(0x187)](_0x3e4690,_0x3792d5,{'parse_mode':_0x53da88(0x1e1)});return;}if(_0x1863fe[_0x53da88(0xf8)]!==_0x53da88(0x175)){await this[_0x53da88(0x114)]?.['sendMessage'](_0x3e4690,_0x53da88(0x138)+_0x2178ea+_0x53da88(0x16f)+_0x53da88(0x136),{'parse_mode':'Markdown'});return;}if(_0x1863fe['publicKey']!==_0x285c9e&&_0x1863fe[_0x53da88(0x18f)]!==_0x285c9e){await this['bot']?.['sendMessage'](_0x3e4690,_0x53da88(0x18c)+_0x2178ea+_0x53da88(0x15f)+_0x53da88(0x1cf)+_0x53da88(0x1d2),{'parse_mode':_0x53da88(0x1e1)});return;}const _0xb94712=await database_1[_0x53da88(0x1a6)]['telegramUser']['findFirst']({'where':{'shopId':_0x1863fe['id'],'isVerified':!![],'telegramId':{'not':_0xc062e3}}});if(_0xb94712){await this['bot']?.['sendMessage'](_0x3e4690,_0x53da88(0x1c4)+_0x2178ea+_0x53da88(0x15f)+_0x53da88(0x10f),{'parse_mode':_0x53da88(0x1e1)});return;}await database_1['default'][_0x53da88(0x109)][_0x53da88(0x190)]({'where':{'telegramId':_0xc062e3},'data':{'shopId':_0x1863fe['id'],'isVerified':!![]}}),await this[_0x53da88(0x114)]?.[_0x53da88(0x187)](_0x3e4690,_0x53da88(0x119)+_0x53da88(0x154)+(_0x53da88(0x17c)+_0x1863fe[_0x53da88(0x1ab)]+'*\x0a')+('👤\x20Username:\x20`'+_0x1863fe[_0x53da88(0x196)]+_0x53da88(0x178))+_0x53da88(0x103)+_0x53da88(0x126)+_0x53da88(0x1a1)+_0x53da88(0x180)+_0x53da88(0x12c)+'Commands:\x0a'+_0x53da88(0x111)+_0x53da88(0x1ac),{'parse_mode':_0x53da88(0x1e1)}),console[_0x53da88(0x1c0)](_0x53da88(0x1b4)+_0xc062e3+'\x20verified\x20for\x20shop\x20'+_0x1863fe['username']+_0x53da88(0x110));}catch(_0x3a91f9){console[_0x53da88(0x10e)](_0x53da88(0x1cd),_0x3a91f9),await this[_0x53da88(0x114)]?.[_0x53da88(0x187)](_0x3e4690,_0x53da88(0x1bf));}}async[a61_0x249a7f(0x1d8)](_0x44f8db,_0x44cdf1,_0x49783c){const _0x107d03=a61_0x249a7f;if(!this['bot']){console['warn']('Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification');return;}try{const _0x4eacef=await database_1[_0x107d03(0x1a6)][_0x107d03(0x109)][_0x107d03(0x120)]({'where':{'shopId':_0x44f8db,'isVerified':!![]}});if(_0x4eacef[_0x107d03(0xfa)]===0x0){console['log'](_0x107d03(0x100)+_0x44f8db);return;}const _0x3c9a7f=_0x4eacef['map'](async _0x15d5a6=>{const _0x2e227d=_0x107d03;try{await this[_0x2e227d(0x114)]?.[_0x2e227d(0x187)](_0x15d5a6[_0x2e227d(0x166)],_0x44cdf1,_0x49783c),console['log']('✅\x20Notification\x20sent\x20to\x20Telegram\x20user\x20'+_0x15d5a6[_0x2e227d(0x166)]);}catch(_0x2a3d4e){console[_0x2e227d(0x10e)]('❌\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20'+_0x15d5a6[_0x2e227d(0x166)]+':',_0x2a3d4e),_0x2a3d4e instanceof Error&&(_0x2a3d4e['message'][_0x2e227d(0x1a9)]('blocked')||_0x2a3d4e[_0x2e227d(0x1d4)][_0x2e227d(0x1a9)](_0x2e227d(0x13f))||_0x2a3d4e['message'][_0x2e227d(0x1a9)]('user\x20is\x20deactivated'))&&(await database_1['default'][_0x2e227d(0x109)][_0x2e227d(0x190)]({'where':{'id':_0x15d5a6['id']},'data':{'isVerified':![]}}),console[_0x2e227d(0x1c0)](_0x2e227d(0x101)+_0x15d5a6[_0x2e227d(0x166)]+_0x2e227d(0x184)));}});await Promise[_0x107d03(0x19f)](_0x3c9a7f);}catch(_0x45da6f){console[_0x107d03(0x10e)](_0x107d03(0x18b),_0x45da6f);}}async[a61_0x249a7f(0x102)](_0x389a32,_0x59456c,_0x3ce6cf){const _0xcd9474=a61_0x249a7f,_0x5147df={'created':'🆕','paid':'✅','failed':'❌','expired':'⏰','refund':'🔄','chargeback':'⚠️','processing':'⚙️'},_0x4c8e81={'created':_0xcd9474(0xf6),'paid':'Payment\x20successfully\x20paid','failed':_0xcd9474(0x1c2),'expired':_0xcd9474(0x1a8),'refund':'Payment\x20refund','chargeback':_0xcd9474(0x17b),'processing':_0xcd9474(0x1de)},_0x3adb5d=_0x5147df[_0x3ce6cf],_0x4b2d3d=_0x4c8e81[_0x3ce6cf],_0x41cd3e=(0x0,gateway_1[_0xcd9474(0x11a)])(_0x59456c[_0xcd9474(0x139)]);console[_0xcd9474(0x1c0)]('📱\x20Telegram\x20notification:\x20gateway\x20\x22'+_0x59456c[_0xcd9474(0x139)]+_0xcd9474(0x15e)+_0x41cd3e+'\x22');let _0x421610=_0x3adb5d+'\x20*'+_0x4b2d3d+'*\x0a\x0a'+(_0xcd9474(0x104)+_0x59456c[_0xcd9474(0x159)]+'\x20'+_0x59456c[_0xcd9474(0x19e)]+'*\x0a')+(_0xcd9474(0x1dc)+(_0x59456c[_0xcd9474(0x181)]||_0x59456c['id'])+'`\x0a')+(_0xcd9474(0x14c)+_0x59456c['id']+'`\x0a')+(_0xcd9474(0x17e)+_0x41cd3e+'`\x0a')+(_0xcd9474(0x12d)+new Date(_0x59456c[_0xcd9474(0x10b)])[_0xcd9474(0xf9)](_0xcd9474(0x16e))+'\x0a');if(_0x59456c[_0xcd9474(0x1a5)]||_0x59456c[_0xcd9474(0x1c9)]||_0x59456c[_0xcd9474(0x13d)]||_0x59456c[_0xcd9474(0x19d)]||_0x59456c[_0xcd9474(0x15c)]){_0x421610+=_0xcd9474(0x174);_0x59456c[_0xcd9474(0x1a5)]&&(_0x421610+=_0xcd9474(0x1ba)+_0x59456c[_0xcd9474(0x1a5)]+'`\x0a');_0x59456c['customerEmail']&&(_0x421610+=_0xcd9474(0x167)+_0x59456c[_0xcd9474(0x1c9)]+'`\x0a');_0x59456c['remitterIban']&&(_0x421610+=_0xcd9474(0x158)+_0x59456c[_0xcd9474(0x13d)]+'`\x0a');_0x59456c[_0xcd9474(0x19d)]&&(_0x421610+=_0xcd9474(0x11f)+_0x59456c[_0xcd9474(0x19d)]+'`\x0a');if(_0x59456c['customerUa']){const _0x41c3dd=_0x59456c[_0xcd9474(0x15c)][_0xcd9474(0xfa)]>0x32?_0x59456c[_0xcd9474(0x15c)][_0xcd9474(0x1b5)](0x0,0x32)+_0xcd9474(0x14e):_0x59456c[_0xcd9474(0x15c)];_0x421610+=_0xcd9474(0x163)+_0x41c3dd+'`\x0a';}}_0x3ce6cf==='chargeback'&&_0x59456c[_0xcd9474(0x176)]&&(_0x421610+=_0xcd9474(0x127)+_0x59456c[_0xcd9474(0x176)]+'\x20USDT*\x0a'),_0x3ce6cf===_0xcd9474(0x18d)&&(_0x421610+='⏳\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a'),_0x59456c['adminNotes']&&(_0x421610+=_0xcd9474(0x13a)+_0x59456c['adminNotes']+'\x0a'),await this[_0xcd9474(0x1d8)](_0x389a32,_0x421610,{'parse_mode':_0xcd9474(0x1e1)});}async[a61_0x249a7f(0x177)](_0x2ec970,_0x592bf2,_0x54908e){const _0x306776=a61_0x249a7f,_0x2d1238={'created':'📤','completed':'✅','rejected':'❌'},_0x227cf6={'created':_0x306776(0x1b7),'completed':_0x306776(0x1a7),'rejected':_0x306776(0x1b9)},_0x35b839=_0x2d1238[_0x54908e],_0x3a0d4f=_0x227cf6[_0x54908e],_0x167dfc=_0x35b839+'\x20*'+_0x3a0d4f+'*\x0a\x0a'+(_0x306776(0x171)+_0x592bf2['amount']+_0x306776(0x113))+(_0x306776(0x1df)+_0x592bf2[_0x306776(0x1bb)]+'`\x0a')+('🆔\x20Payout\x20ID:\x20`'+_0x592bf2['id']+'`\x0a')+(_0x306776(0x12d)+new Date(_0x592bf2[_0x306776(0x10b)])[_0x306776(0xf9)](_0x306776(0x16e))+'\x0a')+(_0x592bf2[_0x306776(0x135)]?_0x306776(0x193)+_0x592bf2[_0x306776(0x135)]+'`':'');await this[_0x306776(0x1d8)](_0x2ec970,_0x167dfc,{'parse_mode':_0x306776(0x1e1)});}async[a61_0x249a7f(0x1db)](_0x1a6219,_0x12c7b7){const _0x27f182=a61_0x249a7f;try{const _0x257a82=await database_1[_0x27f182(0x1a6)][_0x27f182(0x10d)][_0x27f182(0x17f)]({'where':{'shopId':_0x1a6219},'select':{'notificationLogin':!![]}});if(!_0x257a82?.[_0x27f182(0x143)]){console[_0x27f182(0x1c0)](_0x27f182(0x112)+_0x1a6219);return;}const _0x5e30f5=_0x12c7b7[_0x27f182(0x141)]?'🔐':'🚨',_0x49c868=_0x12c7b7[_0x27f182(0x141)]?_0x27f182(0x1a2):_0x27f182(0x132);let _0x13b6f3=_0x5e30f5+'\x20*'+_0x49c868+_0x27f182(0x1e0)+(_0x27f182(0x145)+_0x12c7b7[_0x27f182(0x196)]+'`\x0a')+(_0x27f182(0x11b)+_0x12c7b7[_0x27f182(0x162)][_0x27f182(0xf9)](_0x27f182(0x16e))+'\x0a');_0x12c7b7[_0x27f182(0x147)]&&(_0x13b6f3+='🌐\x20IP\x20address:\x20`'+_0x12c7b7[_0x27f182(0x147)]+'`\x0a');if(_0x12c7b7[_0x27f182(0x16c)]){const _0x295d29=_0x12c7b7[_0x27f182(0x16c)][_0x27f182(0xfa)]>0x32?_0x12c7b7[_0x27f182(0x16c)][_0x27f182(0x1b5)](0x0,0x32)+_0x27f182(0x14e):_0x12c7b7[_0x27f182(0x16c)];_0x13b6f3+=_0x27f182(0x163)+_0x295d29+'`\x0a';}!_0x12c7b7[_0x27f182(0x141)]&&(_0x13b6f3+=_0x27f182(0xf5)),await this[_0x27f182(0x1d8)](_0x1a6219,_0x13b6f3,{'parse_mode':_0x27f182(0x1e1)}),console['log'](_0x27f182(0x115)+_0x1a6219+':\x20'+(_0x12c7b7[_0x27f182(0x141)]?_0x27f182(0x141):'failed'));}catch(_0x3f4651){console[_0x27f182(0x10e)](_0x27f182(0x188),_0x3f4651);}}async[a61_0x249a7f(0x1c8)](_0x5012da,_0x4fa87f){const _0x48d3fe=a61_0x249a7f;try{const _0x33783e=await database_1['default']['shopSettings']['findUnique']({'where':{'shopId':_0x5012da},'select':{'notificationApiError':!![]}});if(!_0x33783e?.[_0x48d3fe(0x10c)]){console[_0x48d3fe(0x1c0)]('📱\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20'+_0x5012da);return;}let _0x575b14=_0x48d3fe(0x1e3)+(_0x48d3fe(0x16b)+_0x4fa87f['method']+'\x20'+_0x4fa87f[_0x48d3fe(0x164)]+'`\x0a')+('📅\x20Time:\x20'+_0x4fa87f[_0x48d3fe(0x162)][_0x48d3fe(0xf9)](_0x48d3fe(0x16e))+'\x0a');_0x4fa87f['statusCode']&&(_0x575b14+=_0x48d3fe(0x125)+_0x4fa87f[_0x48d3fe(0x1c5)]+'`\x0a'),_0x575b14+=_0x48d3fe(0x17a)+_0x4fa87f[_0x48d3fe(0x1b6)]+'`\x0a',_0x4fa87f['requestId']&&(_0x575b14+=_0x48d3fe(0x1a4)+_0x4fa87f[_0x48d3fe(0x149)]+'`\x0a'),_0x575b14+=_0x48d3fe(0x182),await this[_0x48d3fe(0x1d8)](_0x5012da,_0x575b14,{'parse_mode':_0x48d3fe(0x1e1)}),console[_0x48d3fe(0x1c0)](_0x48d3fe(0x1cb)+_0x5012da+':\x20'+_0x4fa87f[_0x48d3fe(0x164)]);}catch(_0x57fb1d){console['error'](_0x48d3fe(0x1a3),_0x57fb1d);}}async['sendCustomNotification'](_0xf723c9,_0x27070b,_0x55bd49){const _0x4e5a56=a61_0x249a7f;let _0x4372d2='🔔\x20*'+_0x27070b+'*\x0a\x0a';for(const [_0x249a4a,_0x58526d]of Object[_0x4e5a56(0x19c)](_0x55bd49)){_0x58526d!==null&&_0x58526d!==undefined&&(_0x4372d2+=_0x249a4a+_0x4e5a56(0x13e)+_0x58526d+'`\x0a');}await this['sendShopNotification'](_0xf723c9,_0x4372d2,{'parse_mode':_0x4e5a56(0x1e1)});}async[a61_0x249a7f(0x161)](_0x37bab0){const _0x203424=a61_0x249a7f;try{console[_0x203424(0x1c0)](_0x203424(0x148)+_0x37bab0['substring'](0x0,0x32)+_0x203424(0x14e));const _0x4bd8aa=await database_1[_0x203424(0x1a6)][_0x203424(0x109)]['findMany']({'select':{'telegramId':!![]}});if(_0x4bd8aa['length']===0x0){console['log'](_0x203424(0x140));return;}for(const _0x39d449 of _0x4bd8aa){try{await this['bot']?.[_0x203424(0x187)](_0x39d449['telegramId'],_0x37bab0,{'parse_mode':'Markdown'});}catch(_0x4e680e){console[_0x203424(0x10e)](_0x203424(0x12b)+_0x39d449[_0x203424(0x166)]+':',_0x4e680e);}}console[_0x203424(0x1c0)](_0x203424(0x1c1)+_0x4bd8aa[_0x203424(0xfa)]+_0x203424(0x156));}catch(_0x20f946){console[_0x203424(0x10e)](_0x203424(0x15b),_0x20f946);}}['getBotInfo'](){const _0x32eeb9=a61_0x249a7f;return{'isActive':!!this[_0x32eeb9(0x114)],'username':this[_0x32eeb9(0x151)]};}[a61_0x249a7f(0x1d1)](){const _0x1aed88=a61_0x249a7f;this['bot']&&(this[_0x1aed88(0x114)][_0x1aed88(0x15a)](),this['bot']=null,console[_0x1aed88(0x1c0)](_0x1aed88(0x1c3)));}}exports[a61_0x249a7f(0x14f)]=TelegramBotService,exports[a61_0x249a7f(0x16d)]=new TelegramBotService();