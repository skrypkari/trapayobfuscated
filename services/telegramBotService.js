'use strict';const a74_0x2097ee=a74_0x53c6;(function(_0x4d25c1,_0x338b6e){const _0x3ef8c6=a74_0x53c6,_0x1dec3f=_0x4d25c1();while(!![]){try{const _0x22b327=parseInt(_0x3ef8c6(0x250))/0x1+parseInt(_0x3ef8c6(0x261))/0x2+-parseInt(_0x3ef8c6(0x2c0))/0x3*(-parseInt(_0x3ef8c6(0x234))/0x4)+parseInt(_0x3ef8c6(0x2d8))/0x5+parseInt(_0x3ef8c6(0x285))/0x6+-parseInt(_0x3ef8c6(0x1f1))/0x7*(parseInt(_0x3ef8c6(0x238))/0x8)+parseInt(_0x3ef8c6(0x2c7))/0x9*(-parseInt(_0x3ef8c6(0x21d))/0xa);if(_0x22b327===_0x338b6e)break;else _0x1dec3f['push'](_0x1dec3f['shift']());}catch(_0xb58f34){_0x1dec3f['push'](_0x1dec3f['shift']());}}}(a74_0x21f0,0xbb4c1));function a74_0x21f0(){const _0xc55dff=['allSettled','sendNotificationToAll','__esModule','trapay_bot','Payment\x20refund','Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.','notificationLogin','image/jpeg','Use\x20/start\x20to\x20connect.','üí∏\x20Penalty\x20amount:\x20*','‚è≥\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a','‚úÖ\x20Telegram\x20bot\x20@','split','warn','\x20(@','üåê\x20IP:\x20`','createdAt','üìä\x20*Connection\x20Status*\x0a\x0a','sk_','telegramBotService','endpoint','‚ùå\x20Error\x20sending\x20direct\x20message:','../config/database','‚ùå\x20Failed\x20to\x20send\x20notification\x20to\x20all\x20users:','chat','New\x20payment\x20created','300861HcdAkD','env','‚úÖ\x20Notification\x20sent\x20to\x20Telegram\x20user\x20','customerIp','üì±\x20Notification\x20sent\x20to\x20','‚ùå\x20Invalid\x20username\x20format:\x20`','‚ùå\x20Error:\x20`','17736048CXfAan','üìß\x20Email:\x20`','üè™\x20Your\x20connected\x20shop:\x0a','isVerified','notificationApiError','Payment\x20chargeback','‚úÖ\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20','\x20USD\x0a','sendDirectFile','wallet','sendMessage','‚Ä¢\x20Payouts\x0a','\x20verified\x20for\x20shop\x20','‚ùå\x20Error\x20getting\x20debug\x20information.','Markdown','ü§ñ\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a','error','3719325MoHUfi','Not\x20specified','‚ùå\x20API\x20key\x20does\x20not\x20match\x20shop\x20`','toLocaleString','first_name','‚ùå\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20','üí≥\x20*Wallet:*\x20`','üì±\x20Your\x20Telegram\x20ID:\x20`','You\x20sent\x20','\x20initialized\x20successfully','onText','üîó\x20*Transaction\x20Link:*\x20`','/status\x20-\x20check\x20connection\x20status\x0a','startsWith','‚ùå\x20Please\x20use\x20/start\x20command\x20first','Error\x20handling\x20/status\x20command:','\x22,\x20apiKey=\x22','7uORqLG','üîó\x20*Transaction\x20Link:*\x20Pending','üì±\x20Telegram\x20notification:\x20gateway\x20\x22','‚è±Ô∏è\x20*Period:*\x20','findMany','sendCustomNotification','‚úÖ\x20File\x20sent\x20to\x20chat\x20','Contact\x20administrator.','\x0aüë§\x20*Customer\x20Information:*\x0a','gateway','customerEmail','sendShopNotification','To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a','`.\x0a\x0a','endsWith','üè¶\x20IBAN:\x20`','initializeBot','log','Successful\x20login','telegramId','ipAddress','‚Ä¢\x20Payment\x20status\x20changes\x0a','Please\x20check\x20the\x20spelling\x20and\x20try\x20again.\x0a\x0a','...','Commands:\x0a','üÜî\x20Payment\x20ID:\x20`','üìù\x20Format:\x20`username\x20api_key`\x0a\x0a','Error\x20sending\x20shop\x20notification:','üë§\x20Username:\x20`','adminNotes','\x20users\x20of\x20shop\x20','Telegram\x20bot\x20polling\x20error:','customerName','üí∏\x20*New\x20Payout*\x0a\x0a','\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure','‚úÖ\x20Connected\x20to\x20shop:\x20*','‚ùå\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.','processing','üìÖ\x20Date:\x20','`\x20is\x20inactive.\x0a\x0a','Username:\x20`','TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables','unknown\x20shop','defineProperty','20RDLvrv','.pdf','handleSingleLineVerification','network','shop','orderId','update','statusCode','Error\x20handling\x20/debug\x20command:','polling_error','Make\x20sure\x20you\x20have\x20the\x20correct\x20username\x20from\x20your\x20account.','length','sendDirectMessage','success','Failed\x20to\x20send\x20API\x20error\x20notification:','‚ùóÔ∏è\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!','\x0aüí°\x20Check\x20your\x20request\x20or\x20contact\x20support.','setupBotHandlers','timestamp','trim','application/octet-stream','TelegramBotService','user\x20is\x20deactivated','36eOcCGY',':\x20username=\x22','`\x0a\x0a','chargeback','1087216WPtSxY','üì±\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20','chat\x20not\x20found','TELEGRAM_BOT_USERNAME','findUnique','‚úÖ\x20Login\x20notification\x20sent\x20for\x20shop\x20','\x22\x20->\x20display\x20\x22','üìÖ\x20Connection\x20date:\x20','../types/gateway','üõë\x20Telegram\x20bot\x20stopped','üîÑ\x20Reset\x20incomplete\x20verification\x20for\x20user\x20','default','Use\x20/start\x20to\x20connect\x20to\x20a\x20shop.','\x20parts:\x20','stopPolling','*\x0a\x0a','blocked','.jpg','‚ùå\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`','map','Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification','üîå\x20User\x20','txid','`\x20not\x20found.\x0a\x0a','759887TREQEW','‚ùå\x20An\x20error\x20occurred\x20while\x20verifying\x20data.','remitterIban','telegramUser','\x20\x20\x20Username:\x20`','application/pdf','üîî\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a','botUsername','.jpeg','geo','username','Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.','toString','create','getGatewayDisplayNameForTelegram','last_name','üåê\x20IP\x20address:\x20`','1859690KmhqMQ','‚ùå\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','customerUa','2-digit','Failed\x20to\x20send\x20login\x20notification:','botToken','üì±\x20Sending\x20notification\x20to\x20all\x20connected\x20users:\x20','‚ùå\x20Telegram\x20bot\x20not\x20initialized','chargebackAmount','test','image/png','üö®\x20*API\x20Error*\x0a\x0a','‚ùå\x20Failed\x20to\x20send\x20message\x20to\x20user\x20','üîç\x20*Debug\x20Information*\x0a\x0a','en-US','‚ùå\x20Shop\x20with\x20username\x20`','includes','‚Ä¢\x20Payouts\x0a\x0a','sendDocument','ACTIVE','üÜî\x20Request\x20ID:\x20`','*.\x0a\x0a','shopId','Failed\x20login\x20attempt','sendPayoutNotification','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','/disconnect\x20-\x20disconnect\x20from\x20notifications','‚úÖ\x20File\x20sent\x20to\x20','from','Error\x20in\x20handleSingleLineVerification:','__importDefault','‚úÖ\x20Direct\x20message\x20sent\x20to\x20chat\x20','sendShopFile','‚Ä¢\x20New\x20payments\x0a','üîî\x20Notifications\x20are\x20active\x0a\x0a','üíª\x20Browser:\x20`','9049410NgWGjw','userAgent','User\x20','.png','‚ùå\x20Failed\x20to\x20initialize\x20Telegram\x20bot:','message','substring','‚Ä¢\x20Important\x20events\x0a\x0a','bot','API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','...\x22','name','requestId','‚úÖ\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a','No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20','‚ùå\x20No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20ID:\x20','text','secretKey','\x20\x20\x20Name:\x20*','üìä\x20Error\x20code:\x20`','status','üîÑ\x20Processing\x20single-line\x20verification\x20for\x20user\x20','amount','toLocaleDateString','getBotInfo','üìù\x20Notes:\x20','üì±\x20Created\x20new\x20Telegram\x20user:\x20','‚ùå\x20Shop\x20`','üîî\x20*','errorMessage','shopSettings','üìù\x20Order\x20ID:\x20`','TELEGRAM_BOT_TOKEN'];a74_0x21f0=function(){return _0xc55dff;};return a74_0x21f0();}var __importDefault=this&&this[a74_0x2097ee(0x27f)]||function(_0x302a26){const _0x4add2b=a74_0x2097ee;return _0x302a26&&_0x302a26[_0x4add2b(0x2a8)]?_0x302a26:{'default':_0x302a26};};Object[a74_0x2097ee(0x21c)](exports,a74_0x2097ee(0x2a8),{'value':!![]}),exports['telegramBotService']=exports['TelegramBotService']=void 0x0;function a74_0x53c6(_0x1418d4,_0x3fa994){_0x1418d4=_0x1418d4-0x1e3;const _0x21f07a=a74_0x21f0();let _0x53c60d=_0x21f07a[_0x1418d4];return _0x53c60d;}const node_telegram_bot_api_1=__importDefault(require('node-telegram-bot-api')),database_1=__importDefault(require(a74_0x2097ee(0x2bc))),gateway_1=require(a74_0x2097ee(0x240));class TelegramBotService{constructor(){const _0x536b17=a74_0x2097ee;this[_0x536b17(0x28d)]=null,this[_0x536b17(0x266)]=process[_0x536b17(0x2c1)][_0x536b17(0x2a5)]||'',this['botUsername']=process[_0x536b17(0x2c1)][_0x536b17(0x23b)]||_0x536b17(0x2a9),this[_0x536b17(0x266)]?this[_0x536b17(0x201)]():console[_0x536b17(0x2b3)](_0x536b17(0x21a));}['initializeBot'](){const _0x555481=a74_0x2097ee;try{this[_0x555481(0x28d)]=new node_telegram_bot_api_1[(_0x555481(0x243))](this[_0x555481(0x266)],{'polling':!![]}),this[_0x555481(0x22e)](),console[_0x555481(0x202)](_0x555481(0x2b1)+this[_0x555481(0x257)]+_0x555481(0x1e9));}catch(_0x51a4b2){console[_0x555481(0x2d7)](_0x555481(0x289),_0x51a4b2);}}[a74_0x2097ee(0x22e)](){const _0x1ac5d8=a74_0x2097ee;if(!this[_0x1ac5d8(0x28d)])return;this['bot']['onText'](/\/start/,async _0x1d1580=>{const _0x1d090c=_0x1ac5d8,_0x1f1356=_0x1d1580[_0x1d090c(0x2be)]['id'],_0x372910=_0x1d1580[_0x1d090c(0x27d)]?.['id'][_0x1d090c(0x25c)](),_0x524667=_0x1d1580[_0x1d090c(0x27d)]?.[_0x1d090c(0x25a)],_0x103665=_0x1d1580[_0x1d090c(0x27d)]?.[_0x1d090c(0x1e4)],_0x65b373=_0x1d1580[_0x1d090c(0x27d)]?.[_0x1d090c(0x25f)];if(!_0x372910)return;try{let _0x3afdd=await database_1['default']['telegramUser'][_0x1d090c(0x23c)]({'where':{'telegramId':_0x372910},'include':{'shop':!![]}});!_0x3afdd?(_0x3afdd=await database_1[_0x1d090c(0x243)][_0x1d090c(0x253)][_0x1d090c(0x25d)]({'data':{'telegramId':_0x372910,'username':_0x524667,'firstName':_0x103665,'lastName':_0x65b373,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console['log'](_0x1d090c(0x29f)+_0x372910+_0x1d090c(0x2b4)+_0x524667+')')):_0x3afdd=await database_1[_0x1d090c(0x243)][_0x1d090c(0x253)]['update']({'where':{'telegramId':_0x372910},'data':{'username':_0x524667,'firstName':_0x103665,'lastName':_0x65b373},'include':{'shop':!![]}}),_0x3afdd[_0x1d090c(0x2ca)]&&_0x3afdd[_0x1d090c(0x277)]&&_0x3afdd[_0x1d090c(0x221)]?await this['bot']?.[_0x1d090c(0x2d1)](_0x1f1356,'‚úÖ\x20Welcome\x20back!\x0a\x0a'+('You\x20are\x20already\x20connected\x20to\x20shop:\x20*'+_0x3afdd[_0x1d090c(0x221)][_0x1d090c(0x290)]+'*\x0a')+(_0x1d090c(0x219)+_0x3afdd[_0x1d090c(0x221)][_0x1d090c(0x25a)]+_0x1d090c(0x236))+'üîî\x20You\x20receive\x20notifications\x20about:\x0a'+'‚Ä¢\x20New\x20payments\x0a'+_0x1d090c(0x206)+_0x1d090c(0x272)+_0x1d090c(0x209)+_0x1d090c(0x1ec)+'/disconnect\x20-\x20disconnect\x20from\x20notifications',{'parse_mode':_0x1d090c(0x2d5)}):(_0x3afdd['shopId']&&!_0x3afdd[_0x1d090c(0x2ca)]&&(await database_1[_0x1d090c(0x243)][_0x1d090c(0x253)]['update']({'where':{'telegramId':_0x372910},'data':{'shopId':null,'isVerified':![]}}),console['log'](_0x1d090c(0x242)+_0x372910)),await this[_0x1d090c(0x28d)]?.[_0x1d090c(0x2d1)](_0x1f1356,_0x1d090c(0x2d6)+_0x1d090c(0x1fd)+'üìù\x20Format:\x20`username\x20api_key`\x0a\x0a'+'Example:\x0a'+'`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a'+_0x1d090c(0x22c),{'parse_mode':'Markdown'}));}catch(_0x286d03){console[_0x1d090c(0x2d7)]('Error\x20handling\x20/start\x20command:',_0x286d03),await this[_0x1d090c(0x28d)]?.[_0x1d090c(0x2d1)](_0x1f1356,'‚ùå\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this[_0x1ac5d8(0x28d)][_0x1ac5d8(0x1ea)](/\/disconnect/,async _0x2a7587=>{const _0x2bb787=_0x1ac5d8,_0xa76ee3=_0x2a7587[_0x2bb787(0x2be)]['id'],_0x59c49c=_0x2a7587['from']?.['id'][_0x2bb787(0x25c)]();if(!_0x59c49c)return;try{const _0x38490d=await database_1[_0x2bb787(0x243)][_0x2bb787(0x253)][_0x2bb787(0x23c)]({'where':{'telegramId':_0x59c49c},'include':{'shop':!![]}});if(!_0x38490d||!_0x38490d[_0x2bb787(0x2ca)]||!_0x38490d[_0x2bb787(0x277)]){await this[_0x2bb787(0x28d)]?.['sendMessage'](_0xa76ee3,_0x2bb787(0x215));return;}const _0x4f2f4f=_0x38490d[_0x2bb787(0x221)]?.[_0x2bb787(0x290)]||_0x2bb787(0x21b);await database_1['default'][_0x2bb787(0x253)][_0x2bb787(0x223)]({'where':{'telegramId':_0x59c49c},'data':{'shopId':null,'isVerified':![]}}),console['log'](_0x2bb787(0x24d)+_0x59c49c+'\x20disconnected\x20from\x20shop\x20'+_0x38490d[_0x2bb787(0x277)]),await this[_0x2bb787(0x28d)]?.[_0x2bb787(0x2d1)](_0xa76ee3,'‚úÖ\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*'+_0x4f2f4f+_0x2bb787(0x276)+'To\x20reconnect,\x20use\x20the\x20/start\x20command',{'parse_mode':_0x2bb787(0x2d5)});}catch(_0x2bd10e){console[_0x2bb787(0x2d7)]('Error\x20handling\x20/disconnect\x20command:',_0x2bd10e),await this['bot']?.['sendMessage'](_0xa76ee3,'‚ùå\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this[_0x1ac5d8(0x28d)][_0x1ac5d8(0x1ea)](/\/status/,async _0x6414ea=>{const _0x22ceda=_0x1ac5d8,_0x29a885=_0x6414ea[_0x22ceda(0x2be)]['id'],_0x207001=_0x6414ea[_0x22ceda(0x27d)]?.['id'][_0x22ceda(0x25c)]();if(!_0x207001)return;try{const _0x1ff64e=await database_1[_0x22ceda(0x243)][_0x22ceda(0x253)]['findUnique']({'where':{'telegramId':_0x207001},'include':{'shop':!![]}});if(!_0x1ff64e){await this[_0x22ceda(0x28d)]?.[_0x22ceda(0x2d1)](_0x29a885,'‚ùå\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a'+'Use\x20/start\x20to\x20begin.');return;}if(!_0x1ff64e[_0x22ceda(0x2ca)]||!_0x1ff64e[_0x22ceda(0x277)]||!_0x1ff64e[_0x22ceda(0x221)]){await this['bot']?.[_0x22ceda(0x2d1)](_0x29a885,'‚ùå\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a'+_0x22ceda(0x2ae));return;}await this[_0x22ceda(0x28d)]?.[_0x22ceda(0x2d1)](_0x29a885,_0x22ceda(0x2b7)+(_0x22ceda(0x214)+_0x1ff64e[_0x22ceda(0x221)][_0x22ceda(0x290)]+'*\x0a')+(_0x22ceda(0x20d)+_0x1ff64e['shop'][_0x22ceda(0x25a)]+'`\x0a')+(_0x22ceda(0x23f)+_0x1ff64e['updatedAt'][_0x22ceda(0x29c)](_0x22ceda(0x26f))+'\x0a\x0a')+_0x22ceda(0x283)+_0x22ceda(0x209)+_0x22ceda(0x27b),{'parse_mode':_0x22ceda(0x2d5)});}catch(_0x53bf05){console[_0x22ceda(0x2d7)](_0x22ceda(0x1ef),_0x53bf05),await this[_0x22ceda(0x28d)]?.[_0x22ceda(0x2d1)](_0x29a885,_0x22ceda(0x262));}}),this[_0x1ac5d8(0x28d)][_0x1ac5d8(0x1ea)](/\/debug/,async _0x480ba3=>{const _0x25a6ff=_0x1ac5d8,_0x57cd8f=_0x480ba3[_0x25a6ff(0x2be)]['id'],_0x1005e0=_0x480ba3['from']?.['id'][_0x25a6ff(0x25c)]();if(!_0x1005e0)return;try{const _0x34458f=await database_1[_0x25a6ff(0x243)]['telegramUser'][_0x25a6ff(0x23c)]({'where':{'telegramId':_0x1005e0},'include':{'shop':!![]}});let _0x31acfa=_0x25a6ff(0x26e);_0x31acfa+=_0x25a6ff(0x1e7)+_0x1005e0+_0x25a6ff(0x236),_0x34458f?.[_0x25a6ff(0x2ca)]&&_0x34458f[_0x25a6ff(0x221)]?(_0x31acfa+=_0x25a6ff(0x2c9),_0x31acfa+=_0x25a6ff(0x297)+_0x34458f['shop'][_0x25a6ff(0x290)]+'*\x0a',_0x31acfa+=_0x25a6ff(0x254)+_0x34458f[_0x25a6ff(0x221)]['username']+'`\x0a',_0x31acfa+='\x20\x20\x20Status:\x20'+_0x34458f[_0x25a6ff(0x221)]['status']+'\x0a\x0a'):_0x31acfa+='‚ùå\x20You\x20are\x20not\x20connected\x20to\x20any\x20shop.\x0a\x0a',_0x31acfa+=_0x25a6ff(0x244),await this[_0x25a6ff(0x28d)]?.[_0x25a6ff(0x2d1)](_0x57cd8f,_0x31acfa,{'parse_mode':_0x25a6ff(0x2d5)});}catch(_0x3a6c81){console[_0x25a6ff(0x2d7)](_0x25a6ff(0x225),_0x3a6c81),await this[_0x25a6ff(0x28d)]?.[_0x25a6ff(0x2d1)](_0x57cd8f,_0x25a6ff(0x2d4));}}),this[_0x1ac5d8(0x28d)]['on'](_0x1ac5d8(0x28a),async _0x24f5e1=>{const _0x1d51fb=_0x1ac5d8;if(_0x24f5e1[_0x1d51fb(0x295)]?.[_0x1d51fb(0x1ed)]('/'))return;const _0x4974d7=_0x24f5e1[_0x1d51fb(0x2be)]['id'],_0x261529=_0x24f5e1['from']?.['id']['toString'](),_0x20eb51=_0x24f5e1['text']?.[_0x1d51fb(0x230)]();if(!_0x261529||!_0x20eb51)return;try{const _0xd6ef14=await database_1[_0x1d51fb(0x243)]['telegramUser'][_0x1d51fb(0x23c)]({'where':{'telegramId':_0x261529},'include':{'shop':!![]}});if(!_0xd6ef14){await this[_0x1d51fb(0x28d)]?.[_0x1d51fb(0x2d1)](_0x4974d7,_0x1d51fb(0x1ee));return;}if(_0xd6ef14['isVerified']&&_0xd6ef14[_0x1d51fb(0x277)]&&_0xd6ef14['shop']){await this[_0x1d51fb(0x28d)]?.[_0x1d51fb(0x2d1)](_0x4974d7,'‚úÖ\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*'+_0xd6ef14['shop'][_0x1d51fb(0x290)]+'*.\x0a\x0a'+_0x1d51fb(0x25b),{'parse_mode':_0x1d51fb(0x2d5)});return;}const _0x3384eb=_0x20eb51[_0x1d51fb(0x2b2)](/\s+/);if(_0x3384eb[_0x1d51fb(0x228)]!==0x2){await this[_0x1d51fb(0x28d)]?.[_0x1d51fb(0x2d1)](_0x4974d7,'‚ùå\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a'+_0x1d51fb(0x20b)+'Example:\x0a'+_0x1d51fb(0x27a)+(_0x1d51fb(0x1e8)+_0x3384eb[_0x1d51fb(0x228)]+_0x1d51fb(0x245)+_0x3384eb[_0x1d51fb(0x24b)](_0x2b370c=>'`'+_0x2b370c+'`')['join'](',\x20')),{'parse_mode':_0x1d51fb(0x2d5)});return;}const [_0x564603,_0x5c252d]=_0x3384eb;console[_0x1d51fb(0x202)](_0x1d51fb(0x29a)+_0x261529+_0x1d51fb(0x235)+_0x564603+_0x1d51fb(0x1f0)+_0x5c252d['substring'](0x0,0xa)+_0x1d51fb(0x28f)),await this[_0x1d51fb(0x21f)](_0x4974d7,_0x261529,_0x564603,_0x5c252d);}catch(_0x2c648e){console[_0x1d51fb(0x2d7)]('Error\x20handling\x20message:',_0x2c648e),await this[_0x1d51fb(0x28d)]?.['sendMessage'](_0x4974d7,_0x1d51fb(0x262));}}),this['bot']['on'](_0x1ac5d8(0x2d7),_0x4b9ef2=>{const _0x732d1f=_0x1ac5d8;console[_0x732d1f(0x2d7)]('Telegram\x20bot\x20error:',_0x4b9ef2);}),this[_0x1ac5d8(0x28d)]['on'](_0x1ac5d8(0x226),_0x14e511=>{const _0x113917=_0x1ac5d8;console['error'](_0x113917(0x210),_0x14e511);});}async[a74_0x2097ee(0x21f)](_0x4bdb6b,_0x5c94a7,_0x5d997c,_0x85b807){const _0x40f436=a74_0x2097ee;try{console[_0x40f436(0x202)](_0x40f436(0x29a)+_0x5c94a7+_0x40f436(0x235)+_0x5d997c+_0x40f436(0x1f0)+_0x85b807[_0x40f436(0x28b)](0x0,0xa)+'...\x22');if(!_0x5d997c||_0x5d997c[_0x40f436(0x228)]<0x3||_0x5d997c[_0x40f436(0x228)]>0x32||!/^[a-zA-Z0-9_]+$/[_0x40f436(0x26a)](_0x5d997c)){await this['bot']?.[_0x40f436(0x2d1)](_0x4bdb6b,_0x40f436(0x2c5)+_0x5d997c+'`\x0a\x0a'+'Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).',{'parse_mode':'Markdown'});return;}if(!_0x85b807||!_0x85b807['startsWith']('pk_')&&!_0x85b807[_0x40f436(0x1ed)](_0x40f436(0x2b8))){await this[_0x40f436(0x28d)]?.[_0x40f436(0x2d1)](_0x4bdb6b,'‚ùå\x20Invalid\x20API\x20key\x20format.\x0a\x0a'+_0x40f436(0x28e),{'parse_mode':'Markdown'});return;}const _0x3622ac=await database_1['default'][_0x40f436(0x221)][_0x40f436(0x23c)]({'where':{'username':_0x5d997c},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x3622ac){const _0x5da9e4=_0x40f436(0x270)+_0x5d997c+_0x40f436(0x24f)+_0x40f436(0x207)+_0x40f436(0x227);await this[_0x40f436(0x28d)]?.[_0x40f436(0x2d1)](_0x4bdb6b,_0x5da9e4,{'parse_mode':_0x40f436(0x2d5)});return;}if(_0x3622ac[_0x40f436(0x299)]!==_0x40f436(0x274)){await this[_0x40f436(0x28d)]?.[_0x40f436(0x2d1)](_0x4bdb6b,_0x40f436(0x2a0)+_0x5d997c+_0x40f436(0x218)+_0x40f436(0x1f8),{'parse_mode':_0x40f436(0x2d5)});return;}if(_0x3622ac['publicKey']!==_0x85b807&&_0x3622ac[_0x40f436(0x296)]!==_0x85b807){await this[_0x40f436(0x28d)]?.[_0x40f436(0x2d1)](_0x4bdb6b,_0x40f436(0x2da)+_0x5d997c+_0x40f436(0x1fe)+'Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a'+'Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`',{'parse_mode':_0x40f436(0x2d5)});return;}const _0x39ca4c=await database_1[_0x40f436(0x243)][_0x40f436(0x253)]['findFirst']({'where':{'shopId':_0x3622ac['id'],'isVerified':!![],'telegramId':{'not':_0x5c94a7}}});if(_0x39ca4c){await this['bot']?.[_0x40f436(0x2d1)](_0x4bdb6b,_0x40f436(0x24a)+_0x5d997c+_0x40f436(0x1fe)+_0x40f436(0x2ab),{'parse_mode':_0x40f436(0x2d5)});return;}await database_1[_0x40f436(0x243)]['telegramUser'][_0x40f436(0x223)]({'where':{'telegramId':_0x5c94a7},'data':{'shopId':_0x3622ac['id'],'isVerified':!![]}}),await this[_0x40f436(0x28d)]?.['sendMessage'](_0x4bdb6b,'üéâ\x20*Congratulations!*\x0a\x0a'+_0x40f436(0x292)+('üì±\x20Shop:\x20*'+_0x3622ac['name']+'*\x0a')+('üë§\x20Username:\x20`'+_0x3622ac['username']+_0x40f436(0x236))+_0x40f436(0x256)+_0x40f436(0x282)+_0x40f436(0x206)+_0x40f436(0x2d2)+_0x40f436(0x28c)+_0x40f436(0x209)+_0x40f436(0x1ec)+_0x40f436(0x27b),{'parse_mode':_0x40f436(0x2d5)}),console[_0x40f436(0x202)]('‚úÖ\x20Telegram\x20user\x20'+_0x5c94a7+_0x40f436(0x2d3)+_0x3622ac[_0x40f436(0x25a)]+'\x20via\x20single-line\x20input');}catch(_0x5b4ead){console[_0x40f436(0x2d7)](_0x40f436(0x27e),_0x5b4ead),await this['bot']?.['sendMessage'](_0x4bdb6b,_0x40f436(0x251));}}async[a74_0x2097ee(0x1fc)](_0x1b78b6,_0x4e19a2,_0x568b4a){const _0xf9cf94=a74_0x2097ee;if(!this[_0xf9cf94(0x28d)]){console[_0xf9cf94(0x2b3)](_0xf9cf94(0x24c));return;}try{const _0x36a4f8=await database_1[_0xf9cf94(0x243)][_0xf9cf94(0x253)]['findMany']({'where':{'shopId':_0x1b78b6,'isVerified':!![]}});if(_0x36a4f8['length']===0x0){console[_0xf9cf94(0x202)](_0xf9cf94(0x293)+_0x1b78b6);return;}const _0xddaccd=_0x36a4f8[_0xf9cf94(0x24b)](async _0x48cc8a=>{const _0x414beb=_0xf9cf94;try{await this[_0x414beb(0x28d)]?.[_0x414beb(0x2d1)](_0x48cc8a['telegramId'],_0x4e19a2,_0x568b4a),console[_0x414beb(0x202)](_0x414beb(0x2c2)+_0x48cc8a[_0x414beb(0x204)]);}catch(_0x30041b){console[_0x414beb(0x2d7)](_0x414beb(0x1e5)+_0x48cc8a['telegramId']+':',_0x30041b),_0x30041b instanceof Error&&(_0x30041b[_0x414beb(0x28a)][_0x414beb(0x271)](_0x414beb(0x248))||_0x30041b[_0x414beb(0x28a)][_0x414beb(0x271)](_0x414beb(0x23a))||_0x30041b[_0x414beb(0x28a)]['includes'](_0x414beb(0x233)))&&(await database_1['default'][_0x414beb(0x253)][_0x414beb(0x223)]({'where':{'id':_0x48cc8a['id']},'data':{'isVerified':![]}}),console[_0x414beb(0x202)](_0x414beb(0x287)+_0x48cc8a['telegramId']+_0x414beb(0x213)));}});await Promise[_0xf9cf94(0x2a6)](_0xddaccd);}catch(_0x1ab565){console['error'](_0xf9cf94(0x20c),_0x1ab565);}}async['sendPaymentNotification'](_0x43ae96,_0x231a91,_0x26a9ee){const _0x46b71f=a74_0x2097ee,_0x4ff1e6={'created':'üÜï','paid':'‚úÖ','failed':'‚ùå','expired':'‚è∞','refund':'üîÑ','chargeback':'‚ö†Ô∏è','processing':'‚öôÔ∏è'},_0x463cd9={'created':_0x46b71f(0x2bf),'paid':'Payment\x20successfully\x20paid','failed':'Payment\x20failed','expired':'Payment\x20expired','refund':_0x46b71f(0x2aa),'chargeback':_0x46b71f(0x2cc),'processing':'Payment\x20is\x20being\x20processed'},_0x2dd8d1=_0x4ff1e6[_0x26a9ee],_0x59e707=_0x463cd9[_0x26a9ee],_0x38a214=(0x0,gateway_1[_0x46b71f(0x25e)])(_0x231a91[_0x46b71f(0x1fa)]);console['log'](_0x46b71f(0x1f3)+_0x231a91['gateway']+_0x46b71f(0x23e)+_0x38a214+'\x22');let _0x30dd2c=_0x2dd8d1+'\x20*'+_0x59e707+_0x46b71f(0x247)+('üí∞\x20Amount:\x20*'+_0x231a91[_0x46b71f(0x29b)]+'\x20'+_0x231a91['currency']+'*\x0a')+(_0x46b71f(0x2a4)+(_0x231a91[_0x46b71f(0x222)]||_0x231a91['id'])+'`\x0a')+(_0x46b71f(0x20a)+_0x231a91['id']+'`\x0a')+('üè™\x20Gateway:\x20`'+_0x38a214+'`\x0a')+(_0x46b71f(0x217)+new Date(_0x231a91[_0x46b71f(0x2b6)])[_0x46b71f(0x1e3)](_0x46b71f(0x26f))+'\x0a');if(_0x231a91[_0x46b71f(0x211)]||_0x231a91[_0x46b71f(0x1fb)]||_0x231a91[_0x46b71f(0x252)]||_0x231a91[_0x46b71f(0x2c3)]||_0x231a91[_0x46b71f(0x263)]){_0x30dd2c+=_0x46b71f(0x1f9);_0x231a91[_0x46b71f(0x211)]&&(_0x30dd2c+='üìõ\x20Name:\x20`'+_0x231a91[_0x46b71f(0x211)]+'`\x0a');_0x231a91[_0x46b71f(0x1fb)]&&(_0x30dd2c+=_0x46b71f(0x2c8)+_0x231a91[_0x46b71f(0x1fb)]+'`\x0a');_0x231a91[_0x46b71f(0x252)]&&(_0x30dd2c+=_0x46b71f(0x200)+_0x231a91[_0x46b71f(0x252)]+'`\x0a');_0x231a91[_0x46b71f(0x2c3)]&&(_0x30dd2c+=_0x46b71f(0x2b5)+_0x231a91['customerIp']+'`\x0a');if(_0x231a91['customerUa']){const _0x266945=_0x231a91['customerUa'][_0x46b71f(0x228)]>0x32?_0x231a91[_0x46b71f(0x263)][_0x46b71f(0x28b)](0x0,0x32)+_0x46b71f(0x208):_0x231a91['customerUa'];_0x30dd2c+=_0x46b71f(0x284)+_0x266945+'`\x0a';}}_0x26a9ee===_0x46b71f(0x237)&&_0x231a91['chargebackAmount']&&(_0x30dd2c+=_0x46b71f(0x2af)+_0x231a91[_0x46b71f(0x269)]+'\x20USDT*\x0a'),_0x26a9ee===_0x46b71f(0x216)&&(_0x30dd2c+=_0x46b71f(0x2b0)),_0x231a91[_0x46b71f(0x20e)]&&(_0x30dd2c+=_0x46b71f(0x29e)+_0x231a91['adminNotes']+'\x0a'),await this[_0x46b71f(0x1fc)](_0x43ae96,_0x30dd2c,{'parse_mode':_0x46b71f(0x2d5)});}async[a74_0x2097ee(0x279)](_0x462b78,_0x71bba1){const _0x548155=a74_0x2097ee,_0x4b0cce=new Date(_0x71bba1['createdAt'])[_0x548155(0x1e3)]('en-US',{'year':'numeric','month':_0x548155(0x264),'day':'2-digit','hour':_0x548155(0x264),'minute':_0x548155(0x264),'second':_0x548155(0x264)}),_0xbce84f=_0x548155(0x212)+('üìÖ\x20*Payout\x20Date:*\x20'+_0x4b0cce+'\x0a')+('üí∞\x20*Amount:*\x20'+_0x71bba1[_0x548155(0x29b)]+_0x548155(0x2ce))+(_0x548155(0x1f4)+(_0x71bba1['period']||_0x548155(0x2d9))+'\x0a')+('üåê\x20*Network:*\x20'+(_0x71bba1[_0x548155(0x220)]||_0x548155(0x2d9))+'\x0a')+(_0x548155(0x1e6)+(_0x71bba1[_0x548155(0x2d0)]||'Not\x20specified')+'`\x0a')+(_0x71bba1[_0x548155(0x24e)]?_0x548155(0x1eb)+_0x71bba1['txid']+'`':_0x548155(0x1f2));await this['sendShopNotification'](_0x462b78,_0xbce84f,{'parse_mode':_0x548155(0x2d5)});}async['sendLoginNotification'](_0x4c3b25,_0x7422be){const _0x24cb9f=a74_0x2097ee;try{const _0x46dd1d=await database_1['default'][_0x24cb9f(0x2a3)]['findUnique']({'where':{'shopId':_0x4c3b25},'select':{'notificationLogin':!![]}});if(!_0x46dd1d?.[_0x24cb9f(0x2ac)]){console[_0x24cb9f(0x202)]('üì±\x20Login\x20notifications\x20disabled\x20for\x20shop\x20'+_0x4c3b25);return;}const _0x39f4f4=_0x7422be['success']?'üîê':'üö®',_0xb20d37=_0x7422be[_0x24cb9f(0x22a)]?_0x24cb9f(0x203):_0x24cb9f(0x278);let _0x4d0cbc=_0x39f4f4+'\x20*'+_0xb20d37+'*\x0a\x0a'+(_0x24cb9f(0x20d)+_0x7422be[_0x24cb9f(0x25a)]+'`\x0a')+('üìÖ\x20Time:\x20'+_0x7422be[_0x24cb9f(0x22f)][_0x24cb9f(0x1e3)](_0x24cb9f(0x26f))+'\x0a');_0x7422be[_0x24cb9f(0x205)]&&(_0x4d0cbc+=_0x24cb9f(0x260)+_0x7422be[_0x24cb9f(0x205)]+'`\x0a');_0x7422be[_0x24cb9f(0x259)]&&(_0x4d0cbc+='üåç\x20Country:\x20'+_0x7422be['geo']+'\x0a');if(_0x7422be[_0x24cb9f(0x286)]){const _0x3b5574=_0x7422be[_0x24cb9f(0x286)][_0x24cb9f(0x228)]>0x32?_0x7422be[_0x24cb9f(0x286)]['substring'](0x0,0x32)+_0x24cb9f(0x208):_0x7422be[_0x24cb9f(0x286)];_0x4d0cbc+=_0x24cb9f(0x284)+_0x3b5574+'`\x0a';}!_0x7422be['success']&&(_0x4d0cbc+='\x0a‚ö†Ô∏è\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!'),await this['sendShopNotification'](_0x4c3b25,_0x4d0cbc,{'parse_mode':_0x24cb9f(0x2d5)}),console[_0x24cb9f(0x202)](_0x24cb9f(0x23d)+_0x4c3b25+':\x20'+(_0x7422be['success']?_0x24cb9f(0x22a):'failed'));}catch(_0x24f58a){console[_0x24cb9f(0x2d7)](_0x24cb9f(0x265),_0x24f58a);}}async['sendApiErrorNotification'](_0x3dc405,_0xbddb2a){const _0x585825=a74_0x2097ee;try{const _0x449526=await database_1[_0x585825(0x243)][_0x585825(0x2a3)][_0x585825(0x23c)]({'where':{'shopId':_0x3dc405},'select':{'notificationApiError':!![]}});if(!_0x449526?.[_0x585825(0x2cb)]){console[_0x585825(0x202)](_0x585825(0x239)+_0x3dc405);return;}let _0x5bd7f4=_0x585825(0x26c)+('üîó\x20Endpoint:\x20`'+_0xbddb2a['method']+'\x20'+_0xbddb2a[_0x585825(0x2ba)]+'`\x0a')+('üìÖ\x20Time:\x20'+_0xbddb2a[_0x585825(0x22f)][_0x585825(0x1e3)]('en-US')+'\x0a');_0xbddb2a[_0x585825(0x224)]&&(_0x5bd7f4+=_0x585825(0x298)+_0xbddb2a[_0x585825(0x224)]+'`\x0a'),_0x5bd7f4+=_0x585825(0x2c6)+_0xbddb2a[_0x585825(0x2a2)]+'`\x0a',_0xbddb2a[_0x585825(0x291)]&&(_0x5bd7f4+=_0x585825(0x275)+_0xbddb2a[_0x585825(0x291)]+'`\x0a'),_0x5bd7f4+=_0x585825(0x22d),await this['sendShopNotification'](_0x3dc405,_0x5bd7f4,{'parse_mode':_0x585825(0x2d5)}),console[_0x585825(0x202)](_0x585825(0x2cd)+_0x3dc405+':\x20'+_0xbddb2a['endpoint']);}catch(_0x39a325){console[_0x585825(0x2d7)](_0x585825(0x22b),_0x39a325);}}async[a74_0x2097ee(0x1f6)](_0x2be85d,_0x43b183,_0x2b3958){const _0x517b80=a74_0x2097ee;let _0x22a489=_0x517b80(0x2a1)+_0x43b183+_0x517b80(0x247);for(const [_0xc4d88,_0x3fee44]of Object['entries'](_0x2b3958)){_0x3fee44!==null&&_0x3fee44!==undefined&&(_0x22a489+=_0xc4d88+':\x20`'+_0x3fee44+'`\x0a');}await this[_0x517b80(0x1fc)](_0x2be85d,_0x22a489,{'parse_mode':_0x517b80(0x2d5)});}async[a74_0x2097ee(0x2a7)](_0x502da9){const _0x1655e0=a74_0x2097ee;try{console[_0x1655e0(0x202)](_0x1655e0(0x267)+_0x502da9[_0x1655e0(0x28b)](0x0,0x32)+_0x1655e0(0x208));const _0x594cd4=await database_1[_0x1655e0(0x243)][_0x1655e0(0x253)][_0x1655e0(0x1f5)]({'select':{'telegramId':!![]}});if(_0x594cd4[_0x1655e0(0x228)]===0x0){console['log']('üì±\x20No\x20active\x20Telegram\x20users\x20found');return;}for(const _0x5c68eb of _0x594cd4){try{await this[_0x1655e0(0x28d)]?.[_0x1655e0(0x2d1)](_0x5c68eb[_0x1655e0(0x204)],_0x502da9,{'parse_mode':_0x1655e0(0x2d5)});}catch(_0xc82377){console[_0x1655e0(0x2d7)](_0x1655e0(0x26d)+_0x5c68eb[_0x1655e0(0x204)]+':',_0xc82377);}}console[_0x1655e0(0x202)](_0x1655e0(0x2c4)+_0x594cd4[_0x1655e0(0x228)]+'\x20users');}catch(_0x554b6f){console[_0x1655e0(0x2d7)](_0x1655e0(0x2bd),_0x554b6f);}}[a74_0x2097ee(0x29d)](){const _0x3a98ca=a74_0x2097ee;return{'isActive':!!this[_0x3a98ca(0x28d)],'username':this[_0x3a98ca(0x257)]};}async[a74_0x2097ee(0x281)](_0x503f83,_0xb870c9,_0x3a5279,_0x22e1d8){const _0xd81969=a74_0x2097ee;try{if(!this[_0xd81969(0x28d)])return console[_0xd81969(0x2d7)](_0xd81969(0x268)),![];const _0x40ebec=await database_1[_0xd81969(0x243)]['telegramUser'][_0xd81969(0x1f5)]({'where':{'shopId':_0x503f83,'isVerified':!![]},'select':{'telegramId':!![]}});if(_0x40ebec['length']===0x0)return console['error'](_0xd81969(0x294)+_0x503f83),![];let _0x599592=0x0;for(const _0x3fe53b of _0x40ebec){try{await this[_0xd81969(0x28d)][_0xd81969(0x273)](_0x3fe53b['telegramId'],_0xb870c9,{},{'filename':_0x3a5279,'contentType':_0x3a5279[_0xd81969(0x1ff)](_0xd81969(0x288))?_0xd81969(0x26b):_0x3a5279[_0xd81969(0x1ff)]('.jpg')||_0x3a5279[_0xd81969(0x1ff)]('.jpeg')?_0xd81969(0x2ad):_0x3a5279[_0xd81969(0x1ff)](_0xd81969(0x21e))?_0xd81969(0x255):_0xd81969(0x231)}),_0x22e1d8&&await this['bot']['sendMessage'](_0x3fe53b[_0xd81969(0x204)],_0x22e1d8),_0x599592++;}catch(_0x2fcecc){console[_0xd81969(0x2d7)]('‚ùå\x20Error\x20sending\x20file\x20to\x20user\x20'+_0x3fe53b[_0xd81969(0x204)]+':',_0x2fcecc);}}return console[_0xd81969(0x202)](_0xd81969(0x27c)+_0x599592+'/'+_0x40ebec[_0xd81969(0x228)]+_0xd81969(0x20f)+_0x503f83+':\x20'+_0x3a5279),_0x599592>0x0;}catch(_0x4f4075){return console[_0xd81969(0x2d7)]('‚ùå\x20Error\x20sending\x20file\x20to\x20shop:',_0x4f4075),![];}}async[a74_0x2097ee(0x229)](_0x38969d,_0x42c3d9){const _0x459d47=a74_0x2097ee;try{if(!this[_0x459d47(0x28d)])return console['error'](_0x459d47(0x268)),![];return await this[_0x459d47(0x28d)][_0x459d47(0x2d1)](_0x38969d,_0x42c3d9),console[_0x459d47(0x202)](_0x459d47(0x280)+_0x38969d),!![];}catch(_0x8e7692){return console[_0x459d47(0x2d7)](_0x459d47(0x2bb),_0x8e7692),![];}}async[a74_0x2097ee(0x2cf)](_0x4e8824,_0x30788b,_0xc22860,_0x23a05a){const _0x3d68aa=a74_0x2097ee;try{if(!this[_0x3d68aa(0x28d)])return console[_0x3d68aa(0x2d7)](_0x3d68aa(0x268)),![];return await this['bot'][_0x3d68aa(0x273)](_0x4e8824,_0x30788b,{},{'filename':_0xc22860,'contentType':_0xc22860[_0x3d68aa(0x1ff)](_0x3d68aa(0x288))?_0x3d68aa(0x26b):_0xc22860[_0x3d68aa(0x1ff)](_0x3d68aa(0x249))||_0xc22860[_0x3d68aa(0x1ff)](_0x3d68aa(0x258))?_0x3d68aa(0x2ad):_0xc22860['endsWith'](_0x3d68aa(0x21e))?_0x3d68aa(0x255):'application/octet-stream'}),_0x23a05a&&await this['bot']['sendMessage'](_0x4e8824,_0x23a05a),console['log'](_0x3d68aa(0x1f7)+_0x4e8824+':\x20'+_0xc22860),!![];}catch(_0x93ec50){return console[_0x3d68aa(0x2d7)]('‚ùå\x20Error\x20sending\x20file\x20to\x20chat:',_0x93ec50),![];}}['stopBot'](){const _0x35e46d=a74_0x2097ee;this[_0x35e46d(0x28d)]&&(this['bot'][_0x35e46d(0x246)](),this[_0x35e46d(0x28d)]=null,console[_0x35e46d(0x202)](_0x35e46d(0x241)));}}exports[a74_0x2097ee(0x232)]=TelegramBotService,exports[a74_0x2097ee(0x2b9)]=new TelegramBotService();