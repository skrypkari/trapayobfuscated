'use strict';function a54_0x19af(){const _0x5235c5=['\x20\x20\x20Public\x20Key:\x20`',':\x20username=\x22','errorMessage','blocked','‚úÖ\x20Login\x20notification\x20sent\x20for\x20shop\x20','customerIp','log','üìÖ\x20Time:\x20','\x22\x20->\x20display\x20\x22','üìù\x20Order\x20ID:\x20`','/status\x20-\x20check\x20connection\x20status\x0a','üè™\x20Gateway:\x20`','pk_','from','sendMessage','customerUa','getBotInfo','findMany','üìÖ\x20Connection\x20date:\x20','‚ùå\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','‚Ä¢\x20New\x20payments\x0a','üì±\x20Login\x20notifications\x20disabled\x20for\x20shop\x20','trim','success','8LJGExe','Contact\x20administrator.','New\x20payout\x20created','1349180xtfylm','üë§\x20Username:\x20`','en-US','\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure','üÜî\x20Request\x20ID:\x20`','Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.','Error\x20handling\x20message:','üìÖ\x20Date:\x20','‚ùå\x20Please\x20use\x20/start\x20command\x20first','üÜî\x20Payment\x20ID:\x20`','‚è≥\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a','üè¶\x20IBAN:\x20`','\x20\x20\x20Status:\x20','‚ùå\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a','defineProperty','`\x20(','name','User\x20','toString','...\x22','‚ùå\x20Shop\x20with\x20username\x20`','üì±\x20Created\x20new\x20Telegram\x20user:\x20','You\x20sent\x20','\x20disconnected\x20from\x20shop\x20','default','TelegramBotService','\x20via\x20single-line\x20input','‚ùå\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`','‚ùå\x20Shop\x20`','Error\x20sending\x20shop\x20notification:','timestamp','Payout\x20completed','9215IUWwid','\x0aüë§\x20*Customer\x20Information:*\x0a','getGatewayDisplayNameForTelegram','TELEGRAM_BOT_USERNAME','You\x20are\x20already\x20connected\x20to\x20shop:\x20*','üÜî\x20Payout\x20ID:\x20`','‚ùå\x20Error:\x20`','telegramUser','shopSettings','*\x0a\x0a','üîî\x20You\x20receive\x20notifications\x20about:\x0a','/disconnect\x20-\x20disconnect\x20from\x20notifications','‚ùå\x20API\x20key\x20does\x20not\x20match\x20shop\x20`','currency','customerName','‚úÖ\x20Connected\x20to\x20shop:\x20*','...','stopBot','first_name','üîó\x20TXID:\x20`','method','üí∏\x20Amount:\x20*','amount','.\x20*','test','üìä\x20Error\x20code:\x20`','‚ùå\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a','Markdown','ipAddress','join','Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a','üéâ\x20*Congratulations!*\x0a\x0a','publicKey','user\x20is\x20deactivated','entries','üîÑ\x20Processing\x20single-line\x20verification\x20for\x20user\x20','\x20verified\x20for\x20shop\x20','startsWith','sk_','telegramBotService','Use\x20/start\x20to\x20connect.','includes','77205siSoGA','handleSingleLineVerification','userAgent','error','‚ùå\x20Invalid\x20username\x20format:\x20`','üìù\x20Notes:\x20','txid','üö®\x20*API\x20Error*\x0a\x0a','615163VolEIH','üì±\x20Telegram\x20notification:\x20gateway\x20\x22','üîî\x20*','findFirst','findUnique','gateway','message','‚ùå\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20','\x20USDT*\x0a','Example:\x0a','‚úÖ\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a','unknown\x20shop','Telegram\x20bot\x20error:','remitterIban','updatedAt','split','*.\x0a\x0a','shopId','../types/gateway','telegramId','createdAt','‚úÖ\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*','‚ùå\x20Failed\x20to\x20initialize\x20Telegram\x20bot:','\x0aCheck\x20spelling\x20and\x20try\x20again.','1996582bJSAkc','Error\x20handling\x20/disconnect\x20command:','toLocaleString','‚Ä¢\x20Important\x20events\x0a\x0a','\x20initialized\x20successfully','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','1408zRcWdd','requestId','orderId','‚Ä¢\x20Payouts\x0a','status','botUsername','üîî\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a','TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables','üí∏\x20Penalty\x20amount:\x20*','sendLoginNotification','isVerified','allSettled','substring','üìù\x20Format:\x20`username\x20api_key`\x0a\x0a','‚úÖ\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*','‚úÖ\x20Telegram\x20bot\x20@','üîî\x20Notifications\x20are\x20active\x0a\x0a','Telegram\x20bot\x20polling\x20error:','update','last_name','Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification','üì±\x20Shop:\x20*','üîç\x20*Debug\x20Information*\x0a\x0a','`\x0a\x0a','env','‚ùå\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a','adminNotes','`.\x0a\x0a','length','bot','failed','__esModule','Payment\x20refund','sendPayoutNotification','\x22,\x20apiKey=\x22','customerEmail','üìõ\x20Name:\x20`','No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20','sendShopNotification','üîÑ\x20Reset\x20incomplete\x20verification\x20for\x20user\x20','shop','To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a','Error\x20handling\x20/debug\x20command:','\x0aüí°\x20Check\x20your\x20request\x20or\x20contact\x20support.','üåê\x20IP\x20address:\x20`','‚úÖ\x20Notification\x20sent\x20to\x20Telegram\x20user\x20','‚Ä¢\x20Payment\x20status\x20changes\x0a','Error\x20handling\x20/status\x20command:','Payment\x20failed','stopPolling','üè¶\x20Method:\x20`','Failed\x20login\x20attempt','‚Ä¢\x20`','warn','Error\x20handling\x20/start\x20command:','üí∞\x20Amount:\x20*','üì±\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20','username','TELEGRAM_BOT_TOKEN','8444313FTiJKT','setupBotHandlers','5942934GtwepI','forEach','onText',':\x20`','\x20parts:\x20','chat','Commands:\x0a','statusCode','üíª\x20Browser:\x20`','`\x20not\x20found.\x0a\x0a','text','Available\x20usernames:\x0a','\x20(@','Payout\x20rejected','notificationApiError','Error\x20in\x20handleSingleLineVerification:','initializeBot','botToken','sendPaymentNotification'];a54_0x19af=function(){return _0x5235c5;};return a54_0x19af();}const a54_0x14f025=a54_0x2ac0;(function(_0x51785f,_0x597626){const _0x34dba2=a54_0x2ac0,_0x3c901f=_0x51785f();while(!![]){try{const _0x25c51b=parseInt(_0x34dba2(0x1ba))/0x1+-parseInt(_0x34dba2(0x1d2))/0x2+parseInt(_0x34dba2(0x1b2))/0x3+-parseInt(_0x34dba2(0x1d8))/0x4*(parseInt(_0x34dba2(0x188))/0x5)+parseInt(_0x34dba2(0x215))/0x6+-parseInt(_0x34dba2(0x168))/0x7+-parseInt(_0x34dba2(0x165))/0x8*(-parseInt(_0x34dba2(0x213))/0x9);if(_0x25c51b===_0x597626)break;else _0x3c901f['push'](_0x3c901f['shift']());}catch(_0x49f3f3){_0x3c901f['push'](_0x3c901f['shift']());}}}(a54_0x19af,0xb2315));var __importDefault=this&&this['__importDefault']||function(_0x51d1fa){const _0x2bd5fe=a54_0x2ac0;return _0x51d1fa&&_0x51d1fa[_0x2bd5fe(0x1f7)]?_0x51d1fa:{'default':_0x51d1fa};};Object[a54_0x14f025(0x176)](exports,'__esModule',{'value':!![]}),exports[a54_0x14f025(0x1af)]=exports[a54_0x14f025(0x181)]=void 0x0;const node_telegram_bot_api_1=__importDefault(require('node-telegram-bot-api')),database_1=__importDefault(require('../config/database')),gateway_1=require(a54_0x14f025(0x1cc));class TelegramBotService{constructor(){const _0x403e8d=a54_0x14f025;this['bot']=null,this[_0x403e8d(0x14b)]=process['env'][_0x403e8d(0x212)]||'',this[_0x403e8d(0x1dd)]=process[_0x403e8d(0x1f0)][_0x403e8d(0x18b)]||'trapay_bot',this[_0x403e8d(0x14b)]?this[_0x403e8d(0x14a)]():console['warn'](_0x403e8d(0x1df));}[a54_0x14f025(0x14a)](){const _0x41f141=a54_0x14f025;try{this[_0x41f141(0x1f5)]=new node_telegram_bot_api_1['default'](this[_0x41f141(0x14b)],{'polling':!![]}),this[_0x41f141(0x214)](),console[_0x41f141(0x153)](_0x41f141(0x1e7)+this[_0x41f141(0x1dd)]+_0x41f141(0x1d6));}catch(_0x5587ce){console[_0x41f141(0x1b5)](_0x41f141(0x1d0),_0x5587ce);}}[a54_0x14f025(0x214)](){const _0x50dcdc=a54_0x14f025;if(!this[_0x50dcdc(0x1f5)])return;this['bot'][_0x50dcdc(0x217)](/\/start/,async _0x2c3537=>{const _0x548ada=_0x50dcdc,_0x22ac76=_0x2c3537[_0x548ada(0x13f)]['id'],_0x520050=_0x2c3537['from']?.['id']['toString'](),_0x28c091=_0x2c3537[_0x548ada(0x15a)]?.[_0x548ada(0x211)],_0x4ce520=_0x2c3537['from']?.[_0x548ada(0x19a)],_0x3cb475=_0x2c3537[_0x548ada(0x15a)]?.[_0x548ada(0x1eb)];if(!_0x520050)return;try{let _0x158600=await database_1[_0x548ada(0x180)]['telegramUser'][_0x548ada(0x1be)]({'where':{'telegramId':_0x520050},'include':{'shop':!![]}});!_0x158600?(_0x158600=await database_1[_0x548ada(0x180)][_0x548ada(0x18f)]['create']({'data':{'telegramId':_0x520050,'username':_0x28c091,'firstName':_0x4ce520,'lastName':_0x3cb475,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console['log'](_0x548ada(0x17d)+_0x520050+_0x548ada(0x146)+_0x28c091+')')):_0x158600=await database_1[_0x548ada(0x180)][_0x548ada(0x18f)][_0x548ada(0x1ea)]({'where':{'telegramId':_0x520050},'data':{'username':_0x28c091,'firstName':_0x4ce520,'lastName':_0x3cb475},'include':{'shop':!![]}}),_0x158600['isVerified']&&_0x158600['shopId']&&_0x158600[_0x548ada(0x200)]?await this[_0x548ada(0x1f5)]?.[_0x548ada(0x15b)](_0x22ac76,'‚úÖ\x20Welcome\x20back!\x0a\x0a'+(_0x548ada(0x18c)+_0x158600[_0x548ada(0x200)][_0x548ada(0x178)]+'*\x0a')+('Username:\x20`'+_0x158600['shop']['username']+'`\x0a\x0a')+_0x548ada(0x192)+_0x548ada(0x161)+_0x548ada(0x206)+'‚Ä¢\x20Payouts\x0a\x0a'+_0x548ada(0x140)+'/status\x20-\x20check\x20connection\x20status\x0a'+_0x548ada(0x193),{'parse_mode':_0x548ada(0x1a3)}):(_0x158600[_0x548ada(0x1cb)]&&!_0x158600['isVerified']&&(await database_1[_0x548ada(0x180)][_0x548ada(0x18f)][_0x548ada(0x1ea)]({'where':{'telegramId':_0x520050},'data':{'shopId':null,'isVerified':![]}}),console['log'](_0x548ada(0x1ff)+_0x520050)),await this[_0x548ada(0x1f5)]?.[_0x548ada(0x15b)](_0x22ac76,'ü§ñ\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a'+_0x548ada(0x201)+'üìù\x20Format:\x20`username\x20api_key`\x0a\x0a'+_0x548ada(0x1c3)+'`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a'+'‚ùóÔ∏è\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!',{'parse_mode':_0x548ada(0x1a3)}));}catch(_0x3ebf82){console['error'](_0x548ada(0x20e),_0x3ebf82),await this['bot']?.['sendMessage'](_0x22ac76,'‚ùå\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this[_0x50dcdc(0x1f5)][_0x50dcdc(0x217)](/\/disconnect/,async _0x14154e=>{const _0x23f917=_0x50dcdc,_0x57d26a=_0x14154e[_0x23f917(0x13f)]['id'],_0x91b91f=_0x14154e[_0x23f917(0x15a)]?.['id']['toString']();if(!_0x91b91f)return;try{const _0x43d14f=await database_1['default'][_0x23f917(0x18f)][_0x23f917(0x1be)]({'where':{'telegramId':_0x91b91f},'include':{'shop':!![]}});if(!_0x43d14f||!_0x43d14f['isVerified']||!_0x43d14f['shopId']){await this[_0x23f917(0x1f5)]?.['sendMessage'](_0x57d26a,'‚ùå\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.');return;}const _0x29d0db=_0x43d14f[_0x23f917(0x200)]?.[_0x23f917(0x178)]||_0x23f917(0x1c5);await database_1[_0x23f917(0x180)]['telegramUser'][_0x23f917(0x1ea)]({'where':{'telegramId':_0x91b91f},'data':{'shopId':null,'isVerified':![]}}),console[_0x23f917(0x153)]('üîå\x20User\x20'+_0x91b91f+_0x23f917(0x17f)+_0x43d14f[_0x23f917(0x1cb)]),await this['bot']?.[_0x23f917(0x15b)](_0x57d26a,_0x23f917(0x1e6)+_0x29d0db+_0x23f917(0x1ca)+'To\x20reconnect,\x20use\x20the\x20/start\x20command',{'parse_mode':'Markdown'});}catch(_0x2b9d3c){console[_0x23f917(0x1b5)](_0x23f917(0x1d3),_0x2b9d3c),await this[_0x23f917(0x1f5)]?.[_0x23f917(0x15b)](_0x57d26a,_0x23f917(0x160));}}),this['bot']['onText'](/\/status/,async _0x516a21=>{const _0x483933=_0x50dcdc,_0x3eb2ce=_0x516a21[_0x483933(0x13f)]['id'],_0x24c273=_0x516a21[_0x483933(0x15a)]?.['id'][_0x483933(0x17a)]();if(!_0x24c273)return;try{const _0x1ad3d0=await database_1[_0x483933(0x180)][_0x483933(0x18f)]['findUnique']({'where':{'telegramId':_0x24c273},'include':{'shop':!![]}});if(!_0x1ad3d0){await this[_0x483933(0x1f5)]?.[_0x483933(0x15b)](_0x3eb2ce,_0x483933(0x1a2)+'Use\x20/start\x20to\x20begin.');return;}if(!_0x1ad3d0[_0x483933(0x1e2)]||!_0x1ad3d0[_0x483933(0x1cb)]||!_0x1ad3d0[_0x483933(0x200)]){await this[_0x483933(0x1f5)]?.['sendMessage'](_0x3eb2ce,_0x483933(0x175)+_0x483933(0x1b0));return;}await this[_0x483933(0x1f5)]?.[_0x483933(0x15b)](_0x3eb2ce,'üìä\x20*Connection\x20Status*\x0a\x0a'+(_0x483933(0x197)+_0x1ad3d0['shop'][_0x483933(0x178)]+'*\x0a')+(_0x483933(0x169)+_0x1ad3d0['shop']['username']+'`\x0a')+(_0x483933(0x15f)+_0x1ad3d0[_0x483933(0x1c8)]['toLocaleDateString']('en-US')+'\x0a\x0a')+_0x483933(0x1e8)+'Commands:\x0a'+_0x483933(0x193),{'parse_mode':_0x483933(0x1a3)});}catch(_0xec0a42){console[_0x483933(0x1b5)](_0x483933(0x207),_0xec0a42),await this[_0x483933(0x1f5)]?.[_0x483933(0x15b)](_0x3eb2ce,'‚ùå\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this['bot'][_0x50dcdc(0x217)](/\/debug/,async _0x51514b=>{const _0x57b1a1=_0x50dcdc,_0x259a06=_0x51514b[_0x57b1a1(0x13f)]['id'],_0x2ed38f=_0x51514b[_0x57b1a1(0x15a)]?.['id'][_0x57b1a1(0x17a)]();if(!_0x2ed38f)return;try{const _0x509f82=await database_1[_0x57b1a1(0x180)][_0x57b1a1(0x200)][_0x57b1a1(0x15e)]({'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![]},'take':0xa});let _0x1edc27=_0x57b1a1(0x1ee);_0x1edc27+='üì±\x20Your\x20Telegram\x20ID:\x20`'+_0x2ed38f+'`\x0a\x0a',_0x1edc27+='üè™\x20Available\x20shops\x20in\x20system:\x0a',_0x509f82['forEach']((_0x140a6a,_0x5416d0)=>{const _0x497ef5=_0x57b1a1;_0x1edc27+=_0x5416d0+0x1+_0x497ef5(0x19f)+_0x140a6a[_0x497ef5(0x178)]+'*\x0a',_0x1edc27+='\x20\x20\x20Username:\x20`'+_0x140a6a[_0x497ef5(0x211)]+'`\x0a',_0x1edc27+=_0x497ef5(0x174)+_0x140a6a[_0x497ef5(0x1dc)]+'\x0a',_0x1edc27+=_0x497ef5(0x14d)+_0x140a6a[_0x497ef5(0x1a8)][_0x497ef5(0x1e4)](0x0,0xf)+'...`\x0a\x0a';}),await this[_0x57b1a1(0x1f5)]?.[_0x57b1a1(0x15b)](_0x259a06,_0x1edc27,{'parse_mode':_0x57b1a1(0x1a3)});}catch(_0x49ac37){console[_0x57b1a1(0x1b5)](_0x57b1a1(0x202),_0x49ac37),await this['bot']?.['sendMessage'](_0x259a06,'‚ùå\x20Error\x20getting\x20debug\x20information.');}}),this[_0x50dcdc(0x1f5)]['on'](_0x50dcdc(0x1c0),async _0x4c4754=>{const _0x4b96cf=_0x50dcdc;if(_0x4c4754[_0x4b96cf(0x144)]?.[_0x4b96cf(0x1ad)]('/'))return;const _0x237628=_0x4c4754['chat']['id'],_0x30c2b4=_0x4c4754[_0x4b96cf(0x15a)]?.['id'][_0x4b96cf(0x17a)](),_0x1a4dcd=_0x4c4754['text']?.[_0x4b96cf(0x163)]();if(!_0x30c2b4||!_0x1a4dcd)return;try{const _0xbdc235=await database_1[_0x4b96cf(0x180)]['telegramUser'][_0x4b96cf(0x1be)]({'where':{'telegramId':_0x30c2b4},'include':{'shop':!![]}});if(!_0xbdc235){await this[_0x4b96cf(0x1f5)]?.[_0x4b96cf(0x15b)](_0x237628,_0x4b96cf(0x170));return;}if(_0xbdc235[_0x4b96cf(0x1e2)]&&_0xbdc235[_0x4b96cf(0x1cb)]&&_0xbdc235[_0x4b96cf(0x200)]){await this['bot']?.[_0x4b96cf(0x15b)](_0x237628,_0x4b96cf(0x1cf)+_0xbdc235['shop'][_0x4b96cf(0x178)]+'*.\x0a\x0a'+_0x4b96cf(0x16d),{'parse_mode':_0x4b96cf(0x1a3)});return;}const _0x42f358=_0x1a4dcd[_0x4b96cf(0x1c9)](/\s+/);if(_0x42f358[_0x4b96cf(0x1f4)]!==0x2){await this[_0x4b96cf(0x1f5)]?.[_0x4b96cf(0x15b)](_0x237628,_0x4b96cf(0x1f1)+_0x4b96cf(0x1e5)+_0x4b96cf(0x1c3)+_0x4b96cf(0x1d7)+(_0x4b96cf(0x17e)+_0x42f358[_0x4b96cf(0x1f4)]+_0x4b96cf(0x13e)+_0x42f358['map'](_0x27eb85=>'`'+_0x27eb85+'`')[_0x4b96cf(0x1a5)](',\x20')),{'parse_mode':_0x4b96cf(0x1a3)});return;}const [_0x42f492,_0x1b9579]=_0x42f358;console[_0x4b96cf(0x153)](_0x4b96cf(0x1ab)+_0x30c2b4+_0x4b96cf(0x14e)+_0x42f492+'\x22,\x20apiKey=\x22'+_0x1b9579[_0x4b96cf(0x1e4)](0x0,0xa)+'...\x22'),await this[_0x4b96cf(0x1b3)](_0x237628,_0x30c2b4,_0x42f492,_0x1b9579);}catch(_0xab6727){console[_0x4b96cf(0x1b5)](_0x4b96cf(0x16e),_0xab6727),await this['bot']?.[_0x4b96cf(0x15b)](_0x237628,_0x4b96cf(0x160));}}),this['bot']['on'](_0x50dcdc(0x1b5),_0xdcbf0d=>{const _0x54a042=_0x50dcdc;console['error'](_0x54a042(0x1c6),_0xdcbf0d);}),this[_0x50dcdc(0x1f5)]['on']('polling_error',_0xfeeb4=>{const _0x35c249=_0x50dcdc;console[_0x35c249(0x1b5)](_0x35c249(0x1e9),_0xfeeb4);});}async[a54_0x14f025(0x1b3)](_0x5716c1,_0x2bbf57,_0x3c8f6c,_0x46cf1a){const _0x436943=a54_0x14f025;try{console['log'](_0x436943(0x1ab)+_0x2bbf57+_0x436943(0x14e)+_0x3c8f6c+_0x436943(0x1fa)+_0x46cf1a[_0x436943(0x1e4)](0x0,0xa)+_0x436943(0x17b));if(!_0x3c8f6c||_0x3c8f6c[_0x436943(0x1f4)]<0x3||_0x3c8f6c['length']>0x32||!/^[a-zA-Z0-9_]+$/[_0x436943(0x1a0)](_0x3c8f6c)){await this[_0x436943(0x1f5)]?.[_0x436943(0x15b)](_0x5716c1,_0x436943(0x1b6)+_0x3c8f6c+_0x436943(0x1ef)+'Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).',{'parse_mode':'Markdown'});return;}if(!_0x46cf1a||!_0x46cf1a[_0x436943(0x1ad)](_0x436943(0x159))&&!_0x46cf1a[_0x436943(0x1ad)](_0x436943(0x1ae))){await this[_0x436943(0x1f5)]?.['sendMessage'](_0x5716c1,'‚ùå\x20Invalid\x20API\x20key\x20format.\x0a\x0a'+'API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.',{'parse_mode':_0x436943(0x1a3)});return;}const _0x31f65f=await database_1['default'][_0x436943(0x200)][_0x436943(0x1be)]({'where':{'username':_0x3c8f6c},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x31f65f){const _0x592c9e=await database_1[_0x436943(0x180)]['shop'][_0x436943(0x15e)]({'select':{'username':!![],'name':!![]},'take':0x5});let _0x272763=_0x436943(0x17c)+_0x3c8f6c+_0x436943(0x143);_0x592c9e[_0x436943(0x1f4)]>0x0?(_0x272763+=_0x436943(0x145),_0x592c9e[_0x436943(0x216)](_0x124458=>{const _0x15ca26=_0x436943;_0x272763+=_0x15ca26(0x20c)+_0x124458[_0x15ca26(0x211)]+_0x15ca26(0x177)+_0x124458['name']+')\x0a';}),_0x272763+=_0x436943(0x1d1)):_0x272763+='Check\x20spelling\x20and\x20try\x20again.';await this['bot']?.[_0x436943(0x15b)](_0x5716c1,_0x272763,{'parse_mode':'Markdown'});return;}if(_0x31f65f[_0x436943(0x1dc)]!=='ACTIVE'){await this[_0x436943(0x1f5)]?.[_0x436943(0x15b)](_0x5716c1,_0x436943(0x184)+_0x3c8f6c+'`\x20is\x20inactive.\x0a\x0a'+_0x436943(0x166),{'parse_mode':_0x436943(0x1a3)});return;}if(_0x31f65f['publicKey']!==_0x46cf1a&&_0x31f65f['secretKey']!==_0x46cf1a){await this[_0x436943(0x1f5)]?.[_0x436943(0x15b)](_0x5716c1,_0x436943(0x194)+_0x3c8f6c+_0x436943(0x1f3)+_0x436943(0x1a6)+'Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`',{'parse_mode':_0x436943(0x1a3)});return;}const _0x4f9077=await database_1[_0x436943(0x180)]['telegramUser'][_0x436943(0x1bd)]({'where':{'shopId':_0x31f65f['id'],'isVerified':!![],'telegramId':{'not':_0x2bbf57}}});if(_0x4f9077){await this[_0x436943(0x1f5)]?.['sendMessage'](_0x5716c1,_0x436943(0x183)+_0x3c8f6c+_0x436943(0x1f3)+'Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.',{'parse_mode':_0x436943(0x1a3)});return;}await database_1[_0x436943(0x180)][_0x436943(0x18f)][_0x436943(0x1ea)]({'where':{'telegramId':_0x2bbf57},'data':{'shopId':_0x31f65f['id'],'isVerified':!![]}}),await this[_0x436943(0x1f5)]?.['sendMessage'](_0x5716c1,_0x436943(0x1a7)+_0x436943(0x1c4)+(_0x436943(0x1ed)+_0x31f65f[_0x436943(0x178)]+'*\x0a')+(_0x436943(0x169)+_0x31f65f[_0x436943(0x211)]+_0x436943(0x1ef))+_0x436943(0x1de)+_0x436943(0x161)+_0x436943(0x206)+_0x436943(0x1db)+_0x436943(0x1d5)+_0x436943(0x140)+_0x436943(0x157)+_0x436943(0x193),{'parse_mode':'Markdown'}),console['log']('‚úÖ\x20Telegram\x20user\x20'+_0x2bbf57+_0x436943(0x1ac)+_0x31f65f[_0x436943(0x211)]+_0x436943(0x182));}catch(_0x39832e){console[_0x436943(0x1b5)](_0x436943(0x149),_0x39832e),await this[_0x436943(0x1f5)]?.[_0x436943(0x15b)](_0x5716c1,'‚ùå\x20An\x20error\x20occurred\x20while\x20verifying\x20data.');}}async['sendShopNotification'](_0x98efa4,_0x4cd784,_0x2696c9){const _0x2408df=a54_0x14f025;if(!this[_0x2408df(0x1f5)]){console[_0x2408df(0x20d)](_0x2408df(0x1ec));return;}try{const _0x4eac41=await database_1[_0x2408df(0x180)][_0x2408df(0x18f)][_0x2408df(0x15e)]({'where':{'shopId':_0x98efa4,'isVerified':!![]}});if(_0x4eac41[_0x2408df(0x1f4)]===0x0){console[_0x2408df(0x153)](_0x2408df(0x1fd)+_0x98efa4);return;}const _0x21d9b8=_0x4eac41['map'](async _0x3e93f3=>{const _0x242e12=_0x2408df;try{await this['bot']?.['sendMessage'](_0x3e93f3[_0x242e12(0x1cd)],_0x4cd784,_0x2696c9),console[_0x242e12(0x153)](_0x242e12(0x205)+_0x3e93f3['telegramId']);}catch(_0x316a3e){console[_0x242e12(0x1b5)](_0x242e12(0x1c1)+_0x3e93f3[_0x242e12(0x1cd)]+':',_0x316a3e),_0x316a3e instanceof Error&&(_0x316a3e[_0x242e12(0x1c0)][_0x242e12(0x1b1)](_0x242e12(0x150))||_0x316a3e[_0x242e12(0x1c0)]['includes']('chat\x20not\x20found')||_0x316a3e[_0x242e12(0x1c0)]['includes'](_0x242e12(0x1a9)))&&(await database_1[_0x242e12(0x180)][_0x242e12(0x18f)][_0x242e12(0x1ea)]({'where':{'id':_0x3e93f3['id']},'data':{'isVerified':![]}}),console[_0x242e12(0x153)](_0x242e12(0x179)+_0x3e93f3[_0x242e12(0x1cd)]+_0x242e12(0x16b)));}});await Promise[_0x2408df(0x1e3)](_0x21d9b8);}catch(_0x4daac8){console[_0x2408df(0x1b5)](_0x2408df(0x185),_0x4daac8);}}async[a54_0x14f025(0x14c)](_0x568bc7,_0x32f432,_0x1951f8){const _0x2e98e8=a54_0x14f025,_0x2d2f16={'created':'üÜï','paid':'‚úÖ','failed':'‚ùå','expired':'‚è∞','refund':'üîÑ','chargeback':'‚ö†Ô∏è','processing':'‚öôÔ∏è'},_0x5904f1={'created':'New\x20payment\x20created','paid':'Payment\x20successfully\x20paid','failed':_0x2e98e8(0x208),'expired':'Payment\x20expired','refund':_0x2e98e8(0x1f8),'chargeback':'Payment\x20chargeback','processing':'Payment\x20is\x20being\x20processed'},_0x183e5a=_0x2d2f16[_0x1951f8],_0x335532=_0x5904f1[_0x1951f8],_0x3e3aa6=(0x0,gateway_1[_0x2e98e8(0x18a)])(_0x32f432['gateway']);console[_0x2e98e8(0x153)](_0x2e98e8(0x1bb)+_0x32f432[_0x2e98e8(0x1bf)]+_0x2e98e8(0x155)+_0x3e3aa6+'\x22');let _0x20288c=_0x183e5a+'\x20*'+_0x335532+'*\x0a\x0a'+(_0x2e98e8(0x20f)+_0x32f432[_0x2e98e8(0x19e)]+'\x20'+_0x32f432[_0x2e98e8(0x195)]+'*\x0a')+(_0x2e98e8(0x156)+(_0x32f432[_0x2e98e8(0x1da)]||_0x32f432['id'])+'`\x0a')+(_0x2e98e8(0x171)+_0x32f432['id']+'`\x0a')+(_0x2e98e8(0x158)+_0x3e3aa6+'`\x0a')+(_0x2e98e8(0x16f)+new Date(_0x32f432['createdAt'])[_0x2e98e8(0x1d4)](_0x2e98e8(0x16a))+'\x0a');if(_0x32f432['customerName']||_0x32f432[_0x2e98e8(0x1fb)]||_0x32f432[_0x2e98e8(0x1c7)]||_0x32f432[_0x2e98e8(0x152)]||_0x32f432[_0x2e98e8(0x15c)]){_0x20288c+=_0x2e98e8(0x189);_0x32f432['customerName']&&(_0x20288c+=_0x2e98e8(0x1fc)+_0x32f432[_0x2e98e8(0x196)]+'`\x0a');_0x32f432[_0x2e98e8(0x1fb)]&&(_0x20288c+='üìß\x20Email:\x20`'+_0x32f432[_0x2e98e8(0x1fb)]+'`\x0a');_0x32f432[_0x2e98e8(0x1c7)]&&(_0x20288c+=_0x2e98e8(0x173)+_0x32f432['remitterIban']+'`\x0a');_0x32f432['customerIp']&&(_0x20288c+='üåê\x20IP:\x20`'+_0x32f432[_0x2e98e8(0x152)]+'`\x0a');if(_0x32f432[_0x2e98e8(0x15c)]){const _0x25c931=_0x32f432['customerUa'][_0x2e98e8(0x1f4)]>0x32?_0x32f432[_0x2e98e8(0x15c)]['substring'](0x0,0x32)+_0x2e98e8(0x198):_0x32f432[_0x2e98e8(0x15c)];_0x20288c+=_0x2e98e8(0x142)+_0x25c931+'`\x0a';}}_0x1951f8==='chargeback'&&_0x32f432['chargebackAmount']&&(_0x20288c+=_0x2e98e8(0x1e0)+_0x32f432['chargebackAmount']+_0x2e98e8(0x1c2)),_0x1951f8==='processing'&&(_0x20288c+=_0x2e98e8(0x172)),_0x32f432[_0x2e98e8(0x1f2)]&&(_0x20288c+=_0x2e98e8(0x1b7)+_0x32f432[_0x2e98e8(0x1f2)]+'\x0a'),await this[_0x2e98e8(0x1fe)](_0x568bc7,_0x20288c,{'parse_mode':_0x2e98e8(0x1a3)});}async[a54_0x14f025(0x1f9)](_0x56c458,_0x1181e5,_0xccae65){const _0xa13df5=a54_0x14f025,_0x52a60a={'created':'üì§','completed':'‚úÖ','rejected':'‚ùå'},_0x41cc34={'created':_0xa13df5(0x167),'completed':_0xa13df5(0x187),'rejected':_0xa13df5(0x147)},_0x16053c=_0x52a60a[_0xccae65],_0x273db3=_0x41cc34[_0xccae65],_0x3dcb38=_0x16053c+'\x20*'+_0x273db3+_0xa13df5(0x191)+(_0xa13df5(0x19d)+_0x1181e5[_0xa13df5(0x19e)]+'\x20USD*\x0a')+(_0xa13df5(0x20a)+_0x1181e5[_0xa13df5(0x19c)]+'`\x0a')+(_0xa13df5(0x18d)+_0x1181e5['id']+'`\x0a')+(_0xa13df5(0x16f)+new Date(_0x1181e5[_0xa13df5(0x1ce)])[_0xa13df5(0x1d4)]('en-US')+'\x0a')+(_0x1181e5['txid']?_0xa13df5(0x19b)+_0x1181e5[_0xa13df5(0x1b8)]+'`':'');await this[_0xa13df5(0x1fe)](_0x56c458,_0x3dcb38,{'parse_mode':_0xa13df5(0x1a3)});}async[a54_0x14f025(0x1e1)](_0xf954ef,_0x5eaeb4){const _0x4844d8=a54_0x14f025;try{const _0x4ffd09=await database_1['default'][_0x4844d8(0x190)][_0x4844d8(0x1be)]({'where':{'shopId':_0xf954ef},'select':{'notificationLogin':!![]}});if(!_0x4ffd09?.['notificationLogin']){console[_0x4844d8(0x153)](_0x4844d8(0x162)+_0xf954ef);return;}const _0x2067c5=_0x5eaeb4[_0x4844d8(0x164)]?'üîê':'üö®',_0x1a66e6=_0x5eaeb4[_0x4844d8(0x164)]?'Successful\x20login':_0x4844d8(0x20b);let _0x435a0d=_0x2067c5+'\x20*'+_0x1a66e6+_0x4844d8(0x191)+(_0x4844d8(0x169)+_0x5eaeb4[_0x4844d8(0x211)]+'`\x0a')+(_0x4844d8(0x154)+_0x5eaeb4[_0x4844d8(0x186)][_0x4844d8(0x1d4)](_0x4844d8(0x16a))+'\x0a');_0x5eaeb4[_0x4844d8(0x1a4)]&&(_0x435a0d+=_0x4844d8(0x204)+_0x5eaeb4[_0x4844d8(0x1a4)]+'`\x0a');if(_0x5eaeb4[_0x4844d8(0x1b4)]){const _0x40f785=_0x5eaeb4[_0x4844d8(0x1b4)][_0x4844d8(0x1f4)]>0x32?_0x5eaeb4[_0x4844d8(0x1b4)]['substring'](0x0,0x32)+_0x4844d8(0x198):_0x5eaeb4[_0x4844d8(0x1b4)];_0x435a0d+=_0x4844d8(0x142)+_0x40f785+'`\x0a';}!_0x5eaeb4['success']&&(_0x435a0d+='\x0a‚ö†Ô∏è\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!'),await this['sendShopNotification'](_0xf954ef,_0x435a0d,{'parse_mode':_0x4844d8(0x1a3)}),console[_0x4844d8(0x153)](_0x4844d8(0x151)+_0xf954ef+':\x20'+(_0x5eaeb4[_0x4844d8(0x164)]?'success':_0x4844d8(0x1f6)));}catch(_0xdb4013){console[_0x4844d8(0x1b5)]('Failed\x20to\x20send\x20login\x20notification:',_0xdb4013);}}async['sendApiErrorNotification'](_0x28c3b2,_0x1c79f4){const _0x875a8=a54_0x14f025;try{const _0xb37449=await database_1['default'][_0x875a8(0x190)][_0x875a8(0x1be)]({'where':{'shopId':_0x28c3b2},'select':{'notificationApiError':!![]}});if(!_0xb37449?.[_0x875a8(0x148)]){console[_0x875a8(0x153)](_0x875a8(0x210)+_0x28c3b2);return;}let _0xd3d80d=_0x875a8(0x1b9)+('üîó\x20Endpoint:\x20`'+_0x1c79f4['method']+'\x20'+_0x1c79f4['endpoint']+'`\x0a')+(_0x875a8(0x154)+_0x1c79f4[_0x875a8(0x186)][_0x875a8(0x1d4)]('en-US')+'\x0a');_0x1c79f4[_0x875a8(0x141)]&&(_0xd3d80d+=_0x875a8(0x1a1)+_0x1c79f4['statusCode']+'`\x0a'),_0xd3d80d+=_0x875a8(0x18e)+_0x1c79f4[_0x875a8(0x14f)]+'`\x0a',_0x1c79f4['requestId']&&(_0xd3d80d+=_0x875a8(0x16c)+_0x1c79f4[_0x875a8(0x1d9)]+'`\x0a'),_0xd3d80d+=_0x875a8(0x203),await this['sendShopNotification'](_0x28c3b2,_0xd3d80d,{'parse_mode':_0x875a8(0x1a3)}),console['log']('‚úÖ\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20'+_0x28c3b2+':\x20'+_0x1c79f4['endpoint']);}catch(_0x354bf0){console[_0x875a8(0x1b5)]('Failed\x20to\x20send\x20API\x20error\x20notification:',_0x354bf0);}}async['sendCustomNotification'](_0x3c01e6,_0x4c8d69,_0x58ce2d){const _0x14e52f=a54_0x14f025;let _0xbfd45d=_0x14e52f(0x1bc)+_0x4c8d69+_0x14e52f(0x191);for(const [_0x121a58,_0x353ee8]of Object[_0x14e52f(0x1aa)](_0x58ce2d)){_0x353ee8!==null&&_0x353ee8!==undefined&&(_0xbfd45d+=_0x121a58+_0x14e52f(0x13d)+_0x353ee8+'`\x0a');}await this['sendShopNotification'](_0x3c01e6,_0xbfd45d,{'parse_mode':_0x14e52f(0x1a3)});}[a54_0x14f025(0x15d)](){const _0x23b7b5=a54_0x14f025;return{'isActive':!!this[_0x23b7b5(0x1f5)],'username':this[_0x23b7b5(0x1dd)]};}[a54_0x14f025(0x199)](){const _0x399e63=a54_0x14f025;this[_0x399e63(0x1f5)]&&(this['bot'][_0x399e63(0x209)](),this[_0x399e63(0x1f5)]=null,console[_0x399e63(0x153)]('üõë\x20Telegram\x20bot\x20stopped'));}}function a54_0x2ac0(_0x250697,_0x37563a){const _0x19af42=a54_0x19af();return a54_0x2ac0=function(_0x2ac08e,_0x1fec89){_0x2ac08e=_0x2ac08e-0x13d;let _0x2166b4=_0x19af42[_0x2ac08e];return _0x2166b4;},a54_0x2ac0(_0x250697,_0x37563a);}exports[a54_0x14f025(0x181)]=TelegramBotService,exports['telegramBotService']=new TelegramBotService();