'use strict';const a66_0x26cd66=a66_0xd6e1;function a66_0x5bec(){const _0x321002=['allSettled','\x0a⚠️\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!','✅\x20File\x20sent\x20to\x20','Use\x20/start\x20to\x20connect.','default','/disconnect\x20-\x20disconnect\x20from\x20notifications','2352TJnNLS','Failed\x20to\x20send\x20API\x20error\x20notification:','675987xskHoL','name','TELEGRAM_BOT_TOKEN','customerEmail','status','❌\x20No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20ID:\x20','chat','getGatewayDisplayNameForTelegram','✅\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20','🆔\x20Payment\x20ID:\x20`','env','Markdown','🏪\x20Gateway:\x20`','username','trim','remitterIban','Error\x20handling\x20/start\x20command:','amount','🔌\x20User\x20','endsWith','sendApiErrorNotification','gateway','ipAddress','Payment\x20chargeback','length','startsWith','To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a','🏪\x20Your\x20connected\x20shop:\x0a','📱\x20Telegram\x20notification:\x20gateway\x20\x22','💰\x20Amount:\x20*','Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.','\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure','\x20\x20\x20Status:\x20','✅\x20Login\x20notification\x20sent\x20for\x20shop\x20','565mkyiuV','sendDocument','sendLoginNotification','🤖\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a','📊\x20Error\x20code:\x20`','*\x0a\x0a','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','.pdf','sendPaymentNotification','❌\x20API\x20key\x20does\x20not\x20match\x20shop\x20`','📝\x20Order\x20ID:\x20`','entries','3VYzqTk','❌\x20You\x20are\x20not\x20connected\x20to\x20any\x20shop.\x0a\x0a','🔗\x20Endpoint:\x20`','findUnique','Error\x20handling\x20/disconnect\x20command:','first_name','adminNotes','\x20users\x20of\x20shop\x20','telegramBotService','.jpeg','📅\x20Connection\x20date:\x20','2089910hhhAYN','❗️\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!','isVerified','telegramId','🔔\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a','\x20users','processing','❌\x20Error\x20sending\x20file\x20to\x20chat:','chat\x20not\x20found','✅\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*','findFirst','•\x20New\x20payments\x0a','\x20initialized\x20successfully','\x20verified\x20for\x20shop\x20','988560XDIHYs','🔔\x20*','To\x20reconnect,\x20use\x20the\x20/start\x20command','✅\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a','Use\x20/start\x20to\x20connect\x20to\x20a\x20shop.','Please\x20check\x20the\x20spelling\x20and\x20try\x20again.\x0a\x0a','../config/database','toLocaleString','📱\x20Shop:\x20*','📱\x20No\x20active\x20Telegram\x20users\x20found','🚨\x20*API\x20Error*\x0a\x0a','Telegram\x20bot\x20polling\x20error:','❌\x20Shop\x20`','\x20via\x20single-line\x20input','\x22,\x20apiKey=\x22','currency','sendCustomNotification','includes','📱\x20Sending\x20notification\x20to\x20all\x20connected\x20users:\x20','👤\x20Username:\x20`','✅\x20File\x20sent\x20to\x20chat\x20','🔔\x20Notifications\x20are\x20active\x0a\x0a','`\x20is\x20inactive.\x0a\x0a','❌\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20','✅\x20Telegram\x20bot\x20@','Payment\x20successfully\x20paid','botUsername','onText','•\x20Important\x20events\x0a\x0a','userAgent','\x0a💡\x20Check\x20your\x20request\x20or\x20contact\x20support.','unknown\x20shop','New\x20payment\x20created','error','TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables','secretKey','sendShopNotification','sendDirectMessage','📅\x20Date:\x20','text','📝\x20Format:\x20`username\x20api_key`\x0a\x0a','❌\x20Error\x20getting\x20debug\x20information.','\x20\x20\x20Name:\x20*','Commands:\x0a','Make\x20sure\x20you\x20have\x20the\x20correct\x20username\x20from\x20your\x20account.','❌\x20Please\x20use\x20/start\x20command\x20first','\x0a👤\x20*Customer\x20Information:*\x0a','❌\x20Telegram\x20bot\x20not\x20initialized','customerIp','\x20USDT*\x0a','❌\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a','🌐\x20IP\x20address:\x20`','publicKey','from','application/pdf','Payout\x20completed','❌\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`','shopId','blocked','.png','Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification','`\x20not\x20found.\x0a\x0a','getBotInfo','You\x20sent\x20','You\x20are\x20already\x20connected\x20to\x20shop:\x20*','polling_error','🆔\x20Payout\x20ID:\x20`','sendNotificationToAll','Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a','...\x22','errorMessage','toLocaleDateString','chargeback','2632796WNGoSe','notificationLogin','map','📧\x20Email:\x20`','initializeBot','Failed\x20login\x20attempt','trapay_bot','❌\x20An\x20error\x20occurred\x20while\x20verifying\x20data.','timestamp','__importDefault','Failed\x20to\x20send\x20login\x20notification:','📱\x20Created\x20new\x20Telegram\x20user:\x20','Error\x20in\x20handleSingleLineVerification:','shop','🔍\x20*Debug\x20Information*\x0a\x0a','/status\x20-\x20check\x20connection\x20status\x0a','defineProperty','substring','📱\x20Your\x20Telegram\x20ID:\x20`','📱\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20','🔗\x20TXID:\x20`','Contact\x20administrator.','\x20parts:\x20','•\x20Payment\x20status\x20changes\x0a','handleSingleLineVerification','10295280Caewrv','message','💸\x20Amount:\x20*','Telegram\x20bot\x20error:','❌\x20Invalid\x20username\x20format:\x20`','Example:\x0a','sendMessage','image/jpeg','\x20USD*\x0a','Use\x20/start\x20to\x20begin.','Username:\x20`','User\x20','success','✅\x20Notification\x20sent\x20to\x20Telegram\x20user\x20','endpoint','❌\x20Error\x20sending\x20file\x20to\x20user\x20','update','en-US','💻\x20Browser:\x20`','create','Successful\x20login','❌\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.','botToken','`\x0a\x0a','📝\x20Notes:\x20','API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','📊\x20*Connection\x20Status*\x0a\x0a','customerName','method','\x20(@','chargebackAmount','requestId','TelegramBotService','🔄\x20Reset\x20incomplete\x20verification\x20for\x20user\x20','70ZkAoNz','image/png','warn','statusCode',':\x20`','Error\x20sending\x20shop\x20notification:','txid','...','log','Payment\x20expired','❌\x20Shop\x20with\x20username\x20`','Payment\x20is\x20being\x20processed','•\x20Payouts\x0a','pk_','sendPayoutNotification','Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).','customerUa','*.\x0a\x0a','Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.','failed','notificationApiError','❌\x20Failed\x20to\x20send\x20notification\x20to\x20all\x20users:','⏳\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a','🆔\x20Request\x20ID:\x20`','last_name','❌\x20Error\x20sending\x20direct\x20message:','74274miecjU','.jpg','📅\x20Time:\x20','toString','New\x20payout\x20created','✅\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*','findMany','telegramUser','✅\x20Direct\x20message\x20sent\x20to\x20chat\x20','Payment\x20refund','`.\x0a\x0a','bot','❌\x20Failed\x20to\x20initialize\x20Telegram\x20bot:','❌\x20Error\x20sending\x20file\x20to\x20shop:',':\x20username=\x22','💸\x20Penalty\x20amount:\x20*'];a66_0x5bec=function(){return _0x321002;};return a66_0x5bec();}(function(_0x4c0bb0,_0x19aeb8){const _0x44d286=a66_0xd6e1,_0xeacf56=_0x4c0bb0();while(!![]){try{const _0x1cbf3e=parseInt(_0x44d286(0x150))/0x1+-parseInt(_0x44d286(0x189))/0x2+-parseInt(_0x44d286(0x17e))/0x3*(-parseInt(_0x44d286(0x1e0))/0x4)+parseInt(_0x44d286(0x172))/0x5*(parseInt(_0x44d286(0x138))/0x6)+-parseInt(_0x44d286(0x11e))/0x7*(-parseInt(_0x44d286(0x14e))/0x8)+parseInt(_0x44d286(0x197))/0x9+-parseInt(_0x44d286(0xfb))/0xa;if(_0x1cbf3e===_0x19aeb8)break;else _0xeacf56['push'](_0xeacf56['shift']());}catch(_0x1ace6c){_0xeacf56['push'](_0xeacf56['shift']());}}}(a66_0x5bec,0xbc4ee));var __importDefault=this&&this[a66_0x26cd66(0x1e9)]||function(_0xa5e94d){return _0xa5e94d&&_0xa5e94d['__esModule']?_0xa5e94d:{'default':_0xa5e94d};};function a66_0xd6e1(_0x1f57d4,_0x52a826){const _0x5beca7=a66_0x5bec();return a66_0xd6e1=function(_0xd6e107,_0x5392d4){_0xd6e107=_0xd6e107-0xed;let _0x144210=_0x5beca7[_0xd6e107];return _0x144210;},a66_0xd6e1(_0x1f57d4,_0x52a826);}Object[a66_0x26cd66(0xf2)](exports,'__esModule',{'value':!![]}),exports[a66_0x26cd66(0x186)]=exports[a66_0x26cd66(0x11c)]=void 0x0;const node_telegram_bot_api_1=__importDefault(require('node-telegram-bot-api')),database_1=__importDefault(require(a66_0x26cd66(0x19d))),gateway_1=require('../types/gateway');class TelegramBotService{constructor(){const _0x3fc56c=a66_0x26cd66;this['bot']=null,this[_0x3fc56c(0x111)]=process[_0x3fc56c(0x15a)][_0x3fc56c(0x152)]||'',this[_0x3fc56c(0x1b1)]=process['env']['TELEGRAM_BOT_USERNAME']||_0x3fc56c(0x1e6),this[_0x3fc56c(0x111)]?this[_0x3fc56c(0x1e4)]():console[_0x3fc56c(0x120)](_0x3fc56c(0x1b9));}[a66_0x26cd66(0x1e4)](){const _0x9235c0=a66_0x26cd66;try{this[_0x9235c0(0x143)]=new node_telegram_bot_api_1[(_0x9235c0(0x14c))](this[_0x9235c0(0x111)],{'polling':!![]}),this['setupBotHandlers'](),console[_0x9235c0(0x126)](_0x9235c0(0x1af)+this[_0x9235c0(0x1b1)]+_0x9235c0(0x195));}catch(_0x232c06){console['error'](_0x9235c0(0x144),_0x232c06);}}['setupBotHandlers'](){const _0x3800ce=a66_0x26cd66;if(!this['bot'])return;this[_0x3800ce(0x143)][_0x3800ce(0x1b2)](/\/start/,async _0xf87206=>{const _0x285850=_0x3800ce,_0x2805ef=_0xf87206['chat']['id'],_0x4a609b=_0xf87206[_0x285850(0x1cc)]?.['id'][_0x285850(0x13b)](),_0x2e4eeb=_0xf87206[_0x285850(0x1cc)]?.[_0x285850(0x15d)],_0x5bd782=_0xf87206[_0x285850(0x1cc)]?.[_0x285850(0x183)],_0x17a2d2=_0xf87206[_0x285850(0x1cc)]?.[_0x285850(0x136)];if(!_0x4a609b)return;try{let _0x4e8137=await database_1[_0x285850(0x14c)][_0x285850(0x13f)]['findUnique']({'where':{'telegramId':_0x4a609b},'include':{'shop':!![]}});!_0x4e8137?(_0x4e8137=await database_1[_0x285850(0x14c)]['telegramUser'][_0x285850(0x10e)]({'data':{'telegramId':_0x4a609b,'username':_0x2e4eeb,'firstName':_0x5bd782,'lastName':_0x17a2d2,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console['log'](_0x285850(0xed)+_0x4a609b+_0x285850(0x119)+_0x2e4eeb+')')):_0x4e8137=await database_1['default']['telegramUser'][_0x285850(0x10b)]({'where':{'telegramId':_0x4a609b},'data':{'username':_0x2e4eeb,'firstName':_0x5bd782,'lastName':_0x17a2d2},'include':{'shop':!![]}}),_0x4e8137[_0x285850(0x18b)]&&_0x4e8137['shopId']&&_0x4e8137['shop']?await this[_0x285850(0x143)]?.[_0x285850(0x101)](_0x2805ef,'✅\x20Welcome\x20back!\x0a\x0a'+(_0x285850(0x1d7)+_0x4e8137[_0x285850(0xef)][_0x285850(0x151)]+'*\x0a')+(_0x285850(0x105)+_0x4e8137[_0x285850(0xef)][_0x285850(0x15d)]+_0x285850(0x112))+'🔔\x20You\x20receive\x20notifications\x20about:\x0a'+_0x285850(0x194)+_0x285850(0xf9)+'•\x20Payouts\x0a\x0a'+'Commands:\x0a'+_0x285850(0xf1)+_0x285850(0x14d),{'parse_mode':_0x285850(0x15b)}):(_0x4e8137[_0x285850(0x1d0)]&&!_0x4e8137[_0x285850(0x18b)]&&(await database_1['default'][_0x285850(0x13f)][_0x285850(0x10b)]({'where':{'telegramId':_0x4a609b},'data':{'shopId':null,'isVerified':![]}}),console['log'](_0x285850(0x11d)+_0x4a609b)),await this[_0x285850(0x143)]?.['sendMessage'](_0x2805ef,_0x285850(0x175)+_0x285850(0x16a)+_0x285850(0x1bf)+_0x285850(0x100)+_0x285850(0x178)+_0x285850(0x18a),{'parse_mode':_0x285850(0x15b)}));}catch(_0x3dab92){console[_0x285850(0x1b8)](_0x285850(0x160),_0x3dab92),await this[_0x285850(0x143)]?.['sendMessage'](_0x2805ef,'❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this['bot'][_0x3800ce(0x1b2)](/\/disconnect/,async _0x13652c=>{const _0x4cfe2c=_0x3800ce,_0x549fe6=_0x13652c[_0x4cfe2c(0x156)]['id'],_0xeab9cb=_0x13652c[_0x4cfe2c(0x1cc)]?.['id'][_0x4cfe2c(0x13b)]();if(!_0xeab9cb)return;try{const _0x33aee3=await database_1[_0x4cfe2c(0x14c)][_0x4cfe2c(0x13f)][_0x4cfe2c(0x181)]({'where':{'telegramId':_0xeab9cb},'include':{'shop':!![]}});if(!_0x33aee3||!_0x33aee3[_0x4cfe2c(0x18b)]||!_0x33aee3['shopId']){await this[_0x4cfe2c(0x143)]?.[_0x4cfe2c(0x101)](_0x549fe6,_0x4cfe2c(0x110));return;}const _0x19bec7=_0x33aee3['shop']?.[_0x4cfe2c(0x151)]||_0x4cfe2c(0x1b6);await database_1[_0x4cfe2c(0x14c)][_0x4cfe2c(0x13f)]['update']({'where':{'telegramId':_0xeab9cb},'data':{'shopId':null,'isVerified':![]}}),console[_0x4cfe2c(0x126)](_0x4cfe2c(0x162)+_0xeab9cb+'\x20disconnected\x20from\x20shop\x20'+_0x33aee3[_0x4cfe2c(0x1d0)]),await this[_0x4cfe2c(0x143)]?.[_0x4cfe2c(0x101)](_0x549fe6,_0x4cfe2c(0x13d)+_0x19bec7+_0x4cfe2c(0x12f)+_0x4cfe2c(0x199),{'parse_mode':_0x4cfe2c(0x15b)});}catch(_0x13ef62){console[_0x4cfe2c(0x1b8)](_0x4cfe2c(0x182),_0x13ef62),await this['bot']?.[_0x4cfe2c(0x101)](_0x549fe6,_0x4cfe2c(0x115));}}),this[_0x3800ce(0x143)]['onText'](/\/status/,async _0x4cd0e3=>{const _0x4d9226=_0x3800ce,_0x29a7b9=_0x4cd0e3[_0x4d9226(0x156)]['id'],_0x42aa52=_0x4cd0e3['from']?.['id'][_0x4d9226(0x13b)]();if(!_0x42aa52)return;try{const _0x3b6cef=await database_1[_0x4d9226(0x14c)][_0x4d9226(0x13f)][_0x4d9226(0x181)]({'where':{'telegramId':_0x42aa52},'include':{'shop':!![]}});if(!_0x3b6cef){await this[_0x4d9226(0x143)]?.['sendMessage'](_0x29a7b9,'❌\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a'+_0x4d9226(0x104));return;}if(!_0x3b6cef[_0x4d9226(0x18b)]||!_0x3b6cef[_0x4d9226(0x1d0)]||!_0x3b6cef[_0x4d9226(0xef)]){await this[_0x4d9226(0x143)]?.[_0x4d9226(0x101)](_0x29a7b9,_0x4d9226(0x1c9)+_0x4d9226(0x14b));return;}await this[_0x4d9226(0x143)]?.[_0x4d9226(0x101)](_0x29a7b9,_0x4d9226(0x116)+('✅\x20Connected\x20to\x20shop:\x20*'+_0x3b6cef[_0x4d9226(0xef)][_0x4d9226(0x151)]+'*\x0a')+('👤\x20Username:\x20`'+_0x3b6cef[_0x4d9226(0xef)][_0x4d9226(0x15d)]+'`\x0a')+(_0x4d9226(0x188)+_0x3b6cef['updatedAt'][_0x4d9226(0x1de)]('en-US')+'\x0a\x0a')+_0x4d9226(0x1ac)+_0x4d9226(0x1c2)+_0x4d9226(0x14d),{'parse_mode':'Markdown'});}catch(_0x4370c0){console[_0x4d9226(0x1b8)]('Error\x20handling\x20/status\x20command:',_0x4370c0),await this[_0x4d9226(0x143)]?.[_0x4d9226(0x101)](_0x29a7b9,_0x4d9226(0x115));}}),this[_0x3800ce(0x143)]['onText'](/\/debug/,async _0x398113=>{const _0x31f110=_0x3800ce,_0x1405c1=_0x398113[_0x31f110(0x156)]['id'],_0x53c994=_0x398113['from']?.['id'][_0x31f110(0x13b)]();if(!_0x53c994)return;try{const _0x3ceb5a=await database_1[_0x31f110(0x14c)][_0x31f110(0x13f)]['findUnique']({'where':{'telegramId':_0x53c994},'include':{'shop':!![]}});let _0x43a975=_0x31f110(0xf0);_0x43a975+=_0x31f110(0xf4)+_0x53c994+_0x31f110(0x112),_0x3ceb5a?.[_0x31f110(0x18b)]&&_0x3ceb5a[_0x31f110(0xef)]?(_0x43a975+=_0x31f110(0x16b),_0x43a975+=_0x31f110(0x1c1)+_0x3ceb5a[_0x31f110(0xef)]['name']+'*\x0a',_0x43a975+='\x20\x20\x20Username:\x20`'+_0x3ceb5a[_0x31f110(0xef)]['username']+'`\x0a',_0x43a975+=_0x31f110(0x170)+_0x3ceb5a[_0x31f110(0xef)]['status']+'\x0a\x0a'):_0x43a975+=_0x31f110(0x17f),_0x43a975+=_0x31f110(0x19b),await this[_0x31f110(0x143)]?.['sendMessage'](_0x1405c1,_0x43a975,{'parse_mode':_0x31f110(0x15b)});}catch(_0x466b49){console[_0x31f110(0x1b8)]('Error\x20handling\x20/debug\x20command:',_0x466b49),await this[_0x31f110(0x143)]?.[_0x31f110(0x101)](_0x1405c1,_0x31f110(0x1c0));}}),this[_0x3800ce(0x143)]['on'](_0x3800ce(0xfc),async _0x4f2126=>{const _0x1b0064=_0x3800ce;if(_0x4f2126[_0x1b0064(0x1be)]?.['startsWith']('/'))return;const _0x25b811=_0x4f2126[_0x1b0064(0x156)]['id'],_0x58ec38=_0x4f2126['from']?.['id'][_0x1b0064(0x13b)](),_0x4692fb=_0x4f2126[_0x1b0064(0x1be)]?.[_0x1b0064(0x15e)]();if(!_0x58ec38||!_0x4692fb)return;try{const _0x1756db=await database_1['default'][_0x1b0064(0x13f)][_0x1b0064(0x181)]({'where':{'telegramId':_0x58ec38},'include':{'shop':!![]}});if(!_0x1756db){await this[_0x1b0064(0x143)]?.['sendMessage'](_0x25b811,_0x1b0064(0x1c4));return;}if(_0x1756db['isVerified']&&_0x1756db[_0x1b0064(0x1d0)]&&_0x1756db[_0x1b0064(0xef)]){await this['bot']?.[_0x1b0064(0x101)](_0x25b811,_0x1b0064(0x192)+_0x1756db[_0x1b0064(0xef)][_0x1b0064(0x151)]+_0x1b0064(0x12f)+_0x1b0064(0x16e),{'parse_mode':_0x1b0064(0x15b)});return;}const _0x3a90ea=_0x4692fb['split'](/\s+/);if(_0x3a90ea[_0x1b0064(0x168)]!==0x2){await this[_0x1b0064(0x143)]?.[_0x1b0064(0x101)](_0x25b811,'❌\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a'+'📝\x20Format:\x20`username\x20api_key`\x0a\x0a'+_0x1b0064(0x100)+_0x1b0064(0x178)+(_0x1b0064(0x1d6)+_0x3a90ea['length']+_0x1b0064(0xf8)+_0x3a90ea[_0x1b0064(0x1e2)](_0x15bc49=>'`'+_0x15bc49+'`')['join'](',\x20')),{'parse_mode':'Markdown'});return;}const [_0x339925,_0x5ddd50]=_0x3a90ea;console[_0x1b0064(0x126)]('🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20'+_0x58ec38+_0x1b0064(0x146)+_0x339925+'\x22,\x20apiKey=\x22'+_0x5ddd50[_0x1b0064(0xf3)](0x0,0xa)+_0x1b0064(0x1dc)),await this[_0x1b0064(0xfa)](_0x25b811,_0x58ec38,_0x339925,_0x5ddd50);}catch(_0x186620){console[_0x1b0064(0x1b8)]('Error\x20handling\x20message:',_0x186620),await this[_0x1b0064(0x143)]?.[_0x1b0064(0x101)](_0x25b811,_0x1b0064(0x115));}}),this[_0x3800ce(0x143)]['on'](_0x3800ce(0x1b8),_0x56aaf4=>{const _0x4e049a=_0x3800ce;console[_0x4e049a(0x1b8)](_0x4e049a(0xfe),_0x56aaf4);}),this[_0x3800ce(0x143)]['on'](_0x3800ce(0x1d8),_0x1bc7cf=>{const _0x346d95=_0x3800ce;console[_0x346d95(0x1b8)](_0x346d95(0x1a2),_0x1bc7cf);});}async['handleSingleLineVerification'](_0x4ce0f6,_0x51c24c,_0x329618,_0x4cf4be){const _0x222933=a66_0x26cd66;try{console[_0x222933(0x126)]('🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20'+_0x51c24c+':\x20username=\x22'+_0x329618+_0x222933(0x1a5)+_0x4cf4be['substring'](0x0,0xa)+_0x222933(0x1dc));if(!_0x329618||_0x329618[_0x222933(0x168)]<0x3||_0x329618[_0x222933(0x168)]>0x32||!/^[a-zA-Z0-9_]+$/['test'](_0x329618)){await this[_0x222933(0x143)]?.[_0x222933(0x101)](_0x4ce0f6,_0x222933(0xff)+_0x329618+_0x222933(0x112)+_0x222933(0x12d),{'parse_mode':_0x222933(0x15b)});return;}if(!_0x4cf4be||!_0x4cf4be['startsWith'](_0x222933(0x12b))&&!_0x4cf4be[_0x222933(0x169)]('sk_')){await this[_0x222933(0x143)]?.['sendMessage'](_0x4ce0f6,'❌\x20Invalid\x20API\x20key\x20format.\x0a\x0a'+_0x222933(0x114),{'parse_mode':_0x222933(0x15b)});return;}const _0x27a258=await database_1[_0x222933(0x14c)]['shop'][_0x222933(0x181)]({'where':{'username':_0x329618},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x27a258){const _0x3f4778=_0x222933(0x128)+_0x329618+_0x222933(0x1d4)+_0x222933(0x19c)+_0x222933(0x1c3);await this[_0x222933(0x143)]?.[_0x222933(0x101)](_0x4ce0f6,_0x3f4778,{'parse_mode':_0x222933(0x15b)});return;}if(_0x27a258[_0x222933(0x154)]!=='ACTIVE'){await this[_0x222933(0x143)]?.['sendMessage'](_0x4ce0f6,_0x222933(0x1a3)+_0x329618+_0x222933(0x1ad)+_0x222933(0xf7),{'parse_mode':_0x222933(0x15b)});return;}if(_0x27a258[_0x222933(0x1cb)]!==_0x4cf4be&&_0x27a258[_0x222933(0x1ba)]!==_0x4cf4be){await this[_0x222933(0x143)]?.['sendMessage'](_0x4ce0f6,_0x222933(0x17b)+_0x329618+_0x222933(0x142)+_0x222933(0x1db)+'Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`',{'parse_mode':'Markdown'});return;}const _0x5e5e84=await database_1['default'][_0x222933(0x13f)][_0x222933(0x193)]({'where':{'shopId':_0x27a258['id'],'isVerified':!![],'telegramId':{'not':_0x51c24c}}});if(_0x5e5e84){await this['bot']?.[_0x222933(0x101)](_0x4ce0f6,_0x222933(0x1cf)+_0x329618+'`.\x0a\x0a'+_0x222933(0x130),{'parse_mode':_0x222933(0x15b)});return;}await database_1[_0x222933(0x14c)][_0x222933(0x13f)][_0x222933(0x10b)]({'where':{'telegramId':_0x51c24c},'data':{'shopId':_0x27a258['id'],'isVerified':!![]}}),await this['bot']?.[_0x222933(0x101)](_0x4ce0f6,'🎉\x20*Congratulations!*\x0a\x0a'+_0x222933(0x19a)+(_0x222933(0x19f)+_0x27a258[_0x222933(0x151)]+'*\x0a')+('👤\x20Username:\x20`'+_0x27a258['username']+_0x222933(0x112))+_0x222933(0x18d)+_0x222933(0x194)+_0x222933(0xf9)+_0x222933(0x12a)+_0x222933(0x1b3)+'Commands:\x0a'+_0x222933(0xf1)+'/disconnect\x20-\x20disconnect\x20from\x20notifications',{'parse_mode':_0x222933(0x15b)}),console[_0x222933(0x126)]('✅\x20Telegram\x20user\x20'+_0x51c24c+_0x222933(0x196)+_0x27a258[_0x222933(0x15d)]+_0x222933(0x1a4));}catch(_0x52fd5d){console['error'](_0x222933(0xee),_0x52fd5d),await this[_0x222933(0x143)]?.[_0x222933(0x101)](_0x4ce0f6,_0x222933(0x1e7));}}async[a66_0x26cd66(0x1bb)](_0x53ac8a,_0x456729,_0x17ec35){const _0x5d395b=a66_0x26cd66;if(!this[_0x5d395b(0x143)]){console[_0x5d395b(0x120)](_0x5d395b(0x1d3));return;}try{const _0xa93567=await database_1['default'][_0x5d395b(0x13f)][_0x5d395b(0x13e)]({'where':{'shopId':_0x53ac8a,'isVerified':!![]}});if(_0xa93567[_0x5d395b(0x168)]===0x0){console[_0x5d395b(0x126)]('No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20'+_0x53ac8a);return;}const _0x11c217=_0xa93567[_0x5d395b(0x1e2)](async _0x4ae53e=>{const _0x3bcd1c=_0x5d395b;try{await this[_0x3bcd1c(0x143)]?.['sendMessage'](_0x4ae53e['telegramId'],_0x456729,_0x17ec35),console[_0x3bcd1c(0x126)](_0x3bcd1c(0x108)+_0x4ae53e['telegramId']);}catch(_0x2a3a7f){console['error'](_0x3bcd1c(0x1ae)+_0x4ae53e[_0x3bcd1c(0x18c)]+':',_0x2a3a7f),_0x2a3a7f instanceof Error&&(_0x2a3a7f[_0x3bcd1c(0xfc)]['includes'](_0x3bcd1c(0x1d1))||_0x2a3a7f[_0x3bcd1c(0xfc)][_0x3bcd1c(0x1a8)](_0x3bcd1c(0x191))||_0x2a3a7f[_0x3bcd1c(0xfc)][_0x3bcd1c(0x1a8)]('user\x20is\x20deactivated'))&&(await database_1[_0x3bcd1c(0x14c)][_0x3bcd1c(0x13f)][_0x3bcd1c(0x10b)]({'where':{'id':_0x4ae53e['id']},'data':{'isVerified':![]}}),console[_0x3bcd1c(0x126)](_0x3bcd1c(0x106)+_0x4ae53e[_0x3bcd1c(0x18c)]+_0x3bcd1c(0x16f)));}});await Promise[_0x5d395b(0x148)](_0x11c217);}catch(_0xb84f8){console[_0x5d395b(0x1b8)](_0x5d395b(0x123),_0xb84f8);}}async[a66_0x26cd66(0x17a)](_0x210aac,_0x585878,_0x4548dc){const _0x5cd08a=a66_0x26cd66,_0x2c1f5e={'created':'🆕','paid':'✅','failed':'❌','expired':'⏰','refund':'🔄','chargeback':'⚠️','processing':'⚙️'},_0x467b00={'created':_0x5cd08a(0x1b7),'paid':_0x5cd08a(0x1b0),'failed':'Payment\x20failed','expired':_0x5cd08a(0x127),'refund':_0x5cd08a(0x141),'chargeback':_0x5cd08a(0x167),'processing':_0x5cd08a(0x129)},_0x471926=_0x2c1f5e[_0x4548dc],_0x213bda=_0x467b00[_0x4548dc],_0x10aa3b=(0x0,gateway_1[_0x5cd08a(0x157)])(_0x585878[_0x5cd08a(0x165)]);console[_0x5cd08a(0x126)](_0x5cd08a(0x16c)+_0x585878[_0x5cd08a(0x165)]+'\x22\x20->\x20display\x20\x22'+_0x10aa3b+'\x22');let _0x2e0214=_0x471926+'\x20*'+_0x213bda+'*\x0a\x0a'+(_0x5cd08a(0x16d)+_0x585878[_0x5cd08a(0x161)]+'\x20'+_0x585878[_0x5cd08a(0x1a6)]+'*\x0a')+(_0x5cd08a(0x17c)+(_0x585878['orderId']||_0x585878['id'])+'`\x0a')+(_0x5cd08a(0x159)+_0x585878['id']+'`\x0a')+(_0x5cd08a(0x15c)+_0x10aa3b+'`\x0a')+(_0x5cd08a(0x1bd)+new Date(_0x585878['createdAt'])[_0x5cd08a(0x19e)]('en-US')+'\x0a');if(_0x585878[_0x5cd08a(0x117)]||_0x585878[_0x5cd08a(0x153)]||_0x585878[_0x5cd08a(0x15f)]||_0x585878[_0x5cd08a(0x1c7)]||_0x585878['customerUa']){_0x2e0214+=_0x5cd08a(0x1c5);_0x585878[_0x5cd08a(0x117)]&&(_0x2e0214+='📛\x20Name:\x20`'+_0x585878[_0x5cd08a(0x117)]+'`\x0a');_0x585878['customerEmail']&&(_0x2e0214+=_0x5cd08a(0x1e3)+_0x585878['customerEmail']+'`\x0a');_0x585878[_0x5cd08a(0x15f)]&&(_0x2e0214+='🏦\x20IBAN:\x20`'+_0x585878[_0x5cd08a(0x15f)]+'`\x0a');_0x585878[_0x5cd08a(0x1c7)]&&(_0x2e0214+='🌐\x20IP:\x20`'+_0x585878[_0x5cd08a(0x1c7)]+'`\x0a');if(_0x585878[_0x5cd08a(0x12e)]){const _0x54706b=_0x585878[_0x5cd08a(0x12e)][_0x5cd08a(0x168)]>0x32?_0x585878[_0x5cd08a(0x12e)][_0x5cd08a(0xf3)](0x0,0x32)+_0x5cd08a(0x125):_0x585878[_0x5cd08a(0x12e)];_0x2e0214+=_0x5cd08a(0x10d)+_0x54706b+'`\x0a';}}_0x4548dc===_0x5cd08a(0x1df)&&_0x585878[_0x5cd08a(0x11a)]&&(_0x2e0214+=_0x5cd08a(0x147)+_0x585878['chargebackAmount']+_0x5cd08a(0x1c8)),_0x4548dc===_0x5cd08a(0x18f)&&(_0x2e0214+=_0x5cd08a(0x134)),_0x585878[_0x5cd08a(0x184)]&&(_0x2e0214+=_0x5cd08a(0x113)+_0x585878[_0x5cd08a(0x184)]+'\x0a'),await this[_0x5cd08a(0x1bb)](_0x210aac,_0x2e0214,{'parse_mode':_0x5cd08a(0x15b)});}async[a66_0x26cd66(0x12c)](_0xab0e2d,_0x4572d6,_0x2fb129){const _0x351138=a66_0x26cd66,_0x50679e={'created':'📤','completed':'✅','rejected':'❌'},_0x1fdb1f={'created':_0x351138(0x13c),'completed':_0x351138(0x1ce),'rejected':'Payout\x20rejected'},_0x2921a4=_0x50679e[_0x2fb129],_0x4d874d=_0x1fdb1f[_0x2fb129],_0x160c81=_0x2921a4+'\x20*'+_0x4d874d+_0x351138(0x177)+(_0x351138(0xfd)+_0x4572d6[_0x351138(0x161)]+_0x351138(0x103))+('🏦\x20Method:\x20`'+_0x4572d6[_0x351138(0x118)]+'`\x0a')+(_0x351138(0x1d9)+_0x4572d6['id']+'`\x0a')+(_0x351138(0x1bd)+new Date(_0x4572d6['createdAt'])[_0x351138(0x19e)](_0x351138(0x10c))+'\x0a')+(_0x4572d6['txid']?_0x351138(0xf6)+_0x4572d6[_0x351138(0x124)]+'`':'');await this[_0x351138(0x1bb)](_0xab0e2d,_0x160c81,{'parse_mode':_0x351138(0x15b)});}async[a66_0x26cd66(0x174)](_0x4f5f49,_0x28b3ae){const _0x321a70=a66_0x26cd66;try{const _0x1b7686=await database_1['default']['shopSettings']['findUnique']({'where':{'shopId':_0x4f5f49},'select':{'notificationLogin':!![]}});if(!_0x1b7686?.[_0x321a70(0x1e1)]){console[_0x321a70(0x126)]('📱\x20Login\x20notifications\x20disabled\x20for\x20shop\x20'+_0x4f5f49);return;}const _0x1ad0a=_0x28b3ae['success']?'🔐':'🚨',_0x5e0aa9=_0x28b3ae[_0x321a70(0x107)]?_0x321a70(0x10f):_0x321a70(0x1e5);let _0x8a07ed=_0x1ad0a+'\x20*'+_0x5e0aa9+_0x321a70(0x177)+(_0x321a70(0x1aa)+_0x28b3ae['username']+'`\x0a')+(_0x321a70(0x13a)+_0x28b3ae['timestamp']['toLocaleString'](_0x321a70(0x10c))+'\x0a');_0x28b3ae[_0x321a70(0x166)]&&(_0x8a07ed+=_0x321a70(0x1ca)+_0x28b3ae[_0x321a70(0x166)]+'`\x0a');if(_0x28b3ae[_0x321a70(0x1b4)]){const _0x152347=_0x28b3ae['userAgent'][_0x321a70(0x168)]>0x32?_0x28b3ae[_0x321a70(0x1b4)][_0x321a70(0xf3)](0x0,0x32)+_0x321a70(0x125):_0x28b3ae[_0x321a70(0x1b4)];_0x8a07ed+='💻\x20Browser:\x20`'+_0x152347+'`\x0a';}!_0x28b3ae[_0x321a70(0x107)]&&(_0x8a07ed+=_0x321a70(0x149)),await this['sendShopNotification'](_0x4f5f49,_0x8a07ed,{'parse_mode':'Markdown'}),console[_0x321a70(0x126)](_0x321a70(0x171)+_0x4f5f49+':\x20'+(_0x28b3ae[_0x321a70(0x107)]?_0x321a70(0x107):_0x321a70(0x131)));}catch(_0x2eed53){console[_0x321a70(0x1b8)](_0x321a70(0x1ea),_0x2eed53);}}async[a66_0x26cd66(0x164)](_0x380e75,_0x1e5699){const _0x378509=a66_0x26cd66;try{const _0x41fe37=await database_1['default']['shopSettings'][_0x378509(0x181)]({'where':{'shopId':_0x380e75},'select':{'notificationApiError':!![]}});if(!_0x41fe37?.[_0x378509(0x132)]){console[_0x378509(0x126)](_0x378509(0xf5)+_0x380e75);return;}let _0x197978=_0x378509(0x1a1)+(_0x378509(0x180)+_0x1e5699['method']+'\x20'+_0x1e5699[_0x378509(0x109)]+'`\x0a')+(_0x378509(0x13a)+_0x1e5699[_0x378509(0x1e8)]['toLocaleString'](_0x378509(0x10c))+'\x0a');_0x1e5699[_0x378509(0x121)]&&(_0x197978+=_0x378509(0x176)+_0x1e5699['statusCode']+'`\x0a'),_0x197978+='❌\x20Error:\x20`'+_0x1e5699[_0x378509(0x1dd)]+'`\x0a',_0x1e5699[_0x378509(0x11b)]&&(_0x197978+=_0x378509(0x135)+_0x1e5699['requestId']+'`\x0a'),_0x197978+=_0x378509(0x1b5),await this['sendShopNotification'](_0x380e75,_0x197978,{'parse_mode':'Markdown'}),console['log'](_0x378509(0x158)+_0x380e75+':\x20'+_0x1e5699[_0x378509(0x109)]);}catch(_0x47bf5a){console['error'](_0x378509(0x14f),_0x47bf5a);}}async[a66_0x26cd66(0x1a7)](_0x579fc2,_0x550025,_0x3b69e8){const _0x3b0f38=a66_0x26cd66;let _0x514ace=_0x3b0f38(0x198)+_0x550025+_0x3b0f38(0x177);for(const [_0x1b4257,_0x5b20c0]of Object[_0x3b0f38(0x17d)](_0x3b69e8)){_0x5b20c0!==null&&_0x5b20c0!==undefined&&(_0x514ace+=_0x1b4257+_0x3b0f38(0x122)+_0x5b20c0+'`\x0a');}await this[_0x3b0f38(0x1bb)](_0x579fc2,_0x514ace,{'parse_mode':_0x3b0f38(0x15b)});}async[a66_0x26cd66(0x1da)](_0x5448f8){const _0x2b6e41=a66_0x26cd66;try{console[_0x2b6e41(0x126)](_0x2b6e41(0x1a9)+_0x5448f8[_0x2b6e41(0xf3)](0x0,0x32)+_0x2b6e41(0x125));const _0x409b64=await database_1[_0x2b6e41(0x14c)][_0x2b6e41(0x13f)][_0x2b6e41(0x13e)]({'select':{'telegramId':!![]}});if(_0x409b64[_0x2b6e41(0x168)]===0x0){console['log'](_0x2b6e41(0x1a0));return;}for(const _0x283ee0 of _0x409b64){try{await this[_0x2b6e41(0x143)]?.[_0x2b6e41(0x101)](_0x283ee0[_0x2b6e41(0x18c)],_0x5448f8,{'parse_mode':_0x2b6e41(0x15b)});}catch(_0x1b9f0b){console[_0x2b6e41(0x1b8)]('❌\x20Failed\x20to\x20send\x20message\x20to\x20user\x20'+_0x283ee0[_0x2b6e41(0x18c)]+':',_0x1b9f0b);}}console[_0x2b6e41(0x126)]('📱\x20Notification\x20sent\x20to\x20'+_0x409b64[_0x2b6e41(0x168)]+_0x2b6e41(0x18e));}catch(_0x2bb5a0){console['error'](_0x2b6e41(0x133),_0x2bb5a0);}}[a66_0x26cd66(0x1d5)](){const _0xb8777e=a66_0x26cd66;return{'isActive':!!this[_0xb8777e(0x143)],'username':this[_0xb8777e(0x1b1)]};}async['sendShopFile'](_0x41dc7d,_0x52a5ee,_0x5be583,_0x70354c){const _0x5c4800=a66_0x26cd66;try{if(!this['bot'])return console[_0x5c4800(0x1b8)](_0x5c4800(0x1c6)),![];const _0x1fb1c8=await database_1['default']['telegramUser'][_0x5c4800(0x13e)]({'where':{'shopId':_0x41dc7d,'isVerified':!![]},'select':{'telegramId':!![]}});if(_0x1fb1c8[_0x5c4800(0x168)]===0x0)return console[_0x5c4800(0x1b8)](_0x5c4800(0x155)+_0x41dc7d),![];let _0x43dc49=0x0;for(const _0xcf2bee of _0x1fb1c8){try{await this[_0x5c4800(0x143)][_0x5c4800(0x173)](_0xcf2bee[_0x5c4800(0x18c)],_0x52a5ee,{},{'filename':_0x5be583,'contentType':_0x5be583[_0x5c4800(0x163)](_0x5c4800(0x1d2))?_0x5c4800(0x11f):_0x5be583[_0x5c4800(0x163)]('.jpg')||_0x5be583[_0x5c4800(0x163)](_0x5c4800(0x187))?_0x5c4800(0x102):_0x5be583[_0x5c4800(0x163)](_0x5c4800(0x179))?_0x5c4800(0x1cd):'application/octet-stream'}),_0x70354c&&await this[_0x5c4800(0x143)]['sendMessage'](_0xcf2bee[_0x5c4800(0x18c)],_0x70354c),_0x43dc49++;}catch(_0x524456){console[_0x5c4800(0x1b8)](_0x5c4800(0x10a)+_0xcf2bee[_0x5c4800(0x18c)]+':',_0x524456);}}return console[_0x5c4800(0x126)](_0x5c4800(0x14a)+_0x43dc49+'/'+_0x1fb1c8[_0x5c4800(0x168)]+_0x5c4800(0x185)+_0x41dc7d+':\x20'+_0x5be583),_0x43dc49>0x0;}catch(_0x24a338){return console[_0x5c4800(0x1b8)](_0x5c4800(0x145),_0x24a338),![];}}async[a66_0x26cd66(0x1bc)](_0x4b735b,_0x3376f9){const _0x1b03f9=a66_0x26cd66;try{if(!this[_0x1b03f9(0x143)])return console[_0x1b03f9(0x1b8)](_0x1b03f9(0x1c6)),![];return await this['bot'][_0x1b03f9(0x101)](_0x4b735b,_0x3376f9),console[_0x1b03f9(0x126)](_0x1b03f9(0x140)+_0x4b735b),!![];}catch(_0x564c9f){return console[_0x1b03f9(0x1b8)](_0x1b03f9(0x137),_0x564c9f),![];}}async['sendDirectFile'](_0x1ca5cd,_0x465e28,_0x179f45,_0x686765){const _0x3688d8=a66_0x26cd66;try{if(!this[_0x3688d8(0x143)])return console[_0x3688d8(0x1b8)](_0x3688d8(0x1c6)),![];return await this[_0x3688d8(0x143)][_0x3688d8(0x173)](_0x1ca5cd,_0x465e28,{},{'filename':_0x179f45,'contentType':_0x179f45[_0x3688d8(0x163)](_0x3688d8(0x1d2))?_0x3688d8(0x11f):_0x179f45[_0x3688d8(0x163)](_0x3688d8(0x139))||_0x179f45[_0x3688d8(0x163)]('.jpeg')?_0x3688d8(0x102):_0x179f45[_0x3688d8(0x163)]('.pdf')?'application/pdf':'application/octet-stream'}),_0x686765&&await this[_0x3688d8(0x143)][_0x3688d8(0x101)](_0x1ca5cd,_0x686765),console[_0x3688d8(0x126)](_0x3688d8(0x1ab)+_0x1ca5cd+':\x20'+_0x179f45),!![];}catch(_0x3cb4b5){return console[_0x3688d8(0x1b8)](_0x3688d8(0x190),_0x3cb4b5),![];}}['stopBot'](){const _0x16b92d=a66_0x26cd66;this[_0x16b92d(0x143)]&&(this['bot']['stopPolling'](),this[_0x16b92d(0x143)]=null,console[_0x16b92d(0x126)]('🛑\x20Telegram\x20bot\x20stopped'));}}exports['TelegramBotService']=TelegramBotService,exports[a66_0x26cd66(0x186)]=new TelegramBotService();