'use strict';function a54_0x5644(){const _0x58d3ce=['✅\x20Connected\x20to\x20shop:\x20*','\x20USDT*\x0a','Telegram\x20bot\x20error:','❌\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.','user\x20is\x20deactivated','chargebackAmount','You\x20are\x20already\x20connected\x20to\x20shop:\x20*','✅\x20Notification\x20sent\x20to\x20Telegram\x20user\x20','toLocaleDateString','adminNotes','•\x20New\x20payments\x0a','📅\x20Time:\x20','\x0a💡\x20Check\x20your\x20request\x20or\x20contact\x20support.','...','Payment\x20is\x20being\x20processed','📝\x20Format:\x20`username\x20api_key`\x0a\x0a','🛑\x20Telegram\x20bot\x20stopped','\x20disconnected\x20from\x20shop\x20','14831865HfqfBC','•\x20Payment\x20status\x20changes\x0a','Username:\x20`','warn','Failed\x20login\x20attempt','❌\x20Invalid\x20API\x20key\x20format.\x0a\x0a','stopPolling','❌\x20Failed\x20to\x20initialize\x20Telegram\x20bot:','startsWith','1274751ROIqIt','unknown\x20shop','\x0a👤\x20*Customer\x20Information:*\x0a','getGatewayDisplayNameForTelegram','Failed\x20to\x20send\x20API\x20error\x20notification:','\x20verified\x20for\x20shop\x20','getBotInfo','ACTIVE','Available\x20usernames:\x0a','Successful\x20login','🏪\x20Available\x20shops\x20in\x20system:\x0a','`\x0a\x0a','botToken','Error\x20handling\x20message:','requestId','join','userAgent','sendCustomNotification','test','env','⏳\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a','\x20USD*\x0a','default','includes','`\x20not\x20found.\x0a\x0a','Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a','TELEGRAM_BOT_USERNAME','📱\x20Shop:\x20*',':\x20`','success','node-telegram-bot-api','forEach','\x20\x20\x20Status:\x20','telegramBotService','statusCode','findFirst','toLocaleString','Commands:\x0a','📝\x20Order\x20ID:\x20`','...`\x0a\x0a','timestamp','length','/status\x20-\x20check\x20connection\x20status\x0a','trim','❌\x20API\x20key\x20does\x20not\x20match\x20shop\x20`','New\x20payment\x20created','You\x20sent\x20','*\x0a\x0a','onText','🔔\x20*','\x20via\x20single-line\x20input','•\x20Payouts\x0a\x0a','🔄\x20Reset\x20incomplete\x20verification\x20for\x20user\x20','createdAt','substring','username','🔔\x20Notifications\x20are\x20active\x0a\x0a','secretKey','📱\x20Created\x20new\x20Telegram\x20user:\x20','16gzZaim','initializeBot','🆔\x20Request\x20ID:\x20`','❌\x20An\x20error\x20occurred\x20while\x20verifying\x20data.','❌\x20Shop\x20with\x20username\x20`','sendShopNotification','📱\x20Telegram\x20notification:\x20gateway\x20\x22','message','💰\x20Amount:\x20*','1bkZdjP','setupBotHandlers',':\x20username=\x22','sendLoginNotification','.\x20*','updatedAt','📅\x20Connection\x20date:\x20','❌\x20Shop\x20`','Payout\x20completed','✅\x20Telegram\x20user\x20','telegramId','🔔\x20You\x20receive\x20notifications\x20about:\x0a','Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.','create','trapay_bot','•\x20`','🤖\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a','💸\x20Penalty\x20amount:\x20*','16560xoirLP','📧\x20Email:\x20`','/disconnect\x20-\x20disconnect\x20from\x20notifications','log','currency','pk_','sendPaymentNotification','✅\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*','API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','Payment\x20failed','notificationApiError','shopSettings','shopId','__esModule','🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20','❌\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`','botUsername','❌\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a','stopBot','🏪\x20Gateway:\x20`','✅\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*','last_name','update','🌐\x20IP\x20address:\x20`','map','\x20\x20\x20Public\x20Key:\x20`','status','amount','Example:\x0a','Payout\x20rejected','customerEmail','✅\x20Login\x20notification\x20sent\x20for\x20shop\x20','Error\x20handling\x20/debug\x20command:','text','customerName','Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).','telegramUser','...\x22','Check\x20spelling\x20and\x20try\x20again.','Payment\x20refund','allSettled','findMany','❌\x20Error\x20getting\x20debug\x20information.','User\x20','Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`','📱\x20Your\x20Telegram\x20ID:\x20`','method','\x20initialized\x20successfully','❌\x20Please\x20use\x20/start\x20command\x20first','gateway','\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure','🎉\x20*Congratulations!*\x0a\x0a','en-US','🆔\x20Payment\x20ID:\x20`','error','No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20','2213012WhPYzR','👤\x20Username:\x20`','10DUHdKi','📊\x20Error\x20code:\x20`','findUnique','txid','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','5555930BUcIrh','45914jTalbq','1276814yBtdSZ','❌\x20Invalid\x20username\x20format:\x20`','sendMessage','chargeback','isVerified','name','*.\x0a\x0a','shop','Payment\x20successfully\x20paid','chat','Error\x20sending\x20shop\x20notification:','Markdown','\x22,\x20apiKey=\x22','❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','Payment\x20expired','endpoint','\x20\x20\x20Username:\x20`','Contact\x20administrator.','chat\x20not\x20found','bot','__importDefault','To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a','TELEGRAM_BOT_TOKEN','ipAddress','errorMessage','New\x20payout\x20created','TelegramBotService','sk_','✅\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20','\x0aCheck\x20spelling\x20and\x20try\x20again.','handleSingleLineVerification','📛\x20Name:\x20`','from','4VXZRCs','publicKey','❌\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20','📅\x20Date:\x20','\x22\x20->\x20display\x20\x22','toString','🔗\x20Endpoint:\x20`','polling_error','../types/gateway','✅\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a','notificationLogin','1138404VoJitX'];a54_0x5644=function(){return _0x58d3ce;};return a54_0x5644();}const a54_0x40e82e=a54_0x47b9;(function(_0x474aa5,_0x18e440){const _0x3779a2=a54_0x47b9,_0x7b1a92=_0x474aa5();while(!![]){try{const _0x56b5c0=parseInt(_0x3779a2(0x115))/0x1*(-parseInt(_0x3779a2(0x15f))/0x2)+-parseInt(_0x3779a2(0xd1))/0x3*(parseInt(_0x3779a2(0xaa))/0x4)+-parseInt(_0x3779a2(0x87))/0x5+-parseInt(_0x3779a2(0xb5))/0x6+parseInt(_0x3779a2(0x89))/0x7*(-parseInt(_0x3779a2(0x10c))/0x8)+parseInt(_0x3779a2(0xc8))/0x9*(-parseInt(_0x3779a2(0x82))/0xa)+-parseInt(_0x3779a2(0x88))/0xb*(-parseInt(_0x3779a2(0x127))/0xc);if(_0x56b5c0===_0x18e440)break;else _0x7b1a92['push'](_0x7b1a92['shift']());}catch(_0x1afc04){_0x7b1a92['push'](_0x7b1a92['shift']());}}}(a54_0x5644,0xdf62c));var __importDefault=this&&this[a54_0x40e82e(0x9d)]||function(_0xb44aad){return _0xb44aad&&_0xb44aad['__esModule']?_0xb44aad:{'default':_0xb44aad};};Object['defineProperty'](exports,a54_0x40e82e(0x134),{'value':!![]}),exports[a54_0x40e82e(0xf2)]=exports[a54_0x40e82e(0xa3)]=void 0x0;const node_telegram_bot_api_1=__importDefault(require(a54_0x40e82e(0xef))),database_1=__importDefault(require('../config/database')),gateway_1=require(a54_0x40e82e(0xb2));function a54_0x47b9(_0x52ee94,_0x4b1b65){const _0x5644fa=a54_0x5644();return a54_0x47b9=function(_0x47b96e,_0x49a415){_0x47b96e=_0x47b96e-0x81;let _0x484d38=_0x5644fa[_0x47b96e];return _0x484d38;},a54_0x47b9(_0x52ee94,_0x4b1b65);}class TelegramBotService{constructor(){const _0xdc6ef8=a54_0x40e82e;this[_0xdc6ef8(0x9c)]=null,this[_0xdc6ef8(0xdd)]=process['env'][_0xdc6ef8(0x9f)]||'',this[_0xdc6ef8(0x137)]=process[_0xdc6ef8(0xe4)][_0xdc6ef8(0xeb)]||_0xdc6ef8(0x123),this[_0xdc6ef8(0xdd)]?this['initializeBot']():console[_0xdc6ef8(0xcb)]('TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables');}[a54_0x40e82e(0x10d)](){const _0x3db100=a54_0x40e82e;try{this[_0x3db100(0x9c)]=new node_telegram_bot_api_1['default'](this[_0x3db100(0xdd)],{'polling':!![]}),this[_0x3db100(0x116)](),console['log']('✅\x20Telegram\x20bot\x20@'+this[_0x3db100(0x137)]+_0x3db100(0x156));}catch(_0x3b0ec5){console['error'](_0x3db100(0xcf),_0x3b0ec5);}}[a54_0x40e82e(0x116)](){const _0x171a0e=a54_0x40e82e;if(!this[_0x171a0e(0x9c)])return;this[_0x171a0e(0x9c)]['onText'](/\/start/,async _0x37b932=>{const _0x5434f4=_0x171a0e,_0x36dacc=_0x37b932[_0x5434f4(0x92)]['id'],_0x10d75f=_0x37b932['from']?.['id'][_0x5434f4(0xaf)](),_0x5e87f4=_0x37b932[_0x5434f4(0xa9)]?.[_0x5434f4(0x108)],_0xa2ca55=_0x37b932[_0x5434f4(0xa9)]?.['first_name'],_0x267fd2=_0x37b932[_0x5434f4(0xa9)]?.[_0x5434f4(0x13c)];if(!_0x10d75f)return;try{let _0x41b01c=await database_1[_0x5434f4(0xe7)][_0x5434f4(0x14b)][_0x5434f4(0x84)]({'where':{'telegramId':_0x10d75f},'include':{'shop':!![]}});!_0x41b01c?(_0x41b01c=await database_1['default'][_0x5434f4(0x14b)][_0x5434f4(0x122)]({'data':{'telegramId':_0x10d75f,'username':_0x5e87f4,'firstName':_0xa2ca55,'lastName':_0x267fd2,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console[_0x5434f4(0x12a)](_0x5434f4(0x10b)+_0x10d75f+'\x20(@'+_0x5e87f4+')')):_0x41b01c=await database_1[_0x5434f4(0xe7)][_0x5434f4(0x14b)][_0x5434f4(0x13d)]({'where':{'telegramId':_0x10d75f},'data':{'username':_0x5e87f4,'firstName':_0xa2ca55,'lastName':_0x267fd2},'include':{'shop':!![]}}),_0x41b01c[_0x5434f4(0x8d)]&&_0x41b01c[_0x5434f4(0x133)]&&_0x41b01c[_0x5434f4(0x90)]?await this[_0x5434f4(0x9c)]?.[_0x5434f4(0x8b)](_0x36dacc,'✅\x20Welcome\x20back!\x0a\x0a'+(_0x5434f4(0xbc)+_0x41b01c[_0x5434f4(0x90)][_0x5434f4(0x8e)]+'*\x0a')+(_0x5434f4(0xca)+_0x41b01c[_0x5434f4(0x90)][_0x5434f4(0x108)]+_0x5434f4(0xdc))+_0x5434f4(0x120)+_0x5434f4(0xc0)+_0x5434f4(0xc9)+_0x5434f4(0x104)+_0x5434f4(0xf6)+_0x5434f4(0xfb)+'/disconnect\x20-\x20disconnect\x20from\x20notifications',{'parse_mode':'Markdown'}):(_0x41b01c[_0x5434f4(0x133)]&&!_0x41b01c['isVerified']&&(await database_1[_0x5434f4(0xe7)]['telegramUser'][_0x5434f4(0x13d)]({'where':{'telegramId':_0x10d75f},'data':{'shopId':null,'isVerified':![]}}),console[_0x5434f4(0x12a)](_0x5434f4(0x105)+_0x10d75f)),await this['bot']?.['sendMessage'](_0x36dacc,_0x5434f4(0x125)+_0x5434f4(0x9e)+'📝\x20Format:\x20`username\x20api_key`\x0a\x0a'+_0x5434f4(0x143)+_0x5434f4(0x86)+'❗️\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!',{'parse_mode':_0x5434f4(0x94)}));}catch(_0x3ef96a){console[_0x5434f4(0x15d)]('Error\x20handling\x20/start\x20command:',_0x3ef96a),await this[_0x5434f4(0x9c)]?.['sendMessage'](_0x36dacc,'❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this[_0x171a0e(0x9c)][_0x171a0e(0x101)](/\/disconnect/,async _0xa474c0=>{const _0x2f80f5=_0x171a0e,_0x280172=_0xa474c0[_0x2f80f5(0x92)]['id'],_0x4494e0=_0xa474c0[_0x2f80f5(0xa9)]?.['id'][_0x2f80f5(0xaf)]();if(!_0x4494e0)return;try{const _0x126da4=await database_1[_0x2f80f5(0xe7)][_0x2f80f5(0x14b)][_0x2f80f5(0x84)]({'where':{'telegramId':_0x4494e0},'include':{'shop':!![]}});if(!_0x126da4||!_0x126da4[_0x2f80f5(0x8d)]||!_0x126da4[_0x2f80f5(0x133)]){await this['bot']?.[_0x2f80f5(0x8b)](_0x280172,_0x2f80f5(0xb9));return;}const _0x3081ab=_0x126da4[_0x2f80f5(0x90)]?.['name']||_0x2f80f5(0xd2);await database_1['default'][_0x2f80f5(0x14b)][_0x2f80f5(0x13d)]({'where':{'telegramId':_0x4494e0},'data':{'shopId':null,'isVerified':![]}}),console['log']('🔌\x20User\x20'+_0x4494e0+_0x2f80f5(0xc7)+_0x126da4[_0x2f80f5(0x133)]),await this[_0x2f80f5(0x9c)]?.[_0x2f80f5(0x8b)](_0x280172,_0x2f80f5(0x12e)+_0x3081ab+_0x2f80f5(0x8f)+'To\x20reconnect,\x20use\x20the\x20/start\x20command',{'parse_mode':_0x2f80f5(0x94)});}catch(_0xb6e0b0){console[_0x2f80f5(0x15d)]('Error\x20handling\x20/disconnect\x20command:',_0xb6e0b0),await this[_0x2f80f5(0x9c)]?.['sendMessage'](_0x280172,_0x2f80f5(0x96));}}),this['bot']['onText'](/\/status/,async _0x18cdd5=>{const _0x1007d7=_0x171a0e,_0xb49c01=_0x18cdd5[_0x1007d7(0x92)]['id'],_0x4f0ba2=_0x18cdd5[_0x1007d7(0xa9)]?.['id']['toString']();if(!_0x4f0ba2)return;try{const _0xe489e2=await database_1[_0x1007d7(0xe7)]['telegramUser']['findUnique']({'where':{'telegramId':_0x4f0ba2},'include':{'shop':!![]}});if(!_0xe489e2){await this['bot']?.['sendMessage'](_0xb49c01,_0x1007d7(0x138)+'Use\x20/start\x20to\x20begin.');return;}if(!_0xe489e2['isVerified']||!_0xe489e2[_0x1007d7(0x133)]||!_0xe489e2[_0x1007d7(0x90)]){await this[_0x1007d7(0x9c)]?.[_0x1007d7(0x8b)](_0xb49c01,'❌\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a'+'Use\x20/start\x20to\x20connect.');return;}await this[_0x1007d7(0x9c)]?.[_0x1007d7(0x8b)](_0xb49c01,'📊\x20*Connection\x20Status*\x0a\x0a'+(_0x1007d7(0xb6)+_0xe489e2[_0x1007d7(0x90)][_0x1007d7(0x8e)]+'*\x0a')+(_0x1007d7(0x81)+_0xe489e2[_0x1007d7(0x90)]['username']+'`\x0a')+(_0x1007d7(0x11b)+_0xe489e2[_0x1007d7(0x11a)][_0x1007d7(0xbe)](_0x1007d7(0x15b))+'\x0a\x0a')+_0x1007d7(0x109)+_0x1007d7(0xf6)+_0x1007d7(0x129),{'parse_mode':_0x1007d7(0x94)});}catch(_0xac1457){console[_0x1007d7(0x15d)]('Error\x20handling\x20/status\x20command:',_0xac1457),await this['bot']?.[_0x1007d7(0x8b)](_0xb49c01,_0x1007d7(0x96));}}),this['bot']['onText'](/\/debug/,async _0x2c14ad=>{const _0x5f46ac=_0x171a0e,_0x31bc94=_0x2c14ad[_0x5f46ac(0x92)]['id'],_0x26406c=_0x2c14ad['from']?.['id'][_0x5f46ac(0xaf)]();if(!_0x26406c)return;try{const _0x22a992=await database_1[_0x5f46ac(0xe7)][_0x5f46ac(0x90)][_0x5f46ac(0x150)]({'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![]},'take':0xa});let _0x5459c5='🔍\x20*Debug\x20Information*\x0a\x0a';_0x5459c5+=_0x5f46ac(0x154)+_0x26406c+_0x5f46ac(0xdc),_0x5459c5+=_0x5f46ac(0xdb),_0x22a992[_0x5f46ac(0xf0)]((_0x3bde33,_0x270e7f)=>{const _0x1d0a9c=_0x5f46ac;_0x5459c5+=_0x270e7f+0x1+_0x1d0a9c(0x119)+_0x3bde33['name']+'*\x0a',_0x5459c5+=_0x1d0a9c(0x99)+_0x3bde33[_0x1d0a9c(0x108)]+'`\x0a',_0x5459c5+=_0x1d0a9c(0xf1)+_0x3bde33[_0x1d0a9c(0x141)]+'\x0a',_0x5459c5+=_0x1d0a9c(0x140)+_0x3bde33[_0x1d0a9c(0xab)][_0x1d0a9c(0x107)](0x0,0xf)+_0x1d0a9c(0xf8);}),await this[_0x5f46ac(0x9c)]?.[_0x5f46ac(0x8b)](_0x31bc94,_0x5459c5,{'parse_mode':'Markdown'});}catch(_0x3de27d){console[_0x5f46ac(0x15d)](_0x5f46ac(0x147),_0x3de27d),await this[_0x5f46ac(0x9c)]?.['sendMessage'](_0x31bc94,_0x5f46ac(0x151));}}),this[_0x171a0e(0x9c)]['on'](_0x171a0e(0x113),async _0x12d76c=>{const _0x19435e=_0x171a0e;if(_0x12d76c[_0x19435e(0x148)]?.[_0x19435e(0xd0)]('/'))return;const _0x57f0cc=_0x12d76c['chat']['id'],_0x8f1d88=_0x12d76c[_0x19435e(0xa9)]?.['id'][_0x19435e(0xaf)](),_0xa35454=_0x12d76c[_0x19435e(0x148)]?.[_0x19435e(0xfc)]();if(!_0x8f1d88||!_0xa35454)return;try{const _0x353346=await database_1[_0x19435e(0xe7)][_0x19435e(0x14b)]['findUnique']({'where':{'telegramId':_0x8f1d88},'include':{'shop':!![]}});if(!_0x353346){await this[_0x19435e(0x9c)]?.[_0x19435e(0x8b)](_0x57f0cc,_0x19435e(0x157));return;}if(_0x353346[_0x19435e(0x8d)]&&_0x353346[_0x19435e(0x133)]&&_0x353346[_0x19435e(0x90)]){await this[_0x19435e(0x9c)]?.['sendMessage'](_0x57f0cc,_0x19435e(0x13b)+_0x353346[_0x19435e(0x90)][_0x19435e(0x8e)]+_0x19435e(0x8f)+'Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.',{'parse_mode':_0x19435e(0x94)});return;}const _0x26f13a=_0xa35454['split'](/\s+/);if(_0x26f13a[_0x19435e(0xfa)]!==0x2){await this[_0x19435e(0x9c)]?.[_0x19435e(0x8b)](_0x57f0cc,'❌\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a'+_0x19435e(0xc5)+_0x19435e(0x143)+_0x19435e(0x86)+(_0x19435e(0xff)+_0x26f13a[_0x19435e(0xfa)]+'\x20parts:\x20'+_0x26f13a[_0x19435e(0x13f)](_0x288d39=>'`'+_0x288d39+'`')[_0x19435e(0xe0)](',\x20')),{'parse_mode':_0x19435e(0x94)});return;}const [_0x1ffdfe,_0x2bfb73]=_0x26f13a;console['log'](_0x19435e(0x135)+_0x8f1d88+_0x19435e(0x117)+_0x1ffdfe+'\x22,\x20apiKey=\x22'+_0x2bfb73[_0x19435e(0x107)](0x0,0xa)+_0x19435e(0x14c)),await this[_0x19435e(0xa7)](_0x57f0cc,_0x8f1d88,_0x1ffdfe,_0x2bfb73);}catch(_0x28d831){console[_0x19435e(0x15d)](_0x19435e(0xde),_0x28d831),await this['bot']?.[_0x19435e(0x8b)](_0x57f0cc,_0x19435e(0x96));}}),this['bot']['on'](_0x171a0e(0x15d),_0x32543f=>{const _0x4af149=_0x171a0e;console[_0x4af149(0x15d)](_0x4af149(0xb8),_0x32543f);}),this[_0x171a0e(0x9c)]['on'](_0x171a0e(0xb1),_0x539d76=>{const _0x504754=_0x171a0e;console[_0x504754(0x15d)]('Telegram\x20bot\x20polling\x20error:',_0x539d76);});}async[a54_0x40e82e(0xa7)](_0x1dff42,_0x2b85ea,_0xbc95a4,_0x418238){const _0x35b1fd=a54_0x40e82e;try{console['log']('🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20'+_0x2b85ea+_0x35b1fd(0x117)+_0xbc95a4+_0x35b1fd(0x95)+_0x418238[_0x35b1fd(0x107)](0x0,0xa)+'...\x22');if(!_0xbc95a4||_0xbc95a4['length']<0x3||_0xbc95a4[_0x35b1fd(0xfa)]>0x32||!/^[a-zA-Z0-9_]+$/[_0x35b1fd(0xe3)](_0xbc95a4)){await this[_0x35b1fd(0x9c)]?.[_0x35b1fd(0x8b)](_0x1dff42,_0x35b1fd(0x8a)+_0xbc95a4+_0x35b1fd(0xdc)+_0x35b1fd(0x14a),{'parse_mode':_0x35b1fd(0x94)});return;}if(!_0x418238||!_0x418238['startsWith'](_0x35b1fd(0x12c))&&!_0x418238[_0x35b1fd(0xd0)](_0x35b1fd(0xa4))){await this[_0x35b1fd(0x9c)]?.[_0x35b1fd(0x8b)](_0x1dff42,_0x35b1fd(0xcd)+_0x35b1fd(0x12f),{'parse_mode':_0x35b1fd(0x94)});return;}const _0x58aa5c=await database_1[_0x35b1fd(0xe7)][_0x35b1fd(0x90)][_0x35b1fd(0x84)]({'where':{'username':_0xbc95a4},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x58aa5c){const _0x28841f=await database_1['default']['shop']['findMany']({'select':{'username':!![],'name':!![]},'take':0x5});let _0x2441ba=_0x35b1fd(0x110)+_0xbc95a4+_0x35b1fd(0xe9);_0x28841f['length']>0x0?(_0x2441ba+=_0x35b1fd(0xd9),_0x28841f[_0x35b1fd(0xf0)](_0x2ca5c2=>{const _0x540499=_0x35b1fd;_0x2441ba+=_0x540499(0x124)+_0x2ca5c2[_0x540499(0x108)]+'`\x20('+_0x2ca5c2[_0x540499(0x8e)]+')\x0a';}),_0x2441ba+=_0x35b1fd(0xa6)):_0x2441ba+=_0x35b1fd(0x14d);await this['bot']?.[_0x35b1fd(0x8b)](_0x1dff42,_0x2441ba,{'parse_mode':_0x35b1fd(0x94)});return;}if(_0x58aa5c[_0x35b1fd(0x141)]!==_0x35b1fd(0xd8)){await this[_0x35b1fd(0x9c)]?.[_0x35b1fd(0x8b)](_0x1dff42,_0x35b1fd(0x11c)+_0xbc95a4+'`\x20is\x20inactive.\x0a\x0a'+_0x35b1fd(0x9a),{'parse_mode':_0x35b1fd(0x94)});return;}if(_0x58aa5c['publicKey']!==_0x418238&&_0x58aa5c[_0x35b1fd(0x10a)]!==_0x418238){await this[_0x35b1fd(0x9c)]?.[_0x35b1fd(0x8b)](_0x1dff42,_0x35b1fd(0xfd)+_0xbc95a4+'`.\x0a\x0a'+_0x35b1fd(0xea)+_0x35b1fd(0x153),{'parse_mode':'Markdown'});return;}const _0x3d7cd4=await database_1[_0x35b1fd(0xe7)][_0x35b1fd(0x14b)][_0x35b1fd(0xf4)]({'where':{'shopId':_0x58aa5c['id'],'isVerified':!![],'telegramId':{'not':_0x2b85ea}}});if(_0x3d7cd4){await this[_0x35b1fd(0x9c)]?.[_0x35b1fd(0x8b)](_0x1dff42,_0x35b1fd(0x136)+_0xbc95a4+'`.\x0a\x0a'+_0x35b1fd(0x121),{'parse_mode':_0x35b1fd(0x94)});return;}await database_1[_0x35b1fd(0xe7)][_0x35b1fd(0x14b)][_0x35b1fd(0x13d)]({'where':{'telegramId':_0x2b85ea},'data':{'shopId':_0x58aa5c['id'],'isVerified':!![]}}),await this['bot']?.[_0x35b1fd(0x8b)](_0x1dff42,_0x35b1fd(0x15a)+_0x35b1fd(0xb3)+(_0x35b1fd(0xec)+_0x58aa5c['name']+'*\x0a')+(_0x35b1fd(0x81)+_0x58aa5c[_0x35b1fd(0x108)]+_0x35b1fd(0xdc))+'🔔\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a'+_0x35b1fd(0xc0)+'•\x20Payment\x20status\x20changes\x0a'+'•\x20Payouts\x0a'+'•\x20Important\x20events\x0a\x0a'+_0x35b1fd(0xf6)+'/status\x20-\x20check\x20connection\x20status\x0a'+_0x35b1fd(0x129),{'parse_mode':_0x35b1fd(0x94)}),console['log'](_0x35b1fd(0x11e)+_0x2b85ea+_0x35b1fd(0xd6)+_0x58aa5c['username']+_0x35b1fd(0x103));}catch(_0x555a8a){console[_0x35b1fd(0x15d)]('Error\x20in\x20handleSingleLineVerification:',_0x555a8a),await this[_0x35b1fd(0x9c)]?.[_0x35b1fd(0x8b)](_0x1dff42,_0x35b1fd(0x10f));}}async[a54_0x40e82e(0x111)](_0x260c49,_0x3136b7,_0x54f6a4){const _0x54039e=a54_0x40e82e;if(!this[_0x54039e(0x9c)]){console[_0x54039e(0xcb)]('Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification');return;}try{const _0x137e80=await database_1[_0x54039e(0xe7)][_0x54039e(0x14b)][_0x54039e(0x150)]({'where':{'shopId':_0x260c49,'isVerified':!![]}});if(_0x137e80['length']===0x0){console[_0x54039e(0x12a)](_0x54039e(0x15e)+_0x260c49);return;}const _0x4d9785=_0x137e80[_0x54039e(0x13f)](async _0x12c303=>{const _0x4e496d=_0x54039e;try{await this[_0x4e496d(0x9c)]?.['sendMessage'](_0x12c303[_0x4e496d(0x11f)],_0x3136b7,_0x54f6a4),console[_0x4e496d(0x12a)](_0x4e496d(0xbd)+_0x12c303[_0x4e496d(0x11f)]);}catch(_0x2a509b){console['error'](_0x4e496d(0xac)+_0x12c303[_0x4e496d(0x11f)]+':',_0x2a509b),_0x2a509b instanceof Error&&(_0x2a509b[_0x4e496d(0x113)][_0x4e496d(0xe8)]('blocked')||_0x2a509b['message'][_0x4e496d(0xe8)](_0x4e496d(0x9b))||_0x2a509b['message'][_0x4e496d(0xe8)](_0x4e496d(0xba)))&&(await database_1['default'][_0x4e496d(0x14b)][_0x4e496d(0x13d)]({'where':{'id':_0x12c303['id']},'data':{'isVerified':![]}}),console['log'](_0x4e496d(0x152)+_0x12c303[_0x4e496d(0x11f)]+_0x4e496d(0x159)));}});await Promise[_0x54039e(0x14f)](_0x4d9785);}catch(_0x2c2fad){console[_0x54039e(0x15d)](_0x54039e(0x93),_0x2c2fad);}}async[a54_0x40e82e(0x12d)](_0x513972,_0x26f2b8,_0x44fab9){const _0x32f398=a54_0x40e82e,_0xd559b2={'created':'🆕','paid':'✅','failed':'❌','expired':'⏰','refund':'🔄','chargeback':'⚠️','processing':'⚙️'},_0x54d0d7={'created':_0x32f398(0xfe),'paid':_0x32f398(0x91),'failed':_0x32f398(0x130),'expired':_0x32f398(0x97),'refund':_0x32f398(0x14e),'chargeback':'Payment\x20chargeback','processing':_0x32f398(0xc4)},_0x2197b1=_0xd559b2[_0x44fab9],_0x247efa=_0x54d0d7[_0x44fab9],_0x274ecd=(0x0,gateway_1[_0x32f398(0xd4)])(_0x26f2b8['gateway']);console[_0x32f398(0x12a)](_0x32f398(0x112)+_0x26f2b8[_0x32f398(0x158)]+_0x32f398(0xae)+_0x274ecd+'\x22');let _0x4987cb=_0x2197b1+'\x20*'+_0x247efa+'*\x0a\x0a'+(_0x32f398(0x114)+_0x26f2b8[_0x32f398(0x142)]+'\x20'+_0x26f2b8[_0x32f398(0x12b)]+'*\x0a')+(_0x32f398(0xf7)+(_0x26f2b8['orderId']||_0x26f2b8['id'])+'`\x0a')+(_0x32f398(0x15c)+_0x26f2b8['id']+'`\x0a')+(_0x32f398(0x13a)+_0x274ecd+'`\x0a')+(_0x32f398(0xad)+new Date(_0x26f2b8[_0x32f398(0x106)])[_0x32f398(0xf5)](_0x32f398(0x15b))+'\x0a');(_0x26f2b8[_0x32f398(0x149)]||_0x26f2b8['customerEmail'])&&(_0x4987cb+=_0x32f398(0xd3),_0x26f2b8['customerName']&&(_0x4987cb+=_0x32f398(0xa8)+_0x26f2b8[_0x32f398(0x149)]+'`\x0a'),_0x26f2b8[_0x32f398(0x145)]&&(_0x4987cb+=_0x32f398(0x128)+_0x26f2b8[_0x32f398(0x145)]+'`\x0a')),_0x44fab9===_0x32f398(0x8c)&&_0x26f2b8[_0x32f398(0xbb)]&&(_0x4987cb+=_0x32f398(0x126)+_0x26f2b8[_0x32f398(0xbb)]+_0x32f398(0xb7)),_0x44fab9==='processing'&&(_0x4987cb+=_0x32f398(0xe5)),_0x26f2b8[_0x32f398(0xbf)]&&(_0x4987cb+='📝\x20Notes:\x20'+_0x26f2b8[_0x32f398(0xbf)]+'\x0a'),await this['sendShopNotification'](_0x513972,_0x4987cb,{'parse_mode':'Markdown'});}async['sendPayoutNotification'](_0x1b4641,_0x26c862,_0x188d12){const _0x1fd52f=a54_0x40e82e,_0xd246ba={'created':'📤','completed':'✅','rejected':'❌'},_0x27e109={'created':_0x1fd52f(0xa2),'completed':_0x1fd52f(0x11d),'rejected':_0x1fd52f(0x144)},_0x39fea7=_0xd246ba[_0x188d12],_0x3c54a9=_0x27e109[_0x188d12],_0x3ff485=_0x39fea7+'\x20*'+_0x3c54a9+_0x1fd52f(0x100)+('💸\x20Amount:\x20*'+_0x26c862[_0x1fd52f(0x142)]+_0x1fd52f(0xe6))+('🏦\x20Method:\x20`'+_0x26c862[_0x1fd52f(0x155)]+'`\x0a')+('🆔\x20Payout\x20ID:\x20`'+_0x26c862['id']+'`\x0a')+(_0x1fd52f(0xad)+new Date(_0x26c862[_0x1fd52f(0x106)])[_0x1fd52f(0xf5)]('en-US')+'\x0a')+(_0x26c862[_0x1fd52f(0x85)]?'🔗\x20TXID:\x20`'+_0x26c862[_0x1fd52f(0x85)]+'`':'');await this[_0x1fd52f(0x111)](_0x1b4641,_0x3ff485,{'parse_mode':_0x1fd52f(0x94)});}async[a54_0x40e82e(0x118)](_0x45fcd5,_0x57eba5){const _0x270055=a54_0x40e82e;try{const _0x3f0c44=await database_1[_0x270055(0xe7)][_0x270055(0x132)][_0x270055(0x84)]({'where':{'shopId':_0x45fcd5},'select':{'notificationLogin':!![]}});if(!_0x3f0c44?.[_0x270055(0xb4)]){console[_0x270055(0x12a)]('📱\x20Login\x20notifications\x20disabled\x20for\x20shop\x20'+_0x45fcd5);return;}const _0x33dfc0=_0x57eba5['success']?'🔐':'🚨',_0x57ea85=_0x57eba5[_0x270055(0xee)]?_0x270055(0xda):_0x270055(0xcc);let _0x4258d6=_0x33dfc0+'\x20*'+_0x57ea85+'*\x0a\x0a'+('👤\x20Username:\x20`'+_0x57eba5[_0x270055(0x108)]+'`\x0a')+(_0x270055(0xc1)+_0x57eba5[_0x270055(0xf9)][_0x270055(0xf5)]('en-US')+'\x0a');_0x57eba5['ipAddress']&&(_0x4258d6+=_0x270055(0x13e)+_0x57eba5[_0x270055(0xa0)]+'`\x0a');if(_0x57eba5[_0x270055(0xe1)]){const _0x3e1847=_0x57eba5[_0x270055(0xe1)]['length']>0x32?_0x57eba5[_0x270055(0xe1)][_0x270055(0x107)](0x0,0x32)+_0x270055(0xc3):_0x57eba5[_0x270055(0xe1)];_0x4258d6+='💻\x20Browser:\x20`'+_0x3e1847+'`\x0a';}!_0x57eba5[_0x270055(0xee)]&&(_0x4258d6+='\x0a⚠️\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!'),await this[_0x270055(0x111)](_0x45fcd5,_0x4258d6,{'parse_mode':_0x270055(0x94)}),console['log'](_0x270055(0x146)+_0x45fcd5+':\x20'+(_0x57eba5['success']?_0x270055(0xee):'failed'));}catch(_0x28c967){console[_0x270055(0x15d)]('Failed\x20to\x20send\x20login\x20notification:',_0x28c967);}}async['sendApiErrorNotification'](_0x202328,_0x5874c9){const _0x4fda33=a54_0x40e82e;try{const _0x42300e=await database_1[_0x4fda33(0xe7)]['shopSettings'][_0x4fda33(0x84)]({'where':{'shopId':_0x202328},'select':{'notificationApiError':!![]}});if(!_0x42300e?.[_0x4fda33(0x131)]){console[_0x4fda33(0x12a)]('📱\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20'+_0x202328);return;}let _0x52b5fe='🚨\x20*API\x20Error*\x0a\x0a'+(_0x4fda33(0xb0)+_0x5874c9[_0x4fda33(0x155)]+'\x20'+_0x5874c9[_0x4fda33(0x98)]+'`\x0a')+('📅\x20Time:\x20'+_0x5874c9[_0x4fda33(0xf9)][_0x4fda33(0xf5)](_0x4fda33(0x15b))+'\x0a');_0x5874c9[_0x4fda33(0xf3)]&&(_0x52b5fe+=_0x4fda33(0x83)+_0x5874c9[_0x4fda33(0xf3)]+'`\x0a'),_0x52b5fe+='❌\x20Error:\x20`'+_0x5874c9[_0x4fda33(0xa1)]+'`\x0a',_0x5874c9[_0x4fda33(0xdf)]&&(_0x52b5fe+=_0x4fda33(0x10e)+_0x5874c9[_0x4fda33(0xdf)]+'`\x0a'),_0x52b5fe+=_0x4fda33(0xc2),await this[_0x4fda33(0x111)](_0x202328,_0x52b5fe,{'parse_mode':'Markdown'}),console['log'](_0x4fda33(0xa5)+_0x202328+':\x20'+_0x5874c9[_0x4fda33(0x98)]);}catch(_0x5dcb2c){console[_0x4fda33(0x15d)](_0x4fda33(0xd5),_0x5dcb2c);}}async[a54_0x40e82e(0xe2)](_0x33b081,_0x4550ef,_0x4930e2){const _0x49df24=a54_0x40e82e;let _0x16f4bf=_0x49df24(0x102)+_0x4550ef+'*\x0a\x0a';for(const [_0x3e2c10,_0x56e74a]of Object['entries'](_0x4930e2)){_0x56e74a!==null&&_0x56e74a!==undefined&&(_0x16f4bf+=_0x3e2c10+_0x49df24(0xed)+_0x56e74a+'`\x0a');}await this[_0x49df24(0x111)](_0x33b081,_0x16f4bf,{'parse_mode':_0x49df24(0x94)});}[a54_0x40e82e(0xd7)](){return{'isActive':!!this['bot'],'username':this['botUsername']};}[a54_0x40e82e(0x139)](){const _0x53539a=a54_0x40e82e;this[_0x53539a(0x9c)]&&(this[_0x53539a(0x9c)][_0x53539a(0xce)](),this[_0x53539a(0x9c)]=null,console[_0x53539a(0x12a)](_0x53539a(0xc6)));}}exports[a54_0x40e82e(0xa3)]=TelegramBotService,exports[a54_0x40e82e(0xf2)]=new TelegramBotService();