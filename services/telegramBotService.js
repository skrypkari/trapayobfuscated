'use strict';const a63_0x5f4543=a63_0x4d33;function a63_0x4d33(_0x47f0c4,_0x2761cd){const _0x392e30=a63_0x392e();return a63_0x4d33=function(_0x4d3309,_0x50bb31){_0x4d3309=_0x4d3309-0x1bd;let _0x51d5a1=_0x392e30[_0x4d3309];return _0x51d5a1;},a63_0x4d33(_0x47f0c4,_0x2761cd);}(function(_0xef3cad,_0x44ef9a){const _0xcd6dc0=a63_0x4d33,_0x525d83=_0xef3cad();while(!![]){try{const _0x20dd2c=-parseInt(_0xcd6dc0(0x23f))/0x1+parseInt(_0xcd6dc0(0x28b))/0x2+parseInt(_0xcd6dc0(0x286))/0x3+-parseInt(_0xcd6dc0(0x2a7))/0x4*(-parseInt(_0xcd6dc0(0x218))/0x5)+-parseInt(_0xcd6dc0(0x272))/0x6+parseInt(_0xcd6dc0(0x1ea))/0x7+-parseInt(_0xcd6dc0(0x278))/0x8*(parseInt(_0xcd6dc0(0x239))/0x9);if(_0x20dd2c===_0x44ef9a)break;else _0x525d83['push'](_0x525d83['shift']());}catch(_0x39fe97){_0x525d83['push'](_0x525d83['shift']());}}}(a63_0x392e,0x39e22));var __importDefault=this&&this[a63_0x5f4543(0x2b5)]||function(_0xe6a0d8){const _0x23b698=a63_0x5f4543;return _0xe6a0d8&&_0xe6a0d8[_0x23b698(0x283)]?_0xe6a0d8:{'default':_0xe6a0d8};};Object[a63_0x5f4543(0x229)](exports,a63_0x5f4543(0x283),{'value':!![]}),exports[a63_0x5f4543(0x28a)]=exports[a63_0x5f4543(0x237)]=void 0x0;const node_telegram_bot_api_1=__importDefault(require('node-telegram-bot-api')),database_1=__importDefault(require(a63_0x5f4543(0x248))),gateway_1=require(a63_0x5f4543(0x240));class TelegramBotService{constructor(){const _0x152758=a63_0x5f4543;this['bot']=null,this[_0x152758(0x1cc)]=process['env'][_0x152758(0x208)]||'',this[_0x152758(0x1d9)]=process[_0x152758(0x1f2)][_0x152758(0x221)]||_0x152758(0x289),this[_0x152758(0x1cc)]?this[_0x152758(0x25a)]():console['warn'](_0x152758(0x25c));}[a63_0x5f4543(0x25a)](){const _0x5f5970=a63_0x5f4543;try{this[_0x5f5970(0x257)]=new node_telegram_bot_api_1[(_0x5f5970(0x200))](this[_0x5f5970(0x1cc)],{'polling':!![]}),this[_0x5f5970(0x274)](),console[_0x5f5970(0x1db)](_0x5f5970(0x287)+this[_0x5f5970(0x1d9)]+_0x5f5970(0x22d));}catch(_0x997fb4){console[_0x5f5970(0x224)]('❌\x20Failed\x20to\x20initialize\x20Telegram\x20bot:',_0x997fb4);}}[a63_0x5f4543(0x274)](){const _0x5e898f=a63_0x5f4543;if(!this[_0x5e898f(0x257)])return;this['bot'][_0x5e898f(0x1c5)](/\/start/,async _0x15018c=>{const _0x57b27d=_0x5e898f,_0x5dfcc1=_0x15018c[_0x57b27d(0x1dd)]['id'],_0x19aeab=_0x15018c[_0x57b27d(0x246)]?.['id'][_0x57b27d(0x238)](),_0x1f276e=_0x15018c[_0x57b27d(0x246)]?.[_0x57b27d(0x2ab)],_0x307065=_0x15018c[_0x57b27d(0x246)]?.[_0x57b27d(0x29a)],_0x29e4d2=_0x15018c[_0x57b27d(0x246)]?.[_0x57b27d(0x293)];if(!_0x19aeab)return;try{let _0x134190=await database_1[_0x57b27d(0x200)]['telegramUser']['findUnique']({'where':{'telegramId':_0x19aeab},'include':{'shop':!![]}});!_0x134190?(_0x134190=await database_1[_0x57b27d(0x200)]['telegramUser'][_0x57b27d(0x1de)]({'data':{'telegramId':_0x19aeab,'username':_0x1f276e,'firstName':_0x307065,'lastName':_0x29e4d2,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console['log'](_0x57b27d(0x245)+_0x19aeab+_0x57b27d(0x1f5)+_0x1f276e+')')):_0x134190=await database_1['default'][_0x57b27d(0x294)][_0x57b27d(0x1e5)]({'where':{'telegramId':_0x19aeab},'data':{'username':_0x1f276e,'firstName':_0x307065,'lastName':_0x29e4d2},'include':{'shop':!![]}}),_0x134190[_0x57b27d(0x26b)]&&_0x134190['shopId']&&_0x134190[_0x57b27d(0x28c)]?await this[_0x57b27d(0x257)]?.[_0x57b27d(0x258)](_0x5dfcc1,_0x57b27d(0x27f)+(_0x57b27d(0x1bd)+_0x134190[_0x57b27d(0x28c)][_0x57b27d(0x22f)]+'*\x0a')+(_0x57b27d(0x25d)+_0x134190['shop'][_0x57b27d(0x2ab)]+'`\x0a\x0a')+_0x57b27d(0x212)+_0x57b27d(0x252)+_0x57b27d(0x21f)+_0x57b27d(0x243)+_0x57b27d(0x2a0)+_0x57b27d(0x251)+'/disconnect\x20-\x20disconnect\x20from\x20notifications',{'parse_mode':_0x57b27d(0x24a)}):(_0x134190[_0x57b27d(0x1fc)]&&!_0x134190[_0x57b27d(0x26b)]&&(await database_1[_0x57b27d(0x200)][_0x57b27d(0x294)][_0x57b27d(0x1e5)]({'where':{'telegramId':_0x19aeab},'data':{'shopId':null,'isVerified':![]}}),console[_0x57b27d(0x1db)]('🔄\x20Reset\x20incomplete\x20verification\x20for\x20user\x20'+_0x19aeab)),await this[_0x57b27d(0x257)]?.[_0x57b27d(0x258)](_0x5dfcc1,_0x57b27d(0x1c4)+_0x57b27d(0x1d0)+_0x57b27d(0x26d)+'Example:\x0a'+'`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a'+_0x57b27d(0x21c),{'parse_mode':'Markdown'}));}catch(_0x5dc128){console[_0x57b27d(0x224)](_0x57b27d(0x1c8),_0x5dc128),await this[_0x57b27d(0x257)]?.['sendMessage'](_0x5dfcc1,_0x57b27d(0x20c));}}),this['bot'][_0x5e898f(0x1c5)](/\/disconnect/,async _0x4d8f8c=>{const _0x38bcd8=_0x5e898f,_0x2e8fe8=_0x4d8f8c['chat']['id'],_0x3e8f43=_0x4d8f8c[_0x38bcd8(0x246)]?.['id'][_0x38bcd8(0x238)]();if(!_0x3e8f43)return;try{const _0x5d86b2=await database_1[_0x38bcd8(0x200)][_0x38bcd8(0x294)][_0x38bcd8(0x268)]({'where':{'telegramId':_0x3e8f43},'include':{'shop':!![]}});if(!_0x5d86b2||!_0x5d86b2['isVerified']||!_0x5d86b2['shopId']){await this[_0x38bcd8(0x257)]?.['sendMessage'](_0x2e8fe8,_0x38bcd8(0x27c));return;}const _0x7241e4=_0x5d86b2[_0x38bcd8(0x28c)]?.[_0x38bcd8(0x22f)]||_0x38bcd8(0x1d6);await database_1[_0x38bcd8(0x200)][_0x38bcd8(0x294)][_0x38bcd8(0x1e5)]({'where':{'telegramId':_0x3e8f43},'data':{'shopId':null,'isVerified':![]}}),console[_0x38bcd8(0x1db)]('🔌\x20User\x20'+_0x3e8f43+_0x38bcd8(0x284)+_0x5d86b2['shopId']),await this['bot']?.['sendMessage'](_0x2e8fe8,_0x38bcd8(0x2b1)+_0x7241e4+_0x38bcd8(0x29c)+_0x38bcd8(0x263),{'parse_mode':_0x38bcd8(0x24a)});}catch(_0xdeee65){console['error'](_0x38bcd8(0x1f4),_0xdeee65),await this[_0x38bcd8(0x257)]?.[_0x38bcd8(0x258)](_0x2e8fe8,_0x38bcd8(0x20c));}}),this[_0x5e898f(0x257)]['onText'](/\/status/,async _0x123913=>{const _0x5611a6=_0x5e898f,_0x46c9f5=_0x123913[_0x5611a6(0x1dd)]['id'],_0x26ec60=_0x123913['from']?.['id'][_0x5611a6(0x238)]();if(!_0x26ec60)return;try{const _0x75686a=await database_1[_0x5611a6(0x200)][_0x5611a6(0x294)][_0x5611a6(0x268)]({'where':{'telegramId':_0x26ec60},'include':{'shop':!![]}});if(!_0x75686a){await this['bot']?.[_0x5611a6(0x258)](_0x46c9f5,_0x5611a6(0x290)+'Use\x20/start\x20to\x20begin.');return;}if(!_0x75686a['isVerified']||!_0x75686a[_0x5611a6(0x1fc)]||!_0x75686a[_0x5611a6(0x28c)]){await this['bot']?.[_0x5611a6(0x258)](_0x46c9f5,_0x5611a6(0x1fe)+'Use\x20/start\x20to\x20connect.');return;}await this[_0x5611a6(0x257)]?.[_0x5611a6(0x258)](_0x46c9f5,_0x5611a6(0x281)+(_0x5611a6(0x201)+_0x75686a[_0x5611a6(0x28c)][_0x5611a6(0x22f)]+'*\x0a')+(_0x5611a6(0x210)+_0x75686a[_0x5611a6(0x28c)][_0x5611a6(0x2ab)]+'`\x0a')+(_0x5611a6(0x22e)+_0x75686a[_0x5611a6(0x2ad)][_0x5611a6(0x2b4)](_0x5611a6(0x261))+'\x0a\x0a')+_0x5611a6(0x22b)+'Commands:\x0a'+_0x5611a6(0x1f6),{'parse_mode':_0x5611a6(0x24a)});}catch(_0x322de6){console[_0x5611a6(0x224)](_0x5611a6(0x1dc),_0x322de6),await this[_0x5611a6(0x257)]?.[_0x5611a6(0x258)](_0x46c9f5,_0x5611a6(0x20c));}}),this[_0x5e898f(0x257)][_0x5e898f(0x1c5)](/\/debug/,async _0x562a73=>{const _0x27dceb=_0x5e898f,_0x2319b9=_0x562a73[_0x27dceb(0x1dd)]['id'],_0x327d2a=_0x562a73['from']?.['id'][_0x27dceb(0x238)]();if(!_0x327d2a)return;try{const _0x109a85=await database_1[_0x27dceb(0x200)]['shop'][_0x27dceb(0x285)]({'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![]},'take':0xa});let _0x349eba=_0x27dceb(0x1d5);_0x349eba+=_0x27dceb(0x249)+_0x327d2a+_0x27dceb(0x216),_0x349eba+=_0x27dceb(0x2af),_0x109a85[_0x27dceb(0x1e2)]((_0x5db965,_0xed27cb)=>{const _0x270d52=_0x27dceb;_0x349eba+=_0xed27cb+0x1+_0x270d52(0x2a8)+_0x5db965[_0x270d52(0x22f)]+'*\x0a',_0x349eba+=_0x270d52(0x236)+_0x5db965[_0x270d52(0x2ab)]+'`\x0a',_0x349eba+='\x20\x20\x20Status:\x20'+_0x5db965[_0x270d52(0x217)]+'\x0a',_0x349eba+=_0x270d52(0x277)+_0x5db965['publicKey'][_0x270d52(0x299)](0x0,0xf)+_0x270d52(0x2a4);}),await this[_0x27dceb(0x257)]?.[_0x27dceb(0x258)](_0x2319b9,_0x349eba,{'parse_mode':_0x27dceb(0x24a)});}catch(_0x177af2){console[_0x27dceb(0x224)](_0x27dceb(0x204),_0x177af2),await this[_0x27dceb(0x257)]?.[_0x27dceb(0x258)](_0x2319b9,_0x27dceb(0x29f));}}),this[_0x5e898f(0x257)]['on']('message',async _0x540476=>{const _0x272a43=_0x5e898f;if(_0x540476[_0x272a43(0x1ef)]?.[_0x272a43(0x262)]('/'))return;const _0x3bc2a6=_0x540476[_0x272a43(0x1dd)]['id'],_0x1a7e69=_0x540476[_0x272a43(0x246)]?.['id'][_0x272a43(0x238)](),_0x576c1d=_0x540476['text']?.[_0x272a43(0x256)]();if(!_0x1a7e69||!_0x576c1d)return;try{const _0xc9ecfe=await database_1['default'][_0x272a43(0x294)][_0x272a43(0x268)]({'where':{'telegramId':_0x1a7e69},'include':{'shop':!![]}});if(!_0xc9ecfe){await this[_0x272a43(0x257)]?.[_0x272a43(0x258)](_0x3bc2a6,_0x272a43(0x2a2));return;}if(_0xc9ecfe['isVerified']&&_0xc9ecfe['shopId']&&_0xc9ecfe[_0x272a43(0x28c)]){await this['bot']?.['sendMessage'](_0x3bc2a6,_0x272a43(0x2aa)+_0xc9ecfe[_0x272a43(0x28c)][_0x272a43(0x22f)]+_0x272a43(0x29c)+_0x272a43(0x298),{'parse_mode':_0x272a43(0x24a)});return;}const _0x2ec1b8=_0x576c1d[_0x272a43(0x1da)](/\s+/);if(_0x2ec1b8[_0x272a43(0x276)]!==0x2){await this[_0x272a43(0x257)]?.[_0x272a43(0x258)](_0x3bc2a6,_0x272a43(0x24f)+_0x272a43(0x26d)+'Example:\x0a'+'`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a'+(_0x272a43(0x215)+_0x2ec1b8[_0x272a43(0x276)]+_0x272a43(0x24c)+_0x2ec1b8[_0x272a43(0x2b6)](_0x507919=>'`'+_0x507919+'`')[_0x272a43(0x291)](',\x20')),{'parse_mode':_0x272a43(0x24a)});return;}const [_0x1e8489,_0x483ba2]=_0x2ec1b8;console['log'](_0x272a43(0x26a)+_0x1a7e69+_0x272a43(0x1fa)+_0x1e8489+_0x272a43(0x1e0)+_0x483ba2[_0x272a43(0x299)](0x0,0xa)+'...\x22'),await this[_0x272a43(0x234)](_0x3bc2a6,_0x1a7e69,_0x1e8489,_0x483ba2);}catch(_0x24f894){console[_0x272a43(0x224)](_0x272a43(0x1ed),_0x24f894),await this[_0x272a43(0x257)]?.['sendMessage'](_0x3bc2a6,_0x272a43(0x20c));}}),this[_0x5e898f(0x257)]['on'](_0x5e898f(0x224),_0x256804=>{const _0x2d35c7=_0x5e898f;console[_0x2d35c7(0x224)](_0x2d35c7(0x20f),_0x256804);}),this['bot']['on'](_0x5e898f(0x27b),_0x29e42e=>{const _0x1228b8=_0x5e898f;console[_0x1228b8(0x224)](_0x1228b8(0x23b),_0x29e42e);});}async['handleSingleLineVerification'](_0x57a91b,_0x46c05f,_0x512941,_0x1748ab){const _0x9c01fb=a63_0x5f4543;try{console[_0x9c01fb(0x1db)](_0x9c01fb(0x26a)+_0x46c05f+_0x9c01fb(0x1fa)+_0x512941+_0x9c01fb(0x1e0)+_0x1748ab[_0x9c01fb(0x299)](0x0,0xa)+_0x9c01fb(0x1cb));if(!_0x512941||_0x512941[_0x9c01fb(0x276)]<0x3||_0x512941[_0x9c01fb(0x276)]>0x32||!/^[a-zA-Z0-9_]+$/['test'](_0x512941)){await this[_0x9c01fb(0x257)]?.[_0x9c01fb(0x258)](_0x57a91b,_0x9c01fb(0x29e)+_0x512941+_0x9c01fb(0x216)+_0x9c01fb(0x23c),{'parse_mode':_0x9c01fb(0x24a)});return;}if(!_0x1748ab||!_0x1748ab[_0x9c01fb(0x262)]('pk_')&&!_0x1748ab[_0x9c01fb(0x262)](_0x9c01fb(0x265))){await this[_0x9c01fb(0x257)]?.[_0x9c01fb(0x258)](_0x57a91b,_0x9c01fb(0x2b2)+_0x9c01fb(0x21d),{'parse_mode':_0x9c01fb(0x24a)});return;}const _0x4a07a1=await database_1['default'][_0x9c01fb(0x28c)]['findUnique']({'where':{'username':_0x512941},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x4a07a1){const _0x228664=await database_1['default']['shop']['findMany']({'select':{'username':!![],'name':!![]},'take':0x5});let _0x596c2c=_0x9c01fb(0x1d2)+_0x512941+_0x9c01fb(0x1d8);_0x228664[_0x9c01fb(0x276)]>0x0?(_0x596c2c+=_0x9c01fb(0x20a),_0x228664['forEach'](_0x44f758=>{const _0x25fc2d=_0x9c01fb;_0x596c2c+=_0x25fc2d(0x297)+_0x44f758[_0x25fc2d(0x2ab)]+_0x25fc2d(0x206)+_0x44f758['name']+')\x0a';}),_0x596c2c+='\x0aCheck\x20spelling\x20and\x20try\x20again.'):_0x596c2c+=_0x9c01fb(0x1c3);await this[_0x9c01fb(0x257)]?.['sendMessage'](_0x57a91b,_0x596c2c,{'parse_mode':_0x9c01fb(0x24a)});return;}if(_0x4a07a1[_0x9c01fb(0x217)]!=='ACTIVE'){await this[_0x9c01fb(0x257)]?.[_0x9c01fb(0x258)](_0x57a91b,'❌\x20Shop\x20`'+_0x512941+_0x9c01fb(0x1f7)+_0x9c01fb(0x260),{'parse_mode':_0x9c01fb(0x24a)});return;}if(_0x4a07a1[_0x9c01fb(0x282)]!==_0x1748ab&&_0x4a07a1[_0x9c01fb(0x247)]!==_0x1748ab){await this[_0x9c01fb(0x257)]?.['sendMessage'](_0x57a91b,_0x9c01fb(0x203)+_0x512941+'`.\x0a\x0a'+_0x9c01fb(0x244)+'Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`',{'parse_mode':'Markdown'});return;}const _0x4ac00a=await database_1[_0x9c01fb(0x200)]['telegramUser']['findFirst']({'where':{'shopId':_0x4a07a1['id'],'isVerified':!![],'telegramId':{'not':_0x46c05f}}});if(_0x4ac00a){await this[_0x9c01fb(0x257)]?.['sendMessage'](_0x57a91b,_0x9c01fb(0x1bf)+_0x512941+'`.\x0a\x0a'+'Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.',{'parse_mode':_0x9c01fb(0x24a)});return;}await database_1[_0x9c01fb(0x200)][_0x9c01fb(0x294)][_0x9c01fb(0x1e5)]({'where':{'telegramId':_0x46c05f},'data':{'shopId':_0x4a07a1['id'],'isVerified':!![]}}),await this[_0x9c01fb(0x257)]?.['sendMessage'](_0x57a91b,'🎉\x20*Congratulations!*\x0a\x0a'+_0x9c01fb(0x1fd)+(_0x9c01fb(0x273)+_0x4a07a1['name']+'*\x0a')+(_0x9c01fb(0x210)+_0x4a07a1[_0x9c01fb(0x2ab)]+_0x9c01fb(0x216))+'🔔\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a'+_0x9c01fb(0x252)+'•\x20Payment\x20status\x20changes\x0a'+_0x9c01fb(0x232)+_0x9c01fb(0x1f9)+_0x9c01fb(0x2a0)+_0x9c01fb(0x251)+'/disconnect\x20-\x20disconnect\x20from\x20notifications',{'parse_mode':'Markdown'}),console['log'](_0x9c01fb(0x28d)+_0x46c05f+'\x20verified\x20for\x20shop\x20'+_0x4a07a1[_0x9c01fb(0x2ab)]+_0x9c01fb(0x2a5));}catch(_0x4c38b6){console['error']('Error\x20in\x20handleSingleLineVerification:',_0x4c38b6),await this[_0x9c01fb(0x257)]?.[_0x9c01fb(0x258)](_0x57a91b,_0x9c01fb(0x220));}}async[a63_0x5f4543(0x235)](_0xf22a1b,_0x38c88c,_0x57ac32){const _0x30ecc6=a63_0x5f4543;if(!this[_0x30ecc6(0x257)]){console[_0x30ecc6(0x1f0)]('Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification');return;}try{const _0xebf441=await database_1[_0x30ecc6(0x200)][_0x30ecc6(0x294)]['findMany']({'where':{'shopId':_0xf22a1b,'isVerified':!![]}});if(_0xebf441['length']===0x0){console['log'](_0x30ecc6(0x25b)+_0xf22a1b);return;}const _0x26b30d=_0xebf441[_0x30ecc6(0x2b6)](async _0x2e894f=>{const _0x49c42f=_0x30ecc6;try{await this[_0x49c42f(0x257)]?.[_0x49c42f(0x258)](_0x2e894f[_0x49c42f(0x1c2)],_0x38c88c,_0x57ac32),console['log'](_0x49c42f(0x227)+_0x2e894f[_0x49c42f(0x1c2)]);}catch(_0x3f5447){console[_0x49c42f(0x224)](_0x49c42f(0x27e)+_0x2e894f[_0x49c42f(0x1c2)]+':',_0x3f5447),_0x3f5447 instanceof Error&&(_0x3f5447['message'][_0x49c42f(0x288)](_0x49c42f(0x1d3))||_0x3f5447[_0x49c42f(0x2b3)][_0x49c42f(0x288)](_0x49c42f(0x20b))||_0x3f5447['message'][_0x49c42f(0x288)]('user\x20is\x20deactivated'))&&(await database_1['default']['telegramUser']['update']({'where':{'id':_0x2e894f['id']},'data':{'isVerified':![]}}),console[_0x49c42f(0x1db)](_0x49c42f(0x23a)+_0x2e894f[_0x49c42f(0x1c2)]+'\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure'));}});await Promise[_0x30ecc6(0x266)](_0x26b30d);}catch(_0x23a364){console[_0x30ecc6(0x224)]('Error\x20sending\x20shop\x20notification:',_0x23a364);}}async[a63_0x5f4543(0x1fb)](_0x44929a,_0x439e33,_0x1f3ffe){const _0x2e1258=a63_0x5f4543,_0x4465d2={'created':'🆕','paid':'✅','failed':'❌','expired':'⏰','refund':'🔄','chargeback':'⚠️','processing':'⚙️'},_0x3c1845={'created':_0x2e1258(0x20e),'paid':_0x2e1258(0x21a),'failed':'Payment\x20failed','expired':'Payment\x20expired','refund':'Payment\x20refund','chargeback':_0x2e1258(0x1e1),'processing':_0x2e1258(0x21b)},_0x29b041=_0x4465d2[_0x1f3ffe],_0x337f28=_0x3c1845[_0x1f3ffe],_0x481080=(0x0,gateway_1['getGatewayDisplayNameForTelegram'])(_0x439e33['gateway']);console['log'](_0x2e1258(0x1df)+_0x439e33[_0x2e1258(0x223)]+_0x2e1258(0x279)+_0x481080+'\x22');let _0x325665=_0x29b041+'\x20*'+_0x337f28+_0x2e1258(0x253)+('💰\x20Amount:\x20*'+_0x439e33[_0x2e1258(0x2b0)]+'\x20'+_0x439e33[_0x2e1258(0x1ce)]+'*\x0a')+(_0x2e1258(0x225)+(_0x439e33[_0x2e1258(0x26e)]||_0x439e33['id'])+'`\x0a')+('🆔\x20Payment\x20ID:\x20`'+_0x439e33['id']+'`\x0a')+('🏪\x20Gateway:\x20`'+_0x481080+'`\x0a')+('📅\x20Date:\x20'+new Date(_0x439e33[_0x2e1258(0x1ec)])[_0x2e1258(0x2a6)](_0x2e1258(0x261))+'\x0a');if(_0x439e33['customerName']||_0x439e33[_0x2e1258(0x1eb)]||_0x439e33[_0x2e1258(0x1e6)]||_0x439e33['customerIp']||_0x439e33[_0x2e1258(0x211)]){_0x325665+=_0x2e1258(0x28f);_0x439e33[_0x2e1258(0x22c)]&&(_0x325665+=_0x2e1258(0x1f8)+_0x439e33['customerName']+'`\x0a');_0x439e33[_0x2e1258(0x1eb)]&&(_0x325665+=_0x2e1258(0x242)+_0x439e33[_0x2e1258(0x1eb)]+'`\x0a');_0x439e33[_0x2e1258(0x1e6)]&&(_0x325665+='🏦\x20IBAN:\x20`'+_0x439e33[_0x2e1258(0x1e6)]+'`\x0a');_0x439e33[_0x2e1258(0x1ca)]&&(_0x325665+=_0x2e1258(0x1e3)+_0x439e33[_0x2e1258(0x1ca)]+'`\x0a');if(_0x439e33[_0x2e1258(0x211)]){const _0x40978c=_0x439e33['customerUa'][_0x2e1258(0x276)]>0x32?_0x439e33['customerUa'][_0x2e1258(0x299)](0x0,0x32)+_0x2e1258(0x231):_0x439e33['customerUa'];_0x325665+=_0x2e1258(0x222)+_0x40978c+'`\x0a';}}_0x1f3ffe===_0x2e1258(0x29d)&&_0x439e33['chargebackAmount']&&(_0x325665+=_0x2e1258(0x259)+_0x439e33[_0x2e1258(0x1be)]+_0x2e1258(0x1f1)),_0x1f3ffe===_0x2e1258(0x26f)&&(_0x325665+='⏳\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a'),_0x439e33[_0x2e1258(0x271)]&&(_0x325665+=_0x2e1258(0x209)+_0x439e33[_0x2e1258(0x271)]+'\x0a'),await this[_0x2e1258(0x235)](_0x44929a,_0x325665,{'parse_mode':_0x2e1258(0x24a)});}async['sendPayoutNotification'](_0x421c6a,_0x2fa44c,_0x5596f1){const _0x40e424=a63_0x5f4543,_0x54df66={'created':'📤','completed':'✅','rejected':'❌'},_0x501264={'created':_0x40e424(0x219),'completed':_0x40e424(0x25e),'rejected':_0x40e424(0x23e)},_0x4c4fe6=_0x54df66[_0x5596f1],_0x505153=_0x501264[_0x5596f1],_0x295aad=_0x4c4fe6+'\x20*'+_0x505153+_0x40e424(0x253)+(_0x40e424(0x1e9)+_0x2fa44c[_0x40e424(0x2b0)]+_0x40e424(0x1cf))+(_0x40e424(0x26c)+_0x2fa44c[_0x40e424(0x1f3)]+'`\x0a')+('🆔\x20Payout\x20ID:\x20`'+_0x2fa44c['id']+'`\x0a')+(_0x40e424(0x28e)+new Date(_0x2fa44c[_0x40e424(0x1ec)])[_0x40e424(0x2a6)](_0x40e424(0x261))+'\x0a')+(_0x2fa44c[_0x40e424(0x23d)]?_0x40e424(0x264)+_0x2fa44c[_0x40e424(0x23d)]+'`':'');await this[_0x40e424(0x235)](_0x421c6a,_0x295aad,{'parse_mode':_0x40e424(0x24a)});}async[a63_0x5f4543(0x2ae)](_0x43b741,_0x256c7c){const _0x3331de=a63_0x5f4543;try{const _0x4d3466=await database_1[_0x3331de(0x200)][_0x3331de(0x2ac)][_0x3331de(0x268)]({'where':{'shopId':_0x43b741},'select':{'notificationLogin':!![]}});if(!_0x4d3466?.['notificationLogin']){console[_0x3331de(0x1db)](_0x3331de(0x2a9)+_0x43b741);return;}const _0x5a3492=_0x256c7c[_0x3331de(0x25f)]?'🔐':'🚨',_0x12b3d4=_0x256c7c[_0x3331de(0x25f)]?_0x3331de(0x2a1):_0x3331de(0x205);let _0x2adc73=_0x5a3492+'\x20*'+_0x12b3d4+_0x3331de(0x253)+(_0x3331de(0x210)+_0x256c7c[_0x3331de(0x2ab)]+'`\x0a')+('📅\x20Time:\x20'+_0x256c7c['timestamp'][_0x3331de(0x2a6)](_0x3331de(0x261))+'\x0a');_0x256c7c[_0x3331de(0x1e8)]&&(_0x2adc73+=_0x3331de(0x213)+_0x256c7c['ipAddress']+'`\x0a');if(_0x256c7c[_0x3331de(0x24d)]){const _0x4d11e2=_0x256c7c[_0x3331de(0x24d)]['length']>0x32?_0x256c7c['userAgent'][_0x3331de(0x299)](0x0,0x32)+'...':_0x256c7c[_0x3331de(0x24d)];_0x2adc73+=_0x3331de(0x222)+_0x4d11e2+'`\x0a';}!_0x256c7c['success']&&(_0x2adc73+='\x0a⚠️\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!'),await this[_0x3331de(0x235)](_0x43b741,_0x2adc73,{'parse_mode':_0x3331de(0x24a)}),console[_0x3331de(0x1db)](_0x3331de(0x1ee)+_0x43b741+':\x20'+(_0x256c7c[_0x3331de(0x25f)]?'success':_0x3331de(0x27d)));}catch(_0x362aea){console[_0x3331de(0x224)](_0x3331de(0x1e7),_0x362aea);}}async['sendApiErrorNotification'](_0x5d7143,_0x59181f){const _0x14551c=a63_0x5f4543;try{const _0x3f2cd4=await database_1['default']['shopSettings']['findUnique']({'where':{'shopId':_0x5d7143},'select':{'notificationApiError':!![]}});if(!_0x3f2cd4?.[_0x14551c(0x226)]){console['log'](_0x14551c(0x296)+_0x5d7143);return;}let _0x774a34='🚨\x20*API\x20Error*\x0a\x0a'+('🔗\x20Endpoint:\x20`'+_0x59181f[_0x14551c(0x1f3)]+'\x20'+_0x59181f[_0x14551c(0x295)]+'`\x0a')+('📅\x20Time:\x20'+_0x59181f[_0x14551c(0x1d7)][_0x14551c(0x2a6)](_0x14551c(0x261))+'\x0a');_0x59181f[_0x14551c(0x1c9)]&&(_0x774a34+=_0x14551c(0x1e4)+_0x59181f[_0x14551c(0x1c9)]+'`\x0a'),_0x774a34+='❌\x20Error:\x20`'+_0x59181f[_0x14551c(0x1c7)]+'`\x0a',_0x59181f['requestId']&&(_0x774a34+=_0x14551c(0x255)+_0x59181f['requestId']+'`\x0a'),_0x774a34+=_0x14551c(0x1d4),await this[_0x14551c(0x235)](_0x5d7143,_0x774a34,{'parse_mode':_0x14551c(0x24a)}),console['log'](_0x14551c(0x228)+_0x5d7143+':\x20'+_0x59181f[_0x14551c(0x295)]);}catch(_0x2a64ce){console['error'](_0x14551c(0x2a3),_0x2a64ce);}}async[a63_0x5f4543(0x292)](_0x216e65,_0x379730,_0x5a3120){const _0x36630c=a63_0x5f4543;let _0x124ede=_0x36630c(0x22a)+_0x379730+'*\x0a\x0a';for(const [_0x497d7c,_0x3a3e93]of Object[_0x36630c(0x29b)](_0x5a3120)){_0x3a3e93!==null&&_0x3a3e93!==undefined&&(_0x124ede+=_0x497d7c+':\x20`'+_0x3a3e93+'`\x0a');}await this['sendShopNotification'](_0x216e65,_0x124ede,{'parse_mode':'Markdown'});}async[a63_0x5f4543(0x241)](_0x2bc0b5){const _0x15041e=a63_0x5f4543;try{console[_0x15041e(0x1db)](_0x15041e(0x1ff)+_0x2bc0b5['substring'](0x0,0x32)+_0x15041e(0x231));const _0x40430b=await database_1['default']['telegramUser'][_0x15041e(0x285)]({'select':{'telegramId':!![]}});if(_0x40430b[_0x15041e(0x276)]===0x0){console[_0x15041e(0x1db)](_0x15041e(0x1c0));return;}for(const _0x50df4a of _0x40430b){try{await this['bot']?.[_0x15041e(0x258)](_0x50df4a[_0x15041e(0x1c2)],_0x2bc0b5,{'parse_mode':_0x15041e(0x24a)});}catch(_0x196041){console[_0x15041e(0x224)](_0x15041e(0x24e)+_0x50df4a[_0x15041e(0x1c2)]+':',_0x196041);}}console[_0x15041e(0x1db)](_0x15041e(0x269)+_0x40430b[_0x15041e(0x276)]+_0x15041e(0x254));}catch(_0x268cb5){console['error'](_0x15041e(0x1cd),_0x268cb5);}}[a63_0x5f4543(0x1d1)](){const _0x431e2f=a63_0x5f4543;return{'isActive':!!this[_0x431e2f(0x257)],'username':this[_0x431e2f(0x1d9)]};}async['sendShopFile'](_0x521126,_0x4f726a,_0x3b8785,_0x45cf03){const _0x32e069=a63_0x5f4543;try{if(!this[_0x32e069(0x257)])return console[_0x32e069(0x224)](_0x32e069(0x20d)),![];const _0x345223=await database_1[_0x32e069(0x200)][_0x32e069(0x294)][_0x32e069(0x285)]({'where':{'shopId':_0x521126,'isVerified':!![]},'select':{'telegramId':!![]}});if(_0x345223['length']===0x0)return console[_0x32e069(0x224)]('❌\x20No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20ID:\x20'+_0x521126),![];let _0x4e5051=0x0;for(const _0x2d7443 of _0x345223){try{await this[_0x32e069(0x257)][_0x32e069(0x250)](_0x2d7443[_0x32e069(0x1c2)],_0x4f726a,{},{'filename':_0x3b8785,'contentType':_0x3b8785[_0x32e069(0x267)](_0x32e069(0x275))?_0x32e069(0x270):_0x3b8785[_0x32e069(0x267)]('.jpg')||_0x3b8785['endsWith'](_0x32e069(0x1c6))?_0x32e069(0x2b7):_0x3b8785['endsWith'](_0x32e069(0x230))?'application/pdf':_0x32e069(0x1c1)}),_0x45cf03&&await this[_0x32e069(0x257)]['sendMessage'](_0x2d7443['telegramId'],_0x45cf03),_0x4e5051++;}catch(_0x47df98){console[_0x32e069(0x224)]('❌\x20Error\x20sending\x20file\x20to\x20user\x20'+_0x2d7443[_0x32e069(0x1c2)]+':',_0x47df98);}}return console['log'](_0x32e069(0x233)+_0x4e5051+'/'+_0x345223[_0x32e069(0x276)]+_0x32e069(0x21e)+_0x521126+':\x20'+_0x3b8785),_0x4e5051>0x0;}catch(_0x1de584){return console[_0x32e069(0x224)]('❌\x20Error\x20sending\x20file\x20to\x20shop:',_0x1de584),![];}}async[a63_0x5f4543(0x27a)](_0xd54c0b,_0x393fc3){const _0x11b30f=a63_0x5f4543;try{if(!this[_0x11b30f(0x257)])return console['error'](_0x11b30f(0x20d)),![];return await this['bot'][_0x11b30f(0x258)](_0xd54c0b,_0x393fc3),console['log'](_0x11b30f(0x24b)+_0xd54c0b),!![];}catch(_0xb8c760){return console[_0x11b30f(0x224)](_0x11b30f(0x214),_0xb8c760),![];}}async[a63_0x5f4543(0x207)](_0x4bbfb7,_0x591aa1,_0x3a132b,_0x4c45f1){const _0x5e9aac=a63_0x5f4543;try{if(!this['bot'])return console['error']('❌\x20Telegram\x20bot\x20not\x20initialized'),![];return await this[_0x5e9aac(0x257)]['sendDocument'](_0x4bbfb7,_0x591aa1,{},{'filename':_0x3a132b,'contentType':_0x3a132b['endsWith'](_0x5e9aac(0x275))?_0x5e9aac(0x270):_0x3a132b['endsWith']('.jpg')||_0x3a132b[_0x5e9aac(0x267)](_0x5e9aac(0x1c6))?_0x5e9aac(0x2b7):_0x3a132b[_0x5e9aac(0x267)](_0x5e9aac(0x230))?'application/pdf':_0x5e9aac(0x1c1)}),_0x4c45f1&&await this['bot'][_0x5e9aac(0x258)](_0x4bbfb7,_0x4c45f1),console[_0x5e9aac(0x1db)](_0x5e9aac(0x280)+_0x4bbfb7+':\x20'+_0x3a132b),!![];}catch(_0x452735){return console[_0x5e9aac(0x224)]('❌\x20Error\x20sending\x20file\x20to\x20chat:',_0x452735),![];}}['stopBot'](){const _0x58e170=a63_0x5f4543;this[_0x58e170(0x257)]&&(this[_0x58e170(0x257)][_0x58e170(0x202)](),this['bot']=null,console[_0x58e170(0x1db)]('🛑\x20Telegram\x20bot\x20stopped'));}}function a63_0x392e(){const _0x43d23a=['175941bbRHok','User\x20','Telegram\x20bot\x20polling\x20error:','Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).','txid','Payout\x20rejected','440421OWZUFu','../types/gateway','sendNotificationToAll','📧\x20Email:\x20`','•\x20Payouts\x0a\x0a','Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a','📱\x20Created\x20new\x20Telegram\x20user:\x20','from','secretKey','../config/database','📱\x20Your\x20Telegram\x20ID:\x20`','Markdown','✅\x20Direct\x20message\x20sent\x20to\x20chat\x20','\x20parts:\x20','userAgent','❌\x20Failed\x20to\x20send\x20message\x20to\x20user\x20','❌\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a','sendDocument','/status\x20-\x20check\x20connection\x20status\x0a','•\x20New\x20payments\x0a','*\x0a\x0a','\x20users','🆔\x20Request\x20ID:\x20`','trim','bot','sendMessage','💸\x20Penalty\x20amount:\x20*','initializeBot','No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20','TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables','Username:\x20`','Payout\x20completed','success','Contact\x20administrator.','en-US','startsWith','To\x20reconnect,\x20use\x20the\x20/start\x20command','🔗\x20TXID:\x20`','sk_','allSettled','endsWith','findUnique','📱\x20Notification\x20sent\x20to\x20','🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20','isVerified','🏦\x20Method:\x20`','📝\x20Format:\x20`username\x20api_key`\x0a\x0a','orderId','processing','image/png','adminNotes','2437176HckKXd','📱\x20Shop:\x20*','setupBotHandlers','.png','length','\x20\x20\x20Public\x20Key:\x20`','56MkrHHE','\x22\x20->\x20display\x20\x22','sendDirectMessage','polling_error','❌\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.','failed','❌\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20','✅\x20Welcome\x20back!\x0a\x0a','✅\x20File\x20sent\x20to\x20chat\x20','📊\x20*Connection\x20Status*\x0a\x0a','publicKey','__esModule','\x20disconnected\x20from\x20shop\x20','findMany','850803oKfWfX','✅\x20Telegram\x20bot\x20@','includes','trapay_bot','telegramBotService','550302ESxjpr','shop','✅\x20Telegram\x20user\x20','📅\x20Date:\x20','\x0a👤\x20*Customer\x20Information:*\x0a','❌\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a','join','sendCustomNotification','last_name','telegramUser','endpoint','📱\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20','•\x20`','Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.','substring','first_name','entries','*.\x0a\x0a','chargeback','❌\x20Invalid\x20username\x20format:\x20`','❌\x20Error\x20getting\x20debug\x20information.','Commands:\x0a','Successful\x20login','❌\x20Please\x20use\x20/start\x20command\x20first','Failed\x20to\x20send\x20API\x20error\x20notification:','...`\x0a\x0a','\x20via\x20single-line\x20input','toLocaleString','4kevuEd','.\x20*','📱\x20Login\x20notifications\x20disabled\x20for\x20shop\x20','✅\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*','username','shopSettings','updatedAt','sendLoginNotification','🏪\x20Available\x20shops\x20in\x20system:\x0a','amount','✅\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*','❌\x20Invalid\x20API\x20key\x20format.\x0a\x0a','message','toLocaleDateString','__importDefault','map','image/jpeg','You\x20are\x20already\x20connected\x20to\x20shop:\x20*','chargebackAmount','❌\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`','📱\x20No\x20active\x20Telegram\x20users\x20found','application/octet-stream','telegramId','Check\x20spelling\x20and\x20try\x20again.','🤖\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a','onText','.jpeg','errorMessage','Error\x20handling\x20/start\x20command:','statusCode','customerIp','...\x22','botToken','❌\x20Failed\x20to\x20send\x20notification\x20to\x20all\x20users:','currency','\x20USD*\x0a','To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a','getBotInfo','❌\x20Shop\x20with\x20username\x20`','blocked','\x0a💡\x20Check\x20your\x20request\x20or\x20contact\x20support.','🔍\x20*Debug\x20Information*\x0a\x0a','unknown\x20shop','timestamp','`\x20not\x20found.\x0a\x0a','botUsername','split','log','Error\x20handling\x20/status\x20command:','chat','create','📱\x20Telegram\x20notification:\x20gateway\x20\x22','\x22,\x20apiKey=\x22','Payment\x20chargeback','forEach','🌐\x20IP:\x20`','📊\x20Error\x20code:\x20`','update','remitterIban','Failed\x20to\x20send\x20login\x20notification:','ipAddress','💸\x20Amount:\x20*','3228155UUMEdW','customerEmail','createdAt','Error\x20handling\x20message:','✅\x20Login\x20notification\x20sent\x20for\x20shop\x20','text','warn','\x20USDT*\x0a','env','method','Error\x20handling\x20/disconnect\x20command:','\x20(@','/disconnect\x20-\x20disconnect\x20from\x20notifications','`\x20is\x20inactive.\x0a\x0a','📛\x20Name:\x20`','•\x20Important\x20events\x0a\x0a',':\x20username=\x22','sendPaymentNotification','shopId','✅\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a','❌\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a','📱\x20Sending\x20notification\x20to\x20all\x20connected\x20users:\x20','default','✅\x20Connected\x20to\x20shop:\x20*','stopPolling','❌\x20API\x20key\x20does\x20not\x20match\x20shop\x20`','Error\x20handling\x20/debug\x20command:','Failed\x20login\x20attempt','`\x20(','sendDirectFile','TELEGRAM_BOT_TOKEN','📝\x20Notes:\x20','Available\x20usernames:\x0a','chat\x20not\x20found','❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','❌\x20Telegram\x20bot\x20not\x20initialized','New\x20payment\x20created','Telegram\x20bot\x20error:','👤\x20Username:\x20`','customerUa','🔔\x20You\x20receive\x20notifications\x20about:\x0a','🌐\x20IP\x20address:\x20`','❌\x20Error\x20sending\x20direct\x20message:','You\x20sent\x20','`\x0a\x0a','status','1003165EZQkmU','New\x20payout\x20created','Payment\x20successfully\x20paid','Payment\x20is\x20being\x20processed','❗️\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!','API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','\x20users\x20of\x20shop\x20','•\x20Payment\x20status\x20changes\x0a','❌\x20An\x20error\x20occurred\x20while\x20verifying\x20data.','TELEGRAM_BOT_USERNAME','💻\x20Browser:\x20`','gateway','error','📝\x20Order\x20ID:\x20`','notificationApiError','✅\x20Notification\x20sent\x20to\x20Telegram\x20user\x20','✅\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20','defineProperty','🔔\x20*','🔔\x20Notifications\x20are\x20active\x0a\x0a','customerName','\x20initialized\x20successfully','📅\x20Connection\x20date:\x20','name','.pdf','...','•\x20Payouts\x0a','✅\x20File\x20sent\x20to\x20','handleSingleLineVerification','sendShopNotification','\x20\x20\x20Username:\x20`','TelegramBotService','toString'];a63_0x392e=function(){return _0x43d23a;};return a63_0x392e();}exports[a63_0x5f4543(0x237)]=TelegramBotService,exports['telegramBotService']=new TelegramBotService();