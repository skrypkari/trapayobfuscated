'use strict';const a54_0xe7c208=a54_0x1970;(function(_0x3155fb,_0x48e103){const _0x3ec476=a54_0x1970,_0x35fcfa=_0x3155fb();while(!![]){try{const _0x3da551=-parseInt(_0x3ec476(0x1f1))/0x1*(-parseInt(_0x3ec476(0x208))/0x2)+parseInt(_0x3ec476(0x189))/0x3+-parseInt(_0x3ec476(0x1dc))/0x4+parseInt(_0x3ec476(0x167))/0x5*(-parseInt(_0x3ec476(0x19a))/0x6)+parseInt(_0x3ec476(0x1cc))/0x7+-parseInt(_0x3ec476(0x1fe))/0x8*(-parseInt(_0x3ec476(0x16b))/0x9)+-parseInt(_0x3ec476(0x224))/0xa*(-parseInt(_0x3ec476(0x1b4))/0xb);if(_0x3da551===_0x48e103)break;else _0x35fcfa['push'](_0x35fcfa['shift']());}catch(_0x7636d4){_0x35fcfa['push'](_0x35fcfa['shift']());}}}(a54_0x1c64,0xbda0c));function a54_0x1c64(){const _0x4f0a78=['✅\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a','💸\x20Penalty\x20amount:\x20*','7232WHkhBB','`.\x0a\x0a','notificationApiError','...\x22','findFirst','💰\x20Amount:\x20*','unknown\x20shop','shopId','User\x20','method','513142DyNneh','\x0a⚠️\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!','publicKey','gateway','✅\x20Notification\x20sent\x20to\x20Telegram\x20user\x20','Example:\x0a','❌\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20','`\x20is\x20inactive.\x0a\x0a','📱\x20Shop:\x20*','🔗\x20Endpoint:\x20`','🌐\x20IP\x20address:\x20`','setupBotHandlers',':\x20username=\x22','Error\x20sending\x20shop\x20notification:','Use\x20/start\x20to\x20connect.','\x20verified\x20for\x20shop\x20','\x20disconnected\x20from\x20shop\x20','/disconnect\x20-\x20disconnect\x20from\x20notifications','❌\x20API\x20key\x20does\x20not\x20match\x20shop\x20`','stopBot','sendPayoutNotification','processing','botToken','createdAt','split','customerName','✅\x20Welcome\x20back!\x0a\x0a','toString','30nogDDM','pk_','🆔\x20Request\x20ID:\x20`','toLocaleDateString','Available\x20usernames:\x0a','❌\x20Error:\x20`','💻\x20Browser:\x20`','❌\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.','📝\x20Notes:\x20','🆔\x20Payout\x20ID:\x20`','...','message','🔔\x20*','polling_error','default','findMany','\x20initialized\x20successfully','TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables','Payout\x20rejected','text','🎉\x20*Congratulations!*\x0a\x0a','chat','first_name','ACTIVE','length','`\x20(','Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a','📅\x20Connection\x20date:\x20','log','🏦\x20IBAN:\x20`','substring','Payment\x20expired','TelegramBotService','timestamp','customerIp','95aHqoln','✅\x20Telegram\x20user\x20','You\x20are\x20already\x20connected\x20to\x20shop:\x20*','notificationLogin','423XFuocd','✅\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*','✅\x20Telegram\x20bot\x20@','Markdown','../types/gateway','chargebackAmount','To\x20reconnect,\x20use\x20the\x20/start\x20command','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','💸\x20Amount:\x20*','🌐\x20IP:\x20`','•\x20New\x20payments\x0a','success','from','📅\x20Date:\x20','Payment\x20refund','join','ipAddress','\x22,\x20apiKey=\x22','remitterIban','✅\x20Connected\x20to\x20shop:\x20*','\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure','📧\x20Email:\x20`','orderId','🔍\x20*Debug\x20Information*\x0a\x0a','sendShopNotification','isVerified','startsWith','New\x20payment\x20created','🏦\x20Method:\x20`','Failed\x20to\x20send\x20API\x20error\x20notification:','2580072HFRNzP','customerUa','telegramUser','name','endpoint','❌\x20Shop\x20`','customerEmail','👤\x20Username:\x20`','✅\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20','Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).','New\x20payout\x20created','Error\x20handling\x20/start\x20command:','•\x20Important\x20events\x0a\x0a',':\x20`','stopPolling','node-telegram-bot-api','❌\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a','50238plHODY','❌\x20Invalid\x20API\x20key\x20format.\x0a\x0a','shop','allSettled','Telegram\x20bot\x20error:','🏪\x20Available\x20shops\x20in\x20system:\x0a','\x20\x20\x20Public\x20Key:\x20`','amount','trapay_bot','Payment\x20failed','test','Use\x20/start\x20to\x20begin.','`\x0a\x0a','❌\x20Shop\x20with\x20username\x20`','✅\x20Login\x20notification\x20sent\x20for\x20shop\x20','🔔\x20Notifications\x20are\x20active\x0a\x0a','🔄\x20Reset\x20incomplete\x20verification\x20for\x20user\x20','\x0a💡\x20Check\x20your\x20request\x20or\x20contact\x20support.','📅\x20Time:\x20','__importDefault','🔌\x20User\x20','📱\x20Created\x20new\x20Telegram\x20user:\x20','adminNotes','/status\x20-\x20check\x20connection\x20status\x0a','\x0aCheck\x20spelling\x20and\x20try\x20again.','\x20via\x20single-line\x20input','804727UDvvJC','chargeback','Error\x20handling\x20/disconnect\x20command:','Payment\x20chargeback','❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','__esModule','\x0a👤\x20*Customer\x20Information:*\x0a','🆔\x20Payment\x20ID:\x20`','📝\x20Format:\x20`username\x20api_key`\x0a\x0a','📝\x20Order\x20ID:\x20`','Error\x20handling\x20message:','•\x20Payouts\x0a\x0a','update','🏪\x20Gateway:\x20`','en-US','*.\x0a\x0a','getGatewayDisplayNameForTelegram','*\x0a\x0a','sendMessage','toLocaleString','requestId','Username:\x20`','•\x20`','findUnique','4886763ZJJvGa','userAgent','Failed\x20login\x20attempt','shopSettings','error','sendApiErrorNotification','❌\x20Failed\x20to\x20initialize\x20Telegram\x20bot:','Check\x20spelling\x20and\x20try\x20again.','Telegram\x20bot\x20polling\x20error:','🔔\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a','❌\x20Error\x20getting\x20debug\x20information.','...`\x0a\x0a','env','📱\x20Your\x20Telegram\x20ID:\x20`','statusCode','❗️\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!','4563440DuJNBi','Commands:\x0a','defineProperty','•\x20Payment\x20status\x20changes\x0a','📱\x20Login\x20notifications\x20disabled\x20for\x20shop\x20','botUsername','\x20USDT*\x0a','telegramId','map','failed','bot','initializeBot','Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`','❌\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a','txid','username','updatedAt','telegramBotService','\x20parts:\x20','secretKey','To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a','1GfHmAo','Failed\x20to\x20send\x20login\x20notification:','sendLoginNotification','\x20\x20\x20Username:\x20`','❌\x20Please\x20use\x20/start\x20command\x20first','Payout\x20completed','warn','onText','handleSingleLineVerification','errorMessage','❌\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a'];a54_0x1c64=function(){return _0x4f0a78;};return a54_0x1c64();}function a54_0x1970(_0x15c961,_0x24ac6e){const _0x1c644c=a54_0x1c64();return a54_0x1970=function(_0x1970d7,_0x43896e){_0x1970d7=_0x1970d7-0x146;let _0x385d1d=_0x1c644c[_0x1970d7];return _0x385d1d;},a54_0x1970(_0x15c961,_0x24ac6e);}var __importDefault=this&&this[a54_0xe7c208(0x1ad)]||function(_0x778ff6){const _0x1a303d=a54_0xe7c208;return _0x778ff6&&_0x778ff6[_0x1a303d(0x1b9)]?_0x778ff6:{'default':_0x778ff6};};Object[a54_0xe7c208(0x1de)](exports,a54_0xe7c208(0x1b9),{'value':!![]}),exports[a54_0xe7c208(0x1ed)]=exports[a54_0xe7c208(0x164)]=void 0x0;const node_telegram_bot_api_1=__importDefault(require(a54_0xe7c208(0x198))),database_1=__importDefault(require('../config/database')),gateway_1=require(a54_0xe7c208(0x16f));class TelegramBotService{constructor(){const _0x4a38f9=a54_0xe7c208;this[_0x4a38f9(0x1e6)]=null,this[_0x4a38f9(0x21e)]=process[_0x4a38f9(0x1d8)]['TELEGRAM_BOT_TOKEN']||'',this[_0x4a38f9(0x1e1)]=process[_0x4a38f9(0x1d8)]['TELEGRAM_BOT_USERNAME']||_0x4a38f9(0x1a2),this['botToken']?this[_0x4a38f9(0x1e7)]():console[_0x4a38f9(0x1f7)](_0x4a38f9(0x155));}[a54_0xe7c208(0x1e7)](){const _0x4cbed8=a54_0xe7c208;try{this[_0x4cbed8(0x1e6)]=new node_telegram_bot_api_1['default'](this[_0x4cbed8(0x21e)],{'polling':!![]}),this['setupBotHandlers'](),console[_0x4cbed8(0x160)](_0x4cbed8(0x16d)+this[_0x4cbed8(0x1e1)]+_0x4cbed8(0x154));}catch(_0x594493){console['error'](_0x4cbed8(0x1d2),_0x594493);}}[a54_0xe7c208(0x213)](){const _0x3ae1c2=a54_0xe7c208;if(!this[_0x3ae1c2(0x1e6)])return;this[_0x3ae1c2(0x1e6)][_0x3ae1c2(0x1f8)](/\/start/,async _0x30b065=>{const _0x5944aa=_0x3ae1c2,_0x5b9954=_0x30b065[_0x5944aa(0x159)]['id'],_0x342888=_0x30b065[_0x5944aa(0x177)]?.['id'][_0x5944aa(0x223)](),_0x2866a3=_0x30b065[_0x5944aa(0x177)]?.['username'],_0x2a3d2e=_0x30b065[_0x5944aa(0x177)]?.[_0x5944aa(0x15a)],_0x398c80=_0x30b065['from']?.['last_name'];if(!_0x342888)return;try{let _0xc537da=await database_1[_0x5944aa(0x152)]['telegramUser']['findUnique']({'where':{'telegramId':_0x342888},'include':{'shop':!![]}});!_0xc537da?(_0xc537da=await database_1[_0x5944aa(0x152)]['telegramUser']['create']({'data':{'telegramId':_0x342888,'username':_0x2866a3,'firstName':_0x2a3d2e,'lastName':_0x398c80,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console['log'](_0x5944aa(0x1af)+_0x342888+'\x20(@'+_0x2866a3+')')):_0xc537da=await database_1['default'][_0x5944aa(0x18b)][_0x5944aa(0x1c0)]({'where':{'telegramId':_0x342888},'data':{'username':_0x2866a3,'firstName':_0x2a3d2e,'lastName':_0x398c80},'include':{'shop':!![]}}),_0xc537da[_0x5944aa(0x184)]&&_0xc537da['shopId']&&_0xc537da[_0x5944aa(0x19c)]?await this[_0x5944aa(0x1e6)]?.[_0x5944aa(0x1c6)](_0x5b9954,_0x5944aa(0x222)+(_0x5944aa(0x169)+_0xc537da['shop'][_0x5944aa(0x18c)]+'*\x0a')+(_0x5944aa(0x1c9)+_0xc537da[_0x5944aa(0x19c)][_0x5944aa(0x1eb)]+_0x5944aa(0x1a6))+'🔔\x20You\x20receive\x20notifications\x20about:\x0a'+_0x5944aa(0x175)+_0x5944aa(0x1df)+_0x5944aa(0x1bf)+_0x5944aa(0x1dd)+_0x5944aa(0x1b1)+'/disconnect\x20-\x20disconnect\x20from\x20notifications',{'parse_mode':_0x5944aa(0x16e)}):(_0xc537da[_0x5944aa(0x205)]&&!_0xc537da[_0x5944aa(0x184)]&&(await database_1[_0x5944aa(0x152)][_0x5944aa(0x18b)][_0x5944aa(0x1c0)]({'where':{'telegramId':_0x342888},'data':{'shopId':null,'isVerified':![]}}),console['log'](_0x5944aa(0x1aa)+_0x342888)),await this[_0x5944aa(0x1e6)]?.[_0x5944aa(0x1c6)](_0x5b9954,'🤖\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a'+_0x5944aa(0x1f0)+_0x5944aa(0x1bc)+_0x5944aa(0x20d)+_0x5944aa(0x172)+_0x5944aa(0x1db),{'parse_mode':_0x5944aa(0x16e)}));}catch(_0x4cd30b){console[_0x5944aa(0x1d0)](_0x5944aa(0x194),_0x4cd30b),await this['bot']?.[_0x5944aa(0x1c6)](_0x5b9954,'❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this[_0x3ae1c2(0x1e6)][_0x3ae1c2(0x1f8)](/\/disconnect/,async _0x6a6ad0=>{const _0x397a91=_0x3ae1c2,_0x18299f=_0x6a6ad0['chat']['id'],_0x26cb2d=_0x6a6ad0[_0x397a91(0x177)]?.['id'][_0x397a91(0x223)]();if(!_0x26cb2d)return;try{const _0x38bc06=await database_1[_0x397a91(0x152)][_0x397a91(0x18b)][_0x397a91(0x1cb)]({'where':{'telegramId':_0x26cb2d},'include':{'shop':!![]}});if(!_0x38bc06||!_0x38bc06[_0x397a91(0x184)]||!_0x38bc06[_0x397a91(0x205)]){await this[_0x397a91(0x1e6)]?.['sendMessage'](_0x18299f,_0x397a91(0x14b));return;}const _0x160e3b=_0x38bc06[_0x397a91(0x19c)]?.[_0x397a91(0x18c)]||_0x397a91(0x204);await database_1[_0x397a91(0x152)]['telegramUser']['update']({'where':{'telegramId':_0x26cb2d},'data':{'shopId':null,'isVerified':![]}}),console[_0x397a91(0x160)](_0x397a91(0x1ae)+_0x26cb2d+_0x397a91(0x218)+_0x38bc06['shopId']),await this[_0x397a91(0x1e6)]?.['sendMessage'](_0x18299f,_0x397a91(0x16c)+_0x160e3b+'*.\x0a\x0a'+_0x397a91(0x171),{'parse_mode':'Markdown'});}catch(_0x3cbddb){console[_0x397a91(0x1d0)](_0x397a91(0x1b6),_0x3cbddb),await this[_0x397a91(0x1e6)]?.[_0x397a91(0x1c6)](_0x18299f,'❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this[_0x3ae1c2(0x1e6)][_0x3ae1c2(0x1f8)](/\/status/,async _0x1c3d4c=>{const _0x2c8617=_0x3ae1c2,_0x375e9a=_0x1c3d4c[_0x2c8617(0x159)]['id'],_0x14e4d8=_0x1c3d4c[_0x2c8617(0x177)]?.['id'][_0x2c8617(0x223)]();if(!_0x14e4d8)return;try{const _0x1d7ca9=await database_1[_0x2c8617(0x152)]['telegramUser'][_0x2c8617(0x1cb)]({'where':{'telegramId':_0x14e4d8},'include':{'shop':!![]}});if(!_0x1d7ca9){await this[_0x2c8617(0x1e6)]?.[_0x2c8617(0x1c6)](_0x375e9a,_0x2c8617(0x1e9)+_0x2c8617(0x1a5));return;}if(!_0x1d7ca9['isVerified']||!_0x1d7ca9[_0x2c8617(0x205)]||!_0x1d7ca9[_0x2c8617(0x19c)]){await this[_0x2c8617(0x1e6)]?.['sendMessage'](_0x375e9a,_0x2c8617(0x1fb)+_0x2c8617(0x216));return;}await this['bot']?.[_0x2c8617(0x1c6)](_0x375e9a,'📊\x20*Connection\x20Status*\x0a\x0a'+(_0x2c8617(0x17e)+_0x1d7ca9['shop'][_0x2c8617(0x18c)]+'*\x0a')+(_0x2c8617(0x190)+_0x1d7ca9[_0x2c8617(0x19c)]['username']+'`\x0a')+(_0x2c8617(0x15f)+_0x1d7ca9[_0x2c8617(0x1ec)][_0x2c8617(0x147)]('en-US')+'\x0a\x0a')+_0x2c8617(0x1a9)+'Commands:\x0a'+_0x2c8617(0x219),{'parse_mode':'Markdown'});}catch(_0x420d56){console['error']('Error\x20handling\x20/status\x20command:',_0x420d56),await this[_0x2c8617(0x1e6)]?.[_0x2c8617(0x1c6)](_0x375e9a,_0x2c8617(0x1b8));}}),this[_0x3ae1c2(0x1e6)][_0x3ae1c2(0x1f8)](/\/debug/,async _0x1c14d7=>{const _0x2f72a9=_0x3ae1c2,_0x472d23=_0x1c14d7['chat']['id'],_0x32ca0b=_0x1c14d7[_0x2f72a9(0x177)]?.['id'][_0x2f72a9(0x223)]();if(!_0x32ca0b)return;try{const _0x438281=await database_1[_0x2f72a9(0x152)][_0x2f72a9(0x19c)][_0x2f72a9(0x153)]({'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![]},'take':0xa});let _0x44c782=_0x2f72a9(0x182);_0x44c782+=_0x2f72a9(0x1d9)+_0x32ca0b+_0x2f72a9(0x1a6),_0x44c782+=_0x2f72a9(0x19f),_0x438281['forEach']((_0x271605,_0x5051f7)=>{const _0x3259c4=_0x2f72a9;_0x44c782+=_0x5051f7+0x1+'.\x20*'+_0x271605['name']+'*\x0a',_0x44c782+=_0x3259c4(0x1f4)+_0x271605[_0x3259c4(0x1eb)]+'`\x0a',_0x44c782+='\x20\x20\x20Status:\x20'+_0x271605['status']+'\x0a',_0x44c782+=_0x3259c4(0x1a0)+_0x271605[_0x3259c4(0x20a)][_0x3259c4(0x162)](0x0,0xf)+_0x3259c4(0x1d7);}),await this['bot']?.['sendMessage'](_0x472d23,_0x44c782,{'parse_mode':_0x2f72a9(0x16e)});}catch(_0x326b9b){console['error']('Error\x20handling\x20/debug\x20command:',_0x326b9b),await this['bot']?.[_0x2f72a9(0x1c6)](_0x472d23,_0x2f72a9(0x1d6));}}),this['bot']['on'](_0x3ae1c2(0x14f),async _0xe1c714=>{const _0x26505a=_0x3ae1c2;if(_0xe1c714[_0x26505a(0x157)]?.[_0x26505a(0x185)]('/'))return;const _0x26a55f=_0xe1c714[_0x26505a(0x159)]['id'],_0x140845=_0xe1c714[_0x26505a(0x177)]?.['id'][_0x26505a(0x223)](),_0x2b7062=_0xe1c714['text']?.['trim']();if(!_0x140845||!_0x2b7062)return;try{const _0x4c3210=await database_1[_0x26505a(0x152)][_0x26505a(0x18b)][_0x26505a(0x1cb)]({'where':{'telegramId':_0x140845},'include':{'shop':!![]}});if(!_0x4c3210){await this[_0x26505a(0x1e6)]?.['sendMessage'](_0x26a55f,_0x26505a(0x1f5));return;}if(_0x4c3210[_0x26505a(0x184)]&&_0x4c3210['shopId']&&_0x4c3210['shop']){await this['bot']?.['sendMessage'](_0x26a55f,'✅\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*'+_0x4c3210[_0x26505a(0x19c)][_0x26505a(0x18c)]+_0x26505a(0x1c3)+'Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.',{'parse_mode':_0x26505a(0x16e)});return;}const _0x548880=_0x2b7062[_0x26505a(0x220)](/\s+/);if(_0x548880[_0x26505a(0x15c)]!==0x2){await this[_0x26505a(0x1e6)]?.[_0x26505a(0x1c6)](_0x26a55f,_0x26505a(0x199)+'📝\x20Format:\x20`username\x20api_key`\x0a\x0a'+'Example:\x0a'+_0x26505a(0x172)+('You\x20sent\x20'+_0x548880['length']+_0x26505a(0x1ee)+_0x548880['map'](_0x3bc45d=>'`'+_0x3bc45d+'`')[_0x26505a(0x17a)](',\x20')),{'parse_mode':'Markdown'});return;}const [_0x50ac12,_0x711117]=_0x548880;console['log']('🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20'+_0x140845+_0x26505a(0x214)+_0x50ac12+_0x26505a(0x17c)+_0x711117[_0x26505a(0x162)](0x0,0xa)+_0x26505a(0x201)),await this[_0x26505a(0x1f9)](_0x26a55f,_0x140845,_0x50ac12,_0x711117);}catch(_0x205b02){console[_0x26505a(0x1d0)](_0x26505a(0x1be),_0x205b02),await this[_0x26505a(0x1e6)]?.[_0x26505a(0x1c6)](_0x26a55f,'❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this[_0x3ae1c2(0x1e6)]['on'](_0x3ae1c2(0x1d0),_0x376824=>{const _0x143b54=_0x3ae1c2;console['error'](_0x143b54(0x19e),_0x376824);}),this[_0x3ae1c2(0x1e6)]['on'](_0x3ae1c2(0x151),_0x2858c1=>{const _0x14bc62=_0x3ae1c2;console[_0x14bc62(0x1d0)](_0x14bc62(0x1d4),_0x2858c1);});}async[a54_0xe7c208(0x1f9)](_0x3ceffc,_0x5670c5,_0x438bb5,_0x1eb14f){const _0x1a6bca=a54_0xe7c208;try{console[_0x1a6bca(0x160)]('🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20'+_0x5670c5+_0x1a6bca(0x214)+_0x438bb5+'\x22,\x20apiKey=\x22'+_0x1eb14f[_0x1a6bca(0x162)](0x0,0xa)+_0x1a6bca(0x201));if(!_0x438bb5||_0x438bb5[_0x1a6bca(0x15c)]<0x3||_0x438bb5[_0x1a6bca(0x15c)]>0x32||!/^[a-zA-Z0-9_]+$/[_0x1a6bca(0x1a4)](_0x438bb5)){await this[_0x1a6bca(0x1e6)]?.[_0x1a6bca(0x1c6)](_0x3ceffc,'❌\x20Invalid\x20username\x20format:\x20`'+_0x438bb5+_0x1a6bca(0x1a6)+_0x1a6bca(0x192),{'parse_mode':_0x1a6bca(0x16e)});return;}if(!_0x1eb14f||!_0x1eb14f[_0x1a6bca(0x185)](_0x1a6bca(0x225))&&!_0x1eb14f[_0x1a6bca(0x185)]('sk_')){await this[_0x1a6bca(0x1e6)]?.[_0x1a6bca(0x1c6)](_0x3ceffc,_0x1a6bca(0x19b)+'API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.',{'parse_mode':_0x1a6bca(0x16e)});return;}const _0xa33c01=await database_1[_0x1a6bca(0x152)][_0x1a6bca(0x19c)]['findUnique']({'where':{'username':_0x438bb5},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0xa33c01){const _0x5aca1d=await database_1[_0x1a6bca(0x152)]['shop'][_0x1a6bca(0x153)]({'select':{'username':!![],'name':!![]},'take':0x5});let _0x23518e=_0x1a6bca(0x1a7)+_0x438bb5+'`\x20not\x20found.\x0a\x0a';_0x5aca1d[_0x1a6bca(0x15c)]>0x0?(_0x23518e+=_0x1a6bca(0x148),_0x5aca1d['forEach'](_0x30a31e=>{const _0x379faa=_0x1a6bca;_0x23518e+=_0x379faa(0x1ca)+_0x30a31e['username']+_0x379faa(0x15d)+_0x30a31e[_0x379faa(0x18c)]+')\x0a';}),_0x23518e+=_0x1a6bca(0x1b2)):_0x23518e+=_0x1a6bca(0x1d3);await this[_0x1a6bca(0x1e6)]?.['sendMessage'](_0x3ceffc,_0x23518e,{'parse_mode':_0x1a6bca(0x16e)});return;}if(_0xa33c01['status']!==_0x1a6bca(0x15b)){await this['bot']?.[_0x1a6bca(0x1c6)](_0x3ceffc,_0x1a6bca(0x18e)+_0x438bb5+_0x1a6bca(0x20f)+'Contact\x20administrator.',{'parse_mode':_0x1a6bca(0x16e)});return;}if(_0xa33c01[_0x1a6bca(0x20a)]!==_0x1eb14f&&_0xa33c01[_0x1a6bca(0x1ef)]!==_0x1eb14f){await this[_0x1a6bca(0x1e6)]?.['sendMessage'](_0x3ceffc,_0x1a6bca(0x21a)+_0x438bb5+_0x1a6bca(0x1ff)+_0x1a6bca(0x15e)+_0x1a6bca(0x1e8),{'parse_mode':_0x1a6bca(0x16e)});return;}const _0x1d8de6=await database_1[_0x1a6bca(0x152)][_0x1a6bca(0x18b)][_0x1a6bca(0x202)]({'where':{'shopId':_0xa33c01['id'],'isVerified':!![],'telegramId':{'not':_0x5670c5}}});if(_0x1d8de6){await this[_0x1a6bca(0x1e6)]?.[_0x1a6bca(0x1c6)](_0x3ceffc,'❌\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`'+_0x438bb5+_0x1a6bca(0x1ff)+'Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.',{'parse_mode':_0x1a6bca(0x16e)});return;}await database_1[_0x1a6bca(0x152)]['telegramUser'][_0x1a6bca(0x1c0)]({'where':{'telegramId':_0x5670c5},'data':{'shopId':_0xa33c01['id'],'isVerified':!![]}}),await this['bot']?.[_0x1a6bca(0x1c6)](_0x3ceffc,_0x1a6bca(0x158)+_0x1a6bca(0x1fc)+(_0x1a6bca(0x210)+_0xa33c01[_0x1a6bca(0x18c)]+'*\x0a')+(_0x1a6bca(0x190)+_0xa33c01[_0x1a6bca(0x1eb)]+_0x1a6bca(0x1a6))+_0x1a6bca(0x1d5)+'•\x20New\x20payments\x0a'+_0x1a6bca(0x1df)+'•\x20Payouts\x0a'+_0x1a6bca(0x195)+'Commands:\x0a'+_0x1a6bca(0x1b1)+_0x1a6bca(0x219),{'parse_mode':'Markdown'}),console[_0x1a6bca(0x160)](_0x1a6bca(0x168)+_0x5670c5+_0x1a6bca(0x217)+_0xa33c01[_0x1a6bca(0x1eb)]+_0x1a6bca(0x1b3));}catch(_0x4f37fe){console[_0x1a6bca(0x1d0)]('Error\x20in\x20handleSingleLineVerification:',_0x4f37fe),await this[_0x1a6bca(0x1e6)]?.[_0x1a6bca(0x1c6)](_0x3ceffc,'❌\x20An\x20error\x20occurred\x20while\x20verifying\x20data.');}}async['sendShopNotification'](_0x1de9c1,_0x2c8854,_0x3f28c3){const _0x8671f2=a54_0xe7c208;if(!this['bot']){console[_0x8671f2(0x1f7)]('Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification');return;}try{const _0x5b667a=await database_1[_0x8671f2(0x152)]['telegramUser']['findMany']({'where':{'shopId':_0x1de9c1,'isVerified':!![]}});if(_0x5b667a[_0x8671f2(0x15c)]===0x0){console[_0x8671f2(0x160)]('No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20'+_0x1de9c1);return;}const _0x4b9118=_0x5b667a[_0x8671f2(0x1e4)](async _0x401b51=>{const _0x5f1d56=_0x8671f2;try{await this[_0x5f1d56(0x1e6)]?.[_0x5f1d56(0x1c6)](_0x401b51['telegramId'],_0x2c8854,_0x3f28c3),console[_0x5f1d56(0x160)](_0x5f1d56(0x20c)+_0x401b51[_0x5f1d56(0x1e3)]);}catch(_0x56644a){console[_0x5f1d56(0x1d0)](_0x5f1d56(0x20e)+_0x401b51[_0x5f1d56(0x1e3)]+':',_0x56644a),_0x56644a instanceof Error&&(_0x56644a['message']['includes']('blocked')||_0x56644a['message']['includes']('chat\x20not\x20found')||_0x56644a[_0x5f1d56(0x14f)]['includes']('user\x20is\x20deactivated'))&&(await database_1[_0x5f1d56(0x152)][_0x5f1d56(0x18b)][_0x5f1d56(0x1c0)]({'where':{'id':_0x401b51['id']},'data':{'isVerified':![]}}),console['log'](_0x5f1d56(0x206)+_0x401b51['telegramId']+_0x5f1d56(0x17f)));}});await Promise[_0x8671f2(0x19d)](_0x4b9118);}catch(_0x5a1f8c){console['error'](_0x8671f2(0x215),_0x5a1f8c);}}async['sendPaymentNotification'](_0x8930cd,_0xadfa56,_0x4e5239){const _0x1236dc=a54_0xe7c208,_0x1937b4={'created':'🆕','paid':'✅','failed':'❌','expired':'⏰','refund':'🔄','chargeback':'⚠️','processing':'⚙️'},_0x240777={'created':_0x1236dc(0x186),'paid':'Payment\x20successfully\x20paid','failed':_0x1236dc(0x1a3),'expired':_0x1236dc(0x163),'refund':_0x1236dc(0x179),'chargeback':_0x1236dc(0x1b7),'processing':'Payment\x20is\x20being\x20processed'},_0x2ba3b0=_0x1937b4[_0x4e5239],_0x4ca8e4=_0x240777[_0x4e5239],_0x419779=(0x0,gateway_1[_0x1236dc(0x1c4)])(_0xadfa56[_0x1236dc(0x20b)]);console[_0x1236dc(0x160)]('📱\x20Telegram\x20notification:\x20gateway\x20\x22'+_0xadfa56['gateway']+'\x22\x20->\x20display\x20\x22'+_0x419779+'\x22');let _0x291a87=_0x2ba3b0+'\x20*'+_0x4ca8e4+_0x1236dc(0x1c5)+(_0x1236dc(0x203)+_0xadfa56['amount']+'\x20'+_0xadfa56['currency']+'*\x0a')+(_0x1236dc(0x1bd)+(_0xadfa56[_0x1236dc(0x181)]||_0xadfa56['id'])+'`\x0a')+(_0x1236dc(0x1bb)+_0xadfa56['id']+'`\x0a')+(_0x1236dc(0x1c1)+_0x419779+'`\x0a')+(_0x1236dc(0x178)+new Date(_0xadfa56['createdAt'])[_0x1236dc(0x1c7)](_0x1236dc(0x1c2))+'\x0a');if(_0xadfa56['customerName']||_0xadfa56[_0x1236dc(0x18f)]||_0xadfa56[_0x1236dc(0x17d)]||_0xadfa56[_0x1236dc(0x166)]||_0xadfa56[_0x1236dc(0x18a)]){_0x291a87+=_0x1236dc(0x1ba);_0xadfa56[_0x1236dc(0x221)]&&(_0x291a87+='📛\x20Name:\x20`'+_0xadfa56[_0x1236dc(0x221)]+'`\x0a');_0xadfa56[_0x1236dc(0x18f)]&&(_0x291a87+=_0x1236dc(0x180)+_0xadfa56[_0x1236dc(0x18f)]+'`\x0a');_0xadfa56['remitterIban']&&(_0x291a87+=_0x1236dc(0x161)+_0xadfa56[_0x1236dc(0x17d)]+'`\x0a');_0xadfa56[_0x1236dc(0x166)]&&(_0x291a87+=_0x1236dc(0x174)+_0xadfa56[_0x1236dc(0x166)]+'`\x0a');if(_0xadfa56[_0x1236dc(0x18a)]){const _0x4619f1=_0xadfa56[_0x1236dc(0x18a)][_0x1236dc(0x15c)]>0x32?_0xadfa56[_0x1236dc(0x18a)][_0x1236dc(0x162)](0x0,0x32)+_0x1236dc(0x14e):_0xadfa56[_0x1236dc(0x18a)];_0x291a87+='💻\x20Browser:\x20`'+_0x4619f1+'`\x0a';}}_0x4e5239===_0x1236dc(0x1b5)&&_0xadfa56[_0x1236dc(0x170)]&&(_0x291a87+=_0x1236dc(0x1fd)+_0xadfa56[_0x1236dc(0x170)]+_0x1236dc(0x1e2)),_0x4e5239===_0x1236dc(0x21d)&&(_0x291a87+='⏳\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a'),_0xadfa56[_0x1236dc(0x1b0)]&&(_0x291a87+=_0x1236dc(0x14c)+_0xadfa56[_0x1236dc(0x1b0)]+'\x0a'),await this[_0x1236dc(0x183)](_0x8930cd,_0x291a87,{'parse_mode':_0x1236dc(0x16e)});}async[a54_0xe7c208(0x21c)](_0x580623,_0x579f62,_0xe51e5c){const _0x5eca28=a54_0xe7c208,_0x24124b={'created':'📤','completed':'✅','rejected':'❌'},_0x41df51={'created':_0x5eca28(0x193),'completed':_0x5eca28(0x1f6),'rejected':_0x5eca28(0x156)},_0x5efe1e=_0x24124b[_0xe51e5c],_0xfc969=_0x41df51[_0xe51e5c],_0x4d5232=_0x5efe1e+'\x20*'+_0xfc969+'*\x0a\x0a'+(_0x5eca28(0x173)+_0x579f62[_0x5eca28(0x1a1)]+'\x20USD*\x0a')+(_0x5eca28(0x187)+_0x579f62[_0x5eca28(0x207)]+'`\x0a')+(_0x5eca28(0x14d)+_0x579f62['id']+'`\x0a')+(_0x5eca28(0x178)+new Date(_0x579f62[_0x5eca28(0x21f)])[_0x5eca28(0x1c7)](_0x5eca28(0x1c2))+'\x0a')+(_0x579f62[_0x5eca28(0x1ea)]?'🔗\x20TXID:\x20`'+_0x579f62['txid']+'`':'');await this[_0x5eca28(0x183)](_0x580623,_0x4d5232,{'parse_mode':'Markdown'});}async[a54_0xe7c208(0x1f3)](_0x4e31ed,_0x1c1bd3){const _0xafac76=a54_0xe7c208;try{const _0x3ed497=await database_1['default'][_0xafac76(0x1cf)]['findUnique']({'where':{'shopId':_0x4e31ed},'select':{'notificationLogin':!![]}});if(!_0x3ed497?.[_0xafac76(0x16a)]){console[_0xafac76(0x160)](_0xafac76(0x1e0)+_0x4e31ed);return;}const _0x1f70cd=_0x1c1bd3[_0xafac76(0x176)]?'🔐':'🚨',_0x40b924=_0x1c1bd3[_0xafac76(0x176)]?'Successful\x20login':_0xafac76(0x1ce);let _0x4b8a37=_0x1f70cd+'\x20*'+_0x40b924+_0xafac76(0x1c5)+(_0xafac76(0x190)+_0x1c1bd3[_0xafac76(0x1eb)]+'`\x0a')+(_0xafac76(0x1ac)+_0x1c1bd3[_0xafac76(0x165)]['toLocaleString']('en-US')+'\x0a');_0x1c1bd3[_0xafac76(0x17b)]&&(_0x4b8a37+=_0xafac76(0x212)+_0x1c1bd3[_0xafac76(0x17b)]+'`\x0a');if(_0x1c1bd3['userAgent']){const _0x406969=_0x1c1bd3[_0xafac76(0x1cd)][_0xafac76(0x15c)]>0x32?_0x1c1bd3['userAgent'][_0xafac76(0x162)](0x0,0x32)+_0xafac76(0x14e):_0x1c1bd3['userAgent'];_0x4b8a37+=_0xafac76(0x14a)+_0x406969+'`\x0a';}!_0x1c1bd3[_0xafac76(0x176)]&&(_0x4b8a37+=_0xafac76(0x209)),await this['sendShopNotification'](_0x4e31ed,_0x4b8a37,{'parse_mode':_0xafac76(0x16e)}),console[_0xafac76(0x160)](_0xafac76(0x1a8)+_0x4e31ed+':\x20'+(_0x1c1bd3[_0xafac76(0x176)]?_0xafac76(0x176):_0xafac76(0x1e5)));}catch(_0x4f6461){console['error'](_0xafac76(0x1f2),_0x4f6461);}}async[a54_0xe7c208(0x1d1)](_0x251717,_0x44fd5b){const _0x38741c=a54_0xe7c208;try{const _0x250e5b=await database_1['default'][_0x38741c(0x1cf)][_0x38741c(0x1cb)]({'where':{'shopId':_0x251717},'select':{'notificationApiError':!![]}});if(!_0x250e5b?.[_0x38741c(0x200)]){console[_0x38741c(0x160)]('📱\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20'+_0x251717);return;}let _0xf2093b='🚨\x20*API\x20Error*\x0a\x0a'+(_0x38741c(0x211)+_0x44fd5b[_0x38741c(0x207)]+'\x20'+_0x44fd5b['endpoint']+'`\x0a')+(_0x38741c(0x1ac)+_0x44fd5b['timestamp'][_0x38741c(0x1c7)](_0x38741c(0x1c2))+'\x0a');_0x44fd5b[_0x38741c(0x1da)]&&(_0xf2093b+='📊\x20Error\x20code:\x20`'+_0x44fd5b['statusCode']+'`\x0a'),_0xf2093b+=_0x38741c(0x149)+_0x44fd5b[_0x38741c(0x1fa)]+'`\x0a',_0x44fd5b[_0x38741c(0x1c8)]&&(_0xf2093b+=_0x38741c(0x146)+_0x44fd5b[_0x38741c(0x1c8)]+'`\x0a'),_0xf2093b+=_0x38741c(0x1ab),await this['sendShopNotification'](_0x251717,_0xf2093b,{'parse_mode':_0x38741c(0x16e)}),console['log'](_0x38741c(0x191)+_0x251717+':\x20'+_0x44fd5b[_0x38741c(0x18d)]);}catch(_0x47f87a){console[_0x38741c(0x1d0)](_0x38741c(0x188),_0x47f87a);}}async['sendCustomNotification'](_0x578ee7,_0x4a057c,_0x1cca73){const _0x2ad87d=a54_0xe7c208;let _0x902842=_0x2ad87d(0x150)+_0x4a057c+_0x2ad87d(0x1c5);for(const [_0x560ab1,_0x19c29]of Object['entries'](_0x1cca73)){_0x19c29!==null&&_0x19c29!==undefined&&(_0x902842+=_0x560ab1+_0x2ad87d(0x196)+_0x19c29+'`\x0a');}await this[_0x2ad87d(0x183)](_0x578ee7,_0x902842,{'parse_mode':_0x2ad87d(0x16e)});}['getBotInfo'](){const _0x57997b=a54_0xe7c208;return{'isActive':!!this[_0x57997b(0x1e6)],'username':this[_0x57997b(0x1e1)]};}[a54_0xe7c208(0x21b)](){const _0x177462=a54_0xe7c208;this['bot']&&(this[_0x177462(0x1e6)][_0x177462(0x197)](),this[_0x177462(0x1e6)]=null,console[_0x177462(0x160)]('🛑\x20Telegram\x20bot\x20stopped'));}}exports[a54_0xe7c208(0x164)]=TelegramBotService,exports['telegramBotService']=new TelegramBotService();