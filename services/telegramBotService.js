'use strict';const a55_0x534300=a55_0x5bd8;(function(_0x51e510,_0x91b262){const _0x335267=a55_0x5bd8,_0x4d4349=_0x51e510();while(!![]){try{const _0x540d30=parseInt(_0x335267(0x168))/0x1+parseInt(_0x335267(0x123))/0x2+parseInt(_0x335267(0xb9))/0x3+parseInt(_0x335267(0xd9))/0x4*(-parseInt(_0x335267(0xd7))/0x5)+parseInt(_0x335267(0x143))/0x6+parseInt(_0x335267(0x17c))/0x7+parseInt(_0x335267(0x16c))/0x8*(-parseInt(_0x335267(0x11e))/0x9);if(_0x540d30===_0x91b262)break;else _0x4d4349['push'](_0x4d4349['shift']());}catch(_0x14491f){_0x4d4349['push'](_0x4d4349['shift']());}}}(a55_0x3b88,0x948ce));function a55_0x5bd8(_0x1a25a0,_0xbb8947){const _0x3b8872=a55_0x3b88();return a55_0x5bd8=function(_0x5bd83d,_0x33ff95){_0x5bd83d=_0x5bd83d-0xa0;let _0x15f4b=_0x3b8872[_0x5bd83d];return _0x15f4b;},a55_0x5bd8(_0x1a25a0,_0xbb8947);}var __importDefault=this&&this['__importDefault']||function(_0x3ba7a1){const _0x107305=a55_0x5bd8;return _0x3ba7a1&&_0x3ba7a1[_0x107305(0x14d)]?_0x3ba7a1:{'default':_0x3ba7a1};};Object[a55_0x534300(0x12d)](exports,'__esModule',{'value':!![]}),exports['telegramBotService']=exports[a55_0x534300(0x154)]=void 0x0;const node_telegram_bot_api_1=__importDefault(require(a55_0x534300(0x11c))),database_1=__importDefault(require('../config/database')),gateway_1=require(a55_0x534300(0xf9));class TelegramBotService{constructor(){const _0x204dbd=a55_0x534300;this['bot']=null,this['botToken']=process['env'][_0x204dbd(0x10b)]||'',this['botUsername']=process['env']['TELEGRAM_BOT_USERNAME']||_0x204dbd(0xd4),this[_0x204dbd(0xcd)]?this[_0x204dbd(0xd3)]():console[_0x204dbd(0xf3)](_0x204dbd(0x17e));}['initializeBot'](){const _0x4614b7=a55_0x534300;try{this[_0x4614b7(0xbb)]=new node_telegram_bot_api_1[(_0x4614b7(0x16f))](this[_0x4614b7(0xcd)],{'polling':!![]}),this[_0x4614b7(0xea)](),console['log'](_0x4614b7(0xaf)+this[_0x4614b7(0x180)]+'\x20initialized\x20successfully');}catch(_0x126caf){console[_0x4614b7(0x100)](_0x4614b7(0xba),_0x126caf);}}[a55_0x534300(0xea)](){const _0x3fb389=a55_0x534300;if(!this[_0x3fb389(0xbb)])return;this[_0x3fb389(0xbb)]['onText'](/\/start/,async _0x17b1f1=>{const _0x246ecc=_0x3fb389,_0x4f14db=_0x17b1f1[_0x246ecc(0x124)]['id'],_0x582310=_0x17b1f1[_0x246ecc(0x145)]?.['id'][_0x246ecc(0x13b)](),_0x3f18a1=_0x17b1f1[_0x246ecc(0x145)]?.['username'],_0x11c217=_0x17b1f1[_0x246ecc(0x145)]?.[_0x246ecc(0xcc)],_0xb0caf4=_0x17b1f1[_0x246ecc(0x145)]?.[_0x246ecc(0xe7)];if(!_0x582310)return;try{let _0x9267ea=await database_1[_0x246ecc(0x16f)][_0x246ecc(0x122)][_0x246ecc(0x13a)]({'where':{'telegramId':_0x582310},'include':{'shop':!![]}});!_0x9267ea?(_0x9267ea=await database_1[_0x246ecc(0x16f)][_0x246ecc(0x122)][_0x246ecc(0x17b)]({'data':{'telegramId':_0x582310,'username':_0x3f18a1,'firstName':_0x11c217,'lastName':_0xb0caf4,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console['log'](_0x246ecc(0x16d)+_0x582310+_0x246ecc(0xbc)+_0x3f18a1+')')):_0x9267ea=await database_1[_0x246ecc(0x16f)][_0x246ecc(0x122)][_0x246ecc(0x14a)]({'where':{'telegramId':_0x582310},'data':{'username':_0x3f18a1,'firstName':_0x11c217,'lastName':_0xb0caf4},'include':{'shop':!![]}}),_0x9267ea[_0x246ecc(0x15e)]&&_0x9267ea[_0x246ecc(0xf0)]&&_0x9267ea[_0x246ecc(0x161)]?await this[_0x246ecc(0xbb)]?.[_0x246ecc(0xad)](_0x4f14db,_0x246ecc(0x17a)+('You\x20are\x20already\x20connected\x20to\x20shop:\x20*'+_0x9267ea[_0x246ecc(0x161)]['name']+'*\x0a')+('Username:\x20`'+_0x9267ea[_0x246ecc(0x161)][_0x246ecc(0x15a)]+_0x246ecc(0xe8))+_0x246ecc(0xc5)+_0x246ecc(0xa9)+'•\x20Payment\x20status\x20changes\x0a'+'•\x20Payouts\x0a\x0a'+'Commands:\x0a'+_0x246ecc(0xd8)+_0x246ecc(0x104),{'parse_mode':'Markdown'}):(_0x9267ea[_0x246ecc(0xf0)]&&!_0x9267ea[_0x246ecc(0x15e)]&&(await database_1[_0x246ecc(0x16f)][_0x246ecc(0x122)][_0x246ecc(0x14a)]({'where':{'telegramId':_0x582310},'data':{'shopId':null,'isVerified':![]}}),console['log'](_0x246ecc(0x16a)+_0x582310)),await this[_0x246ecc(0xbb)]?.[_0x246ecc(0xad)](_0x4f14db,_0x246ecc(0x15d)+_0x246ecc(0x158)+'📝\x20Format:\x20`username\x20api_key`\x0a\x0a'+_0x246ecc(0xb7)+_0x246ecc(0x13e)+_0x246ecc(0xc1),{'parse_mode':_0x246ecc(0xa2)}));}catch(_0x31a16f){console['error'](_0x246ecc(0x13f),_0x31a16f),await this[_0x246ecc(0xbb)]?.[_0x246ecc(0xad)](_0x4f14db,_0x246ecc(0x131));}}),this[_0x3fb389(0xbb)]['onText'](/\/disconnect/,async _0x145bd6=>{const _0x3d9167=_0x3fb389,_0x1a6b9d=_0x145bd6[_0x3d9167(0x124)]['id'],_0x464520=_0x145bd6[_0x3d9167(0x145)]?.['id'][_0x3d9167(0x13b)]();if(!_0x464520)return;try{const _0x2d1040=await database_1[_0x3d9167(0x16f)]['telegramUser'][_0x3d9167(0x13a)]({'where':{'telegramId':_0x464520},'include':{'shop':!![]}});if(!_0x2d1040||!_0x2d1040[_0x3d9167(0x15e)]||!_0x2d1040[_0x3d9167(0xf0)]){await this[_0x3d9167(0xbb)]?.['sendMessage'](_0x1a6b9d,'❌\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.');return;}const _0xd3edfd=_0x2d1040['shop']?.[_0x3d9167(0x139)]||_0x3d9167(0xa0);await database_1[_0x3d9167(0x16f)][_0x3d9167(0x122)][_0x3d9167(0x14a)]({'where':{'telegramId':_0x464520},'data':{'shopId':null,'isVerified':![]}}),console['log']('🔌\x20User\x20'+_0x464520+_0x3d9167(0x103)+_0x2d1040[_0x3d9167(0xf0)]),await this['bot']?.['sendMessage'](_0x1a6b9d,_0x3d9167(0xde)+_0xd3edfd+_0x3d9167(0x136)+_0x3d9167(0x116),{'parse_mode':_0x3d9167(0xa2)});}catch(_0x5e3882){console[_0x3d9167(0x100)](_0x3d9167(0xf1),_0x5e3882),await this[_0x3d9167(0xbb)]?.[_0x3d9167(0xad)](_0x1a6b9d,_0x3d9167(0x131));}}),this[_0x3fb389(0xbb)][_0x3fb389(0xab)](/\/status/,async _0x44be44=>{const _0x2a3253=_0x3fb389,_0x223b4f=_0x44be44[_0x2a3253(0x124)]['id'],_0x350ce3=_0x44be44[_0x2a3253(0x145)]?.['id'][_0x2a3253(0x13b)]();if(!_0x350ce3)return;try{const _0x55af9f=await database_1['default'][_0x2a3253(0x122)][_0x2a3253(0x13a)]({'where':{'telegramId':_0x350ce3},'include':{'shop':!![]}});if(!_0x55af9f){await this[_0x2a3253(0xbb)]?.['sendMessage'](_0x223b4f,_0x2a3253(0xb2)+_0x2a3253(0x113));return;}if(!_0x55af9f['isVerified']||!_0x55af9f[_0x2a3253(0xf0)]||!_0x55af9f[_0x2a3253(0x161)]){await this[_0x2a3253(0xbb)]?.[_0x2a3253(0xad)](_0x223b4f,'❌\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a'+'Use\x20/start\x20to\x20connect.');return;}await this[_0x2a3253(0xbb)]?.[_0x2a3253(0xad)](_0x223b4f,_0x2a3253(0xc4)+(_0x2a3253(0x118)+_0x55af9f[_0x2a3253(0x161)][_0x2a3253(0x139)]+'*\x0a')+('👤\x20Username:\x20`'+_0x55af9f[_0x2a3253(0x161)]['username']+'`\x0a')+(_0x2a3253(0x120)+_0x55af9f[_0x2a3253(0xbf)][_0x2a3253(0x126)](_0x2a3253(0xca))+'\x0a\x0a')+'🔔\x20Notifications\x20are\x20active\x0a\x0a'+_0x2a3253(0xed)+_0x2a3253(0x104),{'parse_mode':_0x2a3253(0xa2)});}catch(_0x45c4b9){console['error'](_0x2a3253(0x169),_0x45c4b9),await this[_0x2a3253(0xbb)]?.[_0x2a3253(0xad)](_0x223b4f,_0x2a3253(0x131));}}),this['bot']['onText'](/\/debug/,async _0x2f51e9=>{const _0x243f50=_0x3fb389,_0x3cfed9=_0x2f51e9[_0x243f50(0x124)]['id'],_0x2a3919=_0x2f51e9[_0x243f50(0x145)]?.['id'][_0x243f50(0x13b)]();if(!_0x2a3919)return;try{const _0xdefd7b=await database_1[_0x243f50(0x16f)][_0x243f50(0x161)][_0x243f50(0xf7)]({'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![]},'take':0xa});let _0x186763='🔍\x20*Debug\x20Information*\x0a\x0a';_0x186763+='📱\x20Your\x20Telegram\x20ID:\x20`'+_0x2a3919+_0x243f50(0xe8),_0x186763+='🏪\x20Available\x20shops\x20in\x20system:\x0a',_0xdefd7b['forEach']((_0x3c1c06,_0x21fbc7)=>{const _0x4d782e=_0x243f50;_0x186763+=_0x21fbc7+0x1+_0x4d782e(0x141)+_0x3c1c06['name']+'*\x0a',_0x186763+=_0x4d782e(0x140)+_0x3c1c06[_0x4d782e(0x15a)]+'`\x0a',_0x186763+='\x20\x20\x20Status:\x20'+_0x3c1c06['status']+'\x0a',_0x186763+=_0x4d782e(0x109)+_0x3c1c06[_0x4d782e(0x151)][_0x4d782e(0xdd)](0x0,0xf)+_0x4d782e(0x107);}),await this[_0x243f50(0xbb)]?.[_0x243f50(0xad)](_0x3cfed9,_0x186763,{'parse_mode':_0x243f50(0xa2)});}catch(_0x40bc8e){console['error'](_0x243f50(0x174),_0x40bc8e),await this[_0x243f50(0xbb)]?.[_0x243f50(0xad)](_0x3cfed9,'❌\x20Error\x20getting\x20debug\x20information.');}}),this[_0x3fb389(0xbb)]['on']('message',async _0x26f304=>{const _0x4061b8=_0x3fb389;if(_0x26f304['text']?.[_0x4061b8(0x128)]('/'))return;const _0x32f75d=_0x26f304[_0x4061b8(0x124)]['id'],_0x51f42a=_0x26f304[_0x4061b8(0x145)]?.['id']['toString'](),_0x5a8de1=_0x26f304[_0x4061b8(0xd6)]?.[_0x4061b8(0x176)]();if(!_0x51f42a||!_0x5a8de1)return;try{const _0x4db6bb=await database_1[_0x4061b8(0x16f)][_0x4061b8(0x122)][_0x4061b8(0x13a)]({'where':{'telegramId':_0x51f42a},'include':{'shop':!![]}});if(!_0x4db6bb){await this[_0x4061b8(0xbb)]?.[_0x4061b8(0xad)](_0x32f75d,_0x4061b8(0xd1));return;}if(_0x4db6bb[_0x4061b8(0x15e)]&&_0x4db6bb[_0x4061b8(0xf0)]&&_0x4db6bb[_0x4061b8(0x161)]){await this[_0x4061b8(0xbb)]?.[_0x4061b8(0xad)](_0x32f75d,_0x4061b8(0x149)+_0x4db6bb[_0x4061b8(0x161)][_0x4061b8(0x139)]+_0x4061b8(0x136)+_0x4061b8(0x14c),{'parse_mode':'Markdown'});return;}const _0x563c41=_0x5a8de1[_0x4061b8(0x152)](/\s+/);if(_0x563c41[_0x4061b8(0xb4)]!==0x2){await this[_0x4061b8(0xbb)]?.[_0x4061b8(0xad)](_0x32f75d,_0x4061b8(0xf8)+_0x4061b8(0xc6)+_0x4061b8(0xb7)+'`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a'+('You\x20sent\x20'+_0x563c41['length']+_0x4061b8(0xdc)+_0x563c41[_0x4061b8(0x172)](_0x2f74a6=>'`'+_0x2f74a6+'`')[_0x4061b8(0x178)](',\x20')),{'parse_mode':_0x4061b8(0xa2)});return;}const [_0xeb8443,_0x304705]=_0x563c41;console[_0x4061b8(0x10d)]('🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20'+_0x51f42a+_0x4061b8(0x17f)+_0xeb8443+_0x4061b8(0x133)+_0x304705[_0x4061b8(0xdd)](0x0,0xa)+_0x4061b8(0x179)),await this[_0x4061b8(0x14b)](_0x32f75d,_0x51f42a,_0xeb8443,_0x304705);}catch(_0x1c4b0e){console[_0x4061b8(0x100)]('Error\x20handling\x20message:',_0x1c4b0e),await this['bot']?.['sendMessage'](_0x32f75d,_0x4061b8(0x131));}}),this[_0x3fb389(0xbb)]['on'](_0x3fb389(0x100),_0x5ed27d=>{const _0xb40ee3=_0x3fb389;console['error'](_0xb40ee3(0xe0),_0x5ed27d);}),this['bot']['on'](_0x3fb389(0xb5),_0x18f3d6=>{const _0xe43558=_0x3fb389;console[_0xe43558(0x100)](_0xe43558(0x17d),_0x18f3d6);});}async[a55_0x534300(0x14b)](_0xa7839b,_0x2985f3,_0x381e99,_0x25ff2d){const _0x2e074b=a55_0x534300;try{console[_0x2e074b(0x10d)](_0x2e074b(0xfc)+_0x2985f3+_0x2e074b(0x17f)+_0x381e99+_0x2e074b(0x133)+_0x25ff2d[_0x2e074b(0xdd)](0x0,0xa)+_0x2e074b(0x179));if(!_0x381e99||_0x381e99[_0x2e074b(0xb4)]<0x3||_0x381e99['length']>0x32||!/^[a-zA-Z0-9_]+$/['test'](_0x381e99)){await this[_0x2e074b(0xbb)]?.[_0x2e074b(0xad)](_0xa7839b,_0x2e074b(0x12a)+_0x381e99+_0x2e074b(0xe8)+_0x2e074b(0xac),{'parse_mode':_0x2e074b(0xa2)});return;}if(!_0x25ff2d||!_0x25ff2d['startsWith'](_0x2e074b(0x12b))&&!_0x25ff2d[_0x2e074b(0x128)]('sk_')){await this[_0x2e074b(0xbb)]?.[_0x2e074b(0xad)](_0xa7839b,'❌\x20Invalid\x20API\x20key\x20format.\x0a\x0a'+_0x2e074b(0x160),{'parse_mode':_0x2e074b(0xa2)});return;}const _0x126d94=await database_1[_0x2e074b(0x16f)][_0x2e074b(0x161)]['findUnique']({'where':{'username':_0x381e99},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x126d94){const _0x2c3a5c=await database_1[_0x2e074b(0x16f)][_0x2e074b(0x161)][_0x2e074b(0xf7)]({'select':{'username':!![],'name':!![]},'take':0x5});let _0x4a215b='❌\x20Shop\x20with\x20username\x20`'+_0x381e99+_0x2e074b(0xe3);_0x2c3a5c[_0x2e074b(0xb4)]>0x0?(_0x4a215b+='Available\x20usernames:\x0a',_0x2c3a5c[_0x2e074b(0x15b)](_0x12aeb1=>{const _0x259a91=_0x2e074b;_0x4a215b+='•\x20`'+_0x12aeb1[_0x259a91(0x15a)]+_0x259a91(0x138)+_0x12aeb1[_0x259a91(0x139)]+')\x0a';}),_0x4a215b+=_0x2e074b(0x11a)):_0x4a215b+=_0x2e074b(0xaa);await this[_0x2e074b(0xbb)]?.[_0x2e074b(0xad)](_0xa7839b,_0x4a215b,{'parse_mode':_0x2e074b(0xa2)});return;}if(_0x126d94[_0x2e074b(0x101)]!==_0x2e074b(0xf4)){await this['bot']?.['sendMessage'](_0xa7839b,_0x2e074b(0x135)+_0x381e99+_0x2e074b(0x16b)+_0x2e074b(0x12e),{'parse_mode':_0x2e074b(0xa2)});return;}if(_0x126d94[_0x2e074b(0x151)]!==_0x25ff2d&&_0x126d94[_0x2e074b(0xd0)]!==_0x25ff2d){await this['bot']?.[_0x2e074b(0xad)](_0xa7839b,_0x2e074b(0x12f)+_0x381e99+_0x2e074b(0x110)+_0x2e074b(0xe4)+_0x2e074b(0x170),{'parse_mode':_0x2e074b(0xa2)});return;}const _0x127acc=await database_1[_0x2e074b(0x16f)]['telegramUser'][_0x2e074b(0xae)]({'where':{'shopId':_0x126d94['id'],'isVerified':!![],'telegramId':{'not':_0x2985f3}}});if(_0x127acc){await this[_0x2e074b(0xbb)]?.[_0x2e074b(0xad)](_0xa7839b,'❌\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`'+_0x381e99+_0x2e074b(0x110)+'Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.',{'parse_mode':'Markdown'});return;}await database_1[_0x2e074b(0x16f)][_0x2e074b(0x122)]['update']({'where':{'telegramId':_0x2985f3},'data':{'shopId':_0x126d94['id'],'isVerified':!![]}}),await this[_0x2e074b(0xbb)]?.[_0x2e074b(0xad)](_0xa7839b,_0x2e074b(0xda)+_0x2e074b(0x119)+(_0x2e074b(0xa4)+_0x126d94[_0x2e074b(0x139)]+'*\x0a')+(_0x2e074b(0xcf)+_0x126d94[_0x2e074b(0x15a)]+_0x2e074b(0xe8))+_0x2e074b(0xc9)+_0x2e074b(0xa9)+_0x2e074b(0x12c)+_0x2e074b(0x167)+_0x2e074b(0x102)+_0x2e074b(0xed)+_0x2e074b(0xd8)+_0x2e074b(0x104),{'parse_mode':'Markdown'}),console[_0x2e074b(0x10d)](_0x2e074b(0x150)+_0x2985f3+_0x2e074b(0x11f)+_0x126d94[_0x2e074b(0x15a)]+_0x2e074b(0x111));}catch(_0x1f642d){console[_0x2e074b(0x100)](_0x2e074b(0x127),_0x1f642d),await this['bot']?.[_0x2e074b(0xad)](_0xa7839b,'❌\x20An\x20error\x20occurred\x20while\x20verifying\x20data.');}}async[a55_0x534300(0xeb)](_0x21ada0,_0x55e030,_0x50c13b){const _0x355a86=a55_0x534300;if(!this[_0x355a86(0xbb)]){console[_0x355a86(0xf3)](_0x355a86(0x146));return;}try{const _0x24350c=await database_1[_0x355a86(0x16f)][_0x355a86(0x122)][_0x355a86(0xf7)]({'where':{'shopId':_0x21ada0,'isVerified':!![]}});if(_0x24350c[_0x355a86(0xb4)]===0x0){console[_0x355a86(0x10d)]('No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20'+_0x21ada0);return;}const _0x5c770c=_0x24350c[_0x355a86(0x172)](async _0x656701=>{const _0xaef1a8=_0x355a86;try{await this[_0xaef1a8(0xbb)]?.['sendMessage'](_0x656701[_0xaef1a8(0xc0)],_0x55e030,_0x50c13b),console[_0xaef1a8(0x10d)](_0xaef1a8(0xfd)+_0x656701['telegramId']);}catch(_0x1c211a){console['error'](_0xaef1a8(0xb6)+_0x656701['telegramId']+':',_0x1c211a),_0x1c211a instanceof Error&&(_0x1c211a[_0xaef1a8(0x10e)][_0xaef1a8(0x132)](_0xaef1a8(0xc8))||_0x1c211a[_0xaef1a8(0x10e)][_0xaef1a8(0x132)](_0xaef1a8(0xe9))||_0x1c211a[_0xaef1a8(0x10e)][_0xaef1a8(0x132)]('user\x20is\x20deactivated'))&&(await database_1[_0xaef1a8(0x16f)][_0xaef1a8(0x122)][_0xaef1a8(0x14a)]({'where':{'id':_0x656701['id']},'data':{'isVerified':![]}}),console[_0xaef1a8(0x10d)](_0xaef1a8(0xcb)+_0x656701[_0xaef1a8(0xc0)]+_0xaef1a8(0x11d)));}});await Promise[_0x355a86(0xb0)](_0x5c770c);}catch(_0x31d903){console[_0x355a86(0x100)](_0x355a86(0x134),_0x31d903);}}async[a55_0x534300(0x181)](_0x52be0,_0x4d3b40,_0x400b86){const _0x402e6c=a55_0x534300,_0x4d195c={'created':'🆕','paid':'✅','failed':'❌','expired':'⏰','refund':'🔄','chargeback':'⚠️','processing':'⚙️'},_0x3e9844={'created':_0x402e6c(0x159),'paid':'Payment\x20successfully\x20paid','failed':_0x402e6c(0xc3),'expired':_0x402e6c(0xff),'refund':'Payment\x20refund','chargeback':_0x402e6c(0xe1),'processing':'Payment\x20is\x20being\x20processed'},_0x16ca44=_0x4d195c[_0x400b86],_0x3a4995=_0x3e9844[_0x400b86],_0x23ff0b=(0x0,gateway_1[_0x402e6c(0x11b)])(_0x4d3b40[_0x402e6c(0x156)]);console[_0x402e6c(0x10d)](_0x402e6c(0xd2)+_0x4d3b40[_0x402e6c(0x156)]+_0x402e6c(0x121)+_0x23ff0b+'\x22');let _0x1e0d1b=_0x16ca44+'\x20*'+_0x3a4995+_0x402e6c(0x175)+(_0x402e6c(0xd5)+_0x4d3b40['amount']+'\x20'+_0x4d3b40[_0x402e6c(0xa1)]+'*\x0a')+(_0x402e6c(0x153)+(_0x4d3b40[_0x402e6c(0xa5)]||_0x4d3b40['id'])+'`\x0a')+('🆔\x20Payment\x20ID:\x20`'+_0x4d3b40['id']+'`\x0a')+(_0x402e6c(0x148)+_0x23ff0b+'`\x0a')+(_0x402e6c(0xce)+new Date(_0x4d3b40[_0x402e6c(0xb3)])['toLocaleString']('en-US')+'\x0a');if(_0x4d3b40['customerName']||_0x4d3b40[_0x402e6c(0xc7)]||_0x4d3b40[_0x402e6c(0x165)]||_0x4d3b40[_0x402e6c(0x125)]||_0x4d3b40['customerUa']){_0x1e0d1b+=_0x402e6c(0x155);_0x4d3b40[_0x402e6c(0xa6)]&&(_0x1e0d1b+=_0x402e6c(0x129)+_0x4d3b40[_0x402e6c(0xa6)]+'`\x0a');_0x4d3b40[_0x402e6c(0xc7)]&&(_0x1e0d1b+=_0x402e6c(0x13d)+_0x4d3b40[_0x402e6c(0xc7)]+'`\x0a');_0x4d3b40['remitterIban']&&(_0x1e0d1b+=_0x402e6c(0xe5)+_0x4d3b40[_0x402e6c(0x165)]+'`\x0a');_0x4d3b40[_0x402e6c(0x125)]&&(_0x1e0d1b+=_0x402e6c(0x14f)+_0x4d3b40['customerIp']+'`\x0a');if(_0x4d3b40[_0x402e6c(0x10f)]){const _0x5c35ff=_0x4d3b40[_0x402e6c(0x10f)]['length']>0x32?_0x4d3b40[_0x402e6c(0x10f)][_0x402e6c(0xdd)](0x0,0x32)+'...':_0x4d3b40[_0x402e6c(0x10f)];_0x1e0d1b+='💻\x20Browser:\x20`'+_0x5c35ff+'`\x0a';}}_0x400b86===_0x402e6c(0x137)&&_0x4d3b40['chargebackAmount']&&(_0x1e0d1b+='💸\x20Penalty\x20amount:\x20*'+_0x4d3b40[_0x402e6c(0x162)]+_0x402e6c(0xec)),_0x400b86==='processing'&&(_0x1e0d1b+=_0x402e6c(0x163)),_0x4d3b40[_0x402e6c(0xa7)]&&(_0x1e0d1b+='📝\x20Notes:\x20'+_0x4d3b40[_0x402e6c(0xa7)]+'\x0a'),await this[_0x402e6c(0xeb)](_0x52be0,_0x1e0d1b,{'parse_mode':_0x402e6c(0xa2)});}async[a55_0x534300(0xfa)](_0x42d7fd,_0x297c22,_0x410b72){const _0x6a133c=a55_0x534300,_0x3f9009={'created':'📤','completed':'✅','rejected':'❌'},_0x426971={'created':'New\x20payout\x20created','completed':_0x6a133c(0x13c),'rejected':_0x6a133c(0xfb)},_0x29cea1=_0x3f9009[_0x410b72],_0xd98232=_0x426971[_0x410b72],_0x572a94=_0x29cea1+'\x20*'+_0xd98232+_0x6a133c(0x175)+('💸\x20Amount:\x20*'+_0x297c22['amount']+_0x6a133c(0x106))+(_0x6a133c(0x171)+_0x297c22[_0x6a133c(0xc2)]+'`\x0a')+(_0x6a133c(0x105)+_0x297c22['id']+'`\x0a')+(_0x6a133c(0xce)+new Date(_0x297c22[_0x6a133c(0xb3)])[_0x6a133c(0x10c)](_0x6a133c(0xca))+'\x0a')+(_0x297c22[_0x6a133c(0xf5)]?_0x6a133c(0x115)+_0x297c22['txid']+'`':'');await this[_0x6a133c(0xeb)](_0x42d7fd,_0x572a94,{'parse_mode':_0x6a133c(0xa2)});}async[a55_0x534300(0x10a)](_0x4a1ca6,_0x320c5d){const _0x383ba1=a55_0x534300;try{const _0x1abd38=await database_1[_0x383ba1(0x16f)][_0x383ba1(0xe6)][_0x383ba1(0x13a)]({'where':{'shopId':_0x4a1ca6},'select':{'notificationLogin':!![]}});if(!_0x1abd38?.[_0x383ba1(0x173)]){console['log']('📱\x20Login\x20notifications\x20disabled\x20for\x20shop\x20'+_0x4a1ca6);return;}const _0x1db54c=_0x320c5d[_0x383ba1(0x147)]?'🔐':'🚨',_0x225103=_0x320c5d[_0x383ba1(0x147)]?_0x383ba1(0x130):'Failed\x20login\x20attempt';let _0x49e897=_0x1db54c+'\x20*'+_0x225103+'*\x0a\x0a'+(_0x383ba1(0xcf)+_0x320c5d[_0x383ba1(0x15a)]+'`\x0a')+(_0x383ba1(0xe2)+_0x320c5d['timestamp'][_0x383ba1(0x10c)](_0x383ba1(0xca))+'\x0a');_0x320c5d[_0x383ba1(0x157)]&&(_0x49e897+=_0x383ba1(0x164)+_0x320c5d['ipAddress']+'`\x0a');if(_0x320c5d[_0x383ba1(0xef)]){const _0xfcaeff=_0x320c5d['userAgent'][_0x383ba1(0xb4)]>0x32?_0x320c5d[_0x383ba1(0xef)][_0x383ba1(0xdd)](0x0,0x32)+_0x383ba1(0x142):_0x320c5d['userAgent'];_0x49e897+=_0x383ba1(0x15f)+_0xfcaeff+'`\x0a';}!_0x320c5d[_0x383ba1(0x147)]&&(_0x49e897+=_0x383ba1(0x144)),await this[_0x383ba1(0xeb)](_0x4a1ca6,_0x49e897,{'parse_mode':_0x383ba1(0xa2)}),console[_0x383ba1(0x10d)](_0x383ba1(0xf6)+_0x4a1ca6+':\x20'+(_0x320c5d[_0x383ba1(0x147)]?_0x383ba1(0x147):_0x383ba1(0xdb)));}catch(_0x22e9d7){console[_0x383ba1(0x100)]('Failed\x20to\x20send\x20login\x20notification:',_0x22e9d7);}}async[a55_0x534300(0x15c)](_0x4aaa53,_0x2e3818){const _0x35b546=a55_0x534300;try{const _0x477da8=await database_1[_0x35b546(0x16f)][_0x35b546(0xe6)][_0x35b546(0x13a)]({'where':{'shopId':_0x4aaa53},'select':{'notificationApiError':!![]}});if(!_0x477da8?.[_0x35b546(0x117)]){console['log'](_0x35b546(0xee)+_0x4aaa53);return;}let _0x3611a1=_0x35b546(0xf2)+('🔗\x20Endpoint:\x20`'+_0x2e3818[_0x35b546(0xc2)]+'\x20'+_0x2e3818[_0x35b546(0xbe)]+'`\x0a')+(_0x35b546(0xe2)+_0x2e3818['timestamp'][_0x35b546(0x10c)]('en-US')+'\x0a');_0x2e3818['statusCode']&&(_0x3611a1+='📊\x20Error\x20code:\x20`'+_0x2e3818[_0x35b546(0x166)]+'`\x0a'),_0x3611a1+=_0x35b546(0x177)+_0x2e3818[_0x35b546(0xbd)]+'`\x0a',_0x2e3818[_0x35b546(0xdf)]&&(_0x3611a1+=_0x35b546(0xb1)+_0x2e3818[_0x35b546(0xdf)]+'`\x0a'),_0x3611a1+=_0x35b546(0x108),await this['sendShopNotification'](_0x4aaa53,_0x3611a1,{'parse_mode':_0x35b546(0xa2)}),console['log'](_0x35b546(0xfe)+_0x4aaa53+':\x20'+_0x2e3818[_0x35b546(0xbe)]);}catch(_0x451f5a){console[_0x35b546(0x100)](_0x35b546(0xa8),_0x451f5a);}}async['sendCustomNotification'](_0x17d713,_0x13f776,_0x7348f){const _0x408f17=a55_0x534300;let _0x3f1526=_0x408f17(0xb8)+_0x13f776+_0x408f17(0x175);for(const [_0x4a950b,_0x204f2a]of Object[_0x408f17(0x16e)](_0x7348f)){_0x204f2a!==null&&_0x204f2a!==undefined&&(_0x3f1526+=_0x4a950b+':\x20`'+_0x204f2a+'`\x0a');}await this[_0x408f17(0xeb)](_0x17d713,_0x3f1526,{'parse_mode':'Markdown'});}[a55_0x534300(0x14e)](){const _0x4edc49=a55_0x534300;return{'isActive':!!this[_0x4edc49(0xbb)],'username':this[_0x4edc49(0x180)]};}['stopBot'](){const _0x1ebec4=a55_0x534300;this[_0x1ebec4(0xbb)]&&(this['bot'][_0x1ebec4(0x112)](),this[_0x1ebec4(0xbb)]=null,console['log'](_0x1ebec4(0xa3)));}}function a55_0x3b88(){const _0xba7d42=['entries','default','Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`','🏦\x20Method:\x20`','map','notificationLogin','Error\x20handling\x20/debug\x20command:','*\x0a\x0a','trim','❌\x20Error:\x20`','join','...\x22','✅\x20Welcome\x20back!\x0a\x0a','create','7772457iDsmCg','Telegram\x20bot\x20polling\x20error:','TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables',':\x20username=\x22','botUsername','sendPaymentNotification','unknown\x20shop','currency','Markdown','🛑\x20Telegram\x20bot\x20stopped','📱\x20Shop:\x20*','orderId','customerName','adminNotes','Failed\x20to\x20send\x20API\x20error\x20notification:','•\x20New\x20payments\x0a','Check\x20spelling\x20and\x20try\x20again.','onText','Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).','sendMessage','findFirst','✅\x20Telegram\x20bot\x20@','allSettled','🆔\x20Request\x20ID:\x20`','❌\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a','createdAt','length','polling_error','❌\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20','Example:\x0a','🔔\x20*','1659465bzFbtR','❌\x20Failed\x20to\x20initialize\x20Telegram\x20bot:','bot','\x20(@','errorMessage','endpoint','updatedAt','telegramId','❗️\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!','method','Payment\x20failed','📊\x20*Connection\x20Status*\x0a\x0a','🔔\x20You\x20receive\x20notifications\x20about:\x0a','📝\x20Format:\x20`username\x20api_key`\x0a\x0a','customerEmail','blocked','🔔\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a','en-US','User\x20','first_name','botToken','📅\x20Date:\x20','👤\x20Username:\x20`','secretKey','❌\x20Please\x20use\x20/start\x20command\x20first','📱\x20Telegram\x20notification:\x20gateway\x20\x22','initializeBot','trapay_bot','💰\x20Amount:\x20*','text','5BJOqHQ','/status\x20-\x20check\x20connection\x20status\x0a','1159036udJUBx','🎉\x20*Congratulations!*\x0a\x0a','failed','\x20parts:\x20','substring','✅\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*','requestId','Telegram\x20bot\x20error:','Payment\x20chargeback','📅\x20Time:\x20','`\x20not\x20found.\x0a\x0a','Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a','🏦\x20IBAN:\x20`','shopSettings','last_name','`\x0a\x0a','chat\x20not\x20found','setupBotHandlers','sendShopNotification','\x20USDT*\x0a','Commands:\x0a','📱\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20','userAgent','shopId','Error\x20handling\x20/disconnect\x20command:','🚨\x20*API\x20Error*\x0a\x0a','warn','ACTIVE','txid','✅\x20Login\x20notification\x20sent\x20for\x20shop\x20','findMany','❌\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a','../types/gateway','sendPayoutNotification','Payout\x20rejected','🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20','✅\x20Notification\x20sent\x20to\x20Telegram\x20user\x20','✅\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20','Payment\x20expired','error','status','•\x20Important\x20events\x0a\x0a','\x20disconnected\x20from\x20shop\x20','/disconnect\x20-\x20disconnect\x20from\x20notifications','🆔\x20Payout\x20ID:\x20`','\x20USD*\x0a','...`\x0a\x0a','\x0a💡\x20Check\x20your\x20request\x20or\x20contact\x20support.','\x20\x20\x20Public\x20Key:\x20`','sendLoginNotification','TELEGRAM_BOT_TOKEN','toLocaleString','log','message','customerUa','`.\x0a\x0a','\x20via\x20single-line\x20input','stopPolling','Use\x20/start\x20to\x20begin.','telegramBotService','🔗\x20TXID:\x20`','To\x20reconnect,\x20use\x20the\x20/start\x20command','notificationApiError','✅\x20Connected\x20to\x20shop:\x20*','✅\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a','\x0aCheck\x20spelling\x20and\x20try\x20again.','getGatewayDisplayNameForTelegram','node-telegram-bot-api','\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure','1025289roElCz','\x20verified\x20for\x20shop\x20','📅\x20Connection\x20date:\x20','\x22\x20->\x20display\x20\x22','telegramUser','1825038uAEaAZ','chat','customerIp','toLocaleDateString','Error\x20in\x20handleSingleLineVerification:','startsWith','📛\x20Name:\x20`','❌\x20Invalid\x20username\x20format:\x20`','pk_','•\x20Payment\x20status\x20changes\x0a','defineProperty','Contact\x20administrator.','❌\x20API\x20key\x20does\x20not\x20match\x20shop\x20`','Successful\x20login','❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','includes','\x22,\x20apiKey=\x22','Error\x20sending\x20shop\x20notification:','❌\x20Shop\x20`','*.\x0a\x0a','chargeback','`\x20(','name','findUnique','toString','Payout\x20completed','📧\x20Email:\x20`','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','Error\x20handling\x20/start\x20command:','\x20\x20\x20Username:\x20`','.\x20*','...','6268098xxsJIk','\x0a⚠️\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!','from','Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification','success','🏪\x20Gateway:\x20`','✅\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*','update','handleSingleLineVerification','Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.','__esModule','getBotInfo','🌐\x20IP:\x20`','✅\x20Telegram\x20user\x20','publicKey','split','📝\x20Order\x20ID:\x20`','TelegramBotService','\x0a👤\x20*Customer\x20Information:*\x0a','gateway','ipAddress','To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a','New\x20payment\x20created','username','forEach','sendApiErrorNotification','🤖\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a','isVerified','💻\x20Browser:\x20`','API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','shop','chargebackAmount','⏳\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a','🌐\x20IP\x20address:\x20`','remitterIban','statusCode','•\x20Payouts\x0a','125538CHnXbM','Error\x20handling\x20/status\x20command:','🔄\x20Reset\x20incomplete\x20verification\x20for\x20user\x20','`\x20is\x20inactive.\x0a\x0a','200ONznpX','📱\x20Created\x20new\x20Telegram\x20user:\x20'];a55_0x3b88=function(){return _0xba7d42;};return a55_0x3b88();}exports[a55_0x534300(0x154)]=TelegramBotService,exports[a55_0x534300(0x114)]=new TelegramBotService();