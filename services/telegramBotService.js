'use strict';const a55_0x252d48=a55_0x2fd5;(function(_0x109e8c,_0x6694e2){const _0x557ae2=a55_0x2fd5,_0x793d2a=_0x109e8c();while(!![]){try{const _0x54326e=parseInt(_0x557ae2(0xdd))/0x1+-parseInt(_0x557ae2(0xcf))/0x2+parseInt(_0x557ae2(0x127))/0x3+parseInt(_0x557ae2(0x103))/0x4+-parseInt(_0x557ae2(0xb2))/0x5+parseInt(_0x557ae2(0xa5))/0x6+-parseInt(_0x557ae2(0x123))/0x7;if(_0x54326e===_0x6694e2)break;else _0x793d2a['push'](_0x793d2a['shift']());}catch(_0x549cb4){_0x793d2a['push'](_0x793d2a['shift']());}}}(a55_0x29c8,0x97118));function a55_0x29c8(){const _0x11f819=['\x20\x20\x20Username:\x20`','initializeBot','📱\x20Login\x20notifications\x20disabled\x20for\x20shop\x20','warn','chat','🔔\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a','448608NRlqnZ','errorMessage','sendLoginNotification','🏪\x20Gateway:\x20`','No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20','toString','✅\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*','message','Error\x20handling\x20/disconnect\x20command:','User\x20','🆔\x20Payout\x20ID:\x20`','✅\x20Connected\x20to\x20shop:\x20*','status','🎉\x20*Congratulations!*\x0a\x0a','1206542vTytIW','entries','🆔\x20Request\x20ID:\x20`','telegramBotService','txid','❌\x20Please\x20use\x20/start\x20command\x20first','•\x20Payment\x20status\x20changes\x0a','❌\x20Invalid\x20username\x20format:\x20`','/status\x20-\x20check\x20connection\x20status\x0a','📱\x20Shop:\x20*','📊\x20*Connection\x20Status*\x0a\x0a','failed','•\x20Payouts\x0a','✅\x20Telegram\x20user\x20','allSettled','getBotInfo','node-telegram-bot-api','processing','\x20verified\x20for\x20shop\x20','Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`','onText','📅\x20Time:\x20','You\x20are\x20already\x20connected\x20to\x20shop:\x20*','\x0a⚠️\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!','customerUa','🏪\x20Available\x20shops\x20in\x20system:\x0a',':\x20username=\x22','/disconnect\x20-\x20disconnect\x20from\x20notifications','❌\x20Shop\x20with\x20username\x20`','Payment\x20refund','`\x20is\x20inactive.\x0a\x0a','🔔\x20Notifications\x20are\x20active\x0a\x0a','TELEGRAM_BOT_TOKEN','create','API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','toLocaleString','Use\x20/start\x20to\x20connect.','customerName','2674204JcYErp','🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20','Failed\x20login\x20attempt','❌\x20Error:\x20`','\x20initialized\x20successfully','ipAddress','handleSingleLineVerification','sendMessage','Example:\x0a','Telegram\x20bot\x20polling\x20error:','\x0a👤\x20*Customer\x20Information:*\x0a','Payout\x20completed','length','\x22\x20->\x20display\x20\x22','...\x22','adminNotes','includes','gateway','from','error','toLocaleDateString','secretKey','getGatewayDisplayNameForTelegram','notificationApiError','last_name','💸\x20Penalty\x20amount:\x20*','substring','✅\x20Notification\x20sent\x20to\x20Telegram\x20user\x20','telegramUser','findFirst','sendShopNotification','Payout\x20rejected','20602106urHkzK','TelegramBotService','shop','isVerified','3268524aaiMQo','❌\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`','📅\x20Date:\x20','*.\x0a\x0a','Payment\x20expired','🔔\x20*','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','❌\x20An\x20error\x20occurred\x20while\x20verifying\x20data.','stopPolling','✅\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a','username','...`\x0a\x0a','trapay_bot','❌\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20','setupBotHandlers','requestId','success','endpoint','sendPayoutNotification','Commands:\x0a','sendPaymentNotification','split','Payment\x20is\x20being\x20processed','method','🌐\x20IP:\x20`','customerEmail','\x20\x20\x20Status:\x20',':\x20`','•\x20`','default','env','blocked','📝\x20Format:\x20`username\x20api_key`\x0a\x0a','text','Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.','Contact\x20administrator.','remitterIban','\x20parts:\x20','📱\x20Telegram\x20notification:\x20gateway\x20\x22','currency','chargebackAmount','💰\x20Amount:\x20*','chargeback','🛑\x20Telegram\x20bot\x20stopped','Error\x20in\x20handleSingleLineVerification:','🔔\x20You\x20receive\x20notifications\x20about:\x0a','shopSettings','`.\x0a\x0a','Successful\x20login','telegramId','test','Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification','\x20\x20\x20Public\x20Key:\x20`','*\x0a\x0a','❌\x20Invalid\x20API\x20key\x20format.\x0a\x0a','❗️\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!','publicKey','findMany','updatedAt','📊\x20Error\x20code:\x20`','first_name','.\x20*','update','❌\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a','\x20disconnected\x20from\x20shop\x20','`\x20(','pk_','🔄\x20Reset\x20incomplete\x20verification\x20for\x20user\x20','Markdown','\x20via\x20single-line\x20input','📧\x20Email:\x20`','statusCode','user\x20is\x20deactivated','✅\x20Login\x20notification\x20sent\x20for\x20shop\x20','botToken','startsWith','👤\x20Username:\x20`','\x20USDT*\x0a','📱\x20Your\x20Telegram\x20ID:\x20`','botUsername','🔗\x20TXID:\x20`','To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a','You\x20sent\x20','💻\x20Browser:\x20`','•\x20Important\x20events\x0a\x0a','Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a','../config/database','7270374qgfgzC','log','userAgent','Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).','__importDefault','sendApiErrorNotification','📝\x20Order\x20ID:\x20`','❌\x20Shop\x20`','Payment\x20failed','map','en-US','trim','\x22,\x20apiKey=\x22','1950460JABGAu','❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','customerIp','Payment\x20chargeback','New\x20payment\x20created','`\x20not\x20found.\x0a\x0a','shopId','bot','amount','\x20USD*\x0a','💸\x20Amount:\x20*','...','🆔\x20Payment\x20ID:\x20`','__esModule','✅\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20','🔌\x20User\x20','sk_','❌\x20API\x20key\x20does\x20not\x20match\x20shop\x20`','name','findUnique','\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure','`\x0a\x0a','✅\x20Telegram\x20bot\x20@'];a55_0x29c8=function(){return _0x11f819;};return a55_0x29c8();}function a55_0x2fd5(_0x83ac5,_0x3cebca){const _0x29c8ed=a55_0x29c8();return a55_0x2fd5=function(_0x2fd560,_0x435215){_0x2fd560=_0x2fd560-0x6d;let _0x1ff455=_0x29c8ed[_0x2fd560];return _0x1ff455;},a55_0x2fd5(_0x83ac5,_0x3cebca);}var __importDefault=this&&this[a55_0x252d48(0xa9)]||function(_0x327a19){const _0x382574=a55_0x252d48;return _0x327a19&&_0x327a19[_0x382574(0xbf)]?_0x327a19:{'default':_0x327a19};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a55_0x252d48(0xe0)]=exports['TelegramBotService']=void 0x0;const node_telegram_bot_api_1=__importDefault(require(a55_0x252d48(0xed))),database_1=__importDefault(require(a55_0x252d48(0xa4))),gateway_1=require('../types/gateway');class TelegramBotService{constructor(){const _0x2627fa=a55_0x252d48;this[_0x2627fa(0xb9)]=null,this[_0x2627fa(0x98)]=process[_0x2627fa(0x145)][_0x2627fa(0xfd)]||'',this[_0x2627fa(0x9d)]=process['env']['TELEGRAM_BOT_USERNAME']||_0x2627fa(0x133),this[_0x2627fa(0x98)]?this[_0x2627fa(0xca)]():console[_0x2627fa(0xcc)]('TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables');}['initializeBot'](){const _0x2c45ae=a55_0x252d48;try{this[_0x2c45ae(0xb9)]=new node_telegram_bot_api_1[(_0x2c45ae(0x144))](this[_0x2c45ae(0x98)],{'polling':!![]}),this[_0x2c45ae(0x135)](),console[_0x2c45ae(0xa6)](_0x2c45ae(0xc8)+this[_0x2c45ae(0x9d)]+_0x2c45ae(0x107));}catch(_0x264557){console[_0x2c45ae(0x116)]('❌\x20Failed\x20to\x20initialize\x20Telegram\x20bot:',_0x264557);}}[a55_0x252d48(0x135)](){const _0x407dfe=a55_0x252d48;if(!this[_0x407dfe(0xb9)])return;this[_0x407dfe(0xb9)][_0x407dfe(0xf1)](/\/start/,async _0x4fa610=>{const _0x29cd0d=_0x407dfe,_0x1e4841=_0x4fa610['chat']['id'],_0x4a9178=_0x4fa610[_0x29cd0d(0x115)]?.['id']['toString'](),_0x438810=_0x4fa610[_0x29cd0d(0x115)]?.[_0x29cd0d(0x131)],_0x56759c=_0x4fa610[_0x29cd0d(0x115)]?.[_0x29cd0d(0x8a)],_0x1c9cb2=_0x4fa610['from']?.[_0x29cd0d(0x11b)];if(!_0x4a9178)return;try{let _0x3b7677=await database_1['default'][_0x29cd0d(0x11f)]['findUnique']({'where':{'telegramId':_0x4a9178},'include':{'shop':!![]}});!_0x3b7677?(_0x3b7677=await database_1['default'][_0x29cd0d(0x11f)][_0x29cd0d(0xfe)]({'data':{'telegramId':_0x4a9178,'username':_0x438810,'firstName':_0x56759c,'lastName':_0x1c9cb2,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console[_0x29cd0d(0xa6)]('📱\x20Created\x20new\x20Telegram\x20user:\x20'+_0x4a9178+'\x20(@'+_0x438810+')')):_0x3b7677=await database_1['default']['telegramUser'][_0x29cd0d(0x8c)]({'where':{'telegramId':_0x4a9178},'data':{'username':_0x438810,'firstName':_0x56759c,'lastName':_0x1c9cb2},'include':{'shop':!![]}}),_0x3b7677[_0x29cd0d(0x126)]&&_0x3b7677[_0x29cd0d(0xb8)]&&_0x3b7677[_0x29cd0d(0x125)]?await this[_0x29cd0d(0xb9)]?.[_0x29cd0d(0x10a)](_0x1e4841,'✅\x20Welcome\x20back!\x0a\x0a'+(_0x29cd0d(0xf3)+_0x3b7677[_0x29cd0d(0x125)][_0x29cd0d(0xc4)]+'*\x0a')+('Username:\x20`'+_0x3b7677[_0x29cd0d(0x125)][_0x29cd0d(0x131)]+_0x29cd0d(0xc7))+_0x29cd0d(0x7b)+'•\x20New\x20payments\x0a'+_0x29cd0d(0xe3)+'•\x20Payouts\x0a\x0a'+_0x29cd0d(0x13a)+_0x29cd0d(0xe5)+_0x29cd0d(0xf8),{'parse_mode':'Markdown'}):(_0x3b7677[_0x29cd0d(0xb8)]&&!_0x3b7677[_0x29cd0d(0x126)]&&(await database_1['default'][_0x29cd0d(0x11f)][_0x29cd0d(0x8c)]({'where':{'telegramId':_0x4a9178},'data':{'shopId':null,'isVerified':![]}}),console[_0x29cd0d(0xa6)](_0x29cd0d(0x91)+_0x4a9178)),await this[_0x29cd0d(0xb9)]?.['sendMessage'](_0x1e4841,'🤖\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a'+_0x29cd0d(0x9f)+_0x29cd0d(0x6e)+_0x29cd0d(0x10b)+_0x29cd0d(0x12d)+_0x29cd0d(0x85),{'parse_mode':_0x29cd0d(0x92)}));}catch(_0x1de3b6){console[_0x29cd0d(0x116)]('Error\x20handling\x20/start\x20command:',_0x1de3b6),await this['bot']?.[_0x29cd0d(0x10a)](_0x1e4841,'❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this[_0x407dfe(0xb9)][_0x407dfe(0xf1)](/\/disconnect/,async _0x654d16=>{const _0x1f8e45=_0x407dfe,_0x4d5433=_0x654d16['chat']['id'],_0x30a68f=_0x654d16[_0x1f8e45(0x115)]?.['id'][_0x1f8e45(0xd4)]();if(!_0x30a68f)return;try{const _0xe4737b=await database_1[_0x1f8e45(0x144)][_0x1f8e45(0x11f)][_0x1f8e45(0xc5)]({'where':{'telegramId':_0x30a68f},'include':{'shop':!![]}});if(!_0xe4737b||!_0xe4737b[_0x1f8e45(0x126)]||!_0xe4737b[_0x1f8e45(0xb8)]){await this[_0x1f8e45(0xb9)]?.[_0x1f8e45(0x10a)](_0x4d5433,'❌\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.');return;}const _0xf2940c=_0xe4737b[_0x1f8e45(0x125)]?.[_0x1f8e45(0xc4)]||'unknown\x20shop';await database_1['default'][_0x1f8e45(0x11f)]['update']({'where':{'telegramId':_0x30a68f},'data':{'shopId':null,'isVerified':![]}}),console[_0x1f8e45(0xa6)](_0x1f8e45(0xc1)+_0x30a68f+_0x1f8e45(0x8e)+_0xe4737b[_0x1f8e45(0xb8)]),await this['bot']?.['sendMessage'](_0x4d5433,'✅\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*'+_0xf2940c+_0x1f8e45(0x12a)+'To\x20reconnect,\x20use\x20the\x20/start\x20command',{'parse_mode':'Markdown'});}catch(_0x2944f7){console[_0x1f8e45(0x116)](_0x1f8e45(0xd7),_0x2944f7),await this[_0x1f8e45(0xb9)]?.[_0x1f8e45(0x10a)](_0x4d5433,_0x1f8e45(0xb3));}}),this[_0x407dfe(0xb9)][_0x407dfe(0xf1)](/\/status/,async _0x412c30=>{const _0x5e59a5=_0x407dfe,_0x2e7caa=_0x412c30[_0x5e59a5(0xcd)]['id'],_0x2a5864=_0x412c30['from']?.['id'][_0x5e59a5(0xd4)]();if(!_0x2a5864)return;try{const _0x30f2e9=await database_1[_0x5e59a5(0x144)][_0x5e59a5(0x11f)]['findUnique']({'where':{'telegramId':_0x2a5864},'include':{'shop':!![]}});if(!_0x30f2e9){await this['bot']?.[_0x5e59a5(0x10a)](_0x2e7caa,_0x5e59a5(0x8d)+'Use\x20/start\x20to\x20begin.');return;}if(!_0x30f2e9[_0x5e59a5(0x126)]||!_0x30f2e9[_0x5e59a5(0xb8)]||!_0x30f2e9[_0x5e59a5(0x125)]){await this[_0x5e59a5(0xb9)]?.[_0x5e59a5(0x10a)](_0x2e7caa,'❌\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a'+_0x5e59a5(0x101));return;}await this[_0x5e59a5(0xb9)]?.[_0x5e59a5(0x10a)](_0x2e7caa,_0x5e59a5(0xe7)+(_0x5e59a5(0xda)+_0x30f2e9['shop'][_0x5e59a5(0xc4)]+'*\x0a')+('👤\x20Username:\x20`'+_0x30f2e9[_0x5e59a5(0x125)][_0x5e59a5(0x131)]+'`\x0a')+('📅\x20Connection\x20date:\x20'+_0x30f2e9[_0x5e59a5(0x88)][_0x5e59a5(0x117)](_0x5e59a5(0xaf))+'\x0a\x0a')+_0x5e59a5(0xfc)+_0x5e59a5(0x13a)+_0x5e59a5(0xf8),{'parse_mode':'Markdown'});}catch(_0x1da1a3){console[_0x5e59a5(0x116)]('Error\x20handling\x20/status\x20command:',_0x1da1a3),await this['bot']?.[_0x5e59a5(0x10a)](_0x2e7caa,_0x5e59a5(0xb3));}}),this[_0x407dfe(0xb9)][_0x407dfe(0xf1)](/\/debug/,async _0x4c93db=>{const _0x532e6f=_0x407dfe,_0xe3c957=_0x4c93db['chat']['id'],_0x2b8877=_0x4c93db[_0x532e6f(0x115)]?.['id'][_0x532e6f(0xd4)]();if(!_0x2b8877)return;try{const _0x12c673=await database_1[_0x532e6f(0x144)][_0x532e6f(0x125)]['findMany']({'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![]},'take':0xa});let _0x55f199='🔍\x20*Debug\x20Information*\x0a\x0a';_0x55f199+=_0x532e6f(0x9c)+_0x2b8877+_0x532e6f(0xc7),_0x55f199+=_0x532e6f(0xf6),_0x12c673['forEach']((_0x397def,_0x4f6103)=>{const _0x1e4a4e=_0x532e6f;_0x55f199+=_0x4f6103+0x1+_0x1e4a4e(0x8b)+_0x397def[_0x1e4a4e(0xc4)]+'*\x0a',_0x55f199+=_0x1e4a4e(0xc9)+_0x397def[_0x1e4a4e(0x131)]+'`\x0a',_0x55f199+=_0x1e4a4e(0x141)+_0x397def[_0x1e4a4e(0xdb)]+'\x0a',_0x55f199+=_0x1e4a4e(0x82)+_0x397def['publicKey'][_0x1e4a4e(0x11d)](0x0,0xf)+_0x1e4a4e(0x132);}),await this[_0x532e6f(0xb9)]?.[_0x532e6f(0x10a)](_0xe3c957,_0x55f199,{'parse_mode':_0x532e6f(0x92)});}catch(_0xfff371){console[_0x532e6f(0x116)]('Error\x20handling\x20/debug\x20command:',_0xfff371),await this[_0x532e6f(0xb9)]?.[_0x532e6f(0x10a)](_0xe3c957,'❌\x20Error\x20getting\x20debug\x20information.');}}),this[_0x407dfe(0xb9)]['on'](_0x407dfe(0xd6),async _0x5cd933=>{const _0x4d07eb=_0x407dfe;if(_0x5cd933[_0x4d07eb(0x6f)]?.[_0x4d07eb(0x99)]('/'))return;const _0x32850b=_0x5cd933[_0x4d07eb(0xcd)]['id'],_0x182795=_0x5cd933['from']?.['id'][_0x4d07eb(0xd4)](),_0x8e6027=_0x5cd933[_0x4d07eb(0x6f)]?.[_0x4d07eb(0xb0)]();if(!_0x182795||!_0x8e6027)return;try{const _0x33ee5b=await database_1[_0x4d07eb(0x144)][_0x4d07eb(0x11f)]['findUnique']({'where':{'telegramId':_0x182795},'include':{'shop':!![]}});if(!_0x33ee5b){await this[_0x4d07eb(0xb9)]?.[_0x4d07eb(0x10a)](_0x32850b,_0x4d07eb(0xe2));return;}if(_0x33ee5b[_0x4d07eb(0x126)]&&_0x33ee5b['shopId']&&_0x33ee5b[_0x4d07eb(0x125)]){await this[_0x4d07eb(0xb9)]?.['sendMessage'](_0x32850b,_0x4d07eb(0xd5)+_0x33ee5b[_0x4d07eb(0x125)][_0x4d07eb(0xc4)]+_0x4d07eb(0x12a)+_0x4d07eb(0x70),{'parse_mode':'Markdown'});return;}const _0x28d1e1=_0x8e6027[_0x4d07eb(0x13c)](/\s+/);if(_0x28d1e1[_0x4d07eb(0x10f)]!==0x2){await this[_0x4d07eb(0xb9)]?.[_0x4d07eb(0x10a)](_0x32850b,'❌\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a'+'📝\x20Format:\x20`username\x20api_key`\x0a\x0a'+'Example:\x0a'+_0x4d07eb(0x12d)+(_0x4d07eb(0xa0)+_0x28d1e1[_0x4d07eb(0x10f)]+_0x4d07eb(0x73)+_0x28d1e1[_0x4d07eb(0xae)](_0x4d3136=>'`'+_0x4d3136+'`')['join'](',\x20')),{'parse_mode':_0x4d07eb(0x92)});return;}const [_0x3e69f2,_0x163bb3]=_0x28d1e1;console[_0x4d07eb(0xa6)](_0x4d07eb(0x104)+_0x182795+_0x4d07eb(0xf7)+_0x3e69f2+_0x4d07eb(0xb1)+_0x163bb3[_0x4d07eb(0x11d)](0x0,0xa)+_0x4d07eb(0x111)),await this['handleSingleLineVerification'](_0x32850b,_0x182795,_0x3e69f2,_0x163bb3);}catch(_0x5b998f){console[_0x4d07eb(0x116)]('Error\x20handling\x20message:',_0x5b998f),await this[_0x4d07eb(0xb9)]?.[_0x4d07eb(0x10a)](_0x32850b,_0x4d07eb(0xb3));}}),this[_0x407dfe(0xb9)]['on']('error',_0x32fee4=>{const _0x3c20fa=_0x407dfe;console[_0x3c20fa(0x116)]('Telegram\x20bot\x20error:',_0x32fee4);}),this[_0x407dfe(0xb9)]['on']('polling_error',_0x59bd7b=>{const _0x239fb6=_0x407dfe;console[_0x239fb6(0x116)](_0x239fb6(0x10c),_0x59bd7b);});}async[a55_0x252d48(0x109)](_0x1c9fd8,_0x38ce90,_0xa3d47,_0x50f613){const _0x566080=a55_0x252d48;try{console['log']('🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20'+_0x38ce90+_0x566080(0xf7)+_0xa3d47+_0x566080(0xb1)+_0x50f613[_0x566080(0x11d)](0x0,0xa)+'...\x22');if(!_0xa3d47||_0xa3d47['length']<0x3||_0xa3d47[_0x566080(0x10f)]>0x32||!/^[a-zA-Z0-9_]+$/[_0x566080(0x80)](_0xa3d47)){await this[_0x566080(0xb9)]?.['sendMessage'](_0x1c9fd8,_0x566080(0xe4)+_0xa3d47+_0x566080(0xc7)+_0x566080(0xa8),{'parse_mode':_0x566080(0x92)});return;}if(!_0x50f613||!_0x50f613[_0x566080(0x99)](_0x566080(0x90))&&!_0x50f613[_0x566080(0x99)](_0x566080(0xc2))){await this[_0x566080(0xb9)]?.['sendMessage'](_0x1c9fd8,_0x566080(0x84)+_0x566080(0xff),{'parse_mode':_0x566080(0x92)});return;}const _0x340bec=await database_1['default'][_0x566080(0x125)][_0x566080(0xc5)]({'where':{'username':_0xa3d47},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x340bec){const _0x1466d6=await database_1[_0x566080(0x144)][_0x566080(0x125)][_0x566080(0x87)]({'select':{'username':!![],'name':!![]},'take':0x5});let _0xd37717=_0x566080(0xf9)+_0xa3d47+_0x566080(0xb7);_0x1466d6[_0x566080(0x10f)]>0x0?(_0xd37717+='Available\x20usernames:\x0a',_0x1466d6['forEach'](_0x5353ff=>{const _0x4343fd=_0x566080;_0xd37717+=_0x4343fd(0x143)+_0x5353ff[_0x4343fd(0x131)]+_0x4343fd(0x8f)+_0x5353ff['name']+')\x0a';}),_0xd37717+='\x0aCheck\x20spelling\x20and\x20try\x20again.'):_0xd37717+='Check\x20spelling\x20and\x20try\x20again.';await this[_0x566080(0xb9)]?.[_0x566080(0x10a)](_0x1c9fd8,_0xd37717,{'parse_mode':_0x566080(0x92)});return;}if(_0x340bec[_0x566080(0xdb)]!=='ACTIVE'){await this[_0x566080(0xb9)]?.['sendMessage'](_0x1c9fd8,_0x566080(0xac)+_0xa3d47+_0x566080(0xfb)+_0x566080(0x71),{'parse_mode':'Markdown'});return;}if(_0x340bec[_0x566080(0x86)]!==_0x50f613&&_0x340bec[_0x566080(0x118)]!==_0x50f613){await this[_0x566080(0xb9)]?.[_0x566080(0x10a)](_0x1c9fd8,_0x566080(0xc3)+_0xa3d47+_0x566080(0x7d)+_0x566080(0xa3)+_0x566080(0xf0),{'parse_mode':_0x566080(0x92)});return;}const _0x461076=await database_1[_0x566080(0x144)][_0x566080(0x11f)][_0x566080(0x120)]({'where':{'shopId':_0x340bec['id'],'isVerified':!![],'telegramId':{'not':_0x38ce90}}});if(_0x461076){await this['bot']?.['sendMessage'](_0x1c9fd8,_0x566080(0x128)+_0xa3d47+_0x566080(0x7d)+'Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.',{'parse_mode':'Markdown'});return;}await database_1[_0x566080(0x144)][_0x566080(0x11f)][_0x566080(0x8c)]({'where':{'telegramId':_0x38ce90},'data':{'shopId':_0x340bec['id'],'isVerified':!![]}}),await this[_0x566080(0xb9)]?.[_0x566080(0x10a)](_0x1c9fd8,_0x566080(0xdc)+_0x566080(0x130)+(_0x566080(0xe6)+_0x340bec[_0x566080(0xc4)]+'*\x0a')+(_0x566080(0x9a)+_0x340bec[_0x566080(0x131)]+'`\x0a\x0a')+_0x566080(0xce)+'•\x20New\x20payments\x0a'+_0x566080(0xe3)+_0x566080(0xe9)+_0x566080(0xa2)+_0x566080(0x13a)+_0x566080(0xe5)+_0x566080(0xf8),{'parse_mode':'Markdown'}),console[_0x566080(0xa6)](_0x566080(0xea)+_0x38ce90+_0x566080(0xef)+_0x340bec[_0x566080(0x131)]+_0x566080(0x93));}catch(_0x2e158d){console[_0x566080(0x116)](_0x566080(0x7a),_0x2e158d),await this[_0x566080(0xb9)]?.[_0x566080(0x10a)](_0x1c9fd8,_0x566080(0x12e));}}async['sendShopNotification'](_0x39adda,_0x1c6b22,_0x588edb){const _0x1f4cbf=a55_0x252d48;if(!this[_0x1f4cbf(0xb9)]){console[_0x1f4cbf(0xcc)](_0x1f4cbf(0x81));return;}try{const _0x16df65=await database_1['default'][_0x1f4cbf(0x11f)][_0x1f4cbf(0x87)]({'where':{'shopId':_0x39adda,'isVerified':!![]}});if(_0x16df65[_0x1f4cbf(0x10f)]===0x0){console[_0x1f4cbf(0xa6)](_0x1f4cbf(0xd3)+_0x39adda);return;}const _0x4d6e47=_0x16df65[_0x1f4cbf(0xae)](async _0x33e5dc=>{const _0x3c37c1=_0x1f4cbf;try{await this[_0x3c37c1(0xb9)]?.[_0x3c37c1(0x10a)](_0x33e5dc['telegramId'],_0x1c6b22,_0x588edb),console[_0x3c37c1(0xa6)](_0x3c37c1(0x11e)+_0x33e5dc[_0x3c37c1(0x7f)]);}catch(_0x5262aa){console[_0x3c37c1(0x116)](_0x3c37c1(0x134)+_0x33e5dc['telegramId']+':',_0x5262aa),_0x5262aa instanceof Error&&(_0x5262aa[_0x3c37c1(0xd6)][_0x3c37c1(0x113)](_0x3c37c1(0x6d))||_0x5262aa[_0x3c37c1(0xd6)]['includes']('chat\x20not\x20found')||_0x5262aa[_0x3c37c1(0xd6)][_0x3c37c1(0x113)](_0x3c37c1(0x96)))&&(await database_1[_0x3c37c1(0x144)]['telegramUser'][_0x3c37c1(0x8c)]({'where':{'id':_0x33e5dc['id']},'data':{'isVerified':![]}}),console[_0x3c37c1(0xa6)](_0x3c37c1(0xd8)+_0x33e5dc['telegramId']+_0x3c37c1(0xc6)));}});await Promise[_0x1f4cbf(0xeb)](_0x4d6e47);}catch(_0x1f28ea){console[_0x1f4cbf(0x116)]('Error\x20sending\x20shop\x20notification:',_0x1f28ea);}}async[a55_0x252d48(0x13b)](_0x2f1696,_0x32af8c,_0x240be0){const _0x54781c=a55_0x252d48,_0x295f58={'created':'🆕','paid':'✅','failed':'❌','expired':'⏰','refund':'🔄','chargeback':'⚠️','processing':'⚙️'},_0x4ce733={'created':_0x54781c(0xb6),'paid':'Payment\x20successfully\x20paid','failed':_0x54781c(0xad),'expired':_0x54781c(0x12b),'refund':_0x54781c(0xfa),'chargeback':_0x54781c(0xb5),'processing':_0x54781c(0x13d)},_0xb00592=_0x295f58[_0x240be0],_0x34c06e=_0x4ce733[_0x240be0],_0x2f8855=(0x0,gateway_1[_0x54781c(0x119)])(_0x32af8c[_0x54781c(0x114)]);console['log'](_0x54781c(0x74)+_0x32af8c[_0x54781c(0x114)]+_0x54781c(0x110)+_0x2f8855+'\x22');let _0x4d8a49=_0xb00592+'\x20*'+_0x34c06e+_0x54781c(0x83)+(_0x54781c(0x77)+_0x32af8c[_0x54781c(0xba)]+'\x20'+_0x32af8c[_0x54781c(0x75)]+'*\x0a')+(_0x54781c(0xab)+(_0x32af8c['orderId']||_0x32af8c['id'])+'`\x0a')+(_0x54781c(0xbe)+_0x32af8c['id']+'`\x0a')+(_0x54781c(0xd2)+_0x2f8855+'`\x0a')+(_0x54781c(0x129)+new Date(_0x32af8c['createdAt'])['toLocaleString'](_0x54781c(0xaf))+'\x0a');if(_0x32af8c[_0x54781c(0x102)]||_0x32af8c[_0x54781c(0x140)]||_0x32af8c['remitterIban']||_0x32af8c['customerIp']||_0x32af8c[_0x54781c(0xf5)]){_0x4d8a49+=_0x54781c(0x10d);_0x32af8c[_0x54781c(0x102)]&&(_0x4d8a49+='📛\x20Name:\x20`'+_0x32af8c[_0x54781c(0x102)]+'`\x0a');_0x32af8c[_0x54781c(0x140)]&&(_0x4d8a49+=_0x54781c(0x94)+_0x32af8c[_0x54781c(0x140)]+'`\x0a');_0x32af8c[_0x54781c(0x72)]&&(_0x4d8a49+='🏦\x20IBAN:\x20`'+_0x32af8c['remitterIban']+'`\x0a');_0x32af8c[_0x54781c(0xb4)]&&(_0x4d8a49+=_0x54781c(0x13f)+_0x32af8c[_0x54781c(0xb4)]+'`\x0a');if(_0x32af8c[_0x54781c(0xf5)]){const _0x1743a4=_0x32af8c[_0x54781c(0xf5)][_0x54781c(0x10f)]>0x32?_0x32af8c[_0x54781c(0xf5)][_0x54781c(0x11d)](0x0,0x32)+_0x54781c(0xbd):_0x32af8c[_0x54781c(0xf5)];_0x4d8a49+=_0x54781c(0xa1)+_0x1743a4+'`\x0a';}}_0x240be0===_0x54781c(0x78)&&_0x32af8c[_0x54781c(0x76)]&&(_0x4d8a49+=_0x54781c(0x11c)+_0x32af8c[_0x54781c(0x76)]+_0x54781c(0x9b)),_0x240be0===_0x54781c(0xee)&&(_0x4d8a49+='⏳\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a'),_0x32af8c[_0x54781c(0x112)]&&(_0x4d8a49+='📝\x20Notes:\x20'+_0x32af8c['adminNotes']+'\x0a'),await this[_0x54781c(0x121)](_0x2f1696,_0x4d8a49,{'parse_mode':_0x54781c(0x92)});}async[a55_0x252d48(0x139)](_0x1c75ce,_0x1b6272,_0x3475f4){const _0x1bc086=a55_0x252d48,_0x1ef6be={'created':'📤','completed':'✅','rejected':'❌'},_0x26f4f2={'created':'New\x20payout\x20created','completed':_0x1bc086(0x10e),'rejected':_0x1bc086(0x122)},_0x4ed435=_0x1ef6be[_0x3475f4],_0x3e67b5=_0x26f4f2[_0x3475f4],_0x3463a3=_0x4ed435+'\x20*'+_0x3e67b5+_0x1bc086(0x83)+(_0x1bc086(0xbc)+_0x1b6272['amount']+_0x1bc086(0xbb))+('🏦\x20Method:\x20`'+_0x1b6272[_0x1bc086(0x13e)]+'`\x0a')+(_0x1bc086(0xd9)+_0x1b6272['id']+'`\x0a')+(_0x1bc086(0x129)+new Date(_0x1b6272['createdAt'])[_0x1bc086(0x100)]('en-US')+'\x0a')+(_0x1b6272['txid']?_0x1bc086(0x9e)+_0x1b6272[_0x1bc086(0xe1)]+'`':'');await this['sendShopNotification'](_0x1c75ce,_0x3463a3,{'parse_mode':_0x1bc086(0x92)});}async[a55_0x252d48(0xd1)](_0x5ac3c8,_0x4d8aa2){const _0x1b3010=a55_0x252d48;try{const _0x30d895=await database_1[_0x1b3010(0x144)][_0x1b3010(0x7c)][_0x1b3010(0xc5)]({'where':{'shopId':_0x5ac3c8},'select':{'notificationLogin':!![]}});if(!_0x30d895?.['notificationLogin']){console[_0x1b3010(0xa6)](_0x1b3010(0xcb)+_0x5ac3c8);return;}const _0xd3dc35=_0x4d8aa2[_0x1b3010(0x137)]?'🔐':'🚨',_0x1734bd=_0x4d8aa2[_0x1b3010(0x137)]?_0x1b3010(0x7e):_0x1b3010(0x105);let _0x21895a=_0xd3dc35+'\x20*'+_0x1734bd+'*\x0a\x0a'+('👤\x20Username:\x20`'+_0x4d8aa2[_0x1b3010(0x131)]+'`\x0a')+(_0x1b3010(0xf2)+_0x4d8aa2['timestamp'][_0x1b3010(0x100)](_0x1b3010(0xaf))+'\x0a');_0x4d8aa2[_0x1b3010(0x108)]&&(_0x21895a+='🌐\x20IP\x20address:\x20`'+_0x4d8aa2[_0x1b3010(0x108)]+'`\x0a');if(_0x4d8aa2[_0x1b3010(0xa7)]){const _0x126940=_0x4d8aa2[_0x1b3010(0xa7)]['length']>0x32?_0x4d8aa2[_0x1b3010(0xa7)]['substring'](0x0,0x32)+_0x1b3010(0xbd):_0x4d8aa2[_0x1b3010(0xa7)];_0x21895a+='💻\x20Browser:\x20`'+_0x126940+'`\x0a';}!_0x4d8aa2[_0x1b3010(0x137)]&&(_0x21895a+=_0x1b3010(0xf4)),await this[_0x1b3010(0x121)](_0x5ac3c8,_0x21895a,{'parse_mode':_0x1b3010(0x92)}),console['log'](_0x1b3010(0x97)+_0x5ac3c8+':\x20'+(_0x4d8aa2[_0x1b3010(0x137)]?'success':_0x1b3010(0xe8)));}catch(_0xe624ff){console[_0x1b3010(0x116)]('Failed\x20to\x20send\x20login\x20notification:',_0xe624ff);}}async[a55_0x252d48(0xaa)](_0x3e9d6d,_0x39deff){const _0x2abc49=a55_0x252d48;try{const _0x3202dc=await database_1[_0x2abc49(0x144)][_0x2abc49(0x7c)][_0x2abc49(0xc5)]({'where':{'shopId':_0x3e9d6d},'select':{'notificationApiError':!![]}});if(!_0x3202dc?.[_0x2abc49(0x11a)]){console[_0x2abc49(0xa6)]('📱\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20'+_0x3e9d6d);return;}let _0x2d4376='🚨\x20*API\x20Error*\x0a\x0a'+('🔗\x20Endpoint:\x20`'+_0x39deff[_0x2abc49(0x13e)]+'\x20'+_0x39deff[_0x2abc49(0x138)]+'`\x0a')+(_0x2abc49(0xf2)+_0x39deff['timestamp'][_0x2abc49(0x100)](_0x2abc49(0xaf))+'\x0a');_0x39deff['statusCode']&&(_0x2d4376+=_0x2abc49(0x89)+_0x39deff[_0x2abc49(0x95)]+'`\x0a'),_0x2d4376+=_0x2abc49(0x106)+_0x39deff[_0x2abc49(0xd0)]+'`\x0a',_0x39deff[_0x2abc49(0x136)]&&(_0x2d4376+=_0x2abc49(0xdf)+_0x39deff['requestId']+'`\x0a'),_0x2d4376+='\x0a💡\x20Check\x20your\x20request\x20or\x20contact\x20support.',await this[_0x2abc49(0x121)](_0x3e9d6d,_0x2d4376,{'parse_mode':_0x2abc49(0x92)}),console[_0x2abc49(0xa6)](_0x2abc49(0xc0)+_0x3e9d6d+':\x20'+_0x39deff[_0x2abc49(0x138)]);}catch(_0x1016e4){console[_0x2abc49(0x116)]('Failed\x20to\x20send\x20API\x20error\x20notification:',_0x1016e4);}}async['sendCustomNotification'](_0x3b8713,_0x43afe9,_0x1bf5d1){const _0x24ebeb=a55_0x252d48;let _0x50a601=_0x24ebeb(0x12c)+_0x43afe9+_0x24ebeb(0x83);for(const [_0x10f4fb,_0x4413ed]of Object[_0x24ebeb(0xde)](_0x1bf5d1)){_0x4413ed!==null&&_0x4413ed!==undefined&&(_0x50a601+=_0x10f4fb+_0x24ebeb(0x142)+_0x4413ed+'`\x0a');}await this[_0x24ebeb(0x121)](_0x3b8713,_0x50a601,{'parse_mode':_0x24ebeb(0x92)});}[a55_0x252d48(0xec)](){const _0x24d0f5=a55_0x252d48;return{'isActive':!!this[_0x24d0f5(0xb9)],'username':this['botUsername']};}['stopBot'](){const _0xadfe3b=a55_0x252d48;this[_0xadfe3b(0xb9)]&&(this[_0xadfe3b(0xb9)][_0xadfe3b(0x12f)](),this[_0xadfe3b(0xb9)]=null,console[_0xadfe3b(0xa6)](_0xadfe3b(0x79)));}}exports[a55_0x252d48(0x124)]=TelegramBotService,exports[a55_0x252d48(0xe0)]=new TelegramBotService();