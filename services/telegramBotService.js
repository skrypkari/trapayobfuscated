'use strict';function a54_0x51bd(_0x9d94a3,_0x1c4411){const _0x1a2818=a54_0x1a28();return a54_0x51bd=function(_0x51bdf4,_0xdad8bd){_0x51bdf4=_0x51bdf4-0x181;let _0x5c6d57=_0x1a2818[_0x51bdf4];return _0x5c6d57;},a54_0x51bd(_0x9d94a3,_0x1c4411);}const a54_0x24660e=a54_0x51bd;(function(_0x36f2ee,_0x571fdd){const _0xba0392=a54_0x51bd,_0x3a88fc=_0x36f2ee();while(!![]){try{const _0x32a6fe=parseInt(_0xba0392(0x1b4))/0x1*(parseInt(_0xba0392(0x25a))/0x2)+parseInt(_0xba0392(0x1cd))/0x3*(parseInt(_0xba0392(0x204))/0x4)+-parseInt(_0xba0392(0x214))/0x5+parseInt(_0xba0392(0x1e9))/0x6+-parseInt(_0xba0392(0x1b9))/0x7*(-parseInt(_0xba0392(0x183))/0x8)+-parseInt(_0xba0392(0x249))/0x9+-parseInt(_0xba0392(0x1d6))/0xa*(parseInt(_0xba0392(0x1e7))/0xb);if(_0x32a6fe===_0x571fdd)break;else _0x3a88fc['push'](_0x3a88fc['shift']());}catch(_0x1cd514){_0x3a88fc['push'](_0x3a88fc['shift']());}}}(a54_0x1a28,0x38f70));var __importDefault=this&&this[a54_0x24660e(0x1da)]||function(_0x38a82f){const _0x126e57=a54_0x24660e;return _0x38a82f&&_0x38a82f[_0x126e57(0x1d2)]?_0x38a82f:{'default':_0x38a82f};};Object[a54_0x24660e(0x1d1)](exports,'__esModule',{'value':!![]}),exports[a54_0x24660e(0x26b)]=exports['TelegramBotService']=void 0x0;const node_telegram_bot_api_1=__importDefault(require(a54_0x24660e(0x192))),database_1=__importDefault(require('../config/database')),gateway_1=require(a54_0x24660e(0x193));class TelegramBotService{constructor(){const _0x365b9f=a54_0x24660e;this[_0x365b9f(0x22a)]=null,this['botToken']=process[_0x365b9f(0x1bb)][_0x365b9f(0x250)]||'',this[_0x365b9f(0x1b5)]=process[_0x365b9f(0x1bb)]['TELEGRAM_BOT_USERNAME']||_0x365b9f(0x207),this['botToken']?this['initializeBot']():console[_0x365b9f(0x1f8)](_0x365b9f(0x217));}[a54_0x24660e(0x267)](){const _0x50c70d=a54_0x24660e;try{this['bot']=new node_telegram_bot_api_1[(_0x50c70d(0x199))](this[_0x50c70d(0x236)],{'polling':!![]}),this[_0x50c70d(0x24e)](),console[_0x50c70d(0x18b)](_0x50c70d(0x1b8)+this[_0x50c70d(0x1b5)]+_0x50c70d(0x251));}catch(_0x1668dd){console[_0x50c70d(0x1a7)]('❌\x20Failed\x20to\x20initialize\x20Telegram\x20bot:',_0x1668dd);}}['setupBotHandlers'](){const _0x1dbf91=a54_0x24660e;if(!this[_0x1dbf91(0x22a)])return;this[_0x1dbf91(0x22a)][_0x1dbf91(0x1d5)](/\/start/,async _0x5c6506=>{const _0x28cc23=_0x1dbf91,_0x1c7844=_0x5c6506[_0x28cc23(0x215)]['id'],_0x4e3fce=_0x5c6506[_0x28cc23(0x181)]?.['id'][_0x28cc23(0x246)](),_0x26b66f=_0x5c6506[_0x28cc23(0x181)]?.['username'],_0x27c061=_0x5c6506['from']?.[_0x28cc23(0x1cc)],_0x2b6ab8=_0x5c6506[_0x28cc23(0x181)]?.[_0x28cc23(0x1a5)];if(!_0x4e3fce)return;try{let _0x541f63=await database_1['default']['telegramUser']['findUnique']({'where':{'telegramId':_0x4e3fce},'include':{'shop':!![]}});!_0x541f63?(_0x541f63=await database_1[_0x28cc23(0x199)][_0x28cc23(0x195)][_0x28cc23(0x213)]({'data':{'telegramId':_0x4e3fce,'username':_0x26b66f,'firstName':_0x27c061,'lastName':_0x2b6ab8,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console[_0x28cc23(0x18b)]('📱\x20Created\x20new\x20Telegram\x20user:\x20'+_0x4e3fce+_0x28cc23(0x254)+_0x26b66f+')')):_0x541f63=await database_1['default'][_0x28cc23(0x195)]['update']({'where':{'telegramId':_0x4e3fce},'data':{'username':_0x26b66f,'firstName':_0x27c061,'lastName':_0x2b6ab8},'include':{'shop':!![]}}),_0x541f63['isVerified']&&_0x541f63[_0x28cc23(0x20a)]&&_0x541f63[_0x28cc23(0x258)]?await this['bot']?.[_0x28cc23(0x24b)](_0x1c7844,_0x28cc23(0x19f)+(_0x28cc23(0x19e)+_0x541f63['shop'][_0x28cc23(0x20e)]+'*\x0a')+(_0x28cc23(0x244)+_0x541f63[_0x28cc23(0x258)][_0x28cc23(0x1f6)]+_0x28cc23(0x18c))+_0x28cc23(0x1a1)+'•\x20New\x20payments\x0a'+_0x28cc23(0x22e)+'•\x20Payouts\x0a\x0a'+_0x28cc23(0x212)+_0x28cc23(0x269)+_0x28cc23(0x1b1),{'parse_mode':_0x28cc23(0x232)}):(_0x541f63[_0x28cc23(0x20a)]&&!_0x541f63[_0x28cc23(0x190)]&&(await database_1['default'][_0x28cc23(0x195)]['update']({'where':{'telegramId':_0x4e3fce},'data':{'shopId':null,'isVerified':![]}}),console[_0x28cc23(0x18b)](_0x28cc23(0x1e4)+_0x4e3fce)),await this[_0x28cc23(0x22a)]?.[_0x28cc23(0x24b)](_0x1c7844,'🤖\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a'+_0x28cc23(0x23c)+'📝\x20Format:\x20`username\x20api_key`\x0a\x0a'+_0x28cc23(0x20f)+_0x28cc23(0x1ad)+_0x28cc23(0x1df),{'parse_mode':'Markdown'}));}catch(_0x41b6b2){console[_0x28cc23(0x1a7)](_0x28cc23(0x225),_0x41b6b2),await this[_0x28cc23(0x22a)]?.[_0x28cc23(0x24b)](_0x1c7844,_0x28cc23(0x1bf));}}),this[_0x1dbf91(0x22a)]['onText'](/\/disconnect/,async _0x2e2256=>{const _0xe8ab8b=_0x1dbf91,_0x42386a=_0x2e2256[_0xe8ab8b(0x215)]['id'],_0x56cb42=_0x2e2256[_0xe8ab8b(0x181)]?.['id'][_0xe8ab8b(0x246)]();if(!_0x56cb42)return;try{const _0x304147=await database_1[_0xe8ab8b(0x199)]['telegramUser'][_0xe8ab8b(0x21d)]({'where':{'telegramId':_0x56cb42},'include':{'shop':!![]}});if(!_0x304147||!_0x304147[_0xe8ab8b(0x190)]||!_0x304147[_0xe8ab8b(0x20a)]){await this[_0xe8ab8b(0x22a)]?.[_0xe8ab8b(0x24b)](_0x42386a,_0xe8ab8b(0x1fb));return;}const _0x28c05a=_0x304147[_0xe8ab8b(0x258)]?.[_0xe8ab8b(0x20e)]||_0xe8ab8b(0x19b);await database_1[_0xe8ab8b(0x199)][_0xe8ab8b(0x195)][_0xe8ab8b(0x19c)]({'where':{'telegramId':_0x56cb42},'data':{'shopId':null,'isVerified':![]}}),console[_0xe8ab8b(0x18b)](_0xe8ab8b(0x1e2)+_0x56cb42+'\x20disconnected\x20from\x20shop\x20'+_0x304147[_0xe8ab8b(0x20a)]),await this[_0xe8ab8b(0x22a)]?.[_0xe8ab8b(0x24b)](_0x42386a,_0xe8ab8b(0x184)+_0x28c05a+'*.\x0a\x0a'+_0xe8ab8b(0x18f),{'parse_mode':_0xe8ab8b(0x232)});}catch(_0x272be4){console[_0xe8ab8b(0x1a7)](_0xe8ab8b(0x202),_0x272be4),await this[_0xe8ab8b(0x22a)]?.[_0xe8ab8b(0x24b)](_0x42386a,_0xe8ab8b(0x1bf));}}),this['bot']['onText'](/\/status/,async _0x644daa=>{const _0x454b0e=_0x1dbf91,_0x3b5b66=_0x644daa[_0x454b0e(0x215)]['id'],_0x51ebc2=_0x644daa[_0x454b0e(0x181)]?.['id']['toString']();if(!_0x51ebc2)return;try{const _0x1b0fcc=await database_1[_0x454b0e(0x199)][_0x454b0e(0x195)][_0x454b0e(0x21d)]({'where':{'telegramId':_0x51ebc2},'include':{'shop':!![]}});if(!_0x1b0fcc){await this[_0x454b0e(0x22a)]?.[_0x454b0e(0x24b)](_0x3b5b66,_0x454b0e(0x1b0)+_0x454b0e(0x230));return;}if(!_0x1b0fcc[_0x454b0e(0x190)]||!_0x1b0fcc['shopId']||!_0x1b0fcc[_0x454b0e(0x258)]){await this[_0x454b0e(0x22a)]?.['sendMessage'](_0x3b5b66,_0x454b0e(0x22b)+_0x454b0e(0x264));return;}await this[_0x454b0e(0x22a)]?.['sendMessage'](_0x3b5b66,'📊\x20*Connection\x20Status*\x0a\x0a'+('✅\x20Connected\x20to\x20shop:\x20*'+_0x1b0fcc['shop']['name']+'*\x0a')+(_0x454b0e(0x226)+_0x1b0fcc[_0x454b0e(0x258)][_0x454b0e(0x1f6)]+'`\x0a')+('📅\x20Connection\x20date:\x20'+_0x1b0fcc[_0x454b0e(0x1ac)][_0x454b0e(0x1b7)](_0x454b0e(0x194))+'\x0a\x0a')+_0x454b0e(0x25b)+_0x454b0e(0x212)+_0x454b0e(0x1b1),{'parse_mode':'Markdown'});}catch(_0x4445f4){console[_0x454b0e(0x1a7)](_0x454b0e(0x211),_0x4445f4),await this[_0x454b0e(0x22a)]?.['sendMessage'](_0x3b5b66,_0x454b0e(0x1bf));}}),this[_0x1dbf91(0x22a)]['onText'](/\/debug/,async _0x10a212=>{const _0xce34fc=_0x1dbf91,_0x282205=_0x10a212[_0xce34fc(0x215)]['id'],_0x10e656=_0x10a212['from']?.['id'][_0xce34fc(0x246)]();if(!_0x10e656)return;try{const _0x2b3de9=await database_1['default']['shop']['findMany']({'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![]},'take':0xa});let _0x52fc12='🔍\x20*Debug\x20Information*\x0a\x0a';_0x52fc12+=_0xce34fc(0x1bd)+_0x10e656+'`\x0a\x0a',_0x52fc12+=_0xce34fc(0x25c),_0x2b3de9[_0xce34fc(0x1ba)]((_0x468124,_0x206e87)=>{const _0x86f74b=_0xce34fc;_0x52fc12+=_0x206e87+0x1+_0x86f74b(0x1f2)+_0x468124['name']+'*\x0a',_0x52fc12+=_0x86f74b(0x1e1)+_0x468124['username']+'`\x0a',_0x52fc12+='\x20\x20\x20Status:\x20'+_0x468124['status']+'\x0a',_0x52fc12+='\x20\x20\x20Public\x20Key:\x20`'+_0x468124[_0x86f74b(0x1db)][_0x86f74b(0x205)](0x0,0xf)+'...`\x0a\x0a';}),await this[_0xce34fc(0x22a)]?.[_0xce34fc(0x24b)](_0x282205,_0x52fc12,{'parse_mode':_0xce34fc(0x232)});}catch(_0xdb2816){console['error']('Error\x20handling\x20/debug\x20command:',_0xdb2816),await this[_0xce34fc(0x22a)]?.[_0xce34fc(0x24b)](_0x282205,_0xce34fc(0x24f));}}),this[_0x1dbf91(0x22a)]['on'](_0x1dbf91(0x1ed),async _0x160ea8=>{const _0x13df1b=_0x1dbf91;if(_0x160ea8[_0x13df1b(0x23e)]?.[_0x13df1b(0x1a3)]('/'))return;const _0x6da4d1=_0x160ea8[_0x13df1b(0x215)]['id'],_0xc3b759=_0x160ea8[_0x13df1b(0x181)]?.['id'][_0x13df1b(0x246)](),_0x2e0024=_0x160ea8[_0x13df1b(0x23e)]?.[_0x13df1b(0x1b3)]();if(!_0xc3b759||!_0x2e0024)return;try{const _0x156495=await database_1['default'][_0x13df1b(0x195)][_0x13df1b(0x21d)]({'where':{'telegramId':_0xc3b759},'include':{'shop':!![]}});if(!_0x156495){await this[_0x13df1b(0x22a)]?.[_0x13df1b(0x24b)](_0x6da4d1,_0x13df1b(0x20c));return;}if(_0x156495['isVerified']&&_0x156495[_0x13df1b(0x20a)]&&_0x156495[_0x13df1b(0x258)]){await this['bot']?.['sendMessage'](_0x6da4d1,_0x13df1b(0x1fe)+_0x156495['shop'][_0x13df1b(0x20e)]+_0x13df1b(0x1e0)+_0x13df1b(0x20d),{'parse_mode':_0x13df1b(0x232)});return;}const _0x5941d0=_0x2e0024[_0x13df1b(0x223)](/\s+/);if(_0x5941d0[_0x13df1b(0x1f7)]!==0x2){await this['bot']?.[_0x13df1b(0x24b)](_0x6da4d1,_0x13df1b(0x1f5)+_0x13df1b(0x252)+_0x13df1b(0x20f)+'`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a'+('You\x20sent\x20'+_0x5941d0[_0x13df1b(0x1f7)]+_0x13df1b(0x23f)+_0x5941d0[_0x13df1b(0x222)](_0xbb646d=>'`'+_0xbb646d+'`')[_0x13df1b(0x1f9)](',\x20')),{'parse_mode':_0x13df1b(0x232)});return;}const [_0x1eb410,_0x472656]=_0x5941d0;console[_0x13df1b(0x18b)](_0x13df1b(0x22f)+_0xc3b759+_0x13df1b(0x1dd)+_0x1eb410+_0x13df1b(0x198)+_0x472656[_0x13df1b(0x205)](0x0,0xa)+'...\x22'),await this[_0x13df1b(0x1ae)](_0x6da4d1,_0xc3b759,_0x1eb410,_0x472656);}catch(_0x1656fb){console['error'](_0x13df1b(0x1cb),_0x1656fb),await this['bot']?.['sendMessage'](_0x6da4d1,_0x13df1b(0x1bf));}}),this[_0x1dbf91(0x22a)]['on'](_0x1dbf91(0x1a7),_0x4f92a2=>{const _0x682428=_0x1dbf91;console[_0x682428(0x1a7)]('Telegram\x20bot\x20error:',_0x4f92a2);}),this[_0x1dbf91(0x22a)]['on'](_0x1dbf91(0x1d7),_0x8253ae=>{const _0xc6af57=_0x1dbf91;console[_0xc6af57(0x1a7)]('Telegram\x20bot\x20polling\x20error:',_0x8253ae);});}async['handleSingleLineVerification'](_0xc14102,_0x38c06f,_0x1b4e2f,_0x494481){const _0x157ab4=a54_0x24660e;try{console[_0x157ab4(0x18b)]('🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20'+_0x38c06f+_0x157ab4(0x1dd)+_0x1b4e2f+_0x157ab4(0x198)+_0x494481[_0x157ab4(0x205)](0x0,0xa)+'...\x22');if(!_0x1b4e2f||_0x1b4e2f['length']<0x3||_0x1b4e2f[_0x157ab4(0x1f7)]>0x32||!/^[a-zA-Z0-9_]+$/[_0x157ab4(0x19a)](_0x1b4e2f)){await this[_0x157ab4(0x22a)]?.[_0x157ab4(0x24b)](_0xc14102,_0x157ab4(0x23d)+_0x1b4e2f+_0x157ab4(0x18c)+_0x157ab4(0x216),{'parse_mode':_0x157ab4(0x232)});return;}if(!_0x494481||!_0x494481[_0x157ab4(0x1a3)](_0x157ab4(0x1e5))&&!_0x494481[_0x157ab4(0x1a3)](_0x157ab4(0x240))){await this[_0x157ab4(0x22a)]?.[_0x157ab4(0x24b)](_0xc14102,_0x157ab4(0x218)+_0x157ab4(0x1d3),{'parse_mode':_0x157ab4(0x232)});return;}const _0x409499=await database_1[_0x157ab4(0x199)][_0x157ab4(0x258)][_0x157ab4(0x21d)]({'where':{'username':_0x1b4e2f},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x409499){const _0x2a337a=await database_1['default'][_0x157ab4(0x258)][_0x157ab4(0x1dc)]({'select':{'username':!![],'name':!![]},'take':0x5});let _0x1ce717=_0x157ab4(0x1be)+_0x1b4e2f+_0x157ab4(0x1ab);_0x2a337a[_0x157ab4(0x1f7)]>0x0?(_0x1ce717+=_0x157ab4(0x227),_0x2a337a[_0x157ab4(0x1ba)](_0x27527f=>{const _0x24b6a2=_0x157ab4;_0x1ce717+=_0x24b6a2(0x268)+_0x27527f[_0x24b6a2(0x1f6)]+_0x24b6a2(0x1d4)+_0x27527f[_0x24b6a2(0x20e)]+')\x0a';}),_0x1ce717+='\x0aCheck\x20spelling\x20and\x20try\x20again.'):_0x1ce717+=_0x157ab4(0x260);await this[_0x157ab4(0x22a)]?.['sendMessage'](_0xc14102,_0x1ce717,{'parse_mode':'Markdown'});return;}if(_0x409499[_0x157ab4(0x239)]!==_0x157ab4(0x25e)){await this[_0x157ab4(0x22a)]?.[_0x157ab4(0x24b)](_0xc14102,_0x157ab4(0x1c2)+_0x1b4e2f+'`\x20is\x20inactive.\x0a\x0a'+_0x157ab4(0x21f),{'parse_mode':_0x157ab4(0x232)});return;}if(_0x409499[_0x157ab4(0x1db)]!==_0x494481&&_0x409499[_0x157ab4(0x18a)]!==_0x494481){await this[_0x157ab4(0x22a)]?.['sendMessage'](_0xc14102,_0x157ab4(0x1e3)+_0x1b4e2f+_0x157ab4(0x229)+_0x157ab4(0x263)+_0x157ab4(0x1f0),{'parse_mode':_0x157ab4(0x232)});return;}const _0x3723ca=await database_1[_0x157ab4(0x199)][_0x157ab4(0x195)][_0x157ab4(0x196)]({'where':{'shopId':_0x409499['id'],'isVerified':!![],'telegramId':{'not':_0x38c06f}}});if(_0x3723ca){await this[_0x157ab4(0x22a)]?.['sendMessage'](_0xc14102,_0x157ab4(0x1b6)+_0x1b4e2f+_0x157ab4(0x229)+_0x157ab4(0x21c),{'parse_mode':_0x157ab4(0x232)});return;}await database_1['default'][_0x157ab4(0x195)][_0x157ab4(0x19c)]({'where':{'telegramId':_0x38c06f},'data':{'shopId':_0x409499['id'],'isVerified':!![]}}),await this[_0x157ab4(0x22a)]?.[_0x157ab4(0x24b)](_0xc14102,_0x157ab4(0x185)+_0x157ab4(0x1d9)+('📱\x20Shop:\x20*'+_0x409499[_0x157ab4(0x20e)]+'*\x0a')+(_0x157ab4(0x226)+_0x409499[_0x157ab4(0x1f6)]+_0x157ab4(0x18c))+'🔔\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a'+_0x157ab4(0x234)+'•\x20Payment\x20status\x20changes\x0a'+_0x157ab4(0x1a8)+_0x157ab4(0x1eb)+_0x157ab4(0x212)+_0x157ab4(0x269)+'/disconnect\x20-\x20disconnect\x20from\x20notifications',{'parse_mode':_0x157ab4(0x232)}),console[_0x157ab4(0x18b)](_0x157ab4(0x1cf)+_0x38c06f+'\x20verified\x20for\x20shop\x20'+_0x409499[_0x157ab4(0x1f6)]+'\x20via\x20single-line\x20input');}catch(_0x5f77e8){console[_0x157ab4(0x1a7)](_0x157ab4(0x1c9),_0x5f77e8),await this[_0x157ab4(0x22a)]?.['sendMessage'](_0xc14102,_0x157ab4(0x224));}}async['sendShopNotification'](_0x56339e,_0x1c6af5,_0x5c3968){const _0x5f3a96=a54_0x24660e;if(!this[_0x5f3a96(0x22a)]){console['warn'](_0x5f3a96(0x1ef));return;}try{const _0x1e172a=await database_1[_0x5f3a96(0x199)]['telegramUser'][_0x5f3a96(0x1dc)]({'where':{'shopId':_0x56339e,'isVerified':!![]}});if(_0x1e172a[_0x5f3a96(0x1f7)]===0x0){console[_0x5f3a96(0x18b)]('No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20'+_0x56339e);return;}const _0x1315de=_0x1e172a[_0x5f3a96(0x222)](async _0x16d7f5=>{const _0x42b980=_0x5f3a96;try{await this[_0x42b980(0x22a)]?.[_0x42b980(0x24b)](_0x16d7f5[_0x42b980(0x200)],_0x1c6af5,_0x5c3968),console[_0x42b980(0x18b)](_0x42b980(0x1ee)+_0x16d7f5['telegramId']);}catch(_0x206da0){console[_0x42b980(0x1a7)](_0x42b980(0x257)+_0x16d7f5[_0x42b980(0x200)]+':',_0x206da0),_0x206da0 instanceof Error&&(_0x206da0['message'][_0x42b980(0x23b)]('blocked')||_0x206da0[_0x42b980(0x1ed)][_0x42b980(0x23b)](_0x42b980(0x1a9))||_0x206da0[_0x42b980(0x1ed)][_0x42b980(0x23b)]('user\x20is\x20deactivated'))&&(await database_1[_0x42b980(0x199)]['telegramUser'][_0x42b980(0x19c)]({'where':{'id':_0x16d7f5['id']},'data':{'isVerified':![]}}),console['log'](_0x42b980(0x24a)+_0x16d7f5['telegramId']+_0x42b980(0x18e)));}});await Promise[_0x5f3a96(0x1e8)](_0x1315de);}catch(_0x1a1701){console[_0x5f3a96(0x1a7)](_0x5f3a96(0x1aa),_0x1a1701);}}async['sendPaymentNotification'](_0x2a5324,_0x1e336d,_0x436b82){const _0x2f6037=a54_0x24660e,_0x31d763={'created':'🆕','paid':'✅','failed':'❌','expired':'⏰','refund':'🔄','chargeback':'⚠️','processing':'⚙️'},_0x4f13d5={'created':_0x2f6037(0x23a),'paid':_0x2f6037(0x1bc),'failed':_0x2f6037(0x1c4),'expired':_0x2f6037(0x1fa),'refund':_0x2f6037(0x24d),'chargeback':_0x2f6037(0x261),'processing':_0x2f6037(0x238)},_0x162a51=_0x31d763[_0x436b82],_0x42ab1e=_0x4f13d5[_0x436b82],_0x317444=(0x0,gateway_1[_0x2f6037(0x231)])(_0x1e336d[_0x2f6037(0x1f3)]);console[_0x2f6037(0x18b)]('📱\x20Telegram\x20notification:\x20gateway\x20\x22'+_0x1e336d['gateway']+'\x22\x20->\x20display\x20\x22'+_0x317444+'\x22');let _0x5ec8a8=_0x162a51+'\x20*'+_0x42ab1e+_0x2f6037(0x1fd)+('💰\x20Amount:\x20*'+_0x1e336d[_0x2f6037(0x235)]+'\x20'+_0x1e336d[_0x2f6037(0x1d0)]+'*\x0a')+(_0x2f6037(0x228)+(_0x1e336d['orderId']||_0x1e336d['id'])+'`\x0a')+(_0x2f6037(0x1ca)+_0x1e336d['id']+'`\x0a')+(_0x2f6037(0x1c5)+_0x317444+'`\x0a')+(_0x2f6037(0x1a0)+new Date(_0x1e336d[_0x2f6037(0x242)])[_0x2f6037(0x1ea)](_0x2f6037(0x194))+'\x0a');if(_0x1e336d[_0x2f6037(0x188)]||_0x1e336d[_0x2f6037(0x22c)]||_0x1e336d[_0x2f6037(0x25f)]||_0x1e336d['customerIp']||_0x1e336d[_0x2f6037(0x201)]){_0x5ec8a8+=_0x2f6037(0x256);_0x1e336d[_0x2f6037(0x188)]&&(_0x5ec8a8+=_0x2f6037(0x18d)+_0x1e336d[_0x2f6037(0x188)]+'`\x0a');_0x1e336d['customerEmail']&&(_0x5ec8a8+=_0x2f6037(0x243)+_0x1e336d[_0x2f6037(0x22c)]+'`\x0a');_0x1e336d[_0x2f6037(0x25f)]&&(_0x5ec8a8+=_0x2f6037(0x221)+_0x1e336d['remitterIban']+'`\x0a');_0x1e336d['customerIp']&&(_0x5ec8a8+=_0x2f6037(0x1a6)+_0x1e336d[_0x2f6037(0x1a2)]+'`\x0a');if(_0x1e336d[_0x2f6037(0x201)]){const _0x439e74=_0x1e336d[_0x2f6037(0x201)][_0x2f6037(0x1f7)]>0x32?_0x1e336d[_0x2f6037(0x201)][_0x2f6037(0x205)](0x0,0x32)+'...':_0x1e336d['customerUa'];_0x5ec8a8+=_0x2f6037(0x1f4)+_0x439e74+'`\x0a';}}_0x436b82===_0x2f6037(0x248)&&_0x1e336d['chargebackAmount']&&(_0x5ec8a8+=_0x2f6037(0x1b2)+_0x1e336d['chargebackAmount']+'\x20USDT*\x0a'),_0x436b82===_0x2f6037(0x209)&&(_0x5ec8a8+=_0x2f6037(0x21e)),_0x1e336d[_0x2f6037(0x1e6)]&&(_0x5ec8a8+=_0x2f6037(0x219)+_0x1e336d[_0x2f6037(0x1e6)]+'\x0a'),await this[_0x2f6037(0x1de)](_0x2a5324,_0x5ec8a8,{'parse_mode':_0x2f6037(0x232)});}async['sendPayoutNotification'](_0x38e9ce,_0x16f961,_0x4c3dfd){const _0x4659d4=a54_0x24660e,_0x1531c4={'created':'📤','completed':'✅','rejected':'❌'},_0x2f55a8={'created':_0x4659d4(0x259),'completed':_0x4659d4(0x247),'rejected':_0x4659d4(0x220)},_0x57d265=_0x1531c4[_0x4c3dfd],_0x4d8ed8=_0x2f55a8[_0x4c3dfd],_0x512f3d=_0x57d265+'\x20*'+_0x4d8ed8+_0x4659d4(0x1fd)+(_0x4659d4(0x191)+_0x16f961[_0x4659d4(0x235)]+_0x4659d4(0x265))+('🏦\x20Method:\x20`'+_0x16f961[_0x4659d4(0x1c0)]+'`\x0a')+('🆔\x20Payout\x20ID:\x20`'+_0x16f961['id']+'`\x0a')+(_0x4659d4(0x1a0)+new Date(_0x16f961[_0x4659d4(0x242)])[_0x4659d4(0x1ea)](_0x4659d4(0x194))+'\x0a')+(_0x16f961['txid']?_0x4659d4(0x245)+_0x16f961[_0x4659d4(0x189)]+'`':'');await this[_0x4659d4(0x1de)](_0x38e9ce,_0x512f3d,{'parse_mode':'Markdown'});}async[a54_0x24660e(0x1ec)](_0x58ee1c,_0x3d951b){const _0x4bc9dc=a54_0x24660e;try{const _0x510545=await database_1[_0x4bc9dc(0x199)][_0x4bc9dc(0x20b)][_0x4bc9dc(0x21d)]({'where':{'shopId':_0x58ee1c},'select':{'notificationLogin':!![]}});if(!_0x510545?.[_0x4bc9dc(0x1c7)]){console[_0x4bc9dc(0x18b)](_0x4bc9dc(0x1a4)+_0x58ee1c);return;}const _0x19526f=_0x3d951b['success']?'🔐':'🚨',_0x11c4e1=_0x3d951b[_0x4bc9dc(0x1d8)]?_0x4bc9dc(0x22d):_0x4bc9dc(0x187);let _0x4459ea=_0x19526f+'\x20*'+_0x11c4e1+_0x4bc9dc(0x1fd)+(_0x4bc9dc(0x226)+_0x3d951b[_0x4bc9dc(0x1f6)]+'`\x0a')+(_0x4bc9dc(0x208)+_0x3d951b[_0x4bc9dc(0x1c8)]['toLocaleString'](_0x4bc9dc(0x194))+'\x0a');_0x3d951b[_0x4bc9dc(0x21b)]&&(_0x4459ea+=_0x4bc9dc(0x262)+_0x3d951b[_0x4bc9dc(0x21b)]+'`\x0a');if(_0x3d951b['userAgent']){const _0x532ae9=_0x3d951b[_0x4bc9dc(0x203)][_0x4bc9dc(0x1f7)]>0x32?_0x3d951b[_0x4bc9dc(0x203)]['substring'](0x0,0x32)+_0x4bc9dc(0x182):_0x3d951b['userAgent'];_0x4459ea+='💻\x20Browser:\x20`'+_0x532ae9+'`\x0a';}!_0x3d951b['success']&&(_0x4459ea+=_0x4bc9dc(0x233)),await this['sendShopNotification'](_0x58ee1c,_0x4459ea,{'parse_mode':'Markdown'}),console[_0x4bc9dc(0x18b)](_0x4bc9dc(0x186)+_0x58ee1c+':\x20'+(_0x3d951b[_0x4bc9dc(0x1d8)]?_0x4bc9dc(0x1d8):'failed'));}catch(_0x1fcd04){console[_0x4bc9dc(0x1a7)](_0x4bc9dc(0x253),_0x1fcd04);}}async[a54_0x24660e(0x1af)](_0x421833,_0x295bc6){const _0x1f95d7=a54_0x24660e;try{const _0x59951c=await database_1[_0x1f95d7(0x199)][_0x1f95d7(0x20b)][_0x1f95d7(0x21d)]({'where':{'shopId':_0x421833},'select':{'notificationApiError':!![]}});if(!_0x59951c?.['notificationApiError']){console[_0x1f95d7(0x18b)](_0x1f95d7(0x197)+_0x421833);return;}let _0x8c0bf5=_0x1f95d7(0x1c1)+(_0x1f95d7(0x21a)+_0x295bc6[_0x1f95d7(0x1c0)]+'\x20'+_0x295bc6['endpoint']+'`\x0a')+(_0x1f95d7(0x208)+_0x295bc6[_0x1f95d7(0x1c8)]['toLocaleString'](_0x1f95d7(0x194))+'\x0a');_0x295bc6[_0x1f95d7(0x1c6)]&&(_0x8c0bf5+=_0x1f95d7(0x266)+_0x295bc6['statusCode']+'`\x0a'),_0x8c0bf5+=_0x1f95d7(0x1ff)+_0x295bc6[_0x1f95d7(0x24c)]+'`\x0a',_0x295bc6[_0x1f95d7(0x237)]&&(_0x8c0bf5+=_0x1f95d7(0x1ce)+_0x295bc6[_0x1f95d7(0x237)]+'`\x0a'),_0x8c0bf5+=_0x1f95d7(0x1fc),await this[_0x1f95d7(0x1de)](_0x421833,_0x8c0bf5,{'parse_mode':_0x1f95d7(0x232)}),console['log'](_0x1f95d7(0x1c3)+_0x421833+':\x20'+_0x295bc6[_0x1f95d7(0x206)]);}catch(_0x13bee5){console['error'](_0x1f95d7(0x241),_0x13bee5);}}async[a54_0x24660e(0x1f1)](_0x341969,_0x33def4,_0x114b1e){const _0x40ad8e=a54_0x24660e;let _0x6bb38e='🔔\x20*'+_0x33def4+_0x40ad8e(0x1fd);for(const [_0x4a051f,_0x5435a4]of Object[_0x40ad8e(0x255)](_0x114b1e)){_0x5435a4!==null&&_0x5435a4!==undefined&&(_0x6bb38e+=_0x4a051f+_0x40ad8e(0x25d)+_0x5435a4+'`\x0a');}await this['sendShopNotification'](_0x341969,_0x6bb38e,{'parse_mode':'Markdown'});}[a54_0x24660e(0x26a)](){const _0xa7b99f=a54_0x24660e;return{'isActive':!!this['bot'],'username':this[_0xa7b99f(0x1b5)]};}['stopBot'](){const _0x172045=a54_0x24660e;this[_0x172045(0x22a)]&&(this[_0x172045(0x22a)]['stopPolling'](),this[_0x172045(0x22a)]=null,console['log'](_0x172045(0x210)));}}exports[a54_0x24660e(0x19d)]=TelegramBotService,exports[a54_0x24660e(0x26b)]=new TelegramBotService();function a54_0x1a28(){const _0x1d6947=['Error\x20handling\x20message:','first_name','9oPtRhf','🆔\x20Request\x20ID:\x20`','✅\x20Telegram\x20user\x20','currency','defineProperty','__esModule','API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','`\x20(','onText','310JnbMtv','polling_error','success','✅\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a','__importDefault','publicKey','findMany',':\x20username=\x22','sendShopNotification','❗️\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!','*.\x0a\x0a','\x20\x20\x20Username:\x20`','🔌\x20User\x20','❌\x20API\x20key\x20does\x20not\x20match\x20shop\x20`','🔄\x20Reset\x20incomplete\x20verification\x20for\x20user\x20','pk_','adminNotes','144639MEkiEU','allSettled','1660158kspvYV','toLocaleString','•\x20Important\x20events\x0a\x0a','sendLoginNotification','message','✅\x20Notification\x20sent\x20to\x20Telegram\x20user\x20','Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification','Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`','sendCustomNotification','.\x20*','gateway','💻\x20Browser:\x20`','❌\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a','username','length','warn','join','Payment\x20expired','❌\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.','\x0a💡\x20Check\x20your\x20request\x20or\x20contact\x20support.','*\x0a\x0a','✅\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*','❌\x20Error:\x20`','telegramId','customerUa','Error\x20handling\x20/disconnect\x20command:','userAgent','114164wQswmy','substring','endpoint','trapay_bot','📅\x20Time:\x20','processing','shopId','shopSettings','❌\x20Please\x20use\x20/start\x20command\x20first','Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.','name','Example:\x0a','🛑\x20Telegram\x20bot\x20stopped','Error\x20handling\x20/status\x20command:','Commands:\x0a','create','728030iUpKMW','chat','Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).','TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables','❌\x20Invalid\x20API\x20key\x20format.\x0a\x0a','📝\x20Notes:\x20','🔗\x20Endpoint:\x20`','ipAddress','Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.','findUnique','⏳\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a','Contact\x20administrator.','Payout\x20rejected','🏦\x20IBAN:\x20`','map','split','❌\x20An\x20error\x20occurred\x20while\x20verifying\x20data.','Error\x20handling\x20/start\x20command:','👤\x20Username:\x20`','Available\x20usernames:\x0a','📝\x20Order\x20ID:\x20`','`.\x0a\x0a','bot','❌\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a','customerEmail','Successful\x20login','•\x20Payment\x20status\x20changes\x0a','🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20','Use\x20/start\x20to\x20begin.','getGatewayDisplayNameForTelegram','Markdown','\x0a⚠️\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!','•\x20New\x20payments\x0a','amount','botToken','requestId','Payment\x20is\x20being\x20processed','status','New\x20payment\x20created','includes','To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a','❌\x20Invalid\x20username\x20format:\x20`','text','\x20parts:\x20','sk_','Failed\x20to\x20send\x20API\x20error\x20notification:','createdAt','📧\x20Email:\x20`','Username:\x20`','🔗\x20TXID:\x20`','toString','Payout\x20completed','chargeback','291015kcPwkR','User\x20','sendMessage','errorMessage','Payment\x20refund','setupBotHandlers','❌\x20Error\x20getting\x20debug\x20information.','TELEGRAM_BOT_TOKEN','\x20initialized\x20successfully','📝\x20Format:\x20`username\x20api_key`\x0a\x0a','Failed\x20to\x20send\x20login\x20notification:','\x20(@','entries','\x0a👤\x20*Customer\x20Information:*\x0a','❌\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20','shop','New\x20payout\x20created','1006VyUzrq','🔔\x20Notifications\x20are\x20active\x0a\x0a','🏪\x20Available\x20shops\x20in\x20system:\x0a',':\x20`','ACTIVE','remitterIban','Check\x20spelling\x20and\x20try\x20again.','Payment\x20chargeback','🌐\x20IP\x20address:\x20`','Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a','Use\x20/start\x20to\x20connect.','\x20USD*\x0a','📊\x20Error\x20code:\x20`','initializeBot','•\x20`','/status\x20-\x20check\x20connection\x20status\x0a','getBotInfo','telegramBotService','from','...','241656yGYWvV','✅\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*','🎉\x20*Congratulations!*\x0a\x0a','✅\x20Login\x20notification\x20sent\x20for\x20shop\x20','Failed\x20login\x20attempt','customerName','txid','secretKey','log','`\x0a\x0a','📛\x20Name:\x20`','\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure','To\x20reconnect,\x20use\x20the\x20/start\x20command','isVerified','💸\x20Amount:\x20*','node-telegram-bot-api','../types/gateway','en-US','telegramUser','findFirst','📱\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20','\x22,\x20apiKey=\x22','default','test','unknown\x20shop','update','TelegramBotService','You\x20are\x20already\x20connected\x20to\x20shop:\x20*','✅\x20Welcome\x20back!\x0a\x0a','📅\x20Date:\x20','🔔\x20You\x20receive\x20notifications\x20about:\x0a','customerIp','startsWith','📱\x20Login\x20notifications\x20disabled\x20for\x20shop\x20','last_name','🌐\x20IP:\x20`','error','•\x20Payouts\x0a','chat\x20not\x20found','Error\x20sending\x20shop\x20notification:','`\x20not\x20found.\x0a\x0a','updatedAt','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','handleSingleLineVerification','sendApiErrorNotification','❌\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a','/disconnect\x20-\x20disconnect\x20from\x20notifications','💸\x20Penalty\x20amount:\x20*','trim','127xHuyqo','botUsername','❌\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`','toLocaleDateString','✅\x20Telegram\x20bot\x20@','91EKoUKk','forEach','env','Payment\x20successfully\x20paid','📱\x20Your\x20Telegram\x20ID:\x20`','❌\x20Shop\x20with\x20username\x20`','❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','method','🚨\x20*API\x20Error*\x0a\x0a','❌\x20Shop\x20`','✅\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20','Payment\x20failed','🏪\x20Gateway:\x20`','statusCode','notificationLogin','timestamp','Error\x20in\x20handleSingleLineVerification:','🆔\x20Payment\x20ID:\x20`'];a54_0x1a28=function(){return _0x1d6947;};return a54_0x1a28();}