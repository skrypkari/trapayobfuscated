'use strict';const a57_0x3ea08e=a57_0x367b;(function(_0x1386a3,_0x3b79ae){const _0x25b08f=a57_0x367b,_0x2a3d95=_0x1386a3();while(!![]){try{const _0x234985=parseInt(_0x25b08f(0x1a7))/0x1+parseInt(_0x25b08f(0x131))/0x2*(-parseInt(_0x25b08f(0x1b7))/0x3)+-parseInt(_0x25b08f(0x134))/0x4*(-parseInt(_0x25b08f(0x169))/0x5)+parseInt(_0x25b08f(0x149))/0x6+parseInt(_0x25b08f(0x1a8))/0x7*(-parseInt(_0x25b08f(0x1b1))/0x8)+-parseInt(_0x25b08f(0x166))/0x9*(parseInt(_0x25b08f(0x175))/0xa)+parseInt(_0x25b08f(0x129))/0xb*(parseInt(_0x25b08f(0x147))/0xc);if(_0x234985===_0x3b79ae)break;else _0x2a3d95['push'](_0x2a3d95['shift']());}catch(_0x4044dd){_0x2a3d95['push'](_0x2a3d95['shift']());}}}(a57_0x3388,0x23308));function a57_0x3388(){const _0x22fa84=['🆔\x20Payment\x20ID:\x20`','💻\x20Browser:\x20`','\x0a💡\x20Check\x20your\x20request\x20or\x20contact\x20support.','entries','📅\x20Time:\x20','defineProperty','default','Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).','\x0a👤\x20*Customer\x20Information:*\x0a','🔄\x20Reset\x20incomplete\x20verification\x20for\x20user\x20','🔍\x20*Debug\x20Information*\x0a\x0a','sendPaymentNotification','📱\x20Shop:\x20*','🏪\x20Available\x20shops\x20in\x20system:\x0a','\x20USDT*\x0a','shop','🛑\x20Telegram\x20bot\x20stopped','/status\x20-\x20check\x20connection\x20status\x0a','botUsername','customerUa','Username:\x20`','chargeback','ipAddress','startsWith','substring','sendMessage','errorMessage','❌\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`','`\x20(','adminNotes','\x20\x20\x20Username:\x20`','❌\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a','✅\x20Telegram\x20bot\x20@','Available\x20usernames:\x0a','Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`','You\x20sent\x20','telegramId','❌\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.','\x22\x20->\x20display\x20\x22','Failed\x20login\x20attempt','Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.','amount','•\x20Payment\x20status\x20changes\x0a','test','getGatewayDisplayNameForTelegram','error','🚨\x20*API\x20Error*\x0a\x0a','customerIp','failed','sendShopNotification','👤\x20Username:\x20`','📝\x20Order\x20ID:\x20`','TELEGRAM_BOT_TOKEN','📊\x20Error\x20code:\x20`','Error\x20sending\x20shop\x20notification:','\x0aCheck\x20spelling\x20and\x20try\x20again.','endpoint','📱\x20Telegram\x20notification:\x20gateway\x20\x22','Error\x20handling\x20/status\x20command:','stopPolling','💰\x20Amount:\x20*','Error\x20in\x20handleSingleLineVerification:','❌\x20Invalid\x20username\x20format:\x20`','split','TELEGRAM_BOT_USERNAME','❌\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a','22FEDjKk','chat\x20not\x20found','sendPayoutNotification','timestamp','🏦\x20IBAN:\x20`','\x20verified\x20for\x20shop\x20','🔗\x20TXID:\x20`','✅\x20Login\x20notification\x20sent\x20for\x20shop\x20','598nXXtmI','Use\x20/start\x20to\x20connect.','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','186932NBeIWX','🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20','requestId','Example:\x0a','✅\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a','findMany','secretKey','🔔\x20Notifications\x20are\x20active\x0a\x0a','New\x20payment\x20created','\x20via\x20single-line\x20input','forEach','🤖\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a','Payment\x20refund','•\x20Payouts\x0a\x0a','Payment\x20expired','❗️\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!','📱\x20Created\x20new\x20Telegram\x20user:\x20','❌\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a','Commands:\x0a','1119528zdTFbe','txid','319404hVoUWg','create','🔌\x20User\x20','Failed\x20to\x20send\x20login\x20notification:','Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a','__importDefault','No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20','initializeBot','pk_','📝\x20Notes:\x20','remitterIban','❌\x20Error:\x20`','📱\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20','warn','toLocaleString','customerName','❌\x20Please\x20use\x20/start\x20command\x20first','message','\x20\x20\x20Public\x20Key:\x20`','stopBot','📅\x20Date:\x20','\x22,\x20apiKey=\x22','ACTIVE','\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure','💸\x20Amount:\x20*','\x0a⚠️\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!','Use\x20/start\x20to\x20begin.','Error\x20handling\x20/start\x20command:','❌\x20API\x20key\x20does\x20not\x20match\x20shop\x20`','18YgvoXp','from','telegramBotService','20qCScAt','Markdown','⏳\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a','\x20USD*\x0a','🆔\x20Request\x20ID:\x20`','You\x20are\x20already\x20connected\x20to\x20shop:\x20*','name','Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification','`.\x0a\x0a','Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.','🆔\x20Payout\x20ID:\x20`','❌\x20Invalid\x20API\x20key\x20format.\x0a\x0a','1064130KBNyyH','To\x20reconnect,\x20use\x20the\x20/start\x20command','trapay_bot','chat','createdAt','success','first_name','userAgent','env','method','🏪\x20Gateway:\x20`','getBotInfo','shopId','🔔\x20*','•\x20New\x20payments\x0a','📱\x20Login\x20notifications\x20disabled\x20for\x20shop\x20','onText','Check\x20spelling\x20and\x20try\x20again.','customerEmail','unknown\x20shop','To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a','✅\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*','Payment\x20is\x20being\x20processed','setupBotHandlers','*.\x0a\x0a','notificationLogin','sendCustomNotification',':\x20username=\x22','blocked','chargebackAmount','Successful\x20login','❌\x20Failed\x20to\x20initialize\x20Telegram\x20bot:','bot','Telegram\x20bot\x20error:','gateway','shopSettings','username','/disconnect\x20-\x20disconnect\x20from\x20notifications','join','*\x0a\x0a','sk_','allSettled','botToken','...\x22','Contact\x20administrator.','handleSingleLineVerification','✅\x20Notification\x20sent\x20to\x20Telegram\x20user\x20','Payment\x20failed','🎉\x20*Congratulations!*\x0a\x0a','sendApiErrorNotification','79487RWsihN','456820ulXARK','map','text','status','✅\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*','📊\x20*Connection\x20Status*\x0a\x0a','statusCode','•\x20Important\x20events\x0a\x0a','update','8uipnLj','length','Error\x20handling\x20/disconnect\x20command:','❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','Payment\x20successfully\x20paid','New\x20payout\x20created','843GNKfXh','`\x0a\x0a','../types/gateway','log','📝\x20Format:\x20`username\x20api_key`\x0a\x0a','trim','updatedAt','notificationApiError','isVerified','toString','•\x20`','🏦\x20Method:\x20`','publicKey','...','TelegramBotService','telegramUser','en-US','findUnique','Failed\x20to\x20send\x20API\x20error\x20notification:','🔔\x20You\x20receive\x20notifications\x20about:\x0a'];a57_0x3388=function(){return _0x22fa84;};return a57_0x3388();}var __importDefault=this&&this[a57_0x3ea08e(0x14e)]||function(_0x524b3c){return _0x524b3c&&_0x524b3c['__esModule']?_0x524b3c:{'default':_0x524b3c};};Object[a57_0x3ea08e(0x1d0)](exports,'__esModule',{'value':!![]}),exports[a57_0x3ea08e(0x168)]=exports[a57_0x3ea08e(0x1c5)]=void 0x0;function a57_0x367b(_0x2f7f48,_0x349ec9){const _0x3388d1=a57_0x3388();return a57_0x367b=function(_0x367b50,_0x4dda5f){_0x367b50=_0x367b50-0x101;let _0x23b570=_0x3388d1[_0x367b50];return _0x23b570;},a57_0x367b(_0x2f7f48,_0x349ec9);}const node_telegram_bot_api_1=__importDefault(require('node-telegram-bot-api')),database_1=__importDefault(require('../config/database')),gateway_1=require(a57_0x3ea08e(0x1b9));class TelegramBotService{constructor(){const _0x14a71a=a57_0x3ea08e;this[_0x14a71a(0x195)]=null,this['botToken']=process['env'][_0x14a71a(0x11b)]||'',this[_0x14a71a(0x1dd)]=process[_0x14a71a(0x17d)][_0x14a71a(0x127)]||_0x14a71a(0x177),this[_0x14a71a(0x19f)]?this[_0x14a71a(0x150)]():console[_0x14a71a(0x156)]('TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables');}[a57_0x3ea08e(0x150)](){const _0x1241a1=a57_0x3ea08e;try{this[_0x1241a1(0x195)]=new node_telegram_bot_api_1[(_0x1241a1(0x1d1))](this[_0x1241a1(0x19f)],{'polling':!![]}),this[_0x1241a1(0x18c)](),console['log'](_0x1241a1(0x107)+this[_0x1241a1(0x1dd)]+'\x20initialized\x20successfully');}catch(_0x41fee3){console[_0x1241a1(0x114)](_0x1241a1(0x194),_0x41fee3);}}[a57_0x3ea08e(0x18c)](){const _0x2a3f45=a57_0x3ea08e;if(!this[_0x2a3f45(0x195)])return;this[_0x2a3f45(0x195)][_0x2a3f45(0x185)](/\/start/,async _0x5ddfcf=>{const _0x21ef06=_0x2a3f45,_0x3a050c=_0x5ddfcf['chat']['id'],_0x86638e=_0x5ddfcf[_0x21ef06(0x167)]?.['id'][_0x21ef06(0x1c0)](),_0x342d65=_0x5ddfcf[_0x21ef06(0x167)]?.[_0x21ef06(0x199)],_0x3db277=_0x5ddfcf[_0x21ef06(0x167)]?.[_0x21ef06(0x17b)],_0x142c73=_0x5ddfcf[_0x21ef06(0x167)]?.['last_name'];if(!_0x86638e)return;try{let _0x1f3006=await database_1['default'][_0x21ef06(0x1c6)]['findUnique']({'where':{'telegramId':_0x86638e},'include':{'shop':!![]}});!_0x1f3006?(_0x1f3006=await database_1['default']['telegramUser'][_0x21ef06(0x14a)]({'data':{'telegramId':_0x86638e,'username':_0x342d65,'firstName':_0x3db277,'lastName':_0x142c73,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console[_0x21ef06(0x1ba)](_0x21ef06(0x144)+_0x86638e+'\x20(@'+_0x342d65+')')):_0x1f3006=await database_1['default'][_0x21ef06(0x1c6)][_0x21ef06(0x1b0)]({'where':{'telegramId':_0x86638e},'data':{'username':_0x342d65,'firstName':_0x3db277,'lastName':_0x142c73},'include':{'shop':!![]}}),_0x1f3006[_0x21ef06(0x1bf)]&&_0x1f3006[_0x21ef06(0x181)]&&_0x1f3006['shop']?await this[_0x21ef06(0x195)]?.['sendMessage'](_0x3a050c,'✅\x20Welcome\x20back!\x0a\x0a'+(_0x21ef06(0x16e)+_0x1f3006[_0x21ef06(0x1da)][_0x21ef06(0x16f)]+'*\x0a')+(_0x21ef06(0x1df)+_0x1f3006[_0x21ef06(0x1da)][_0x21ef06(0x199)]+_0x21ef06(0x1b8))+_0x21ef06(0x1ca)+'•\x20New\x20payments\x0a'+_0x21ef06(0x111)+_0x21ef06(0x141)+'Commands:\x0a'+_0x21ef06(0x1dc)+_0x21ef06(0x19a),{'parse_mode':_0x21ef06(0x16a)}):(_0x1f3006[_0x21ef06(0x181)]&&!_0x1f3006['isVerified']&&(await database_1[_0x21ef06(0x1d1)][_0x21ef06(0x1c6)][_0x21ef06(0x1b0)]({'where':{'telegramId':_0x86638e},'data':{'shopId':null,'isVerified':![]}}),console[_0x21ef06(0x1ba)](_0x21ef06(0x1d4)+_0x86638e)),await this['bot']?.['sendMessage'](_0x3a050c,_0x21ef06(0x13f)+_0x21ef06(0x189)+_0x21ef06(0x1bb)+'Example:\x0a'+_0x21ef06(0x133)+_0x21ef06(0x143),{'parse_mode':_0x21ef06(0x16a)}));}catch(_0x19c98a){console['error'](_0x21ef06(0x164),_0x19c98a),await this[_0x21ef06(0x195)]?.[_0x21ef06(0x1e4)](_0x3a050c,_0x21ef06(0x1b4));}}),this[_0x2a3f45(0x195)][_0x2a3f45(0x185)](/\/disconnect/,async _0x30fc14=>{const _0x568a88=_0x2a3f45,_0x6e9e00=_0x30fc14['chat']['id'],_0x2589e7=_0x30fc14['from']?.['id'][_0x568a88(0x1c0)]();if(!_0x2589e7)return;try{const _0x4cc527=await database_1['default'][_0x568a88(0x1c6)][_0x568a88(0x1c8)]({'where':{'telegramId':_0x2589e7},'include':{'shop':!![]}});if(!_0x4cc527||!_0x4cc527[_0x568a88(0x1bf)]||!_0x4cc527[_0x568a88(0x181)]){await this[_0x568a88(0x195)]?.[_0x568a88(0x1e4)](_0x6e9e00,_0x568a88(0x10c));return;}const _0x2a6785=_0x4cc527[_0x568a88(0x1da)]?.[_0x568a88(0x16f)]||_0x568a88(0x188);await database_1[_0x568a88(0x1d1)][_0x568a88(0x1c6)]['update']({'where':{'telegramId':_0x2589e7},'data':{'shopId':null,'isVerified':![]}}),console[_0x568a88(0x1ba)](_0x568a88(0x14b)+_0x2589e7+'\x20disconnected\x20from\x20shop\x20'+_0x4cc527[_0x568a88(0x181)]),await this[_0x568a88(0x195)]?.['sendMessage'](_0x6e9e00,_0x568a88(0x18a)+_0x2a6785+_0x568a88(0x18d)+_0x568a88(0x176),{'parse_mode':'Markdown'});}catch(_0x1a1583){console[_0x568a88(0x114)](_0x568a88(0x1b3),_0x1a1583),await this[_0x568a88(0x195)]?.[_0x568a88(0x1e4)](_0x6e9e00,_0x568a88(0x1b4));}}),this[_0x2a3f45(0x195)]['onText'](/\/status/,async _0x4e00db=>{const _0xa1a842=_0x2a3f45,_0x319b88=_0x4e00db[_0xa1a842(0x178)]['id'],_0x5c3a45=_0x4e00db['from']?.['id'][_0xa1a842(0x1c0)]();if(!_0x5c3a45)return;try{const _0xccc6a8=await database_1[_0xa1a842(0x1d1)][_0xa1a842(0x1c6)]['findUnique']({'where':{'telegramId':_0x5c3a45},'include':{'shop':!![]}});if(!_0xccc6a8){await this[_0xa1a842(0x195)]?.[_0xa1a842(0x1e4)](_0x319b88,_0xa1a842(0x106)+_0xa1a842(0x163));return;}if(!_0xccc6a8['isVerified']||!_0xccc6a8['shopId']||!_0xccc6a8[_0xa1a842(0x1da)]){await this[_0xa1a842(0x195)]?.['sendMessage'](_0x319b88,_0xa1a842(0x128)+_0xa1a842(0x132));return;}await this[_0xa1a842(0x195)]?.['sendMessage'](_0x319b88,_0xa1a842(0x1ad)+('✅\x20Connected\x20to\x20shop:\x20*'+_0xccc6a8[_0xa1a842(0x1da)][_0xa1a842(0x16f)]+'*\x0a')+(_0xa1a842(0x119)+_0xccc6a8[_0xa1a842(0x1da)][_0xa1a842(0x199)]+'`\x0a')+('📅\x20Connection\x20date:\x20'+_0xccc6a8[_0xa1a842(0x1bd)]['toLocaleDateString'](_0xa1a842(0x1c7))+'\x0a\x0a')+_0xa1a842(0x13b)+'Commands:\x0a'+'/disconnect\x20-\x20disconnect\x20from\x20notifications',{'parse_mode':_0xa1a842(0x16a)});}catch(_0xf430d4){console['error'](_0xa1a842(0x121),_0xf430d4),await this[_0xa1a842(0x195)]?.['sendMessage'](_0x319b88,'❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this[_0x2a3f45(0x195)]['onText'](/\/debug/,async _0x571740=>{const _0x1e0e39=_0x2a3f45,_0x717667=_0x571740[_0x1e0e39(0x178)]['id'],_0x37ab33=_0x571740[_0x1e0e39(0x167)]?.['id']['toString']();if(!_0x37ab33)return;try{const _0x144464=await database_1[_0x1e0e39(0x1d1)][_0x1e0e39(0x1da)][_0x1e0e39(0x139)]({'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![]},'take':0xa});let _0x4fb896=_0x1e0e39(0x1d5);_0x4fb896+='📱\x20Your\x20Telegram\x20ID:\x20`'+_0x37ab33+_0x1e0e39(0x1b8),_0x4fb896+=_0x1e0e39(0x1d8),_0x144464[_0x1e0e39(0x13e)]((_0x46efe8,_0x495063)=>{const _0x4520c0=_0x1e0e39;_0x4fb896+=_0x495063+0x1+'.\x20*'+_0x46efe8['name']+'*\x0a',_0x4fb896+=_0x4520c0(0x105)+_0x46efe8['username']+'`\x0a',_0x4fb896+='\x20\x20\x20Status:\x20'+_0x46efe8[_0x4520c0(0x1ab)]+'\x0a',_0x4fb896+=_0x4520c0(0x15b)+_0x46efe8[_0x4520c0(0x1c3)][_0x4520c0(0x1e3)](0x0,0xf)+'...`\x0a\x0a';}),await this[_0x1e0e39(0x195)]?.[_0x1e0e39(0x1e4)](_0x717667,_0x4fb896,{'parse_mode':_0x1e0e39(0x16a)});}catch(_0x2c780f){console[_0x1e0e39(0x114)]('Error\x20handling\x20/debug\x20command:',_0x2c780f),await this[_0x1e0e39(0x195)]?.['sendMessage'](_0x717667,'❌\x20Error\x20getting\x20debug\x20information.');}}),this['bot']['on']('message',async _0x5544b3=>{const _0xebad35=_0x2a3f45;if(_0x5544b3[_0xebad35(0x1aa)]?.[_0xebad35(0x1e2)]('/'))return;const _0x46f9f4=_0x5544b3['chat']['id'],_0x4c2dcd=_0x5544b3[_0xebad35(0x167)]?.['id'][_0xebad35(0x1c0)](),_0xf1361f=_0x5544b3[_0xebad35(0x1aa)]?.[_0xebad35(0x1bc)]();if(!_0x4c2dcd||!_0xf1361f)return;try{const _0x8723c1=await database_1[_0xebad35(0x1d1)][_0xebad35(0x1c6)][_0xebad35(0x1c8)]({'where':{'telegramId':_0x4c2dcd},'include':{'shop':!![]}});if(!_0x8723c1){await this[_0xebad35(0x195)]?.[_0xebad35(0x1e4)](_0x46f9f4,_0xebad35(0x159));return;}if(_0x8723c1[_0xebad35(0x1bf)]&&_0x8723c1[_0xebad35(0x181)]&&_0x8723c1[_0xebad35(0x1da)]){await this[_0xebad35(0x195)]?.[_0xebad35(0x1e4)](_0x46f9f4,_0xebad35(0x1ac)+_0x8723c1[_0xebad35(0x1da)][_0xebad35(0x16f)]+'*.\x0a\x0a'+_0xebad35(0x172),{'parse_mode':_0xebad35(0x16a)});return;}const _0x387036=_0xf1361f[_0xebad35(0x126)](/\s+/);if(_0x387036[_0xebad35(0x1b2)]!==0x2){await this[_0xebad35(0x195)]?.['sendMessage'](_0x46f9f4,_0xebad35(0x145)+'📝\x20Format:\x20`username\x20api_key`\x0a\x0a'+_0xebad35(0x137)+_0xebad35(0x133)+(_0xebad35(0x10a)+_0x387036[_0xebad35(0x1b2)]+'\x20parts:\x20'+_0x387036[_0xebad35(0x1a9)](_0x41a123=>'`'+_0x41a123+'`')[_0xebad35(0x19b)](',\x20')),{'parse_mode':_0xebad35(0x16a)});return;}const [_0x4fb75f,_0x571b44]=_0x387036;console['log'](_0xebad35(0x135)+_0x4c2dcd+':\x20username=\x22'+_0x4fb75f+_0xebad35(0x15e)+_0x571b44[_0xebad35(0x1e3)](0x0,0xa)+'...\x22'),await this['handleSingleLineVerification'](_0x46f9f4,_0x4c2dcd,_0x4fb75f,_0x571b44);}catch(_0x382f0c){console[_0xebad35(0x114)]('Error\x20handling\x20message:',_0x382f0c),await this['bot']?.[_0xebad35(0x1e4)](_0x46f9f4,_0xebad35(0x1b4));}}),this[_0x2a3f45(0x195)]['on'](_0x2a3f45(0x114),_0x4b0e1e=>{const _0x31dfde=_0x2a3f45;console[_0x31dfde(0x114)](_0x31dfde(0x196),_0x4b0e1e);}),this[_0x2a3f45(0x195)]['on']('polling_error',_0x4dd617=>{const _0xa38e89=_0x2a3f45;console[_0xa38e89(0x114)]('Telegram\x20bot\x20polling\x20error:',_0x4dd617);});}async[a57_0x3ea08e(0x1a2)](_0x5caf7c,_0x1c4e9e,_0x34cd38,_0x17af44){const _0xd0ef0f=a57_0x3ea08e;try{console[_0xd0ef0f(0x1ba)](_0xd0ef0f(0x135)+_0x1c4e9e+_0xd0ef0f(0x190)+_0x34cd38+'\x22,\x20apiKey=\x22'+_0x17af44[_0xd0ef0f(0x1e3)](0x0,0xa)+_0xd0ef0f(0x1a0));if(!_0x34cd38||_0x34cd38[_0xd0ef0f(0x1b2)]<0x3||_0x34cd38[_0xd0ef0f(0x1b2)]>0x32||!/^[a-zA-Z0-9_]+$/[_0xd0ef0f(0x112)](_0x34cd38)){await this[_0xd0ef0f(0x195)]?.[_0xd0ef0f(0x1e4)](_0x5caf7c,_0xd0ef0f(0x125)+_0x34cd38+_0xd0ef0f(0x1b8)+_0xd0ef0f(0x1d2),{'parse_mode':_0xd0ef0f(0x16a)});return;}if(!_0x17af44||!_0x17af44['startsWith'](_0xd0ef0f(0x151))&&!_0x17af44[_0xd0ef0f(0x1e2)](_0xd0ef0f(0x19d))){await this['bot']?.['sendMessage'](_0x5caf7c,_0xd0ef0f(0x174)+'API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.',{'parse_mode':_0xd0ef0f(0x16a)});return;}const _0x49b9dc=await database_1['default']['shop']['findUnique']({'where':{'username':_0x34cd38},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x49b9dc){const _0x370f7c=await database_1[_0xd0ef0f(0x1d1)]['shop'][_0xd0ef0f(0x139)]({'select':{'username':!![],'name':!![]},'take':0x5});let _0x363166='❌\x20Shop\x20with\x20username\x20`'+_0x34cd38+'`\x20not\x20found.\x0a\x0a';_0x370f7c['length']>0x0?(_0x363166+=_0xd0ef0f(0x108),_0x370f7c['forEach'](_0x559b9f=>{const _0x3d16d8=_0xd0ef0f;_0x363166+=_0x3d16d8(0x1c1)+_0x559b9f['username']+_0x3d16d8(0x103)+_0x559b9f['name']+')\x0a';}),_0x363166+=_0xd0ef0f(0x11e)):_0x363166+=_0xd0ef0f(0x186);await this['bot']?.[_0xd0ef0f(0x1e4)](_0x5caf7c,_0x363166,{'parse_mode':_0xd0ef0f(0x16a)});return;}if(_0x49b9dc[_0xd0ef0f(0x1ab)]!==_0xd0ef0f(0x15f)){await this[_0xd0ef0f(0x195)]?.[_0xd0ef0f(0x1e4)](_0x5caf7c,'❌\x20Shop\x20`'+_0x34cd38+'`\x20is\x20inactive.\x0a\x0a'+_0xd0ef0f(0x1a1),{'parse_mode':_0xd0ef0f(0x16a)});return;}if(_0x49b9dc[_0xd0ef0f(0x1c3)]!==_0x17af44&&_0x49b9dc[_0xd0ef0f(0x13a)]!==_0x17af44){await this[_0xd0ef0f(0x195)]?.[_0xd0ef0f(0x1e4)](_0x5caf7c,_0xd0ef0f(0x165)+_0x34cd38+_0xd0ef0f(0x171)+_0xd0ef0f(0x14d)+_0xd0ef0f(0x109),{'parse_mode':_0xd0ef0f(0x16a)});return;}const _0x5a52e2=await database_1[_0xd0ef0f(0x1d1)][_0xd0ef0f(0x1c6)]['findFirst']({'where':{'shopId':_0x49b9dc['id'],'isVerified':!![],'telegramId':{'not':_0x1c4e9e}}});if(_0x5a52e2){await this[_0xd0ef0f(0x195)]?.['sendMessage'](_0x5caf7c,_0xd0ef0f(0x102)+_0x34cd38+_0xd0ef0f(0x171)+_0xd0ef0f(0x10f),{'parse_mode':_0xd0ef0f(0x16a)});return;}await database_1[_0xd0ef0f(0x1d1)][_0xd0ef0f(0x1c6)][_0xd0ef0f(0x1b0)]({'where':{'telegramId':_0x1c4e9e},'data':{'shopId':_0x49b9dc['id'],'isVerified':!![]}}),await this[_0xd0ef0f(0x195)]?.[_0xd0ef0f(0x1e4)](_0x5caf7c,_0xd0ef0f(0x1a5)+_0xd0ef0f(0x138)+(_0xd0ef0f(0x1d7)+_0x49b9dc[_0xd0ef0f(0x16f)]+'*\x0a')+(_0xd0ef0f(0x119)+_0x49b9dc['username']+_0xd0ef0f(0x1b8))+'🔔\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a'+_0xd0ef0f(0x183)+_0xd0ef0f(0x111)+'•\x20Payouts\x0a'+_0xd0ef0f(0x1af)+_0xd0ef0f(0x146)+_0xd0ef0f(0x1dc)+'/disconnect\x20-\x20disconnect\x20from\x20notifications',{'parse_mode':_0xd0ef0f(0x16a)}),console['log']('✅\x20Telegram\x20user\x20'+_0x1c4e9e+_0xd0ef0f(0x12e)+_0x49b9dc[_0xd0ef0f(0x199)]+_0xd0ef0f(0x13d));}catch(_0x3041bd){console[_0xd0ef0f(0x114)](_0xd0ef0f(0x124),_0x3041bd),await this['bot']?.['sendMessage'](_0x5caf7c,'❌\x20An\x20error\x20occurred\x20while\x20verifying\x20data.');}}async[a57_0x3ea08e(0x118)](_0x29d88f,_0x11448e,_0x9f2658){const _0x56105a=a57_0x3ea08e;if(!this[_0x56105a(0x195)]){console[_0x56105a(0x156)](_0x56105a(0x170));return;}try{const _0x4c15c3=await database_1[_0x56105a(0x1d1)][_0x56105a(0x1c6)][_0x56105a(0x139)]({'where':{'shopId':_0x29d88f,'isVerified':!![]}});if(_0x4c15c3[_0x56105a(0x1b2)]===0x0){console[_0x56105a(0x1ba)](_0x56105a(0x14f)+_0x29d88f);return;}const _0x1a2710=_0x4c15c3[_0x56105a(0x1a9)](async _0xa8ab86=>{const _0x327764=_0x56105a;try{await this[_0x327764(0x195)]?.[_0x327764(0x1e4)](_0xa8ab86['telegramId'],_0x11448e,_0x9f2658),console[_0x327764(0x1ba)](_0x327764(0x1a3)+_0xa8ab86[_0x327764(0x10b)]);}catch(_0x541e61){console[_0x327764(0x114)]('❌\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20'+_0xa8ab86[_0x327764(0x10b)]+':',_0x541e61),_0x541e61 instanceof Error&&(_0x541e61['message']['includes'](_0x327764(0x191))||_0x541e61[_0x327764(0x15a)]['includes'](_0x327764(0x12a))||_0x541e61[_0x327764(0x15a)]['includes']('user\x20is\x20deactivated'))&&(await database_1[_0x327764(0x1d1)][_0x327764(0x1c6)][_0x327764(0x1b0)]({'where':{'id':_0xa8ab86['id']},'data':{'isVerified':![]}}),console[_0x327764(0x1ba)]('User\x20'+_0xa8ab86[_0x327764(0x10b)]+_0x327764(0x160)));}});await Promise[_0x56105a(0x19e)](_0x1a2710);}catch(_0x1f731a){console[_0x56105a(0x114)](_0x56105a(0x11d),_0x1f731a);}}async[a57_0x3ea08e(0x1d6)](_0x3aa713,_0x396e0c,_0x312444){const _0x5d2343=a57_0x3ea08e,_0x23539f={'created':'🆕','paid':'✅','failed':'❌','expired':'⏰','refund':'🔄','chargeback':'⚠️','processing':'⚙️'},_0x4b7cd0={'created':_0x5d2343(0x13c),'paid':_0x5d2343(0x1b5),'failed':_0x5d2343(0x1a4),'expired':_0x5d2343(0x142),'refund':_0x5d2343(0x140),'chargeback':'Payment\x20chargeback','processing':_0x5d2343(0x18b)},_0x92b770=_0x23539f[_0x312444],_0x4e2af1=_0x4b7cd0[_0x312444],_0x208118=(0x0,gateway_1[_0x5d2343(0x113)])(_0x396e0c[_0x5d2343(0x197)]);console['log'](_0x5d2343(0x120)+_0x396e0c[_0x5d2343(0x197)]+_0x5d2343(0x10d)+_0x208118+'\x22');let _0x2c95d8=_0x92b770+'\x20*'+_0x4e2af1+_0x5d2343(0x19c)+(_0x5d2343(0x123)+_0x396e0c[_0x5d2343(0x110)]+'\x20'+_0x396e0c['currency']+'*\x0a')+(_0x5d2343(0x11a)+(_0x396e0c['orderId']||_0x396e0c['id'])+'`\x0a')+(_0x5d2343(0x1cb)+_0x396e0c['id']+'`\x0a')+(_0x5d2343(0x17f)+_0x208118+'`\x0a')+(_0x5d2343(0x15d)+new Date(_0x396e0c[_0x5d2343(0x179)])[_0x5d2343(0x157)](_0x5d2343(0x1c7))+'\x0a');if(_0x396e0c[_0x5d2343(0x158)]||_0x396e0c[_0x5d2343(0x187)]||_0x396e0c[_0x5d2343(0x153)]||_0x396e0c[_0x5d2343(0x116)]||_0x396e0c[_0x5d2343(0x1de)]){_0x2c95d8+=_0x5d2343(0x1d3);_0x396e0c[_0x5d2343(0x158)]&&(_0x2c95d8+='📛\x20Name:\x20`'+_0x396e0c[_0x5d2343(0x158)]+'`\x0a');_0x396e0c[_0x5d2343(0x187)]&&(_0x2c95d8+='📧\x20Email:\x20`'+_0x396e0c[_0x5d2343(0x187)]+'`\x0a');_0x396e0c[_0x5d2343(0x153)]&&(_0x2c95d8+=_0x5d2343(0x12d)+_0x396e0c[_0x5d2343(0x153)]+'`\x0a');_0x396e0c[_0x5d2343(0x116)]&&(_0x2c95d8+='🌐\x20IP:\x20`'+_0x396e0c['customerIp']+'`\x0a');if(_0x396e0c[_0x5d2343(0x1de)]){const _0x36933e=_0x396e0c[_0x5d2343(0x1de)][_0x5d2343(0x1b2)]>0x32?_0x396e0c[_0x5d2343(0x1de)][_0x5d2343(0x1e3)](0x0,0x32)+_0x5d2343(0x1c4):_0x396e0c[_0x5d2343(0x1de)];_0x2c95d8+='💻\x20Browser:\x20`'+_0x36933e+'`\x0a';}}_0x312444===_0x5d2343(0x1e0)&&_0x396e0c[_0x5d2343(0x192)]&&(_0x2c95d8+='💸\x20Penalty\x20amount:\x20*'+_0x396e0c[_0x5d2343(0x192)]+_0x5d2343(0x1d9)),_0x312444==='processing'&&(_0x2c95d8+=_0x5d2343(0x16b)),_0x396e0c[_0x5d2343(0x104)]&&(_0x2c95d8+=_0x5d2343(0x152)+_0x396e0c[_0x5d2343(0x104)]+'\x0a'),await this[_0x5d2343(0x118)](_0x3aa713,_0x2c95d8,{'parse_mode':_0x5d2343(0x16a)});}async[a57_0x3ea08e(0x12b)](_0x588070,_0x5d4393,_0x4bb1c1){const _0x269122=a57_0x3ea08e,_0xb379b0={'created':'📤','completed':'✅','rejected':'❌'},_0x3a029e={'created':_0x269122(0x1b6),'completed':'Payout\x20completed','rejected':'Payout\x20rejected'},_0x38398d=_0xb379b0[_0x4bb1c1],_0x16b2da=_0x3a029e[_0x4bb1c1],_0x4d7312=_0x38398d+'\x20*'+_0x16b2da+_0x269122(0x19c)+(_0x269122(0x161)+_0x5d4393[_0x269122(0x110)]+_0x269122(0x16c))+(_0x269122(0x1c2)+_0x5d4393[_0x269122(0x17e)]+'`\x0a')+(_0x269122(0x173)+_0x5d4393['id']+'`\x0a')+(_0x269122(0x15d)+new Date(_0x5d4393[_0x269122(0x179)])[_0x269122(0x157)](_0x269122(0x1c7))+'\x0a')+(_0x5d4393[_0x269122(0x148)]?_0x269122(0x12f)+_0x5d4393[_0x269122(0x148)]+'`':'');await this[_0x269122(0x118)](_0x588070,_0x4d7312,{'parse_mode':_0x269122(0x16a)});}async['sendLoginNotification'](_0x2801d4,_0x32b2b2){const _0x3721c0=a57_0x3ea08e;try{const _0x175085=await database_1['default'][_0x3721c0(0x198)][_0x3721c0(0x1c8)]({'where':{'shopId':_0x2801d4},'select':{'notificationLogin':!![]}});if(!_0x175085?.[_0x3721c0(0x18e)]){console[_0x3721c0(0x1ba)](_0x3721c0(0x184)+_0x2801d4);return;}const _0x5cf1c4=_0x32b2b2[_0x3721c0(0x17a)]?'🔐':'🚨',_0x2d1847=_0x32b2b2[_0x3721c0(0x17a)]?_0x3721c0(0x193):_0x3721c0(0x10e);let _0x5bdd9e=_0x5cf1c4+'\x20*'+_0x2d1847+_0x3721c0(0x19c)+(_0x3721c0(0x119)+_0x32b2b2['username']+'`\x0a')+(_0x3721c0(0x1cf)+_0x32b2b2[_0x3721c0(0x12c)][_0x3721c0(0x157)](_0x3721c0(0x1c7))+'\x0a');_0x32b2b2[_0x3721c0(0x1e1)]&&(_0x5bdd9e+='🌐\x20IP\x20address:\x20`'+_0x32b2b2[_0x3721c0(0x1e1)]+'`\x0a');if(_0x32b2b2[_0x3721c0(0x17c)]){const _0x52e8da=_0x32b2b2[_0x3721c0(0x17c)]['length']>0x32?_0x32b2b2[_0x3721c0(0x17c)][_0x3721c0(0x1e3)](0x0,0x32)+_0x3721c0(0x1c4):_0x32b2b2['userAgent'];_0x5bdd9e+=_0x3721c0(0x1cc)+_0x52e8da+'`\x0a';}!_0x32b2b2['success']&&(_0x5bdd9e+=_0x3721c0(0x162)),await this[_0x3721c0(0x118)](_0x2801d4,_0x5bdd9e,{'parse_mode':_0x3721c0(0x16a)}),console['log'](_0x3721c0(0x130)+_0x2801d4+':\x20'+(_0x32b2b2['success']?'success':_0x3721c0(0x117)));}catch(_0x21d9bf){console[_0x3721c0(0x114)](_0x3721c0(0x14c),_0x21d9bf);}}async[a57_0x3ea08e(0x1a6)](_0x12f7ed,_0x1b3713){const _0x1e0c69=a57_0x3ea08e;try{const _0x38d402=await database_1[_0x1e0c69(0x1d1)]['shopSettings']['findUnique']({'where':{'shopId':_0x12f7ed},'select':{'notificationApiError':!![]}});if(!_0x38d402?.[_0x1e0c69(0x1be)]){console[_0x1e0c69(0x1ba)](_0x1e0c69(0x155)+_0x12f7ed);return;}let _0xe90886=_0x1e0c69(0x115)+('🔗\x20Endpoint:\x20`'+_0x1b3713[_0x1e0c69(0x17e)]+'\x20'+_0x1b3713[_0x1e0c69(0x11f)]+'`\x0a')+(_0x1e0c69(0x1cf)+_0x1b3713[_0x1e0c69(0x12c)][_0x1e0c69(0x157)](_0x1e0c69(0x1c7))+'\x0a');_0x1b3713['statusCode']&&(_0xe90886+=_0x1e0c69(0x11c)+_0x1b3713[_0x1e0c69(0x1ae)]+'`\x0a'),_0xe90886+=_0x1e0c69(0x154)+_0x1b3713[_0x1e0c69(0x101)]+'`\x0a',_0x1b3713['requestId']&&(_0xe90886+=_0x1e0c69(0x16d)+_0x1b3713[_0x1e0c69(0x136)]+'`\x0a'),_0xe90886+=_0x1e0c69(0x1cd),await this[_0x1e0c69(0x118)](_0x12f7ed,_0xe90886,{'parse_mode':_0x1e0c69(0x16a)}),console[_0x1e0c69(0x1ba)]('✅\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20'+_0x12f7ed+':\x20'+_0x1b3713['endpoint']);}catch(_0x1d6494){console[_0x1e0c69(0x114)](_0x1e0c69(0x1c9),_0x1d6494);}}async[a57_0x3ea08e(0x18f)](_0x39c676,_0x1f6127,_0x435f7d){const _0x429ed4=a57_0x3ea08e;let _0x1c3b68=_0x429ed4(0x182)+_0x1f6127+_0x429ed4(0x19c);for(const [_0xe89f65,_0x1fc460]of Object[_0x429ed4(0x1ce)](_0x435f7d)){_0x1fc460!==null&&_0x1fc460!==undefined&&(_0x1c3b68+=_0xe89f65+':\x20`'+_0x1fc460+'`\x0a');}await this[_0x429ed4(0x118)](_0x39c676,_0x1c3b68,{'parse_mode':_0x429ed4(0x16a)});}[a57_0x3ea08e(0x180)](){const _0x575ed2=a57_0x3ea08e;return{'isActive':!!this[_0x575ed2(0x195)],'username':this['botUsername']};}[a57_0x3ea08e(0x15c)](){const _0x26ca92=a57_0x3ea08e;this[_0x26ca92(0x195)]&&(this[_0x26ca92(0x195)][_0x26ca92(0x122)](),this[_0x26ca92(0x195)]=null,console[_0x26ca92(0x1ba)](_0x26ca92(0x1db)));}}exports['TelegramBotService']=TelegramBotService,exports[a57_0x3ea08e(0x168)]=new TelegramBotService();