'use strict';function a55_0x5f1f(){const _0x27cbf0=['getGatewayDisplayNameForTelegram','Check\x20spelling\x20and\x20try\x20again.','📱\x20Created\x20new\x20Telegram\x20user:\x20','❌\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`','📛\x20Name:\x20`','•\x20Payment\x20status\x20changes\x0a','first_name','username','\x20\x20\x20Status:\x20','Failed\x20login\x20attempt','amount','sendLoginNotification','Contact\x20administrator.','env','❗️\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!','txid','📱\x20Telegram\x20notification:\x20gateway\x20\x22','timestamp','👤\x20Username:\x20`','botToken','286qHtWeB','TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables','Username:\x20`','✅\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*','📝\x20Notes:\x20','🔔\x20*','forEach','ipAddress','chargebackAmount','✅\x20Connected\x20to\x20shop:\x20*','customerUa','telegramBotService','🆔\x20Request\x20ID:\x20`','length','✅\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20','substring','currency','To\x20reconnect,\x20use\x20the\x20/start\x20command','🔗\x20Endpoint:\x20`','TelegramBotService','\x22,\x20apiKey=\x22','Use\x20/start\x20to\x20connect.','✅\x20Telegram\x20user\x20','📧\x20Email:\x20`','shopId','Payment\x20successfully\x20paid',':\x20username=\x22','❌\x20Please\x20use\x20/start\x20command\x20first','Error\x20handling\x20/debug\x20command:','💻\x20Browser:\x20`','adminNotes','updatedAt','requestId','secretKey','🤖\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a','startsWith','•\x20New\x20payments\x0a','662117luYfwM','❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','\x0a⚠️\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!','onText','Commands:\x0a','No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20','status','Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification','🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20','🌐\x20IP:\x20`','.\x20*','Telegram\x20bot\x20polling\x20error:','customerName','Payment\x20failed','chargeback','66280KxURMb','Telegram\x20bot\x20error:','\x20via\x20single-line\x20input','✅\x20Notification\x20sent\x20to\x20Telegram\x20user\x20','../config/database','13953CPCvXg','Use\x20/start\x20to\x20begin.','customerIp','\x20USDT*\x0a','/disconnect\x20-\x20disconnect\x20from\x20notifications','🔌\x20User\x20','__importDefault','Payment\x20chargeback','TELEGRAM_BOT_USERNAME','Payment\x20expired','node-telegram-bot-api','...\x22','⏳\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a','stopBot','Error\x20sending\x20shop\x20notification:','❌\x20Error:\x20`','🆔\x20Payout\x20ID:\x20`','isVerified','customerEmail','text','`\x20(','update','name','__esModule','4002296CAeeZc','🔍\x20*Debug\x20Information*\x0a\x0a','sendMessage','toString','trapay_bot','sendPayoutNotification','\x20initialized\x20successfully','•\x20Important\x20events\x0a\x0a','*\x0a\x0a','📊\x20Error\x20code:\x20`','publicKey','defineProperty','User\x20','\x0a👤\x20*Customer\x20Information:*\x0a','*.\x0a\x0a','Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`','Payout\x20completed','sendPaymentNotification','error','entries','✅\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a','endpoint','❌\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a','Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.','❌\x20API\x20key\x20does\x20not\x20match\x20shop\x20`','API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','\x20USD*\x0a','botUsername','📱\x20Shop:\x20*','❌\x20Shop\x20`','toLocaleString','❌\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20','6225786mWgglq','bot','from','chat\x20not\x20found','shop','\x20verified\x20for\x20shop\x20','Payout\x20rejected','🔔\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a','log','notificationApiError','sendShopNotification','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','🔔\x20Notifications\x20are\x20active\x0a\x0a','❌\x20Shop\x20with\x20username\x20`','You\x20sent\x20','🏪\x20Gateway:\x20`','❌\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.','🛑\x20Telegram\x20bot\x20stopped','success','allSettled','method','remitterIban','Error\x20handling\x20message:','handleSingleLineVerification','findMany','warn','setupBotHandlers','stopPolling','Failed\x20to\x20send\x20login\x20notification:','📅\x20Date:\x20','../types/gateway','📅\x20Time:\x20','\x20\x20\x20Public\x20Key:\x20`','🏦\x20IBAN:\x20`','processing','en-US','❌\x20An\x20error\x20occurred\x20while\x20verifying\x20data.','🔗\x20TXID:\x20`','orderId','findUnique','To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a','chat','`.\x0a\x0a','TELEGRAM_BOT_TOKEN','🌐\x20IP\x20address:\x20`','split','unknown\x20shop','📱\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20','create','❌\x20Error\x20getting\x20debug\x20information.','💸\x20Penalty\x20amount:\x20*','💰\x20Amount:\x20*','initializeBot','3141YeLmWB','3956970cCgdxi','telegramId','\x0aCheck\x20spelling\x20and\x20try\x20again.','📝\x20Format:\x20`username\x20api_key`\x0a\x0a','includes','userAgent','sendApiErrorNotification','...','🆔\x20Payment\x20ID:\x20`','❌\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a','test','gateway','❌\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a','📅\x20Connection\x20date:\x20','findFirst','shopSettings','errorMessage','Example:\x0a','🔔\x20You\x20receive\x20notifications\x20about:\x0a','\x20disconnected\x20from\x20shop\x20','🎉\x20*Congratulations!*\x0a\x0a','✅\x20Welcome\x20back!\x0a\x0a','Error\x20handling\x20/start\x20command:','❌\x20Invalid\x20API\x20key\x20format.\x0a\x0a','createdAt','...`\x0a\x0a','map','\x20parts:\x20','default','•\x20Payouts\x0a','1527169WmYXnF','message','Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a','Error\x20handling\x20/status\x20command:','`\x0a\x0a','failed','statusCode','Markdown','Successful\x20login','join','telegramUser','New\x20payout\x20created','\x22\x20->\x20display\x20\x22','Payment\x20refund'];a55_0x5f1f=function(){return _0x27cbf0;};return a55_0x5f1f();}const a55_0x28347a=a55_0x4e04;(function(_0x17b501,_0xc45d30){const _0x204de2=a55_0x4e04,_0x481cb4=_0x17b501();while(!![]){try{const _0x3ddf36=-parseInt(_0x204de2(0x20e))/0x1+-parseInt(_0x204de2(0x1e9))/0x2*(parseInt(_0x204de2(0x222))/0x3)+-parseInt(_0x204de2(0x23a))/0x4+parseInt(_0x204de2(0x1a9))/0x5+-parseInt(_0x204de2(0x25a))/0x6+parseInt(_0x204de2(0x1c7))/0x7+-parseInt(_0x204de2(0x21d))/0x8*(-parseInt(_0x204de2(0x1a8))/0x9);if(_0x3ddf36===_0xc45d30)break;else _0x481cb4['push'](_0x481cb4['shift']());}catch(_0x26345c){_0x481cb4['push'](_0x481cb4['shift']());}}}(a55_0x5f1f,0x82c3b));function a55_0x4e04(_0x3e96fa,_0x308a48){const _0x5f1f3f=a55_0x5f1f();return a55_0x4e04=function(_0x4e04f3,_0x1bf480){_0x4e04f3=_0x4e04f3-0x1a5;let _0x4d325c=_0x5f1f3f[_0x4e04f3];return _0x4d325c;},a55_0x4e04(_0x3e96fa,_0x308a48);}var __importDefault=this&&this[a55_0x28347a(0x228)]||function(_0x5c717c){return _0x5c717c&&_0x5c717c['__esModule']?_0x5c717c:{'default':_0x5c717c};};Object[a55_0x28347a(0x245)](exports,a55_0x28347a(0x239),{'value':!![]}),exports['telegramBotService']=exports[a55_0x28347a(0x1fc)]=void 0x0;const node_telegram_bot_api_1=__importDefault(require(a55_0x28347a(0x22c))),database_1=__importDefault(require(a55_0x28347a(0x221))),gateway_1=require(a55_0x28347a(0x278));class TelegramBotService{constructor(){const _0x4aeffa=a55_0x28347a;this[_0x4aeffa(0x25b)]=null,this[_0x4aeffa(0x1e8)]=process[_0x4aeffa(0x1e2)][_0x4aeffa(0x285)]||'',this[_0x4aeffa(0x255)]=process[_0x4aeffa(0x1e2)][_0x4aeffa(0x22a)]||_0x4aeffa(0x23e),this[_0x4aeffa(0x1e8)]?this[_0x4aeffa(0x1a7)]():console['warn'](_0x4aeffa(0x1ea));}['initializeBot'](){const _0x3edc1c=a55_0x28347a;try{this[_0x3edc1c(0x25b)]=new node_telegram_bot_api_1[(_0x3edc1c(0x1c5))](this[_0x3edc1c(0x1e8)],{'polling':!![]}),this[_0x3edc1c(0x274)](),console['log']('✅\x20Telegram\x20bot\x20@'+this[_0x3edc1c(0x255)]+_0x3edc1c(0x240));}catch(_0x595b78){console[_0x3edc1c(0x24c)]('❌\x20Failed\x20to\x20initialize\x20Telegram\x20bot:',_0x595b78);}}[a55_0x28347a(0x274)](){const _0x33e28d=a55_0x28347a;if(!this['bot'])return;this['bot'][_0x33e28d(0x211)](/\/start/,async _0x1e293e=>{const _0x2e9a28=_0x33e28d,_0x23b538=_0x1e293e[_0x2e9a28(0x283)]['id'],_0x46b830=_0x1e293e[_0x2e9a28(0x25c)]?.['id'][_0x2e9a28(0x23d)](),_0x121176=_0x1e293e[_0x2e9a28(0x25c)]?.[_0x2e9a28(0x1dc)],_0x3a147b=_0x1e293e[_0x2e9a28(0x25c)]?.[_0x2e9a28(0x1db)],_0x46841b=_0x1e293e[_0x2e9a28(0x25c)]?.['last_name'];if(!_0x46b830)return;try{let _0x3745c1=await database_1[_0x2e9a28(0x1c5)][_0x2e9a28(0x1d1)][_0x2e9a28(0x281)]({'where':{'telegramId':_0x46b830},'include':{'shop':!![]}});!_0x3745c1?(_0x3745c1=await database_1['default'][_0x2e9a28(0x1d1)][_0x2e9a28(0x28a)]({'data':{'telegramId':_0x46b830,'username':_0x121176,'firstName':_0x3a147b,'lastName':_0x46841b,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console[_0x2e9a28(0x262)](_0x2e9a28(0x1d7)+_0x46b830+'\x20(@'+_0x121176+')')):_0x3745c1=await database_1[_0x2e9a28(0x1c5)][_0x2e9a28(0x1d1)][_0x2e9a28(0x237)]({'where':{'telegramId':_0x46b830},'data':{'username':_0x121176,'firstName':_0x3a147b,'lastName':_0x46841b},'include':{'shop':!![]}}),_0x3745c1['isVerified']&&_0x3745c1['shopId']&&_0x3745c1[_0x2e9a28(0x25e)]?await this['bot']?.[_0x2e9a28(0x23c)](_0x23b538,_0x2e9a28(0x1be)+('You\x20are\x20already\x20connected\x20to\x20shop:\x20*'+_0x3745c1[_0x2e9a28(0x25e)][_0x2e9a28(0x238)]+'*\x0a')+(_0x2e9a28(0x1eb)+_0x3745c1['shop'][_0x2e9a28(0x1dc)]+'`\x0a\x0a')+_0x2e9a28(0x1bb)+_0x2e9a28(0x20d)+_0x2e9a28(0x1da)+'•\x20Payouts\x0a\x0a'+_0x2e9a28(0x212)+'/status\x20-\x20check\x20connection\x20status\x0a'+_0x2e9a28(0x226),{'parse_mode':'Markdown'}):(_0x3745c1[_0x2e9a28(0x201)]&&!_0x3745c1[_0x2e9a28(0x233)]&&(await database_1[_0x2e9a28(0x1c5)][_0x2e9a28(0x1d1)][_0x2e9a28(0x237)]({'where':{'telegramId':_0x46b830},'data':{'shopId':null,'isVerified':![]}}),console[_0x2e9a28(0x262)]('🔄\x20Reset\x20incomplete\x20verification\x20for\x20user\x20'+_0x46b830)),await this['bot']?.[_0x2e9a28(0x23c)](_0x23b538,_0x2e9a28(0x20b)+_0x2e9a28(0x282)+_0x2e9a28(0x1ac)+_0x2e9a28(0x1ba)+_0x2e9a28(0x265)+_0x2e9a28(0x1e3),{'parse_mode':_0x2e9a28(0x1ce)}));}catch(_0x486dd2){console[_0x2e9a28(0x24c)](_0x2e9a28(0x1bf),_0x486dd2),await this[_0x2e9a28(0x25b)]?.[_0x2e9a28(0x23c)](_0x23b538,_0x2e9a28(0x20f));}}),this[_0x33e28d(0x25b)]['onText'](/\/disconnect/,async _0x5e46f8=>{const _0x3c4161=_0x33e28d,_0x5dd03a=_0x5e46f8[_0x3c4161(0x283)]['id'],_0x89deab=_0x5e46f8[_0x3c4161(0x25c)]?.['id'][_0x3c4161(0x23d)]();if(!_0x89deab)return;try{const _0x4ae423=await database_1[_0x3c4161(0x1c5)][_0x3c4161(0x1d1)][_0x3c4161(0x281)]({'where':{'telegramId':_0x89deab},'include':{'shop':!![]}});if(!_0x4ae423||!_0x4ae423[_0x3c4161(0x233)]||!_0x4ae423[_0x3c4161(0x201)]){await this[_0x3c4161(0x25b)]?.['sendMessage'](_0x5dd03a,_0x3c4161(0x26a));return;}const _0x522e7a=_0x4ae423[_0x3c4161(0x25e)]?.[_0x3c4161(0x238)]||_0x3c4161(0x288);await database_1[_0x3c4161(0x1c5)][_0x3c4161(0x1d1)]['update']({'where':{'telegramId':_0x89deab},'data':{'shopId':null,'isVerified':![]}}),console[_0x3c4161(0x262)](_0x3c4161(0x227)+_0x89deab+_0x3c4161(0x1bc)+_0x4ae423['shopId']),await this[_0x3c4161(0x25b)]?.['sendMessage'](_0x5dd03a,_0x3c4161(0x1ec)+_0x522e7a+_0x3c4161(0x248)+_0x3c4161(0x1fa),{'parse_mode':'Markdown'});}catch(_0x363a90){console['error']('Error\x20handling\x20/disconnect\x20command:',_0x363a90),await this['bot']?.[_0x3c4161(0x23c)](_0x5dd03a,_0x3c4161(0x20f));}}),this[_0x33e28d(0x25b)][_0x33e28d(0x211)](/\/status/,async _0x4f8e9b=>{const _0x1632d3=_0x33e28d,_0x2fd1a9=_0x4f8e9b[_0x1632d3(0x283)]['id'],_0x5a0b36=_0x4f8e9b[_0x1632d3(0x25c)]?.['id'][_0x1632d3(0x23d)]();if(!_0x5a0b36)return;try{const _0x4053f4=await database_1[_0x1632d3(0x1c5)][_0x1632d3(0x1d1)][_0x1632d3(0x281)]({'where':{'telegramId':_0x5a0b36},'include':{'shop':!![]}});if(!_0x4053f4){await this[_0x1632d3(0x25b)]?.[_0x1632d3(0x23c)](_0x2fd1a9,_0x1632d3(0x1b5)+_0x1632d3(0x223));return;}if(!_0x4053f4[_0x1632d3(0x233)]||!_0x4053f4['shopId']||!_0x4053f4[_0x1632d3(0x25e)]){await this[_0x1632d3(0x25b)]?.[_0x1632d3(0x23c)](_0x2fd1a9,_0x1632d3(0x250)+_0x1632d3(0x1fe));return;}await this[_0x1632d3(0x25b)]?.[_0x1632d3(0x23c)](_0x2fd1a9,'📊\x20*Connection\x20Status*\x0a\x0a'+(_0x1632d3(0x1f2)+_0x4053f4[_0x1632d3(0x25e)][_0x1632d3(0x238)]+'*\x0a')+(_0x1632d3(0x1e7)+_0x4053f4[_0x1632d3(0x25e)][_0x1632d3(0x1dc)]+'`\x0a')+(_0x1632d3(0x1b6)+_0x4053f4[_0x1632d3(0x208)]['toLocaleDateString'](_0x1632d3(0x27d))+'\x0a\x0a')+_0x1632d3(0x266)+_0x1632d3(0x212)+_0x1632d3(0x226),{'parse_mode':_0x1632d3(0x1ce)});}catch(_0x13eabc){console[_0x1632d3(0x24c)](_0x1632d3(0x1ca),_0x13eabc),await this[_0x1632d3(0x25b)]?.[_0x1632d3(0x23c)](_0x2fd1a9,_0x1632d3(0x20f));}}),this['bot'][_0x33e28d(0x211)](/\/debug/,async _0x1d189f=>{const _0x2ff1a4=_0x33e28d,_0xd768ae=_0x1d189f[_0x2ff1a4(0x283)]['id'],_0x2588e6=_0x1d189f[_0x2ff1a4(0x25c)]?.['id'][_0x2ff1a4(0x23d)]();if(!_0x2588e6)return;try{const _0x11cc95=await database_1['default'][_0x2ff1a4(0x25e)]['findMany']({'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![]},'take':0xa});let _0x5610e9=_0x2ff1a4(0x23b);_0x5610e9+='📱\x20Your\x20Telegram\x20ID:\x20`'+_0x2588e6+_0x2ff1a4(0x1cb),_0x5610e9+='🏪\x20Available\x20shops\x20in\x20system:\x0a',_0x11cc95[_0x2ff1a4(0x1ef)]((_0x2bc7d1,_0x59d0c7)=>{const _0xa71732=_0x2ff1a4;_0x5610e9+=_0x59d0c7+0x1+_0xa71732(0x218)+_0x2bc7d1['name']+'*\x0a',_0x5610e9+='\x20\x20\x20Username:\x20`'+_0x2bc7d1['username']+'`\x0a',_0x5610e9+=_0xa71732(0x1dd)+_0x2bc7d1[_0xa71732(0x214)]+'\x0a',_0x5610e9+=_0xa71732(0x27a)+_0x2bc7d1[_0xa71732(0x244)]['substring'](0x0,0xf)+_0xa71732(0x1c2);}),await this[_0x2ff1a4(0x25b)]?.['sendMessage'](_0xd768ae,_0x5610e9,{'parse_mode':_0x2ff1a4(0x1ce)});}catch(_0x5a925a){console['error'](_0x2ff1a4(0x205),_0x5a925a),await this[_0x2ff1a4(0x25b)]?.[_0x2ff1a4(0x23c)](_0xd768ae,_0x2ff1a4(0x28b));}}),this[_0x33e28d(0x25b)]['on'](_0x33e28d(0x1c8),async _0x2a0120=>{const _0x572b37=_0x33e28d;if(_0x2a0120[_0x572b37(0x235)]?.[_0x572b37(0x20c)]('/'))return;const _0xf5a84d=_0x2a0120[_0x572b37(0x283)]['id'],_0x16492f=_0x2a0120[_0x572b37(0x25c)]?.['id'][_0x572b37(0x23d)](),_0x410486=_0x2a0120['text']?.['trim']();if(!_0x16492f||!_0x410486)return;try{const _0x4290cf=await database_1[_0x572b37(0x1c5)][_0x572b37(0x1d1)][_0x572b37(0x281)]({'where':{'telegramId':_0x16492f},'include':{'shop':!![]}});if(!_0x4290cf){await this[_0x572b37(0x25b)]?.[_0x572b37(0x23c)](_0xf5a84d,_0x572b37(0x204));return;}if(_0x4290cf[_0x572b37(0x233)]&&_0x4290cf['shopId']&&_0x4290cf[_0x572b37(0x25e)]){await this[_0x572b37(0x25b)]?.[_0x572b37(0x23c)](_0xf5a84d,'✅\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*'+_0x4290cf['shop'][_0x572b37(0x238)]+_0x572b37(0x248)+_0x572b37(0x251),{'parse_mode':_0x572b37(0x1ce)});return;}const _0x1cff82=_0x410486[_0x572b37(0x287)](/\s+/);if(_0x1cff82[_0x572b37(0x1f6)]!==0x2){await this[_0x572b37(0x25b)]?.[_0x572b37(0x23c)](_0xf5a84d,_0x572b37(0x1b2)+'📝\x20Format:\x20`username\x20api_key`\x0a\x0a'+_0x572b37(0x1ba)+_0x572b37(0x265)+(_0x572b37(0x268)+_0x1cff82[_0x572b37(0x1f6)]+_0x572b37(0x1c4)+_0x1cff82['map'](_0x5c4518=>'`'+_0x5c4518+'`')[_0x572b37(0x1d0)](',\x20')),{'parse_mode':_0x572b37(0x1ce)});return;}const [_0x321209,_0x4f5cc2]=_0x1cff82;console[_0x572b37(0x262)](_0x572b37(0x216)+_0x16492f+_0x572b37(0x203)+_0x321209+_0x572b37(0x1fd)+_0x4f5cc2['substring'](0x0,0xa)+_0x572b37(0x22d)),await this['handleSingleLineVerification'](_0xf5a84d,_0x16492f,_0x321209,_0x4f5cc2);}catch(_0xf7aafc){console[_0x572b37(0x24c)](_0x572b37(0x270),_0xf7aafc),await this['bot']?.[_0x572b37(0x23c)](_0xf5a84d,_0x572b37(0x20f));}}),this[_0x33e28d(0x25b)]['on'](_0x33e28d(0x24c),_0x340f24=>{const _0x3f160d=_0x33e28d;console[_0x3f160d(0x24c)](_0x3f160d(0x21e),_0x340f24);}),this['bot']['on']('polling_error',_0x4b803b=>{const _0x428665=_0x33e28d;console[_0x428665(0x24c)](_0x428665(0x219),_0x4b803b);});}async[a55_0x28347a(0x271)](_0x31fdf9,_0x397f49,_0x211b54,_0x156276){const _0x57e816=a55_0x28347a;try{console['log'](_0x57e816(0x216)+_0x397f49+':\x20username=\x22'+_0x211b54+_0x57e816(0x1fd)+_0x156276[_0x57e816(0x1f8)](0x0,0xa)+'...\x22');if(!_0x211b54||_0x211b54[_0x57e816(0x1f6)]<0x3||_0x211b54[_0x57e816(0x1f6)]>0x32||!/^[a-zA-Z0-9_]+$/[_0x57e816(0x1b3)](_0x211b54)){await this[_0x57e816(0x25b)]?.[_0x57e816(0x23c)](_0x31fdf9,'❌\x20Invalid\x20username\x20format:\x20`'+_0x211b54+_0x57e816(0x1cb)+'Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).',{'parse_mode':'Markdown'});return;}if(!_0x156276||!_0x156276[_0x57e816(0x20c)]('pk_')&&!_0x156276[_0x57e816(0x20c)]('sk_')){await this['bot']?.[_0x57e816(0x23c)](_0x31fdf9,_0x57e816(0x1c0)+_0x57e816(0x253),{'parse_mode':_0x57e816(0x1ce)});return;}const _0x14c7cb=await database_1[_0x57e816(0x1c5)]['shop'][_0x57e816(0x281)]({'where':{'username':_0x211b54},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x14c7cb){const _0x445413=await database_1[_0x57e816(0x1c5)][_0x57e816(0x25e)][_0x57e816(0x272)]({'select':{'username':!![],'name':!![]},'take':0x5});let _0x3f97eb=_0x57e816(0x267)+_0x211b54+'`\x20not\x20found.\x0a\x0a';_0x445413[_0x57e816(0x1f6)]>0x0?(_0x3f97eb+='Available\x20usernames:\x0a',_0x445413['forEach'](_0xa77618=>{const _0x4dda2c=_0x57e816;_0x3f97eb+='•\x20`'+_0xa77618[_0x4dda2c(0x1dc)]+_0x4dda2c(0x236)+_0xa77618[_0x4dda2c(0x238)]+')\x0a';}),_0x3f97eb+=_0x57e816(0x1ab)):_0x3f97eb+=_0x57e816(0x1d6);await this[_0x57e816(0x25b)]?.[_0x57e816(0x23c)](_0x31fdf9,_0x3f97eb,{'parse_mode':_0x57e816(0x1ce)});return;}if(_0x14c7cb[_0x57e816(0x214)]!=='ACTIVE'){await this['bot']?.['sendMessage'](_0x31fdf9,_0x57e816(0x257)+_0x211b54+'`\x20is\x20inactive.\x0a\x0a'+_0x57e816(0x1e1),{'parse_mode':'Markdown'});return;}if(_0x14c7cb['publicKey']!==_0x156276&&_0x14c7cb[_0x57e816(0x20a)]!==_0x156276){await this[_0x57e816(0x25b)]?.['sendMessage'](_0x31fdf9,_0x57e816(0x252)+_0x211b54+_0x57e816(0x284)+_0x57e816(0x1c9)+_0x57e816(0x249),{'parse_mode':_0x57e816(0x1ce)});return;}const _0x298305=await database_1[_0x57e816(0x1c5)][_0x57e816(0x1d1)][_0x57e816(0x1b7)]({'where':{'shopId':_0x14c7cb['id'],'isVerified':!![],'telegramId':{'not':_0x397f49}}});if(_0x298305){await this[_0x57e816(0x25b)]?.[_0x57e816(0x23c)](_0x31fdf9,_0x57e816(0x1d8)+_0x211b54+_0x57e816(0x284)+'Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.',{'parse_mode':'Markdown'});return;}await database_1[_0x57e816(0x1c5)][_0x57e816(0x1d1)][_0x57e816(0x237)]({'where':{'telegramId':_0x397f49},'data':{'shopId':_0x14c7cb['id'],'isVerified':!![]}}),await this[_0x57e816(0x25b)]?.[_0x57e816(0x23c)](_0x31fdf9,_0x57e816(0x1bd)+_0x57e816(0x24e)+(_0x57e816(0x256)+_0x14c7cb[_0x57e816(0x238)]+'*\x0a')+(_0x57e816(0x1e7)+_0x14c7cb[_0x57e816(0x1dc)]+'`\x0a\x0a')+_0x57e816(0x261)+'•\x20New\x20payments\x0a'+_0x57e816(0x1da)+_0x57e816(0x1c6)+_0x57e816(0x241)+_0x57e816(0x212)+'/status\x20-\x20check\x20connection\x20status\x0a'+_0x57e816(0x226),{'parse_mode':'Markdown'}),console[_0x57e816(0x262)](_0x57e816(0x1ff)+_0x397f49+_0x57e816(0x25f)+_0x14c7cb[_0x57e816(0x1dc)]+_0x57e816(0x21f));}catch(_0x3439f0){console['error']('Error\x20in\x20handleSingleLineVerification:',_0x3439f0),await this[_0x57e816(0x25b)]?.[_0x57e816(0x23c)](_0x31fdf9,_0x57e816(0x27e));}}async[a55_0x28347a(0x264)](_0x5b3016,_0x20169d,_0x4ce00d){const _0x5c5426=a55_0x28347a;if(!this['bot']){console[_0x5c5426(0x273)](_0x5c5426(0x215));return;}try{const _0x1736e5=await database_1['default'][_0x5c5426(0x1d1)][_0x5c5426(0x272)]({'where':{'shopId':_0x5b3016,'isVerified':!![]}});if(_0x1736e5[_0x5c5426(0x1f6)]===0x0){console[_0x5c5426(0x262)](_0x5c5426(0x213)+_0x5b3016);return;}const _0x4fea45=_0x1736e5[_0x5c5426(0x1c3)](async _0x38d2e4=>{const _0x407e7a=_0x5c5426;try{await this[_0x407e7a(0x25b)]?.['sendMessage'](_0x38d2e4['telegramId'],_0x20169d,_0x4ce00d),console[_0x407e7a(0x262)](_0x407e7a(0x220)+_0x38d2e4[_0x407e7a(0x1aa)]);}catch(_0xc0135a){console[_0x407e7a(0x24c)](_0x407e7a(0x259)+_0x38d2e4[_0x407e7a(0x1aa)]+':',_0xc0135a),_0xc0135a instanceof Error&&(_0xc0135a[_0x407e7a(0x1c8)][_0x407e7a(0x1ad)]('blocked')||_0xc0135a[_0x407e7a(0x1c8)][_0x407e7a(0x1ad)](_0x407e7a(0x25d))||_0xc0135a[_0x407e7a(0x1c8)]['includes']('user\x20is\x20deactivated'))&&(await database_1['default'][_0x407e7a(0x1d1)]['update']({'where':{'id':_0x38d2e4['id']},'data':{'isVerified':![]}}),console['log'](_0x407e7a(0x246)+_0x38d2e4[_0x407e7a(0x1aa)]+'\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure'));}});await Promise[_0x5c5426(0x26d)](_0x4fea45);}catch(_0x573466){console[_0x5c5426(0x24c)](_0x5c5426(0x230),_0x573466);}}async[a55_0x28347a(0x24b)](_0x540765,_0x36d741,_0x3a2d01){const _0x103aeb=a55_0x28347a,_0x426709={'created':'🆕','paid':'✅','failed':'❌','expired':'⏰','refund':'🔄','chargeback':'⚠️','processing':'⚙️'},_0x1a7bf4={'created':'New\x20payment\x20created','paid':_0x103aeb(0x202),'failed':_0x103aeb(0x21b),'expired':_0x103aeb(0x22b),'refund':_0x103aeb(0x1d4),'chargeback':_0x103aeb(0x229),'processing':'Payment\x20is\x20being\x20processed'},_0x4f1808=_0x426709[_0x3a2d01],_0x3995c0=_0x1a7bf4[_0x3a2d01],_0x2fdcec=(0x0,gateway_1[_0x103aeb(0x1d5)])(_0x36d741[_0x103aeb(0x1b4)]);console['log'](_0x103aeb(0x1e5)+_0x36d741[_0x103aeb(0x1b4)]+_0x103aeb(0x1d3)+_0x2fdcec+'\x22');let _0x346f38=_0x4f1808+'\x20*'+_0x3995c0+_0x103aeb(0x242)+(_0x103aeb(0x1a6)+_0x36d741[_0x103aeb(0x1df)]+'\x20'+_0x36d741[_0x103aeb(0x1f9)]+'*\x0a')+('📝\x20Order\x20ID:\x20`'+(_0x36d741[_0x103aeb(0x280)]||_0x36d741['id'])+'`\x0a')+(_0x103aeb(0x1b1)+_0x36d741['id']+'`\x0a')+(_0x103aeb(0x269)+_0x2fdcec+'`\x0a')+(_0x103aeb(0x277)+new Date(_0x36d741[_0x103aeb(0x1c1)])[_0x103aeb(0x258)](_0x103aeb(0x27d))+'\x0a');if(_0x36d741[_0x103aeb(0x21a)]||_0x36d741[_0x103aeb(0x234)]||_0x36d741[_0x103aeb(0x26f)]||_0x36d741[_0x103aeb(0x224)]||_0x36d741[_0x103aeb(0x1f3)]){_0x346f38+=_0x103aeb(0x247);_0x36d741[_0x103aeb(0x21a)]&&(_0x346f38+=_0x103aeb(0x1d9)+_0x36d741['customerName']+'`\x0a');_0x36d741[_0x103aeb(0x234)]&&(_0x346f38+=_0x103aeb(0x200)+_0x36d741['customerEmail']+'`\x0a');_0x36d741['remitterIban']&&(_0x346f38+=_0x103aeb(0x27b)+_0x36d741[_0x103aeb(0x26f)]+'`\x0a');_0x36d741[_0x103aeb(0x224)]&&(_0x346f38+=_0x103aeb(0x217)+_0x36d741[_0x103aeb(0x224)]+'`\x0a');if(_0x36d741[_0x103aeb(0x1f3)]){const _0x626b41=_0x36d741[_0x103aeb(0x1f3)][_0x103aeb(0x1f6)]>0x32?_0x36d741[_0x103aeb(0x1f3)][_0x103aeb(0x1f8)](0x0,0x32)+_0x103aeb(0x1b0):_0x36d741[_0x103aeb(0x1f3)];_0x346f38+=_0x103aeb(0x206)+_0x626b41+'`\x0a';}}_0x3a2d01===_0x103aeb(0x21c)&&_0x36d741[_0x103aeb(0x1f1)]&&(_0x346f38+=_0x103aeb(0x1a5)+_0x36d741['chargebackAmount']+_0x103aeb(0x225)),_0x3a2d01===_0x103aeb(0x27c)&&(_0x346f38+=_0x103aeb(0x22e)),_0x36d741[_0x103aeb(0x207)]&&(_0x346f38+=_0x103aeb(0x1ed)+_0x36d741[_0x103aeb(0x207)]+'\x0a'),await this['sendShopNotification'](_0x540765,_0x346f38,{'parse_mode':'Markdown'});}async[a55_0x28347a(0x23f)](_0x40aaec,_0x5b2a82,_0x4b06ae){const _0x5a16e4=a55_0x28347a,_0x322f6f={'created':'📤','completed':'✅','rejected':'❌'},_0x405c72={'created':_0x5a16e4(0x1d2),'completed':_0x5a16e4(0x24a),'rejected':_0x5a16e4(0x260)},_0xe18353=_0x322f6f[_0x4b06ae],_0xf1f3ab=_0x405c72[_0x4b06ae],_0x434aa6=_0xe18353+'\x20*'+_0xf1f3ab+_0x5a16e4(0x242)+('💸\x20Amount:\x20*'+_0x5b2a82['amount']+_0x5a16e4(0x254))+('🏦\x20Method:\x20`'+_0x5b2a82[_0x5a16e4(0x26e)]+'`\x0a')+(_0x5a16e4(0x232)+_0x5b2a82['id']+'`\x0a')+('📅\x20Date:\x20'+new Date(_0x5b2a82['createdAt'])[_0x5a16e4(0x258)](_0x5a16e4(0x27d))+'\x0a')+(_0x5b2a82[_0x5a16e4(0x1e4)]?_0x5a16e4(0x27f)+_0x5b2a82[_0x5a16e4(0x1e4)]+'`':'');await this[_0x5a16e4(0x264)](_0x40aaec,_0x434aa6,{'parse_mode':'Markdown'});}async[a55_0x28347a(0x1e0)](_0x38af9d,_0x5ae99b){const _0x55d472=a55_0x28347a;try{const _0x2116df=await database_1[_0x55d472(0x1c5)][_0x55d472(0x1b8)][_0x55d472(0x281)]({'where':{'shopId':_0x38af9d},'select':{'notificationLogin':!![]}});if(!_0x2116df?.['notificationLogin']){console[_0x55d472(0x262)]('📱\x20Login\x20notifications\x20disabled\x20for\x20shop\x20'+_0x38af9d);return;}const _0x3ab695=_0x5ae99b[_0x55d472(0x26c)]?'🔐':'🚨',_0x49fdee=_0x5ae99b[_0x55d472(0x26c)]?_0x55d472(0x1cf):_0x55d472(0x1de);let _0x222dcc=_0x3ab695+'\x20*'+_0x49fdee+'*\x0a\x0a'+('👤\x20Username:\x20`'+_0x5ae99b[_0x55d472(0x1dc)]+'`\x0a')+('📅\x20Time:\x20'+_0x5ae99b[_0x55d472(0x1e6)][_0x55d472(0x258)](_0x55d472(0x27d))+'\x0a');_0x5ae99b['ipAddress']&&(_0x222dcc+=_0x55d472(0x286)+_0x5ae99b[_0x55d472(0x1f0)]+'`\x0a');if(_0x5ae99b[_0x55d472(0x1ae)]){const _0x433702=_0x5ae99b[_0x55d472(0x1ae)][_0x55d472(0x1f6)]>0x32?_0x5ae99b[_0x55d472(0x1ae)]['substring'](0x0,0x32)+_0x55d472(0x1b0):_0x5ae99b[_0x55d472(0x1ae)];_0x222dcc+=_0x55d472(0x206)+_0x433702+'`\x0a';}!_0x5ae99b[_0x55d472(0x26c)]&&(_0x222dcc+=_0x55d472(0x210)),await this[_0x55d472(0x264)](_0x38af9d,_0x222dcc,{'parse_mode':_0x55d472(0x1ce)}),console[_0x55d472(0x262)]('✅\x20Login\x20notification\x20sent\x20for\x20shop\x20'+_0x38af9d+':\x20'+(_0x5ae99b['success']?_0x55d472(0x26c):_0x55d472(0x1cc)));}catch(_0x8a30c5){console['error'](_0x55d472(0x276),_0x8a30c5);}}async[a55_0x28347a(0x1af)](_0x35d2c5,_0x19801e){const _0x562502=a55_0x28347a;try{const _0x53b073=await database_1[_0x562502(0x1c5)][_0x562502(0x1b8)][_0x562502(0x281)]({'where':{'shopId':_0x35d2c5},'select':{'notificationApiError':!![]}});if(!_0x53b073?.[_0x562502(0x263)]){console[_0x562502(0x262)](_0x562502(0x289)+_0x35d2c5);return;}let _0x5e9cd4='🚨\x20*API\x20Error*\x0a\x0a'+(_0x562502(0x1fb)+_0x19801e[_0x562502(0x26e)]+'\x20'+_0x19801e[_0x562502(0x24f)]+'`\x0a')+(_0x562502(0x279)+_0x19801e[_0x562502(0x1e6)]['toLocaleString']('en-US')+'\x0a');_0x19801e[_0x562502(0x1cd)]&&(_0x5e9cd4+=_0x562502(0x243)+_0x19801e[_0x562502(0x1cd)]+'`\x0a'),_0x5e9cd4+=_0x562502(0x231)+_0x19801e[_0x562502(0x1b9)]+'`\x0a',_0x19801e['requestId']&&(_0x5e9cd4+=_0x562502(0x1f5)+_0x19801e[_0x562502(0x209)]+'`\x0a'),_0x5e9cd4+='\x0a💡\x20Check\x20your\x20request\x20or\x20contact\x20support.',await this[_0x562502(0x264)](_0x35d2c5,_0x5e9cd4,{'parse_mode':_0x562502(0x1ce)}),console[_0x562502(0x262)](_0x562502(0x1f7)+_0x35d2c5+':\x20'+_0x19801e[_0x562502(0x24f)]);}catch(_0x4f0d0c){console['error']('Failed\x20to\x20send\x20API\x20error\x20notification:',_0x4f0d0c);}}async['sendCustomNotification'](_0x511f51,_0x51828e,_0x281963){const _0x3ec559=a55_0x28347a;let _0x32d08d=_0x3ec559(0x1ee)+_0x51828e+'*\x0a\x0a';for(const [_0x3e7978,_0x8a399f]of Object[_0x3ec559(0x24d)](_0x281963)){_0x8a399f!==null&&_0x8a399f!==undefined&&(_0x32d08d+=_0x3e7978+':\x20`'+_0x8a399f+'`\x0a');}await this[_0x3ec559(0x264)](_0x511f51,_0x32d08d,{'parse_mode':'Markdown'});}['getBotInfo'](){const _0x3d7799=a55_0x28347a;return{'isActive':!!this['bot'],'username':this[_0x3d7799(0x255)]};}[a55_0x28347a(0x22f)](){const _0x91f763=a55_0x28347a;this['bot']&&(this[_0x91f763(0x25b)][_0x91f763(0x275)](),this[_0x91f763(0x25b)]=null,console[_0x91f763(0x262)](_0x91f763(0x26b)));}}exports[a55_0x28347a(0x1fc)]=TelegramBotService,exports[a55_0x28347a(0x1f4)]=new TelegramBotService();