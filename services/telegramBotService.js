'use strict';const a58_0x51b727=a58_0x4480;function a58_0x550b(){const _0xbeb4ec=['❌\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.','❗️\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!','🔔\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a','polling_error','notificationLogin','Error\x20handling\x20message:','❌\x20Error:\x20`','Payment\x20chargeback','__esModule','chat\x20not\x20found','•\x20Payouts\x0a\x0a','telegramBotService','Commands:\x0a','🔔\x20Notifications\x20are\x20active\x0a\x0a','❌\x20Please\x20use\x20/start\x20command\x20first','\x22\x20->\x20display\x20\x22','Markdown','handleSingleLineVerification','💸\x20Amount:\x20*','/status\x20-\x20check\x20connection\x20status\x0a','sendPaymentNotification','❌\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a','`\x0a\x0a','✅\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*','includes','🆔\x20Payment\x20ID:\x20`','message','\x20\x20\x20Status:\x20','✅\x20Login\x20notification\x20sent\x20for\x20shop\x20','text','.\x20*','*.\x0a\x0a','❌\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`','length','📅\x20Time:\x20','❌\x20An\x20error\x20occurred\x20while\x20verifying\x20data.','👤\x20Username:\x20`','sk_','ipAddress','en-US','findFirst','toLocaleString','Payment\x20refund','\x0a👤\x20*Customer\x20Information:*\x0a','📝\x20Format:\x20`username\x20api_key`\x0a\x0a','updatedAt','❌\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20','📊\x20Error\x20code:\x20`','../types/gateway','stopPolling','findMany','username','🔍\x20*Debug\x20Information*\x0a\x0a','📱\x20Login\x20notifications\x20disabled\x20for\x20shop\x20','pk_','🌐\x20IP:\x20`','botToken','Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).','❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','`.\x0a\x0a','test','246780aIfvpG','unknown\x20shop','✅\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20','adminNotes','customerName','🔗\x20Endpoint:\x20`','findUnique','Failed\x20login\x20attempt','Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','🌐\x20IP\x20address:\x20`','...\x22','sendShopNotification','sendPayoutNotification','\x20disconnected\x20from\x20shop\x20','default','Telegram\x20bot\x20error:','❌\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a','User\x20','Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.','🆔\x20Payout\x20ID:\x20`','customerUa','txid','9nuxsCZ','\x20USDT*\x0a','💸\x20Penalty\x20amount:\x20*','update','setupBotHandlers','❌\x20Failed\x20to\x20initialize\x20Telegram\x20bot:','31432pWDNrM','userAgent','Telegram\x20bot\x20polling\x20error:','TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables','📧\x20Email:\x20`','•\x20`','TELEGRAM_BOT_USERNAME','1851080MyxwGo','New\x20payment\x20created','customerEmail','__importDefault','chat',':\x20`','name','📱\x20Your\x20Telegram\x20ID:\x20`','🏦\x20Method:\x20`','`\x20not\x20found.\x0a\x0a','✅\x20Connected\x20to\x20shop:\x20*','shop','../config/database','168rZyGdi','getGatewayDisplayNameForTelegram','332308YcWQgI','sendApiErrorNotification','Username:\x20`','💻\x20Browser:\x20`','Error\x20handling\x20/debug\x20command:','•\x20New\x20payments\x0a','statusCode','...`\x0a\x0a','To\x20reconnect,\x20use\x20the\x20/start\x20command','chargeback','orderId','sendMessage','toString','customerIp','📊\x20*Connection\x20Status*\x0a\x0a','isVerified','🏪\x20Gateway:\x20`','Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification','433590clJJQS','📱\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20','Payment\x20expired','API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','\x0a⚠️\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!','method','•\x20Important\x20events\x0a\x0a','Successful\x20login','\x0a💡\x20Check\x20your\x20request\x20or\x20contact\x20support.','📝\x20Order\x20ID:\x20`','TelegramBotService','ACTIVE','Failed\x20to\x20send\x20login\x20notification:','Contact\x20administrator.','amount','sendCustomNotification','shopId','Use\x20/start\x20to\x20begin.','Error\x20sending\x20shop\x20notification:','•\x20Payouts\x0a','Error\x20handling\x20/status\x20command:','\x20\x20\x20Username:\x20`','✅\x20Telegram\x20bot\x20@','Available\x20usernames:\x0a','telegramUser','\x0aCheck\x20spelling\x20and\x20try\x20again.','sendLoginNotification','✅\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*','initializeBot','🔔\x20You\x20receive\x20notifications\x20about:\x0a','❌\x20API\x20key\x20does\x20not\x20match\x20shop\x20`','📱\x20Created\x20new\x20Telegram\x20user:\x20','currency','📱\x20Telegram\x20notification:\x20gateway\x20\x22','🔔\x20*','❌\x20Shop\x20with\x20username\x20`','✅\x20Welcome\x20back!\x0a\x0a','success','*\x0a\x0a','botUsername','Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.','\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure','endpoint','🔗\x20TXID:\x20`','You\x20sent\x20','startsWith','allSettled','blocked','from','🆔\x20Request\x20ID:\x20`','warn','split','join','\x20initialized\x20successfully','errorMessage','log','14vSaeiO','24330WWOgDD',':\x20username=\x22','timestamp','requestId','✅\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a','map','notificationApiError','error','📅\x20Date:\x20','forEach','1080256uJyerE','...','shopSettings','gateway','bot','\x20\x20\x20Public\x20Key:\x20`','onText','entries','Payout\x20completed','env','remitterIban','🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20','status','To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a','❌\x20Shop\x20`','You\x20are\x20already\x20connected\x20to\x20shop:\x20*','Check\x20spelling\x20and\x20try\x20again.','publicKey','telegramId','🏦\x20IBAN:\x20`','Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`','Payout\x20rejected','Use\x20/start\x20to\x20connect.','`\x20is\x20inactive.\x0a\x0a','❌\x20Error\x20getting\x20debug\x20information.','substring','createdAt','/disconnect\x20-\x20disconnect\x20from\x20notifications','💰\x20Amount:\x20*'];a58_0x550b=function(){return _0xbeb4ec;};return a58_0x550b();}(function(_0x5f4a32,_0x1a502f){const _0x42a311=a58_0x4480,_0x16cbfd=_0x5f4a32();while(!![]){try{const _0x3bdcef=parseInt(_0x42a311(0x194))/0x1+parseInt(_0x42a311(0xfc))/0x2*(parseInt(_0x42a311(0xfd))/0x3)+parseInt(_0x42a311(0x107))/0x4+-parseInt(_0x42a311(0x185))/0x5+parseInt(_0x42a311(0x1a6))/0x6+parseInt(_0x42a311(0x192))/0x7*(-parseInt(_0x42a311(0x17e))/0x8)+-parseInt(_0x42a311(0x178))/0x9*(-parseInt(_0x42a311(0x161))/0xa);if(_0x3bdcef===_0x1a502f)break;else _0x16cbfd['push'](_0x16cbfd['shift']());}catch(_0x248e75){_0x16cbfd['push'](_0x16cbfd['shift']());}}}(a58_0x550b,0x472f5));var __importDefault=this&&this[a58_0x51b727(0x188)]||function(_0x2502cc){const _0x9b9496=a58_0x51b727;return _0x2502cc&&_0x2502cc[_0x9b9496(0x12c)]?_0x2502cc:{'default':_0x2502cc};};Object['defineProperty'](exports,a58_0x51b727(0x12c),{'value':!![]}),exports[a58_0x51b727(0x12f)]=exports[a58_0x51b727(0x1b0)]=void 0x0;const node_telegram_bot_api_1=__importDefault(require('node-telegram-bot-api')),database_1=__importDefault(require(a58_0x51b727(0x191))),gateway_1=require(a58_0x51b727(0x154));class TelegramBotService{constructor(){const _0x1873e3=a58_0x51b727;this[_0x1873e3(0x10b)]=null,this[_0x1873e3(0x15c)]=process[_0x1873e3(0x110)]['TELEGRAM_BOT_TOKEN']||'',this[_0x1873e3(0xeb)]=process[_0x1873e3(0x110)][_0x1873e3(0x184)]||'trapay_bot',this[_0x1873e3(0x15c)]?this[_0x1873e3(0x1c2)]():console[_0x1873e3(0xf6)](_0x1873e3(0x181));}[a58_0x51b727(0x1c2)](){const _0x372d52=a58_0x51b727;try{this['bot']=new node_telegram_bot_api_1[(_0x372d52(0x170))](this[_0x372d52(0x15c)],{'polling':!![]}),this[_0x372d52(0x17c)](),console[_0x372d52(0xfb)](_0x372d52(0x1bc)+this['botUsername']+_0x372d52(0xf9));}catch(_0x294d60){console[_0x372d52(0x104)](_0x372d52(0x17d),_0x294d60);}}[a58_0x51b727(0x17c)](){const _0x47b2d0=a58_0x51b727;if(!this[_0x47b2d0(0x10b)])return;this[_0x47b2d0(0x10b)][_0x47b2d0(0x10d)](/\/start/,async _0x411884=>{const _0x1c6797=_0x47b2d0,_0x1373b6=_0x411884[_0x1c6797(0x189)]['id'],_0x1a6415=_0x411884['from']?.['id'][_0x1c6797(0x1a0)](),_0x19f62d=_0x411884[_0x1c6797(0xf4)]?.[_0x1c6797(0x157)],_0x18567c=_0x411884['from']?.['first_name'],_0x49d33c=_0x411884[_0x1c6797(0xf4)]?.['last_name'];if(!_0x1a6415)return;try{let _0x44503d=await database_1[_0x1c6797(0x170)]['telegramUser'][_0x1c6797(0x167)]({'where':{'telegramId':_0x1a6415},'include':{'shop':!![]}});!_0x44503d?(_0x44503d=await database_1[_0x1c6797(0x170)]['telegramUser']['create']({'data':{'telegramId':_0x1a6415,'username':_0x19f62d,'firstName':_0x18567c,'lastName':_0x49d33c,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console['log'](_0x1c6797(0xe3)+_0x1a6415+'\x20(@'+_0x19f62d+')')):_0x44503d=await database_1[_0x1c6797(0x170)][_0x1c6797(0x1be)]['update']({'where':{'telegramId':_0x1a6415},'data':{'username':_0x19f62d,'firstName':_0x18567c,'lastName':_0x49d33c},'include':{'shop':!![]}}),_0x44503d[_0x1c6797(0x1a3)]&&_0x44503d[_0x1c6797(0x1b6)]&&_0x44503d['shop']?await this[_0x1c6797(0x10b)]?.[_0x1c6797(0x19f)](_0x1373b6,_0x1c6797(0xe8)+(_0x1c6797(0x116)+_0x44503d['shop'][_0x1c6797(0x18b)]+'*\x0a')+(_0x1c6797(0x196)+_0x44503d['shop'][_0x1c6797(0x157)]+_0x1c6797(0x13a))+_0x1c6797(0x1c3)+_0x1c6797(0x199)+'•\x20Payment\x20status\x20changes\x0a'+_0x1c6797(0x12e)+_0x1c6797(0x130)+'/status\x20-\x20check\x20connection\x20status\x0a'+'/disconnect\x20-\x20disconnect\x20from\x20notifications',{'parse_mode':_0x1c6797(0x134)}):(_0x44503d[_0x1c6797(0x1b6)]&&!_0x44503d[_0x1c6797(0x1a3)]&&(await database_1[_0x1c6797(0x170)]['telegramUser'][_0x1c6797(0x17b)]({'where':{'telegramId':_0x1a6415},'data':{'shopId':null,'isVerified':![]}}),console[_0x1c6797(0xfb)]('🔄\x20Reset\x20incomplete\x20verification\x20for\x20user\x20'+_0x1a6415)),await this['bot']?.[_0x1c6797(0x19f)](_0x1373b6,'🤖\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a'+_0x1c6797(0x114)+'📝\x20Format:\x20`username\x20api_key`\x0a\x0a'+'Example:\x0a'+_0x1c6797(0x16a)+_0x1c6797(0x125),{'parse_mode':_0x1c6797(0x134)}));}catch(_0x54c0e4){console['error']('Error\x20handling\x20/start\x20command:',_0x54c0e4),await this['bot']?.[_0x1c6797(0x19f)](_0x1373b6,'❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this[_0x47b2d0(0x10b)][_0x47b2d0(0x10d)](/\/disconnect/,async _0x494482=>{const _0x54232f=_0x47b2d0,_0x2c47d5=_0x494482['chat']['id'],_0xcd5bdd=_0x494482['from']?.['id']['toString']();if(!_0xcd5bdd)return;try{const _0x4b5cd0=await database_1[_0x54232f(0x170)][_0x54232f(0x1be)][_0x54232f(0x167)]({'where':{'telegramId':_0xcd5bdd},'include':{'shop':!![]}});if(!_0x4b5cd0||!_0x4b5cd0[_0x54232f(0x1a3)]||!_0x4b5cd0[_0x54232f(0x1b6)]){await this[_0x54232f(0x10b)]?.[_0x54232f(0x19f)](_0x2c47d5,_0x54232f(0x124));return;}const _0x55e886=_0x4b5cd0[_0x54232f(0x190)]?.['name']||_0x54232f(0x162);await database_1[_0x54232f(0x170)][_0x54232f(0x1be)]['update']({'where':{'telegramId':_0xcd5bdd},'data':{'shopId':null,'isVerified':![]}}),console[_0x54232f(0xfb)]('🔌\x20User\x20'+_0xcd5bdd+_0x54232f(0x16f)+_0x4b5cd0[_0x54232f(0x1b6)]),await this[_0x54232f(0x10b)]?.[_0x54232f(0x19f)](_0x2c47d5,_0x54232f(0x1c1)+_0x55e886+'*.\x0a\x0a'+_0x54232f(0x19c),{'parse_mode':_0x54232f(0x134)});}catch(_0x180637){console[_0x54232f(0x104)]('Error\x20handling\x20/disconnect\x20command:',_0x180637),await this[_0x54232f(0x10b)]?.[_0x54232f(0x19f)](_0x2c47d5,'❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this[_0x47b2d0(0x10b)][_0x47b2d0(0x10d)](/\/status/,async _0x4004d6=>{const _0x569151=_0x47b2d0,_0x1d0372=_0x4004d6['chat']['id'],_0x5b1ad9=_0x4004d6[_0x569151(0xf4)]?.['id'][_0x569151(0x1a0)]();if(!_0x5b1ad9)return;try{const _0x2b057c=await database_1[_0x569151(0x170)][_0x569151(0x1be)][_0x569151(0x167)]({'where':{'telegramId':_0x5b1ad9},'include':{'shop':!![]}});if(!_0x2b057c){await this[_0x569151(0x10b)]?.[_0x569151(0x19f)](_0x1d0372,'❌\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a'+_0x569151(0x1b7));return;}if(!_0x2b057c[_0x569151(0x1a3)]||!_0x2b057c[_0x569151(0x1b6)]||!_0x2b057c[_0x569151(0x190)]){await this[_0x569151(0x10b)]?.[_0x569151(0x19f)](_0x1d0372,_0x569151(0x139)+_0x569151(0x11d));return;}await this['bot']?.[_0x569151(0x19f)](_0x1d0372,_0x569151(0x1a2)+(_0x569151(0x18f)+_0x2b057c[_0x569151(0x190)]['name']+'*\x0a')+(_0x569151(0x148)+_0x2b057c[_0x569151(0x190)][_0x569151(0x157)]+'`\x0a')+('📅\x20Connection\x20date:\x20'+_0x2b057c[_0x569151(0x151)]['toLocaleDateString']('en-US')+'\x0a\x0a')+_0x569151(0x131)+_0x569151(0x130)+_0x569151(0x122),{'parse_mode':'Markdown'});}catch(_0x4d9df7){console[_0x569151(0x104)](_0x569151(0x1ba),_0x4d9df7),await this[_0x569151(0x10b)]?.[_0x569151(0x19f)](_0x1d0372,_0x569151(0x15e));}}),this[_0x47b2d0(0x10b)][_0x47b2d0(0x10d)](/\/debug/,async _0x27bb44=>{const _0x2835dd=_0x47b2d0,_0x32e8c7=_0x27bb44['chat']['id'],_0x53c954=_0x27bb44[_0x2835dd(0xf4)]?.['id']['toString']();if(!_0x53c954)return;try{const _0x55462d=await database_1[_0x2835dd(0x170)][_0x2835dd(0x190)][_0x2835dd(0x156)]({'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![]},'take':0xa});let _0x3c664d=_0x2835dd(0x158);_0x3c664d+=_0x2835dd(0x18c)+_0x53c954+_0x2835dd(0x13a),_0x3c664d+='🏪\x20Available\x20shops\x20in\x20system:\x0a',_0x55462d[_0x2835dd(0x106)]((_0x2859e3,_0x933b07)=>{const _0x510197=_0x2835dd;_0x3c664d+=_0x933b07+0x1+_0x510197(0x142)+_0x2859e3[_0x510197(0x18b)]+'*\x0a',_0x3c664d+=_0x510197(0x1bb)+_0x2859e3[_0x510197(0x157)]+'`\x0a',_0x3c664d+=_0x510197(0x13f)+_0x2859e3[_0x510197(0x113)]+'\x0a',_0x3c664d+=_0x510197(0x10c)+_0x2859e3[_0x510197(0x118)][_0x510197(0x120)](0x0,0xf)+_0x510197(0x19b);}),await this[_0x2835dd(0x10b)]?.[_0x2835dd(0x19f)](_0x32e8c7,_0x3c664d,{'parse_mode':_0x2835dd(0x134)});}catch(_0x52bc5a){console['error'](_0x2835dd(0x198),_0x52bc5a),await this[_0x2835dd(0x10b)]?.['sendMessage'](_0x32e8c7,_0x2835dd(0x11f));}}),this['bot']['on'](_0x47b2d0(0x13e),async _0x2635f9=>{const _0xc8e850=_0x47b2d0;if(_0x2635f9['text']?.['startsWith']('/'))return;const _0x1238d9=_0x2635f9['chat']['id'],_0x475a92=_0x2635f9[_0xc8e850(0xf4)]?.['id'][_0xc8e850(0x1a0)](),_0x5d3150=_0x2635f9[_0xc8e850(0x141)]?.['trim']();if(!_0x475a92||!_0x5d3150)return;try{const _0xe30f8e=await database_1['default']['telegramUser'][_0xc8e850(0x167)]({'where':{'telegramId':_0x475a92},'include':{'shop':!![]}});if(!_0xe30f8e){await this[_0xc8e850(0x10b)]?.[_0xc8e850(0x19f)](_0x1238d9,_0xc8e850(0x132));return;}if(_0xe30f8e[_0xc8e850(0x1a3)]&&_0xe30f8e['shopId']&&_0xe30f8e['shop']){await this[_0xc8e850(0x10b)]?.[_0xc8e850(0x19f)](_0x1238d9,_0xc8e850(0x13b)+_0xe30f8e['shop'][_0xc8e850(0x18b)]+_0xc8e850(0x143)+_0xc8e850(0xec),{'parse_mode':_0xc8e850(0x134)});return;}const _0x3733d1=_0x5d3150[_0xc8e850(0xf7)](/\s+/);if(_0x3733d1[_0xc8e850(0x145)]!==0x2){await this[_0xc8e850(0x10b)]?.[_0xc8e850(0x19f)](_0x1238d9,_0xc8e850(0x172)+_0xc8e850(0x150)+'Example:\x0a'+_0xc8e850(0x16a)+(_0xc8e850(0xf0)+_0x3733d1[_0xc8e850(0x145)]+'\x20parts:\x20'+_0x3733d1[_0xc8e850(0x102)](_0x200f59=>'`'+_0x200f59+'`')[_0xc8e850(0xf8)](',\x20')),{'parse_mode':'Markdown'});return;}const [_0x19ded4,_0x1181c5]=_0x3733d1;console[_0xc8e850(0xfb)](_0xc8e850(0x112)+_0x475a92+_0xc8e850(0xfe)+_0x19ded4+'\x22,\x20apiKey=\x22'+_0x1181c5[_0xc8e850(0x120)](0x0,0xa)+_0xc8e850(0x16c)),await this[_0xc8e850(0x135)](_0x1238d9,_0x475a92,_0x19ded4,_0x1181c5);}catch(_0x2f0d7b){console[_0xc8e850(0x104)](_0xc8e850(0x129),_0x2f0d7b),await this['bot']?.[_0xc8e850(0x19f)](_0x1238d9,_0xc8e850(0x15e));}}),this['bot']['on'](_0x47b2d0(0x104),_0x3636de=>{const _0x3c5fc9=_0x47b2d0;console['error'](_0x3c5fc9(0x171),_0x3636de);}),this[_0x47b2d0(0x10b)]['on'](_0x47b2d0(0x127),_0x1cb925=>{const _0x2778ef=_0x47b2d0;console['error'](_0x2778ef(0x180),_0x1cb925);});}async[a58_0x51b727(0x135)](_0x130c8e,_0x5d3cc2,_0x5d8681,_0x446af0){const _0x33f39a=a58_0x51b727;try{console['log'](_0x33f39a(0x112)+_0x5d3cc2+_0x33f39a(0xfe)+_0x5d8681+'\x22,\x20apiKey=\x22'+_0x446af0[_0x33f39a(0x120)](0x0,0xa)+_0x33f39a(0x16c));if(!_0x5d8681||_0x5d8681[_0x33f39a(0x145)]<0x3||_0x5d8681[_0x33f39a(0x145)]>0x32||!/^[a-zA-Z0-9_]+$/[_0x33f39a(0x160)](_0x5d8681)){await this[_0x33f39a(0x10b)]?.[_0x33f39a(0x19f)](_0x130c8e,'❌\x20Invalid\x20username\x20format:\x20`'+_0x5d8681+_0x33f39a(0x13a)+_0x33f39a(0x15d),{'parse_mode':_0x33f39a(0x134)});return;}if(!_0x446af0||!_0x446af0[_0x33f39a(0xf1)](_0x33f39a(0x15a))&&!_0x446af0[_0x33f39a(0xf1)](_0x33f39a(0x149))){await this[_0x33f39a(0x10b)]?.['sendMessage'](_0x130c8e,'❌\x20Invalid\x20API\x20key\x20format.\x0a\x0a'+_0x33f39a(0x1a9),{'parse_mode':_0x33f39a(0x134)});return;}const _0x5d0f1c=await database_1[_0x33f39a(0x170)][_0x33f39a(0x190)][_0x33f39a(0x167)]({'where':{'username':_0x5d8681},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x5d0f1c){const _0xc6ff35=await database_1[_0x33f39a(0x170)][_0x33f39a(0x190)][_0x33f39a(0x156)]({'select':{'username':!![],'name':!![]},'take':0x5});let _0x3894d0=_0x33f39a(0xe7)+_0x5d8681+_0x33f39a(0x18e);_0xc6ff35['length']>0x0?(_0x3894d0+=_0x33f39a(0x1bd),_0xc6ff35[_0x33f39a(0x106)](_0x58e5d9=>{const _0xd07f48=_0x33f39a;_0x3894d0+=_0xd07f48(0x183)+_0x58e5d9[_0xd07f48(0x157)]+'`\x20('+_0x58e5d9['name']+')\x0a';}),_0x3894d0+=_0x33f39a(0x1bf)):_0x3894d0+=_0x33f39a(0x117);await this[_0x33f39a(0x10b)]?.[_0x33f39a(0x19f)](_0x130c8e,_0x3894d0,{'parse_mode':_0x33f39a(0x134)});return;}if(_0x5d0f1c[_0x33f39a(0x113)]!==_0x33f39a(0x1b1)){await this['bot']?.[_0x33f39a(0x19f)](_0x130c8e,_0x33f39a(0x115)+_0x5d8681+_0x33f39a(0x11e)+_0x33f39a(0x1b3),{'parse_mode':_0x33f39a(0x134)});return;}if(_0x5d0f1c[_0x33f39a(0x118)]!==_0x446af0&&_0x5d0f1c['secretKey']!==_0x446af0){await this[_0x33f39a(0x10b)]?.[_0x33f39a(0x19f)](_0x130c8e,_0x33f39a(0xe2)+_0x5d8681+_0x33f39a(0x15f)+_0x33f39a(0x169)+_0x33f39a(0x11b),{'parse_mode':'Markdown'});return;}const _0x3246c5=await database_1[_0x33f39a(0x170)][_0x33f39a(0x1be)][_0x33f39a(0x14c)]({'where':{'shopId':_0x5d0f1c['id'],'isVerified':!![],'telegramId':{'not':_0x5d3cc2}}});if(_0x3246c5){await this[_0x33f39a(0x10b)]?.[_0x33f39a(0x19f)](_0x130c8e,_0x33f39a(0x144)+_0x5d8681+_0x33f39a(0x15f)+_0x33f39a(0x174),{'parse_mode':_0x33f39a(0x134)});return;}await database_1[_0x33f39a(0x170)][_0x33f39a(0x1be)][_0x33f39a(0x17b)]({'where':{'telegramId':_0x5d3cc2},'data':{'shopId':_0x5d0f1c['id'],'isVerified':!![]}}),await this[_0x33f39a(0x10b)]?.[_0x33f39a(0x19f)](_0x130c8e,'🎉\x20*Congratulations!*\x0a\x0a'+_0x33f39a(0x101)+('📱\x20Shop:\x20*'+_0x5d0f1c[_0x33f39a(0x18b)]+'*\x0a')+(_0x33f39a(0x148)+_0x5d0f1c[_0x33f39a(0x157)]+_0x33f39a(0x13a))+_0x33f39a(0x126)+_0x33f39a(0x199)+'•\x20Payment\x20status\x20changes\x0a'+_0x33f39a(0x1b9)+_0x33f39a(0x1ac)+_0x33f39a(0x130)+_0x33f39a(0x137)+_0x33f39a(0x122),{'parse_mode':_0x33f39a(0x134)}),console[_0x33f39a(0xfb)]('✅\x20Telegram\x20user\x20'+_0x5d3cc2+'\x20verified\x20for\x20shop\x20'+_0x5d0f1c[_0x33f39a(0x157)]+'\x20via\x20single-line\x20input');}catch(_0x74038b){console[_0x33f39a(0x104)]('Error\x20in\x20handleSingleLineVerification:',_0x74038b),await this['bot']?.[_0x33f39a(0x19f)](_0x130c8e,_0x33f39a(0x147));}}async[a58_0x51b727(0x16d)](_0x4be295,_0x3eac40,_0x19f7a7){const _0x1728e6=a58_0x51b727;if(!this[_0x1728e6(0x10b)]){console[_0x1728e6(0xf6)](_0x1728e6(0x1a5));return;}try{const _0x57357b=await database_1[_0x1728e6(0x170)][_0x1728e6(0x1be)][_0x1728e6(0x156)]({'where':{'shopId':_0x4be295,'isVerified':!![]}});if(_0x57357b[_0x1728e6(0x145)]===0x0){console[_0x1728e6(0xfb)]('No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20'+_0x4be295);return;}const _0x4a9516=_0x57357b['map'](async _0x3e666b=>{const _0x39575b=_0x1728e6;try{await this[_0x39575b(0x10b)]?.['sendMessage'](_0x3e666b['telegramId'],_0x3eac40,_0x19f7a7),console[_0x39575b(0xfb)]('✅\x20Notification\x20sent\x20to\x20Telegram\x20user\x20'+_0x3e666b[_0x39575b(0x119)]);}catch(_0xaf8d6){console[_0x39575b(0x104)](_0x39575b(0x152)+_0x3e666b[_0x39575b(0x119)]+':',_0xaf8d6),_0xaf8d6 instanceof Error&&(_0xaf8d6[_0x39575b(0x13e)][_0x39575b(0x13c)](_0x39575b(0xf3))||_0xaf8d6[_0x39575b(0x13e)]['includes'](_0x39575b(0x12d))||_0xaf8d6[_0x39575b(0x13e)][_0x39575b(0x13c)]('user\x20is\x20deactivated'))&&(await database_1[_0x39575b(0x170)]['telegramUser'][_0x39575b(0x17b)]({'where':{'id':_0x3e666b['id']},'data':{'isVerified':![]}}),console[_0x39575b(0xfb)](_0x39575b(0x173)+_0x3e666b[_0x39575b(0x119)]+_0x39575b(0xed)));}});await Promise[_0x1728e6(0xf2)](_0x4a9516);}catch(_0x48fb15){console['error'](_0x1728e6(0x1b8),_0x48fb15);}}async[a58_0x51b727(0x138)](_0xe2ad69,_0x2f7b32,_0xb8c34f){const _0x50adec=a58_0x51b727,_0x1f49db={'created':'🆕','paid':'✅','failed':'❌','expired':'⏰','refund':'🔄','chargeback':'⚠️','processing':'⚙️'},_0xccc515={'created':_0x50adec(0x186),'paid':'Payment\x20successfully\x20paid','failed':'Payment\x20failed','expired':_0x50adec(0x1a8),'refund':_0x50adec(0x14e),'chargeback':_0x50adec(0x12b),'processing':'Payment\x20is\x20being\x20processed'},_0x3ef4bc=_0x1f49db[_0xb8c34f],_0x4696cd=_0xccc515[_0xb8c34f],_0x140442=(0x0,gateway_1[_0x50adec(0x193)])(_0x2f7b32['gateway']);console[_0x50adec(0xfb)](_0x50adec(0xe5)+_0x2f7b32[_0x50adec(0x10a)]+_0x50adec(0x133)+_0x140442+'\x22');let _0x4a7dd1=_0x3ef4bc+'\x20*'+_0x4696cd+_0x50adec(0xea)+(_0x50adec(0x123)+_0x2f7b32[_0x50adec(0x1b4)]+'\x20'+_0x2f7b32[_0x50adec(0xe4)]+'*\x0a')+(_0x50adec(0x1af)+(_0x2f7b32[_0x50adec(0x19e)]||_0x2f7b32['id'])+'`\x0a')+(_0x50adec(0x13d)+_0x2f7b32['id']+'`\x0a')+(_0x50adec(0x1a4)+_0x140442+'`\x0a')+(_0x50adec(0x105)+new Date(_0x2f7b32[_0x50adec(0x121)])['toLocaleString'](_0x50adec(0x14b))+'\x0a');if(_0x2f7b32['customerName']||_0x2f7b32[_0x50adec(0x187)]||_0x2f7b32[_0x50adec(0x111)]||_0x2f7b32[_0x50adec(0x1a1)]||_0x2f7b32[_0x50adec(0x176)]){_0x4a7dd1+=_0x50adec(0x14f);_0x2f7b32['customerName']&&(_0x4a7dd1+='📛\x20Name:\x20`'+_0x2f7b32[_0x50adec(0x165)]+'`\x0a');_0x2f7b32[_0x50adec(0x187)]&&(_0x4a7dd1+=_0x50adec(0x182)+_0x2f7b32['customerEmail']+'`\x0a');_0x2f7b32[_0x50adec(0x111)]&&(_0x4a7dd1+=_0x50adec(0x11a)+_0x2f7b32[_0x50adec(0x111)]+'`\x0a');_0x2f7b32[_0x50adec(0x1a1)]&&(_0x4a7dd1+=_0x50adec(0x15b)+_0x2f7b32[_0x50adec(0x1a1)]+'`\x0a');if(_0x2f7b32[_0x50adec(0x176)]){const _0x371f4c=_0x2f7b32[_0x50adec(0x176)]['length']>0x32?_0x2f7b32[_0x50adec(0x176)][_0x50adec(0x120)](0x0,0x32)+_0x50adec(0x108):_0x2f7b32[_0x50adec(0x176)];_0x4a7dd1+='💻\x20Browser:\x20`'+_0x371f4c+'`\x0a';}}_0xb8c34f===_0x50adec(0x19d)&&_0x2f7b32['chargebackAmount']&&(_0x4a7dd1+=_0x50adec(0x17a)+_0x2f7b32['chargebackAmount']+_0x50adec(0x179)),_0xb8c34f==='processing'&&(_0x4a7dd1+='⏳\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a'),_0x2f7b32[_0x50adec(0x164)]&&(_0x4a7dd1+='📝\x20Notes:\x20'+_0x2f7b32[_0x50adec(0x164)]+'\x0a'),await this[_0x50adec(0x16d)](_0xe2ad69,_0x4a7dd1,{'parse_mode':'Markdown'});}async[a58_0x51b727(0x16e)](_0x3deacd,_0x455bdc,_0x4dedc0){const _0x511243=a58_0x51b727,_0x46ef44={'created':'📤','completed':'✅','rejected':'❌'},_0x423620={'created':'New\x20payout\x20created','completed':_0x511243(0x10f),'rejected':_0x511243(0x11c)},_0x29c3e2=_0x46ef44[_0x4dedc0],_0x3ca327=_0x423620[_0x4dedc0],_0x18ab93=_0x29c3e2+'\x20*'+_0x3ca327+'*\x0a\x0a'+(_0x511243(0x136)+_0x455bdc[_0x511243(0x1b4)]+'\x20USD*\x0a')+(_0x511243(0x18d)+_0x455bdc['method']+'`\x0a')+(_0x511243(0x175)+_0x455bdc['id']+'`\x0a')+(_0x511243(0x105)+new Date(_0x455bdc[_0x511243(0x121)])[_0x511243(0x14d)](_0x511243(0x14b))+'\x0a')+(_0x455bdc[_0x511243(0x177)]?_0x511243(0xef)+_0x455bdc[_0x511243(0x177)]+'`':'');await this['sendShopNotification'](_0x3deacd,_0x18ab93,{'parse_mode':_0x511243(0x134)});}async[a58_0x51b727(0x1c0)](_0x15b285,_0x36c2d4){const _0x426cef=a58_0x51b727;try{const _0x182299=await database_1['default'][_0x426cef(0x109)]['findUnique']({'where':{'shopId':_0x15b285},'select':{'notificationLogin':!![]}});if(!_0x182299?.[_0x426cef(0x128)]){console['log'](_0x426cef(0x159)+_0x15b285);return;}const _0x3191d9=_0x36c2d4[_0x426cef(0xe9)]?'🔐':'🚨',_0x49c018=_0x36c2d4[_0x426cef(0xe9)]?_0x426cef(0x1ad):_0x426cef(0x168);let _0x528085=_0x3191d9+'\x20*'+_0x49c018+_0x426cef(0xea)+(_0x426cef(0x148)+_0x36c2d4['username']+'`\x0a')+('📅\x20Time:\x20'+_0x36c2d4[_0x426cef(0xff)][_0x426cef(0x14d)](_0x426cef(0x14b))+'\x0a');_0x36c2d4[_0x426cef(0x14a)]&&(_0x528085+=_0x426cef(0x16b)+_0x36c2d4[_0x426cef(0x14a)]+'`\x0a');if(_0x36c2d4['userAgent']){const _0x4975a8=_0x36c2d4[_0x426cef(0x17f)][_0x426cef(0x145)]>0x32?_0x36c2d4[_0x426cef(0x17f)][_0x426cef(0x120)](0x0,0x32)+_0x426cef(0x108):_0x36c2d4[_0x426cef(0x17f)];_0x528085+=_0x426cef(0x197)+_0x4975a8+'`\x0a';}!_0x36c2d4[_0x426cef(0xe9)]&&(_0x528085+=_0x426cef(0x1aa)),await this['sendShopNotification'](_0x15b285,_0x528085,{'parse_mode':_0x426cef(0x134)}),console[_0x426cef(0xfb)](_0x426cef(0x140)+_0x15b285+':\x20'+(_0x36c2d4[_0x426cef(0xe9)]?_0x426cef(0xe9):'failed'));}catch(_0x14faa0){console[_0x426cef(0x104)](_0x426cef(0x1b2),_0x14faa0);}}async[a58_0x51b727(0x195)](_0x370da2,_0x1c55ae){const _0x24e65b=a58_0x51b727;try{const _0x1702ac=await database_1[_0x24e65b(0x170)]['shopSettings'][_0x24e65b(0x167)]({'where':{'shopId':_0x370da2},'select':{'notificationApiError':!![]}});if(!_0x1702ac?.[_0x24e65b(0x103)]){console[_0x24e65b(0xfb)](_0x24e65b(0x1a7)+_0x370da2);return;}let _0x2a55ef='🚨\x20*API\x20Error*\x0a\x0a'+(_0x24e65b(0x166)+_0x1c55ae[_0x24e65b(0x1ab)]+'\x20'+_0x1c55ae[_0x24e65b(0xee)]+'`\x0a')+(_0x24e65b(0x146)+_0x1c55ae[_0x24e65b(0xff)][_0x24e65b(0x14d)](_0x24e65b(0x14b))+'\x0a');_0x1c55ae[_0x24e65b(0x19a)]&&(_0x2a55ef+=_0x24e65b(0x153)+_0x1c55ae[_0x24e65b(0x19a)]+'`\x0a'),_0x2a55ef+=_0x24e65b(0x12a)+_0x1c55ae[_0x24e65b(0xfa)]+'`\x0a',_0x1c55ae['requestId']&&(_0x2a55ef+=_0x24e65b(0xf5)+_0x1c55ae[_0x24e65b(0x100)]+'`\x0a'),_0x2a55ef+=_0x24e65b(0x1ae),await this['sendShopNotification'](_0x370da2,_0x2a55ef,{'parse_mode':_0x24e65b(0x134)}),console[_0x24e65b(0xfb)](_0x24e65b(0x163)+_0x370da2+':\x20'+_0x1c55ae[_0x24e65b(0xee)]);}catch(_0x444111){console[_0x24e65b(0x104)]('Failed\x20to\x20send\x20API\x20error\x20notification:',_0x444111);}}async[a58_0x51b727(0x1b5)](_0x49e435,_0x493150,_0x4bb556){const _0x5c7b3d=a58_0x51b727;let _0x41f7ab=_0x5c7b3d(0xe6)+_0x493150+_0x5c7b3d(0xea);for(const [_0x3fb6df,_0x565b58]of Object[_0x5c7b3d(0x10e)](_0x4bb556)){_0x565b58!==null&&_0x565b58!==undefined&&(_0x41f7ab+=_0x3fb6df+_0x5c7b3d(0x18a)+_0x565b58+'`\x0a');}await this[_0x5c7b3d(0x16d)](_0x49e435,_0x41f7ab,{'parse_mode':_0x5c7b3d(0x134)});}['getBotInfo'](){const _0x3cd2e7=a58_0x51b727;return{'isActive':!!this[_0x3cd2e7(0x10b)],'username':this['botUsername']};}['stopBot'](){const _0xb795ff=a58_0x51b727;this[_0xb795ff(0x10b)]&&(this[_0xb795ff(0x10b)][_0xb795ff(0x155)](),this[_0xb795ff(0x10b)]=null,console[_0xb795ff(0xfb)]('🛑\x20Telegram\x20bot\x20stopped'));}}function a58_0x4480(_0x2e2d0e,_0x3c779e){const _0x550b67=a58_0x550b();return a58_0x4480=function(_0x4480c6,_0xadc0){_0x4480c6=_0x4480c6-0xe2;let _0x2f3be3=_0x550b67[_0x4480c6];return _0x2f3be3;},a58_0x4480(_0x2e2d0e,_0x3c779e);}exports[a58_0x51b727(0x1b0)]=TelegramBotService,exports[a58_0x51b727(0x12f)]=new TelegramBotService();