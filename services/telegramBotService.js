'use strict';const a54_0x24deba=a54_0x52d6;(function(_0x261f70,_0x424894){const _0x14b1c5=a54_0x52d6,_0x381f10=_0x261f70();while(!![]){try{const _0x8601c5=-parseInt(_0x14b1c5(0x1e0))/0x1+parseInt(_0x14b1c5(0x1bb))/0x2+parseInt(_0x14b1c5(0x1e9))/0x3+parseInt(_0x14b1c5(0x1b0))/0x4*(-parseInt(_0x14b1c5(0x1e1))/0x5)+-parseInt(_0x14b1c5(0x16f))/0x6*(parseInt(_0x14b1c5(0x1bd))/0x7)+-parseInt(_0x14b1c5(0x1d3))/0x8*(-parseInt(_0x14b1c5(0x231))/0x9)+-parseInt(_0x14b1c5(0x1dc))/0xa;if(_0x8601c5===_0x424894)break;else _0x381f10['push'](_0x381f10['shift']());}catch(_0x53a8e5){_0x381f10['push'](_0x381f10['shift']());}}}(a54_0x5811,0xec926));function a54_0x5811(){const _0x5a17c1=['forEach','📝\x20Order\x20ID:\x20`','notificationLogin','shopId','from','1772340EbhdSj','✅\x20Notification\x20sent\x20to\x20Telegram\x20user\x20','2803892ScUozc','stopBot','Error\x20handling\x20/debug\x20command:','📅\x20Date:\x20','currency','chat\x20not\x20found','📱\x20Telegram\x20notification:\x20gateway\x20\x22','__esModule','createdAt','Commands:\x0a','`\x20is\x20inactive.\x0a\x0a','gateway','sendPayoutNotification','warn','👤\x20Username:\x20`','🤖\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a','sendMessage','requestId','__importDefault',':\x20username=\x22','❌\x20API\x20key\x20does\x20not\x20match\x20shop\x20`','Example:\x0a','28344OZfWNY','ACTIVE','handleSingleLineVerification','•\x20Payment\x20status\x20changes\x0a','💸\x20Penalty\x20amount:\x20*','\x0a⚠️\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!','🚨\x20*API\x20Error*\x0a\x0a','split','🔍\x20*Debug\x20Information*\x0a\x0a','16127650AGJUPI','•\x20New\x20payments\x0a','Markdown','⏳\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a','164883lNBAXf','1563555mzZINE','test','getGatewayDisplayNameForTelegram','Error\x20handling\x20/disconnect\x20command:','userAgent','create','Failed\x20to\x20send\x20login\x20notification:','💸\x20Amount:\x20*','4989576DKPNoc','To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a','✅\x20Welcome\x20back!\x0a\x0a','📝\x20Notes:\x20','\x20disconnected\x20from\x20shop\x20','Error\x20handling\x20/status\x20command:','findMany','includes','🌐\x20IP\x20address:\x20`','To\x20reconnect,\x20use\x20the\x20/start\x20command','../types/gateway','*\x0a\x0a','remitterIban','❌\x20Please\x20use\x20/start\x20command\x20first','🆔\x20Payout\x20ID:\x20`','findUnique','Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.','User\x20','customerEmail','...\x22','\x20verified\x20for\x20shop\x20','polling_error','Error\x20sending\x20shop\x20notification:','toLocaleDateString','TelegramBotService','unknown\x20shop','secretKey','\x20USDT*\x0a','Telegram\x20bot\x20polling\x20error:','update','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','Use\x20/start\x20to\x20begin.','🆔\x20Payment\x20ID:\x20`','entries','`\x20not\x20found.\x0a\x0a','✅\x20Telegram\x20user\x20','❌\x20Shop\x20with\x20username\x20`','error','📅\x20Time:\x20','sk_','🏦\x20IBAN:\x20`','🏪\x20Available\x20shops\x20in\x20system:\x0a','.\x20*','isVerified','trim','pk_','\x0aCheck\x20spelling\x20and\x20try\x20again.','last_name','Failed\x20login\x20attempt','Username:\x20`','stopPolling','🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20','Contact\x20administrator.','log','...','•\x20Payouts\x0a\x0a','failed','shop','node-telegram-bot-api','🔌\x20User\x20','`.\x0a\x0a','❌\x20Failed\x20to\x20initialize\x20Telegram\x20bot:','message','📱\x20Created\x20new\x20Telegram\x20user:\x20','🌐\x20IP:\x20`','statusCode','botUsername','sendApiErrorNotification','map','\x22,\x20apiKey=\x22','customerName','❌\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a','2313HOeUaM','✅\x20Telegram\x20bot\x20@','shopSettings','No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20','🏦\x20Method:\x20`','name','`\x0a\x0a','startsWith','Telegram\x20bot\x20error:','onText','✅\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*','🔔\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a','initializeBot','📱\x20Login\x20notifications\x20disabled\x20for\x20shop\x20','•\x20Important\x20events\x0a\x0a','\x20\x20\x20Status:\x20','Payment\x20expired','🔗\x20TXID:\x20`','/status\x20-\x20check\x20connection\x20status\x0a','getBotInfo','adminNotes','❌\x20Invalid\x20API\x20key\x20format.\x0a\x0a','sendCustomNotification','Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).','🔔\x20*','`\x20(','Successful\x20login','toString','❌\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.','publicKey','customerIp','Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification','Payment\x20refund','length','📱\x20Shop:\x20*','🏪\x20Gateway:\x20`','📊\x20Error\x20code:\x20`','method','Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`','🛑\x20Telegram\x20bot\x20stopped','bot','📧\x20Email:\x20`','6SCPger','🔔\x20You\x20receive\x20notifications\x20about:\x0a','chat','first_name','env','txid','New\x20payout\x20created','telegramUser','default','❌\x20Error\x20getting\x20debug\x20information.','success','username','📱\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20','setupBotHandlers','❌\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a','...`\x0a\x0a','New\x20payment\x20created','Payment\x20successfully\x20paid','chargebackAmount','•\x20Payouts\x0a','✅\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a','📝\x20Format:\x20`username\x20api_key`\x0a\x0a','•\x20`','status','join','✅\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*','defineProperty','sendShopNotification','Payment\x20failed','🆔\x20Request\x20ID:\x20`','❌\x20Invalid\x20username\x20format:\x20`','telegramId','toLocaleString','Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.','botToken','telegramBotService','substring','*.\x0a\x0a',':\x20`','Error\x20in\x20handleSingleLineVerification:','en-US','../config/database','\x20USD*\x0a','💰\x20Amount:\x20*','chargeback','Payment\x20chargeback','TELEGRAM_BOT_TOKEN','🔄\x20Reset\x20incomplete\x20verification\x20for\x20user\x20','timestamp','text','🔗\x20Endpoint:\x20`','customerUa','\x22\x20->\x20display\x20\x22','❌\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20','❌\x20Error:\x20`','endpoint','❗️\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!','Error\x20handling\x20message:','\x0a💡\x20Check\x20your\x20request\x20or\x20contact\x20support.','✅\x20Connected\x20to\x20shop:\x20*','✅\x20Login\x20notification\x20sent\x20for\x20shop\x20','\x20\x20\x20Public\x20Key:\x20`','/disconnect\x20-\x20disconnect\x20from\x20notifications','❌\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`','\x20parts:\x20','4VNwPKM','orderId','❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','❌\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a','user\x20is\x20deactivated','TELEGRAM_BOT_USERNAME'];a54_0x5811=function(){return _0x5a17c1;};return a54_0x5811();}var __importDefault=this&&this[a54_0x24deba(0x1cf)]||function(_0x456287){const _0x3734c6=a54_0x24deba;return _0x456287&&_0x456287[_0x3734c6(0x1c4)]?_0x456287:{'default':_0x456287};};Object[a54_0x24deba(0x189)](exports,a54_0x24deba(0x1c4),{'value':!![]}),exports[a54_0x24deba(0x192)]=exports[a54_0x24deba(0x201)]=void 0x0;const node_telegram_bot_api_1=__importDefault(require(a54_0x24deba(0x223))),database_1=__importDefault(require(a54_0x24deba(0x198))),gateway_1=require(a54_0x24deba(0x1f3));function a54_0x52d6(_0x23e19b,_0x5c7ec7){const _0x581165=a54_0x5811();return a54_0x52d6=function(_0x52d6f9,_0x1b9e7c){_0x52d6f9=_0x52d6f9-0x14e;let _0x43dcc8=_0x581165[_0x52d6f9];return _0x43dcc8;},a54_0x52d6(_0x23e19b,_0x5c7ec7);}class TelegramBotService{constructor(){const _0x108e7e=a54_0x24deba;this[_0x108e7e(0x16d)]=null,this[_0x108e7e(0x191)]=process[_0x108e7e(0x173)][_0x108e7e(0x19d)]||'',this[_0x108e7e(0x22b)]=process['env'][_0x108e7e(0x1b5)]||'trapay_bot',this[_0x108e7e(0x191)]?this[_0x108e7e(0x151)]():console[_0x108e7e(0x1ca)]('TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables');}[a54_0x24deba(0x151)](){const _0x56d70c=a54_0x24deba;try{this[_0x56d70c(0x16d)]=new node_telegram_bot_api_1[(_0x56d70c(0x177))](this[_0x56d70c(0x191)],{'polling':!![]}),this[_0x56d70c(0x17c)](),console[_0x56d70c(0x21e)](_0x56d70c(0x232)+this[_0x56d70c(0x22b)]+'\x20initialized\x20successfully');}catch(_0x508405){console['error'](_0x56d70c(0x226),_0x508405);}}['setupBotHandlers'](){const _0xe3db28=a54_0x24deba;if(!this[_0xe3db28(0x16d)])return;this['bot'][_0xe3db28(0x14e)](/\/start/,async _0x3afce7=>{const _0x380297=_0xe3db28,_0x37112b=_0x3afce7[_0x380297(0x171)]['id'],_0x44e844=_0x3afce7[_0x380297(0x1ba)]?.['id']['toString'](),_0x4a6eeb=_0x3afce7[_0x380297(0x1ba)]?.[_0x380297(0x17a)],_0x53cd1c=_0x3afce7[_0x380297(0x1ba)]?.[_0x380297(0x172)],_0x2d295a=_0x3afce7[_0x380297(0x1ba)]?.[_0x380297(0x218)];if(!_0x44e844)return;try{let _0x2c3d04=await database_1[_0x380297(0x177)][_0x380297(0x176)][_0x380297(0x1f8)]({'where':{'telegramId':_0x44e844},'include':{'shop':!![]}});!_0x2c3d04?(_0x2c3d04=await database_1[_0x380297(0x177)][_0x380297(0x176)][_0x380297(0x1e6)]({'data':{'telegramId':_0x44e844,'username':_0x4a6eeb,'firstName':_0x53cd1c,'lastName':_0x2d295a,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console['log'](_0x380297(0x228)+_0x44e844+'\x20(@'+_0x4a6eeb+')')):_0x2c3d04=await database_1[_0x380297(0x177)][_0x380297(0x176)][_0x380297(0x206)]({'where':{'telegramId':_0x44e844},'data':{'username':_0x4a6eeb,'firstName':_0x53cd1c,'lastName':_0x2d295a},'include':{'shop':!![]}}),_0x2c3d04[_0x380297(0x214)]&&_0x2c3d04[_0x380297(0x1b9)]&&_0x2c3d04[_0x380297(0x222)]?await this[_0x380297(0x16d)]?.[_0x380297(0x1cd)](_0x37112b,_0x380297(0x1eb)+('You\x20are\x20already\x20connected\x20to\x20shop:\x20*'+_0x2c3d04[_0x380297(0x222)]['name']+'*\x0a')+(_0x380297(0x21a)+_0x2c3d04['shop'][_0x380297(0x17a)]+'`\x0a\x0a')+_0x380297(0x170)+_0x380297(0x1dd)+'•\x20Payment\x20status\x20changes\x0a'+_0x380297(0x220)+_0x380297(0x1c6)+_0x380297(0x157)+_0x380297(0x1ad),{'parse_mode':_0x380297(0x1de)}):(_0x2c3d04[_0x380297(0x1b9)]&&!_0x2c3d04['isVerified']&&(await database_1[_0x380297(0x177)]['telegramUser']['update']({'where':{'telegramId':_0x44e844},'data':{'shopId':null,'isVerified':![]}}),console[_0x380297(0x21e)](_0x380297(0x19e)+_0x44e844)),await this[_0x380297(0x16d)]?.['sendMessage'](_0x37112b,_0x380297(0x1cc)+_0x380297(0x1ea)+'📝\x20Format:\x20`username\x20api_key`\x0a\x0a'+_0x380297(0x1d2)+_0x380297(0x207)+_0x380297(0x1a7),{'parse_mode':'Markdown'}));}catch(_0x13a75d){console[_0x380297(0x20e)]('Error\x20handling\x20/start\x20command:',_0x13a75d),await this[_0x380297(0x16d)]?.[_0x380297(0x1cd)](_0x37112b,_0x380297(0x1b2));}}),this[_0xe3db28(0x16d)][_0xe3db28(0x14e)](/\/disconnect/,async _0x49e0bd=>{const _0x5525a9=_0xe3db28,_0x23e4a9=_0x49e0bd[_0x5525a9(0x171)]['id'],_0x3bb0c2=_0x49e0bd['from']?.['id'][_0x5525a9(0x160)]();if(!_0x3bb0c2)return;try{const _0x4cdc46=await database_1[_0x5525a9(0x177)][_0x5525a9(0x176)]['findUnique']({'where':{'telegramId':_0x3bb0c2},'include':{'shop':!![]}});if(!_0x4cdc46||!_0x4cdc46[_0x5525a9(0x214)]||!_0x4cdc46['shopId']){await this['bot']?.['sendMessage'](_0x23e4a9,_0x5525a9(0x161));return;}const _0x35ea3c=_0x4cdc46[_0x5525a9(0x222)]?.[_0x5525a9(0x236)]||_0x5525a9(0x202);await database_1[_0x5525a9(0x177)][_0x5525a9(0x176)][_0x5525a9(0x206)]({'where':{'telegramId':_0x3bb0c2},'data':{'shopId':null,'isVerified':![]}}),console[_0x5525a9(0x21e)](_0x5525a9(0x224)+_0x3bb0c2+_0x5525a9(0x1ed)+_0x4cdc46['shopId']),await this[_0x5525a9(0x16d)]?.['sendMessage'](_0x23e4a9,_0x5525a9(0x188)+_0x35ea3c+_0x5525a9(0x194)+_0x5525a9(0x1f2),{'parse_mode':_0x5525a9(0x1de)});}catch(_0x1bcb64){console[_0x5525a9(0x20e)](_0x5525a9(0x1e4),_0x1bcb64),await this[_0x5525a9(0x16d)]?.[_0x5525a9(0x1cd)](_0x23e4a9,'❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this[_0xe3db28(0x16d)][_0xe3db28(0x14e)](/\/status/,async _0x11bfb2=>{const _0x3aac76=_0xe3db28,_0x49f898=_0x11bfb2[_0x3aac76(0x171)]['id'],_0x10486d=_0x11bfb2[_0x3aac76(0x1ba)]?.['id'][_0x3aac76(0x160)]();if(!_0x10486d)return;try{const _0x527bb9=await database_1[_0x3aac76(0x177)][_0x3aac76(0x176)]['findUnique']({'where':{'telegramId':_0x10486d},'include':{'shop':!![]}});if(!_0x527bb9){await this[_0x3aac76(0x16d)]?.[_0x3aac76(0x1cd)](_0x49f898,_0x3aac76(0x1b3)+_0x3aac76(0x208));return;}if(!_0x527bb9[_0x3aac76(0x214)]||!_0x527bb9[_0x3aac76(0x1b9)]||!_0x527bb9[_0x3aac76(0x222)]){await this['bot']?.[_0x3aac76(0x1cd)](_0x49f898,_0x3aac76(0x230)+'Use\x20/start\x20to\x20connect.');return;}await this['bot']?.[_0x3aac76(0x1cd)](_0x49f898,'📊\x20*Connection\x20Status*\x0a\x0a'+(_0x3aac76(0x1aa)+_0x527bb9['shop'][_0x3aac76(0x236)]+'*\x0a')+(_0x3aac76(0x1cb)+_0x527bb9[_0x3aac76(0x222)]['username']+'`\x0a')+('📅\x20Connection\x20date:\x20'+_0x527bb9['updatedAt'][_0x3aac76(0x200)](_0x3aac76(0x197))+'\x0a\x0a')+'🔔\x20Notifications\x20are\x20active\x0a\x0a'+_0x3aac76(0x1c6)+_0x3aac76(0x1ad),{'parse_mode':_0x3aac76(0x1de)});}catch(_0x4ac526){console[_0x3aac76(0x20e)](_0x3aac76(0x1ee),_0x4ac526),await this[_0x3aac76(0x16d)]?.[_0x3aac76(0x1cd)](_0x49f898,_0x3aac76(0x1b2));}}),this[_0xe3db28(0x16d)][_0xe3db28(0x14e)](/\/debug/,async _0x353ea8=>{const _0x214cb3=_0xe3db28,_0x1b46f8=_0x353ea8[_0x214cb3(0x171)]['id'],_0x1abe64=_0x353ea8[_0x214cb3(0x1ba)]?.['id'][_0x214cb3(0x160)]();if(!_0x1abe64)return;try{const _0x27ff52=await database_1[_0x214cb3(0x177)][_0x214cb3(0x222)][_0x214cb3(0x1ef)]({'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![]},'take':0xa});let _0x25cf69=_0x214cb3(0x1db);_0x25cf69+='📱\x20Your\x20Telegram\x20ID:\x20`'+_0x1abe64+_0x214cb3(0x237),_0x25cf69+=_0x214cb3(0x212),_0x27ff52[_0x214cb3(0x1b6)]((_0x48a466,_0x44bb28)=>{const _0xd532a3=_0x214cb3;_0x25cf69+=_0x44bb28+0x1+_0xd532a3(0x213)+_0x48a466[_0xd532a3(0x236)]+'*\x0a',_0x25cf69+='\x20\x20\x20Username:\x20`'+_0x48a466[_0xd532a3(0x17a)]+'`\x0a',_0x25cf69+=_0xd532a3(0x154)+_0x48a466[_0xd532a3(0x186)]+'\x0a',_0x25cf69+=_0xd532a3(0x1ac)+_0x48a466[_0xd532a3(0x162)][_0xd532a3(0x193)](0x0,0xf)+_0xd532a3(0x17e);}),await this[_0x214cb3(0x16d)]?.[_0x214cb3(0x1cd)](_0x1b46f8,_0x25cf69,{'parse_mode':_0x214cb3(0x1de)});}catch(_0x4a7ab2){console[_0x214cb3(0x20e)](_0x214cb3(0x1bf),_0x4a7ab2),await this[_0x214cb3(0x16d)]?.[_0x214cb3(0x1cd)](_0x1b46f8,_0x214cb3(0x178));}}),this[_0xe3db28(0x16d)]['on'](_0xe3db28(0x227),async _0x4ef1b4=>{const _0x523553=_0xe3db28;if(_0x4ef1b4['text']?.[_0x523553(0x238)]('/'))return;const _0x1732d5=_0x4ef1b4[_0x523553(0x171)]['id'],_0x444cdc=_0x4ef1b4[_0x523553(0x1ba)]?.['id'][_0x523553(0x160)](),_0x495e98=_0x4ef1b4[_0x523553(0x1a0)]?.[_0x523553(0x215)]();if(!_0x444cdc||!_0x495e98)return;try{const _0x1ef7b8=await database_1[_0x523553(0x177)]['telegramUser'][_0x523553(0x1f8)]({'where':{'telegramId':_0x444cdc},'include':{'shop':!![]}});if(!_0x1ef7b8){await this[_0x523553(0x16d)]?.['sendMessage'](_0x1732d5,_0x523553(0x1f6));return;}if(_0x1ef7b8[_0x523553(0x214)]&&_0x1ef7b8[_0x523553(0x1b9)]&&_0x1ef7b8[_0x523553(0x222)]){await this[_0x523553(0x16d)]?.[_0x523553(0x1cd)](_0x1732d5,_0x523553(0x14f)+_0x1ef7b8['shop'][_0x523553(0x236)]+_0x523553(0x194)+_0x523553(0x1f9),{'parse_mode':_0x523553(0x1de)});return;}const _0x358bab=_0x495e98[_0x523553(0x1da)](/\s+/);if(_0x358bab[_0x523553(0x166)]!==0x2){await this[_0x523553(0x16d)]?.['sendMessage'](_0x1732d5,_0x523553(0x17d)+_0x523553(0x184)+'Example:\x0a'+_0x523553(0x207)+('You\x20sent\x20'+_0x358bab['length']+_0x523553(0x1af)+_0x358bab[_0x523553(0x22d)](_0x33f065=>'`'+_0x33f065+'`')[_0x523553(0x187)](',\x20')),{'parse_mode':_0x523553(0x1de)});return;}const [_0xa9f250,_0x4ff47b]=_0x358bab;console['log'](_0x523553(0x21c)+_0x444cdc+_0x523553(0x1d0)+_0xa9f250+'\x22,\x20apiKey=\x22'+_0x4ff47b['substring'](0x0,0xa)+'...\x22'),await this[_0x523553(0x1d5)](_0x1732d5,_0x444cdc,_0xa9f250,_0x4ff47b);}catch(_0x2d5723){console[_0x523553(0x20e)](_0x523553(0x1a8),_0x2d5723),await this['bot']?.[_0x523553(0x1cd)](_0x1732d5,_0x523553(0x1b2));}}),this[_0xe3db28(0x16d)]['on'](_0xe3db28(0x20e),_0x406a95=>{const _0x5a8fc4=_0xe3db28;console['error'](_0x5a8fc4(0x239),_0x406a95);}),this['bot']['on'](_0xe3db28(0x1fe),_0x10b6ed=>{const _0x11ade8=_0xe3db28;console[_0x11ade8(0x20e)](_0x11ade8(0x205),_0x10b6ed);});}async[a54_0x24deba(0x1d5)](_0x4945ca,_0x2827ed,_0x576ed0,_0x16e17f){const _0x5f2a75=a54_0x24deba;try{console[_0x5f2a75(0x21e)](_0x5f2a75(0x21c)+_0x2827ed+_0x5f2a75(0x1d0)+_0x576ed0+_0x5f2a75(0x22e)+_0x16e17f['substring'](0x0,0xa)+_0x5f2a75(0x1fc));if(!_0x576ed0||_0x576ed0[_0x5f2a75(0x166)]<0x3||_0x576ed0['length']>0x32||!/^[a-zA-Z0-9_]+$/[_0x5f2a75(0x1e2)](_0x576ed0)){await this[_0x5f2a75(0x16d)]?.[_0x5f2a75(0x1cd)](_0x4945ca,_0x5f2a75(0x18d)+_0x576ed0+'`\x0a\x0a'+_0x5f2a75(0x15c),{'parse_mode':_0x5f2a75(0x1de)});return;}if(!_0x16e17f||!_0x16e17f[_0x5f2a75(0x238)](_0x5f2a75(0x216))&&!_0x16e17f['startsWith'](_0x5f2a75(0x210))){await this['bot']?.[_0x5f2a75(0x1cd)](_0x4945ca,_0x5f2a75(0x15a)+'API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.',{'parse_mode':'Markdown'});return;}const _0x2560f2=await database_1[_0x5f2a75(0x177)][_0x5f2a75(0x222)][_0x5f2a75(0x1f8)]({'where':{'username':_0x576ed0},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x2560f2){const _0x324379=await database_1[_0x5f2a75(0x177)][_0x5f2a75(0x222)][_0x5f2a75(0x1ef)]({'select':{'username':!![],'name':!![]},'take':0x5});let _0x35ef0c=_0x5f2a75(0x20d)+_0x576ed0+_0x5f2a75(0x20b);_0x324379[_0x5f2a75(0x166)]>0x0?(_0x35ef0c+='Available\x20usernames:\x0a',_0x324379[_0x5f2a75(0x1b6)](_0x3aa409=>{const _0x5a4d82=_0x5f2a75;_0x35ef0c+=_0x5a4d82(0x185)+_0x3aa409[_0x5a4d82(0x17a)]+_0x5a4d82(0x15e)+_0x3aa409['name']+')\x0a';}),_0x35ef0c+=_0x5f2a75(0x217)):_0x35ef0c+='Check\x20spelling\x20and\x20try\x20again.';await this[_0x5f2a75(0x16d)]?.['sendMessage'](_0x4945ca,_0x35ef0c,{'parse_mode':'Markdown'});return;}if(_0x2560f2[_0x5f2a75(0x186)]!==_0x5f2a75(0x1d4)){await this[_0x5f2a75(0x16d)]?.[_0x5f2a75(0x1cd)](_0x4945ca,'❌\x20Shop\x20`'+_0x576ed0+_0x5f2a75(0x1c7)+_0x5f2a75(0x21d),{'parse_mode':'Markdown'});return;}if(_0x2560f2[_0x5f2a75(0x162)]!==_0x16e17f&&_0x2560f2[_0x5f2a75(0x203)]!==_0x16e17f){await this[_0x5f2a75(0x16d)]?.[_0x5f2a75(0x1cd)](_0x4945ca,_0x5f2a75(0x1d1)+_0x576ed0+_0x5f2a75(0x225)+'Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a'+_0x5f2a75(0x16b),{'parse_mode':'Markdown'});return;}const _0x24cc52=await database_1[_0x5f2a75(0x177)][_0x5f2a75(0x176)]['findFirst']({'where':{'shopId':_0x2560f2['id'],'isVerified':!![],'telegramId':{'not':_0x2827ed}}});if(_0x24cc52){await this[_0x5f2a75(0x16d)]?.['sendMessage'](_0x4945ca,_0x5f2a75(0x1ae)+_0x576ed0+'`.\x0a\x0a'+_0x5f2a75(0x190),{'parse_mode':_0x5f2a75(0x1de)});return;}await database_1[_0x5f2a75(0x177)]['telegramUser'][_0x5f2a75(0x206)]({'where':{'telegramId':_0x2827ed},'data':{'shopId':_0x2560f2['id'],'isVerified':!![]}}),await this['bot']?.[_0x5f2a75(0x1cd)](_0x4945ca,'🎉\x20*Congratulations!*\x0a\x0a'+_0x5f2a75(0x183)+(_0x5f2a75(0x167)+_0x2560f2[_0x5f2a75(0x236)]+'*\x0a')+(_0x5f2a75(0x1cb)+_0x2560f2[_0x5f2a75(0x17a)]+'`\x0a\x0a')+_0x5f2a75(0x150)+'•\x20New\x20payments\x0a'+_0x5f2a75(0x1d6)+_0x5f2a75(0x182)+_0x5f2a75(0x153)+_0x5f2a75(0x1c6)+_0x5f2a75(0x157)+_0x5f2a75(0x1ad),{'parse_mode':'Markdown'}),console[_0x5f2a75(0x21e)](_0x5f2a75(0x20c)+_0x2827ed+_0x5f2a75(0x1fd)+_0x2560f2[_0x5f2a75(0x17a)]+'\x20via\x20single-line\x20input');}catch(_0x512b85){console[_0x5f2a75(0x20e)](_0x5f2a75(0x196),_0x512b85),await this['bot']?.['sendMessage'](_0x4945ca,'❌\x20An\x20error\x20occurred\x20while\x20verifying\x20data.');}}async['sendShopNotification'](_0x15d4bf,_0x4e076e,_0xb2d7a9){const _0x1bdc1d=a54_0x24deba;if(!this[_0x1bdc1d(0x16d)]){console['warn'](_0x1bdc1d(0x164));return;}try{const _0x3acf5c=await database_1[_0x1bdc1d(0x177)][_0x1bdc1d(0x176)][_0x1bdc1d(0x1ef)]({'where':{'shopId':_0x15d4bf,'isVerified':!![]}});if(_0x3acf5c['length']===0x0){console[_0x1bdc1d(0x21e)](_0x1bdc1d(0x234)+_0x15d4bf);return;}const _0x473527=_0x3acf5c[_0x1bdc1d(0x22d)](async _0x3a234e=>{const _0x15580e=_0x1bdc1d;try{await this[_0x15580e(0x16d)]?.[_0x15580e(0x1cd)](_0x3a234e[_0x15580e(0x18e)],_0x4e076e,_0xb2d7a9),console[_0x15580e(0x21e)](_0x15580e(0x1bc)+_0x3a234e['telegramId']);}catch(_0x432806){console['error'](_0x15580e(0x1a4)+_0x3a234e[_0x15580e(0x18e)]+':',_0x432806),_0x432806 instanceof Error&&(_0x432806[_0x15580e(0x227)]['includes']('blocked')||_0x432806[_0x15580e(0x227)][_0x15580e(0x1f0)](_0x15580e(0x1c2))||_0x432806[_0x15580e(0x227)]['includes'](_0x15580e(0x1b4)))&&(await database_1['default'][_0x15580e(0x176)][_0x15580e(0x206)]({'where':{'id':_0x3a234e['id']},'data':{'isVerified':![]}}),console[_0x15580e(0x21e)](_0x15580e(0x1fa)+_0x3a234e['telegramId']+'\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure'));}});await Promise['allSettled'](_0x473527);}catch(_0x49ba2f){console['error'](_0x1bdc1d(0x1ff),_0x49ba2f);}}async['sendPaymentNotification'](_0x1fdf79,_0x1c1e43,_0xd3c696){const _0x3d3fcd=a54_0x24deba,_0x46f4b3={'created':'🆕','paid':'✅','failed':'❌','expired':'⏰','refund':'🔄','chargeback':'⚠️','processing':'⚙️'},_0x181b28={'created':_0x3d3fcd(0x17f),'paid':_0x3d3fcd(0x180),'failed':_0x3d3fcd(0x18b),'expired':_0x3d3fcd(0x155),'refund':_0x3d3fcd(0x165),'chargeback':_0x3d3fcd(0x19c),'processing':'Payment\x20is\x20being\x20processed'},_0x2437e6=_0x46f4b3[_0xd3c696],_0x5199e1=_0x181b28[_0xd3c696],_0x4ddc15=(0x0,gateway_1[_0x3d3fcd(0x1e3)])(_0x1c1e43[_0x3d3fcd(0x1c8)]);console[_0x3d3fcd(0x21e)](_0x3d3fcd(0x1c3)+_0x1c1e43['gateway']+_0x3d3fcd(0x1a3)+_0x4ddc15+'\x22');let _0x14e026=_0x2437e6+'\x20*'+_0x5199e1+_0x3d3fcd(0x1f4)+(_0x3d3fcd(0x19a)+_0x1c1e43['amount']+'\x20'+_0x1c1e43[_0x3d3fcd(0x1c1)]+'*\x0a')+(_0x3d3fcd(0x1b7)+(_0x1c1e43[_0x3d3fcd(0x1b1)]||_0x1c1e43['id'])+'`\x0a')+(_0x3d3fcd(0x209)+_0x1c1e43['id']+'`\x0a')+(_0x3d3fcd(0x168)+_0x4ddc15+'`\x0a')+(_0x3d3fcd(0x1c0)+new Date(_0x1c1e43['createdAt'])['toLocaleString'](_0x3d3fcd(0x197))+'\x0a');if(_0x1c1e43[_0x3d3fcd(0x22f)]||_0x1c1e43[_0x3d3fcd(0x1fb)]||_0x1c1e43['remitterIban']||_0x1c1e43[_0x3d3fcd(0x163)]||_0x1c1e43['customerUa']){_0x14e026+='\x0a👤\x20*Customer\x20Information:*\x0a';_0x1c1e43[_0x3d3fcd(0x22f)]&&(_0x14e026+='📛\x20Name:\x20`'+_0x1c1e43['customerName']+'`\x0a');_0x1c1e43[_0x3d3fcd(0x1fb)]&&(_0x14e026+=_0x3d3fcd(0x16e)+_0x1c1e43[_0x3d3fcd(0x1fb)]+'`\x0a');_0x1c1e43[_0x3d3fcd(0x1f5)]&&(_0x14e026+=_0x3d3fcd(0x211)+_0x1c1e43['remitterIban']+'`\x0a');_0x1c1e43['customerIp']&&(_0x14e026+=_0x3d3fcd(0x229)+_0x1c1e43['customerIp']+'`\x0a');if(_0x1c1e43[_0x3d3fcd(0x1a2)]){const _0xcf7fdd=_0x1c1e43[_0x3d3fcd(0x1a2)][_0x3d3fcd(0x166)]>0x32?_0x1c1e43['customerUa'][_0x3d3fcd(0x193)](0x0,0x32)+_0x3d3fcd(0x21f):_0x1c1e43[_0x3d3fcd(0x1a2)];_0x14e026+='💻\x20Browser:\x20`'+_0xcf7fdd+'`\x0a';}}_0xd3c696===_0x3d3fcd(0x19b)&&_0x1c1e43[_0x3d3fcd(0x181)]&&(_0x14e026+=_0x3d3fcd(0x1d7)+_0x1c1e43['chargebackAmount']+_0x3d3fcd(0x204)),_0xd3c696==='processing'&&(_0x14e026+=_0x3d3fcd(0x1df)),_0x1c1e43['adminNotes']&&(_0x14e026+=_0x3d3fcd(0x1ec)+_0x1c1e43[_0x3d3fcd(0x159)]+'\x0a'),await this[_0x3d3fcd(0x18a)](_0x1fdf79,_0x14e026,{'parse_mode':_0x3d3fcd(0x1de)});}async[a54_0x24deba(0x1c9)](_0x363c13,_0x12e474,_0x140c8b){const _0x2899b4=a54_0x24deba,_0x59266c={'created':'📤','completed':'✅','rejected':'❌'},_0x3aae1a={'created':_0x2899b4(0x175),'completed':'Payout\x20completed','rejected':'Payout\x20rejected'},_0x18284e=_0x59266c[_0x140c8b],_0x3c17e7=_0x3aae1a[_0x140c8b],_0x4bef82=_0x18284e+'\x20*'+_0x3c17e7+_0x2899b4(0x1f4)+(_0x2899b4(0x1e8)+_0x12e474['amount']+_0x2899b4(0x199))+(_0x2899b4(0x235)+_0x12e474['method']+'`\x0a')+(_0x2899b4(0x1f7)+_0x12e474['id']+'`\x0a')+(_0x2899b4(0x1c0)+new Date(_0x12e474[_0x2899b4(0x1c5)])[_0x2899b4(0x18f)](_0x2899b4(0x197))+'\x0a')+(_0x12e474[_0x2899b4(0x174)]?_0x2899b4(0x156)+_0x12e474[_0x2899b4(0x174)]+'`':'');await this[_0x2899b4(0x18a)](_0x363c13,_0x4bef82,{'parse_mode':'Markdown'});}async['sendLoginNotification'](_0x52d9d7,_0x24611f){const _0x43f494=a54_0x24deba;try{const _0x310e01=await database_1[_0x43f494(0x177)][_0x43f494(0x233)][_0x43f494(0x1f8)]({'where':{'shopId':_0x52d9d7},'select':{'notificationLogin':!![]}});if(!_0x310e01?.[_0x43f494(0x1b8)]){console['log'](_0x43f494(0x152)+_0x52d9d7);return;}const _0x1ee201=_0x24611f['success']?'🔐':'🚨',_0x5dee95=_0x24611f['success']?_0x43f494(0x15f):_0x43f494(0x219);let _0x1f83e6=_0x1ee201+'\x20*'+_0x5dee95+'*\x0a\x0a'+(_0x43f494(0x1cb)+_0x24611f['username']+'`\x0a')+(_0x43f494(0x20f)+_0x24611f[_0x43f494(0x19f)]['toLocaleString']('en-US')+'\x0a');_0x24611f['ipAddress']&&(_0x1f83e6+=_0x43f494(0x1f1)+_0x24611f['ipAddress']+'`\x0a');if(_0x24611f[_0x43f494(0x1e5)]){const _0x13e5f5=_0x24611f['userAgent']['length']>0x32?_0x24611f['userAgent'][_0x43f494(0x193)](0x0,0x32)+_0x43f494(0x21f):_0x24611f[_0x43f494(0x1e5)];_0x1f83e6+='💻\x20Browser:\x20`'+_0x13e5f5+'`\x0a';}!_0x24611f[_0x43f494(0x179)]&&(_0x1f83e6+=_0x43f494(0x1d8)),await this[_0x43f494(0x18a)](_0x52d9d7,_0x1f83e6,{'parse_mode':_0x43f494(0x1de)}),console[_0x43f494(0x21e)](_0x43f494(0x1ab)+_0x52d9d7+':\x20'+(_0x24611f['success']?'success':_0x43f494(0x221)));}catch(_0x308ba3){console[_0x43f494(0x20e)](_0x43f494(0x1e7),_0x308ba3);}}async[a54_0x24deba(0x22c)](_0x19f5eb,_0x268866){const _0x179b17=a54_0x24deba;try{const _0x279e5d=await database_1['default'][_0x179b17(0x233)][_0x179b17(0x1f8)]({'where':{'shopId':_0x19f5eb},'select':{'notificationApiError':!![]}});if(!_0x279e5d?.['notificationApiError']){console['log'](_0x179b17(0x17b)+_0x19f5eb);return;}let _0x31b74b=_0x179b17(0x1d9)+(_0x179b17(0x1a1)+_0x268866[_0x179b17(0x16a)]+'\x20'+_0x268866[_0x179b17(0x1a6)]+'`\x0a')+('📅\x20Time:\x20'+_0x268866[_0x179b17(0x19f)][_0x179b17(0x18f)](_0x179b17(0x197))+'\x0a');_0x268866[_0x179b17(0x22a)]&&(_0x31b74b+=_0x179b17(0x169)+_0x268866['statusCode']+'`\x0a'),_0x31b74b+=_0x179b17(0x1a5)+_0x268866['errorMessage']+'`\x0a',_0x268866[_0x179b17(0x1ce)]&&(_0x31b74b+=_0x179b17(0x18c)+_0x268866['requestId']+'`\x0a'),_0x31b74b+=_0x179b17(0x1a9),await this[_0x179b17(0x18a)](_0x19f5eb,_0x31b74b,{'parse_mode':'Markdown'}),console['log']('✅\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20'+_0x19f5eb+':\x20'+_0x268866['endpoint']);}catch(_0x86f7df){console[_0x179b17(0x20e)]('Failed\x20to\x20send\x20API\x20error\x20notification:',_0x86f7df);}}async[a54_0x24deba(0x15b)](_0x473e05,_0x5c5448,_0x1d2bc2){const _0x528a08=a54_0x24deba;let _0x549e4b=_0x528a08(0x15d)+_0x5c5448+_0x528a08(0x1f4);for(const [_0x3c0fd2,_0xaaf25b]of Object[_0x528a08(0x20a)](_0x1d2bc2)){_0xaaf25b!==null&&_0xaaf25b!==undefined&&(_0x549e4b+=_0x3c0fd2+_0x528a08(0x195)+_0xaaf25b+'`\x0a');}await this[_0x528a08(0x18a)](_0x473e05,_0x549e4b,{'parse_mode':'Markdown'});}[a54_0x24deba(0x158)](){const _0x533d4e=a54_0x24deba;return{'isActive':!!this[_0x533d4e(0x16d)],'username':this[_0x533d4e(0x22b)]};}[a54_0x24deba(0x1be)](){const _0x177212=a54_0x24deba;this['bot']&&(this[_0x177212(0x16d)][_0x177212(0x21b)](),this[_0x177212(0x16d)]=null,console[_0x177212(0x21e)](_0x177212(0x16c)));}}exports['TelegramBotService']=TelegramBotService,exports[a54_0x24deba(0x192)]=new TelegramBotService();