'use strict';function a59_0x3ae5(){const _0x49a4c2=['❌\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a','polling_error','📝\x20Notes:\x20','error','entries','✅\x20Welcome\x20back!\x0a\x0a','findUnique','Payment\x20expired','268140ZTkKtB','defineProperty','Error\x20handling\x20/status\x20command:','user\x20is\x20deactivated','__importDefault','Commands:\x0a','...','TELEGRAM_BOT_USERNAME','processing','💻\x20Browser:\x20`','Markdown','💸\x20Amount:\x20*','timestamp','success','toLocaleString','status','🆔\x20Request\x20ID:\x20`','🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20','🔔\x20You\x20receive\x20notifications\x20about:\x0a','❗️\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!','sendShopNotification','../types/gateway','telegramId','`\x20is\x20inactive.\x0a\x0a','requestId','📅\x20Date:\x20','env','31oNAMdk','toLocaleDateString','2480huDCQk','join','•\x20Payouts\x0a','Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.','shopId','userAgent','Successful\x20login','customerIp','•\x20Payment\x20status\x20changes\x0a','log','Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a','📅\x20Connection\x20date:\x20','Failed\x20login\x20attempt','5442850auxBln','toString','default','🔄\x20Reset\x20incomplete\x20verification\x20for\x20user\x20','🌐\x20IP\x20address:\x20`','294VZQHIk','name','Payout\x20completed','✅\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20','Failed\x20to\x20send\x20login\x20notification:','`\x20not\x20found.\x0a\x0a','\x22\x20->\x20display\x20\x22','❌\x20Failed\x20to\x20initialize\x20Telegram\x20bot:','sendLoginNotification','You\x20are\x20already\x20connected\x20to\x20shop:\x20*','sendMessage','🔔\x20Notifications\x20are\x20active\x0a\x0a','New\x20payout\x20created','txid','map','✅\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*','🔌\x20User\x20','\x0aCheck\x20spelling\x20and\x20try\x20again.','`\x0a\x0a','*\x0a\x0a','🔔\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a','chargeback','❌\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a','💸\x20Penalty\x20amount:\x20*','ipAddress','📅\x20Time:\x20','statusCode','onText','\x20\x20\x20Public\x20Key:\x20`','shopSettings','chargebackAmount','🛑\x20Telegram\x20bot\x20stopped','📱\x20Created\x20new\x20Telegram\x20user:\x20','🆔\x20Payout\x20ID:\x20`','🚨\x20*API\x20Error*\x0a\x0a','📱\x20Shop:\x20*','isVerified','last_name','customerEmail','Telegram\x20bot\x20polling\x20error:','\x20parts:\x20','../config/database','remitterIban','No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20',':\x20username=\x22','notificationLogin','shop','sk_','📱\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20','gateway','/disconnect\x20-\x20disconnect\x20from\x20notifications','ACTIVE','✅\x20Telegram\x20bot\x20@','stopBot','Available\x20usernames:\x0a','❌\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.','from','\x20USDT*\x0a','Error\x20handling\x20/debug\x20command:','Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).','setupBotHandlers','Error\x20handling\x20/disconnect\x20command:','Payment\x20is\x20being\x20processed','638952wphQFE','publicKey','TelegramBotService','User\x20','❌\x20Error:\x20`','To\x20reconnect,\x20use\x20the\x20/start\x20command','findFirst','__esModule','pk_','Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.','Error\x20in\x20handleSingleLineVerification:','Use\x20/start\x20to\x20connect.','30NRwJYn','✅\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a','✅\x20Login\x20notification\x20sent\x20for\x20shop\x20','Use\x20/start\x20to\x20begin.','text','\x0a👤\x20*Customer\x20Information:*\x0a','Example:\x0a','❌\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a','telegramUser','customerUa','`.\x0a\x0a','❌\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20','forEach','🏦\x20IBAN:\x20`','trapay_bot','message','TELEGRAM_BOT_TOKEN','startsWith','Payment\x20failed','update','blocked','Telegram\x20bot\x20error:','API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','\x22,\x20apiKey=\x22','📱\x20Your\x20Telegram\x20ID:\x20`','includes','unknown\x20shop','/status\x20-\x20check\x20connection\x20status\x0a','New\x20payment\x20created','chat','🔗\x20Endpoint:\x20`','\x20verified\x20for\x20shop\x20','botUsername','15842ImqTtY','warn','*.\x0a\x0a','✅\x20Notification\x20sent\x20to\x20Telegram\x20user\x20','create','🎉\x20*Congratulations!*\x0a\x0a','❌\x20Invalid\x20username\x20format:\x20`','test','failed','🌐\x20IP:\x20`','•\x20`','length','❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','handleSingleLineVerification','📝\x20Format:\x20`username\x20api_key`\x0a\x0a','...\x22','🆔\x20Payment\x20ID:\x20`','customerName','chat\x20not\x20found','•\x20New\x20payments\x0a','👤\x20Username:\x20`','1520112qPWXXj','findMany','initializeBot','Username:\x20`','Payment\x20refund','\x20\x20\x20Username:\x20`','📝\x20Order\x20ID:\x20`','botToken','first_name','❌\x20Invalid\x20API\x20key\x20format.\x0a\x0a','substring','✅\x20Connected\x20to\x20shop:\x20*','\x20initialized\x20successfully','createdAt','✅\x20Telegram\x20user\x20','💰\x20Amount:\x20*','❌\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`','en-US','amount','.\x20*','❌\x20An\x20error\x20occurred\x20while\x20verifying\x20data.','endpoint','getBotInfo','Contact\x20administrator.','notificationApiError','orderId','updatedAt','bot','🔍\x20*Debug\x20Information*\x0a\x0a','✅\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*','Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification','adminNotes','📱\x20Telegram\x20notification:\x20gateway\x20\x22','\x0a💡\x20Check\x20your\x20request\x20or\x20contact\x20support.','Payment\x20successfully\x20paid','•\x20Payouts\x0a\x0a','\x20USD*\x0a','method','Error\x20handling\x20message:','Payout\x20rejected','📧\x20Email:\x20`','🏪\x20Available\x20shops\x20in\x20system:\x0a','🔔\x20*','stopPolling','`\x20(','split',':\x20`','sendCustomNotification','trim','295353KaSstJ','telegramBotService','sendPayoutNotification','username'];a59_0x3ae5=function(){return _0x49a4c2;};return a59_0x3ae5();}const a59_0x11e826=a59_0x5dde;(function(_0x22b34c,_0x2d373f){const _0x11e766=a59_0x5dde,_0x2e374c=_0x22b34c();while(!![]){try{const _0x3a3a67=parseInt(_0x11e766(0xd9))/0x1*(parseInt(_0x11e766(0x159))/0x2)+-parseInt(_0x11e766(0x12c))/0x3+-parseInt(_0x11e766(0xbe))/0x4+-parseInt(_0x11e766(0xdb))/0x5*(-parseInt(_0x11e766(0xed))/0x6)+parseInt(_0x11e766(0xe8))/0x7+-parseInt(_0x11e766(0x16e))/0x8+-parseInt(_0x11e766(0xb2))/0x9*(parseInt(_0x11e766(0x138))/0xa);if(_0x3a3a67===_0x2d373f)break;else _0x2e374c['push'](_0x2e374c['shift']());}catch(_0x54842d){_0x2e374c['push'](_0x2e374c['shift']());}}}(a59_0x3ae5,0x74ec9));function a59_0x5dde(_0x3df08b,_0xcf2dda){const _0x3ae5a6=a59_0x3ae5();return a59_0x5dde=function(_0x5dde80,_0x5c84d8){_0x5dde80=_0x5dde80-0xa8;let _0x400c6c=_0x3ae5a6[_0x5dde80];return _0x400c6c;},a59_0x5dde(_0x3df08b,_0xcf2dda);}var __importDefault=this&&this[a59_0x11e826(0xc2)]||function(_0x392cd8){const _0x2a3994=a59_0x11e826;return _0x392cd8&&_0x392cd8[_0x2a3994(0x133)]?_0x392cd8:{'default':_0x392cd8};};Object[a59_0x11e826(0xbf)](exports,a59_0x11e826(0x133),{'value':!![]}),exports[a59_0x11e826(0xb3)]=exports[a59_0x11e826(0x12e)]=void 0x0;const node_telegram_bot_api_1=__importDefault(require('node-telegram-bot-api')),database_1=__importDefault(require(a59_0x11e826(0x116))),gateway_1=require(a59_0x11e826(0xd3));class TelegramBotService{constructor(){const _0x534cb3=a59_0x11e826;this[_0x534cb3(0x189)]=null,this[_0x534cb3(0x175)]=process[_0x534cb3(0xd8)][_0x534cb3(0x148)]||'',this[_0x534cb3(0x158)]=process[_0x534cb3(0xd8)][_0x534cb3(0xc5)]||_0x534cb3(0x146),this['botToken']?this[_0x534cb3(0x170)]():console[_0x534cb3(0x15a)]('TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables');}[a59_0x11e826(0x170)](){const _0x276ce0=a59_0x11e826;try{this[_0x276ce0(0x189)]=new node_telegram_bot_api_1[(_0x276ce0(0xea))](this[_0x276ce0(0x175)],{'polling':!![]}),this[_0x276ce0(0x129)](),console[_0x276ce0(0xe4)](_0x276ce0(0x121)+this[_0x276ce0(0x158)]+_0x276ce0(0x17a));}catch(_0x4dd073){console['error'](_0x276ce0(0xf4),_0x4dd073);}}[a59_0x11e826(0x129)](){const _0x239e3=a59_0x11e826;if(!this['bot'])return;this[_0x239e3(0x189)][_0x239e3(0x108)](/\/start/,async _0x5782b5=>{const _0x6bb7dd=_0x239e3,_0xe985f2=_0x5782b5[_0x6bb7dd(0x155)]['id'],_0x87477d=_0x5782b5[_0x6bb7dd(0x125)]?.['id'][_0x6bb7dd(0xe9)](),_0x4176c6=_0x5782b5[_0x6bb7dd(0x125)]?.[_0x6bb7dd(0xb5)],_0x5d71b9=_0x5782b5[_0x6bb7dd(0x125)]?.[_0x6bb7dd(0x176)],_0x4d386c=_0x5782b5[_0x6bb7dd(0x125)]?.[_0x6bb7dd(0x112)];if(!_0x87477d)return;try{let _0x28b7ee=await database_1['default'][_0x6bb7dd(0x140)][_0x6bb7dd(0xbc)]({'where':{'telegramId':_0x87477d},'include':{'shop':!![]}});!_0x28b7ee?(_0x28b7ee=await database_1[_0x6bb7dd(0xea)][_0x6bb7dd(0x140)][_0x6bb7dd(0x15d)]({'data':{'telegramId':_0x87477d,'username':_0x4176c6,'firstName':_0x5d71b9,'lastName':_0x4d386c,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console[_0x6bb7dd(0xe4)](_0x6bb7dd(0x10d)+_0x87477d+'\x20(@'+_0x4176c6+')')):_0x28b7ee=await database_1[_0x6bb7dd(0xea)][_0x6bb7dd(0x140)][_0x6bb7dd(0x14b)]({'where':{'telegramId':_0x87477d},'data':{'username':_0x4176c6,'firstName':_0x5d71b9,'lastName':_0x4d386c},'include':{'shop':!![]}}),_0x28b7ee[_0x6bb7dd(0x111)]&&_0x28b7ee[_0x6bb7dd(0xdf)]&&_0x28b7ee[_0x6bb7dd(0x11b)]?await this[_0x6bb7dd(0x189)]?.[_0x6bb7dd(0xf7)](_0xe985f2,_0x6bb7dd(0xbb)+(_0x6bb7dd(0xf6)+_0x28b7ee[_0x6bb7dd(0x11b)][_0x6bb7dd(0xee)]+'*\x0a')+(_0x6bb7dd(0x171)+_0x28b7ee['shop'][_0x6bb7dd(0xb5)]+'`\x0a\x0a')+_0x6bb7dd(0xd0)+'•\x20New\x20payments\x0a'+_0x6bb7dd(0xe3)+_0x6bb7dd(0x191)+_0x6bb7dd(0xc3)+_0x6bb7dd(0x153)+_0x6bb7dd(0x11f),{'parse_mode':_0x6bb7dd(0xc8)}):(_0x28b7ee[_0x6bb7dd(0xdf)]&&!_0x28b7ee[_0x6bb7dd(0x111)]&&(await database_1[_0x6bb7dd(0xea)][_0x6bb7dd(0x140)][_0x6bb7dd(0x14b)]({'where':{'telegramId':_0x87477d},'data':{'shopId':null,'isVerified':![]}}),console[_0x6bb7dd(0xe4)](_0x6bb7dd(0xeb)+_0x87477d)),await this[_0x6bb7dd(0x189)]?.[_0x6bb7dd(0xf7)](_0xe985f2,'🤖\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a'+'To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a'+_0x6bb7dd(0x167)+_0x6bb7dd(0x13e)+'`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a'+_0x6bb7dd(0xd1),{'parse_mode':_0x6bb7dd(0xc8)}));}catch(_0x4937f8){console[_0x6bb7dd(0xb9)]('Error\x20handling\x20/start\x20command:',_0x4937f8),await this[_0x6bb7dd(0x189)]?.[_0x6bb7dd(0xf7)](_0xe985f2,'❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this['bot']['onText'](/\/disconnect/,async _0x269e95=>{const _0x15f392=_0x239e3,_0x13a5a4=_0x269e95[_0x15f392(0x155)]['id'],_0x56a62c=_0x269e95['from']?.['id'][_0x15f392(0xe9)]();if(!_0x56a62c)return;try{const _0x16eeb2=await database_1[_0x15f392(0xea)][_0x15f392(0x140)][_0x15f392(0xbc)]({'where':{'telegramId':_0x56a62c},'include':{'shop':!![]}});if(!_0x16eeb2||!_0x16eeb2['isVerified']||!_0x16eeb2['shopId']){await this[_0x15f392(0x189)]?.[_0x15f392(0xf7)](_0x13a5a4,_0x15f392(0x124));return;}const _0x55ffea=_0x16eeb2[_0x15f392(0x11b)]?.[_0x15f392(0xee)]||_0x15f392(0x152);await database_1['default'][_0x15f392(0x140)][_0x15f392(0x14b)]({'where':{'telegramId':_0x56a62c},'data':{'shopId':null,'isVerified':![]}}),console[_0x15f392(0xe4)](_0x15f392(0xfd)+_0x56a62c+'\x20disconnected\x20from\x20shop\x20'+_0x16eeb2[_0x15f392(0xdf)]),await this[_0x15f392(0x189)]?.[_0x15f392(0xf7)](_0x13a5a4,_0x15f392(0xfc)+_0x55ffea+_0x15f392(0x15b)+_0x15f392(0x131),{'parse_mode':_0x15f392(0xc8)});}catch(_0x1f353b){console[_0x15f392(0xb9)](_0x15f392(0x12a),_0x1f353b),await this[_0x15f392(0x189)]?.[_0x15f392(0xf7)](_0x13a5a4,_0x15f392(0x165));}}),this[_0x239e3(0x189)][_0x239e3(0x108)](/\/status/,async _0x132c17=>{const _0x5a6635=_0x239e3,_0x4f7b6f=_0x132c17[_0x5a6635(0x155)]['id'],_0x3fbe12=_0x132c17[_0x5a6635(0x125)]?.['id'][_0x5a6635(0xe9)]();if(!_0x3fbe12)return;try{const _0x3e23cf=await database_1[_0x5a6635(0xea)][_0x5a6635(0x140)][_0x5a6635(0xbc)]({'where':{'telegramId':_0x3fbe12},'include':{'shop':!![]}});if(!_0x3e23cf){await this['bot']?.[_0x5a6635(0xf7)](_0x4f7b6f,_0x5a6635(0x13f)+_0x5a6635(0x13b));return;}if(!_0x3e23cf['isVerified']||!_0x3e23cf[_0x5a6635(0xdf)]||!_0x3e23cf[_0x5a6635(0x11b)]){await this[_0x5a6635(0x189)]?.[_0x5a6635(0xf7)](_0x4f7b6f,_0x5a6635(0xb6)+_0x5a6635(0x137));return;}await this[_0x5a6635(0x189)]?.[_0x5a6635(0xf7)](_0x4f7b6f,'📊\x20*Connection\x20Status*\x0a\x0a'+(_0x5a6635(0x179)+_0x3e23cf[_0x5a6635(0x11b)][_0x5a6635(0xee)]+'*\x0a')+(_0x5a6635(0x16d)+_0x3e23cf[_0x5a6635(0x11b)][_0x5a6635(0xb5)]+'`\x0a')+(_0x5a6635(0xe6)+_0x3e23cf[_0x5a6635(0x188)][_0x5a6635(0xda)]('en-US')+'\x0a\x0a')+_0x5a6635(0xf8)+_0x5a6635(0xc3)+_0x5a6635(0x11f),{'parse_mode':'Markdown'});}catch(_0x1d659a){console['error'](_0x5a6635(0xc0),_0x1d659a),await this['bot']?.[_0x5a6635(0xf7)](_0x4f7b6f,_0x5a6635(0x165));}}),this['bot']['onText'](/\/debug/,async _0x215066=>{const _0x54371d=_0x239e3,_0x43a668=_0x215066[_0x54371d(0x155)]['id'],_0x574ab5=_0x215066['from']?.['id']['toString']();if(!_0x574ab5)return;try{const _0x206e08=await database_1[_0x54371d(0xea)][_0x54371d(0x11b)][_0x54371d(0x16f)]({'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![]},'take':0xa});let _0x306687=_0x54371d(0x18a);_0x306687+=_0x54371d(0x150)+_0x574ab5+_0x54371d(0xff),_0x306687+=_0x54371d(0xaa),_0x206e08[_0x54371d(0x144)]((_0x4b03fe,_0x35743a)=>{const _0x46929a=_0x54371d;_0x306687+=_0x35743a+0x1+_0x46929a(0x181)+_0x4b03fe[_0x46929a(0xee)]+'*\x0a',_0x306687+=_0x46929a(0x173)+_0x4b03fe['username']+'`\x0a',_0x306687+='\x20\x20\x20Status:\x20'+_0x4b03fe['status']+'\x0a',_0x306687+=_0x46929a(0x109)+_0x4b03fe[_0x46929a(0x12d)][_0x46929a(0x178)](0x0,0xf)+'...`\x0a\x0a';}),await this[_0x54371d(0x189)]?.[_0x54371d(0xf7)](_0x43a668,_0x306687,{'parse_mode':_0x54371d(0xc8)});}catch(_0x1c2fee){console[_0x54371d(0xb9)](_0x54371d(0x127),_0x1c2fee),await this[_0x54371d(0x189)]?.[_0x54371d(0xf7)](_0x43a668,'❌\x20Error\x20getting\x20debug\x20information.');}}),this['bot']['on'](_0x239e3(0x147),async _0x50c6cd=>{const _0x491b55=_0x239e3;if(_0x50c6cd[_0x491b55(0x13c)]?.[_0x491b55(0x149)]('/'))return;const _0x137d1b=_0x50c6cd[_0x491b55(0x155)]['id'],_0x262ccd=_0x50c6cd[_0x491b55(0x125)]?.['id'][_0x491b55(0xe9)](),_0xad80f8=_0x50c6cd[_0x491b55(0x13c)]?.[_0x491b55(0xb1)]();if(!_0x262ccd||!_0xad80f8)return;try{const _0x3311c1=await database_1[_0x491b55(0xea)][_0x491b55(0x140)][_0x491b55(0xbc)]({'where':{'telegramId':_0x262ccd},'include':{'shop':!![]}});if(!_0x3311c1){await this['bot']?.['sendMessage'](_0x137d1b,'❌\x20Please\x20use\x20/start\x20command\x20first');return;}if(_0x3311c1[_0x491b55(0x111)]&&_0x3311c1[_0x491b55(0xdf)]&&_0x3311c1[_0x491b55(0x11b)]){await this[_0x491b55(0x189)]?.[_0x491b55(0xf7)](_0x137d1b,_0x491b55(0x18b)+_0x3311c1[_0x491b55(0x11b)][_0x491b55(0xee)]+_0x491b55(0x15b)+_0x491b55(0x135),{'parse_mode':_0x491b55(0xc8)});return;}const _0x1732df=_0xad80f8[_0x491b55(0xae)](/\s+/);if(_0x1732df[_0x491b55(0x164)]!==0x2){await this[_0x491b55(0x189)]?.[_0x491b55(0xf7)](_0x137d1b,_0x491b55(0x103)+'📝\x20Format:\x20`username\x20api_key`\x0a\x0a'+_0x491b55(0x13e)+'`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a'+('You\x20sent\x20'+_0x1732df[_0x491b55(0x164)]+_0x491b55(0x115)+_0x1732df['map'](_0x2497dd=>'`'+_0x2497dd+'`')[_0x491b55(0xdc)](',\x20')),{'parse_mode':_0x491b55(0xc8)});return;}const [_0x38a489,_0x43c77b]=_0x1732df;console[_0x491b55(0xe4)](_0x491b55(0xcf)+_0x262ccd+_0x491b55(0x119)+_0x38a489+'\x22,\x20apiKey=\x22'+_0x43c77b[_0x491b55(0x178)](0x0,0xa)+'...\x22'),await this[_0x491b55(0x166)](_0x137d1b,_0x262ccd,_0x38a489,_0x43c77b);}catch(_0xbd40c2){console[_0x491b55(0xb9)](_0x491b55(0x194),_0xbd40c2),await this[_0x491b55(0x189)]?.[_0x491b55(0xf7)](_0x137d1b,'❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this[_0x239e3(0x189)]['on'](_0x239e3(0xb9),_0x3f2828=>{const _0x4a5f84=_0x239e3;console['error'](_0x4a5f84(0x14d),_0x3f2828);}),this[_0x239e3(0x189)]['on'](_0x239e3(0xb7),_0x59764f=>{const _0x183777=_0x239e3;console['error'](_0x183777(0x114),_0x59764f);});}async[a59_0x11e826(0x166)](_0x11921b,_0x2fe735,_0x3f5b41,_0x58bbcd){const _0x259faa=a59_0x11e826;try{console[_0x259faa(0xe4)]('🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20'+_0x2fe735+_0x259faa(0x119)+_0x3f5b41+_0x259faa(0x14f)+_0x58bbcd[_0x259faa(0x178)](0x0,0xa)+_0x259faa(0x168));if(!_0x3f5b41||_0x3f5b41[_0x259faa(0x164)]<0x3||_0x3f5b41[_0x259faa(0x164)]>0x32||!/^[a-zA-Z0-9_]+$/[_0x259faa(0x160)](_0x3f5b41)){await this[_0x259faa(0x189)]?.[_0x259faa(0xf7)](_0x11921b,_0x259faa(0x15f)+_0x3f5b41+'`\x0a\x0a'+_0x259faa(0x128),{'parse_mode':_0x259faa(0xc8)});return;}if(!_0x58bbcd||!_0x58bbcd[_0x259faa(0x149)](_0x259faa(0x134))&&!_0x58bbcd[_0x259faa(0x149)](_0x259faa(0x11c))){await this[_0x259faa(0x189)]?.[_0x259faa(0xf7)](_0x11921b,_0x259faa(0x177)+_0x259faa(0x14e),{'parse_mode':_0x259faa(0xc8)});return;}const _0x3be58a=await database_1[_0x259faa(0xea)][_0x259faa(0x11b)][_0x259faa(0xbc)]({'where':{'username':_0x3f5b41},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x3be58a){const _0xa59977=await database_1['default'][_0x259faa(0x11b)]['findMany']({'select':{'username':!![],'name':!![]},'take':0x5});let _0x24abdd='❌\x20Shop\x20with\x20username\x20`'+_0x3f5b41+_0x259faa(0xf2);_0xa59977['length']>0x0?(_0x24abdd+=_0x259faa(0x123),_0xa59977[_0x259faa(0x144)](_0x349a47=>{const _0x360992=_0x259faa;_0x24abdd+=_0x360992(0x163)+_0x349a47['username']+_0x360992(0xad)+_0x349a47[_0x360992(0xee)]+')\x0a';}),_0x24abdd+=_0x259faa(0xfe)):_0x24abdd+='Check\x20spelling\x20and\x20try\x20again.';await this['bot']?.[_0x259faa(0xf7)](_0x11921b,_0x24abdd,{'parse_mode':_0x259faa(0xc8)});return;}if(_0x3be58a[_0x259faa(0xcd)]!==_0x259faa(0x120)){await this[_0x259faa(0x189)]?.[_0x259faa(0xf7)](_0x11921b,'❌\x20Shop\x20`'+_0x3f5b41+_0x259faa(0xd5)+_0x259faa(0x185),{'parse_mode':_0x259faa(0xc8)});return;}if(_0x3be58a[_0x259faa(0x12d)]!==_0x58bbcd&&_0x3be58a['secretKey']!==_0x58bbcd){await this[_0x259faa(0x189)]?.['sendMessage'](_0x11921b,'❌\x20API\x20key\x20does\x20not\x20match\x20shop\x20`'+_0x3f5b41+_0x259faa(0x142)+_0x259faa(0xe5)+'Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`',{'parse_mode':_0x259faa(0xc8)});return;}const _0x192068=await database_1[_0x259faa(0xea)]['telegramUser'][_0x259faa(0x132)]({'where':{'shopId':_0x3be58a['id'],'isVerified':!![],'telegramId':{'not':_0x2fe735}}});if(_0x192068){await this[_0x259faa(0x189)]?.['sendMessage'](_0x11921b,_0x259faa(0x17e)+_0x3f5b41+_0x259faa(0x142)+_0x259faa(0xde),{'parse_mode':_0x259faa(0xc8)});return;}await database_1[_0x259faa(0xea)][_0x259faa(0x140)][_0x259faa(0x14b)]({'where':{'telegramId':_0x2fe735},'data':{'shopId':_0x3be58a['id'],'isVerified':!![]}}),await this[_0x259faa(0x189)]?.[_0x259faa(0xf7)](_0x11921b,_0x259faa(0x15e)+_0x259faa(0x139)+(_0x259faa(0x110)+_0x3be58a['name']+'*\x0a')+('👤\x20Username:\x20`'+_0x3be58a[_0x259faa(0xb5)]+'`\x0a\x0a')+_0x259faa(0x101)+_0x259faa(0x16c)+_0x259faa(0xe3)+_0x259faa(0xdd)+'•\x20Important\x20events\x0a\x0a'+'Commands:\x0a'+_0x259faa(0x153)+_0x259faa(0x11f),{'parse_mode':_0x259faa(0xc8)}),console[_0x259faa(0xe4)](_0x259faa(0x17c)+_0x2fe735+_0x259faa(0x157)+_0x3be58a[_0x259faa(0xb5)]+'\x20via\x20single-line\x20input');}catch(_0x202685){console[_0x259faa(0xb9)](_0x259faa(0x136),_0x202685),await this[_0x259faa(0x189)]?.[_0x259faa(0xf7)](_0x11921b,_0x259faa(0x182));}}async[a59_0x11e826(0xd2)](_0x5ca412,_0x1e2893,_0x1afb4f){const _0x3a5ade=a59_0x11e826;if(!this['bot']){console[_0x3a5ade(0x15a)](_0x3a5ade(0x18c));return;}try{const _0x4adfc6=await database_1['default'][_0x3a5ade(0x140)]['findMany']({'where':{'shopId':_0x5ca412,'isVerified':!![]}});if(_0x4adfc6['length']===0x0){console[_0x3a5ade(0xe4)](_0x3a5ade(0x118)+_0x5ca412);return;}const _0x4631f6=_0x4adfc6[_0x3a5ade(0xfb)](async _0x1b9982=>{const _0x2bce0d=_0x3a5ade;try{await this[_0x2bce0d(0x189)]?.[_0x2bce0d(0xf7)](_0x1b9982['telegramId'],_0x1e2893,_0x1afb4f),console[_0x2bce0d(0xe4)](_0x2bce0d(0x15c)+_0x1b9982[_0x2bce0d(0xd4)]);}catch(_0x1f165f){console['error'](_0x2bce0d(0x143)+_0x1b9982[_0x2bce0d(0xd4)]+':',_0x1f165f),_0x1f165f instanceof Error&&(_0x1f165f[_0x2bce0d(0x147)]['includes'](_0x2bce0d(0x14c))||_0x1f165f[_0x2bce0d(0x147)][_0x2bce0d(0x151)](_0x2bce0d(0x16b))||_0x1f165f[_0x2bce0d(0x147)]['includes'](_0x2bce0d(0xc1)))&&(await database_1[_0x2bce0d(0xea)][_0x2bce0d(0x140)][_0x2bce0d(0x14b)]({'where':{'id':_0x1b9982['id']},'data':{'isVerified':![]}}),console[_0x2bce0d(0xe4)](_0x2bce0d(0x12f)+_0x1b9982[_0x2bce0d(0xd4)]+'\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure'));}});await Promise['allSettled'](_0x4631f6);}catch(_0x410c7c){console[_0x3a5ade(0xb9)]('Error\x20sending\x20shop\x20notification:',_0x410c7c);}}async['sendPaymentNotification'](_0x12062a,_0x4640c4,_0x3175a0){const _0x15af26=a59_0x11e826,_0x189415={'created':'🆕','paid':'✅','failed':'❌','expired':'⏰','refund':'🔄','chargeback':'⚠️','processing':'⚙️'},_0x56312a={'created':_0x15af26(0x154),'paid':_0x15af26(0x190),'failed':_0x15af26(0x14a),'expired':_0x15af26(0xbd),'refund':_0x15af26(0x172),'chargeback':'Payment\x20chargeback','processing':_0x15af26(0x12b)},_0x58b781=_0x189415[_0x3175a0],_0x3cd6bc=_0x56312a[_0x3175a0],_0x3d53a6=(0x0,gateway_1['getGatewayDisplayNameForTelegram'])(_0x4640c4['gateway']);console[_0x15af26(0xe4)](_0x15af26(0x18e)+_0x4640c4[_0x15af26(0x11e)]+_0x15af26(0xf3)+_0x3d53a6+'\x22');let _0xb60cc1=_0x58b781+'\x20*'+_0x3cd6bc+_0x15af26(0x100)+(_0x15af26(0x17d)+_0x4640c4[_0x15af26(0x180)]+'\x20'+_0x4640c4['currency']+'*\x0a')+(_0x15af26(0x174)+(_0x4640c4[_0x15af26(0x187)]||_0x4640c4['id'])+'`\x0a')+(_0x15af26(0x169)+_0x4640c4['id']+'`\x0a')+('🏪\x20Gateway:\x20`'+_0x3d53a6+'`\x0a')+(_0x15af26(0xd7)+new Date(_0x4640c4[_0x15af26(0x17b)])['toLocaleString'](_0x15af26(0x17f))+'\x0a');if(_0x4640c4[_0x15af26(0x16a)]||_0x4640c4[_0x15af26(0x113)]||_0x4640c4[_0x15af26(0x117)]||_0x4640c4['customerIp']||_0x4640c4[_0x15af26(0x141)]){_0xb60cc1+=_0x15af26(0x13d);_0x4640c4[_0x15af26(0x16a)]&&(_0xb60cc1+='📛\x20Name:\x20`'+_0x4640c4[_0x15af26(0x16a)]+'`\x0a');_0x4640c4[_0x15af26(0x113)]&&(_0xb60cc1+=_0x15af26(0xa9)+_0x4640c4[_0x15af26(0x113)]+'`\x0a');_0x4640c4['remitterIban']&&(_0xb60cc1+=_0x15af26(0x145)+_0x4640c4[_0x15af26(0x117)]+'`\x0a');_0x4640c4[_0x15af26(0xe2)]&&(_0xb60cc1+=_0x15af26(0x162)+_0x4640c4[_0x15af26(0xe2)]+'`\x0a');if(_0x4640c4[_0x15af26(0x141)]){const _0x4d2392=_0x4640c4[_0x15af26(0x141)][_0x15af26(0x164)]>0x32?_0x4640c4['customerUa'][_0x15af26(0x178)](0x0,0x32)+_0x15af26(0xc4):_0x4640c4[_0x15af26(0x141)];_0xb60cc1+=_0x15af26(0xc7)+_0x4d2392+'`\x0a';}}_0x3175a0===_0x15af26(0x102)&&_0x4640c4[_0x15af26(0x10b)]&&(_0xb60cc1+=_0x15af26(0x104)+_0x4640c4[_0x15af26(0x10b)]+_0x15af26(0x126)),_0x3175a0===_0x15af26(0xc6)&&(_0xb60cc1+='⏳\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a'),_0x4640c4[_0x15af26(0x18d)]&&(_0xb60cc1+=_0x15af26(0xb8)+_0x4640c4[_0x15af26(0x18d)]+'\x0a'),await this['sendShopNotification'](_0x12062a,_0xb60cc1,{'parse_mode':'Markdown'});}async[a59_0x11e826(0xb4)](_0x37b4ee,_0x7cc23c,_0x5ef1e4){const _0x5cb6fd=a59_0x11e826,_0x1ddf98={'created':'📤','completed':'✅','rejected':'❌'},_0x2141e6={'created':_0x5cb6fd(0xf9),'completed':_0x5cb6fd(0xef),'rejected':_0x5cb6fd(0xa8)},_0x1c320f=_0x1ddf98[_0x5ef1e4],_0x7f4801=_0x2141e6[_0x5ef1e4],_0x2135e4=_0x1c320f+'\x20*'+_0x7f4801+_0x5cb6fd(0x100)+(_0x5cb6fd(0xc9)+_0x7cc23c[_0x5cb6fd(0x180)]+_0x5cb6fd(0x192))+('🏦\x20Method:\x20`'+_0x7cc23c[_0x5cb6fd(0x193)]+'`\x0a')+(_0x5cb6fd(0x10e)+_0x7cc23c['id']+'`\x0a')+(_0x5cb6fd(0xd7)+new Date(_0x7cc23c[_0x5cb6fd(0x17b)])[_0x5cb6fd(0xcc)](_0x5cb6fd(0x17f))+'\x0a')+(_0x7cc23c[_0x5cb6fd(0xfa)]?'🔗\x20TXID:\x20`'+_0x7cc23c[_0x5cb6fd(0xfa)]+'`':'');await this[_0x5cb6fd(0xd2)](_0x37b4ee,_0x2135e4,{'parse_mode':_0x5cb6fd(0xc8)});}async[a59_0x11e826(0xf5)](_0x173d55,_0x23cf9a){const _0x40d6f7=a59_0x11e826;try{const _0x5b66e8=await database_1[_0x40d6f7(0xea)]['shopSettings'][_0x40d6f7(0xbc)]({'where':{'shopId':_0x173d55},'select':{'notificationLogin':!![]}});if(!_0x5b66e8?.[_0x40d6f7(0x11a)]){console[_0x40d6f7(0xe4)]('📱\x20Login\x20notifications\x20disabled\x20for\x20shop\x20'+_0x173d55);return;}const _0x496600=_0x23cf9a[_0x40d6f7(0xcb)]?'🔐':'🚨',_0x4b6801=_0x23cf9a[_0x40d6f7(0xcb)]?_0x40d6f7(0xe1):_0x40d6f7(0xe7);let _0x1ab3be=_0x496600+'\x20*'+_0x4b6801+_0x40d6f7(0x100)+(_0x40d6f7(0x16d)+_0x23cf9a['username']+'`\x0a')+(_0x40d6f7(0x106)+_0x23cf9a[_0x40d6f7(0xca)][_0x40d6f7(0xcc)](_0x40d6f7(0x17f))+'\x0a');_0x23cf9a[_0x40d6f7(0x105)]&&(_0x1ab3be+=_0x40d6f7(0xec)+_0x23cf9a['ipAddress']+'`\x0a');if(_0x23cf9a[_0x40d6f7(0xe0)]){const _0x1ddffa=_0x23cf9a[_0x40d6f7(0xe0)][_0x40d6f7(0x164)]>0x32?_0x23cf9a[_0x40d6f7(0xe0)][_0x40d6f7(0x178)](0x0,0x32)+_0x40d6f7(0xc4):_0x23cf9a[_0x40d6f7(0xe0)];_0x1ab3be+=_0x40d6f7(0xc7)+_0x1ddffa+'`\x0a';}!_0x23cf9a[_0x40d6f7(0xcb)]&&(_0x1ab3be+='\x0a⚠️\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!'),await this[_0x40d6f7(0xd2)](_0x173d55,_0x1ab3be,{'parse_mode':_0x40d6f7(0xc8)}),console[_0x40d6f7(0xe4)](_0x40d6f7(0x13a)+_0x173d55+':\x20'+(_0x23cf9a[_0x40d6f7(0xcb)]?'success':_0x40d6f7(0x161)));}catch(_0x27d1de){console[_0x40d6f7(0xb9)](_0x40d6f7(0xf1),_0x27d1de);}}async['sendApiErrorNotification'](_0x36dd21,_0x35d060){const _0x4babb9=a59_0x11e826;try{const _0x2aa10d=await database_1['default'][_0x4babb9(0x10a)]['findUnique']({'where':{'shopId':_0x36dd21},'select':{'notificationApiError':!![]}});if(!_0x2aa10d?.[_0x4babb9(0x186)]){console[_0x4babb9(0xe4)](_0x4babb9(0x11d)+_0x36dd21);return;}let _0x26bb45=_0x4babb9(0x10f)+(_0x4babb9(0x156)+_0x35d060[_0x4babb9(0x193)]+'\x20'+_0x35d060['endpoint']+'`\x0a')+(_0x4babb9(0x106)+_0x35d060[_0x4babb9(0xca)][_0x4babb9(0xcc)](_0x4babb9(0x17f))+'\x0a');_0x35d060['statusCode']&&(_0x26bb45+='📊\x20Error\x20code:\x20`'+_0x35d060[_0x4babb9(0x107)]+'`\x0a'),_0x26bb45+=_0x4babb9(0x130)+_0x35d060['errorMessage']+'`\x0a',_0x35d060[_0x4babb9(0xd6)]&&(_0x26bb45+=_0x4babb9(0xce)+_0x35d060[_0x4babb9(0xd6)]+'`\x0a'),_0x26bb45+=_0x4babb9(0x18f),await this[_0x4babb9(0xd2)](_0x36dd21,_0x26bb45,{'parse_mode':_0x4babb9(0xc8)}),console[_0x4babb9(0xe4)](_0x4babb9(0xf0)+_0x36dd21+':\x20'+_0x35d060[_0x4babb9(0x183)]);}catch(_0x1bb141){console[_0x4babb9(0xb9)]('Failed\x20to\x20send\x20API\x20error\x20notification:',_0x1bb141);}}async[a59_0x11e826(0xb0)](_0x5d9478,_0x5f5200,_0x2d80c9){const _0x1b75c1=a59_0x11e826;let _0x5d38d7=_0x1b75c1(0xab)+_0x5f5200+_0x1b75c1(0x100);for(const [_0x51aed9,_0x1e1183]of Object[_0x1b75c1(0xba)](_0x2d80c9)){_0x1e1183!==null&&_0x1e1183!==undefined&&(_0x5d38d7+=_0x51aed9+_0x1b75c1(0xaf)+_0x1e1183+'`\x0a');}await this[_0x1b75c1(0xd2)](_0x5d9478,_0x5d38d7,{'parse_mode':'Markdown'});}[a59_0x11e826(0x184)](){const _0x4dc16d=a59_0x11e826;return{'isActive':!!this['bot'],'username':this[_0x4dc16d(0x158)]};}[a59_0x11e826(0x122)](){const _0x450786=a59_0x11e826;this[_0x450786(0x189)]&&(this['bot'][_0x450786(0xac)](),this['bot']=null,console['log'](_0x450786(0x10c)));}}exports[a59_0x11e826(0x12e)]=TelegramBotService,exports['telegramBotService']=new TelegramBotService();