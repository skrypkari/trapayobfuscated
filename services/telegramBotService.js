'use strict';const a55_0x4ca319=a55_0x3951;function a55_0x3951(_0x4f8cdc,_0x49c0e8){const _0x2b61d5=a55_0x2b61();return a55_0x3951=function(_0x395192,_0x22250f){_0x395192=_0x395192-0x97;let _0x134a5c=_0x2b61d5[_0x395192];return _0x134a5c;},a55_0x3951(_0x4f8cdc,_0x49c0e8);}(function(_0x3df64d,_0x559c8b){const _0x370d95=a55_0x3951,_0x3dee3f=_0x3df64d();while(!![]){try{const _0x5df171=parseInt(_0x370d95(0x153))/0x1+-parseInt(_0x370d95(0x107))/0x2*(parseInt(_0x370d95(0x126))/0x3)+parseInt(_0x370d95(0x174))/0x4*(-parseInt(_0x370d95(0x11b))/0x5)+-parseInt(_0x370d95(0xca))/0x6*(parseInt(_0x370d95(0x10d))/0x7)+parseInt(_0x370d95(0x111))/0x8*(parseInt(_0x370d95(0xe6))/0x9)+-parseInt(_0x370d95(0x139))/0xa*(-parseInt(_0x370d95(0x12e))/0xb)+parseInt(_0x370d95(0x119))/0xc;if(_0x5df171===_0x559c8b)break;else _0x3dee3f['push'](_0x3dee3f['shift']());}catch(_0x5943e2){_0x3dee3f['push'](_0x3dee3f['shift']());}}}(a55_0x2b61,0x5b70b));var __importDefault=this&&this[a55_0x4ca319(0x155)]||function(_0x48e77d){const _0x54851f=a55_0x4ca319;return _0x48e77d&&_0x48e77d[_0x54851f(0x9a)]?_0x48e77d:{'default':_0x48e77d};};Object[a55_0x4ca319(0x143)](exports,a55_0x4ca319(0x9a),{'value':!![]}),exports[a55_0x4ca319(0x16f)]=exports[a55_0x4ca319(0xcb)]=void 0x0;function a55_0x2b61(){const _0x40cb7f=['👤\x20Username:\x20`','Payment\x20chargeback','•\x20New\x20payments\x0a','getBotInfo','You\x20sent\x20','❌\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20','bot','📅\x20Time:\x20','currency','📝\x20Format:\x20`username\x20api_key`\x0a\x0a','❌\x20Error\x20getting\x20debug\x20information.','username','•\x20`','482IwtDjj','env','🔄\x20Reset\x20incomplete\x20verification\x20for\x20user\x20','orderId','📱\x20Login\x20notifications\x20disabled\x20for\x20shop\x20','Failed\x20to\x20send\x20API\x20error\x20notification:','50505qcMoOw','chat','🏪\x20Available\x20shops\x20in\x20system:\x0a',':\x20`','40ABDzvr','\x20via\x20single-line\x20input','map','.\x20*','setupBotHandlers','join','Payout\x20rejected','publicKey','8886312czXjTM','🎉\x20*Congratulations!*\x0a\x0a','21295JrvMau','✅\x20Telegram\x20user\x20','update','User\x20','trapay_bot','length','Failed\x20to\x20send\x20login\x20notification:','❌\x20Failed\x20to\x20initialize\x20Telegram\x20bot:','includes','chargeback','Contact\x20administrator.','3387iWKbWC','API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','method','sendApiErrorNotification','Error\x20sending\x20shop\x20notification:','📱\x20Your\x20Telegram\x20ID:\x20`','❌\x20An\x20error\x20occurred\x20while\x20verifying\x20data.','🔔\x20You\x20receive\x20notifications\x20about:\x0a','1133462aVYVkK','customerIp','Use\x20/start\x20to\x20connect.','*.\x0a\x0a','../config/database','\x20USD*\x0a','Username:\x20`','...','🔔\x20*','\x0aCheck\x20spelling\x20and\x20try\x20again.','Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`','10LHEkrA','shop','Error\x20handling\x20/start\x20command:','Commands:\x0a','\x20\x20\x20Username:\x20`','...\x22','Telegram\x20bot\x20error:','Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.','telegramUser','🔍\x20*Debug\x20Information*\x0a\x0a','defineProperty','🏦\x20Method:\x20`','amount','🔌\x20User\x20','trim','initializeBot','ACTIVE','📱\x20Created\x20new\x20Telegram\x20user:\x20','TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables','\x22,\x20apiKey=\x22','toLocaleDateString','✅\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a','pk_','To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a','createdAt','isVerified','8224AdenCY','\x20disconnected\x20from\x20shop\x20','__importDefault','gateway','❌\x20API\x20key\x20does\x20not\x20match\x20shop\x20`','Failed\x20login\x20attempt','Payment\x20expired','notificationLogin','📊\x20Error\x20code:\x20`','Example:\x0a','💰\x20Amount:\x20*','from','startsWith','success','sendPaymentNotification','Check\x20spelling\x20and\x20try\x20again.','../types/gateway','remitterIban','botToken','endpoint','warn','Payment\x20refund','blocked','Payment\x20successfully\x20paid','Payment\x20failed','❌\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.','/status\x20-\x20check\x20connection\x20status\x0a','unknown\x20shop','telegramBotService','ipAddress','`\x20(','•\x20Payouts\x0a','Payout\x20completed','484YAjwEJ','💸\x20Penalty\x20amount:\x20*','TELEGRAM_BOT_TOKEN','\x20USDT*\x0a','polling_error','New\x20payment\x20created','`.\x0a\x0a','status','🆔\x20Payment\x20ID:\x20`','✅\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*',':\x20username=\x22','Telegram\x20bot\x20polling\x20error:','🏪\x20Gateway:\x20`','telegramId','__esModule','*\x0a\x0a','🛑\x20Telegram\x20bot\x20stopped','📱\x20Telegram\x20notification:\x20gateway\x20\x22','error','📱\x20Shop:\x20*','🆔\x20Payout\x20ID:\x20`','📅\x20Date:\x20','\x20verified\x20for\x20shop\x20','❌\x20Please\x20use\x20/start\x20command\x20first','❌\x20Shop\x20with\x20username\x20`','last_name','substring','user\x20is\x20deactivated','🌐\x20IP:\x20`','❌\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`','findFirst','secretKey','sendShopNotification','customerEmail','toLocaleString','shopSettings','To\x20reconnect,\x20use\x20the\x20/start\x20command','📧\x20Email:\x20`','sendPayoutNotification','processing','first_name','`\x20not\x20found.\x0a\x0a','Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.','botUsername','🔔\x20Notifications\x20are\x20active\x0a\x0a','•\x20Payment\x20status\x20changes\x0a','customerName','❌\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a','🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20','name','Successful\x20login','\x20(@','test','\x0a⚠️\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!','en-US','\x20initialized\x20successfully','allSettled','stopPolling','sendCustomNotification','❌\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a','...`\x0a\x0a','handleSingleLineVerification','258uaIXpH','TelegramBotService','You\x20are\x20already\x20connected\x20to\x20shop:\x20*','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','❌\x20Shop\x20`','✅\x20Connected\x20to\x20shop:\x20*','`\x0a\x0a','\x20\x20\x20Status:\x20','sendMessage','✅\x20Telegram\x20bot\x20@','default','split','❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','message','findMany','Error\x20handling\x20/status\x20command:','findUnique','💻\x20Browser:\x20`','🌐\x20IP\x20address:\x20`','statusCode','adminNotes','shopId','🆔\x20Request\x20ID:\x20`','🔗\x20Endpoint:\x20`','customerUa','✅\x20Notification\x20sent\x20to\x20Telegram\x20user\x20','requestId','📝\x20Notes:\x20','1116756dmPUUz','forEach','❌\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a','✅\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*','onText','log','toString','📝\x20Order\x20ID:\x20`','No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20','chargebackAmount','text','Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification','New\x20payout\x20created','Markdown','TELEGRAM_BOT_USERNAME','📱\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20','txid','userAgent','notificationApiError','timestamp'];a55_0x2b61=function(){return _0x40cb7f;};return a55_0x2b61();}const node_telegram_bot_api_1=__importDefault(require('node-telegram-bot-api')),database_1=__importDefault(require(a55_0x4ca319(0x132))),gateway_1=require(a55_0x4ca319(0x163));class TelegramBotService{constructor(){const _0x5c0922=a55_0x4ca319;this['bot']=null,this['botToken']=process['env'][_0x5c0922(0x176)]||'',this['botUsername']=process[_0x5c0922(0x108)][_0x5c0922(0xf4)]||_0x5c0922(0x11f),this[_0x5c0922(0x165)]?this[_0x5c0922(0x148)]():console[_0x5c0922(0x167)](_0x5c0922(0x14b));}['initializeBot'](){const _0x14302c=a55_0x4ca319;try{this['bot']=new node_telegram_bot_api_1['default'](this[_0x14302c(0x165)],{'polling':!![]}),this[_0x14302c(0x115)](),console[_0x14302c(0xeb)](_0x14302c(0xd3)+this[_0x14302c(0xb7)]+_0x14302c(0xc3));}catch(_0x5a574e){console[_0x14302c(0x9e)](_0x14302c(0x122),_0x5a574e);}}[a55_0x4ca319(0x115)](){const _0x421a7d=a55_0x4ca319;if(!this[_0x421a7d(0x100)])return;this[_0x421a7d(0x100)][_0x421a7d(0xea)](/\/start/,async _0xe4936e=>{const _0x5d62b9=_0x421a7d,_0x4d8428=_0xe4936e[_0x5d62b9(0x10e)]['id'],_0x4d355a=_0xe4936e['from']?.['id'][_0x5d62b9(0xec)](),_0x139398=_0xe4936e[_0x5d62b9(0x15e)]?.['username'],_0x5792f6=_0xe4936e[_0x5d62b9(0x15e)]?.[_0x5d62b9(0xb4)],_0x121c64=_0xe4936e[_0x5d62b9(0x15e)]?.[_0x5d62b9(0xa5)];if(!_0x4d355a)return;try{let _0xb53174=await database_1[_0x5d62b9(0xd4)][_0x5d62b9(0x141)][_0x5d62b9(0xda)]({'where':{'telegramId':_0x4d355a},'include':{'shop':!![]}});!_0xb53174?(_0xb53174=await database_1['default'][_0x5d62b9(0x141)]['create']({'data':{'telegramId':_0x4d355a,'username':_0x139398,'firstName':_0x5792f6,'lastName':_0x121c64,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console[_0x5d62b9(0xeb)](_0x5d62b9(0x14a)+_0x4d355a+_0x5d62b9(0xbf)+_0x139398+')')):_0xb53174=await database_1['default'][_0x5d62b9(0x141)][_0x5d62b9(0x11d)]({'where':{'telegramId':_0x4d355a},'data':{'username':_0x139398,'firstName':_0x5792f6,'lastName':_0x121c64},'include':{'shop':!![]}}),_0xb53174[_0x5d62b9(0x152)]&&_0xb53174[_0x5d62b9(0xdf)]&&_0xb53174[_0x5d62b9(0x13a)]?await this[_0x5d62b9(0x100)]?.[_0x5d62b9(0xd2)](_0x4d8428,'✅\x20Welcome\x20back!\x0a\x0a'+(_0x5d62b9(0xcc)+_0xb53174[_0x5d62b9(0x13a)]['name']+'*\x0a')+(_0x5d62b9(0x134)+_0xb53174[_0x5d62b9(0x13a)][_0x5d62b9(0x105)]+_0x5d62b9(0xd0))+_0x5d62b9(0x12d)+_0x5d62b9(0xfc)+_0x5d62b9(0xb9)+'•\x20Payouts\x0a\x0a'+_0x5d62b9(0x13c)+_0x5d62b9(0x16d)+'/disconnect\x20-\x20disconnect\x20from\x20notifications',{'parse_mode':_0x5d62b9(0xf3)}):(_0xb53174[_0x5d62b9(0xdf)]&&!_0xb53174[_0x5d62b9(0x152)]&&(await database_1[_0x5d62b9(0xd4)][_0x5d62b9(0x141)][_0x5d62b9(0x11d)]({'where':{'telegramId':_0x4d355a},'data':{'shopId':null,'isVerified':![]}}),console[_0x5d62b9(0xeb)](_0x5d62b9(0x109)+_0x4d355a)),await this[_0x5d62b9(0x100)]?.[_0x5d62b9(0xd2)](_0x4d8428,'🤖\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a'+_0x5d62b9(0x150)+_0x5d62b9(0x103)+'Example:\x0a'+_0x5d62b9(0xcd)+'❗️\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!',{'parse_mode':_0x5d62b9(0xf3)}));}catch(_0x46e436){console[_0x5d62b9(0x9e)](_0x5d62b9(0x13b),_0x46e436),await this['bot']?.[_0x5d62b9(0xd2)](_0x4d8428,'❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this[_0x421a7d(0x100)][_0x421a7d(0xea)](/\/disconnect/,async _0x355eaf=>{const _0x11d7ea=_0x421a7d,_0x4356aa=_0x355eaf[_0x11d7ea(0x10e)]['id'],_0x38cdcb=_0x355eaf['from']?.['id']['toString']();if(!_0x38cdcb)return;try{const _0xa646fd=await database_1[_0x11d7ea(0xd4)]['telegramUser'][_0x11d7ea(0xda)]({'where':{'telegramId':_0x38cdcb},'include':{'shop':!![]}});if(!_0xa646fd||!_0xa646fd[_0x11d7ea(0x152)]||!_0xa646fd['shopId']){await this[_0x11d7ea(0x100)]?.['sendMessage'](_0x4356aa,_0x11d7ea(0x16c));return;}const _0x5d585b=_0xa646fd[_0x11d7ea(0x13a)]?.[_0x11d7ea(0xbd)]||_0x11d7ea(0x16e);await database_1['default'][_0x11d7ea(0x141)][_0x11d7ea(0x11d)]({'where':{'telegramId':_0x38cdcb},'data':{'shopId':null,'isVerified':![]}}),console[_0x11d7ea(0xeb)](_0x11d7ea(0x146)+_0x38cdcb+_0x11d7ea(0x154)+_0xa646fd['shopId']),await this[_0x11d7ea(0x100)]?.[_0x11d7ea(0xd2)](_0x4356aa,_0x11d7ea(0xe9)+_0x5d585b+_0x11d7ea(0x131)+_0x11d7ea(0xb0),{'parse_mode':_0x11d7ea(0xf3)});}catch(_0x501b0c){console[_0x11d7ea(0x9e)]('Error\x20handling\x20/disconnect\x20command:',_0x501b0c),await this[_0x11d7ea(0x100)]?.[_0x11d7ea(0xd2)](_0x4356aa,_0x11d7ea(0xd6));}}),this[_0x421a7d(0x100)]['onText'](/\/status/,async _0x9ae740=>{const _0x4e8962=_0x421a7d,_0x2cec16=_0x9ae740[_0x4e8962(0x10e)]['id'],_0x1b37e9=_0x9ae740[_0x4e8962(0x15e)]?.['id']['toString']();if(!_0x1b37e9)return;try{const _0x2f89a2=await database_1['default'][_0x4e8962(0x141)][_0x4e8962(0xda)]({'where':{'telegramId':_0x1b37e9},'include':{'shop':!![]}});if(!_0x2f89a2){await this['bot']?.[_0x4e8962(0xd2)](_0x2cec16,_0x4e8962(0xbb)+'Use\x20/start\x20to\x20begin.');return;}if(!_0x2f89a2[_0x4e8962(0x152)]||!_0x2f89a2[_0x4e8962(0xdf)]||!_0x2f89a2[_0x4e8962(0x13a)]){await this['bot']?.['sendMessage'](_0x2cec16,_0x4e8962(0xc7)+_0x4e8962(0x130));return;}await this[_0x4e8962(0x100)]?.[_0x4e8962(0xd2)](_0x2cec16,'📊\x20*Connection\x20Status*\x0a\x0a'+(_0x4e8962(0xcf)+_0x2f89a2[_0x4e8962(0x13a)][_0x4e8962(0xbd)]+'*\x0a')+('👤\x20Username:\x20`'+_0x2f89a2[_0x4e8962(0x13a)][_0x4e8962(0x105)]+'`\x0a')+('📅\x20Connection\x20date:\x20'+_0x2f89a2['updatedAt'][_0x4e8962(0x14d)](_0x4e8962(0xc2))+'\x0a\x0a')+_0x4e8962(0xb8)+_0x4e8962(0x13c)+'/disconnect\x20-\x20disconnect\x20from\x20notifications',{'parse_mode':_0x4e8962(0xf3)});}catch(_0x390995){console['error'](_0x4e8962(0xd9),_0x390995),await this[_0x4e8962(0x100)]?.[_0x4e8962(0xd2)](_0x2cec16,_0x4e8962(0xd6));}}),this[_0x421a7d(0x100)][_0x421a7d(0xea)](/\/debug/,async _0x5e7f6a=>{const _0x330e3e=_0x421a7d,_0x4ff411=_0x5e7f6a[_0x330e3e(0x10e)]['id'],_0x2ff041=_0x5e7f6a[_0x330e3e(0x15e)]?.['id'][_0x330e3e(0xec)]();if(!_0x2ff041)return;try{const _0x3525cd=await database_1['default'][_0x330e3e(0x13a)][_0x330e3e(0xd8)]({'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![]},'take':0xa});let _0x4ea2e9=_0x330e3e(0x142);_0x4ea2e9+=_0x330e3e(0x12b)+_0x2ff041+_0x330e3e(0xd0),_0x4ea2e9+=_0x330e3e(0x10f),_0x3525cd['forEach']((_0x2300e5,_0x526319)=>{const _0x2df87f=_0x330e3e;_0x4ea2e9+=_0x526319+0x1+_0x2df87f(0x114)+_0x2300e5['name']+'*\x0a',_0x4ea2e9+=_0x2df87f(0x13d)+_0x2300e5['username']+'`\x0a',_0x4ea2e9+=_0x2df87f(0xd1)+_0x2300e5['status']+'\x0a',_0x4ea2e9+='\x20\x20\x20Public\x20Key:\x20`'+_0x2300e5[_0x2df87f(0x118)][_0x2df87f(0xa6)](0x0,0xf)+_0x2df87f(0xc8);}),await this['bot']?.[_0x330e3e(0xd2)](_0x4ff411,_0x4ea2e9,{'parse_mode':_0x330e3e(0xf3)});}catch(_0x1c27fc){console['error']('Error\x20handling\x20/debug\x20command:',_0x1c27fc),await this['bot']?.[_0x330e3e(0xd2)](_0x4ff411,_0x330e3e(0x104));}}),this['bot']['on']('message',async _0xe00754=>{const _0x5123b4=_0x421a7d;if(_0xe00754[_0x5123b4(0xf0)]?.[_0x5123b4(0x15f)]('/'))return;const _0x5078f2=_0xe00754[_0x5123b4(0x10e)]['id'],_0x49a140=_0xe00754[_0x5123b4(0x15e)]?.['id'][_0x5123b4(0xec)](),_0x289408=_0xe00754[_0x5123b4(0xf0)]?.[_0x5123b4(0x147)]();if(!_0x49a140||!_0x289408)return;try{const _0x5d5a52=await database_1[_0x5123b4(0xd4)][_0x5123b4(0x141)]['findUnique']({'where':{'telegramId':_0x49a140},'include':{'shop':!![]}});if(!_0x5d5a52){await this[_0x5123b4(0x100)]?.[_0x5123b4(0xd2)](_0x5078f2,_0x5123b4(0xa3));return;}if(_0x5d5a52[_0x5123b4(0x152)]&&_0x5d5a52[_0x5123b4(0xdf)]&&_0x5d5a52['shop']){await this['bot']?.[_0x5123b4(0xd2)](_0x5078f2,_0x5123b4(0x17d)+_0x5d5a52[_0x5123b4(0x13a)][_0x5123b4(0xbd)]+'*.\x0a\x0a'+_0x5123b4(0xb6),{'parse_mode':_0x5123b4(0xf3)});return;}const _0x3ed49b=_0x289408[_0x5123b4(0xd5)](/\s+/);if(_0x3ed49b['length']!==0x2){await this[_0x5123b4(0x100)]?.[_0x5123b4(0xd2)](_0x5078f2,_0x5123b4(0xe8)+'📝\x20Format:\x20`username\x20api_key`\x0a\x0a'+_0x5123b4(0x15c)+_0x5123b4(0xcd)+(_0x5123b4(0xfe)+_0x3ed49b[_0x5123b4(0x120)]+'\x20parts:\x20'+_0x3ed49b[_0x5123b4(0x113)](_0x449b01=>'`'+_0x449b01+'`')[_0x5123b4(0x116)](',\x20')),{'parse_mode':'Markdown'});return;}const [_0x5e7034,_0x177fca]=_0x3ed49b;console[_0x5123b4(0xeb)](_0x5123b4(0xbc)+_0x49a140+_0x5123b4(0x17e)+_0x5e7034+_0x5123b4(0x14c)+_0x177fca['substring'](0x0,0xa)+'...\x22'),await this['handleSingleLineVerification'](_0x5078f2,_0x49a140,_0x5e7034,_0x177fca);}catch(_0x2fc80a){console[_0x5123b4(0x9e)]('Error\x20handling\x20message:',_0x2fc80a),await this[_0x5123b4(0x100)]?.[_0x5123b4(0xd2)](_0x5078f2,_0x5123b4(0xd6));}}),this['bot']['on'](_0x421a7d(0x9e),_0x4b405d=>{const _0xdf0f43=_0x421a7d;console['error'](_0xdf0f43(0x13f),_0x4b405d);}),this['bot']['on'](_0x421a7d(0x178),_0x570429=>{const _0x2dbd4e=_0x421a7d;console[_0x2dbd4e(0x9e)](_0x2dbd4e(0x97),_0x570429);});}async[a55_0x4ca319(0xc9)](_0x4e6198,_0x101fb7,_0x418cc9,_0x2fb91a){const _0x272936=a55_0x4ca319;try{console['log'](_0x272936(0xbc)+_0x101fb7+_0x272936(0x17e)+_0x418cc9+_0x272936(0x14c)+_0x2fb91a[_0x272936(0xa6)](0x0,0xa)+_0x272936(0x13e));if(!_0x418cc9||_0x418cc9[_0x272936(0x120)]<0x3||_0x418cc9['length']>0x32||!/^[a-zA-Z0-9_]+$/[_0x272936(0xc0)](_0x418cc9)){await this[_0x272936(0x100)]?.[_0x272936(0xd2)](_0x4e6198,'❌\x20Invalid\x20username\x20format:\x20`'+_0x418cc9+'`\x0a\x0a'+'Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).',{'parse_mode':_0x272936(0xf3)});return;}if(!_0x2fb91a||!_0x2fb91a[_0x272936(0x15f)](_0x272936(0x14f))&&!_0x2fb91a[_0x272936(0x15f)]('sk_')){await this[_0x272936(0x100)]?.[_0x272936(0xd2)](_0x4e6198,'❌\x20Invalid\x20API\x20key\x20format.\x0a\x0a'+_0x272936(0x127),{'parse_mode':_0x272936(0xf3)});return;}const _0x1ae18e=await database_1['default'][_0x272936(0x13a)][_0x272936(0xda)]({'where':{'username':_0x418cc9},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x1ae18e){const _0x3aae42=await database_1['default'][_0x272936(0x13a)]['findMany']({'select':{'username':!![],'name':!![]},'take':0x5});let _0x56072c=_0x272936(0xa4)+_0x418cc9+_0x272936(0xb5);_0x3aae42[_0x272936(0x120)]>0x0?(_0x56072c+='Available\x20usernames:\x0a',_0x3aae42[_0x272936(0xe7)](_0x38a5ef=>{const _0x241d52=_0x272936;_0x56072c+=_0x241d52(0x106)+_0x38a5ef[_0x241d52(0x105)]+_0x241d52(0x171)+_0x38a5ef['name']+')\x0a';}),_0x56072c+=_0x272936(0x137)):_0x56072c+=_0x272936(0x162);await this[_0x272936(0x100)]?.[_0x272936(0xd2)](_0x4e6198,_0x56072c,{'parse_mode':_0x272936(0xf3)});return;}if(_0x1ae18e[_0x272936(0x17b)]!==_0x272936(0x149)){await this[_0x272936(0x100)]?.['sendMessage'](_0x4e6198,_0x272936(0xce)+_0x418cc9+'`\x20is\x20inactive.\x0a\x0a'+_0x272936(0x125),{'parse_mode':_0x272936(0xf3)});return;}if(_0x1ae18e[_0x272936(0x118)]!==_0x2fb91a&&_0x1ae18e[_0x272936(0xab)]!==_0x2fb91a){await this[_0x272936(0x100)]?.[_0x272936(0xd2)](_0x4e6198,_0x272936(0x157)+_0x418cc9+_0x272936(0x17a)+'Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a'+_0x272936(0x138),{'parse_mode':'Markdown'});return;}const _0x1c430c=await database_1[_0x272936(0xd4)][_0x272936(0x141)][_0x272936(0xaa)]({'where':{'shopId':_0x1ae18e['id'],'isVerified':!![],'telegramId':{'not':_0x101fb7}}});if(_0x1c430c){await this[_0x272936(0x100)]?.[_0x272936(0xd2)](_0x4e6198,_0x272936(0xa9)+_0x418cc9+_0x272936(0x17a)+_0x272936(0x140),{'parse_mode':_0x272936(0xf3)});return;}await database_1[_0x272936(0xd4)]['telegramUser'][_0x272936(0x11d)]({'where':{'telegramId':_0x101fb7},'data':{'shopId':_0x1ae18e['id'],'isVerified':!![]}}),await this[_0x272936(0x100)]?.[_0x272936(0xd2)](_0x4e6198,_0x272936(0x11a)+_0x272936(0x14e)+(_0x272936(0x9f)+_0x1ae18e[_0x272936(0xbd)]+'*\x0a')+(_0x272936(0xfa)+_0x1ae18e['username']+'`\x0a\x0a')+'🔔\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a'+_0x272936(0xfc)+'•\x20Payment\x20status\x20changes\x0a'+_0x272936(0x172)+'•\x20Important\x20events\x0a\x0a'+_0x272936(0x13c)+_0x272936(0x16d)+'/disconnect\x20-\x20disconnect\x20from\x20notifications',{'parse_mode':'Markdown'}),console[_0x272936(0xeb)](_0x272936(0x11c)+_0x101fb7+_0x272936(0xa2)+_0x1ae18e[_0x272936(0x105)]+_0x272936(0x112));}catch(_0x4e1f20){console[_0x272936(0x9e)]('Error\x20in\x20handleSingleLineVerification:',_0x4e1f20),await this[_0x272936(0x100)]?.['sendMessage'](_0x4e6198,_0x272936(0x12c));}}async[a55_0x4ca319(0xac)](_0x21b93e,_0x2712c9,_0x4f0c65){const _0x12701a=a55_0x4ca319;if(!this['bot']){console[_0x12701a(0x167)](_0x12701a(0xf1));return;}try{const _0x943806=await database_1[_0x12701a(0xd4)][_0x12701a(0x141)]['findMany']({'where':{'shopId':_0x21b93e,'isVerified':!![]}});if(_0x943806['length']===0x0){console[_0x12701a(0xeb)](_0x12701a(0xee)+_0x21b93e);return;}const _0xee91b7=_0x943806[_0x12701a(0x113)](async _0x49888d=>{const _0x1cacd6=_0x12701a;try{await this[_0x1cacd6(0x100)]?.[_0x1cacd6(0xd2)](_0x49888d[_0x1cacd6(0x99)],_0x2712c9,_0x4f0c65),console[_0x1cacd6(0xeb)](_0x1cacd6(0xe3)+_0x49888d['telegramId']);}catch(_0x47b30f){console[_0x1cacd6(0x9e)](_0x1cacd6(0xff)+_0x49888d[_0x1cacd6(0x99)]+':',_0x47b30f),_0x47b30f instanceof Error&&(_0x47b30f[_0x1cacd6(0xd7)][_0x1cacd6(0x123)](_0x1cacd6(0x169))||_0x47b30f['message'][_0x1cacd6(0x123)]('chat\x20not\x20found')||_0x47b30f['message']['includes'](_0x1cacd6(0xa7)))&&(await database_1[_0x1cacd6(0xd4)]['telegramUser']['update']({'where':{'id':_0x49888d['id']},'data':{'isVerified':![]}}),console[_0x1cacd6(0xeb)](_0x1cacd6(0x11e)+_0x49888d[_0x1cacd6(0x99)]+'\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure'));}});await Promise[_0x12701a(0xc4)](_0xee91b7);}catch(_0x12df45){console['error'](_0x12701a(0x12a),_0x12df45);}}async[a55_0x4ca319(0x161)](_0x375441,_0x5d2e63,_0x49fbff){const _0x509a54=a55_0x4ca319,_0x1ad24e={'created':'🆕','paid':'✅','failed':'❌','expired':'⏰','refund':'🔄','chargeback':'⚠️','processing':'⚙️'},_0x4c659d={'created':_0x509a54(0x179),'paid':_0x509a54(0x16a),'failed':_0x509a54(0x16b),'expired':_0x509a54(0x159),'refund':_0x509a54(0x168),'chargeback':_0x509a54(0xfb),'processing':'Payment\x20is\x20being\x20processed'},_0x38fbff=_0x1ad24e[_0x49fbff],_0x2f7e70=_0x4c659d[_0x49fbff],_0x5b4734=(0x0,gateway_1['getGatewayDisplayNameForTelegram'])(_0x5d2e63[_0x509a54(0x156)]);console[_0x509a54(0xeb)](_0x509a54(0x9d)+_0x5d2e63[_0x509a54(0x156)]+'\x22\x20->\x20display\x20\x22'+_0x5b4734+'\x22');let _0xc4f63=_0x38fbff+'\x20*'+_0x2f7e70+_0x509a54(0x9b)+(_0x509a54(0x15d)+_0x5d2e63[_0x509a54(0x145)]+'\x20'+_0x5d2e63[_0x509a54(0x102)]+'*\x0a')+(_0x509a54(0xed)+(_0x5d2e63[_0x509a54(0x10a)]||_0x5d2e63['id'])+'`\x0a')+(_0x509a54(0x17c)+_0x5d2e63['id']+'`\x0a')+(_0x509a54(0x98)+_0x5b4734+'`\x0a')+(_0x509a54(0xa1)+new Date(_0x5d2e63['createdAt'])[_0x509a54(0xae)](_0x509a54(0xc2))+'\x0a');if(_0x5d2e63['customerName']||_0x5d2e63['customerEmail']||_0x5d2e63[_0x509a54(0x164)]||_0x5d2e63[_0x509a54(0x12f)]||_0x5d2e63[_0x509a54(0xe2)]){_0xc4f63+='\x0a👤\x20*Customer\x20Information:*\x0a';_0x5d2e63['customerName']&&(_0xc4f63+='📛\x20Name:\x20`'+_0x5d2e63[_0x509a54(0xba)]+'`\x0a');_0x5d2e63[_0x509a54(0xad)]&&(_0xc4f63+=_0x509a54(0xb1)+_0x5d2e63['customerEmail']+'`\x0a');_0x5d2e63[_0x509a54(0x164)]&&(_0xc4f63+='🏦\x20IBAN:\x20`'+_0x5d2e63[_0x509a54(0x164)]+'`\x0a');_0x5d2e63[_0x509a54(0x12f)]&&(_0xc4f63+=_0x509a54(0xa8)+_0x5d2e63[_0x509a54(0x12f)]+'`\x0a');if(_0x5d2e63[_0x509a54(0xe2)]){const _0x346c52=_0x5d2e63[_0x509a54(0xe2)][_0x509a54(0x120)]>0x32?_0x5d2e63[_0x509a54(0xe2)][_0x509a54(0xa6)](0x0,0x32)+_0x509a54(0x135):_0x5d2e63[_0x509a54(0xe2)];_0xc4f63+=_0x509a54(0xdb)+_0x346c52+'`\x0a';}}_0x49fbff===_0x509a54(0x124)&&_0x5d2e63[_0x509a54(0xef)]&&(_0xc4f63+=_0x509a54(0x175)+_0x5d2e63[_0x509a54(0xef)]+_0x509a54(0x177)),_0x49fbff===_0x509a54(0xb3)&&(_0xc4f63+='⏳\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a'),_0x5d2e63[_0x509a54(0xde)]&&(_0xc4f63+=_0x509a54(0xe5)+_0x5d2e63[_0x509a54(0xde)]+'\x0a'),await this['sendShopNotification'](_0x375441,_0xc4f63,{'parse_mode':_0x509a54(0xf3)});}async[a55_0x4ca319(0xb2)](_0x488ee5,_0x422df7,_0x2141ff){const _0x358594=a55_0x4ca319,_0x15a695={'created':'📤','completed':'✅','rejected':'❌'},_0x4ceaac={'created':_0x358594(0xf2),'completed':_0x358594(0x173),'rejected':_0x358594(0x117)},_0x38067b=_0x15a695[_0x2141ff],_0x5b1d26=_0x4ceaac[_0x2141ff],_0x347466=_0x38067b+'\x20*'+_0x5b1d26+_0x358594(0x9b)+('💸\x20Amount:\x20*'+_0x422df7[_0x358594(0x145)]+_0x358594(0x133))+(_0x358594(0x144)+_0x422df7[_0x358594(0x128)]+'`\x0a')+(_0x358594(0xa0)+_0x422df7['id']+'`\x0a')+('📅\x20Date:\x20'+new Date(_0x422df7[_0x358594(0x151)])[_0x358594(0xae)]('en-US')+'\x0a')+(_0x422df7['txid']?'🔗\x20TXID:\x20`'+_0x422df7[_0x358594(0xf6)]+'`':'');await this[_0x358594(0xac)](_0x488ee5,_0x347466,{'parse_mode':_0x358594(0xf3)});}async['sendLoginNotification'](_0x14e443,_0x16d657){const _0x540061=a55_0x4ca319;try{const _0x41caf2=await database_1[_0x540061(0xd4)]['shopSettings'][_0x540061(0xda)]({'where':{'shopId':_0x14e443},'select':{'notificationLogin':!![]}});if(!_0x41caf2?.[_0x540061(0x15a)]){console[_0x540061(0xeb)](_0x540061(0x10b)+_0x14e443);return;}const _0x3729d2=_0x16d657['success']?'🔐':'🚨',_0xcfe5b3=_0x16d657[_0x540061(0x160)]?_0x540061(0xbe):_0x540061(0x158);let _0x7789d9=_0x3729d2+'\x20*'+_0xcfe5b3+_0x540061(0x9b)+(_0x540061(0xfa)+_0x16d657[_0x540061(0x105)]+'`\x0a')+(_0x540061(0x101)+_0x16d657[_0x540061(0xf9)]['toLocaleString'](_0x540061(0xc2))+'\x0a');_0x16d657[_0x540061(0x170)]&&(_0x7789d9+=_0x540061(0xdc)+_0x16d657['ipAddress']+'`\x0a');if(_0x16d657[_0x540061(0xf7)]){const _0x31aae3=_0x16d657['userAgent'][_0x540061(0x120)]>0x32?_0x16d657[_0x540061(0xf7)][_0x540061(0xa6)](0x0,0x32)+_0x540061(0x135):_0x16d657[_0x540061(0xf7)];_0x7789d9+=_0x540061(0xdb)+_0x31aae3+'`\x0a';}!_0x16d657[_0x540061(0x160)]&&(_0x7789d9+=_0x540061(0xc1)),await this['sendShopNotification'](_0x14e443,_0x7789d9,{'parse_mode':'Markdown'}),console[_0x540061(0xeb)]('✅\x20Login\x20notification\x20sent\x20for\x20shop\x20'+_0x14e443+':\x20'+(_0x16d657[_0x540061(0x160)]?'success':'failed'));}catch(_0x4a9b91){console[_0x540061(0x9e)](_0x540061(0x121),_0x4a9b91);}}async[a55_0x4ca319(0x129)](_0x3c3d87,_0x1adfcb){const _0x44ef4a=a55_0x4ca319;try{const _0x66479c=await database_1[_0x44ef4a(0xd4)][_0x44ef4a(0xaf)]['findUnique']({'where':{'shopId':_0x3c3d87},'select':{'notificationApiError':!![]}});if(!_0x66479c?.[_0x44ef4a(0xf8)]){console[_0x44ef4a(0xeb)](_0x44ef4a(0xf5)+_0x3c3d87);return;}let _0xbf2b65='🚨\x20*API\x20Error*\x0a\x0a'+(_0x44ef4a(0xe1)+_0x1adfcb[_0x44ef4a(0x128)]+'\x20'+_0x1adfcb[_0x44ef4a(0x166)]+'`\x0a')+(_0x44ef4a(0x101)+_0x1adfcb[_0x44ef4a(0xf9)][_0x44ef4a(0xae)](_0x44ef4a(0xc2))+'\x0a');_0x1adfcb[_0x44ef4a(0xdd)]&&(_0xbf2b65+=_0x44ef4a(0x15b)+_0x1adfcb[_0x44ef4a(0xdd)]+'`\x0a'),_0xbf2b65+='❌\x20Error:\x20`'+_0x1adfcb['errorMessage']+'`\x0a',_0x1adfcb['requestId']&&(_0xbf2b65+=_0x44ef4a(0xe0)+_0x1adfcb[_0x44ef4a(0xe4)]+'`\x0a'),_0xbf2b65+='\x0a💡\x20Check\x20your\x20request\x20or\x20contact\x20support.',await this[_0x44ef4a(0xac)](_0x3c3d87,_0xbf2b65,{'parse_mode':_0x44ef4a(0xf3)}),console[_0x44ef4a(0xeb)]('✅\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20'+_0x3c3d87+':\x20'+_0x1adfcb[_0x44ef4a(0x166)]);}catch(_0x220e4f){console['error'](_0x44ef4a(0x10c),_0x220e4f);}}async[a55_0x4ca319(0xc6)](_0x48a579,_0x5c166a,_0x2f4b86){const _0x564f20=a55_0x4ca319;let _0x3754da=_0x564f20(0x136)+_0x5c166a+_0x564f20(0x9b);for(const [_0x1a04bd,_0x53418a]of Object['entries'](_0x2f4b86)){_0x53418a!==null&&_0x53418a!==undefined&&(_0x3754da+=_0x1a04bd+_0x564f20(0x110)+_0x53418a+'`\x0a');}await this[_0x564f20(0xac)](_0x48a579,_0x3754da,{'parse_mode':_0x564f20(0xf3)});}[a55_0x4ca319(0xfd)](){const _0x1e7a68=a55_0x4ca319;return{'isActive':!!this['bot'],'username':this[_0x1e7a68(0xb7)]};}['stopBot'](){const _0x1be086=a55_0x4ca319;this['bot']&&(this['bot'][_0x1be086(0xc5)](),this['bot']=null,console[_0x1be086(0xeb)](_0x1be086(0x9c)));}}exports[a55_0x4ca319(0xcb)]=TelegramBotService,exports[a55_0x4ca319(0x16f)]=new TelegramBotService();