'use strict';const a80_0x3245aa=a80_0x5292;(function(_0x248b97,_0x852eba){const _0x1bf622=a80_0x5292,_0x555e89=_0x248b97();while(!![]){try{const _0x40e397=-parseInt(_0x1bf622(0xf0))/0x1+-parseInt(_0x1bf622(0x11e))/0x2*(parseInt(_0x1bf622(0x122))/0x3)+parseInt(_0x1bf622(0x175))/0x4*(-parseInt(_0x1bf622(0x1ab))/0x5)+-parseInt(_0x1bf622(0x149))/0x6+parseInt(_0x1bf622(0x18a))/0x7+parseInt(_0x1bf622(0x121))/0x8+parseInt(_0x1bf622(0x1b1))/0x9;if(_0x40e397===_0x852eba)break;else _0x555e89['push'](_0x555e89['shift']());}catch(_0x45a39a){_0x555e89['push'](_0x555e89['shift']());}}}(a80_0xab08,0xea4cf));var __importDefault=this&&this[a80_0x3245aa(0xec)]||function(_0x2a83cf){const _0x51bd3a=a80_0x3245aa;return _0x2a83cf&&_0x2a83cf[_0x51bd3a(0x1af)]?_0x2a83cf:{'default':_0x2a83cf};};Object[a80_0x3245aa(0xde)](exports,a80_0x3245aa(0x1af),{'value':!![]}),exports[a80_0x3245aa(0x10d)]=exports[a80_0x3245aa(0x15b)]=void 0x0;const node_telegram_bot_api_1=__importDefault(require('node-telegram-bot-api')),database_1=__importDefault(require(a80_0x3245aa(0x1a3))),gateway_1=require(a80_0x3245aa(0x13b));class TelegramBotService{constructor(){const _0x5d0fa2=a80_0x3245aa;this[_0x5d0fa2(0x180)]=null,this[_0x5d0fa2(0x117)]=process.env.TELEGRAM_BOT_TOKEN||'',this[_0x5d0fa2(0x113)]=process.env.TELEGRAM_BOT_USERNAME||_0x5d0fa2(0x18c),this[_0x5d0fa2(0x117)]?this[_0x5d0fa2(0x132)]():console[_0x5d0fa2(0x135)](_0x5d0fa2(0x112));}[a80_0x3245aa(0x132)](){const _0x353a95=a80_0x3245aa;try{this['bot']=new node_telegram_bot_api_1[(_0x353a95(0x12f))](this[_0x353a95(0x117)],{'polling':!![]}),this[_0x353a95(0x168)](),console[_0x353a95(0x164)](_0x353a95(0x126)+this[_0x353a95(0x113)]+_0x353a95(0x19b));}catch(_0x3450ae){console[_0x353a95(0x16e)]('âŒ\x20Failed\x20to\x20initialize\x20Telegram\x20bot:',_0x3450ae);}}[a80_0x3245aa(0x168)](){const _0x4d349c=a80_0x3245aa;if(!this[_0x4d349c(0x180)])return;this['bot'][_0x4d349c(0x120)](/\/start/,async _0x566a5d=>{const _0x45dd84=_0x4d349c,_0x34d81a=_0x566a5d[_0x45dd84(0x1a7)]['id'],_0x30e800=_0x566a5d[_0x45dd84(0x116)]?.['id'][_0x45dd84(0xd4)](),_0x55bfab=_0x566a5d[_0x45dd84(0x116)]?.[_0x45dd84(0x1ad)],_0x55d17a=_0x566a5d[_0x45dd84(0x116)]?.[_0x45dd84(0x189)],_0x5c5be6=_0x566a5d[_0x45dd84(0x116)]?.[_0x45dd84(0x157)];if(!_0x30e800)return;try{let _0x43aa60=await database_1['default'][_0x45dd84(0xee)]['findUnique']({'where':{'telegramId':_0x30e800},'include':{'shop':!![]}});!_0x43aa60?(_0x43aa60=await database_1[_0x45dd84(0x12f)]['telegramUser'][_0x45dd84(0x176)]({'data':{'telegramId':_0x30e800,'username':_0x55bfab,'firstName':_0x55d17a,'lastName':_0x5c5be6,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console['log'](_0x45dd84(0xdb)+_0x30e800+_0x45dd84(0x17f)+_0x55bfab+')')):_0x43aa60=await database_1[_0x45dd84(0x12f)][_0x45dd84(0xee)][_0x45dd84(0x1c5)]({'where':{'telegramId':_0x30e800},'data':{'username':_0x55bfab,'firstName':_0x55d17a,'lastName':_0x5c5be6},'include':{'shop':!![]}}),_0x43aa60[_0x45dd84(0x140)]&&_0x43aa60[_0x45dd84(0x123)]&&_0x43aa60[_0x45dd84(0xe6)]?await this[_0x45dd84(0x180)]?.[_0x45dd84(0x1b0)](_0x34d81a,_0x45dd84(0x10c)+(_0x45dd84(0xc7)+_0x43aa60[_0x45dd84(0xe6)][_0x45dd84(0x17e)]+'*\x0a')+('Username:\x20`'+_0x43aa60['shop'][_0x45dd84(0x1ad)]+_0x45dd84(0x142))+'ğŸ””\x20You\x20receive\x20notifications\x20about:\x0a'+_0x45dd84(0x1a5)+_0x45dd84(0xef)+_0x45dd84(0x1b9)+_0x45dd84(0xc9)+_0x45dd84(0x15d)+'/disconnect\x20-\x20disconnect\x20from\x20notifications',{'parse_mode':'Markdown'}):(_0x43aa60[_0x45dd84(0x123)]&&!_0x43aa60['isVerified']&&(await database_1['default']['telegramUser'][_0x45dd84(0x1c5)]({'where':{'telegramId':_0x30e800},'data':{'shopId':null,'isVerified':![]}}),console[_0x45dd84(0x164)](_0x45dd84(0x1bb)+_0x30e800)),await this[_0x45dd84(0x180)]?.[_0x45dd84(0x1b0)](_0x34d81a,_0x45dd84(0x169)+_0x45dd84(0x12d)+_0x45dd84(0x1a6)+'Example:\x0a'+_0x45dd84(0x198)+_0x45dd84(0xf9),{'parse_mode':_0x45dd84(0x133)}));}catch(_0x3f3d72){console['error'](_0x45dd84(0xe3),_0x3f3d72),await this[_0x45dd84(0x180)]?.[_0x45dd84(0x1b0)](_0x34d81a,_0x45dd84(0x16b));}}),this['bot'][_0x4d349c(0x120)](/\/disconnect/,async _0x4dc224=>{const _0x3bd515=_0x4d349c,_0x37a972=_0x4dc224['chat']['id'],_0xe4899d=_0x4dc224[_0x3bd515(0x116)]?.['id']['toString']();if(!_0xe4899d)return;try{const _0x1e2c70=await database_1[_0x3bd515(0x12f)][_0x3bd515(0xee)][_0x3bd515(0xdc)]({'where':{'telegramId':_0xe4899d},'include':{'shop':!![]}});if(!_0x1e2c70||!_0x1e2c70[_0x3bd515(0x140)]||!_0x1e2c70[_0x3bd515(0x123)]){await this[_0x3bd515(0x180)]?.[_0x3bd515(0x1b0)](_0x37a972,_0x3bd515(0x1a8));return;}const _0x2f7b2c=_0x1e2c70[_0x3bd515(0xe6)]?.['name']||_0x3bd515(0x10b);await database_1[_0x3bd515(0x12f)][_0x3bd515(0xee)][_0x3bd515(0x1c5)]({'where':{'telegramId':_0xe4899d},'data':{'shopId':null,'isVerified':![]}}),console[_0x3bd515(0x164)](_0x3bd515(0x15f)+_0xe4899d+_0x3bd515(0x1a9)+_0x1e2c70['shopId']),await this[_0x3bd515(0x180)]?.[_0x3bd515(0x1b0)](_0x37a972,'âœ…\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*'+_0x2f7b2c+'*.\x0a\x0a'+'To\x20reconnect,\x20use\x20the\x20/start\x20command',{'parse_mode':_0x3bd515(0x133)});}catch(_0x33e507){console['error']('Error\x20handling\x20/disconnect\x20command:',_0x33e507),await this[_0x3bd515(0x180)]?.['sendMessage'](_0x37a972,'âŒ\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this['bot'][_0x4d349c(0x120)](/\/status/,async _0x5887bd=>{const _0x57356f=_0x4d349c,_0x56fb25=_0x5887bd[_0x57356f(0x1a7)]['id'],_0x55dc17=_0x5887bd[_0x57356f(0x116)]?.['id'][_0x57356f(0xd4)]();if(!_0x55dc17)return;try{const _0x46844b=await database_1[_0x57356f(0x12f)][_0x57356f(0xee)]['findUnique']({'where':{'telegramId':_0x55dc17},'include':{'shop':!![]}});if(!_0x46844b){await this['bot']?.[_0x57356f(0x1b0)](_0x56fb25,_0x57356f(0x105)+_0x57356f(0x187));return;}if(!_0x46844b[_0x57356f(0x140)]||!_0x46844b[_0x57356f(0x123)]||!_0x46844b['shop']){await this[_0x57356f(0x180)]?.[_0x57356f(0x1b0)](_0x56fb25,_0x57356f(0x115)+'Use\x20/start\x20to\x20connect.');return;}await this[_0x57356f(0x180)]?.[_0x57356f(0x1b0)](_0x56fb25,_0x57356f(0x1ae)+('âœ…\x20Connected\x20to\x20shop:\x20*'+_0x46844b['shop'][_0x57356f(0x17e)]+'*\x0a')+(_0x57356f(0x160)+_0x46844b['shop'][_0x57356f(0x1ad)]+'`\x0a')+(_0x57356f(0xe9)+_0x46844b[_0x57356f(0x14b)]['toLocaleDateString'](_0x57356f(0x179))+'\x0a\x0a')+_0x57356f(0xce)+'Commands:\x0a'+_0x57356f(0x16d),{'parse_mode':_0x57356f(0x133)});}catch(_0x14a822){console[_0x57356f(0x16e)](_0x57356f(0xf2),_0x14a822),await this[_0x57356f(0x180)]?.[_0x57356f(0x1b0)](_0x56fb25,_0x57356f(0x16b));}}),this[_0x4d349c(0x180)][_0x4d349c(0x120)](/\/debug/,async _0x3a4ed8=>{const _0x10dfda=_0x4d349c,_0x513aa1=_0x3a4ed8['chat']['id'],_0x420f94=_0x3a4ed8[_0x10dfda(0x116)]?.['id']['toString']();if(!_0x420f94)return;try{const _0x1bf7a2=await database_1[_0x10dfda(0x12f)][_0x10dfda(0xee)]['findUnique']({'where':{'telegramId':_0x420f94},'include':{'shop':!![]}});let _0x1ac5ee='ğŸ”\x20*Debug\x20Information*\x0a\x0a';_0x1ac5ee+='ğŸ“±\x20Your\x20Telegram\x20ID:\x20`'+_0x420f94+_0x10dfda(0x142),_0x1bf7a2?.[_0x10dfda(0x140)]&&_0x1bf7a2['shop']?(_0x1ac5ee+='ğŸª\x20Your\x20connected\x20shop:\x0a',_0x1ac5ee+=_0x10dfda(0x15e)+_0x1bf7a2[_0x10dfda(0xe6)][_0x10dfda(0x17e)]+'*\x0a',_0x1ac5ee+=_0x10dfda(0x119)+_0x1bf7a2[_0x10dfda(0xe6)][_0x10dfda(0x1ad)]+'`\x0a',_0x1ac5ee+='\x20\x20\x20Status:\x20'+_0x1bf7a2[_0x10dfda(0xe6)][_0x10dfda(0x14a)]+'\x0a\x0a'):_0x1ac5ee+=_0x10dfda(0xcf),_0x1ac5ee+=_0x10dfda(0x125),await this[_0x10dfda(0x180)]?.[_0x10dfda(0x1b0)](_0x513aa1,_0x1ac5ee,{'parse_mode':_0x10dfda(0x133)});}catch(_0x1312d8){console[_0x10dfda(0x16e)](_0x10dfda(0x172),_0x1312d8),await this[_0x10dfda(0x180)]?.[_0x10dfda(0x1b0)](_0x513aa1,_0x10dfda(0x18b));}}),this['bot']['on'](_0x4d349c(0xff),async _0x175b3e=>{const _0x4920a8=_0x4d349c;if(_0x175b3e[_0x4920a8(0x137)]?.['startsWith']('/'))return;const _0x36ffcd=_0x175b3e[_0x4920a8(0x1a7)]['id'],_0x5058b6=_0x175b3e[_0x4920a8(0x116)]?.['id']['toString'](),_0xf61525=_0x175b3e['text']?.[_0x4920a8(0x182)]();if(!_0x5058b6||!_0xf61525)return;try{const _0x413a80=await database_1['default']['telegramUser'][_0x4920a8(0xdc)]({'where':{'telegramId':_0x5058b6},'include':{'shop':!![]}});if(!_0x413a80){await this[_0x4920a8(0x180)]?.[_0x4920a8(0x1b0)](_0x36ffcd,'âŒ\x20Please\x20use\x20/start\x20command\x20first');return;}if(_0x413a80[_0x4920a8(0x140)]&&_0x413a80[_0x4920a8(0x123)]&&_0x413a80['shop']){await this[_0x4920a8(0x180)]?.[_0x4920a8(0x1b0)](_0x36ffcd,_0x4920a8(0x130)+_0x413a80[_0x4920a8(0xe6)][_0x4920a8(0x17e)]+_0x4920a8(0x15c)+'Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.',{'parse_mode':_0x4920a8(0x133)});return;}const _0x1d0d64=_0xf61525['split'](/\s+/);if(_0x1d0d64[_0x4920a8(0x162)]!==0x2){await this['bot']?.[_0x4920a8(0x1b0)](_0x36ffcd,_0x4920a8(0x10a)+'ğŸ“\x20Format:\x20`username\x20api_key`\x0a\x0a'+_0x4920a8(0x124)+_0x4920a8(0x198)+(_0x4920a8(0x19d)+_0x1d0d64['length']+_0x4920a8(0x1bf)+_0x1d0d64['map'](_0x165a07=>'`'+_0x165a07+'`')[_0x4920a8(0xd9)](',\x20')),{'parse_mode':'Markdown'});return;}const [_0x2eb199,_0xbdc555]=_0x1d0d64;console[_0x4920a8(0x164)](_0x4920a8(0x196)+_0x5058b6+_0x4920a8(0xfa)+_0x2eb199+_0x4920a8(0x1c3)+_0xbdc555[_0x4920a8(0xed)](0x0,0xa)+_0x4920a8(0x17d)),await this[_0x4920a8(0x100)](_0x36ffcd,_0x5058b6,_0x2eb199,_0xbdc555);}catch(_0x383fe7){console[_0x4920a8(0x16e)](_0x4920a8(0x110),_0x383fe7),await this[_0x4920a8(0x180)]?.[_0x4920a8(0x1b0)](_0x36ffcd,_0x4920a8(0x16b));}}),this[_0x4d349c(0x180)]['on']('error',_0x47f6d6=>{const _0x5aeda3=_0x4d349c;console['error'](_0x5aeda3(0x158),_0x47f6d6);}),this[_0x4d349c(0x180)]['on'](_0x4d349c(0x1b3),_0x2f0d87=>{console['error']('Telegram\x20bot\x20polling\x20error:',_0x2f0d87);});}async['handleSingleLineVerification'](_0x145751,_0x2e31cf,_0x3f3e9c,_0x7b810f){const _0x50524f=a80_0x3245aa;try{console[_0x50524f(0x164)](_0x50524f(0x196)+_0x2e31cf+_0x50524f(0xfa)+_0x3f3e9c+'\x22,\x20apiKey=\x22'+_0x7b810f[_0x50524f(0xed)](0x0,0xa)+_0x50524f(0x17d));if(!_0x3f3e9c||_0x3f3e9c['length']<0x3||_0x3f3e9c[_0x50524f(0x162)]>0x32||!/^[a-zA-Z0-9_]+$/[_0x50524f(0xd5)](_0x3f3e9c)){await this[_0x50524f(0x180)]?.[_0x50524f(0x1b0)](_0x145751,_0x50524f(0xfb)+_0x3f3e9c+_0x50524f(0x142)+'Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).',{'parse_mode':'Markdown'});return;}if(!_0x7b810f||!_0x7b810f['startsWith'](_0x50524f(0x14e))&&!_0x7b810f[_0x50524f(0x1a4)](_0x50524f(0x1bd))){await this[_0x50524f(0x180)]?.[_0x50524f(0x1b0)](_0x145751,_0x50524f(0x194)+_0x50524f(0x15a),{'parse_mode':_0x50524f(0x133)});return;}const _0x4b87d3=await database_1[_0x50524f(0x12f)][_0x50524f(0xe6)][_0x50524f(0xdc)]({'where':{'username':_0x3f3e9c},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x4b87d3){const _0x40e8fc=_0x50524f(0x1a1)+_0x3f3e9c+_0x50524f(0xe2)+_0x50524f(0xe5)+_0x50524f(0x184);await this[_0x50524f(0x180)]?.[_0x50524f(0x1b0)](_0x145751,_0x40e8fc,{'parse_mode':_0x50524f(0x133)});return;}if(_0x4b87d3[_0x50524f(0x14a)]!=='ACTIVE'){await this[_0x50524f(0x180)]?.[_0x50524f(0x1b0)](_0x145751,_0x50524f(0x146)+_0x3f3e9c+_0x50524f(0x1c0)+_0x50524f(0x10f),{'parse_mode':_0x50524f(0x133)});return;}if(_0x4b87d3[_0x50524f(0x165)]!==_0x7b810f&&_0x4b87d3['secretKey']!==_0x7b810f){await this['bot']?.[_0x50524f(0x1b0)](_0x145751,_0x50524f(0xeb)+_0x3f3e9c+_0x50524f(0x13e)+_0x50524f(0x102)+'Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`',{'parse_mode':'Markdown'});return;}const _0x56ccdc=await database_1[_0x50524f(0x12f)]['telegramUser']['findFirst']({'where':{'shopId':_0x4b87d3['id'],'isVerified':!![],'telegramId':{'not':_0x2e31cf}}});if(_0x56ccdc){await this[_0x50524f(0x180)]?.[_0x50524f(0x1b0)](_0x145751,_0x50524f(0x12e)+_0x3f3e9c+_0x50524f(0x13e)+_0x50524f(0x128),{'parse_mode':_0x50524f(0x133)});return;}await database_1['default']['telegramUser'][_0x50524f(0x1c5)]({'where':{'telegramId':_0x2e31cf},'data':{'shopId':_0x4b87d3['id'],'isVerified':!![]}}),await this[_0x50524f(0x180)]?.[_0x50524f(0x1b0)](_0x145751,_0x50524f(0x13f)+_0x50524f(0x12a)+(_0x50524f(0x16f)+_0x4b87d3[_0x50524f(0x17e)]+'*\x0a')+(_0x50524f(0x160)+_0x4b87d3[_0x50524f(0x1ad)]+_0x50524f(0x142))+_0x50524f(0x1b8)+'â€¢\x20New\x20payments\x0a'+_0x50524f(0xef)+_0x50524f(0x183)+_0x50524f(0x1aa)+'Commands:\x0a'+'/status\x20-\x20check\x20connection\x20status\x0a'+_0x50524f(0x16d),{'parse_mode':_0x50524f(0x133)}),console[_0x50524f(0x164)](_0x50524f(0x12b)+_0x2e31cf+_0x50524f(0x1ba)+_0x4b87d3[_0x50524f(0x1ad)]+'\x20via\x20single-line\x20input');}catch(_0x63f703){console[_0x50524f(0x16e)](_0x50524f(0xf8),_0x63f703),await this[_0x50524f(0x180)]?.[_0x50524f(0x1b0)](_0x145751,_0x50524f(0x129));}}async['sendShopNotification'](_0x51639f,_0x415346,_0x1836db){const _0x4ed7b7=a80_0x3245aa;if(!this[_0x4ed7b7(0x180)]){console[_0x4ed7b7(0x135)](_0x4ed7b7(0xfd));return;}try{const _0x14b242=await database_1[_0x4ed7b7(0x12f)][_0x4ed7b7(0xee)][_0x4ed7b7(0x127)]({'where':{'shopId':_0x51639f,'isVerified':!![]}});if(_0x14b242[_0x4ed7b7(0x162)]===0x0){console[_0x4ed7b7(0x164)](_0x4ed7b7(0x17c)+_0x51639f);return;}const _0xe46d7c=_0x14b242[_0x4ed7b7(0xe7)](async _0x1d88b6=>{const _0x1d509f=_0x4ed7b7;try{await this['bot']?.[_0x1d509f(0x1b0)](_0x1d88b6['telegramId'],_0x415346,_0x1836db),console[_0x1d509f(0x164)](_0x1d509f(0x151)+_0x1d88b6[_0x1d509f(0x114)]);}catch(_0xb9cd33){console[_0x1d509f(0x16e)](_0x1d509f(0x16a)+_0x1d88b6[_0x1d509f(0x114)]+':',_0xb9cd33),_0xb9cd33 instanceof Error&&(_0xb9cd33[_0x1d509f(0xff)]['includes']('blocked')||_0xb9cd33['message'][_0x1d509f(0x192)](_0x1d509f(0x106))||_0xb9cd33[_0x1d509f(0xff)][_0x1d509f(0x192)]('user\x20is\x20deactivated'))&&(await database_1[_0x1d509f(0x12f)][_0x1d509f(0xee)]['update']({'where':{'id':_0x1d88b6['id']},'data':{'isVerified':![]}}),console[_0x1d509f(0x164)](_0x1d509f(0xcc)+_0x1d88b6[_0x1d509f(0x114)]+_0x1d509f(0x11a)));}});await Promise[_0x4ed7b7(0x178)](_0xe46d7c);}catch(_0x123a9e){console[_0x4ed7b7(0x16e)](_0x4ed7b7(0x1b4),_0x123a9e);}}async[a80_0x3245aa(0x138)](_0x1818af,_0x3f7ea3,_0x5d3ffc){const _0x1960c3=a80_0x3245aa,_0x2e13e0={'created':'ğŸ†•','paid':'âœ…','failed':'âŒ','expired':'â°','refund':'ğŸ”„','chargeback':'âš ï¸','processing':'âš™ï¸'},_0x34725f={'created':_0x1960c3(0x18f),'paid':_0x1960c3(0x11c),'failed':'Payment\x20failed','expired':_0x1960c3(0x156),'refund':'Payment\x20refund','chargeback':_0x1960c3(0x139),'processing':_0x1960c3(0xe0)},_0x46989b=_0x2e13e0[_0x5d3ffc],_0x573c3a=_0x34725f[_0x5d3ffc],_0x5f27ba=(0x0,gateway_1[_0x1960c3(0xe8)])(_0x3f7ea3[_0x1960c3(0x1c4)]);console['log']('ğŸ“±\x20Telegram\x20notification:\x20gateway\x20\x22'+_0x3f7ea3[_0x1960c3(0x1c4)]+_0x1960c3(0x13c)+_0x5f27ba+'\x22');let _0x2e6308=_0x46989b+'\x20*'+_0x573c3a+_0x1960c3(0x11d)+(_0x1960c3(0xf7)+_0x3f7ea3[_0x1960c3(0x111)]+'\x20'+_0x3f7ea3[_0x1960c3(0x104)]+'*\x0a')+('ğŸ“\x20Order\x20ID:\x20`'+(_0x3f7ea3[_0x1960c3(0x16c)]||_0x3f7ea3['id'])+'`\x0a')+('ğŸ†”\x20Payment\x20ID:\x20`'+_0x3f7ea3['id']+'`\x0a')+(_0x1960c3(0x11f)+_0x5f27ba+'`\x0a')+(_0x1960c3(0x131)+new Date(_0x3f7ea3['createdAt'])[_0x1960c3(0xcb)](_0x1960c3(0x179))+'\x0a');if(_0x3f7ea3['customerName']||_0x3f7ea3[_0x1960c3(0x150)]||_0x3f7ea3[_0x1960c3(0xd7)]||_0x3f7ea3[_0x1960c3(0x109)]||_0x3f7ea3['customerUa']){_0x2e6308+=_0x1960c3(0x161);_0x3f7ea3['customerName']&&(_0x2e6308+='ğŸ“›\x20Name:\x20`'+_0x3f7ea3['customerName']+'`\x0a');_0x3f7ea3['customerEmail']&&(_0x2e6308+=_0x1960c3(0x108)+_0x3f7ea3['customerEmail']+'`\x0a');_0x3f7ea3[_0x1960c3(0xd7)]&&(_0x2e6308+=_0x1960c3(0x141)+_0x3f7ea3[_0x1960c3(0xd7)]+'`\x0a');_0x3f7ea3['customerIp']&&(_0x2e6308+=_0x1960c3(0x188)+_0x3f7ea3[_0x1960c3(0x109)]+'`\x0a');if(_0x3f7ea3[_0x1960c3(0x173)]){const _0x5d0cd1=_0x3f7ea3[_0x1960c3(0x173)]['length']>0x32?_0x3f7ea3[_0x1960c3(0x173)][_0x1960c3(0xed)](0x0,0x32)+_0x1960c3(0xea):_0x3f7ea3['customerUa'];_0x2e6308+='ğŸ’»\x20Browser:\x20`'+_0x5d0cd1+'`\x0a';}}_0x5d3ffc==='chargeback'&&_0x3f7ea3['chargebackAmount']&&(_0x2e6308+=_0x1960c3(0x19c)+_0x3f7ea3[_0x1960c3(0x181)]+'\x20USDT*\x0a'),_0x5d3ffc===_0x1960c3(0xca)&&(_0x2e6308+='â³\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a'),_0x3f7ea3[_0x1960c3(0xf6)]&&(_0x2e6308+=_0x1960c3(0x12c)+_0x3f7ea3[_0x1960c3(0xf6)]+'\x0a'),await this[_0x1960c3(0x166)](_0x1818af,_0x2e6308,{'parse_mode':_0x1960c3(0x133)});}async[a80_0x3245aa(0x18e)](_0x3d0000,_0x22498a){const _0x79625e=a80_0x3245aa,_0x2e9799=new Date(_0x22498a['createdAt'])[_0x79625e(0xcb)]('en-US',{'year':_0x79625e(0xda),'month':_0x79625e(0x107),'day':'2-digit','hour':'2-digit','minute':_0x79625e(0x107),'second':'2-digit'}),_0x20482c=_0x79625e(0x1bc)+(_0x79625e(0x1c1)+_0x2e9799+'\x0a')+(_0x79625e(0xe1)+_0x22498a[_0x79625e(0x111)]+_0x79625e(0xf5))+(_0x79625e(0x17a)+(_0x22498a[_0x79625e(0x167)]||'Not\x20specified')+'\x0a')+(_0x79625e(0x1be)+(_0x22498a[_0x79625e(0x14c)]||_0x79625e(0x195))+'\x0a')+(_0x79625e(0x1b2)+(_0x22498a[_0x79625e(0xdd)]||'Not\x20specified')+'`\x0a')+(_0x22498a['txid']?'ğŸ”—\x20*Transaction\x20Link:*\x20`'+_0x22498a[_0x79625e(0x148)]+'`':_0x79625e(0x136));await this[_0x79625e(0x166)](_0x3d0000,_0x20482c,{'parse_mode':_0x79625e(0x133)});}async[a80_0x3245aa(0x190)](_0x1e2645,_0x2a9b52){const _0x42e89f=a80_0x3245aa;try{const _0x42762a=await database_1[_0x42e89f(0x12f)][_0x42e89f(0x177)][_0x42e89f(0xdc)]({'where':{'shopId':_0x1e2645},'select':{'notificationLogin':!![]}});if(!_0x42762a?.[_0x42e89f(0xc6)]){console['log'](_0x42e89f(0xd2)+_0x1e2645);return;}const _0xf81231=_0x2a9b52[_0x42e89f(0x13a)]?'ğŸ”':'ğŸš¨',_0x30f060=_0x2a9b52[_0x42e89f(0x13a)]?_0x42e89f(0x1a0):_0x42e89f(0x1a2);let _0x42e86c=_0xf81231+'\x20*'+_0x30f060+_0x42e89f(0x11d)+(_0x42e89f(0x160)+_0x2a9b52[_0x42e89f(0x1ad)]+'`\x0a')+(_0x42e89f(0x18d)+_0x2a9b52[_0x42e89f(0xd8)][_0x42e89f(0xcb)](_0x42e89f(0x179))+'\x0a');_0x2a9b52[_0x42e89f(0x1b5)]&&(_0x42e86c+=_0x42e89f(0x13d)+_0x2a9b52[_0x42e89f(0x1b5)]+'`\x0a');_0x2a9b52[_0x42e89f(0xd3)]&&(_0x42e86c+=_0x42e89f(0x1b6)+_0x2a9b52[_0x42e89f(0xd3)]+'\x0a');if(_0x2a9b52[_0x42e89f(0x199)]){const _0x4127ca=_0x2a9b52[_0x42e89f(0x199)][_0x42e89f(0x162)]>0x32?_0x2a9b52[_0x42e89f(0x199)][_0x42e89f(0xed)](0x0,0x32)+_0x42e89f(0xea):_0x2a9b52[_0x42e89f(0x199)];_0x42e86c+='ğŸ’»\x20Browser:\x20`'+_0x4127ca+'`\x0a';}!_0x2a9b52[_0x42e89f(0x13a)]&&(_0x42e86c+='\x0aâš ï¸\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!'),await this[_0x42e89f(0x166)](_0x1e2645,_0x42e86c,{'parse_mode':_0x42e89f(0x133)}),console[_0x42e89f(0x164)]('âœ…\x20Login\x20notification\x20sent\x20for\x20shop\x20'+_0x1e2645+':\x20'+(_0x2a9b52[_0x42e89f(0x13a)]?_0x42e89f(0x13a):_0x42e89f(0xd0)));}catch(_0x1c43c1){console[_0x42e89f(0x16e)](_0x42e89f(0x101),_0x1c43c1);}}async[a80_0x3245aa(0x153)](_0x3dbf84,_0x49d9df){const _0x38f511=a80_0x3245aa;try{const _0xf33a63=await database_1['default'][_0x38f511(0x177)][_0x38f511(0xdc)]({'where':{'shopId':_0x3dbf84},'select':{'notificationApiError':!![]}});if(!_0xf33a63?.[_0x38f511(0xfe)]){console[_0x38f511(0x164)]('ğŸ“±\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20'+_0x3dbf84);return;}let _0x5f4290=_0x38f511(0xf3)+(_0x38f511(0x103)+_0x49d9df[_0x38f511(0x186)]+'\x20'+_0x49d9df[_0x38f511(0xc8)]+'`\x0a')+('ğŸ“…\x20Time:\x20'+_0x49d9df[_0x38f511(0xd8)][_0x38f511(0xcb)](_0x38f511(0x179))+'\x0a');_0x49d9df[_0x38f511(0x134)]&&(_0x5f4290+=_0x38f511(0x1c2)+_0x49d9df[_0x38f511(0x134)]+'`\x0a'),_0x5f4290+=_0x38f511(0x145)+_0x49d9df[_0x38f511(0xe4)]+'`\x0a',_0x49d9df[_0x38f511(0xfc)]&&(_0x5f4290+=_0x38f511(0xcd)+_0x49d9df[_0x38f511(0xfc)]+'`\x0a'),_0x5f4290+=_0x38f511(0x185),await this[_0x38f511(0x166)](_0x3dbf84,_0x5f4290,{'parse_mode':_0x38f511(0x133)}),console['log'](_0x38f511(0xdf)+_0x3dbf84+':\x20'+_0x49d9df[_0x38f511(0xc8)]);}catch(_0xd47d65){console['error'](_0x38f511(0x1ac),_0xd47d65);}}async[a80_0x3245aa(0x19f)](_0x4e53fc,_0x339b40,_0x1ff99c){const _0x310479=a80_0x3245aa;let _0x207060=_0x310479(0x155)+_0x339b40+_0x310479(0x11d);for(const [_0x1c2025,_0x4fba93]of Object['entries'](_0x1ff99c)){_0x4fba93!==null&&_0x4fba93!==undefined&&(_0x207060+=_0x1c2025+':\x20`'+_0x4fba93+'`\x0a');}await this['sendShopNotification'](_0x4e53fc,_0x207060,{'parse_mode':_0x310479(0x133)});}async['sendNotificationToAll'](_0x37b984){const _0x195700=a80_0x3245aa;try{console['log'](_0x195700(0x152)+_0x37b984[_0x195700(0xed)](0x0,0x32)+_0x195700(0xea));const _0x2735c9=await database_1[_0x195700(0x12f)]['telegramUser'][_0x195700(0x127)]({'select':{'telegramId':!![]}});if(_0x2735c9[_0x195700(0x162)]===0x0){console[_0x195700(0x164)](_0x195700(0x1c6));return;}for(const _0x3d2866 of _0x2735c9){try{await this[_0x195700(0x180)]?.[_0x195700(0x1b0)](_0x3d2866['telegramId'],_0x37b984,{'parse_mode':_0x195700(0x133)});}catch(_0x3603ce){console[_0x195700(0x16e)](_0x195700(0x19e)+_0x3d2866['telegramId']+':',_0x3603ce);}}console[_0x195700(0x164)](_0x195700(0x1b7)+_0x2735c9['length']+_0x195700(0x154));}catch(_0x321563){console[_0x195700(0x16e)]('âŒ\x20Failed\x20to\x20send\x20notification\x20to\x20all\x20users:',_0x321563);}}['getBotInfo'](){const _0x3a9231=a80_0x3245aa;return{'isActive':!!this[_0x3a9231(0x180)],'username':this[_0x3a9231(0x113)]};}async[a80_0x3245aa(0xd6)](_0x3198e5,_0x5d7ac1,_0x46457a,_0x459ecc){const _0x52d1d3=a80_0x3245aa;try{if(!this[_0x52d1d3(0x180)])return console[_0x52d1d3(0x16e)](_0x52d1d3(0x159)),![];const _0x478388=await database_1['default'][_0x52d1d3(0xee)][_0x52d1d3(0x127)]({'where':{'shopId':_0x3198e5,'isVerified':!![]},'select':{'telegramId':!![]}});if(_0x478388[_0x52d1d3(0x162)]===0x0)return console[_0x52d1d3(0x16e)](_0x52d1d3(0x147)+_0x3198e5),![];let _0x27cefc=0x0;for(const _0x5ce06e of _0x478388){try{await this[_0x52d1d3(0x180)][_0x52d1d3(0x163)](_0x5ce06e[_0x52d1d3(0x114)],_0x5d7ac1,{},{'filename':_0x46457a,'contentType':_0x46457a[_0x52d1d3(0xf4)]('.png')?_0x52d1d3(0x174):_0x46457a[_0x52d1d3(0xf4)]('.jpg')||_0x46457a['endsWith'](_0x52d1d3(0x14d))?_0x52d1d3(0x170):_0x46457a[_0x52d1d3(0xf4)](_0x52d1d3(0x118))?'application/pdf':_0x52d1d3(0x143)}),_0x459ecc&&await this[_0x52d1d3(0x180)]['sendMessage'](_0x5ce06e[_0x52d1d3(0x114)],_0x459ecc),_0x27cefc++;}catch(_0xca5b69){console[_0x52d1d3(0x16e)]('âŒ\x20Error\x20sending\x20file\x20to\x20user\x20'+_0x5ce06e[_0x52d1d3(0x114)]+':',_0xca5b69);}}return console[_0x52d1d3(0x164)](_0x52d1d3(0x191)+_0x27cefc+'/'+_0x478388['length']+_0x52d1d3(0xf1)+_0x3198e5+':\x20'+_0x46457a),_0x27cefc>0x0;}catch(_0xfdc2b5){return console['error'](_0x52d1d3(0x144),_0xfdc2b5),![];}}async[a80_0x3245aa(0x19a)](_0x3f6795,_0x231eb0){const _0x3e75e9=a80_0x3245aa;try{if(!this[_0x3e75e9(0x180)])return console[_0x3e75e9(0x16e)](_0x3e75e9(0x159)),![];return await this[_0x3e75e9(0x180)]['sendMessage'](_0x3f6795,_0x231eb0),console[_0x3e75e9(0x164)](_0x3e75e9(0x197)+_0x3f6795),!![];}catch(_0x1de2de){return console[_0x3e75e9(0x16e)](_0x3e75e9(0x171),_0x1de2de),![];}}async[a80_0x3245aa(0xd1)](_0x143ffa,_0x389f78,_0x1393ea,_0x2f9ed2){const _0x2f271d=a80_0x3245aa;try{if(!this['bot'])return console[_0x2f271d(0x16e)]('âŒ\x20Telegram\x20bot\x20not\x20initialized'),![];return await this[_0x2f271d(0x180)][_0x2f271d(0x163)](_0x143ffa,_0x389f78,{},{'filename':_0x1393ea,'contentType':_0x1393ea[_0x2f271d(0xf4)](_0x2f271d(0x17b))?_0x2f271d(0x174):_0x1393ea[_0x2f271d(0xf4)](_0x2f271d(0x10e))||_0x1393ea['endsWith'](_0x2f271d(0x14d))?_0x2f271d(0x170):_0x1393ea['endsWith'](_0x2f271d(0x118))?_0x2f271d(0x193):'application/octet-stream'}),_0x2f9ed2&&await this[_0x2f271d(0x180)]['sendMessage'](_0x143ffa,_0x2f9ed2),console[_0x2f271d(0x164)](_0x2f271d(0x11b)+_0x143ffa+':\x20'+_0x1393ea),!![];}catch(_0x558d6e){return console['error']('âŒ\x20Error\x20sending\x20file\x20to\x20chat:',_0x558d6e),![];}}['stopBot'](){const _0x5b9a7c=a80_0x3245aa;this['bot']&&(this[_0x5b9a7c(0x180)][_0x5b9a7c(0x14f)](),this[_0x5b9a7c(0x180)]=null,console[_0x5b9a7c(0x164)]('ğŸ›‘\x20Telegram\x20bot\x20stopped'));}}function a80_0x5292(_0x3fa0be,_0x32dec6){_0x3fa0be=_0x3fa0be-0xc6;const _0xab0836=a80_0xab08();let _0x52928a=_0xab0836[_0x3fa0be];return _0x52928a;}exports['TelegramBotService']=TelegramBotService,exports[a80_0x3245aa(0x10d)]=new TelegramBotService();function a80_0xab08(){const _0x57e080=['adminNotes','ğŸ’°\x20Amount:\x20*','Error\x20in\x20handleSingleLineVerification:','â—ï¸\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!',':\x20username=\x22','âŒ\x20Invalid\x20username\x20format:\x20`','requestId','Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification','notificationApiError','message','handleSingleLineVerification','Failed\x20to\x20send\x20login\x20notification:','Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a','ğŸ”—\x20Endpoint:\x20`','currency','âŒ\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a','chat\x20not\x20found','2-digit','ğŸ“§\x20Email:\x20`','customerIp','âŒ\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a','unknown\x20shop','âœ…\x20Welcome\x20back!\x0a\x0a','telegramBotService','.jpg','Contact\x20administrator.','Error\x20handling\x20message:','amount','TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables','botUsername','telegramId','âŒ\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a','from','botToken','.pdf','\x20\x20\x20Username:\x20`','\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure','âœ…\x20File\x20sent\x20to\x20chat\x20','Payment\x20successfully\x20paid','*\x0a\x0a','118562kvcxHC','ğŸª\x20Gateway:\x20`','onText','4861480cSouAl','39LKscbC','shopId','Example:\x0a','Use\x20/start\x20to\x20connect\x20to\x20a\x20shop.','âœ…\x20Telegram\x20bot\x20@','findMany','Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.','âŒ\x20An\x20error\x20occurred\x20while\x20verifying\x20data.','âœ…\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a','âœ…\x20Telegram\x20user\x20','ğŸ“\x20Notes:\x20','To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a','âŒ\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`','default','âœ…\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*','ğŸ“…\x20Date:\x20','initializeBot','Markdown','statusCode','warn','ğŸ”—\x20*Transaction\x20Link:*\x20Pending','text','sendPaymentNotification','Payment\x20chargeback','success','../types/gateway','\x22\x20->\x20display\x20\x22','ğŸŒ\x20IP\x20address:\x20`','`.\x0a\x0a','ğŸ‰\x20*Congratulations!*\x0a\x0a','isVerified','ğŸ¦\x20IBAN:\x20`','`\x0a\x0a','application/octet-stream','âŒ\x20Error\x20sending\x20file\x20to\x20shop:','âŒ\x20Error:\x20`','âŒ\x20Shop\x20`','âŒ\x20No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20ID:\x20','txid','8750328KDBppX','status','updatedAt','network','.jpeg','pk_','stopPolling','customerEmail','âœ…\x20Notification\x20sent\x20to\x20Telegram\x20user\x20','ğŸ“±\x20Sending\x20notification\x20to\x20all\x20connected\x20users:\x20','sendApiErrorNotification','\x20users','ğŸ””\x20*','Payment\x20expired','last_name','Telegram\x20bot\x20error:','âŒ\x20Telegram\x20bot\x20not\x20initialized','API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','TelegramBotService','*.\x0a\x0a','/status\x20-\x20check\x20connection\x20status\x0a','\x20\x20\x20Name:\x20*','ğŸ”Œ\x20User\x20','ğŸ‘¤\x20Username:\x20`','\x0ağŸ‘¤\x20*Customer\x20Information:*\x0a','length','sendDocument','log','publicKey','sendShopNotification','period','setupBotHandlers','ğŸ¤–\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a','âŒ\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20','âŒ\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','orderId','/disconnect\x20-\x20disconnect\x20from\x20notifications','error','ğŸ“±\x20Shop:\x20*','image/jpeg','âŒ\x20Error\x20sending\x20direct\x20message:','Error\x20handling\x20/debug\x20command:','customerUa','image/png','36KHYSjh','create','shopSettings','allSettled','en-US','â±ï¸\x20*Period:*\x20','.png','No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20','...\x22','name','\x20(@','bot','chargebackAmount','trim','â€¢\x20Payouts\x0a','Make\x20sure\x20you\x20have\x20the\x20correct\x20username\x20from\x20your\x20account.','\x0ağŸ’¡\x20Check\x20your\x20request\x20or\x20contact\x20support.','method','Use\x20/start\x20to\x20begin.','ğŸŒ\x20IP:\x20`','first_name','2250388CYMjbf','âŒ\x20Error\x20getting\x20debug\x20information.','trapay_bot','ğŸ“…\x20Time:\x20','sendPayoutNotification','New\x20payment\x20created','sendLoginNotification','âœ…\x20File\x20sent\x20to\x20','includes','application/pdf','âŒ\x20Invalid\x20API\x20key\x20format.\x0a\x0a','Not\x20specified','ğŸ”„\x20Processing\x20single-line\x20verification\x20for\x20user\x20','âœ…\x20Direct\x20message\x20sent\x20to\x20chat\x20','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','userAgent','sendDirectMessage','\x20initialized\x20successfully','ğŸ’¸\x20Penalty\x20amount:\x20*','You\x20sent\x20','âŒ\x20Failed\x20to\x20send\x20message\x20to\x20user\x20','sendCustomNotification','Successful\x20login','âŒ\x20Shop\x20with\x20username\x20`','Failed\x20login\x20attempt','../config/database','startsWith','â€¢\x20New\x20payments\x0a','ğŸ“\x20Format:\x20`username\x20api_key`\x0a\x0a','chat','âŒ\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.','\x20disconnected\x20from\x20shop\x20','â€¢\x20Important\x20events\x0a\x0a','467465uTjwXB','Failed\x20to\x20send\x20API\x20error\x20notification:','username','ğŸ“Š\x20*Connection\x20Status*\x0a\x0a','__esModule','sendMessage','34297119KnwfMo','ğŸ’³\x20*Wallet:*\x20`','polling_error','Error\x20sending\x20shop\x20notification:','ipAddress','ğŸŒ\x20Country:\x20','ğŸ“±\x20Notification\x20sent\x20to\x20','ğŸ””\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a','â€¢\x20Payouts\x0a\x0a','\x20verified\x20for\x20shop\x20','ğŸ”„\x20Reset\x20incomplete\x20verification\x20for\x20user\x20','ğŸ’¸\x20*New\x20Payout*\x0a\x0a','sk_','ğŸŒ\x20*Network:*\x20','\x20parts:\x20','`\x20is\x20inactive.\x0a\x0a','ğŸ“…\x20*Payout\x20Date:*\x20','ğŸ“Š\x20Error\x20code:\x20`','\x22,\x20apiKey=\x22','gateway','update','ğŸ“±\x20No\x20active\x20Telegram\x20users\x20found','notificationLogin','You\x20are\x20already\x20connected\x20to\x20shop:\x20*','endpoint','Commands:\x0a','processing','toLocaleString','User\x20','ğŸ†”\x20Request\x20ID:\x20`','ğŸ””\x20Notifications\x20are\x20active\x0a\x0a','âŒ\x20You\x20are\x20not\x20connected\x20to\x20any\x20shop.\x0a\x0a','failed','sendDirectFile','ğŸ“±\x20Login\x20notifications\x20disabled\x20for\x20shop\x20','geo','toString','test','sendShopFile','remitterIban','timestamp','join','numeric','ğŸ“±\x20Created\x20new\x20Telegram\x20user:\x20','findUnique','wallet','defineProperty','âœ…\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20','Payment\x20is\x20being\x20processed','ğŸ’°\x20*Amount:*\x20','`\x20not\x20found.\x0a\x0a','Error\x20handling\x20/start\x20command:','errorMessage','Please\x20check\x20the\x20spelling\x20and\x20try\x20again.\x0a\x0a','shop','map','getGatewayDisplayNameForTelegram','ğŸ“…\x20Connection\x20date:\x20','...','âŒ\x20API\x20key\x20does\x20not\x20match\x20shop\x20`','__importDefault','substring','telegramUser','â€¢\x20Payment\x20status\x20changes\x0a','709787aDTgsj','\x20users\x20of\x20shop\x20','Error\x20handling\x20/status\x20command:','ğŸš¨\x20*API\x20Error*\x0a\x0a','endsWith','\x20USD\x0a'];a80_0xab08=function(){return _0x57e080;};return a80_0xab08();}