'use strict';const a55_0x1043f4=a55_0x4b75;(function(_0x520a6d,_0x511658){const _0x4d0031=a55_0x4b75,_0x3099a6=_0x520a6d();while(!![]){try{const _0x492ff3=parseInt(_0x4d0031(0x1ab))/0x1+parseInt(_0x4d0031(0x210))/0x2*(parseInt(_0x4d0031(0x1ed))/0x3)+parseInt(_0x4d0031(0x1e1))/0x4+parseInt(_0x4d0031(0x20f))/0x5+-parseInt(_0x4d0031(0x145))/0x6*(-parseInt(_0x4d0031(0x1c2))/0x7)+parseInt(_0x4d0031(0x161))/0x8*(parseInt(_0x4d0031(0x1dd))/0x9)+-parseInt(_0x4d0031(0x17b))/0xa;if(_0x492ff3===_0x511658)break;else _0x3099a6['push'](_0x3099a6['shift']());}catch(_0x118a37){_0x3099a6['push'](_0x3099a6['shift']());}}}(a55_0x4904,0x5931e));var __importDefault=this&&this[a55_0x1043f4(0x1d6)]||function(_0x1eeca6){return _0x1eeca6&&_0x1eeca6['__esModule']?_0x1eeca6:{'default':_0x1eeca6};};function a55_0x4b75(_0x1f4200,_0x51fbab){const _0x490498=a55_0x4904();return a55_0x4b75=function(_0x4b758f,_0x152a03){_0x4b758f=_0x4b758f-0x142;let _0x5d9109=_0x490498[_0x4b758f];return _0x5d9109;},a55_0x4b75(_0x1f4200,_0x51fbab);}Object['defineProperty'](exports,a55_0x1043f4(0x16e),{'value':!![]}),exports[a55_0x1043f4(0x201)]=exports[a55_0x1043f4(0x17f)]=void 0x0;const node_telegram_bot_api_1=__importDefault(require(a55_0x1043f4(0x191))),database_1=__importDefault(require(a55_0x1043f4(0x204))),gateway_1=require('../types/gateway');class TelegramBotService{constructor(){const _0x3fa430=a55_0x1043f4;this[_0x3fa430(0x214)]=null,this[_0x3fa430(0x15f)]=process[_0x3fa430(0x179)][_0x3fa430(0x173)]||'',this[_0x3fa430(0x1c4)]=process[_0x3fa430(0x179)][_0x3fa430(0x1be)]||_0x3fa430(0x194),this[_0x3fa430(0x15f)]?this[_0x3fa430(0x1da)]():console[_0x3fa430(0x197)]('TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables');}[a55_0x1043f4(0x1da)](){const _0x4b0040=a55_0x1043f4;try{this[_0x4b0040(0x214)]=new node_telegram_bot_api_1[(_0x4b0040(0x211))](this[_0x4b0040(0x15f)],{'polling':!![]}),this['setupBotHandlers'](),console[_0x4b0040(0x207)]('✅\x20Telegram\x20bot\x20@'+this[_0x4b0040(0x1c4)]+_0x4b0040(0x1a3));}catch(_0x2d7e23){console[_0x4b0040(0x1c5)](_0x4b0040(0x14b),_0x2d7e23);}}[a55_0x1043f4(0x159)](){const _0x10af22=a55_0x1043f4;if(!this[_0x10af22(0x214)])return;this[_0x10af22(0x214)][_0x10af22(0x181)](/\/start/,async _0x220258=>{const _0x39a945=_0x10af22,_0x14199e=_0x220258[_0x39a945(0x19d)]['id'],_0x32e320=_0x220258[_0x39a945(0x1dc)]?.['id'][_0x39a945(0x1ff)](),_0x53c63a=_0x220258['from']?.['username'],_0x1dd647=_0x220258[_0x39a945(0x1dc)]?.[_0x39a945(0x164)],_0x4c0c7d=_0x220258[_0x39a945(0x1dc)]?.['last_name'];if(!_0x32e320)return;try{let _0x41c0c6=await database_1[_0x39a945(0x211)]['telegramUser'][_0x39a945(0x146)]({'where':{'telegramId':_0x32e320},'include':{'shop':!![]}});!_0x41c0c6?(_0x41c0c6=await database_1[_0x39a945(0x211)][_0x39a945(0x16b)]['create']({'data':{'telegramId':_0x32e320,'username':_0x53c63a,'firstName':_0x1dd647,'lastName':_0x4c0c7d,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console[_0x39a945(0x207)](_0x39a945(0x1cf)+_0x32e320+_0x39a945(0x196)+_0x53c63a+')')):_0x41c0c6=await database_1[_0x39a945(0x211)][_0x39a945(0x16b)][_0x39a945(0x172)]({'where':{'telegramId':_0x32e320},'data':{'username':_0x53c63a,'firstName':_0x1dd647,'lastName':_0x4c0c7d},'include':{'shop':!![]}}),_0x41c0c6[_0x39a945(0x19e)]&&_0x41c0c6[_0x39a945(0x1ba)]&&_0x41c0c6['shop']?await this[_0x39a945(0x214)]?.[_0x39a945(0x16a)](_0x14199e,_0x39a945(0x1cb)+(_0x39a945(0x20e)+_0x41c0c6[_0x39a945(0x1c3)][_0x39a945(0x192)]+'*\x0a')+(_0x39a945(0x18a)+_0x41c0c6[_0x39a945(0x1c3)]['username']+_0x39a945(0x222))+_0x39a945(0x17e)+'•\x20New\x20payments\x0a'+_0x39a945(0x193)+_0x39a945(0x15b)+_0x39a945(0x20a)+_0x39a945(0x153)+_0x39a945(0x17a),{'parse_mode':_0x39a945(0x1cd)}):(_0x41c0c6['shopId']&&!_0x41c0c6[_0x39a945(0x19e)]&&(await database_1[_0x39a945(0x211)][_0x39a945(0x16b)][_0x39a945(0x172)]({'where':{'telegramId':_0x32e320},'data':{'shopId':null,'isVerified':![]}}),console[_0x39a945(0x207)](_0x39a945(0x1bf)+_0x32e320)),await this[_0x39a945(0x214)]?.['sendMessage'](_0x14199e,_0x39a945(0x1a2)+_0x39a945(0x186)+_0x39a945(0x168)+_0x39a945(0x18e)+'`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a'+'❗️\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!',{'parse_mode':_0x39a945(0x1cd)}));}catch(_0x1ab972){console[_0x39a945(0x1c5)](_0x39a945(0x149),_0x1ab972),await this[_0x39a945(0x214)]?.['sendMessage'](_0x14199e,_0x39a945(0x1fa));}}),this[_0x10af22(0x214)]['onText'](/\/disconnect/,async _0x32bcf6=>{const _0x59dd8b=_0x10af22,_0x5ca1e5=_0x32bcf6['chat']['id'],_0x17effd=_0x32bcf6['from']?.['id'][_0x59dd8b(0x1ff)]();if(!_0x17effd)return;try{const _0x121079=await database_1[_0x59dd8b(0x211)][_0x59dd8b(0x16b)]['findUnique']({'where':{'telegramId':_0x17effd},'include':{'shop':!![]}});if(!_0x121079||!_0x121079[_0x59dd8b(0x19e)]||!_0x121079[_0x59dd8b(0x1ba)]){await this['bot']?.[_0x59dd8b(0x16a)](_0x5ca1e5,'❌\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.');return;}const _0x23674a=_0x121079[_0x59dd8b(0x1c3)]?.[_0x59dd8b(0x192)]||_0x59dd8b(0x1a1);await database_1['default'][_0x59dd8b(0x16b)][_0x59dd8b(0x172)]({'where':{'telegramId':_0x17effd},'data':{'shopId':null,'isVerified':![]}}),console['log'](_0x59dd8b(0x1e6)+_0x17effd+_0x59dd8b(0x226)+_0x121079[_0x59dd8b(0x1ba)]),await this[_0x59dd8b(0x214)]?.[_0x59dd8b(0x16a)](_0x5ca1e5,_0x59dd8b(0x1b0)+_0x23674a+_0x59dd8b(0x14a)+_0x59dd8b(0x1ad),{'parse_mode':_0x59dd8b(0x1cd)});}catch(_0x2d3b71){console[_0x59dd8b(0x1c5)]('Error\x20handling\x20/disconnect\x20command:',_0x2d3b71),await this[_0x59dd8b(0x214)]?.[_0x59dd8b(0x16a)](_0x5ca1e5,_0x59dd8b(0x1fa));}}),this[_0x10af22(0x214)][_0x10af22(0x181)](/\/status/,async _0x2b432e=>{const _0x5a4d8d=_0x10af22,_0x5780eb=_0x2b432e['chat']['id'],_0x485527=_0x2b432e['from']?.['id'][_0x5a4d8d(0x1ff)]();if(!_0x485527)return;try{const _0xd777bb=await database_1[_0x5a4d8d(0x211)][_0x5a4d8d(0x16b)]['findUnique']({'where':{'telegramId':_0x485527},'include':{'shop':!![]}});if(!_0xd777bb){await this[_0x5a4d8d(0x214)]?.[_0x5a4d8d(0x16a)](_0x5780eb,_0x5a4d8d(0x203)+'Use\x20/start\x20to\x20begin.');return;}if(!_0xd777bb[_0x5a4d8d(0x19e)]||!_0xd777bb['shopId']||!_0xd777bb[_0x5a4d8d(0x1c3)]){await this[_0x5a4d8d(0x214)]?.[_0x5a4d8d(0x16a)](_0x5780eb,_0x5a4d8d(0x15e)+_0x5a4d8d(0x1b6));return;}await this[_0x5a4d8d(0x214)]?.[_0x5a4d8d(0x16a)](_0x5780eb,'📊\x20*Connection\x20Status*\x0a\x0a'+(_0x5a4d8d(0x1ae)+_0xd777bb['shop'][_0x5a4d8d(0x192)]+'*\x0a')+('👤\x20Username:\x20`'+_0xd777bb[_0x5a4d8d(0x1c3)]['username']+'`\x0a')+(_0x5a4d8d(0x224)+_0xd777bb[_0x5a4d8d(0x1ea)]['toLocaleDateString'](_0x5a4d8d(0x208))+'\x0a\x0a')+_0x5a4d8d(0x1e3)+_0x5a4d8d(0x20a)+_0x5a4d8d(0x17a),{'parse_mode':'Markdown'});}catch(_0x449da9){console[_0x5a4d8d(0x1c5)](_0x5a4d8d(0x21e),_0x449da9),await this[_0x5a4d8d(0x214)]?.[_0x5a4d8d(0x16a)](_0x5780eb,_0x5a4d8d(0x1fa));}}),this['bot'][_0x10af22(0x181)](/\/debug/,async _0x1a1345=>{const _0x384479=_0x10af22,_0x371cf6=_0x1a1345[_0x384479(0x19d)]['id'],_0x2fd055=_0x1a1345[_0x384479(0x1dc)]?.['id'][_0x384479(0x1ff)]();if(!_0x2fd055)return;try{const _0x2030c7=await database_1[_0x384479(0x211)][_0x384479(0x1c3)][_0x384479(0x1b1)]({'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![]},'take':0xa});let _0x3421bd='🔍\x20*Debug\x20Information*\x0a\x0a';_0x3421bd+=_0x384479(0x183)+_0x2fd055+_0x384479(0x222),_0x3421bd+=_0x384479(0x1a5),_0x2030c7[_0x384479(0x1f7)]((_0x5655c2,_0x2f4ec7)=>{const _0x55f664=_0x384479;_0x3421bd+=_0x2f4ec7+0x1+'.\x20*'+_0x5655c2['name']+'*\x0a',_0x3421bd+=_0x55f664(0x1c9)+_0x5655c2[_0x55f664(0x215)]+'`\x0a',_0x3421bd+=_0x55f664(0x187)+_0x5655c2['status']+'\x0a',_0x3421bd+='\x20\x20\x20Public\x20Key:\x20`'+_0x5655c2[_0x55f664(0x152)][_0x55f664(0x20c)](0x0,0xf)+_0x55f664(0x1f8);}),await this[_0x384479(0x214)]?.['sendMessage'](_0x371cf6,_0x3421bd,{'parse_mode':_0x384479(0x1cd)});}catch(_0x58a70e){console['error'](_0x384479(0x1f9),_0x58a70e),await this['bot']?.[_0x384479(0x16a)](_0x371cf6,_0x384479(0x1eb));}}),this[_0x10af22(0x214)]['on'](_0x10af22(0x1c6),async _0x19a2ff=>{const _0x975a1=_0x10af22;if(_0x19a2ff[_0x975a1(0x1ca)]?.[_0x975a1(0x147)]('/'))return;const _0x48d3c3=_0x19a2ff[_0x975a1(0x19d)]['id'],_0x11a7cc=_0x19a2ff[_0x975a1(0x1dc)]?.['id'][_0x975a1(0x1ff)](),_0x31f6a5=_0x19a2ff['text']?.[_0x975a1(0x19b)]();if(!_0x11a7cc||!_0x31f6a5)return;try{const _0x27fdc5=await database_1[_0x975a1(0x211)]['telegramUser'][_0x975a1(0x146)]({'where':{'telegramId':_0x11a7cc},'include':{'shop':!![]}});if(!_0x27fdc5){await this['bot']?.[_0x975a1(0x16a)](_0x48d3c3,'❌\x20Please\x20use\x20/start\x20command\x20first');return;}if(_0x27fdc5[_0x975a1(0x19e)]&&_0x27fdc5[_0x975a1(0x1ba)]&&_0x27fdc5['shop']){await this['bot']?.['sendMessage'](_0x48d3c3,_0x975a1(0x190)+_0x27fdc5[_0x975a1(0x1c3)][_0x975a1(0x192)]+'*.\x0a\x0a'+_0x975a1(0x150),{'parse_mode':_0x975a1(0x1cd)});return;}const _0x1752e2=_0x31f6a5[_0x975a1(0x17c)](/\s+/);if(_0x1752e2[_0x975a1(0x163)]!==0x2){await this[_0x975a1(0x214)]?.[_0x975a1(0x16a)](_0x48d3c3,_0x975a1(0x1b4)+_0x975a1(0x168)+'Example:\x0a'+_0x975a1(0x1f3)+(_0x975a1(0x155)+_0x1752e2[_0x975a1(0x163)]+_0x975a1(0x1d0)+_0x1752e2[_0x975a1(0x209)](_0x191182=>'`'+_0x191182+'`')[_0x975a1(0x1ac)](',\x20')),{'parse_mode':'Markdown'});return;}const [_0x461941,_0x2e1386]=_0x1752e2;console['log'](_0x975a1(0x19f)+_0x11a7cc+':\x20username=\x22'+_0x461941+'\x22,\x20apiKey=\x22'+_0x2e1386[_0x975a1(0x20c)](0x0,0xa)+_0x975a1(0x184)),await this['handleSingleLineVerification'](_0x48d3c3,_0x11a7cc,_0x461941,_0x2e1386);}catch(_0x1498ac){console['error'](_0x975a1(0x1cc),_0x1498ac),await this[_0x975a1(0x214)]?.[_0x975a1(0x16a)](_0x48d3c3,'❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this['bot']['on']('error',_0x295cdc=>{const _0x434792=_0x10af22;console[_0x434792(0x1c5)](_0x434792(0x217),_0x295cdc);}),this[_0x10af22(0x214)]['on']('polling_error',_0x20706a=>{const _0x23ea34=_0x10af22;console[_0x23ea34(0x1c5)](_0x23ea34(0x21d),_0x20706a);});}async[a55_0x1043f4(0x223)](_0x595f88,_0x37dbee,_0x194681,_0x50b12d){const _0x43815a=a55_0x1043f4;try{console[_0x43815a(0x207)](_0x43815a(0x19f)+_0x37dbee+_0x43815a(0x228)+_0x194681+_0x43815a(0x213)+_0x50b12d['substring'](0x0,0xa)+_0x43815a(0x184));if(!_0x194681||_0x194681['length']<0x3||_0x194681[_0x43815a(0x163)]>0x32||!/^[a-zA-Z0-9_]+$/[_0x43815a(0x1f0)](_0x194681)){await this[_0x43815a(0x214)]?.[_0x43815a(0x16a)](_0x595f88,'❌\x20Invalid\x20username\x20format:\x20`'+_0x194681+'`\x0a\x0a'+_0x43815a(0x1aa),{'parse_mode':_0x43815a(0x1cd)});return;}if(!_0x50b12d||!_0x50b12d['startsWith'](_0x43815a(0x188))&&!_0x50b12d['startsWith']('sk_')){await this['bot']?.['sendMessage'](_0x595f88,_0x43815a(0x212)+'API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.',{'parse_mode':_0x43815a(0x1cd)});return;}const _0x1097c4=await database_1[_0x43815a(0x211)][_0x43815a(0x1c3)][_0x43815a(0x146)]({'where':{'username':_0x194681},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x1097c4){const _0x4903d6=await database_1[_0x43815a(0x211)][_0x43815a(0x1c3)][_0x43815a(0x1b1)]({'select':{'username':!![],'name':!![]},'take':0x5});let _0x32aedd=_0x43815a(0x1d8)+_0x194681+_0x43815a(0x1fd);_0x4903d6[_0x43815a(0x163)]>0x0?(_0x32aedd+='Available\x20usernames:\x0a',_0x4903d6[_0x43815a(0x1f7)](_0x229263=>{const _0x293b30=_0x43815a;_0x32aedd+=_0x293b30(0x221)+_0x229263[_0x293b30(0x215)]+_0x293b30(0x1f6)+_0x229263[_0x293b30(0x192)]+')\x0a';}),_0x32aedd+='\x0aCheck\x20spelling\x20and\x20try\x20again.'):_0x32aedd+=_0x43815a(0x15d);await this[_0x43815a(0x214)]?.[_0x43815a(0x16a)](_0x595f88,_0x32aedd,{'parse_mode':_0x43815a(0x1cd)});return;}if(_0x1097c4[_0x43815a(0x162)]!==_0x43815a(0x1d4)){await this['bot']?.[_0x43815a(0x16a)](_0x595f88,_0x43815a(0x1ec)+_0x194681+'`\x20is\x20inactive.\x0a\x0a'+'Contact\x20administrator.',{'parse_mode':_0x43815a(0x1cd)});return;}if(_0x1097c4[_0x43815a(0x152)]!==_0x50b12d&&_0x1097c4[_0x43815a(0x1a0)]!==_0x50b12d){await this[_0x43815a(0x214)]?.['sendMessage'](_0x595f88,_0x43815a(0x1fe)+_0x194681+_0x43815a(0x220)+_0x43815a(0x202)+'Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`',{'parse_mode':'Markdown'});return;}const _0x128fb3=await database_1[_0x43815a(0x211)]['telegramUser'][_0x43815a(0x1bd)]({'where':{'shopId':_0x1097c4['id'],'isVerified':!![],'telegramId':{'not':_0x37dbee}}});if(_0x128fb3){await this[_0x43815a(0x214)]?.[_0x43815a(0x16a)](_0x595f88,'❌\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`'+_0x194681+_0x43815a(0x220)+_0x43815a(0x198),{'parse_mode':_0x43815a(0x1cd)});return;}await database_1[_0x43815a(0x211)][_0x43815a(0x16b)][_0x43815a(0x172)]({'where':{'telegramId':_0x37dbee},'data':{'shopId':_0x1097c4['id'],'isVerified':!![]}}),await this[_0x43815a(0x214)]?.['sendMessage'](_0x595f88,_0x43815a(0x1e9)+'✅\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a'+(_0x43815a(0x1db)+_0x1097c4['name']+'*\x0a')+(_0x43815a(0x170)+_0x1097c4['username']+'`\x0a\x0a')+_0x43815a(0x175)+'•\x20New\x20payments\x0a'+_0x43815a(0x193)+_0x43815a(0x1f1)+'•\x20Important\x20events\x0a\x0a'+'Commands:\x0a'+_0x43815a(0x153)+_0x43815a(0x17a),{'parse_mode':_0x43815a(0x1cd)}),console['log']('✅\x20Telegram\x20user\x20'+_0x37dbee+_0x43815a(0x14e)+_0x1097c4[_0x43815a(0x215)]+_0x43815a(0x1de));}catch(_0x35e60e){console[_0x43815a(0x1c5)](_0x43815a(0x15a),_0x35e60e),await this[_0x43815a(0x214)]?.[_0x43815a(0x16a)](_0x595f88,_0x43815a(0x21c));}}async[a55_0x1043f4(0x15c)](_0x4407e5,_0xfa1d03,_0xff976b){const _0x82f1dd=a55_0x1043f4;if(!this[_0x82f1dd(0x214)]){console['warn'](_0x82f1dd(0x218));return;}try{const _0x3a45ff=await database_1[_0x82f1dd(0x211)][_0x82f1dd(0x16b)]['findMany']({'where':{'shopId':_0x4407e5,'isVerified':!![]}});if(_0x3a45ff[_0x82f1dd(0x163)]===0x0){console[_0x82f1dd(0x207)]('No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20'+_0x4407e5);return;}const _0x1c19a2=_0x3a45ff[_0x82f1dd(0x209)](async _0x2fe9ad=>{const _0x556a38=_0x82f1dd;try{await this['bot']?.[_0x556a38(0x16a)](_0x2fe9ad[_0x556a38(0x178)],_0xfa1d03,_0xff976b),console[_0x556a38(0x207)](_0x556a38(0x1d5)+_0x2fe9ad[_0x556a38(0x178)]);}catch(_0x476730){console['error'](_0x556a38(0x185)+_0x2fe9ad[_0x556a38(0x178)]+':',_0x476730),_0x476730 instanceof Error&&(_0x476730[_0x556a38(0x1c6)][_0x556a38(0x1a9)](_0x556a38(0x200))||_0x476730['message']['includes'](_0x556a38(0x148))||_0x476730[_0x556a38(0x1c6)][_0x556a38(0x1a9)](_0x556a38(0x1f2)))&&(await database_1[_0x556a38(0x211)][_0x556a38(0x16b)]['update']({'where':{'id':_0x2fe9ad['id']},'data':{'isVerified':![]}}),console['log'](_0x556a38(0x14f)+_0x2fe9ad[_0x556a38(0x178)]+_0x556a38(0x16d)));}});await Promise['allSettled'](_0x1c19a2);}catch(_0x36ddf7){console[_0x82f1dd(0x1c5)](_0x82f1dd(0x157),_0x36ddf7);}}async[a55_0x1043f4(0x205)](_0x13aeb0,_0x34195c,_0x376baa){const _0x2c01e2=a55_0x1043f4,_0x3a8f79={'created':'🆕','paid':'✅','failed':'❌','expired':'⏰','refund':'🔄','chargeback':'⚠️','processing':'⚙️'},_0xe09f02={'created':_0x2c01e2(0x206),'paid':_0x2c01e2(0x171),'failed':_0x2c01e2(0x169),'expired':_0x2c01e2(0x1f5),'refund':_0x2c01e2(0x14d),'chargeback':'Payment\x20chargeback','processing':_0x2c01e2(0x1d2)},_0x5ca83b=_0x3a8f79[_0x376baa],_0x1c5368=_0xe09f02[_0x376baa],_0x502715=(0x0,gateway_1[_0x2c01e2(0x1e8)])(_0x34195c['gateway']);console[_0x2c01e2(0x207)](_0x2c01e2(0x1a4)+_0x34195c['gateway']+_0x2c01e2(0x1fb)+_0x502715+'\x22');let _0x4bc00e=_0x5ca83b+'\x20*'+_0x1c5368+_0x2c01e2(0x154)+('💰\x20Amount:\x20*'+_0x34195c[_0x2c01e2(0x19c)]+'\x20'+_0x34195c['currency']+'*\x0a')+('📝\x20Order\x20ID:\x20`'+(_0x34195c[_0x2c01e2(0x1af)]||_0x34195c['id'])+'`\x0a')+(_0x2c01e2(0x1d9)+_0x34195c['id']+'`\x0a')+(_0x2c01e2(0x167)+_0x502715+'`\x0a')+(_0x2c01e2(0x199)+new Date(_0x34195c[_0x2c01e2(0x1b8)])['toLocaleString'](_0x2c01e2(0x208))+'\x0a');if(_0x34195c['customerName']||_0x34195c['customerEmail']||_0x34195c[_0x2c01e2(0x160)]||_0x34195c[_0x2c01e2(0x1c0)]||_0x34195c['customerUa']){_0x4bc00e+=_0x2c01e2(0x1c8);_0x34195c[_0x2c01e2(0x1e5)]&&(_0x4bc00e+=_0x2c01e2(0x1d3)+_0x34195c[_0x2c01e2(0x1e5)]+'`\x0a');_0x34195c[_0x2c01e2(0x1c7)]&&(_0x4bc00e+='📧\x20Email:\x20`'+_0x34195c['customerEmail']+'`\x0a');_0x34195c[_0x2c01e2(0x160)]&&(_0x4bc00e+=_0x2c01e2(0x158)+_0x34195c[_0x2c01e2(0x160)]+'`\x0a');_0x34195c['customerIp']&&(_0x4bc00e+=_0x2c01e2(0x17d)+_0x34195c[_0x2c01e2(0x1c0)]+'`\x0a');if(_0x34195c['customerUa']){const _0x4855f6=_0x34195c[_0x2c01e2(0x1bc)][_0x2c01e2(0x163)]>0x32?_0x34195c[_0x2c01e2(0x1bc)][_0x2c01e2(0x20c)](0x0,0x32)+'...':_0x34195c['customerUa'];_0x4bc00e+=_0x2c01e2(0x21b)+_0x4855f6+'`\x0a';}}_0x376baa===_0x2c01e2(0x142)&&_0x34195c['chargebackAmount']&&(_0x4bc00e+=_0x2c01e2(0x225)+_0x34195c[_0x2c01e2(0x1c1)]+_0x2c01e2(0x21a)),_0x376baa===_0x2c01e2(0x1a8)&&(_0x4bc00e+=_0x2c01e2(0x219)),_0x34195c[_0x2c01e2(0x1e7)]&&(_0x4bc00e+=_0x2c01e2(0x189)+_0x34195c[_0x2c01e2(0x1e7)]+'\x0a'),await this[_0x2c01e2(0x15c)](_0x13aeb0,_0x4bc00e,{'parse_mode':_0x2c01e2(0x1cd)});}async[a55_0x1043f4(0x1ee)](_0x580347,_0x470735,_0x2599ef){const _0x27c3e0=a55_0x1043f4,_0x18f4cf={'created':'📤','completed':'✅','rejected':'❌'},_0x3733ef={'created':_0x27c3e0(0x1df),'completed':_0x27c3e0(0x18b),'rejected':_0x27c3e0(0x1e4)},_0x274e0f=_0x18f4cf[_0x2599ef],_0x39d241=_0x3733ef[_0x2599ef],_0x2dc344=_0x274e0f+'\x20*'+_0x39d241+_0x27c3e0(0x154)+(_0x27c3e0(0x16c)+_0x470735[_0x27c3e0(0x19c)]+_0x27c3e0(0x20d))+(_0x27c3e0(0x18d)+_0x470735[_0x27c3e0(0x1b3)]+'`\x0a')+(_0x27c3e0(0x21f)+_0x470735['id']+'`\x0a')+(_0x27c3e0(0x199)+new Date(_0x470735[_0x27c3e0(0x1b8)])[_0x27c3e0(0x16f)](_0x27c3e0(0x208))+'\x0a')+(_0x470735[_0x27c3e0(0x1e2)]?'🔗\x20TXID:\x20`'+_0x470735[_0x27c3e0(0x1e2)]+'`':'');await this[_0x27c3e0(0x15c)](_0x580347,_0x2dc344,{'parse_mode':_0x27c3e0(0x1cd)});}async[a55_0x1043f4(0x1fc)](_0x21828e,_0xbe0d5d){const _0x219130=a55_0x1043f4;try{const _0x867e26=await database_1[_0x219130(0x211)]['shopSettings'][_0x219130(0x146)]({'where':{'shopId':_0x21828e},'select':{'notificationLogin':!![]}});if(!_0x867e26?.['notificationLogin']){console[_0x219130(0x207)](_0x219130(0x195)+_0x21828e);return;}const _0x3a357e=_0xbe0d5d[_0x219130(0x165)]?'🔐':'🚨',_0x8a6c85=_0xbe0d5d[_0x219130(0x165)]?_0x219130(0x144):_0x219130(0x1b2);let _0x5a6b28=_0x3a357e+'\x20*'+_0x8a6c85+_0x219130(0x154)+(_0x219130(0x170)+_0xbe0d5d['username']+'`\x0a')+(_0x219130(0x1d7)+_0xbe0d5d[_0x219130(0x18f)][_0x219130(0x16f)](_0x219130(0x208))+'\x0a');_0xbe0d5d[_0x219130(0x1ce)]&&(_0x5a6b28+=_0x219130(0x20b)+_0xbe0d5d[_0x219130(0x1ce)]+'`\x0a');if(_0xbe0d5d[_0x219130(0x151)]){const _0x247eb6=_0xbe0d5d[_0x219130(0x151)][_0x219130(0x163)]>0x32?_0xbe0d5d[_0x219130(0x151)][_0x219130(0x20c)](0x0,0x32)+'...':_0xbe0d5d[_0x219130(0x151)];_0x5a6b28+=_0x219130(0x21b)+_0x247eb6+'`\x0a';}!_0xbe0d5d[_0x219130(0x165)]&&(_0x5a6b28+=_0x219130(0x177)),await this['sendShopNotification'](_0x21828e,_0x5a6b28,{'parse_mode':_0x219130(0x1cd)}),console[_0x219130(0x207)](_0x219130(0x1a7)+_0x21828e+':\x20'+(_0xbe0d5d['success']?_0x219130(0x165):_0x219130(0x14c)));}catch(_0x1f5f21){console[_0x219130(0x1c5)](_0x219130(0x216),_0x1f5f21);}}async['sendApiErrorNotification'](_0x2f4d56,_0x380db1){const _0x5d4aa6=a55_0x1043f4;try{const _0x5a5ad9=await database_1[_0x5d4aa6(0x211)][_0x5d4aa6(0x227)][_0x5d4aa6(0x146)]({'where':{'shopId':_0x2f4d56},'select':{'notificationApiError':!![]}});if(!_0x5a5ad9?.[_0x5d4aa6(0x143)]){console[_0x5d4aa6(0x207)](_0x5d4aa6(0x1bb)+_0x2f4d56);return;}let _0x1285da='🚨\x20*API\x20Error*\x0a\x0a'+(_0x5d4aa6(0x18c)+_0x380db1[_0x5d4aa6(0x1b3)]+'\x20'+_0x380db1[_0x5d4aa6(0x1b5)]+'`\x0a')+(_0x5d4aa6(0x1d7)+_0x380db1['timestamp'][_0x5d4aa6(0x16f)]('en-US')+'\x0a');_0x380db1[_0x5d4aa6(0x156)]&&(_0x1285da+=_0x5d4aa6(0x19a)+_0x380db1[_0x5d4aa6(0x156)]+'`\x0a'),_0x1285da+=_0x5d4aa6(0x174)+_0x380db1[_0x5d4aa6(0x1d1)]+'`\x0a',_0x380db1[_0x5d4aa6(0x180)]&&(_0x1285da+=_0x5d4aa6(0x1a6)+_0x380db1[_0x5d4aa6(0x180)]+'`\x0a'),_0x1285da+=_0x5d4aa6(0x176),await this[_0x5d4aa6(0x15c)](_0x2f4d56,_0x1285da,{'parse_mode':_0x5d4aa6(0x1cd)}),console['log']('✅\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20'+_0x2f4d56+':\x20'+_0x380db1[_0x5d4aa6(0x1b5)]);}catch(_0x4bc8f2){console['error'](_0x5d4aa6(0x1ef),_0x4bc8f2);}}async[a55_0x1043f4(0x1b9)](_0xa26ace,_0x38aea4,_0x5122de){const _0x1c4d51=a55_0x1043f4;let _0x4429ed='🔔\x20*'+_0x38aea4+_0x1c4d51(0x154);for(const [_0x3f600e,_0x559f07]of Object[_0x1c4d51(0x166)](_0x5122de)){_0x559f07!==null&&_0x559f07!==undefined&&(_0x4429ed+=_0x3f600e+':\x20`'+_0x559f07+'`\x0a');}await this['sendShopNotification'](_0xa26ace,_0x4429ed,{'parse_mode':_0x1c4d51(0x1cd)});}[a55_0x1043f4(0x182)](){const _0x5bb6b6=a55_0x1043f4;return{'isActive':!!this[_0x5bb6b6(0x214)],'username':this[_0x5bb6b6(0x1c4)]};}[a55_0x1043f4(0x1f4)](){const _0x2f6a81=a55_0x1043f4;this[_0x2f6a81(0x214)]&&(this[_0x2f6a81(0x214)][_0x2f6a81(0x1b7)](),this[_0x2f6a81(0x214)]=null,console[_0x2f6a81(0x207)](_0x2f6a81(0x1e0)));}}exports['TelegramBotService']=TelegramBotService,exports[a55_0x1043f4(0x201)]=new TelegramBotService();function a55_0x4904(){const _0x299021=['🔗\x20Endpoint:\x20`','🏦\x20Method:\x20`','Example:\x0a','timestamp','✅\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*','node-telegram-bot-api','name','•\x20Payment\x20status\x20changes\x0a','trapay_bot','📱\x20Login\x20notifications\x20disabled\x20for\x20shop\x20','\x20(@','warn','Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.','📅\x20Date:\x20','📊\x20Error\x20code:\x20`','trim','amount','chat','isVerified','🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20','secretKey','unknown\x20shop','🤖\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a','\x20initialized\x20successfully','📱\x20Telegram\x20notification:\x20gateway\x20\x22','🏪\x20Available\x20shops\x20in\x20system:\x0a','🆔\x20Request\x20ID:\x20`','✅\x20Login\x20notification\x20sent\x20for\x20shop\x20','processing','includes','Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).','135120PVKLbT','join','To\x20reconnect,\x20use\x20the\x20/start\x20command','✅\x20Connected\x20to\x20shop:\x20*','orderId','✅\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*','findMany','Failed\x20login\x20attempt','method','❌\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a','endpoint','Use\x20/start\x20to\x20connect.','stopPolling','createdAt','sendCustomNotification','shopId','📱\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20','customerUa','findFirst','TELEGRAM_BOT_USERNAME','🔄\x20Reset\x20incomplete\x20verification\x20for\x20user\x20','customerIp','chargebackAmount','3157VlKTWN','shop','botUsername','error','message','customerEmail','\x0a👤\x20*Customer\x20Information:*\x0a','\x20\x20\x20Username:\x20`','text','✅\x20Welcome\x20back!\x0a\x0a','Error\x20handling\x20message:','Markdown','ipAddress','📱\x20Created\x20new\x20Telegram\x20user:\x20','\x20parts:\x20','errorMessage','Payment\x20is\x20being\x20processed','📛\x20Name:\x20`','ACTIVE','✅\x20Notification\x20sent\x20to\x20Telegram\x20user\x20','__importDefault','📅\x20Time:\x20','❌\x20Shop\x20with\x20username\x20`','🆔\x20Payment\x20ID:\x20`','initializeBot','📱\x20Shop:\x20*','from','36qbafOY','\x20via\x20single-line\x20input','New\x20payout\x20created','🛑\x20Telegram\x20bot\x20stopped','1833080HMObla','txid','🔔\x20Notifications\x20are\x20active\x0a\x0a','Payout\x20rejected','customerName','🔌\x20User\x20','adminNotes','getGatewayDisplayNameForTelegram','🎉\x20*Congratulations!*\x0a\x0a','updatedAt','❌\x20Error\x20getting\x20debug\x20information.','❌\x20Shop\x20`','1899ZkZYcS','sendPayoutNotification','Failed\x20to\x20send\x20API\x20error\x20notification:','test','•\x20Payouts\x0a','user\x20is\x20deactivated','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','stopBot','Payment\x20expired','`\x20(','forEach','...`\x0a\x0a','Error\x20handling\x20/debug\x20command:','❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','\x22\x20->\x20display\x20\x22','sendLoginNotification','`\x20not\x20found.\x0a\x0a','❌\x20API\x20key\x20does\x20not\x20match\x20shop\x20`','toString','blocked','telegramBotService','Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a','❌\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a','../config/database','sendPaymentNotification','New\x20payment\x20created','log','en-US','map','Commands:\x0a','🌐\x20IP\x20address:\x20`','substring','\x20USD*\x0a','You\x20are\x20already\x20connected\x20to\x20shop:\x20*','2559420QXjnwq','122IyIYzi','default','❌\x20Invalid\x20API\x20key\x20format.\x0a\x0a','\x22,\x20apiKey=\x22','bot','username','Failed\x20to\x20send\x20login\x20notification:','Telegram\x20bot\x20error:','Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification','⏳\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a','\x20USDT*\x0a','💻\x20Browser:\x20`','❌\x20An\x20error\x20occurred\x20while\x20verifying\x20data.','Telegram\x20bot\x20polling\x20error:','Error\x20handling\x20/status\x20command:','🆔\x20Payout\x20ID:\x20`','`.\x0a\x0a','•\x20`','`\x0a\x0a','handleSingleLineVerification','📅\x20Connection\x20date:\x20','💸\x20Penalty\x20amount:\x20*','\x20disconnected\x20from\x20shop\x20','shopSettings',':\x20username=\x22','chargeback','notificationApiError','Successful\x20login','654dAPPlx','findUnique','startsWith','chat\x20not\x20found','Error\x20handling\x20/start\x20command:','*.\x0a\x0a','❌\x20Failed\x20to\x20initialize\x20Telegram\x20bot:','failed','Payment\x20refund','\x20verified\x20for\x20shop\x20','User\x20','Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.','userAgent','publicKey','/status\x20-\x20check\x20connection\x20status\x0a','*\x0a\x0a','You\x20sent\x20','statusCode','Error\x20sending\x20shop\x20notification:','🏦\x20IBAN:\x20`','setupBotHandlers','Error\x20in\x20handleSingleLineVerification:','•\x20Payouts\x0a\x0a','sendShopNotification','Check\x20spelling\x20and\x20try\x20again.','❌\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a','botToken','remitterIban','769768zmzznv','status','length','first_name','success','entries','🏪\x20Gateway:\x20`','📝\x20Format:\x20`username\x20api_key`\x0a\x0a','Payment\x20failed','sendMessage','telegramUser','💸\x20Amount:\x20*','\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure','__esModule','toLocaleString','👤\x20Username:\x20`','Payment\x20successfully\x20paid','update','TELEGRAM_BOT_TOKEN','❌\x20Error:\x20`','🔔\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a','\x0a💡\x20Check\x20your\x20request\x20or\x20contact\x20support.','\x0a⚠️\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!','telegramId','env','/disconnect\x20-\x20disconnect\x20from\x20notifications','12125880hhZwmO','split','🌐\x20IP:\x20`','🔔\x20You\x20receive\x20notifications\x20about:\x0a','TelegramBotService','requestId','onText','getBotInfo','📱\x20Your\x20Telegram\x20ID:\x20`','...\x22','❌\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20','To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a','\x20\x20\x20Status:\x20','pk_','📝\x20Notes:\x20','Username:\x20`','Payout\x20completed'];a55_0x4904=function(){return _0x299021;};return a55_0x4904();}