'use strict';const a55_0x2e8552=a55_0x1adf;(function(_0x288793,_0xf25cea){const _0x1b7009=a55_0x1adf,_0x354a7d=_0x288793();while(!![]){try{const _0x53e2bf=parseInt(_0x1b7009(0x1ad))/0x1+parseInt(_0x1b7009(0x1ef))/0x2*(parseInt(_0x1b7009(0x18b))/0x3)+parseInt(_0x1b7009(0x1fc))/0x4*(parseInt(_0x1b7009(0x210))/0x5)+-parseInt(_0x1b7009(0x221))/0x6*(parseInt(_0x1b7009(0x1ab))/0x7)+parseInt(_0x1b7009(0x213))/0x8*(-parseInt(_0x1b7009(0x224))/0x9)+-parseInt(_0x1b7009(0x1cd))/0xa*(-parseInt(_0x1b7009(0x1ee))/0xb)+-parseInt(_0x1b7009(0x15e))/0xc;if(_0x53e2bf===_0xf25cea)break;else _0x354a7d['push'](_0x354a7d['shift']());}catch(_0x550740){_0x354a7d['push'](_0x354a7d['shift']());}}}(a55_0x1e42,0x8d3f8));function a55_0x1e42(){const _0x20f1ef=['txid','Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.','\x20initialized\x20successfully','You\x20are\x20already\x20connected\x20to\x20shop:\x20*','Payout\x20completed','customerName','📝\x20Format:\x20`username\x20api_key`\x0a\x0a','ipAddress','adminNotes','User\x20','allSettled','/disconnect\x20-\x20disconnect\x20from\x20notifications','Error\x20handling\x20/status\x20command:','trapay_bot','🔔\x20You\x20receive\x20notifications\x20about:\x0a','warn','defineProperty','amount','customerIp','\x20\x20\x20Username:\x20`','Available\x20usernames:\x0a','✅\x20Welcome\x20back!\x0a\x0a','chat','🔌\x20User\x20','\x0a⚠️\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!','\x20parts:\x20','telegramBotService','🌐\x20IP:\x20`','📝\x20Order\x20ID:\x20`','getBotInfo','findMany','20269188QamTDJ','To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a','To\x20reconnect,\x20use\x20the\x20/start\x20command','\x20disconnected\x20from\x20shop\x20','currency','🏪\x20Gateway:\x20`','📱\x20Shop:\x20*','Commands:\x0a','✅\x20Telegram\x20user\x20','requestId','shop','❌\x20Shop\x20with\x20username\x20`','🔔\x20*','\x20\x20\x20Status:\x20','...\x22','sendMessage','•\x20Payouts\x0a\x0a','Use\x20/start\x20to\x20begin.','text','🔄\x20Reset\x20incomplete\x20verification\x20for\x20user\x20','❌\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`','findFirst','❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','botUsername','handleSingleLineVerification','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','Successful\x20login','Payment\x20successfully\x20paid','❌\x20Shop\x20`','telegramId','getGatewayDisplayNameForTelegram','bot','👤\x20Username:\x20`','stopBot','user\x20is\x20deactivated','onText','•\x20Important\x20events\x0a\x0a','📅\x20Date:\x20','❌\x20An\x20error\x20occurred\x20while\x20verifying\x20data.','📱\x20Login\x20notifications\x20disabled\x20for\x20shop\x20','📧\x20Email:\x20`','❌\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a','Telegram\x20bot\x20polling\x20error:','🛑\x20Telegram\x20bot\x20stopped','message','129aQKmMD','includes','last_name','initializeBot','../config/database','❌\x20Invalid\x20username\x20format:\x20`','\x0aCheck\x20spelling\x20and\x20try\x20again.','customerEmail','You\x20sent\x20','•\x20New\x20payments\x0a','node-telegram-bot-api','sendLoginNotification','toString','🔔\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a','substring','🤖\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a','❗️\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!','📅\x20Time:\x20','method','Error\x20sending\x20shop\x20notification:','endpoint','🔍\x20*Debug\x20Information*\x0a\x0a','Telegram\x20bot\x20error:','userAgent','Payment\x20is\x20being\x20processed','test','Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.','stopPolling','📱\x20Created\x20new\x20Telegram\x20user:\x20','__importDefault','📱\x20Telegram\x20notification:\x20gateway\x20\x22','Failed\x20login\x20attempt','7XfmTji','📊\x20*Connection\x20Status*\x0a\x0a','908098eQOVlE','TelegramBotService','from','📊\x20Error\x20code:\x20`','\x22,\x20apiKey=\x22','/status\x20-\x20check\x20connection\x20status\x0a','remitterIban','📅\x20Connection\x20date:\x20','💸\x20Amount:\x20*','en-US','...','timestamp','*\x0a\x0a','💸\x20Penalty\x20amount:\x20*','\x20USD*\x0a','sendPaymentNotification','gateway','forEach','length','`\x0a\x0a','🔗\x20TXID:\x20`','❌\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a',':\x20username=\x22','entries','🏦\x20IBAN:\x20`','\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure','❌\x20Failed\x20to\x20initialize\x20Telegram\x20bot:','customerUa','../types/gateway','`.\x0a\x0a','💻\x20Browser:\x20`','`\x20(','10dYtQRx','Markdown','🚨\x20*API\x20Error*\x0a\x0a','Failed\x20to\x20send\x20API\x20error\x20notification:','📛\x20Name:\x20`','pk_','🆔\x20Request\x20ID:\x20`','split','status','🆔\x20Payout\x20ID:\x20`','🔗\x20Endpoint:\x20`','chargebackAmount','chat\x20not\x20found','`\x20is\x20inactive.\x0a\x0a','\x20\x20\x20Public\x20Key:\x20`','orderId','map','No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20','•\x20`','createdAt','log','❌\x20Error\x20getting\x20debug\x20information.','📝\x20Notes:\x20','trim','Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a','Error\x20handling\x20message:','findUnique','\x20verified\x20for\x20shop\x20','default','✅\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20','Contact\x20administrator.','Payout\x20rejected','New\x20payout\x20created','9394451xCJLKK','16462IqJUZG','telegramUser','Payment\x20failed','TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables','success','TELEGRAM_BOT_USERNAME','Payment\x20chargeback','⏳\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a','startsWith','name','❌\x20Please\x20use\x20/start\x20command\x20first','sendShopNotification','Payment\x20expired','165208YMvbFU','polling_error','📱\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20','❌\x20Error:\x20`','update','🏪\x20Available\x20shops\x20in\x20system:\x0a','🌐\x20IP\x20address:\x20`','🎉\x20*Congratulations!*\x0a\x0a','•\x20Payment\x20status\x20changes\x0a','Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`','✅\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a','env','✅\x20Login\x20notification\x20sent\x20for\x20shop\x20','processing','💰\x20Amount:\x20*',':\x20`','\x20(@','first_name','publicKey','isVerified','25OOaNoj','Error\x20handling\x20/debug\x20command:','error','32PUxZcJ','Username:\x20`','botToken','*.\x0a\x0a','setupBotHandlers','shopId','toLocaleDateString','TELEGRAM_BOT_TOKEN','✅\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*','Use\x20/start\x20to\x20connect.','✅\x20Telegram\x20bot\x20@','❌\x20Invalid\x20API\x20key\x20format.\x0a\x0a','ACTIVE','API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','226698EmJTLG','❌\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.','\x0a👤\x20*Customer\x20Information:*\x0a','38583xqnkJU','Example:\x0a','Error\x20handling\x20/disconnect\x20command:','Check\x20spelling\x20and\x20try\x20again.','Error\x20handling\x20/start\x20command:','statusCode','username','toLocaleString','sendPayoutNotification','Failed\x20to\x20send\x20login\x20notification:'];a55_0x1e42=function(){return _0x20f1ef;};return a55_0x1e42();}function a55_0x1adf(_0x4d2e8a,_0x3169f7){const _0x1e4211=a55_0x1e42();return a55_0x1adf=function(_0x1adfaf,_0x56b746){_0x1adfaf=_0x1adfaf-0x144;let _0x3c048d=_0x1e4211[_0x1adfaf];return _0x3c048d;},a55_0x1adf(_0x4d2e8a,_0x3169f7);}var __importDefault=this&&this[a55_0x2e8552(0x1a8)]||function(_0x8db293){return _0x8db293&&_0x8db293['__esModule']?_0x8db293:{'default':_0x8db293};};Object[a55_0x2e8552(0x14f)](exports,'__esModule',{'value':!![]}),exports[a55_0x2e8552(0x159)]=exports[a55_0x2e8552(0x1ae)]=void 0x0;const node_telegram_bot_api_1=__importDefault(require(a55_0x2e8552(0x195))),database_1=__importDefault(require(a55_0x2e8552(0x18f))),gateway_1=require(a55_0x2e8552(0x1c9));class TelegramBotService{constructor(){const _0x3cbe0f=a55_0x2e8552;this[_0x3cbe0f(0x17d)]=null,this[_0x3cbe0f(0x215)]=process[_0x3cbe0f(0x207)][_0x3cbe0f(0x21a)]||'',this['botUsername']=process[_0x3cbe0f(0x207)][_0x3cbe0f(0x1f4)]||_0x3cbe0f(0x14c),this['botToken']?this[_0x3cbe0f(0x18e)]():console[_0x3cbe0f(0x14e)](_0x3cbe0f(0x1f2));}['initializeBot'](){const _0x22e684=a55_0x2e8552;try{this['bot']=new node_telegram_bot_api_1[(_0x22e684(0x1e9))](this[_0x22e684(0x215)],{'polling':!![]}),this['setupBotHandlers'](),console[_0x22e684(0x1e1)](_0x22e684(0x21d)+this[_0x22e684(0x175)]+_0x22e684(0x230));}catch(_0x378335){console[_0x22e684(0x212)](_0x22e684(0x1c7),_0x378335);}}[a55_0x2e8552(0x217)](){const _0x44ef9d=a55_0x2e8552;if(!this['bot'])return;this['bot'][_0x44ef9d(0x181)](/\/start/,async _0x583404=>{const _0x498b60=_0x44ef9d,_0x150511=_0x583404[_0x498b60(0x155)]['id'],_0x3295b2=_0x583404[_0x498b60(0x1af)]?.['id'][_0x498b60(0x197)](),_0x591735=_0x583404[_0x498b60(0x1af)]?.[_0x498b60(0x22a)],_0x21474c=_0x583404['from']?.[_0x498b60(0x20d)],_0xa752ba=_0x583404[_0x498b60(0x1af)]?.[_0x498b60(0x18d)];if(!_0x3295b2)return;try{let _0x1db862=await database_1[_0x498b60(0x1e9)]['telegramUser'][_0x498b60(0x1e7)]({'where':{'telegramId':_0x3295b2},'include':{'shop':!![]}});!_0x1db862?(_0x1db862=await database_1[_0x498b60(0x1e9)][_0x498b60(0x1f0)]['create']({'data':{'telegramId':_0x3295b2,'username':_0x591735,'firstName':_0x21474c,'lastName':_0xa752ba,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console[_0x498b60(0x1e1)](_0x498b60(0x1a7)+_0x3295b2+_0x498b60(0x20c)+_0x591735+')')):_0x1db862=await database_1[_0x498b60(0x1e9)]['telegramUser'][_0x498b60(0x200)]({'where':{'telegramId':_0x3295b2},'data':{'username':_0x591735,'firstName':_0x21474c,'lastName':_0xa752ba},'include':{'shop':!![]}}),_0x1db862[_0x498b60(0x20f)]&&_0x1db862[_0x498b60(0x218)]&&_0x1db862[_0x498b60(0x168)]?await this[_0x498b60(0x17d)]?.[_0x498b60(0x16d)](_0x150511,_0x498b60(0x154)+(_0x498b60(0x231)+_0x1db862['shop'][_0x498b60(0x1f8)]+'*\x0a')+(_0x498b60(0x214)+_0x1db862[_0x498b60(0x168)][_0x498b60(0x22a)]+'`\x0a\x0a')+_0x498b60(0x14d)+_0x498b60(0x194)+_0x498b60(0x204)+_0x498b60(0x16e)+_0x498b60(0x165)+_0x498b60(0x1b2)+_0x498b60(0x14a),{'parse_mode':_0x498b60(0x1ce)}):(_0x1db862['shopId']&&!_0x1db862['isVerified']&&(await database_1['default'][_0x498b60(0x1f0)][_0x498b60(0x200)]({'where':{'telegramId':_0x3295b2},'data':{'shopId':null,'isVerified':![]}}),console[_0x498b60(0x1e1)](_0x498b60(0x171)+_0x3295b2)),await this['bot']?.[_0x498b60(0x16d)](_0x150511,_0x498b60(0x19a)+_0x498b60(0x15f)+_0x498b60(0x145)+_0x498b60(0x225)+'`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a'+_0x498b60(0x19b),{'parse_mode':_0x498b60(0x1ce)}));}catch(_0x234912){console[_0x498b60(0x212)](_0x498b60(0x228),_0x234912),await this[_0x498b60(0x17d)]?.[_0x498b60(0x16d)](_0x150511,_0x498b60(0x174));}}),this[_0x44ef9d(0x17d)]['onText'](/\/disconnect/,async _0x2e23bd=>{const _0xf038af=_0x44ef9d,_0x3ca813=_0x2e23bd[_0xf038af(0x155)]['id'],_0x46fc32=_0x2e23bd[_0xf038af(0x1af)]?.['id'][_0xf038af(0x197)]();if(!_0x46fc32)return;try{const _0x49e7a7=await database_1[_0xf038af(0x1e9)][_0xf038af(0x1f0)][_0xf038af(0x1e7)]({'where':{'telegramId':_0x46fc32},'include':{'shop':!![]}});if(!_0x49e7a7||!_0x49e7a7[_0xf038af(0x20f)]||!_0x49e7a7[_0xf038af(0x218)]){await this[_0xf038af(0x17d)]?.[_0xf038af(0x16d)](_0x3ca813,_0xf038af(0x222));return;}const _0x48929c=_0x49e7a7['shop']?.[_0xf038af(0x1f8)]||'unknown\x20shop';await database_1[_0xf038af(0x1e9)][_0xf038af(0x1f0)]['update']({'where':{'telegramId':_0x46fc32},'data':{'shopId':null,'isVerified':![]}}),console['log'](_0xf038af(0x156)+_0x46fc32+_0xf038af(0x161)+_0x49e7a7[_0xf038af(0x218)]),await this[_0xf038af(0x17d)]?.[_0xf038af(0x16d)](_0x3ca813,_0xf038af(0x21b)+_0x48929c+_0xf038af(0x216)+_0xf038af(0x160),{'parse_mode':_0xf038af(0x1ce)});}catch(_0x240dd7){console[_0xf038af(0x212)](_0xf038af(0x226),_0x240dd7),await this['bot']?.['sendMessage'](_0x3ca813,'❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this[_0x44ef9d(0x17d)][_0x44ef9d(0x181)](/\/status/,async _0x138fb4=>{const _0x3d6384=_0x44ef9d,_0x5841a9=_0x138fb4[_0x3d6384(0x155)]['id'],_0x4349f2=_0x138fb4[_0x3d6384(0x1af)]?.['id'][_0x3d6384(0x197)]();if(!_0x4349f2)return;try{const _0x38369d=await database_1[_0x3d6384(0x1e9)]['telegramUser'][_0x3d6384(0x1e7)]({'where':{'telegramId':_0x4349f2},'include':{'shop':!![]}});if(!_0x38369d){await this[_0x3d6384(0x17d)]?.['sendMessage'](_0x5841a9,_0x3d6384(0x1c2)+_0x3d6384(0x16f));return;}if(!_0x38369d[_0x3d6384(0x20f)]||!_0x38369d[_0x3d6384(0x218)]||!_0x38369d[_0x3d6384(0x168)]){await this[_0x3d6384(0x17d)]?.['sendMessage'](_0x5841a9,_0x3d6384(0x187)+_0x3d6384(0x21c));return;}await this[_0x3d6384(0x17d)]?.['sendMessage'](_0x5841a9,_0x3d6384(0x1ac)+('✅\x20Connected\x20to\x20shop:\x20*'+_0x38369d[_0x3d6384(0x168)]['name']+'*\x0a')+('👤\x20Username:\x20`'+_0x38369d[_0x3d6384(0x168)][_0x3d6384(0x22a)]+'`\x0a')+(_0x3d6384(0x1b4)+_0x38369d['updatedAt'][_0x3d6384(0x219)](_0x3d6384(0x1b6))+'\x0a\x0a')+'🔔\x20Notifications\x20are\x20active\x0a\x0a'+_0x3d6384(0x165)+'/disconnect\x20-\x20disconnect\x20from\x20notifications',{'parse_mode':'Markdown'});}catch(_0xb9ef77){console[_0x3d6384(0x212)](_0x3d6384(0x14b),_0xb9ef77),await this[_0x3d6384(0x17d)]?.[_0x3d6384(0x16d)](_0x5841a9,_0x3d6384(0x174));}}),this[_0x44ef9d(0x17d)][_0x44ef9d(0x181)](/\/debug/,async _0xc4c8cb=>{const _0x46c7db=_0x44ef9d,_0xa5ffaa=_0xc4c8cb[_0x46c7db(0x155)]['id'],_0x11d0ad=_0xc4c8cb[_0x46c7db(0x1af)]?.['id']['toString']();if(!_0x11d0ad)return;try{const _0x1c4ee0=await database_1[_0x46c7db(0x1e9)][_0x46c7db(0x168)][_0x46c7db(0x15d)]({'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![]},'take':0xa});let _0x1875bc=_0x46c7db(0x1a0);_0x1875bc+='📱\x20Your\x20Telegram\x20ID:\x20`'+_0x11d0ad+_0x46c7db(0x1c0),_0x1875bc+=_0x46c7db(0x201),_0x1c4ee0[_0x46c7db(0x1be)]((_0x4a26e2,_0x3fabee)=>{const _0x22992b=_0x46c7db;_0x1875bc+=_0x3fabee+0x1+'.\x20*'+_0x4a26e2[_0x22992b(0x1f8)]+'*\x0a',_0x1875bc+=_0x22992b(0x152)+_0x4a26e2[_0x22992b(0x22a)]+'`\x0a',_0x1875bc+=_0x22992b(0x16b)+_0x4a26e2[_0x22992b(0x1d5)]+'\x0a',_0x1875bc+=_0x22992b(0x1db)+_0x4a26e2[_0x22992b(0x20e)][_0x22992b(0x199)](0x0,0xf)+'...`\x0a\x0a';}),await this[_0x46c7db(0x17d)]?.[_0x46c7db(0x16d)](_0xa5ffaa,_0x1875bc,{'parse_mode':'Markdown'});}catch(_0xc8e55f){console['error'](_0x46c7db(0x211),_0xc8e55f),await this['bot']?.[_0x46c7db(0x16d)](_0xa5ffaa,_0x46c7db(0x1e2));}}),this[_0x44ef9d(0x17d)]['on']('message',async _0x163714=>{const _0x57fc71=_0x44ef9d;if(_0x163714[_0x57fc71(0x170)]?.['startsWith']('/'))return;const _0x9d98a=_0x163714[_0x57fc71(0x155)]['id'],_0x40321e=_0x163714[_0x57fc71(0x1af)]?.['id']['toString'](),_0x29e5ed=_0x163714[_0x57fc71(0x170)]?.[_0x57fc71(0x1e4)]();if(!_0x40321e||!_0x29e5ed)return;try{const _0x15779c=await database_1[_0x57fc71(0x1e9)]['telegramUser'][_0x57fc71(0x1e7)]({'where':{'telegramId':_0x40321e},'include':{'shop':!![]}});if(!_0x15779c){await this[_0x57fc71(0x17d)]?.[_0x57fc71(0x16d)](_0x9d98a,_0x57fc71(0x1f9));return;}if(_0x15779c[_0x57fc71(0x20f)]&&_0x15779c['shopId']&&_0x15779c[_0x57fc71(0x168)]){await this['bot']?.['sendMessage'](_0x9d98a,'✅\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*'+_0x15779c['shop'][_0x57fc71(0x1f8)]+_0x57fc71(0x216)+_0x57fc71(0x1a5),{'parse_mode':_0x57fc71(0x1ce)});return;}const _0x566639=_0x29e5ed[_0x57fc71(0x1d4)](/\s+/);if(_0x566639[_0x57fc71(0x1bf)]!==0x2){await this[_0x57fc71(0x17d)]?.[_0x57fc71(0x16d)](_0x9d98a,'❌\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a'+_0x57fc71(0x145)+_0x57fc71(0x225)+_0x57fc71(0x177)+(_0x57fc71(0x193)+_0x566639[_0x57fc71(0x1bf)]+_0x57fc71(0x158)+_0x566639[_0x57fc71(0x1dd)](_0x5c9b4a=>'`'+_0x5c9b4a+'`')['join'](',\x20')),{'parse_mode':_0x57fc71(0x1ce)});return;}const [_0x9c4c16,_0x440bce]=_0x566639;console[_0x57fc71(0x1e1)]('🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20'+_0x40321e+_0x57fc71(0x1c3)+_0x9c4c16+_0x57fc71(0x1b1)+_0x440bce[_0x57fc71(0x199)](0x0,0xa)+_0x57fc71(0x16c)),await this[_0x57fc71(0x176)](_0x9d98a,_0x40321e,_0x9c4c16,_0x440bce);}catch(_0x439dca){console[_0x57fc71(0x212)](_0x57fc71(0x1e6),_0x439dca),await this['bot']?.[_0x57fc71(0x16d)](_0x9d98a,_0x57fc71(0x174));}}),this['bot']['on'](_0x44ef9d(0x212),_0x273cf1=>{const _0x27aace=_0x44ef9d;console[_0x27aace(0x212)](_0x27aace(0x1a1),_0x273cf1);}),this['bot']['on'](_0x44ef9d(0x1fd),_0x4c603c=>{const _0x21bf79=_0x44ef9d;console['error'](_0x21bf79(0x188),_0x4c603c);});}async['handleSingleLineVerification'](_0x2d1b78,_0x4047ed,_0x4bb7f5,_0x3fced9){const _0x17304d=a55_0x2e8552;try{console[_0x17304d(0x1e1)]('🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20'+_0x4047ed+_0x17304d(0x1c3)+_0x4bb7f5+_0x17304d(0x1b1)+_0x3fced9['substring'](0x0,0xa)+'...\x22');if(!_0x4bb7f5||_0x4bb7f5[_0x17304d(0x1bf)]<0x3||_0x4bb7f5[_0x17304d(0x1bf)]>0x32||!/^[a-zA-Z0-9_]+$/[_0x17304d(0x1a4)](_0x4bb7f5)){await this[_0x17304d(0x17d)]?.[_0x17304d(0x16d)](_0x2d1b78,_0x17304d(0x190)+_0x4bb7f5+'`\x0a\x0a'+'Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).',{'parse_mode':'Markdown'});return;}if(!_0x3fced9||!_0x3fced9[_0x17304d(0x1f7)](_0x17304d(0x1d2))&&!_0x3fced9[_0x17304d(0x1f7)]('sk_')){await this[_0x17304d(0x17d)]?.[_0x17304d(0x16d)](_0x2d1b78,_0x17304d(0x21e)+_0x17304d(0x220),{'parse_mode':_0x17304d(0x1ce)});return;}const _0x1f6508=await database_1['default'][_0x17304d(0x168)][_0x17304d(0x1e7)]({'where':{'username':_0x4bb7f5},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x1f6508){const _0x2d8bba=await database_1[_0x17304d(0x1e9)][_0x17304d(0x168)]['findMany']({'select':{'username':!![],'name':!![]},'take':0x5});let _0x1ff939=_0x17304d(0x169)+_0x4bb7f5+'`\x20not\x20found.\x0a\x0a';_0x2d8bba[_0x17304d(0x1bf)]>0x0?(_0x1ff939+=_0x17304d(0x153),_0x2d8bba['forEach'](_0xbec5af=>{const _0x48a6ea=_0x17304d;_0x1ff939+=_0x48a6ea(0x1df)+_0xbec5af[_0x48a6ea(0x22a)]+_0x48a6ea(0x1cc)+_0xbec5af[_0x48a6ea(0x1f8)]+')\x0a';}),_0x1ff939+=_0x17304d(0x191)):_0x1ff939+=_0x17304d(0x227);await this[_0x17304d(0x17d)]?.[_0x17304d(0x16d)](_0x2d1b78,_0x1ff939,{'parse_mode':_0x17304d(0x1ce)});return;}if(_0x1f6508[_0x17304d(0x1d5)]!==_0x17304d(0x21f)){await this[_0x17304d(0x17d)]?.[_0x17304d(0x16d)](_0x2d1b78,_0x17304d(0x17a)+_0x4bb7f5+_0x17304d(0x1da)+_0x17304d(0x1eb),{'parse_mode':_0x17304d(0x1ce)});return;}if(_0x1f6508[_0x17304d(0x20e)]!==_0x3fced9&&_0x1f6508['secretKey']!==_0x3fced9){await this['bot']?.[_0x17304d(0x16d)](_0x2d1b78,'❌\x20API\x20key\x20does\x20not\x20match\x20shop\x20`'+_0x4bb7f5+_0x17304d(0x1ca)+_0x17304d(0x1e5)+_0x17304d(0x205),{'parse_mode':_0x17304d(0x1ce)});return;}const _0x21c175=await database_1[_0x17304d(0x1e9)][_0x17304d(0x1f0)][_0x17304d(0x173)]({'where':{'shopId':_0x1f6508['id'],'isVerified':!![],'telegramId':{'not':_0x4047ed}}});if(_0x21c175){await this[_0x17304d(0x17d)]?.[_0x17304d(0x16d)](_0x2d1b78,_0x17304d(0x172)+_0x4bb7f5+_0x17304d(0x1ca)+_0x17304d(0x22f),{'parse_mode':_0x17304d(0x1ce)});return;}await database_1[_0x17304d(0x1e9)][_0x17304d(0x1f0)][_0x17304d(0x200)]({'where':{'telegramId':_0x4047ed},'data':{'shopId':_0x1f6508['id'],'isVerified':!![]}}),await this[_0x17304d(0x17d)]?.[_0x17304d(0x16d)](_0x2d1b78,_0x17304d(0x203)+_0x17304d(0x206)+(_0x17304d(0x164)+_0x1f6508[_0x17304d(0x1f8)]+'*\x0a')+(_0x17304d(0x17e)+_0x1f6508[_0x17304d(0x22a)]+'`\x0a\x0a')+_0x17304d(0x198)+_0x17304d(0x194)+_0x17304d(0x204)+'•\x20Payouts\x0a'+_0x17304d(0x182)+_0x17304d(0x165)+_0x17304d(0x1b2)+_0x17304d(0x14a),{'parse_mode':_0x17304d(0x1ce)}),console[_0x17304d(0x1e1)](_0x17304d(0x166)+_0x4047ed+_0x17304d(0x1e8)+_0x1f6508[_0x17304d(0x22a)]+'\x20via\x20single-line\x20input');}catch(_0x6717f7){console['error']('Error\x20in\x20handleSingleLineVerification:',_0x6717f7),await this[_0x17304d(0x17d)]?.[_0x17304d(0x16d)](_0x2d1b78,_0x17304d(0x184));}}async[a55_0x2e8552(0x1fa)](_0x45633e,_0x4059bc,_0x54fa09){const _0x3f92d0=a55_0x2e8552;if(!this[_0x3f92d0(0x17d)]){console['warn']('Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification');return;}try{const _0x12c340=await database_1[_0x3f92d0(0x1e9)][_0x3f92d0(0x1f0)][_0x3f92d0(0x15d)]({'where':{'shopId':_0x45633e,'isVerified':!![]}});if(_0x12c340['length']===0x0){console[_0x3f92d0(0x1e1)](_0x3f92d0(0x1de)+_0x45633e);return;}const _0x4e0eda=_0x12c340[_0x3f92d0(0x1dd)](async _0x17f3aa=>{const _0x46b0fb=_0x3f92d0;try{await this['bot']?.['sendMessage'](_0x17f3aa[_0x46b0fb(0x17b)],_0x4059bc,_0x54fa09),console['log']('✅\x20Notification\x20sent\x20to\x20Telegram\x20user\x20'+_0x17f3aa[_0x46b0fb(0x17b)]);}catch(_0xe4f399){console[_0x46b0fb(0x212)]('❌\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20'+_0x17f3aa['telegramId']+':',_0xe4f399),_0xe4f399 instanceof Error&&(_0xe4f399['message'][_0x46b0fb(0x18c)]('blocked')||_0xe4f399[_0x46b0fb(0x18a)][_0x46b0fb(0x18c)](_0x46b0fb(0x1d9))||_0xe4f399[_0x46b0fb(0x18a)][_0x46b0fb(0x18c)](_0x46b0fb(0x180)))&&(await database_1[_0x46b0fb(0x1e9)]['telegramUser'][_0x46b0fb(0x200)]({'where':{'id':_0x17f3aa['id']},'data':{'isVerified':![]}}),console[_0x46b0fb(0x1e1)](_0x46b0fb(0x148)+_0x17f3aa[_0x46b0fb(0x17b)]+_0x46b0fb(0x1c6)));}});await Promise[_0x3f92d0(0x149)](_0x4e0eda);}catch(_0x5d810e){console[_0x3f92d0(0x212)](_0x3f92d0(0x19e),_0x5d810e);}}async[a55_0x2e8552(0x1bc)](_0x1f48cd,_0x75cec8,_0x42de19){const _0xb5e69e=a55_0x2e8552,_0x5ce239={'created':'🆕','paid':'✅','failed':'❌','expired':'⏰','refund':'🔄','chargeback':'⚠️','processing':'⚙️'},_0x2a50ec={'created':'New\x20payment\x20created','paid':_0xb5e69e(0x179),'failed':_0xb5e69e(0x1f1),'expired':_0xb5e69e(0x1fb),'refund':'Payment\x20refund','chargeback':_0xb5e69e(0x1f5),'processing':_0xb5e69e(0x1a3)},_0x195208=_0x5ce239[_0x42de19],_0x1cbfcc=_0x2a50ec[_0x42de19],_0x1b4550=(0x0,gateway_1[_0xb5e69e(0x17c)])(_0x75cec8['gateway']);console[_0xb5e69e(0x1e1)](_0xb5e69e(0x1a9)+_0x75cec8[_0xb5e69e(0x1bd)]+'\x22\x20->\x20display\x20\x22'+_0x1b4550+'\x22');let _0x5061f1=_0x195208+'\x20*'+_0x1cbfcc+_0xb5e69e(0x1b9)+(_0xb5e69e(0x20a)+_0x75cec8[_0xb5e69e(0x150)]+'\x20'+_0x75cec8[_0xb5e69e(0x162)]+'*\x0a')+(_0xb5e69e(0x15b)+(_0x75cec8[_0xb5e69e(0x1dc)]||_0x75cec8['id'])+'`\x0a')+('🆔\x20Payment\x20ID:\x20`'+_0x75cec8['id']+'`\x0a')+(_0xb5e69e(0x163)+_0x1b4550+'`\x0a')+(_0xb5e69e(0x183)+new Date(_0x75cec8[_0xb5e69e(0x1e0)])['toLocaleString'](_0xb5e69e(0x1b6))+'\x0a');if(_0x75cec8[_0xb5e69e(0x144)]||_0x75cec8[_0xb5e69e(0x192)]||_0x75cec8['remitterIban']||_0x75cec8[_0xb5e69e(0x151)]||_0x75cec8[_0xb5e69e(0x1c8)]){_0x5061f1+=_0xb5e69e(0x223);_0x75cec8['customerName']&&(_0x5061f1+=_0xb5e69e(0x1d1)+_0x75cec8[_0xb5e69e(0x144)]+'`\x0a');_0x75cec8[_0xb5e69e(0x192)]&&(_0x5061f1+=_0xb5e69e(0x186)+_0x75cec8[_0xb5e69e(0x192)]+'`\x0a');_0x75cec8['remitterIban']&&(_0x5061f1+=_0xb5e69e(0x1c5)+_0x75cec8[_0xb5e69e(0x1b3)]+'`\x0a');_0x75cec8[_0xb5e69e(0x151)]&&(_0x5061f1+=_0xb5e69e(0x15a)+_0x75cec8['customerIp']+'`\x0a');if(_0x75cec8[_0xb5e69e(0x1c8)]){const _0x1a608f=_0x75cec8[_0xb5e69e(0x1c8)][_0xb5e69e(0x1bf)]>0x32?_0x75cec8['customerUa'][_0xb5e69e(0x199)](0x0,0x32)+_0xb5e69e(0x1b7):_0x75cec8[_0xb5e69e(0x1c8)];_0x5061f1+='💻\x20Browser:\x20`'+_0x1a608f+'`\x0a';}}_0x42de19==='chargeback'&&_0x75cec8[_0xb5e69e(0x1d8)]&&(_0x5061f1+=_0xb5e69e(0x1ba)+_0x75cec8[_0xb5e69e(0x1d8)]+'\x20USDT*\x0a'),_0x42de19===_0xb5e69e(0x209)&&(_0x5061f1+=_0xb5e69e(0x1f6)),_0x75cec8[_0xb5e69e(0x147)]&&(_0x5061f1+=_0xb5e69e(0x1e3)+_0x75cec8['adminNotes']+'\x0a'),await this[_0xb5e69e(0x1fa)](_0x1f48cd,_0x5061f1,{'parse_mode':_0xb5e69e(0x1ce)});}async[a55_0x2e8552(0x22c)](_0x4f6bf2,_0x1a03dc,_0x1d1a8d){const _0x47b699=a55_0x2e8552,_0x133d3c={'created':'📤','completed':'✅','rejected':'❌'},_0x26324a={'created':_0x47b699(0x1ed),'completed':_0x47b699(0x232),'rejected':_0x47b699(0x1ec)},_0x50117f=_0x133d3c[_0x1d1a8d],_0x2e45e8=_0x26324a[_0x1d1a8d],_0x24e48a=_0x50117f+'\x20*'+_0x2e45e8+_0x47b699(0x1b9)+(_0x47b699(0x1b5)+_0x1a03dc['amount']+_0x47b699(0x1bb))+('🏦\x20Method:\x20`'+_0x1a03dc[_0x47b699(0x19d)]+'`\x0a')+(_0x47b699(0x1d6)+_0x1a03dc['id']+'`\x0a')+(_0x47b699(0x183)+new Date(_0x1a03dc['createdAt'])[_0x47b699(0x22b)](_0x47b699(0x1b6))+'\x0a')+(_0x1a03dc['txid']?_0x47b699(0x1c1)+_0x1a03dc[_0x47b699(0x22e)]+'`':'');await this[_0x47b699(0x1fa)](_0x4f6bf2,_0x24e48a,{'parse_mode':'Markdown'});}async[a55_0x2e8552(0x196)](_0x5ac670,_0x407708){const _0x4bb78f=a55_0x2e8552;try{const _0x4cd3ab=await database_1[_0x4bb78f(0x1e9)]['shopSettings'][_0x4bb78f(0x1e7)]({'where':{'shopId':_0x5ac670},'select':{'notificationLogin':!![]}});if(!_0x4cd3ab?.['notificationLogin']){console[_0x4bb78f(0x1e1)](_0x4bb78f(0x185)+_0x5ac670);return;}const _0x7cb8eb=_0x407708[_0x4bb78f(0x1f3)]?'🔐':'🚨',_0x11cf67=_0x407708[_0x4bb78f(0x1f3)]?_0x4bb78f(0x178):_0x4bb78f(0x1aa);let _0x22b383=_0x7cb8eb+'\x20*'+_0x11cf67+_0x4bb78f(0x1b9)+('👤\x20Username:\x20`'+_0x407708['username']+'`\x0a')+(_0x4bb78f(0x19c)+_0x407708[_0x4bb78f(0x1b8)][_0x4bb78f(0x22b)]('en-US')+'\x0a');_0x407708[_0x4bb78f(0x146)]&&(_0x22b383+=_0x4bb78f(0x202)+_0x407708[_0x4bb78f(0x146)]+'`\x0a');if(_0x407708[_0x4bb78f(0x1a2)]){const _0x3510e3=_0x407708[_0x4bb78f(0x1a2)]['length']>0x32?_0x407708[_0x4bb78f(0x1a2)][_0x4bb78f(0x199)](0x0,0x32)+'...':_0x407708[_0x4bb78f(0x1a2)];_0x22b383+=_0x4bb78f(0x1cb)+_0x3510e3+'`\x0a';}!_0x407708[_0x4bb78f(0x1f3)]&&(_0x22b383+=_0x4bb78f(0x157)),await this[_0x4bb78f(0x1fa)](_0x5ac670,_0x22b383,{'parse_mode':_0x4bb78f(0x1ce)}),console['log'](_0x4bb78f(0x208)+_0x5ac670+':\x20'+(_0x407708[_0x4bb78f(0x1f3)]?_0x4bb78f(0x1f3):'failed'));}catch(_0x301b8f){console['error'](_0x4bb78f(0x22d),_0x301b8f);}}async['sendApiErrorNotification'](_0x2c3486,_0x2a47d0){const _0x3e6ec2=a55_0x2e8552;try{const _0x49c61e=await database_1[_0x3e6ec2(0x1e9)]['shopSettings'][_0x3e6ec2(0x1e7)]({'where':{'shopId':_0x2c3486},'select':{'notificationApiError':!![]}});if(!_0x49c61e?.['notificationApiError']){console[_0x3e6ec2(0x1e1)](_0x3e6ec2(0x1fe)+_0x2c3486);return;}let _0x2df629=_0x3e6ec2(0x1cf)+(_0x3e6ec2(0x1d7)+_0x2a47d0[_0x3e6ec2(0x19d)]+'\x20'+_0x2a47d0[_0x3e6ec2(0x19f)]+'`\x0a')+(_0x3e6ec2(0x19c)+_0x2a47d0[_0x3e6ec2(0x1b8)][_0x3e6ec2(0x22b)](_0x3e6ec2(0x1b6))+'\x0a');_0x2a47d0[_0x3e6ec2(0x229)]&&(_0x2df629+=_0x3e6ec2(0x1b0)+_0x2a47d0[_0x3e6ec2(0x229)]+'`\x0a'),_0x2df629+=_0x3e6ec2(0x1ff)+_0x2a47d0['errorMessage']+'`\x0a',_0x2a47d0[_0x3e6ec2(0x167)]&&(_0x2df629+=_0x3e6ec2(0x1d3)+_0x2a47d0[_0x3e6ec2(0x167)]+'`\x0a'),_0x2df629+='\x0a💡\x20Check\x20your\x20request\x20or\x20contact\x20support.',await this[_0x3e6ec2(0x1fa)](_0x2c3486,_0x2df629,{'parse_mode':_0x3e6ec2(0x1ce)}),console[_0x3e6ec2(0x1e1)](_0x3e6ec2(0x1ea)+_0x2c3486+':\x20'+_0x2a47d0[_0x3e6ec2(0x19f)]);}catch(_0x4f433e){console[_0x3e6ec2(0x212)](_0x3e6ec2(0x1d0),_0x4f433e);}}async['sendCustomNotification'](_0x3729be,_0xf9b65d,_0x5bffad){const _0x74aed5=a55_0x2e8552;let _0xfdbe4c=_0x74aed5(0x16a)+_0xf9b65d+_0x74aed5(0x1b9);for(const [_0x2d3020,_0x4ddafd]of Object[_0x74aed5(0x1c4)](_0x5bffad)){_0x4ddafd!==null&&_0x4ddafd!==undefined&&(_0xfdbe4c+=_0x2d3020+_0x74aed5(0x20b)+_0x4ddafd+'`\x0a');}await this[_0x74aed5(0x1fa)](_0x3729be,_0xfdbe4c,{'parse_mode':_0x74aed5(0x1ce)});}[a55_0x2e8552(0x15c)](){const _0x53babb=a55_0x2e8552;return{'isActive':!!this['bot'],'username':this[_0x53babb(0x175)]};}[a55_0x2e8552(0x17f)](){const _0x2fac01=a55_0x2e8552;this[_0x2fac01(0x17d)]&&(this[_0x2fac01(0x17d)][_0x2fac01(0x1a6)](),this[_0x2fac01(0x17d)]=null,console[_0x2fac01(0x1e1)](_0x2fac01(0x189)));}}exports[a55_0x2e8552(0x1ae)]=TelegramBotService,exports['telegramBotService']=new TelegramBotService();