'use strict';const a54_0x34b34c=a54_0x41c2;(function(_0x592765,_0x2482bb){const _0x3b7e1b=a54_0x41c2,_0x2ab25b=_0x592765();while(!![]){try{const _0x435e16=parseInt(_0x3b7e1b(0x1ed))/0x1+parseInt(_0x3b7e1b(0x206))/0x2+-parseInt(_0x3b7e1b(0x21f))/0x3*(-parseInt(_0x3b7e1b(0x1ee))/0x4)+parseInt(_0x3b7e1b(0x1c3))/0x5*(parseInt(_0x3b7e1b(0x225))/0x6)+-parseInt(_0x3b7e1b(0x1ca))/0x7+-parseInt(_0x3b7e1b(0x1eb))/0x8*(-parseInt(_0x3b7e1b(0x1c9))/0x9)+-parseInt(_0x3b7e1b(0x211))/0xa;if(_0x435e16===_0x2482bb)break;else _0x2ab25b['push'](_0x2ab25b['shift']());}catch(_0x5144c4){_0x2ab25b['push'](_0x2ab25b['shift']());}}}(a54_0x4689,0xc8bc3));function a54_0x4689(){const _0xa5880f=['Failed\x20login\x20attempt','Payment\x20is\x20being\x20processed','❗️\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!','customerEmail','❌\x20API\x20key\x20does\x20not\x20match\x20shop\x20`','Payment\x20failed','Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.','❌\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a','Error\x20handling\x20/status\x20command:','✅\x20Telegram\x20bot\x20@','findUnique','botUsername','📱\x20Shop:\x20*','✅\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*','Commands:\x0a','sendShopNotification','sendPaymentNotification','../types/gateway','telegramUser','✅\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20','forEach','🏦\x20Method:\x20`','Telegram\x20bot\x20error:','adminNotes','getBotInfo','Payment\x20refund','text','method','last_name','Error\x20handling\x20/debug\x20command:','defineProperty','sendLoginNotification','sk_','❌\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.','Markdown','isVerified','You\x20sent\x20','Telegram\x20bot\x20polling\x20error:','currency','/disconnect\x20-\x20disconnect\x20from\x20notifications','initializeBot','\x20USDT*\x0a','\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure','Use\x20/start\x20to\x20connect.','🔔\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a','substring','❌\x20Failed\x20to\x20initialize\x20Telegram\x20bot:','\x20initialized\x20successfully','customerIp','Payment\x20expired','shopId','🏪\x20Gateway:\x20`','❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','shopSettings','startsWith','Error\x20sending\x20shop\x20notification:','map','`\x0a\x0a','getGatewayDisplayNameForTelegram','✅\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*','•\x20New\x20payments\x0a','167545AeXnzB','📅\x20Time:\x20','entries','📱\x20Created\x20new\x20Telegram\x20user:\x20','You\x20are\x20already\x20connected\x20to\x20shop:\x20*','sendMessage','27LdUoQa','1150611tefFpY','✅\x20Welcome\x20back!\x0a\x0a','📊\x20Error\x20code:\x20`','trim','📧\x20Email:\x20`','Payment\x20chargeback','`.\x0a\x0a','📛\x20Name:\x20`','•\x20Payouts\x0a','\x0a⚠️\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!','botToken','❌\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a','status','test','📅\x20Date:\x20','Payout\x20completed','setupBotHandlers','📱\x20Login\x20notifications\x20disabled\x20for\x20shop\x20','toLocaleDateString','length','🏪\x20Available\x20shops\x20in\x20system:\x0a','🔔\x20*','node-telegram-bot-api','allSettled','🆔\x20Payment\x20ID:\x20`','createdAt','Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a','chat','create','\x20USD*\x0a','failed','/status\x20-\x20check\x20connection\x20status\x0a','name','1851352FCMppw','amount','7685lQEjBC','2264428fgbyzy','error','ACTIVE','🔔\x20Notifications\x20are\x20active\x0a\x0a','from','errorMessage','🆔\x20Payout\x20ID:\x20`','join','💸\x20Amount:\x20*','telegramBotService','findMany','en-US','env','Check\x20spelling\x20and\x20try\x20again.','update','shop','default','pk_','onText','statusCode','Available\x20usernames:\x0a','•\x20Important\x20events\x0a\x0a','•\x20Payment\x20status\x20changes\x0a','`\x20(','1711084FveRFM','🔔\x20You\x20receive\x20notifications\x20about:\x0a','publicKey','secretKey','\x22\x20->\x20display\x20\x22','❌\x20Shop\x20with\x20username\x20`','customerUa','To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a','Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification','\x22,\x20apiKey=\x22','`\x20not\x20found.\x0a\x0a','32780370qjFpxA','❌\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20','Example:\x0a','📱\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20','🔌\x20User\x20','Payout\x20rejected','sendApiErrorNotification','💻\x20Browser:\x20`','🛑\x20Telegram\x20bot\x20stopped','log','❌\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`','processing','✅\x20Connected\x20to\x20shop:\x20*','user\x20is\x20deactivated','6YOEvvG','Error\x20handling\x20/start\x20command:','\x20via\x20single-line\x20input','includes','TELEGRAM_BOT_TOKEN','bot','282UIfUwG','__esModule','User\x20','TelegramBotService','split','❌\x20Error\x20getting\x20debug\x20information.','\x20parts:\x20','toString','message','Error\x20handling\x20message:','🤖\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a','findFirst','orderId','...\x22','✅\x20Login\x20notification\x20sent\x20for\x20shop\x20','*.\x0a\x0a','requestId','chargebackAmount','Contact\x20administrator.','\x20\x20\x20Username:\x20`','⏳\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a','sendPayoutNotification','TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables','👤\x20Username:\x20`','🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20','✅\x20Notification\x20sent\x20to\x20Telegram\x20user\x20','Payment\x20successfully\x20paid','💰\x20Amount:\x20*','customerName','timestamp','❌\x20Error:\x20`','📊\x20*Connection\x20Status*\x0a\x0a','txid','❌\x20An\x20error\x20occurred\x20while\x20verifying\x20data.','first_name','chargeback','userAgent','Use\x20/start\x20to\x20begin.','API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','unknown\x20shop','ipAddress','notificationLogin','remitterIban','telegramId','📝\x20Notes:\x20','🔄\x20Reset\x20incomplete\x20verification\x20for\x20user\x20','\x20verified\x20for\x20shop\x20',':\x20`','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','`\x20is\x20inactive.\x0a\x0a','*\x0a\x0a','🎉\x20*Congratulations!*\x0a\x0a',':\x20username=\x22','__importDefault','Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).','📱\x20Telegram\x20notification:\x20gateway\x20\x22','...','toLocaleString','username','🌐\x20IP\x20address:\x20`','💸\x20Penalty\x20amount:\x20*','📅\x20Connection\x20date:\x20','updatedAt','🌐\x20IP:\x20`','polling_error','handleSingleLineVerification','Successful\x20login','../config/database','warn','notificationApiError','success','endpoint','\x0aCheck\x20spelling\x20and\x20try\x20again.','.\x20*','🚨\x20*API\x20Error*\x0a\x0a','•\x20`','❌\x20Please\x20use\x20/start\x20command\x20first','Username:\x20`','🔗\x20TXID:\x20`','Failed\x20to\x20send\x20login\x20notification:','✅\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a','📝\x20Order\x20ID:\x20`'];a54_0x4689=function(){return _0xa5880f;};return a54_0x4689();}var __importDefault=this&&this[a54_0x34b34c(0x25a)]||function(_0x37794e){const _0x5b2cd2=a54_0x34b34c;return _0x37794e&&_0x37794e[_0x5b2cd2(0x226)]?_0x37794e:{'default':_0x37794e};};Object[a54_0x34b34c(0x1a4)](exports,a54_0x34b34c(0x226),{'value':!![]}),exports[a54_0x34b34c(0x1f7)]=exports['TelegramBotService']=void 0x0;const node_telegram_bot_api_1=__importDefault(require(a54_0x34b34c(0x1e0))),database_1=__importDefault(require(a54_0x34b34c(0x177))),gateway_1=require(a54_0x34b34c(0x197));class TelegramBotService{constructor(){const _0x37bcf6=a54_0x34b34c;this[_0x37bcf6(0x224)]=null,this['botToken']=process[_0x37bcf6(0x1fa)][_0x37bcf6(0x223)]||'',this[_0x37bcf6(0x191)]=process[_0x37bcf6(0x1fa)]['TELEGRAM_BOT_USERNAME']||'trapay_bot',this[_0x37bcf6(0x1d4)]?this[_0x37bcf6(0x1ae)]():console[_0x37bcf6(0x178)](_0x37bcf6(0x23b));}[a54_0x34b34c(0x1ae)](){const _0x4bcb9a=a54_0x34b34c;try{this['bot']=new node_telegram_bot_api_1[(_0x4bcb9a(0x1fe))](this[_0x4bcb9a(0x1d4)],{'polling':!![]}),this[_0x4bcb9a(0x1da)](),console[_0x4bcb9a(0x21a)](_0x4bcb9a(0x18f)+this[_0x4bcb9a(0x191)]+_0x4bcb9a(0x1b5));}catch(_0x247cba){console[_0x4bcb9a(0x1ef)](_0x4bcb9a(0x1b4),_0x247cba);}}[a54_0x34b34c(0x1da)](){const _0x4105a5=a54_0x34b34c;if(!this[_0x4105a5(0x224)])return;this[_0x4105a5(0x224)][_0x4105a5(0x200)](/\/start/,async _0x4af9c3=>{const _0x426c1b=_0x4105a5,_0x45fe00=_0x4af9c3[_0x426c1b(0x1e5)]['id'],_0x299cdf=_0x4af9c3['from']?.['id'][_0x426c1b(0x22c)](),_0xb38576=_0x4af9c3[_0x426c1b(0x1f2)]?.[_0x426c1b(0x25f)],_0x374595=_0x4af9c3[_0x426c1b(0x1f2)]?.[_0x426c1b(0x247)],_0x24954b=_0x4af9c3[_0x426c1b(0x1f2)]?.[_0x426c1b(0x1a2)];if(!_0x299cdf)return;try{let _0x38a046=await database_1['default'][_0x426c1b(0x198)]['findUnique']({'where':{'telegramId':_0x299cdf},'include':{'shop':!![]}});!_0x38a046?(_0x38a046=await database_1['default'][_0x426c1b(0x198)][_0x426c1b(0x1e6)]({'data':{'telegramId':_0x299cdf,'username':_0xb38576,'firstName':_0x374595,'lastName':_0x24954b,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console[_0x426c1b(0x21a)](_0x426c1b(0x1c6)+_0x299cdf+'\x20(@'+_0xb38576+')')):_0x38a046=await database_1[_0x426c1b(0x1fe)][_0x426c1b(0x198)][_0x426c1b(0x1fc)]({'where':{'telegramId':_0x299cdf},'data':{'username':_0xb38576,'firstName':_0x374595,'lastName':_0x24954b},'include':{'shop':!![]}}),_0x38a046[_0x426c1b(0x1a9)]&&_0x38a046['shopId']&&_0x38a046[_0x426c1b(0x1fd)]?await this[_0x426c1b(0x224)]?.['sendMessage'](_0x45fe00,_0x426c1b(0x1cb)+(_0x426c1b(0x1c7)+_0x38a046[_0x426c1b(0x1fd)]['name']+'*\x0a')+(_0x426c1b(0x181)+_0x38a046['shop'][_0x426c1b(0x25f)]+'`\x0a\x0a')+_0x426c1b(0x207)+_0x426c1b(0x1c2)+_0x426c1b(0x204)+'•\x20Payouts\x0a\x0a'+'Commands:\x0a'+_0x426c1b(0x1e9)+_0x426c1b(0x1ad),{'parse_mode':'Markdown'}):(_0x38a046[_0x426c1b(0x1b8)]&&!_0x38a046['isVerified']&&(await database_1[_0x426c1b(0x1fe)][_0x426c1b(0x198)][_0x426c1b(0x1fc)]({'where':{'telegramId':_0x299cdf},'data':{'shopId':null,'isVerified':![]}}),console[_0x426c1b(0x21a)](_0x426c1b(0x252)+_0x299cdf)),await this[_0x426c1b(0x224)]?.[_0x426c1b(0x1c8)](_0x45fe00,_0x426c1b(0x22f)+_0x426c1b(0x20d)+'📝\x20Format:\x20`username\x20api_key`\x0a\x0a'+_0x426c1b(0x213)+_0x426c1b(0x255)+_0x426c1b(0x188),{'parse_mode':_0x426c1b(0x1a8)}));}catch(_0x32e5ce){console[_0x426c1b(0x1ef)](_0x426c1b(0x220),_0x32e5ce),await this[_0x426c1b(0x224)]?.[_0x426c1b(0x1c8)](_0x45fe00,_0x426c1b(0x1ba));}}),this[_0x4105a5(0x224)]['onText'](/\/disconnect/,async _0x3e1b6e=>{const _0x459c57=_0x4105a5,_0x5ba46f=_0x3e1b6e[_0x459c57(0x1e5)]['id'],_0x9b4576=_0x3e1b6e[_0x459c57(0x1f2)]?.['id'][_0x459c57(0x22c)]();if(!_0x9b4576)return;try{const _0x5a614c=await database_1['default'][_0x459c57(0x198)][_0x459c57(0x190)]({'where':{'telegramId':_0x9b4576},'include':{'shop':!![]}});if(!_0x5a614c||!_0x5a614c['isVerified']||!_0x5a614c[_0x459c57(0x1b8)]){await this[_0x459c57(0x224)]?.[_0x459c57(0x1c8)](_0x5ba46f,_0x459c57(0x1a7));return;}const _0x1db2b9=_0x5a614c[_0x459c57(0x1fd)]?.[_0x459c57(0x1ea)]||_0x459c57(0x24c);await database_1[_0x459c57(0x1fe)][_0x459c57(0x198)][_0x459c57(0x1fc)]({'where':{'telegramId':_0x9b4576},'data':{'shopId':null,'isVerified':![]}}),console['log'](_0x459c57(0x215)+_0x9b4576+'\x20disconnected\x20from\x20shop\x20'+_0x5a614c[_0x459c57(0x1b8)]),await this['bot']?.['sendMessage'](_0x5ba46f,_0x459c57(0x193)+_0x1db2b9+_0x459c57(0x234)+'To\x20reconnect,\x20use\x20the\x20/start\x20command',{'parse_mode':_0x459c57(0x1a8)});}catch(_0x384ba7){console[_0x459c57(0x1ef)]('Error\x20handling\x20/disconnect\x20command:',_0x384ba7),await this[_0x459c57(0x224)]?.[_0x459c57(0x1c8)](_0x5ba46f,_0x459c57(0x1ba));}}),this['bot'][_0x4105a5(0x200)](/\/status/,async _0x37cdd2=>{const _0x33e9e6=_0x4105a5,_0x44e4be=_0x37cdd2[_0x33e9e6(0x1e5)]['id'],_0x53020e=_0x37cdd2[_0x33e9e6(0x1f2)]?.['id'][_0x33e9e6(0x22c)]();if(!_0x53020e)return;try{const _0x14eac6=await database_1['default'][_0x33e9e6(0x198)][_0x33e9e6(0x190)]({'where':{'telegramId':_0x53020e},'include':{'shop':!![]}});if(!_0x14eac6){await this[_0x33e9e6(0x224)]?.[_0x33e9e6(0x1c8)](_0x44e4be,'❌\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a'+_0x33e9e6(0x24a));return;}if(!_0x14eac6[_0x33e9e6(0x1a9)]||!_0x14eac6['shopId']||!_0x14eac6[_0x33e9e6(0x1fd)]){await this['bot']?.[_0x33e9e6(0x1c8)](_0x44e4be,_0x33e9e6(0x18d)+_0x33e9e6(0x1b1));return;}await this['bot']?.['sendMessage'](_0x44e4be,_0x33e9e6(0x244)+(_0x33e9e6(0x21d)+_0x14eac6['shop'][_0x33e9e6(0x1ea)]+'*\x0a')+(_0x33e9e6(0x23c)+_0x14eac6[_0x33e9e6(0x1fd)]['username']+'`\x0a')+(_0x33e9e6(0x262)+_0x14eac6[_0x33e9e6(0x263)][_0x33e9e6(0x1dc)](_0x33e9e6(0x1f9))+'\x0a\x0a')+_0x33e9e6(0x1f1)+_0x33e9e6(0x194)+_0x33e9e6(0x1ad),{'parse_mode':_0x33e9e6(0x1a8)});}catch(_0x2562c3){console['error'](_0x33e9e6(0x18e),_0x2562c3),await this[_0x33e9e6(0x224)]?.['sendMessage'](_0x44e4be,_0x33e9e6(0x1ba));}}),this['bot'][_0x4105a5(0x200)](/\/debug/,async _0x1edfa6=>{const _0xd93ea2=_0x4105a5,_0xdc0653=_0x1edfa6[_0xd93ea2(0x1e5)]['id'],_0x4c17e2=_0x1edfa6[_0xd93ea2(0x1f2)]?.['id'][_0xd93ea2(0x22c)]();if(!_0x4c17e2)return;try{const _0x95675a=await database_1[_0xd93ea2(0x1fe)][_0xd93ea2(0x1fd)][_0xd93ea2(0x1f8)]({'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![]},'take':0xa});let _0x41039d='🔍\x20*Debug\x20Information*\x0a\x0a';_0x41039d+='📱\x20Your\x20Telegram\x20ID:\x20`'+_0x4c17e2+'`\x0a\x0a',_0x41039d+=_0xd93ea2(0x1de),_0x95675a[_0xd93ea2(0x19a)]((_0x4bf6e3,_0x3423d8)=>{const _0x2b1280=_0xd93ea2;_0x41039d+=_0x3423d8+0x1+_0x2b1280(0x17d)+_0x4bf6e3[_0x2b1280(0x1ea)]+'*\x0a',_0x41039d+=_0x2b1280(0x238)+_0x4bf6e3[_0x2b1280(0x25f)]+'`\x0a',_0x41039d+='\x20\x20\x20Status:\x20'+_0x4bf6e3[_0x2b1280(0x1d6)]+'\x0a',_0x41039d+='\x20\x20\x20Public\x20Key:\x20`'+_0x4bf6e3['publicKey']['substring'](0x0,0xf)+'...`\x0a\x0a';}),await this[_0xd93ea2(0x224)]?.[_0xd93ea2(0x1c8)](_0xdc0653,_0x41039d,{'parse_mode':_0xd93ea2(0x1a8)});}catch(_0x1596d9){console['error'](_0xd93ea2(0x1a3),_0x1596d9),await this[_0xd93ea2(0x224)]?.[_0xd93ea2(0x1c8)](_0xdc0653,_0xd93ea2(0x22a));}}),this[_0x4105a5(0x224)]['on']('message',async _0x3645d5=>{const _0x21bc6e=_0x4105a5;if(_0x3645d5[_0x21bc6e(0x1a0)]?.[_0x21bc6e(0x1bc)]('/'))return;const _0x36e371=_0x3645d5[_0x21bc6e(0x1e5)]['id'],_0x26c092=_0x3645d5[_0x21bc6e(0x1f2)]?.['id'][_0x21bc6e(0x22c)](),_0x5b2a77=_0x3645d5['text']?.[_0x21bc6e(0x1cd)]();if(!_0x26c092||!_0x5b2a77)return;try{const _0x37e93d=await database_1[_0x21bc6e(0x1fe)]['telegramUser']['findUnique']({'where':{'telegramId':_0x26c092},'include':{'shop':!![]}});if(!_0x37e93d){await this[_0x21bc6e(0x224)]?.[_0x21bc6e(0x1c8)](_0x36e371,_0x21bc6e(0x180));return;}if(_0x37e93d['isVerified']&&_0x37e93d['shopId']&&_0x37e93d['shop']){await this['bot']?.[_0x21bc6e(0x1c8)](_0x36e371,_0x21bc6e(0x1c1)+_0x37e93d[_0x21bc6e(0x1fd)][_0x21bc6e(0x1ea)]+_0x21bc6e(0x234)+'Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.',{'parse_mode':'Markdown'});return;}const _0x5301ef=_0x5b2a77[_0x21bc6e(0x229)](/\s+/);if(_0x5301ef['length']!==0x2){await this[_0x21bc6e(0x224)]?.[_0x21bc6e(0x1c8)](_0x36e371,_0x21bc6e(0x1d5)+'📝\x20Format:\x20`username\x20api_key`\x0a\x0a'+'Example:\x0a'+_0x21bc6e(0x255)+(_0x21bc6e(0x1aa)+_0x5301ef[_0x21bc6e(0x1dd)]+_0x21bc6e(0x22b)+_0x5301ef['map'](_0xfc97d0=>'`'+_0xfc97d0+'`')[_0x21bc6e(0x1f5)](',\x20')),{'parse_mode':_0x21bc6e(0x1a8)});return;}const [_0x478e88,_0x2d66fe]=_0x5301ef;console[_0x21bc6e(0x21a)](_0x21bc6e(0x23d)+_0x26c092+_0x21bc6e(0x259)+_0x478e88+_0x21bc6e(0x20f)+_0x2d66fe[_0x21bc6e(0x1b3)](0x0,0xa)+_0x21bc6e(0x232)),await this[_0x21bc6e(0x175)](_0x36e371,_0x26c092,_0x478e88,_0x2d66fe);}catch(_0x284ce3){console[_0x21bc6e(0x1ef)](_0x21bc6e(0x22e),_0x284ce3),await this[_0x21bc6e(0x224)]?.[_0x21bc6e(0x1c8)](_0x36e371,_0x21bc6e(0x1ba));}}),this[_0x4105a5(0x224)]['on']('error',_0x3621cf=>{const _0x237cb7=_0x4105a5;console[_0x237cb7(0x1ef)](_0x237cb7(0x19c),_0x3621cf);}),this[_0x4105a5(0x224)]['on'](_0x4105a5(0x174),_0x456940=>{const _0x4c0897=_0x4105a5;console['error'](_0x4c0897(0x1ab),_0x456940);});}async[a54_0x34b34c(0x175)](_0x27ece0,_0x4abd76,_0xd32e5b,_0x3b22eb){const _0x25988a=a54_0x34b34c;try{console[_0x25988a(0x21a)](_0x25988a(0x23d)+_0x4abd76+_0x25988a(0x259)+_0xd32e5b+_0x25988a(0x20f)+_0x3b22eb[_0x25988a(0x1b3)](0x0,0xa)+_0x25988a(0x232));if(!_0xd32e5b||_0xd32e5b[_0x25988a(0x1dd)]<0x3||_0xd32e5b[_0x25988a(0x1dd)]>0x32||!/^[a-zA-Z0-9_]+$/[_0x25988a(0x1d7)](_0xd32e5b)){await this[_0x25988a(0x224)]?.[_0x25988a(0x1c8)](_0x27ece0,'❌\x20Invalid\x20username\x20format:\x20`'+_0xd32e5b+'`\x0a\x0a'+_0x25988a(0x25b),{'parse_mode':'Markdown'});return;}if(!_0x3b22eb||!_0x3b22eb[_0x25988a(0x1bc)](_0x25988a(0x1ff))&&!_0x3b22eb['startsWith'](_0x25988a(0x1a6))){await this[_0x25988a(0x224)]?.[_0x25988a(0x1c8)](_0x27ece0,'❌\x20Invalid\x20API\x20key\x20format.\x0a\x0a'+_0x25988a(0x24b),{'parse_mode':_0x25988a(0x1a8)});return;}const _0x2c843d=await database_1[_0x25988a(0x1fe)][_0x25988a(0x1fd)][_0x25988a(0x190)]({'where':{'username':_0xd32e5b},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x2c843d){const _0x3d38fe=await database_1[_0x25988a(0x1fe)][_0x25988a(0x1fd)][_0x25988a(0x1f8)]({'select':{'username':!![],'name':!![]},'take':0x5});let _0x51a81f=_0x25988a(0x20b)+_0xd32e5b+_0x25988a(0x210);_0x3d38fe['length']>0x0?(_0x51a81f+=_0x25988a(0x202),_0x3d38fe[_0x25988a(0x19a)](_0x1e55cf=>{const _0x21faa2=_0x25988a;_0x51a81f+=_0x21faa2(0x17f)+_0x1e55cf[_0x21faa2(0x25f)]+_0x21faa2(0x205)+_0x1e55cf[_0x21faa2(0x1ea)]+')\x0a';}),_0x51a81f+=_0x25988a(0x17c)):_0x51a81f+=_0x25988a(0x1fb);await this['bot']?.[_0x25988a(0x1c8)](_0x27ece0,_0x51a81f,{'parse_mode':_0x25988a(0x1a8)});return;}if(_0x2c843d[_0x25988a(0x1d6)]!==_0x25988a(0x1f0)){await this['bot']?.[_0x25988a(0x1c8)](_0x27ece0,'❌\x20Shop\x20`'+_0xd32e5b+_0x25988a(0x256)+_0x25988a(0x237),{'parse_mode':_0x25988a(0x1a8)});return;}if(_0x2c843d[_0x25988a(0x208)]!==_0x3b22eb&&_0x2c843d[_0x25988a(0x209)]!==_0x3b22eb){await this[_0x25988a(0x224)]?.[_0x25988a(0x1c8)](_0x27ece0,_0x25988a(0x18a)+_0xd32e5b+_0x25988a(0x1d0)+_0x25988a(0x1e4)+'Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`',{'parse_mode':_0x25988a(0x1a8)});return;}const _0x1d1f2a=await database_1[_0x25988a(0x1fe)]['telegramUser'][_0x25988a(0x230)]({'where':{'shopId':_0x2c843d['id'],'isVerified':!![],'telegramId':{'not':_0x4abd76}}});if(_0x1d1f2a){await this[_0x25988a(0x224)]?.['sendMessage'](_0x27ece0,_0x25988a(0x21b)+_0xd32e5b+_0x25988a(0x1d0)+_0x25988a(0x18c),{'parse_mode':_0x25988a(0x1a8)});return;}await database_1[_0x25988a(0x1fe)]['telegramUser'][_0x25988a(0x1fc)]({'where':{'telegramId':_0x4abd76},'data':{'shopId':_0x2c843d['id'],'isVerified':!![]}}),await this[_0x25988a(0x224)]?.[_0x25988a(0x1c8)](_0x27ece0,_0x25988a(0x258)+_0x25988a(0x184)+(_0x25988a(0x192)+_0x2c843d[_0x25988a(0x1ea)]+'*\x0a')+(_0x25988a(0x23c)+_0x2c843d[_0x25988a(0x25f)]+_0x25988a(0x1bf))+_0x25988a(0x1b2)+_0x25988a(0x1c2)+_0x25988a(0x204)+_0x25988a(0x1d2)+_0x25988a(0x203)+_0x25988a(0x194)+_0x25988a(0x1e9)+_0x25988a(0x1ad),{'parse_mode':_0x25988a(0x1a8)}),console['log']('✅\x20Telegram\x20user\x20'+_0x4abd76+_0x25988a(0x253)+_0x2c843d[_0x25988a(0x25f)]+_0x25988a(0x221));}catch(_0x29af14){console['error']('Error\x20in\x20handleSingleLineVerification:',_0x29af14),await this['bot']?.[_0x25988a(0x1c8)](_0x27ece0,_0x25988a(0x246));}}async[a54_0x34b34c(0x195)](_0x49ef1c,_0x200856,_0xcb69fd){const _0x214efc=a54_0x34b34c;if(!this['bot']){console[_0x214efc(0x178)](_0x214efc(0x20e));return;}try{const _0x12e6a6=await database_1[_0x214efc(0x1fe)][_0x214efc(0x198)][_0x214efc(0x1f8)]({'where':{'shopId':_0x49ef1c,'isVerified':!![]}});if(_0x12e6a6[_0x214efc(0x1dd)]===0x0){console[_0x214efc(0x21a)]('No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20'+_0x49ef1c);return;}const _0x52df21=_0x12e6a6[_0x214efc(0x1be)](async _0x5ab27a=>{const _0x15cf3a=_0x214efc;try{await this['bot']?.[_0x15cf3a(0x1c8)](_0x5ab27a['telegramId'],_0x200856,_0xcb69fd),console[_0x15cf3a(0x21a)](_0x15cf3a(0x23e)+_0x5ab27a[_0x15cf3a(0x250)]);}catch(_0x386914){console['error'](_0x15cf3a(0x212)+_0x5ab27a[_0x15cf3a(0x250)]+':',_0x386914),_0x386914 instanceof Error&&(_0x386914[_0x15cf3a(0x22d)][_0x15cf3a(0x222)]('blocked')||_0x386914['message']['includes']('chat\x20not\x20found')||_0x386914[_0x15cf3a(0x22d)][_0x15cf3a(0x222)](_0x15cf3a(0x21e)))&&(await database_1[_0x15cf3a(0x1fe)][_0x15cf3a(0x198)][_0x15cf3a(0x1fc)]({'where':{'id':_0x5ab27a['id']},'data':{'isVerified':![]}}),console[_0x15cf3a(0x21a)](_0x15cf3a(0x227)+_0x5ab27a[_0x15cf3a(0x250)]+_0x15cf3a(0x1b0)));}});await Promise[_0x214efc(0x1e1)](_0x52df21);}catch(_0x1b61c2){console[_0x214efc(0x1ef)](_0x214efc(0x1bd),_0x1b61c2);}}async[a54_0x34b34c(0x196)](_0xa486ba,_0x3143ff,_0x12fd8c){const _0x3d5275=a54_0x34b34c,_0x43f2eb={'created':'🆕','paid':'✅','failed':'❌','expired':'⏰','refund':'🔄','chargeback':'⚠️','processing':'⚙️'},_0xb486d0={'created':'New\x20payment\x20created','paid':_0x3d5275(0x23f),'failed':_0x3d5275(0x18b),'expired':_0x3d5275(0x1b7),'refund':_0x3d5275(0x19f),'chargeback':_0x3d5275(0x1cf),'processing':_0x3d5275(0x187)},_0x48002a=_0x43f2eb[_0x12fd8c],_0x42ccf4=_0xb486d0[_0x12fd8c],_0x4bb5e3=(0x0,gateway_1[_0x3d5275(0x1c0)])(_0x3143ff['gateway']);console['log'](_0x3d5275(0x25c)+_0x3143ff['gateway']+_0x3d5275(0x20a)+_0x4bb5e3+'\x22');let _0x30fa79=_0x48002a+'\x20*'+_0x42ccf4+_0x3d5275(0x257)+(_0x3d5275(0x240)+_0x3143ff[_0x3d5275(0x1ec)]+'\x20'+_0x3143ff[_0x3d5275(0x1ac)]+'*\x0a')+(_0x3d5275(0x185)+(_0x3143ff[_0x3d5275(0x231)]||_0x3143ff['id'])+'`\x0a')+(_0x3d5275(0x1e2)+_0x3143ff['id']+'`\x0a')+(_0x3d5275(0x1b9)+_0x4bb5e3+'`\x0a')+('📅\x20Date:\x20'+new Date(_0x3143ff['createdAt'])[_0x3d5275(0x25e)](_0x3d5275(0x1f9))+'\x0a');if(_0x3143ff['customerName']||_0x3143ff[_0x3d5275(0x189)]||_0x3143ff[_0x3d5275(0x24f)]||_0x3143ff[_0x3d5275(0x1b6)]||_0x3143ff['customerUa']){_0x30fa79+='\x0a👤\x20*Customer\x20Information:*\x0a';_0x3143ff[_0x3d5275(0x241)]&&(_0x30fa79+=_0x3d5275(0x1d1)+_0x3143ff[_0x3d5275(0x241)]+'`\x0a');_0x3143ff[_0x3d5275(0x189)]&&(_0x30fa79+=_0x3d5275(0x1ce)+_0x3143ff['customerEmail']+'`\x0a');_0x3143ff[_0x3d5275(0x24f)]&&(_0x30fa79+='🏦\x20IBAN:\x20`'+_0x3143ff[_0x3d5275(0x24f)]+'`\x0a');_0x3143ff[_0x3d5275(0x1b6)]&&(_0x30fa79+=_0x3d5275(0x173)+_0x3143ff['customerIp']+'`\x0a');if(_0x3143ff[_0x3d5275(0x20c)]){const _0x12554c=_0x3143ff['customerUa'][_0x3d5275(0x1dd)]>0x32?_0x3143ff['customerUa'][_0x3d5275(0x1b3)](0x0,0x32)+_0x3d5275(0x25d):_0x3143ff[_0x3d5275(0x20c)];_0x30fa79+=_0x3d5275(0x218)+_0x12554c+'`\x0a';}}_0x12fd8c===_0x3d5275(0x248)&&_0x3143ff[_0x3d5275(0x236)]&&(_0x30fa79+=_0x3d5275(0x261)+_0x3143ff['chargebackAmount']+_0x3d5275(0x1af)),_0x12fd8c===_0x3d5275(0x21c)&&(_0x30fa79+=_0x3d5275(0x239)),_0x3143ff[_0x3d5275(0x19d)]&&(_0x30fa79+=_0x3d5275(0x251)+_0x3143ff[_0x3d5275(0x19d)]+'\x0a'),await this[_0x3d5275(0x195)](_0xa486ba,_0x30fa79,{'parse_mode':'Markdown'});}async[a54_0x34b34c(0x23a)](_0x3e0280,_0x168508,_0x1ce112){const _0x3b8ac7=a54_0x34b34c,_0x440f24={'created':'📤','completed':'✅','rejected':'❌'},_0x4a9919={'created':'New\x20payout\x20created','completed':_0x3b8ac7(0x1d9),'rejected':_0x3b8ac7(0x216)},_0x2292cc=_0x440f24[_0x1ce112],_0x34cbb3=_0x4a9919[_0x1ce112],_0x37ed4d=_0x2292cc+'\x20*'+_0x34cbb3+_0x3b8ac7(0x257)+(_0x3b8ac7(0x1f6)+_0x168508['amount']+_0x3b8ac7(0x1e7))+(_0x3b8ac7(0x19b)+_0x168508['method']+'`\x0a')+(_0x3b8ac7(0x1f4)+_0x168508['id']+'`\x0a')+(_0x3b8ac7(0x1d8)+new Date(_0x168508[_0x3b8ac7(0x1e3)])[_0x3b8ac7(0x25e)](_0x3b8ac7(0x1f9))+'\x0a')+(_0x168508[_0x3b8ac7(0x245)]?_0x3b8ac7(0x182)+_0x168508[_0x3b8ac7(0x245)]+'`':'');await this[_0x3b8ac7(0x195)](_0x3e0280,_0x37ed4d,{'parse_mode':_0x3b8ac7(0x1a8)});}async[a54_0x34b34c(0x1a5)](_0x595ab3,_0x5df9ea){const _0x3268f0=a54_0x34b34c;try{const _0x1c2301=await database_1['default'][_0x3268f0(0x1bb)]['findUnique']({'where':{'shopId':_0x595ab3},'select':{'notificationLogin':!![]}});if(!_0x1c2301?.[_0x3268f0(0x24e)]){console[_0x3268f0(0x21a)](_0x3268f0(0x1db)+_0x595ab3);return;}const _0x5d8b94=_0x5df9ea['success']?'🔐':'🚨',_0x1daeac=_0x5df9ea['success']?_0x3268f0(0x176):_0x3268f0(0x186);let _0x2b851c=_0x5d8b94+'\x20*'+_0x1daeac+'*\x0a\x0a'+(_0x3268f0(0x23c)+_0x5df9ea[_0x3268f0(0x25f)]+'`\x0a')+(_0x3268f0(0x1c4)+_0x5df9ea[_0x3268f0(0x242)][_0x3268f0(0x25e)](_0x3268f0(0x1f9))+'\x0a');_0x5df9ea[_0x3268f0(0x24d)]&&(_0x2b851c+=_0x3268f0(0x260)+_0x5df9ea['ipAddress']+'`\x0a');if(_0x5df9ea[_0x3268f0(0x249)]){const _0x4134cf=_0x5df9ea['userAgent']['length']>0x32?_0x5df9ea[_0x3268f0(0x249)][_0x3268f0(0x1b3)](0x0,0x32)+_0x3268f0(0x25d):_0x5df9ea[_0x3268f0(0x249)];_0x2b851c+=_0x3268f0(0x218)+_0x4134cf+'`\x0a';}!_0x5df9ea[_0x3268f0(0x17a)]&&(_0x2b851c+=_0x3268f0(0x1d3)),await this[_0x3268f0(0x195)](_0x595ab3,_0x2b851c,{'parse_mode':_0x3268f0(0x1a8)}),console[_0x3268f0(0x21a)](_0x3268f0(0x233)+_0x595ab3+':\x20'+(_0x5df9ea[_0x3268f0(0x17a)]?_0x3268f0(0x17a):_0x3268f0(0x1e8)));}catch(_0x358c9b){console[_0x3268f0(0x1ef)](_0x3268f0(0x183),_0x358c9b);}}async[a54_0x34b34c(0x217)](_0x2fc18d,_0x45e9a0){const _0x19baae=a54_0x34b34c;try{const _0x3437a3=await database_1['default'][_0x19baae(0x1bb)][_0x19baae(0x190)]({'where':{'shopId':_0x2fc18d},'select':{'notificationApiError':!![]}});if(!_0x3437a3?.[_0x19baae(0x179)]){console[_0x19baae(0x21a)](_0x19baae(0x214)+_0x2fc18d);return;}let _0x57f00d=_0x19baae(0x17e)+('🔗\x20Endpoint:\x20`'+_0x45e9a0[_0x19baae(0x1a1)]+'\x20'+_0x45e9a0['endpoint']+'`\x0a')+(_0x19baae(0x1c4)+_0x45e9a0[_0x19baae(0x242)][_0x19baae(0x25e)](_0x19baae(0x1f9))+'\x0a');_0x45e9a0[_0x19baae(0x201)]&&(_0x57f00d+=_0x19baae(0x1cc)+_0x45e9a0['statusCode']+'`\x0a'),_0x57f00d+=_0x19baae(0x243)+_0x45e9a0[_0x19baae(0x1f3)]+'`\x0a',_0x45e9a0[_0x19baae(0x235)]&&(_0x57f00d+='🆔\x20Request\x20ID:\x20`'+_0x45e9a0['requestId']+'`\x0a'),_0x57f00d+='\x0a💡\x20Check\x20your\x20request\x20or\x20contact\x20support.',await this[_0x19baae(0x195)](_0x2fc18d,_0x57f00d,{'parse_mode':_0x19baae(0x1a8)}),console[_0x19baae(0x21a)](_0x19baae(0x199)+_0x2fc18d+':\x20'+_0x45e9a0[_0x19baae(0x17b)]);}catch(_0x4a4089){console[_0x19baae(0x1ef)]('Failed\x20to\x20send\x20API\x20error\x20notification:',_0x4a4089);}}async['sendCustomNotification'](_0x548902,_0x229b29,_0x714df4){const _0x466881=a54_0x34b34c;let _0x15f12b=_0x466881(0x1df)+_0x229b29+'*\x0a\x0a';for(const [_0x380d11,_0x56e4a2]of Object[_0x466881(0x1c5)](_0x714df4)){_0x56e4a2!==null&&_0x56e4a2!==undefined&&(_0x15f12b+=_0x380d11+_0x466881(0x254)+_0x56e4a2+'`\x0a');}await this[_0x466881(0x195)](_0x548902,_0x15f12b,{'parse_mode':_0x466881(0x1a8)});}[a54_0x34b34c(0x19e)](){const _0xfcb75=a54_0x34b34c;return{'isActive':!!this[_0xfcb75(0x224)],'username':this['botUsername']};}['stopBot'](){const _0x9a0009=a54_0x34b34c;this[_0x9a0009(0x224)]&&(this['bot']['stopPolling'](),this[_0x9a0009(0x224)]=null,console[_0x9a0009(0x21a)](_0x9a0009(0x219)));}}function a54_0x41c2(_0x212f41,_0x2e5146){const _0x46890f=a54_0x4689();return a54_0x41c2=function(_0x41c2c4,_0x1556b2){_0x41c2c4=_0x41c2c4-0x173;let _0x436afb=_0x46890f[_0x41c2c4];return _0x436afb;},a54_0x41c2(_0x212f41,_0x2e5146);}exports[a54_0x34b34c(0x228)]=TelegramBotService,exports['telegramBotService']=new TelegramBotService();