'use strict';const a66_0x494577=a66_0x437c;function a66_0x3c77(){const _0x1dc15a=['✅\x20Welcome\x20back!\x0a\x0a','network','❌\x20Shop\x20`','includes','userAgent','bot','createdAt','timestamp','trapay_bot','`\x0a\x0a','TELEGRAM_BOT_USERNAME','from','\x0a👤\x20*Customer\x20Information:*\x0a','../config/database','🌐\x20IP\x20address:\x20`','Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).','🔗\x20Endpoint:\x20`','Error\x20handling\x20message:','*.\x0a\x0a','text','📅\x20Time:\x20','Failed\x20to\x20send\x20login\x20notification:','entries','❌\x20Error:\x20`','Payment\x20successfully\x20paid','🔔\x20Notifications\x20are\x20active\x0a\x0a','chargebackAmount','\x0a💡\x20Check\x20your\x20request\x20or\x20contact\x20support.','default','1674NOGwAP','To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a','telegramUser','118214coDgwR','sendLoginNotification','log','Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification','❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','❌\x20Failed\x20to\x20initialize\x20Telegram\x20bot:','📱\x20Notification\x20sent\x20to\x20','startsWith','shopId','Failed\x20to\x20send\x20API\x20error\x20notification:','You\x20sent\x20','setupBotHandlers','message','Failed\x20login\x20attempt','.jpeg','❌\x20Shop\x20with\x20username\x20`','❌\x20You\x20are\x20not\x20connected\x20to\x20any\x20shop.\x0a\x0a','status','`\x20is\x20inactive.\x0a\x0a','📛\x20Name:\x20`','sendPayoutNotification','findUnique',':\x20`','🎉\x20*Congratulations!*\x0a\x0a','❌\x20Failed\x20to\x20send\x20message\x20to\x20user\x20','📱\x20Created\x20new\x20Telegram\x20user:\x20','application/pdf','.png','❌\x20Failed\x20to\x20send\x20notification\x20to\x20all\x20users:','env','3933ixpILW','\x20initialized\x20successfully','customerIp','amount','651010WEOvLz','sendShopNotification','You\x20are\x20already\x20connected\x20to\x20shop:\x20*','❌\x20Error\x20getting\x20debug\x20information.','Example:\x0a','•\x20New\x20payments\x0a','customerUa','processing','...','Make\x20sure\x20you\x20have\x20the\x20correct\x20username\x20from\x20your\x20account.','📝\x20Notes:\x20','🌐\x20IP:\x20`','✅\x20Connected\x20to\x20shop:\x20*','unknown\x20shop','toLocaleDateString','\x20users\x20of\x20shop\x20','❌\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a','✅\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*','__esModule','Markdown','❌\x20API\x20key\x20does\x20not\x20match\x20shop\x20`','💻\x20Browser:\x20`','🏦\x20IBAN:\x20`','💰\x20Amount:\x20*','*\x0a\x0a','error','💰\x20*Amount:*\x20','gateway','💸\x20Penalty\x20amount:\x20*','Use\x20/start\x20to\x20begin.','handleSingleLineVerification','User\x20','📱\x20No\x20active\x20Telegram\x20users\x20found','getGatewayDisplayNameForTelegram','🔔\x20*','Please\x20check\x20the\x20spelling\x20and\x20try\x20again.\x0a\x0a','sendApiErrorNotification','Payment\x20refund','findFirst','toString','TelegramBotService','telegramBotService','chat','✅\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a',':\x20username=\x22','📊\x20Error\x20code:\x20`','❌\x20Please\x20use\x20/start\x20command\x20first','Payment\x20is\x20being\x20processed','\x20\x20\x20Status:\x20','❌\x20Telegram\x20bot\x20not\x20initialized','polling_error','Error\x20handling\x20/status\x20command:','../types/gateway','txid','\x20users','🌍\x20Country:\x20','•\x20Payouts\x0a\x0a','join','Telegram\x20bot\x20error:','onText','remitterIban','•\x20Payment\x20status\x20changes\x0a','wallet','🆔\x20Request\x20ID:\x20`','•\x20Important\x20events\x0a\x0a','🚨\x20*API\x20Error*\x0a\x0a','•\x20Payouts\x0a','1419471udtbbc','endsWith','en-US','✅\x20File\x20sent\x20to\x20chat\x20','To\x20reconnect,\x20use\x20the\x20/start\x20command','❌\x20Error\x20sending\x20file\x20to\x20chat:','\x20verified\x20for\x20shop\x20','endpoint','telegramId','❌\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`','adminNotes','shop','stopBot','📱\x20Your\x20Telegram\x20ID:\x20`','sendPaymentNotification','username','✅\x20Telegram\x20bot\x20@','sendCustomNotification','✅\x20Direct\x20message\x20sent\x20to\x20chat\x20','findMany','allSettled','❌\x20Error\x20sending\x20direct\x20message:','__importDefault','TELEGRAM_BOT_TOKEN','`.\x0a\x0a','test','407SZfbSV','Successful\x20login','initializeBot','🆔\x20Payment\x20ID:\x20`','🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20','toLocaleString','sendDirectMessage','❌\x20Invalid\x20username\x20format:\x20`','customerEmail','`\x20not\x20found.\x0a\x0a','Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.','🏪\x20Your\x20connected\x20shop:\x0a','Commands:\x0a','Telegram\x20bot\x20polling\x20error:','method','first_name','\x20\x20\x20Username:\x20`','node-telegram-bot-api','botUsername','📝\x20Order\x20ID:\x20`','🔌\x20User\x20','period','/disconnect\x20-\x20disconnect\x20from\x20notifications','\x20\x20\x20Name:\x20*','\x20disconnected\x20from\x20shop\x20','✅\x20Notification\x20sent\x20to\x20Telegram\x20user\x20','statusCode','\x22,\x20apiKey=\x22','isVerified','split','🔗\x20*Transaction\x20Link:*\x20Pending','API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','❌\x20An\x20error\x20occurred\x20while\x20verifying\x20data.','❌\x20Error\x20sending\x20file\x20to\x20user\x20','image/jpeg','blocked','\x20(@','sendShopFile','👤\x20Username:\x20`','New\x20payment\x20created','defineProperty','substring','Error\x20handling\x20/disconnect\x20command:','chat\x20not\x20found','success','length','💳\x20*Wallet:*\x20`','5418680lNCUjP','name','last_name','sendNotificationToAll','✅\x20Telegram\x20user\x20','map','🔍\x20*Debug\x20Information*\x0a\x0a','No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20','Contact\x20administrator.','\x20USD\x0a','trim','📝\x20Format:\x20`username\x20api_key`\x0a\x0a','464LxVMEZ','sendDocument','\x22\x20->\x20display\x20\x22','failed','image/png','botToken','errorMessage','7730233ojLEXC','🔔\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a','✅\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*','\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure','customerName','secretKey','update','/status\x20-\x20check\x20connection\x20status\x0a','🌐\x20*Network:*\x20','notificationApiError','Not\x20specified','💸\x20*New\x20Payout*\x0a\x0a','publicKey','orderId','2NATfwk','❗️\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!','2-digit','Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a','sk_','\x20parts:\x20','requestId','ipAddress','Error\x20in\x20handleSingleLineVerification:','❌\x20Error\x20sending\x20file\x20to\x20shop:','.jpg','📱\x20Login\x20notifications\x20disabled\x20for\x20shop\x20','updatedAt','currency','7255akfsnV','notificationLogin','Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.','...\x22','❌\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.','❌\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a','📅\x20*Payout\x20Date:*\x20','❌\x20Invalid\x20API\x20key\x20format.\x0a\x0a','pk_','sendMessage','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','shopSettings','Use\x20/start\x20to\x20connect.'];a66_0x3c77=function(){return _0x1dc15a;};return a66_0x3c77();}(function(_0x1f8ac4,_0x58c26f){const _0x2651d4=a66_0x437c,_0x3bd71d=_0x1f8ac4();while(!![]){try{const _0x3c8761=parseInt(_0x2651d4(0x1b1))/0x1*(-parseInt(_0x2651d4(0x176))/0x2)+parseInt(_0x2651d4(0x1cf))/0x3*(-parseInt(_0x2651d4(0x161))/0x4)+parseInt(_0x2651d4(0x184))/0x5*(parseInt(_0x2651d4(0x1ae))/0x6)+-parseInt(_0x2651d4(0x168))/0x7+-parseInt(_0x2651d4(0x155))/0x8+-parseInt(_0x2651d4(0x216))/0x9+parseInt(_0x2651d4(0x1d3))/0xa*(parseInt(_0x2651d4(0x230))/0xb);if(_0x3c8761===_0x58c26f)break;else _0x3bd71d['push'](_0x3bd71d['shift']());}catch(_0x5df5c0){_0x3bd71d['push'](_0x3bd71d['shift']());}}}(a66_0x3c77,0x936ff));function a66_0x437c(_0xf9e316,_0x5bbd39){const _0x3c7765=a66_0x3c77();return a66_0x437c=function(_0x437c0d,_0xad41ec){_0x437c0d=_0x437c0d-0x147;let _0x382efa=_0x3c7765[_0x437c0d];return _0x382efa;},a66_0x437c(_0xf9e316,_0x5bbd39);}var __importDefault=this&&this[a66_0x494577(0x22c)]||function(_0x1de4c3){const _0x2a814c=a66_0x494577;return _0x1de4c3&&_0x1de4c3[_0x2a814c(0x1e5)]?_0x1de4c3:{'default':_0x1de4c3};};Object[a66_0x494577(0x14e)](exports,a66_0x494577(0x1e5),{'value':!![]}),exports[a66_0x494577(0x1fc)]=exports[a66_0x494577(0x1fb)]=void 0x0;const node_telegram_bot_api_1=__importDefault(require(a66_0x494577(0x241))),database_1=__importDefault(require(a66_0x494577(0x19e))),gateway_1=require(a66_0x494577(0x207));class TelegramBotService{constructor(){const _0x364ef7=a66_0x494577;this[_0x364ef7(0x196)]=null,this['botToken']=process['env'][_0x364ef7(0x22d)]||'',this[_0x364ef7(0x242)]=process[_0x364ef7(0x1ce)][_0x364ef7(0x19b)]||_0x364ef7(0x199),this['botToken']?this['initializeBot']():console['warn']('TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables');}[a66_0x494577(0x232)](){const _0x48a03a=a66_0x494577;try{this[_0x48a03a(0x196)]=new node_telegram_bot_api_1[(_0x48a03a(0x1ad))](this[_0x48a03a(0x166)],{'polling':!![]}),this['setupBotHandlers'](),console[_0x48a03a(0x1b3)](_0x48a03a(0x226)+this['botUsername']+_0x48a03a(0x1d0));}catch(_0x12ad0e){console[_0x48a03a(0x1ec)](_0x48a03a(0x1b6),_0x12ad0e);}}[a66_0x494577(0x1bc)](){const _0x57f02e=a66_0x494577;if(!this[_0x57f02e(0x196)])return;this['bot'][_0x57f02e(0x20e)](/\/start/,async _0x3cf2aa=>{const _0xfec5b8=_0x57f02e,_0x19b4a9=_0x3cf2aa[_0xfec5b8(0x1fd)]['id'],_0x4e7a0f=_0x3cf2aa[_0xfec5b8(0x19c)]?.['id']['toString'](),_0xd781e4=_0x3cf2aa[_0xfec5b8(0x19c)]?.['username'],_0x26054e=_0x3cf2aa['from']?.[_0xfec5b8(0x23f)],_0x31c879=_0x3cf2aa[_0xfec5b8(0x19c)]?.[_0xfec5b8(0x157)];if(!_0x4e7a0f)return;try{let _0x503d15=await database_1[_0xfec5b8(0x1ad)]['telegramUser'][_0xfec5b8(0x1c6)]({'where':{'telegramId':_0x4e7a0f},'include':{'shop':!![]}});!_0x503d15?(_0x503d15=await database_1['default'][_0xfec5b8(0x1b0)]['create']({'data':{'telegramId':_0x4e7a0f,'username':_0xd781e4,'firstName':_0x26054e,'lastName':_0x31c879,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console[_0xfec5b8(0x1b3)](_0xfec5b8(0x1ca)+_0x4e7a0f+_0xfec5b8(0x14a)+_0xd781e4+')')):_0x503d15=await database_1[_0xfec5b8(0x1ad)][_0xfec5b8(0x1b0)]['update']({'where':{'telegramId':_0x4e7a0f},'data':{'username':_0xd781e4,'firstName':_0x26054e,'lastName':_0x31c879},'include':{'shop':!![]}}),_0x503d15[_0xfec5b8(0x24c)]&&_0x503d15['shopId']&&_0x503d15[_0xfec5b8(0x221)]?await this[_0xfec5b8(0x196)]?.[_0xfec5b8(0x18d)](_0x19b4a9,_0xfec5b8(0x191)+(_0xfec5b8(0x1d5)+_0x503d15[_0xfec5b8(0x221)][_0xfec5b8(0x156)]+'*\x0a')+('Username:\x20`'+_0x503d15[_0xfec5b8(0x221)][_0xfec5b8(0x225)]+_0xfec5b8(0x19a))+'🔔\x20You\x20receive\x20notifications\x20about:\x0a'+_0xfec5b8(0x1d8)+_0xfec5b8(0x210)+_0xfec5b8(0x20b)+_0xfec5b8(0x23c)+_0xfec5b8(0x16f)+_0xfec5b8(0x246),{'parse_mode':_0xfec5b8(0x1e6)}):(_0x503d15[_0xfec5b8(0x1b9)]&&!_0x503d15[_0xfec5b8(0x24c)]&&(await database_1[_0xfec5b8(0x1ad)]['telegramUser'][_0xfec5b8(0x16e)]({'where':{'telegramId':_0x4e7a0f},'data':{'shopId':null,'isVerified':![]}}),console[_0xfec5b8(0x1b3)]('🔄\x20Reset\x20incomplete\x20verification\x20for\x20user\x20'+_0x4e7a0f)),await this[_0xfec5b8(0x196)]?.[_0xfec5b8(0x18d)](_0x19b4a9,'🤖\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a'+_0xfec5b8(0x1af)+_0xfec5b8(0x160)+_0xfec5b8(0x1d7)+'`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a'+_0xfec5b8(0x177),{'parse_mode':_0xfec5b8(0x1e6)}));}catch(_0x2f3810){console[_0xfec5b8(0x1ec)]('Error\x20handling\x20/start\x20command:',_0x2f3810),await this[_0xfec5b8(0x196)]?.[_0xfec5b8(0x18d)](_0x19b4a9,'❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this[_0x57f02e(0x196)]['onText'](/\/disconnect/,async _0x46ef4d=>{const _0x20b534=_0x57f02e,_0x5543f0=_0x46ef4d[_0x20b534(0x1fd)]['id'],_0x4ba3ad=_0x46ef4d[_0x20b534(0x19c)]?.['id'][_0x20b534(0x1fa)]();if(!_0x4ba3ad)return;try{const _0xd522d5=await database_1[_0x20b534(0x1ad)][_0x20b534(0x1b0)][_0x20b534(0x1c6)]({'where':{'telegramId':_0x4ba3ad},'include':{'shop':!![]}});if(!_0xd522d5||!_0xd522d5[_0x20b534(0x24c)]||!_0xd522d5[_0x20b534(0x1b9)]){await this[_0x20b534(0x196)]?.[_0x20b534(0x18d)](_0x5543f0,_0x20b534(0x188));return;}const _0x1130bb=_0xd522d5[_0x20b534(0x221)]?.[_0x20b534(0x156)]||_0x20b534(0x1e0);await database_1[_0x20b534(0x1ad)]['telegramUser'][_0x20b534(0x16e)]({'where':{'telegramId':_0x4ba3ad},'data':{'shopId':null,'isVerified':![]}}),console[_0x20b534(0x1b3)](_0x20b534(0x244)+_0x4ba3ad+_0x20b534(0x248)+_0xd522d5['shopId']),await this['bot']?.[_0x20b534(0x18d)](_0x5543f0,_0x20b534(0x16a)+_0x1130bb+_0x20b534(0x1a3)+_0x20b534(0x21a),{'parse_mode':_0x20b534(0x1e6)});}catch(_0x429907){console[_0x20b534(0x1ec)](_0x20b534(0x150),_0x429907),await this[_0x20b534(0x196)]?.[_0x20b534(0x18d)](_0x5543f0,_0x20b534(0x1b5));}}),this[_0x57f02e(0x196)]['onText'](/\/status/,async _0x43726c=>{const _0x2ea785=_0x57f02e,_0x2a1355=_0x43726c[_0x2ea785(0x1fd)]['id'],_0x2ecccc=_0x43726c[_0x2ea785(0x19c)]?.['id']['toString']();if(!_0x2ecccc)return;try{const _0x1587a0=await database_1[_0x2ea785(0x1ad)][_0x2ea785(0x1b0)][_0x2ea785(0x1c6)]({'where':{'telegramId':_0x2ecccc},'include':{'shop':!![]}});if(!_0x1587a0){await this['bot']?.['sendMessage'](_0x2a1355,_0x2ea785(0x1e3)+_0x2ea785(0x1f0));return;}if(!_0x1587a0[_0x2ea785(0x24c)]||!_0x1587a0[_0x2ea785(0x1b9)]||!_0x1587a0[_0x2ea785(0x221)]){await this['bot']?.[_0x2ea785(0x18d)](_0x2a1355,'❌\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a'+_0x2ea785(0x190));return;}await this[_0x2ea785(0x196)]?.[_0x2ea785(0x18d)](_0x2a1355,'📊\x20*Connection\x20Status*\x0a\x0a'+(_0x2ea785(0x1df)+_0x1587a0[_0x2ea785(0x221)][_0x2ea785(0x156)]+'*\x0a')+(_0x2ea785(0x14c)+_0x1587a0['shop'][_0x2ea785(0x225)]+'`\x0a')+('📅\x20Connection\x20date:\x20'+_0x1587a0[_0x2ea785(0x182)][_0x2ea785(0x1e1)](_0x2ea785(0x218))+'\x0a\x0a')+_0x2ea785(0x1aa)+_0x2ea785(0x23c)+_0x2ea785(0x246),{'parse_mode':_0x2ea785(0x1e6)});}catch(_0x314c61){console['error'](_0x2ea785(0x206),_0x314c61),await this[_0x2ea785(0x196)]?.['sendMessage'](_0x2a1355,_0x2ea785(0x1b5));}}),this['bot'][_0x57f02e(0x20e)](/\/debug/,async _0x262bec=>{const _0x145ffa=_0x57f02e,_0x43aa26=_0x262bec[_0x145ffa(0x1fd)]['id'],_0xdce975=_0x262bec['from']?.['id'][_0x145ffa(0x1fa)]();if(!_0xdce975)return;try{const _0x31da68=await database_1[_0x145ffa(0x1ad)][_0x145ffa(0x1b0)][_0x145ffa(0x1c6)]({'where':{'telegramId':_0xdce975},'include':{'shop':!![]}});let _0x432eef=_0x145ffa(0x15b);_0x432eef+=_0x145ffa(0x223)+_0xdce975+_0x145ffa(0x19a),_0x31da68?.[_0x145ffa(0x24c)]&&_0x31da68[_0x145ffa(0x221)]?(_0x432eef+=_0x145ffa(0x23b),_0x432eef+=_0x145ffa(0x247)+_0x31da68[_0x145ffa(0x221)]['name']+'*\x0a',_0x432eef+=_0x145ffa(0x240)+_0x31da68[_0x145ffa(0x221)][_0x145ffa(0x225)]+'`\x0a',_0x432eef+=_0x145ffa(0x203)+_0x31da68[_0x145ffa(0x221)]['status']+'\x0a\x0a'):_0x432eef+=_0x145ffa(0x1c1),_0x432eef+='Use\x20/start\x20to\x20connect\x20to\x20a\x20shop.',await this['bot']?.['sendMessage'](_0x43aa26,_0x432eef,{'parse_mode':_0x145ffa(0x1e6)});}catch(_0x133642){console[_0x145ffa(0x1ec)]('Error\x20handling\x20/debug\x20command:',_0x133642),await this[_0x145ffa(0x196)]?.[_0x145ffa(0x18d)](_0x43aa26,_0x145ffa(0x1d6));}}),this[_0x57f02e(0x196)]['on'](_0x57f02e(0x1bd),async _0x414547=>{const _0x5170c=_0x57f02e;if(_0x414547['text']?.[_0x5170c(0x1b8)]('/'))return;const _0x5cca0d=_0x414547[_0x5170c(0x1fd)]['id'],_0x566b4f=_0x414547[_0x5170c(0x19c)]?.['id']['toString'](),_0x355232=_0x414547[_0x5170c(0x1a4)]?.[_0x5170c(0x15f)]();if(!_0x566b4f||!_0x355232)return;try{const _0x4f9781=await database_1[_0x5170c(0x1ad)][_0x5170c(0x1b0)][_0x5170c(0x1c6)]({'where':{'telegramId':_0x566b4f},'include':{'shop':!![]}});if(!_0x4f9781){await this[_0x5170c(0x196)]?.[_0x5170c(0x18d)](_0x5cca0d,_0x5170c(0x201));return;}if(_0x4f9781[_0x5170c(0x24c)]&&_0x4f9781[_0x5170c(0x1b9)]&&_0x4f9781[_0x5170c(0x221)]){await this[_0x5170c(0x196)]?.['sendMessage'](_0x5cca0d,_0x5170c(0x1e4)+_0x4f9781[_0x5170c(0x221)][_0x5170c(0x156)]+_0x5170c(0x1a3)+_0x5170c(0x186),{'parse_mode':'Markdown'});return;}const _0x36bfab=_0x355232[_0x5170c(0x24d)](/\s+/);if(_0x36bfab[_0x5170c(0x153)]!==0x2){await this[_0x5170c(0x196)]?.['sendMessage'](_0x5cca0d,_0x5170c(0x189)+_0x5170c(0x160)+_0x5170c(0x1d7)+_0x5170c(0x18e)+(_0x5170c(0x1bb)+_0x36bfab[_0x5170c(0x153)]+_0x5170c(0x17b)+_0x36bfab[_0x5170c(0x15a)](_0x5bac7b=>'`'+_0x5bac7b+'`')[_0x5170c(0x20c)](',\x20')),{'parse_mode':_0x5170c(0x1e6)});return;}const [_0x3bc5e5,_0x585bd5]=_0x36bfab;console[_0x5170c(0x1b3)](_0x5170c(0x234)+_0x566b4f+':\x20username=\x22'+_0x3bc5e5+_0x5170c(0x24b)+_0x585bd5[_0x5170c(0x14f)](0x0,0xa)+_0x5170c(0x187)),await this[_0x5170c(0x1f1)](_0x5cca0d,_0x566b4f,_0x3bc5e5,_0x585bd5);}catch(_0x3e65e8){console[_0x5170c(0x1ec)](_0x5170c(0x1a2),_0x3e65e8),await this['bot']?.['sendMessage'](_0x5cca0d,'❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this[_0x57f02e(0x196)]['on'](_0x57f02e(0x1ec),_0x39fa75=>{const _0x1d1db6=_0x57f02e;console[_0x1d1db6(0x1ec)](_0x1d1db6(0x20d),_0x39fa75);}),this[_0x57f02e(0x196)]['on'](_0x57f02e(0x205),_0xa0f7b9=>{const _0x1b15c0=_0x57f02e;console[_0x1b15c0(0x1ec)](_0x1b15c0(0x23d),_0xa0f7b9);});}async[a66_0x494577(0x1f1)](_0x342e6d,_0x4295d7,_0x29338d,_0x234896){const _0x22e062=a66_0x494577;try{console[_0x22e062(0x1b3)]('🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20'+_0x4295d7+_0x22e062(0x1ff)+_0x29338d+_0x22e062(0x24b)+_0x234896[_0x22e062(0x14f)](0x0,0xa)+'...\x22');if(!_0x29338d||_0x29338d['length']<0x3||_0x29338d[_0x22e062(0x153)]>0x32||!/^[a-zA-Z0-9_]+$/[_0x22e062(0x22f)](_0x29338d)){await this['bot']?.[_0x22e062(0x18d)](_0x342e6d,_0x22e062(0x237)+_0x29338d+'`\x0a\x0a'+_0x22e062(0x1a0),{'parse_mode':_0x22e062(0x1e6)});return;}if(!_0x234896||!_0x234896['startsWith'](_0x22e062(0x18c))&&!_0x234896['startsWith'](_0x22e062(0x17a))){await this['bot']?.[_0x22e062(0x18d)](_0x342e6d,_0x22e062(0x18b)+_0x22e062(0x24f),{'parse_mode':_0x22e062(0x1e6)});return;}const _0x46a870=await database_1[_0x22e062(0x1ad)][_0x22e062(0x221)]['findUnique']({'where':{'username':_0x29338d},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x46a870){const _0x3c9a11=_0x22e062(0x1c0)+_0x29338d+_0x22e062(0x239)+_0x22e062(0x1f6)+_0x22e062(0x1dc);await this['bot']?.['sendMessage'](_0x342e6d,_0x3c9a11,{'parse_mode':_0x22e062(0x1e6)});return;}if(_0x46a870[_0x22e062(0x1c2)]!=='ACTIVE'){await this[_0x22e062(0x196)]?.['sendMessage'](_0x342e6d,_0x22e062(0x193)+_0x29338d+_0x22e062(0x1c3)+_0x22e062(0x15d),{'parse_mode':'Markdown'});return;}if(_0x46a870[_0x22e062(0x174)]!==_0x234896&&_0x46a870[_0x22e062(0x16d)]!==_0x234896){await this[_0x22e062(0x196)]?.[_0x22e062(0x18d)](_0x342e6d,_0x22e062(0x1e7)+_0x29338d+_0x22e062(0x22e)+_0x22e062(0x179)+'Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`',{'parse_mode':_0x22e062(0x1e6)});return;}const _0x1aff39=await database_1[_0x22e062(0x1ad)][_0x22e062(0x1b0)][_0x22e062(0x1f9)]({'where':{'shopId':_0x46a870['id'],'isVerified':!![],'telegramId':{'not':_0x4295d7}}});if(_0x1aff39){await this['bot']?.[_0x22e062(0x18d)](_0x342e6d,_0x22e062(0x21f)+_0x29338d+_0x22e062(0x22e)+_0x22e062(0x23a),{'parse_mode':_0x22e062(0x1e6)});return;}await database_1['default'][_0x22e062(0x1b0)][_0x22e062(0x16e)]({'where':{'telegramId':_0x4295d7},'data':{'shopId':_0x46a870['id'],'isVerified':!![]}}),await this[_0x22e062(0x196)]?.[_0x22e062(0x18d)](_0x342e6d,_0x22e062(0x1c8)+_0x22e062(0x1fe)+('📱\x20Shop:\x20*'+_0x46a870['name']+'*\x0a')+('👤\x20Username:\x20`'+_0x46a870[_0x22e062(0x225)]+_0x22e062(0x19a))+_0x22e062(0x169)+_0x22e062(0x1d8)+_0x22e062(0x210)+_0x22e062(0x215)+_0x22e062(0x213)+_0x22e062(0x23c)+_0x22e062(0x16f)+_0x22e062(0x246),{'parse_mode':_0x22e062(0x1e6)}),console[_0x22e062(0x1b3)](_0x22e062(0x159)+_0x4295d7+_0x22e062(0x21c)+_0x46a870[_0x22e062(0x225)]+'\x20via\x20single-line\x20input');}catch(_0x1a9f8d){console[_0x22e062(0x1ec)](_0x22e062(0x17e),_0x1a9f8d),await this['bot']?.[_0x22e062(0x18d)](_0x342e6d,_0x22e062(0x250));}}async[a66_0x494577(0x1d4)](_0x2c74d6,_0x307871,_0x5a8000){const _0x5a182a=a66_0x494577;if(!this['bot']){console['warn'](_0x5a182a(0x1b4));return;}try{const _0x17e568=await database_1[_0x5a182a(0x1ad)][_0x5a182a(0x1b0)][_0x5a182a(0x229)]({'where':{'shopId':_0x2c74d6,'isVerified':!![]}});if(_0x17e568['length']===0x0){console[_0x5a182a(0x1b3)](_0x5a182a(0x15c)+_0x2c74d6);return;}const _0x9e34e5=_0x17e568[_0x5a182a(0x15a)](async _0x5ceb82=>{const _0x359931=_0x5a182a;try{await this[_0x359931(0x196)]?.[_0x359931(0x18d)](_0x5ceb82['telegramId'],_0x307871,_0x5a8000),console[_0x359931(0x1b3)](_0x359931(0x249)+_0x5ceb82['telegramId']);}catch(_0xde439a){console[_0x359931(0x1ec)]('❌\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20'+_0x5ceb82[_0x359931(0x21e)]+':',_0xde439a),_0xde439a instanceof Error&&(_0xde439a[_0x359931(0x1bd)][_0x359931(0x194)](_0x359931(0x149))||_0xde439a[_0x359931(0x1bd)]['includes'](_0x359931(0x151))||_0xde439a[_0x359931(0x1bd)][_0x359931(0x194)]('user\x20is\x20deactivated'))&&(await database_1[_0x359931(0x1ad)][_0x359931(0x1b0)]['update']({'where':{'id':_0x5ceb82['id']},'data':{'isVerified':![]}}),console[_0x359931(0x1b3)](_0x359931(0x1f2)+_0x5ceb82[_0x359931(0x21e)]+_0x359931(0x16b)));}});await Promise[_0x5a182a(0x22a)](_0x9e34e5);}catch(_0x492156){console['error']('Error\x20sending\x20shop\x20notification:',_0x492156);}}async[a66_0x494577(0x224)](_0x1315c0,_0x197c82,_0x13181d){const _0x505b24=a66_0x494577,_0x1bb011={'created':'🆕','paid':'✅','failed':'❌','expired':'⏰','refund':'🔄','chargeback':'⚠️','processing':'⚙️'},_0x57117c={'created':_0x505b24(0x14d),'paid':_0x505b24(0x1a9),'failed':'Payment\x20failed','expired':'Payment\x20expired','refund':_0x505b24(0x1f8),'chargeback':'Payment\x20chargeback','processing':_0x505b24(0x202)},_0x275bba=_0x1bb011[_0x13181d],_0x2357d6=_0x57117c[_0x13181d],_0x551d4=(0x0,gateway_1[_0x505b24(0x1f4)])(_0x197c82[_0x505b24(0x1ee)]);console[_0x505b24(0x1b3)]('📱\x20Telegram\x20notification:\x20gateway\x20\x22'+_0x197c82[_0x505b24(0x1ee)]+_0x505b24(0x163)+_0x551d4+'\x22');let _0x3f1689=_0x275bba+'\x20*'+_0x2357d6+_0x505b24(0x1eb)+(_0x505b24(0x1ea)+_0x197c82[_0x505b24(0x1d2)]+'\x20'+_0x197c82[_0x505b24(0x183)]+'*\x0a')+(_0x505b24(0x243)+(_0x197c82[_0x505b24(0x175)]||_0x197c82['id'])+'`\x0a')+(_0x505b24(0x233)+_0x197c82['id']+'`\x0a')+('🏪\x20Gateway:\x20`'+_0x551d4+'`\x0a')+('📅\x20Date:\x20'+new Date(_0x197c82[_0x505b24(0x197)])[_0x505b24(0x235)](_0x505b24(0x218))+'\x0a');if(_0x197c82[_0x505b24(0x16c)]||_0x197c82['customerEmail']||_0x197c82['remitterIban']||_0x197c82['customerIp']||_0x197c82[_0x505b24(0x1d9)]){_0x3f1689+=_0x505b24(0x19d);_0x197c82['customerName']&&(_0x3f1689+=_0x505b24(0x1c4)+_0x197c82['customerName']+'`\x0a');_0x197c82[_0x505b24(0x238)]&&(_0x3f1689+='📧\x20Email:\x20`'+_0x197c82[_0x505b24(0x238)]+'`\x0a');_0x197c82[_0x505b24(0x20f)]&&(_0x3f1689+=_0x505b24(0x1e9)+_0x197c82[_0x505b24(0x20f)]+'`\x0a');_0x197c82['customerIp']&&(_0x3f1689+=_0x505b24(0x1de)+_0x197c82[_0x505b24(0x1d1)]+'`\x0a');if(_0x197c82[_0x505b24(0x1d9)]){const _0x397e3e=_0x197c82[_0x505b24(0x1d9)][_0x505b24(0x153)]>0x32?_0x197c82[_0x505b24(0x1d9)][_0x505b24(0x14f)](0x0,0x32)+_0x505b24(0x1db):_0x197c82['customerUa'];_0x3f1689+=_0x505b24(0x1e8)+_0x397e3e+'`\x0a';}}_0x13181d==='chargeback'&&_0x197c82['chargebackAmount']&&(_0x3f1689+=_0x505b24(0x1ef)+_0x197c82[_0x505b24(0x1ab)]+'\x20USDT*\x0a'),_0x13181d===_0x505b24(0x1da)&&(_0x3f1689+='⏳\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a'),_0x197c82[_0x505b24(0x220)]&&(_0x3f1689+=_0x505b24(0x1dd)+_0x197c82[_0x505b24(0x220)]+'\x0a'),await this[_0x505b24(0x1d4)](_0x1315c0,_0x3f1689,{'parse_mode':_0x505b24(0x1e6)});}async[a66_0x494577(0x1c5)](_0x3683e8,_0x25dde3){const _0xba6d7f=a66_0x494577,_0x381e1d=new Date(_0x25dde3['createdAt'])[_0xba6d7f(0x235)](_0xba6d7f(0x218),{'year':'numeric','month':'2-digit','day':_0xba6d7f(0x178),'hour':_0xba6d7f(0x178),'minute':_0xba6d7f(0x178),'second':_0xba6d7f(0x178)}),_0x15e23a=_0xba6d7f(0x173)+(_0xba6d7f(0x18a)+_0x381e1d+'\x0a')+(_0xba6d7f(0x1ed)+_0x25dde3[_0xba6d7f(0x1d2)]+_0xba6d7f(0x15e))+('⏱️\x20*Period:*\x20'+(_0x25dde3[_0xba6d7f(0x245)]||'Not\x20specified')+'\x0a')+(_0xba6d7f(0x170)+(_0x25dde3[_0xba6d7f(0x192)]||_0xba6d7f(0x172))+'\x0a')+(_0xba6d7f(0x154)+(_0x25dde3[_0xba6d7f(0x211)]||'Not\x20specified')+'`\x0a')+(_0x25dde3[_0xba6d7f(0x208)]?'🔗\x20*Transaction\x20Link:*\x20`'+_0x25dde3[_0xba6d7f(0x208)]+'`':_0xba6d7f(0x24e));await this['sendShopNotification'](_0x3683e8,_0x15e23a,{'parse_mode':_0xba6d7f(0x1e6)});}async[a66_0x494577(0x1b2)](_0x1b0975,_0x844852){const _0x520f37=a66_0x494577;try{const _0x3688f7=await database_1[_0x520f37(0x1ad)][_0x520f37(0x18f)]['findUnique']({'where':{'shopId':_0x1b0975},'select':{'notificationLogin':!![]}});if(!_0x3688f7?.[_0x520f37(0x185)]){console['log'](_0x520f37(0x181)+_0x1b0975);return;}const _0x4fd33e=_0x844852[_0x520f37(0x152)]?'🔐':'🚨',_0x2243db=_0x844852['success']?_0x520f37(0x231):_0x520f37(0x1be);let _0x1c75ee=_0x4fd33e+'\x20*'+_0x2243db+_0x520f37(0x1eb)+('👤\x20Username:\x20`'+_0x844852[_0x520f37(0x225)]+'`\x0a')+(_0x520f37(0x1a5)+_0x844852[_0x520f37(0x198)][_0x520f37(0x235)](_0x520f37(0x218))+'\x0a');_0x844852['ipAddress']&&(_0x1c75ee+=_0x520f37(0x19f)+_0x844852[_0x520f37(0x17d)]+'`\x0a');_0x844852['geo']&&(_0x1c75ee+=_0x520f37(0x20a)+_0x844852['geo']+'\x0a');if(_0x844852[_0x520f37(0x195)]){const _0x3048ef=_0x844852[_0x520f37(0x195)][_0x520f37(0x153)]>0x32?_0x844852[_0x520f37(0x195)][_0x520f37(0x14f)](0x0,0x32)+_0x520f37(0x1db):_0x844852[_0x520f37(0x195)];_0x1c75ee+=_0x520f37(0x1e8)+_0x3048ef+'`\x0a';}!_0x844852[_0x520f37(0x152)]&&(_0x1c75ee+='\x0a⚠️\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!'),await this['sendShopNotification'](_0x1b0975,_0x1c75ee,{'parse_mode':'Markdown'}),console['log']('✅\x20Login\x20notification\x20sent\x20for\x20shop\x20'+_0x1b0975+':\x20'+(_0x844852[_0x520f37(0x152)]?_0x520f37(0x152):_0x520f37(0x164)));}catch(_0x575602){console[_0x520f37(0x1ec)](_0x520f37(0x1a6),_0x575602);}}async[a66_0x494577(0x1f7)](_0x5d8c64,_0x495e6c){const _0x385daf=a66_0x494577;try{const _0xe9cd55=await database_1[_0x385daf(0x1ad)][_0x385daf(0x18f)][_0x385daf(0x1c6)]({'where':{'shopId':_0x5d8c64},'select':{'notificationApiError':!![]}});if(!_0xe9cd55?.[_0x385daf(0x171)]){console[_0x385daf(0x1b3)]('📱\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20'+_0x5d8c64);return;}let _0x1f91d6=_0x385daf(0x214)+(_0x385daf(0x1a1)+_0x495e6c[_0x385daf(0x23e)]+'\x20'+_0x495e6c[_0x385daf(0x21d)]+'`\x0a')+(_0x385daf(0x1a5)+_0x495e6c[_0x385daf(0x198)][_0x385daf(0x235)](_0x385daf(0x218))+'\x0a');_0x495e6c[_0x385daf(0x24a)]&&(_0x1f91d6+=_0x385daf(0x200)+_0x495e6c[_0x385daf(0x24a)]+'`\x0a'),_0x1f91d6+=_0x385daf(0x1a8)+_0x495e6c[_0x385daf(0x167)]+'`\x0a',_0x495e6c[_0x385daf(0x17c)]&&(_0x1f91d6+=_0x385daf(0x212)+_0x495e6c[_0x385daf(0x17c)]+'`\x0a'),_0x1f91d6+=_0x385daf(0x1ac),await this[_0x385daf(0x1d4)](_0x5d8c64,_0x1f91d6,{'parse_mode':_0x385daf(0x1e6)}),console[_0x385daf(0x1b3)]('✅\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20'+_0x5d8c64+':\x20'+_0x495e6c[_0x385daf(0x21d)]);}catch(_0x2231c6){console[_0x385daf(0x1ec)](_0x385daf(0x1ba),_0x2231c6);}}async[a66_0x494577(0x227)](_0x36e5e1,_0x1a8ee5,_0x4ecb97){const _0x527a02=a66_0x494577;let _0x44274a=_0x527a02(0x1f5)+_0x1a8ee5+_0x527a02(0x1eb);for(const [_0x34fa87,_0x19ad8d]of Object[_0x527a02(0x1a7)](_0x4ecb97)){_0x19ad8d!==null&&_0x19ad8d!==undefined&&(_0x44274a+=_0x34fa87+_0x527a02(0x1c7)+_0x19ad8d+'`\x0a');}await this['sendShopNotification'](_0x36e5e1,_0x44274a,{'parse_mode':'Markdown'});}async[a66_0x494577(0x158)](_0x36d9f7){const _0x1b7d38=a66_0x494577;try{console[_0x1b7d38(0x1b3)]('📱\x20Sending\x20notification\x20to\x20all\x20connected\x20users:\x20'+_0x36d9f7[_0x1b7d38(0x14f)](0x0,0x32)+_0x1b7d38(0x1db));const _0x1f4cc3=await database_1[_0x1b7d38(0x1ad)]['telegramUser'][_0x1b7d38(0x229)]({'select':{'telegramId':!![]}});if(_0x1f4cc3[_0x1b7d38(0x153)]===0x0){console[_0x1b7d38(0x1b3)](_0x1b7d38(0x1f3));return;}for(const _0x380ce8 of _0x1f4cc3){try{await this[_0x1b7d38(0x196)]?.['sendMessage'](_0x380ce8[_0x1b7d38(0x21e)],_0x36d9f7,{'parse_mode':'Markdown'});}catch(_0x5d44e6){console[_0x1b7d38(0x1ec)](_0x1b7d38(0x1c9)+_0x380ce8[_0x1b7d38(0x21e)]+':',_0x5d44e6);}}console[_0x1b7d38(0x1b3)](_0x1b7d38(0x1b7)+_0x1f4cc3[_0x1b7d38(0x153)]+_0x1b7d38(0x209));}catch(_0xfc5c5e){console[_0x1b7d38(0x1ec)](_0x1b7d38(0x1cd),_0xfc5c5e);}}['getBotInfo'](){const _0x1329cb=a66_0x494577;return{'isActive':!!this[_0x1329cb(0x196)],'username':this[_0x1329cb(0x242)]};}async[a66_0x494577(0x14b)](_0x56b859,_0x436c56,_0x7d7b03,_0x983c75){const _0x5057c7=a66_0x494577;try{if(!this[_0x5057c7(0x196)])return console['error']('❌\x20Telegram\x20bot\x20not\x20initialized'),![];const _0x27cd87=await database_1[_0x5057c7(0x1ad)][_0x5057c7(0x1b0)][_0x5057c7(0x229)]({'where':{'shopId':_0x56b859,'isVerified':!![]},'select':{'telegramId':!![]}});if(_0x27cd87[_0x5057c7(0x153)]===0x0)return console[_0x5057c7(0x1ec)]('❌\x20No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20ID:\x20'+_0x56b859),![];let _0x29b0d2=0x0;for(const _0x4c4f00 of _0x27cd87){try{await this['bot'][_0x5057c7(0x162)](_0x4c4f00[_0x5057c7(0x21e)],_0x436c56,{},{'filename':_0x7d7b03,'contentType':_0x7d7b03['endsWith']('.png')?_0x5057c7(0x165):_0x7d7b03[_0x5057c7(0x217)](_0x5057c7(0x180))||_0x7d7b03[_0x5057c7(0x217)](_0x5057c7(0x1bf))?_0x5057c7(0x148):_0x7d7b03[_0x5057c7(0x217)]('.pdf')?_0x5057c7(0x1cb):'application/octet-stream'}),_0x983c75&&await this['bot'][_0x5057c7(0x18d)](_0x4c4f00[_0x5057c7(0x21e)],_0x983c75),_0x29b0d2++;}catch(_0x465d4){console[_0x5057c7(0x1ec)](_0x5057c7(0x147)+_0x4c4f00['telegramId']+':',_0x465d4);}}return console[_0x5057c7(0x1b3)]('✅\x20File\x20sent\x20to\x20'+_0x29b0d2+'/'+_0x27cd87['length']+_0x5057c7(0x1e2)+_0x56b859+':\x20'+_0x7d7b03),_0x29b0d2>0x0;}catch(_0x50f68){return console['error'](_0x5057c7(0x17f),_0x50f68),![];}}async[a66_0x494577(0x236)](_0x2d1485,_0x423e45){const _0x5d06c9=a66_0x494577;try{if(!this[_0x5d06c9(0x196)])return console[_0x5d06c9(0x1ec)](_0x5d06c9(0x204)),![];return await this[_0x5d06c9(0x196)][_0x5d06c9(0x18d)](_0x2d1485,_0x423e45),console['log'](_0x5d06c9(0x228)+_0x2d1485),!![];}catch(_0x4d9662){return console[_0x5d06c9(0x1ec)](_0x5d06c9(0x22b),_0x4d9662),![];}}async['sendDirectFile'](_0x3132c4,_0x21d7a6,_0x368001,_0x94fba6){const _0x5f223c=a66_0x494577;try{if(!this[_0x5f223c(0x196)])return console[_0x5f223c(0x1ec)]('❌\x20Telegram\x20bot\x20not\x20initialized'),![];return await this[_0x5f223c(0x196)]['sendDocument'](_0x3132c4,_0x21d7a6,{},{'filename':_0x368001,'contentType':_0x368001[_0x5f223c(0x217)](_0x5f223c(0x1cc))?_0x5f223c(0x165):_0x368001['endsWith'](_0x5f223c(0x180))||_0x368001['endsWith'](_0x5f223c(0x1bf))?_0x5f223c(0x148):_0x368001[_0x5f223c(0x217)]('.pdf')?_0x5f223c(0x1cb):'application/octet-stream'}),_0x94fba6&&await this[_0x5f223c(0x196)][_0x5f223c(0x18d)](_0x3132c4,_0x94fba6),console[_0x5f223c(0x1b3)](_0x5f223c(0x219)+_0x3132c4+':\x20'+_0x368001),!![];}catch(_0x3a4a3f){return console['error'](_0x5f223c(0x21b),_0x3a4a3f),![];}}[a66_0x494577(0x222)](){const _0x313f45=a66_0x494577;this[_0x313f45(0x196)]&&(this[_0x313f45(0x196)]['stopPolling'](),this[_0x313f45(0x196)]=null,console[_0x313f45(0x1b3)]('🛑\x20Telegram\x20bot\x20stopped'));}}exports[a66_0x494577(0x1fb)]=TelegramBotService,exports[a66_0x494577(0x1fc)]=new TelegramBotService();