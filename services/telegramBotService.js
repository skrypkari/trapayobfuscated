'use strict';const a80_0x1aea81=a80_0x1842;(function(_0x5234fe,_0x2cbb58){const _0x3008a2=a80_0x1842,_0x3f230d=_0x5234fe();while(!![]){try{const _0x1bb405=-parseInt(_0x3008a2(0x148))/0x1+-parseInt(_0x3008a2(0x16b))/0x2+parseInt(_0x3008a2(0x1a4))/0x3*(-parseInt(_0x3008a2(0x11b))/0x4)+-parseInt(_0x3008a2(0x1c9))/0x5*(-parseInt(_0x3008a2(0x1a5))/0x6)+parseInt(_0x3008a2(0x210))/0x7*(-parseInt(_0x3008a2(0x17f))/0x8)+-parseInt(_0x3008a2(0x1ba))/0x9+parseInt(_0x3008a2(0x1c8))/0xa;if(_0x1bb405===_0x2cbb58)break;else _0x3f230d['push'](_0x3f230d['shift']());}catch(_0x539747){_0x3f230d['push'](_0x3f230d['shift']());}}}(a80_0x5e93,0x272aa));function a80_0x5e93(){const _0x118529=['shopId','__importDefault','defineProperty','219288aBTbWx','chargeback','‚è±Ô∏è\x20*Period:*\x20','Payment\x20successfully\x20paid','txid','‚úÖ\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a','üè™\x20Your\x20connected\x20shop:\x0a','botUsername','üì±\x20Telegram\x20notification:\x20gateway\x20\x22','customerUa','errorMessage','count','üí∏\x20Penalty\x20amount:\x20*','‚ùå\x20Failed\x20to\x20send\x20notification\x20to\x20all\x20users:','Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).','‚Ä¢\x20New\x20payments\x0a','‚úÖ\x20Login\x20notification\x20sent\x20for\x20shop\x20','‚úÖ\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*','period','isVerified','username','log','warn','‚Ä¢\x20Payment\x20status\x20changes\x0a','getBotInfo','remitterIban','node-telegram-bot-api','Error\x20in\x20handleSingleLineVerification:','Payment\x20is\x20being\x20processed','\x22,\x20apiKey=\x22','‚ùå\x20Shop\x20`','‚ùå\x20Error\x20sending\x20file\x20to\x20chat:','‚úÖ\x20File\x20sent\x20to\x20','‚ùå\x20Error\x20getting\x20debug\x20information.','en-US','customerName','Telegram\x20bot\x20polling\x20error:','8457pECryi','30jshjpZ','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','Use\x20/start\x20to\x20begin.','üè¶\x20IBAN:\x20`','from','‚úÖ\x20File\x20sent\x20to\x20chat\x20','‚úÖ\x20Direct\x20message\x20sent\x20to\x20chat\x20','Payment\x20refund','Payment\x20expired','application/pdf','‚ùå\x20Error\x20sending\x20direct\x20message:','length','‚Ä¢\x20Important\x20events\x0a\x0a','toLocaleString','üìÖ\x20*Payout\x20Date:*\x20','üéâ\x20*Congratulations!*\x0a\x0a','startsWith','shopSettings','üìÖ\x20Connection\x20date:\x20','success','map','1975644SAvUiK','‚ùå\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a','üõë\x20Telegram\x20bot\x20stopped','Error\x20handling\x20/debug\x20command:','amount','‚Ä¢\x20Payouts\x0a','‚ùå\x20Failed\x20to\x20send\x20message\x20to\x20user\x20','sendDirectMessage','notificationApiError','substring','üåç\x20Country:\x20','\x20\x20\x20Name:\x20*','*.\x0a\x0a','Failed\x20to\x20send\x20API\x20error\x20notification:','6670560ijuCDm','76280OqLCdM','No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20','üíª\x20Browser:\x20`','üìù\x20Order\x20ID:\x20`','onText','endpoint','User\x20','setupBotHandlers','üîå\x20User\x20','timestamp','last_name','test','`\x20not\x20found.\x0a\x0a','telegramId','findMany','sendLoginNotification','update','üîî\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a','trim','telegramBotService','pk_','/disconnect\x20-\x20disconnect\x20from\x20notifications','application/octet-stream','sendShopFile','üí∞\x20*Amount:*\x20','\x20(@','‚ùå\x20Failed\x20to\x20initialize\x20Telegram\x20bot:','network','ipAddress','image/png','üîó\x20Endpoint:\x20`','.pdf','\x0a‚ö†Ô∏è\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!','üì±\x20Created\x20new\x20Telegram\x20user:\x20','create','‚ùå\x20Please\x20use\x20/start\x20command\x20first','wallet','üìù\x20Format:\x20`username\x20api_key`\x0a\x0a','üîç\x20*Debug\x20Information*\x0a\x0a','Error\x20handling\x20/status\x20command:','sendNotificationToAll','üë§\x20Username:\x20`','sendDirectFile','Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a','findUnique','sendPayoutNotification','userAgent','‚ùå\x20API\x20key\x20does\x20not\x20match\x20shop\x20`','Successful\x20login','status','`\x0a\x0a','Username:\x20`','*\x0a\x0a','Markdown','default','first_name','‚ùå\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','Please\x20check\x20the\x20spelling\x20and\x20try\x20again.\x0a\x0a','adminNotes','Failed\x20login\x20attempt','Commands:\x0a','üö®\x20*API\x20Error*\x0a\x0a','\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure','‚ùå\x20Invalid\x20username\x20format:\x20`','\x20via\x20single-line\x20input','\x20\x20\x20Status:\x20','toString','üí∏\x20*New\x20Payout*\x0a\x0a','chargebackAmount','Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.','chat','7cfEwtN','currency','‚ùå\x20Telegram\x20bot\x20not\x20initialized','__esModule','424HKOEuj','bot','geo','.png','botToken','\x20disconnected\x20from\x20shop\x20','üì±\x20Login\x20notifications\x20disabled\x20for\x20shop\x20','üìß\x20Email:\x20`','üí≥\x20*Wallet:*\x20`','To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a','‚úÖ\x20Telegram\x20bot\x20@','toLocaleDateString','handleSingleLineVerification','stopBot','sendPaymentNotification','\x20parts:\x20','‚ùå\x20Maximum\x20number\x20of\x20connected\x20accounts\x20(5)\x20reached\x20for\x20shop\x20`','Use\x20/start\x20to\x20connect\x20to\x20a\x20shop.','endsWith','‚ùóÔ∏è\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!','Not\x20specified','üì±\x20Sending\x20notification\x20to\x20all\x20connected\x20users:\x20','...','customerEmail','customerIp','\x20verified\x20for\x20shop\x20','initializeBot','.jpeg','shop','‚ùå\x20No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20ID:\x20','sk_','2-digit','sendMessage','üîÑ\x20Reset\x20incomplete\x20verification\x20for\x20user\x20','sendCustomNotification','...\x22','requestId','.jpg','üìÖ\x20Time:\x20','Make\x20sure\x20you\x20have\x20the\x20correct\x20username\x20from\x20your\x20account.','\x22\x20->\x20display\x20\x22','ü§ñ\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a','TelegramBotService','user\x20is\x20deactivated','‚úÖ\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*','12177xivPGH','üåê\x20IP:\x20`','image/jpeg','statusCode','method','Contact\x20administrator.','Disconnect\x20one\x20of\x20the\x20existing\x20accounts\x20first.','üîî\x20You\x20receive\x20notifications\x20about:\x0a','message','polling_error','‚Ä¢\x20Payouts\x0a\x0a',':\x20`','üîó\x20*Transaction\x20Link:*\x20Pending','Use\x20/start\x20to\x20connect.','../types/gateway','Failed\x20to\x20send\x20login\x20notification:','üì±\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20','telegramUser','sendShopNotification','../config/database','‚ùå\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a','üåê\x20IP\x20address:\x20`','includes','/status\x20-\x20check\x20connection\x20status\x0a',':\x20username=\x22','Error\x20handling\x20/disconnect\x20command:','error','name','üìù\x20Notes:\x20','üÜî\x20Request\x20ID:\x20`','üì±\x20Your\x20Telegram\x20ID:\x20`','‚ùå\x20Invalid\x20API\x20key\x20format.\x0a\x0a','sendDocument','trapay_bot','üìä\x20Error\x20code:\x20`','49984ZpIXLt','failed','‚ùå\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.','üè™\x20Gateway:\x20`','‚úÖ\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20','‚ùå\x20Error\x20sending\x20file\x20to\x20user\x20','text','üîÑ\x20Processing\x20single-line\x20verification\x20for\x20user\x20','createdAt','processing','\x20USD\x0a','gateway','`.\x0a\x0a','\x0aüë§\x20*Customer\x20Information:*\x0a','‚ùå\x20Shop\x20with\x20username\x20`','Telegram\x20bot\x20error:','sendApiErrorNotification'];a80_0x5e93=function(){return _0x118529;};return a80_0x5e93();}var __importDefault=this&&this[a80_0x1aea81(0x17d)]||function(_0x511e01){const _0x30bb61=a80_0x1aea81;return _0x511e01&&_0x511e01[_0x30bb61(0x11a)]?_0x511e01:{'default':_0x511e01};};Object[a80_0x1aea81(0x17e)](exports,'__esModule',{'value':!![]}),exports['telegramBotService']=exports[a80_0x1aea81(0x145)]=void 0x0;function a80_0x1842(_0x2fa815,_0x3183ff){_0x2fa815=_0x2fa815-0x119;const _0x5e932c=a80_0x5e93();let _0x1842da=_0x5e932c[_0x2fa815];return _0x1842da;}const node_telegram_bot_api_1=__importDefault(require(a80_0x1aea81(0x199))),database_1=__importDefault(require(a80_0x1aea81(0x15b))),gateway_1=require(a80_0x1aea81(0x156));class TelegramBotService{constructor(){const _0x594b9f=a80_0x1aea81;this[_0x594b9f(0x11c)]=null,this['botToken']=process.env.TELEGRAM_BOT_TOKEN||'',this['botUsername']=process.env.TELEGRAM_BOT_USERNAME||_0x594b9f(0x169),this[_0x594b9f(0x11f)]?this[_0x594b9f(0x135)]():console[_0x594b9f(0x195)]('TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables');}['initializeBot'](){const _0x4a4c14=a80_0x1aea81;try{this[_0x4a4c14(0x11c)]=new node_telegram_bot_api_1[(_0x4a4c14(0x1ff))](this[_0x4a4c14(0x11f)],{'polling':!![]}),this[_0x4a4c14(0x1d0)](),console['log'](_0x4a4c14(0x125)+this['botUsername']+'\x20initialized\x20successfully');}catch(_0x145b12){console[_0x4a4c14(0x162)](_0x4a4c14(0x1e3),_0x145b12);}}[a80_0x1aea81(0x1d0)](){const _0x5f4a7e=a80_0x1aea81;if(!this[_0x5f4a7e(0x11c)])return;this[_0x5f4a7e(0x11c)][_0x5f4a7e(0x1cd)](/\/start/,async _0x4ba507=>{const _0xb5b035=_0x5f4a7e,_0x1bf64b=_0x4ba507['chat']['id'],_0x58e798=_0x4ba507[_0xb5b035(0x1a9)]?.['id'][_0xb5b035(0x20b)](),_0x24496a=_0x4ba507['from']?.['username'],_0x25746a=_0x4ba507[_0xb5b035(0x1a9)]?.[_0xb5b035(0x200)],_0x3e2f8a=_0x4ba507['from']?.[_0xb5b035(0x1d3)];if(!_0x58e798)return;try{let _0x56a9ad=await database_1[_0xb5b035(0x1ff)][_0xb5b035(0x159)][_0xb5b035(0x1f5)]({'where':{'telegramId':_0x58e798},'include':{'shop':!![]}});!_0x56a9ad?(_0x56a9ad=await database_1[_0xb5b035(0x1ff)][_0xb5b035(0x159)][_0xb5b035(0x1eb)]({'data':{'telegramId':_0x58e798,'username':_0x24496a,'firstName':_0x25746a,'lastName':_0x3e2f8a,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console[_0xb5b035(0x194)](_0xb5b035(0x1ea)+_0x58e798+_0xb5b035(0x1e2)+_0x24496a+')')):_0x56a9ad=await database_1[_0xb5b035(0x1ff)][_0xb5b035(0x159)][_0xb5b035(0x1d9)]({'where':{'telegramId':_0x58e798},'data':{'username':_0x24496a,'firstName':_0x25746a,'lastName':_0x3e2f8a},'include':{'shop':!![]}}),_0x56a9ad['isVerified']&&_0x56a9ad[_0xb5b035(0x17c)]&&_0x56a9ad['shop']?await this[_0xb5b035(0x11c)]?.['sendMessage'](_0x1bf64b,'‚úÖ\x20Welcome\x20back!\x0a\x0a'+('You\x20are\x20already\x20connected\x20to\x20shop:\x20*'+_0x56a9ad[_0xb5b035(0x137)][_0xb5b035(0x163)]+'*\x0a')+(_0xb5b035(0x1fc)+_0x56a9ad[_0xb5b035(0x137)]['username']+_0xb5b035(0x1fb))+_0xb5b035(0x14f)+_0xb5b035(0x18e)+_0xb5b035(0x196)+_0xb5b035(0x152)+'Commands:\x0a'+_0xb5b035(0x15f)+_0xb5b035(0x1de),{'parse_mode':'Markdown'}):(_0x56a9ad['shopId']&&!_0x56a9ad[_0xb5b035(0x192)]&&(await database_1[_0xb5b035(0x1ff)][_0xb5b035(0x159)][_0xb5b035(0x1d9)]({'where':{'telegramId':_0x58e798},'data':{'shopId':null,'isVerified':![]}}),console[_0xb5b035(0x194)](_0xb5b035(0x13c)+_0x58e798)),await this['bot']?.[_0xb5b035(0x13b)](_0x1bf64b,_0xb5b035(0x144)+_0xb5b035(0x124)+_0xb5b035(0x1ee)+'Example:\x0a'+_0xb5b035(0x1a6)+_0xb5b035(0x12e),{'parse_mode':_0xb5b035(0x1fe)}));}catch(_0x17bddc){console[_0xb5b035(0x162)]('Error\x20handling\x20/start\x20command:',_0x17bddc),await this['bot']?.['sendMessage'](_0x1bf64b,_0xb5b035(0x201));}}),this[_0x5f4a7e(0x11c)][_0x5f4a7e(0x1cd)](/\/disconnect/,async _0x2c933b=>{const _0x4ddfcb=_0x5f4a7e,_0x165029=_0x2c933b[_0x4ddfcb(0x20f)]['id'],_0x4507b9=_0x2c933b['from']?.['id'][_0x4ddfcb(0x20b)]();if(!_0x4507b9)return;try{const _0x445e9a=await database_1[_0x4ddfcb(0x1ff)][_0x4ddfcb(0x159)][_0x4ddfcb(0x1f5)]({'where':{'telegramId':_0x4507b9},'include':{'shop':!![]}});if(!_0x445e9a||!_0x445e9a[_0x4ddfcb(0x192)]||!_0x445e9a[_0x4ddfcb(0x17c)]){await this[_0x4ddfcb(0x11c)]?.[_0x4ddfcb(0x13b)](_0x165029,_0x4ddfcb(0x16d));return;}const _0x350bd7=_0x445e9a['shop']?.[_0x4ddfcb(0x163)]||'unknown\x20shop';await database_1['default'][_0x4ddfcb(0x159)]['update']({'where':{'telegramId':_0x4507b9},'data':{'shopId':null,'isVerified':![]}}),console[_0x4ddfcb(0x194)](_0x4ddfcb(0x1d1)+_0x4507b9+_0x4ddfcb(0x120)+_0x445e9a[_0x4ddfcb(0x17c)]),await this['bot']?.[_0x4ddfcb(0x13b)](_0x165029,_0x4ddfcb(0x147)+_0x350bd7+_0x4ddfcb(0x1c6)+'To\x20reconnect,\x20use\x20the\x20/start\x20command',{'parse_mode':_0x4ddfcb(0x1fe)});}catch(_0x4a8225){console[_0x4ddfcb(0x162)](_0x4ddfcb(0x161),_0x4a8225),await this['bot']?.[_0x4ddfcb(0x13b)](_0x165029,_0x4ddfcb(0x201));}}),this[_0x5f4a7e(0x11c)][_0x5f4a7e(0x1cd)](/\/status/,async _0x4f7507=>{const _0x134443=_0x5f4a7e,_0x33ec43=_0x4f7507[_0x134443(0x20f)]['id'],_0x19c16c=_0x4f7507['from']?.['id'][_0x134443(0x20b)]();if(!_0x19c16c)return;try{const _0x17039a=await database_1['default'][_0x134443(0x159)][_0x134443(0x1f5)]({'where':{'telegramId':_0x19c16c},'include':{'shop':!![]}});if(!_0x17039a){await this[_0x134443(0x11c)]?.[_0x134443(0x13b)](_0x33ec43,_0x134443(0x15c)+_0x134443(0x1a7));return;}if(!_0x17039a[_0x134443(0x192)]||!_0x17039a['shopId']||!_0x17039a['shop']){await this[_0x134443(0x11c)]?.[_0x134443(0x13b)](_0x33ec43,_0x134443(0x1bb)+_0x134443(0x155));return;}await this[_0x134443(0x11c)]?.[_0x134443(0x13b)](_0x33ec43,'üìä\x20*Connection\x20Status*\x0a\x0a'+('‚úÖ\x20Connected\x20to\x20shop:\x20*'+_0x17039a[_0x134443(0x137)][_0x134443(0x163)]+'*\x0a')+(_0x134443(0x1f2)+_0x17039a[_0x134443(0x137)][_0x134443(0x193)]+'`\x0a')+(_0x134443(0x1b7)+_0x17039a['updatedAt'][_0x134443(0x126)](_0x134443(0x1a1))+'\x0a\x0a')+'üîî\x20Notifications\x20are\x20active\x0a\x0a'+_0x134443(0x205)+_0x134443(0x1de),{'parse_mode':'Markdown'});}catch(_0x1b25b2){console[_0x134443(0x162)](_0x134443(0x1f0),_0x1b25b2),await this[_0x134443(0x11c)]?.[_0x134443(0x13b)](_0x33ec43,_0x134443(0x201));}}),this[_0x5f4a7e(0x11c)][_0x5f4a7e(0x1cd)](/\/debug/,async _0x3ff733=>{const _0x3559a9=_0x5f4a7e,_0x89d820=_0x3ff733[_0x3559a9(0x20f)]['id'],_0x207ade=_0x3ff733[_0x3559a9(0x1a9)]?.['id'][_0x3559a9(0x20b)]();if(!_0x207ade)return;try{const _0x323a1e=await database_1[_0x3559a9(0x1ff)]['telegramUser'][_0x3559a9(0x1f5)]({'where':{'telegramId':_0x207ade},'include':{'shop':!![]}});let _0x15896b=_0x3559a9(0x1ef);_0x15896b+=_0x3559a9(0x166)+_0x207ade+_0x3559a9(0x1fb),_0x323a1e?.['isVerified']&&_0x323a1e[_0x3559a9(0x137)]?(_0x15896b+=_0x3559a9(0x185),_0x15896b+=_0x3559a9(0x1c5)+_0x323a1e[_0x3559a9(0x137)][_0x3559a9(0x163)]+'*\x0a',_0x15896b+='\x20\x20\x20Username:\x20`'+_0x323a1e['shop'][_0x3559a9(0x193)]+'`\x0a',_0x15896b+=_0x3559a9(0x20a)+_0x323a1e[_0x3559a9(0x137)][_0x3559a9(0x1fa)]+'\x0a\x0a'):_0x15896b+='‚ùå\x20You\x20are\x20not\x20connected\x20to\x20any\x20shop.\x0a\x0a',_0x15896b+=_0x3559a9(0x12c),await this[_0x3559a9(0x11c)]?.[_0x3559a9(0x13b)](_0x89d820,_0x15896b,{'parse_mode':_0x3559a9(0x1fe)});}catch(_0x2bd196){console[_0x3559a9(0x162)](_0x3559a9(0x1bd),_0x2bd196),await this[_0x3559a9(0x11c)]?.['sendMessage'](_0x89d820,_0x3559a9(0x1a0));}}),this[_0x5f4a7e(0x11c)]['on']('message',async _0x43b073=>{const _0x46d19c=_0x5f4a7e;if(_0x43b073[_0x46d19c(0x171)]?.[_0x46d19c(0x1b5)]('/'))return;const _0x52d4d0=_0x43b073[_0x46d19c(0x20f)]['id'],_0x4030e9=_0x43b073[_0x46d19c(0x1a9)]?.['id']['toString'](),_0x25d8b5=_0x43b073[_0x46d19c(0x171)]?.[_0x46d19c(0x1db)]();if(!_0x4030e9||!_0x25d8b5)return;try{const _0x4b8f3b=await database_1['default'][_0x46d19c(0x159)][_0x46d19c(0x1f5)]({'where':{'telegramId':_0x4030e9},'include':{'shop':!![]}});if(!_0x4b8f3b){await this['bot']?.[_0x46d19c(0x13b)](_0x52d4d0,_0x46d19c(0x1ec));return;}if(_0x4b8f3b[_0x46d19c(0x192)]&&_0x4b8f3b[_0x46d19c(0x17c)]&&_0x4b8f3b['shop']){await this[_0x46d19c(0x11c)]?.['sendMessage'](_0x52d4d0,_0x46d19c(0x190)+_0x4b8f3b[_0x46d19c(0x137)][_0x46d19c(0x163)]+_0x46d19c(0x1c6)+_0x46d19c(0x20e),{'parse_mode':_0x46d19c(0x1fe)});return;}const _0x247173=_0x25d8b5['split'](/\s+/);if(_0x247173['length']!==0x2){await this[_0x46d19c(0x11c)]?.[_0x46d19c(0x13b)](_0x52d4d0,'‚ùå\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a'+_0x46d19c(0x1ee)+'Example:\x0a'+_0x46d19c(0x1a6)+('You\x20sent\x20'+_0x247173[_0x46d19c(0x1b0)]+_0x46d19c(0x12a)+_0x247173['map'](_0x5e8f2a=>'`'+_0x5e8f2a+'`')['join'](',\x20')),{'parse_mode':_0x46d19c(0x1fe)});return;}const [_0x3f1edb,_0x2c9549]=_0x247173;console['log'](_0x46d19c(0x172)+_0x4030e9+':\x20username=\x22'+_0x3f1edb+_0x46d19c(0x19c)+_0x2c9549[_0x46d19c(0x1c3)](0x0,0xa)+_0x46d19c(0x13e)),await this[_0x46d19c(0x127)](_0x52d4d0,_0x4030e9,_0x3f1edb,_0x2c9549);}catch(_0x49521e){console[_0x46d19c(0x162)]('Error\x20handling\x20message:',_0x49521e),await this[_0x46d19c(0x11c)]?.[_0x46d19c(0x13b)](_0x52d4d0,_0x46d19c(0x201));}}),this[_0x5f4a7e(0x11c)]['on'](_0x5f4a7e(0x162),_0x444702=>{const _0x24292f=_0x5f4a7e;console['error'](_0x24292f(0x17a),_0x444702);}),this[_0x5f4a7e(0x11c)]['on'](_0x5f4a7e(0x151),_0x10badf=>{const _0x55c65d=_0x5f4a7e;console[_0x55c65d(0x162)](_0x55c65d(0x1a3),_0x10badf);});}async[a80_0x1aea81(0x127)](_0xa741ec,_0x28e9ed,_0x2b5c86,_0x15923f){const _0x574398=a80_0x1aea81;try{console['log'](_0x574398(0x172)+_0x28e9ed+_0x574398(0x160)+_0x2b5c86+_0x574398(0x19c)+_0x15923f[_0x574398(0x1c3)](0x0,0xa)+'...\x22');if(!_0x2b5c86||_0x2b5c86[_0x574398(0x1b0)]<0x3||_0x2b5c86[_0x574398(0x1b0)]>0x32||!/^[a-zA-Z0-9_]+$/[_0x574398(0x1d4)](_0x2b5c86)){await this[_0x574398(0x11c)]?.[_0x574398(0x13b)](_0xa741ec,_0x574398(0x208)+_0x2b5c86+_0x574398(0x1fb)+_0x574398(0x18d),{'parse_mode':_0x574398(0x1fe)});return;}if(!_0x15923f||!_0x15923f['startsWith'](_0x574398(0x1dd))&&!_0x15923f['startsWith'](_0x574398(0x139))){await this[_0x574398(0x11c)]?.[_0x574398(0x13b)](_0xa741ec,_0x574398(0x167)+'API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.',{'parse_mode':_0x574398(0x1fe)});return;}const _0x42c782=await database_1[_0x574398(0x1ff)][_0x574398(0x137)][_0x574398(0x1f5)]({'where':{'username':_0x2b5c86},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x42c782){const _0x282b14=_0x574398(0x179)+_0x2b5c86+_0x574398(0x1d5)+_0x574398(0x202)+_0x574398(0x142);await this['bot']?.[_0x574398(0x13b)](_0xa741ec,_0x282b14,{'parse_mode':_0x574398(0x1fe)});return;}if(_0x42c782[_0x574398(0x1fa)]!=='ACTIVE'){await this[_0x574398(0x11c)]?.['sendMessage'](_0xa741ec,_0x574398(0x19d)+_0x2b5c86+'`\x20is\x20inactive.\x0a\x0a'+_0x574398(0x14d),{'parse_mode':_0x574398(0x1fe)});return;}if(_0x42c782['publicKey']!==_0x15923f&&_0x42c782['secretKey']!==_0x15923f){await this[_0x574398(0x11c)]?.[_0x574398(0x13b)](_0xa741ec,_0x574398(0x1f8)+_0x2b5c86+'`.\x0a\x0a'+_0x574398(0x1f4)+'Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`',{'parse_mode':_0x574398(0x1fe)});return;}const _0x11fb54=await database_1[_0x574398(0x1ff)][_0x574398(0x159)][_0x574398(0x18a)]({'where':{'shopId':_0x42c782['id'],'isVerified':!![]}});if(_0x11fb54>=0x5){await this[_0x574398(0x11c)]?.[_0x574398(0x13b)](_0xa741ec,_0x574398(0x12b)+_0x2b5c86+_0x574398(0x177)+_0x574398(0x14e),{'parse_mode':_0x574398(0x1fe)});return;}await database_1['default'][_0x574398(0x159)][_0x574398(0x1d9)]({'where':{'telegramId':_0x28e9ed},'data':{'shopId':_0x42c782['id'],'isVerified':!![]}}),await this[_0x574398(0x11c)]?.[_0x574398(0x13b)](_0xa741ec,_0x574398(0x1b4)+_0x574398(0x184)+('üì±\x20Shop:\x20*'+_0x42c782[_0x574398(0x163)]+'*\x0a')+('üë§\x20Username:\x20`'+_0x42c782[_0x574398(0x193)]+_0x574398(0x1fb))+_0x574398(0x1da)+_0x574398(0x18e)+_0x574398(0x196)+_0x574398(0x1bf)+_0x574398(0x1b1)+'Commands:\x0a'+'/status\x20-\x20check\x20connection\x20status\x0a'+_0x574398(0x1de),{'parse_mode':'Markdown'}),console[_0x574398(0x194)]('‚úÖ\x20Telegram\x20user\x20'+_0x28e9ed+_0x574398(0x134)+_0x42c782[_0x574398(0x193)]+_0x574398(0x209));}catch(_0x560c56){console[_0x574398(0x162)](_0x574398(0x19a),_0x560c56),await this[_0x574398(0x11c)]?.[_0x574398(0x13b)](_0xa741ec,'‚ùå\x20An\x20error\x20occurred\x20while\x20verifying\x20data.');}}async[a80_0x1aea81(0x15a)](_0x2c6dca,_0x560715,_0x512732){const _0x357268=a80_0x1aea81;if(!this[_0x357268(0x11c)]){console[_0x357268(0x195)]('Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification');return;}try{const _0x594d41=await database_1['default'][_0x357268(0x159)]['findMany']({'where':{'shopId':_0x2c6dca,'isVerified':!![]}});if(_0x594d41[_0x357268(0x1b0)]===0x0){console[_0x357268(0x194)](_0x357268(0x1ca)+_0x2c6dca);return;}const _0x418867=_0x594d41[_0x357268(0x1b9)](async _0x39d2ad=>{const _0x3ce30d=_0x357268;try{await this[_0x3ce30d(0x11c)]?.[_0x3ce30d(0x13b)](_0x39d2ad[_0x3ce30d(0x1d6)],_0x560715,_0x512732),console[_0x3ce30d(0x194)]('‚úÖ\x20Notification\x20sent\x20to\x20Telegram\x20user\x20'+_0x39d2ad[_0x3ce30d(0x1d6)]);}catch(_0x24cb58){console[_0x3ce30d(0x162)]('‚ùå\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20'+_0x39d2ad['telegramId']+':',_0x24cb58),_0x24cb58 instanceof Error&&(_0x24cb58[_0x3ce30d(0x150)][_0x3ce30d(0x15e)]('blocked')||_0x24cb58['message'][_0x3ce30d(0x15e)]('chat\x20not\x20found')||_0x24cb58[_0x3ce30d(0x150)][_0x3ce30d(0x15e)](_0x3ce30d(0x146)))&&(await database_1[_0x3ce30d(0x1ff)]['telegramUser'][_0x3ce30d(0x1d9)]({'where':{'id':_0x39d2ad['id']},'data':{'isVerified':![]}}),console[_0x3ce30d(0x194)](_0x3ce30d(0x1cf)+_0x39d2ad['telegramId']+_0x3ce30d(0x207)));}});await Promise['allSettled'](_0x418867);}catch(_0xf91402){console[_0x357268(0x162)]('Error\x20sending\x20shop\x20notification:',_0xf91402);}}async[a80_0x1aea81(0x129)](_0x2777aa,_0x370ada,_0x100425){const _0x6dd91=a80_0x1aea81,_0x1aede2={'created':'üÜï','paid':'‚úÖ','failed':'‚ùå','expired':'‚è∞','refund':'üîÑ','chargeback':'‚ö†Ô∏è','processing':'‚öôÔ∏è'},_0x1b9c94={'created':'New\x20payment\x20created','paid':_0x6dd91(0x182),'failed':'Payment\x20failed','expired':_0x6dd91(0x1ad),'refund':_0x6dd91(0x1ac),'chargeback':'Payment\x20chargeback','processing':_0x6dd91(0x19b)},_0x35e19b=_0x1aede2[_0x100425],_0x3e42bf=_0x1b9c94[_0x100425],_0x4b350c=(0x0,gateway_1['getGatewayDisplayNameForTelegram'])(_0x370ada[_0x6dd91(0x176)]);console['log'](_0x6dd91(0x187)+_0x370ada[_0x6dd91(0x176)]+_0x6dd91(0x143)+_0x4b350c+'\x22');let _0x5e9847=_0x35e19b+'\x20*'+_0x3e42bf+_0x6dd91(0x1fd)+('üí∞\x20Amount:\x20*'+_0x370ada[_0x6dd91(0x1be)]+'\x20'+_0x370ada[_0x6dd91(0x211)]+'*\x0a')+(_0x6dd91(0x1cc)+(_0x370ada['orderId']||_0x370ada['id'])+'`\x0a')+('üÜî\x20Payment\x20ID:\x20`'+_0x370ada['id']+'`\x0a')+(_0x6dd91(0x16e)+_0x4b350c+'`\x0a')+('üìÖ\x20Date:\x20'+new Date(_0x370ada[_0x6dd91(0x173)])[_0x6dd91(0x1b2)]('en-US')+'\x0a');if(_0x370ada[_0x6dd91(0x1a2)]||_0x370ada[_0x6dd91(0x132)]||_0x370ada[_0x6dd91(0x198)]||_0x370ada['customerIp']||_0x370ada[_0x6dd91(0x188)]){_0x5e9847+=_0x6dd91(0x178);_0x370ada[_0x6dd91(0x1a2)]&&(_0x5e9847+='üìõ\x20Name:\x20`'+_0x370ada[_0x6dd91(0x1a2)]+'`\x0a');_0x370ada[_0x6dd91(0x132)]&&(_0x5e9847+=_0x6dd91(0x122)+_0x370ada[_0x6dd91(0x132)]+'`\x0a');_0x370ada[_0x6dd91(0x198)]&&(_0x5e9847+=_0x6dd91(0x1a8)+_0x370ada[_0x6dd91(0x198)]+'`\x0a');_0x370ada[_0x6dd91(0x133)]&&(_0x5e9847+=_0x6dd91(0x149)+_0x370ada[_0x6dd91(0x133)]+'`\x0a');if(_0x370ada[_0x6dd91(0x188)]){const _0x1d099c=_0x370ada[_0x6dd91(0x188)]['length']>0x32?_0x370ada['customerUa'][_0x6dd91(0x1c3)](0x0,0x32)+_0x6dd91(0x131):_0x370ada['customerUa'];_0x5e9847+=_0x6dd91(0x1cb)+_0x1d099c+'`\x0a';}}_0x100425===_0x6dd91(0x180)&&_0x370ada[_0x6dd91(0x20d)]&&(_0x5e9847+=_0x6dd91(0x18b)+_0x370ada[_0x6dd91(0x20d)]+'\x20USDT*\x0a'),_0x100425===_0x6dd91(0x174)&&(_0x5e9847+='‚è≥\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a'),_0x370ada[_0x6dd91(0x203)]&&(_0x5e9847+=_0x6dd91(0x164)+_0x370ada['adminNotes']+'\x0a'),await this[_0x6dd91(0x15a)](_0x2777aa,_0x5e9847,{'parse_mode':_0x6dd91(0x1fe)});}async[a80_0x1aea81(0x1f6)](_0x383526,_0x28000d){const _0x432ca6=a80_0x1aea81,_0x4fa92b=new Date(_0x28000d[_0x432ca6(0x173)])['toLocaleString'](_0x432ca6(0x1a1),{'year':'numeric','month':_0x432ca6(0x13a),'day':'2-digit','hour':_0x432ca6(0x13a),'minute':_0x432ca6(0x13a),'second':'2-digit'}),_0x572396=_0x432ca6(0x20c)+(_0x432ca6(0x1b3)+_0x4fa92b+'\x0a')+(_0x432ca6(0x1e1)+_0x28000d[_0x432ca6(0x1be)]+_0x432ca6(0x175))+(_0x432ca6(0x181)+(_0x28000d[_0x432ca6(0x191)]||'Not\x20specified')+'\x0a')+('üåê\x20*Network:*\x20'+(_0x28000d[_0x432ca6(0x1e4)]||_0x432ca6(0x12f))+'\x0a')+(_0x432ca6(0x123)+(_0x28000d[_0x432ca6(0x1ed)]||_0x432ca6(0x12f))+'`\x0a')+(_0x28000d[_0x432ca6(0x183)]?'üîó\x20*Transaction\x20Link:*\x20`'+_0x28000d[_0x432ca6(0x183)]+'`':_0x432ca6(0x154));await this[_0x432ca6(0x15a)](_0x383526,_0x572396,{'parse_mode':_0x432ca6(0x1fe)});}async[a80_0x1aea81(0x1d8)](_0x514033,_0x9ffeb){const _0x2281c5=a80_0x1aea81;try{const _0x3be46c=await database_1[_0x2281c5(0x1ff)][_0x2281c5(0x1b6)][_0x2281c5(0x1f5)]({'where':{'shopId':_0x514033},'select':{'notificationLogin':!![]}});if(!_0x3be46c?.['notificationLogin']){console[_0x2281c5(0x194)](_0x2281c5(0x121)+_0x514033);return;}const _0x311f53=_0x9ffeb[_0x2281c5(0x1b8)]?'üîê':'üö®',_0x5cd410=_0x9ffeb['success']?_0x2281c5(0x1f9):_0x2281c5(0x204);let _0x488fdd=_0x311f53+'\x20*'+_0x5cd410+'*\x0a\x0a'+(_0x2281c5(0x1f2)+_0x9ffeb[_0x2281c5(0x193)]+'`\x0a')+('üìÖ\x20Time:\x20'+_0x9ffeb[_0x2281c5(0x1d2)][_0x2281c5(0x1b2)]('en-US')+'\x0a');_0x9ffeb[_0x2281c5(0x1e5)]&&(_0x488fdd+=_0x2281c5(0x15d)+_0x9ffeb['ipAddress']+'`\x0a');_0x9ffeb[_0x2281c5(0x11d)]&&(_0x488fdd+=_0x2281c5(0x1c4)+_0x9ffeb[_0x2281c5(0x11d)]+'\x0a');if(_0x9ffeb[_0x2281c5(0x1f7)]){const _0x3f8b47=_0x9ffeb[_0x2281c5(0x1f7)][_0x2281c5(0x1b0)]>0x32?_0x9ffeb[_0x2281c5(0x1f7)][_0x2281c5(0x1c3)](0x0,0x32)+_0x2281c5(0x131):_0x9ffeb[_0x2281c5(0x1f7)];_0x488fdd+=_0x2281c5(0x1cb)+_0x3f8b47+'`\x0a';}!_0x9ffeb[_0x2281c5(0x1b8)]&&(_0x488fdd+=_0x2281c5(0x1e9)),await this['sendShopNotification'](_0x514033,_0x488fdd,{'parse_mode':_0x2281c5(0x1fe)}),console['log'](_0x2281c5(0x18f)+_0x514033+':\x20'+(_0x9ffeb[_0x2281c5(0x1b8)]?_0x2281c5(0x1b8):_0x2281c5(0x16c)));}catch(_0x3ddccd){console[_0x2281c5(0x162)](_0x2281c5(0x157),_0x3ddccd);}}async[a80_0x1aea81(0x17b)](_0x3a1823,_0x182fef){const _0x359158=a80_0x1aea81;try{const _0x254c17=await database_1[_0x359158(0x1ff)]['shopSettings'][_0x359158(0x1f5)]({'where':{'shopId':_0x3a1823},'select':{'notificationApiError':!![]}});if(!_0x254c17?.[_0x359158(0x1c2)]){console[_0x359158(0x194)](_0x359158(0x158)+_0x3a1823);return;}let _0x3ea4e0=_0x359158(0x206)+(_0x359158(0x1e7)+_0x182fef[_0x359158(0x14c)]+'\x20'+_0x182fef[_0x359158(0x1ce)]+'`\x0a')+(_0x359158(0x141)+_0x182fef[_0x359158(0x1d2)][_0x359158(0x1b2)]('en-US')+'\x0a');_0x182fef[_0x359158(0x14b)]&&(_0x3ea4e0+=_0x359158(0x16a)+_0x182fef[_0x359158(0x14b)]+'`\x0a'),_0x3ea4e0+='‚ùå\x20Error:\x20`'+_0x182fef[_0x359158(0x189)]+'`\x0a',_0x182fef[_0x359158(0x13f)]&&(_0x3ea4e0+=_0x359158(0x165)+_0x182fef['requestId']+'`\x0a'),_0x3ea4e0+='\x0aüí°\x20Check\x20your\x20request\x20or\x20contact\x20support.',await this[_0x359158(0x15a)](_0x3a1823,_0x3ea4e0,{'parse_mode':_0x359158(0x1fe)}),console['log'](_0x359158(0x16f)+_0x3a1823+':\x20'+_0x182fef[_0x359158(0x1ce)]);}catch(_0x2c0122){console[_0x359158(0x162)](_0x359158(0x1c7),_0x2c0122);}}async[a80_0x1aea81(0x13d)](_0x427f32,_0x40b609,_0xa6adf1){const _0x4496f3=a80_0x1aea81;let _0x528136='üîî\x20*'+_0x40b609+_0x4496f3(0x1fd);for(const [_0x179f64,_0x5eeea2]of Object['entries'](_0xa6adf1)){_0x5eeea2!==null&&_0x5eeea2!==undefined&&(_0x528136+=_0x179f64+_0x4496f3(0x153)+_0x5eeea2+'`\x0a');}await this[_0x4496f3(0x15a)](_0x427f32,_0x528136,{'parse_mode':'Markdown'});}async[a80_0x1aea81(0x1f1)](_0x412a86){const _0x2681e7=a80_0x1aea81;try{console[_0x2681e7(0x194)](_0x2681e7(0x130)+_0x412a86[_0x2681e7(0x1c3)](0x0,0x32)+_0x2681e7(0x131));const _0x92e377=await database_1['default']['telegramUser'][_0x2681e7(0x1d7)]({'select':{'telegramId':!![]}});if(_0x92e377[_0x2681e7(0x1b0)]===0x0){console[_0x2681e7(0x194)]('üì±\x20No\x20active\x20Telegram\x20users\x20found');return;}for(const _0x4a738f of _0x92e377){try{await this[_0x2681e7(0x11c)]?.[_0x2681e7(0x13b)](_0x4a738f[_0x2681e7(0x1d6)],_0x412a86,{'parse_mode':_0x2681e7(0x1fe)});}catch(_0x4a19a6){console[_0x2681e7(0x162)](_0x2681e7(0x1c0)+_0x4a738f[_0x2681e7(0x1d6)]+':',_0x4a19a6);}}console[_0x2681e7(0x194)]('üì±\x20Notification\x20sent\x20to\x20'+_0x92e377[_0x2681e7(0x1b0)]+'\x20users');}catch(_0x4745e7){console[_0x2681e7(0x162)](_0x2681e7(0x18c),_0x4745e7);}}[a80_0x1aea81(0x197)](){const _0x65aa4=a80_0x1aea81;return{'isActive':!!this[_0x65aa4(0x11c)],'username':this[_0x65aa4(0x186)]};}async[a80_0x1aea81(0x1e0)](_0x17225f,_0x4cc359,_0x1b9f38,_0x4577c7){const _0x25cd5e=a80_0x1aea81;try{if(!this['bot'])return console[_0x25cd5e(0x162)](_0x25cd5e(0x119)),![];const _0x464c6d=await database_1[_0x25cd5e(0x1ff)][_0x25cd5e(0x159)]['findMany']({'where':{'shopId':_0x17225f,'isVerified':!![]},'select':{'telegramId':!![]}});if(_0x464c6d[_0x25cd5e(0x1b0)]===0x0)return console[_0x25cd5e(0x162)](_0x25cd5e(0x138)+_0x17225f),![];let _0x553efb=0x0;for(const _0x1d6ca7 of _0x464c6d){try{await this[_0x25cd5e(0x11c)][_0x25cd5e(0x168)](_0x1d6ca7[_0x25cd5e(0x1d6)],_0x4cc359,{},{'filename':_0x1b9f38,'contentType':_0x1b9f38[_0x25cd5e(0x12d)]('.png')?_0x25cd5e(0x1e6):_0x1b9f38[_0x25cd5e(0x12d)](_0x25cd5e(0x140))||_0x1b9f38[_0x25cd5e(0x12d)](_0x25cd5e(0x136))?_0x25cd5e(0x14a):_0x1b9f38[_0x25cd5e(0x12d)](_0x25cd5e(0x1e8))?_0x25cd5e(0x1ae):_0x25cd5e(0x1df)}),_0x4577c7&&await this[_0x25cd5e(0x11c)][_0x25cd5e(0x13b)](_0x1d6ca7['telegramId'],_0x4577c7),_0x553efb++;}catch(_0x6cef84){console[_0x25cd5e(0x162)](_0x25cd5e(0x170)+_0x1d6ca7[_0x25cd5e(0x1d6)]+':',_0x6cef84);}}return console[_0x25cd5e(0x194)](_0x25cd5e(0x19f)+_0x553efb+'/'+_0x464c6d[_0x25cd5e(0x1b0)]+'\x20users\x20of\x20shop\x20'+_0x17225f+':\x20'+_0x1b9f38),_0x553efb>0x0;}catch(_0x425e28){return console[_0x25cd5e(0x162)]('‚ùå\x20Error\x20sending\x20file\x20to\x20shop:',_0x425e28),![];}}async[a80_0x1aea81(0x1c1)](_0x2f441d,_0x5d8b75){const _0x37e1b6=a80_0x1aea81;try{if(!this['bot'])return console[_0x37e1b6(0x162)](_0x37e1b6(0x119)),![];return await this[_0x37e1b6(0x11c)][_0x37e1b6(0x13b)](_0x2f441d,_0x5d8b75),console[_0x37e1b6(0x194)](_0x37e1b6(0x1ab)+_0x2f441d),!![];}catch(_0x2cc011){return console[_0x37e1b6(0x162)](_0x37e1b6(0x1af),_0x2cc011),![];}}async[a80_0x1aea81(0x1f3)](_0x1ae3d7,_0x29567f,_0x30c8a0,_0x51cbc3){const _0xf26cdf=a80_0x1aea81;try{if(!this[_0xf26cdf(0x11c)])return console[_0xf26cdf(0x162)](_0xf26cdf(0x119)),![];return await this[_0xf26cdf(0x11c)][_0xf26cdf(0x168)](_0x1ae3d7,_0x29567f,{},{'filename':_0x30c8a0,'contentType':_0x30c8a0[_0xf26cdf(0x12d)](_0xf26cdf(0x11e))?_0xf26cdf(0x1e6):_0x30c8a0[_0xf26cdf(0x12d)](_0xf26cdf(0x140))||_0x30c8a0['endsWith']('.jpeg')?_0xf26cdf(0x14a):_0x30c8a0[_0xf26cdf(0x12d)](_0xf26cdf(0x1e8))?_0xf26cdf(0x1ae):'application/octet-stream'}),_0x51cbc3&&await this[_0xf26cdf(0x11c)][_0xf26cdf(0x13b)](_0x1ae3d7,_0x51cbc3),console[_0xf26cdf(0x194)](_0xf26cdf(0x1aa)+_0x1ae3d7+':\x20'+_0x30c8a0),!![];}catch(_0x393291){return console['error'](_0xf26cdf(0x19e),_0x393291),![];}}[a80_0x1aea81(0x128)](){const _0x3508ed=a80_0x1aea81;this[_0x3508ed(0x11c)]&&(this[_0x3508ed(0x11c)]['stopPolling'](),this['bot']=null,console['log'](_0x3508ed(0x1bc)));}}exports[a80_0x1aea81(0x145)]=TelegramBotService,exports[a80_0x1aea81(0x1dc)]=new TelegramBotService();