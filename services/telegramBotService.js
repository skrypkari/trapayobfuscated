'use strict';const a74_0x47a400=a74_0x12ee;(function(_0x54d7ed,_0x294a6c){const _0x492c2a=a74_0x12ee,_0x25a1d2=_0x54d7ed();while(!![]){try{const _0x18c171=parseInt(_0x492c2a(0x1a1))/0x1+parseInt(_0x492c2a(0x18b))/0x2*(-parseInt(_0x492c2a(0xef))/0x3)+-parseInt(_0x492c2a(0x194))/0x4*(-parseInt(_0x492c2a(0xaf))/0x5)+parseInt(_0x492c2a(0xee))/0x6*(parseInt(_0x492c2a(0x103))/0x7)+-parseInt(_0x492c2a(0x185))/0x8+-parseInt(_0x492c2a(0x1a2))/0x9*(-parseInt(_0x492c2a(0xe8))/0xa)+parseInt(_0x492c2a(0xc6))/0xb*(-parseInt(_0x492c2a(0x106))/0xc);if(_0x18c171===_0x294a6c)break;else _0x25a1d2['push'](_0x25a1d2['shift']());}catch(_0x1c043b){_0x25a1d2['push'](_0x25a1d2['shift']());}}}(a74_0xe1ba,0x58e46));function a74_0x12ee(_0x5897d9,_0x1cef6b){_0x5897d9=_0x5897d9-0xa3;const _0xe1baf3=a74_0xe1ba();let _0x12ee4d=_0xe1baf3[_0x5897d9];return _0x12ee4d;}var __importDefault=this&&this['__importDefault']||function(_0x5f0376){return _0x5f0376&&_0x5f0376['__esModule']?_0x5f0376:{'default':_0x5f0376};};Object[a74_0x47a400(0xfa)](exports,'__esModule',{'value':!![]}),exports[a74_0x47a400(0x13e)]=exports[a74_0x47a400(0xa6)]=void 0x0;function a74_0xe1ba(){const _0x36872e=['update','\x20users','üì±\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20','image/jpeg','en-US','Payment\x20refund','üì±\x20No\x20active\x20Telegram\x20users\x20found','API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','name','getGatewayDisplayNameForTelegram','Error\x20handling\x20/start\x20command:','allSettled','requestId','customerName','\x20disconnected\x20from\x20shop\x20','\x20(@','‚úÖ\x20Telegram\x20bot\x20@','‚ùå\x20Invalid\x20username\x20format:\x20`','‚ùå\x20Failed\x20to\x20send\x20notification\x20to\x20all\x20users:','üí∞\x20*Amount:*\x20','üì±\x20Login\x20notifications\x20disabled\x20for\x20shop\x20','telegramBotService','\x0aüí°\x20Check\x20your\x20request\x20or\x20contact\x20support.','‚ùå\x20Failed\x20to\x20send\x20message\x20to\x20user\x20','default','üì±\x20Created\x20new\x20Telegram\x20user:\x20','‚ùå\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a','‚ùå\x20Error\x20sending\x20file\x20to\x20shop:','‚ùå\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a','Markdown','Username:\x20`','Use\x20/start\x20to\x20begin.','trim','üìù\x20Format:\x20`username\x20api_key`\x0a\x0a','Commands:\x0a','notificationLogin','‚úÖ\x20Login\x20notification\x20sent\x20for\x20shop\x20','\x20users\x20of\x20shop\x20','ü§ñ\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a','üö®\x20*API\x20Error*\x0a\x0a','.png','\x0aüë§\x20*Customer\x20Information:*\x0a','üîå\x20User\x20','üîî\x20You\x20receive\x20notifications\x20about:\x0a','isVerified','method','entries','success','\x20USDT*\x0a','sendMessage','‚Ä¢\x20Payouts\x0a','image/png','setupBotHandlers','unknown\x20shop','üîó\x20Endpoint:\x20`','*\x0a\x0a','text','username','üîÑ\x20Processing\x20single-line\x20verification\x20for\x20user\x20','Not\x20specified','User\x20','üìä\x20*Connection\x20Status*\x0a\x0a','period','sendPayoutNotification','\x20\x20\x20Username:\x20`','log','customerUa','userAgent','substring','You\x20are\x20already\x20connected\x20to\x20shop:\x20*','endsWith','üìß\x20Email:\x20`','remitterIban','toLocaleString','Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.','üåê\x20*Network:*\x20','\x20\x20\x20Name:\x20*','Payment\x20expired','env','botUsername','‚ùå\x20Error\x20sending\x20file\x20to\x20chat:','üåê\x20IP\x20address:\x20`','sendDirectFile','TELEGRAM_BOT_USERNAME','Payment\x20failed','üÜî\x20Request\x20ID:\x20`','üìù\x20Order\x20ID:\x20`','chat\x20not\x20found','‚ùå\x20Telegram\x20bot\x20not\x20initialized','\x22,\x20apiKey=\x22','‚úÖ\x20Telegram\x20user\x20','findMany','4531240ibiIHc','üéâ\x20*Congratulations!*\x0a\x0a','üåç\x20Country:\x20','telegramId','message','‚ùå\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.','8yiLEdA','üì±\x20Your\x20Telegram\x20ID:\x20`','sendDocument','üîî\x20Notifications\x20are\x20active\x0a\x0a','pk_','/disconnect\x20-\x20disconnect\x20from\x20notifications','To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a','shop','polling_error','689484RyTNAN','geo','sendNotificationToAll','‚ùå\x20Shop\x20`','‚ùå\x20An\x20error\x20occurred\x20while\x20verifying\x20data.','chargeback','test','TELEGRAM_BOT_TOKEN','sendDirectMessage','‚ùå\x20Shop\x20with\x20username\x20`','üí≥\x20*Wallet:*\x20`','‚ùå\x20Invalid\x20API\x20key\x20format.\x0a\x0a','Example:\x0a','640143GCGDXU','74835aCdVSa','‚ùå\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20','Error\x20handling\x20message:','To\x20reconnect,\x20use\x20the\x20/start\x20command','`\x0a\x0a','‚Ä¢\x20New\x20payments\x0a','*.\x0a\x0a','üõë\x20Telegram\x20bot\x20stopped','TelegramBotService','currency','‚ùå\x20You\x20are\x20not\x20connected\x20to\x20any\x20shop.\x0a\x0a','üè¶\x20IBAN:\x20`','‚úÖ\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*','üè™\x20Gateway:\x20`','Failed\x20login\x20attempt','network','Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a','15WqMVdu','‚úÖ\x20Welcome\x20back!\x0a\x0a','üì±\x20Shop:\x20*','statusCode','Payment\x20successfully\x20paid','customerIp','amount','‚úÖ\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a','toString','../config/database','`.\x0a\x0a','handleSingleLineVerification','application/octet-stream','processing','Payment\x20chargeback','ACTIVE','‚ùóÔ∏è\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!','üí∏\x20*New\x20Payout*\x0a\x0a','Telegram\x20bot\x20polling\x20error:','telegramUser','...\x22','blocked','notificationApiError','5449279iiqGky','‚ùå\x20No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20ID:\x20','\x20initialized\x20successfully','onText','length','updatedAt','timestamp','numeric','‚ùå\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a','\x22\x20->\x20display\x20\x22','...','‚Ä¢\x20Important\x20events\x0a\x0a','\x20parts:\x20','Failed\x20to\x20send\x20API\x20error\x20notification:','Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification','2-digit','findUnique','ipAddress','‚úÖ\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*','map','You\x20sent\x20','Error\x20in\x20handleSingleLineVerification:','\x20USD\x0a','‚ùå\x20Error\x20sending\x20file\x20to\x20user\x20','from','Please\x20check\x20the\x20spelling\x20and\x20try\x20again.\x0a\x0a','adminNotes','Use\x20/start\x20to\x20connect\x20to\x20a\x20shop.','../types/gateway','sendApiErrorNotification','üí∏\x20Penalty\x20amount:\x20*','last_name','includes','Payment\x20is\x20being\x20processed','510wBDVOl','üåê\x20IP:\x20`','chat','sendShopFile','üë§\x20Username:\x20`','‚ùå\x20Error:\x20`','102066ykvlgp','282426IEjXed','‚ùå\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`','sendShopNotification','bot','txid','Error\x20handling\x20/debug\x20command:','üìÖ\x20*Payout\x20Date:*\x20','Failed\x20to\x20send\x20login\x20notification:','Telegram\x20bot\x20error:','üÜî\x20Payment\x20ID:\x20`','botToken','defineProperty','startsWith','Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`','Error\x20sending\x20shop\x20notification:','üìÖ\x20Time:\x20','errorMessage','üìÖ\x20Date:\x20','secretKey','‚Ä¢\x20Payment\x20status\x20changes\x0a','91EBCIRa','üíª\x20Browser:\x20`','.jpg','12DGZXOX','application/pdf','warn','chargebackAmount','gateway','Successful\x20login','üîÑ\x20Reset\x20incomplete\x20verification\x20for\x20user\x20','üîó\x20*Transaction\x20Link:*\x20`','customerEmail','`\x20is\x20inactive.\x0a\x0a','getBotInfo','üîî\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a','stopPolling','findFirst','\x20\x20\x20Status:\x20','error','shopId','Make\x20sure\x20you\x20have\x20the\x20correct\x20username\x20from\x20your\x20account.','\x20via\x20single-line\x20input','`\x20not\x20found.\x0a\x0a','\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure','‚ùå\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','üìõ\x20Name:\x20`','createdAt','sendLoginNotification','Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).','‚úÖ\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20','‚ùå\x20Error\x20getting\x20debug\x20information.','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','.jpeg','status','split',':\x20username=\x22','‚úÖ\x20Connected\x20to\x20shop:\x20*','‚ùå\x20API\x20key\x20does\x20not\x20match\x20shop\x20`'];a74_0xe1ba=function(){return _0x36872e;};return a74_0xe1ba();}const node_telegram_bot_api_1=__importDefault(require('node-telegram-bot-api')),database_1=__importDefault(require(a74_0x47a400(0xb8))),gateway_1=require(a74_0x47a400(0xe2));class TelegramBotService{constructor(){const _0x441ddb=a74_0x47a400;this[_0x441ddb(0xf2)]=null,this[_0x441ddb(0xf9)]=process['env'][_0x441ddb(0x19b)]||'',this[_0x441ddb(0x178)]=process[_0x441ddb(0x177)][_0x441ddb(0x17c)]||'trapay_bot',this[_0x441ddb(0xf9)]?this['initializeBot']():console[_0x441ddb(0x108)]('TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables');}['initializeBot'](){const _0x4e038c=a74_0x47a400;try{this[_0x4e038c(0xf2)]=new node_telegram_bot_api_1['default'](this[_0x4e038c(0xf9)],{'polling':!![]}),this[_0x4e038c(0x15d)](),console[_0x4e038c(0x16a)](_0x4e038c(0x139)+this['botUsername']+_0x4e038c(0xc8));}catch(_0x51bc73){console[_0x4e038c(0x115)]('‚ùå\x20Failed\x20to\x20initialize\x20Telegram\x20bot:',_0x51bc73);}}[a74_0x47a400(0x15d)](){const _0x2fdc57=a74_0x47a400;if(!this[_0x2fdc57(0xf2)])return;this[_0x2fdc57(0xf2)][_0x2fdc57(0xc9)](/\/start/,async _0x26396c=>{const _0x2790d8=_0x2fdc57,_0x15dcbe=_0x26396c['chat']['id'],_0x51cebf=_0x26396c['from']?.['id'][_0x2790d8(0xb7)](),_0x1a8c5e=_0x26396c[_0x2790d8(0xde)]?.['username'],_0x55be6c=_0x26396c['from']?.['first_name'],_0x1ab12f=_0x26396c[_0x2790d8(0xde)]?.[_0x2790d8(0xe5)];if(!_0x51cebf)return;try{let _0x4471d4=await database_1[_0x2790d8(0x141)][_0x2790d8(0xc2)][_0x2790d8(0xd6)]({'where':{'telegramId':_0x51cebf},'include':{'shop':!![]}});!_0x4471d4?(_0x4471d4=await database_1[_0x2790d8(0x141)]['telegramUser']['create']({'data':{'telegramId':_0x51cebf,'username':_0x1a8c5e,'firstName':_0x55be6c,'lastName':_0x1ab12f,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console[_0x2790d8(0x16a)](_0x2790d8(0x142)+_0x51cebf+_0x2790d8(0x138)+_0x1a8c5e+')')):_0x4471d4=await database_1[_0x2790d8(0x141)][_0x2790d8(0xc2)][_0x2790d8(0x129)]({'where':{'telegramId':_0x51cebf},'data':{'username':_0x1a8c5e,'firstName':_0x55be6c,'lastName':_0x1ab12f},'include':{'shop':!![]}}),_0x4471d4[_0x2790d8(0x155)]&&_0x4471d4['shopId']&&_0x4471d4[_0x2790d8(0x192)]?await this[_0x2790d8(0xf2)]?.['sendMessage'](_0x15dcbe,_0x2790d8(0xb0)+(_0x2790d8(0x16e)+_0x4471d4[_0x2790d8(0x192)][_0x2790d8(0x131)]+'*\x0a')+(_0x2790d8(0x147)+_0x4471d4[_0x2790d8(0x192)][_0x2790d8(0x162)]+'`\x0a\x0a')+_0x2790d8(0x154)+_0x2790d8(0xa3)+_0x2790d8(0x102)+'‚Ä¢\x20Payouts\x0a\x0a'+'Commands:\x0a'+'/status\x20-\x20check\x20connection\x20status\x0a'+_0x2790d8(0x190),{'parse_mode':_0x2790d8(0x146)}):(_0x4471d4[_0x2790d8(0x116)]&&!_0x4471d4[_0x2790d8(0x155)]&&(await database_1[_0x2790d8(0x141)]['telegramUser']['update']({'where':{'telegramId':_0x51cebf},'data':{'shopId':null,'isVerified':![]}}),console[_0x2790d8(0x16a)](_0x2790d8(0x10c)+_0x51cebf)),await this[_0x2790d8(0xf2)]?.['sendMessage'](_0x15dcbe,_0x2790d8(0x14f)+_0x2790d8(0x191)+_0x2790d8(0x14a)+_0x2790d8(0x1a0)+_0x2790d8(0x122)+_0x2790d8(0xbf),{'parse_mode':_0x2790d8(0x146)}));}catch(_0x2ab14b){console['error'](_0x2790d8(0x133),_0x2ab14b),await this[_0x2790d8(0xf2)]?.[_0x2790d8(0x15a)](_0x15dcbe,_0x2790d8(0x11b));}}),this[_0x2fdc57(0xf2)][_0x2fdc57(0xc9)](/\/disconnect/,async _0x27af22=>{const _0xd1e567=_0x2fdc57,_0x110eb7=_0x27af22[_0xd1e567(0xea)]['id'],_0x1dcafd=_0x27af22[_0xd1e567(0xde)]?.['id'][_0xd1e567(0xb7)]();if(!_0x1dcafd)return;try{const _0x3b63c5=await database_1[_0xd1e567(0x141)][_0xd1e567(0xc2)][_0xd1e567(0xd6)]({'where':{'telegramId':_0x1dcafd},'include':{'shop':!![]}});if(!_0x3b63c5||!_0x3b63c5[_0xd1e567(0x155)]||!_0x3b63c5['shopId']){await this[_0xd1e567(0xf2)]?.[_0xd1e567(0x15a)](_0x110eb7,_0xd1e567(0x18a));return;}const _0x1276c4=_0x3b63c5[_0xd1e567(0x192)]?.[_0xd1e567(0x131)]||_0xd1e567(0x15e);await database_1['default'][_0xd1e567(0xc2)][_0xd1e567(0x129)]({'where':{'telegramId':_0x1dcafd},'data':{'shopId':null,'isVerified':![]}}),console[_0xd1e567(0x16a)](_0xd1e567(0x153)+_0x1dcafd+_0xd1e567(0x137)+_0x3b63c5[_0xd1e567(0x116)]),await this[_0xd1e567(0xf2)]?.[_0xd1e567(0x15a)](_0x110eb7,_0xd1e567(0xaa)+_0x1276c4+_0xd1e567(0xa4)+_0xd1e567(0x1a5),{'parse_mode':_0xd1e567(0x146)});}catch(_0x2fa8a3){console[_0xd1e567(0x115)]('Error\x20handling\x20/disconnect\x20command:',_0x2fa8a3),await this['bot']?.[_0xd1e567(0x15a)](_0x110eb7,'‚ùå\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this['bot']['onText'](/\/status/,async _0x30d88b=>{const _0x5b052e=_0x2fdc57,_0x1a9f15=_0x30d88b[_0x5b052e(0xea)]['id'],_0xf427c3=_0x30d88b[_0x5b052e(0xde)]?.['id']['toString']();if(!_0xf427c3)return;try{const _0x27e21b=await database_1[_0x5b052e(0x141)]['telegramUser'][_0x5b052e(0xd6)]({'where':{'telegramId':_0xf427c3},'include':{'shop':!![]}});if(!_0x27e21b){await this['bot']?.['sendMessage'](_0x1a9f15,_0x5b052e(0x143)+_0x5b052e(0x148));return;}if(!_0x27e21b['isVerified']||!_0x27e21b[_0x5b052e(0x116)]||!_0x27e21b[_0x5b052e(0x192)]){await this[_0x5b052e(0xf2)]?.[_0x5b052e(0x15a)](_0x1a9f15,_0x5b052e(0xce)+'Use\x20/start\x20to\x20connect.');return;}await this['bot']?.['sendMessage'](_0x1a9f15,_0x5b052e(0x166)+(_0x5b052e(0x127)+_0x27e21b[_0x5b052e(0x192)][_0x5b052e(0x131)]+'*\x0a')+(_0x5b052e(0xec)+_0x27e21b[_0x5b052e(0x192)][_0x5b052e(0x162)]+'`\x0a')+('üìÖ\x20Connection\x20date:\x20'+_0x27e21b[_0x5b052e(0xcb)]['toLocaleDateString']('en-US')+'\x0a\x0a')+_0x5b052e(0x18e)+_0x5b052e(0x14b)+_0x5b052e(0x190),{'parse_mode':_0x5b052e(0x146)});}catch(_0x58e861){console[_0x5b052e(0x115)]('Error\x20handling\x20/status\x20command:',_0x58e861),await this['bot']?.[_0x5b052e(0x15a)](_0x1a9f15,'‚ùå\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this[_0x2fdc57(0xf2)]['onText'](/\/debug/,async _0x498e0f=>{const _0x383744=_0x2fdc57,_0x30b56a=_0x498e0f[_0x383744(0xea)]['id'],_0xeed5d0=_0x498e0f['from']?.['id'][_0x383744(0xb7)]();if(!_0xeed5d0)return;try{const _0x90850b=await database_1[_0x383744(0x141)][_0x383744(0xc2)][_0x383744(0xd6)]({'where':{'telegramId':_0xeed5d0},'include':{'shop':!![]}});let _0x48d3bf='üîç\x20*Debug\x20Information*\x0a\x0a';_0x48d3bf+=_0x383744(0x18c)+_0xeed5d0+_0x383744(0x1a6),_0x90850b?.[_0x383744(0x155)]&&_0x90850b[_0x383744(0x192)]?(_0x48d3bf+='üè™\x20Your\x20connected\x20shop:\x0a',_0x48d3bf+=_0x383744(0x175)+_0x90850b['shop']['name']+'*\x0a',_0x48d3bf+=_0x383744(0x169)+_0x90850b[_0x383744(0x192)][_0x383744(0x162)]+'`\x0a',_0x48d3bf+=_0x383744(0x114)+_0x90850b['shop'][_0x383744(0x124)]+'\x0a\x0a'):_0x48d3bf+=_0x383744(0xa8),_0x48d3bf+=_0x383744(0xe1),await this[_0x383744(0xf2)]?.[_0x383744(0x15a)](_0x30b56a,_0x48d3bf,{'parse_mode':_0x383744(0x146)});}catch(_0x26c6e4){console['error'](_0x383744(0xf4),_0x26c6e4),await this[_0x383744(0xf2)]?.[_0x383744(0x15a)](_0x30b56a,_0x383744(0x121));}}),this[_0x2fdc57(0xf2)]['on'](_0x2fdc57(0x189),async _0x362620=>{const _0x366a8a=_0x2fdc57;if(_0x362620[_0x366a8a(0x161)]?.[_0x366a8a(0xfb)]('/'))return;const _0xa47f9=_0x362620['chat']['id'],_0x3236d=_0x362620[_0x366a8a(0xde)]?.['id']['toString'](),_0x2ea10b=_0x362620['text']?.[_0x366a8a(0x149)]();if(!_0x3236d||!_0x2ea10b)return;try{const _0x1707a2=await database_1[_0x366a8a(0x141)][_0x366a8a(0xc2)][_0x366a8a(0xd6)]({'where':{'telegramId':_0x3236d},'include':{'shop':!![]}});if(!_0x1707a2){await this[_0x366a8a(0xf2)]?.[_0x366a8a(0x15a)](_0xa47f9,'‚ùå\x20Please\x20use\x20/start\x20command\x20first');return;}if(_0x1707a2[_0x366a8a(0x155)]&&_0x1707a2[_0x366a8a(0x116)]&&_0x1707a2['shop']){await this[_0x366a8a(0xf2)]?.[_0x366a8a(0x15a)](_0xa47f9,_0x366a8a(0xd8)+_0x1707a2[_0x366a8a(0x192)][_0x366a8a(0x131)]+'*.\x0a\x0a'+'Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.',{'parse_mode':_0x366a8a(0x146)});return;}const _0x476d16=_0x2ea10b[_0x366a8a(0x125)](/\s+/);if(_0x476d16[_0x366a8a(0xca)]!==0x2){await this['bot']?.[_0x366a8a(0x15a)](_0xa47f9,_0x366a8a(0x145)+_0x366a8a(0x14a)+_0x366a8a(0x1a0)+_0x366a8a(0x122)+(_0x366a8a(0xda)+_0x476d16['length']+_0x366a8a(0xd2)+_0x476d16[_0x366a8a(0xd9)](_0x400ac6=>'`'+_0x400ac6+'`')['join'](',\x20')),{'parse_mode':'Markdown'});return;}const [_0x586459,_0x36b4a9]=_0x476d16;console[_0x366a8a(0x16a)](_0x366a8a(0x163)+_0x3236d+':\x20username=\x22'+_0x586459+_0x366a8a(0x182)+_0x36b4a9[_0x366a8a(0x16d)](0x0,0xa)+_0x366a8a(0xc3)),await this[_0x366a8a(0xba)](_0xa47f9,_0x3236d,_0x586459,_0x36b4a9);}catch(_0xdeefaf){console[_0x366a8a(0x115)](_0x366a8a(0x1a4),_0xdeefaf),await this[_0x366a8a(0xf2)]?.['sendMessage'](_0xa47f9,_0x366a8a(0x11b));}}),this['bot']['on'](_0x2fdc57(0x115),_0x24623c=>{const _0x2d3e53=_0x2fdc57;console['error'](_0x2d3e53(0xf7),_0x24623c);}),this[_0x2fdc57(0xf2)]['on'](_0x2fdc57(0x193),_0x3c394d=>{const _0x9925dd=_0x2fdc57;console['error'](_0x9925dd(0xc1),_0x3c394d);});}async[a74_0x47a400(0xba)](_0x32b536,_0x13c58f,_0x51386,_0x3555dd){const _0x433abf=a74_0x47a400;try{console[_0x433abf(0x16a)]('üîÑ\x20Processing\x20single-line\x20verification\x20for\x20user\x20'+_0x13c58f+_0x433abf(0x126)+_0x51386+'\x22,\x20apiKey=\x22'+_0x3555dd['substring'](0x0,0xa)+_0x433abf(0xc3));if(!_0x51386||_0x51386[_0x433abf(0xca)]<0x3||_0x51386['length']>0x32||!/^[a-zA-Z0-9_]+$/[_0x433abf(0x19a)](_0x51386)){await this['bot']?.['sendMessage'](_0x32b536,_0x433abf(0x13a)+_0x51386+_0x433abf(0x1a6)+_0x433abf(0x11f),{'parse_mode':'Markdown'});return;}if(!_0x3555dd||!_0x3555dd[_0x433abf(0xfb)](_0x433abf(0x18f))&&!_0x3555dd[_0x433abf(0xfb)]('sk_')){await this[_0x433abf(0xf2)]?.['sendMessage'](_0x32b536,_0x433abf(0x19f)+_0x433abf(0x130),{'parse_mode':_0x433abf(0x146)});return;}const _0x294396=await database_1[_0x433abf(0x141)]['shop'][_0x433abf(0xd6)]({'where':{'username':_0x51386},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x294396){const _0x23cef5=_0x433abf(0x19d)+_0x51386+_0x433abf(0x119)+_0x433abf(0xdf)+_0x433abf(0x117);await this['bot']?.[_0x433abf(0x15a)](_0x32b536,_0x23cef5,{'parse_mode':_0x433abf(0x146)});return;}if(_0x294396[_0x433abf(0x124)]!==_0x433abf(0xbe)){await this[_0x433abf(0xf2)]?.[_0x433abf(0x15a)](_0x32b536,_0x433abf(0x197)+_0x51386+_0x433abf(0x10f)+'Contact\x20administrator.',{'parse_mode':_0x433abf(0x146)});return;}if(_0x294396['publicKey']!==_0x3555dd&&_0x294396[_0x433abf(0x101)]!==_0x3555dd){await this[_0x433abf(0xf2)]?.[_0x433abf(0x15a)](_0x32b536,_0x433abf(0x128)+_0x51386+_0x433abf(0xb9)+_0x433abf(0xae)+_0x433abf(0xfc),{'parse_mode':_0x433abf(0x146)});return;}const _0x2f3c4c=await database_1['default'][_0x433abf(0xc2)][_0x433abf(0x113)]({'where':{'shopId':_0x294396['id'],'isVerified':!![],'telegramId':{'not':_0x13c58f}}});if(_0x2f3c4c){await this['bot']?.['sendMessage'](_0x32b536,_0x433abf(0xf0)+_0x51386+_0x433abf(0xb9)+_0x433abf(0x173),{'parse_mode':'Markdown'});return;}await database_1[_0x433abf(0x141)]['telegramUser'][_0x433abf(0x129)]({'where':{'telegramId':_0x13c58f},'data':{'shopId':_0x294396['id'],'isVerified':!![]}}),await this[_0x433abf(0xf2)]?.[_0x433abf(0x15a)](_0x32b536,_0x433abf(0x186)+_0x433abf(0xb6)+(_0x433abf(0xb1)+_0x294396[_0x433abf(0x131)]+'*\x0a')+('üë§\x20Username:\x20`'+_0x294396['username']+_0x433abf(0x1a6))+_0x433abf(0x111)+_0x433abf(0xa3)+_0x433abf(0x102)+_0x433abf(0x15b)+_0x433abf(0xd1)+'Commands:\x0a'+'/status\x20-\x20check\x20connection\x20status\x0a'+_0x433abf(0x190),{'parse_mode':_0x433abf(0x146)}),console[_0x433abf(0x16a)](_0x433abf(0x183)+_0x13c58f+'\x20verified\x20for\x20shop\x20'+_0x294396[_0x433abf(0x162)]+_0x433abf(0x118));}catch(_0x8995b5){console[_0x433abf(0x115)](_0x433abf(0xdb),_0x8995b5),await this['bot']?.['sendMessage'](_0x32b536,_0x433abf(0x198));}}async[a74_0x47a400(0xf1)](_0x15ea20,_0xffa9b1,_0x11ece2){const _0x506205=a74_0x47a400;if(!this[_0x506205(0xf2)]){console[_0x506205(0x108)](_0x506205(0xd4));return;}try{const _0x2f1527=await database_1['default'][_0x506205(0xc2)][_0x506205(0x184)]({'where':{'shopId':_0x15ea20,'isVerified':!![]}});if(_0x2f1527[_0x506205(0xca)]===0x0){console[_0x506205(0x16a)]('No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20'+_0x15ea20);return;}const _0x3cb3ca=_0x2f1527[_0x506205(0xd9)](async _0x5a35a5=>{const _0x2c5946=_0x506205;try{await this['bot']?.[_0x2c5946(0x15a)](_0x5a35a5[_0x2c5946(0x188)],_0xffa9b1,_0x11ece2),console[_0x2c5946(0x16a)]('‚úÖ\x20Notification\x20sent\x20to\x20Telegram\x20user\x20'+_0x5a35a5['telegramId']);}catch(_0x963f07){console['error'](_0x2c5946(0x1a3)+_0x5a35a5[_0x2c5946(0x188)]+':',_0x963f07),_0x963f07 instanceof Error&&(_0x963f07['message'][_0x2c5946(0xe6)](_0x2c5946(0xc4))||_0x963f07[_0x2c5946(0x189)][_0x2c5946(0xe6)](_0x2c5946(0x180))||_0x963f07['message']['includes']('user\x20is\x20deactivated'))&&(await database_1[_0x2c5946(0x141)][_0x2c5946(0xc2)][_0x2c5946(0x129)]({'where':{'id':_0x5a35a5['id']},'data':{'isVerified':![]}}),console[_0x2c5946(0x16a)](_0x2c5946(0x165)+_0x5a35a5['telegramId']+_0x2c5946(0x11a)));}});await Promise[_0x506205(0x134)](_0x3cb3ca);}catch(_0x1a6db5){console[_0x506205(0x115)](_0x506205(0xfd),_0x1a6db5);}}async['sendPaymentNotification'](_0x21f7bc,_0x281caa,_0x401fd9){const _0x49dc33=a74_0x47a400,_0x33e9ed={'created':'üÜï','paid':'‚úÖ','failed':'‚ùå','expired':'‚è∞','refund':'üîÑ','chargeback':'‚ö†Ô∏è','processing':'‚öôÔ∏è'},_0x16cb89={'created':'New\x20payment\x20created','paid':_0x49dc33(0xb3),'failed':_0x49dc33(0x17d),'expired':_0x49dc33(0x176),'refund':_0x49dc33(0x12e),'chargeback':_0x49dc33(0xbd),'processing':_0x49dc33(0xe7)},_0x20c7f9=_0x33e9ed[_0x401fd9],_0x82f979=_0x16cb89[_0x401fd9],_0x4bf66c=(0x0,gateway_1[_0x49dc33(0x132)])(_0x281caa[_0x49dc33(0x10a)]);console['log']('üì±\x20Telegram\x20notification:\x20gateway\x20\x22'+_0x281caa[_0x49dc33(0x10a)]+_0x49dc33(0xcf)+_0x4bf66c+'\x22');let _0x274174=_0x20c7f9+'\x20*'+_0x82f979+_0x49dc33(0x160)+('üí∞\x20Amount:\x20*'+_0x281caa[_0x49dc33(0xb5)]+'\x20'+_0x281caa[_0x49dc33(0xa7)]+'*\x0a')+(_0x49dc33(0x17f)+(_0x281caa['orderId']||_0x281caa['id'])+'`\x0a')+(_0x49dc33(0xf8)+_0x281caa['id']+'`\x0a')+(_0x49dc33(0xab)+_0x4bf66c+'`\x0a')+(_0x49dc33(0x100)+new Date(_0x281caa[_0x49dc33(0x11d)])[_0x49dc33(0x172)](_0x49dc33(0x12d))+'\x0a');if(_0x281caa[_0x49dc33(0x136)]||_0x281caa[_0x49dc33(0x10e)]||_0x281caa[_0x49dc33(0x171)]||_0x281caa[_0x49dc33(0xb4)]||_0x281caa[_0x49dc33(0x16b)]){_0x274174+=_0x49dc33(0x152);_0x281caa['customerName']&&(_0x274174+=_0x49dc33(0x11c)+_0x281caa[_0x49dc33(0x136)]+'`\x0a');_0x281caa[_0x49dc33(0x10e)]&&(_0x274174+=_0x49dc33(0x170)+_0x281caa[_0x49dc33(0x10e)]+'`\x0a');_0x281caa[_0x49dc33(0x171)]&&(_0x274174+=_0x49dc33(0xa9)+_0x281caa[_0x49dc33(0x171)]+'`\x0a');_0x281caa[_0x49dc33(0xb4)]&&(_0x274174+=_0x49dc33(0xe9)+_0x281caa['customerIp']+'`\x0a');if(_0x281caa['customerUa']){const _0xded1d9=_0x281caa[_0x49dc33(0x16b)][_0x49dc33(0xca)]>0x32?_0x281caa[_0x49dc33(0x16b)][_0x49dc33(0x16d)](0x0,0x32)+_0x49dc33(0xd0):_0x281caa['customerUa'];_0x274174+=_0x49dc33(0x104)+_0xded1d9+'`\x0a';}}_0x401fd9===_0x49dc33(0x199)&&_0x281caa[_0x49dc33(0x109)]&&(_0x274174+=_0x49dc33(0xe4)+_0x281caa[_0x49dc33(0x109)]+_0x49dc33(0x159)),_0x401fd9===_0x49dc33(0xbc)&&(_0x274174+='‚è≥\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a'),_0x281caa[_0x49dc33(0xe0)]&&(_0x274174+='üìù\x20Notes:\x20'+_0x281caa[_0x49dc33(0xe0)]+'\x0a'),await this[_0x49dc33(0xf1)](_0x21f7bc,_0x274174,{'parse_mode':'Markdown'});}async[a74_0x47a400(0x168)](_0x6ce6f7,_0x428f76){const _0x578c86=a74_0x47a400,_0x3fd4dc=new Date(_0x428f76[_0x578c86(0x11d)])['toLocaleString'](_0x578c86(0x12d),{'year':_0x578c86(0xcd),'month':_0x578c86(0xd5),'day':_0x578c86(0xd5),'hour':_0x578c86(0xd5),'minute':'2-digit','second':_0x578c86(0xd5)}),_0x2131e7=_0x578c86(0xc0)+(_0x578c86(0xf5)+_0x3fd4dc+'\x0a')+(_0x578c86(0x13c)+_0x428f76[_0x578c86(0xb5)]+_0x578c86(0xdc))+('‚è±Ô∏è\x20*Period:*\x20'+(_0x428f76[_0x578c86(0x167)]||'Not\x20specified')+'\x0a')+(_0x578c86(0x174)+(_0x428f76[_0x578c86(0xad)]||_0x578c86(0x164))+'\x0a')+(_0x578c86(0x19e)+(_0x428f76['wallet']||_0x578c86(0x164))+'`\x0a')+(_0x428f76[_0x578c86(0xf3)]?_0x578c86(0x10d)+_0x428f76[_0x578c86(0xf3)]+'`':'üîó\x20*Transaction\x20Link:*\x20Pending');await this['sendShopNotification'](_0x6ce6f7,_0x2131e7,{'parse_mode':_0x578c86(0x146)});}async[a74_0x47a400(0x11e)](_0x5ada72,_0x5cc4a5){const _0x1cc795=a74_0x47a400;try{const _0x336839=await database_1[_0x1cc795(0x141)]['shopSettings'][_0x1cc795(0xd6)]({'where':{'shopId':_0x5ada72},'select':{'notificationLogin':!![]}});if(!_0x336839?.[_0x1cc795(0x14c)]){console[_0x1cc795(0x16a)](_0x1cc795(0x13d)+_0x5ada72);return;}const _0x5da073=_0x5cc4a5['success']?'üîê':'üö®',_0x1c5e35=_0x5cc4a5[_0x1cc795(0x158)]?_0x1cc795(0x10b):_0x1cc795(0xac);let _0x238f65=_0x5da073+'\x20*'+_0x1c5e35+_0x1cc795(0x160)+(_0x1cc795(0xec)+_0x5cc4a5[_0x1cc795(0x162)]+'`\x0a')+(_0x1cc795(0xfe)+_0x5cc4a5['timestamp'][_0x1cc795(0x172)](_0x1cc795(0x12d))+'\x0a');_0x5cc4a5[_0x1cc795(0xd7)]&&(_0x238f65+=_0x1cc795(0x17a)+_0x5cc4a5[_0x1cc795(0xd7)]+'`\x0a');_0x5cc4a5[_0x1cc795(0x195)]&&(_0x238f65+=_0x1cc795(0x187)+_0x5cc4a5[_0x1cc795(0x195)]+'\x0a');if(_0x5cc4a5['userAgent']){const _0x3aced7=_0x5cc4a5[_0x1cc795(0x16c)]['length']>0x32?_0x5cc4a5[_0x1cc795(0x16c)][_0x1cc795(0x16d)](0x0,0x32)+_0x1cc795(0xd0):_0x5cc4a5[_0x1cc795(0x16c)];_0x238f65+=_0x1cc795(0x104)+_0x3aced7+'`\x0a';}!_0x5cc4a5[_0x1cc795(0x158)]&&(_0x238f65+='\x0a‚ö†Ô∏è\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!'),await this[_0x1cc795(0xf1)](_0x5ada72,_0x238f65,{'parse_mode':'Markdown'}),console['log'](_0x1cc795(0x14d)+_0x5ada72+':\x20'+(_0x5cc4a5['success']?_0x1cc795(0x158):'failed'));}catch(_0x1efe7b){console['error'](_0x1cc795(0xf6),_0x1efe7b);}}async[a74_0x47a400(0xe3)](_0x558cfe,_0x1747a2){const _0x452872=a74_0x47a400;try{const _0x4a4186=await database_1[_0x452872(0x141)]['shopSettings'][_0x452872(0xd6)]({'where':{'shopId':_0x558cfe},'select':{'notificationApiError':!![]}});if(!_0x4a4186?.[_0x452872(0xc5)]){console[_0x452872(0x16a)](_0x452872(0x12b)+_0x558cfe);return;}let _0x18fe0a=_0x452872(0x150)+(_0x452872(0x15f)+_0x1747a2[_0x452872(0x156)]+'\x20'+_0x1747a2['endpoint']+'`\x0a')+(_0x452872(0xfe)+_0x1747a2[_0x452872(0xcc)][_0x452872(0x172)](_0x452872(0x12d))+'\x0a');_0x1747a2[_0x452872(0xb2)]&&(_0x18fe0a+='üìä\x20Error\x20code:\x20`'+_0x1747a2[_0x452872(0xb2)]+'`\x0a'),_0x18fe0a+=_0x452872(0xed)+_0x1747a2[_0x452872(0xff)]+'`\x0a',_0x1747a2[_0x452872(0x135)]&&(_0x18fe0a+=_0x452872(0x17e)+_0x1747a2[_0x452872(0x135)]+'`\x0a'),_0x18fe0a+=_0x452872(0x13f),await this[_0x452872(0xf1)](_0x558cfe,_0x18fe0a,{'parse_mode':'Markdown'}),console['log'](_0x452872(0x120)+_0x558cfe+':\x20'+_0x1747a2['endpoint']);}catch(_0x4da508){console[_0x452872(0x115)](_0x452872(0xd3),_0x4da508);}}async['sendCustomNotification'](_0xc2b9a7,_0x667f3b,_0x4a6599){const _0x40a7ed=a74_0x47a400;let _0x5578e3='üîî\x20*'+_0x667f3b+_0x40a7ed(0x160);for(const [_0x240a8b,_0x18cca8]of Object[_0x40a7ed(0x157)](_0x4a6599)){_0x18cca8!==null&&_0x18cca8!==undefined&&(_0x5578e3+=_0x240a8b+':\x20`'+_0x18cca8+'`\x0a');}await this['sendShopNotification'](_0xc2b9a7,_0x5578e3,{'parse_mode':_0x40a7ed(0x146)});}async[a74_0x47a400(0x196)](_0x2b6594){const _0x3b1600=a74_0x47a400;try{console[_0x3b1600(0x16a)]('üì±\x20Sending\x20notification\x20to\x20all\x20connected\x20users:\x20'+_0x2b6594[_0x3b1600(0x16d)](0x0,0x32)+_0x3b1600(0xd0));const _0x34a1fe=await database_1[_0x3b1600(0x141)]['telegramUser'][_0x3b1600(0x184)]({'select':{'telegramId':!![]}});if(_0x34a1fe[_0x3b1600(0xca)]===0x0){console[_0x3b1600(0x16a)](_0x3b1600(0x12f));return;}for(const _0x44b539 of _0x34a1fe){try{await this[_0x3b1600(0xf2)]?.['sendMessage'](_0x44b539[_0x3b1600(0x188)],_0x2b6594,{'parse_mode':_0x3b1600(0x146)});}catch(_0x4692a2){console[_0x3b1600(0x115)](_0x3b1600(0x140)+_0x44b539[_0x3b1600(0x188)]+':',_0x4692a2);}}console['log']('üì±\x20Notification\x20sent\x20to\x20'+_0x34a1fe['length']+_0x3b1600(0x12a));}catch(_0x4f6623){console[_0x3b1600(0x115)](_0x3b1600(0x13b),_0x4f6623);}}[a74_0x47a400(0x110)](){const _0x2f46d0=a74_0x47a400;return{'isActive':!!this['bot'],'username':this[_0x2f46d0(0x178)]};}async[a74_0x47a400(0xeb)](_0x47f896,_0x4e45fc,_0x29f7c8,_0xccfce5){const _0x22c014=a74_0x47a400;try{if(!this['bot'])return console[_0x22c014(0x115)]('‚ùå\x20Telegram\x20bot\x20not\x20initialized'),![];const _0x5f64e6=await database_1[_0x22c014(0x141)][_0x22c014(0xc2)][_0x22c014(0x184)]({'where':{'shopId':_0x47f896,'isVerified':!![]},'select':{'telegramId':!![]}});if(_0x5f64e6['length']===0x0)return console[_0x22c014(0x115)](_0x22c014(0xc7)+_0x47f896),![];let _0x16de49=0x0;for(const _0x5c0b8a of _0x5f64e6){try{await this[_0x22c014(0xf2)][_0x22c014(0x18d)](_0x5c0b8a['telegramId'],_0x4e45fc,{},{'filename':_0x29f7c8,'contentType':_0x29f7c8['endsWith'](_0x22c014(0x151))?_0x22c014(0x15c):_0x29f7c8['endsWith'](_0x22c014(0x105))||_0x29f7c8[_0x22c014(0x16f)](_0x22c014(0x123))?_0x22c014(0x12c):_0x29f7c8[_0x22c014(0x16f)]('.pdf')?_0x22c014(0x107):_0x22c014(0xbb)}),_0xccfce5&&await this['bot'][_0x22c014(0x15a)](_0x5c0b8a[_0x22c014(0x188)],_0xccfce5),_0x16de49++;}catch(_0x339995){console[_0x22c014(0x115)](_0x22c014(0xdd)+_0x5c0b8a[_0x22c014(0x188)]+':',_0x339995);}}return console[_0x22c014(0x16a)]('‚úÖ\x20File\x20sent\x20to\x20'+_0x16de49+'/'+_0x5f64e6[_0x22c014(0xca)]+_0x22c014(0x14e)+_0x47f896+':\x20'+_0x29f7c8),_0x16de49>0x0;}catch(_0x309836){return console['error'](_0x22c014(0x144),_0x309836),![];}}async[a74_0x47a400(0x19c)](_0x2ae3a2,_0x3f5a8b){const _0x408249=a74_0x47a400;try{if(!this['bot'])return console[_0x408249(0x115)](_0x408249(0x181)),![];return await this[_0x408249(0xf2)][_0x408249(0x15a)](_0x2ae3a2,_0x3f5a8b),console[_0x408249(0x16a)]('‚úÖ\x20Direct\x20message\x20sent\x20to\x20chat\x20'+_0x2ae3a2),!![];}catch(_0x19c80e){return console['error']('‚ùå\x20Error\x20sending\x20direct\x20message:',_0x19c80e),![];}}async[a74_0x47a400(0x17b)](_0x5e134b,_0x43cf07,_0xa594e,_0x585dab){const _0x383033=a74_0x47a400;try{if(!this['bot'])return console[_0x383033(0x115)](_0x383033(0x181)),![];return await this[_0x383033(0xf2)][_0x383033(0x18d)](_0x5e134b,_0x43cf07,{},{'filename':_0xa594e,'contentType':_0xa594e[_0x383033(0x16f)]('.png')?_0x383033(0x15c):_0xa594e[_0x383033(0x16f)](_0x383033(0x105))||_0xa594e[_0x383033(0x16f)](_0x383033(0x123))?'image/jpeg':_0xa594e[_0x383033(0x16f)]('.pdf')?_0x383033(0x107):'application/octet-stream'}),_0x585dab&&await this[_0x383033(0xf2)][_0x383033(0x15a)](_0x5e134b,_0x585dab),console[_0x383033(0x16a)]('‚úÖ\x20File\x20sent\x20to\x20chat\x20'+_0x5e134b+':\x20'+_0xa594e),!![];}catch(_0x895669){return console[_0x383033(0x115)](_0x383033(0x179),_0x895669),![];}}['stopBot'](){const _0x1d2280=a74_0x47a400;this[_0x1d2280(0xf2)]&&(this[_0x1d2280(0xf2)][_0x1d2280(0x112)](),this[_0x1d2280(0xf2)]=null,console[_0x1d2280(0x16a)](_0x1d2280(0xa5)));}}exports[a74_0x47a400(0xa6)]=TelegramBotService,exports[a74_0x47a400(0x13e)]=new TelegramBotService();