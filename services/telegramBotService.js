'use strict';const a59_0x449140=a59_0x5c73;(function(_0x1c9e87,_0x5219cf){const _0x3c77ca=a59_0x5c73,_0x5bdb06=_0x1c9e87();while(!![]){try{const _0x32f009=-parseInt(_0x3c77ca(0x263))/0x1+parseInt(_0x3c77ca(0x23a))/0x2+-parseInt(_0x3c77ca(0x1dc))/0x3*(parseInt(_0x3c77ca(0x239))/0x4)+-parseInt(_0x3c77ca(0x24d))/0x5+parseInt(_0x3c77ca(0x287))/0x6+-parseInt(_0x3c77ca(0x25b))/0x7+parseInt(_0x3c77ca(0x1cb))/0x8*(parseInt(_0x3c77ca(0x1bf))/0x9);if(_0x32f009===_0x5219cf)break;else _0x5bdb06['push'](_0x5bdb06['shift']());}catch(_0x3eec61){_0x5bdb06['push'](_0x5bdb06['shift']());}}}(a59_0x1ab5,0x9e012));function a59_0x1ab5(){const _0x3f26f8=['handleSingleLineVerification','botToken','❌\x20Please\x20use\x20/start\x20command\x20first','New\x20payment\x20created','✅\x20Notification\x20sent\x20to\x20Telegram\x20user\x20','TELEGRAM_BOT_USERNAME','•\x20Important\x20events\x0a\x0a','📱\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20','failed','requestId','✅\x20Telegram\x20bot\x20@','API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','createdAt','warn','⏳\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a','telegramUser','Check\x20spelling\x20and\x20try\x20again.','processing','User\x20','../config/database','log','statusCode','onText','•\x20Payment\x20status\x20changes\x0a','Telegram\x20bot\x20error:','toLocaleString','ACTIVE','from','Use\x20/start\x20to\x20connect.','📧\x20Email:\x20`','create','gateway','✅\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*','🤖\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a','•\x20New\x20payments\x0a',':\x20`','\x20verified\x20for\x20shop\x20','❌\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`','publicKey','❌\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20','/status\x20-\x20check\x20connection\x20status\x0a','🚨\x20*API\x20Error*\x0a\x0a','🏪\x20Gateway:\x20`','\x20via\x20single-line\x20input','To\x20reconnect,\x20use\x20the\x20/start\x20command','last_name','updatedAt','adminNotes','\x20\x20\x20Public\x20Key:\x20`','sendPaymentNotification','1615352MHdSIn','2357618HeeAXa','Error\x20in\x20handleSingleLineVerification:','💻\x20Browser:\x20`','sk_','•\x20Payouts\x0a','📝\x20Order\x20ID:\x20`','notificationApiError','en-US','❌\x20Failed\x20to\x20initialize\x20Telegram\x20bot:','sendMessage','../types/gateway','Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification','sendApiErrorNotification','*\x0a\x0a','💸\x20Amount:\x20*','Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.','unknown\x20shop','Username:\x20`','text','5785485spTbbJ','sendShopNotification','error','getBotInfo','update','success','🌐\x20IP\x20address:\x20`','remitterIban','Payout\x20completed','telegramId','trim','findUnique','chat\x20not\x20found','•\x20`','6861260IaGMZx','initializeBot','sendPayoutNotification','TelegramBotService','\x22,\x20apiKey=\x22','split','\x20parts:\x20','name','498566GdpyPW','📅\x20Date:\x20','\x20USDT*\x0a','chat','You\x20are\x20already\x20connected\x20to\x20shop:\x20*','/disconnect\x20-\x20disconnect\x20from\x20notifications','shopId','endpoint','Failed\x20to\x20send\x20API\x20error\x20notification:','Commands:\x0a','✅\x20Connected\x20to\x20shop:\x20*','❌\x20Invalid\x20API\x20key\x20format.\x0a\x0a','📅\x20Time:\x20','🆔\x20Payment\x20ID:\x20`','length','ipAddress','.\x20*','Telegram\x20bot\x20polling\x20error:','*.\x0a\x0a','findMany','Markdown','...\x22','customerUa','shop','To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a','status','__esModule','📱\x20Created\x20new\x20Telegram\x20user:\x20','__importDefault','Error\x20handling\x20message:','...','customerIp','allSettled','userAgent','Payment\x20expired','\x0a👤\x20*Customer\x20Information:*\x0a','104826hJoDLp','🏪\x20Available\x20shops\x20in\x20system:\x0a','🆔\x20Request\x20ID:\x20`','trapay_bot','Error\x20handling\x20/debug\x20command:','botUsername','TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables','✅\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a','❌\x20An\x20error\x20occurred\x20while\x20verifying\x20data.','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','👤\x20Username:\x20`','node-telegram-bot-api','orderId','❗️\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!','notificationLogin','\x20\x20\x20Status:\x20','🔔\x20*','findFirst','✅\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20','\x20(@','test','🔔\x20You\x20receive\x20notifications\x20about:\x0a','🔍\x20*Debug\x20Information*\x0a\x0a','Error\x20handling\x20/status\x20command:','join','💰\x20Amount:\x20*','📊\x20*Connection\x20Status*\x0a\x0a','user\x20is\x20deactivated','❌\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a','🔔\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a','bot','secretKey','substring','❌\x20API\x20key\x20does\x20not\x20match\x20shop\x20`','`\x20is\x20inactive.\x0a\x0a','You\x20sent\x20','sendLoginNotification','customerEmail','🔔\x20Notifications\x20are\x20active\x0a\x0a','2313dojmML','Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`','🔗\x20TXID:\x20`','Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).','startsWith','✅\x20Login\x20notification\x20sent\x20for\x20shop\x20','📱\x20Telegram\x20notification:\x20gateway\x20\x22','`.\x0a\x0a','❌\x20Error\x20getting\x20debug\x20information.','toString','isVerified','telegramBotService','77528SsZgSv','Successful\x20login','🔗\x20Endpoint:\x20`','TELEGRAM_BOT_TOKEN','📅\x20Connection\x20date:\x20','\x20disconnected\x20from\x20shop\x20','getGatewayDisplayNameForTelegram','currency','\x0a💡\x20Check\x20your\x20request\x20or\x20contact\x20support.','stopBot','toLocaleDateString','\x22\x20->\x20display\x20\x22','🏦\x20IBAN:\x20`','message','\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure','🔄\x20Reset\x20incomplete\x20verification\x20for\x20user\x20','timestamp','3qDirvl','❌\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a','forEach','txid','includes','Payment\x20is\x20being\x20processed','default','\x0aCheck\x20spelling\x20and\x20try\x20again.','📱\x20Login\x20notifications\x20disabled\x20for\x20shop\x20','Payment\x20refund','Payout\x20rejected','📛\x20Name:\x20`','💸\x20Penalty\x20amount:\x20*','`\x0a\x0a','setupBotHandlers','New\x20payout\x20created','`\x20not\x20found.\x0a\x0a','✅\x20Welcome\x20back!\x0a\x0a','Available\x20usernames:\x0a','amount','❌\x20Shop\x20with\x20username\x20`','shopSettings','sendCustomNotification','Failed\x20to\x20send\x20login\x20notification:','✅\x20Telegram\x20user\x20','first_name','username','Failed\x20login\x20attempt','❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','...`\x0a\x0a','✅\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*','Payment\x20failed','Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a','env','customerName','Error\x20sending\x20shop\x20notification:','❌\x20Error:\x20`','Payment\x20chargeback','chargebackAmount','📊\x20Error\x20code:\x20`',':\x20username=\x22','method','Contact\x20administrator.'];a59_0x1ab5=function(){return _0x3f26f8;};return a59_0x1ab5();}function a59_0x5c73(_0x372f5c,_0x416a39){const _0x1ab5b7=a59_0x1ab5();return a59_0x5c73=function(_0x5c739c,_0x2c7670){_0x5c739c=_0x5c739c-0x1b3;let _0x334b33=_0x1ab5b7[_0x5c739c];return _0x334b33;},a59_0x5c73(_0x372f5c,_0x416a39);}var __importDefault=this&&this[a59_0x449140(0x27f)]||function(_0x48ddc0){const _0x1c880a=a59_0x449140;return _0x48ddc0&&_0x48ddc0[_0x1c880a(0x27d)]?_0x48ddc0:{'default':_0x48ddc0};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a59_0x449140(0x1ca)]=exports[a59_0x449140(0x25e)]=void 0x0;const node_telegram_bot_api_1=__importDefault(require(a59_0x449140(0x292))),database_1=__importDefault(require(a59_0x449140(0x21a))),gateway_1=require(a59_0x449140(0x244));class TelegramBotService{constructor(){const _0x48051d=a59_0x449140;this['bot']=null,this['botToken']=process[_0x48051d(0x1fd)][_0x48051d(0x1ce)]||'',this['botUsername']=process[_0x48051d(0x1fd)][_0x48051d(0x20c)]||_0x48051d(0x28a),this['botToken']?this[_0x48051d(0x25c)]():console[_0x48051d(0x214)](_0x48051d(0x28d));}[a59_0x449140(0x25c)](){const _0x4ff3df=a59_0x449140;try{this[_0x4ff3df(0x1b6)]=new node_telegram_bot_api_1[(_0x4ff3df(0x1e2))](this[_0x4ff3df(0x208)],{'polling':!![]}),this[_0x4ff3df(0x1ea)](),console['log'](_0x4ff3df(0x211)+this[_0x4ff3df(0x28c)]+'\x20initialized\x20successfully');}catch(_0x3d09ab){console[_0x4ff3df(0x24f)](_0x4ff3df(0x242),_0x3d09ab);}}['setupBotHandlers'](){const _0x1109ed=a59_0x449140;if(!this[_0x1109ed(0x1b6)])return;this[_0x1109ed(0x1b6)][_0x1109ed(0x21d)](/\/start/,async _0x548568=>{const _0x2ead2c=_0x1109ed,_0x4422cd=_0x548568[_0x2ead2c(0x266)]['id'],_0x430eed=_0x548568[_0x2ead2c(0x222)]?.['id']['toString'](),_0x53cc89=_0x548568[_0x2ead2c(0x222)]?.[_0x2ead2c(0x1f6)],_0x3bdb7b=_0x548568['from']?.[_0x2ead2c(0x1f5)],_0x5b6c2f=_0x548568[_0x2ead2c(0x222)]?.[_0x2ead2c(0x234)];if(!_0x430eed)return;try{let _0x4b9f3=await database_1['default']['telegramUser'][_0x2ead2c(0x258)]({'where':{'telegramId':_0x430eed},'include':{'shop':!![]}});!_0x4b9f3?(_0x4b9f3=await database_1['default'][_0x2ead2c(0x216)][_0x2ead2c(0x225)]({'data':{'telegramId':_0x430eed,'username':_0x53cc89,'firstName':_0x3bdb7b,'lastName':_0x5b6c2f,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console[_0x2ead2c(0x21b)](_0x2ead2c(0x27e)+_0x430eed+_0x2ead2c(0x29a)+_0x53cc89+')')):_0x4b9f3=await database_1[_0x2ead2c(0x1e2)][_0x2ead2c(0x216)][_0x2ead2c(0x251)]({'where':{'telegramId':_0x430eed},'data':{'username':_0x53cc89,'firstName':_0x3bdb7b,'lastName':_0x5b6c2f},'include':{'shop':!![]}}),_0x4b9f3['isVerified']&&_0x4b9f3['shopId']&&_0x4b9f3[_0x2ead2c(0x27a)]?await this['bot']?.[_0x2ead2c(0x243)](_0x4422cd,_0x2ead2c(0x1ed)+(_0x2ead2c(0x267)+_0x4b9f3[_0x2ead2c(0x27a)]['name']+'*\x0a')+(_0x2ead2c(0x24b)+_0x4b9f3[_0x2ead2c(0x27a)]['username']+_0x2ead2c(0x1e9))+_0x2ead2c(0x29c)+_0x2ead2c(0x229)+_0x2ead2c(0x21e)+'•\x20Payouts\x0a\x0a'+_0x2ead2c(0x26c)+_0x2ead2c(0x22f)+_0x2ead2c(0x268),{'parse_mode':'Markdown'}):(_0x4b9f3[_0x2ead2c(0x269)]&&!_0x4b9f3['isVerified']&&(await database_1[_0x2ead2c(0x1e2)][_0x2ead2c(0x216)][_0x2ead2c(0x251)]({'where':{'telegramId':_0x430eed},'data':{'shopId':null,'isVerified':![]}}),console[_0x2ead2c(0x21b)](_0x2ead2c(0x1da)+_0x430eed)),await this[_0x2ead2c(0x1b6)]?.[_0x2ead2c(0x243)](_0x4422cd,_0x2ead2c(0x228)+_0x2ead2c(0x27b)+'📝\x20Format:\x20`username\x20api_key`\x0a\x0a'+'Example:\x0a'+'`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a'+_0x2ead2c(0x294),{'parse_mode':'Markdown'}));}catch(_0x572909){console[_0x2ead2c(0x24f)]('Error\x20handling\x20/start\x20command:',_0x572909),await this['bot']?.['sendMessage'](_0x4422cd,_0x2ead2c(0x1f8));}}),this[_0x1109ed(0x1b6)]['onText'](/\/disconnect/,async _0x5e764f=>{const _0x1ae0a4=_0x1109ed,_0x42fa28=_0x5e764f['chat']['id'],_0x250ebe=_0x5e764f[_0x1ae0a4(0x222)]?.['id'][_0x1ae0a4(0x1c8)]();if(!_0x250ebe)return;try{const _0x4fc01b=await database_1['default'][_0x1ae0a4(0x216)][_0x1ae0a4(0x258)]({'where':{'telegramId':_0x250ebe},'include':{'shop':!![]}});if(!_0x4fc01b||!_0x4fc01b[_0x1ae0a4(0x1c9)]||!_0x4fc01b[_0x1ae0a4(0x269)]){await this[_0x1ae0a4(0x1b6)]?.[_0x1ae0a4(0x243)](_0x42fa28,'❌\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.');return;}const _0x5f1f21=_0x4fc01b[_0x1ae0a4(0x27a)]?.['name']||_0x1ae0a4(0x24a);await database_1['default'][_0x1ae0a4(0x216)][_0x1ae0a4(0x251)]({'where':{'telegramId':_0x250ebe},'data':{'shopId':null,'isVerified':![]}}),console[_0x1ae0a4(0x21b)]('🔌\x20User\x20'+_0x250ebe+_0x1ae0a4(0x1d0)+_0x4fc01b['shopId']),await this[_0x1ae0a4(0x1b6)]?.[_0x1ae0a4(0x243)](_0x42fa28,_0x1ae0a4(0x1fa)+_0x5f1f21+_0x1ae0a4(0x275)+_0x1ae0a4(0x233),{'parse_mode':_0x1ae0a4(0x277)});}catch(_0x1585f6){console[_0x1ae0a4(0x24f)]('Error\x20handling\x20/disconnect\x20command:',_0x1585f6),await this[_0x1ae0a4(0x1b6)]?.[_0x1ae0a4(0x243)](_0x42fa28,'❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this[_0x1109ed(0x1b6)][_0x1109ed(0x21d)](/\/status/,async _0x54a8df=>{const _0x5d8f37=_0x1109ed,_0x38046d=_0x54a8df['chat']['id'],_0x3ff20d=_0x54a8df['from']?.['id'][_0x5d8f37(0x1c8)]();if(!_0x3ff20d)return;try{const _0x39f3b2=await database_1['default'][_0x5d8f37(0x216)][_0x5d8f37(0x258)]({'where':{'telegramId':_0x3ff20d},'include':{'shop':!![]}});if(!_0x39f3b2){await this[_0x5d8f37(0x1b6)]?.[_0x5d8f37(0x243)](_0x38046d,_0x5d8f37(0x1dd)+'Use\x20/start\x20to\x20begin.');return;}if(!_0x39f3b2[_0x5d8f37(0x1c9)]||!_0x39f3b2['shopId']||!_0x39f3b2[_0x5d8f37(0x27a)]){await this[_0x5d8f37(0x1b6)]?.[_0x5d8f37(0x243)](_0x38046d,'❌\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a'+_0x5d8f37(0x223));return;}await this[_0x5d8f37(0x1b6)]?.[_0x5d8f37(0x243)](_0x38046d,_0x5d8f37(0x2a1)+(_0x5d8f37(0x26d)+_0x39f3b2[_0x5d8f37(0x27a)]['name']+'*\x0a')+('👤\x20Username:\x20`'+_0x39f3b2[_0x5d8f37(0x27a)][_0x5d8f37(0x1f6)]+'`\x0a')+(_0x5d8f37(0x1cf)+_0x39f3b2[_0x5d8f37(0x235)][_0x5d8f37(0x1d5)](_0x5d8f37(0x241))+'\x0a\x0a')+_0x5d8f37(0x1be)+'Commands:\x0a'+_0x5d8f37(0x268),{'parse_mode':_0x5d8f37(0x277)});}catch(_0x2d3c2d){console[_0x5d8f37(0x24f)](_0x5d8f37(0x29e),_0x2d3c2d),await this['bot']?.[_0x5d8f37(0x243)](_0x38046d,_0x5d8f37(0x1f8));}}),this[_0x1109ed(0x1b6)][_0x1109ed(0x21d)](/\/debug/,async _0x2450b5=>{const _0x27d096=_0x1109ed,_0x5436fd=_0x2450b5[_0x27d096(0x266)]['id'],_0x364c92=_0x2450b5['from']?.['id'][_0x27d096(0x1c8)]();if(!_0x364c92)return;try{const _0x35b0c2=await database_1[_0x27d096(0x1e2)][_0x27d096(0x27a)][_0x27d096(0x276)]({'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![]},'take':0xa});let _0x4ab1e4=_0x27d096(0x29d);_0x4ab1e4+='📱\x20Your\x20Telegram\x20ID:\x20`'+_0x364c92+_0x27d096(0x1e9),_0x4ab1e4+=_0x27d096(0x288),_0x35b0c2[_0x27d096(0x1de)]((_0x25b0a2,_0x3d2f31)=>{const _0x2fe20b=_0x27d096;_0x4ab1e4+=_0x3d2f31+0x1+_0x2fe20b(0x273)+_0x25b0a2[_0x2fe20b(0x262)]+'*\x0a',_0x4ab1e4+='\x20\x20\x20Username:\x20`'+_0x25b0a2[_0x2fe20b(0x1f6)]+'`\x0a',_0x4ab1e4+=_0x2fe20b(0x296)+_0x25b0a2['status']+'\x0a',_0x4ab1e4+=_0x2fe20b(0x237)+_0x25b0a2[_0x2fe20b(0x22d)]['substring'](0x0,0xf)+_0x2fe20b(0x1f9);}),await this[_0x27d096(0x1b6)]?.[_0x27d096(0x243)](_0x5436fd,_0x4ab1e4,{'parse_mode':_0x27d096(0x277)});}catch(_0x5865de){console['error'](_0x27d096(0x28b),_0x5865de),await this[_0x27d096(0x1b6)]?.['sendMessage'](_0x5436fd,_0x27d096(0x1c7));}}),this[_0x1109ed(0x1b6)]['on'](_0x1109ed(0x1d8),async _0x27f187=>{const _0x18a189=_0x1109ed;if(_0x27f187[_0x18a189(0x24c)]?.[_0x18a189(0x1c3)]('/'))return;const _0x1abe31=_0x27f187['chat']['id'],_0x2f915b=_0x27f187[_0x18a189(0x222)]?.['id'][_0x18a189(0x1c8)](),_0x18d8c8=_0x27f187['text']?.[_0x18a189(0x257)]();if(!_0x2f915b||!_0x18d8c8)return;try{const _0x4c2462=await database_1['default'][_0x18a189(0x216)][_0x18a189(0x258)]({'where':{'telegramId':_0x2f915b},'include':{'shop':!![]}});if(!_0x4c2462){await this[_0x18a189(0x1b6)]?.['sendMessage'](_0x1abe31,_0x18a189(0x209));return;}if(_0x4c2462[_0x18a189(0x1c9)]&&_0x4c2462['shopId']&&_0x4c2462[_0x18a189(0x27a)]){await this[_0x18a189(0x1b6)]?.[_0x18a189(0x243)](_0x1abe31,_0x18a189(0x227)+_0x4c2462[_0x18a189(0x27a)][_0x18a189(0x262)]+_0x18a189(0x275)+'Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.',{'parse_mode':_0x18a189(0x277)});return;}const _0x276932=_0x18d8c8[_0x18a189(0x260)](/\s+/);if(_0x276932[_0x18a189(0x271)]!==0x2){await this[_0x18a189(0x1b6)]?.[_0x18a189(0x243)](_0x1abe31,_0x18a189(0x1b4)+'📝\x20Format:\x20`username\x20api_key`\x0a\x0a'+'Example:\x0a'+_0x18a189(0x290)+(_0x18a189(0x1bb)+_0x276932[_0x18a189(0x271)]+_0x18a189(0x261)+_0x276932['map'](_0x565888=>'`'+_0x565888+'`')[_0x18a189(0x29f)](',\x20')),{'parse_mode':_0x18a189(0x277)});return;}const [_0x1a4be2,_0x57d38f]=_0x276932;console['log']('🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20'+_0x2f915b+':\x20username=\x22'+_0x1a4be2+_0x18a189(0x25f)+_0x57d38f[_0x18a189(0x1b8)](0x0,0xa)+_0x18a189(0x278)),await this[_0x18a189(0x207)](_0x1abe31,_0x2f915b,_0x1a4be2,_0x57d38f);}catch(_0x41f42c){console['error'](_0x18a189(0x280),_0x41f42c),await this['bot']?.['sendMessage'](_0x1abe31,_0x18a189(0x1f8));}}),this[_0x1109ed(0x1b6)]['on'](_0x1109ed(0x24f),_0x1ccbfa=>{const _0x396077=_0x1109ed;console[_0x396077(0x24f)](_0x396077(0x21f),_0x1ccbfa);}),this[_0x1109ed(0x1b6)]['on']('polling_error',_0x2cbd92=>{const _0x1b5697=_0x1109ed;console[_0x1b5697(0x24f)](_0x1b5697(0x274),_0x2cbd92);});}async[a59_0x449140(0x207)](_0x9d057f,_0x59cfe1,_0x4bab1e,_0x28fcf9){const _0x4793d3=a59_0x449140;try{console[_0x4793d3(0x21b)]('🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20'+_0x59cfe1+_0x4793d3(0x204)+_0x4bab1e+_0x4793d3(0x25f)+_0x28fcf9[_0x4793d3(0x1b8)](0x0,0xa)+_0x4793d3(0x278));if(!_0x4bab1e||_0x4bab1e[_0x4793d3(0x271)]<0x3||_0x4bab1e['length']>0x32||!/^[a-zA-Z0-9_]+$/[_0x4793d3(0x29b)](_0x4bab1e)){await this[_0x4793d3(0x1b6)]?.[_0x4793d3(0x243)](_0x9d057f,'❌\x20Invalid\x20username\x20format:\x20`'+_0x4bab1e+_0x4793d3(0x1e9)+_0x4793d3(0x1c2),{'parse_mode':'Markdown'});return;}if(!_0x28fcf9||!_0x28fcf9[_0x4793d3(0x1c3)]('pk_')&&!_0x28fcf9[_0x4793d3(0x1c3)](_0x4793d3(0x23d))){await this[_0x4793d3(0x1b6)]?.[_0x4793d3(0x243)](_0x9d057f,_0x4793d3(0x26e)+_0x4793d3(0x212),{'parse_mode':_0x4793d3(0x277)});return;}const _0x5345fd=await database_1[_0x4793d3(0x1e2)][_0x4793d3(0x27a)]['findUnique']({'where':{'username':_0x4bab1e},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x5345fd){const _0x27140e=await database_1[_0x4793d3(0x1e2)][_0x4793d3(0x27a)][_0x4793d3(0x276)]({'select':{'username':!![],'name':!![]},'take':0x5});let _0x16dcef=_0x4793d3(0x1f0)+_0x4bab1e+_0x4793d3(0x1ec);_0x27140e['length']>0x0?(_0x16dcef+=_0x4793d3(0x1ee),_0x27140e[_0x4793d3(0x1de)](_0x4a8637=>{const _0x561a18=_0x4793d3;_0x16dcef+=_0x561a18(0x25a)+_0x4a8637[_0x561a18(0x1f6)]+'`\x20('+_0x4a8637[_0x561a18(0x262)]+')\x0a';}),_0x16dcef+=_0x4793d3(0x1e3)):_0x16dcef+=_0x4793d3(0x217);await this[_0x4793d3(0x1b6)]?.[_0x4793d3(0x243)](_0x9d057f,_0x16dcef,{'parse_mode':_0x4793d3(0x277)});return;}if(_0x5345fd[_0x4793d3(0x27c)]!==_0x4793d3(0x221)){await this['bot']?.['sendMessage'](_0x9d057f,'❌\x20Shop\x20`'+_0x4bab1e+_0x4793d3(0x1ba)+_0x4793d3(0x206),{'parse_mode':_0x4793d3(0x277)});return;}if(_0x5345fd[_0x4793d3(0x22d)]!==_0x28fcf9&&_0x5345fd[_0x4793d3(0x1b7)]!==_0x28fcf9){await this['bot']?.['sendMessage'](_0x9d057f,_0x4793d3(0x1b9)+_0x4bab1e+_0x4793d3(0x1c6)+_0x4793d3(0x1fc)+_0x4793d3(0x1c0),{'parse_mode':_0x4793d3(0x277)});return;}const _0x1726fd=await database_1[_0x4793d3(0x1e2)][_0x4793d3(0x216)][_0x4793d3(0x298)]({'where':{'shopId':_0x5345fd['id'],'isVerified':!![],'telegramId':{'not':_0x59cfe1}}});if(_0x1726fd){await this['bot']?.[_0x4793d3(0x243)](_0x9d057f,_0x4793d3(0x22c)+_0x4bab1e+_0x4793d3(0x1c6)+_0x4793d3(0x249),{'parse_mode':_0x4793d3(0x277)});return;}await database_1[_0x4793d3(0x1e2)][_0x4793d3(0x216)]['update']({'where':{'telegramId':_0x59cfe1},'data':{'shopId':_0x5345fd['id'],'isVerified':!![]}}),await this[_0x4793d3(0x1b6)]?.['sendMessage'](_0x9d057f,'🎉\x20*Congratulations!*\x0a\x0a'+_0x4793d3(0x28e)+('📱\x20Shop:\x20*'+_0x5345fd[_0x4793d3(0x262)]+'*\x0a')+('👤\x20Username:\x20`'+_0x5345fd[_0x4793d3(0x1f6)]+'`\x0a\x0a')+_0x4793d3(0x1b5)+'•\x20New\x20payments\x0a'+'•\x20Payment\x20status\x20changes\x0a'+_0x4793d3(0x23e)+_0x4793d3(0x20d)+_0x4793d3(0x26c)+_0x4793d3(0x22f)+'/disconnect\x20-\x20disconnect\x20from\x20notifications',{'parse_mode':_0x4793d3(0x277)}),console[_0x4793d3(0x21b)](_0x4793d3(0x1f4)+_0x59cfe1+_0x4793d3(0x22b)+_0x5345fd['username']+_0x4793d3(0x232));}catch(_0x561bf3){console[_0x4793d3(0x24f)](_0x4793d3(0x23b),_0x561bf3),await this['bot']?.['sendMessage'](_0x9d057f,_0x4793d3(0x28f));}}async[a59_0x449140(0x24e)](_0x47950a,_0x5cc055,_0x29d81f){const _0x66432c=a59_0x449140;if(!this[_0x66432c(0x1b6)]){console[_0x66432c(0x214)](_0x66432c(0x245));return;}try{const _0x10f372=await database_1[_0x66432c(0x1e2)][_0x66432c(0x216)][_0x66432c(0x276)]({'where':{'shopId':_0x47950a,'isVerified':!![]}});if(_0x10f372[_0x66432c(0x271)]===0x0){console[_0x66432c(0x21b)]('No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20'+_0x47950a);return;}const _0x5425d9=_0x10f372['map'](async _0x58e7e7=>{const _0x3d19e7=_0x66432c;try{await this['bot']?.[_0x3d19e7(0x243)](_0x58e7e7[_0x3d19e7(0x256)],_0x5cc055,_0x29d81f),console['log'](_0x3d19e7(0x20b)+_0x58e7e7[_0x3d19e7(0x256)]);}catch(_0x5a9c4d){console[_0x3d19e7(0x24f)](_0x3d19e7(0x22e)+_0x58e7e7[_0x3d19e7(0x256)]+':',_0x5a9c4d),_0x5a9c4d instanceof Error&&(_0x5a9c4d[_0x3d19e7(0x1d8)]['includes']('blocked')||_0x5a9c4d[_0x3d19e7(0x1d8)]['includes'](_0x3d19e7(0x259))||_0x5a9c4d[_0x3d19e7(0x1d8)][_0x3d19e7(0x1e0)](_0x3d19e7(0x1b3)))&&(await database_1['default'][_0x3d19e7(0x216)][_0x3d19e7(0x251)]({'where':{'id':_0x58e7e7['id']},'data':{'isVerified':![]}}),console['log'](_0x3d19e7(0x219)+_0x58e7e7[_0x3d19e7(0x256)]+_0x3d19e7(0x1d9)));}});await Promise[_0x66432c(0x283)](_0x5425d9);}catch(_0x3c6f9f){console[_0x66432c(0x24f)](_0x66432c(0x1ff),_0x3c6f9f);}}async[a59_0x449140(0x238)](_0x83c466,_0x4d5511,_0x1666fc){const _0x159695=a59_0x449140,_0x979088={'created':'🆕','paid':'✅','failed':'❌','expired':'⏰','refund':'🔄','chargeback':'⚠️','processing':'⚙️'},_0x1dc96d={'created':_0x159695(0x20a),'paid':'Payment\x20successfully\x20paid','failed':_0x159695(0x1fb),'expired':_0x159695(0x285),'refund':_0x159695(0x1e5),'chargeback':_0x159695(0x201),'processing':_0x159695(0x1e1)},_0x49841b=_0x979088[_0x1666fc],_0x454a5d=_0x1dc96d[_0x1666fc],_0x3674ea=(0x0,gateway_1[_0x159695(0x1d1)])(_0x4d5511['gateway']);console['log'](_0x159695(0x1c5)+_0x4d5511[_0x159695(0x226)]+_0x159695(0x1d6)+_0x3674ea+'\x22');let _0x57d3af=_0x49841b+'\x20*'+_0x454a5d+_0x159695(0x247)+(_0x159695(0x2a0)+_0x4d5511[_0x159695(0x1ef)]+'\x20'+_0x4d5511[_0x159695(0x1d2)]+'*\x0a')+(_0x159695(0x23f)+(_0x4d5511[_0x159695(0x293)]||_0x4d5511['id'])+'`\x0a')+(_0x159695(0x270)+_0x4d5511['id']+'`\x0a')+(_0x159695(0x231)+_0x3674ea+'`\x0a')+(_0x159695(0x264)+new Date(_0x4d5511[_0x159695(0x213)])[_0x159695(0x220)](_0x159695(0x241))+'\x0a');if(_0x4d5511[_0x159695(0x1fe)]||_0x4d5511[_0x159695(0x1bd)]||_0x4d5511['remitterIban']||_0x4d5511[_0x159695(0x282)]||_0x4d5511[_0x159695(0x279)]){_0x57d3af+=_0x159695(0x286);_0x4d5511['customerName']&&(_0x57d3af+=_0x159695(0x1e7)+_0x4d5511[_0x159695(0x1fe)]+'`\x0a');_0x4d5511[_0x159695(0x1bd)]&&(_0x57d3af+=_0x159695(0x224)+_0x4d5511[_0x159695(0x1bd)]+'`\x0a');_0x4d5511['remitterIban']&&(_0x57d3af+=_0x159695(0x1d7)+_0x4d5511[_0x159695(0x254)]+'`\x0a');_0x4d5511['customerIp']&&(_0x57d3af+='🌐\x20IP:\x20`'+_0x4d5511[_0x159695(0x282)]+'`\x0a');if(_0x4d5511['customerUa']){const _0x2f0883=_0x4d5511[_0x159695(0x279)][_0x159695(0x271)]>0x32?_0x4d5511['customerUa'][_0x159695(0x1b8)](0x0,0x32)+_0x159695(0x281):_0x4d5511[_0x159695(0x279)];_0x57d3af+='💻\x20Browser:\x20`'+_0x2f0883+'`\x0a';}}_0x1666fc==='chargeback'&&_0x4d5511[_0x159695(0x202)]&&(_0x57d3af+=_0x159695(0x1e8)+_0x4d5511[_0x159695(0x202)]+_0x159695(0x265)),_0x1666fc===_0x159695(0x218)&&(_0x57d3af+=_0x159695(0x215)),_0x4d5511[_0x159695(0x236)]&&(_0x57d3af+='📝\x20Notes:\x20'+_0x4d5511['adminNotes']+'\x0a'),await this[_0x159695(0x24e)](_0x83c466,_0x57d3af,{'parse_mode':'Markdown'});}async[a59_0x449140(0x25d)](_0x1a59cc,_0x5005ab,_0x452948){const _0x5b2dab=a59_0x449140,_0x1f99c8={'created':'📤','completed':'✅','rejected':'❌'},_0x5b3936={'created':_0x5b2dab(0x1eb),'completed':_0x5b2dab(0x255),'rejected':_0x5b2dab(0x1e6)},_0x2aeafa=_0x1f99c8[_0x452948],_0x4212e6=_0x5b3936[_0x452948],_0x56bd2a=_0x2aeafa+'\x20*'+_0x4212e6+_0x5b2dab(0x247)+(_0x5b2dab(0x248)+_0x5005ab[_0x5b2dab(0x1ef)]+'\x20USD*\x0a')+('🏦\x20Method:\x20`'+_0x5005ab[_0x5b2dab(0x205)]+'`\x0a')+('🆔\x20Payout\x20ID:\x20`'+_0x5005ab['id']+'`\x0a')+(_0x5b2dab(0x264)+new Date(_0x5005ab[_0x5b2dab(0x213)])[_0x5b2dab(0x220)]('en-US')+'\x0a')+(_0x5005ab[_0x5b2dab(0x1df)]?_0x5b2dab(0x1c1)+_0x5005ab['txid']+'`':'');await this[_0x5b2dab(0x24e)](_0x1a59cc,_0x56bd2a,{'parse_mode':_0x5b2dab(0x277)});}async[a59_0x449140(0x1bc)](_0x2fc297,_0x557bb5){const _0x4c0a31=a59_0x449140;try{const _0xbac488=await database_1[_0x4c0a31(0x1e2)]['shopSettings'][_0x4c0a31(0x258)]({'where':{'shopId':_0x2fc297},'select':{'notificationLogin':!![]}});if(!_0xbac488?.[_0x4c0a31(0x295)]){console['log'](_0x4c0a31(0x1e4)+_0x2fc297);return;}const _0x28a131=_0x557bb5[_0x4c0a31(0x252)]?'🔐':'🚨',_0x2c7364=_0x557bb5[_0x4c0a31(0x252)]?_0x4c0a31(0x1cc):_0x4c0a31(0x1f7);let _0x139f37=_0x28a131+'\x20*'+_0x2c7364+_0x4c0a31(0x247)+(_0x4c0a31(0x291)+_0x557bb5[_0x4c0a31(0x1f6)]+'`\x0a')+(_0x4c0a31(0x26f)+_0x557bb5[_0x4c0a31(0x1db)]['toLocaleString'](_0x4c0a31(0x241))+'\x0a');_0x557bb5[_0x4c0a31(0x272)]&&(_0x139f37+=_0x4c0a31(0x253)+_0x557bb5[_0x4c0a31(0x272)]+'`\x0a');if(_0x557bb5[_0x4c0a31(0x284)]){const _0x72d2d=_0x557bb5[_0x4c0a31(0x284)]['length']>0x32?_0x557bb5['userAgent']['substring'](0x0,0x32)+_0x4c0a31(0x281):_0x557bb5[_0x4c0a31(0x284)];_0x139f37+=_0x4c0a31(0x23c)+_0x72d2d+'`\x0a';}!_0x557bb5[_0x4c0a31(0x252)]&&(_0x139f37+='\x0a⚠️\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!'),await this['sendShopNotification'](_0x2fc297,_0x139f37,{'parse_mode':_0x4c0a31(0x277)}),console[_0x4c0a31(0x21b)](_0x4c0a31(0x1c4)+_0x2fc297+':\x20'+(_0x557bb5[_0x4c0a31(0x252)]?'success':_0x4c0a31(0x20f)));}catch(_0x3f0411){console[_0x4c0a31(0x24f)](_0x4c0a31(0x1f3),_0x3f0411);}}async[a59_0x449140(0x246)](_0x2c9248,_0x25db51){const _0x35a9a6=a59_0x449140;try{const _0x4372e4=await database_1[_0x35a9a6(0x1e2)][_0x35a9a6(0x1f1)][_0x35a9a6(0x258)]({'where':{'shopId':_0x2c9248},'select':{'notificationApiError':!![]}});if(!_0x4372e4?.[_0x35a9a6(0x240)]){console[_0x35a9a6(0x21b)](_0x35a9a6(0x20e)+_0x2c9248);return;}let _0x228190=_0x35a9a6(0x230)+(_0x35a9a6(0x1cd)+_0x25db51['method']+'\x20'+_0x25db51[_0x35a9a6(0x26a)]+'`\x0a')+('📅\x20Time:\x20'+_0x25db51[_0x35a9a6(0x1db)][_0x35a9a6(0x220)](_0x35a9a6(0x241))+'\x0a');_0x25db51[_0x35a9a6(0x21c)]&&(_0x228190+=_0x35a9a6(0x203)+_0x25db51[_0x35a9a6(0x21c)]+'`\x0a'),_0x228190+=_0x35a9a6(0x200)+_0x25db51['errorMessage']+'`\x0a',_0x25db51[_0x35a9a6(0x210)]&&(_0x228190+=_0x35a9a6(0x289)+_0x25db51[_0x35a9a6(0x210)]+'`\x0a'),_0x228190+=_0x35a9a6(0x1d3),await this[_0x35a9a6(0x24e)](_0x2c9248,_0x228190,{'parse_mode':_0x35a9a6(0x277)}),console[_0x35a9a6(0x21b)](_0x35a9a6(0x299)+_0x2c9248+':\x20'+_0x25db51['endpoint']);}catch(_0x152528){console[_0x35a9a6(0x24f)](_0x35a9a6(0x26b),_0x152528);}}async[a59_0x449140(0x1f2)](_0x5e9a90,_0x16c6d6,_0x542610){const _0x45e22f=a59_0x449140;let _0x25f0be=_0x45e22f(0x297)+_0x16c6d6+_0x45e22f(0x247);for(const [_0x58e546,_0x2da747]of Object['entries'](_0x542610)){_0x2da747!==null&&_0x2da747!==undefined&&(_0x25f0be+=_0x58e546+_0x45e22f(0x22a)+_0x2da747+'`\x0a');}await this[_0x45e22f(0x24e)](_0x5e9a90,_0x25f0be,{'parse_mode':_0x45e22f(0x277)});}[a59_0x449140(0x250)](){const _0x198b3d=a59_0x449140;return{'isActive':!!this['bot'],'username':this[_0x198b3d(0x28c)]};}[a59_0x449140(0x1d4)](){const _0x5dcddb=a59_0x449140;this['bot']&&(this['bot']['stopPolling'](),this[_0x5dcddb(0x1b6)]=null,console[_0x5dcddb(0x21b)]('🛑\x20Telegram\x20bot\x20stopped'));}}exports[a59_0x449140(0x25e)]=TelegramBotService,exports[a59_0x449140(0x1ca)]=new TelegramBotService();