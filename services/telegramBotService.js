'use strict';const a62_0x44dae1=a62_0x4861;(function(_0x14991f,_0x43471b){const _0x3434a8=a62_0x4861,_0x217cc5=_0x14991f();while(!![]){try{const _0x2814c1=-parseInt(_0x3434a8(0x224))/0x1+-parseInt(_0x3434a8(0x289))/0x2+-parseInt(_0x3434a8(0x2a4))/0x3*(-parseInt(_0x3434a8(0x214))/0x4)+-parseInt(_0x3434a8(0x2bf))/0x5*(-parseInt(_0x3434a8(0x295))/0x6)+-parseInt(_0x3434a8(0x1e1))/0x7+-parseInt(_0x3434a8(0x23b))/0x8+parseInt(_0x3434a8(0x246))/0x9;if(_0x2814c1===_0x43471b)break;else _0x217cc5['push'](_0x217cc5['shift']());}catch(_0x32e75b){_0x217cc5['push'](_0x217cc5['shift']());}}}(a62_0x2877,0x44c30));var __importDefault=this&&this[a62_0x44dae1(0x206)]||function(_0x490f2e){const _0x555d54=a62_0x44dae1;return _0x490f2e&&_0x490f2e[_0x555d54(0x2b5)]?_0x490f2e:{'default':_0x490f2e};};function a62_0x4861(_0x5a7cae,_0x14a30c){const _0x2877e6=a62_0x2877();return a62_0x4861=function(_0x48613a,_0x35b953){_0x48613a=_0x48613a-0x1d8;let _0x17b08c=_0x2877e6[_0x48613a];return _0x17b08c;},a62_0x4861(_0x5a7cae,_0x14a30c);}Object[a62_0x44dae1(0x2bc)](exports,a62_0x44dae1(0x2b5),{'value':!![]}),exports[a62_0x44dae1(0x271)]=exports['TelegramBotService']=void 0x0;const node_telegram_bot_api_1=__importDefault(require('node-telegram-bot-api')),database_1=__importDefault(require(a62_0x44dae1(0x264))),gateway_1=require(a62_0x44dae1(0x1e7));class TelegramBotService{constructor(){const _0x2b4394=a62_0x44dae1;this[_0x2b4394(0x2c9)]=null,this[_0x2b4394(0x28c)]=process[_0x2b4394(0x221)][_0x2b4394(0x2c4)]||'',this[_0x2b4394(0x23a)]=process[_0x2b4394(0x221)][_0x2b4394(0x27b)]||_0x2b4394(0x1ee),this[_0x2b4394(0x28c)]?this['initializeBot']():console['warn'](_0x2b4394(0x22b));}[a62_0x44dae1(0x28e)](){const _0x545fe1=a62_0x44dae1;try{this[_0x545fe1(0x2c9)]=new node_telegram_bot_api_1[(_0x545fe1(0x1f6))](this[_0x545fe1(0x28c)],{'polling':!![]}),this[_0x545fe1(0x230)](),console[_0x545fe1(0x1ea)](_0x545fe1(0x234)+this[_0x545fe1(0x23a)]+_0x545fe1(0x241));}catch(_0xc907a7){console[_0x545fe1(0x24b)](_0x545fe1(0x229),_0xc907a7);}}[a62_0x44dae1(0x230)](){const _0x5e3ee8=a62_0x44dae1;if(!this['bot'])return;this['bot'][_0x5e3ee8(0x23f)](/\/start/,async _0x48cb48=>{const _0x3a8ef2=_0x5e3ee8,_0x40395e=_0x48cb48[_0x3a8ef2(0x22c)]['id'],_0x2e42cc=_0x48cb48['from']?.['id'][_0x3a8ef2(0x279)](),_0x2dd8d6=_0x48cb48[_0x3a8ef2(0x22e)]?.[_0x3a8ef2(0x242)],_0x4b56b3=_0x48cb48[_0x3a8ef2(0x22e)]?.[_0x3a8ef2(0x1ec)],_0x1695be=_0x48cb48[_0x3a8ef2(0x22e)]?.[_0x3a8ef2(0x2ba)];if(!_0x2e42cc)return;try{let _0x3264aa=await database_1[_0x3a8ef2(0x1f6)]['telegramUser']['findUnique']({'where':{'telegramId':_0x2e42cc},'include':{'shop':!![]}});!_0x3264aa?(_0x3264aa=await database_1['default'][_0x3a8ef2(0x1de)]['create']({'data':{'telegramId':_0x2e42cc,'username':_0x2dd8d6,'firstName':_0x4b56b3,'lastName':_0x1695be,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console[_0x3a8ef2(0x1ea)](_0x3a8ef2(0x283)+_0x2e42cc+_0x3a8ef2(0x231)+_0x2dd8d6+')')):_0x3264aa=await database_1[_0x3a8ef2(0x1f6)][_0x3a8ef2(0x1de)][_0x3a8ef2(0x1df)]({'where':{'telegramId':_0x2e42cc},'data':{'username':_0x2dd8d6,'firstName':_0x4b56b3,'lastName':_0x1695be},'include':{'shop':!![]}}),_0x3264aa['isVerified']&&_0x3264aa[_0x3a8ef2(0x1ed)]&&_0x3264aa[_0x3a8ef2(0x232)]?await this['bot']?.[_0x3a8ef2(0x237)](_0x40395e,_0x3a8ef2(0x250)+(_0x3a8ef2(0x286)+_0x3264aa[_0x3a8ef2(0x232)][_0x3a8ef2(0x2cd)]+'*\x0a')+(_0x3a8ef2(0x25c)+_0x3264aa[_0x3a8ef2(0x232)]['username']+_0x3a8ef2(0x2a0))+_0x3a8ef2(0x2cb)+_0x3a8ef2(0x1e8)+'•\x20Payment\x20status\x20changes\x0a'+_0x3a8ef2(0x265)+_0x3a8ef2(0x2b2)+_0x3a8ef2(0x233)+_0x3a8ef2(0x2a9),{'parse_mode':'Markdown'}):(_0x3264aa[_0x3a8ef2(0x1ed)]&&!_0x3264aa[_0x3a8ef2(0x216)]&&(await database_1[_0x3a8ef2(0x1f6)][_0x3a8ef2(0x1de)][_0x3a8ef2(0x1df)]({'where':{'telegramId':_0x2e42cc},'data':{'shopId':null,'isVerified':![]}}),console[_0x3a8ef2(0x1ea)](_0x3a8ef2(0x2be)+_0x2e42cc)),await this[_0x3a8ef2(0x2c9)]?.[_0x3a8ef2(0x237)](_0x40395e,_0x3a8ef2(0x2b7)+_0x3a8ef2(0x2cc)+_0x3a8ef2(0x29d)+_0x3a8ef2(0x27e)+_0x3a8ef2(0x245)+'❗️\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!',{'parse_mode':_0x3a8ef2(0x1db)}));}catch(_0x42f00d){console[_0x3a8ef2(0x24b)]('Error\x20handling\x20/start\x20command:',_0x42f00d),await this[_0x3a8ef2(0x2c9)]?.[_0x3a8ef2(0x237)](_0x40395e,_0x3a8ef2(0x1f2));}}),this[_0x5e3ee8(0x2c9)][_0x5e3ee8(0x23f)](/\/disconnect/,async _0x18e3f2=>{const _0x2e24ca=_0x5e3ee8,_0xdb3f4c=_0x18e3f2[_0x2e24ca(0x22c)]['id'],_0x4e65c4=_0x18e3f2[_0x2e24ca(0x22e)]?.['id']['toString']();if(!_0x4e65c4)return;try{const _0x418fc5=await database_1[_0x2e24ca(0x1f6)]['telegramUser']['findUnique']({'where':{'telegramId':_0x4e65c4},'include':{'shop':!![]}});if(!_0x418fc5||!_0x418fc5[_0x2e24ca(0x216)]||!_0x418fc5[_0x2e24ca(0x1ed)]){await this['bot']?.[_0x2e24ca(0x237)](_0xdb3f4c,_0x2e24ca(0x2ae));return;}const _0x993a9c=_0x418fc5['shop']?.[_0x2e24ca(0x2cd)]||'unknown\x20shop';await database_1[_0x2e24ca(0x1f6)][_0x2e24ca(0x1de)][_0x2e24ca(0x1df)]({'where':{'telegramId':_0x4e65c4},'data':{'shopId':null,'isVerified':![]}}),console[_0x2e24ca(0x1ea)](_0x2e24ca(0x25a)+_0x4e65c4+_0x2e24ca(0x1eb)+_0x418fc5['shopId']),await this['bot']?.[_0x2e24ca(0x237)](_0xdb3f4c,'✅\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*'+_0x993a9c+_0x2e24ca(0x278)+_0x2e24ca(0x20e),{'parse_mode':_0x2e24ca(0x1db)});}catch(_0x2b7650){console[_0x2e24ca(0x24b)](_0x2e24ca(0x297),_0x2b7650),await this[_0x2e24ca(0x2c9)]?.[_0x2e24ca(0x237)](_0xdb3f4c,_0x2e24ca(0x1f2));}}),this['bot'][_0x5e3ee8(0x23f)](/\/status/,async _0x3834fa=>{const _0x8ae3aa=_0x5e3ee8,_0x47d1be=_0x3834fa['chat']['id'],_0x690deb=_0x3834fa[_0x8ae3aa(0x22e)]?.['id'][_0x8ae3aa(0x279)]();if(!_0x690deb)return;try{const _0x2889d2=await database_1['default'][_0x8ae3aa(0x1de)][_0x8ae3aa(0x23d)]({'where':{'telegramId':_0x690deb},'include':{'shop':!![]}});if(!_0x2889d2){await this['bot']?.[_0x8ae3aa(0x237)](_0x47d1be,'❌\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a'+_0x8ae3aa(0x28f));return;}if(!_0x2889d2[_0x8ae3aa(0x216)]||!_0x2889d2[_0x8ae3aa(0x1ed)]||!_0x2889d2[_0x8ae3aa(0x232)]){await this[_0x8ae3aa(0x2c9)]?.[_0x8ae3aa(0x237)](_0x47d1be,_0x8ae3aa(0x21f)+_0x8ae3aa(0x29a));return;}await this[_0x8ae3aa(0x2c9)]?.['sendMessage'](_0x47d1be,'📊\x20*Connection\x20Status*\x0a\x0a'+(_0x8ae3aa(0x207)+_0x2889d2[_0x8ae3aa(0x232)][_0x8ae3aa(0x2cd)]+'*\x0a')+('👤\x20Username:\x20`'+_0x2889d2['shop'][_0x8ae3aa(0x242)]+'`\x0a')+(_0x8ae3aa(0x202)+_0x2889d2[_0x8ae3aa(0x238)]['toLocaleDateString']('en-US')+'\x0a\x0a')+_0x8ae3aa(0x254)+_0x8ae3aa(0x2b2)+'/disconnect\x20-\x20disconnect\x20from\x20notifications',{'parse_mode':_0x8ae3aa(0x1db)});}catch(_0x2c14d7){console[_0x8ae3aa(0x24b)]('Error\x20handling\x20/status\x20command:',_0x2c14d7),await this[_0x8ae3aa(0x2c9)]?.[_0x8ae3aa(0x237)](_0x47d1be,_0x8ae3aa(0x1f2));}}),this[_0x5e3ee8(0x2c9)][_0x5e3ee8(0x23f)](/\/debug/,async _0xb97c54=>{const _0x490415=_0x5e3ee8,_0xf5898b=_0xb97c54[_0x490415(0x22c)]['id'],_0x2240ed=_0xb97c54[_0x490415(0x22e)]?.['id'][_0x490415(0x279)]();if(!_0x2240ed)return;try{const _0x1bd732=await database_1[_0x490415(0x1f6)][_0x490415(0x232)][_0x490415(0x21b)]({'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![]},'take':0xa});let _0x4e9618=_0x490415(0x1f9);_0x4e9618+=_0x490415(0x2c8)+_0x2240ed+_0x490415(0x2a0),_0x4e9618+=_0x490415(0x2aa),_0x1bd732['forEach']((_0x6dc3d9,_0x2ebb34)=>{const _0x3a18a7=_0x490415;_0x4e9618+=_0x2ebb34+0x1+'.\x20*'+_0x6dc3d9[_0x3a18a7(0x2cd)]+'*\x0a',_0x4e9618+='\x20\x20\x20Username:\x20`'+_0x6dc3d9['username']+'`\x0a',_0x4e9618+=_0x3a18a7(0x2ad)+_0x6dc3d9[_0x3a18a7(0x274)]+'\x0a',_0x4e9618+=_0x3a18a7(0x267)+_0x6dc3d9['publicKey']['substring'](0x0,0xf)+_0x3a18a7(0x1f8);}),await this[_0x490415(0x2c9)]?.[_0x490415(0x237)](_0xf5898b,_0x4e9618,{'parse_mode':_0x490415(0x1db)});}catch(_0x49573d){console[_0x490415(0x24b)](_0x490415(0x29e),_0x49573d),await this[_0x490415(0x2c9)]?.['sendMessage'](_0xf5898b,_0x490415(0x1fa));}}),this[_0x5e3ee8(0x2c9)]['on'](_0x5e3ee8(0x1f1),async _0x2e9939=>{const _0x1e4f29=_0x5e3ee8;if(_0x2e9939[_0x1e4f29(0x293)]?.[_0x1e4f29(0x244)]('/'))return;const _0x4c3e78=_0x2e9939['chat']['id'],_0x29c13e=_0x2e9939['from']?.['id'][_0x1e4f29(0x279)](),_0xc5b295=_0x2e9939['text']?.[_0x1e4f29(0x22d)]();if(!_0x29c13e||!_0xc5b295)return;try{const _0x5865d0=await database_1['default'][_0x1e4f29(0x1de)][_0x1e4f29(0x23d)]({'where':{'telegramId':_0x29c13e},'include':{'shop':!![]}});if(!_0x5865d0){await this[_0x1e4f29(0x2c9)]?.['sendMessage'](_0x4c3e78,'❌\x20Please\x20use\x20/start\x20command\x20first');return;}if(_0x5865d0[_0x1e4f29(0x216)]&&_0x5865d0[_0x1e4f29(0x1ed)]&&_0x5865d0[_0x1e4f29(0x232)]){await this[_0x1e4f29(0x2c9)]?.[_0x1e4f29(0x237)](_0x4c3e78,_0x1e4f29(0x1e4)+_0x5865d0[_0x1e4f29(0x232)][_0x1e4f29(0x2cd)]+_0x1e4f29(0x278)+'Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.',{'parse_mode':_0x1e4f29(0x1db)});return;}const _0xd74b66=_0xc5b295[_0x1e4f29(0x208)](/\s+/);if(_0xd74b66[_0x1e4f29(0x23e)]!==0x2){await this['bot']?.[_0x1e4f29(0x237)](_0x4c3e78,_0x1e4f29(0x227)+_0x1e4f29(0x29d)+_0x1e4f29(0x27e)+_0x1e4f29(0x245)+(_0x1e4f29(0x215)+_0xd74b66[_0x1e4f29(0x23e)]+'\x20parts:\x20'+_0xd74b66[_0x1e4f29(0x29b)](_0x4ee47d=>'`'+_0x4ee47d+'`')[_0x1e4f29(0x26d)](',\x20')),{'parse_mode':'Markdown'});return;}const [_0x40273b,_0x38aa50]=_0xd74b66;console['log'](_0x1e4f29(0x212)+_0x29c13e+_0x1e4f29(0x240)+_0x40273b+_0x1e4f29(0x261)+_0x38aa50[_0x1e4f29(0x262)](0x0,0xa)+'...\x22'),await this[_0x1e4f29(0x28d)](_0x4c3e78,_0x29c13e,_0x40273b,_0x38aa50);}catch(_0x2d1b44){console['error'](_0x1e4f29(0x22a),_0x2d1b44),await this['bot']?.[_0x1e4f29(0x237)](_0x4c3e78,'❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this['bot']['on']('error',_0xdd2cf1=>{console['error']('Telegram\x20bot\x20error:',_0xdd2cf1);}),this['bot']['on'](_0x5e3ee8(0x1fe),_0x2c3219=>{const _0x4dbe61=_0x5e3ee8;console[_0x4dbe61(0x24b)]('Telegram\x20bot\x20polling\x20error:',_0x2c3219);});}async[a62_0x44dae1(0x28d)](_0x53eb43,_0x3b9e6c,_0x3835c0,_0xce4261){const _0x545653=a62_0x44dae1;try{console[_0x545653(0x1ea)](_0x545653(0x212)+_0x3b9e6c+':\x20username=\x22'+_0x3835c0+'\x22,\x20apiKey=\x22'+_0xce4261[_0x545653(0x262)](0x0,0xa)+_0x545653(0x225));if(!_0x3835c0||_0x3835c0['length']<0x3||_0x3835c0[_0x545653(0x23e)]>0x32||!/^[a-zA-Z0-9_]+$/[_0x545653(0x251)](_0x3835c0)){await this['bot']?.[_0x545653(0x237)](_0x53eb43,'❌\x20Invalid\x20username\x20format:\x20`'+_0x3835c0+_0x545653(0x2a0)+_0x545653(0x2b9),{'parse_mode':_0x545653(0x1db)});return;}if(!_0xce4261||!_0xce4261[_0x545653(0x244)](_0x545653(0x204))&&!_0xce4261[_0x545653(0x244)]('sk_')){await this[_0x545653(0x2c9)]?.[_0x545653(0x237)](_0x53eb43,_0x545653(0x1f5)+_0x545653(0x26e),{'parse_mode':_0x545653(0x1db)});return;}const _0x4f3834=await database_1[_0x545653(0x1f6)]['shop'][_0x545653(0x23d)]({'where':{'username':_0x3835c0},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x4f3834){const _0x287d08=await database_1['default']['shop'][_0x545653(0x21b)]({'select':{'username':!![],'name':!![]},'take':0x5});let _0x2e3656=_0x545653(0x284)+_0x3835c0+_0x545653(0x1f7);_0x287d08['length']>0x0?(_0x2e3656+='Available\x20usernames:\x0a',_0x287d08['forEach'](_0x5e18db=>{const _0x44d5b1=_0x545653;_0x2e3656+='•\x20`'+_0x5e18db['username']+_0x44d5b1(0x281)+_0x5e18db[_0x44d5b1(0x2cd)]+')\x0a';}),_0x2e3656+=_0x545653(0x1fb)):_0x2e3656+=_0x545653(0x273);await this[_0x545653(0x2c9)]?.[_0x545653(0x237)](_0x53eb43,_0x2e3656,{'parse_mode':_0x545653(0x1db)});return;}if(_0x4f3834[_0x545653(0x274)]!==_0x545653(0x290)){await this[_0x545653(0x2c9)]?.['sendMessage'](_0x53eb43,_0x545653(0x26b)+_0x3835c0+_0x545653(0x270)+_0x545653(0x288),{'parse_mode':'Markdown'});return;}if(_0x4f3834[_0x545653(0x21c)]!==_0xce4261&&_0x4f3834['secretKey']!==_0xce4261){await this[_0x545653(0x2c9)]?.[_0x545653(0x237)](_0x53eb43,'❌\x20API\x20key\x20does\x20not\x20match\x20shop\x20`'+_0x3835c0+_0x545653(0x29f)+_0x545653(0x247)+_0x545653(0x1e2),{'parse_mode':_0x545653(0x1db)});return;}const _0x7a2c37=await database_1['default'][_0x545653(0x1de)][_0x545653(0x1d8)]({'where':{'shopId':_0x4f3834['id'],'isVerified':!![],'telegramId':{'not':_0x3b9e6c}}});if(_0x7a2c37){await this[_0x545653(0x2c9)]?.['sendMessage'](_0x53eb43,_0x545653(0x24c)+_0x3835c0+_0x545653(0x29f)+_0x545653(0x1dd),{'parse_mode':_0x545653(0x1db)});return;}await database_1[_0x545653(0x1f6)][_0x545653(0x1de)][_0x545653(0x1df)]({'where':{'telegramId':_0x3b9e6c},'data':{'shopId':_0x4f3834['id'],'isVerified':!![]}}),await this[_0x545653(0x2c9)]?.[_0x545653(0x237)](_0x53eb43,_0x545653(0x2b0)+_0x545653(0x200)+('📱\x20Shop:\x20*'+_0x4f3834[_0x545653(0x2cd)]+'*\x0a')+(_0x545653(0x21a)+_0x4f3834[_0x545653(0x242)]+_0x545653(0x2a0))+_0x545653(0x22f)+_0x545653(0x1e8)+'•\x20Payment\x20status\x20changes\x0a'+_0x545653(0x256)+_0x545653(0x1f0)+_0x545653(0x2b2)+_0x545653(0x233)+_0x545653(0x2a9),{'parse_mode':_0x545653(0x1db)}),console[_0x545653(0x1ea)](_0x545653(0x28b)+_0x3b9e6c+'\x20verified\x20for\x20shop\x20'+_0x4f3834[_0x545653(0x242)]+_0x545653(0x25f));}catch(_0x1b8311){console[_0x545653(0x24b)]('Error\x20in\x20handleSingleLineVerification:',_0x1b8311),await this[_0x545653(0x2c9)]?.[_0x545653(0x237)](_0x53eb43,_0x545653(0x239));}}async[a62_0x44dae1(0x280)](_0x5a351e,_0xa00ce,_0xc9071d){const _0x3767a7=a62_0x44dae1;if(!this[_0x3767a7(0x2c9)]){console['warn']('Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification');return;}try{const _0x416d89=await database_1[_0x3767a7(0x1f6)][_0x3767a7(0x1de)][_0x3767a7(0x21b)]({'where':{'shopId':_0x5a351e,'isVerified':!![]}});if(_0x416d89[_0x3767a7(0x23e)]===0x0){console[_0x3767a7(0x1ea)](_0x3767a7(0x2a3)+_0x5a351e);return;}const _0xd34106=_0x416d89[_0x3767a7(0x29b)](async _0x428779=>{const _0x3058f5=_0x3767a7;try{await this[_0x3058f5(0x2c9)]?.[_0x3058f5(0x237)](_0x428779[_0x3058f5(0x1f3)],_0xa00ce,_0xc9071d),console[_0x3058f5(0x1ea)](_0x3058f5(0x228)+_0x428779[_0x3058f5(0x1f3)]);}catch(_0x3fc560){console[_0x3058f5(0x24b)](_0x3058f5(0x20a)+_0x428779[_0x3058f5(0x1f3)]+':',_0x3fc560),_0x3fc560 instanceof Error&&(_0x3fc560[_0x3058f5(0x1f1)][_0x3058f5(0x2c1)]('blocked')||_0x3fc560[_0x3058f5(0x1f1)][_0x3058f5(0x2c1)](_0x3058f5(0x1fd))||_0x3fc560[_0x3058f5(0x1f1)][_0x3058f5(0x2c1)](_0x3058f5(0x24f)))&&(await database_1[_0x3058f5(0x1f6)][_0x3058f5(0x1de)][_0x3058f5(0x1df)]({'where':{'id':_0x428779['id']},'data':{'isVerified':![]}}),console[_0x3058f5(0x1ea)](_0x3058f5(0x253)+_0x428779[_0x3058f5(0x1f3)]+'\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure'));}});await Promise[_0x3767a7(0x27c)](_0xd34106);}catch(_0x3f0980){console[_0x3767a7(0x24b)]('Error\x20sending\x20shop\x20notification:',_0x3f0980);}}async[a62_0x44dae1(0x2b4)](_0x218796,_0x57fe48,_0x55a7c2){const _0x4bc6c1=a62_0x44dae1,_0x26848c={'created':'🆕','paid':'✅','failed':'❌','expired':'⏰','refund':'🔄','chargeback':'⚠️','processing':'⚙️'},_0x31c997={'created':_0x4bc6c1(0x243),'paid':_0x4bc6c1(0x275),'failed':_0x4bc6c1(0x220),'expired':_0x4bc6c1(0x2cf),'refund':'Payment\x20refund','chargeback':_0x4bc6c1(0x2b8),'processing':_0x4bc6c1(0x20b)},_0x438612=_0x26848c[_0x55a7c2],_0x4dbb65=_0x31c997[_0x55a7c2],_0x4b75bd=(0x0,gateway_1['getGatewayDisplayNameForTelegram'])(_0x57fe48['gateway']);console[_0x4bc6c1(0x1ea)](_0x4bc6c1(0x259)+_0x57fe48[_0x4bc6c1(0x219)]+_0x4bc6c1(0x2bb)+_0x4b75bd+'\x22');let _0x194f91=_0x438612+'\x20*'+_0x4dbb65+'*\x0a\x0a'+(_0x4bc6c1(0x1e5)+_0x57fe48[_0x4bc6c1(0x25d)]+'\x20'+_0x57fe48[_0x4bc6c1(0x282)]+'*\x0a')+(_0x4bc6c1(0x223)+(_0x57fe48[_0x4bc6c1(0x2ab)]||_0x57fe48['id'])+'`\x0a')+(_0x4bc6c1(0x2bd)+_0x57fe48['id']+'`\x0a')+(_0x4bc6c1(0x236)+_0x4b75bd+'`\x0a')+(_0x4bc6c1(0x2a1)+new Date(_0x57fe48[_0x4bc6c1(0x2af)])[_0x4bc6c1(0x2d0)](_0x4bc6c1(0x222))+'\x0a');if(_0x57fe48[_0x4bc6c1(0x24d)]||_0x57fe48[_0x4bc6c1(0x1e9)]||_0x57fe48['remitterIban']||_0x57fe48[_0x4bc6c1(0x218)]||_0x57fe48[_0x4bc6c1(0x2b6)]){_0x194f91+='\x0a👤\x20*Customer\x20Information:*\x0a';_0x57fe48[_0x4bc6c1(0x24d)]&&(_0x194f91+='📛\x20Name:\x20`'+_0x57fe48[_0x4bc6c1(0x24d)]+'`\x0a');_0x57fe48[_0x4bc6c1(0x1e9)]&&(_0x194f91+='📧\x20Email:\x20`'+_0x57fe48[_0x4bc6c1(0x1e9)]+'`\x0a');_0x57fe48[_0x4bc6c1(0x2d1)]&&(_0x194f91+='🏦\x20IBAN:\x20`'+_0x57fe48[_0x4bc6c1(0x2d1)]+'`\x0a');_0x57fe48['customerIp']&&(_0x194f91+=_0x4bc6c1(0x217)+_0x57fe48[_0x4bc6c1(0x218)]+'`\x0a');if(_0x57fe48[_0x4bc6c1(0x2b6)]){const _0x1d6abe=_0x57fe48['customerUa'][_0x4bc6c1(0x23e)]>0x32?_0x57fe48['customerUa'][_0x4bc6c1(0x262)](0x0,0x32)+_0x4bc6c1(0x1dc):_0x57fe48[_0x4bc6c1(0x2b6)];_0x194f91+='💻\x20Browser:\x20`'+_0x1d6abe+'`\x0a';}}_0x55a7c2==='chargeback'&&_0x57fe48[_0x4bc6c1(0x299)]&&(_0x194f91+=_0x4bc6c1(0x25e)+_0x57fe48['chargebackAmount']+_0x4bc6c1(0x205)),_0x55a7c2===_0x4bc6c1(0x26f)&&(_0x194f91+=_0x4bc6c1(0x1ef)),_0x57fe48[_0x4bc6c1(0x2c2)]&&(_0x194f91+=_0x4bc6c1(0x249)+_0x57fe48[_0x4bc6c1(0x2c2)]+'\x0a'),await this[_0x4bc6c1(0x280)](_0x218796,_0x194f91,{'parse_mode':_0x4bc6c1(0x1db)});}async['sendPayoutNotification'](_0x836fea,_0x57696,_0x442498){const _0x1576a2=a62_0x44dae1,_0x1b0c43={'created':'📤','completed':'✅','rejected':'❌'},_0x3ae31c={'created':_0x1576a2(0x2d2),'completed':'Payout\x20completed','rejected':_0x1576a2(0x27f)},_0x1af9e2=_0x1b0c43[_0x442498],_0x50c5b4=_0x3ae31c[_0x442498],_0x14e4ec=_0x1af9e2+'\x20*'+_0x50c5b4+_0x1576a2(0x266)+(_0x1576a2(0x296)+_0x57696[_0x1576a2(0x25d)]+_0x1576a2(0x26a))+(_0x1576a2(0x292)+_0x57696[_0x1576a2(0x23c)]+'`\x0a')+(_0x1576a2(0x21d)+_0x57696['id']+'`\x0a')+('📅\x20Date:\x20'+new Date(_0x57696['createdAt'])['toLocaleString'](_0x1576a2(0x222))+'\x0a')+(_0x57696[_0x1576a2(0x2c5)]?_0x1576a2(0x257)+_0x57696[_0x1576a2(0x2c5)]+'`':'');await this['sendShopNotification'](_0x836fea,_0x14e4ec,{'parse_mode':'Markdown'});}async[a62_0x44dae1(0x213)](_0x2de85c,_0x276a56){const _0x5bdba8=a62_0x44dae1;try{const _0x521ce5=await database_1['default']['shopSettings'][_0x5bdba8(0x23d)]({'where':{'shopId':_0x2de85c},'select':{'notificationLogin':!![]}});if(!_0x521ce5?.[_0x5bdba8(0x2ce)]){console['log'](_0x5bdba8(0x21e)+_0x2de85c);return;}const _0x88ca3f=_0x276a56['success']?'🔐':'🚨',_0x5735e6=_0x276a56[_0x5bdba8(0x252)]?'Successful\x20login':_0x5bdba8(0x294);let _0x9049d7=_0x88ca3f+'\x20*'+_0x5735e6+_0x5bdba8(0x266)+(_0x5bdba8(0x21a)+_0x276a56['username']+'`\x0a')+(_0x5bdba8(0x1ff)+_0x276a56[_0x5bdba8(0x211)][_0x5bdba8(0x2d0)]('en-US')+'\x0a');_0x276a56['ipAddress']&&(_0x9049d7+=_0x5bdba8(0x1da)+_0x276a56[_0x5bdba8(0x201)]+'`\x0a');if(_0x276a56[_0x5bdba8(0x2a7)]){const _0x3599b7=_0x276a56['userAgent'][_0x5bdba8(0x23e)]>0x32?_0x276a56[_0x5bdba8(0x2a7)][_0x5bdba8(0x262)](0x0,0x32)+_0x5bdba8(0x1dc):_0x276a56[_0x5bdba8(0x2a7)];_0x9049d7+='💻\x20Browser:\x20`'+_0x3599b7+'`\x0a';}!_0x276a56[_0x5bdba8(0x252)]&&(_0x9049d7+=_0x5bdba8(0x298)),await this[_0x5bdba8(0x280)](_0x2de85c,_0x9049d7,{'parse_mode':'Markdown'}),console[_0x5bdba8(0x1ea)](_0x5bdba8(0x2c7)+_0x2de85c+':\x20'+(_0x276a56[_0x5bdba8(0x252)]?_0x5bdba8(0x252):_0x5bdba8(0x268)));}catch(_0x35f52d){console[_0x5bdba8(0x24b)](_0x5bdba8(0x2a6),_0x35f52d);}}async['sendApiErrorNotification'](_0x282683,_0x51b2ef){const _0x5979d4=a62_0x44dae1;try{const _0x49e101=await database_1['default']['shopSettings'][_0x5979d4(0x23d)]({'where':{'shopId':_0x282683},'select':{'notificationApiError':!![]}});if(!_0x49e101?.[_0x5979d4(0x260)]){console['log']('📱\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20'+_0x282683);return;}let _0x18815f='🚨\x20*API\x20Error*\x0a\x0a'+(_0x5979d4(0x1e6)+_0x51b2ef[_0x5979d4(0x23c)]+'\x20'+_0x51b2ef[_0x5979d4(0x1f4)]+'`\x0a')+(_0x5979d4(0x1ff)+_0x51b2ef[_0x5979d4(0x211)][_0x5979d4(0x2d0)](_0x5979d4(0x222))+'\x0a');_0x51b2ef[_0x5979d4(0x2b1)]&&(_0x18815f+=_0x5979d4(0x2ca)+_0x51b2ef[_0x5979d4(0x2b1)]+'`\x0a'),_0x18815f+=_0x5979d4(0x210)+_0x51b2ef['errorMessage']+'`\x0a',_0x51b2ef[_0x5979d4(0x2ac)]&&(_0x18815f+=_0x5979d4(0x24e)+_0x51b2ef[_0x5979d4(0x2ac)]+'`\x0a'),_0x18815f+=_0x5979d4(0x226),await this['sendShopNotification'](_0x282683,_0x18815f,{'parse_mode':_0x5979d4(0x1db)}),console['log'](_0x5979d4(0x209)+_0x282683+':\x20'+_0x51b2ef[_0x5979d4(0x1f4)]);}catch(_0x31954a){console[_0x5979d4(0x24b)](_0x5979d4(0x1d9),_0x31954a);}}async['sendCustomNotification'](_0x3efbcf,_0x53ebcb,_0x5302ab){const _0x5c3bc3=a62_0x44dae1;let _0xd6b879=_0x5c3bc3(0x203)+_0x53ebcb+'*\x0a\x0a';for(const [_0x3e4eb5,_0x1c693a]of Object['entries'](_0x5302ab)){_0x1c693a!==null&&_0x1c693a!==undefined&&(_0xd6b879+=_0x3e4eb5+_0x5c3bc3(0x27d)+_0x1c693a+'`\x0a');}await this[_0x5c3bc3(0x280)](_0x3efbcf,_0xd6b879,{'parse_mode':_0x5c3bc3(0x1db)});}async[a62_0x44dae1(0x276)](_0x5cb1c2){const _0x53631d=a62_0x44dae1;try{console['log'](_0x53631d(0x28a)+_0x5cb1c2['substring'](0x0,0x32)+_0x53631d(0x1dc));const _0xebd5a5=await database_1[_0x53631d(0x1f6)][_0x53631d(0x1de)][_0x53631d(0x21b)]({'select':{'telegramId':!![]}});if(_0xebd5a5[_0x53631d(0x23e)]===0x0){console[_0x53631d(0x1ea)](_0x53631d(0x248));return;}for(const _0x34dcbc of _0xebd5a5){try{await this[_0x53631d(0x2c9)]?.['sendMessage'](_0x34dcbc[_0x53631d(0x1f3)],_0x5cb1c2,{'parse_mode':_0x53631d(0x1db)});}catch(_0x571f7d){console[_0x53631d(0x24b)](_0x53631d(0x235)+_0x34dcbc['telegramId']+':',_0x571f7d);}}console[_0x53631d(0x1ea)](_0x53631d(0x24a)+_0xebd5a5[_0x53631d(0x23e)]+'\x20users');}catch(_0x43fd19){console['error'](_0x53631d(0x2c0),_0x43fd19);}}[a62_0x44dae1(0x20f)](){const _0x3d8225=a62_0x44dae1;return{'isActive':!!this[_0x3d8225(0x2c9)],'username':this[_0x3d8225(0x23a)]};}async[a62_0x44dae1(0x29c)](_0x2a1ade,_0x47a82b,_0x260ff6,_0x31cc26){const _0x85a35a=a62_0x44dae1;try{if(!this[_0x85a35a(0x2c9)])return console['error'](_0x85a35a(0x20c)),![];const _0x454c06=await database_1[_0x85a35a(0x1f6)]['telegramUser']['findMany']({'where':{'shopId':_0x2a1ade,'isVerified':!![]},'select':{'telegramId':!![]}});if(_0x454c06[_0x85a35a(0x23e)]===0x0)return console['error'](_0x85a35a(0x269)+_0x2a1ade),![];let _0xc51e49=0x0;for(const _0x4338dc of _0x454c06){try{await this[_0x85a35a(0x2c9)][_0x85a35a(0x27a)](_0x4338dc[_0x85a35a(0x1f3)],_0x47a82b,{},{'filename':_0x260ff6,'contentType':_0x260ff6['endsWith'](_0x85a35a(0x287))?_0x85a35a(0x26c):_0x260ff6[_0x85a35a(0x255)](_0x85a35a(0x1e0))||_0x260ff6['endsWith'](_0x85a35a(0x2a2))?_0x85a35a(0x2b3):_0x260ff6['endsWith'](_0x85a35a(0x25b))?_0x85a35a(0x272):_0x85a35a(0x263)}),_0x31cc26&&await this['bot'][_0x85a35a(0x237)](_0x4338dc[_0x85a35a(0x1f3)],_0x31cc26),_0xc51e49++;}catch(_0x2aefbf){console['error'](_0x85a35a(0x1fc)+_0x4338dc['telegramId']+':',_0x2aefbf);}}return console[_0x85a35a(0x1ea)](_0x85a35a(0x1e3)+_0xc51e49+'/'+_0x454c06[_0x85a35a(0x23e)]+_0x85a35a(0x2a5)+_0x2a1ade+':\x20'+_0x260ff6),_0xc51e49>0x0;}catch(_0x14a94d){return console[_0x85a35a(0x24b)](_0x85a35a(0x258),_0x14a94d),![];}}async['sendDirectMessage'](_0x4621b1,_0x488633){const _0xd69fe5=a62_0x44dae1;try{if(!this[_0xd69fe5(0x2c9)])return console[_0xd69fe5(0x24b)](_0xd69fe5(0x20c)),![];return await this[_0xd69fe5(0x2c9)]['sendMessage'](_0x4621b1,_0x488633),console[_0xd69fe5(0x1ea)](_0xd69fe5(0x277)+_0x4621b1),!![];}catch(_0x19e1af){return console[_0xd69fe5(0x24b)](_0xd69fe5(0x2c6),_0x19e1af),![];}}async[a62_0x44dae1(0x285)](_0x3594f6,_0x1619c1,_0x1c9610,_0x477b9f){const _0x470dce=a62_0x44dae1;try{if(!this[_0x470dce(0x2c9)])return console['error'](_0x470dce(0x20c)),![];return await this[_0x470dce(0x2c9)][_0x470dce(0x27a)](_0x3594f6,_0x1619c1,{},{'filename':_0x1c9610,'contentType':_0x1c9610[_0x470dce(0x255)]('.png')?'image/png':_0x1c9610['endsWith'](_0x470dce(0x1e0))||_0x1c9610[_0x470dce(0x255)](_0x470dce(0x2a2))?'image/jpeg':_0x1c9610[_0x470dce(0x255)](_0x470dce(0x25b))?_0x470dce(0x272):_0x470dce(0x263)}),_0x477b9f&&await this[_0x470dce(0x2c9)][_0x470dce(0x237)](_0x3594f6,_0x477b9f),console['log'](_0x470dce(0x2c3)+_0x3594f6+':\x20'+_0x1c9610),!![];}catch(_0x5724a4){return console[_0x470dce(0x24b)](_0x470dce(0x2a8),_0x5724a4),![];}}['stopBot'](){const _0x22c088=a62_0x44dae1;this[_0x22c088(0x2c9)]&&(this[_0x22c088(0x2c9)][_0x22c088(0x291)](),this[_0x22c088(0x2c9)]=null,console[_0x22c088(0x1ea)]('🛑\x20Telegram\x20bot\x20stopped'));}}function a62_0x2877(){const _0x479efc=['❌\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a','Payment\x20failed','env','en-US','📝\x20Order\x20ID:\x20`','365507sroVoU','...\x22','\x0a💡\x20Check\x20your\x20request\x20or\x20contact\x20support.','❌\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a','✅\x20Notification\x20sent\x20to\x20Telegram\x20user\x20','❌\x20Failed\x20to\x20initialize\x20Telegram\x20bot:','Error\x20handling\x20message:','TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables','chat','trim','from','🔔\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a','setupBotHandlers','\x20(@','shop','/status\x20-\x20check\x20connection\x20status\x0a','✅\x20Telegram\x20bot\x20@','❌\x20Failed\x20to\x20send\x20message\x20to\x20user\x20','🏪\x20Gateway:\x20`','sendMessage','updatedAt','❌\x20An\x20error\x20occurred\x20while\x20verifying\x20data.','botUsername','1065200CjpTQJ','method','findUnique','length','onText',':\x20username=\x22','\x20initialized\x20successfully','username','New\x20payment\x20created','startsWith','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','8209719ymnArn','Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a','📱\x20No\x20active\x20Telegram\x20users\x20found','📝\x20Notes:\x20','📱\x20Notification\x20sent\x20to\x20','error','❌\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`','customerName','🆔\x20Request\x20ID:\x20`','user\x20is\x20deactivated','✅\x20Welcome\x20back!\x0a\x0a','test','success','User\x20','🔔\x20Notifications\x20are\x20active\x0a\x0a','endsWith','•\x20Payouts\x0a','🔗\x20TXID:\x20`','❌\x20Error\x20sending\x20file\x20to\x20shop:','📱\x20Telegram\x20notification:\x20gateway\x20\x22','🔌\x20User\x20','.pdf','Username:\x20`','amount','💸\x20Penalty\x20amount:\x20*','\x20via\x20single-line\x20input','notificationApiError','\x22,\x20apiKey=\x22','substring','application/octet-stream','../config/database','•\x20Payouts\x0a\x0a','*\x0a\x0a','\x20\x20\x20Public\x20Key:\x20`','failed','❌\x20No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20ID:\x20','\x20USD*\x0a','❌\x20Shop\x20`','image/png','join','API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','processing','`\x20is\x20inactive.\x0a\x0a','telegramBotService','application/pdf','Check\x20spelling\x20and\x20try\x20again.','status','Payment\x20successfully\x20paid','sendNotificationToAll','✅\x20Direct\x20message\x20sent\x20to\x20chat\x20','*.\x0a\x0a','toString','sendDocument','TELEGRAM_BOT_USERNAME','allSettled',':\x20`','Example:\x0a','Payout\x20rejected','sendShopNotification','`\x20(','currency','📱\x20Created\x20new\x20Telegram\x20user:\x20','❌\x20Shop\x20with\x20username\x20`','sendDirectFile','You\x20are\x20already\x20connected\x20to\x20shop:\x20*','.png','Contact\x20administrator.','433626uAfEYd','📱\x20Sending\x20notification\x20to\x20all\x20connected\x20users:\x20','✅\x20Telegram\x20user\x20','botToken','handleSingleLineVerification','initializeBot','Use\x20/start\x20to\x20begin.','ACTIVE','stopPolling','🏦\x20Method:\x20`','text','Failed\x20login\x20attempt','36kuWwWE','💸\x20Amount:\x20*','Error\x20handling\x20/disconnect\x20command:','\x0a⚠️\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!','chargebackAmount','Use\x20/start\x20to\x20connect.','map','sendShopFile','📝\x20Format:\x20`username\x20api_key`\x0a\x0a','Error\x20handling\x20/debug\x20command:','`.\x0a\x0a','`\x0a\x0a','📅\x20Date:\x20','.jpeg','No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20','3ZhYVWo','\x20users\x20of\x20shop\x20','Failed\x20to\x20send\x20login\x20notification:','userAgent','❌\x20Error\x20sending\x20file\x20to\x20chat:','/disconnect\x20-\x20disconnect\x20from\x20notifications','🏪\x20Available\x20shops\x20in\x20system:\x0a','orderId','requestId','\x20\x20\x20Status:\x20','❌\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.','createdAt','🎉\x20*Congratulations!*\x0a\x0a','statusCode','Commands:\x0a','image/jpeg','sendPaymentNotification','__esModule','customerUa','🤖\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a','Payment\x20chargeback','Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).','last_name','\x22\x20->\x20display\x20\x22','defineProperty','🆔\x20Payment\x20ID:\x20`','🔄\x20Reset\x20incomplete\x20verification\x20for\x20user\x20','456085nduBiN','❌\x20Failed\x20to\x20send\x20notification\x20to\x20all\x20users:','includes','adminNotes','✅\x20File\x20sent\x20to\x20chat\x20','TELEGRAM_BOT_TOKEN','txid','❌\x20Error\x20sending\x20direct\x20message:','✅\x20Login\x20notification\x20sent\x20for\x20shop\x20','📱\x20Your\x20Telegram\x20ID:\x20`','bot','📊\x20Error\x20code:\x20`','🔔\x20You\x20receive\x20notifications\x20about:\x0a','To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a','name','notificationLogin','Payment\x20expired','toLocaleString','remitterIban','New\x20payout\x20created','findFirst','Failed\x20to\x20send\x20API\x20error\x20notification:','🌐\x20IP\x20address:\x20`','Markdown','...','Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.','telegramUser','update','.jpg','3758629qqAyqt','Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`','✅\x20File\x20sent\x20to\x20','✅\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*','💰\x20Amount:\x20*','🔗\x20Endpoint:\x20`','../types/gateway','•\x20New\x20payments\x0a','customerEmail','log','\x20disconnected\x20from\x20shop\x20','first_name','shopId','trapay_bot','⏳\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a','•\x20Important\x20events\x0a\x0a','message','❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','telegramId','endpoint','❌\x20Invalid\x20API\x20key\x20format.\x0a\x0a','default','`\x20not\x20found.\x0a\x0a','...`\x0a\x0a','🔍\x20*Debug\x20Information*\x0a\x0a','❌\x20Error\x20getting\x20debug\x20information.','\x0aCheck\x20spelling\x20and\x20try\x20again.','❌\x20Error\x20sending\x20file\x20to\x20user\x20','chat\x20not\x20found','polling_error','📅\x20Time:\x20','✅\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a','ipAddress','📅\x20Connection\x20date:\x20','🔔\x20*','pk_','\x20USDT*\x0a','__importDefault','✅\x20Connected\x20to\x20shop:\x20*','split','✅\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20','❌\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20','Payment\x20is\x20being\x20processed','❌\x20Telegram\x20bot\x20not\x20initialized','TelegramBotService','To\x20reconnect,\x20use\x20the\x20/start\x20command','getBotInfo','❌\x20Error:\x20`','timestamp','🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20','sendLoginNotification','298288Pdjedh','You\x20sent\x20','isVerified','🌐\x20IP:\x20`','customerIp','gateway','👤\x20Username:\x20`','findMany','publicKey','🆔\x20Payout\x20ID:\x20`','📱\x20Login\x20notifications\x20disabled\x20for\x20shop\x20'];a62_0x2877=function(){return _0x479efc;};return a62_0x2877();}exports[a62_0x44dae1(0x20d)]=TelegramBotService,exports[a62_0x44dae1(0x271)]=new TelegramBotService();