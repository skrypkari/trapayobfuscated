'use strict';const a55_0x53dcf7=a55_0x4762;(function(_0x11d9ca,_0x511de3){const _0x262f85=a55_0x4762,_0x323478=_0x11d9ca();while(!![]){try{const _0x304a16=-parseInt(_0x262f85(0x11b))/0x1*(parseInt(_0x262f85(0x19c))/0x2)+-parseInt(_0x262f85(0x155))/0x3*(parseInt(_0x262f85(0x1c2))/0x4)+parseInt(_0x262f85(0x1da))/0x5*(parseInt(_0x262f85(0x165))/0x6)+-parseInt(_0x262f85(0x182))/0x7+-parseInt(_0x262f85(0x1ed))/0x8*(parseInt(_0x262f85(0x1b8))/0x9)+parseInt(_0x262f85(0x1a5))/0xa*(-parseInt(_0x262f85(0x1c3))/0xb)+parseInt(_0x262f85(0x1a2))/0xc;if(_0x304a16===_0x511de3)break;else _0x323478['push'](_0x323478['shift']());}catch(_0x1d018b){_0x323478['push'](_0x323478['shift']());}}}(a55_0x5990,0x57317));var __importDefault=this&&this[a55_0x53dcf7(0x1a7)]||function(_0x19cab7){const _0x5781a7=a55_0x53dcf7;return _0x19cab7&&_0x19cab7[_0x5781a7(0x1d2)]?_0x19cab7:{'default':_0x19cab7};};function a55_0x5990(){const _0x7bd80b=['secretKey','sendPaymentNotification','...`\x0a\x0a','message','Error\x20handling\x20message:','🏦\x20IBAN:\x20`','telegramBotService','📅\x20Connection\x20date:\x20','🌐\x20IP\x20address:\x20`','adminNotes','❌\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.','`\x20(','name','1858448IXjrCD','📝\x20Format:\x20`username\x20api_key`\x0a\x0a','Contact\x20administrator.','\x0a👤\x20*Customer\x20Information:*\x0a','🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20','from','onText','📝\x20Order\x20ID:\x20`','telegramUser','userAgent','To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a','🔔\x20*','setupBotHandlers','✅\x20Telegram\x20user\x20','toString','Payment\x20chargeback','Payment\x20failed','txid','trapay_bot','🔔\x20Notifications\x20are\x20active\x0a\x0a','Payment\x20refund','You\x20are\x20already\x20connected\x20to\x20shop:\x20*','../types/gateway','2356quYfWM','Error\x20handling\x20/debug\x20command:','createdAt','env','Use\x20/start\x20to\x20connect.','✅\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20','findMany','username','🛑\x20Telegram\x20bot\x20stopped','🌐\x20IP:\x20`','🔍\x20*Debug\x20Information*\x0a\x0a','test','`\x0a\x0a','last_name','botToken','❗️\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!','\x20verified\x20for\x20shop\x20','TELEGRAM_BOT_TOKEN','log','defineProperty','customerName','isVerified','text','updatedAt','You\x20sent\x20','\x20parts:\x20','default','sendPayoutNotification','🆔\x20Payment\x20ID:\x20`','❌\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`','New\x20payment\x20created','update','handleSingleLineVerification','Payment\x20is\x20being\x20processed','❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','Telegram\x20bot\x20polling\x20error:','Username:\x20`','📱\x20Shop:\x20*','•\x20Payouts\x0a\x0a','📅\x20Date:\x20','🆔\x20Payout\x20ID:\x20`','✅\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*','findUnique','🤖\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a','📱\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20','errorMessage','`\x20not\x20found.\x0a\x0a','❌\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20','💸\x20Amount:\x20*','💸\x20Penalty\x20amount:\x20*','TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables','💻\x20Browser:\x20`','✅\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a','chargeback','🏦\x20Method:\x20`','split','stopPolling','shop','180675mhoXdc','substring','customerIp','requestId','❌\x20Error\x20getting\x20debug\x20information.','🔄\x20Reset\x20incomplete\x20verification\x20for\x20user\x20','Successful\x20login','📛\x20Name:\x20`','📊\x20Error\x20code:\x20`','/status\x20-\x20check\x20connection\x20status\x0a','Example:\x0a','first_name','endpoint','../config/database','\x20USD*\x0a','ipAddress','8706twpSsq','Use\x20/start\x20to\x20begin.','\x20\x20\x20Username:\x20`','💰\x20Amount:\x20*','success','customerUa','Telegram\x20bot\x20error:','sendCustomNotification','polling_error','❌\x20Invalid\x20API\x20key\x20format.\x0a\x0a','✅\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*','toLocaleDateString','❌\x20Shop\x20`','initializeBot','📝\x20Notes:\x20','warn','forEach','📊\x20*Connection\x20Status*\x0a\x0a','/disconnect\x20-\x20disconnect\x20from\x20notifications','❌\x20An\x20error\x20occurred\x20while\x20verifying\x20data.','chargebackAmount','failed','orderId','❌\x20Please\x20use\x20/start\x20command\x20first','Commands:\x0a','*\x0a\x0a','error','📧\x20Email:\x20`','Error\x20handling\x20/start\x20command:','4377030MyiGnl','Check\x20spelling\x20and\x20try\x20again.','startsWith','entries','findFirst','method',':\x20username=\x22','stopBot','length','✅\x20Telegram\x20bot\x20@','pk_','👤\x20Username:\x20`','map','Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a','\x20via\x20single-line\x20input','⏳\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a','Error\x20handling\x20/status\x20command:','telegramId','To\x20reconnect,\x20use\x20the\x20/start\x20command','TelegramBotService','New\x20payout\x20created','✅\x20Notification\x20sent\x20to\x20Telegram\x20user\x20','user\x20is\x20deactivated','*.\x0a\x0a','`\x20is\x20inactive.\x0a\x0a','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','70VaKCln','bot','✅\x20Login\x20notification\x20sent\x20for\x20shop\x20','•\x20Important\x20events\x0a\x0a','chat','🔔\x20You\x20receive\x20notifications\x20about:\x0a','22817772Vcvjih','botUsername','shopId','230Ljtauk','❌\x20API\x20key\x20does\x20not\x20match\x20shop\x20`','__importDefault','publicKey','Error\x20in\x20handleSingleLineVerification:','en-US','sk_','🏪\x20Available\x20shops\x20in\x20system:\x0a','\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure','Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.','Failed\x20to\x20send\x20API\x20error\x20notification:','Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification','node-telegram-bot-api','\x0a💡\x20Check\x20your\x20request\x20or\x20contact\x20support.','sendShopNotification','🔔\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a','Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.','📅\x20Time:\x20','🔗\x20TXID:\x20`','9TKcduL','gateway','includes','sendMessage','Markdown','✅\x20Connected\x20to\x20shop:\x20*','customerEmail','statusCode','🆔\x20Request\x20ID:\x20`','Failed\x20to\x20send\x20login\x20notification:','24jpVoSw','273713rhDiTw','Payout\x20rejected','\x20\x20\x20Public\x20Key:\x20`','unknown\x20shop','create','📱\x20Telegram\x20notification:\x20gateway\x20\x22','Payment\x20expired','...\x22','notificationApiError','•\x20Payment\x20status\x20changes\x0a','amount','Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).','Error\x20sending\x20shop\x20notification:','remitterIban','\x0aCheck\x20spelling\x20and\x20try\x20again.','__esModule','\x22,\x20apiKey=\x22','notificationLogin','allSettled','trim','status','•\x20`','❌\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a','1135COGUTF','\x20(@','toLocaleString','timestamp','`.\x0a\x0a','shopSettings'];a55_0x5990=function(){return _0x7bd80b;};return a55_0x5990();}Object[a55_0x53dcf7(0x12e)](exports,a55_0x53dcf7(0x1d2),{'value':!![]}),exports[a55_0x53dcf7(0x1e6)]=exports[a55_0x53dcf7(0x195)]=void 0x0;function a55_0x4762(_0x3dbdeb,_0x296aae){const _0x5990c0=a55_0x5990();return a55_0x4762=function(_0x4762fb,_0x142a52){_0x4762fb=_0x4762fb-0x113;let _0x2cfd4a=_0x5990c0[_0x4762fb];return _0x2cfd4a;},a55_0x4762(_0x3dbdeb,_0x296aae);}const node_telegram_bot_api_1=__importDefault(require(a55_0x53dcf7(0x1b1))),database_1=__importDefault(require(a55_0x53dcf7(0x162))),gateway_1=require(a55_0x53dcf7(0x11a));class TelegramBotService{constructor(){const _0x513926=a55_0x53dcf7;this[_0x513926(0x19d)]=null,this[_0x513926(0x129)]=process[_0x513926(0x11e)][_0x513926(0x12c)]||'',this['botUsername']=process['env']['TELEGRAM_BOT_USERNAME']||_0x513926(0x116),this[_0x513926(0x129)]?this[_0x513926(0x172)]():console['warn'](_0x513926(0x14d));}[a55_0x53dcf7(0x172)](){const _0x3fb7d9=a55_0x53dcf7;try{this[_0x3fb7d9(0x19d)]=new node_telegram_bot_api_1[(_0x3fb7d9(0x135))](this['botToken'],{'polling':!![]}),this[_0x3fb7d9(0x1f9)](),console['log'](_0x3fb7d9(0x18b)+this[_0x3fb7d9(0x1a3)]+'\x20initialized\x20successfully');}catch(_0x168342){console[_0x3fb7d9(0x17f)]('❌\x20Failed\x20to\x20initialize\x20Telegram\x20bot:',_0x168342);}}[a55_0x53dcf7(0x1f9)](){const _0x42084e=a55_0x53dcf7;if(!this['bot'])return;this['bot']['onText'](/\/start/,async _0x5d8e19=>{const _0xb507c9=a55_0x4762,_0x4039c6=_0x5d8e19[_0xb507c9(0x1a0)]['id'],_0x24dbca=_0x5d8e19[_0xb507c9(0x1f2)]?.['id'][_0xb507c9(0x1fb)](),_0x311814=_0x5d8e19[_0xb507c9(0x1f2)]?.['username'],_0x34e5a6=_0x5d8e19['from']?.[_0xb507c9(0x160)],_0x12aa11=_0x5d8e19[_0xb507c9(0x1f2)]?.[_0xb507c9(0x128)];if(!_0x24dbca)return;try{let _0x184f5d=await database_1[_0xb507c9(0x135)][_0xb507c9(0x1f5)][_0xb507c9(0x145)]({'where':{'telegramId':_0x24dbca},'include':{'shop':!![]}});!_0x184f5d?(_0x184f5d=await database_1[_0xb507c9(0x135)][_0xb507c9(0x1f5)][_0xb507c9(0x1c7)]({'data':{'telegramId':_0x24dbca,'username':_0x311814,'firstName':_0x34e5a6,'lastName':_0x12aa11,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console['log']('📱\x20Created\x20new\x20Telegram\x20user:\x20'+_0x24dbca+_0xb507c9(0x1db)+_0x311814+')')):_0x184f5d=await database_1[_0xb507c9(0x135)]['telegramUser']['update']({'where':{'telegramId':_0x24dbca},'data':{'username':_0x311814,'firstName':_0x34e5a6,'lastName':_0x12aa11},'include':{'shop':!![]}}),_0x184f5d['isVerified']&&_0x184f5d['shopId']&&_0x184f5d['shop']?await this[_0xb507c9(0x19d)]?.[_0xb507c9(0x1bb)](_0x4039c6,'✅\x20Welcome\x20back!\x0a\x0a'+(_0xb507c9(0x119)+_0x184f5d[_0xb507c9(0x154)][_0xb507c9(0x1ec)]+'*\x0a')+(_0xb507c9(0x13f)+_0x184f5d[_0xb507c9(0x154)][_0xb507c9(0x122)]+_0xb507c9(0x127))+_0xb507c9(0x1a1)+'•\x20New\x20payments\x0a'+'•\x20Payment\x20status\x20changes\x0a'+_0xb507c9(0x141)+_0xb507c9(0x17d)+_0xb507c9(0x15e)+_0xb507c9(0x177),{'parse_mode':_0xb507c9(0x1bc)}):(_0x184f5d[_0xb507c9(0x1a4)]&&!_0x184f5d[_0xb507c9(0x130)]&&(await database_1[_0xb507c9(0x135)]['telegramUser']['update']({'where':{'telegramId':_0x24dbca},'data':{'shopId':null,'isVerified':![]}}),console[_0xb507c9(0x12d)](_0xb507c9(0x15a)+_0x24dbca)),await this[_0xb507c9(0x19d)]?.[_0xb507c9(0x1bb)](_0x4039c6,_0xb507c9(0x146)+_0xb507c9(0x1f7)+'📝\x20Format:\x20`username\x20api_key`\x0a\x0a'+_0xb507c9(0x15f)+_0xb507c9(0x19b)+_0xb507c9(0x12a),{'parse_mode':'Markdown'}));}catch(_0x3e9384){console['error'](_0xb507c9(0x181),_0x3e9384),await this[_0xb507c9(0x19d)]?.[_0xb507c9(0x1bb)](_0x4039c6,'❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this['bot'][_0x42084e(0x1f3)](/\/disconnect/,async _0x2d92c5=>{const _0x1ff419=_0x42084e,_0x32ff80=_0x2d92c5['chat']['id'],_0x344e59=_0x2d92c5[_0x1ff419(0x1f2)]?.['id'][_0x1ff419(0x1fb)]();if(!_0x344e59)return;try{const _0x3d9a66=await database_1[_0x1ff419(0x135)][_0x1ff419(0x1f5)]['findUnique']({'where':{'telegramId':_0x344e59},'include':{'shop':!![]}});if(!_0x3d9a66||!_0x3d9a66[_0x1ff419(0x130)]||!_0x3d9a66['shopId']){await this[_0x1ff419(0x19d)]?.[_0x1ff419(0x1bb)](_0x32ff80,_0x1ff419(0x1ea));return;}const _0x2ba1d7=_0x3d9a66[_0x1ff419(0x154)]?.[_0x1ff419(0x1ec)]||_0x1ff419(0x1c6);await database_1[_0x1ff419(0x135)][_0x1ff419(0x1f5)][_0x1ff419(0x13a)]({'where':{'telegramId':_0x344e59},'data':{'shopId':null,'isVerified':![]}}),console['log']('🔌\x20User\x20'+_0x344e59+'\x20disconnected\x20from\x20shop\x20'+_0x3d9a66[_0x1ff419(0x1a4)]),await this[_0x1ff419(0x19d)]?.[_0x1ff419(0x1bb)](_0x32ff80,_0x1ff419(0x144)+_0x2ba1d7+_0x1ff419(0x199)+_0x1ff419(0x194),{'parse_mode':'Markdown'});}catch(_0x1166a5){console[_0x1ff419(0x17f)]('Error\x20handling\x20/disconnect\x20command:',_0x1166a5),await this[_0x1ff419(0x19d)]?.[_0x1ff419(0x1bb)](_0x32ff80,'❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this[_0x42084e(0x19d)][_0x42084e(0x1f3)](/\/status/,async _0x3becc9=>{const _0x474493=_0x42084e,_0x495b27=_0x3becc9['chat']['id'],_0x538b31=_0x3becc9[_0x474493(0x1f2)]?.['id'][_0x474493(0x1fb)]();if(!_0x538b31)return;try{const _0x59e7c7=await database_1[_0x474493(0x135)][_0x474493(0x1f5)]['findUnique']({'where':{'telegramId':_0x538b31},'include':{'shop':!![]}});if(!_0x59e7c7){await this['bot']?.[_0x474493(0x1bb)](_0x495b27,'❌\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a'+_0x474493(0x166));return;}if(!_0x59e7c7[_0x474493(0x130)]||!_0x59e7c7['shopId']||!_0x59e7c7[_0x474493(0x154)]){await this['bot']?.[_0x474493(0x1bb)](_0x495b27,'❌\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a'+_0x474493(0x11f));return;}await this[_0x474493(0x19d)]?.[_0x474493(0x1bb)](_0x495b27,_0x474493(0x176)+(_0x474493(0x1bd)+_0x59e7c7[_0x474493(0x154)][_0x474493(0x1ec)]+'*\x0a')+(_0x474493(0x18d)+_0x59e7c7[_0x474493(0x154)][_0x474493(0x122)]+'`\x0a')+(_0x474493(0x1e7)+_0x59e7c7[_0x474493(0x132)][_0x474493(0x170)](_0x474493(0x1aa))+'\x0a\x0a')+_0x474493(0x117)+_0x474493(0x17d)+_0x474493(0x177),{'parse_mode':_0x474493(0x1bc)});}catch(_0x8d562e){console[_0x474493(0x17f)](_0x474493(0x192),_0x8d562e),await this[_0x474493(0x19d)]?.[_0x474493(0x1bb)](_0x495b27,_0x474493(0x13d));}}),this[_0x42084e(0x19d)][_0x42084e(0x1f3)](/\/debug/,async _0x3c83f0=>{const _0x11eefd=_0x42084e,_0x5207ea=_0x3c83f0['chat']['id'],_0x903fc4=_0x3c83f0[_0x11eefd(0x1f2)]?.['id'][_0x11eefd(0x1fb)]();if(!_0x903fc4)return;try{const _0x142443=await database_1[_0x11eefd(0x135)][_0x11eefd(0x154)]['findMany']({'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![]},'take':0xa});let _0x460149=_0x11eefd(0x125);_0x460149+='📱\x20Your\x20Telegram\x20ID:\x20`'+_0x903fc4+'`\x0a\x0a',_0x460149+=_0x11eefd(0x1ac),_0x142443['forEach']((_0x18b752,_0x1e5d09)=>{const _0x240eb0=_0x11eefd;_0x460149+=_0x1e5d09+0x1+'.\x20*'+_0x18b752[_0x240eb0(0x1ec)]+'*\x0a',_0x460149+=_0x240eb0(0x167)+_0x18b752[_0x240eb0(0x122)]+'`\x0a',_0x460149+='\x20\x20\x20Status:\x20'+_0x18b752[_0x240eb0(0x1d7)]+'\x0a',_0x460149+=_0x240eb0(0x1c5)+_0x18b752[_0x240eb0(0x1a8)][_0x240eb0(0x156)](0x0,0xf)+_0x240eb0(0x1e2);}),await this[_0x11eefd(0x19d)]?.['sendMessage'](_0x5207ea,_0x460149,{'parse_mode':_0x11eefd(0x1bc)});}catch(_0x14a172){console[_0x11eefd(0x17f)](_0x11eefd(0x11c),_0x14a172),await this[_0x11eefd(0x19d)]?.[_0x11eefd(0x1bb)](_0x5207ea,_0x11eefd(0x159));}}),this['bot']['on'](_0x42084e(0x1e3),async _0x47da62=>{const _0x5851f2=_0x42084e;if(_0x47da62[_0x5851f2(0x131)]?.[_0x5851f2(0x184)]('/'))return;const _0x476bb9=_0x47da62['chat']['id'],_0xb1d72f=_0x47da62[_0x5851f2(0x1f2)]?.['id']['toString'](),_0xa7e844=_0x47da62['text']?.[_0x5851f2(0x1d6)]();if(!_0xb1d72f||!_0xa7e844)return;try{const _0x273690=await database_1[_0x5851f2(0x135)][_0x5851f2(0x1f5)][_0x5851f2(0x145)]({'where':{'telegramId':_0xb1d72f},'include':{'shop':!![]}});if(!_0x273690){await this['bot']?.[_0x5851f2(0x1bb)](_0x476bb9,_0x5851f2(0x17c));return;}if(_0x273690[_0x5851f2(0x130)]&&_0x273690[_0x5851f2(0x1a4)]&&_0x273690[_0x5851f2(0x154)]){await this[_0x5851f2(0x19d)]?.[_0x5851f2(0x1bb)](_0x476bb9,_0x5851f2(0x16f)+_0x273690[_0x5851f2(0x154)][_0x5851f2(0x1ec)]+_0x5851f2(0x199)+_0x5851f2(0x1ae),{'parse_mode':_0x5851f2(0x1bc)});return;}const _0x18f02f=_0xa7e844[_0x5851f2(0x152)](/\s+/);if(_0x18f02f[_0x5851f2(0x18a)]!==0x2){await this[_0x5851f2(0x19d)]?.[_0x5851f2(0x1bb)](_0x476bb9,_0x5851f2(0x1d9)+_0x5851f2(0x1ee)+'Example:\x0a'+_0x5851f2(0x19b)+(_0x5851f2(0x133)+_0x18f02f['length']+_0x5851f2(0x134)+_0x18f02f[_0x5851f2(0x18e)](_0x193576=>'`'+_0x193576+'`')['join'](',\x20')),{'parse_mode':_0x5851f2(0x1bc)});return;}const [_0xdb898b,_0x18792d]=_0x18f02f;console[_0x5851f2(0x12d)](_0x5851f2(0x1f1)+_0xb1d72f+_0x5851f2(0x188)+_0xdb898b+'\x22,\x20apiKey=\x22'+_0x18792d[_0x5851f2(0x156)](0x0,0xa)+_0x5851f2(0x1ca)),await this[_0x5851f2(0x13b)](_0x476bb9,_0xb1d72f,_0xdb898b,_0x18792d);}catch(_0x162d5e){console['error'](_0x5851f2(0x1e4),_0x162d5e),await this[_0x5851f2(0x19d)]?.[_0x5851f2(0x1bb)](_0x476bb9,_0x5851f2(0x13d));}}),this[_0x42084e(0x19d)]['on'](_0x42084e(0x17f),_0x1c94d3=>{const _0x17faed=_0x42084e;console[_0x17faed(0x17f)](_0x17faed(0x16b),_0x1c94d3);}),this[_0x42084e(0x19d)]['on'](_0x42084e(0x16d),_0x39d179=>{const _0x1d97a5=_0x42084e;console[_0x1d97a5(0x17f)](_0x1d97a5(0x13e),_0x39d179);});}async[a55_0x53dcf7(0x13b)](_0x2ca935,_0x5ec5eb,_0x127003,_0xdc3da1){const _0x10dcef=a55_0x53dcf7;try{console[_0x10dcef(0x12d)]('🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20'+_0x5ec5eb+_0x10dcef(0x188)+_0x127003+_0x10dcef(0x1d3)+_0xdc3da1[_0x10dcef(0x156)](0x0,0xa)+_0x10dcef(0x1ca));if(!_0x127003||_0x127003[_0x10dcef(0x18a)]<0x3||_0x127003[_0x10dcef(0x18a)]>0x32||!/^[a-zA-Z0-9_]+$/[_0x10dcef(0x126)](_0x127003)){await this[_0x10dcef(0x19d)]?.['sendMessage'](_0x2ca935,'❌\x20Invalid\x20username\x20format:\x20`'+_0x127003+_0x10dcef(0x127)+_0x10dcef(0x1ce),{'parse_mode':_0x10dcef(0x1bc)});return;}if(!_0xdc3da1||!_0xdc3da1['startsWith'](_0x10dcef(0x18c))&&!_0xdc3da1[_0x10dcef(0x184)](_0x10dcef(0x1ab))){await this[_0x10dcef(0x19d)]?.[_0x10dcef(0x1bb)](_0x2ca935,_0x10dcef(0x16e)+'API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.',{'parse_mode':_0x10dcef(0x1bc)});return;}const _0x4a2849=await database_1['default'][_0x10dcef(0x154)][_0x10dcef(0x145)]({'where':{'username':_0x127003},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x4a2849){const _0x8bdac=await database_1['default'][_0x10dcef(0x154)]['findMany']({'select':{'username':!![],'name':!![]},'take':0x5});let _0xb0db1d='❌\x20Shop\x20with\x20username\x20`'+_0x127003+_0x10dcef(0x149);_0x8bdac['length']>0x0?(_0xb0db1d+='Available\x20usernames:\x0a',_0x8bdac[_0x10dcef(0x175)](_0x3a8066=>{const _0x29b5a4=_0x10dcef;_0xb0db1d+=_0x29b5a4(0x1d8)+_0x3a8066[_0x29b5a4(0x122)]+_0x29b5a4(0x1eb)+_0x3a8066[_0x29b5a4(0x1ec)]+')\x0a';}),_0xb0db1d+=_0x10dcef(0x1d1)):_0xb0db1d+=_0x10dcef(0x183);await this['bot']?.[_0x10dcef(0x1bb)](_0x2ca935,_0xb0db1d,{'parse_mode':_0x10dcef(0x1bc)});return;}if(_0x4a2849[_0x10dcef(0x1d7)]!=='ACTIVE'){await this['bot']?.['sendMessage'](_0x2ca935,_0x10dcef(0x171)+_0x127003+_0x10dcef(0x19a)+_0x10dcef(0x1ef),{'parse_mode':_0x10dcef(0x1bc)});return;}if(_0x4a2849[_0x10dcef(0x1a8)]!==_0xdc3da1&&_0x4a2849[_0x10dcef(0x1e0)]!==_0xdc3da1){await this[_0x10dcef(0x19d)]?.[_0x10dcef(0x1bb)](_0x2ca935,_0x10dcef(0x1a6)+_0x127003+'`.\x0a\x0a'+_0x10dcef(0x18f)+'Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`',{'parse_mode':_0x10dcef(0x1bc)});return;}const _0x30b6d6=await database_1[_0x10dcef(0x135)]['telegramUser'][_0x10dcef(0x186)]({'where':{'shopId':_0x4a2849['id'],'isVerified':!![],'telegramId':{'not':_0x5ec5eb}}});if(_0x30b6d6){await this[_0x10dcef(0x19d)]?.['sendMessage'](_0x2ca935,_0x10dcef(0x138)+_0x127003+_0x10dcef(0x1de)+_0x10dcef(0x1b5),{'parse_mode':_0x10dcef(0x1bc)});return;}await database_1[_0x10dcef(0x135)][_0x10dcef(0x1f5)]['update']({'where':{'telegramId':_0x5ec5eb},'data':{'shopId':_0x4a2849['id'],'isVerified':!![]}}),await this['bot']?.['sendMessage'](_0x2ca935,'🎉\x20*Congratulations!*\x0a\x0a'+_0x10dcef(0x14f)+(_0x10dcef(0x140)+_0x4a2849['name']+'*\x0a')+('👤\x20Username:\x20`'+_0x4a2849[_0x10dcef(0x122)]+'`\x0a\x0a')+_0x10dcef(0x1b4)+'•\x20New\x20payments\x0a'+_0x10dcef(0x1cc)+'•\x20Payouts\x0a'+_0x10dcef(0x19f)+_0x10dcef(0x17d)+_0x10dcef(0x15e)+_0x10dcef(0x177),{'parse_mode':_0x10dcef(0x1bc)}),console[_0x10dcef(0x12d)](_0x10dcef(0x1fa)+_0x5ec5eb+_0x10dcef(0x12b)+_0x4a2849[_0x10dcef(0x122)]+_0x10dcef(0x190));}catch(_0x1d56eb){console[_0x10dcef(0x17f)](_0x10dcef(0x1a9),_0x1d56eb),await this['bot']?.[_0x10dcef(0x1bb)](_0x2ca935,_0x10dcef(0x178));}}async[a55_0x53dcf7(0x1b3)](_0x3e68db,_0x443fa1,_0x2aed6c){const _0x48e6e2=a55_0x53dcf7;if(!this[_0x48e6e2(0x19d)]){console[_0x48e6e2(0x174)](_0x48e6e2(0x1b0));return;}try{const _0x58af81=await database_1[_0x48e6e2(0x135)][_0x48e6e2(0x1f5)][_0x48e6e2(0x121)]({'where':{'shopId':_0x3e68db,'isVerified':!![]}});if(_0x58af81[_0x48e6e2(0x18a)]===0x0){console[_0x48e6e2(0x12d)]('No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20'+_0x3e68db);return;}const _0x44eba4=_0x58af81[_0x48e6e2(0x18e)](async _0x94ad88=>{const _0x290ea1=_0x48e6e2;try{await this[_0x290ea1(0x19d)]?.[_0x290ea1(0x1bb)](_0x94ad88['telegramId'],_0x443fa1,_0x2aed6c),console['log'](_0x290ea1(0x197)+_0x94ad88[_0x290ea1(0x193)]);}catch(_0x3537dc){console[_0x290ea1(0x17f)](_0x290ea1(0x14a)+_0x94ad88[_0x290ea1(0x193)]+':',_0x3537dc),_0x3537dc instanceof Error&&(_0x3537dc[_0x290ea1(0x1e3)][_0x290ea1(0x1ba)]('blocked')||_0x3537dc[_0x290ea1(0x1e3)][_0x290ea1(0x1ba)]('chat\x20not\x20found')||_0x3537dc[_0x290ea1(0x1e3)][_0x290ea1(0x1ba)](_0x290ea1(0x198)))&&(await database_1['default'][_0x290ea1(0x1f5)][_0x290ea1(0x13a)]({'where':{'id':_0x94ad88['id']},'data':{'isVerified':![]}}),console[_0x290ea1(0x12d)]('User\x20'+_0x94ad88['telegramId']+_0x290ea1(0x1ad)));}});await Promise[_0x48e6e2(0x1d5)](_0x44eba4);}catch(_0x3a433e){console['error'](_0x48e6e2(0x1cf),_0x3a433e);}}async[a55_0x53dcf7(0x1e1)](_0x417dcb,_0x640663,_0x4a4d37){const _0x52a922=a55_0x53dcf7,_0x544d86={'created':'🆕','paid':'✅','failed':'❌','expired':'⏰','refund':'🔄','chargeback':'⚠️','processing':'⚙️'},_0x6e76bd={'created':_0x52a922(0x139),'paid':'Payment\x20successfully\x20paid','failed':_0x52a922(0x114),'expired':_0x52a922(0x1c9),'refund':_0x52a922(0x118),'chargeback':_0x52a922(0x113),'processing':_0x52a922(0x13c)},_0x5e49f8=_0x544d86[_0x4a4d37],_0x5c977e=_0x6e76bd[_0x4a4d37],_0x9a5a9c=(0x0,gateway_1['getGatewayDisplayNameForTelegram'])(_0x640663[_0x52a922(0x1b9)]);console['log'](_0x52a922(0x1c8)+_0x640663['gateway']+'\x22\x20->\x20display\x20\x22'+_0x9a5a9c+'\x22');let _0x5f060a=_0x5e49f8+'\x20*'+_0x5c977e+_0x52a922(0x17e)+(_0x52a922(0x168)+_0x640663[_0x52a922(0x1cd)]+'\x20'+_0x640663['currency']+'*\x0a')+(_0x52a922(0x1f4)+(_0x640663[_0x52a922(0x17b)]||_0x640663['id'])+'`\x0a')+(_0x52a922(0x137)+_0x640663['id']+'`\x0a')+('🏪\x20Gateway:\x20`'+_0x9a5a9c+'`\x0a')+(_0x52a922(0x142)+new Date(_0x640663[_0x52a922(0x11d)])[_0x52a922(0x1dc)](_0x52a922(0x1aa))+'\x0a');if(_0x640663[_0x52a922(0x12f)]||_0x640663['customerEmail']||_0x640663[_0x52a922(0x1d0)]||_0x640663[_0x52a922(0x157)]||_0x640663[_0x52a922(0x16a)]){_0x5f060a+=_0x52a922(0x1f0);_0x640663[_0x52a922(0x12f)]&&(_0x5f060a+=_0x52a922(0x15c)+_0x640663[_0x52a922(0x12f)]+'`\x0a');_0x640663[_0x52a922(0x1be)]&&(_0x5f060a+=_0x52a922(0x180)+_0x640663[_0x52a922(0x1be)]+'`\x0a');_0x640663['remitterIban']&&(_0x5f060a+=_0x52a922(0x1e5)+_0x640663[_0x52a922(0x1d0)]+'`\x0a');_0x640663[_0x52a922(0x157)]&&(_0x5f060a+=_0x52a922(0x124)+_0x640663['customerIp']+'`\x0a');if(_0x640663[_0x52a922(0x16a)]){const _0x5d352b=_0x640663['customerUa'][_0x52a922(0x18a)]>0x32?_0x640663[_0x52a922(0x16a)]['substring'](0x0,0x32)+'...':_0x640663[_0x52a922(0x16a)];_0x5f060a+='💻\x20Browser:\x20`'+_0x5d352b+'`\x0a';}}_0x4a4d37===_0x52a922(0x150)&&_0x640663['chargebackAmount']&&(_0x5f060a+=_0x52a922(0x14c)+_0x640663[_0x52a922(0x179)]+'\x20USDT*\x0a'),_0x4a4d37==='processing'&&(_0x5f060a+=_0x52a922(0x191)),_0x640663['adminNotes']&&(_0x5f060a+=_0x52a922(0x173)+_0x640663[_0x52a922(0x1e9)]+'\x0a'),await this[_0x52a922(0x1b3)](_0x417dcb,_0x5f060a,{'parse_mode':_0x52a922(0x1bc)});}async[a55_0x53dcf7(0x136)](_0x1d0fb5,_0x2dca54,_0x53f253){const _0x1b4aa3=a55_0x53dcf7,_0x3bcbff={'created':'📤','completed':'✅','rejected':'❌'},_0x4584e1={'created':_0x1b4aa3(0x196),'completed':'Payout\x20completed','rejected':_0x1b4aa3(0x1c4)},_0xc1afb6=_0x3bcbff[_0x53f253],_0x3d7d24=_0x4584e1[_0x53f253],_0x46af5a=_0xc1afb6+'\x20*'+_0x3d7d24+'*\x0a\x0a'+(_0x1b4aa3(0x14b)+_0x2dca54['amount']+_0x1b4aa3(0x163))+(_0x1b4aa3(0x151)+_0x2dca54[_0x1b4aa3(0x187)]+'`\x0a')+(_0x1b4aa3(0x143)+_0x2dca54['id']+'`\x0a')+(_0x1b4aa3(0x142)+new Date(_0x2dca54[_0x1b4aa3(0x11d)])[_0x1b4aa3(0x1dc)](_0x1b4aa3(0x1aa))+'\x0a')+(_0x2dca54['txid']?_0x1b4aa3(0x1b7)+_0x2dca54[_0x1b4aa3(0x115)]+'`':'');await this[_0x1b4aa3(0x1b3)](_0x1d0fb5,_0x46af5a,{'parse_mode':_0x1b4aa3(0x1bc)});}async['sendLoginNotification'](_0x3e99a8,_0x1c45b9){const _0xb6332b=a55_0x53dcf7;try{const _0x3738e7=await database_1[_0xb6332b(0x135)][_0xb6332b(0x1df)][_0xb6332b(0x145)]({'where':{'shopId':_0x3e99a8},'select':{'notificationLogin':!![]}});if(!_0x3738e7?.[_0xb6332b(0x1d4)]){console['log']('📱\x20Login\x20notifications\x20disabled\x20for\x20shop\x20'+_0x3e99a8);return;}const _0x3a1a6c=_0x1c45b9[_0xb6332b(0x169)]?'🔐':'🚨',_0x20136e=_0x1c45b9['success']?_0xb6332b(0x15b):'Failed\x20login\x20attempt';let _0x57ea0b=_0x3a1a6c+'\x20*'+_0x20136e+'*\x0a\x0a'+(_0xb6332b(0x18d)+_0x1c45b9[_0xb6332b(0x122)]+'`\x0a')+(_0xb6332b(0x1b6)+_0x1c45b9['timestamp'][_0xb6332b(0x1dc)](_0xb6332b(0x1aa))+'\x0a');_0x1c45b9['ipAddress']&&(_0x57ea0b+=_0xb6332b(0x1e8)+_0x1c45b9[_0xb6332b(0x164)]+'`\x0a');if(_0x1c45b9[_0xb6332b(0x1f6)]){const _0xaad24=_0x1c45b9[_0xb6332b(0x1f6)][_0xb6332b(0x18a)]>0x32?_0x1c45b9[_0xb6332b(0x1f6)][_0xb6332b(0x156)](0x0,0x32)+'...':_0x1c45b9[_0xb6332b(0x1f6)];_0x57ea0b+=_0xb6332b(0x14e)+_0xaad24+'`\x0a';}!_0x1c45b9[_0xb6332b(0x169)]&&(_0x57ea0b+='\x0a⚠️\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!'),await this[_0xb6332b(0x1b3)](_0x3e99a8,_0x57ea0b,{'parse_mode':_0xb6332b(0x1bc)}),console[_0xb6332b(0x12d)](_0xb6332b(0x19e)+_0x3e99a8+':\x20'+(_0x1c45b9[_0xb6332b(0x169)]?_0xb6332b(0x169):_0xb6332b(0x17a)));}catch(_0x209186){console[_0xb6332b(0x17f)](_0xb6332b(0x1c1),_0x209186);}}async['sendApiErrorNotification'](_0x24a338,_0x59dc1d){const _0x3c8354=a55_0x53dcf7;try{const _0x32be58=await database_1[_0x3c8354(0x135)][_0x3c8354(0x1df)][_0x3c8354(0x145)]({'where':{'shopId':_0x24a338},'select':{'notificationApiError':!![]}});if(!_0x32be58?.[_0x3c8354(0x1cb)]){console[_0x3c8354(0x12d)](_0x3c8354(0x147)+_0x24a338);return;}let _0x4cacd2='🚨\x20*API\x20Error*\x0a\x0a'+('🔗\x20Endpoint:\x20`'+_0x59dc1d[_0x3c8354(0x187)]+'\x20'+_0x59dc1d[_0x3c8354(0x161)]+'`\x0a')+('📅\x20Time:\x20'+_0x59dc1d[_0x3c8354(0x1dd)]['toLocaleString'](_0x3c8354(0x1aa))+'\x0a');_0x59dc1d[_0x3c8354(0x1bf)]&&(_0x4cacd2+=_0x3c8354(0x15d)+_0x59dc1d[_0x3c8354(0x1bf)]+'`\x0a'),_0x4cacd2+='❌\x20Error:\x20`'+_0x59dc1d[_0x3c8354(0x148)]+'`\x0a',_0x59dc1d[_0x3c8354(0x158)]&&(_0x4cacd2+=_0x3c8354(0x1c0)+_0x59dc1d['requestId']+'`\x0a'),_0x4cacd2+=_0x3c8354(0x1b2),await this[_0x3c8354(0x1b3)](_0x24a338,_0x4cacd2,{'parse_mode':'Markdown'}),console['log'](_0x3c8354(0x120)+_0x24a338+':\x20'+_0x59dc1d[_0x3c8354(0x161)]);}catch(_0x3b3c49){console[_0x3c8354(0x17f)](_0x3c8354(0x1af),_0x3b3c49);}}async[a55_0x53dcf7(0x16c)](_0x3f689d,_0x217675,_0x2033f8){const _0x2c5eab=a55_0x53dcf7;let _0x1e7cf9=_0x2c5eab(0x1f8)+_0x217675+_0x2c5eab(0x17e);for(const [_0x139aa7,_0x4a8077]of Object[_0x2c5eab(0x185)](_0x2033f8)){_0x4a8077!==null&&_0x4a8077!==undefined&&(_0x1e7cf9+=_0x139aa7+':\x20`'+_0x4a8077+'`\x0a');}await this[_0x2c5eab(0x1b3)](_0x3f689d,_0x1e7cf9,{'parse_mode':_0x2c5eab(0x1bc)});}['getBotInfo'](){const _0x38c8f5=a55_0x53dcf7;return{'isActive':!!this[_0x38c8f5(0x19d)],'username':this[_0x38c8f5(0x1a3)]};}[a55_0x53dcf7(0x189)](){const _0xf6a28c=a55_0x53dcf7;this[_0xf6a28c(0x19d)]&&(this[_0xf6a28c(0x19d)][_0xf6a28c(0x153)](),this[_0xf6a28c(0x19d)]=null,console[_0xf6a28c(0x12d)](_0xf6a28c(0x123)));}}exports[a55_0x53dcf7(0x195)]=TelegramBotService,exports['telegramBotService']=new TelegramBotService();