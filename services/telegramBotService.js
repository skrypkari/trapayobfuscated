'use strict';const a80_0x422b4b=a80_0x3b18;(function(_0x1b7773,_0x246e40){const _0x5bcc2a=a80_0x3b18,_0x2b7dac=_0x1b7773();while(!![]){try{const _0x2e915d=parseInt(_0x5bcc2a(0xc2))/0x1+parseInt(_0x5bcc2a(0x1a8))/0x2+-parseInt(_0x5bcc2a(0x197))/0x3*(parseInt(_0x5bcc2a(0x175))/0x4)+-parseInt(_0x5bcc2a(0x147))/0x5+parseInt(_0x5bcc2a(0xae))/0x6*(parseInt(_0x5bcc2a(0x130))/0x7)+parseInt(_0x5bcc2a(0xb2))/0x8*(-parseInt(_0x5bcc2a(0x15f))/0x9)+-parseInt(_0x5bcc2a(0x107))/0xa*(-parseInt(_0x5bcc2a(0xec))/0xb);if(_0x2e915d===_0x246e40)break;else _0x2b7dac['push'](_0x2b7dac['shift']());}catch(_0x12b39b){_0x2b7dac['push'](_0x2b7dac['shift']());}}}(a80_0x3167,0xa580a));var __importDefault=this&&this[a80_0x422b4b(0x128)]||function(_0x553d9a){const _0x2a16e0=a80_0x422b4b;return _0x553d9a&&_0x553d9a[_0x2a16e0(0x122)]?_0x553d9a:{'default':_0x553d9a};};function a80_0x3167(){const _0x1201da=['Markdown','Payment\x20expired','\x20\x20\x20Status:\x20','‚ùå\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a','‚ùå\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a','üåê\x20*Network:*\x20','user\x20is\x20deactivated','shop','../config/database','üì±\x20Notification\x20sent\x20to\x20','length','.jpeg','`\x20is\x20inactive.\x0a\x0a','‚ùå\x20Failed\x20to\x20send\x20notification\x20to\x20all\x20users:','Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.','trim','Not\x20specified','success','To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a','851964abtjgP','üìÖ\x20*Payout\x20Date:*\x20','‚úÖ\x20Telegram\x20bot\x20@','üîÑ\x20Reset\x20incomplete\x20verification\x20for\x20user\x20','Error\x20handling\x20message:','.pdf','remitterIban','includes','‚Ä¢\x20New\x20payments\x0a','log','üìÖ\x20Time:\x20','Payment\x20successfully\x20paid','from','üì±\x20Created\x20new\x20Telegram\x20user:\x20','Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification','botUsername','Error\x20handling\x20/debug\x20command:','üìù\x20Format:\x20`username\x20api_key`\x0a\x0a','toLocaleDateString','Please\x20check\x20the\x20spelling\x20and\x20try\x20again.\x0a\x0a','üè™\x20Your\x20connected\x20shop:\x0a','‚úÖ\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20','trapay_bot','üì±\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20','‚ùå\x20You\x20are\x20not\x20connected\x20to\x20any\x20shop.\x0a\x0a','Use\x20/start\x20to\x20connect.','onText','‚ùå\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.','‚ùå\x20Error\x20sending\x20file\x20to\x20user\x20','üì±\x20Login\x20notifications\x20disabled\x20for\x20shop\x20','en-US','sendDirectMessage','error','`\x0a\x0a','9MgotlG','üè¶\x20IBAN:\x20`','üí∏\x20Penalty\x20amount:\x20*','last_name','‚úÖ\x20Connected\x20to\x20shop:\x20*','üîå\x20User\x20','üì±\x20Your\x20Telegram\x20ID:\x20`','setupBotHandlers','üí≥\x20*Wallet:*\x20`','2-digit','toString','username','üì±\x20No\x20active\x20Telegram\x20users\x20found','Error\x20in\x20handleSingleLineVerification:','\x20users','sendApiErrorNotification','Example:\x0a','2090918vKzjEP','Failed\x20login\x20attempt','Error\x20sending\x20shop\x20notification:','notificationLogin','‚úÖ\x20File\x20sent\x20to\x20chat\x20','\x20via\x20single-line\x20input','/status\x20-\x20check\x20connection\x20status\x0a','message','TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables','unknown\x20shop','‚ùå\x20Telegram\x20bot\x20not\x20initialized','‚Ä¢\x20Important\x20events\x0a\x0a','‚ùå\x20Please\x20use\x20/start\x20command\x20first','üîó\x20Endpoint:\x20`','65412znIbqs','‚úÖ\x20Notification\x20sent\x20to\x20Telegram\x20user\x20','Successful\x20login','requestId','17464wHbwoR',':\x20username=\x22','image/png','\x20initialized\x20successfully','findUnique','\x20verified\x20for\x20shop\x20','üìù\x20Notes:\x20','substring','Payment\x20is\x20being\x20processed','üîç\x20*Debug\x20Information*\x0a\x0a','statusCode','customerUa','üîî\x20*','Use\x20/start\x20to\x20connect\x20to\x20a\x20shop.','‚Ä¢\x20Payouts\x0a\x0a','findMany','388059VSDcQU','üì±\x20Shop:\x20*','userAgent','processing','üë§\x20Username:\x20`','üö®\x20*API\x20Error*\x0a\x0a','üîÑ\x20Processing\x20single-line\x20verification\x20for\x20user\x20','...','\x20(@','üì±\x20Sending\x20notification\x20to\x20all\x20connected\x20users:\x20','\x20\x20\x20Name:\x20*','Contact\x20administrator.','üí∏\x20*New\x20Payout*\x0a\x0a','numeric','\x22\x20->\x20display\x20\x22','handleSingleLineVerification','bot','Error\x20handling\x20/status\x20command:','Failed\x20to\x20send\x20API\x20error\x20notification:','üìõ\x20Name:\x20`','‚ùå\x20No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20ID:\x20','image/jpeg','polling_error','sendShopNotification','geo','*.\x0a\x0a','Telegram\x20bot\x20error:','test','üÜî\x20Payment\x20ID:\x20`','create','‚ùå\x20Invalid\x20username\x20format:\x20`','sendDocument','status','‚úÖ\x20Direct\x20message\x20sent\x20to\x20chat\x20','telegramUser','stopPolling','üìß\x20Email:\x20`','Telegram\x20bot\x20polling\x20error:','‚ùå\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','\x0aüí°\x20Check\x20your\x20request\x20or\x20contact\x20support.','text','pk_','138226bIBksE','ipAddress','customerEmail','period','üìä\x20Error\x20code:\x20`','sendDirectFile','../types/gateway','‚úÖ\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*','currency','üíª\x20Browser:\x20`','‚ùå\x20Error\x20sending\x20file\x20to\x20shop:','üîó\x20*Transaction\x20Link:*\x20`','‚ùå\x20Maximum\x20number\x20of\x20connected\x20accounts\x20(5)\x20reached\x20for\x20shop\x20`','API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','update','sendMessage','Payment\x20failed','Commands:\x0a','warn','User\x20','\x20parts:\x20','‚ùå\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20','telegramBotService','üåê\x20IP\x20address:\x20`','‚è≥\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a','chat\x20not\x20found','üõë\x20Telegram\x20bot\x20stopped','30Peglot','‚ùå\x20API\x20key\x20does\x20not\x20match\x20shop\x20`','toLocaleString','‚ùå\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a','chargeback','üìÖ\x20Date:\x20','first_name','chat','ü§ñ\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a','üìä\x20*Connection\x20Status*\x0a\x0a','sendLoginNotification','‚è±Ô∏è\x20*Period:*\x20','\x0aüë§\x20*Customer\x20Information:*\x0a','isVerified','orderId','timestamp','createdAt','sendShopFile','/disconnect\x20-\x20disconnect\x20from\x20notifications','Error\x20handling\x20/disconnect\x20command:','\x22,\x20apiKey=\x22','getGatewayDisplayNameForTelegram','name','‚úÖ\x20Welcome\x20back!\x0a\x0a','Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).','customerName','\x20\x20\x20Username:\x20`','__esModule','updatedAt','customerIp','üè™\x20Gateway:\x20`','sendPaymentNotification','üí∞\x20*Amount:*\x20','__importDefault','üÜî\x20Request\x20ID:\x20`','üí∞\x20Amount:\x20*','‚ùå\x20Failed\x20to\x20send\x20message\x20to\x20user\x20','üîî\x20Notifications\x20are\x20active\x0a\x0a','default','startsWith','Use\x20/start\x20to\x20begin.','245uFbyvu','sendCustomNotification','endsWith','‚ùå\x20Shop\x20with\x20username\x20`','stopBot','telegramId','adminNotes','.jpg','You\x20sent\x20',':\x20`','gateway','...\x22','üì±\x20Telegram\x20notification:\x20gateway\x20\x22','‚úÖ\x20Telegram\x20user\x20','initializeBot','sendPayoutNotification','network','TelegramBotService','üéâ\x20*Congratulations!*\x0a\x0a','\x20USD\x0a','amount','txid','count','867685NvVeAt','Payment\x20refund','‚ùóÔ∏è\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!','Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`','sk_','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','Payment\x20chargeback','`\x20not\x20found.\x0a\x0a','*\x0a\x0a','getBotInfo','notificationApiError','shopId','endpoint','Disconnect\x20one\x20of\x20the\x20existing\x20accounts\x20first.','‚Ä¢\x20Payment\x20status\x20changes\x0a','blocked','\x0a‚ö†Ô∏è\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!','secretKey','‚úÖ\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a','map','\x20disconnected\x20from\x20shop\x20','botToken','application/pdf','üîî\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a','1494jKyttn','Username:\x20`','application/octet-stream'];a80_0x3167=function(){return _0x1201da;};return a80_0x3167();}Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a80_0x422b4b(0x102)]=exports['TelegramBotService']=void 0x0;function a80_0x3b18(_0x2b9ffd,_0x3143a6){_0x2b9ffd=_0x2b9ffd-0xa8;const _0x3167f0=a80_0x3167();let _0x3b18bd=_0x3167f0[_0x2b9ffd];return _0x3b18bd;}const node_telegram_bot_api_1=__importDefault(require('node-telegram-bot-api')),database_1=__importDefault(require(a80_0x422b4b(0x16a))),gateway_1=require(a80_0x422b4b(0xf2));class TelegramBotService{constructor(){const _0x4e1d71=a80_0x422b4b;this[_0x4e1d71(0xd2)]=null,this[_0x4e1d71(0x15c)]=process.env.TELEGRAM_BOT_TOKEN||'',this[_0x4e1d71(0x184)]=process.env.TELEGRAM_BOT_USERNAME||_0x4e1d71(0x18b),this[_0x4e1d71(0x15c)]?this[_0x4e1d71(0x13e)]():console[_0x4e1d71(0xfe)](_0x4e1d71(0xa8));}[a80_0x422b4b(0x13e)](){const _0x5b8c85=a80_0x422b4b;try{this['bot']=new node_telegram_bot_api_1[(_0x5b8c85(0x12d))](this[_0x5b8c85(0x15c)],{'polling':!![]}),this[_0x5b8c85(0x19e)](),console[_0x5b8c85(0x17e)](_0x5b8c85(0x177)+this[_0x5b8c85(0x184)]+_0x5b8c85(0xb5));}catch(_0x70e94a){console['error']('‚ùå\x20Failed\x20to\x20initialize\x20Telegram\x20bot:',_0x70e94a);}}[a80_0x422b4b(0x19e)](){const _0x14bd5a=a80_0x422b4b;if(!this[_0x14bd5a(0xd2)])return;this[_0x14bd5a(0xd2)][_0x14bd5a(0x18f)](/\/start/,async _0x213642=>{const _0x587c9d=_0x14bd5a,_0x4b9b9d=_0x213642[_0x587c9d(0x10e)]['id'],_0x41d2ec=_0x213642['from']?.['id'][_0x587c9d(0x1a1)](),_0xb02123=_0x213642[_0x587c9d(0x181)]?.[_0x587c9d(0x1a2)],_0xf19a35=_0x213642[_0x587c9d(0x181)]?.[_0x587c9d(0x10d)],_0x34fecd=_0x213642[_0x587c9d(0x181)]?.[_0x587c9d(0x19a)];if(!_0x41d2ec)return;try{let _0x4eb4cd=await database_1[_0x587c9d(0x12d)][_0x587c9d(0xe4)][_0x587c9d(0xb6)]({'where':{'telegramId':_0x41d2ec},'include':{'shop':!![]}});!_0x4eb4cd?(_0x4eb4cd=await database_1['default']['telegramUser'][_0x587c9d(0xdf)]({'data':{'telegramId':_0x41d2ec,'username':_0xb02123,'firstName':_0xf19a35,'lastName':_0x34fecd,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console[_0x587c9d(0x17e)](_0x587c9d(0x182)+_0x41d2ec+_0x587c9d(0xca)+_0xb02123+')')):_0x4eb4cd=await database_1[_0x587c9d(0x12d)][_0x587c9d(0xe4)][_0x587c9d(0xfa)]({'where':{'telegramId':_0x41d2ec},'data':{'username':_0xb02123,'firstName':_0xf19a35,'lastName':_0x34fecd},'include':{'shop':!![]}}),_0x4eb4cd[_0x587c9d(0x114)]&&_0x4eb4cd[_0x587c9d(0x152)]&&_0x4eb4cd[_0x587c9d(0x169)]?await this[_0x587c9d(0xd2)]?.['sendMessage'](_0x4b9b9d,_0x587c9d(0x11e)+('You\x20are\x20already\x20connected\x20to\x20shop:\x20*'+_0x4eb4cd[_0x587c9d(0x169)][_0x587c9d(0x11d)]+'*\x0a')+(_0x587c9d(0x160)+_0x4eb4cd[_0x587c9d(0x169)][_0x587c9d(0x1a2)]+'`\x0a\x0a')+'üîî\x20You\x20receive\x20notifications\x20about:\x0a'+_0x587c9d(0x17d)+_0x587c9d(0x155)+_0x587c9d(0xc0)+_0x587c9d(0xfd)+_0x587c9d(0x1ae)+_0x587c9d(0x119),{'parse_mode':'Markdown'}):(_0x4eb4cd[_0x587c9d(0x152)]&&!_0x4eb4cd[_0x587c9d(0x114)]&&(await database_1[_0x587c9d(0x12d)]['telegramUser']['update']({'where':{'telegramId':_0x41d2ec},'data':{'shopId':null,'isVerified':![]}}),console[_0x587c9d(0x17e)](_0x587c9d(0x178)+_0x41d2ec)),await this[_0x587c9d(0xd2)]?.[_0x587c9d(0xfb)](_0x4b9b9d,_0x587c9d(0x10f)+_0x587c9d(0x174)+'üìù\x20Format:\x20`username\x20api_key`\x0a\x0a'+_0x587c9d(0x1a7)+_0x587c9d(0x14c)+_0x587c9d(0x149),{'parse_mode':_0x587c9d(0x162)}));}catch(_0x406048){console[_0x587c9d(0x195)]('Error\x20handling\x20/start\x20command:',_0x406048),await this[_0x587c9d(0xd2)]?.['sendMessage'](_0x4b9b9d,'‚ùå\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this[_0x14bd5a(0xd2)][_0x14bd5a(0x18f)](/\/disconnect/,async _0x4db696=>{const _0x2438fb=_0x14bd5a,_0x4bed46=_0x4db696[_0x2438fb(0x10e)]['id'],_0x3cc192=_0x4db696[_0x2438fb(0x181)]?.['id'][_0x2438fb(0x1a1)]();if(!_0x3cc192)return;try{const _0x983571=await database_1[_0x2438fb(0x12d)]['telegramUser']['findUnique']({'where':{'telegramId':_0x3cc192},'include':{'shop':!![]}});if(!_0x983571||!_0x983571['isVerified']||!_0x983571[_0x2438fb(0x152)]){await this['bot']?.['sendMessage'](_0x4bed46,_0x2438fb(0x190));return;}const _0x2446f2=_0x983571['shop']?.['name']||_0x2438fb(0xa9);await database_1['default']['telegramUser'][_0x2438fb(0xfa)]({'where':{'telegramId':_0x3cc192},'data':{'shopId':null,'isVerified':![]}}),console[_0x2438fb(0x17e)](_0x2438fb(0x19c)+_0x3cc192+_0x2438fb(0x15b)+_0x983571[_0x2438fb(0x152)]),await this['bot']?.[_0x2438fb(0xfb)](_0x4bed46,'‚úÖ\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*'+_0x2446f2+_0x2438fb(0xdb)+'To\x20reconnect,\x20use\x20the\x20/start\x20command',{'parse_mode':_0x2438fb(0x162)});}catch(_0x5165aa){console['error'](_0x2438fb(0x11a),_0x5165aa),await this[_0x2438fb(0xd2)]?.[_0x2438fb(0xfb)](_0x4bed46,_0x2438fb(0xe8));}}),this[_0x14bd5a(0xd2)]['onText'](/\/status/,async _0x38ab31=>{const _0x162458=_0x14bd5a,_0x24f9e7=_0x38ab31[_0x162458(0x10e)]['id'],_0x2635d0=_0x38ab31[_0x162458(0x181)]?.['id']['toString']();if(!_0x2635d0)return;try{const _0x414b87=await database_1[_0x162458(0x12d)][_0x162458(0xe4)][_0x162458(0xb6)]({'where':{'telegramId':_0x2635d0},'include':{'shop':!![]}});if(!_0x414b87){await this[_0x162458(0xd2)]?.[_0x162458(0xfb)](_0x24f9e7,_0x162458(0x166)+_0x162458(0x12f));return;}if(!_0x414b87['isVerified']||!_0x414b87[_0x162458(0x152)]||!_0x414b87[_0x162458(0x169)]){await this[_0x162458(0xd2)]?.[_0x162458(0xfb)](_0x24f9e7,_0x162458(0x165)+_0x162458(0x18e));return;}await this[_0x162458(0xd2)]?.['sendMessage'](_0x24f9e7,_0x162458(0x110)+(_0x162458(0x19b)+_0x414b87[_0x162458(0x169)][_0x162458(0x11d)]+'*\x0a')+(_0x162458(0xc6)+_0x414b87[_0x162458(0x169)][_0x162458(0x1a2)]+'`\x0a')+('üìÖ\x20Connection\x20date:\x20'+_0x414b87[_0x162458(0x123)][_0x162458(0x187)](_0x162458(0x193))+'\x0a\x0a')+_0x162458(0x12c)+_0x162458(0xfd)+_0x162458(0x119),{'parse_mode':_0x162458(0x162)});}catch(_0x549d53){console[_0x162458(0x195)](_0x162458(0xd3),_0x549d53),await this['bot']?.[_0x162458(0xfb)](_0x24f9e7,_0x162458(0xe8));}}),this[_0x14bd5a(0xd2)]['onText'](/\/debug/,async _0x529bc0=>{const _0x544248=_0x14bd5a,_0x17dd65=_0x529bc0[_0x544248(0x10e)]['id'],_0x88067f=_0x529bc0[_0x544248(0x181)]?.['id'][_0x544248(0x1a1)]();if(!_0x88067f)return;try{const _0x6708e9=await database_1[_0x544248(0x12d)][_0x544248(0xe4)][_0x544248(0xb6)]({'where':{'telegramId':_0x88067f},'include':{'shop':!![]}});let _0x4fe52e=_0x544248(0xbb);_0x4fe52e+=_0x544248(0x19d)+_0x88067f+'`\x0a\x0a',_0x6708e9?.[_0x544248(0x114)]&&_0x6708e9[_0x544248(0x169)]?(_0x4fe52e+=_0x544248(0x189),_0x4fe52e+=_0x544248(0xcc)+_0x6708e9[_0x544248(0x169)][_0x544248(0x11d)]+'*\x0a',_0x4fe52e+=_0x544248(0x121)+_0x6708e9['shop'][_0x544248(0x1a2)]+'`\x0a',_0x4fe52e+=_0x544248(0x164)+_0x6708e9[_0x544248(0x169)]['status']+'\x0a\x0a'):_0x4fe52e+=_0x544248(0x18d),_0x4fe52e+=_0x544248(0xbf),await this[_0x544248(0xd2)]?.['sendMessage'](_0x17dd65,_0x4fe52e,{'parse_mode':_0x544248(0x162)});}catch(_0x1eab80){console[_0x544248(0x195)](_0x544248(0x185),_0x1eab80),await this[_0x544248(0xd2)]?.[_0x544248(0xfb)](_0x17dd65,'‚ùå\x20Error\x20getting\x20debug\x20information.');}}),this['bot']['on'](_0x14bd5a(0x1af),async _0xc944ab=>{const _0x34eeb2=_0x14bd5a;if(_0xc944ab[_0x34eeb2(0xea)]?.[_0x34eeb2(0x12e)]('/'))return;const _0x217304=_0xc944ab[_0x34eeb2(0x10e)]['id'],_0x5a8c79=_0xc944ab['from']?.['id'][_0x34eeb2(0x1a1)](),_0x58f126=_0xc944ab[_0x34eeb2(0xea)]?.[_0x34eeb2(0x171)]();if(!_0x5a8c79||!_0x58f126)return;try{const _0x5c7935=await database_1['default'][_0x34eeb2(0xe4)][_0x34eeb2(0xb6)]({'where':{'telegramId':_0x5a8c79},'include':{'shop':!![]}});if(!_0x5c7935){await this[_0x34eeb2(0xd2)]?.[_0x34eeb2(0xfb)](_0x217304,_0x34eeb2(0xac));return;}if(_0x5c7935[_0x34eeb2(0x114)]&&_0x5c7935[_0x34eeb2(0x152)]&&_0x5c7935['shop']){await this['bot']?.['sendMessage'](_0x217304,_0x34eeb2(0xf3)+_0x5c7935[_0x34eeb2(0x169)][_0x34eeb2(0x11d)]+_0x34eeb2(0xdb)+_0x34eeb2(0x170),{'parse_mode':'Markdown'});return;}const _0x22119b=_0x58f126['split'](/\s+/);if(_0x22119b['length']!==0x2){await this[_0x34eeb2(0xd2)]?.['sendMessage'](_0x217304,_0x34eeb2(0x10a)+_0x34eeb2(0x186)+_0x34eeb2(0x1a7)+'`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a'+(_0x34eeb2(0x138)+_0x22119b[_0x34eeb2(0x16c)]+_0x34eeb2(0x100)+_0x22119b['map'](_0x51c24d=>'`'+_0x51c24d+'`')['join'](',\x20')),{'parse_mode':_0x34eeb2(0x162)});return;}const [_0x5425b5,_0x2b601f]=_0x22119b;console[_0x34eeb2(0x17e)](_0x34eeb2(0xc8)+_0x5a8c79+_0x34eeb2(0xb3)+_0x5425b5+_0x34eeb2(0x11b)+_0x2b601f['substring'](0x0,0xa)+_0x34eeb2(0x13b)),await this[_0x34eeb2(0xd1)](_0x217304,_0x5a8c79,_0x5425b5,_0x2b601f);}catch(_0x431372){console[_0x34eeb2(0x195)](_0x34eeb2(0x179),_0x431372),await this[_0x34eeb2(0xd2)]?.[_0x34eeb2(0xfb)](_0x217304,_0x34eeb2(0xe8));}}),this[_0x14bd5a(0xd2)]['on'](_0x14bd5a(0x195),_0x33a3e7=>{const _0x772e7e=_0x14bd5a;console[_0x772e7e(0x195)](_0x772e7e(0xdc),_0x33a3e7);}),this['bot']['on'](_0x14bd5a(0xd8),_0x100dfa=>{const _0x27de16=_0x14bd5a;console[_0x27de16(0x195)](_0x27de16(0xe7),_0x100dfa);});}async['handleSingleLineVerification'](_0x3688cf,_0x42404e,_0x202b3,_0x45fdcf){const _0xe294b4=a80_0x422b4b;try{console[_0xe294b4(0x17e)](_0xe294b4(0xc8)+_0x42404e+_0xe294b4(0xb3)+_0x202b3+_0xe294b4(0x11b)+_0x45fdcf[_0xe294b4(0xb9)](0x0,0xa)+_0xe294b4(0x13b));if(!_0x202b3||_0x202b3[_0xe294b4(0x16c)]<0x3||_0x202b3['length']>0x32||!/^[a-zA-Z0-9_]+$/[_0xe294b4(0xdd)](_0x202b3)){await this[_0xe294b4(0xd2)]?.[_0xe294b4(0xfb)](_0x3688cf,_0xe294b4(0xe0)+_0x202b3+_0xe294b4(0x196)+_0xe294b4(0x11f),{'parse_mode':_0xe294b4(0x162)});return;}if(!_0x45fdcf||!_0x45fdcf[_0xe294b4(0x12e)](_0xe294b4(0xeb))&&!_0x45fdcf[_0xe294b4(0x12e)](_0xe294b4(0x14b))){await this['bot']?.[_0xe294b4(0xfb)](_0x3688cf,'‚ùå\x20Invalid\x20API\x20key\x20format.\x0a\x0a'+_0xe294b4(0xf9),{'parse_mode':_0xe294b4(0x162)});return;}const _0x45d49a=await database_1[_0xe294b4(0x12d)][_0xe294b4(0x169)]['findUnique']({'where':{'username':_0x202b3},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x45d49a){const _0x24977f=_0xe294b4(0x133)+_0x202b3+_0xe294b4(0x14e)+_0xe294b4(0x188)+'Make\x20sure\x20you\x20have\x20the\x20correct\x20username\x20from\x20your\x20account.';await this[_0xe294b4(0xd2)]?.[_0xe294b4(0xfb)](_0x3688cf,_0x24977f,{'parse_mode':_0xe294b4(0x162)});return;}if(_0x45d49a[_0xe294b4(0xe2)]!=='ACTIVE'){await this[_0xe294b4(0xd2)]?.[_0xe294b4(0xfb)](_0x3688cf,'‚ùå\x20Shop\x20`'+_0x202b3+_0xe294b4(0x16e)+_0xe294b4(0xcd),{'parse_mode':'Markdown'});return;}if(_0x45d49a['publicKey']!==_0x45fdcf&&_0x45d49a[_0xe294b4(0x158)]!==_0x45fdcf){await this['bot']?.[_0xe294b4(0xfb)](_0x3688cf,_0xe294b4(0x108)+_0x202b3+'`.\x0a\x0a'+'Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a'+_0xe294b4(0x14a),{'parse_mode':'Markdown'});return;}const _0x1cf92d=await database_1[_0xe294b4(0x12d)][_0xe294b4(0xe4)][_0xe294b4(0x146)]({'where':{'shopId':_0x45d49a['id'],'isVerified':!![]}});if(_0x1cf92d>=0x5){await this['bot']?.[_0xe294b4(0xfb)](_0x3688cf,_0xe294b4(0xf8)+_0x202b3+'`.\x0a\x0a'+_0xe294b4(0x154),{'parse_mode':_0xe294b4(0x162)});return;}await database_1[_0xe294b4(0x12d)]['telegramUser'][_0xe294b4(0xfa)]({'where':{'telegramId':_0x42404e},'data':{'shopId':_0x45d49a['id'],'isVerified':!![]}}),await this[_0xe294b4(0xd2)]?.['sendMessage'](_0x3688cf,_0xe294b4(0x142)+_0xe294b4(0x159)+(_0xe294b4(0xc3)+_0x45d49a[_0xe294b4(0x11d)]+'*\x0a')+(_0xe294b4(0xc6)+_0x45d49a[_0xe294b4(0x1a2)]+_0xe294b4(0x196))+_0xe294b4(0x15e)+_0xe294b4(0x17d)+_0xe294b4(0x155)+'‚Ä¢\x20Payouts\x0a'+_0xe294b4(0xab)+'Commands:\x0a'+_0xe294b4(0x1ae)+_0xe294b4(0x119),{'parse_mode':_0xe294b4(0x162)}),console[_0xe294b4(0x17e)](_0xe294b4(0x13d)+_0x42404e+_0xe294b4(0xb7)+_0x45d49a[_0xe294b4(0x1a2)]+_0xe294b4(0x1ad));}catch(_0x2ed584){console['error'](_0xe294b4(0x1a4),_0x2ed584),await this[_0xe294b4(0xd2)]?.[_0xe294b4(0xfb)](_0x3688cf,'‚ùå\x20An\x20error\x20occurred\x20while\x20verifying\x20data.');}}async[a80_0x422b4b(0xd9)](_0x2785ce,_0x4a1318,_0x19e205){const _0xcc5007=a80_0x422b4b;if(!this[_0xcc5007(0xd2)]){console[_0xcc5007(0xfe)](_0xcc5007(0x183));return;}try{const _0x4ebe14=await database_1[_0xcc5007(0x12d)][_0xcc5007(0xe4)][_0xcc5007(0xc1)]({'where':{'shopId':_0x2785ce,'isVerified':!![]}});if(_0x4ebe14['length']===0x0){console['log']('No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20'+_0x2785ce);return;}const _0x6c381e=_0x4ebe14[_0xcc5007(0x15a)](async _0x2d541d=>{const _0x4d1c55=_0xcc5007;try{await this['bot']?.[_0x4d1c55(0xfb)](_0x2d541d['telegramId'],_0x4a1318,_0x19e205),console['log'](_0x4d1c55(0xaf)+_0x2d541d['telegramId']);}catch(_0x25dd4f){console['error'](_0x4d1c55(0x101)+_0x2d541d[_0x4d1c55(0x135)]+':',_0x25dd4f),_0x25dd4f instanceof Error&&(_0x25dd4f['message'][_0x4d1c55(0x17c)](_0x4d1c55(0x156))||_0x25dd4f[_0x4d1c55(0x1af)][_0x4d1c55(0x17c)](_0x4d1c55(0x105))||_0x25dd4f['message'][_0x4d1c55(0x17c)](_0x4d1c55(0x168)))&&(await database_1['default'][_0x4d1c55(0xe4)][_0x4d1c55(0xfa)]({'where':{'id':_0x2d541d['id']},'data':{'isVerified':![]}}),console[_0x4d1c55(0x17e)](_0x4d1c55(0xff)+_0x2d541d[_0x4d1c55(0x135)]+'\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure'));}});await Promise['allSettled'](_0x6c381e);}catch(_0x1849d1){console['error'](_0xcc5007(0x1aa),_0x1849d1);}}async[a80_0x422b4b(0x126)](_0x55393,_0xfca99e,_0x53a1bf){const _0x4287c4=a80_0x422b4b,_0x4746fb={'created':'üÜï','paid':'‚úÖ','failed':'‚ùå','expired':'‚è∞','refund':'üîÑ','chargeback':'‚ö†Ô∏è','processing':'‚öôÔ∏è'},_0x532f99={'created':'New\x20payment\x20created','paid':_0x4287c4(0x180),'failed':_0x4287c4(0xfc),'expired':_0x4287c4(0x163),'refund':_0x4287c4(0x148),'chargeback':_0x4287c4(0x14d),'processing':_0x4287c4(0xba)},_0x2a9a18=_0x4746fb[_0x53a1bf],_0x517ab0=_0x532f99[_0x53a1bf],_0x52ef2f=(0x0,gateway_1[_0x4287c4(0x11c)])(_0xfca99e[_0x4287c4(0x13a)]);console[_0x4287c4(0x17e)](_0x4287c4(0x13c)+_0xfca99e[_0x4287c4(0x13a)]+_0x4287c4(0xd0)+_0x52ef2f+'\x22');let _0x3bd59d=_0x2a9a18+'\x20*'+_0x517ab0+'*\x0a\x0a'+(_0x4287c4(0x12a)+_0xfca99e['amount']+'\x20'+_0xfca99e[_0x4287c4(0xf4)]+'*\x0a')+('üìù\x20Order\x20ID:\x20`'+(_0xfca99e[_0x4287c4(0x115)]||_0xfca99e['id'])+'`\x0a')+(_0x4287c4(0xde)+_0xfca99e['id']+'`\x0a')+(_0x4287c4(0x125)+_0x52ef2f+'`\x0a')+(_0x4287c4(0x10c)+new Date(_0xfca99e[_0x4287c4(0x117)])['toLocaleString'](_0x4287c4(0x193))+'\x0a');if(_0xfca99e[_0x4287c4(0x120)]||_0xfca99e[_0x4287c4(0xee)]||_0xfca99e[_0x4287c4(0x17b)]||_0xfca99e[_0x4287c4(0x124)]||_0xfca99e[_0x4287c4(0xbd)]){_0x3bd59d+=_0x4287c4(0x113);_0xfca99e[_0x4287c4(0x120)]&&(_0x3bd59d+=_0x4287c4(0xd5)+_0xfca99e[_0x4287c4(0x120)]+'`\x0a');_0xfca99e['customerEmail']&&(_0x3bd59d+=_0x4287c4(0xe6)+_0xfca99e[_0x4287c4(0xee)]+'`\x0a');_0xfca99e['remitterIban']&&(_0x3bd59d+=_0x4287c4(0x198)+_0xfca99e['remitterIban']+'`\x0a');_0xfca99e['customerIp']&&(_0x3bd59d+='üåê\x20IP:\x20`'+_0xfca99e[_0x4287c4(0x124)]+'`\x0a');if(_0xfca99e[_0x4287c4(0xbd)]){const _0x4587b6=_0xfca99e[_0x4287c4(0xbd)][_0x4287c4(0x16c)]>0x32?_0xfca99e[_0x4287c4(0xbd)]['substring'](0x0,0x32)+_0x4287c4(0xc9):_0xfca99e['customerUa'];_0x3bd59d+=_0x4287c4(0xf5)+_0x4587b6+'`\x0a';}}_0x53a1bf===_0x4287c4(0x10b)&&_0xfca99e['chargebackAmount']&&(_0x3bd59d+=_0x4287c4(0x199)+_0xfca99e['chargebackAmount']+'\x20USDT*\x0a'),_0x53a1bf===_0x4287c4(0xc5)&&(_0x3bd59d+=_0x4287c4(0x104)),_0xfca99e[_0x4287c4(0x136)]&&(_0x3bd59d+=_0x4287c4(0xb8)+_0xfca99e['adminNotes']+'\x0a'),await this[_0x4287c4(0xd9)](_0x55393,_0x3bd59d,{'parse_mode':_0x4287c4(0x162)});}async[a80_0x422b4b(0x13f)](_0x436f2a,_0x5662d3){const _0x256bd6=a80_0x422b4b,_0x501437=new Date(_0x5662d3[_0x256bd6(0x117)])[_0x256bd6(0x109)](_0x256bd6(0x193),{'year':_0x256bd6(0xcf),'month':_0x256bd6(0x1a0),'day':'2-digit','hour':'2-digit','minute':_0x256bd6(0x1a0),'second':_0x256bd6(0x1a0)}),_0x2c5f0f=_0x256bd6(0xce)+(_0x256bd6(0x176)+_0x501437+'\x0a')+(_0x256bd6(0x127)+_0x5662d3[_0x256bd6(0x144)]+_0x256bd6(0x143))+(_0x256bd6(0x112)+(_0x5662d3[_0x256bd6(0xef)]||_0x256bd6(0x172))+'\x0a')+(_0x256bd6(0x167)+(_0x5662d3[_0x256bd6(0x140)]||_0x256bd6(0x172))+'\x0a')+(_0x256bd6(0x19f)+(_0x5662d3['wallet']||_0x256bd6(0x172))+'`\x0a')+(_0x5662d3[_0x256bd6(0x145)]?_0x256bd6(0xf7)+_0x5662d3[_0x256bd6(0x145)]+'`':'üîó\x20*Transaction\x20Link:*\x20Pending');await this[_0x256bd6(0xd9)](_0x436f2a,_0x2c5f0f,{'parse_mode':_0x256bd6(0x162)});}async[a80_0x422b4b(0x111)](_0x47b5dd,_0xda7094){const _0x5769af=a80_0x422b4b;try{const _0x38da55=await database_1['default']['shopSettings'][_0x5769af(0xb6)]({'where':{'shopId':_0x47b5dd},'select':{'notificationLogin':!![]}});if(!_0x38da55?.[_0x5769af(0x1ab)]){console['log'](_0x5769af(0x192)+_0x47b5dd);return;}const _0x17451d=_0xda7094['success']?'üîê':'üö®',_0x51b9bd=_0xda7094[_0x5769af(0x173)]?_0x5769af(0xb0):_0x5769af(0x1a9);let _0x23b640=_0x17451d+'\x20*'+_0x51b9bd+_0x5769af(0x14f)+(_0x5769af(0xc6)+_0xda7094['username']+'`\x0a')+(_0x5769af(0x17f)+_0xda7094[_0x5769af(0x116)]['toLocaleString']('en-US')+'\x0a');_0xda7094[_0x5769af(0xed)]&&(_0x23b640+=_0x5769af(0x103)+_0xda7094[_0x5769af(0xed)]+'`\x0a');_0xda7094['geo']&&(_0x23b640+='üåç\x20Country:\x20'+_0xda7094[_0x5769af(0xda)]+'\x0a');if(_0xda7094[_0x5769af(0xc4)]){const _0x295028=_0xda7094[_0x5769af(0xc4)][_0x5769af(0x16c)]>0x32?_0xda7094[_0x5769af(0xc4)]['substring'](0x0,0x32)+_0x5769af(0xc9):_0xda7094[_0x5769af(0xc4)];_0x23b640+=_0x5769af(0xf5)+_0x295028+'`\x0a';}!_0xda7094[_0x5769af(0x173)]&&(_0x23b640+=_0x5769af(0x157)),await this['sendShopNotification'](_0x47b5dd,_0x23b640,{'parse_mode':_0x5769af(0x162)}),console[_0x5769af(0x17e)]('‚úÖ\x20Login\x20notification\x20sent\x20for\x20shop\x20'+_0x47b5dd+':\x20'+(_0xda7094[_0x5769af(0x173)]?_0x5769af(0x173):'failed'));}catch(_0xce2d0e){console['error']('Failed\x20to\x20send\x20login\x20notification:',_0xce2d0e);}}async[a80_0x422b4b(0x1a6)](_0x4d5a01,_0x1eeb77){const _0x2ddc46=a80_0x422b4b;try{const _0x2b6c22=await database_1['default']['shopSettings'][_0x2ddc46(0xb6)]({'where':{'shopId':_0x4d5a01},'select':{'notificationApiError':!![]}});if(!_0x2b6c22?.[_0x2ddc46(0x151)]){console[_0x2ddc46(0x17e)](_0x2ddc46(0x18c)+_0x4d5a01);return;}let _0x5a067d=_0x2ddc46(0xc7)+(_0x2ddc46(0xad)+_0x1eeb77['method']+'\x20'+_0x1eeb77[_0x2ddc46(0x153)]+'`\x0a')+('üìÖ\x20Time:\x20'+_0x1eeb77[_0x2ddc46(0x116)][_0x2ddc46(0x109)](_0x2ddc46(0x193))+'\x0a');_0x1eeb77['statusCode']&&(_0x5a067d+=_0x2ddc46(0xf0)+_0x1eeb77[_0x2ddc46(0xbc)]+'`\x0a'),_0x5a067d+='‚ùå\x20Error:\x20`'+_0x1eeb77['errorMessage']+'`\x0a',_0x1eeb77[_0x2ddc46(0xb1)]&&(_0x5a067d+=_0x2ddc46(0x129)+_0x1eeb77[_0x2ddc46(0xb1)]+'`\x0a'),_0x5a067d+=_0x2ddc46(0xe9),await this[_0x2ddc46(0xd9)](_0x4d5a01,_0x5a067d,{'parse_mode':_0x2ddc46(0x162)}),console[_0x2ddc46(0x17e)](_0x2ddc46(0x18a)+_0x4d5a01+':\x20'+_0x1eeb77['endpoint']);}catch(_0x4a4b84){console[_0x2ddc46(0x195)](_0x2ddc46(0xd4),_0x4a4b84);}}async[a80_0x422b4b(0x131)](_0x1bd75e,_0xea35a8,_0x282269){const _0x52e2b3=a80_0x422b4b;let _0x6c0cf8=_0x52e2b3(0xbe)+_0xea35a8+_0x52e2b3(0x14f);for(const [_0xcd331d,_0x3f9c0f]of Object['entries'](_0x282269)){_0x3f9c0f!==null&&_0x3f9c0f!==undefined&&(_0x6c0cf8+=_0xcd331d+_0x52e2b3(0x139)+_0x3f9c0f+'`\x0a');}await this[_0x52e2b3(0xd9)](_0x1bd75e,_0x6c0cf8,{'parse_mode':'Markdown'});}async['sendNotificationToAll'](_0x4022aa){const _0x9e6ec=a80_0x422b4b;try{console['log'](_0x9e6ec(0xcb)+_0x4022aa[_0x9e6ec(0xb9)](0x0,0x32)+_0x9e6ec(0xc9));const _0x2014b4=await database_1[_0x9e6ec(0x12d)]['telegramUser'][_0x9e6ec(0xc1)]({'select':{'telegramId':!![]}});if(_0x2014b4[_0x9e6ec(0x16c)]===0x0){console['log'](_0x9e6ec(0x1a3));return;}for(const _0x354ed5 of _0x2014b4){try{await this['bot']?.['sendMessage'](_0x354ed5[_0x9e6ec(0x135)],_0x4022aa,{'parse_mode':_0x9e6ec(0x162)});}catch(_0x1cf8d6){console['error'](_0x9e6ec(0x12b)+_0x354ed5[_0x9e6ec(0x135)]+':',_0x1cf8d6);}}console[_0x9e6ec(0x17e)](_0x9e6ec(0x16b)+_0x2014b4[_0x9e6ec(0x16c)]+_0x9e6ec(0x1a5));}catch(_0x3e19b6){console['error'](_0x9e6ec(0x16f),_0x3e19b6);}}[a80_0x422b4b(0x150)](){const _0x6bf65=a80_0x422b4b;return{'isActive':!!this[_0x6bf65(0xd2)],'username':this[_0x6bf65(0x184)]};}async[a80_0x422b4b(0x118)](_0x8d6b43,_0x4a149d,_0x529ac6,_0x5cdef2){const _0x22b9bd=a80_0x422b4b;try{if(!this[_0x22b9bd(0xd2)])return console[_0x22b9bd(0x195)]('‚ùå\x20Telegram\x20bot\x20not\x20initialized'),![];const _0x129ebd=await database_1[_0x22b9bd(0x12d)][_0x22b9bd(0xe4)][_0x22b9bd(0xc1)]({'where':{'shopId':_0x8d6b43,'isVerified':!![]},'select':{'telegramId':!![]}});if(_0x129ebd[_0x22b9bd(0x16c)]===0x0)return console[_0x22b9bd(0x195)](_0x22b9bd(0xd6)+_0x8d6b43),![];let _0x3887e0=0x0;for(const _0x3459e6 of _0x129ebd){try{await this[_0x22b9bd(0xd2)][_0x22b9bd(0xe1)](_0x3459e6[_0x22b9bd(0x135)],_0x4a149d,{},{'filename':_0x529ac6,'contentType':_0x529ac6[_0x22b9bd(0x132)]('.png')?'image/png':_0x529ac6[_0x22b9bd(0x132)](_0x22b9bd(0x137))||_0x529ac6[_0x22b9bd(0x132)](_0x22b9bd(0x16d))?_0x22b9bd(0xd7):_0x529ac6[_0x22b9bd(0x132)](_0x22b9bd(0x17a))?_0x22b9bd(0x15d):_0x22b9bd(0x161)}),_0x5cdef2&&await this[_0x22b9bd(0xd2)][_0x22b9bd(0xfb)](_0x3459e6['telegramId'],_0x5cdef2),_0x3887e0++;}catch(_0x2d2f68){console[_0x22b9bd(0x195)](_0x22b9bd(0x191)+_0x3459e6[_0x22b9bd(0x135)]+':',_0x2d2f68);}}return console[_0x22b9bd(0x17e)]('‚úÖ\x20File\x20sent\x20to\x20'+_0x3887e0+'/'+_0x129ebd[_0x22b9bd(0x16c)]+'\x20users\x20of\x20shop\x20'+_0x8d6b43+':\x20'+_0x529ac6),_0x3887e0>0x0;}catch(_0x1918f8){return console[_0x22b9bd(0x195)](_0x22b9bd(0xf6),_0x1918f8),![];}}async[a80_0x422b4b(0x194)](_0x425217,_0x41c74e){const _0x2c057a=a80_0x422b4b;try{if(!this[_0x2c057a(0xd2)])return console[_0x2c057a(0x195)](_0x2c057a(0xaa)),![];return await this[_0x2c057a(0xd2)][_0x2c057a(0xfb)](_0x425217,_0x41c74e),console[_0x2c057a(0x17e)](_0x2c057a(0xe3)+_0x425217),!![];}catch(_0x1fdf3a){return console[_0x2c057a(0x195)]('‚ùå\x20Error\x20sending\x20direct\x20message:',_0x1fdf3a),![];}}async[a80_0x422b4b(0xf1)](_0x425c9c,_0x33f015,_0x5c1b18,_0x2ea5c6){const _0x32d0aa=a80_0x422b4b;try{if(!this[_0x32d0aa(0xd2)])return console['error'](_0x32d0aa(0xaa)),![];return await this[_0x32d0aa(0xd2)][_0x32d0aa(0xe1)](_0x425c9c,_0x33f015,{},{'filename':_0x5c1b18,'contentType':_0x5c1b18[_0x32d0aa(0x132)]('.png')?_0x32d0aa(0xb4):_0x5c1b18[_0x32d0aa(0x132)](_0x32d0aa(0x137))||_0x5c1b18['endsWith'](_0x32d0aa(0x16d))?_0x32d0aa(0xd7):_0x5c1b18['endsWith']('.pdf')?_0x32d0aa(0x15d):_0x32d0aa(0x161)}),_0x2ea5c6&&await this['bot'][_0x32d0aa(0xfb)](_0x425c9c,_0x2ea5c6),console['log'](_0x32d0aa(0x1ac)+_0x425c9c+':\x20'+_0x5c1b18),!![];}catch(_0x2df879){return console[_0x32d0aa(0x195)]('‚ùå\x20Error\x20sending\x20file\x20to\x20chat:',_0x2df879),![];}}[a80_0x422b4b(0x134)](){const _0x9aa656=a80_0x422b4b;this[_0x9aa656(0xd2)]&&(this[_0x9aa656(0xd2)][_0x9aa656(0xe5)](),this[_0x9aa656(0xd2)]=null,console[_0x9aa656(0x17e)](_0x9aa656(0x106)));}}exports[a80_0x422b4b(0x141)]=TelegramBotService,exports[a80_0x422b4b(0x102)]=new TelegramBotService();