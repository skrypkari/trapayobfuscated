'use strict';function a54_0x52df(){const _0x45d5af=['Contact\x20administrator.','entries','findFirst','toLocaleDateString','💰\x20Amount:\x20*','3836CICXlR','🏪\x20Gateway:\x20`','txid','../config/database','•\x20Important\x20events\x0a\x0a','API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','1188948eazKVX','allSettled','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','❌\x20Invalid\x20API\x20key\x20format.\x0a\x0a','log','2670910zOcNBa','user\x20is\x20deactivated','stopBot','📝\x20Notes:\x20','✅\x20Notification\x20sent\x20to\x20Telegram\x20user\x20','🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20','createdAt','ipAddress','gateway','notificationLogin','blocked','48udgtrl','findUnique','🔔\x20You\x20receive\x20notifications\x20about:\x0a','handleSingleLineVerification','shopSettings','Check\x20spelling\x20and\x20try\x20again.','sendMessage','defineProperty','shop','sk_','\x20\x20\x20Username:\x20`','📧\x20Email:\x20`',':\x20username=\x22','You\x20are\x20already\x20connected\x20to\x20shop:\x20*','🛑\x20Telegram\x20bot\x20stopped','🔌\x20User\x20','...\x22','sendLoginNotification','🔄\x20Reset\x20incomplete\x20verification\x20for\x20user\x20','Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a','❌\x20Error\x20getting\x20debug\x20information.','sendShopNotification','🌐\x20IP:\x20`','To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a','update','Error\x20in\x20handleSingleLineVerification:','`\x20not\x20found.\x0a\x0a','forEach','isVerified',':\x20`','`\x0a\x0a','Use\x20/start\x20to\x20connect.','/disconnect\x20-\x20disconnect\x20from\x20notifications','text','63258XGPvuk','includes','.\x20*','44veFabY','📊\x20*Connection\x20Status*\x0a\x0a','❌\x20An\x20error\x20occurred\x20while\x20verifying\x20data.','onText','✅\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*','errorMessage','✅\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a','🆔\x20Payment\x20ID:\x20`','273492OVodyT','✅\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20','chat\x20not\x20found','customerEmail','❌\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20','findMany','adminNotes','You\x20sent\x20','TELEGRAM_BOT_TOKEN','New\x20payout\x20created','Payment\x20expired','10VDnwyQ','env','length','test','📅\x20Time:\x20','Example:\x0a','map','\x20USD*\x0a','🆔\x20Payout\x20ID:\x20`','en-US','📝\x20Format:\x20`username\x20api_key`\x0a\x0a','sendApiErrorNotification','customerName','🏪\x20Available\x20shops\x20in\x20system:\x0a','split','customerUa','🆔\x20Request\x20ID:\x20`','🏦\x20Method:\x20`','message','🌐\x20IP\x20address:\x20`','*.\x0a\x0a','Available\x20usernames:\x0a','\x0aCheck\x20spelling\x20and\x20try\x20again.','telegramId','Successful\x20login','🔗\x20TXID:\x20`','toLocaleString','Payment\x20successfully\x20paid','216165OpTCyz','\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure','sendPayoutNotification','365212PSVTgL','botUsername','Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`','chat','📅\x20Date:\x20','last_name','amount','toString','📅\x20Connection\x20date:\x20','sendPaymentNotification','\x22\x20->\x20display\x20\x22','Payment\x20refund','`\x20is\x20inactive.\x0a\x0a','...','orderId','📱\x20Login\x20notifications\x20disabled\x20for\x20shop\x20','❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','remitterIban','chargebackAmount','Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.','default','/status\x20-\x20check\x20connection\x20status\x0a','substring','•\x20Payment\x20status\x20changes\x0a','status','💻\x20Browser:\x20`','•\x20Payouts\x0a','New\x20payment\x20created','•\x20New\x20payments\x0a','❌\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a','initializeBot','\x0a👤\x20*Customer\x20Information:*\x0a','\x20verified\x20for\x20shop\x20','Markdown','...`\x0a\x0a','✅\x20Telegram\x20user\x20','*\x0a\x0a','ACTIVE','telegramBotService','7NUmbuo','customerIp','username','telegramUser','User\x20','✅\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*','❌\x20Shop\x20with\x20username\x20`','📱\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20','Payout\x20rejected','Error\x20handling\x20/disconnect\x20command:','join','❗️\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!','🔔\x20*','from','name','✅\x20Welcome\x20back!\x0a\x0a','❌\x20Failed\x20to\x20initialize\x20Telegram\x20bot:','❌\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a','📱\x20Your\x20Telegram\x20ID:\x20`','startsWith','\x20parts:\x20','\x20(@','Payment\x20chargeback','trim','Error\x20sending\x20shop\x20notification:','Error\x20handling\x20/status\x20command:','Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).','TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables','🔍\x20*Debug\x20Information*\x0a\x0a','Error\x20handling\x20/start\x20command:','getGatewayDisplayNameForTelegram','__esModule','notificationApiError','🔗\x20Endpoint:\x20`','polling_error','📱\x20Telegram\x20notification:\x20gateway\x20\x22','__importDefault','../types/gateway','\x0a💡\x20Check\x20your\x20request\x20or\x20contact\x20support.','endpoint','requestId','To\x20reconnect,\x20use\x20the\x20/start\x20command','✅\x20Telegram\x20bot\x20@','botToken','statusCode','error','❌\x20Error:\x20`','processing','🤖\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a','•\x20Payouts\x0a\x0a','publicKey','❌\x20API\x20key\x20does\x20not\x20match\x20shop\x20`','create','11KCYnGw','🏦\x20IBAN:\x20`','userAgent','📛\x20Name:\x20`','Commands:\x0a','Failed\x20to\x20send\x20API\x20error\x20notification:','setupBotHandlers','📱\x20Shop:\x20*','•\x20`','`.\x0a\x0a','shopId','method','\x0a⚠️\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!','warn','TelegramBotService','❌\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.','success','Telegram\x20bot\x20polling\x20error:','Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.','🔔\x20Notifications\x20are\x20active\x0a\x0a','\x20disconnected\x20from\x20shop\x20','bot','❌\x20Invalid\x20username\x20format:\x20`','Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification'];a54_0x52df=function(){return _0x45d5af;};return a54_0x52df();}function a54_0x55c7(_0x35fbd8,_0x4b7a6b){const _0x52df8e=a54_0x52df();return a54_0x55c7=function(_0x55c787,_0x752cea){_0x55c787=_0x55c787-0xea;let _0x16fa93=_0x52df8e[_0x55c787];return _0x16fa93;},a54_0x55c7(_0x35fbd8,_0x4b7a6b);}const a54_0x21f8b1=a54_0x55c7;(function(_0xcde991,_0x3eb358){const _0x1f4a46=a54_0x55c7,_0x218fd1=_0xcde991();while(!![]){try{const _0x252ff6=parseInt(_0x1f4a46(0xf5))/0x1*(-parseInt(_0x1f4a46(0x130))/0x2)+parseInt(_0x1f4a46(0x15f))/0x3+parseInt(_0x1f4a46(0x162))/0x4*(-parseInt(_0x1f4a46(0x143))/0x5)+-parseInt(_0x1f4a46(0x12d))/0x6*(-parseInt(_0x1f4a46(0x189))/0x7)+parseInt(_0x1f4a46(0x10b))/0x8*(parseInt(_0x1f4a46(0x138))/0x9)+parseInt(_0x1f4a46(0x100))/0xa+parseInt(_0x1f4a46(0x1be))/0xb*(-parseInt(_0x1f4a46(0xfb))/0xc);if(_0x252ff6===_0x3eb358)break;else _0x218fd1['push'](_0x218fd1['shift']());}catch(_0x5bee88){_0x218fd1['push'](_0x218fd1['shift']());}}}(a54_0x52df,0x28834));var __importDefault=this&&this[a54_0x21f8b1(0x1ad)]||function(_0x3c669){const _0x3a33f9=a54_0x21f8b1;return _0x3c669&&_0x3c669[_0x3a33f9(0x1a8)]?_0x3c669:{'default':_0x3c669};};Object[a54_0x21f8b1(0x112)](exports,a54_0x21f8b1(0x1a8),{'value':!![]}),exports[a54_0x21f8b1(0x188)]=exports[a54_0x21f8b1(0x1cc)]=void 0x0;const node_telegram_bot_api_1=__importDefault(require('node-telegram-bot-api')),database_1=__importDefault(require(a54_0x21f8b1(0xf8))),gateway_1=require(a54_0x21f8b1(0x1ae));class TelegramBotService{constructor(){const _0x2a72ae=a54_0x21f8b1;this['bot']=null,this[_0x2a72ae(0x1b4)]=process[_0x2a72ae(0x144)][_0x2a72ae(0x140)]||'',this[_0x2a72ae(0x163)]=process[_0x2a72ae(0x144)]['TELEGRAM_BOT_USERNAME']||'trapay_bot',this[_0x2a72ae(0x1b4)]?this[_0x2a72ae(0x180)]():console[_0x2a72ae(0x1cb)](_0x2a72ae(0x1a4));}[a54_0x21f8b1(0x180)](){const _0x3ff65c=a54_0x21f8b1;try{this['bot']=new node_telegram_bot_api_1[(_0x3ff65c(0x176))](this['botToken'],{'polling':!![]}),this[_0x3ff65c(0x1c4)](),console['log'](_0x3ff65c(0x1b3)+this['botUsername']+'\x20initialized\x20successfully');}catch(_0x5da752){console[_0x3ff65c(0x1b6)](_0x3ff65c(0x199),_0x5da752);}}['setupBotHandlers'](){const _0x37648f=a54_0x21f8b1;if(!this[_0x37648f(0xed)])return;this[_0x37648f(0xed)][_0x37648f(0x133)](/\/start/,async _0x2324cf=>{const _0x57b36c=_0x37648f,_0x392d0e=_0x2324cf['chat']['id'],_0x22d66a=_0x2324cf[_0x57b36c(0x196)]?.['id'][_0x57b36c(0x169)](),_0x22da4a=_0x2324cf[_0x57b36c(0x196)]?.['username'],_0x409999=_0x2324cf[_0x57b36c(0x196)]?.['first_name'],_0x58893e=_0x2324cf[_0x57b36c(0x196)]?.[_0x57b36c(0x167)];if(!_0x22d66a)return;try{let _0x4f844a=await database_1[_0x57b36c(0x176)][_0x57b36c(0x18c)][_0x57b36c(0x10c)]({'where':{'telegramId':_0x22d66a},'include':{'shop':!![]}});!_0x4f844a?(_0x4f844a=await database_1[_0x57b36c(0x176)]['telegramUser'][_0x57b36c(0x1bd)]({'data':{'telegramId':_0x22d66a,'username':_0x22da4a,'firstName':_0x409999,'lastName':_0x58893e,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console[_0x57b36c(0xff)]('📱\x20Created\x20new\x20Telegram\x20user:\x20'+_0x22d66a+_0x57b36c(0x19e)+_0x22da4a+')')):_0x4f844a=await database_1[_0x57b36c(0x176)]['telegramUser'][_0x57b36c(0x123)]({'where':{'telegramId':_0x22d66a},'data':{'username':_0x22da4a,'firstName':_0x409999,'lastName':_0x58893e},'include':{'shop':!![]}}),_0x4f844a[_0x57b36c(0x127)]&&_0x4f844a[_0x57b36c(0x1c8)]&&_0x4f844a[_0x57b36c(0x113)]?await this['bot']?.[_0x57b36c(0x111)](_0x392d0e,_0x57b36c(0x198)+(_0x57b36c(0x118)+_0x4f844a[_0x57b36c(0x113)][_0x57b36c(0x197)]+'*\x0a')+('Username:\x20`'+_0x4f844a[_0x57b36c(0x113)]['username']+_0x57b36c(0x129))+_0x57b36c(0x10d)+'•\x20New\x20payments\x0a'+_0x57b36c(0x179)+_0x57b36c(0x1ba)+'Commands:\x0a'+_0x57b36c(0x177)+_0x57b36c(0x12b),{'parse_mode':'Markdown'}):(_0x4f844a[_0x57b36c(0x1c8)]&&!_0x4f844a[_0x57b36c(0x127)]&&(await database_1[_0x57b36c(0x176)][_0x57b36c(0x18c)][_0x57b36c(0x123)]({'where':{'telegramId':_0x22d66a},'data':{'shopId':null,'isVerified':![]}}),console[_0x57b36c(0xff)](_0x57b36c(0x11d)+_0x22d66a)),await this[_0x57b36c(0xed)]?.['sendMessage'](_0x392d0e,_0x57b36c(0x1b9)+_0x57b36c(0x122)+_0x57b36c(0x14d)+_0x57b36c(0x148)+_0x57b36c(0xfd)+_0x57b36c(0x194),{'parse_mode':_0x57b36c(0x183)}));}catch(_0x4d4442){console[_0x57b36c(0x1b6)](_0x57b36c(0x1a6),_0x4d4442),await this[_0x57b36c(0xed)]?.[_0x57b36c(0x111)](_0x392d0e,_0x57b36c(0x172));}}),this[_0x37648f(0xed)]['onText'](/\/disconnect/,async _0x38287c=>{const _0x59ef20=_0x37648f,_0x1e378c=_0x38287c['chat']['id'],_0xdd519a=_0x38287c[_0x59ef20(0x196)]?.['id'][_0x59ef20(0x169)]();if(!_0xdd519a)return;try{const _0x57c199=await database_1['default']['telegramUser']['findUnique']({'where':{'telegramId':_0xdd519a},'include':{'shop':!![]}});if(!_0x57c199||!_0x57c199['isVerified']||!_0x57c199[_0x59ef20(0x1c8)]){await this[_0x59ef20(0xed)]?.[_0x59ef20(0x111)](_0x1e378c,_0x59ef20(0x1cd));return;}const _0x276e11=_0x57c199[_0x59ef20(0x113)]?.[_0x59ef20(0x197)]||'unknown\x20shop';await database_1['default'][_0x59ef20(0x18c)][_0x59ef20(0x123)]({'where':{'telegramId':_0xdd519a},'data':{'shopId':null,'isVerified':![]}}),console[_0x59ef20(0xff)](_0x59ef20(0x11a)+_0xdd519a+_0x59ef20(0xec)+_0x57c199[_0x59ef20(0x1c8)]),await this[_0x59ef20(0xed)]?.[_0x59ef20(0x111)](_0x1e378c,_0x59ef20(0x134)+_0x276e11+_0x59ef20(0x157)+_0x59ef20(0x1b2),{'parse_mode':_0x59ef20(0x183)});}catch(_0xc1b46b){console[_0x59ef20(0x1b6)](_0x59ef20(0x192),_0xc1b46b),await this[_0x59ef20(0xed)]?.[_0x59ef20(0x111)](_0x1e378c,'❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this[_0x37648f(0xed)]['onText'](/\/status/,async _0x3d5a5e=>{const _0x330d20=_0x37648f,_0x358d65=_0x3d5a5e[_0x330d20(0x165)]['id'],_0x156cd0=_0x3d5a5e[_0x330d20(0x196)]?.['id'][_0x330d20(0x169)]();if(!_0x156cd0)return;try{const _0x1c1802=await database_1[_0x330d20(0x176)][_0x330d20(0x18c)]['findUnique']({'where':{'telegramId':_0x156cd0},'include':{'shop':!![]}});if(!_0x1c1802){await this[_0x330d20(0xed)]?.[_0x330d20(0x111)](_0x358d65,_0x330d20(0x17f)+'Use\x20/start\x20to\x20begin.');return;}if(!_0x1c1802[_0x330d20(0x127)]||!_0x1c1802['shopId']||!_0x1c1802['shop']){await this[_0x330d20(0xed)]?.[_0x330d20(0x111)](_0x358d65,'❌\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a'+_0x330d20(0x12a));return;}await this['bot']?.['sendMessage'](_0x358d65,_0x330d20(0x131)+('✅\x20Connected\x20to\x20shop:\x20*'+_0x1c1802['shop'][_0x330d20(0x197)]+'*\x0a')+('👤\x20Username:\x20`'+_0x1c1802['shop'][_0x330d20(0x18b)]+'`\x0a')+(_0x330d20(0x16a)+_0x1c1802['updatedAt'][_0x330d20(0xf3)]('en-US')+'\x0a\x0a')+_0x330d20(0xeb)+_0x330d20(0x1c2)+'/disconnect\x20-\x20disconnect\x20from\x20notifications',{'parse_mode':'Markdown'});}catch(_0x13846f){console[_0x330d20(0x1b6)](_0x330d20(0x1a2),_0x13846f),await this[_0x330d20(0xed)]?.[_0x330d20(0x111)](_0x358d65,_0x330d20(0x172));}}),this[_0x37648f(0xed)]['onText'](/\/debug/,async _0x44f254=>{const _0x35ee04=_0x37648f,_0x3ee5ce=_0x44f254[_0x35ee04(0x165)]['id'],_0x1b274f=_0x44f254[_0x35ee04(0x196)]?.['id']['toString']();if(!_0x1b274f)return;try{const _0x1c6b81=await database_1['default'][_0x35ee04(0x113)][_0x35ee04(0x13d)]({'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![]},'take':0xa});let _0x3594c4=_0x35ee04(0x1a5);_0x3594c4+=_0x35ee04(0x19b)+_0x1b274f+_0x35ee04(0x129),_0x3594c4+=_0x35ee04(0x150),_0x1c6b81[_0x35ee04(0x126)]((_0x58e653,_0x1f1558)=>{const _0x18bc9c=_0x35ee04;_0x3594c4+=_0x1f1558+0x1+_0x18bc9c(0x12f)+_0x58e653['name']+'*\x0a',_0x3594c4+=_0x18bc9c(0x115)+_0x58e653[_0x18bc9c(0x18b)]+'`\x0a',_0x3594c4+='\x20\x20\x20Status:\x20'+_0x58e653[_0x18bc9c(0x17a)]+'\x0a',_0x3594c4+='\x20\x20\x20Public\x20Key:\x20`'+_0x58e653[_0x18bc9c(0x1bb)]['substring'](0x0,0xf)+_0x18bc9c(0x184);}),await this['bot']?.[_0x35ee04(0x111)](_0x3ee5ce,_0x3594c4,{'parse_mode':_0x35ee04(0x183)});}catch(_0x3bfcc8){console[_0x35ee04(0x1b6)]('Error\x20handling\x20/debug\x20command:',_0x3bfcc8),await this[_0x35ee04(0xed)]?.[_0x35ee04(0x111)](_0x3ee5ce,_0x35ee04(0x11f));}}),this[_0x37648f(0xed)]['on'](_0x37648f(0x155),async _0x4d56ea=>{const _0x20011b=_0x37648f;if(_0x4d56ea[_0x20011b(0x12c)]?.[_0x20011b(0x19c)]('/'))return;const _0x5e58a8=_0x4d56ea[_0x20011b(0x165)]['id'],_0x22eaee=_0x4d56ea[_0x20011b(0x196)]?.['id']['toString'](),_0x5842c8=_0x4d56ea[_0x20011b(0x12c)]?.[_0x20011b(0x1a0)]();if(!_0x22eaee||!_0x5842c8)return;try{const _0x32a6ad=await database_1[_0x20011b(0x176)]['telegramUser'][_0x20011b(0x10c)]({'where':{'telegramId':_0x22eaee},'include':{'shop':!![]}});if(!_0x32a6ad){await this['bot']?.[_0x20011b(0x111)](_0x5e58a8,'❌\x20Please\x20use\x20/start\x20command\x20first');return;}if(_0x32a6ad[_0x20011b(0x127)]&&_0x32a6ad['shopId']&&_0x32a6ad['shop']){await this[_0x20011b(0xed)]?.[_0x20011b(0x111)](_0x5e58a8,_0x20011b(0x18e)+_0x32a6ad[_0x20011b(0x113)][_0x20011b(0x197)]+_0x20011b(0x157)+_0x20011b(0x175),{'parse_mode':'Markdown'});return;}const _0x2c2612=_0x5842c8[_0x20011b(0x151)](/\s+/);if(_0x2c2612[_0x20011b(0x145)]!==0x2){await this[_0x20011b(0xed)]?.[_0x20011b(0x111)](_0x5e58a8,_0x20011b(0x19a)+_0x20011b(0x14d)+_0x20011b(0x148)+_0x20011b(0xfd)+(_0x20011b(0x13f)+_0x2c2612['length']+_0x20011b(0x19d)+_0x2c2612[_0x20011b(0x149)](_0x48c759=>'`'+_0x48c759+'`')[_0x20011b(0x193)](',\x20')),{'parse_mode':_0x20011b(0x183)});return;}const [_0x104eb1,_0x21f87f]=_0x2c2612;console[_0x20011b(0xff)](_0x20011b(0x105)+_0x22eaee+_0x20011b(0x117)+_0x104eb1+'\x22,\x20apiKey=\x22'+_0x21f87f['substring'](0x0,0xa)+_0x20011b(0x11b)),await this[_0x20011b(0x10e)](_0x5e58a8,_0x22eaee,_0x104eb1,_0x21f87f);}catch(_0x5616b8){console[_0x20011b(0x1b6)]('Error\x20handling\x20message:',_0x5616b8),await this['bot']?.[_0x20011b(0x111)](_0x5e58a8,_0x20011b(0x172));}}),this[_0x37648f(0xed)]['on'](_0x37648f(0x1b6),_0x3fc949=>{console['error']('Telegram\x20bot\x20error:',_0x3fc949);}),this[_0x37648f(0xed)]['on'](_0x37648f(0x1ab),_0xab210=>{const _0x2c5d9f=_0x37648f;console[_0x2c5d9f(0x1b6)](_0x2c5d9f(0x1cf),_0xab210);});}async[a54_0x21f8b1(0x10e)](_0x232d62,_0x3500c0,_0x343bc0,_0x1c5b05){const _0x526788=a54_0x21f8b1;try{console[_0x526788(0xff)](_0x526788(0x105)+_0x3500c0+':\x20username=\x22'+_0x343bc0+'\x22,\x20apiKey=\x22'+_0x1c5b05[_0x526788(0x178)](0x0,0xa)+_0x526788(0x11b));if(!_0x343bc0||_0x343bc0['length']<0x3||_0x343bc0[_0x526788(0x145)]>0x32||!/^[a-zA-Z0-9_]+$/[_0x526788(0x146)](_0x343bc0)){await this['bot']?.['sendMessage'](_0x232d62,_0x526788(0xee)+_0x343bc0+'`\x0a\x0a'+_0x526788(0x1a3),{'parse_mode':_0x526788(0x183)});return;}if(!_0x1c5b05||!_0x1c5b05[_0x526788(0x19c)]('pk_')&&!_0x1c5b05['startsWith'](_0x526788(0x114))){await this[_0x526788(0xed)]?.[_0x526788(0x111)](_0x232d62,_0x526788(0xfe)+_0x526788(0xfa),{'parse_mode':_0x526788(0x183)});return;}const _0x263e7c=await database_1[_0x526788(0x176)][_0x526788(0x113)][_0x526788(0x10c)]({'where':{'username':_0x343bc0},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x263e7c){const _0x35796d=await database_1[_0x526788(0x176)][_0x526788(0x113)][_0x526788(0x13d)]({'select':{'username':!![],'name':!![]},'take':0x5});let _0x10b807=_0x526788(0x18f)+_0x343bc0+_0x526788(0x125);_0x35796d['length']>0x0?(_0x10b807+=_0x526788(0x158),_0x35796d[_0x526788(0x126)](_0x7b9391=>{const _0x208371=_0x526788;_0x10b807+=_0x208371(0x1c6)+_0x7b9391[_0x208371(0x18b)]+'`\x20('+_0x7b9391[_0x208371(0x197)]+')\x0a';}),_0x10b807+=_0x526788(0x159)):_0x10b807+=_0x526788(0x110);await this['bot']?.[_0x526788(0x111)](_0x232d62,_0x10b807,{'parse_mode':'Markdown'});return;}if(_0x263e7c['status']!==_0x526788(0x187)){await this[_0x526788(0xed)]?.[_0x526788(0x111)](_0x232d62,'❌\x20Shop\x20`'+_0x343bc0+_0x526788(0x16e)+_0x526788(0xf0),{'parse_mode':_0x526788(0x183)});return;}if(_0x263e7c[_0x526788(0x1bb)]!==_0x1c5b05&&_0x263e7c['secretKey']!==_0x1c5b05){await this['bot']?.['sendMessage'](_0x232d62,_0x526788(0x1bc)+_0x343bc0+_0x526788(0x1c7)+_0x526788(0x11e)+_0x526788(0x164),{'parse_mode':_0x526788(0x183)});return;}const _0x48d814=await database_1[_0x526788(0x176)][_0x526788(0x18c)][_0x526788(0xf2)]({'where':{'shopId':_0x263e7c['id'],'isVerified':!![],'telegramId':{'not':_0x3500c0}}});if(_0x48d814){await this['bot']?.[_0x526788(0x111)](_0x232d62,'❌\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`'+_0x343bc0+'`.\x0a\x0a'+_0x526788(0xea),{'parse_mode':_0x526788(0x183)});return;}await database_1['default'][_0x526788(0x18c)][_0x526788(0x123)]({'where':{'telegramId':_0x3500c0},'data':{'shopId':_0x263e7c['id'],'isVerified':!![]}}),await this[_0x526788(0xed)]?.['sendMessage'](_0x232d62,'🎉\x20*Congratulations!*\x0a\x0a'+_0x526788(0x136)+(_0x526788(0x1c5)+_0x263e7c[_0x526788(0x197)]+'*\x0a')+('👤\x20Username:\x20`'+_0x263e7c[_0x526788(0x18b)]+_0x526788(0x129))+'🔔\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a'+_0x526788(0x17e)+_0x526788(0x179)+_0x526788(0x17c)+_0x526788(0xf9)+'Commands:\x0a'+'/status\x20-\x20check\x20connection\x20status\x0a'+_0x526788(0x12b),{'parse_mode':_0x526788(0x183)}),console[_0x526788(0xff)](_0x526788(0x185)+_0x3500c0+_0x526788(0x182)+_0x263e7c[_0x526788(0x18b)]+'\x20via\x20single-line\x20input');}catch(_0x17d4fe){console[_0x526788(0x1b6)](_0x526788(0x124),_0x17d4fe),await this[_0x526788(0xed)]?.['sendMessage'](_0x232d62,_0x526788(0x132));}}async[a54_0x21f8b1(0x120)](_0x34ab58,_0x5d4748,_0x51f242){const _0x474bfc=a54_0x21f8b1;if(!this[_0x474bfc(0xed)]){console[_0x474bfc(0x1cb)](_0x474bfc(0xef));return;}try{const _0x3f7b6d=await database_1[_0x474bfc(0x176)][_0x474bfc(0x18c)]['findMany']({'where':{'shopId':_0x34ab58,'isVerified':!![]}});if(_0x3f7b6d[_0x474bfc(0x145)]===0x0){console[_0x474bfc(0xff)]('No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20'+_0x34ab58);return;}const _0x1bb188=_0x3f7b6d['map'](async _0x57c5d4=>{const _0x27cc26=_0x474bfc;try{await this['bot']?.['sendMessage'](_0x57c5d4[_0x27cc26(0x15a)],_0x5d4748,_0x51f242),console[_0x27cc26(0xff)](_0x27cc26(0x104)+_0x57c5d4[_0x27cc26(0x15a)]);}catch(_0x3ef7e4){console[_0x27cc26(0x1b6)](_0x27cc26(0x13c)+_0x57c5d4['telegramId']+':',_0x3ef7e4),_0x3ef7e4 instanceof Error&&(_0x3ef7e4[_0x27cc26(0x155)][_0x27cc26(0x12e)](_0x27cc26(0x10a))||_0x3ef7e4[_0x27cc26(0x155)][_0x27cc26(0x12e)](_0x27cc26(0x13a))||_0x3ef7e4[_0x27cc26(0x155)]['includes'](_0x27cc26(0x101)))&&(await database_1['default']['telegramUser'][_0x27cc26(0x123)]({'where':{'id':_0x57c5d4['id']},'data':{'isVerified':![]}}),console[_0x27cc26(0xff)](_0x27cc26(0x18d)+_0x57c5d4[_0x27cc26(0x15a)]+_0x27cc26(0x160)));}});await Promise[_0x474bfc(0xfc)](_0x1bb188);}catch(_0x4c5d48){console[_0x474bfc(0x1b6)](_0x474bfc(0x1a1),_0x4c5d48);}}async[a54_0x21f8b1(0x16b)](_0x3b477d,_0xe4ae15,_0x271a91){const _0x59566d=a54_0x21f8b1,_0x2db161={'created':'🆕','paid':'✅','failed':'❌','expired':'⏰','refund':'🔄','chargeback':'⚠️','processing':'⚙️'},_0x470302={'created':_0x59566d(0x17d),'paid':_0x59566d(0x15e),'failed':'Payment\x20failed','expired':_0x59566d(0x142),'refund':_0x59566d(0x16d),'chargeback':_0x59566d(0x19f),'processing':'Payment\x20is\x20being\x20processed'},_0x2fb490=_0x2db161[_0x271a91],_0x326a55=_0x470302[_0x271a91],_0x162de9=(0x0,gateway_1[_0x59566d(0x1a7)])(_0xe4ae15[_0x59566d(0x108)]);console[_0x59566d(0xff)](_0x59566d(0x1ac)+_0xe4ae15['gateway']+_0x59566d(0x16c)+_0x162de9+'\x22');let _0x102cb3=_0x2fb490+'\x20*'+_0x326a55+_0x59566d(0x186)+(_0x59566d(0xf4)+_0xe4ae15[_0x59566d(0x168)]+'\x20'+_0xe4ae15['currency']+'*\x0a')+('📝\x20Order\x20ID:\x20`'+(_0xe4ae15[_0x59566d(0x170)]||_0xe4ae15['id'])+'`\x0a')+(_0x59566d(0x137)+_0xe4ae15['id']+'`\x0a')+(_0x59566d(0xf6)+_0x162de9+'`\x0a')+(_0x59566d(0x166)+new Date(_0xe4ae15['createdAt'])[_0x59566d(0x15d)](_0x59566d(0x14c))+'\x0a');if(_0xe4ae15[_0x59566d(0x14f)]||_0xe4ae15[_0x59566d(0x13b)]||_0xe4ae15['remitterIban']||_0xe4ae15[_0x59566d(0x18a)]||_0xe4ae15[_0x59566d(0x152)]){_0x102cb3+=_0x59566d(0x181);_0xe4ae15[_0x59566d(0x14f)]&&(_0x102cb3+=_0x59566d(0x1c1)+_0xe4ae15[_0x59566d(0x14f)]+'`\x0a');_0xe4ae15[_0x59566d(0x13b)]&&(_0x102cb3+=_0x59566d(0x116)+_0xe4ae15[_0x59566d(0x13b)]+'`\x0a');_0xe4ae15[_0x59566d(0x173)]&&(_0x102cb3+=_0x59566d(0x1bf)+_0xe4ae15[_0x59566d(0x173)]+'`\x0a');_0xe4ae15[_0x59566d(0x18a)]&&(_0x102cb3+=_0x59566d(0x121)+_0xe4ae15[_0x59566d(0x18a)]+'`\x0a');if(_0xe4ae15[_0x59566d(0x152)]){const _0x393dfc=_0xe4ae15[_0x59566d(0x152)][_0x59566d(0x145)]>0x32?_0xe4ae15['customerUa']['substring'](0x0,0x32)+_0x59566d(0x16f):_0xe4ae15[_0x59566d(0x152)];_0x102cb3+=_0x59566d(0x17b)+_0x393dfc+'`\x0a';}}_0x271a91==='chargeback'&&_0xe4ae15[_0x59566d(0x174)]&&(_0x102cb3+='💸\x20Penalty\x20amount:\x20*'+_0xe4ae15[_0x59566d(0x174)]+'\x20USDT*\x0a'),_0x271a91===_0x59566d(0x1b8)&&(_0x102cb3+='⏳\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a'),_0xe4ae15['adminNotes']&&(_0x102cb3+=_0x59566d(0x103)+_0xe4ae15[_0x59566d(0x13e)]+'\x0a'),await this[_0x59566d(0x120)](_0x3b477d,_0x102cb3,{'parse_mode':'Markdown'});}async[a54_0x21f8b1(0x161)](_0x1b4e10,_0x4e1166,_0x36a360){const _0x4246bf=a54_0x21f8b1,_0x8ffae2={'created':'📤','completed':'✅','rejected':'❌'},_0x226f39={'created':_0x4246bf(0x141),'completed':'Payout\x20completed','rejected':_0x4246bf(0x191)},_0x25dbfd=_0x8ffae2[_0x36a360],_0x404939=_0x226f39[_0x36a360],_0x4ead11=_0x25dbfd+'\x20*'+_0x404939+_0x4246bf(0x186)+('💸\x20Amount:\x20*'+_0x4e1166[_0x4246bf(0x168)]+_0x4246bf(0x14a))+(_0x4246bf(0x154)+_0x4e1166[_0x4246bf(0x1c9)]+'`\x0a')+(_0x4246bf(0x14b)+_0x4e1166['id']+'`\x0a')+(_0x4246bf(0x166)+new Date(_0x4e1166[_0x4246bf(0x106)])[_0x4246bf(0x15d)](_0x4246bf(0x14c))+'\x0a')+(_0x4e1166['txid']?_0x4246bf(0x15c)+_0x4e1166[_0x4246bf(0xf7)]+'`':'');await this[_0x4246bf(0x120)](_0x1b4e10,_0x4ead11,{'parse_mode':_0x4246bf(0x183)});}async[a54_0x21f8b1(0x11c)](_0x462e61,_0x16a364){const _0x558215=a54_0x21f8b1;try{const _0x2fae08=await database_1[_0x558215(0x176)][_0x558215(0x10f)]['findUnique']({'where':{'shopId':_0x462e61},'select':{'notificationLogin':!![]}});if(!_0x2fae08?.[_0x558215(0x109)]){console[_0x558215(0xff)](_0x558215(0x171)+_0x462e61);return;}const _0x179258=_0x16a364[_0x558215(0x1ce)]?'🔐':'🚨',_0x4193e0=_0x16a364[_0x558215(0x1ce)]?_0x558215(0x15b):'Failed\x20login\x20attempt';let _0x2756f1=_0x179258+'\x20*'+_0x4193e0+_0x558215(0x186)+('👤\x20Username:\x20`'+_0x16a364[_0x558215(0x18b)]+'`\x0a')+(_0x558215(0x147)+_0x16a364['timestamp'][_0x558215(0x15d)](_0x558215(0x14c))+'\x0a');_0x16a364[_0x558215(0x107)]&&(_0x2756f1+=_0x558215(0x156)+_0x16a364['ipAddress']+'`\x0a');if(_0x16a364[_0x558215(0x1c0)]){const _0x49a725=_0x16a364[_0x558215(0x1c0)]['length']>0x32?_0x16a364[_0x558215(0x1c0)]['substring'](0x0,0x32)+'...':_0x16a364[_0x558215(0x1c0)];_0x2756f1+='💻\x20Browser:\x20`'+_0x49a725+'`\x0a';}!_0x16a364[_0x558215(0x1ce)]&&(_0x2756f1+=_0x558215(0x1ca)),await this[_0x558215(0x120)](_0x462e61,_0x2756f1,{'parse_mode':_0x558215(0x183)}),console['log']('✅\x20Login\x20notification\x20sent\x20for\x20shop\x20'+_0x462e61+':\x20'+(_0x16a364[_0x558215(0x1ce)]?_0x558215(0x1ce):'failed'));}catch(_0x5b9c2e){console[_0x558215(0x1b6)]('Failed\x20to\x20send\x20login\x20notification:',_0x5b9c2e);}}async[a54_0x21f8b1(0x14e)](_0x2877b6,_0x4485fd){const _0x1a2dd9=a54_0x21f8b1;try{const _0xbe6e87=await database_1['default'][_0x1a2dd9(0x10f)][_0x1a2dd9(0x10c)]({'where':{'shopId':_0x2877b6},'select':{'notificationApiError':!![]}});if(!_0xbe6e87?.[_0x1a2dd9(0x1a9)]){console[_0x1a2dd9(0xff)](_0x1a2dd9(0x190)+_0x2877b6);return;}let _0x549691='🚨\x20*API\x20Error*\x0a\x0a'+(_0x1a2dd9(0x1aa)+_0x4485fd[_0x1a2dd9(0x1c9)]+'\x20'+_0x4485fd[_0x1a2dd9(0x1b0)]+'`\x0a')+(_0x1a2dd9(0x147)+_0x4485fd['timestamp'][_0x1a2dd9(0x15d)](_0x1a2dd9(0x14c))+'\x0a');_0x4485fd[_0x1a2dd9(0x1b5)]&&(_0x549691+='📊\x20Error\x20code:\x20`'+_0x4485fd[_0x1a2dd9(0x1b5)]+'`\x0a'),_0x549691+=_0x1a2dd9(0x1b7)+_0x4485fd[_0x1a2dd9(0x135)]+'`\x0a',_0x4485fd[_0x1a2dd9(0x1b1)]&&(_0x549691+=_0x1a2dd9(0x153)+_0x4485fd['requestId']+'`\x0a'),_0x549691+=_0x1a2dd9(0x1af),await this[_0x1a2dd9(0x120)](_0x2877b6,_0x549691,{'parse_mode':_0x1a2dd9(0x183)}),console[_0x1a2dd9(0xff)](_0x1a2dd9(0x139)+_0x2877b6+':\x20'+_0x4485fd[_0x1a2dd9(0x1b0)]);}catch(_0x32fc54){console[_0x1a2dd9(0x1b6)](_0x1a2dd9(0x1c3),_0x32fc54);}}async['sendCustomNotification'](_0x16a643,_0x2ac45a,_0x131129){const _0x5cd2f9=a54_0x21f8b1;let _0x4b1366=_0x5cd2f9(0x195)+_0x2ac45a+_0x5cd2f9(0x186);for(const [_0x2ff01e,_0x4f5536]of Object[_0x5cd2f9(0xf1)](_0x131129)){_0x4f5536!==null&&_0x4f5536!==undefined&&(_0x4b1366+=_0x2ff01e+_0x5cd2f9(0x128)+_0x4f5536+'`\x0a');}await this[_0x5cd2f9(0x120)](_0x16a643,_0x4b1366,{'parse_mode':_0x5cd2f9(0x183)});}['getBotInfo'](){const _0x43d64d=a54_0x21f8b1;return{'isActive':!!this[_0x43d64d(0xed)],'username':this[_0x43d64d(0x163)]};}[a54_0x21f8b1(0x102)](){const _0x57a615=a54_0x21f8b1;this[_0x57a615(0xed)]&&(this[_0x57a615(0xed)]['stopPolling'](),this[_0x57a615(0xed)]=null,console[_0x57a615(0xff)](_0x57a615(0x119)));}}exports[a54_0x21f8b1(0x1cc)]=TelegramBotService,exports[a54_0x21f8b1(0x188)]=new TelegramBotService();