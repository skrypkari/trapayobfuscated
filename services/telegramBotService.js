'use strict';const a55_0x251727=a55_0x4d84;(function(_0x18fd10,_0x53d192){const _0x146ba8=a55_0x4d84,_0x5cf674=_0x18fd10();while(!![]){try{const _0x44c486=parseInt(_0x146ba8(0x1f4))/0x1+-parseInt(_0x146ba8(0x17c))/0x2*(parseInt(_0x146ba8(0x183))/0x3)+-parseInt(_0x146ba8(0x1b3))/0x4*(parseInt(_0x146ba8(0x18e))/0x5)+-parseInt(_0x146ba8(0x221))/0x6+-parseInt(_0x146ba8(0x159))/0x7+-parseInt(_0x146ba8(0x15e))/0x8*(-parseInt(_0x146ba8(0x173))/0x9)+parseInt(_0x146ba8(0x20e))/0xa;if(_0x44c486===_0x53d192)break;else _0x5cf674['push'](_0x5cf674['shift']());}catch(_0x5366b0){_0x5cf674['push'](_0x5cf674['shift']());}}}(a55_0x3c63,0xaff56));function a55_0x3c63(){const _0x2146d5=['✅\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a','Error\x20handling\x20message:','sendApiErrorNotification','chat','Failed\x20login\x20attempt','\x0a👤\x20*Customer\x20Information:*\x0a','getBotInfo','📱\x20Shop:\x20*','🏦\x20IBAN:\x20`','•\x20Payouts\x0a','🔌\x20User\x20','polling_error','1457568JwyUZb','telegramUser','../types/gateway','botToken','sendPaymentNotification','sendShopNotification','📱\x20Created\x20new\x20Telegram\x20user:\x20','💰\x20Amount:\x20*','Use\x20/start\x20to\x20connect.','148026JagNoU','❌\x20An\x20error\x20occurred\x20while\x20verifying\x20data.','Telegram\x20bot\x20error:','•\x20Important\x20events\x0a\x0a','statusCode','✅\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*','orderId','42KIRxdc','`\x0a\x0a','`\x20not\x20found.\x0a\x0a','Telegram\x20bot\x20polling\x20error:','❌\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.','❌\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a','userAgent','sendMessage','ipAddress','\x20parts:\x20','TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables','110395YbMfAQ','❌\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`','toLocaleDateString','💸\x20Amount:\x20*','✅\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*','Use\x20/start\x20to\x20begin.','sendLoginNotification','`.\x0a\x0a','\x22\x20->\x20display\x20\x22','✅\x20Welcome\x20back!\x0a\x0a','default','Available\x20usernames:\x0a','*\x0a\x0a','test','API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','notificationApiError','🔔\x20You\x20receive\x20notifications\x20about:\x0a','toString','shopId','__esModule','❌\x20Invalid\x20username\x20format:\x20`','Payment\x20expired','You\x20are\x20already\x20connected\x20to\x20shop:\x20*','failed','❌\x20Shop\x20with\x20username\x20`','customerIp','🛑\x20Telegram\x20bot\x20stopped','chargebackAmount','Payment\x20chargeback','\x20\x20\x20Status:\x20','createdAt','ACTIVE','*.\x0a\x0a','last_name','stopBot','sendPayoutNotification','💻\x20Browser:\x20`','200LqnGAC','name','User\x20','processing','../config/database','...','bot','\x0aCheck\x20spelling\x20and\x20try\x20again.','customerName','update','•\x20Payment\x20status\x20changes\x0a','gateway','Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`','publicKey','✅\x20Telegram\x20user\x20','telegramBotService','🔗\x20TXID:\x20`','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','setupBotHandlers','Failed\x20to\x20send\x20login\x20notification:','Error\x20handling\x20/status\x20command:','🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20','txid','onText','log','map','method','\x20(@','\x20via\x20single-line\x20input','🎉\x20*Congratulations!*\x0a\x0a','\x0a💡\x20Check\x20your\x20request\x20or\x20contact\x20support.','•\x20New\x20payments\x0a','findUnique','❗️\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!','📱\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20','Payment\x20refund','botUsername','findMany','sendCustomNotification','🔗\x20Endpoint:\x20`','TELEGRAM_BOT_USERNAME','\x20disconnected\x20from\x20shop\x20','Example:\x0a','❌\x20Error:\x20`','trim','user\x20is\x20deactivated','To\x20reconnect,\x20use\x20the\x20/start\x20command','TelegramBotService','🔍\x20*Debug\x20Information*\x0a\x0a','📝\x20Order\x20ID:\x20`','requestId','📱\x20Telegram\x20notification:\x20gateway\x20\x22','toLocaleString','❌\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a','Successful\x20login','/disconnect\x20-\x20disconnect\x20from\x20notifications','✅\x20Notification\x20sent\x20to\x20Telegram\x20user\x20','❌\x20API\x20key\x20does\x20not\x20match\x20shop\x20`','\x22,\x20apiKey=\x22','TELEGRAM_BOT_TOKEN','❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','forEach',':\x20`','en-US','message','1212481ecRgrV','chat\x20not\x20found','findFirst','warn','Failed\x20to\x20send\x20API\x20error\x20notification:','🌐\x20IP\x20address:\x20`','...`\x0a\x0a','🏦\x20Method:\x20`','secretKey','📱\x20Your\x20Telegram\x20ID:\x20`','length','•\x20`','remitterIban','\x20verified\x20for\x20shop\x20','`\x20is\x20inactive.\x0a\x0a','customerEmail','amount','Markdown','.\x20*','`\x20(','shopSettings','📧\x20Email:\x20`','🌐\x20IP:\x20`','text','❌\x20Shop\x20`','Error\x20in\x20handleSingleLineVerification:','27442810fVcPrL','substring','allSettled','from','getGatewayDisplayNameForTelegram','handleSingleLineVerification','includes','join','To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a','stopPolling','\x0a⚠️\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!','Username:\x20`','__importDefault','🚨\x20*API\x20Error*\x0a\x0a','⏳\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a','✅\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20','No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20','📝\x20Format:\x20`username\x20api_key`\x0a\x0a','❌\x20Please\x20use\x20/start\x20command\x20first','1739562UGuJGI','defineProperty','Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.','Contact\x20administrator.','New\x20payout\x20created','📅\x20Time:\x20','❌\x20Error\x20getting\x20debug\x20information.',':\x20username=\x22','❌\x20Failed\x20to\x20initialize\x20Telegram\x20bot:','timestamp','•\x20Payouts\x0a\x0a','🏪\x20Gateway:\x20`','shop','\x20USD*\x0a','error','Error\x20handling\x20/debug\x20command:','username','errorMessage','Error\x20handling\x20/start\x20command:','New\x20payment\x20created','Error\x20sending\x20shop\x20notification:','customerUa','💸\x20Penalty\x20amount:\x20*','env','👤\x20Username:\x20`','✅\x20Connected\x20to\x20shop:\x20*','telegramId','adminNotes','Payout\x20completed','status','create','7909167VZgxXE','❌\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20','endpoint','success','isVerified','16aglfuU','initializeBot','startsWith','✅\x20Login\x20notification\x20sent\x20for\x20shop\x20','trapay_bot','\x20initialized\x20successfully','📅\x20Date:\x20','Commands:\x0a','...\x22'];a55_0x3c63=function(){return _0x2146d5;};return a55_0x3c63();}var __importDefault=this&&this[a55_0x251727(0x21a)]||function(_0x365a85){return _0x365a85&&_0x365a85['__esModule']?_0x365a85:{'default':_0x365a85};};Object[a55_0x251727(0x222)](exports,a55_0x251727(0x1a1),{'value':!![]}),exports[a55_0x251727(0x1c2)]=exports[a55_0x251727(0x1e2)]=void 0x0;const node_telegram_bot_api_1=__importDefault(require('node-telegram-bot-api')),database_1=__importDefault(require(a55_0x251727(0x1b7))),gateway_1=require(a55_0x251727(0x175));class TelegramBotService{constructor(){const _0x4b4ac3=a55_0x251727;this[_0x4b4ac3(0x1b9)]=null,this[_0x4b4ac3(0x176)]=process[_0x4b4ac3(0x238)][_0x4b4ac3(0x1ee)]||'',this[_0x4b4ac3(0x1d7)]=process[_0x4b4ac3(0x238)][_0x4b4ac3(0x1db)]||_0x4b4ac3(0x162),this[_0x4b4ac3(0x176)]?this[_0x4b4ac3(0x15f)]():console[_0x4b4ac3(0x1f7)](_0x4b4ac3(0x18d));}[a55_0x251727(0x15f)](){const _0x23dac6=a55_0x251727;try{this[_0x23dac6(0x1b9)]=new node_telegram_bot_api_1['default'](this[_0x23dac6(0x176)],{'polling':!![]}),this[_0x23dac6(0x1c5)](),console[_0x23dac6(0x1cb)]('✅\x20Telegram\x20bot\x20@'+this['botUsername']+_0x23dac6(0x163));}catch(_0x5203c3){console[_0x23dac6(0x22f)](_0x23dac6(0x229),_0x5203c3);}}['setupBotHandlers'](){const _0x260bcc=a55_0x251727;if(!this[_0x260bcc(0x1b9)])return;this['bot'][_0x260bcc(0x1ca)](/\/start/,async _0xb02bd7=>{const _0x5e82b1=_0x260bcc,_0x48db1b=_0xb02bd7[_0x5e82b1(0x16a)]['id'],_0x20329b=_0xb02bd7[_0x5e82b1(0x211)]?.['id'][_0x5e82b1(0x19f)](),_0x53df1c=_0xb02bd7[_0x5e82b1(0x211)]?.[_0x5e82b1(0x231)],_0x20c53c=_0xb02bd7[_0x5e82b1(0x211)]?.['first_name'],_0x142587=_0xb02bd7[_0x5e82b1(0x211)]?.[_0x5e82b1(0x1af)];if(!_0x20329b)return;try{let _0x75241d=await database_1[_0x5e82b1(0x198)][_0x5e82b1(0x174)][_0x5e82b1(0x1d3)]({'where':{'telegramId':_0x20329b},'include':{'shop':!![]}});!_0x75241d?(_0x75241d=await database_1['default']['telegramUser'][_0x5e82b1(0x158)]({'data':{'telegramId':_0x20329b,'username':_0x53df1c,'firstName':_0x20c53c,'lastName':_0x142587,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console['log'](_0x5e82b1(0x179)+_0x20329b+_0x5e82b1(0x1ce)+_0x53df1c+')')):_0x75241d=await database_1['default'][_0x5e82b1(0x174)][_0x5e82b1(0x1bc)]({'where':{'telegramId':_0x20329b},'data':{'username':_0x53df1c,'firstName':_0x20c53c,'lastName':_0x142587},'include':{'shop':!![]}}),_0x75241d[_0x5e82b1(0x15d)]&&_0x75241d[_0x5e82b1(0x1a0)]&&_0x75241d[_0x5e82b1(0x22d)]?await this[_0x5e82b1(0x1b9)]?.[_0x5e82b1(0x18a)](_0x48db1b,_0x5e82b1(0x197)+(_0x5e82b1(0x1a4)+_0x75241d[_0x5e82b1(0x22d)][_0x5e82b1(0x1b4)]+'*\x0a')+(_0x5e82b1(0x219)+_0x75241d[_0x5e82b1(0x22d)][_0x5e82b1(0x231)]+_0x5e82b1(0x184))+_0x5e82b1(0x19e)+_0x5e82b1(0x1d2)+_0x5e82b1(0x1bd)+_0x5e82b1(0x22b)+_0x5e82b1(0x165)+'/status\x20-\x20check\x20connection\x20status\x0a'+'/disconnect\x20-\x20disconnect\x20from\x20notifications',{'parse_mode':'Markdown'}):(_0x75241d[_0x5e82b1(0x1a0)]&&!_0x75241d[_0x5e82b1(0x15d)]&&(await database_1['default'][_0x5e82b1(0x174)][_0x5e82b1(0x1bc)]({'where':{'telegramId':_0x20329b},'data':{'shopId':null,'isVerified':![]}}),console[_0x5e82b1(0x1cb)]('🔄\x20Reset\x20incomplete\x20verification\x20for\x20user\x20'+_0x20329b)),await this[_0x5e82b1(0x1b9)]?.[_0x5e82b1(0x18a)](_0x48db1b,'🤖\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a'+_0x5e82b1(0x216)+_0x5e82b1(0x21f)+_0x5e82b1(0x1dd)+_0x5e82b1(0x1c4)+_0x5e82b1(0x1d4),{'parse_mode':_0x5e82b1(0x205)}));}catch(_0x49075c){console[_0x5e82b1(0x22f)](_0x5e82b1(0x233),_0x49075c),await this['bot']?.[_0x5e82b1(0x18a)](_0x48db1b,_0x5e82b1(0x1ef));}}),this[_0x260bcc(0x1b9)][_0x260bcc(0x1ca)](/\/disconnect/,async _0x1e5b6f=>{const _0x1acc58=_0x260bcc,_0x1482ea=_0x1e5b6f[_0x1acc58(0x16a)]['id'],_0xb64c69=_0x1e5b6f[_0x1acc58(0x211)]?.['id'][_0x1acc58(0x19f)]();if(!_0xb64c69)return;try{const _0x47104b=await database_1[_0x1acc58(0x198)][_0x1acc58(0x174)][_0x1acc58(0x1d3)]({'where':{'telegramId':_0xb64c69},'include':{'shop':!![]}});if(!_0x47104b||!_0x47104b[_0x1acc58(0x15d)]||!_0x47104b[_0x1acc58(0x1a0)]){await this[_0x1acc58(0x1b9)]?.[_0x1acc58(0x18a)](_0x1482ea,_0x1acc58(0x187));return;}const _0x3326a8=_0x47104b['shop']?.[_0x1acc58(0x1b4)]||'unknown\x20shop';await database_1[_0x1acc58(0x198)]['telegramUser'][_0x1acc58(0x1bc)]({'where':{'telegramId':_0xb64c69},'data':{'shopId':null,'isVerified':![]}}),console[_0x1acc58(0x1cb)](_0x1acc58(0x171)+_0xb64c69+_0x1acc58(0x1dc)+_0x47104b['shopId']),await this[_0x1acc58(0x1b9)]?.[_0x1acc58(0x18a)](_0x1482ea,_0x1acc58(0x181)+_0x3326a8+_0x1acc58(0x1ae)+_0x1acc58(0x1e1),{'parse_mode':'Markdown'});}catch(_0x3c9209){console[_0x1acc58(0x22f)]('Error\x20handling\x20/disconnect\x20command:',_0x3c9209),await this[_0x1acc58(0x1b9)]?.[_0x1acc58(0x18a)](_0x1482ea,_0x1acc58(0x1ef));}}),this[_0x260bcc(0x1b9)][_0x260bcc(0x1ca)](/\/status/,async _0x4997c2=>{const _0x3194e9=_0x260bcc,_0x175452=_0x4997c2[_0x3194e9(0x16a)]['id'],_0x50fd6e=_0x4997c2['from']?.['id']['toString']();if(!_0x50fd6e)return;try{const _0x3c3ffe=await database_1[_0x3194e9(0x198)][_0x3194e9(0x174)][_0x3194e9(0x1d3)]({'where':{'telegramId':_0x50fd6e},'include':{'shop':!![]}});if(!_0x3c3ffe){await this[_0x3194e9(0x1b9)]?.[_0x3194e9(0x18a)](_0x175452,_0x3194e9(0x1e8)+_0x3194e9(0x193));return;}if(!_0x3c3ffe[_0x3194e9(0x15d)]||!_0x3c3ffe[_0x3194e9(0x1a0)]||!_0x3c3ffe['shop']){await this[_0x3194e9(0x1b9)]?.['sendMessage'](_0x175452,_0x3194e9(0x188)+_0x3194e9(0x17b));return;}await this[_0x3194e9(0x1b9)]?.['sendMessage'](_0x175452,'📊\x20*Connection\x20Status*\x0a\x0a'+(_0x3194e9(0x153)+_0x3c3ffe[_0x3194e9(0x22d)]['name']+'*\x0a')+('👤\x20Username:\x20`'+_0x3c3ffe[_0x3194e9(0x22d)][_0x3194e9(0x231)]+'`\x0a')+('📅\x20Connection\x20date:\x20'+_0x3c3ffe['updatedAt'][_0x3194e9(0x190)](_0x3194e9(0x1f2))+'\x0a\x0a')+'🔔\x20Notifications\x20are\x20active\x0a\x0a'+_0x3194e9(0x165)+'/disconnect\x20-\x20disconnect\x20from\x20notifications',{'parse_mode':_0x3194e9(0x205)});}catch(_0x4bbbf6){console[_0x3194e9(0x22f)](_0x3194e9(0x1c7),_0x4bbbf6),await this['bot']?.['sendMessage'](_0x175452,_0x3194e9(0x1ef));}}),this['bot']['onText'](/\/debug/,async _0x246561=>{const _0x37bd89=_0x260bcc,_0x1224ac=_0x246561[_0x37bd89(0x16a)]['id'],_0x5bdd76=_0x246561[_0x37bd89(0x211)]?.['id'][_0x37bd89(0x19f)]();if(!_0x5bdd76)return;try{const _0x19bd7b=await database_1[_0x37bd89(0x198)][_0x37bd89(0x22d)][_0x37bd89(0x1d8)]({'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![]},'take':0xa});let _0x35384c=_0x37bd89(0x1e3);_0x35384c+=_0x37bd89(0x1fd)+_0x5bdd76+_0x37bd89(0x184),_0x35384c+='🏪\x20Available\x20shops\x20in\x20system:\x0a',_0x19bd7b['forEach']((_0x2278ea,_0xa5f7ce)=>{const _0x3be953=_0x37bd89;_0x35384c+=_0xa5f7ce+0x1+_0x3be953(0x206)+_0x2278ea['name']+'*\x0a',_0x35384c+='\x20\x20\x20Username:\x20`'+_0x2278ea['username']+'`\x0a',_0x35384c+=_0x3be953(0x1ab)+_0x2278ea[_0x3be953(0x157)]+'\x0a',_0x35384c+='\x20\x20\x20Public\x20Key:\x20`'+_0x2278ea['publicKey'][_0x3be953(0x20f)](0x0,0xf)+_0x3be953(0x1fa);}),await this[_0x37bd89(0x1b9)]?.[_0x37bd89(0x18a)](_0x1224ac,_0x35384c,{'parse_mode':_0x37bd89(0x205)});}catch(_0x39183c){console[_0x37bd89(0x22f)](_0x37bd89(0x230),_0x39183c),await this[_0x37bd89(0x1b9)]?.[_0x37bd89(0x18a)](_0x1224ac,_0x37bd89(0x227));}}),this['bot']['on'](_0x260bcc(0x1f3),async _0x3c2c64=>{const _0x3a40d8=_0x260bcc;if(_0x3c2c64[_0x3a40d8(0x20b)]?.[_0x3a40d8(0x160)]('/'))return;const _0x1f74de=_0x3c2c64['chat']['id'],_0x4cd7ba=_0x3c2c64[_0x3a40d8(0x211)]?.['id'][_0x3a40d8(0x19f)](),_0x3821e8=_0x3c2c64[_0x3a40d8(0x20b)]?.[_0x3a40d8(0x1df)]();if(!_0x4cd7ba||!_0x3821e8)return;try{const _0x242be3=await database_1[_0x3a40d8(0x198)]['telegramUser']['findUnique']({'where':{'telegramId':_0x4cd7ba},'include':{'shop':!![]}});if(!_0x242be3){await this[_0x3a40d8(0x1b9)]?.[_0x3a40d8(0x18a)](_0x1f74de,_0x3a40d8(0x220));return;}if(_0x242be3[_0x3a40d8(0x15d)]&&_0x242be3['shopId']&&_0x242be3[_0x3a40d8(0x22d)]){await this[_0x3a40d8(0x1b9)]?.[_0x3a40d8(0x18a)](_0x1f74de,_0x3a40d8(0x192)+_0x242be3['shop'][_0x3a40d8(0x1b4)]+'*.\x0a\x0a'+'Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.',{'parse_mode':_0x3a40d8(0x205)});return;}const _0x413324=_0x3821e8['split'](/\s+/);if(_0x413324['length']!==0x2){await this[_0x3a40d8(0x1b9)]?.['sendMessage'](_0x1f74de,'❌\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a'+'📝\x20Format:\x20`username\x20api_key`\x0a\x0a'+_0x3a40d8(0x1dd)+_0x3a40d8(0x1c4)+('You\x20sent\x20'+_0x413324[_0x3a40d8(0x1fe)]+_0x3a40d8(0x18c)+_0x413324['map'](_0xac12=>'`'+_0xac12+'`')[_0x3a40d8(0x215)](',\x20')),{'parse_mode':_0x3a40d8(0x205)});return;}const [_0x153f48,_0x1c3533]=_0x413324;console[_0x3a40d8(0x1cb)](_0x3a40d8(0x1c8)+_0x4cd7ba+_0x3a40d8(0x228)+_0x153f48+_0x3a40d8(0x1ed)+_0x1c3533[_0x3a40d8(0x20f)](0x0,0xa)+_0x3a40d8(0x166)),await this[_0x3a40d8(0x213)](_0x1f74de,_0x4cd7ba,_0x153f48,_0x1c3533);}catch(_0x32db6f){console[_0x3a40d8(0x22f)](_0x3a40d8(0x168),_0x32db6f),await this[_0x3a40d8(0x1b9)]?.[_0x3a40d8(0x18a)](_0x1f74de,'❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this[_0x260bcc(0x1b9)]['on'](_0x260bcc(0x22f),_0x43baeb=>{const _0x1552f5=_0x260bcc;console['error'](_0x1552f5(0x17e),_0x43baeb);}),this[_0x260bcc(0x1b9)]['on'](_0x260bcc(0x172),_0x438c45=>{const _0x1c9717=_0x260bcc;console[_0x1c9717(0x22f)](_0x1c9717(0x186),_0x438c45);});}async[a55_0x251727(0x213)](_0x445c2d,_0x1b2115,_0x910a89,_0x5da32){const _0x1f051e=a55_0x251727;try{console[_0x1f051e(0x1cb)](_0x1f051e(0x1c8)+_0x1b2115+':\x20username=\x22'+_0x910a89+_0x1f051e(0x1ed)+_0x5da32['substring'](0x0,0xa)+_0x1f051e(0x166));if(!_0x910a89||_0x910a89['length']<0x3||_0x910a89[_0x1f051e(0x1fe)]>0x32||!/^[a-zA-Z0-9_]+$/[_0x1f051e(0x19b)](_0x910a89)){await this[_0x1f051e(0x1b9)]?.[_0x1f051e(0x18a)](_0x445c2d,_0x1f051e(0x1a2)+_0x910a89+_0x1f051e(0x184)+'Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).',{'parse_mode':'Markdown'});return;}if(!_0x5da32||!_0x5da32['startsWith']('pk_')&&!_0x5da32[_0x1f051e(0x160)]('sk_')){await this[_0x1f051e(0x1b9)]?.[_0x1f051e(0x18a)](_0x445c2d,'❌\x20Invalid\x20API\x20key\x20format.\x0a\x0a'+_0x1f051e(0x19c),{'parse_mode':_0x1f051e(0x205)});return;}const _0x3ceec2=await database_1[_0x1f051e(0x198)][_0x1f051e(0x22d)][_0x1f051e(0x1d3)]({'where':{'username':_0x910a89},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x3ceec2){const _0x17162d=await database_1[_0x1f051e(0x198)][_0x1f051e(0x22d)][_0x1f051e(0x1d8)]({'select':{'username':!![],'name':!![]},'take':0x5});let _0x59b31e=_0x1f051e(0x1a6)+_0x910a89+_0x1f051e(0x185);_0x17162d['length']>0x0?(_0x59b31e+=_0x1f051e(0x199),_0x17162d[_0x1f051e(0x1f0)](_0xdba85c=>{const _0x54025b=_0x1f051e;_0x59b31e+=_0x54025b(0x1ff)+_0xdba85c[_0x54025b(0x231)]+_0x54025b(0x207)+_0xdba85c[_0x54025b(0x1b4)]+')\x0a';}),_0x59b31e+=_0x1f051e(0x1ba)):_0x59b31e+='Check\x20spelling\x20and\x20try\x20again.';await this[_0x1f051e(0x1b9)]?.[_0x1f051e(0x18a)](_0x445c2d,_0x59b31e,{'parse_mode':_0x1f051e(0x205)});return;}if(_0x3ceec2[_0x1f051e(0x157)]!==_0x1f051e(0x1ad)){await this[_0x1f051e(0x1b9)]?.[_0x1f051e(0x18a)](_0x445c2d,_0x1f051e(0x20c)+_0x910a89+_0x1f051e(0x202)+_0x1f051e(0x224),{'parse_mode':_0x1f051e(0x205)});return;}if(_0x3ceec2[_0x1f051e(0x1c0)]!==_0x5da32&&_0x3ceec2[_0x1f051e(0x1fc)]!==_0x5da32){await this[_0x1f051e(0x1b9)]?.[_0x1f051e(0x18a)](_0x445c2d,_0x1f051e(0x1ec)+_0x910a89+_0x1f051e(0x195)+'Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a'+_0x1f051e(0x1bf),{'parse_mode':_0x1f051e(0x205)});return;}const _0x243baa=await database_1[_0x1f051e(0x198)][_0x1f051e(0x174)][_0x1f051e(0x1f6)]({'where':{'shopId':_0x3ceec2['id'],'isVerified':!![],'telegramId':{'not':_0x1b2115}}});if(_0x243baa){await this[_0x1f051e(0x1b9)]?.['sendMessage'](_0x445c2d,_0x1f051e(0x18f)+_0x910a89+_0x1f051e(0x195)+_0x1f051e(0x223),{'parse_mode':_0x1f051e(0x205)});return;}await database_1[_0x1f051e(0x198)]['telegramUser'][_0x1f051e(0x1bc)]({'where':{'telegramId':_0x1b2115},'data':{'shopId':_0x3ceec2['id'],'isVerified':!![]}}),await this['bot']?.[_0x1f051e(0x18a)](_0x445c2d,_0x1f051e(0x1d0)+_0x1f051e(0x167)+(_0x1f051e(0x16e)+_0x3ceec2[_0x1f051e(0x1b4)]+'*\x0a')+(_0x1f051e(0x152)+_0x3ceec2[_0x1f051e(0x231)]+_0x1f051e(0x184))+'🔔\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a'+_0x1f051e(0x1d2)+_0x1f051e(0x1bd)+_0x1f051e(0x170)+_0x1f051e(0x17f)+_0x1f051e(0x165)+'/status\x20-\x20check\x20connection\x20status\x0a'+_0x1f051e(0x1ea),{'parse_mode':_0x1f051e(0x205)}),console['log'](_0x1f051e(0x1c1)+_0x1b2115+_0x1f051e(0x201)+_0x3ceec2[_0x1f051e(0x231)]+_0x1f051e(0x1cf));}catch(_0x901c04){console[_0x1f051e(0x22f)](_0x1f051e(0x20d),_0x901c04),await this['bot']?.[_0x1f051e(0x18a)](_0x445c2d,_0x1f051e(0x17d));}}async[a55_0x251727(0x178)](_0x3230a3,_0x950694,_0x113d24){const _0x8467f0=a55_0x251727;if(!this[_0x8467f0(0x1b9)]){console[_0x8467f0(0x1f7)]('Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification');return;}try{const _0x4701a4=await database_1['default'][_0x8467f0(0x174)][_0x8467f0(0x1d8)]({'where':{'shopId':_0x3230a3,'isVerified':!![]}});if(_0x4701a4['length']===0x0){console[_0x8467f0(0x1cb)](_0x8467f0(0x21e)+_0x3230a3);return;}const _0x3fe8bc=_0x4701a4[_0x8467f0(0x1cc)](async _0x123137=>{const _0x5ec24e=_0x8467f0;try{await this[_0x5ec24e(0x1b9)]?.['sendMessage'](_0x123137[_0x5ec24e(0x154)],_0x950694,_0x113d24),console[_0x5ec24e(0x1cb)](_0x5ec24e(0x1eb)+_0x123137[_0x5ec24e(0x154)]);}catch(_0x8a873b){console['error'](_0x5ec24e(0x15a)+_0x123137[_0x5ec24e(0x154)]+':',_0x8a873b),_0x8a873b instanceof Error&&(_0x8a873b[_0x5ec24e(0x1f3)][_0x5ec24e(0x214)]('blocked')||_0x8a873b['message']['includes'](_0x5ec24e(0x1f5))||_0x8a873b[_0x5ec24e(0x1f3)][_0x5ec24e(0x214)](_0x5ec24e(0x1e0)))&&(await database_1['default'][_0x5ec24e(0x174)]['update']({'where':{'id':_0x123137['id']},'data':{'isVerified':![]}}),console[_0x5ec24e(0x1cb)](_0x5ec24e(0x1b5)+_0x123137[_0x5ec24e(0x154)]+'\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure'));}});await Promise[_0x8467f0(0x210)](_0x3fe8bc);}catch(_0x4f5e90){console['error'](_0x8467f0(0x235),_0x4f5e90);}}async[a55_0x251727(0x177)](_0x374ef3,_0x547168,_0x1eaa16){const _0x24cc64=a55_0x251727,_0x2c6f60={'created':'🆕','paid':'✅','failed':'❌','expired':'⏰','refund':'🔄','chargeback':'⚠️','processing':'⚙️'},_0x4827c0={'created':_0x24cc64(0x234),'paid':'Payment\x20successfully\x20paid','failed':'Payment\x20failed','expired':_0x24cc64(0x1a3),'refund':_0x24cc64(0x1d6),'chargeback':_0x24cc64(0x1aa),'processing':'Payment\x20is\x20being\x20processed'},_0x43754e=_0x2c6f60[_0x1eaa16],_0x272433=_0x4827c0[_0x1eaa16],_0x5fb2da=(0x0,gateway_1[_0x24cc64(0x212)])(_0x547168[_0x24cc64(0x1be)]);console[_0x24cc64(0x1cb)](_0x24cc64(0x1e6)+_0x547168[_0x24cc64(0x1be)]+_0x24cc64(0x196)+_0x5fb2da+'\x22');let _0xf48fe2=_0x43754e+'\x20*'+_0x272433+'*\x0a\x0a'+(_0x24cc64(0x17a)+_0x547168['amount']+'\x20'+_0x547168['currency']+'*\x0a')+(_0x24cc64(0x1e4)+(_0x547168[_0x24cc64(0x182)]||_0x547168['id'])+'`\x0a')+('🆔\x20Payment\x20ID:\x20`'+_0x547168['id']+'`\x0a')+(_0x24cc64(0x22c)+_0x5fb2da+'`\x0a')+(_0x24cc64(0x164)+new Date(_0x547168[_0x24cc64(0x1ac)])[_0x24cc64(0x1e7)](_0x24cc64(0x1f2))+'\x0a');if(_0x547168[_0x24cc64(0x1bb)]||_0x547168['customerEmail']||_0x547168['remitterIban']||_0x547168[_0x24cc64(0x1a7)]||_0x547168[_0x24cc64(0x236)]){_0xf48fe2+=_0x24cc64(0x16c);_0x547168[_0x24cc64(0x1bb)]&&(_0xf48fe2+='📛\x20Name:\x20`'+_0x547168[_0x24cc64(0x1bb)]+'`\x0a');_0x547168[_0x24cc64(0x203)]&&(_0xf48fe2+=_0x24cc64(0x209)+_0x547168[_0x24cc64(0x203)]+'`\x0a');_0x547168[_0x24cc64(0x200)]&&(_0xf48fe2+=_0x24cc64(0x16f)+_0x547168[_0x24cc64(0x200)]+'`\x0a');_0x547168[_0x24cc64(0x1a7)]&&(_0xf48fe2+=_0x24cc64(0x20a)+_0x547168[_0x24cc64(0x1a7)]+'`\x0a');if(_0x547168['customerUa']){const _0x1aa825=_0x547168[_0x24cc64(0x236)][_0x24cc64(0x1fe)]>0x32?_0x547168[_0x24cc64(0x236)][_0x24cc64(0x20f)](0x0,0x32)+'...':_0x547168['customerUa'];_0xf48fe2+=_0x24cc64(0x1b2)+_0x1aa825+'`\x0a';}}_0x1eaa16==='chargeback'&&_0x547168[_0x24cc64(0x1a9)]&&(_0xf48fe2+=_0x24cc64(0x237)+_0x547168[_0x24cc64(0x1a9)]+'\x20USDT*\x0a'),_0x1eaa16===_0x24cc64(0x1b6)&&(_0xf48fe2+=_0x24cc64(0x21c)),_0x547168[_0x24cc64(0x155)]&&(_0xf48fe2+='📝\x20Notes:\x20'+_0x547168[_0x24cc64(0x155)]+'\x0a'),await this[_0x24cc64(0x178)](_0x374ef3,_0xf48fe2,{'parse_mode':_0x24cc64(0x205)});}async[a55_0x251727(0x1b1)](_0x2733ae,_0x1f8a27,_0x2a87af){const _0x13f31d=a55_0x251727,_0x795c0c={'created':'📤','completed':'✅','rejected':'❌'},_0x4009b0={'created':_0x13f31d(0x225),'completed':_0x13f31d(0x156),'rejected':'Payout\x20rejected'},_0x26273f=_0x795c0c[_0x2a87af],_0x341124=_0x4009b0[_0x2a87af],_0x453912=_0x26273f+'\x20*'+_0x341124+_0x13f31d(0x19a)+(_0x13f31d(0x191)+_0x1f8a27[_0x13f31d(0x204)]+_0x13f31d(0x22e))+(_0x13f31d(0x1fb)+_0x1f8a27[_0x13f31d(0x1cd)]+'`\x0a')+('🆔\x20Payout\x20ID:\x20`'+_0x1f8a27['id']+'`\x0a')+('📅\x20Date:\x20'+new Date(_0x1f8a27[_0x13f31d(0x1ac)])['toLocaleString'](_0x13f31d(0x1f2))+'\x0a')+(_0x1f8a27[_0x13f31d(0x1c9)]?_0x13f31d(0x1c3)+_0x1f8a27[_0x13f31d(0x1c9)]+'`':'');await this['sendShopNotification'](_0x2733ae,_0x453912,{'parse_mode':_0x13f31d(0x205)});}async[a55_0x251727(0x194)](_0x1bf242,_0x316431){const _0x22c2fa=a55_0x251727;try{const _0x32fa48=await database_1['default']['shopSettings'][_0x22c2fa(0x1d3)]({'where':{'shopId':_0x1bf242},'select':{'notificationLogin':!![]}});if(!_0x32fa48?.['notificationLogin']){console[_0x22c2fa(0x1cb)]('📱\x20Login\x20notifications\x20disabled\x20for\x20shop\x20'+_0x1bf242);return;}const _0x476fb8=_0x316431[_0x22c2fa(0x15c)]?'🔐':'🚨',_0x536bb9=_0x316431[_0x22c2fa(0x15c)]?_0x22c2fa(0x1e9):_0x22c2fa(0x16b);let _0x13b297=_0x476fb8+'\x20*'+_0x536bb9+_0x22c2fa(0x19a)+(_0x22c2fa(0x152)+_0x316431[_0x22c2fa(0x231)]+'`\x0a')+('📅\x20Time:\x20'+_0x316431['timestamp'][_0x22c2fa(0x1e7)](_0x22c2fa(0x1f2))+'\x0a');_0x316431[_0x22c2fa(0x18b)]&&(_0x13b297+=_0x22c2fa(0x1f9)+_0x316431[_0x22c2fa(0x18b)]+'`\x0a');if(_0x316431[_0x22c2fa(0x189)]){const _0x4a87e6=_0x316431['userAgent'][_0x22c2fa(0x1fe)]>0x32?_0x316431[_0x22c2fa(0x189)][_0x22c2fa(0x20f)](0x0,0x32)+_0x22c2fa(0x1b8):_0x316431['userAgent'];_0x13b297+=_0x22c2fa(0x1b2)+_0x4a87e6+'`\x0a';}!_0x316431[_0x22c2fa(0x15c)]&&(_0x13b297+=_0x22c2fa(0x218)),await this[_0x22c2fa(0x178)](_0x1bf242,_0x13b297,{'parse_mode':_0x22c2fa(0x205)}),console['log'](_0x22c2fa(0x161)+_0x1bf242+':\x20'+(_0x316431[_0x22c2fa(0x15c)]?_0x22c2fa(0x15c):_0x22c2fa(0x1a5)));}catch(_0x5f2817){console['error'](_0x22c2fa(0x1c6),_0x5f2817);}}async[a55_0x251727(0x169)](_0x1a749e,_0xa973d7){const _0x11e926=a55_0x251727;try{const _0x3bb2b7=await database_1['default'][_0x11e926(0x208)][_0x11e926(0x1d3)]({'where':{'shopId':_0x1a749e},'select':{'notificationApiError':!![]}});if(!_0x3bb2b7?.[_0x11e926(0x19d)]){console[_0x11e926(0x1cb)](_0x11e926(0x1d5)+_0x1a749e);return;}let _0xf4faf3=_0x11e926(0x21b)+(_0x11e926(0x1da)+_0xa973d7[_0x11e926(0x1cd)]+'\x20'+_0xa973d7[_0x11e926(0x15b)]+'`\x0a')+(_0x11e926(0x226)+_0xa973d7[_0x11e926(0x22a)][_0x11e926(0x1e7)](_0x11e926(0x1f2))+'\x0a');_0xa973d7[_0x11e926(0x180)]&&(_0xf4faf3+='📊\x20Error\x20code:\x20`'+_0xa973d7['statusCode']+'`\x0a'),_0xf4faf3+=_0x11e926(0x1de)+_0xa973d7[_0x11e926(0x232)]+'`\x0a',_0xa973d7[_0x11e926(0x1e5)]&&(_0xf4faf3+='🆔\x20Request\x20ID:\x20`'+_0xa973d7[_0x11e926(0x1e5)]+'`\x0a'),_0xf4faf3+=_0x11e926(0x1d1),await this[_0x11e926(0x178)](_0x1a749e,_0xf4faf3,{'parse_mode':'Markdown'}),console[_0x11e926(0x1cb)](_0x11e926(0x21d)+_0x1a749e+':\x20'+_0xa973d7[_0x11e926(0x15b)]);}catch(_0x26d2f1){console[_0x11e926(0x22f)](_0x11e926(0x1f8),_0x26d2f1);}}async[a55_0x251727(0x1d9)](_0x2579e2,_0x667d1c,_0x2a3afe){const _0x10625c=a55_0x251727;let _0x523291='🔔\x20*'+_0x667d1c+_0x10625c(0x19a);for(const [_0x2c15bb,_0x5dfe36]of Object['entries'](_0x2a3afe)){_0x5dfe36!==null&&_0x5dfe36!==undefined&&(_0x523291+=_0x2c15bb+_0x10625c(0x1f1)+_0x5dfe36+'`\x0a');}await this['sendShopNotification'](_0x2579e2,_0x523291,{'parse_mode':_0x10625c(0x205)});}[a55_0x251727(0x16d)](){const _0x1b27a4=a55_0x251727;return{'isActive':!!this[_0x1b27a4(0x1b9)],'username':this[_0x1b27a4(0x1d7)]};}[a55_0x251727(0x1b0)](){const _0x1582f2=a55_0x251727;this[_0x1582f2(0x1b9)]&&(this[_0x1582f2(0x1b9)][_0x1582f2(0x217)](),this[_0x1582f2(0x1b9)]=null,console['log'](_0x1582f2(0x1a8)));}}function a55_0x4d84(_0x55240f,_0x322357){const _0x3c635d=a55_0x3c63();return a55_0x4d84=function(_0x4d8415,_0x3bd734){_0x4d8415=_0x4d8415-0x152;let _0x2f2cb0=_0x3c635d[_0x4d8415];return _0x2f2cb0;},a55_0x4d84(_0x55240f,_0x322357);}exports[a55_0x251727(0x1e2)]=TelegramBotService,exports[a55_0x251727(0x1c2)]=new TelegramBotService();