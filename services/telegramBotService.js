'use strict';const a59_0x281e3e=a59_0x21dc;(function(_0x10ab57,_0x3c4540){const _0x56c4ad=a59_0x21dc,_0x49a935=_0x10ab57();while(!![]){try{const _0x22b513=-parseInt(_0x56c4ad(0x1c2))/0x1+parseInt(_0x56c4ad(0x26c))/0x2+-parseInt(_0x56c4ad(0x1d1))/0x3+parseInt(_0x56c4ad(0x1aa))/0x4+-parseInt(_0x56c4ad(0x1ab))/0x5*(parseInt(_0x56c4ad(0x1d9))/0x6)+parseInt(_0x56c4ad(0x1f5))/0x7+parseInt(_0x56c4ad(0x21a))/0x8*(parseInt(_0x56c4ad(0x203))/0x9);if(_0x22b513===_0x3c4540)break;else _0x49a935['push'](_0x49a935['shift']());}catch(_0x2e6983){_0x49a935['push'](_0x49a935['shift']());}}}(a59_0xbdab,0x37581));var __importDefault=this&&this[a59_0x281e3e(0x256)]||function(_0x4fc4ff){return _0x4fc4ff&&_0x4fc4ff['__esModule']?_0x4fc4ff:{'default':_0x4fc4ff};};function a59_0x21dc(_0x2039c7,_0x2b5d3f){const _0xbdab24=a59_0xbdab();return a59_0x21dc=function(_0x21dcc0,_0x2fdee5){_0x21dcc0=_0x21dcc0-0x18f;let _0x3d2f57=_0xbdab24[_0x21dcc0];return _0x3d2f57;},a59_0x21dc(_0x2039c7,_0x2b5d3f);}Object[a59_0x281e3e(0x1a3)](exports,a59_0x281e3e(0x1b4),{'value':!![]}),exports[a59_0x281e3e(0x1a6)]=exports[a59_0x281e3e(0x1f9)]=void 0x0;const node_telegram_bot_api_1=__importDefault(require(a59_0x281e3e(0x221))),database_1=__importDefault(require(a59_0x281e3e(0x273))),gateway_1=require(a59_0x281e3e(0x23a));class TelegramBotService{constructor(){const _0x14a2b1=a59_0x281e3e;this['bot']=null,this['botToken']=process[_0x14a2b1(0x258)][_0x14a2b1(0x26f)]||'',this[_0x14a2b1(0x205)]=process[_0x14a2b1(0x258)]['TELEGRAM_BOT_USERNAME']||_0x14a2b1(0x267),this[_0x14a2b1(0x1e2)]?this['initializeBot']():console['warn'](_0x14a2b1(0x243));}[a59_0x281e3e(0x1d6)](){const _0x25fde4=a59_0x281e3e;try{this[_0x25fde4(0x24d)]=new node_telegram_bot_api_1[(_0x25fde4(0x263))](this[_0x25fde4(0x1e2)],{'polling':!![]}),this['setupBotHandlers'](),console[_0x25fde4(0x1cb)]('✅\x20Telegram\x20bot\x20@'+this[_0x25fde4(0x205)]+'\x20initialized\x20successfully');}catch(_0x1bf0b3){console[_0x25fde4(0x1e4)](_0x25fde4(0x204),_0x1bf0b3);}}['setupBotHandlers'](){const _0x754a2=a59_0x281e3e;if(!this['bot'])return;this['bot'][_0x754a2(0x201)](/\/start/,async _0x595a2b=>{const _0x3c9e33=_0x754a2,_0x3b62d6=_0x595a2b['chat']['id'],_0xe0eb88=_0x595a2b[_0x3c9e33(0x261)]?.['id'][_0x3c9e33(0x228)](),_0x174885=_0x595a2b['from']?.[_0x3c9e33(0x1ae)],_0x283d7d=_0x595a2b[_0x3c9e33(0x261)]?.['first_name'],_0x9d186=_0x595a2b[_0x3c9e33(0x261)]?.[_0x3c9e33(0x19f)];if(!_0xe0eb88)return;try{let _0x59c22d=await database_1[_0x3c9e33(0x263)][_0x3c9e33(0x232)][_0x3c9e33(0x1ea)]({'where':{'telegramId':_0xe0eb88},'include':{'shop':!![]}});!_0x59c22d?(_0x59c22d=await database_1[_0x3c9e33(0x263)]['telegramUser'][_0x3c9e33(0x215)]({'data':{'telegramId':_0xe0eb88,'username':_0x174885,'firstName':_0x283d7d,'lastName':_0x9d186,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console[_0x3c9e33(0x1cb)](_0x3c9e33(0x1fc)+_0xe0eb88+_0x3c9e33(0x1a7)+_0x174885+')')):_0x59c22d=await database_1[_0x3c9e33(0x263)]['telegramUser'][_0x3c9e33(0x249)]({'where':{'telegramId':_0xe0eb88},'data':{'username':_0x174885,'firstName':_0x283d7d,'lastName':_0x9d186},'include':{'shop':!![]}}),_0x59c22d['isVerified']&&_0x59c22d[_0x3c9e33(0x1d0)]&&_0x59c22d[_0x3c9e33(0x230)]?await this['bot']?.['sendMessage'](_0x3b62d6,_0x3c9e33(0x1bc)+(_0x3c9e33(0x1ff)+_0x59c22d[_0x3c9e33(0x230)][_0x3c9e33(0x1bd)]+'*\x0a')+(_0x3c9e33(0x22a)+_0x59c22d['shop'][_0x3c9e33(0x1ae)]+_0x3c9e33(0x1c1))+_0x3c9e33(0x20b)+_0x3c9e33(0x247)+_0x3c9e33(0x22d)+'•\x20Payouts\x0a\x0a'+'Commands:\x0a'+_0x3c9e33(0x1b2)+_0x3c9e33(0x217),{'parse_mode':_0x3c9e33(0x233)}):(_0x59c22d[_0x3c9e33(0x1d0)]&&!_0x59c22d[_0x3c9e33(0x25b)]&&(await database_1[_0x3c9e33(0x263)]['telegramUser']['update']({'where':{'telegramId':_0xe0eb88},'data':{'shopId':null,'isVerified':![]}}),console[_0x3c9e33(0x1cb)](_0x3c9e33(0x1f3)+_0xe0eb88)),await this[_0x3c9e33(0x24d)]?.[_0x3c9e33(0x1ee)](_0x3b62d6,_0x3c9e33(0x234)+'To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a'+_0x3c9e33(0x1cc)+_0x3c9e33(0x207)+_0x3c9e33(0x1d4)+_0x3c9e33(0x222),{'parse_mode':_0x3c9e33(0x233)}));}catch(_0x32de45){console[_0x3c9e33(0x1e4)](_0x3c9e33(0x1af),_0x32de45),await this[_0x3c9e33(0x24d)]?.['sendMessage'](_0x3b62d6,_0x3c9e33(0x1cd));}}),this[_0x754a2(0x24d)][_0x754a2(0x201)](/\/disconnect/,async _0x708646=>{const _0x5b0df6=_0x754a2,_0x200559=_0x708646['chat']['id'],_0x458004=_0x708646[_0x5b0df6(0x261)]?.['id'][_0x5b0df6(0x228)]();if(!_0x458004)return;try{const _0xa98336=await database_1[_0x5b0df6(0x263)][_0x5b0df6(0x232)]['findUnique']({'where':{'telegramId':_0x458004},'include':{'shop':!![]}});if(!_0xa98336||!_0xa98336['isVerified']||!_0xa98336[_0x5b0df6(0x1d0)]){await this[_0x5b0df6(0x24d)]?.[_0x5b0df6(0x1ee)](_0x200559,_0x5b0df6(0x24c));return;}const _0x29da56=_0xa98336[_0x5b0df6(0x230)]?.[_0x5b0df6(0x1bd)]||_0x5b0df6(0x1f4);await database_1['default'][_0x5b0df6(0x232)]['update']({'where':{'telegramId':_0x458004},'data':{'shopId':null,'isVerified':![]}}),console[_0x5b0df6(0x1cb)]('🔌\x20User\x20'+_0x458004+_0x5b0df6(0x197)+_0xa98336[_0x5b0df6(0x1d0)]),await this[_0x5b0df6(0x24d)]?.[_0x5b0df6(0x1ee)](_0x200559,'✅\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*'+_0x29da56+_0x5b0df6(0x25c)+'To\x20reconnect,\x20use\x20the\x20/start\x20command',{'parse_mode':_0x5b0df6(0x233)});}catch(_0x55fb6e){console['error'](_0x5b0df6(0x198),_0x55fb6e),await this[_0x5b0df6(0x24d)]?.[_0x5b0df6(0x1ee)](_0x200559,_0x5b0df6(0x1cd));}}),this[_0x754a2(0x24d)]['onText'](/\/status/,async _0x8ea409=>{const _0x20dfb7=_0x754a2,_0x5ef218=_0x8ea409[_0x20dfb7(0x190)]['id'],_0x1c18ea=_0x8ea409[_0x20dfb7(0x261)]?.['id']['toString']();if(!_0x1c18ea)return;try{const _0x59ef4b=await database_1[_0x20dfb7(0x263)][_0x20dfb7(0x232)][_0x20dfb7(0x1ea)]({'where':{'telegramId':_0x1c18ea},'include':{'shop':!![]}});if(!_0x59ef4b){await this['bot']?.['sendMessage'](_0x5ef218,_0x20dfb7(0x1c6)+'Use\x20/start\x20to\x20begin.');return;}if(!_0x59ef4b['isVerified']||!_0x59ef4b[_0x20dfb7(0x1d0)]||!_0x59ef4b[_0x20dfb7(0x230)]){await this[_0x20dfb7(0x24d)]?.[_0x20dfb7(0x1ee)](_0x5ef218,_0x20dfb7(0x20f)+_0x20dfb7(0x24e));return;}await this['bot']?.[_0x20dfb7(0x1ee)](_0x5ef218,_0x20dfb7(0x194)+(_0x20dfb7(0x211)+_0x59ef4b[_0x20dfb7(0x230)][_0x20dfb7(0x1bd)]+'*\x0a')+('👤\x20Username:\x20`'+_0x59ef4b['shop'][_0x20dfb7(0x1ae)]+'`\x0a')+(_0x20dfb7(0x22b)+_0x59ef4b['updatedAt'][_0x20dfb7(0x1b6)](_0x20dfb7(0x202))+'\x0a\x0a')+'🔔\x20Notifications\x20are\x20active\x0a\x0a'+_0x20dfb7(0x1e7)+_0x20dfb7(0x217),{'parse_mode':'Markdown'});}catch(_0x47dced){console[_0x20dfb7(0x1e4)](_0x20dfb7(0x1da),_0x47dced),await this[_0x20dfb7(0x24d)]?.[_0x20dfb7(0x1ee)](_0x5ef218,'❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this[_0x754a2(0x24d)][_0x754a2(0x201)](/\/debug/,async _0x51627a=>{const _0xf2109c=_0x754a2,_0x51461f=_0x51627a['chat']['id'],_0x46da9a=_0x51627a[_0xf2109c(0x261)]?.['id'][_0xf2109c(0x228)]();if(!_0x46da9a)return;try{const _0x4a1eb0=await database_1[_0xf2109c(0x263)][_0xf2109c(0x230)][_0xf2109c(0x1b1)]({'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![]},'take':0xa});let _0x300fd3=_0xf2109c(0x272);_0x300fd3+=_0xf2109c(0x266)+_0x46da9a+'`\x0a\x0a',_0x300fd3+=_0xf2109c(0x1db),_0x4a1eb0[_0xf2109c(0x1b9)]((_0x958d04,_0x5a2a53)=>{const _0x518a24=_0xf2109c;_0x300fd3+=_0x5a2a53+0x1+_0x518a24(0x262)+_0x958d04[_0x518a24(0x1bd)]+'*\x0a',_0x300fd3+='\x20\x20\x20Username:\x20`'+_0x958d04[_0x518a24(0x1ae)]+'`\x0a',_0x300fd3+=_0x518a24(0x193)+_0x958d04['status']+'\x0a',_0x300fd3+=_0x518a24(0x271)+_0x958d04[_0x518a24(0x1c5)][_0x518a24(0x26d)](0x0,0xf)+_0x518a24(0x269);}),await this['bot']?.['sendMessage'](_0x51461f,_0x300fd3,{'parse_mode':_0xf2109c(0x233)});}catch(_0x1ae91c){console[_0xf2109c(0x1e4)](_0xf2109c(0x1ed),_0x1ae91c),await this[_0xf2109c(0x24d)]?.[_0xf2109c(0x1ee)](_0x51461f,_0xf2109c(0x25e));}}),this['bot']['on']('message',async _0x3ffccb=>{const _0x1611fd=_0x754a2;if(_0x3ffccb[_0x1611fd(0x1f6)]?.[_0x1611fd(0x20c)]('/'))return;const _0x14db02=_0x3ffccb[_0x1611fd(0x190)]['id'],_0x4872f9=_0x3ffccb[_0x1611fd(0x261)]?.['id'][_0x1611fd(0x228)](),_0x240c92=_0x3ffccb[_0x1611fd(0x1f6)]?.['trim']();if(!_0x4872f9||!_0x240c92)return;try{const _0x24d18c=await database_1[_0x1611fd(0x263)][_0x1611fd(0x232)]['findUnique']({'where':{'telegramId':_0x4872f9},'include':{'shop':!![]}});if(!_0x24d18c){await this[_0x1611fd(0x24d)]?.[_0x1611fd(0x1ee)](_0x14db02,_0x1611fd(0x1ca));return;}if(_0x24d18c['isVerified']&&_0x24d18c[_0x1611fd(0x1d0)]&&_0x24d18c['shop']){await this[_0x1611fd(0x24d)]?.['sendMessage'](_0x14db02,'✅\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*'+_0x24d18c[_0x1611fd(0x230)][_0x1611fd(0x1bd)]+_0x1611fd(0x25c)+_0x1611fd(0x1b7),{'parse_mode':'Markdown'});return;}const _0x25e680=_0x240c92[_0x1611fd(0x1fa)](/\s+/);if(_0x25e680[_0x1611fd(0x25f)]!==0x2){await this[_0x1611fd(0x24d)]?.[_0x1611fd(0x1ee)](_0x14db02,'❌\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a'+_0x1611fd(0x1cc)+_0x1611fd(0x207)+_0x1611fd(0x1d4)+(_0x1611fd(0x248)+_0x25e680[_0x1611fd(0x25f)]+_0x1611fd(0x1f8)+_0x25e680[_0x1611fd(0x20d)](_0x5cc9c8=>'`'+_0x5cc9c8+'`')[_0x1611fd(0x19e)](',\x20')),{'parse_mode':'Markdown'});return;}const [_0x279d0c,_0x492646]=_0x25e680;console[_0x1611fd(0x1cb)](_0x1611fd(0x1b3)+_0x4872f9+_0x1611fd(0x218)+_0x279d0c+_0x1611fd(0x1a4)+_0x492646['substring'](0x0,0xa)+_0x1611fd(0x23d)),await this[_0x1611fd(0x23f)](_0x14db02,_0x4872f9,_0x279d0c,_0x492646);}catch(_0x562aeb){console[_0x1611fd(0x1e4)](_0x1611fd(0x22e),_0x562aeb),await this[_0x1611fd(0x24d)]?.['sendMessage'](_0x14db02,_0x1611fd(0x1cd));}}),this['bot']['on'](_0x754a2(0x1e4),_0x265465=>{const _0x425d52=_0x754a2;console[_0x425d52(0x1e4)]('Telegram\x20bot\x20error:',_0x265465);}),this[_0x754a2(0x24d)]['on'](_0x754a2(0x1c4),_0x14b5f3=>{const _0x4e3fc0=_0x754a2;console[_0x4e3fc0(0x1e4)](_0x4e3fc0(0x270),_0x14b5f3);});}async['handleSingleLineVerification'](_0x19c7b,_0x5aa33f,_0xd826c2,_0x502332){const _0x1d339f=a59_0x281e3e;try{console[_0x1d339f(0x1cb)](_0x1d339f(0x1b3)+_0x5aa33f+_0x1d339f(0x218)+_0xd826c2+_0x1d339f(0x1a4)+_0x502332[_0x1d339f(0x26d)](0x0,0xa)+'...\x22');if(!_0xd826c2||_0xd826c2['length']<0x3||_0xd826c2['length']>0x32||!/^[a-zA-Z0-9_]+$/[_0x1d339f(0x1ad)](_0xd826c2)){await this[_0x1d339f(0x24d)]?.[_0x1d339f(0x1ee)](_0x19c7b,_0x1d339f(0x226)+_0xd826c2+_0x1d339f(0x1c1)+'Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).',{'parse_mode':'Markdown'});return;}if(!_0x502332||!_0x502332[_0x1d339f(0x20c)](_0x1d339f(0x1d7))&&!_0x502332[_0x1d339f(0x20c)](_0x1d339f(0x239))){await this['bot']?.['sendMessage'](_0x19c7b,_0x1d339f(0x264)+_0x1d339f(0x1dd),{'parse_mode':'Markdown'});return;}const _0x5170b5=await database_1[_0x1d339f(0x263)][_0x1d339f(0x230)][_0x1d339f(0x1ea)]({'where':{'username':_0xd826c2},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x5170b5){const _0x32492b=await database_1[_0x1d339f(0x263)][_0x1d339f(0x230)][_0x1d339f(0x1b1)]({'select':{'username':!![],'name':!![]},'take':0x5});let _0x17baab=_0x1d339f(0x1a0)+_0xd826c2+_0x1d339f(0x241);_0x32492b[_0x1d339f(0x25f)]>0x0?(_0x17baab+=_0x1d339f(0x21e),_0x32492b[_0x1d339f(0x1b9)](_0x5c7d05=>{const _0x58cb41=_0x1d339f;_0x17baab+='•\x20`'+_0x5c7d05[_0x58cb41(0x1ae)]+'`\x20('+_0x5c7d05[_0x58cb41(0x1bd)]+')\x0a';}),_0x17baab+=_0x1d339f(0x209)):_0x17baab+=_0x1d339f(0x1eb);await this[_0x1d339f(0x24d)]?.[_0x1d339f(0x1ee)](_0x19c7b,_0x17baab,{'parse_mode':_0x1d339f(0x233)});return;}if(_0x5170b5[_0x1d339f(0x26b)]!==_0x1d339f(0x1f2)){await this['bot']?.[_0x1d339f(0x1ee)](_0x19c7b,_0x1d339f(0x252)+_0xd826c2+_0x1d339f(0x1f0)+_0x1d339f(0x268),{'parse_mode':'Markdown'});return;}if(_0x5170b5['publicKey']!==_0x502332&&_0x5170b5[_0x1d339f(0x191)]!==_0x502332){await this[_0x1d339f(0x24d)]?.[_0x1d339f(0x1ee)](_0x19c7b,_0x1d339f(0x18f)+_0xd826c2+_0x1d339f(0x245)+_0x1d339f(0x1e9)+'Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`',{'parse_mode':_0x1d339f(0x233)});return;}const _0x50435f=await database_1[_0x1d339f(0x263)][_0x1d339f(0x232)][_0x1d339f(0x255)]({'where':{'shopId':_0x5170b5['id'],'isVerified':!![],'telegramId':{'not':_0x5aa33f}}});if(_0x50435f){await this[_0x1d339f(0x24d)]?.['sendMessage'](_0x19c7b,_0x1d339f(0x1c7)+_0xd826c2+_0x1d339f(0x245)+_0x1d339f(0x1ba),{'parse_mode':'Markdown'});return;}await database_1['default'][_0x1d339f(0x232)]['update']({'where':{'telegramId':_0x5aa33f},'data':{'shopId':_0x5170b5['id'],'isVerified':!![]}}),await this['bot']?.[_0x1d339f(0x1ee)](_0x19c7b,_0x1d339f(0x1b8)+'✅\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a'+(_0x1d339f(0x1b5)+_0x5170b5[_0x1d339f(0x1bd)]+'*\x0a')+(_0x1d339f(0x1e0)+_0x5170b5[_0x1d339f(0x1ae)]+'`\x0a\x0a')+_0x1d339f(0x1de)+_0x1d339f(0x247)+_0x1d339f(0x22d)+_0x1d339f(0x250)+_0x1d339f(0x1ec)+_0x1d339f(0x1e7)+_0x1d339f(0x1b2)+_0x1d339f(0x217),{'parse_mode':'Markdown'}),console[_0x1d339f(0x1cb)]('✅\x20Telegram\x20user\x20'+_0x5aa33f+_0x1d339f(0x1c9)+_0x5170b5[_0x1d339f(0x1ae)]+'\x20via\x20single-line\x20input');}catch(_0x4b4904){console[_0x1d339f(0x1e4)]('Error\x20in\x20handleSingleLineVerification:',_0x4b4904),await this[_0x1d339f(0x24d)]?.[_0x1d339f(0x1ee)](_0x19c7b,_0x1d339f(0x1ef));}}async[a59_0x281e3e(0x1be)](_0x19cb64,_0x155cdf,_0x5eb42d){const _0x56e085=a59_0x281e3e;if(!this[_0x56e085(0x24d)]){console[_0x56e085(0x236)](_0x56e085(0x246));return;}try{const _0x49f42c=await database_1[_0x56e085(0x263)][_0x56e085(0x232)]['findMany']({'where':{'shopId':_0x19cb64,'isVerified':!![]}});if(_0x49f42c[_0x56e085(0x25f)]===0x0){console[_0x56e085(0x1cb)](_0x56e085(0x265)+_0x19cb64);return;}const _0x3c30d9=_0x49f42c['map'](async _0x1efd53=>{const _0x575d0b=_0x56e085;try{await this['bot']?.['sendMessage'](_0x1efd53[_0x575d0b(0x196)],_0x155cdf,_0x5eb42d),console[_0x575d0b(0x1cb)](_0x575d0b(0x224)+_0x1efd53[_0x575d0b(0x196)]);}catch(_0x35ced8){console[_0x575d0b(0x1e4)]('❌\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20'+_0x1efd53[_0x575d0b(0x196)]+':',_0x35ced8),_0x35ced8 instanceof Error&&(_0x35ced8['message']['includes'](_0x575d0b(0x238))||_0x35ced8['message'][_0x575d0b(0x24b)](_0x575d0b(0x22f))||_0x35ced8[_0x575d0b(0x21b)][_0x575d0b(0x24b)](_0x575d0b(0x1a2)))&&(await database_1[_0x575d0b(0x263)][_0x575d0b(0x232)][_0x575d0b(0x249)]({'where':{'id':_0x1efd53['id']},'data':{'isVerified':![]}}),console[_0x575d0b(0x1cb)](_0x575d0b(0x206)+_0x1efd53[_0x575d0b(0x196)]+'\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure'));}});await Promise[_0x56e085(0x225)](_0x3c30d9);}catch(_0x37c0d5){console[_0x56e085(0x1e4)](_0x56e085(0x1c8),_0x37c0d5);}}async['sendPaymentNotification'](_0x9f2f67,_0x498f8b,_0x4f0cc8){const _0x334725=a59_0x281e3e,_0x31978d={'created':'🆕','paid':'✅','failed':'❌','expired':'⏰','refund':'🔄','chargeback':'⚠️','processing':'⚙️'},_0x53b08c={'created':'New\x20payment\x20created','paid':_0x334725(0x1b0),'failed':_0x334725(0x1e8),'expired':'Payment\x20expired','refund':'Payment\x20refund','chargeback':_0x334725(0x21d),'processing':_0x334725(0x1a8)},_0x544f4d=_0x31978d[_0x4f0cc8],_0x19c63a=_0x53b08c[_0x4f0cc8],_0x533a53=(0x0,gateway_1['getGatewayDisplayNameForTelegram'])(_0x498f8b['gateway']);console['log']('📱\x20Telegram\x20notification:\x20gateway\x20\x22'+_0x498f8b[_0x334725(0x253)]+'\x22\x20->\x20display\x20\x22'+_0x533a53+'\x22');let _0x3241be=_0x544f4d+'\x20*'+_0x19c63a+_0x334725(0x1ce)+(_0x334725(0x200)+_0x498f8b['amount']+'\x20'+_0x498f8b[_0x334725(0x21c)]+'*\x0a')+(_0x334725(0x210)+(_0x498f8b[_0x334725(0x208)]||_0x498f8b['id'])+'`\x0a')+(_0x334725(0x1e5)+_0x498f8b['id']+'`\x0a')+('🏪\x20Gateway:\x20`'+_0x533a53+'`\x0a')+('📅\x20Date:\x20'+new Date(_0x498f8b[_0x334725(0x1d8)])['toLocaleString'](_0x334725(0x202))+'\x0a');if(_0x498f8b[_0x334725(0x220)]||_0x498f8b[_0x334725(0x1dc)]||_0x498f8b[_0x334725(0x23b)]||_0x498f8b['customerIp']||_0x498f8b[_0x334725(0x19a)]){_0x3241be+=_0x334725(0x257);_0x498f8b[_0x334725(0x220)]&&(_0x3241be+=_0x334725(0x19b)+_0x498f8b[_0x334725(0x220)]+'`\x0a');_0x498f8b[_0x334725(0x1dc)]&&(_0x3241be+=_0x334725(0x192)+_0x498f8b[_0x334725(0x1dc)]+'`\x0a');_0x498f8b[_0x334725(0x23b)]&&(_0x3241be+=_0x334725(0x1bf)+_0x498f8b[_0x334725(0x23b)]+'`\x0a');_0x498f8b[_0x334725(0x254)]&&(_0x3241be+=_0x334725(0x24f)+_0x498f8b[_0x334725(0x254)]+'`\x0a');if(_0x498f8b[_0x334725(0x19a)]){const _0x596086=_0x498f8b['customerUa'][_0x334725(0x25f)]>0x32?_0x498f8b[_0x334725(0x19a)][_0x334725(0x26d)](0x0,0x32)+_0x334725(0x242):_0x498f8b[_0x334725(0x19a)];_0x3241be+=_0x334725(0x20e)+_0x596086+'`\x0a';}}_0x4f0cc8===_0x334725(0x20a)&&_0x498f8b['chargebackAmount']&&(_0x3241be+=_0x334725(0x1fe)+_0x498f8b[_0x334725(0x1a5)]+_0x334725(0x25a)),_0x4f0cc8==='processing'&&(_0x3241be+=_0x334725(0x26a)),_0x498f8b[_0x334725(0x216)]&&(_0x3241be+=_0x334725(0x1f1)+_0x498f8b['adminNotes']+'\x0a'),await this[_0x334725(0x1be)](_0x9f2f67,_0x3241be,{'parse_mode':_0x334725(0x233)});}async['sendPayoutNotification'](_0x3ce9b7,_0x291c84,_0x3774fb){const _0x3fb82d=a59_0x281e3e,_0x2bf6d6={'created':'📤','completed':'✅','rejected':'❌'},_0x3ee818={'created':_0x3fb82d(0x1d2),'completed':_0x3fb82d(0x219),'rejected':_0x3fb82d(0x24a)},_0x245067=_0x2bf6d6[_0x3774fb],_0x4308cb=_0x3ee818[_0x3774fb],_0x2c529f=_0x245067+'\x20*'+_0x4308cb+_0x3fb82d(0x1ce)+(_0x3fb82d(0x23c)+_0x291c84[_0x3fb82d(0x1a1)]+_0x3fb82d(0x231))+('🏦\x20Method:\x20`'+_0x291c84[_0x3fb82d(0x1d5)]+'`\x0a')+(_0x3fb82d(0x1d3)+_0x291c84['id']+'`\x0a')+('📅\x20Date:\x20'+new Date(_0x291c84[_0x3fb82d(0x1d8)])['toLocaleString'](_0x3fb82d(0x202))+'\x0a')+(_0x291c84[_0x3fb82d(0x1e1)]?_0x3fb82d(0x1c0)+_0x291c84[_0x3fb82d(0x1e1)]+'`':'');await this['sendShopNotification'](_0x3ce9b7,_0x2c529f,{'parse_mode':_0x3fb82d(0x233)});}async[a59_0x281e3e(0x213)](_0x264323,_0x1fdeff){const _0x217661=a59_0x281e3e;try{const _0x374159=await database_1[_0x217661(0x263)][_0x217661(0x1e3)][_0x217661(0x1ea)]({'where':{'shopId':_0x264323},'select':{'notificationLogin':!![]}});if(!_0x374159?.[_0x217661(0x22c)]){console['log']('📱\x20Login\x20notifications\x20disabled\x20for\x20shop\x20'+_0x264323);return;}const _0x36c286=_0x1fdeff['success']?'🔐':'🚨',_0x4b263f=_0x1fdeff['success']?_0x217661(0x19d):_0x217661(0x1a9);let _0xcdd64a=_0x36c286+'\x20*'+_0x4b263f+'*\x0a\x0a'+('👤\x20Username:\x20`'+_0x1fdeff[_0x217661(0x1ae)]+'`\x0a')+(_0x217661(0x1f7)+_0x1fdeff[_0x217661(0x21f)]['toLocaleString'](_0x217661(0x202))+'\x0a');_0x1fdeff[_0x217661(0x260)]&&(_0xcdd64a+='🌐\x20IP\x20address:\x20`'+_0x1fdeff[_0x217661(0x260)]+'`\x0a');if(_0x1fdeff[_0x217661(0x1fd)]){const _0x4fa65a=_0x1fdeff[_0x217661(0x1fd)]['length']>0x32?_0x1fdeff['userAgent'][_0x217661(0x26d)](0x0,0x32)+_0x217661(0x242):_0x1fdeff[_0x217661(0x1fd)];_0xcdd64a+=_0x217661(0x20e)+_0x4fa65a+'`\x0a';}!_0x1fdeff['success']&&(_0xcdd64a+=_0x217661(0x212)),await this[_0x217661(0x1be)](_0x264323,_0xcdd64a,{'parse_mode':_0x217661(0x233)}),console[_0x217661(0x1cb)](_0x217661(0x1c3)+_0x264323+':\x20'+(_0x1fdeff['success']?'success':_0x217661(0x240)));}catch(_0x54802e){console[_0x217661(0x1e4)]('Failed\x20to\x20send\x20login\x20notification:',_0x54802e);}}async[a59_0x281e3e(0x259)](_0x55dfad,_0xd83035){const _0x1de453=a59_0x281e3e;try{const _0xad2cc9=await database_1[_0x1de453(0x263)][_0x1de453(0x1e3)][_0x1de453(0x1ea)]({'where':{'shopId':_0x55dfad},'select':{'notificationApiError':!![]}});if(!_0xad2cc9?.[_0x1de453(0x26e)]){console['log'](_0x1de453(0x244)+_0x55dfad);return;}let _0x14b236=_0x1de453(0x1ac)+(_0x1de453(0x25d)+_0xd83035[_0x1de453(0x1d5)]+'\x20'+_0xd83035[_0x1de453(0x214)]+'`\x0a')+('📅\x20Time:\x20'+_0xd83035['timestamp'][_0x1de453(0x223)]('en-US')+'\x0a');_0xd83035['statusCode']&&(_0x14b236+=_0x1de453(0x1fb)+_0xd83035[_0x1de453(0x199)]+'`\x0a'),_0x14b236+=_0x1de453(0x1cf)+_0xd83035['errorMessage']+'`\x0a',_0xd83035[_0x1de453(0x1bb)]&&(_0x14b236+=_0x1de453(0x251)+_0xd83035['requestId']+'`\x0a'),_0x14b236+=_0x1de453(0x195),await this[_0x1de453(0x1be)](_0x55dfad,_0x14b236,{'parse_mode':'Markdown'}),console[_0x1de453(0x1cb)](_0x1de453(0x19c)+_0x55dfad+':\x20'+_0xd83035[_0x1de453(0x214)]);}catch(_0x56bf14){console[_0x1de453(0x1e4)]('Failed\x20to\x20send\x20API\x20error\x20notification:',_0x56bf14);}}async['sendCustomNotification'](_0x2a701d,_0x28b804,_0x2e9eac){const _0x1e8b53=a59_0x281e3e;let _0x5cacd7=_0x1e8b53(0x23e)+_0x28b804+_0x1e8b53(0x1ce);for(const [_0x234339,_0x346b3d]of Object[_0x1e8b53(0x229)](_0x2e9eac)){_0x346b3d!==null&&_0x346b3d!==undefined&&(_0x5cacd7+=_0x234339+_0x1e8b53(0x1e6)+_0x346b3d+'`\x0a');}await this[_0x1e8b53(0x1be)](_0x2a701d,_0x5cacd7,{'parse_mode':_0x1e8b53(0x233)});}[a59_0x281e3e(0x237)](){const _0x2aa97d=a59_0x281e3e;return{'isActive':!!this[_0x2aa97d(0x24d)],'username':this[_0x2aa97d(0x205)]};}[a59_0x281e3e(0x227)](){const _0x27f0bd=a59_0x281e3e;this[_0x27f0bd(0x24d)]&&(this[_0x27f0bd(0x24d)][_0x27f0bd(0x235)](),this['bot']=null,console['log'](_0x27f0bd(0x1df)));}}function a59_0xbdab(){const _0x256965=['\x0a💡\x20Check\x20your\x20request\x20or\x20contact\x20support.','telegramId','\x20disconnected\x20from\x20shop\x20','Error\x20handling\x20/disconnect\x20command:','statusCode','customerUa','📛\x20Name:\x20`','✅\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20','Successful\x20login','join','last_name','❌\x20Shop\x20with\x20username\x20`','amount','user\x20is\x20deactivated','defineProperty','\x22,\x20apiKey=\x22','chargebackAmount','telegramBotService','\x20(@','Payment\x20is\x20being\x20processed','Failed\x20login\x20attempt','1493016EAhwzY','5KtrUjs','🚨\x20*API\x20Error*\x0a\x0a','test','username','Error\x20handling\x20/start\x20command:','Payment\x20successfully\x20paid','findMany','/status\x20-\x20check\x20connection\x20status\x0a','🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20','__esModule','📱\x20Shop:\x20*','toLocaleDateString','Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.','🎉\x20*Congratulations!*\x0a\x0a','forEach','Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.','requestId','✅\x20Welcome\x20back!\x0a\x0a','name','sendShopNotification','🏦\x20IBAN:\x20`','🔗\x20TXID:\x20`','`\x0a\x0a','73996KDXRvg','✅\x20Login\x20notification\x20sent\x20for\x20shop\x20','polling_error','publicKey','❌\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a','❌\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`','Error\x20sending\x20shop\x20notification:','\x20verified\x20for\x20shop\x20','❌\x20Please\x20use\x20/start\x20command\x20first','log','📝\x20Format:\x20`username\x20api_key`\x0a\x0a','❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','*\x0a\x0a','❌\x20Error:\x20`','shopId','1289481soDLfu','New\x20payout\x20created','🆔\x20Payout\x20ID:\x20`','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','method','initializeBot','pk_','createdAt','2362212qaWmnN','Error\x20handling\x20/status\x20command:','🏪\x20Available\x20shops\x20in\x20system:\x0a','customerEmail','API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','🔔\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a','🛑\x20Telegram\x20bot\x20stopped','👤\x20Username:\x20`','txid','botToken','shopSettings','error','🆔\x20Payment\x20ID:\x20`',':\x20`','Commands:\x0a','Payment\x20failed','Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a','findUnique','Check\x20spelling\x20and\x20try\x20again.','•\x20Important\x20events\x0a\x0a','Error\x20handling\x20/debug\x20command:','sendMessage','❌\x20An\x20error\x20occurred\x20while\x20verifying\x20data.','`\x20is\x20inactive.\x0a\x0a','📝\x20Notes:\x20','ACTIVE','🔄\x20Reset\x20incomplete\x20verification\x20for\x20user\x20','unknown\x20shop','3053113yrmYXm','text','📅\x20Time:\x20','\x20parts:\x20','TelegramBotService','split','📊\x20Error\x20code:\x20`','📱\x20Created\x20new\x20Telegram\x20user:\x20','userAgent','💸\x20Penalty\x20amount:\x20*','You\x20are\x20already\x20connected\x20to\x20shop:\x20*','💰\x20Amount:\x20*','onText','en-US','38817TCrqFu','❌\x20Failed\x20to\x20initialize\x20Telegram\x20bot:','botUsername','User\x20','Example:\x0a','orderId','\x0aCheck\x20spelling\x20and\x20try\x20again.','chargeback','🔔\x20You\x20receive\x20notifications\x20about:\x0a','startsWith','map','💻\x20Browser:\x20`','❌\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a','📝\x20Order\x20ID:\x20`','✅\x20Connected\x20to\x20shop:\x20*','\x0a⚠️\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!','sendLoginNotification','endpoint','create','adminNotes','/disconnect\x20-\x20disconnect\x20from\x20notifications',':\x20username=\x22','Payout\x20completed','440rGdurh','message','currency','Payment\x20chargeback','Available\x20usernames:\x0a','timestamp','customerName','node-telegram-bot-api','❗️\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!','toLocaleString','✅\x20Notification\x20sent\x20to\x20Telegram\x20user\x20','allSettled','❌\x20Invalid\x20username\x20format:\x20`','stopBot','toString','entries','Username:\x20`','📅\x20Connection\x20date:\x20','notificationLogin','•\x20Payment\x20status\x20changes\x0a','Error\x20handling\x20message:','chat\x20not\x20found','shop','\x20USD*\x0a','telegramUser','Markdown','🤖\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a','stopPolling','warn','getBotInfo','blocked','sk_','../types/gateway','remitterIban','💸\x20Amount:\x20*','...\x22','🔔\x20*','handleSingleLineVerification','failed','`\x20not\x20found.\x0a\x0a','...','TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables','📱\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20','`.\x0a\x0a','Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification','•\x20New\x20payments\x0a','You\x20sent\x20','update','Payout\x20rejected','includes','❌\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.','bot','Use\x20/start\x20to\x20connect.','🌐\x20IP:\x20`','•\x20Payouts\x0a','🆔\x20Request\x20ID:\x20`','❌\x20Shop\x20`','gateway','customerIp','findFirst','__importDefault','\x0a👤\x20*Customer\x20Information:*\x0a','env','sendApiErrorNotification','\x20USDT*\x0a','isVerified','*.\x0a\x0a','🔗\x20Endpoint:\x20`','❌\x20Error\x20getting\x20debug\x20information.','length','ipAddress','from','.\x20*','default','❌\x20Invalid\x20API\x20key\x20format.\x0a\x0a','No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20','📱\x20Your\x20Telegram\x20ID:\x20`','trapay_bot','Contact\x20administrator.','...`\x0a\x0a','⏳\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a','status','155172hpMgvs','substring','notificationApiError','TELEGRAM_BOT_TOKEN','Telegram\x20bot\x20polling\x20error:','\x20\x20\x20Public\x20Key:\x20`','🔍\x20*Debug\x20Information*\x0a\x0a','../config/database','❌\x20API\x20key\x20does\x20not\x20match\x20shop\x20`','chat','secretKey','📧\x20Email:\x20`','\x20\x20\x20Status:\x20','📊\x20*Connection\x20Status*\x0a\x0a'];a59_0xbdab=function(){return _0x256965;};return a59_0xbdab();}exports[a59_0x281e3e(0x1f9)]=TelegramBotService,exports[a59_0x281e3e(0x1a6)]=new TelegramBotService();