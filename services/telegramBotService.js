'use strict';const a57_0x4c8d67=a57_0x286d;(function(_0xa3e88c,_0x46190e){const _0x50676b=a57_0x286d,_0x4cb5bb=_0xa3e88c();while(!![]){try{const _0x1e8503=parseInt(_0x50676b(0x1a7))/0x1+parseInt(_0x50676b(0x1ca))/0x2+parseInt(_0x50676b(0x236))/0x3+-parseInt(_0x50676b(0x1a8))/0x4+parseInt(_0x50676b(0x1cc))/0x5*(-parseInt(_0x50676b(0x250))/0x6)+-parseInt(_0x50676b(0x22b))/0x7*(-parseInt(_0x50676b(0x1ef))/0x8)+-parseInt(_0x50676b(0x21a))/0x9;if(_0x1e8503===_0x46190e)break;else _0x4cb5bb['push'](_0x4cb5bb['shift']());}catch(_0x1a86f4){_0x4cb5bb['push'](_0x4cb5bb['shift']());}}}(a57_0x233d,0xcc6a6));var __importDefault=this&&this['__importDefault']||function(_0x25efa7){const _0xc0a018=a57_0x286d;return _0x25efa7&&_0x25efa7[_0xc0a018(0x201)]?_0x25efa7:{'default':_0x25efa7};};Object[a57_0x4c8d67(0x213)](exports,a57_0x4c8d67(0x201),{'value':!![]}),exports[a57_0x4c8d67(0x27c)]=exports['TelegramBotService']=void 0x0;const node_telegram_bot_api_1=__importDefault(require(a57_0x4c8d67(0x267))),database_1=__importDefault(require(a57_0x4c8d67(0x1f0))),gateway_1=require(a57_0x4c8d67(0x1a5));function a57_0x286d(_0x1eb68b,_0x112e39){const _0x233dd9=a57_0x233d();return a57_0x286d=function(_0x286ded,_0x1d4439){_0x286ded=_0x286ded-0x19e;let _0x334a91=_0x233dd9[_0x286ded];return _0x334a91;},a57_0x286d(_0x1eb68b,_0x112e39);}class TelegramBotService{constructor(){const _0x381ef3=a57_0x4c8d67;this[_0x381ef3(0x24f)]=null,this[_0x381ef3(0x23d)]=process[_0x381ef3(0x282)][_0x381ef3(0x266)]||'',this[_0x381ef3(0x273)]=process[_0x381ef3(0x282)]['TELEGRAM_BOT_USERNAME']||'trapay_bot',this['botToken']?this[_0x381ef3(0x23e)]():console[_0x381ef3(0x261)](_0x381ef3(0x1ab));}['initializeBot'](){const _0x19ef91=a57_0x4c8d67;try{this[_0x19ef91(0x24f)]=new node_telegram_bot_api_1[(_0x19ef91(0x275))](this[_0x19ef91(0x23d)],{'polling':!![]}),this[_0x19ef91(0x25f)](),console['log']('‚úÖ\x20Telegram\x20bot\x20@'+this[_0x19ef91(0x273)]+_0x19ef91(0x1f5));}catch(_0x56bc69){console[_0x19ef91(0x212)](_0x19ef91(0x1ac),_0x56bc69);}}[a57_0x4c8d67(0x25f)](){const _0x5782ab=a57_0x4c8d67;if(!this['bot'])return;this[_0x5782ab(0x24f)][_0x5782ab(0x1da)](/\/start/,async _0x109bc0=>{const _0x23243d=_0x5782ab,_0xf759d9=_0x109bc0['chat']['id'],_0x3f0262=_0x109bc0['from']?.['id'][_0x23243d(0x247)](),_0x11117d=_0x109bc0[_0x23243d(0x21c)]?.[_0x23243d(0x24d)],_0x3ec7dc=_0x109bc0[_0x23243d(0x21c)]?.['first_name'],_0x59b8a0=_0x109bc0[_0x23243d(0x21c)]?.[_0x23243d(0x1a9)];if(!_0x3f0262)return;try{let _0x428ccc=await database_1[_0x23243d(0x275)]['telegramUser']['findUnique']({'where':{'telegramId':_0x3f0262},'include':{'shop':!![]}});!_0x428ccc?(_0x428ccc=await database_1[_0x23243d(0x275)][_0x23243d(0x242)][_0x23243d(0x230)]({'data':{'telegramId':_0x3f0262,'username':_0x11117d,'firstName':_0x3ec7dc,'lastName':_0x59b8a0,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console[_0x23243d(0x21e)](_0x23243d(0x1e8)+_0x3f0262+_0x23243d(0x203)+_0x11117d+')')):_0x428ccc=await database_1['default'][_0x23243d(0x242)][_0x23243d(0x21d)]({'where':{'telegramId':_0x3f0262},'data':{'username':_0x11117d,'firstName':_0x3ec7dc,'lastName':_0x59b8a0},'include':{'shop':!![]}}),_0x428ccc['isVerified']&&_0x428ccc['shopId']&&_0x428ccc['shop']?await this[_0x23243d(0x24f)]?.[_0x23243d(0x234)](_0xf759d9,_0x23243d(0x1ae)+(_0x23243d(0x1a1)+_0x428ccc[_0x23243d(0x263)]['name']+'*\x0a')+('Username:\x20`'+_0x428ccc[_0x23243d(0x263)][_0x23243d(0x24d)]+_0x23243d(0x1eb))+_0x23243d(0x27f)+'‚Ä¢\x20New\x20payments\x0a'+'‚Ä¢\x20Payment\x20status\x20changes\x0a'+_0x23243d(0x277)+_0x23243d(0x1ec)+'/status\x20-\x20check\x20connection\x20status\x0a'+_0x23243d(0x1c7),{'parse_mode':_0x23243d(0x20a)}):(_0x428ccc[_0x23243d(0x264)]&&!_0x428ccc[_0x23243d(0x26f)]&&(await database_1[_0x23243d(0x275)][_0x23243d(0x242)]['update']({'where':{'telegramId':_0x3f0262},'data':{'shopId':null,'isVerified':![]}}),console[_0x23243d(0x21e)]('üîÑ\x20Reset\x20incomplete\x20verification\x20for\x20user\x20'+_0x3f0262)),await this['bot']?.[_0x23243d(0x234)](_0xf759d9,'ü§ñ\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a'+'To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a'+_0x23243d(0x269)+_0x23243d(0x22e)+_0x23243d(0x1fe)+'‚ùóÔ∏è\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!',{'parse_mode':_0x23243d(0x20a)}));}catch(_0x5ecb6f){console['error']('Error\x20handling\x20/start\x20command:',_0x5ecb6f),await this[_0x23243d(0x24f)]?.[_0x23243d(0x234)](_0xf759d9,'‚ùå\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this[_0x5782ab(0x24f)][_0x5782ab(0x1da)](/\/disconnect/,async _0x5f5a89=>{const _0xc9aa84=_0x5782ab,_0x5d12b9=_0x5f5a89['chat']['id'],_0x59383d=_0x5f5a89[_0xc9aa84(0x21c)]?.['id'][_0xc9aa84(0x247)]();if(!_0x59383d)return;try{const _0x4e347a=await database_1[_0xc9aa84(0x275)][_0xc9aa84(0x242)]['findUnique']({'where':{'telegramId':_0x59383d},'include':{'shop':!![]}});if(!_0x4e347a||!_0x4e347a[_0xc9aa84(0x26f)]||!_0x4e347a[_0xc9aa84(0x264)]){await this[_0xc9aa84(0x24f)]?.[_0xc9aa84(0x234)](_0x5d12b9,_0xc9aa84(0x1d1));return;}const _0xc070ed=_0x4e347a['shop']?.[_0xc9aa84(0x1c0)]||'unknown\x20shop';await database_1[_0xc9aa84(0x275)][_0xc9aa84(0x242)][_0xc9aa84(0x21d)]({'where':{'telegramId':_0x59383d},'data':{'shopId':null,'isVerified':![]}}),console['log'](_0xc9aa84(0x20c)+_0x59383d+_0xc9aa84(0x228)+_0x4e347a[_0xc9aa84(0x264)]),await this[_0xc9aa84(0x24f)]?.[_0xc9aa84(0x234)](_0x5d12b9,_0xc9aa84(0x207)+_0xc070ed+_0xc9aa84(0x221)+_0xc9aa84(0x1ea),{'parse_mode':_0xc9aa84(0x20a)});}catch(_0xf1a0f4){console[_0xc9aa84(0x212)](_0xc9aa84(0x239),_0xf1a0f4),await this[_0xc9aa84(0x24f)]?.[_0xc9aa84(0x234)](_0x5d12b9,_0xc9aa84(0x1a3));}}),this['bot'][_0x5782ab(0x1da)](/\/status/,async _0x4202b2=>{const _0x1c85cc=_0x5782ab,_0x3dbdc4=_0x4202b2[_0x1c85cc(0x204)]['id'],_0x4b9632=_0x4202b2[_0x1c85cc(0x21c)]?.['id']['toString']();if(!_0x4b9632)return;try{const _0x4a234f=await database_1['default']['telegramUser'][_0x1c85cc(0x24c)]({'where':{'telegramId':_0x4b9632},'include':{'shop':!![]}});if(!_0x4a234f){await this['bot']?.[_0x1c85cc(0x234)](_0x3dbdc4,_0x1c85cc(0x1f9)+_0x1c85cc(0x20d));return;}if(!_0x4a234f[_0x1c85cc(0x26f)]||!_0x4a234f[_0x1c85cc(0x264)]||!_0x4a234f[_0x1c85cc(0x263)]){await this[_0x1c85cc(0x24f)]?.[_0x1c85cc(0x234)](_0x3dbdc4,_0x1c85cc(0x25d)+_0x1c85cc(0x227));return;}await this['bot']?.[_0x1c85cc(0x234)](_0x3dbdc4,_0x1c85cc(0x256)+(_0x1c85cc(0x1ba)+_0x4a234f[_0x1c85cc(0x263)][_0x1c85cc(0x1c0)]+'*\x0a')+('üë§\x20Username:\x20`'+_0x4a234f[_0x1c85cc(0x263)][_0x1c85cc(0x24d)]+'`\x0a')+(_0x1c85cc(0x270)+_0x4a234f['updatedAt'][_0x1c85cc(0x248)]('en-US')+'\x0a\x0a')+_0x1c85cc(0x214)+_0x1c85cc(0x1ec)+_0x1c85cc(0x1c7),{'parse_mode':_0x1c85cc(0x20a)});}catch(_0x120ec9){console[_0x1c85cc(0x212)]('Error\x20handling\x20/status\x20command:',_0x120ec9),await this['bot']?.[_0x1c85cc(0x234)](_0x3dbdc4,'‚ùå\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this[_0x5782ab(0x24f)][_0x5782ab(0x1da)](/\/debug/,async _0x215a02=>{const _0x474de5=_0x5782ab,_0x5d735f=_0x215a02['chat']['id'],_0x404cd4=_0x215a02['from']?.['id'][_0x474de5(0x247)]();if(!_0x404cd4)return;try{const _0x2f7193=await database_1['default'][_0x474de5(0x263)][_0x474de5(0x1f2)]({'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![]},'take':0xa});let _0x38535e=_0x474de5(0x1e4);_0x38535e+=_0x474de5(0x1f6)+_0x404cd4+_0x474de5(0x1eb),_0x38535e+=_0x474de5(0x1e0),_0x2f7193[_0x474de5(0x1e5)]((_0x2f3e19,_0x19d019)=>{const _0x4a8c6b=_0x474de5;_0x38535e+=_0x19d019+0x1+'.\x20*'+_0x2f3e19['name']+'*\x0a',_0x38535e+=_0x4a8c6b(0x240)+_0x2f3e19[_0x4a8c6b(0x24d)]+'`\x0a',_0x38535e+=_0x4a8c6b(0x25a)+_0x2f3e19[_0x4a8c6b(0x1b9)]+'\x0a',_0x38535e+=_0x4a8c6b(0x246)+_0x2f3e19['publicKey'][_0x4a8c6b(0x1c2)](0x0,0xf)+'...`\x0a\x0a';}),await this[_0x474de5(0x24f)]?.[_0x474de5(0x234)](_0x5d735f,_0x38535e,{'parse_mode':_0x474de5(0x20a)});}catch(_0x3c75ea){console[_0x474de5(0x212)]('Error\x20handling\x20/debug\x20command:',_0x3c75ea),await this['bot']?.[_0x474de5(0x234)](_0x5d735f,_0x474de5(0x26c));}}),this[_0x5782ab(0x24f)]['on'](_0x5782ab(0x249),async _0x562976=>{const _0x1ebbde=_0x5782ab;if(_0x562976['text']?.[_0x1ebbde(0x260)]('/'))return;const _0x335105=_0x562976[_0x1ebbde(0x204)]['id'],_0x439ad9=_0x562976[_0x1ebbde(0x21c)]?.['id'][_0x1ebbde(0x247)](),_0x36a17b=_0x562976[_0x1ebbde(0x26d)]?.['trim']();if(!_0x439ad9||!_0x36a17b)return;try{const _0x16e053=await database_1[_0x1ebbde(0x275)][_0x1ebbde(0x242)][_0x1ebbde(0x24c)]({'where':{'telegramId':_0x439ad9},'include':{'shop':!![]}});if(!_0x16e053){await this[_0x1ebbde(0x24f)]?.['sendMessage'](_0x335105,_0x1ebbde(0x262));return;}if(_0x16e053[_0x1ebbde(0x26f)]&&_0x16e053[_0x1ebbde(0x264)]&&_0x16e053[_0x1ebbde(0x263)]){await this[_0x1ebbde(0x24f)]?.[_0x1ebbde(0x234)](_0x335105,_0x1ebbde(0x1fa)+_0x16e053[_0x1ebbde(0x263)][_0x1ebbde(0x1c0)]+'*.\x0a\x0a'+_0x1ebbde(0x1af),{'parse_mode':_0x1ebbde(0x20a)});return;}const _0x2c794f=_0x36a17b[_0x1ebbde(0x1df)](/\s+/);if(_0x2c794f[_0x1ebbde(0x233)]!==0x2){await this[_0x1ebbde(0x24f)]?.['sendMessage'](_0x335105,'‚ùå\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a'+_0x1ebbde(0x269)+_0x1ebbde(0x22e)+_0x1ebbde(0x1fe)+(_0x1ebbde(0x220)+_0x2c794f[_0x1ebbde(0x233)]+_0x1ebbde(0x1cd)+_0x2c794f['map'](_0x445732=>'`'+_0x445732+'`')['join'](',\x20')),{'parse_mode':_0x1ebbde(0x20a)});return;}const [_0x261985,_0x197db5]=_0x2c794f;console[_0x1ebbde(0x21e)](_0x1ebbde(0x215)+_0x439ad9+':\x20username=\x22'+_0x261985+_0x1ebbde(0x245)+_0x197db5['substring'](0x0,0xa)+_0x1ebbde(0x19e)),await this['handleSingleLineVerification'](_0x335105,_0x439ad9,_0x261985,_0x197db5);}catch(_0x3d49af){console[_0x1ebbde(0x212)]('Error\x20handling\x20message:',_0x3d49af),await this['bot']?.[_0x1ebbde(0x234)](_0x335105,'‚ùå\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this[_0x5782ab(0x24f)]['on'](_0x5782ab(0x212),_0x272167=>{const _0x2072fb=_0x5782ab;console[_0x2072fb(0x212)](_0x2072fb(0x278),_0x272167);}),this[_0x5782ab(0x24f)]['on']('polling_error',_0x13a3ce=>{const _0x4a31e6=_0x5782ab;console[_0x4a31e6(0x212)](_0x4a31e6(0x210),_0x13a3ce);});}async[a57_0x4c8d67(0x24a)](_0x814db7,_0x27e020,_0x3facac,_0x4056a2){const _0x1f00d4=a57_0x4c8d67;try{console[_0x1f00d4(0x21e)](_0x1f00d4(0x215)+_0x27e020+_0x1f00d4(0x22f)+_0x3facac+'\x22,\x20apiKey=\x22'+_0x4056a2['substring'](0x0,0xa)+_0x1f00d4(0x19e));if(!_0x3facac||_0x3facac[_0x1f00d4(0x233)]<0x3||_0x3facac[_0x1f00d4(0x233)]>0x32||!/^[a-zA-Z0-9_]+$/['test'](_0x3facac)){await this[_0x1f00d4(0x24f)]?.[_0x1f00d4(0x234)](_0x814db7,_0x1f00d4(0x238)+_0x3facac+_0x1f00d4(0x1eb)+'Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).',{'parse_mode':_0x1f00d4(0x20a)});return;}if(!_0x4056a2||!_0x4056a2[_0x1f00d4(0x260)](_0x1f00d4(0x23a))&&!_0x4056a2[_0x1f00d4(0x260)](_0x1f00d4(0x1c4))){await this['bot']?.['sendMessage'](_0x814db7,_0x1f00d4(0x1e6)+_0x1f00d4(0x1b7),{'parse_mode':_0x1f00d4(0x20a)});return;}const _0x1b6f88=await database_1['default'][_0x1f00d4(0x263)][_0x1f00d4(0x24c)]({'where':{'username':_0x3facac},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x1b6f88){const _0x23824e=await database_1[_0x1f00d4(0x275)]['shop'][_0x1f00d4(0x1f2)]({'select':{'username':!![],'name':!![]},'take':0x5});let _0x4c42eb=_0x1f00d4(0x1fd)+_0x3facac+'`\x20not\x20found.\x0a\x0a';_0x23824e['length']>0x0?(_0x4c42eb+=_0x1f00d4(0x226),_0x23824e[_0x1f00d4(0x1e5)](_0x2c2a0e=>{const _0x2921a8=_0x1f00d4;_0x4c42eb+=_0x2921a8(0x1d0)+_0x2c2a0e[_0x2921a8(0x24d)]+_0x2921a8(0x22c)+_0x2c2a0e[_0x2921a8(0x1c0)]+')\x0a';}),_0x4c42eb+=_0x1f00d4(0x1c6)):_0x4c42eb+=_0x1f00d4(0x251);await this[_0x1f00d4(0x24f)]?.[_0x1f00d4(0x234)](_0x814db7,_0x4c42eb,{'parse_mode':'Markdown'});return;}if(_0x1b6f88[_0x1f00d4(0x1b9)]!==_0x1f00d4(0x1f7)){await this[_0x1f00d4(0x24f)]?.[_0x1f00d4(0x234)](_0x814db7,_0x1f00d4(0x21f)+_0x3facac+_0x1f00d4(0x1bf)+_0x1f00d4(0x1c8),{'parse_mode':_0x1f00d4(0x20a)});return;}if(_0x1b6f88[_0x1f00d4(0x24e)]!==_0x4056a2&&_0x1b6f88[_0x1f00d4(0x1b0)]!==_0x4056a2){await this['bot']?.[_0x1f00d4(0x234)](_0x814db7,_0x1f00d4(0x257)+_0x3facac+'`.\x0a\x0a'+_0x1f00d4(0x1ed)+_0x1f00d4(0x1b4),{'parse_mode':_0x1f00d4(0x20a)});return;}const _0x10c499=await database_1['default'][_0x1f00d4(0x242)][_0x1f00d4(0x1b8)]({'where':{'shopId':_0x1b6f88['id'],'isVerified':!![],'telegramId':{'not':_0x27e020}}});if(_0x10c499){await this[_0x1f00d4(0x24f)]?.[_0x1f00d4(0x234)](_0x814db7,_0x1f00d4(0x20b)+_0x3facac+_0x1f00d4(0x244)+'Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.',{'parse_mode':_0x1f00d4(0x20a)});return;}await database_1[_0x1f00d4(0x275)][_0x1f00d4(0x242)][_0x1f00d4(0x21d)]({'where':{'telegramId':_0x27e020},'data':{'shopId':_0x1b6f88['id'],'isVerified':!![]}}),await this[_0x1f00d4(0x24f)]?.['sendMessage'](_0x814db7,_0x1f00d4(0x1cf)+_0x1f00d4(0x23c)+(_0x1f00d4(0x26e)+_0x1b6f88[_0x1f00d4(0x1c0)]+'*\x0a')+(_0x1f00d4(0x1dd)+_0x1b6f88[_0x1f00d4(0x24d)]+'`\x0a\x0a')+_0x1f00d4(0x1d8)+_0x1f00d4(0x274)+_0x1f00d4(0x25c)+_0x1f00d4(0x1ee)+_0x1f00d4(0x268)+_0x1f00d4(0x1ec)+_0x1f00d4(0x1f1)+'/disconnect\x20-\x20disconnect\x20from\x20notifications',{'parse_mode':_0x1f00d4(0x20a)}),console[_0x1f00d4(0x21e)](_0x1f00d4(0x1b5)+_0x27e020+_0x1f00d4(0x205)+_0x1b6f88[_0x1f00d4(0x24d)]+_0x1f00d4(0x1d2));}catch(_0x231055){console['error'](_0x1f00d4(0x1d6),_0x231055),await this['bot']?.['sendMessage'](_0x814db7,'‚ùå\x20An\x20error\x20occurred\x20while\x20verifying\x20data.');}}async[a57_0x4c8d67(0x1de)](_0x1be67b,_0x43c164,_0x405ad3){const _0x7bc04a=a57_0x4c8d67;if(!this[_0x7bc04a(0x24f)]){console['warn'](_0x7bc04a(0x1dc));return;}try{const _0x5a85da=await database_1['default'][_0x7bc04a(0x242)]['findMany']({'where':{'shopId':_0x1be67b,'isVerified':!![]}});if(_0x5a85da[_0x7bc04a(0x233)]===0x0){console[_0x7bc04a(0x21e)](_0x7bc04a(0x265)+_0x1be67b);return;}const _0x1bb11c=_0x5a85da[_0x7bc04a(0x26b)](async _0x410467=>{const _0x2dd956=_0x7bc04a;try{await this[_0x2dd956(0x24f)]?.[_0x2dd956(0x234)](_0x410467[_0x2dd956(0x1c1)],_0x43c164,_0x405ad3),console[_0x2dd956(0x21e)]('‚úÖ\x20Notification\x20sent\x20to\x20Telegram\x20user\x20'+_0x410467[_0x2dd956(0x1c1)]);}catch(_0x36e930){console[_0x2dd956(0x212)](_0x2dd956(0x229)+_0x410467[_0x2dd956(0x1c1)]+':',_0x36e930),_0x36e930 instanceof Error&&(_0x36e930[_0x2dd956(0x249)][_0x2dd956(0x25b)](_0x2dd956(0x1cb))||_0x36e930[_0x2dd956(0x249)][_0x2dd956(0x25b)](_0x2dd956(0x20e))||_0x36e930[_0x2dd956(0x249)][_0x2dd956(0x25b)]('user\x20is\x20deactivated'))&&(await database_1[_0x2dd956(0x275)][_0x2dd956(0x242)][_0x2dd956(0x21d)]({'where':{'id':_0x410467['id']},'data':{'isVerified':![]}}),console[_0x2dd956(0x21e)]('User\x20'+_0x410467[_0x2dd956(0x1c1)]+'\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure'));}});await Promise['allSettled'](_0x1bb11c);}catch(_0x32f98a){console[_0x7bc04a(0x212)]('Error\x20sending\x20shop\x20notification:',_0x32f98a);}}async[a57_0x4c8d67(0x279)](_0x40166b,_0x20d47d,_0x5a929d){const _0x56345c=a57_0x4c8d67,_0xe9631e={'created':'üÜï','paid':'‚úÖ','failed':'‚ùå','expired':'‚è∞','refund':'üîÑ','chargeback':'‚ö†Ô∏è','processing':'‚öôÔ∏è'},_0x1f5199={'created':'New\x20payment\x20created','paid':_0x56345c(0x1a4),'failed':_0x56345c(0x1a0),'expired':_0x56345c(0x27a),'refund':_0x56345c(0x1f3),'chargeback':'Payment\x20chargeback','processing':'Payment\x20is\x20being\x20processed'},_0xbe0369=_0xe9631e[_0x5a929d],_0x5e1eae=_0x1f5199[_0x5a929d],_0x1f5e25=(0x0,gateway_1[_0x56345c(0x223)])(_0x20d47d['gateway']);console['log'](_0x56345c(0x280)+_0x20d47d[_0x56345c(0x1fb)]+'\x22\x20->\x20display\x20\x22'+_0x1f5e25+'\x22');let _0x799d93=_0xbe0369+'\x20*'+_0x5e1eae+_0x56345c(0x1e1)+(_0x56345c(0x1aa)+_0x20d47d[_0x56345c(0x25e)]+'\x20'+_0x20d47d[_0x56345c(0x1db)]+'*\x0a')+('üìù\x20Order\x20ID:\x20`'+(_0x20d47d['orderId']||_0x20d47d['id'])+'`\x0a')+(_0x56345c(0x271)+_0x20d47d['id']+'`\x0a')+(_0x56345c(0x1e7)+_0x1f5e25+'`\x0a')+('üìÖ\x20Date:\x20'+new Date(_0x20d47d[_0x56345c(0x202)])[_0x56345c(0x1be)]('en-US')+'\x0a');if(_0x20d47d['customerName']||_0x20d47d[_0x56345c(0x27b)]||_0x20d47d[_0x56345c(0x1d3)]||_0x20d47d[_0x56345c(0x1ff)]||_0x20d47d[_0x56345c(0x27d)]){_0x799d93+=_0x56345c(0x23b);_0x20d47d[_0x56345c(0x254)]&&(_0x799d93+=_0x56345c(0x219)+_0x20d47d['customerName']+'`\x0a');_0x20d47d[_0x56345c(0x27b)]&&(_0x799d93+=_0x56345c(0x222)+_0x20d47d[_0x56345c(0x27b)]+'`\x0a');_0x20d47d[_0x56345c(0x1d3)]&&(_0x799d93+=_0x56345c(0x255)+_0x20d47d[_0x56345c(0x1d3)]+'`\x0a');_0x20d47d['customerIp']&&(_0x799d93+=_0x56345c(0x20f)+_0x20d47d[_0x56345c(0x1ff)]+'`\x0a');if(_0x20d47d['customerUa']){const _0x2d7382=_0x20d47d[_0x56345c(0x27d)]['length']>0x32?_0x20d47d[_0x56345c(0x27d)][_0x56345c(0x1c2)](0x0,0x32)+_0x56345c(0x272):_0x20d47d[_0x56345c(0x27d)];_0x799d93+='üíª\x20Browser:\x20`'+_0x2d7382+'`\x0a';}}_0x5a929d===_0x56345c(0x21b)&&_0x20d47d[_0x56345c(0x209)]&&(_0x799d93+=_0x56345c(0x281)+_0x20d47d[_0x56345c(0x209)]+_0x56345c(0x218)),_0x5a929d===_0x56345c(0x1f4)&&(_0x799d93+=_0x56345c(0x208)),_0x20d47d[_0x56345c(0x22a)]&&(_0x799d93+=_0x56345c(0x1e9)+_0x20d47d['adminNotes']+'\x0a'),await this[_0x56345c(0x1de)](_0x40166b,_0x799d93,{'parse_mode':_0x56345c(0x20a)});}async[a57_0x4c8d67(0x211)](_0x1bddab,_0x38ff9e,_0x4f86a1){const _0x5a606a=a57_0x4c8d67,_0x7f578={'created':'üì§','completed':'‚úÖ','rejected':'‚ùå'},_0x2fcbda={'created':_0x5a606a(0x1e3),'completed':_0x5a606a(0x1e2),'rejected':_0x5a606a(0x231)},_0x51ebfb=_0x7f578[_0x4f86a1],_0x4fefc6=_0x2fcbda[_0x4f86a1],_0x4b2fff=_0x51ebfb+'\x20*'+_0x4fefc6+_0x5a606a(0x1e1)+(_0x5a606a(0x1bd)+_0x38ff9e[_0x5a606a(0x25e)]+'\x20USD*\x0a')+(_0x5a606a(0x1bb)+_0x38ff9e['method']+'`\x0a')+('üÜî\x20Payout\x20ID:\x20`'+_0x38ff9e['id']+'`\x0a')+(_0x5a606a(0x243)+new Date(_0x38ff9e[_0x5a606a(0x202)])[_0x5a606a(0x1be)](_0x5a606a(0x1c3))+'\x0a')+(_0x38ff9e[_0x5a606a(0x216)]?_0x5a606a(0x1a2)+_0x38ff9e[_0x5a606a(0x216)]+'`':'');await this[_0x5a606a(0x1de)](_0x1bddab,_0x4b2fff,{'parse_mode':_0x5a606a(0x20a)});}async[a57_0x4c8d67(0x1d4)](_0xebdd29,_0x5e9fac){const _0x372fdc=a57_0x4c8d67;try{const _0x27918f=await database_1[_0x372fdc(0x275)][_0x372fdc(0x200)][_0x372fdc(0x24c)]({'where':{'shopId':_0xebdd29},'select':{'notificationLogin':!![]}});if(!_0x27918f?.['notificationLogin']){console[_0x372fdc(0x21e)](_0x372fdc(0x1d7)+_0xebdd29);return;}const _0x433d40=_0x5e9fac['success']?'üîê':'üö®',_0x27aa8c=_0x5e9fac[_0x372fdc(0x224)]?_0x372fdc(0x27e):_0x372fdc(0x24b);let _0x2ddb79=_0x433d40+'\x20*'+_0x27aa8c+_0x372fdc(0x1e1)+(_0x372fdc(0x1dd)+_0x5e9fac[_0x372fdc(0x24d)]+'`\x0a')+(_0x372fdc(0x241)+_0x5e9fac['timestamp'][_0x372fdc(0x1be)](_0x372fdc(0x1c3))+'\x0a');_0x5e9fac[_0x372fdc(0x232)]&&(_0x2ddb79+=_0x372fdc(0x217)+_0x5e9fac['ipAddress']+'`\x0a');if(_0x5e9fac[_0x372fdc(0x1b1)]){const _0xf053e4=_0x5e9fac['userAgent'][_0x372fdc(0x233)]>0x32?_0x5e9fac[_0x372fdc(0x1b1)]['substring'](0x0,0x32)+_0x372fdc(0x272):_0x5e9fac['userAgent'];_0x2ddb79+=_0x372fdc(0x1b3)+_0xf053e4+'`\x0a';}!_0x5e9fac['success']&&(_0x2ddb79+=_0x372fdc(0x1fc)),await this[_0x372fdc(0x1de)](_0xebdd29,_0x2ddb79,{'parse_mode':_0x372fdc(0x20a)}),console[_0x372fdc(0x21e)](_0x372fdc(0x1ad)+_0xebdd29+':\x20'+(_0x5e9fac[_0x372fdc(0x224)]?'success':_0x372fdc(0x1c5)));}catch(_0x3162cd){console['error'](_0x372fdc(0x225),_0x3162cd);}}async[a57_0x4c8d67(0x1a6)](_0x18d29b,_0x265f8c){const _0x384071=a57_0x4c8d67;try{const _0x39d285=await database_1[_0x384071(0x275)][_0x384071(0x200)]['findUnique']({'where':{'shopId':_0x18d29b},'select':{'notificationApiError':!![]}});if(!_0x39d285?.[_0x384071(0x237)]){console[_0x384071(0x21e)](_0x384071(0x1b2)+_0x18d29b);return;}let _0x11cb42=_0x384071(0x19f)+('üîó\x20Endpoint:\x20`'+_0x265f8c[_0x384071(0x1c9)]+'\x20'+_0x265f8c['endpoint']+'`\x0a')+('üìÖ\x20Time:\x20'+_0x265f8c['timestamp']['toLocaleString'](_0x384071(0x1c3))+'\x0a');_0x265f8c[_0x384071(0x235)]&&(_0x11cb42+=_0x384071(0x26a)+_0x265f8c['statusCode']+'`\x0a'),_0x11cb42+=_0x384071(0x1b6)+_0x265f8c[_0x384071(0x276)]+'`\x0a',_0x265f8c[_0x384071(0x1bc)]&&(_0x11cb42+=_0x384071(0x206)+_0x265f8c['requestId']+'`\x0a'),_0x11cb42+=_0x384071(0x253),await this[_0x384071(0x1de)](_0x18d29b,_0x11cb42,{'parse_mode':_0x384071(0x20a)}),console[_0x384071(0x21e)](_0x384071(0x1d5)+_0x18d29b+':\x20'+_0x265f8c[_0x384071(0x258)]);}catch(_0xaec6a6){console[_0x384071(0x212)](_0x384071(0x1ce),_0xaec6a6);}}async['sendCustomNotification'](_0x258dbf,_0x5c7733,_0x1f1e5c){const _0x34dff9=a57_0x4c8d67;let _0x22975b='üîî\x20*'+_0x5c7733+_0x34dff9(0x1e1);for(const [_0x5e8de9,_0x13a3ea]of Object[_0x34dff9(0x252)](_0x1f1e5c)){_0x13a3ea!==null&&_0x13a3ea!==undefined&&(_0x22975b+=_0x5e8de9+_0x34dff9(0x22d)+_0x13a3ea+'`\x0a');}await this[_0x34dff9(0x1de)](_0x258dbf,_0x22975b,{'parse_mode':'Markdown'});}[a57_0x4c8d67(0x1f8)](){const _0xadc260=a57_0x4c8d67;return{'isActive':!!this[_0xadc260(0x24f)],'username':this[_0xadc260(0x273)]};}[a57_0x4c8d67(0x1d9)](){const _0x479afc=a57_0x4c8d67;this[_0x479afc(0x24f)]&&(this[_0x479afc(0x24f)][_0x479afc(0x259)](),this['bot']=null,console['log']('üõë\x20Telegram\x20bot\x20stopped'));}}function a57_0x233d(){const _0x2d1ae4=['üì±\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20','üíª\x20Browser:\x20`','Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`','‚úÖ\x20Telegram\x20user\x20','‚ùå\x20Error:\x20`','API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','findFirst','status','‚úÖ\x20Connected\x20to\x20shop:\x20*','üè¶\x20Method:\x20`','requestId','üí∏\x20Amount:\x20*','toLocaleString','`\x20is\x20inactive.\x0a\x0a','name','telegramId','substring','en-US','sk_','failed','\x0aCheck\x20spelling\x20and\x20try\x20again.','/disconnect\x20-\x20disconnect\x20from\x20notifications','Contact\x20administrator.','method','840694vrTGkU','blocked','127390ubQRUx','\x20parts:\x20','Failed\x20to\x20send\x20API\x20error\x20notification:','üéâ\x20*Congratulations!*\x0a\x0a','‚Ä¢\x20`','‚ùå\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.','\x20via\x20single-line\x20input','remitterIban','sendLoginNotification','‚úÖ\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20','Error\x20in\x20handleSingleLineVerification:','üì±\x20Login\x20notifications\x20disabled\x20for\x20shop\x20','üîî\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a','stopBot','onText','currency','Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification','üë§\x20Username:\x20`','sendShopNotification','split','üè™\x20Available\x20shops\x20in\x20system:\x0a','*\x0a\x0a','Payout\x20completed','New\x20payout\x20created','üîç\x20*Debug\x20Information*\x0a\x0a','forEach','‚ùå\x20Invalid\x20API\x20key\x20format.\x0a\x0a','üè™\x20Gateway:\x20`','üì±\x20Created\x20new\x20Telegram\x20user:\x20','üìù\x20Notes:\x20','To\x20reconnect,\x20use\x20the\x20/start\x20command','`\x0a\x0a','Commands:\x0a','Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a','‚Ä¢\x20Payouts\x0a','992328ucxQgE','../config/database','/status\x20-\x20check\x20connection\x20status\x0a','findMany','Payment\x20refund','processing','\x20initialized\x20successfully','üì±\x20Your\x20Telegram\x20ID:\x20`','ACTIVE','getBotInfo','‚ùå\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a','‚úÖ\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*','gateway','\x0a‚ö†Ô∏è\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!','‚ùå\x20Shop\x20with\x20username\x20`','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','customerIp','shopSettings','__esModule','createdAt','\x20(@','chat','\x20verified\x20for\x20shop\x20','üÜî\x20Request\x20ID:\x20`','‚úÖ\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*','‚è≥\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a','chargebackAmount','Markdown','‚ùå\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`','üîå\x20User\x20','Use\x20/start\x20to\x20begin.','chat\x20not\x20found','üåê\x20IP:\x20`','Telegram\x20bot\x20polling\x20error:','sendPayoutNotification','error','defineProperty','üîî\x20Notifications\x20are\x20active\x0a\x0a','üîÑ\x20Processing\x20single-line\x20verification\x20for\x20user\x20','txid','üåê\x20IP\x20address:\x20`','\x20USDT*\x0a','üìõ\x20Name:\x20`','6508575TXgUvL','chargeback','from','update','log','‚ùå\x20Shop\x20`','You\x20sent\x20','*.\x0a\x0a','üìß\x20Email:\x20`','getGatewayDisplayNameForTelegram','success','Failed\x20to\x20send\x20login\x20notification:','Available\x20usernames:\x0a','Use\x20/start\x20to\x20connect.','\x20disconnected\x20from\x20shop\x20','‚ùå\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20','adminNotes','35pJIcSk','`\x20(',':\x20`','Example:\x0a',':\x20username=\x22','create','Payout\x20rejected','ipAddress','length','sendMessage','statusCode','3163329dYfnUz','notificationApiError','‚ùå\x20Invalid\x20username\x20format:\x20`','Error\x20handling\x20/disconnect\x20command:','pk_','\x0aüë§\x20*Customer\x20Information:*\x0a','‚úÖ\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a','botToken','initializeBot','TelegramBotService','\x20\x20\x20Username:\x20`','üìÖ\x20Time:\x20','telegramUser','üìÖ\x20Date:\x20','`.\x0a\x0a','\x22,\x20apiKey=\x22','\x20\x20\x20Public\x20Key:\x20`','toString','toLocaleDateString','message','handleSingleLineVerification','Failed\x20login\x20attempt','findUnique','username','publicKey','bot','138TGUGXI','Check\x20spelling\x20and\x20try\x20again.','entries','\x0aüí°\x20Check\x20your\x20request\x20or\x20contact\x20support.','customerName','üè¶\x20IBAN:\x20`','üìä\x20*Connection\x20Status*\x0a\x0a','‚ùå\x20API\x20key\x20does\x20not\x20match\x20shop\x20`','endpoint','stopPolling','\x20\x20\x20Status:\x20','includes','‚Ä¢\x20Payment\x20status\x20changes\x0a','‚ùå\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a','amount','setupBotHandlers','startsWith','warn','‚ùå\x20Please\x20use\x20/start\x20command\x20first','shop','shopId','No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20','TELEGRAM_BOT_TOKEN','node-telegram-bot-api','‚Ä¢\x20Important\x20events\x0a\x0a','üìù\x20Format:\x20`username\x20api_key`\x0a\x0a','üìä\x20Error\x20code:\x20`','map','‚ùå\x20Error\x20getting\x20debug\x20information.','text','üì±\x20Shop:\x20*','isVerified','üìÖ\x20Connection\x20date:\x20','üÜî\x20Payment\x20ID:\x20`','...','botUsername','‚Ä¢\x20New\x20payments\x0a','default','errorMessage','‚Ä¢\x20Payouts\x0a\x0a','Telegram\x20bot\x20error:','sendPaymentNotification','Payment\x20expired','customerEmail','telegramBotService','customerUa','Successful\x20login','üîî\x20You\x20receive\x20notifications\x20about:\x0a','üì±\x20Telegram\x20notification:\x20gateway\x20\x22','üí∏\x20Penalty\x20amount:\x20*','env','...\x22','üö®\x20*API\x20Error*\x0a\x0a','Payment\x20failed','You\x20are\x20already\x20connected\x20to\x20shop:\x20*','üîó\x20TXID:\x20`','‚ùå\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','Payment\x20successfully\x20paid','../types/gateway','sendApiErrorNotification','1434265STvmDa','5531220aFNgxL','last_name','üí∞\x20Amount:\x20*','TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables','‚ùå\x20Failed\x20to\x20initialize\x20Telegram\x20bot:','‚úÖ\x20Login\x20notification\x20sent\x20for\x20shop\x20','‚úÖ\x20Welcome\x20back!\x0a\x0a','Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.','secretKey','userAgent'];a57_0x233d=function(){return _0x2d1ae4;};return a57_0x233d();}exports[a57_0x4c8d67(0x23f)]=TelegramBotService,exports[a57_0x4c8d67(0x27c)]=new TelegramBotService();