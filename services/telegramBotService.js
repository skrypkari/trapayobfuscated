'use strict';const a54_0x5db1ce=a54_0x50b0;(function(_0x30fbc0,_0x104844){const _0x1d3d8d=a54_0x50b0,_0x44ff56=_0x30fbc0();while(!![]){try{const _0x2dc19c=parseInt(_0x1d3d8d(0x1b1))/0x1*(parseInt(_0x1d3d8d(0x1f4))/0x2)+parseInt(_0x1d3d8d(0x1ba))/0x3*(-parseInt(_0x1d3d8d(0x1b5))/0x4)+parseInt(_0x1d3d8d(0x22b))/0x5+-parseInt(_0x1d3d8d(0x18f))/0x6+-parseInt(_0x1d3d8d(0x214))/0x7*(parseInt(_0x1d3d8d(0x1fd))/0x8)+parseInt(_0x1d3d8d(0x25b))/0x9+parseInt(_0x1d3d8d(0x194))/0xa;if(_0x2dc19c===_0x104844)break;else _0x44ff56['push'](_0x44ff56['shift']());}catch(_0x286474){_0x44ff56['push'](_0x44ff56['shift']());}}}(a54_0x2949,0x36888));function a54_0x2949(){const _0xd6b0cf=['🆔\x20Payment\x20ID:\x20`','update','Contact\x20administrator.','gateway','\x0a💡\x20Check\x20your\x20request\x20or\x20contact\x20support.','chat','🔍\x20*Debug\x20Information*\x0a\x0a','Error\x20handling\x20/disconnect\x20command:','pk_','*\x0a\x0a','📱\x20Telegram\x20notification:\x20gateway\x20\x22','getGatewayDisplayNameForTelegram','📅\x20Time:\x20','Use\x20/start\x20to\x20connect.','forEach','✅\x20Notification\x20sent\x20to\x20Telegram\x20user\x20','\x20USD*\x0a','Example:\x0a','💸\x20Amount:\x20*','Use\x20/start\x20to\x20begin.','polling_error','•\x20Important\x20events\x0a\x0a','orderId','includes','🔔\x20Notifications\x20are\x20active\x0a\x0a','3377664nSOYDg','initializeBot','❌\x20Please\x20use\x20/start\x20command\x20first','handleSingleLineVerification','sendPaymentNotification','❌\x20Shop\x20`','error','Successful\x20login','`\x0a\x0a','You\x20are\x20already\x20connected\x20to\x20shop:\x20*','length','🆔\x20Request\x20ID:\x20`','toString','test','❌\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a','bot','user\x20is\x20deactivated','defineProperty','Failed\x20to\x20send\x20login\x20notification:','sendMessage','💻\x20Browser:\x20`','trapay_bot','Telegram\x20bot\x20polling\x20error:','secretKey','sendApiErrorNotification','failed','1416438HAGFsS','\x20initialized\x20successfully',':\x20`','🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20','`\x20is\x20inactive.\x0a\x0a','199210Bxfsjv','•\x20New\x20payments\x0a','📛\x20Name:\x20`','API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','❌\x20Shop\x20with\x20username\x20`','\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure','shop','•\x20Payouts\x0a\x0a','📝\x20Format:\x20`username\x20api_key`\x0a\x0a','ipAddress','timestamp','processing','TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables','substring','❌\x20Failed\x20to\x20initialize\x20Telegram\x20bot:','❌\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.','...`\x0a\x0a','method','Error\x20handling\x20/status\x20command:','chat\x20not\x20found','📧\x20Email:\x20`','👤\x20Username:\x20`','\x22\x20->\x20display\x20\x22','💰\x20Amount:\x20*','message','You\x20sent\x20','...','🏦\x20Method:\x20`','userAgent','1Qbujql','customerIp','\x0a👤\x20*Customer\x20Information:*\x0a','telegramBotService','368868TkfMYI','Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).','Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.','publicKey','errorMessage','3xfjUvY','Payout\x20rejected','isVerified','Failed\x20to\x20send\x20API\x20error\x20notification:','🔔\x20You\x20receive\x20notifications\x20about:\x0a','❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','allSettled','📱\x20Your\x20Telegram\x20ID:\x20`','stopBot','__esModule','botToken','Commands:\x0a','/disconnect\x20-\x20disconnect\x20from\x20notifications','notificationApiError','env','botUsername','🤖\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a','No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20','🚨\x20*API\x20Error*\x0a\x0a','findFirst','❌\x20Invalid\x20username\x20format:\x20`','en-US','\x20verified\x20for\x20shop\x20','stopPolling','🔌\x20User\x20','join','../config/database','Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.','❌\x20An\x20error\x20occurred\x20while\x20verifying\x20data.','log','../types/gateway','Payment\x20chargeback','endpoint','❌\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a','\x20via\x20single-line\x20input','first_name','success','requestId','customerName','🌐\x20IP:\x20`','startsWith','📝\x20Order\x20ID:\x20`','•\x20`','__importDefault','entries','Payment\x20expired','username','❌\x20Error:\x20`','❌\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20','TELEGRAM_BOT_TOKEN','map','default','telegramId','warn','chargeback','🎉\x20*Congratulations!*\x0a\x0a','❗️\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!','🔄\x20Reset\x20incomplete\x20verification\x20for\x20user\x20','254626qugNxw','🔔\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a','📅\x20Connection\x20date:\x20','customerUa','getBotInfo','`\x20not\x20found.\x0a\x0a','chargebackAmount','findUnique','•\x20Payment\x20status\x20changes\x0a','14440WGHVnQ','Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`','✅\x20Telegram\x20user\x20','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','\x20(@','Username:\x20`','🛑\x20Telegram\x20bot\x20stopped','📱\x20Created\x20new\x20Telegram\x20user:\x20','/status\x20-\x20check\x20connection\x20status\x0a','telegramUser','\x0a⚠️\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!','📅\x20Date:\x20','❌\x20Error\x20getting\x20debug\x20information.','trim','To\x20reconnect,\x20use\x20the\x20/start\x20command','Available\x20usernames:\x0a','Telegram\x20bot\x20error:','🔗\x20TXID:\x20`','📝\x20Notes:\x20','shopId','currency','txid','Failed\x20login\x20attempt','385tvWfbE','Payment\x20successfully\x20paid','\x22,\x20apiKey=\x22','ACTIVE','name','New\x20payout\x20created','`.\x0a\x0a','...\x22','✅\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a','💸\x20Penalty\x20amount:\x20*','remitterIban','📊\x20*Connection\x20Status*\x0a\x0a','adminNotes','createdAt','status','node-telegram-bot-api','findMany','Markdown','statusCode','✅\x20Telegram\x20bot\x20@','To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a','*.\x0a\x0a','sendPayoutNotification','642015XrBOqV','shopSettings','🏪\x20Gateway:\x20`',':\x20username=\x22','⏳\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a','Error\x20sending\x20shop\x20notification:','❌\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`','✅\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20','last_name','.\x20*','text','`\x20(','\x20disconnected\x20from\x20shop\x20','customerEmail','•\x20Payouts\x0a','❌\x20Invalid\x20API\x20key\x20format.\x0a\x0a','create','setupBotHandlers','sendShopNotification','from','blocked','toLocaleString','amount'];a54_0x2949=function(){return _0xd6b0cf;};return a54_0x2949();}var __importDefault=this&&this[a54_0x5db1ce(0x1e5)]||function(_0x3da138){const _0x1ba9f9=a54_0x5db1ce;return _0x3da138&&_0x3da138[_0x1ba9f9(0x1c3)]?_0x3da138:{'default':_0x3da138};};function a54_0x50b0(_0x55adeb,_0x3feee6){const _0x294976=a54_0x2949();return a54_0x50b0=function(_0x50b0fb,_0x3213e1){_0x50b0fb=_0x50b0fb-0x17e;let _0x1e657e=_0x294976[_0x50b0fb];return _0x1e657e;},a54_0x50b0(_0x55adeb,_0x3feee6);}Object[a54_0x5db1ce(0x186)](exports,a54_0x5db1ce(0x1c3),{'value':!![]}),exports[a54_0x5db1ce(0x1b4)]=exports['TelegramBotService']=void 0x0;const node_telegram_bot_api_1=__importDefault(require(a54_0x5db1ce(0x223))),database_1=__importDefault(require(a54_0x5db1ce(0x1d4))),gateway_1=require(a54_0x5db1ce(0x1d8));class TelegramBotService{constructor(){const _0x33be5a=a54_0x5db1ce;this[_0x33be5a(0x184)]=null,this[_0x33be5a(0x1c4)]=process[_0x33be5a(0x1c8)][_0x33be5a(0x1eb)]||'',this[_0x33be5a(0x1c9)]=process[_0x33be5a(0x1c8)]['TELEGRAM_BOT_USERNAME']||_0x33be5a(0x18a),this[_0x33be5a(0x1c4)]?this[_0x33be5a(0x25c)]():console[_0x33be5a(0x1ef)](_0x33be5a(0x1a0));}[a54_0x5db1ce(0x25c)](){const _0xa4f51=a54_0x5db1ce;try{this['bot']=new node_telegram_bot_api_1[(_0xa4f51(0x1ed))](this['botToken'],{'polling':!![]}),this[_0xa4f51(0x23c)](),console[_0xa4f51(0x1d7)](_0xa4f51(0x227)+this[_0xa4f51(0x1c9)]+_0xa4f51(0x190));}catch(_0x1b0b02){console[_0xa4f51(0x261)](_0xa4f51(0x1a2),_0x1b0b02);}}[a54_0x5db1ce(0x23c)](){const _0x22e191=a54_0x5db1ce;if(!this[_0x22e191(0x184)])return;this[_0x22e191(0x184)]['onText'](/\/start/,async _0x2920ce=>{const _0x5981e6=_0x22e191,_0x32576e=_0x2920ce[_0x5981e6(0x247)]['id'],_0x106947=_0x2920ce['from']?.['id']['toString'](),_0x3ec78c=_0x2920ce[_0x5981e6(0x23e)]?.[_0x5981e6(0x1e8)],_0x993653=_0x2920ce[_0x5981e6(0x23e)]?.[_0x5981e6(0x1dd)],_0x866da6=_0x2920ce['from']?.[_0x5981e6(0x233)];if(!_0x106947)return;try{let _0x3a9d29=await database_1[_0x5981e6(0x1ed)][_0x5981e6(0x206)][_0x5981e6(0x1fb)]({'where':{'telegramId':_0x106947},'include':{'shop':!![]}});!_0x3a9d29?(_0x3a9d29=await database_1[_0x5981e6(0x1ed)][_0x5981e6(0x206)][_0x5981e6(0x23b)]({'data':{'telegramId':_0x106947,'username':_0x3ec78c,'firstName':_0x993653,'lastName':_0x866da6,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console[_0x5981e6(0x1d7)](_0x5981e6(0x204)+_0x106947+_0x5981e6(0x201)+_0x3ec78c+')')):_0x3a9d29=await database_1[_0x5981e6(0x1ed)][_0x5981e6(0x206)][_0x5981e6(0x243)]({'where':{'telegramId':_0x106947},'data':{'username':_0x3ec78c,'firstName':_0x993653,'lastName':_0x866da6},'include':{'shop':!![]}}),_0x3a9d29[_0x5981e6(0x1bc)]&&_0x3a9d29[_0x5981e6(0x210)]&&_0x3a9d29['shop']?await this[_0x5981e6(0x184)]?.[_0x5981e6(0x188)](_0x32576e,'✅\x20Welcome\x20back!\x0a\x0a'+(_0x5981e6(0x17e)+_0x3a9d29['shop'][_0x5981e6(0x218)]+'*\x0a')+(_0x5981e6(0x202)+_0x3a9d29[_0x5981e6(0x19a)][_0x5981e6(0x1e8)]+'`\x0a\x0a')+_0x5981e6(0x1be)+_0x5981e6(0x195)+_0x5981e6(0x1fc)+_0x5981e6(0x19b)+_0x5981e6(0x1c5)+'/status\x20-\x20check\x20connection\x20status\x0a'+_0x5981e6(0x1c6),{'parse_mode':'Markdown'}):(_0x3a9d29[_0x5981e6(0x210)]&&!_0x3a9d29[_0x5981e6(0x1bc)]&&(await database_1[_0x5981e6(0x1ed)][_0x5981e6(0x206)][_0x5981e6(0x243)]({'where':{'telegramId':_0x106947},'data':{'shopId':null,'isVerified':![]}}),console[_0x5981e6(0x1d7)](_0x5981e6(0x1f3)+_0x106947)),await this[_0x5981e6(0x184)]?.[_0x5981e6(0x188)](_0x32576e,_0x5981e6(0x1ca)+_0x5981e6(0x228)+_0x5981e6(0x19c)+_0x5981e6(0x253)+_0x5981e6(0x200)+_0x5981e6(0x1f2),{'parse_mode':_0x5981e6(0x225)}));}catch(_0x55fcdb){console[_0x5981e6(0x261)]('Error\x20handling\x20/start\x20command:',_0x55fcdb),await this[_0x5981e6(0x184)]?.['sendMessage'](_0x32576e,_0x5981e6(0x1bf));}}),this[_0x22e191(0x184)]['onText'](/\/disconnect/,async _0x14513b=>{const _0x41c8b7=_0x22e191,_0x2c9b8f=_0x14513b[_0x41c8b7(0x247)]['id'],_0x54b982=_0x14513b[_0x41c8b7(0x23e)]?.['id'][_0x41c8b7(0x181)]();if(!_0x54b982)return;try{const _0xc063be=await database_1[_0x41c8b7(0x1ed)][_0x41c8b7(0x206)]['findUnique']({'where':{'telegramId':_0x54b982},'include':{'shop':!![]}});if(!_0xc063be||!_0xc063be[_0x41c8b7(0x1bc)]||!_0xc063be[_0x41c8b7(0x210)]){await this[_0x41c8b7(0x184)]?.['sendMessage'](_0x2c9b8f,_0x41c8b7(0x1a3));return;}const _0x465f15=_0xc063be[_0x41c8b7(0x19a)]?.[_0x41c8b7(0x218)]||'unknown\x20shop';await database_1[_0x41c8b7(0x1ed)][_0x41c8b7(0x206)]['update']({'where':{'telegramId':_0x54b982},'data':{'shopId':null,'isVerified':![]}}),console[_0x41c8b7(0x1d7)](_0x41c8b7(0x1d2)+_0x54b982+_0x41c8b7(0x237)+_0xc063be[_0x41c8b7(0x210)]),await this[_0x41c8b7(0x184)]?.[_0x41c8b7(0x188)](_0x2c9b8f,'✅\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*'+_0x465f15+_0x41c8b7(0x229)+_0x41c8b7(0x20b),{'parse_mode':_0x41c8b7(0x225)});}catch(_0x1ff36b){console[_0x41c8b7(0x261)](_0x41c8b7(0x249),_0x1ff36b),await this['bot']?.[_0x41c8b7(0x188)](_0x2c9b8f,_0x41c8b7(0x1bf));}}),this[_0x22e191(0x184)]['onText'](/\/status/,async _0x3cad25=>{const _0x125ec7=_0x22e191,_0x31d16d=_0x3cad25[_0x125ec7(0x247)]['id'],_0x1ef39a=_0x3cad25[_0x125ec7(0x23e)]?.['id']['toString']();if(!_0x1ef39a)return;try{const _0x1364a2=await database_1['default'][_0x125ec7(0x206)][_0x125ec7(0x1fb)]({'where':{'telegramId':_0x1ef39a},'include':{'shop':!![]}});if(!_0x1364a2){await this[_0x125ec7(0x184)]?.['sendMessage'](_0x31d16d,'❌\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a'+_0x125ec7(0x255));return;}if(!_0x1364a2[_0x125ec7(0x1bc)]||!_0x1364a2[_0x125ec7(0x210)]||!_0x1364a2[_0x125ec7(0x19a)]){await this[_0x125ec7(0x184)]?.[_0x125ec7(0x188)](_0x31d16d,_0x125ec7(0x1db)+_0x125ec7(0x24f));return;}await this[_0x125ec7(0x184)]?.[_0x125ec7(0x188)](_0x31d16d,_0x125ec7(0x21f)+('✅\x20Connected\x20to\x20shop:\x20*'+_0x1364a2['shop']['name']+'*\x0a')+(_0x125ec7(0x1a9)+_0x1364a2[_0x125ec7(0x19a)][_0x125ec7(0x1e8)]+'`\x0a')+(_0x125ec7(0x1f6)+_0x1364a2['updatedAt']['toLocaleDateString'](_0x125ec7(0x1cf))+'\x0a\x0a')+_0x125ec7(0x25a)+_0x125ec7(0x1c5)+_0x125ec7(0x1c6),{'parse_mode':_0x125ec7(0x225)});}catch(_0x5c36dc){console[_0x125ec7(0x261)](_0x125ec7(0x1a6),_0x5c36dc),await this['bot']?.[_0x125ec7(0x188)](_0x31d16d,_0x125ec7(0x1bf));}}),this[_0x22e191(0x184)]['onText'](/\/debug/,async _0x371ca4=>{const _0x590403=_0x22e191,_0x416fdd=_0x371ca4['chat']['id'],_0x5473e5=_0x371ca4[_0x590403(0x23e)]?.['id'][_0x590403(0x181)]();if(!_0x5473e5)return;try{const _0x5a99a7=await database_1[_0x590403(0x1ed)][_0x590403(0x19a)][_0x590403(0x224)]({'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![]},'take':0xa});let _0x4d2760=_0x590403(0x248);_0x4d2760+=_0x590403(0x1c1)+_0x5473e5+'`\x0a\x0a',_0x4d2760+='🏪\x20Available\x20shops\x20in\x20system:\x0a',_0x5a99a7[_0x590403(0x250)]((_0x41a4a9,_0x554435)=>{const _0x2c1c48=_0x590403;_0x4d2760+=_0x554435+0x1+_0x2c1c48(0x234)+_0x41a4a9['name']+'*\x0a',_0x4d2760+='\x20\x20\x20Username:\x20`'+_0x41a4a9[_0x2c1c48(0x1e8)]+'`\x0a',_0x4d2760+='\x20\x20\x20Status:\x20'+_0x41a4a9['status']+'\x0a',_0x4d2760+='\x20\x20\x20Public\x20Key:\x20`'+_0x41a4a9[_0x2c1c48(0x1b8)][_0x2c1c48(0x1a1)](0x0,0xf)+_0x2c1c48(0x1a4);}),await this[_0x590403(0x184)]?.[_0x590403(0x188)](_0x416fdd,_0x4d2760,{'parse_mode':'Markdown'});}catch(_0x8ffda7){console[_0x590403(0x261)]('Error\x20handling\x20/debug\x20command:',_0x8ffda7),await this[_0x590403(0x184)]?.[_0x590403(0x188)](_0x416fdd,_0x590403(0x209));}}),this['bot']['on'](_0x22e191(0x1ac),async _0x48d9c1=>{const _0x30f2af=_0x22e191;if(_0x48d9c1['text']?.[_0x30f2af(0x1e2)]('/'))return;const _0xc5fa15=_0x48d9c1[_0x30f2af(0x247)]['id'],_0x37c11c=_0x48d9c1[_0x30f2af(0x23e)]?.['id'][_0x30f2af(0x181)](),_0x3d06a6=_0x48d9c1[_0x30f2af(0x235)]?.[_0x30f2af(0x20a)]();if(!_0x37c11c||!_0x3d06a6)return;try{const _0x13c4ef=await database_1[_0x30f2af(0x1ed)][_0x30f2af(0x206)][_0x30f2af(0x1fb)]({'where':{'telegramId':_0x37c11c},'include':{'shop':!![]}});if(!_0x13c4ef){await this[_0x30f2af(0x184)]?.[_0x30f2af(0x188)](_0xc5fa15,_0x30f2af(0x25d));return;}if(_0x13c4ef[_0x30f2af(0x1bc)]&&_0x13c4ef['shopId']&&_0x13c4ef[_0x30f2af(0x19a)]){await this['bot']?.[_0x30f2af(0x188)](_0xc5fa15,'✅\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*'+_0x13c4ef['shop'][_0x30f2af(0x218)]+_0x30f2af(0x229)+_0x30f2af(0x1d5),{'parse_mode':_0x30f2af(0x225)});return;}const _0x164e3b=_0x3d06a6['split'](/\s+/);if(_0x164e3b[_0x30f2af(0x17f)]!==0x2){await this[_0x30f2af(0x184)]?.[_0x30f2af(0x188)](_0xc5fa15,_0x30f2af(0x183)+_0x30f2af(0x19c)+_0x30f2af(0x253)+_0x30f2af(0x200)+(_0x30f2af(0x1ad)+_0x164e3b['length']+'\x20parts:\x20'+_0x164e3b[_0x30f2af(0x1ec)](_0xa24daf=>'`'+_0xa24daf+'`')[_0x30f2af(0x1d3)](',\x20')),{'parse_mode':'Markdown'});return;}const [_0x5a3e0d,_0x568e17]=_0x164e3b;console['log'](_0x30f2af(0x192)+_0x37c11c+':\x20username=\x22'+_0x5a3e0d+_0x30f2af(0x216)+_0x568e17[_0x30f2af(0x1a1)](0x0,0xa)+'...\x22'),await this[_0x30f2af(0x25e)](_0xc5fa15,_0x37c11c,_0x5a3e0d,_0x568e17);}catch(_0x23ee43){console['error']('Error\x20handling\x20message:',_0x23ee43),await this[_0x30f2af(0x184)]?.['sendMessage'](_0xc5fa15,_0x30f2af(0x1bf));}}),this['bot']['on'](_0x22e191(0x261),_0x5d5ae0=>{const _0x9b7859=_0x22e191;console[_0x9b7859(0x261)](_0x9b7859(0x20d),_0x5d5ae0);}),this[_0x22e191(0x184)]['on'](_0x22e191(0x256),_0xb43f3d=>{const _0x3b9428=_0x22e191;console[_0x3b9428(0x261)](_0x3b9428(0x18b),_0xb43f3d);});}async[a54_0x5db1ce(0x25e)](_0x221e12,_0x47a08f,_0x29c7ee,_0x572347){const _0x26f5f8=a54_0x5db1ce;try{console[_0x26f5f8(0x1d7)](_0x26f5f8(0x192)+_0x47a08f+_0x26f5f8(0x22e)+_0x29c7ee+'\x22,\x20apiKey=\x22'+_0x572347[_0x26f5f8(0x1a1)](0x0,0xa)+_0x26f5f8(0x21b));if(!_0x29c7ee||_0x29c7ee[_0x26f5f8(0x17f)]<0x3||_0x29c7ee[_0x26f5f8(0x17f)]>0x32||!/^[a-zA-Z0-9_]+$/[_0x26f5f8(0x182)](_0x29c7ee)){await this[_0x26f5f8(0x184)]?.[_0x26f5f8(0x188)](_0x221e12,_0x26f5f8(0x1ce)+_0x29c7ee+_0x26f5f8(0x263)+_0x26f5f8(0x1b6),{'parse_mode':_0x26f5f8(0x225)});return;}if(!_0x572347||!_0x572347[_0x26f5f8(0x1e2)](_0x26f5f8(0x24a))&&!_0x572347[_0x26f5f8(0x1e2)]('sk_')){await this[_0x26f5f8(0x184)]?.[_0x26f5f8(0x188)](_0x221e12,_0x26f5f8(0x23a)+_0x26f5f8(0x197),{'parse_mode':_0x26f5f8(0x225)});return;}const _0x1aa89f=await database_1[_0x26f5f8(0x1ed)]['shop'][_0x26f5f8(0x1fb)]({'where':{'username':_0x29c7ee},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x1aa89f){const _0x2b20ae=await database_1[_0x26f5f8(0x1ed)]['shop'][_0x26f5f8(0x224)]({'select':{'username':!![],'name':!![]},'take':0x5});let _0x5ac3be=_0x26f5f8(0x198)+_0x29c7ee+_0x26f5f8(0x1f9);_0x2b20ae[_0x26f5f8(0x17f)]>0x0?(_0x5ac3be+=_0x26f5f8(0x20c),_0x2b20ae['forEach'](_0x1b0cb0=>{const _0x57905c=_0x26f5f8;_0x5ac3be+=_0x57905c(0x1e4)+_0x1b0cb0[_0x57905c(0x1e8)]+_0x57905c(0x236)+_0x1b0cb0[_0x57905c(0x218)]+')\x0a';}),_0x5ac3be+='\x0aCheck\x20spelling\x20and\x20try\x20again.'):_0x5ac3be+='Check\x20spelling\x20and\x20try\x20again.';await this[_0x26f5f8(0x184)]?.[_0x26f5f8(0x188)](_0x221e12,_0x5ac3be,{'parse_mode':_0x26f5f8(0x225)});return;}if(_0x1aa89f[_0x26f5f8(0x222)]!==_0x26f5f8(0x217)){await this[_0x26f5f8(0x184)]?.[_0x26f5f8(0x188)](_0x221e12,_0x26f5f8(0x260)+_0x29c7ee+_0x26f5f8(0x193)+_0x26f5f8(0x244),{'parse_mode':_0x26f5f8(0x225)});return;}if(_0x1aa89f[_0x26f5f8(0x1b8)]!==_0x572347&&_0x1aa89f[_0x26f5f8(0x18c)]!==_0x572347){await this[_0x26f5f8(0x184)]?.[_0x26f5f8(0x188)](_0x221e12,'❌\x20API\x20key\x20does\x20not\x20match\x20shop\x20`'+_0x29c7ee+_0x26f5f8(0x21a)+'Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a'+_0x26f5f8(0x1fe),{'parse_mode':_0x26f5f8(0x225)});return;}const _0x205b13=await database_1[_0x26f5f8(0x1ed)][_0x26f5f8(0x206)][_0x26f5f8(0x1cd)]({'where':{'shopId':_0x1aa89f['id'],'isVerified':!![],'telegramId':{'not':_0x47a08f}}});if(_0x205b13){await this[_0x26f5f8(0x184)]?.[_0x26f5f8(0x188)](_0x221e12,_0x26f5f8(0x231)+_0x29c7ee+_0x26f5f8(0x21a)+_0x26f5f8(0x1b7),{'parse_mode':_0x26f5f8(0x225)});return;}await database_1[_0x26f5f8(0x1ed)][_0x26f5f8(0x206)][_0x26f5f8(0x243)]({'where':{'telegramId':_0x47a08f},'data':{'shopId':_0x1aa89f['id'],'isVerified':!![]}}),await this['bot']?.['sendMessage'](_0x221e12,_0x26f5f8(0x1f1)+_0x26f5f8(0x21c)+('📱\x20Shop:\x20*'+_0x1aa89f[_0x26f5f8(0x218)]+'*\x0a')+(_0x26f5f8(0x1a9)+_0x1aa89f[_0x26f5f8(0x1e8)]+'`\x0a\x0a')+_0x26f5f8(0x1f5)+_0x26f5f8(0x195)+_0x26f5f8(0x1fc)+_0x26f5f8(0x239)+_0x26f5f8(0x257)+_0x26f5f8(0x1c5)+_0x26f5f8(0x205)+_0x26f5f8(0x1c6),{'parse_mode':'Markdown'}),console[_0x26f5f8(0x1d7)](_0x26f5f8(0x1ff)+_0x47a08f+_0x26f5f8(0x1d0)+_0x1aa89f[_0x26f5f8(0x1e8)]+_0x26f5f8(0x1dc));}catch(_0x40d40e){console['error']('Error\x20in\x20handleSingleLineVerification:',_0x40d40e),await this[_0x26f5f8(0x184)]?.[_0x26f5f8(0x188)](_0x221e12,_0x26f5f8(0x1d6));}}async[a54_0x5db1ce(0x23d)](_0xe38f6b,_0x35c556,_0x507c7b){const _0x2a828f=a54_0x5db1ce;if(!this[_0x2a828f(0x184)]){console['warn']('Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification');return;}try{const _0x5a2f27=await database_1[_0x2a828f(0x1ed)][_0x2a828f(0x206)]['findMany']({'where':{'shopId':_0xe38f6b,'isVerified':!![]}});if(_0x5a2f27[_0x2a828f(0x17f)]===0x0){console[_0x2a828f(0x1d7)](_0x2a828f(0x1cb)+_0xe38f6b);return;}const _0x147608=_0x5a2f27[_0x2a828f(0x1ec)](async _0x574ea1=>{const _0x443bca=_0x2a828f;try{await this[_0x443bca(0x184)]?.[_0x443bca(0x188)](_0x574ea1['telegramId'],_0x35c556,_0x507c7b),console['log'](_0x443bca(0x251)+_0x574ea1[_0x443bca(0x1ee)]);}catch(_0x537170){console['error'](_0x443bca(0x1ea)+_0x574ea1['telegramId']+':',_0x537170),_0x537170 instanceof Error&&(_0x537170[_0x443bca(0x1ac)][_0x443bca(0x259)](_0x443bca(0x23f))||_0x537170[_0x443bca(0x1ac)][_0x443bca(0x259)](_0x443bca(0x1a7))||_0x537170['message']['includes'](_0x443bca(0x185)))&&(await database_1[_0x443bca(0x1ed)][_0x443bca(0x206)]['update']({'where':{'id':_0x574ea1['id']},'data':{'isVerified':![]}}),console['log']('User\x20'+_0x574ea1[_0x443bca(0x1ee)]+_0x443bca(0x199)));}});await Promise[_0x2a828f(0x1c0)](_0x147608);}catch(_0x5d7861){console[_0x2a828f(0x261)](_0x2a828f(0x230),_0x5d7861);}}async[a54_0x5db1ce(0x25f)](_0xb1c92c,_0x1a958c,_0x586b48){const _0x50aa87=a54_0x5db1ce,_0x39dc3b={'created':'🆕','paid':'✅','failed':'❌','expired':'⏰','refund':'🔄','chargeback':'⚠️','processing':'⚙️'},_0x540f62={'created':'New\x20payment\x20created','paid':_0x50aa87(0x215),'failed':'Payment\x20failed','expired':_0x50aa87(0x1e7),'refund':'Payment\x20refund','chargeback':_0x50aa87(0x1d9),'processing':'Payment\x20is\x20being\x20processed'},_0x2b6f71=_0x39dc3b[_0x586b48],_0x361ced=_0x540f62[_0x586b48],_0x267425=(0x0,gateway_1[_0x50aa87(0x24d)])(_0x1a958c['gateway']);console['log'](_0x50aa87(0x24c)+_0x1a958c[_0x50aa87(0x245)]+_0x50aa87(0x1aa)+_0x267425+'\x22');let _0x4ce437=_0x2b6f71+'\x20*'+_0x361ced+_0x50aa87(0x24b)+(_0x50aa87(0x1ab)+_0x1a958c[_0x50aa87(0x241)]+'\x20'+_0x1a958c[_0x50aa87(0x211)]+'*\x0a')+(_0x50aa87(0x1e3)+(_0x1a958c[_0x50aa87(0x258)]||_0x1a958c['id'])+'`\x0a')+(_0x50aa87(0x242)+_0x1a958c['id']+'`\x0a')+(_0x50aa87(0x22d)+_0x267425+'`\x0a')+('📅\x20Date:\x20'+new Date(_0x1a958c[_0x50aa87(0x221)])[_0x50aa87(0x240)](_0x50aa87(0x1cf))+'\x0a');if(_0x1a958c[_0x50aa87(0x1e0)]||_0x1a958c[_0x50aa87(0x238)]||_0x1a958c['remitterIban']||_0x1a958c[_0x50aa87(0x1b2)]||_0x1a958c[_0x50aa87(0x1f7)]){_0x4ce437+=_0x50aa87(0x1b3);_0x1a958c['customerName']&&(_0x4ce437+=_0x50aa87(0x196)+_0x1a958c[_0x50aa87(0x1e0)]+'`\x0a');_0x1a958c[_0x50aa87(0x238)]&&(_0x4ce437+=_0x50aa87(0x1a8)+_0x1a958c[_0x50aa87(0x238)]+'`\x0a');_0x1a958c[_0x50aa87(0x21e)]&&(_0x4ce437+='🏦\x20IBAN:\x20`'+_0x1a958c['remitterIban']+'`\x0a');_0x1a958c[_0x50aa87(0x1b2)]&&(_0x4ce437+=_0x50aa87(0x1e1)+_0x1a958c[_0x50aa87(0x1b2)]+'`\x0a');if(_0x1a958c[_0x50aa87(0x1f7)]){const _0x4fb756=_0x1a958c['customerUa'][_0x50aa87(0x17f)]>0x32?_0x1a958c['customerUa']['substring'](0x0,0x32)+_0x50aa87(0x1ae):_0x1a958c[_0x50aa87(0x1f7)];_0x4ce437+=_0x50aa87(0x189)+_0x4fb756+'`\x0a';}}_0x586b48===_0x50aa87(0x1f0)&&_0x1a958c[_0x50aa87(0x1fa)]&&(_0x4ce437+=_0x50aa87(0x21d)+_0x1a958c[_0x50aa87(0x1fa)]+'\x20USDT*\x0a'),_0x586b48===_0x50aa87(0x19f)&&(_0x4ce437+=_0x50aa87(0x22f)),_0x1a958c[_0x50aa87(0x220)]&&(_0x4ce437+=_0x50aa87(0x20f)+_0x1a958c['adminNotes']+'\x0a'),await this[_0x50aa87(0x23d)](_0xb1c92c,_0x4ce437,{'parse_mode':_0x50aa87(0x225)});}async[a54_0x5db1ce(0x22a)](_0x1a942c,_0x418c8c,_0x44a8ed){const _0x284485=a54_0x5db1ce,_0x396efc={'created':'📤','completed':'✅','rejected':'❌'},_0x767883={'created':_0x284485(0x219),'completed':'Payout\x20completed','rejected':_0x284485(0x1bb)},_0x32d6e4=_0x396efc[_0x44a8ed],_0x30848e=_0x767883[_0x44a8ed],_0x322d51=_0x32d6e4+'\x20*'+_0x30848e+_0x284485(0x24b)+(_0x284485(0x254)+_0x418c8c[_0x284485(0x241)]+_0x284485(0x252))+(_0x284485(0x1af)+_0x418c8c[_0x284485(0x1a5)]+'`\x0a')+('🆔\x20Payout\x20ID:\x20`'+_0x418c8c['id']+'`\x0a')+(_0x284485(0x208)+new Date(_0x418c8c[_0x284485(0x221)])['toLocaleString']('en-US')+'\x0a')+(_0x418c8c[_0x284485(0x212)]?_0x284485(0x20e)+_0x418c8c[_0x284485(0x212)]+'`':'');await this['sendShopNotification'](_0x1a942c,_0x322d51,{'parse_mode':'Markdown'});}async['sendLoginNotification'](_0x2b10ad,_0x10753e){const _0x48298c=a54_0x5db1ce;try{const _0x15679d=await database_1[_0x48298c(0x1ed)][_0x48298c(0x22c)]['findUnique']({'where':{'shopId':_0x2b10ad},'select':{'notificationLogin':!![]}});if(!_0x15679d?.['notificationLogin']){console[_0x48298c(0x1d7)]('📱\x20Login\x20notifications\x20disabled\x20for\x20shop\x20'+_0x2b10ad);return;}const _0x50e475=_0x10753e[_0x48298c(0x1de)]?'🔐':'🚨',_0x390418=_0x10753e[_0x48298c(0x1de)]?_0x48298c(0x262):_0x48298c(0x213);let _0x51f3bb=_0x50e475+'\x20*'+_0x390418+_0x48298c(0x24b)+(_0x48298c(0x1a9)+_0x10753e[_0x48298c(0x1e8)]+'`\x0a')+(_0x48298c(0x24e)+_0x10753e[_0x48298c(0x19e)][_0x48298c(0x240)](_0x48298c(0x1cf))+'\x0a');_0x10753e['ipAddress']&&(_0x51f3bb+='🌐\x20IP\x20address:\x20`'+_0x10753e[_0x48298c(0x19d)]+'`\x0a');if(_0x10753e[_0x48298c(0x1b0)]){const _0x3311e9=_0x10753e[_0x48298c(0x1b0)][_0x48298c(0x17f)]>0x32?_0x10753e[_0x48298c(0x1b0)][_0x48298c(0x1a1)](0x0,0x32)+_0x48298c(0x1ae):_0x10753e[_0x48298c(0x1b0)];_0x51f3bb+=_0x48298c(0x189)+_0x3311e9+'`\x0a';}!_0x10753e[_0x48298c(0x1de)]&&(_0x51f3bb+=_0x48298c(0x207)),await this[_0x48298c(0x23d)](_0x2b10ad,_0x51f3bb,{'parse_mode':'Markdown'}),console[_0x48298c(0x1d7)]('✅\x20Login\x20notification\x20sent\x20for\x20shop\x20'+_0x2b10ad+':\x20'+(_0x10753e[_0x48298c(0x1de)]?'success':_0x48298c(0x18e)));}catch(_0x239d57){console[_0x48298c(0x261)](_0x48298c(0x187),_0x239d57);}}async[a54_0x5db1ce(0x18d)](_0x2c58da,_0x179bcc){const _0x3c003b=a54_0x5db1ce;try{const _0x55ffc8=await database_1[_0x3c003b(0x1ed)][_0x3c003b(0x22c)][_0x3c003b(0x1fb)]({'where':{'shopId':_0x2c58da},'select':{'notificationApiError':!![]}});if(!_0x55ffc8?.[_0x3c003b(0x1c7)]){console[_0x3c003b(0x1d7)]('📱\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20'+_0x2c58da);return;}let _0x1df521=_0x3c003b(0x1cc)+('🔗\x20Endpoint:\x20`'+_0x179bcc['method']+'\x20'+_0x179bcc[_0x3c003b(0x1da)]+'`\x0a')+('📅\x20Time:\x20'+_0x179bcc[_0x3c003b(0x19e)][_0x3c003b(0x240)](_0x3c003b(0x1cf))+'\x0a');_0x179bcc['statusCode']&&(_0x1df521+='📊\x20Error\x20code:\x20`'+_0x179bcc[_0x3c003b(0x226)]+'`\x0a'),_0x1df521+=_0x3c003b(0x1e9)+_0x179bcc[_0x3c003b(0x1b9)]+'`\x0a',_0x179bcc[_0x3c003b(0x1df)]&&(_0x1df521+=_0x3c003b(0x180)+_0x179bcc[_0x3c003b(0x1df)]+'`\x0a'),_0x1df521+=_0x3c003b(0x246),await this[_0x3c003b(0x23d)](_0x2c58da,_0x1df521,{'parse_mode':_0x3c003b(0x225)}),console[_0x3c003b(0x1d7)](_0x3c003b(0x232)+_0x2c58da+':\x20'+_0x179bcc['endpoint']);}catch(_0x493669){console[_0x3c003b(0x261)](_0x3c003b(0x1bd),_0x493669);}}async['sendCustomNotification'](_0x328377,_0x293c09,_0xf32b10){const _0x4d30b0=a54_0x5db1ce;let _0x57a1f7='🔔\x20*'+_0x293c09+_0x4d30b0(0x24b);for(const [_0x351b3b,_0xd624e3]of Object[_0x4d30b0(0x1e6)](_0xf32b10)){_0xd624e3!==null&&_0xd624e3!==undefined&&(_0x57a1f7+=_0x351b3b+_0x4d30b0(0x191)+_0xd624e3+'`\x0a');}await this[_0x4d30b0(0x23d)](_0x328377,_0x57a1f7,{'parse_mode':'Markdown'});}[a54_0x5db1ce(0x1f8)](){const _0xc48972=a54_0x5db1ce;return{'isActive':!!this[_0xc48972(0x184)],'username':this[_0xc48972(0x1c9)]};}[a54_0x5db1ce(0x1c2)](){const _0x143f91=a54_0x5db1ce;this[_0x143f91(0x184)]&&(this[_0x143f91(0x184)][_0x143f91(0x1d1)](),this[_0x143f91(0x184)]=null,console[_0x143f91(0x1d7)](_0x143f91(0x203)));}}exports['TelegramBotService']=TelegramBotService,exports[a54_0x5db1ce(0x1b4)]=new TelegramBotService();