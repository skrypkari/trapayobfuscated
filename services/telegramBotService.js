'use strict';const a59_0x10677c=a59_0x20b0;(function(_0x3eca12,_0x359f45){const _0x41bf1b=a59_0x20b0,_0x196a51=_0x3eca12();while(!![]){try{const _0x1f5662=-parseInt(_0x41bf1b(0x1d9))/0x1*(-parseInt(_0x41bf1b(0x1a7))/0x2)+parseInt(_0x41bf1b(0x1e8))/0x3*(parseInt(_0x41bf1b(0x212))/0x4)+-parseInt(_0x41bf1b(0x181))/0x5+parseInt(_0x41bf1b(0x1d6))/0x6+parseInt(_0x41bf1b(0x1b9))/0x7*(parseInt(_0x41bf1b(0x15a))/0x8)+parseInt(_0x41bf1b(0x1af))/0x9*(-parseInt(_0x41bf1b(0x22c))/0xa)+parseInt(_0x41bf1b(0x234))/0xb;if(_0x1f5662===_0x359f45)break;else _0x196a51['push'](_0x196a51['shift']());}catch(_0x1c3408){_0x196a51['push'](_0x196a51['shift']());}}}(a59_0x38a8,0x34385));function a59_0x38a8(){const _0x2e8291=['\x22,\x20apiKey=\x22','Payment\x20refund','chat','Telegram\x20bot\x20polling\x20error:','...','🔔\x20You\x20receive\x20notifications\x20about:\x0a','map','\x20(@','💰\x20Amount:\x20*','216669zIzsTm','To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a','__importDefault','🔍\x20*Debug\x20Information*\x0a\x0a','Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).','You\x20are\x20already\x20connected\x20to\x20shop:\x20*','📝\x20Notes:\x20','✅\x20Telegram\x20user\x20','TelegramBotService','default','🆔\x20Payout\x20ID:\x20`','\x20\x20\x20Username:\x20`','join','•\x20`','Error\x20handling\x20message:','✅\x20Login\x20notification\x20sent\x20for\x20shop\x20','onText','botToken','📝\x20Order\x20ID:\x20`','text','/disconnect\x20-\x20disconnect\x20from\x20notifications','Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a','chargeback','createdAt','📊\x20*Connection\x20Status*\x0a\x0a','🆔\x20Request\x20ID:\x20`','telegramBotService','log','📛\x20Name:\x20`','🔄\x20Reset\x20incomplete\x20verification\x20for\x20user\x20','🛑\x20Telegram\x20bot\x20stopped','❌\x20Shop\x20`','❌\x20Error:\x20`','sendMessage','Error\x20sending\x20shop\x20notification:','❌\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a','📊\x20Error\x20code:\x20`','message','method','Payment\x20successfully\x20paid','customerUa','Username:\x20`','4kBoGzI','findUnique','en-US','Available\x20usernames:\x0a','💸\x20Penalty\x20amount:\x20*','🌐\x20IP:\x20`','endpoint',':\x20username=\x22','allSettled','🔔\x20Notifications\x20are\x20active\x0a\x0a','failed','Failed\x20login\x20attempt','•\x20Payment\x20status\x20changes\x0a','Error\x20handling\x20/debug\x20command:','📱\x20Shop:\x20*','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','update','ipAddress','setupBotHandlers','✅\x20Telegram\x20bot\x20@','ACTIVE','orderId','✅\x20Notification\x20sent\x20to\x20Telegram\x20user\x20','🚨\x20*API\x20Error*\x0a\x0a','❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','requestId','3128570cZFzuA','publicKey','Failed\x20to\x20send\x20login\x20notification:','✅\x20Welcome\x20back!\x0a\x0a',':\x20`','🏦\x20IBAN:\x20`','user\x20is\x20deactivated','Markdown','200783bIzgxQ','startsWith','forEach','Payment\x20chargeback','Failed\x20to\x20send\x20API\x20error\x20notification:','sk_','split','sendPayoutNotification','🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20','No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20','`.\x0a\x0a','Payout\x20rejected','🔗\x20TXID:\x20`','Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification','📅\x20Connection\x20date:\x20','node-telegram-bot-api','417160xBIIog','\x20via\x20single-line\x20input','customerIp','✅\x20Connected\x20to\x20shop:\x20*','...`\x0a\x0a','💸\x20Amount:\x20*','❌\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a','❌\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`','❌\x20Please\x20use\x20/start\x20command\x20first','shopSettings','chargebackAmount','initializeBot','•\x20Payouts\x0a\x0a','Contact\x20administrator.','📱\x20Telegram\x20notification:\x20gateway\x20\x22','from','errorMessage','toLocaleDateString','includes','telegramId','✅\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*','secretKey','📧\x20Email:\x20`','❌\x20Invalid\x20API\x20key\x20format.\x0a\x0a','env','TELEGRAM_BOT_TOKEN','🔔\x20*','Error\x20in\x20handleSingleLineVerification:','getGatewayDisplayNameForTelegram','findFirst','📅\x20Time:\x20','❌\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.','🤖\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a','Commands:\x0a','You\x20sent\x20','TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables','create','last_name','__esModule','1496340piFhlx','Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.','❌\x20API\x20key\x20does\x20not\x20match\x20shop\x20`','Telegram\x20bot\x20error:','Error\x20handling\x20/start\x20command:','blocked','entries','../types/gateway','✅\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*','length','💻\x20Browser:\x20`','warn','\x20\x20\x20Status:\x20','Check\x20spelling\x20and\x20try\x20again.','❌\x20Failed\x20to\x20initialize\x20Telegram\x20bot:','📅\x20Date:\x20','statusCode','toString','...\x22','✅\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20','notificationLogin','shopId','*.\x0a\x0a','customerEmail','`\x20not\x20found.\x0a\x0a','username','TELEGRAM_BOT_USERNAME','polling_error','substring','status','sendCustomNotification','gateway','❌\x20Error\x20getting\x20debug\x20information.','•\x20Payouts\x0a','New\x20payout\x20created','*\x0a\x0a','userAgent','🏦\x20Method:\x20`','80818ojxrdu','\x0a👤\x20*Customer\x20Information:*\x0a','👤\x20Username:\x20`','•\x20Important\x20events\x0a\x0a','Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.','Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`','Payment\x20expired','currency','9xDqJPP','toLocaleString','txid','botUsername','timestamp','🔗\x20Endpoint:\x20`','bot','User\x20','success','/status\x20-\x20check\x20connection\x20status\x0a','42xYvmCK','name','sendPaymentNotification','`\x0a\x0a','Payment\x20is\x20being\x20processed','customerName','Successful\x20login','findMany','⏳\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a','telegramUser','Example:\x0a','sendShopNotification','❌\x20Invalid\x20username\x20format:\x20`','handleSingleLineVerification','🎉\x20*Congratulations!*\x0a\x0a','remitterIban','Error\x20handling\x20/status\x20command:','Payment\x20failed','To\x20reconnect,\x20use\x20the\x20/start\x20command','📱\x20Your\x20Telegram\x20ID:\x20`','•\x20New\x20payments\x0a','defineProperty','Payout\x20completed','🏪\x20Gateway:\x20`','\x20USDT*\x0a','shop','❌\x20An\x20error\x20occurred\x20while\x20verifying\x20data.','processing','isVerified','353946orAuaN','📝\x20Format:\x20`username\x20api_key`\x0a\x0a','adminNotes','9MmHMxQ','🔔\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a','API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','error','amount','\x0a⚠️\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!'];a59_0x38a8=function(){return _0x2e8291;};return a59_0x38a8();}var __importDefault=this&&this[a59_0x10677c(0x1ea)]||function(_0x5360ba){const _0x226bda=a59_0x10677c;return _0x5360ba&&_0x5360ba[_0x226bda(0x180)]?_0x5360ba:{'default':_0x5360ba};};Object[a59_0x10677c(0x1ce)](exports,'__esModule',{'value':!![]}),exports[a59_0x10677c(0x202)]=exports[a59_0x10677c(0x1f0)]=void 0x0;const node_telegram_bot_api_1=__importDefault(require(a59_0x10677c(0x159))),database_1=__importDefault(require('../config/database')),gateway_1=require(a59_0x10677c(0x188));class TelegramBotService{constructor(){const _0x204349=a59_0x10677c;this['bot']=null,this[_0x204349(0x1f9)]=process[_0x204349(0x172)][_0x204349(0x173)]||'',this[_0x204349(0x1b2)]=process['env'][_0x204349(0x19b)]||'trapay_bot',this[_0x204349(0x1f9)]?this[_0x204349(0x165)]():console[_0x204349(0x18c)](_0x204349(0x17d));}[a59_0x10677c(0x165)](){const _0xdec369=a59_0x10677c;try{this[_0xdec369(0x1b5)]=new node_telegram_bot_api_1[(_0xdec369(0x1f1))](this[_0xdec369(0x1f9)],{'polling':!![]}),this[_0xdec369(0x224)](),console['log'](_0xdec369(0x225)+this[_0xdec369(0x1b2)]+'\x20initialized\x20successfully');}catch(_0x101113){console[_0xdec369(0x1dc)](_0xdec369(0x18f),_0x101113);}}['setupBotHandlers'](){const _0x454866=a59_0x10677c;if(!this['bot'])return;this[_0x454866(0x1b5)]['onText'](/\/start/,async _0x44a893=>{const _0x12c6c9=_0x454866,_0x20b677=_0x44a893[_0x12c6c9(0x1e1)]['id'],_0x216b44=_0x44a893[_0x12c6c9(0x169)]?.['id'][_0x12c6c9(0x192)](),_0x4c0bbb=_0x44a893['from']?.[_0x12c6c9(0x19a)],_0x5557ee=_0x44a893[_0x12c6c9(0x169)]?.['first_name'],_0x2fc2a7=_0x44a893['from']?.[_0x12c6c9(0x17f)];if(!_0x216b44)return;try{let _0x722b0d=await database_1[_0x12c6c9(0x1f1)][_0x12c6c9(0x1c2)][_0x12c6c9(0x213)]({'where':{'telegramId':_0x216b44},'include':{'shop':!![]}});!_0x722b0d?(_0x722b0d=await database_1[_0x12c6c9(0x1f1)][_0x12c6c9(0x1c2)][_0x12c6c9(0x17e)]({'data':{'telegramId':_0x216b44,'username':_0x4c0bbb,'firstName':_0x5557ee,'lastName':_0x2fc2a7,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console[_0x12c6c9(0x203)]('📱\x20Created\x20new\x20Telegram\x20user:\x20'+_0x216b44+_0x12c6c9(0x1e6)+_0x4c0bbb+')')):_0x722b0d=await database_1[_0x12c6c9(0x1f1)][_0x12c6c9(0x1c2)][_0x12c6c9(0x222)]({'where':{'telegramId':_0x216b44},'data':{'username':_0x4c0bbb,'firstName':_0x5557ee,'lastName':_0x2fc2a7},'include':{'shop':!![]}}),_0x722b0d[_0x12c6c9(0x1d5)]&&_0x722b0d[_0x12c6c9(0x196)]&&_0x722b0d[_0x12c6c9(0x1d2)]?await this[_0x12c6c9(0x1b5)]?.[_0x12c6c9(0x209)](_0x20b677,_0x12c6c9(0x22f)+(_0x12c6c9(0x1ed)+_0x722b0d['shop'][_0x12c6c9(0x1ba)]+'*\x0a')+(_0x12c6c9(0x211)+_0x722b0d['shop'][_0x12c6c9(0x19a)]+_0x12c6c9(0x1bc))+_0x12c6c9(0x1e4)+'•\x20New\x20payments\x0a'+_0x12c6c9(0x21e)+_0x12c6c9(0x166)+_0x12c6c9(0x17b)+'/status\x20-\x20check\x20connection\x20status\x0a'+_0x12c6c9(0x1fc),{'parse_mode':_0x12c6c9(0x233)}):(_0x722b0d[_0x12c6c9(0x196)]&&!_0x722b0d[_0x12c6c9(0x1d5)]&&(await database_1[_0x12c6c9(0x1f1)][_0x12c6c9(0x1c2)][_0x12c6c9(0x222)]({'where':{'telegramId':_0x216b44},'data':{'shopId':null,'isVerified':![]}}),console[_0x12c6c9(0x203)](_0x12c6c9(0x205)+_0x216b44)),await this[_0x12c6c9(0x1b5)]?.[_0x12c6c9(0x209)](_0x20b677,_0x12c6c9(0x17a)+_0x12c6c9(0x1e9)+_0x12c6c9(0x1d7)+_0x12c6c9(0x1c3)+_0x12c6c9(0x221)+'❗️\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!',{'parse_mode':_0x12c6c9(0x233)}));}catch(_0x309f7d){console[_0x12c6c9(0x1dc)](_0x12c6c9(0x185),_0x309f7d),await this[_0x12c6c9(0x1b5)]?.[_0x12c6c9(0x209)](_0x20b677,_0x12c6c9(0x22a));}}),this[_0x454866(0x1b5)]['onText'](/\/disconnect/,async _0x2af3b=>{const _0x48133d=_0x454866,_0x50ae55=_0x2af3b['chat']['id'],_0xe2713=_0x2af3b['from']?.['id'][_0x48133d(0x192)]();if(!_0xe2713)return;try{const _0x5416ed=await database_1[_0x48133d(0x1f1)][_0x48133d(0x1c2)]['findUnique']({'where':{'telegramId':_0xe2713},'include':{'shop':!![]}});if(!_0x5416ed||!_0x5416ed[_0x48133d(0x1d5)]||!_0x5416ed[_0x48133d(0x196)]){await this[_0x48133d(0x1b5)]?.['sendMessage'](_0x50ae55,_0x48133d(0x179));return;}const _0x361850=_0x5416ed['shop']?.[_0x48133d(0x1ba)]||'unknown\x20shop';await database_1['default'][_0x48133d(0x1c2)]['update']({'where':{'telegramId':_0xe2713},'data':{'shopId':null,'isVerified':![]}}),console['log']('🔌\x20User\x20'+_0xe2713+'\x20disconnected\x20from\x20shop\x20'+_0x5416ed[_0x48133d(0x196)]),await this['bot']?.[_0x48133d(0x209)](_0x50ae55,_0x48133d(0x16e)+_0x361850+_0x48133d(0x197)+_0x48133d(0x1cb),{'parse_mode':'Markdown'});}catch(_0x414472){console[_0x48133d(0x1dc)]('Error\x20handling\x20/disconnect\x20command:',_0x414472),await this['bot']?.['sendMessage'](_0x50ae55,_0x48133d(0x22a));}}),this[_0x454866(0x1b5)][_0x454866(0x1f8)](/\/status/,async _0x4ce807=>{const _0x34b178=_0x454866,_0x35626a=_0x4ce807[_0x34b178(0x1e1)]['id'],_0x431fbe=_0x4ce807['from']?.['id'][_0x34b178(0x192)]();if(!_0x431fbe)return;try{const _0x48f80a=await database_1['default']['telegramUser'][_0x34b178(0x213)]({'where':{'telegramId':_0x431fbe},'include':{'shop':!![]}});if(!_0x48f80a){await this['bot']?.[_0x34b178(0x209)](_0x35626a,_0x34b178(0x160)+'Use\x20/start\x20to\x20begin.');return;}if(!_0x48f80a[_0x34b178(0x1d5)]||!_0x48f80a[_0x34b178(0x196)]||!_0x48f80a[_0x34b178(0x1d2)]){await this[_0x34b178(0x1b5)]?.[_0x34b178(0x209)](_0x35626a,_0x34b178(0x20b)+'Use\x20/start\x20to\x20connect.');return;}await this[_0x34b178(0x1b5)]?.[_0x34b178(0x209)](_0x35626a,_0x34b178(0x200)+(_0x34b178(0x15d)+_0x48f80a[_0x34b178(0x1d2)][_0x34b178(0x1ba)]+'*\x0a')+(_0x34b178(0x1a9)+_0x48f80a[_0x34b178(0x1d2)][_0x34b178(0x19a)]+'`\x0a')+(_0x34b178(0x158)+_0x48f80a['updatedAt'][_0x34b178(0x16b)](_0x34b178(0x214))+'\x0a\x0a')+_0x34b178(0x21b)+_0x34b178(0x17b)+_0x34b178(0x1fc),{'parse_mode':'Markdown'});}catch(_0x59ac81){console['error'](_0x34b178(0x1c9),_0x59ac81),await this['bot']?.[_0x34b178(0x209)](_0x35626a,'❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this['bot'][_0x454866(0x1f8)](/\/debug/,async _0x187f8b=>{const _0x30baf8=_0x454866,_0x5af114=_0x187f8b[_0x30baf8(0x1e1)]['id'],_0x3b6fd5=_0x187f8b['from']?.['id'][_0x30baf8(0x192)]();if(!_0x3b6fd5)return;try{const _0x3efdbc=await database_1[_0x30baf8(0x1f1)][_0x30baf8(0x1d2)][_0x30baf8(0x1c0)]({'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![]},'take':0xa});let _0x2daf85=_0x30baf8(0x1eb);_0x2daf85+=_0x30baf8(0x1cc)+_0x3b6fd5+_0x30baf8(0x1bc),_0x2daf85+='🏪\x20Available\x20shops\x20in\x20system:\x0a',_0x3efdbc[_0x30baf8(0x236)]((_0x2d2ca,_0x545709)=>{const _0x12af5e=_0x30baf8;_0x2daf85+=_0x545709+0x1+'.\x20*'+_0x2d2ca[_0x12af5e(0x1ba)]+'*\x0a',_0x2daf85+=_0x12af5e(0x1f3)+_0x2d2ca[_0x12af5e(0x19a)]+'`\x0a',_0x2daf85+=_0x12af5e(0x18d)+_0x2d2ca[_0x12af5e(0x19e)]+'\x0a',_0x2daf85+='\x20\x20\x20Public\x20Key:\x20`'+_0x2d2ca['publicKey'][_0x12af5e(0x19d)](0x0,0xf)+_0x12af5e(0x15e);}),await this[_0x30baf8(0x1b5)]?.[_0x30baf8(0x209)](_0x5af114,_0x2daf85,{'parse_mode':_0x30baf8(0x233)});}catch(_0xbe6228){console[_0x30baf8(0x1dc)](_0x30baf8(0x21f),_0xbe6228),await this[_0x30baf8(0x1b5)]?.[_0x30baf8(0x209)](_0x5af114,_0x30baf8(0x1a1));}}),this['bot']['on'](_0x454866(0x20d),async _0x2e9143=>{const _0x5e9de8=_0x454866;if(_0x2e9143[_0x5e9de8(0x1fb)]?.[_0x5e9de8(0x235)]('/'))return;const _0x3cdc79=_0x2e9143[_0x5e9de8(0x1e1)]['id'],_0x400525=_0x2e9143[_0x5e9de8(0x169)]?.['id']['toString'](),_0x146df7=_0x2e9143[_0x5e9de8(0x1fb)]?.['trim']();if(!_0x400525||!_0x146df7)return;try{const _0x38e37f=await database_1[_0x5e9de8(0x1f1)][_0x5e9de8(0x1c2)][_0x5e9de8(0x213)]({'where':{'telegramId':_0x400525},'include':{'shop':!![]}});if(!_0x38e37f){await this[_0x5e9de8(0x1b5)]?.[_0x5e9de8(0x209)](_0x3cdc79,_0x5e9de8(0x162));return;}if(_0x38e37f['isVerified']&&_0x38e37f[_0x5e9de8(0x196)]&&_0x38e37f[_0x5e9de8(0x1d2)]){await this[_0x5e9de8(0x1b5)]?.[_0x5e9de8(0x209)](_0x3cdc79,_0x5e9de8(0x189)+_0x38e37f[_0x5e9de8(0x1d2)][_0x5e9de8(0x1ba)]+_0x5e9de8(0x197)+_0x5e9de8(0x182),{'parse_mode':'Markdown'});return;}const _0x29decb=_0x146df7[_0x5e9de8(0x23a)](/\s+/);if(_0x29decb[_0x5e9de8(0x18a)]!==0x2){await this[_0x5e9de8(0x1b5)]?.['sendMessage'](_0x3cdc79,'❌\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a'+_0x5e9de8(0x1d7)+_0x5e9de8(0x1c3)+'`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a'+(_0x5e9de8(0x17c)+_0x29decb[_0x5e9de8(0x18a)]+'\x20parts:\x20'+_0x29decb['map'](_0x793387=>'`'+_0x793387+'`')[_0x5e9de8(0x1f4)](',\x20')),{'parse_mode':_0x5e9de8(0x233)});return;}const [_0x2bb755,_0x434f5c]=_0x29decb;console[_0x5e9de8(0x203)]('🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20'+_0x400525+_0x5e9de8(0x219)+_0x2bb755+_0x5e9de8(0x1df)+_0x434f5c['substring'](0x0,0xa)+'...\x22'),await this[_0x5e9de8(0x1c6)](_0x3cdc79,_0x400525,_0x2bb755,_0x434f5c);}catch(_0x1c2560){console[_0x5e9de8(0x1dc)](_0x5e9de8(0x1f6),_0x1c2560),await this[_0x5e9de8(0x1b5)]?.[_0x5e9de8(0x209)](_0x3cdc79,_0x5e9de8(0x22a));}}),this[_0x454866(0x1b5)]['on']('error',_0x91e31a=>{const _0x324491=_0x454866;console[_0x324491(0x1dc)](_0x324491(0x184),_0x91e31a);}),this[_0x454866(0x1b5)]['on'](_0x454866(0x19c),_0x42615d=>{const _0x5228aa=_0x454866;console['error'](_0x5228aa(0x1e2),_0x42615d);});}async[a59_0x10677c(0x1c6)](_0x4b0c43,_0x788988,_0x3aef56,_0x59523c){const _0x2f77ea=a59_0x10677c;try{console[_0x2f77ea(0x203)](_0x2f77ea(0x152)+_0x788988+':\x20username=\x22'+_0x3aef56+'\x22,\x20apiKey=\x22'+_0x59523c[_0x2f77ea(0x19d)](0x0,0xa)+_0x2f77ea(0x193));if(!_0x3aef56||_0x3aef56['length']<0x3||_0x3aef56[_0x2f77ea(0x18a)]>0x32||!/^[a-zA-Z0-9_]+$/['test'](_0x3aef56)){await this[_0x2f77ea(0x1b5)]?.[_0x2f77ea(0x209)](_0x4b0c43,_0x2f77ea(0x1c5)+_0x3aef56+'`\x0a\x0a'+_0x2f77ea(0x1ec),{'parse_mode':_0x2f77ea(0x233)});return;}if(!_0x59523c||!_0x59523c[_0x2f77ea(0x235)]('pk_')&&!_0x59523c[_0x2f77ea(0x235)](_0x2f77ea(0x239))){await this[_0x2f77ea(0x1b5)]?.[_0x2f77ea(0x209)](_0x4b0c43,_0x2f77ea(0x171)+_0x2f77ea(0x1db),{'parse_mode':_0x2f77ea(0x233)});return;}const _0x16a59d=await database_1[_0x2f77ea(0x1f1)][_0x2f77ea(0x1d2)][_0x2f77ea(0x213)]({'where':{'username':_0x3aef56},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x16a59d){const _0x1672e0=await database_1[_0x2f77ea(0x1f1)][_0x2f77ea(0x1d2)][_0x2f77ea(0x1c0)]({'select':{'username':!![],'name':!![]},'take':0x5});let _0x5709a4='❌\x20Shop\x20with\x20username\x20`'+_0x3aef56+_0x2f77ea(0x199);_0x1672e0[_0x2f77ea(0x18a)]>0x0?(_0x5709a4+=_0x2f77ea(0x215),_0x1672e0[_0x2f77ea(0x236)](_0x4b5ece=>{const _0xe8f262=_0x2f77ea;_0x5709a4+=_0xe8f262(0x1f5)+_0x4b5ece[_0xe8f262(0x19a)]+'`\x20('+_0x4b5ece[_0xe8f262(0x1ba)]+')\x0a';}),_0x5709a4+='\x0aCheck\x20spelling\x20and\x20try\x20again.'):_0x5709a4+=_0x2f77ea(0x18e);await this['bot']?.[_0x2f77ea(0x209)](_0x4b0c43,_0x5709a4,{'parse_mode':'Markdown'});return;}if(_0x16a59d['status']!==_0x2f77ea(0x226)){await this[_0x2f77ea(0x1b5)]?.[_0x2f77ea(0x209)](_0x4b0c43,_0x2f77ea(0x207)+_0x3aef56+'`\x20is\x20inactive.\x0a\x0a'+_0x2f77ea(0x167),{'parse_mode':'Markdown'});return;}if(_0x16a59d[_0x2f77ea(0x22d)]!==_0x59523c&&_0x16a59d[_0x2f77ea(0x16f)]!==_0x59523c){await this['bot']?.[_0x2f77ea(0x209)](_0x4b0c43,_0x2f77ea(0x183)+_0x3aef56+_0x2f77ea(0x154)+_0x2f77ea(0x1fd)+_0x2f77ea(0x1ac),{'parse_mode':_0x2f77ea(0x233)});return;}const _0x1292e7=await database_1[_0x2f77ea(0x1f1)][_0x2f77ea(0x1c2)][_0x2f77ea(0x177)]({'where':{'shopId':_0x16a59d['id'],'isVerified':!![],'telegramId':{'not':_0x788988}}});if(_0x1292e7){await this['bot']?.[_0x2f77ea(0x209)](_0x4b0c43,_0x2f77ea(0x161)+_0x3aef56+_0x2f77ea(0x154)+_0x2f77ea(0x1ab),{'parse_mode':_0x2f77ea(0x233)});return;}await database_1[_0x2f77ea(0x1f1)][_0x2f77ea(0x1c2)][_0x2f77ea(0x222)]({'where':{'telegramId':_0x788988},'data':{'shopId':_0x16a59d['id'],'isVerified':!![]}}),await this[_0x2f77ea(0x1b5)]?.[_0x2f77ea(0x209)](_0x4b0c43,_0x2f77ea(0x1c7)+'✅\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a'+(_0x2f77ea(0x220)+_0x16a59d[_0x2f77ea(0x1ba)]+'*\x0a')+('👤\x20Username:\x20`'+_0x16a59d[_0x2f77ea(0x19a)]+_0x2f77ea(0x1bc))+_0x2f77ea(0x1da)+_0x2f77ea(0x1cd)+_0x2f77ea(0x21e)+_0x2f77ea(0x1a2)+_0x2f77ea(0x1aa)+_0x2f77ea(0x17b)+_0x2f77ea(0x1b8)+_0x2f77ea(0x1fc),{'parse_mode':_0x2f77ea(0x233)}),console[_0x2f77ea(0x203)](_0x2f77ea(0x1ef)+_0x788988+'\x20verified\x20for\x20shop\x20'+_0x16a59d[_0x2f77ea(0x19a)]+_0x2f77ea(0x15b));}catch(_0x361800){console[_0x2f77ea(0x1dc)](_0x2f77ea(0x175),_0x361800),await this[_0x2f77ea(0x1b5)]?.['sendMessage'](_0x4b0c43,_0x2f77ea(0x1d3));}}async[a59_0x10677c(0x1c4)](_0x31adac,_0x12be02,_0x379089){const _0x54c6e5=a59_0x10677c;if(!this[_0x54c6e5(0x1b5)]){console[_0x54c6e5(0x18c)](_0x54c6e5(0x157));return;}try{const _0x57de6e=await database_1['default']['telegramUser']['findMany']({'where':{'shopId':_0x31adac,'isVerified':!![]}});if(_0x57de6e[_0x54c6e5(0x18a)]===0x0){console[_0x54c6e5(0x203)](_0x54c6e5(0x153)+_0x31adac);return;}const _0x1b1586=_0x57de6e[_0x54c6e5(0x1e5)](async _0x4f2dc8=>{const _0x1b6ade=_0x54c6e5;try{await this[_0x1b6ade(0x1b5)]?.[_0x1b6ade(0x209)](_0x4f2dc8[_0x1b6ade(0x16d)],_0x12be02,_0x379089),console[_0x1b6ade(0x203)](_0x1b6ade(0x228)+_0x4f2dc8[_0x1b6ade(0x16d)]);}catch(_0x14ba6c){console[_0x1b6ade(0x1dc)]('❌\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20'+_0x4f2dc8[_0x1b6ade(0x16d)]+':',_0x14ba6c),_0x14ba6c instanceof Error&&(_0x14ba6c['message'][_0x1b6ade(0x16c)](_0x1b6ade(0x186))||_0x14ba6c[_0x1b6ade(0x20d)][_0x1b6ade(0x16c)]('chat\x20not\x20found')||_0x14ba6c[_0x1b6ade(0x20d)][_0x1b6ade(0x16c)](_0x1b6ade(0x232)))&&(await database_1[_0x1b6ade(0x1f1)][_0x1b6ade(0x1c2)]['update']({'where':{'id':_0x4f2dc8['id']},'data':{'isVerified':![]}}),console[_0x1b6ade(0x203)](_0x1b6ade(0x1b6)+_0x4f2dc8[_0x1b6ade(0x16d)]+'\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure'));}});await Promise[_0x54c6e5(0x21a)](_0x1b1586);}catch(_0x38a88b){console[_0x54c6e5(0x1dc)](_0x54c6e5(0x20a),_0x38a88b);}}async[a59_0x10677c(0x1bb)](_0x405b9e,_0x2174fc,_0x14ea3e){const _0x2883f2=a59_0x10677c,_0xddb1b={'created':'🆕','paid':'✅','failed':'❌','expired':'⏰','refund':'🔄','chargeback':'⚠️','processing':'⚙️'},_0x33b5e8={'created':'New\x20payment\x20created','paid':_0x2883f2(0x20f),'failed':_0x2883f2(0x1ca),'expired':_0x2883f2(0x1ad),'refund':_0x2883f2(0x1e0),'chargeback':_0x2883f2(0x237),'processing':_0x2883f2(0x1bd)},_0x2d6ca2=_0xddb1b[_0x14ea3e],_0x4804b2=_0x33b5e8[_0x14ea3e],_0x45cf4e=(0x0,gateway_1[_0x2883f2(0x176)])(_0x2174fc[_0x2883f2(0x1a0)]);console[_0x2883f2(0x203)](_0x2883f2(0x168)+_0x2174fc[_0x2883f2(0x1a0)]+'\x22\x20->\x20display\x20\x22'+_0x45cf4e+'\x22');let _0x30daca=_0x2d6ca2+'\x20*'+_0x4804b2+_0x2883f2(0x1a4)+(_0x2883f2(0x1e7)+_0x2174fc[_0x2883f2(0x1dd)]+'\x20'+_0x2174fc[_0x2883f2(0x1ae)]+'*\x0a')+(_0x2883f2(0x1fa)+(_0x2174fc[_0x2883f2(0x227)]||_0x2174fc['id'])+'`\x0a')+('🆔\x20Payment\x20ID:\x20`'+_0x2174fc['id']+'`\x0a')+(_0x2883f2(0x1d0)+_0x45cf4e+'`\x0a')+('📅\x20Date:\x20'+new Date(_0x2174fc['createdAt'])[_0x2883f2(0x1b0)]('en-US')+'\x0a');if(_0x2174fc['customerName']||_0x2174fc['customerEmail']||_0x2174fc[_0x2883f2(0x1c8)]||_0x2174fc[_0x2883f2(0x15c)]||_0x2174fc[_0x2883f2(0x210)]){_0x30daca+=_0x2883f2(0x1a8);_0x2174fc['customerName']&&(_0x30daca+=_0x2883f2(0x204)+_0x2174fc[_0x2883f2(0x1be)]+'`\x0a');_0x2174fc[_0x2883f2(0x198)]&&(_0x30daca+=_0x2883f2(0x170)+_0x2174fc['customerEmail']+'`\x0a');_0x2174fc[_0x2883f2(0x1c8)]&&(_0x30daca+=_0x2883f2(0x231)+_0x2174fc[_0x2883f2(0x1c8)]+'`\x0a');_0x2174fc[_0x2883f2(0x15c)]&&(_0x30daca+=_0x2883f2(0x217)+_0x2174fc[_0x2883f2(0x15c)]+'`\x0a');if(_0x2174fc[_0x2883f2(0x210)]){const _0x5d3eef=_0x2174fc[_0x2883f2(0x210)]['length']>0x32?_0x2174fc[_0x2883f2(0x210)][_0x2883f2(0x19d)](0x0,0x32)+_0x2883f2(0x1e3):_0x2174fc[_0x2883f2(0x210)];_0x30daca+=_0x2883f2(0x18b)+_0x5d3eef+'`\x0a';}}_0x14ea3e===_0x2883f2(0x1fe)&&_0x2174fc[_0x2883f2(0x164)]&&(_0x30daca+=_0x2883f2(0x216)+_0x2174fc[_0x2883f2(0x164)]+_0x2883f2(0x1d1)),_0x14ea3e===_0x2883f2(0x1d4)&&(_0x30daca+=_0x2883f2(0x1c1)),_0x2174fc[_0x2883f2(0x1d8)]&&(_0x30daca+=_0x2883f2(0x1ee)+_0x2174fc[_0x2883f2(0x1d8)]+'\x0a'),await this[_0x2883f2(0x1c4)](_0x405b9e,_0x30daca,{'parse_mode':_0x2883f2(0x233)});}async[a59_0x10677c(0x23b)](_0x3ae1fd,_0x3bcc0a,_0x49b6f1){const _0x29c646=a59_0x10677c,_0x3cdd94={'created':'📤','completed':'✅','rejected':'❌'},_0x5aefc9={'created':_0x29c646(0x1a3),'completed':_0x29c646(0x1cf),'rejected':_0x29c646(0x155)},_0x1caf26=_0x3cdd94[_0x49b6f1],_0x31fc30=_0x5aefc9[_0x49b6f1],_0x1ebe66=_0x1caf26+'\x20*'+_0x31fc30+_0x29c646(0x1a4)+(_0x29c646(0x15f)+_0x3bcc0a['amount']+'\x20USD*\x0a')+(_0x29c646(0x1a6)+_0x3bcc0a['method']+'`\x0a')+(_0x29c646(0x1f2)+_0x3bcc0a['id']+'`\x0a')+(_0x29c646(0x190)+new Date(_0x3bcc0a[_0x29c646(0x1ff)])[_0x29c646(0x1b0)]('en-US')+'\x0a')+(_0x3bcc0a[_0x29c646(0x1b1)]?_0x29c646(0x156)+_0x3bcc0a['txid']+'`':'');await this['sendShopNotification'](_0x3ae1fd,_0x1ebe66,{'parse_mode':_0x29c646(0x233)});}async['sendLoginNotification'](_0x57eb7c,_0x25585b){const _0x1bb573=a59_0x10677c;try{const _0x1f4e82=await database_1[_0x1bb573(0x1f1)][_0x1bb573(0x163)][_0x1bb573(0x213)]({'where':{'shopId':_0x57eb7c},'select':{'notificationLogin':!![]}});if(!_0x1f4e82?.[_0x1bb573(0x195)]){console['log']('📱\x20Login\x20notifications\x20disabled\x20for\x20shop\x20'+_0x57eb7c);return;}const _0x151f99=_0x25585b['success']?'🔐':'🚨',_0x79a44=_0x25585b[_0x1bb573(0x1b7)]?_0x1bb573(0x1bf):_0x1bb573(0x21d);let _0x19b1ae=_0x151f99+'\x20*'+_0x79a44+_0x1bb573(0x1a4)+(_0x1bb573(0x1a9)+_0x25585b[_0x1bb573(0x19a)]+'`\x0a')+('📅\x20Time:\x20'+_0x25585b['timestamp']['toLocaleString'](_0x1bb573(0x214))+'\x0a');_0x25585b[_0x1bb573(0x223)]&&(_0x19b1ae+='🌐\x20IP\x20address:\x20`'+_0x25585b['ipAddress']+'`\x0a');if(_0x25585b[_0x1bb573(0x1a5)]){const _0x337ed7=_0x25585b[_0x1bb573(0x1a5)]['length']>0x32?_0x25585b[_0x1bb573(0x1a5)][_0x1bb573(0x19d)](0x0,0x32)+_0x1bb573(0x1e3):_0x25585b['userAgent'];_0x19b1ae+=_0x1bb573(0x18b)+_0x337ed7+'`\x0a';}!_0x25585b['success']&&(_0x19b1ae+=_0x1bb573(0x1de)),await this[_0x1bb573(0x1c4)](_0x57eb7c,_0x19b1ae,{'parse_mode':_0x1bb573(0x233)}),console[_0x1bb573(0x203)](_0x1bb573(0x1f7)+_0x57eb7c+':\x20'+(_0x25585b[_0x1bb573(0x1b7)]?_0x1bb573(0x1b7):_0x1bb573(0x21c)));}catch(_0x202c44){console[_0x1bb573(0x1dc)](_0x1bb573(0x22e),_0x202c44);}}async['sendApiErrorNotification'](_0x3fbc4b,_0x28907e){const _0x4f6908=a59_0x10677c;try{const _0x1902a4=await database_1[_0x4f6908(0x1f1)][_0x4f6908(0x163)][_0x4f6908(0x213)]({'where':{'shopId':_0x3fbc4b},'select':{'notificationApiError':!![]}});if(!_0x1902a4?.['notificationApiError']){console[_0x4f6908(0x203)]('📱\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20'+_0x3fbc4b);return;}let _0x2bea4e=_0x4f6908(0x229)+(_0x4f6908(0x1b4)+_0x28907e[_0x4f6908(0x20e)]+'\x20'+_0x28907e[_0x4f6908(0x218)]+'`\x0a')+(_0x4f6908(0x178)+_0x28907e[_0x4f6908(0x1b3)][_0x4f6908(0x1b0)]('en-US')+'\x0a');_0x28907e['statusCode']&&(_0x2bea4e+=_0x4f6908(0x20c)+_0x28907e[_0x4f6908(0x191)]+'`\x0a'),_0x2bea4e+=_0x4f6908(0x208)+_0x28907e[_0x4f6908(0x16a)]+'`\x0a',_0x28907e[_0x4f6908(0x22b)]&&(_0x2bea4e+=_0x4f6908(0x201)+_0x28907e[_0x4f6908(0x22b)]+'`\x0a'),_0x2bea4e+='\x0a💡\x20Check\x20your\x20request\x20or\x20contact\x20support.',await this[_0x4f6908(0x1c4)](_0x3fbc4b,_0x2bea4e,{'parse_mode':_0x4f6908(0x233)}),console[_0x4f6908(0x203)](_0x4f6908(0x194)+_0x3fbc4b+':\x20'+_0x28907e['endpoint']);}catch(_0x1b3a67){console[_0x4f6908(0x1dc)](_0x4f6908(0x238),_0x1b3a67);}}async[a59_0x10677c(0x19f)](_0x1e5dad,_0x31aabb,_0x1f4b18){const _0x139989=a59_0x10677c;let _0xd2e557=_0x139989(0x174)+_0x31aabb+'*\x0a\x0a';for(const [_0x1c6d82,_0x3e358b]of Object[_0x139989(0x187)](_0x1f4b18)){_0x3e358b!==null&&_0x3e358b!==undefined&&(_0xd2e557+=_0x1c6d82+_0x139989(0x230)+_0x3e358b+'`\x0a');}await this['sendShopNotification'](_0x1e5dad,_0xd2e557,{'parse_mode':'Markdown'});}['getBotInfo'](){const _0xdb7403=a59_0x10677c;return{'isActive':!!this[_0xdb7403(0x1b5)],'username':this[_0xdb7403(0x1b2)]};}['stopBot'](){const _0x2afb51=a59_0x10677c;this['bot']&&(this[_0x2afb51(0x1b5)]['stopPolling'](),this[_0x2afb51(0x1b5)]=null,console[_0x2afb51(0x203)](_0x2afb51(0x206)));}}function a59_0x20b0(_0x4e8fc4,_0x353c3d){const _0x38a8d2=a59_0x38a8();return a59_0x20b0=function(_0x20b03f,_0x5bd1cf){_0x20b03f=_0x20b03f-0x152;let _0x53d614=_0x38a8d2[_0x20b03f];return _0x53d614;},a59_0x20b0(_0x4e8fc4,_0x353c3d);}exports[a59_0x10677c(0x1f0)]=TelegramBotService,exports[a59_0x10677c(0x202)]=new TelegramBotService();