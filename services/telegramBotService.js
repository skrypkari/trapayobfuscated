'use strict';const a55_0x463265=a55_0x2fc7;(function(_0x4e6a5a,_0x5b866b){const _0x34ebd1=a55_0x2fc7,_0x201aa6=_0x4e6a5a();while(!![]){try{const _0x1f6213=-parseInt(_0x34ebd1(0x27b))/0x1+parseInt(_0x34ebd1(0x234))/0x2+-parseInt(_0x34ebd1(0x21e))/0x3+parseInt(_0x34ebd1(0x240))/0x4+parseInt(_0x34ebd1(0x2ab))/0x5*(-parseInt(_0x34ebd1(0x278))/0x6)+-parseInt(_0x34ebd1(0x204))/0x7+parseInt(_0x34ebd1(0x28e))/0x8*(parseInt(_0x34ebd1(0x29d))/0x9);if(_0x1f6213===_0x5b866b)break;else _0x201aa6['push'](_0x201aa6['shift']());}catch(_0x23e3f){_0x201aa6['push'](_0x201aa6['shift']());}}}(a55_0x2a53,0xc4edc));var __importDefault=this&&this[a55_0x463265(0x1eb)]||function(_0x4980bd){const _0x235b6c=a55_0x463265;return _0x4980bd&&_0x4980bd[_0x235b6c(0x1fe)]?_0x4980bd:{'default':_0x4980bd};};Object[a55_0x463265(0x256)](exports,a55_0x463265(0x1fe),{'value':!![]}),exports['telegramBotService']=exports[a55_0x463265(0x219)]=void 0x0;const node_telegram_bot_api_1=__importDefault(require(a55_0x463265(0x23e))),database_1=__importDefault(require(a55_0x463265(0x20f))),gateway_1=require('../types/gateway');function a55_0x2fc7(_0xf15a01,_0x2bbfcd){const _0x2a5300=a55_0x2a53();return a55_0x2fc7=function(_0x2fc740,_0x3742b8){_0x2fc740=_0x2fc740-0x1cb;let _0x35bd7e=_0x2a5300[_0x2fc740];return _0x35bd7e;},a55_0x2fc7(_0xf15a01,_0x2bbfcd);}class TelegramBotService{constructor(){const _0x124ac0=a55_0x463265;this[_0x124ac0(0x21d)]=null,this['botToken']=process['env'][_0x124ac0(0x214)]||'',this[_0x124ac0(0x224)]=process[_0x124ac0(0x1d9)]['TELEGRAM_BOT_USERNAME']||_0x124ac0(0x255),this['botToken']?this[_0x124ac0(0x2a9)]():console[_0x124ac0(0x208)]('TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables');}[a55_0x463265(0x2a9)](){const _0x56dc81=a55_0x463265;try{this[_0x56dc81(0x21d)]=new node_telegram_bot_api_1[(_0x56dc81(0x260))](this[_0x56dc81(0x1f8)],{'polling':!![]}),this['setupBotHandlers'](),console['log'](_0x56dc81(0x284)+this[_0x56dc81(0x224)]+'\x20initialized\x20successfully');}catch(_0x1cdad2){console[_0x56dc81(0x253)](_0x56dc81(0x229),_0x1cdad2);}}[a55_0x463265(0x1fd)](){const _0x264ace=a55_0x463265;if(!this['bot'])return;this[_0x264ace(0x21d)][_0x264ace(0x289)](/\/start/,async _0x4c0762=>{const _0x43a748=_0x264ace,_0x2a698c=_0x4c0762[_0x43a748(0x1e3)]['id'],_0x550c6c=_0x4c0762['from']?.['id'][_0x43a748(0x275)](),_0x152011=_0x4c0762[_0x43a748(0x29b)]?.[_0x43a748(0x271)],_0x38d8f6=_0x4c0762[_0x43a748(0x29b)]?.['first_name'],_0x592f0e=_0x4c0762[_0x43a748(0x29b)]?.[_0x43a748(0x2ac)];if(!_0x550c6c)return;try{let _0xa8a539=await database_1['default']['telegramUser'][_0x43a748(0x295)]({'where':{'telegramId':_0x550c6c},'include':{'shop':!![]}});!_0xa8a539?(_0xa8a539=await database_1[_0x43a748(0x260)]['telegramUser'][_0x43a748(0x243)]({'data':{'telegramId':_0x550c6c,'username':_0x152011,'firstName':_0x38d8f6,'lastName':_0x592f0e,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console[_0x43a748(0x272)]('📱\x20Created\x20new\x20Telegram\x20user:\x20'+_0x550c6c+_0x43a748(0x285)+_0x152011+')')):_0xa8a539=await database_1['default'][_0x43a748(0x29c)]['update']({'where':{'telegramId':_0x550c6c},'data':{'username':_0x152011,'firstName':_0x38d8f6,'lastName':_0x592f0e},'include':{'shop':!![]}}),_0xa8a539[_0x43a748(0x29f)]&&_0xa8a539['shopId']&&_0xa8a539[_0x43a748(0x2a8)]?await this['bot']?.['sendMessage'](_0x2a698c,_0x43a748(0x20c)+(_0x43a748(0x269)+_0xa8a539['shop'][_0x43a748(0x1f6)]+'*\x0a')+(_0x43a748(0x22f)+_0xa8a539[_0x43a748(0x2a8)][_0x43a748(0x271)]+_0x43a748(0x280))+_0x43a748(0x1e2)+_0x43a748(0x1f7)+_0x43a748(0x27a)+'•\x20Payouts\x0a\x0a'+_0x43a748(0x1df)+_0x43a748(0x221)+_0x43a748(0x232),{'parse_mode':_0x43a748(0x24d)}):(_0xa8a539[_0x43a748(0x1ce)]&&!_0xa8a539['isVerified']&&(await database_1['default']['telegramUser']['update']({'where':{'telegramId':_0x550c6c},'data':{'shopId':null,'isVerified':![]}}),console[_0x43a748(0x272)](_0x43a748(0x1d0)+_0x550c6c)),await this[_0x43a748(0x21d)]?.[_0x43a748(0x25c)](_0x2a698c,_0x43a748(0x25b)+_0x43a748(0x287)+_0x43a748(0x203)+'Example:\x0a'+'`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a'+_0x43a748(0x277),{'parse_mode':_0x43a748(0x24d)}));}catch(_0x40b05c){console['error'](_0x43a748(0x28a),_0x40b05c),await this[_0x43a748(0x21d)]?.['sendMessage'](_0x2a698c,_0x43a748(0x25d));}}),this[_0x264ace(0x21d)][_0x264ace(0x289)](/\/disconnect/,async _0x584ba7=>{const _0x9819cc=_0x264ace,_0x2c5627=_0x584ba7[_0x9819cc(0x1e3)]['id'],_0x199a5c=_0x584ba7[_0x9819cc(0x29b)]?.['id']['toString']();if(!_0x199a5c)return;try{const _0x4bd43d=await database_1[_0x9819cc(0x260)][_0x9819cc(0x29c)][_0x9819cc(0x295)]({'where':{'telegramId':_0x199a5c},'include':{'shop':!![]}});if(!_0x4bd43d||!_0x4bd43d[_0x9819cc(0x29f)]||!_0x4bd43d[_0x9819cc(0x1ce)]){await this[_0x9819cc(0x21d)]?.[_0x9819cc(0x25c)](_0x2c5627,_0x9819cc(0x20e));return;}const _0x42a21f=_0x4bd43d[_0x9819cc(0x2a8)]?.[_0x9819cc(0x1f6)]||_0x9819cc(0x2a6);await database_1['default'][_0x9819cc(0x29c)][_0x9819cc(0x1db)]({'where':{'telegramId':_0x199a5c},'data':{'shopId':null,'isVerified':![]}}),console['log']('🔌\x20User\x20'+_0x199a5c+_0x9819cc(0x21b)+_0x4bd43d[_0x9819cc(0x1ce)]),await this[_0x9819cc(0x21d)]?.[_0x9819cc(0x25c)](_0x2c5627,_0x9819cc(0x2a4)+_0x42a21f+'*.\x0a\x0a'+'To\x20reconnect,\x20use\x20the\x20/start\x20command',{'parse_mode':_0x9819cc(0x24d)});}catch(_0xe91357){console[_0x9819cc(0x253)](_0x9819cc(0x1d1),_0xe91357),await this[_0x9819cc(0x21d)]?.[_0x9819cc(0x25c)](_0x2c5627,_0x9819cc(0x25d));}}),this[_0x264ace(0x21d)]['onText'](/\/status/,async _0x475bba=>{const _0x193780=_0x264ace,_0xe4f657=_0x475bba[_0x193780(0x1e3)]['id'],_0x182998=_0x475bba['from']?.['id'][_0x193780(0x275)]();if(!_0x182998)return;try{const _0x17b3c9=await database_1['default'][_0x193780(0x29c)][_0x193780(0x295)]({'where':{'telegramId':_0x182998},'include':{'shop':!![]}});if(!_0x17b3c9){await this['bot']?.['sendMessage'](_0xe4f657,_0x193780(0x1f0)+_0x193780(0x27f));return;}if(!_0x17b3c9['isVerified']||!_0x17b3c9['shopId']||!_0x17b3c9[_0x193780(0x2a8)]){await this[_0x193780(0x21d)]?.[_0x193780(0x25c)](_0xe4f657,_0x193780(0x1ea)+_0x193780(0x1f9));return;}await this[_0x193780(0x21d)]?.[_0x193780(0x25c)](_0xe4f657,'📊\x20*Connection\x20Status*\x0a\x0a'+(_0x193780(0x267)+_0x17b3c9['shop'][_0x193780(0x1f6)]+'*\x0a')+(_0x193780(0x252)+_0x17b3c9[_0x193780(0x2a8)]['username']+'`\x0a')+('📅\x20Connection\x20date:\x20'+_0x17b3c9[_0x193780(0x23d)]['toLocaleDateString'](_0x193780(0x27d))+'\x0a\x0a')+_0x193780(0x1f3)+_0x193780(0x1df)+'/disconnect\x20-\x20disconnect\x20from\x20notifications',{'parse_mode':_0x193780(0x24d)});}catch(_0x4f9fcb){console[_0x193780(0x253)](_0x193780(0x292),_0x4f9fcb),await this[_0x193780(0x21d)]?.['sendMessage'](_0xe4f657,'❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this[_0x264ace(0x21d)]['onText'](/\/debug/,async _0x1118fd=>{const _0xbe592c=_0x264ace,_0x2d8ce7=_0x1118fd['chat']['id'],_0x30a4d9=_0x1118fd[_0xbe592c(0x29b)]?.['id'][_0xbe592c(0x275)]();if(!_0x30a4d9)return;try{const _0x3f6389=await database_1[_0xbe592c(0x260)][_0xbe592c(0x2a8)]['findMany']({'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![]},'take':0xa});let _0x4c7957='🔍\x20*Debug\x20Information*\x0a\x0a';_0x4c7957+='📱\x20Your\x20Telegram\x20ID:\x20`'+_0x30a4d9+'`\x0a\x0a',_0x4c7957+='🏪\x20Available\x20shops\x20in\x20system:\x0a',_0x3f6389[_0xbe592c(0x21c)]((_0x503ab8,_0x30706b)=>{const _0x4e8678=_0xbe592c;_0x4c7957+=_0x30706b+0x1+_0x4e8678(0x291)+_0x503ab8[_0x4e8678(0x1f6)]+'*\x0a',_0x4c7957+=_0x4e8678(0x26f)+_0x503ab8[_0x4e8678(0x271)]+'`\x0a',_0x4c7957+=_0x4e8678(0x1fb)+_0x503ab8[_0x4e8678(0x296)]+'\x0a',_0x4c7957+='\x20\x20\x20Public\x20Key:\x20`'+_0x503ab8['publicKey'][_0x4e8678(0x1f2)](0x0,0xf)+_0x4e8678(0x1d7);}),await this[_0xbe592c(0x21d)]?.[_0xbe592c(0x25c)](_0x2d8ce7,_0x4c7957,{'parse_mode':_0xbe592c(0x24d)});}catch(_0x422c11){console[_0xbe592c(0x253)](_0xbe592c(0x201),_0x422c11),await this[_0xbe592c(0x21d)]?.[_0xbe592c(0x25c)](_0x2d8ce7,_0xbe592c(0x241));}}),this[_0x264ace(0x21d)]['on'](_0x264ace(0x266),async _0x1ede47=>{const _0x11f679=_0x264ace;if(_0x1ede47['text']?.[_0x11f679(0x1e8)]('/'))return;const _0x686861=_0x1ede47[_0x11f679(0x1e3)]['id'],_0x45079f=_0x1ede47[_0x11f679(0x29b)]?.['id'][_0x11f679(0x275)](),_0x13a326=_0x1ede47[_0x11f679(0x1e7)]?.[_0x11f679(0x22a)]();if(!_0x45079f||!_0x13a326)return;try{const _0x46a71f=await database_1[_0x11f679(0x260)][_0x11f679(0x29c)][_0x11f679(0x295)]({'where':{'telegramId':_0x45079f},'include':{'shop':!![]}});if(!_0x46a71f){await this['bot']?.[_0x11f679(0x25c)](_0x686861,_0x11f679(0x206));return;}if(_0x46a71f[_0x11f679(0x29f)]&&_0x46a71f['shopId']&&_0x46a71f[_0x11f679(0x2a8)]){await this['bot']?.[_0x11f679(0x25c)](_0x686861,'✅\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*'+_0x46a71f['shop'][_0x11f679(0x1f6)]+'*.\x0a\x0a'+_0x11f679(0x217),{'parse_mode':_0x11f679(0x24d)});return;}const _0x45f467=_0x13a326[_0x11f679(0x274)](/\s+/);if(_0x45f467[_0x11f679(0x23f)]!==0x2){await this[_0x11f679(0x21d)]?.[_0x11f679(0x25c)](_0x686861,'❌\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a'+'📝\x20Format:\x20`username\x20api_key`\x0a\x0a'+'Example:\x0a'+_0x11f679(0x1de)+(_0x11f679(0x1dc)+_0x45f467[_0x11f679(0x23f)]+_0x11f679(0x230)+_0x45f467[_0x11f679(0x246)](_0x3843a3=>'`'+_0x3843a3+'`')[_0x11f679(0x25f)](',\x20')),{'parse_mode':_0x11f679(0x24d)});return;}const [_0x2d5348,_0x523d29]=_0x45f467;console['log'](_0x11f679(0x231)+_0x45079f+_0x11f679(0x1e1)+_0x2d5348+_0x11f679(0x20d)+_0x523d29[_0x11f679(0x1f2)](0x0,0xa)+_0x11f679(0x227)),await this['handleSingleLineVerification'](_0x686861,_0x45079f,_0x2d5348,_0x523d29);}catch(_0x2b93d1){console['error'](_0x11f679(0x2a3),_0x2b93d1),await this[_0x11f679(0x21d)]?.[_0x11f679(0x25c)](_0x686861,_0x11f679(0x25d));}}),this[_0x264ace(0x21d)]['on'](_0x264ace(0x253),_0x1a4896=>{const _0x1e79b8=_0x264ace;console[_0x1e79b8(0x253)]('Telegram\x20bot\x20error:',_0x1a4896);}),this[_0x264ace(0x21d)]['on'](_0x264ace(0x213),_0x3b5de7=>{const _0x80bbd7=_0x264ace;console[_0x80bbd7(0x253)](_0x80bbd7(0x1e4),_0x3b5de7);});}async[a55_0x463265(0x1e0)](_0x217a89,_0x504f84,_0x1e36f9,_0x10b938){const _0x38cac7=a55_0x463265;try{console['log'](_0x38cac7(0x231)+_0x504f84+_0x38cac7(0x1e1)+_0x1e36f9+_0x38cac7(0x20d)+_0x10b938['substring'](0x0,0xa)+_0x38cac7(0x227));if(!_0x1e36f9||_0x1e36f9['length']<0x3||_0x1e36f9[_0x38cac7(0x23f)]>0x32||!/^[a-zA-Z0-9_]+$/['test'](_0x1e36f9)){await this['bot']?.[_0x38cac7(0x25c)](_0x217a89,_0x38cac7(0x28b)+_0x1e36f9+_0x38cac7(0x280)+_0x38cac7(0x251),{'parse_mode':_0x38cac7(0x24d)});return;}if(!_0x10b938||!_0x10b938[_0x38cac7(0x1e8)](_0x38cac7(0x1fc))&&!_0x10b938[_0x38cac7(0x1e8)](_0x38cac7(0x26d))){await this[_0x38cac7(0x21d)]?.['sendMessage'](_0x217a89,_0x38cac7(0x24c)+'API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.',{'parse_mode':'Markdown'});return;}const _0x136d4a=await database_1[_0x38cac7(0x260)][_0x38cac7(0x2a8)]['findUnique']({'where':{'username':_0x1e36f9},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x136d4a){const _0x462920=await database_1[_0x38cac7(0x260)][_0x38cac7(0x2a8)][_0x38cac7(0x22d)]({'select':{'username':!![],'name':!![]},'take':0x5});let _0x4ed180=_0x38cac7(0x2a5)+_0x1e36f9+_0x38cac7(0x297);_0x462920[_0x38cac7(0x23f)]>0x0?(_0x4ed180+=_0x38cac7(0x290),_0x462920[_0x38cac7(0x21c)](_0xe110e9=>{const _0x10435d=_0x38cac7;_0x4ed180+=_0x10435d(0x235)+_0xe110e9[_0x10435d(0x271)]+_0x10435d(0x22b)+_0xe110e9[_0x10435d(0x1f6)]+')\x0a';}),_0x4ed180+='\x0aCheck\x20spelling\x20and\x20try\x20again.'):_0x4ed180+='Check\x20spelling\x20and\x20try\x20again.';await this['bot']?.[_0x38cac7(0x25c)](_0x217a89,_0x4ed180,{'parse_mode':_0x38cac7(0x24d)});return;}if(_0x136d4a['status']!=='ACTIVE'){await this['bot']?.[_0x38cac7(0x25c)](_0x217a89,_0x38cac7(0x26e)+_0x1e36f9+_0x38cac7(0x293)+'Contact\x20administrator.',{'parse_mode':'Markdown'});return;}if(_0x136d4a[_0x38cac7(0x220)]!==_0x10b938&&_0x136d4a[_0x38cac7(0x1e9)]!==_0x10b938){await this[_0x38cac7(0x21d)]?.[_0x38cac7(0x25c)](_0x217a89,'❌\x20API\x20key\x20does\x20not\x20match\x20shop\x20`'+_0x1e36f9+_0x38cac7(0x1d4)+_0x38cac7(0x223)+_0x38cac7(0x270),{'parse_mode':_0x38cac7(0x24d)});return;}const _0x4aacc7=await database_1[_0x38cac7(0x260)][_0x38cac7(0x29c)][_0x38cac7(0x2a2)]({'where':{'shopId':_0x136d4a['id'],'isVerified':!![],'telegramId':{'not':_0x504f84}}});if(_0x4aacc7){await this[_0x38cac7(0x21d)]?.[_0x38cac7(0x25c)](_0x217a89,'❌\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`'+_0x1e36f9+_0x38cac7(0x1d4)+'Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.',{'parse_mode':_0x38cac7(0x24d)});return;}await database_1[_0x38cac7(0x260)][_0x38cac7(0x29c)][_0x38cac7(0x1db)]({'where':{'telegramId':_0x504f84},'data':{'shopId':_0x136d4a['id'],'isVerified':!![]}}),await this['bot']?.[_0x38cac7(0x25c)](_0x217a89,_0x38cac7(0x26c)+_0x38cac7(0x215)+(_0x38cac7(0x1f5)+_0x136d4a[_0x38cac7(0x1f6)]+'*\x0a')+(_0x38cac7(0x252)+_0x136d4a[_0x38cac7(0x271)]+_0x38cac7(0x280))+'🔔\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a'+_0x38cac7(0x1f7)+_0x38cac7(0x27a)+_0x38cac7(0x212)+'•\x20Important\x20events\x0a\x0a'+_0x38cac7(0x1df)+_0x38cac7(0x221)+'/disconnect\x20-\x20disconnect\x20from\x20notifications',{'parse_mode':'Markdown'}),console[_0x38cac7(0x272)](_0x38cac7(0x236)+_0x504f84+_0x38cac7(0x299)+_0x136d4a[_0x38cac7(0x271)]+_0x38cac7(0x26b));}catch(_0x235582){console[_0x38cac7(0x253)](_0x38cac7(0x1da),_0x235582),await this['bot']?.['sendMessage'](_0x217a89,_0x38cac7(0x24b));}}async[a55_0x463265(0x2aa)](_0x355a46,_0x5842c0,_0x3cac31){const _0x36587a=a55_0x463265;if(!this[_0x36587a(0x21d)]){console[_0x36587a(0x208)]('Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification');return;}try{const _0x3edda8=await database_1[_0x36587a(0x260)]['telegramUser'][_0x36587a(0x22d)]({'where':{'shopId':_0x355a46,'isVerified':!![]}});if(_0x3edda8[_0x36587a(0x23f)]===0x0){console[_0x36587a(0x272)](_0x36587a(0x2a0)+_0x355a46);return;}const _0x3f80e8=_0x3edda8[_0x36587a(0x246)](async _0x42a855=>{const _0x1d64bf=_0x36587a;try{await this[_0x1d64bf(0x21d)]?.[_0x1d64bf(0x25c)](_0x42a855['telegramId'],_0x5842c0,_0x3cac31),console[_0x1d64bf(0x272)](_0x1d64bf(0x1dd)+_0x42a855[_0x1d64bf(0x205)]);}catch(_0x17eb83){console[_0x1d64bf(0x253)](_0x1d64bf(0x24f)+_0x42a855['telegramId']+':',_0x17eb83),_0x17eb83 instanceof Error&&(_0x17eb83[_0x1d64bf(0x266)][_0x1d64bf(0x286)](_0x1d64bf(0x2a1))||_0x17eb83['message']['includes'](_0x1d64bf(0x218))||_0x17eb83['message'][_0x1d64bf(0x286)]('user\x20is\x20deactivated'))&&(await database_1[_0x1d64bf(0x260)][_0x1d64bf(0x29c)][_0x1d64bf(0x1db)]({'where':{'id':_0x42a855['id']},'data':{'isVerified':![]}}),console[_0x1d64bf(0x272)](_0x1d64bf(0x24e)+_0x42a855[_0x1d64bf(0x205)]+_0x1d64bf(0x1d8)));}});await Promise['allSettled'](_0x3f80e8);}catch(_0xab2128){console[_0x36587a(0x253)](_0x36587a(0x248),_0xab2128);}}async[a55_0x463265(0x259)](_0x5633a8,_0x5c6041,_0x43c3df){const _0x4b6323=a55_0x463265,_0x35e76d={'created':'🆕','paid':'✅','failed':'❌','expired':'⏰','refund':'🔄','chargeback':'⚠️','processing':'⚙️'},_0x5b95d3={'created':'New\x20payment\x20created','paid':_0x4b6323(0x222),'failed':_0x4b6323(0x28c),'expired':_0x4b6323(0x268),'refund':_0x4b6323(0x21f),'chargeback':'Payment\x20chargeback','processing':_0x4b6323(0x29e)},_0x3498a8=_0x35e76d[_0x43c3df],_0x58de41=_0x5b95d3[_0x43c3df],_0x2a93ee=(0x0,gateway_1[_0x4b6323(0x27e)])(_0x5c6041[_0x4b6323(0x237)]);console[_0x4b6323(0x272)]('📱\x20Telegram\x20notification:\x20gateway\x20\x22'+_0x5c6041[_0x4b6323(0x237)]+'\x22\x20->\x20display\x20\x22'+_0x2a93ee+'\x22');let _0x4dc3f5=_0x3498a8+'\x20*'+_0x58de41+'*\x0a\x0a'+(_0x4b6323(0x288)+_0x5c6041[_0x4b6323(0x247)]+'\x20'+_0x5c6041[_0x4b6323(0x262)]+'*\x0a')+(_0x4b6323(0x245)+(_0x5c6041[_0x4b6323(0x23a)]||_0x5c6041['id'])+'`\x0a')+(_0x4b6323(0x1d6)+_0x5c6041['id']+'`\x0a')+(_0x4b6323(0x25a)+_0x2a93ee+'`\x0a')+('📅\x20Date:\x20'+new Date(_0x5c6041[_0x4b6323(0x20a)])['toLocaleString']('en-US')+'\x0a');if(_0x5c6041[_0x4b6323(0x250)]||_0x5c6041['customerEmail']||_0x5c6041[_0x4b6323(0x1f1)]||_0x5c6041[_0x4b6323(0x261)]||_0x5c6041[_0x4b6323(0x2a7)]){_0x4dc3f5+=_0x4b6323(0x1e6);_0x5c6041[_0x4b6323(0x250)]&&(_0x4dc3f5+=_0x4b6323(0x225)+_0x5c6041['customerName']+'`\x0a');_0x5c6041[_0x4b6323(0x22c)]&&(_0x4dc3f5+=_0x4b6323(0x1d3)+_0x5c6041[_0x4b6323(0x22c)]+'`\x0a');_0x5c6041[_0x4b6323(0x1f1)]&&(_0x4dc3f5+=_0x4b6323(0x21a)+_0x5c6041[_0x4b6323(0x1f1)]+'`\x0a');_0x5c6041[_0x4b6323(0x261)]&&(_0x4dc3f5+=_0x4b6323(0x244)+_0x5c6041[_0x4b6323(0x261)]+'`\x0a');if(_0x5c6041['customerUa']){const _0x37f810=_0x5c6041[_0x4b6323(0x2a7)][_0x4b6323(0x23f)]>0x32?_0x5c6041[_0x4b6323(0x2a7)][_0x4b6323(0x1f2)](0x0,0x32)+_0x4b6323(0x202):_0x5c6041[_0x4b6323(0x2a7)];_0x4dc3f5+=_0x4b6323(0x27c)+_0x37f810+'`\x0a';}}_0x43c3df===_0x4b6323(0x210)&&_0x5c6041[_0x4b6323(0x20b)]&&(_0x4dc3f5+=_0x4b6323(0x1ec)+_0x5c6041[_0x4b6323(0x20b)]+_0x4b6323(0x1ee)),_0x43c3df===_0x4b6323(0x1f4)&&(_0x4dc3f5+=_0x4b6323(0x233)),_0x5c6041[_0x4b6323(0x216)]&&(_0x4dc3f5+=_0x4b6323(0x282)+_0x5c6041['adminNotes']+'\x0a'),await this[_0x4b6323(0x2aa)](_0x5633a8,_0x4dc3f5,{'parse_mode':'Markdown'});}async[a55_0x463265(0x1cf)](_0x1a02f9,_0x1cafb4,_0x6f127a){const _0x1607a2=a55_0x463265,_0x312411={'created':'📤','completed':'✅','rejected':'❌'},_0x4dc2a4={'created':_0x1607a2(0x24a),'completed':'Payout\x20completed','rejected':'Payout\x20rejected'},_0x13914e=_0x312411[_0x6f127a],_0x26c63b=_0x4dc2a4[_0x6f127a],_0x544864=_0x13914e+'\x20*'+_0x26c63b+_0x1607a2(0x263)+('💸\x20Amount:\x20*'+_0x1cafb4[_0x1607a2(0x247)]+_0x1607a2(0x281))+('🏦\x20Method:\x20`'+_0x1cafb4[_0x1607a2(0x258)]+'`\x0a')+(_0x1607a2(0x254)+_0x1cafb4['id']+'`\x0a')+(_0x1607a2(0x1e5)+new Date(_0x1cafb4['createdAt'])['toLocaleString'](_0x1607a2(0x27d))+'\x0a')+(_0x1cafb4[_0x1607a2(0x298)]?_0x1607a2(0x1cd)+_0x1cafb4[_0x1607a2(0x298)]+'`':'');await this[_0x1607a2(0x2aa)](_0x1a02f9,_0x544864,{'parse_mode':_0x1607a2(0x24d)});}async[a55_0x463265(0x264)](_0x1919d0,_0x2929ba){const _0x405af8=a55_0x463265;try{const _0x2b8201=await database_1['default']['shopSettings']['findUnique']({'where':{'shopId':_0x1919d0},'select':{'notificationLogin':!![]}});if(!_0x2b8201?.[_0x405af8(0x207)]){console['log'](_0x405af8(0x211)+_0x1919d0);return;}const _0x566298=_0x2929ba[_0x405af8(0x276)]?'🔐':'🚨',_0x581026=_0x2929ba[_0x405af8(0x276)]?_0x405af8(0x283):_0x405af8(0x1ed);let _0x24771a=_0x566298+'\x20*'+_0x581026+'*\x0a\x0a'+(_0x405af8(0x252)+_0x2929ba[_0x405af8(0x271)]+'`\x0a')+('📅\x20Time:\x20'+_0x2929ba[_0x405af8(0x1d5)][_0x405af8(0x25e)](_0x405af8(0x27d))+'\x0a');_0x2929ba[_0x405af8(0x1ef)]&&(_0x24771a+=_0x405af8(0x29a)+_0x2929ba[_0x405af8(0x1ef)]+'`\x0a');if(_0x2929ba[_0x405af8(0x294)]){const _0xdb4f04=_0x2929ba[_0x405af8(0x294)][_0x405af8(0x23f)]>0x32?_0x2929ba[_0x405af8(0x294)][_0x405af8(0x1f2)](0x0,0x32)+_0x405af8(0x202):_0x2929ba['userAgent'];_0x24771a+=_0x405af8(0x27c)+_0xdb4f04+'`\x0a';}!_0x2929ba[_0x405af8(0x276)]&&(_0x24771a+=_0x405af8(0x273)),await this[_0x405af8(0x2aa)](_0x1919d0,_0x24771a,{'parse_mode':_0x405af8(0x24d)}),console[_0x405af8(0x272)](_0x405af8(0x279)+_0x1919d0+':\x20'+(_0x2929ba[_0x405af8(0x276)]?_0x405af8(0x276):_0x405af8(0x249)));}catch(_0x1aabd7){console['error']('Failed\x20to\x20send\x20login\x20notification:',_0x1aabd7);}}async['sendApiErrorNotification'](_0x4bc2f4,_0x2f14f5){const _0x254499=a55_0x463265;try{const _0x2190ad=await database_1[_0x254499(0x260)]['shopSettings']['findUnique']({'where':{'shopId':_0x4bc2f4},'select':{'notificationApiError':!![]}});if(!_0x2190ad?.[_0x254499(0x1ff)]){console[_0x254499(0x272)](_0x254499(0x1d2)+_0x4bc2f4);return;}let _0x18d746=_0x254499(0x28d)+(_0x254499(0x265)+_0x2f14f5[_0x254499(0x258)]+'\x20'+_0x2f14f5['endpoint']+'`\x0a')+(_0x254499(0x238)+_0x2f14f5[_0x254499(0x1d5)][_0x254499(0x25e)](_0x254499(0x27d))+'\x0a');_0x2f14f5['statusCode']&&(_0x18d746+=_0x254499(0x23b)+_0x2f14f5['statusCode']+'`\x0a'),_0x18d746+=_0x254499(0x239)+_0x2f14f5[_0x254499(0x209)]+'`\x0a',_0x2f14f5[_0x254499(0x28f)]&&(_0x18d746+='🆔\x20Request\x20ID:\x20`'+_0x2f14f5[_0x254499(0x28f)]+'`\x0a'),_0x18d746+=_0x254499(0x228),await this[_0x254499(0x2aa)](_0x4bc2f4,_0x18d746,{'parse_mode':_0x254499(0x24d)}),console[_0x254499(0x272)](_0x254499(0x1cb)+_0x4bc2f4+':\x20'+_0x2f14f5[_0x254499(0x226)]);}catch(_0x47374b){console['error'](_0x254499(0x257),_0x47374b);}}async[a55_0x463265(0x26a)](_0x25fb68,_0x2f8e06,_0x250fbd){const _0x5cf9f3=a55_0x463265;let _0x5137ea='🔔\x20*'+_0x2f8e06+'*\x0a\x0a';for(const [_0xb0275d,_0x48c572]of Object['entries'](_0x250fbd)){_0x48c572!==null&&_0x48c572!==undefined&&(_0x5137ea+=_0xb0275d+_0x5cf9f3(0x23c)+_0x48c572+'`\x0a');}await this[_0x5cf9f3(0x2aa)](_0x25fb68,_0x5137ea,{'parse_mode':_0x5cf9f3(0x24d)});}[a55_0x463265(0x1fa)](){const _0x918154=a55_0x463265;return{'isActive':!!this['bot'],'username':this[_0x918154(0x224)]};}[a55_0x463265(0x200)](){const _0x1e97ea=a55_0x463265;this[_0x1e97ea(0x21d)]&&(this[_0x1e97ea(0x21d)][_0x1e97ea(0x242)](),this[_0x1e97ea(0x21d)]=null,console[_0x1e97ea(0x272)](_0x1e97ea(0x22e)));}}function a55_0x2a53(){const _0x31481e=['\x20USD*\x0a','📝\x20Notes:\x20','Successful\x20login','✅\x20Telegram\x20bot\x20@','\x20(@','includes','To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a','💰\x20Amount:\x20*','onText','Error\x20handling\x20/start\x20command:','❌\x20Invalid\x20username\x20format:\x20`','Payment\x20failed','🚨\x20*API\x20Error*\x0a\x0a','13768xUwwvB','requestId','Available\x20usernames:\x0a','.\x20*','Error\x20handling\x20/status\x20command:','`\x20is\x20inactive.\x0a\x0a','userAgent','findUnique','status','`\x20not\x20found.\x0a\x0a','txid','\x20verified\x20for\x20shop\x20','🌐\x20IP\x20address:\x20`','from','telegramUser','19377doyHzL','Payment\x20is\x20being\x20processed','isVerified','No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20','blocked','findFirst','Error\x20handling\x20message:','✅\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*','❌\x20Shop\x20with\x20username\x20`','unknown\x20shop','customerUa','shop','initializeBot','sendShopNotification','5942285iySzSi','last_name','✅\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20','telegramBotService','🔗\x20TXID:\x20`','shopId','sendPayoutNotification','🔄\x20Reset\x20incomplete\x20verification\x20for\x20user\x20','Error\x20handling\x20/disconnect\x20command:','📱\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20','📧\x20Email:\x20`','`.\x0a\x0a','timestamp','🆔\x20Payment\x20ID:\x20`','...`\x0a\x0a','\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure','env','Error\x20in\x20handleSingleLineVerification:','update','You\x20sent\x20','✅\x20Notification\x20sent\x20to\x20Telegram\x20user\x20','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','Commands:\x0a','handleSingleLineVerification',':\x20username=\x22','🔔\x20You\x20receive\x20notifications\x20about:\x0a','chat','Telegram\x20bot\x20polling\x20error:','📅\x20Date:\x20','\x0a👤\x20*Customer\x20Information:*\x0a','text','startsWith','secretKey','❌\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a','__importDefault','💸\x20Penalty\x20amount:\x20*','Failed\x20login\x20attempt','\x20USDT*\x0a','ipAddress','❌\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a','remitterIban','substring','🔔\x20Notifications\x20are\x20active\x0a\x0a','processing','📱\x20Shop:\x20*','name','•\x20New\x20payments\x0a','botToken','Use\x20/start\x20to\x20connect.','getBotInfo','\x20\x20\x20Status:\x20','pk_','setupBotHandlers','__esModule','notificationApiError','stopBot','Error\x20handling\x20/debug\x20command:','...','📝\x20Format:\x20`username\x20api_key`\x0a\x0a','4905817auTRDy','telegramId','❌\x20Please\x20use\x20/start\x20command\x20first','notificationLogin','warn','errorMessage','createdAt','chargebackAmount','✅\x20Welcome\x20back!\x0a\x0a','\x22,\x20apiKey=\x22','❌\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.','../config/database','chargeback','📱\x20Login\x20notifications\x20disabled\x20for\x20shop\x20','•\x20Payouts\x0a','polling_error','TELEGRAM_BOT_TOKEN','✅\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a','adminNotes','Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.','chat\x20not\x20found','TelegramBotService','🏦\x20IBAN:\x20`','\x20disconnected\x20from\x20shop\x20','forEach','bot','4723197GATuSv','Payment\x20refund','publicKey','/status\x20-\x20check\x20connection\x20status\x0a','Payment\x20successfully\x20paid','Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a','botUsername','📛\x20Name:\x20`','endpoint','...\x22','\x0a💡\x20Check\x20your\x20request\x20or\x20contact\x20support.','❌\x20Failed\x20to\x20initialize\x20Telegram\x20bot:','trim','`\x20(','customerEmail','findMany','🛑\x20Telegram\x20bot\x20stopped','Username:\x20`','\x20parts:\x20','🔄\x20Processing\x20single-line\x20verification\x20for\x20user\x20','/disconnect\x20-\x20disconnect\x20from\x20notifications','⏳\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a','31800aQUOlA','•\x20`','✅\x20Telegram\x20user\x20','gateway','📅\x20Time:\x20','❌\x20Error:\x20`','orderId','📊\x20Error\x20code:\x20`',':\x20`','updatedAt','node-telegram-bot-api','length','2208712rQhEAB','❌\x20Error\x20getting\x20debug\x20information.','stopPolling','create','🌐\x20IP:\x20`','📝\x20Order\x20ID:\x20`','map','amount','Error\x20sending\x20shop\x20notification:','failed','New\x20payout\x20created','❌\x20An\x20error\x20occurred\x20while\x20verifying\x20data.','❌\x20Invalid\x20API\x20key\x20format.\x0a\x0a','Markdown','User\x20','❌\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20','customerName','Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).','👤\x20Username:\x20`','error','🆔\x20Payout\x20ID:\x20`','trapay_bot','defineProperty','Failed\x20to\x20send\x20API\x20error\x20notification:','method','sendPaymentNotification','🏪\x20Gateway:\x20`','🤖\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a','sendMessage','❌\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','toLocaleString','join','default','customerIp','currency','*\x0a\x0a','sendLoginNotification','🔗\x20Endpoint:\x20`','message','✅\x20Connected\x20to\x20shop:\x20*','Payment\x20expired','You\x20are\x20already\x20connected\x20to\x20shop:\x20*','sendCustomNotification','\x20via\x20single-line\x20input','🎉\x20*Congratulations!*\x0a\x0a','sk_','❌\x20Shop\x20`','\x20\x20\x20Username:\x20`','Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`','username','log','\x0a⚠️\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!','split','toString','success','❗️\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!','6WVWPvE','✅\x20Login\x20notification\x20sent\x20for\x20shop\x20','•\x20Payment\x20status\x20changes\x0a','3084bcAMDm','💻\x20Browser:\x20`','en-US','getGatewayDisplayNameForTelegram','Use\x20/start\x20to\x20begin.','`\x0a\x0a'];a55_0x2a53=function(){return _0x31481e;};return a55_0x2a53();}exports[a55_0x463265(0x219)]=TelegramBotService,exports[a55_0x463265(0x1cc)]=new TelegramBotService();