'use strict';const a49_0x47ecee=a49_0xe494;(function(_0x4b2e44,_0x370f91){const _0x5b8013=a49_0xe494,_0xaeca06=_0x4b2e44();while(!![]){try{const _0x3bc3e9=parseInt(_0x5b8013(0xab))/0x1+parseInt(_0x5b8013(0xad))/0x2*(-parseInt(_0x5b8013(0xca))/0x3)+-parseInt(_0x5b8013(0xf5))/0x4+-parseInt(_0x5b8013(0x104))/0x5+-parseInt(_0x5b8013(0xaa))/0x6*(-parseInt(_0x5b8013(0xe7))/0x7)+parseInt(_0x5b8013(0x11d))/0x8+-parseInt(_0x5b8013(0x13d))/0x9*(-parseInt(_0x5b8013(0xda))/0xa);if(_0x3bc3e9===_0x370f91)break;else _0xaeca06['push'](_0xaeca06['shift']());}catch(_0xd13b23){_0xaeca06['push'](_0xaeca06['shift']());}}}(a49_0x27a6,0x22b0d));var __importDefault=this&&this[a49_0x47ecee(0x14b)]||function(_0x4138fd){const _0x2cd173=a49_0x47ecee;return _0x4138fd&&_0x4138fd[_0x2cd173(0xf1)]?_0x4138fd:{'default':_0x4138fd};};function a49_0xe494(_0x4bc50c,_0x1f6f0c){const _0x27a68a=a49_0x27a6();return a49_0xe494=function(_0xe49494,_0x222c59){_0xe49494=_0xe49494-0x94;let _0x2ed4b6=_0x27a68a[_0xe49494];return _0x2ed4b6;},a49_0xe494(_0x4bc50c,_0x1f6f0c);}Object[a49_0x47ecee(0x130)](exports,a49_0x47ecee(0xf1),{'value':!![]}),exports[a49_0x47ecee(0x100)]=exports[a49_0x47ecee(0x14d)]=void 0x0;const node_telegram_bot_api_1=__importDefault(require('node-telegram-bot-api')),database_1=__importDefault(require(a49_0x47ecee(0x15b))),gateway_1=require(a49_0x47ecee(0x131));class TelegramBotService{constructor(){const _0x5bdc18=a49_0x47ecee;this[_0x5bdc18(0x101)]=null,this[_0x5bdc18(0x12c)]=process[_0x5bdc18(0x161)][_0x5bdc18(0xfc)]||'',this[_0x5bdc18(0xc8)]=process[_0x5bdc18(0x161)][_0x5bdc18(0xd7)]||_0x5bdc18(0xd5),this[_0x5bdc18(0x12c)]?this[_0x5bdc18(0x9f)]():console['warn'](_0x5bdc18(0xb3));}[a49_0x47ecee(0x9f)](){const _0x25dfe7=a49_0x47ecee;try{this[_0x25dfe7(0x101)]=new node_telegram_bot_api_1['default'](this[_0x25dfe7(0x12c)],{'polling':!![]}),this[_0x25dfe7(0x123)](),console[_0x25dfe7(0x13c)]('âœ…\x20Telegram\x20bot\x20@'+this[_0x25dfe7(0xc8)]+_0x25dfe7(0x154));}catch(_0xd0ac6e){console[_0x25dfe7(0xb0)](_0x25dfe7(0x153),_0xd0ac6e);}}[a49_0x47ecee(0x123)](){const _0x5dddef=a49_0x47ecee;if(!this[_0x5dddef(0x101)])return;this[_0x5dddef(0x101)][_0x5dddef(0x168)](/\/start/,async _0x46486f=>{const _0x28c679=_0x5dddef,_0x3aa484=_0x46486f['chat']['id'],_0x2edd32=_0x46486f['from']?.['id'][_0x28c679(0xa6)](),_0x3e7dbd=_0x46486f['from']?.[_0x28c679(0x132)],_0x266bda=_0x46486f[_0x28c679(0x95)]?.[_0x28c679(0xdf)],_0x55c690=_0x46486f[_0x28c679(0x95)]?.[_0x28c679(0x12b)];if(!_0x2edd32)return;try{let _0xa3520c=await database_1[_0x28c679(0x126)][_0x28c679(0xb9)][_0x28c679(0x119)]({'where':{'telegramId':_0x2edd32},'include':{'shop':!![]}});!_0xa3520c?(_0xa3520c=await database_1[_0x28c679(0x126)][_0x28c679(0xb9)][_0x28c679(0x15a)]({'data':{'telegramId':_0x2edd32,'username':_0x3e7dbd,'firstName':_0x266bda,'lastName':_0x55c690,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console[_0x28c679(0x13c)]('ğŸ“±\x20Created\x20new\x20Telegram\x20user:\x20'+_0x2edd32+_0x28c679(0x167)+_0x3e7dbd+')')):_0xa3520c=await database_1['default'][_0x28c679(0xb9)][_0x28c679(0x149)]({'where':{'telegramId':_0x2edd32},'data':{'username':_0x3e7dbd,'firstName':_0x266bda,'lastName':_0x55c690},'include':{'shop':!![]}}),_0xa3520c[_0x28c679(0x10a)]&&_0xa3520c['shopId']&&_0xa3520c[_0x28c679(0x11e)]?await this[_0x28c679(0x101)]?.[_0x28c679(0xe2)](_0x3aa484,_0x28c679(0x98)+(_0x28c679(0x109)+_0xa3520c[_0x28c679(0x11e)][_0x28c679(0x166)]+'*\x0a')+(_0x28c679(0x115)+_0xa3520c[_0x28c679(0x11e)][_0x28c679(0x132)]+_0x28c679(0xed))+'ğŸ””\x20You\x20receive\x20notifications\x20about:\x0a'+_0x28c679(0xa3)+_0x28c679(0x11a)+_0x28c679(0xc6)+'Commands:\x0a'+'/status\x20-\x20check\x20connection\x20status\x0a'+'/disconnect\x20-\x20disconnect\x20from\x20notifications',{'parse_mode':_0x28c679(0x139)}):(_0xa3520c[_0x28c679(0xf6)]&&!_0xa3520c[_0x28c679(0x10a)]&&(await database_1[_0x28c679(0x126)][_0x28c679(0xb9)][_0x28c679(0x149)]({'where':{'telegramId':_0x2edd32},'data':{'shopId':null,'isVerified':![]}}),console[_0x28c679(0x13c)](_0x28c679(0x140)+_0x2edd32)),await this[_0x28c679(0x101)]?.[_0x28c679(0xe2)](_0x3aa484,_0x28c679(0x11f)+_0x28c679(0x124)+_0x28c679(0x12d)+_0x28c679(0x102)+_0x28c679(0x136)+'â—ï¸\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!',{'parse_mode':'Markdown'}));}catch(_0x224b9a){console['error'](_0x28c679(0x156),_0x224b9a),await this[_0x28c679(0x101)]?.[_0x28c679(0xe2)](_0x3aa484,_0x28c679(0xd2));}}),this['bot'][_0x5dddef(0x168)](/\/disconnect/,async _0x11f41d=>{const _0x266f17=_0x5dddef,_0x16d4ee=_0x11f41d['chat']['id'],_0x1436ae=_0x11f41d[_0x266f17(0x95)]?.['id']['toString']();if(!_0x1436ae)return;try{const _0x3209a0=await database_1[_0x266f17(0x126)][_0x266f17(0xb9)][_0x266f17(0x119)]({'where':{'telegramId':_0x1436ae},'include':{'shop':!![]}});if(!_0x3209a0||!_0x3209a0['isVerified']||!_0x3209a0[_0x266f17(0xf6)]){await this[_0x266f17(0x101)]?.['sendMessage'](_0x16d4ee,_0x266f17(0x10b));return;}const _0x2c7b2a=_0x3209a0['shop']?.[_0x266f17(0x166)]||_0x266f17(0x10c);await database_1[_0x266f17(0x126)]['telegramUser'][_0x266f17(0x149)]({'where':{'telegramId':_0x1436ae},'data':{'shopId':null,'isVerified':![]}}),console[_0x266f17(0x13c)](_0x266f17(0xec)+_0x1436ae+_0x266f17(0xe1)+_0x3209a0['shopId']),await this['bot']?.[_0x266f17(0xe2)](_0x16d4ee,'âœ…\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*'+_0x2c7b2a+_0x266f17(0x122)+'To\x20reconnect,\x20use\x20the\x20/start\x20command',{'parse_mode':'Markdown'});}catch(_0x187076){console[_0x266f17(0xb0)](_0x266f17(0x12f),_0x187076),await this[_0x266f17(0x101)]?.['sendMessage'](_0x16d4ee,_0x266f17(0xd2));}}),this[_0x5dddef(0x101)]['onText'](/\/status/,async _0x4e61d7=>{const _0x1d0a3a=_0x5dddef,_0x30d0c2=_0x4e61d7[_0x1d0a3a(0xa7)]['id'],_0x44a6e4=_0x4e61d7[_0x1d0a3a(0x95)]?.['id'][_0x1d0a3a(0xa6)]();if(!_0x44a6e4)return;try{const _0x28691c=await database_1[_0x1d0a3a(0x126)][_0x1d0a3a(0xb9)][_0x1d0a3a(0x119)]({'where':{'telegramId':_0x44a6e4},'include':{'shop':!![]}});if(!_0x28691c){await this[_0x1d0a3a(0x101)]?.[_0x1d0a3a(0xe2)](_0x30d0c2,_0x1d0a3a(0x150)+_0x1d0a3a(0x160));return;}if(!_0x28691c[_0x1d0a3a(0x10a)]||!_0x28691c[_0x1d0a3a(0xf6)]||!_0x28691c[_0x1d0a3a(0x11e)]){await this['bot']?.['sendMessage'](_0x30d0c2,_0x1d0a3a(0x158)+_0x1d0a3a(0x99));return;}await this['bot']?.[_0x1d0a3a(0xe2)](_0x30d0c2,_0x1d0a3a(0x12a)+(_0x1d0a3a(0x96)+_0x28691c[_0x1d0a3a(0x11e)][_0x1d0a3a(0x166)]+'*\x0a')+(_0x1d0a3a(0x127)+_0x28691c[_0x1d0a3a(0x11e)][_0x1d0a3a(0x132)]+'`\x0a')+(_0x1d0a3a(0x120)+_0x28691c['updatedAt'][_0x1d0a3a(0x145)](_0x1d0a3a(0xb5))+'\x0a\x0a')+_0x1d0a3a(0xe4)+_0x1d0a3a(0x10f)+_0x1d0a3a(0xc4),{'parse_mode':_0x1d0a3a(0x139)});}catch(_0x142370){console[_0x1d0a3a(0xb0)]('Error\x20handling\x20/status\x20command:',_0x142370),await this['bot']?.[_0x1d0a3a(0xe2)](_0x30d0c2,_0x1d0a3a(0xd2));}}),this[_0x5dddef(0x101)][_0x5dddef(0x168)](/\/debug/,async _0xd124a9=>{const _0x44c5ca=_0x5dddef,_0x679246=_0xd124a9[_0x44c5ca(0xa7)]['id'],_0x478129=_0xd124a9['from']?.['id'][_0x44c5ca(0xa6)]();if(!_0x478129)return;try{const _0x5f30ff=await database_1['default'][_0x44c5ca(0x11e)][_0x44c5ca(0xf8)]({'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![]},'take':0xa});let _0x425bc7=_0x44c5ca(0xae);_0x425bc7+=_0x44c5ca(0xe5)+_0x478129+_0x44c5ca(0xed),_0x425bc7+=_0x44c5ca(0xbe),_0x5f30ff[_0x44c5ca(0xc1)]((_0x4a4084,_0x2e7252)=>{const _0x26c0fe=_0x44c5ca;_0x425bc7+=_0x2e7252+0x1+_0x26c0fe(0x138)+_0x4a4084[_0x26c0fe(0x166)]+'*\x0a',_0x425bc7+=_0x26c0fe(0xb6)+_0x4a4084[_0x26c0fe(0x132)]+'`\x0a',_0x425bc7+=_0x26c0fe(0x15f)+_0x4a4084[_0x26c0fe(0x133)]+'\x0a',_0x425bc7+=_0x26c0fe(0xc3)+_0x4a4084[_0x26c0fe(0x155)][_0x26c0fe(0xbc)](0x0,0xf)+_0x26c0fe(0xd4);}),await this[_0x44c5ca(0x101)]?.['sendMessage'](_0x679246,_0x425bc7,{'parse_mode':_0x44c5ca(0x139)});}catch(_0x2699db){console[_0x44c5ca(0xb0)](_0x44c5ca(0x12e),_0x2699db),await this['bot']?.[_0x44c5ca(0xe2)](_0x679246,'âŒ\x20Error\x20getting\x20debug\x20information.');}}),this[_0x5dddef(0x101)]['on']('message',async _0x24d69f=>{const _0x358ddc=_0x5dddef;if(_0x24d69f[_0x358ddc(0x9e)]?.[_0x358ddc(0xa8)]('/'))return;const _0x3a446f=_0x24d69f['chat']['id'],_0x47b966=_0x24d69f[_0x358ddc(0x95)]?.['id'][_0x358ddc(0xa6)](),_0x2c457a=_0x24d69f[_0x358ddc(0x9e)]?.[_0x358ddc(0xf3)]();if(!_0x47b966||!_0x2c457a)return;try{const _0x5eb4ee=await database_1[_0x358ddc(0x126)][_0x358ddc(0xb9)][_0x358ddc(0x119)]({'where':{'telegramId':_0x47b966},'include':{'shop':!![]}});if(!_0x5eb4ee){await this[_0x358ddc(0x101)]?.['sendMessage'](_0x3a446f,'âŒ\x20Please\x20use\x20/start\x20command\x20first');return;}if(_0x5eb4ee[_0x358ddc(0x10a)]&&_0x5eb4ee[_0x358ddc(0xf6)]&&_0x5eb4ee['shop']){await this[_0x358ddc(0x101)]?.[_0x358ddc(0xe2)](_0x3a446f,'âœ…\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*'+_0x5eb4ee[_0x358ddc(0x11e)][_0x358ddc(0x166)]+_0x358ddc(0x122)+_0x358ddc(0xcf),{'parse_mode':_0x358ddc(0x139)});return;}const _0x12a82c=_0x2c457a[_0x358ddc(0x159)](/\s+/);if(_0x12a82c[_0x358ddc(0xc5)]!==0x2){await this[_0x358ddc(0x101)]?.[_0x358ddc(0xe2)](_0x3a446f,'âŒ\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a'+_0x358ddc(0x12d)+_0x358ddc(0x102)+_0x358ddc(0x136)+(_0x358ddc(0x146)+_0x12a82c[_0x358ddc(0xc5)]+_0x358ddc(0x163)+_0x12a82c[_0x358ddc(0x14f)](_0x52e07d=>'`'+_0x52e07d+'`')[_0x358ddc(0x106)](',\x20')),{'parse_mode':_0x358ddc(0x139)});return;}const [_0x4204ee,_0x3e36a4]=_0x12a82c;console[_0x358ddc(0x13c)](_0x358ddc(0x107)+_0x47b966+_0x358ddc(0xcc)+_0x4204ee+_0x358ddc(0x103)+_0x3e36a4[_0x358ddc(0xbc)](0x0,0xa)+_0x358ddc(0x144)),await this['handleSingleLineVerification'](_0x3a446f,_0x47b966,_0x4204ee,_0x3e36a4);}catch(_0x3f7bd3){console[_0x358ddc(0xb0)]('Error\x20handling\x20message:',_0x3f7bd3),await this[_0x358ddc(0x101)]?.['sendMessage'](_0x3a446f,_0x358ddc(0xd2));}}),this[_0x5dddef(0x101)]['on'](_0x5dddef(0xb0),_0x141f7c=>{const _0x1eb0a5=_0x5dddef;console[_0x1eb0a5(0xb0)]('Telegram\x20bot\x20error:',_0x141f7c);}),this[_0x5dddef(0x101)]['on']('polling_error',_0x3fb40e=>{const _0x4e6b11=_0x5dddef;console[_0x4e6b11(0xb0)](_0x4e6b11(0x15c),_0x3fb40e);});}async[a49_0x47ecee(0x142)](_0x1bbe51,_0x381d90,_0x5a9b9e,_0x54e9d1){const _0x1811f3=a49_0x47ecee;try{console['log'](_0x1811f3(0x107)+_0x381d90+_0x1811f3(0xcc)+_0x5a9b9e+'\x22,\x20apiKey=\x22'+_0x54e9d1['substring'](0x0,0xa)+'...\x22');if(!_0x5a9b9e||_0x5a9b9e[_0x1811f3(0xc5)]<0x3||_0x5a9b9e[_0x1811f3(0xc5)]>0x32||!/^[a-zA-Z0-9_]+$/['test'](_0x5a9b9e)){await this[_0x1811f3(0x101)]?.[_0x1811f3(0xe2)](_0x1bbe51,'âŒ\x20Invalid\x20username\x20format:\x20`'+_0x5a9b9e+_0x1811f3(0xed)+_0x1811f3(0xf4),{'parse_mode':_0x1811f3(0x139)});return;}if(!_0x54e9d1||!_0x54e9d1[_0x1811f3(0xa8)]('pk_')&&!_0x54e9d1[_0x1811f3(0xa8)](_0x1811f3(0x164))){await this['bot']?.['sendMessage'](_0x1bbe51,'âŒ\x20Invalid\x20API\x20key\x20format.\x0a\x0a'+_0x1811f3(0xe6),{'parse_mode':'Markdown'});return;}const _0x2e2e7c=await database_1['default'][_0x1811f3(0x11e)][_0x1811f3(0x119)]({'where':{'username':_0x5a9b9e},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x2e2e7c){const _0x52d892=await database_1[_0x1811f3(0x126)]['shop'][_0x1811f3(0xf8)]({'select':{'username':!![],'name':!![]},'take':0x5});let _0x473c4e=_0x1811f3(0xc2)+_0x5a9b9e+'`\x20not\x20found.\x0a\x0a';_0x52d892[_0x1811f3(0xc5)]>0x0?(_0x473c4e+='Available\x20usernames:\x0a',_0x52d892[_0x1811f3(0xc1)](_0x1061a7=>{const _0x167d0b=_0x1811f3;_0x473c4e+=_0x167d0b(0xb1)+_0x1061a7[_0x167d0b(0x132)]+_0x167d0b(0xee)+_0x1061a7[_0x167d0b(0x166)]+')\x0a';}),_0x473c4e+=_0x1811f3(0x15e)):_0x473c4e+=_0x1811f3(0xfa);await this[_0x1811f3(0x101)]?.[_0x1811f3(0xe2)](_0x1bbe51,_0x473c4e,{'parse_mode':_0x1811f3(0x139)});return;}if(_0x2e2e7c['status']!==_0x1811f3(0xd1)){await this[_0x1811f3(0x101)]?.[_0x1811f3(0xe2)](_0x1bbe51,'âŒ\x20Shop\x20`'+_0x5a9b9e+'`\x20is\x20inactive.\x0a\x0a'+_0x1811f3(0x15d),{'parse_mode':_0x1811f3(0x139)});return;}if(_0x2e2e7c['publicKey']!==_0x54e9d1&&_0x2e2e7c[_0x1811f3(0x111)]!==_0x54e9d1){await this[_0x1811f3(0x101)]?.[_0x1811f3(0xe2)](_0x1bbe51,_0x1811f3(0xfb)+_0x5a9b9e+_0x1811f3(0xef)+_0x1811f3(0xff)+_0x1811f3(0x137),{'parse_mode':_0x1811f3(0x139)});return;}const _0x3d2a73=await database_1[_0x1811f3(0x126)][_0x1811f3(0xb9)][_0x1811f3(0x162)]({'where':{'shopId':_0x2e2e7c['id'],'isVerified':!![],'telegramId':{'not':_0x381d90}}});if(_0x3d2a73){await this[_0x1811f3(0x101)]?.['sendMessage'](_0x1bbe51,_0x1811f3(0x13b)+_0x5a9b9e+_0x1811f3(0xef)+_0x1811f3(0xfe),{'parse_mode':_0x1811f3(0x139)});return;}await database_1[_0x1811f3(0x126)][_0x1811f3(0xb9)]['update']({'where':{'telegramId':_0x381d90},'data':{'shopId':_0x2e2e7c['id'],'isVerified':!![]}}),await this[_0x1811f3(0x101)]?.[_0x1811f3(0xe2)](_0x1bbe51,_0x1811f3(0x125)+_0x1811f3(0x13a)+('ğŸ“±\x20Shop:\x20*'+_0x2e2e7c[_0x1811f3(0x166)]+'*\x0a')+(_0x1811f3(0x127)+_0x2e2e7c[_0x1811f3(0x132)]+'`\x0a\x0a')+_0x1811f3(0xce)+_0x1811f3(0xa3)+_0x1811f3(0x11a)+'â€¢\x20Payouts\x0a'+_0x1811f3(0xeb)+'Commands:\x0a'+_0x1811f3(0xcd)+_0x1811f3(0xc4),{'parse_mode':'Markdown'}),console[_0x1811f3(0x13c)](_0x1811f3(0x141)+_0x381d90+_0x1811f3(0xe0)+_0x2e2e7c[_0x1811f3(0x132)]+_0x1811f3(0xa4));}catch(_0x286f8d){console[_0x1811f3(0xb0)]('Error\x20in\x20handleSingleLineVerification:',_0x286f8d),await this[_0x1811f3(0x101)]?.[_0x1811f3(0xe2)](_0x1bbe51,_0x1811f3(0xf9));}}async[a49_0x47ecee(0x9b)](_0xeb5a96,_0x7b6f65,_0x4b0368){const _0x30792a=a49_0x47ecee;if(!this['bot']){console[_0x30792a(0xe8)](_0x30792a(0xfd));return;}try{const _0x38b699=await database_1[_0x30792a(0x126)][_0x30792a(0xb9)][_0x30792a(0xf8)]({'where':{'shopId':_0xeb5a96,'isVerified':!![]}});if(_0x38b699[_0x30792a(0xc5)]===0x0){console[_0x30792a(0x13c)](_0x30792a(0x114)+_0xeb5a96);return;}const _0x323e8c=_0x38b699[_0x30792a(0x14f)](async _0x4f6e0e=>{const _0x41645e=_0x30792a;try{await this[_0x41645e(0x101)]?.[_0x41645e(0xe2)](_0x4f6e0e[_0x41645e(0xe9)],_0x7b6f65,_0x4b0368),console[_0x41645e(0x13c)](_0x41645e(0xea)+_0x4f6e0e[_0x41645e(0xe9)]);}catch(_0x15634a){console['error']('âŒ\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20'+_0x4f6e0e['telegramId']+':',_0x15634a),_0x15634a instanceof Error&&(_0x15634a['message'][_0x41645e(0x112)]('blocked')||_0x15634a['message'][_0x41645e(0x112)](_0x41645e(0x157))||_0x15634a['message'][_0x41645e(0x112)](_0x41645e(0xa9)))&&(await database_1['default'][_0x41645e(0xb9)][_0x41645e(0x149)]({'where':{'id':_0x4f6e0e['id']},'data':{'isVerified':![]}}),console[_0x41645e(0x13c)](_0x41645e(0x16a)+_0x4f6e0e['telegramId']+'\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure'));}});await Promise[_0x30792a(0xb7)](_0x323e8c);}catch(_0x2399e4){console[_0x30792a(0xb0)](_0x30792a(0xf7),_0x2399e4);}}async[a49_0x47ecee(0xa5)](_0x278923,_0x58b403,_0xe32bbb){const _0x5f3ce5=a49_0x47ecee,_0x36efc9={'created':'ğŸ†•','paid':'âœ…','failed':'âŒ','expired':'â°','refund':'ğŸ”„','chargeback':'âš ï¸','processing':'âš™ï¸'},_0x3b85f7={'created':_0x5f3ce5(0xd6),'paid':_0x5f3ce5(0x113),'failed':'Payment\x20failed','expired':_0x5f3ce5(0xbb),'refund':_0x5f3ce5(0xd9),'chargeback':_0x5f3ce5(0x14e),'processing':_0x5f3ce5(0xc9)},_0x54b4c2=_0x36efc9[_0xe32bbb],_0x367dbd=_0x3b85f7[_0xe32bbb],_0x2710d3=(0x0,gateway_1['getGatewayDisplayNameForTelegram'])(_0x58b403['gateway']);console[_0x5f3ce5(0x13c)](_0x5f3ce5(0xf0)+_0x58b403[_0x5f3ce5(0x152)]+_0x5f3ce5(0x117)+_0x2710d3+'\x22');let _0x54b4ba=_0x54b4c2+'\x20*'+_0x367dbd+'*\x0a\x0a'+('ğŸ’°\x20Amount:\x20*'+_0x58b403['amount']+'\x20'+_0x58b403[_0x5f3ce5(0xa1)]+'*\x0a')+('ğŸ“\x20Order\x20ID:\x20`'+(_0x58b403[_0x5f3ce5(0x11c)]||_0x58b403['id'])+'`\x0a')+('ğŸ†”\x20Payment\x20ID:\x20`'+_0x58b403['id']+'`\x0a')+('ğŸª\x20Gateway:\x20`'+_0x2710d3+'`\x0a')+(_0x5f3ce5(0x108)+new Date(_0x58b403['createdAt'])[_0x5f3ce5(0x10d)](_0x5f3ce5(0xb5))+'\x0a');_0xe32bbb===_0x5f3ce5(0x128)&&_0x58b403[_0x5f3ce5(0xdd)]&&(_0x54b4ba+=_0x5f3ce5(0x9a)+_0x58b403['chargebackAmount']+'\x20USDT*\x0a'),_0xe32bbb===_0x5f3ce5(0x148)&&(_0x54b4ba+=_0x5f3ce5(0xbd)),_0x58b403[_0x5f3ce5(0x97)]&&(_0x54b4ba+=_0x5f3ce5(0xc7)+_0x58b403[_0x5f3ce5(0x97)]+'\x0a'),await this[_0x5f3ce5(0x9b)](_0x278923,_0x54b4ba,{'parse_mode':_0x5f3ce5(0x139)});}async[a49_0x47ecee(0x13e)](_0x453027,_0x402ee1,_0x1a01a0){const _0x831863=a49_0x47ecee,_0x27ed21={'created':'ğŸ“¤','completed':'âœ…','rejected':'âŒ'},_0x19f7a6={'created':_0x831863(0x10e),'completed':_0x831863(0xde),'rejected':'Payout\x20rejected'},_0x7d08bb=_0x27ed21[_0x1a01a0],_0x581e3a=_0x19f7a6[_0x1a01a0],_0x45325c=_0x7d08bb+'\x20*'+_0x581e3a+_0x831863(0x147)+('ğŸ’¸\x20Amount:\x20*'+_0x402ee1[_0x831863(0xa0)]+_0x831863(0xf2))+('ğŸ¦\x20Method:\x20`'+_0x402ee1['method']+'`\x0a')+('ğŸ†”\x20Payout\x20ID:\x20`'+_0x402ee1['id']+'`\x0a')+('ğŸ“…\x20Date:\x20'+new Date(_0x402ee1['createdAt'])[_0x831863(0x10d)](_0x831863(0xb5))+'\x0a')+(_0x402ee1[_0x831863(0x110)]?'ğŸ”—\x20TXID:\x20`'+_0x402ee1['txid']+'`':'');await this[_0x831863(0x9b)](_0x453027,_0x45325c,{'parse_mode':_0x831863(0x139)});}async[a49_0x47ecee(0x11b)](_0x5bb190,_0x54822d){const _0x9e64fd=a49_0x47ecee;try{const _0x2cf569=await database_1[_0x9e64fd(0x126)][_0x9e64fd(0x9d)][_0x9e64fd(0x119)]({'where':{'shopId':_0x5bb190},'select':{'notificationLogin':!![]}});if(!_0x2cf569?.['notificationLogin']){console['log'](_0x9e64fd(0x165)+_0x5bb190);return;}const _0x216ecb=_0x54822d['success']?'ğŸ”':'ğŸš¨',_0x21b843=_0x54822d[_0x9e64fd(0xdb)]?_0x9e64fd(0xb4):_0x9e64fd(0x14a);let _0x3cd1f0=_0x216ecb+'\x20*'+_0x21b843+'*\x0a\x0a'+(_0x9e64fd(0x127)+_0x54822d['username']+'`\x0a')+(_0x9e64fd(0x129)+_0x54822d[_0x9e64fd(0xd3)][_0x9e64fd(0x10d)](_0x9e64fd(0xb5))+'\x0a');_0x54822d[_0x9e64fd(0xd8)]&&(_0x3cd1f0+=_0x9e64fd(0xb2)+_0x54822d[_0x9e64fd(0xd8)]+'`\x0a');if(_0x54822d['userAgent']){const _0x5e084d=_0x54822d['userAgent']['length']>0x32?_0x54822d[_0x9e64fd(0xc0)]['substring'](0x0,0x32)+_0x9e64fd(0x14c):_0x54822d[_0x9e64fd(0xc0)];_0x3cd1f0+=_0x9e64fd(0x94)+_0x5e084d+'`\x0a';}!_0x54822d[_0x9e64fd(0xdb)]&&(_0x3cd1f0+=_0x9e64fd(0x105)),await this['sendShopNotification'](_0x5bb190,_0x3cd1f0,{'parse_mode':'Markdown'}),console['log'](_0x9e64fd(0xac)+_0x5bb190+':\x20'+(_0x54822d[_0x9e64fd(0xdb)]?_0x9e64fd(0xdb):'failed'));}catch(_0x5789d0){console[_0x9e64fd(0xb0)]('Failed\x20to\x20send\x20login\x20notification:',_0x5789d0);}}async[a49_0x47ecee(0x118)](_0xa9b5f,_0x4d45af){const _0x551454=a49_0x47ecee;try{const _0x624756=await database_1[_0x551454(0x126)][_0x551454(0x9d)][_0x551454(0x119)]({'where':{'shopId':_0xa9b5f},'select':{'notificationApiError':!![]}});if(!_0x624756?.['notificationApiError']){console['log']('ğŸ“±\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20'+_0xa9b5f);return;}let _0x2e085a=_0x551454(0x169)+(_0x551454(0x116)+_0x4d45af[_0x551454(0xe3)]+'\x20'+_0x4d45af[_0x551454(0x13f)]+'`\x0a')+(_0x551454(0x129)+_0x4d45af[_0x551454(0xd3)][_0x551454(0x10d)](_0x551454(0xb5))+'\x0a');_0x4d45af[_0x551454(0xba)]&&(_0x2e085a+=_0x551454(0x143)+_0x4d45af[_0x551454(0xba)]+'`\x0a'),_0x2e085a+='âŒ\x20Error:\x20`'+_0x4d45af[_0x551454(0x9c)]+'`\x0a',_0x4d45af['requestId']&&(_0x2e085a+=_0x551454(0xd0)+_0x4d45af[_0x551454(0xbf)]+'`\x0a'),_0x2e085a+=_0x551454(0xb8),await this[_0x551454(0x9b)](_0xa9b5f,_0x2e085a,{'parse_mode':_0x551454(0x139)}),console[_0x551454(0x13c)]('âœ…\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20'+_0xa9b5f+':\x20'+_0x4d45af[_0x551454(0x13f)]);}catch(_0x3cfd7d){console[_0x551454(0xb0)](_0x551454(0xdc),_0x3cfd7d);}}async[a49_0x47ecee(0xa2)](_0x44cd17,_0x262a35,_0x256280){const _0x231b59=a49_0x47ecee;let _0x30501b='ğŸ””\x20*'+_0x262a35+_0x231b59(0x147);for(const [_0x443cde,_0x566bb0]of Object[_0x231b59(0x134)](_0x256280)){_0x566bb0!==null&&_0x566bb0!==undefined&&(_0x30501b+=_0x443cde+_0x231b59(0x151)+_0x566bb0+'`\x0a');}await this[_0x231b59(0x9b)](_0x44cd17,_0x30501b,{'parse_mode':_0x231b59(0x139)});}[a49_0x47ecee(0xaf)](){const _0x392c2b=a49_0x47ecee;return{'isActive':!!this['bot'],'username':this[_0x392c2b(0xc8)]};}[a49_0x47ecee(0xcb)](){const _0x39fe31=a49_0x47ecee;this[_0x39fe31(0x101)]&&(this[_0x39fe31(0x101)][_0x39fe31(0x135)](),this[_0x39fe31(0x101)]=null,console['log'](_0x39fe31(0x121)));}}exports['TelegramBotService']=TelegramBotService,exports[a49_0x47ecee(0x100)]=new TelegramBotService();function a49_0x27a6(){const _0x4da5da=['â€¢\x20New\x20payments\x0a','\x20via\x20single-line\x20input','sendPaymentNotification','toString','chat','startsWith','user\x20is\x20deactivated','92766DPIPtt','82116SCDImS','âœ…\x20Login\x20notification\x20sent\x20for\x20shop\x20','13038cgaEHb','ğŸ”\x20*Debug\x20Information*\x0a\x0a','getBotInfo','error','â€¢\x20`','ğŸŒ\x20IP\x20address:\x20`','TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables','Successful\x20login','en-US','\x20\x20\x20Username:\x20`','allSettled','\x0ağŸ’¡\x20Check\x20your\x20request\x20or\x20contact\x20support.','telegramUser','statusCode','Payment\x20expired','substring','â³\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a','ğŸª\x20Available\x20shops\x20in\x20system:\x0a','requestId','userAgent','forEach','âŒ\x20Shop\x20with\x20username\x20`','\x20\x20\x20Public\x20Key:\x20`','/disconnect\x20-\x20disconnect\x20from\x20notifications','length','â€¢\x20Payouts\x0a\x0a','ğŸ“\x20Notes:\x20','botUsername','Payment\x20is\x20being\x20processed','45wlycKx','stopBot',':\x20username=\x22','/status\x20-\x20check\x20connection\x20status\x0a','ğŸ””\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a','Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.','ğŸ†”\x20Request\x20ID:\x20`','ACTIVE','âŒ\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','timestamp','...`\x0a\x0a','trapay_bot','New\x20payment\x20created','TELEGRAM_BOT_USERNAME','ipAddress','Payment\x20refund','410JDgeUh','success','Failed\x20to\x20send\x20API\x20error\x20notification:','chargebackAmount','Payout\x20completed','first_name','\x20verified\x20for\x20shop\x20','\x20disconnected\x20from\x20shop\x20','sendMessage','method','ğŸ””\x20Notifications\x20are\x20active\x0a\x0a','ğŸ“±\x20Your\x20Telegram\x20ID:\x20`','API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','35CKNbbx','warn','telegramId','âœ…\x20Notification\x20sent\x20to\x20Telegram\x20user\x20','â€¢\x20Important\x20events\x0a\x0a','ğŸ”Œ\x20User\x20','`\x0a\x0a','`\x20(','`.\x0a\x0a','ğŸ“±\x20Telegram\x20notification:\x20gateway\x20\x22','__esModule','\x20USD*\x0a','trim','Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).','212012YIRKVq','shopId','Error\x20sending\x20shop\x20notification:','findMany','âŒ\x20An\x20error\x20occurred\x20while\x20verifying\x20data.','Check\x20spelling\x20and\x20try\x20again.','âŒ\x20API\x20key\x20does\x20not\x20match\x20shop\x20`','TELEGRAM_BOT_TOKEN','Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification','Disconnect\x20the\x20previous\x20account\x20first\x20or\x20contact\x20administrator.','Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a','telegramBotService','bot','Example:\x0a','\x22,\x20apiKey=\x22','1103430kwzfFR','\x0aâš ï¸\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!','join','ğŸ”„\x20Processing\x20single-line\x20verification\x20for\x20user\x20','ğŸ“…\x20Date:\x20','You\x20are\x20already\x20connected\x20to\x20shop:\x20*','isVerified','âŒ\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.','unknown\x20shop','toLocaleString','New\x20payout\x20created','Commands:\x0a','txid','secretKey','includes','Payment\x20successfully\x20paid','No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20','Username:\x20`','ğŸ”—\x20Endpoint:\x20`','\x22\x20->\x20display\x20\x22','sendApiErrorNotification','findUnique','â€¢\x20Payment\x20status\x20changes\x0a','sendLoginNotification','orderId','1202024jaqVEC','shop','ğŸ¤–\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a','ğŸ“…\x20Connection\x20date:\x20','ğŸ›‘\x20Telegram\x20bot\x20stopped','*.\x0a\x0a','setupBotHandlers','To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a','ğŸ‰\x20*Congratulations!*\x0a\x0a','default','ğŸ‘¤\x20Username:\x20`','chargeback','ğŸ“…\x20Time:\x20','ğŸ“Š\x20*Connection\x20Status*\x0a\x0a','last_name','botToken','ğŸ“\x20Format:\x20`username\x20api_key`\x0a\x0a','Error\x20handling\x20/debug\x20command:','Error\x20handling\x20/disconnect\x20command:','defineProperty','../types/gateway','username','status','entries','stopPolling','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`','.\x20*','Markdown','âœ…\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a','âŒ\x20Another\x20Telegram\x20account\x20is\x20already\x20connected\x20to\x20shop\x20`','log','44757nsdpXZ','sendPayoutNotification','endpoint','ğŸ”„\x20Reset\x20incomplete\x20verification\x20for\x20user\x20','âœ…\x20Telegram\x20user\x20','handleSingleLineVerification','ğŸ“Š\x20Error\x20code:\x20`','...\x22','toLocaleDateString','You\x20sent\x20','*\x0a\x0a','processing','update','Failed\x20login\x20attempt','__importDefault','...','TelegramBotService','Payment\x20chargeback','map','âŒ\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a',':\x20`','gateway','âŒ\x20Failed\x20to\x20initialize\x20Telegram\x20bot:','\x20initialized\x20successfully','publicKey','Error\x20handling\x20/start\x20command:','chat\x20not\x20found','âŒ\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a','split','create','../config/database','Telegram\x20bot\x20polling\x20error:','Contact\x20administrator.','\x0aCheck\x20spelling\x20and\x20try\x20again.','\x20\x20\x20Status:\x20','Use\x20/start\x20to\x20begin.','env','findFirst','\x20parts:\x20','sk_','ğŸ“±\x20Login\x20notifications\x20disabled\x20for\x20shop\x20','name','\x20(@','onText','ğŸš¨\x20*API\x20Error*\x0a\x0a','User\x20','ğŸ’»\x20Browser:\x20`','from','âœ…\x20Connected\x20to\x20shop:\x20*','adminNotes','âœ…\x20Welcome\x20back!\x0a\x0a','Use\x20/start\x20to\x20connect.','ğŸ’¸\x20Penalty\x20amount:\x20*','sendShopNotification','errorMessage','shopSettings','text','initializeBot','amount','currency','sendCustomNotification'];a49_0x27a6=function(){return _0x4da5da;};return a49_0x27a6();}