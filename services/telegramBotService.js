'use strict';const a87_0xedbd06=a87_0x5d5d;(function(_0x36ee35,_0x453501){const _0x1cfe5a=a87_0x5d5d,_0x157184=_0x36ee35();while(!![]){try{const _0x88e2ee=-parseInt(_0x1cfe5a(0x193))/0x1+parseInt(_0x1cfe5a(0x195))/0x2*(parseInt(_0x1cfe5a(0x198))/0x3)+parseInt(_0x1cfe5a(0x1b0))/0x4+parseInt(_0x1cfe5a(0x13f))/0x5+-parseInt(_0x1cfe5a(0x12e))/0x6*(parseInt(_0x1cfe5a(0x12a))/0x7)+-parseInt(_0x1cfe5a(0xf0))/0x8+-parseInt(_0x1cfe5a(0x23b))/0x9;if(_0x88e2ee===_0x453501)break;else _0x157184['push'](_0x157184['shift']());}catch(_0x481e54){_0x157184['push'](_0x157184['shift']());}}}(a87_0x18ec,0xcb24b));function a87_0x18ec(){const _0x403e2c=['isValidGatewayId','telegramId','âŒ\x20Failed\x20to\x20send\x20message\x20to\x20user\x20','image/png','secretKey','ðŸ”—\x20*Payment\x20Links*\x0a\x0aChoose\x20an\x20action:','processing','ðŸ’°\x20*Amount:*\x20','UTC','âœ…\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*','Failed\x20to\x20send\x20login\x20notification:','\x20USDT\x0a','TelegramBotService','...','âŒ\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0aUse\x20/start\x20to\x20connect.','â€¢\x20Payment\x20status\x20changes\x0a','EXPIRED','payout','ðŸ””\x20Notifications\x20are\x20active','âž•\x20Create\x20New\x20Link','This\x20feature\x20will\x20show:\x0a','â³\x20Pending\x20payouts:\x20','PAID','cmd_contacts','1253cpqClz','stats_today','type','All\x20Time','18552DvdCRQ','getGatewayCurrencies','message','âŒ\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20','join','/payment\x5c_links\x20-\x20manage\x20payment\x20links\x0a','\x20USDC','ðŸ“›\x20Name:\x20`','EUR','replace','âŒ\x20Error\x20sending\x20direct\x20message:','Markdown','substring','.png','Error\x20handling\x20/contacts\x20command:','createdAt','push','6380790TbbnFW','ðŸ“\x20Order\x20ID:\x20`','geo','timestamp','Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.','sendPayoutNotification','ðŸŒ\x20IP:\x20`','...\x22','ðŸª\x20Your\x20connected\x20shop:\x0a','sendMessage','notificationLogin','2-digit','pl_type_','getGatewayDisplayNameForTelegram','toString','success','paymentLinkSessions','ðŸ†”\x20Request\x20ID:\x20`','sendShopNotification','pk_','stats_yesterday','ðŸ”„\x20Refunds\x20\x5c-\x20','ðŸ“Š\x20Status','\x20\x20\x20Status:\x20','stats_this_month','âŒ\x20API\x20key\x20does\x20not\x20match\x20shop\x20`','Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a','slice','image/jpeg','âŒ\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`','ðŸ”—\x20*Payment\x20Links*\x0a\x0a','user\x20is\x20deactivated','set','ACTIVE','statusCode','`\x20is\x20inactive.\x0a\x0a','ðŸª\x20Gateway:\x20`','pl_gw_','\x20\x20\x20Username:\x20`','telegramUser','last_name','padStart','âœ…\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*','Telegram\x20bot\x20polling\x20error:','polling_error','ðŸŒ\x20*Network:*\x20','âœ…\x20Notification\x20sent\x20to\x20Telegram\x20user\x20','NZD','ðŸ”„\x20Type:\x20','ðŸ“ž\x20*Contacts*\x0a\x0a','ðŸ“…\x20*Payout\x20Date:*\x20','ðŸ¦\x20IBAN:\x20`','Error\x20handling\x20/start\x20command:','âŒ\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a','toUpperCase','.jpg','ðŸ”Œ\x20Disconnect','Not\x20specified','network','split','ðŸ“±\x20Available\x20Commands:\x0a','PLN','â€¢\x20Quick\x20create\x20new\x20link\x0a','âŒ\x20No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20ID:\x20','Error\x20handling\x20callback\x20query:','application/octet-stream','ðŸ””\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a','ðŸ“…\x20Date:\x20','*.\x0a\x0a','Error\x20showing\x20payment\x20links\x20list:','default','âŒ\x20Invalid\x20username\x20format:\x20`','âŒ\x20Error\x20sending\x20file\x20to\x20chat:','log','ðŸ”„\x20Processing\x20single-line\x20verification\x20for\x20user\x20','period','pl_type_multi','errorMessage','ðŸ“±\x20Sending\x20notification\x20to\x20all\x20connected\x20users:\x20','map','get','Next\x20âž¡ï¸','ðŸ’¸\x20Penalty\x20amount:\x20*','324991oQzcrD','âœ…\x20File\x20sent\x20to\x20chat\x20','14mmLVfl','Payment\x20expired','ðŸ‘¤\x20Username:\x20`','555477dchcVC','onText','parse','pl_page_','âŒ\x20Shop\x20`','Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification','â€¢\x20Important\x20events','NOK','INR','âŒ\x20An\x20error\x20occurred\x20while\x20loading\x20payment\x20links.','stats_last_month','editMessageText','â€¢\x20Amount\x20and\x20network\x0a','GATEWAY_ID_MAP','DOGE','\x20USDC\x0a','toFixed','Failed\x20to\x20send\x20API\x20error\x20notification:','ðŸ“‹\x20View\x20Payment\x20Links','â€¢\x20Payouts\x0a','remitterIban','ðŸ“…\x20All\x20Time','cmd_payment_links','shop','2821368exmpRu','message_id','ðŸ’µ\x20Earned\x20\x5c-\x20','reduce','chat\x20not\x20found','ðŸ“\x20Notes:\x20','AUD','âŒ\x20An\x20error\x20occurred.\x20Please\x20try\x20again.','desc','ðŸ“¢\x20Telegram\x20channel:\x20https://t.me/trapay\x5c_news\x0a','Step\x202/4:\x20Select\x20link\x20type','/contacts\x20-\x20support\x20contacts\x0a','âœ…\x20Direct\x20message\x20sent\x20to\x20chat\x20','isVerified','ðŸ’¸\x20Payouts','\x20\x20\x20[LINK](','callback_query','userAgent','\x20USD\x0a','âŒ\x20Cancel','ðŸ“Š\x20*Connection\x20Status*\x0a\x0a','ðŸ“…\x20Connection\x20date:\x20','â€¢\x20Share\x20link\x20directly','ðŸ”—\x20*Create\x20Payment\x20Link*\x0a\x0a','To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a','TRX','To\x20reconnect,\x20use\x20the\x20/start\x20command','â³\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a','currency','cmd_status','delete','endpoint','âœ…\x20Login\x20notification\x20sent\x20for\x20shop\x20','length','ðŸ“±\x20Login\x20notifications\x20disabled\x20for\x20shop\x20','cmd_disconnect','ðŸ”Œ\x20User\x20','warn','\x20initialized\x20successfully','endsWith','âœ…\x20Connected\x20to\x20shop:\x20*','ðŸ”—\x20Link:\x20','You\x20are\x20already\x20connected\x20to\x20shop:\x20*','ceil','pl_curr_','ðŸ’¸\x20*New\x20Payout*\x0a\x0a','https://app.trapay.uk','chargebackAmount','pl_','Error\x20handling\x20/statistics\x20command:','ðŸš¨\x20*API\x20Error*\x0a\x0a','Error\x20handling\x20/disconnect\x20command:','status','step','customerEmail','JPY','ðŸ“…\x20Time:\x20','getGatewayNameById','ðŸ”—\x20Payment\x20Links','\x20(e.g.,\x20100)','sendDirectMessage','MarkdownV2','ðŸ””\x20*','customerIp','ipAddress','create','ðŸ“±\x20Notification\x20sent\x20to\x20','name','amountAfterGatewayCommissionUSDT','CHF','ðŸ¤–\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a','customerName','CAD','â™¾ï¸\x20Multi\x20Use','ðŸ”‚\x20Single\x20Use','from','ðŸ“±\x20Telegram\x20notification:\x20gateway\x20\x22','ðŸ’°\x20Amount:\x20','wallet','Payment\x20refund','paymentLink','ðŸ””\x20Notifications\x20are\x20active\x0a\x0a','toLocaleDateString','ðŸ“Š\x20*Statistics*\x0a\x0aSelect\x20period:','\x20\x20\x20Name:\x20*','setupBotHandlers','Error\x20handling\x20/payment_links\x20command:','update','Gateway\x20-\x20','\x0aðŸ‘¤\x20*Customer\x20Information:*\x0a','Step\x204/4:\x20Enter\x20amount\x0a\x0a','AED',')\x0a\x0a','notificationApiError','âŒ\x20Maximum\x20number\x20of\x20connected\x20accounts\x20(5)\x20reached\x20for\x20shop\x20`','keys','blocked','Failed\x20login\x20attempt','txid','ðŸ›‘\x20Telegram\x20bot\x20stopped','`.\x0a\x0a','ðŸ’°\x20Turnover\x20\x5c-\x20','ðŸ“±\x20Your\x20Telegram\x20ID:\x20`','/disconnect\x20-\x20disconnect\x20from\x20notifications','defineProperty','.pdf','application/pdf','âœ…\x20Welcome\x20back!\x0a\x0a','Error\x20getting\x20merchant\x20statistics:','0.0','shopId','pl_view_list','sendApiErrorNotification','ðŸ“±\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20','âœ…\x20Successful\x20Payments\x20\x5c-\x20','`\x0a\x0a','stats_all_time','âŒ\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a','filter','getUTCMonth','GBP','../types/gateway','âŒ\x20Invalid\x20API\x20key\x20format.\x0a\x0a','\x20USDT*\x0a','orderId','ðŸŒ\x20IP\x20address:\x20`','ðŸ“…\x20This\x20Month','Disconnect\x20one\x20of\x20the\x20existing\x20accounts\x20first.','âœ…\x20*Payment\x20Link\x20Created\x20Successfully\x5c!*\x0a\x0a','findMany','Error\x20handling\x20/status\x20command:','TRY','âŒ\x20Failed\x20to\x20send\x20notification\x20to\x20all\x20users:','Coming\x20soon...\x0a\x0a','../config/database','username','Error\x20handling\x20/payouts\x20command:','âœ…\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20','ðŸ’°\x20Amount:\x20*','6795774lylbUL','adminNotes','amountUSDT','answerCallbackQuery','pl_cancel','Payment\x20is\x20being\x20processed','ðŸ“Š\x20Statistics','shopSettings','â¬…ï¸\x20Previous','ðŸ“ž\x20Contacts','customerUa','âŒ\x20Failed\x20Payments\x20\x5c-\x20','__esModule','sendDocument','â€¢\x20Active\x20payment\x20links\x0a','âš ï¸\x20Chargebacks\x20\x5c-\x20','â€¢\x20Transaction\x20status\x0a','USD','Payment\x20failed','COMPLETED','SINGLE','Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).','handleMerchantStatistics','ðŸ’»\x20Browser:\x20`','`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a','ðŸ””\x20You\x20receive\x20notifications\x20about:\x0a','â€¢\x20Payouts','API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.','ðŸ“…\x20Today','LTC','*\x0a\x0a','amount','paymentGateways','showPaymentLinksList','New\x20payment\x20created','â€¢\x20Usage\x20statistics\x0a','initializeBot','/link/','REFUND','TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables','requestId','updatedAt','handlePaymentLinkFlow','\x20users\x20of\x20shop\x20','ðŸ“ˆ\x20Conversion\x20\x5c-\x20','âŒ\x20Please\x20use\x20/start\x20command\x20first','startsWith','â—ï¸\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!','ðŸ“…\x20Last\x20Month','âœ…\x20Paid\x20out:\x20','ðŸ’¸\x20*Recent\x20Payouts*\x0a\x0a','sendLoginNotification','`\x20not\x20found.\x0a\x0a',':\x20username=\x22','Payment\x20successfully\x20paid','âœ…\x20Telegram\x20bot\x20@','PENDING','No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20','findUnique','BNB','numeric','getUTCFullYear','find','\x20verified\x20for\x20shop\x20','âŒ\x20Telegram\x20bot\x20not\x20initialized','pl_create_new','text','âŒ\x20No\x20active\x20gateways\x20found.\x20Please\x20enable\x20at\x20least\x20one\x20gateway\x20in\x20the\x20admin\x20panel.','botUsername','ðŸ“…\x20Yesterday','âŒ\x20Error\x20getting\x20debug\x20information.','âŒ\x20No\x20gateways\x20configured.\x20Please\x20configure\x20gateways\x20in\x20the\x20admin\x20panel\x20first.','FAILED','\x0aðŸ’¡\x20Check\x20your\x20request\x20or\x20contact\x20support.','stopPolling','allSettled','chat','entries','\x20disconnected\x20from\x20shop\x20','first_name','handleSingleLineVerification','ðŸ’¬\x20Support:\x20https://t.me/trapay\x5c_sales','POL','trim','Error\x20handling\x20message:','Error\x20in\x20payment\x20link\x20flow:','error','Error\x20in\x20handleSingleLineVerification:','ðŸ”—\x20*Create\x20Payment\x20Link*\x0a\x0aStep\x201/4:\x20Select\x20gateway','Please\x20send\x20the\x20amount\x20in\x20','Multi\x20Use','cmd_payouts','6495944mXWlQy','en-US','ðŸ“±\x20Shop:\x20*','ðŸŒ\x20Website:\x20https://trapay.uk/\x0a','â€¢\x20Dates\x20and\x20TX\x20IDs','ðŸ’³\x20*Wallet:*\x20`','bot','\x20parts:\x20','toLocaleString','forEach','count','\x20\x20\x20Gateway:\x20','all','ðŸ‘¤\x20Account:\x20https://app.trapay.uk/login\x0a','sendShopFile','âŒ\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a','\x20\x5c|\x20Type:\x20','Unknown','\x20-\x20','Make\x20sure\x20you\x20have\x20the\x20correct\x20username\x20from\x20your\x20account.','gateway','N/A','botToken','includes','ARS','USDC','ðŸ“±\x20Created\x20new\x20Telegram\x20user:\x20','telegramBotService','Use\x20/start\x20to\x20connect.','getUTCDate','\x20via\x20single-line\x20input','cmd_statistics','\x22,\x20apiKey=\x22','â€¢\x20New\x20payments\x0a'];a87_0x18ec=function(){return _0x403e2c;};return a87_0x18ec();}var __importDefault=this&&this['__importDefault']||function(_0x233123){const _0x3a9f61=a87_0x5d5d;return _0x233123&&_0x233123[_0x3a9f61(0xa0)]?_0x233123:{'default':_0x233123};};function a87_0x5d5d(_0x286134,_0x2dabcf){_0x286134=_0x286134-0x9c;const _0x18ecc4=a87_0x18ec();let _0x5d5d72=_0x18ecc4[_0x286134];return _0x5d5d72;}Object[a87_0xedbd06(0x218)](exports,'__esModule',{'value':!![]}),exports[a87_0xedbd06(0x10b)]=exports[a87_0xedbd06(0x11e)]=void 0x0;const node_telegram_bot_api_1=__importDefault(require('node-telegram-bot-api')),database_1=__importDefault(require(a87_0xedbd06(0x236))),gateway_1=require(a87_0xedbd06(0x229));class TelegramBotService{constructor(){const _0x2ab8ad=a87_0xedbd06;this[_0x2ab8ad(0xf6)]=null,this['paymentLinkSessions']=new Map(),this[_0x2ab8ad(0x106)]=process.env.TELEGRAM_BOT_TOKEN||'',this[_0x2ab8ad(0xd8)]=process.env.TELEGRAM_BOT_USERNAME||'trapay_bot',this[_0x2ab8ad(0x106)]?this[_0x2ab8ad(0xb8)]():console[_0x2ab8ad(0x1d5)](_0x2ab8ad(0xbb));}[a87_0xedbd06(0xb8)](){const _0x5004ef=a87_0xedbd06;try{this['bot']=new node_telegram_bot_api_1[(_0x5004ef(0x186))](this['botToken'],{'polling':!![]}),this[_0x5004ef(0x205)](),console['log'](_0x5004ef(0xcb)+this[_0x5004ef(0xd8)]+_0x5004ef(0x1d6));}catch(_0x54c0c6){console[_0x5004ef(0xea)]('âŒ\x20Failed\x20to\x20initialize\x20Telegram\x20bot:',_0x54c0c6);}}[a87_0xedbd06(0x205)](){const _0x3a2c00=a87_0xedbd06;if(!this[_0x3a2c00(0xf6)])return;this['bot'][_0x3a2c00(0x199)](/\/start/,async _0x50a85d=>{const _0x8d1c6=_0x3a2c00,_0x390edd=_0x50a85d['chat']['id'],_0x2eb3c8=_0x50a85d['from']?.['id'][_0x8d1c6(0x14d)](),_0x312512=_0x50a85d['from']?.[_0x8d1c6(0x237)],_0x524c03=_0x50a85d['from']?.[_0x8d1c6(0xe3)],_0x4f5f28=_0x50a85d[_0x8d1c6(0x1fb)]?.[_0x8d1c6(0x168)];if(!_0x2eb3c8)return;try{let _0x2b05e6=await database_1[_0x8d1c6(0x186)]['telegramUser']['findUnique']({'where':{'telegramId':_0x2eb3c8},'include':{'shop':!![]}});!_0x2b05e6?(_0x2b05e6=await database_1[_0x8d1c6(0x186)][_0x8d1c6(0x167)][_0x8d1c6(0x1f1)]({'data':{'telegramId':_0x2eb3c8,'username':_0x312512,'firstName':_0x524c03,'lastName':_0x4f5f28,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console[_0x8d1c6(0x189)](_0x8d1c6(0x10a)+_0x2eb3c8+'\x20(@'+_0x312512+')')):_0x2b05e6=await database_1[_0x8d1c6(0x186)][_0x8d1c6(0x167)][_0x8d1c6(0x207)]({'where':{'telegramId':_0x2eb3c8},'data':{'username':_0x312512,'firstName':_0x524c03,'lastName':_0x4f5f28},'include':{'shop':!![]}}),_0x2b05e6[_0x8d1c6(0x1bd)]&&_0x2b05e6[_0x8d1c6(0x21e)]&&_0x2b05e6['shop']?await this[_0x8d1c6(0xf6)]?.['sendMessage'](_0x390edd,_0x8d1c6(0x21b)+(_0x8d1c6(0x1da)+_0x2b05e6[_0x8d1c6(0x1af)][_0x8d1c6(0x1f3)]+'*\x0a')+('Username:\x20`'+_0x2b05e6[_0x8d1c6(0x1af)]['username']+'`\x0a\x0a')+_0x8d1c6(0xad)+_0x8d1c6(0x111)+_0x8d1c6(0x121)+_0x8d1c6(0xae),{'parse_mode':_0x8d1c6(0x139),'reply_markup':{'inline_keyboard':[[{'text':_0x8d1c6(0x241),'callback_data':_0x8d1c6(0x10f)},{'text':_0x8d1c6(0x1be),'callback_data':_0x8d1c6(0xef)}],[{'text':_0x8d1c6(0x1ea),'callback_data':_0x8d1c6(0x1ae)},{'text':_0x8d1c6(0x155),'callback_data':_0x8d1c6(0x1cd)}],[{'text':_0x8d1c6(0x9d),'callback_data':'cmd_contacts'},{'text':_0x8d1c6(0x178),'callback_data':'cmd_disconnect'}]]}}):(_0x2b05e6[_0x8d1c6(0x21e)]&&!_0x2b05e6[_0x8d1c6(0x1bd)]&&(await database_1[_0x8d1c6(0x186)]['telegramUser']['update']({'where':{'telegramId':_0x2eb3c8},'data':{'shopId':null,'isVerified':![]}}),console[_0x8d1c6(0x189)]('ðŸ”„\x20Reset\x20incomplete\x20verification\x20for\x20user\x20'+_0x2eb3c8)),await this[_0x8d1c6(0xf6)]?.[_0x8d1c6(0x148)](_0x390edd,_0x8d1c6(0x1f6)+_0x8d1c6(0x1c8)+'ðŸ“\x20Format:\x20`username\x20api_key`\x0a\x0a'+'Example:\x0a'+_0x8d1c6(0xac)+_0x8d1c6(0xc3),{'parse_mode':_0x8d1c6(0x139)}));}catch(_0x598b9d){console[_0x8d1c6(0xea)](_0x8d1c6(0x174),_0x598b9d),await this[_0x8d1c6(0xf6)]?.['sendMessage'](_0x390edd,_0x8d1c6(0x15c));}}),this[_0x3a2c00(0xf6)][_0x3a2c00(0x199)](/\/disconnect/,async _0x308625=>{const _0xc54623=_0x3a2c00,_0x54c1d3=_0x308625[_0xc54623(0xe0)]['id'],_0x2d1ab2=_0x308625[_0xc54623(0x1fb)]?.['id'][_0xc54623(0x14d)]();if(!_0x2d1ab2)return;try{const _0x50d595=await database_1[_0xc54623(0x186)][_0xc54623(0x167)]['findUnique']({'where':{'telegramId':_0x2d1ab2},'include':{'shop':!![]}});if(!_0x50d595||!_0x50d595[_0xc54623(0x1bd)]||!_0x50d595[_0xc54623(0x21e)]){await this[_0xc54623(0xf6)]?.[_0xc54623(0x148)](_0x54c1d3,'âŒ\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.');return;}const _0x4c2a4a=_0x50d595[_0xc54623(0x1af)]?.[_0xc54623(0x1f3)]||'unknown\x20shop';await database_1[_0xc54623(0x186)]['telegramUser'][_0xc54623(0x207)]({'where':{'telegramId':_0x2d1ab2},'data':{'shopId':null,'isVerified':![]}}),console[_0xc54623(0x189)](_0xc54623(0x1d4)+_0x2d1ab2+_0xc54623(0xe2)+_0x50d595[_0xc54623(0x21e)]),await this['bot']?.['sendMessage'](_0x54c1d3,_0xc54623(0x16a)+_0x4c2a4a+_0xc54623(0x184)+'To\x20reconnect,\x20use\x20the\x20/start\x20command',{'parse_mode':_0xc54623(0x139)});}catch(_0x24e031){console['error'](_0xc54623(0x1e3),_0x24e031),await this['bot']?.[_0xc54623(0x148)](_0x54c1d3,_0xc54623(0x15c));}}),this[_0x3a2c00(0xf6)][_0x3a2c00(0x199)](/\/status/,async _0x5953d3=>{const _0x47efca=_0x3a2c00,_0x5d65ba=_0x5953d3[_0x47efca(0xe0)]['id'],_0x56052d=_0x5953d3[_0x47efca(0x1fb)]?.['id'][_0x47efca(0x14d)]();if(!_0x56052d)return;try{const _0xf45458=await database_1['default'][_0x47efca(0x167)][_0x47efca(0xce)]({'where':{'telegramId':_0x56052d},'include':{'shop':!![]}});if(!_0xf45458){await this[_0x47efca(0xf6)]?.['sendMessage'](_0x5d65ba,_0x47efca(0x175)+'Use\x20/start\x20to\x20begin.');return;}if(!_0xf45458[_0x47efca(0x1bd)]||!_0xf45458['shopId']||!_0xf45458[_0x47efca(0x1af)]){await this[_0x47efca(0xf6)]?.[_0x47efca(0x148)](_0x5d65ba,'âŒ\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a'+_0x47efca(0x10c));return;}await this[_0x47efca(0xf6)]?.[_0x47efca(0x148)](_0x5d65ba,_0x47efca(0x1c4)+('âœ…\x20Connected\x20to\x20shop:\x20*'+_0xf45458[_0x47efca(0x1af)][_0x47efca(0x1f3)]+'*\x0a')+(_0x47efca(0x197)+_0xf45458['shop'][_0x47efca(0x237)]+'`\x0a')+(_0x47efca(0x1c5)+_0xf45458[_0x47efca(0xbd)][_0x47efca(0x202)](_0x47efca(0xf1))+'\x0a\x0a')+_0x47efca(0x201)+_0x47efca(0x17c)+'/statistics\x20-\x20view\x20your\x20statistics\x0a'+'/payouts\x20-\x20view\x20recent\x20payouts\x0a'+_0x47efca(0x133)+_0x47efca(0x1bb)+_0x47efca(0x217),{'parse_mode':_0x47efca(0x139)});}catch(_0x5c6b2b){console[_0x47efca(0xea)](_0x47efca(0x232),_0x5c6b2b),await this[_0x47efca(0xf6)]?.[_0x47efca(0x148)](_0x5d65ba,_0x47efca(0x15c));}}),this[_0x3a2c00(0xf6)][_0x3a2c00(0x199)](/\/statistics/,async _0x3b36b3=>{const _0x55bab0=_0x3a2c00,_0x28c967=_0x3b36b3['chat']['id'],_0x265270=_0x3b36b3['from']?.['id'][_0x55bab0(0x14d)]();if(!_0x265270)return;try{const _0x511933=await database_1[_0x55bab0(0x186)]['telegramUser'][_0x55bab0(0xce)]({'where':{'telegramId':_0x265270},'include':{'shop':!![]}});if(!_0x511933?.[_0x55bab0(0x1bd)]||!_0x511933['shopId']){await this['bot']?.[_0x55bab0(0x148)](_0x28c967,_0x55bab0(0xff)+'Use\x20/start\x20to\x20connect.');return;}const _0x251b39={'inline_keyboard':[[{'text':_0x55bab0(0xb0),'callback_data':'stats_today'}],[{'text':_0x55bab0(0xd9),'callback_data':_0x55bab0(0x153)}],[{'text':'ðŸ“…\x20This\x20Month','callback_data':_0x55bab0(0x157)}],[{'text':_0x55bab0(0xc4),'callback_data':_0x55bab0(0x1a2)}],[{'text':_0x55bab0(0x1ad),'callback_data':_0x55bab0(0x224)}]]};await this[_0x55bab0(0xf6)]?.[_0x55bab0(0x148)](_0x28c967,_0x55bab0(0x203),{'parse_mode':_0x55bab0(0x139),'reply_markup':_0x251b39});}catch(_0x3c938a){console[_0x55bab0(0xea)](_0x55bab0(0x1e1),_0x3c938a),await this[_0x55bab0(0xf6)]?.[_0x55bab0(0x148)](_0x28c967,_0x55bab0(0x15c));}}),this[_0x3a2c00(0xf6)]['onText'](/\/payouts/,async _0x46a128=>{const _0x47d877=_0x3a2c00,_0x3fd212=_0x46a128[_0x47d877(0xe0)]['id'],_0x48691d=_0x46a128[_0x47d877(0x1fb)]?.['id'][_0x47d877(0x14d)]();if(!_0x48691d)return;try{const _0x2d32eb=await database_1[_0x47d877(0x186)][_0x47d877(0x167)][_0x47d877(0xce)]({'where':{'telegramId':_0x48691d},'include':{'shop':!![]}});if(!_0x2d32eb?.[_0x47d877(0x1bd)]||!_0x2d32eb[_0x47d877(0x21e)]){await this[_0x47d877(0xf6)]?.[_0x47d877(0x148)](_0x3fd212,_0x47d877(0xff)+_0x47d877(0x10c));return;}await this[_0x47d877(0xf6)]?.[_0x47d877(0x148)](_0x3fd212,_0x47d877(0xc6)+_0x47d877(0x235)+_0x47d877(0x126)+'â€¢\x20Last\x205\x20payouts\x0a'+_0x47d877(0x1a4)+_0x47d877(0xa4)+_0x47d877(0xf4),{'parse_mode':_0x47d877(0x139)});}catch(_0x1429d5){console[_0x47d877(0xea)](_0x47d877(0x238),_0x1429d5),await this[_0x47d877(0xf6)]?.[_0x47d877(0x148)](_0x3fd212,_0x47d877(0x15c));}}),this[_0x3a2c00(0xf6)][_0x3a2c00(0x199)](/\/payment_links/,async _0x13dc69=>{const _0x11d983=_0x3a2c00,_0x5a2ae5=_0x13dc69['chat']['id'],_0x579bc1=_0x13dc69['from']?.['id'][_0x11d983(0x14d)]();if(!_0x579bc1)return;try{const _0x31fbe3=await database_1[_0x11d983(0x186)][_0x11d983(0x167)][_0x11d983(0xce)]({'where':{'telegramId':_0x579bc1},'include':{'shop':!![]}});if(!_0x31fbe3?.[_0x11d983(0x1bd)]||!_0x31fbe3[_0x11d983(0x21e)]){await this['bot']?.[_0x11d983(0x148)](_0x5a2ae5,'âŒ\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a'+_0x11d983(0x10c));return;}await this[_0x11d983(0xf6)]?.['sendMessage'](_0x5a2ae5,_0x11d983(0x15e)+'Coming\x20soon...\x0a\x0a'+_0x11d983(0x126)+_0x11d983(0xa2)+_0x11d983(0xb7)+_0x11d983(0x17e)+_0x11d983(0x1c6),{'parse_mode':'Markdown'});}catch(_0x4d0923){console['error'](_0x11d983(0x206),_0x4d0923),await this[_0x11d983(0xf6)]?.[_0x11d983(0x148)](_0x5a2ae5,_0x11d983(0x15c));}}),this['bot'][_0x3a2c00(0x199)](/\/contacts/,async _0x352b76=>{const _0xfa2dc=_0x3a2c00,_0x487d70=_0x352b76[_0xfa2dc(0xe0)]['id'];try{await this['bot']?.[_0xfa2dc(0x148)](_0x487d70,_0xfa2dc(0x171)+_0xfa2dc(0xf3)+_0xfa2dc(0xfd)+'ðŸ“¢\x20Telegram\x20channel:\x20https://t.me/trapay\x5c_news\x0a'+_0xfa2dc(0xe5),{'parse_mode':_0xfa2dc(0x139)});}catch(_0x3b94ea){console[_0xfa2dc(0xea)](_0xfa2dc(0x13c),_0x3b94ea),await this['bot']?.[_0xfa2dc(0x148)](_0x487d70,_0xfa2dc(0x15c));}}),this[_0x3a2c00(0xf6)]['on'](_0x3a2c00(0x1c0),async _0x1783aa=>{const _0xedf9d4=_0x3a2c00,_0x14f7ce=_0x1783aa[_0xedf9d4(0x130)],_0x463d90=_0x14f7ce?.[_0xedf9d4(0xe0)]['id'],_0x2c8fc9=_0x1783aa[_0xedf9d4(0x1fb)]['id'][_0xedf9d4(0x14d)](),_0x1c7bdd=_0x1783aa['data'];if(!_0x463d90||!_0x1c7bdd)return;try{await this['bot']?.[_0xedf9d4(0x23e)](_0x1783aa['id']);const _0x565ae5=await database_1['default']['telegramUser']['findUnique']({'where':{'telegramId':_0x2c8fc9},'include':{'shop':!![]}});if(!_0x565ae5?.[_0xedf9d4(0x1bd)]||!_0x565ae5[_0xedf9d4(0x21e)]){await this['bot']?.[_0xedf9d4(0x148)](_0x463d90,_0xedf9d4(0x120));return;}switch(_0x1c7bdd){case _0xedf9d4(0x10f):const _0x171048={'inline_keyboard':[[{'text':'ðŸ“…\x20Today','callback_data':_0xedf9d4(0x12b)}],[{'text':_0xedf9d4(0xd9),'callback_data':_0xedf9d4(0x153)}],[{'text':_0xedf9d4(0x22e),'callback_data':_0xedf9d4(0x157)}],[{'text':_0xedf9d4(0xc4),'callback_data':_0xedf9d4(0x1a2)}],[{'text':_0xedf9d4(0x1ad),'callback_data':_0xedf9d4(0x224)}]]};await this['bot']?.[_0xedf9d4(0x148)](_0x463d90,_0xedf9d4(0x203),{'parse_mode':_0xedf9d4(0x139),'reply_markup':_0x171048});break;case _0xedf9d4(0x12b):case _0xedf9d4(0x153):case'stats_this_month':case _0xedf9d4(0x1a2):case'stats_all_time':await this[_0xedf9d4(0xaa)](_0x463d90,_0x565ae5['shopId'],_0x1c7bdd,_0x14f7ce?.[_0xedf9d4(0x1b1)]);break;case'back_to_stats_menu':const _0x308e0c={'inline_keyboard':[[{'text':'ðŸ“…\x20Today','callback_data':_0xedf9d4(0x12b)}],[{'text':'ðŸ“…\x20Yesterday','callback_data':_0xedf9d4(0x153)}],[{'text':_0xedf9d4(0x22e),'callback_data':'stats_this_month'}],[{'text':'ðŸ“…\x20Last\x20Month','callback_data':_0xedf9d4(0x1a2)}],[{'text':_0xedf9d4(0x1ad),'callback_data':_0xedf9d4(0x224)}]]};_0x14f7ce?.['message_id']?await this['bot']?.['editMessageText'](_0xedf9d4(0x203),{'chat_id':_0x463d90,'message_id':_0x14f7ce['message_id'],'parse_mode':_0xedf9d4(0x139),'reply_markup':_0x308e0c}):await this[_0xedf9d4(0xf6)]?.[_0xedf9d4(0x148)](_0x463d90,'ðŸ“Š\x20*Statistics*\x0a\x0aSelect\x20period:',{'parse_mode':_0xedf9d4(0x139),'reply_markup':_0x308e0c});break;case _0xedf9d4(0xef):const _0x5062ef=await database_1['default'][_0xedf9d4(0x123)][_0xedf9d4(0x231)]({'where':{'shopId':_0x565ae5['shopId']},'orderBy':{'createdAt':_0xedf9d4(0x1b8)}}),_0x4e6f7c=_0x5062ef[_0xedf9d4(0x226)](_0x162626=>_0x162626[_0xedf9d4(0x1e4)]===_0xedf9d4(0xcc))[_0xedf9d4(0x1b3)]((_0x54d0a1,_0x79cf33)=>_0x54d0a1+_0x79cf33[_0xedf9d4(0xb3)],0x0),_0x38bb2f=_0x5062ef['filter'](_0x2b145c=>_0x2b145c[_0xedf9d4(0x1e4)]===_0xedf9d4(0xa7))[_0xedf9d4(0x1b3)]((_0x46e49e,_0x2f68cd)=>_0x46e49e+_0x2f68cd[_0xedf9d4(0xb3)],0x0),_0x5c30dc=(_0x565ae5['shop']?.['balance']||0x0)+(_0x565ae5[_0xedf9d4(0x1af)]?.['totalPaidOut']||0x0);await this[_0xedf9d4(0xf6)]?.[_0xedf9d4(0x148)](_0x463d90,'ðŸ’¸\x20*Payouts*\x0a\x0a'+(_0xedf9d4(0x127)+_0x4e6f7c[_0xedf9d4(0x1a8)](0x2)+'\x20USDC\x0a')+(_0xedf9d4(0xc5)+_0x38bb2f[_0xedf9d4(0x1a8)](0x2)+_0xedf9d4(0x1a7))+('ðŸ’°\x20Total\x20earned:\x20'+_0x5c30dc[_0xedf9d4(0x1a8)](0x2)+_0xedf9d4(0x134)),{'parse_mode':'Markdown'});break;case'cmd_payment_links':await this[_0xedf9d4(0xf6)]?.[_0xedf9d4(0x148)](_0x463d90,_0xedf9d4(0x117),{'parse_mode':_0xedf9d4(0x139),'reply_markup':{'inline_keyboard':[[{'text':_0xedf9d4(0x1aa),'callback_data':_0xedf9d4(0x21f)}],[{'text':'âž•\x20Create\x20New\x20Link','callback_data':_0xedf9d4(0xd5)}],[{'text':_0xedf9d4(0x1c3),'callback_data':'pl_cancel'}]]}});break;case _0xedf9d4(0x1cd):await this['bot']?.['sendMessage'](_0x463d90,'ðŸ“Š\x20*Connection\x20Status*\x0a\x0a'+(_0xedf9d4(0x1d8)+(_0x565ae5[_0xedf9d4(0x1af)]?.['name']||_0xedf9d4(0x101))+'*\x0a')+('ðŸ‘¤\x20Username:\x20`'+(_0x565ae5[_0xedf9d4(0x1af)]?.[_0xedf9d4(0x237)]||_0xedf9d4(0x101))+'`\x0a')+(_0xedf9d4(0x1c5)+_0x565ae5['updatedAt'][_0xedf9d4(0x202)](_0xedf9d4(0xf1))+'\x0a\x0a')+_0xedf9d4(0x124),{'parse_mode':'Markdown'});break;case _0xedf9d4(0x129):await this['bot']?.['sendMessage'](_0x463d90,_0xedf9d4(0x171)+_0xedf9d4(0xf3)+_0xedf9d4(0xfd)+_0xedf9d4(0x1b9)+_0xedf9d4(0xe5),{'parse_mode':_0xedf9d4(0x139)});break;case _0xedf9d4(0x1d3):await database_1['default'][_0xedf9d4(0x167)][_0xedf9d4(0x207)]({'where':{'telegramId':_0x2c8fc9},'data':{'shopId':null,'isVerified':![]}}),await this[_0xedf9d4(0xf6)]?.['sendMessage'](_0x463d90,_0xedf9d4(0x16a)+(_0x565ae5[_0xedf9d4(0x1af)]?.[_0xedf9d4(0x1f3)]||'Unknown')+_0xedf9d4(0x184)+_0xedf9d4(0x1ca),{'parse_mode':_0xedf9d4(0x139)});break;default:_0x1c7bdd[_0xedf9d4(0xc2)](_0xedf9d4(0x1e0))?await this[_0xedf9d4(0xbe)](_0x463d90,_0x2c8fc9,_0x1c7bdd,_0x1783aa[_0xedf9d4(0x130)]?.['message_id']):await this['bot']?.[_0xedf9d4(0x148)](_0x463d90,'âŒ\x20Unknown\x20command');}}catch(_0x557696){console['error'](_0xedf9d4(0x180),_0x557696),await this[_0xedf9d4(0xf6)]?.[_0xedf9d4(0x148)](_0x463d90,_0xedf9d4(0x15c));}}),this[_0x3a2c00(0xf6)][_0x3a2c00(0x199)](/\/debug/,async _0x470cf3=>{const _0x123060=_0x3a2c00,_0x572a3e=_0x470cf3[_0x123060(0xe0)]['id'],_0x3820c5=_0x470cf3[_0x123060(0x1fb)]?.['id'][_0x123060(0x14d)]();if(!_0x3820c5)return;try{const _0x525f35=await database_1[_0x123060(0x186)][_0x123060(0x167)][_0x123060(0xce)]({'where':{'telegramId':_0x3820c5},'include':{'shop':!![]}});let _0xd3910e='ðŸ”\x20*Debug\x20Information*\x0a\x0a';_0xd3910e+=_0x123060(0x216)+_0x3820c5+_0x123060(0x223),_0x525f35?.[_0x123060(0x1bd)]&&_0x525f35[_0x123060(0x1af)]?(_0xd3910e+=_0x123060(0x147),_0xd3910e+=_0x123060(0x204)+_0x525f35['shop'][_0x123060(0x1f3)]+'*\x0a',_0xd3910e+=_0x123060(0x166)+_0x525f35[_0x123060(0x1af)]['username']+'`\x0a',_0xd3910e+=_0x123060(0x156)+_0x525f35['shop'][_0x123060(0x1e4)]+'\x0a\x0a'):_0xd3910e+='âŒ\x20You\x20are\x20not\x20connected\x20to\x20any\x20shop.\x0a\x0a',_0xd3910e+='Use\x20/start\x20to\x20connect\x20to\x20a\x20shop.',await this[_0x123060(0xf6)]?.[_0x123060(0x148)](_0x572a3e,_0xd3910e,{'parse_mode':_0x123060(0x139)});}catch(_0x2c202d){console[_0x123060(0xea)]('Error\x20handling\x20/debug\x20command:',_0x2c202d),await this[_0x123060(0xf6)]?.['sendMessage'](_0x572a3e,_0x123060(0xda));}}),this[_0x3a2c00(0xf6)]['on'](_0x3a2c00(0x130),async _0x1be1bd=>{const _0x445625=_0x3a2c00;if(_0x1be1bd[_0x445625(0xd6)]?.[_0x445625(0xc2)]('/'))return;const _0x59bf17=_0x1be1bd[_0x445625(0xe0)]['id'],_0x21379b=_0x1be1bd['from']?.['id'][_0x445625(0x14d)](),_0x40502c=_0x1be1bd[_0x445625(0xd6)]?.[_0x445625(0xe7)]();if(!_0x21379b||!_0x40502c)return;try{const _0x5f24ad=this['paymentLinkSessions']['get'](_0x21379b);if(_0x5f24ad&&_0x5f24ad[_0x445625(0x1e5)]===_0x445625(0xb3)){const _0x4d1d1b=parseFloat(_0x40502c);if(isNaN(_0x4d1d1b)||_0x4d1d1b<=0x0){await this[_0x445625(0xf6)]?.['sendMessage'](_0x59bf17,'âŒ\x20Invalid\x20amount.\x20Please\x20enter\x20a\x20valid\x20number\x20greater\x20than\x200.');return;}const _0x29d0ee=await database_1['default'][_0x445625(0x167)][_0x445625(0xce)]({'where':{'telegramId':_0x21379b},'include':{'shop':!![]}});if(!_0x29d0ee?.[_0x445625(0x21e)]){await this[_0x445625(0xf6)]?.[_0x445625(0x148)](_0x59bf17,'âŒ\x20Shop\x20not\x20found.\x20Please\x20start\x20over\x20with\x20/start'),this[_0x445625(0x14f)][_0x445625(0x1ce)](_0x21379b);return;}const _0x438e90=(0x0,gateway_1[_0x445625(0x112)])(_0x5f24ad[_0x445625(0x104)])?(0x0,gateway_1[_0x445625(0x1e9)])(_0x5f24ad[_0x445625(0x104)]):_0x5f24ad[_0x445625(0x104)],_0x4d1ba8={'shopId':_0x29d0ee['shopId'],'gateway':_0x438e90,'amount':_0x4d1d1b,'currency':_0x5f24ad[_0x445625(0x1cc)],'type':_0x5f24ad[_0x445625(0x12c)],'status':_0x445625(0x161)},_0x145e85=await database_1['default'][_0x445625(0x200)][_0x445625(0x1f1)]({'data':_0x4d1ba8});this[_0x445625(0x14f)]['delete'](_0x21379b);const _0x1805e8=(process.env.FRONTEND_URL||_0x445625(0x1de))+_0x445625(0xb9)+_0x145e85['id'],_0x301a06=_0x1805e8[_0x445625(0x137)](/\./g,'\x5c.')[_0x445625(0x137)](/-/g,'\x5c-')[_0x445625(0x137)](/\//g,'\x5c/');await this[_0x445625(0xf6)]?.['sendMessage'](_0x59bf17,_0x445625(0x230)+(_0x445625(0x1d9)+_0x301a06+'\x0a')+(_0x445625(0x1fd)+_0x4d1d1b+'\x20'+_0x5f24ad[_0x445625(0x1cc)]+'\x0a')+('ðŸ¦\x20Gateway:\x20'+_0x5f24ad['gateway']+'\x0a')+(_0x445625(0x170)+(_0x5f24ad[_0x445625(0x12c)]===_0x445625(0xa8)?'Single\x20Use':_0x445625(0xee))+'\x0a\x0a')+'Copy\x20and\x20share\x20this\x20link\x20with\x20your\x20customers\x5c!',{'parse_mode':_0x445625(0x1ed)});return;}const _0x4de63a=await database_1[_0x445625(0x186)][_0x445625(0x167)][_0x445625(0xce)]({'where':{'telegramId':_0x21379b},'include':{'shop':!![]}});if(!_0x4de63a){await this[_0x445625(0xf6)]?.['sendMessage'](_0x59bf17,_0x445625(0xc1));return;}if(_0x4de63a['isVerified']&&_0x4de63a[_0x445625(0x21e)]&&_0x4de63a[_0x445625(0x1af)]){await this['bot']?.[_0x445625(0x148)](_0x59bf17,_0x445625(0x11b)+_0x4de63a['shop']['name']+_0x445625(0x184)+_0x445625(0x143),{'parse_mode':_0x445625(0x139)});return;}const _0x496b3b=_0x40502c[_0x445625(0x17b)](/\s+/);if(_0x496b3b[_0x445625(0x1d1)]!==0x2){await this['bot']?.[_0x445625(0x148)](_0x59bf17,_0x445625(0x225)+'ðŸ“\x20Format:\x20`username\x20api_key`\x0a\x0a'+'Example:\x0a'+_0x445625(0xac)+('You\x20sent\x20'+_0x496b3b[_0x445625(0x1d1)]+_0x445625(0xf7)+_0x496b3b[_0x445625(0x18f)](_0x35b80e=>'`'+_0x35b80e+'`')[_0x445625(0x132)](',\x20')),{'parse_mode':'Markdown'});return;}const [_0x5298dd,_0x5f0c04]=_0x496b3b;console['log'](_0x445625(0x18a)+_0x21379b+_0x445625(0xc9)+_0x5298dd+_0x445625(0x110)+_0x5f0c04[_0x445625(0x13a)](0x0,0xa)+_0x445625(0x146)),await this[_0x445625(0xe4)](_0x59bf17,_0x21379b,_0x5298dd,_0x5f0c04);}catch(_0x1c63d4){console['error'](_0x445625(0xe8),_0x1c63d4),await this['bot']?.['sendMessage'](_0x59bf17,'âŒ\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this[_0x3a2c00(0xf6)]['on'](_0x3a2c00(0xea),_0xd2183f=>{console['error']('Telegram\x20bot\x20error:',_0xd2183f);}),this[_0x3a2c00(0xf6)]['on'](_0x3a2c00(0x16c),_0xe38a24=>{const _0x480faf=_0x3a2c00;console['error'](_0x480faf(0x16b),_0xe38a24);});}async[a87_0xedbd06(0xe4)](_0x59de58,_0x128c0b,_0xd72a5d,_0x34c019){const _0x74969d=a87_0xedbd06;try{console[_0x74969d(0x189)](_0x74969d(0x18a)+_0x128c0b+_0x74969d(0xc9)+_0xd72a5d+_0x74969d(0x110)+_0x34c019[_0x74969d(0x13a)](0x0,0xa)+_0x74969d(0x146));if(!_0xd72a5d||_0xd72a5d['length']<0x3||_0xd72a5d[_0x74969d(0x1d1)]>0x32||!/^[a-zA-Z0-9_]+$/['test'](_0xd72a5d)){await this[_0x74969d(0xf6)]?.[_0x74969d(0x148)](_0x59de58,_0x74969d(0x187)+_0xd72a5d+_0x74969d(0x223)+_0x74969d(0xa9),{'parse_mode':_0x74969d(0x139)});return;}if(!_0x34c019||!_0x34c019[_0x74969d(0xc2)](_0x74969d(0x152))&&!_0x34c019['startsWith']('sk_')){await this['bot']?.[_0x74969d(0x148)](_0x59de58,_0x74969d(0x22a)+_0x74969d(0xaf),{'parse_mode':_0x74969d(0x139)});return;}const _0x497fba=await database_1[_0x74969d(0x186)]['shop'][_0x74969d(0xce)]({'where':{'username':_0xd72a5d},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x497fba){const _0x444630='âŒ\x20Shop\x20with\x20username\x20`'+_0xd72a5d+_0x74969d(0xc8)+'Please\x20check\x20the\x20spelling\x20and\x20try\x20again.\x0a\x0a'+_0x74969d(0x103);await this[_0x74969d(0xf6)]?.['sendMessage'](_0x59de58,_0x444630,{'parse_mode':_0x74969d(0x139)});return;}if(_0x497fba[_0x74969d(0x1e4)]!==_0x74969d(0x161)){await this[_0x74969d(0xf6)]?.[_0x74969d(0x148)](_0x59de58,_0x74969d(0x19c)+_0xd72a5d+_0x74969d(0x163)+'Contact\x20administrator.',{'parse_mode':_0x74969d(0x139)});return;}if(_0x497fba['publicKey']!==_0x34c019&&_0x497fba[_0x74969d(0x116)]!==_0x34c019){await this[_0x74969d(0xf6)]?.[_0x74969d(0x148)](_0x59de58,_0x74969d(0x158)+_0xd72a5d+_0x74969d(0x214)+_0x74969d(0x159)+_0x74969d(0x15d),{'parse_mode':'Markdown'});return;}const _0x3a0be5=await database_1['default']['telegramUser'][_0x74969d(0xfa)]({'where':{'shopId':_0x497fba['id'],'isVerified':!![]}});if(_0x3a0be5>=0x5){await this[_0x74969d(0xf6)]?.[_0x74969d(0x148)](_0x59de58,_0x74969d(0x20e)+_0xd72a5d+_0x74969d(0x214)+_0x74969d(0x22f),{'parse_mode':'Markdown'});return;}await database_1['default'][_0x74969d(0x167)][_0x74969d(0x207)]({'where':{'telegramId':_0x128c0b},'data':{'shopId':_0x497fba['id'],'isVerified':!![]}}),await this[_0x74969d(0xf6)]?.['sendMessage'](_0x59de58,'ðŸŽ‰\x20*Congratulations!*\x0a\x0a'+'âœ…\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a'+(_0x74969d(0xf2)+_0x497fba[_0x74969d(0x1f3)]+'*\x0a')+(_0x74969d(0x197)+_0x497fba[_0x74969d(0x237)]+'`\x0a\x0a')+_0x74969d(0x182)+_0x74969d(0x111)+'â€¢\x20Payment\x20status\x20changes\x0a'+_0x74969d(0x1ab)+_0x74969d(0x19e),{'parse_mode':_0x74969d(0x139),'reply_markup':{'inline_keyboard':[[{'text':'ðŸ“Š\x20Statistics','callback_data':_0x74969d(0x10f)},{'text':_0x74969d(0x1be),'callback_data':_0x74969d(0xef)}],[{'text':_0x74969d(0x1ea),'callback_data':_0x74969d(0x1ae)},{'text':_0x74969d(0x155),'callback_data':'cmd_status'}],[{'text':_0x74969d(0x9d),'callback_data':_0x74969d(0x129)},{'text':'ðŸ”Œ\x20Disconnect','callback_data':_0x74969d(0x1d3)}]]}}),console['log']('âœ…\x20Telegram\x20user\x20'+_0x128c0b+_0x74969d(0xd3)+_0x497fba[_0x74969d(0x237)]+_0x74969d(0x10e));}catch(_0x10d8f8){console[_0x74969d(0xea)](_0x74969d(0xeb),_0x10d8f8),await this[_0x74969d(0xf6)]?.['sendMessage'](_0x59de58,'âŒ\x20An\x20error\x20occurred\x20while\x20verifying\x20data.');}}async[a87_0xedbd06(0x151)](_0x3c2a48,_0x3cd50c,_0x53f84b){const _0x1ec96c=a87_0xedbd06;if(!this[_0x1ec96c(0xf6)]){console[_0x1ec96c(0x1d5)](_0x1ec96c(0x19d));return;}try{const _0x4cab6c=await database_1[_0x1ec96c(0x186)][_0x1ec96c(0x167)][_0x1ec96c(0x231)]({'where':{'shopId':_0x3c2a48,'isVerified':!![]}});if(_0x4cab6c[_0x1ec96c(0x1d1)]===0x0){console[_0x1ec96c(0x189)](_0x1ec96c(0xcd)+_0x3c2a48);return;}const _0x58e5ab=_0x4cab6c[_0x1ec96c(0x18f)](async _0x391dd1=>{const _0x234f04=_0x1ec96c;try{await this[_0x234f04(0xf6)]?.[_0x234f04(0x148)](_0x391dd1['telegramId'],_0x3cd50c,_0x53f84b),console[_0x234f04(0x189)](_0x234f04(0x16e)+_0x391dd1['telegramId']);}catch(_0x37cf1b){console[_0x234f04(0xea)](_0x234f04(0x131)+_0x391dd1[_0x234f04(0x113)]+':',_0x37cf1b),_0x37cf1b instanceof Error&&(_0x37cf1b[_0x234f04(0x130)][_0x234f04(0x107)](_0x234f04(0x210))||_0x37cf1b['message'][_0x234f04(0x107)](_0x234f04(0x1b4))||_0x37cf1b[_0x234f04(0x130)]['includes'](_0x234f04(0x15f)))&&(await database_1[_0x234f04(0x186)][_0x234f04(0x167)][_0x234f04(0x207)]({'where':{'id':_0x391dd1['id']},'data':{'isVerified':![]}}),console['log']('User\x20'+_0x391dd1[_0x234f04(0x113)]+'\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure'));}});await Promise[_0x1ec96c(0xdf)](_0x58e5ab);}catch(_0x49fa17){console['error']('Error\x20sending\x20shop\x20notification:',_0x49fa17);}}async['sendPaymentNotification'](_0x1d6f4c,_0x19c1a9,_0x151ded){const _0x30674e=a87_0xedbd06,_0x434f1c={'created':'ðŸ†•','paid':'âœ…','failed':'âŒ','expired':'â°','refund':'ðŸ”„','chargeback':'âš ï¸','processing':'âš™ï¸'},_0x4965fc={'created':_0x30674e(0xb6),'paid':_0x30674e(0xca),'failed':_0x30674e(0xa6),'expired':_0x30674e(0x196),'refund':_0x30674e(0x1ff),'chargeback':'Payment\x20chargeback','processing':_0x30674e(0x240)},_0x20fc45=_0x434f1c[_0x151ded],_0x4dbfc4=_0x4965fc[_0x151ded],_0x8a0266=(0x0,gateway_1[_0x30674e(0x14c)])(_0x19c1a9['gateway']);console[_0x30674e(0x189)](_0x30674e(0x1fc)+_0x19c1a9[_0x30674e(0x104)]+'\x22\x20->\x20display\x20\x22'+_0x8a0266+'\x22');let _0x1666db=_0x20fc45+'\x20*'+_0x4dbfc4+_0x30674e(0xb2)+(_0x30674e(0x23a)+_0x19c1a9[_0x30674e(0xb3)]+'\x20'+_0x19c1a9['currency']+'*\x0a')+(_0x30674e(0x140)+(_0x19c1a9[_0x30674e(0x22c)]||_0x19c1a9['id'])+'`\x0a')+('ðŸ†”\x20Payment\x20ID:\x20`'+_0x19c1a9['id']+'`\x0a')+(_0x30674e(0x164)+_0x8a0266+'`\x0a')+(_0x30674e(0x183)+new Date(_0x19c1a9[_0x30674e(0x13d)])['toLocaleString'](_0x30674e(0xf1))+'\x0a');if(_0x19c1a9['customerName']||_0x19c1a9[_0x30674e(0x1e6)]||_0x19c1a9['remitterIban']||_0x19c1a9[_0x30674e(0x1ef)]||_0x19c1a9['customerUa']){_0x1666db+=_0x30674e(0x209);_0x19c1a9[_0x30674e(0x1f7)]&&(_0x1666db+=_0x30674e(0x135)+_0x19c1a9[_0x30674e(0x1f7)]+'`\x0a');_0x19c1a9[_0x30674e(0x1e6)]&&(_0x1666db+='ðŸ“§\x20Email:\x20`'+_0x19c1a9[_0x30674e(0x1e6)]+'`\x0a');_0x19c1a9['remitterIban']&&(_0x1666db+=_0x30674e(0x173)+_0x19c1a9[_0x30674e(0x1ac)]+'`\x0a');_0x19c1a9[_0x30674e(0x1ef)]&&(_0x1666db+=_0x30674e(0x145)+_0x19c1a9['customerIp']+'`\x0a');if(_0x19c1a9[_0x30674e(0x9e)]){const _0x41e833=_0x19c1a9[_0x30674e(0x9e)][_0x30674e(0x1d1)]>0x32?_0x19c1a9[_0x30674e(0x9e)]['substring'](0x0,0x32)+_0x30674e(0x11f):_0x19c1a9[_0x30674e(0x9e)];_0x1666db+='ðŸ’»\x20Browser:\x20`'+_0x41e833+'`\x0a';}}_0x151ded==='chargeback'&&_0x19c1a9[_0x30674e(0x1df)]&&(_0x1666db+=_0x30674e(0x192)+_0x19c1a9['chargebackAmount']+_0x30674e(0x22b)),_0x151ded===_0x30674e(0x118)&&(_0x1666db+=_0x30674e(0x1cb)),_0x19c1a9[_0x30674e(0x23c)]&&(_0x1666db+=_0x30674e(0x1b5)+_0x19c1a9[_0x30674e(0x23c)]+'\x0a'),await this['sendShopNotification'](_0x1d6f4c,_0x1666db,{'parse_mode':_0x30674e(0x139)});}async[a87_0xedbd06(0x144)](_0x232b95,_0x5b0eda){const _0x2a2edd=a87_0xedbd06,_0x2b4597=new Date(_0x5b0eda['createdAt'])['toLocaleString']('en-US',{'year':_0x2a2edd(0xd0),'month':'2-digit','day':_0x2a2edd(0x14a),'hour':'2-digit','minute':_0x2a2edd(0x14a),'second':_0x2a2edd(0x14a)}),_0x3b2b6a=_0x2a2edd(0x1dd)+(_0x2a2edd(0x172)+_0x2b4597+'\x0a')+(_0x2a2edd(0x119)+_0x5b0eda['amount']+_0x2a2edd(0x1c2))+('â±ï¸\x20*Period:*\x20'+(_0x5b0eda[_0x2a2edd(0x18b)]||_0x2a2edd(0x179))+'\x0a')+(_0x2a2edd(0x16d)+(_0x5b0eda[_0x2a2edd(0x17a)]||_0x2a2edd(0x179))+'\x0a')+(_0x2a2edd(0xf5)+(_0x5b0eda[_0x2a2edd(0x1fe)]||'Not\x20specified')+'`\x0a')+(_0x5b0eda[_0x2a2edd(0x212)]?'ðŸ”—\x20*Transaction\x20Link:*\x20`'+_0x5b0eda[_0x2a2edd(0x212)]+'`':'ðŸ”—\x20*Transaction\x20Link:*\x20Pending');await this[_0x2a2edd(0x151)](_0x232b95,_0x3b2b6a,{'parse_mode':_0x2a2edd(0x139)});}async[a87_0xedbd06(0xc7)](_0x220250,_0x5f5a1b){const _0x5029a5=a87_0xedbd06;try{const _0x10e1a1=await database_1['default'][_0x5029a5(0x242)][_0x5029a5(0xce)]({'where':{'shopId':_0x220250},'select':{'notificationLogin':!![]}});if(!_0x10e1a1?.[_0x5029a5(0x149)]){console['log'](_0x5029a5(0x1d2)+_0x220250);return;}const _0x2f50a9=_0x5f5a1b['success']?'ðŸ”':'ðŸš¨',_0x48d606=_0x5f5a1b[_0x5029a5(0x14e)]?'Successful\x20login':_0x5029a5(0x211);let _0x1b3db3=_0x2f50a9+'\x20*'+_0x48d606+_0x5029a5(0xb2)+(_0x5029a5(0x197)+_0x5f5a1b['username']+'`\x0a')+(_0x5029a5(0x1e8)+_0x5f5a1b[_0x5029a5(0x142)][_0x5029a5(0xf8)]('en-US')+'\x0a');_0x5f5a1b['ipAddress']&&(_0x1b3db3+=_0x5029a5(0x22d)+_0x5f5a1b[_0x5029a5(0x1f0)]+'`\x0a');_0x5f5a1b[_0x5029a5(0x141)]&&(_0x1b3db3+='ðŸŒ\x20Country:\x20'+_0x5f5a1b[_0x5029a5(0x141)]+'\x0a');if(_0x5f5a1b['userAgent']){const _0x16cf53=_0x5f5a1b[_0x5029a5(0x1c1)][_0x5029a5(0x1d1)]>0x32?_0x5f5a1b[_0x5029a5(0x1c1)][_0x5029a5(0x13a)](0x0,0x32)+'...':_0x5f5a1b[_0x5029a5(0x1c1)];_0x1b3db3+=_0x5029a5(0xab)+_0x16cf53+'`\x0a';}!_0x5f5a1b[_0x5029a5(0x14e)]&&(_0x1b3db3+='\x0aâš ï¸\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!'),await this[_0x5029a5(0x151)](_0x220250,_0x1b3db3,{'parse_mode':_0x5029a5(0x139)}),console['log'](_0x5029a5(0x1d0)+_0x220250+':\x20'+(_0x5f5a1b[_0x5029a5(0x14e)]?_0x5029a5(0x14e):'failed'));}catch(_0x30ca6d){console['error'](_0x5029a5(0x11c),_0x30ca6d);}}async[a87_0xedbd06(0x220)](_0xde183e,_0xac4a30){const _0x4bdbf9=a87_0xedbd06;try{const _0x37d7fb=await database_1['default'][_0x4bdbf9(0x242)][_0x4bdbf9(0xce)]({'where':{'shopId':_0xde183e},'select':{'notificationApiError':!![]}});if(!_0x37d7fb?.[_0x4bdbf9(0x20d)]){console['log'](_0x4bdbf9(0x221)+_0xde183e);return;}let _0x1b5b61=_0x4bdbf9(0x1e2)+('ðŸ”—\x20Endpoint:\x20`'+_0xac4a30['method']+'\x20'+_0xac4a30[_0x4bdbf9(0x1cf)]+'`\x0a')+(_0x4bdbf9(0x1e8)+_0xac4a30[_0x4bdbf9(0x142)][_0x4bdbf9(0xf8)](_0x4bdbf9(0xf1))+'\x0a');_0xac4a30[_0x4bdbf9(0x162)]&&(_0x1b5b61+='ðŸ“Š\x20Error\x20code:\x20`'+_0xac4a30['statusCode']+'`\x0a'),_0x1b5b61+='âŒ\x20Error:\x20`'+_0xac4a30[_0x4bdbf9(0x18d)]+'`\x0a',_0xac4a30[_0x4bdbf9(0xbc)]&&(_0x1b5b61+=_0x4bdbf9(0x150)+_0xac4a30[_0x4bdbf9(0xbc)]+'`\x0a'),_0x1b5b61+=_0x4bdbf9(0xdd),await this['sendShopNotification'](_0xde183e,_0x1b5b61,{'parse_mode':'Markdown'}),console['log'](_0x4bdbf9(0x239)+_0xde183e+':\x20'+_0xac4a30['endpoint']);}catch(_0x37c068){console[_0x4bdbf9(0xea)](_0x4bdbf9(0x1a9),_0x37c068);}}async['sendCustomNotification'](_0x4dae11,_0x94c999,_0x52815b){const _0x3fb542=a87_0xedbd06;let _0x1d797f=_0x3fb542(0x1ee)+_0x94c999+_0x3fb542(0xb2);for(const [_0x2f8661,_0x3ed099]of Object[_0x3fb542(0xe1)](_0x52815b)){_0x3ed099!==null&&_0x3ed099!==undefined&&(_0x1d797f+=_0x2f8661+':\x20`'+_0x3ed099+'`\x0a');}await this[_0x3fb542(0x151)](_0x4dae11,_0x1d797f,{'parse_mode':_0x3fb542(0x139)});}async['sendNotificationToAll'](_0x552524){const _0x2ab062=a87_0xedbd06;try{console[_0x2ab062(0x189)](_0x2ab062(0x18e)+_0x552524['substring'](0x0,0x32)+_0x2ab062(0x11f));const _0xac5984=await database_1[_0x2ab062(0x186)][_0x2ab062(0x167)][_0x2ab062(0x231)]({'select':{'telegramId':!![]}});if(_0xac5984[_0x2ab062(0x1d1)]===0x0){console[_0x2ab062(0x189)]('ðŸ“±\x20No\x20active\x20Telegram\x20users\x20found');return;}for(const _0x5b8691 of _0xac5984){try{await this[_0x2ab062(0xf6)]?.['sendMessage'](_0x5b8691['telegramId'],_0x552524,{'parse_mode':_0x2ab062(0x139)});}catch(_0x2df3a4){console['error'](_0x2ab062(0x114)+_0x5b8691[_0x2ab062(0x113)]+':',_0x2df3a4);}}console[_0x2ab062(0x189)](_0x2ab062(0x1f2)+_0xac5984['length']+'\x20users');}catch(_0x338917){console[_0x2ab062(0xea)](_0x2ab062(0x234),_0x338917);}}['getBotInfo'](){const _0x54c1d8=a87_0xedbd06;return{'isActive':!!this[_0x54c1d8(0xf6)],'username':this[_0x54c1d8(0xd8)]};}async[a87_0xedbd06(0xfe)](_0x1a326e,_0x1155cd,_0x197032,_0x195e96){const _0x17d051=a87_0xedbd06;try{if(!this[_0x17d051(0xf6)])return console[_0x17d051(0xea)](_0x17d051(0xd4)),![];const _0x5300a6=await database_1[_0x17d051(0x186)][_0x17d051(0x167)][_0x17d051(0x231)]({'where':{'shopId':_0x1a326e,'isVerified':!![]},'select':{'telegramId':!![]}});if(_0x5300a6[_0x17d051(0x1d1)]===0x0)return console[_0x17d051(0xea)](_0x17d051(0x17f)+_0x1a326e),![];let _0x19b735=0x0;for(const _0x1d81cc of _0x5300a6){try{await this['bot']['sendDocument'](_0x1d81cc['telegramId'],_0x1155cd,{},{'filename':_0x197032,'contentType':_0x197032[_0x17d051(0x1d7)](_0x17d051(0x13b))?_0x17d051(0x115):_0x197032['endsWith'](_0x17d051(0x177))||_0x197032['endsWith']('.jpeg')?_0x17d051(0x15b):_0x197032[_0x17d051(0x1d7)]('.pdf')?'application/pdf':_0x17d051(0x181)}),_0x195e96&&await this[_0x17d051(0xf6)][_0x17d051(0x148)](_0x1d81cc['telegramId'],_0x195e96),_0x19b735++;}catch(_0x59ed3a){console[_0x17d051(0xea)]('âŒ\x20Error\x20sending\x20file\x20to\x20user\x20'+_0x1d81cc['telegramId']+':',_0x59ed3a);}}return console[_0x17d051(0x189)]('âœ…\x20File\x20sent\x20to\x20'+_0x19b735+'/'+_0x5300a6[_0x17d051(0x1d1)]+_0x17d051(0xbf)+_0x1a326e+':\x20'+_0x197032),_0x19b735>0x0;}catch(_0x59aafb){return console[_0x17d051(0xea)]('âŒ\x20Error\x20sending\x20file\x20to\x20shop:',_0x59aafb),![];}}async[a87_0xedbd06(0x1ec)](_0x5be1f0,_0x1440be){const _0x520b59=a87_0xedbd06;try{if(!this['bot'])return console['error']('âŒ\x20Telegram\x20bot\x20not\x20initialized'),![];return await this[_0x520b59(0xf6)][_0x520b59(0x148)](_0x5be1f0,_0x1440be),console[_0x520b59(0x189)](_0x520b59(0x1bc)+_0x5be1f0),!![];}catch(_0x587681){return console[_0x520b59(0xea)](_0x520b59(0x138),_0x587681),![];}}async['sendDirectFile'](_0x3145e0,_0x1bde53,_0x5bf786,_0x56a71d){const _0x46afe5=a87_0xedbd06;try{if(!this[_0x46afe5(0xf6)])return console[_0x46afe5(0xea)]('âŒ\x20Telegram\x20bot\x20not\x20initialized'),![];return await this['bot'][_0x46afe5(0xa1)](_0x3145e0,_0x1bde53,{},{'filename':_0x5bf786,'contentType':_0x5bf786[_0x46afe5(0x1d7)]('.png')?_0x46afe5(0x115):_0x5bf786['endsWith']('.jpg')||_0x5bf786['endsWith']('.jpeg')?_0x46afe5(0x15b):_0x5bf786[_0x46afe5(0x1d7)](_0x46afe5(0x219))?_0x46afe5(0x21a):_0x46afe5(0x181)}),_0x56a71d&&await this['bot'][_0x46afe5(0x148)](_0x3145e0,_0x56a71d),console['log'](_0x46afe5(0x194)+_0x3145e0+':\x20'+_0x5bf786),!![];}catch(_0x20f963){return console[_0x46afe5(0xea)](_0x46afe5(0x188),_0x20f963),![];}}async['handlePaymentLinkFlow'](_0x33ccff,_0xa59507,_0x3afe3c,_0x2f85c4){const _0xa2e180=a87_0xedbd06,_0x45694c=this[_0xa2e180(0x14f)][_0xa2e180(0x190)](_0xa59507)||{};try{if(_0x3afe3c===_0xa2e180(0x23f)){this[_0xa2e180(0x14f)]['delete'](_0xa59507),await this['bot']?.['editMessageText']('âŒ\x20Cancelled.',{'chat_id':_0x33ccff,'message_id':_0x2f85c4});return;}if(_0x3afe3c===_0xa2e180(0x21f)){await this[_0xa2e180(0xb5)](_0x33ccff,_0xa59507,_0x2f85c4,0x1);return;}if(_0x3afe3c[_0xa2e180(0xc2)]('pl_page_')){const _0x33b9b9=parseInt(_0x3afe3c['replace'](_0xa2e180(0x19b),''));await this[_0xa2e180(0xb5)](_0x33ccff,_0xa59507,_0x2f85c4,_0x33b9b9);return;}if(_0x3afe3c===_0xa2e180(0xd5)){const _0x4c0256=await database_1[_0xa2e180(0x186)]['telegramUser']['findUnique']({'where':{'telegramId':_0xa59507},'include':{'shop':!![]}});if(!_0x4c0256?.[_0xa2e180(0x1af)]?.[_0xa2e180(0xb4)]){await this[_0xa2e180(0xf6)]?.[_0xa2e180(0x1a3)](_0xa2e180(0xdb),{'chat_id':_0x33ccff,'message_id':_0x2f85c4});return;}let _0x5acd8a;try{_0x5acd8a=JSON[_0xa2e180(0x19a)](_0x4c0256[_0xa2e180(0x1af)]['paymentGateways']);}catch{_0x5acd8a=_0x4c0256[_0xa2e180(0x1af)][_0xa2e180(0xb4)]['split'](',')[_0xa2e180(0x226)](_0xff7d67=>_0xff7d67['trim']());}if(_0x5acd8a['length']===0x0){await this['bot']?.[_0xa2e180(0x1a3)](_0xa2e180(0xd7),{'chat_id':_0x33ccff,'message_id':_0x2f85c4});return;}this[_0xa2e180(0x14f)][_0xa2e180(0x160)](_0xa59507,{'step':'gateway'});const _0x5395f7=_0x5acd8a[_0xa2e180(0x18f)](_0x583bd4=>{const _0x4d6def=_0xa2e180,_0x3594e6=Object[_0x4d6def(0x20f)](gateway_1[_0x4d6def(0x1a5)])[_0x4d6def(0xd2)](_0x16b61f=>gateway_1[_0x4d6def(0x1a5)][_0x16b61f]===_0x583bd4)||_0x583bd4;return[{'text':_0x4d6def(0x208)+_0x3594e6,'callback_data':_0x4d6def(0x165)+_0x3594e6}];});await this['bot']?.['editMessageText'](_0xa2e180(0xec),{'chat_id':_0x33ccff,'message_id':_0x2f85c4,'parse_mode':'Markdown','reply_markup':{'inline_keyboard':[..._0x5395f7,[{'text':_0xa2e180(0x1c3),'callback_data':_0xa2e180(0x23f)}]]}});return;}if(_0x3afe3c['startsWith'](_0xa2e180(0x165))){const _0x2198fb=_0x3afe3c[_0xa2e180(0x137)]('pl_gw_','');_0x45694c[_0xa2e180(0x104)]=_0x2198fb,_0x45694c[_0xa2e180(0x1e5)]=_0xa2e180(0x12c),this[_0xa2e180(0x14f)]['set'](_0xa59507,_0x45694c),await this[_0xa2e180(0xf6)]?.[_0xa2e180(0x1a3)](_0xa2e180(0x1c7)+_0xa2e180(0x1ba),{'chat_id':_0x33ccff,'message_id':_0x2f85c4,'parse_mode':_0xa2e180(0x139),'reply_markup':{'inline_keyboard':[[{'text':_0xa2e180(0x1fa),'callback_data':'pl_type_single'}],[{'text':_0xa2e180(0x1f9),'callback_data':_0xa2e180(0x18c)}],[{'text':'âŒ\x20Cancel','callback_data':'pl_cancel'}]]}});return;}if(_0x3afe3c['startsWith'](_0xa2e180(0x14b))){const _0x1325c8=_0x3afe3c[_0xa2e180(0x137)]('pl_type_','')[_0xa2e180(0x176)]();_0x45694c[_0xa2e180(0x12c)]=_0x1325c8,_0x45694c[_0xa2e180(0x1e5)]=_0xa2e180(0x1cc),this[_0xa2e180(0x14f)]['set'](_0xa59507,_0x45694c);const _0x8f15c8=this[_0xa2e180(0x12f)](_0x45694c[_0xa2e180(0x104)]),_0x288db5=_0x8f15c8[_0xa2e180(0x15a)](0x0,0x14)[_0xa2e180(0x18f)](_0x5b1a21=>[{'text':_0x5b1a21,'callback_data':'pl_curr_'+_0x5b1a21}]);await this[_0xa2e180(0xf6)]?.[_0xa2e180(0x1a3)](_0xa2e180(0x1c7)+'Step\x203/4:\x20Select\x20currency',{'chat_id':_0x33ccff,'message_id':_0x2f85c4,'parse_mode':'Markdown','reply_markup':{'inline_keyboard':[..._0x288db5,[{'text':_0xa2e180(0x1c3),'callback_data':_0xa2e180(0x23f)}]]}});return;}if(_0x3afe3c[_0xa2e180(0xc2)](_0xa2e180(0x1dc))){const _0x19721d=_0x3afe3c[_0xa2e180(0x137)](_0xa2e180(0x1dc),'');_0x45694c[_0xa2e180(0x1cc)]=_0x19721d,_0x45694c['step']=_0xa2e180(0xb3),this['paymentLinkSessions'][_0xa2e180(0x160)](_0xa59507,_0x45694c),await this[_0xa2e180(0xf6)]?.[_0xa2e180(0x1a3)]('ðŸ”—\x20*Create\x20Payment\x20Link*\x0a\x0a'+_0xa2e180(0x20a)+(_0xa2e180(0xed)+_0x19721d+_0xa2e180(0x1eb)),{'chat_id':_0x33ccff,'message_id':_0x2f85c4,'parse_mode':_0xa2e180(0x139)});return;}}catch(_0x168195){console['error'](_0xa2e180(0xe9),_0x168195),await this[_0xa2e180(0xf6)]?.[_0xa2e180(0x148)](_0x33ccff,_0xa2e180(0x1b7)),this[_0xa2e180(0x14f)][_0xa2e180(0x1ce)](_0xa59507);}}async[a87_0xedbd06(0xb5)](_0x4d496d,_0x3848ee,_0x21f263,_0xd7d4ca=0x1){const _0x2a5cd3=a87_0xedbd06;try{const _0x2daf98=await database_1['default'][_0x2a5cd3(0x167)]['findUnique']({'where':{'telegramId':_0x3848ee},'include':{'shop':!![]}});if(!_0x2daf98?.[_0x2a5cd3(0x21e)]){await this[_0x2a5cd3(0xf6)]?.[_0x2a5cd3(0x148)](_0x4d496d,'âŒ\x20Shop\x20not\x20found.');return;}const _0x52a400=0x5,_0x5ef12b=(_0xd7d4ca-0x1)*_0x52a400,[_0x531bf7,_0x23d38b]=await Promise[_0x2a5cd3(0xfc)]([database_1[_0x2a5cd3(0x186)]['paymentLink']['findMany']({'where':{'shopId':_0x2daf98[_0x2a5cd3(0x21e)]},'orderBy':{'createdAt':_0x2a5cd3(0x1b8)},'take':_0x52a400,'skip':_0x5ef12b}),database_1[_0x2a5cd3(0x186)][_0x2a5cd3(0x200)][_0x2a5cd3(0xfa)]({'where':{'shopId':_0x2daf98['shopId']}})]),_0x112718=Math[_0x2a5cd3(0x1db)](_0x23d38b/_0x52a400);if(_0x531bf7[_0x2a5cd3(0x1d1)]===0x0){const _0x30ada2='ðŸ“‹\x20*Payment\x20Links*\x0a\x0aNo\x20payment\x20links\x20found\x5c.\x0a\x0aCreate\x20your\x20first\x20payment\x20link\x5c!';_0x21f263?await this['bot']?.[_0x2a5cd3(0x1a3)](_0x30ada2,{'chat_id':_0x4d496d,'message_id':_0x21f263,'parse_mode':_0x2a5cd3(0x1ed),'reply_markup':{'inline_keyboard':[[{'text':_0x2a5cd3(0x125),'callback_data':'pl_create_new'}]]}}):await this[_0x2a5cd3(0xf6)]?.[_0x2a5cd3(0x148)](_0x4d496d,_0x30ada2,{'parse_mode':_0x2a5cd3(0x1ed),'reply_markup':{'inline_keyboard':[[{'text':_0x2a5cd3(0x125),'callback_data':_0x2a5cd3(0xd5)}]]}});return;}let _0x170f0d='ðŸ“‹\x20*Payment\x20Links*\x20\x5c(Page\x20'+_0xd7d4ca+'/'+_0x112718+'\x5c)\x0a\x0a';_0x531bf7[_0x2a5cd3(0xf9)]((_0x3dd3ca,_0x256bbc)=>{const _0x489ded=_0x2a5cd3,_0x3f5589=_0x5ef12b+_0x256bbc+0x1,_0xf878e8=_0x3dd3ca[_0x489ded(0xb3)]?_0x3dd3ca[_0x489ded(0xb3)]+'\x20'+_0x3dd3ca[_0x489ded(0x1cc)]:_0x489ded(0x105),_0x1751d3=_0x3dd3ca['status']===_0x489ded(0x161)?'âœ…':'âŒ',_0x306831=(process.env.FRONTEND_URL||_0x489ded(0x1de))+_0x489ded(0xb9)+_0x3dd3ca['id'],_0x2c1b80=_0x306831[_0x489ded(0x137)](/\./g,'\x5c.')[_0x489ded(0x137)](/-/g,'\x5c-')[_0x489ded(0x137)](/\//g,'\x5c/');_0x170f0d+=_0x3f5589+'\x5c.\x20'+_0x1751d3+'\x20*'+_0xf878e8+'*\x0a',_0x170f0d+=_0x489ded(0xfb)+_0x3dd3ca[_0x489ded(0x104)]+_0x489ded(0x100)+_0x3dd3ca[_0x489ded(0x12c)]+'\x0a',_0x170f0d+=_0x489ded(0x1bf)+_0x2c1b80+_0x489ded(0x20c);});const _0x46a3b1=[];_0xd7d4ca>0x1&&_0x46a3b1[_0x2a5cd3(0x13e)]({'text':_0x2a5cd3(0x9c),'callback_data':_0x2a5cd3(0x19b)+(_0xd7d4ca-0x1)});_0xd7d4ca<_0x112718&&_0x46a3b1[_0x2a5cd3(0x13e)]({'text':_0x2a5cd3(0x191),'callback_data':_0x2a5cd3(0x19b)+(_0xd7d4ca+0x1)});const _0x15144d=[];_0x46a3b1[_0x2a5cd3(0x1d1)]>0x0&&_0x15144d['push'](_0x46a3b1),_0x15144d[_0x2a5cd3(0x13e)]([{'text':_0x2a5cd3(0x125),'callback_data':'pl_create_new'}]),_0x15144d[_0x2a5cd3(0x13e)]([{'text':'âŒ\x20Close','callback_data':_0x2a5cd3(0x23f)}]),_0x21f263?await this['bot']?.[_0x2a5cd3(0x1a3)](_0x170f0d,{'chat_id':_0x4d496d,'message_id':_0x21f263,'parse_mode':'MarkdownV2','reply_markup':{'inline_keyboard':_0x15144d}}):await this[_0x2a5cd3(0xf6)]?.[_0x2a5cd3(0x148)](_0x4d496d,_0x170f0d,{'parse_mode':_0x2a5cd3(0x1ed),'reply_markup':{'inline_keyboard':_0x15144d}});}catch(_0x2621cc){console[_0x2a5cd3(0xea)](_0x2a5cd3(0x185),_0x2621cc),await this['bot']?.[_0x2a5cd3(0x148)](_0x4d496d,_0x2a5cd3(0x1a1));}}[a87_0xedbd06(0x12f)](_0x882a6){const _0x3ec226=a87_0xedbd06,_0x34b5fa={'1000':[_0x3ec226(0x136),'GBP',_0x3ec226(0xa5)],'0001':['USD','EUR','GBP',_0x3ec226(0x1f8),_0x3ec226(0x1b6)],'0010':['USD',_0x3ec226(0x136),_0x3ec226(0x228),_0x3ec226(0x1f8),_0x3ec226(0x1b6)],'1111':[_0x3ec226(0x136)],'0000':[_0x3ec226(0x136),_0x3ec226(0xa5),_0x3ec226(0x1b6),_0x3ec226(0x1f8),_0x3ec226(0x228),_0x3ec226(0x19f),'JPY'],'1110':[_0x3ec226(0x136),_0x3ec226(0xa5),_0x3ec226(0x228)],'2000':['EUR'],'2001':[_0x3ec226(0x136)],'2010':[_0x3ec226(0x136)],'2011':[_0x3ec226(0x1f8)],'2002':['TRY'],'3000':[_0x3ec226(0x233),_0x3ec226(0x20b),'EUR',_0x3ec226(0xa5),_0x3ec226(0x1b6),_0x3ec226(0x17d),_0x3ec226(0x16f),_0x3ec226(0x1f8),_0x3ec226(0x228),_0x3ec226(0x108),_0x3ec226(0x1a0)],'3001':['USD',_0x3ec226(0x136)],'3002':['EUR','USD',_0x3ec226(0x20b),_0x3ec226(0x228),_0x3ec226(0x1b6),_0x3ec226(0x1f8),_0x3ec226(0x1f5),_0x3ec226(0x1e7)],'3004':['USDT','BTC','ETH',_0x3ec226(0x109),_0x3ec226(0xcf),_0x3ec226(0x1a6),_0x3ec226(0xe6),_0x3ec226(0xb1),'SOL',_0x3ec226(0x1c9)]};return _0x34b5fa[_0x882a6]||[_0x3ec226(0xa5)];}async[a87_0xedbd06(0xaa)](_0x18b8b0,_0x17ebf3,_0x59c447,_0x160a2b){const _0x5f03df=a87_0xedbd06;try{const _0x29411b=new Date();let _0x2799a2,_0x2cd4a8,_0x2c6120;switch(_0x59c447){case _0x5f03df(0x12b):{const _0x2dbeea=new Date(Date[_0x5f03df(0x11a)](_0x29411b[_0x5f03df(0xd1)](),_0x29411b[_0x5f03df(0x227)](),_0x29411b[_0x5f03df(0x10d)]()));_0x2799a2=_0x2dbeea,_0x2cd4a8=new Date(Date[_0x5f03df(0x11a)](_0x29411b[_0x5f03df(0xd1)](),_0x29411b[_0x5f03df(0x227)](),_0x29411b[_0x5f03df(0x10d)](),0x17,0x3b,0x3b,0x3e7)),_0x2c6120=_0x2dbeea['getUTCDate']()[_0x5f03df(0x14d)]()['padStart'](0x2,'0')+'.'+(_0x2dbeea['getUTCMonth']()+0x1)[_0x5f03df(0x14d)]()['padStart'](0x2,'0')+'.'+_0x2dbeea['getUTCFullYear']();break;}case _0x5f03df(0x153):{const _0x162c5c=new Date(Date['UTC'](_0x29411b['getUTCFullYear'](),_0x29411b[_0x5f03df(0x227)](),_0x29411b[_0x5f03df(0x10d)]()-0x1));_0x2799a2=_0x162c5c,_0x2cd4a8=new Date(Date[_0x5f03df(0x11a)](_0x29411b['getUTCFullYear'](),_0x29411b['getUTCMonth'](),_0x29411b['getUTCDate']()-0x1,0x17,0x3b,0x3b,0x3e7)),_0x2c6120=_0x162c5c[_0x5f03df(0x10d)]()[_0x5f03df(0x14d)]()[_0x5f03df(0x169)](0x2,'0')+'.'+(_0x162c5c[_0x5f03df(0x227)]()+0x1)[_0x5f03df(0x14d)]()['padStart'](0x2,'0')+'.'+_0x162c5c[_0x5f03df(0xd1)]();break;}case'stats_this_month':{const _0x393b6c=new Date(Date[_0x5f03df(0x11a)](_0x29411b[_0x5f03df(0xd1)](),_0x29411b[_0x5f03df(0x227)](),0x1));_0x2799a2=_0x393b6c,_0x2cd4a8=new Date(Date['UTC'](_0x29411b['getUTCFullYear'](),_0x29411b[_0x5f03df(0x227)]()+0x1,0x0,0x17,0x3b,0x3b,0x3e7));const _0x3c9146=new Date(Date[_0x5f03df(0x11a)](_0x29411b[_0x5f03df(0xd1)](),_0x29411b[_0x5f03df(0x227)]()+0x1,0x0));_0x2c6120=_0x393b6c[_0x5f03df(0x10d)]()['toString']()['padStart'](0x2,'0')+'.'+(_0x393b6c['getUTCMonth']()+0x1)['toString']()[_0x5f03df(0x169)](0x2,'0')+'.'+_0x393b6c[_0x5f03df(0xd1)]()+_0x5f03df(0x102)+_0x3c9146[_0x5f03df(0x10d)]()[_0x5f03df(0x14d)]()[_0x5f03df(0x169)](0x2,'0')+'.'+(_0x3c9146[_0x5f03df(0x227)]()+0x1)['toString']()[_0x5f03df(0x169)](0x2,'0')+'.'+_0x3c9146[_0x5f03df(0xd1)]();break;}case _0x5f03df(0x1a2):{const _0x1e65ca=new Date(Date['UTC'](_0x29411b[_0x5f03df(0xd1)](),_0x29411b[_0x5f03df(0x227)]()-0x1,0x1));_0x2799a2=_0x1e65ca,_0x2cd4a8=new Date(Date[_0x5f03df(0x11a)](_0x29411b[_0x5f03df(0xd1)](),_0x29411b[_0x5f03df(0x227)](),0x0,0x17,0x3b,0x3b,0x3e7));const _0x5de672=new Date(Date['UTC'](_0x29411b['getUTCFullYear'](),_0x29411b[_0x5f03df(0x227)](),0x0));_0x2c6120=_0x1e65ca['getUTCDate']()[_0x5f03df(0x14d)]()[_0x5f03df(0x169)](0x2,'0')+'.'+(_0x1e65ca[_0x5f03df(0x227)]()+0x1)['toString']()[_0x5f03df(0x169)](0x2,'0')+'.'+_0x1e65ca[_0x5f03df(0xd1)]()+_0x5f03df(0x102)+_0x5de672[_0x5f03df(0x10d)]()[_0x5f03df(0x14d)]()['padStart'](0x2,'0')+'.'+(_0x5de672['getUTCMonth']()+0x1)[_0x5f03df(0x14d)]()['padStart'](0x2,'0')+'.'+_0x5de672[_0x5f03df(0xd1)]();break;}case _0x5f03df(0x224):{_0x2799a2=new Date(0x0),_0x2cd4a8=_0x29411b,_0x2c6120=_0x5f03df(0x12d);break;}default:return;}const _0x8a262d=await database_1[_0x5f03df(0x186)]['payment'][_0x5f03df(0x231)]({'where':{'shopId':_0x17ebf3,'createdAt':{'gte':_0x2799a2,'lte':_0x2cd4a8}},'select':{'status':!![],'amountUSDT':!![],'amountAfterGatewayCommissionUSDT':!![]}});let _0x5e5210=0x0,_0x4dcbe0=0x0,_0x2a1726=0x0,_0x5d7113=0x0,_0x2badaf=0x0,_0x3ac70c=0x0;_0x8a262d[_0x5f03df(0xf9)](_0x34b5c5=>{const _0x76a67a=_0x5f03df,_0x3e0378=_0x34b5c5[_0x76a67a(0x23d)]||0x0,_0x1ee6ad=_0x34b5c5[_0x76a67a(0x1f4)]||0x0;if(_0x34b5c5['status']===_0x76a67a(0x128))_0x5e5210+=_0x3e0378,_0x4dcbe0+=_0x3e0378-_0x1ee6ad,_0x2a1726++;else{if(_0x34b5c5[_0x76a67a(0x1e4)]===_0x76a67a(0xdc)||_0x34b5c5[_0x76a67a(0x1e4)]===_0x76a67a(0x122))_0x5d7113++;else{if(_0x34b5c5[_0x76a67a(0x1e4)]==='CHARGEBACK')_0x2badaf++,_0x5e5210+=_0x3e0378;else _0x34b5c5[_0x76a67a(0x1e4)]===_0x76a67a(0xba)&&(_0x3ac70c++,_0x5e5210+=_0x3e0378);}}});const _0x4469f2=_0x2a1726+_0x5d7113,_0x3b0053=_0x4469f2>0x0?(_0x2a1726/_0x4469f2*0x64)[_0x5f03df(0x1a8)](0x1):_0x5f03df(0x21d),_0x51643c=_0x2c6120[_0x5f03df(0x137)](/\./g,'\x5c.')[_0x5f03df(0x137)](/\-/g,'\x5c-'),_0x101124=_0x5e5210[_0x5f03df(0x1a8)](0x2)[_0x5f03df(0x137)](/\./g,'\x5c.'),_0x3643c9=_0x4dcbe0[_0x5f03df(0x1a8)](0x2)[_0x5f03df(0x137)](/\./g,'\x5c.'),_0x3d5abb=_0x3b0053[_0x5f03df(0x137)](/\./g,'\x5c.'),_0x129aac='ðŸ“Š\x20*Statistics:\x20'+_0x51643c+_0x5f03df(0xb2)+(_0x5f03df(0x215)+_0x101124+_0x5f03df(0x11d))+(_0x5f03df(0x1b2)+_0x3643c9+_0x5f03df(0x11d))+(_0x5f03df(0x222)+_0x2a1726+'\x0a')+(_0x5f03df(0x9f)+_0x5d7113+'\x0a')+(_0x5f03df(0xc0)+_0x3d5abb+'%\x0a')+(_0x5f03df(0xa3)+_0x2badaf+'\x0a')+(_0x5f03df(0x154)+_0x3ac70c),_0x3b2544={'inline_keyboard':[[{'text':'â¬…ï¸\x20Back','callback_data':'back_to_stats_menu'}]]};_0x160a2b?await this[_0x5f03df(0xf6)]?.[_0x5f03df(0x1a3)](_0x129aac,{'chat_id':_0x18b8b0,'message_id':_0x160a2b,'parse_mode':_0x5f03df(0x1ed),'reply_markup':_0x3b2544}):await this[_0x5f03df(0xf6)]?.[_0x5f03df(0x148)](_0x18b8b0,_0x129aac,{'parse_mode':'MarkdownV2','reply_markup':_0x3b2544});}catch(_0x3296d8){console[_0x5f03df(0xea)](_0x5f03df(0x21c),_0x3296d8),await this[_0x5f03df(0xf6)]?.[_0x5f03df(0x148)](_0x18b8b0,'âŒ\x20Error\x20getting\x20statistics');}}['stopBot'](){const _0x84ee70=a87_0xedbd06;this[_0x84ee70(0xf6)]&&(this[_0x84ee70(0xf6)][_0x84ee70(0xde)](),this[_0x84ee70(0xf6)]=null,console[_0x84ee70(0x189)](_0x84ee70(0x213)));}}exports[a87_0xedbd06(0x11e)]=TelegramBotService,exports['telegramBotService']=new TelegramBotService();