'use strict';function a83_0x5b7e(_0x494ef2,_0x2f3502){_0x494ef2=_0x494ef2-0x162;const _0x438dd8=a83_0x438d();let _0x5b7ec9=_0x438dd8[_0x494ef2];return _0x5b7ec9;}function a83_0x438d(){const _0x2ebd94=['84swYVJu','‚ùå\x20You\x20are\x20not\x20connected\x20to\x20any\x20shop.\x0a\x0a','Error\x20handling\x20message:','createdAt','Use\x20/status\x20to\x20check\x20status\x20or\x20/disconnect\x20to\x20disconnect.','‚ùå\x20Invalid\x20username\x20format:\x20`','‚ùå\x20An\x20error\x20occurred\x20while\x20verifying\x20data.','üîÑ\x20Processing\x20single-line\x20verification\x20for\x20user\x20','‚ùå\x20Please\x20use\x20/start\x20command\x20first','toLocaleString','update','Use\x20/start\x20to\x20begin.','\x20(@','publicKey','*.\x0a\x0a','Contact\x20administrator.','üè™\x20Your\x20connected\x20shop:\x0a','sendMessage',':\x20`','üéâ\x20*Congratulations!*\x0a\x0a','üîî\x20Notifications\x20are\x20active\x0a\x0a','customerUa','image/jpeg','toString','‚ùå\x20Shop\x20`','application/octet-stream','.png','chat\x20not\x20found','üìß\x20Email:\x20`','en-US','‚ùå\x20Failed\x20to\x20send\x20message\x20to\x20user\x20','userAgent','Telegram\x20bot\x20not\x20initialized,\x20cannot\x20send\x20notification','Error\x20handling\x20/status\x20command:','Payment\x20is\x20being\x20processed','.jpg','setupBotHandlers','31686OSiKav','üö®\x20*API\x20Error*\x0a\x0a','‚úÖ\x20Connected\x20to\x20shop:\x20*','üîó\x20Endpoint:\x20`','Make\x20sure\x20you\x20have\x20the\x20correct\x20username\x20from\x20your\x20account.',':\x20username=\x22','error','botUsername','‚ùå\x20Error:\x20`','\x20marked\x20as\x20unverified\x20due\x20to\x20delivery\x20failure','isVerified','Payment\x20chargeback','map','\x20\x20\x20Username:\x20`','üÜî\x20Request\x20ID:\x20`','TELEGRAM_BOT_TOKEN\x20not\x20found\x20in\x20environment\x20variables','üîî\x20You\x20will\x20now\x20receive\x20notifications\x20about:\x0a','...','üì±\x20Created\x20new\x20Telegram\x20user:\x20','shopSettings','sendApiErrorNotification','geo','\x20users\x20of\x20shop\x20','length','shopId','\x22\x20->\x20display\x20\x22','toLocaleDateString','Expected\x20key\x20format:\x20`pk_...`\x20or\x20`sk_...`','unknown\x20shop','status','\x0a‚ö†Ô∏è\x20If\x20this\x20wasn\x27t\x20you,\x20change\x20your\x20password\x20immediately!','node-telegram-bot-api','‚ùå\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.','2-digit','__importDefault','bot','\x20\x20\x20Name:\x20*','Payment\x20failed','trim','Use\x20/start\x20to\x20connect\x20to\x20a\x20shop.','defineProperty','Error\x20handling\x20/disconnect\x20command:','shop','../config/database','‚ùå\x20Maximum\x20number\x20of\x20connected\x20accounts\x20(5)\x20reached\x20for\x20shop\x20`','‚úÖ\x20Telegram\x20bot\x20@','stopBot','üìÖ\x20Time:\x20','substring','notificationLogin','`\x20not\x20found.\x0a\x0a','‚ùå\x20API\x20key\x20does\x20not\x20match\x20shop\x20`','‚Ä¢\x20New\x20payments\x0a','sendShopFile','‚úÖ\x20File\x20sent\x20to\x20','adminNotes','üí≥\x20*Wallet:*\x20`','üîó\x20*Transaction\x20Link:*\x20Pending','test','default','üí∞\x20Amount:\x20*','üìÖ\x20Date:\x20','ü§ñ\x20Welcome\x20to\x20TRAPAY\x20notification\x20system!\x0a\x0a','üè™\x20Gateway:\x20`','log','‚ùå\x20Error\x20sending\x20direct\x20message:','TelegramBotService','‚ùå\x20Error\x20getting\x20debug\x20information.','Payment\x20successfully\x20paid','629247VWORVY','notificationApiError','includes','No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20','*\x0a\x0a','662760rTXTkj','Failed\x20to\x20send\x20login\x20notification:','üì±\x20API\x20error\x20notifications\x20disabled\x20for\x20shop\x20','\x20verified\x20for\x20shop\x20','warn','join','pk_','findUnique','Username\x20must\x20contain\x20only\x20letters,\x20numbers\x20and\x20underscore\x20(3-50\x20characters).','üí∞\x20*Amount:*\x20','.pdf','Error\x20in\x20handleSingleLineVerification:','sendShopNotification','handleSingleLineVerification','../types/gateway','‚úÖ\x20You\x20have\x20been\x20successfully\x20disconnected\x20from\x20shop\x20*','‚ùå\x20Telegram\x20bot\x20not\x20initialized','getGatewayDisplayNameForTelegram','application/pdf','üîó\x20*Transaction\x20Link:*\x20`','startsWith','endpoint','üìù\x20Format:\x20`username\x20api_key`\x0a\x0a','To\x20receive\x20payment\x20notifications,\x20send\x20your\x20credentials\x20in\x20one\x20line:\x0a\x0a','343090WZDUJd','processing','username','üìù\x20Notes:\x20','message','Commands:\x0a','üìä\x20*Connection\x20Status*\x0a\x0a','‚ùå\x20Failed\x20to\x20send\x20notification\x20to\x20Telegram\x20user\x20','ACTIVE','txid','New\x20payment\x20created','üìÖ\x20Connection\x20date:\x20','\x0aüë§\x20*Customer\x20Information:*\x0a','Payment\x20expired','remitterIban','sendDocument','stopPolling','onText','‚Ä¢\x20Important\x20events\x0a\x0a','chat','Not\x20specified','User\x20','‚úÖ\x20Telegram\x20user\x20','üè¶\x20IBAN:\x20`','customerIp','initializeBot','last_name','Error\x20sending\x20shop\x20notification:','telegramUser','.jpeg','‚ùå\x20Shop\x20with\x20username\x20`','üì±\x20Notification\x20sent\x20to\x20','sendDirectMessage','\x0aüí°\x20Check\x20your\x20request\x20or\x20contact\x20support.','üìù\x20Order\x20ID:\x20`','‚ùå\x20Error\x20sending\x20file\x20to\x20chat:','‚è±Ô∏è\x20*Period:*\x20','currency','10038lweVoK','/status\x20-\x20check\x20connection\x20status\x0a','secretKey','üîî\x20*','‚úÖ\x20You\x20are\x20already\x20connected\x20to\x20shop\x20*','requestId','botToken','__esModule','27kQEQod','split','sendCustomNotification','findMany','image/png','network','‚úÖ\x20Login\x20notification\x20sent\x20for\x20shop\x20','allSettled','üåç\x20Country:\x20','telegramId','Disconnect\x20one\x20of\x20the\x20existing\x20accounts\x20first.','üìÖ\x20*Payout\x20Date:*\x20','2254752dPCzfL','chargebackAmount','üíª\x20Browser:\x20`','Failed\x20login\x20attempt','‚ùå\x20No\x20verified\x20Telegram\x20users\x20found\x20for\x20shop\x20ID:\x20','Username:\x20`','timestamp','Use\x20/start\x20to\x20connect.','üîî\x20You\x20receive\x20notifications\x20about:\x0a','...\x22','\x20USD\x0a','Payment\x20refund','‚ùóÔ∏è\x20Make\x20sure\x20to\x20separate\x20username\x20and\x20API\x20key\x20with\x20a\x20space!','period','Failed\x20to\x20send\x20API\x20error\x20notification:','üîå\x20User\x20','sendLoginNotification','‚ùå\x20Failed\x20to\x20send\x20notification\x20to\x20all\x20users:','from','üì±\x20Telegram\x20notification:\x20gateway\x20\x22','Markdown','\x20initialized\x20successfully','sendPayoutNotification','‚ùå\x20Invalid\x20format.\x20Please\x20send\x20exactly\x202\x20parts\x20separated\x20by\x20space:\x0a\x0a','üåê\x20IP\x20address:\x20`','Telegram\x20bot\x20polling\x20error:','üõë\x20Telegram\x20bot\x20stopped','errorMessage','create','customerEmail','updatedAt','text','user\x20is\x20deactivated','ipAddress','endsWith','Telegram\x20bot\x20error:','`\x20is\x20inactive.\x0a\x0a','/disconnect\x20-\x20disconnect\x20from\x20notifications','\x20via\x20single-line\x20input','\x20parts:\x20','failed','gateway','`\x0a\x0a','amount','telegramBotService','To\x20reconnect,\x20use\x20the\x20/start\x20command','üí∏\x20Penalty\x20amount:\x20*','You\x20are\x20already\x20connected\x20to\x20shop:\x20*','orderId','name','1085928eTSPwm','üåê\x20IP:\x20`','‚Ä¢\x20Payment\x20status\x20changes\x0a','method','üìä\x20Error\x20code:\x20`','success','üë§\x20Username:\x20`','statusCode','blocked','trapay_bot'];a83_0x438d=function(){return _0x2ebd94;};return a83_0x438d();}const a83_0x1644d6=a83_0x5b7e;(function(_0xf2efc8,_0x1c4281){const _0x1f9fa5=a83_0x5b7e,_0x1476d2=_0xf2efc8();while(!![]){try{const _0x186a01=-parseInt(_0x1f9fa5(0x241))/0x1*(parseInt(_0x1f9fa5(0x239))/0x2)+parseInt(_0x1f9fa5(0x1f6))/0x3+parseInt(_0x1f9fa5(0x182))/0x4+parseInt(_0x1f9fa5(0x213))/0x5+-parseInt(_0x1f9fa5(0x1b1))/0x6*(-parseInt(_0x1f9fa5(0x18c))/0x7)+-parseInt(_0x1f9fa5(0x1fb))/0x8+-parseInt(_0x1f9fa5(0x24d))/0x9;if(_0x186a01===_0x1c4281)break;else _0x1476d2['push'](_0x1476d2['shift']());}catch(_0x49d2db){_0x1476d2['push'](_0x1476d2['shift']());}}}(a83_0x438d,0x233cf));var __importDefault=this&&this[a83_0x1644d6(0x1d3)]||function(_0x3073d3){const _0x490592=a83_0x1644d6;return _0x3073d3&&_0x3073d3[_0x490592(0x240)]?_0x3073d3:{'default':_0x3073d3};};Object[a83_0x1644d6(0x1d9)](exports,a83_0x1644d6(0x240),{'value':!![]}),exports['telegramBotService']=exports[a83_0x1644d6(0x1f3)]=void 0x0;const node_telegram_bot_api_1=__importDefault(require(a83_0x1644d6(0x1d0))),database_1=__importDefault(require(a83_0x1644d6(0x1dc))),gateway_1=require(a83_0x1644d6(0x209));class TelegramBotService{constructor(){const _0x40509b=a83_0x1644d6;this[_0x40509b(0x1d4)]=null,this[_0x40509b(0x23f)]=process.env.TELEGRAM_BOT_TOKEN||'',this[_0x40509b(0x1b8)]=process.env.TELEGRAM_BOT_USERNAME||_0x40509b(0x18b),this[_0x40509b(0x23f)]?this[_0x40509b(0x22c)]():console[_0x40509b(0x1ff)](_0x40509b(0x1c0));}[a83_0x1644d6(0x22c)](){const _0x540614=a83_0x1644d6;try{this['bot']=new node_telegram_bot_api_1[(_0x540614(0x1ec))](this[_0x540614(0x23f)],{'polling':!![]}),this[_0x540614(0x1b0)](),console[_0x540614(0x1f1)](_0x540614(0x1de)+this[_0x540614(0x1b8)]+_0x540614(0x165));}catch(_0x270b39){console[_0x540614(0x1b7)]('‚ùå\x20Failed\x20to\x20initialize\x20Telegram\x20bot:',_0x270b39);}}['setupBotHandlers'](){const _0x5bc975=a83_0x1644d6;if(!this['bot'])return;this[_0x5bc975(0x1d4)][_0x5bc975(0x224)](/\/start/,async _0x24c18f=>{const _0x37be7c=_0x5bc975,_0x42584a=_0x24c18f[_0x37be7c(0x226)]['id'],_0x554afc=_0x24c18f[_0x37be7c(0x162)]?.['id'][_0x37be7c(0x1a3)](),_0xc82e17=_0x24c18f[_0x37be7c(0x162)]?.[_0x37be7c(0x215)],_0x19576c=_0x24c18f[_0x37be7c(0x162)]?.['first_name'],_0x1e0e7c=_0x24c18f[_0x37be7c(0x162)]?.[_0x37be7c(0x22d)];if(!_0x554afc)return;try{let _0x1fb2eb=await database_1['default'][_0x37be7c(0x22f)][_0x37be7c(0x202)]({'where':{'telegramId':_0x554afc},'include':{'shop':!![]}});!_0x1fb2eb?(_0x1fb2eb=await database_1[_0x37be7c(0x1ec)]['telegramUser'][_0x37be7c(0x16c)]({'data':{'telegramId':_0x554afc,'username':_0xc82e17,'firstName':_0x19576c,'lastName':_0x1e0e7c,'isVerified':![],'shopId':null},'include':{'shop':!![]}}),console['log'](_0x37be7c(0x1c3)+_0x554afc+_0x37be7c(0x198)+_0xc82e17+')')):_0x1fb2eb=await database_1['default'][_0x37be7c(0x22f)]['update']({'where':{'telegramId':_0x554afc},'data':{'username':_0xc82e17,'firstName':_0x19576c,'lastName':_0x1e0e7c},'include':{'shop':!![]}}),_0x1fb2eb[_0x37be7c(0x1bb)]&&_0x1fb2eb[_0x37be7c(0x1c9)]&&_0x1fb2eb[_0x37be7c(0x1db)]?await this['bot']?.[_0x37be7c(0x19d)](_0x42584a,'‚úÖ\x20Welcome\x20back!\x0a\x0a'+(_0x37be7c(0x17f)+_0x1fb2eb['shop'][_0x37be7c(0x181)]+'*\x0a')+(_0x37be7c(0x252)+_0x1fb2eb[_0x37be7c(0x1db)][_0x37be7c(0x215)]+_0x37be7c(0x17a))+_0x37be7c(0x255)+_0x37be7c(0x1e5)+_0x37be7c(0x184)+'‚Ä¢\x20Payouts\x0a\x0a'+_0x37be7c(0x218)+_0x37be7c(0x23a)+_0x37be7c(0x175),{'parse_mode':_0x37be7c(0x164)}):(_0x1fb2eb[_0x37be7c(0x1c9)]&&!_0x1fb2eb[_0x37be7c(0x1bb)]&&(await database_1[_0x37be7c(0x1ec)][_0x37be7c(0x22f)][_0x37be7c(0x196)]({'where':{'telegramId':_0x554afc},'data':{'shopId':null,'isVerified':![]}}),console[_0x37be7c(0x1f1)]('üîÑ\x20Reset\x20incomplete\x20verification\x20for\x20user\x20'+_0x554afc)),await this[_0x37be7c(0x1d4)]?.[_0x37be7c(0x19d)](_0x42584a,_0x37be7c(0x1ef)+_0x37be7c(0x212)+_0x37be7c(0x211)+'Example:\x0a'+'`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a'+_0x37be7c(0x259),{'parse_mode':_0x37be7c(0x164)}));}catch(_0x24e467){console['error']('Error\x20handling\x20/start\x20command:',_0x24e467),await this[_0x37be7c(0x1d4)]?.[_0x37be7c(0x19d)](_0x42584a,_0x37be7c(0x1d1));}}),this[_0x5bc975(0x1d4)]['onText'](/\/disconnect/,async _0x3dee81=>{const _0x18ca70=_0x5bc975,_0x42c952=_0x3dee81[_0x18ca70(0x226)]['id'],_0x3a1e44=_0x3dee81[_0x18ca70(0x162)]?.['id'][_0x18ca70(0x1a3)]();if(!_0x3a1e44)return;try{const _0x46fbec=await database_1[_0x18ca70(0x1ec)]['telegramUser']['findUnique']({'where':{'telegramId':_0x3a1e44},'include':{'shop':!![]}});if(!_0x46fbec||!_0x46fbec[_0x18ca70(0x1bb)]||!_0x46fbec[_0x18ca70(0x1c9)]){await this[_0x18ca70(0x1d4)]?.['sendMessage'](_0x42c952,'‚ùå\x20You\x20are\x20not\x20connected\x20to\x20the\x20notification\x20system.');return;}const _0x40ed49=_0x46fbec[_0x18ca70(0x1db)]?.[_0x18ca70(0x181)]||_0x18ca70(0x1cd);await database_1[_0x18ca70(0x1ec)][_0x18ca70(0x22f)]['update']({'where':{'telegramId':_0x3a1e44},'data':{'shopId':null,'isVerified':![]}}),console[_0x18ca70(0x1f1)](_0x18ca70(0x25c)+_0x3a1e44+'\x20disconnected\x20from\x20shop\x20'+_0x46fbec['shopId']),await this['bot']?.[_0x18ca70(0x19d)](_0x42c952,_0x18ca70(0x20a)+_0x40ed49+_0x18ca70(0x19a)+_0x18ca70(0x17d),{'parse_mode':'Markdown'});}catch(_0x53b426){console[_0x18ca70(0x1b7)](_0x18ca70(0x1da),_0x53b426),await this['bot']?.[_0x18ca70(0x19d)](_0x42c952,_0x18ca70(0x1d1));}}),this[_0x5bc975(0x1d4)][_0x5bc975(0x224)](/\/status/,async _0x4c173d=>{const _0x661550=_0x5bc975,_0x29f424=_0x4c173d[_0x661550(0x226)]['id'],_0x49e81c=_0x4c173d['from']?.['id'][_0x661550(0x1a3)]();if(!_0x49e81c)return;try{const _0x577aeb=await database_1[_0x661550(0x1ec)][_0x661550(0x22f)][_0x661550(0x202)]({'where':{'telegramId':_0x49e81c},'include':{'shop':!![]}});if(!_0x577aeb){await this[_0x661550(0x1d4)]?.[_0x661550(0x19d)](_0x29f424,'‚ùå\x20You\x20are\x20not\x20registered\x20in\x20the\x20system.\x0a\x0a'+_0x661550(0x197));return;}if(!_0x577aeb[_0x661550(0x1bb)]||!_0x577aeb[_0x661550(0x1c9)]||!_0x577aeb[_0x661550(0x1db)]){await this['bot']?.[_0x661550(0x19d)](_0x29f424,'‚ùå\x20You\x20are\x20not\x20connected\x20to\x20a\x20shop.\x0a\x0a'+_0x661550(0x254));return;}await this[_0x661550(0x1d4)]?.[_0x661550(0x19d)](_0x29f424,_0x661550(0x219)+(_0x661550(0x1b3)+_0x577aeb[_0x661550(0x1db)][_0x661550(0x181)]+'*\x0a')+(_0x661550(0x188)+_0x577aeb['shop'][_0x661550(0x215)]+'`\x0a')+(_0x661550(0x21e)+_0x577aeb[_0x661550(0x16e)][_0x661550(0x1cb)]('en-US')+'\x0a\x0a')+_0x661550(0x1a0)+'Commands:\x0a'+_0x661550(0x175),{'parse_mode':'Markdown'});}catch(_0x393bf2){console[_0x661550(0x1b7)](_0x661550(0x1ad),_0x393bf2),await this[_0x661550(0x1d4)]?.[_0x661550(0x19d)](_0x29f424,_0x661550(0x1d1));}}),this[_0x5bc975(0x1d4)][_0x5bc975(0x224)](/\/debug/,async _0x134372=>{const _0x1a17c1=_0x5bc975,_0x58cf7a=_0x134372[_0x1a17c1(0x226)]['id'],_0x3c8d03=_0x134372['from']?.['id'][_0x1a17c1(0x1a3)]();if(!_0x3c8d03)return;try{const _0xce9cb4=await database_1[_0x1a17c1(0x1ec)][_0x1a17c1(0x22f)][_0x1a17c1(0x202)]({'where':{'telegramId':_0x3c8d03},'include':{'shop':!![]}});let _0x38544b='üîç\x20*Debug\x20Information*\x0a\x0a';_0x38544b+='üì±\x20Your\x20Telegram\x20ID:\x20`'+_0x3c8d03+_0x1a17c1(0x17a),_0xce9cb4?.[_0x1a17c1(0x1bb)]&&_0xce9cb4[_0x1a17c1(0x1db)]?(_0x38544b+=_0x1a17c1(0x19c),_0x38544b+=_0x1a17c1(0x1d5)+_0xce9cb4[_0x1a17c1(0x1db)][_0x1a17c1(0x181)]+'*\x0a',_0x38544b+=_0x1a17c1(0x1be)+_0xce9cb4[_0x1a17c1(0x1db)][_0x1a17c1(0x215)]+'`\x0a',_0x38544b+='\x20\x20\x20Status:\x20'+_0xce9cb4[_0x1a17c1(0x1db)][_0x1a17c1(0x1ce)]+'\x0a\x0a'):_0x38544b+=_0x1a17c1(0x18d),_0x38544b+=_0x1a17c1(0x1d8),await this[_0x1a17c1(0x1d4)]?.['sendMessage'](_0x58cf7a,_0x38544b,{'parse_mode':_0x1a17c1(0x164)});}catch(_0x1fcff0){console[_0x1a17c1(0x1b7)]('Error\x20handling\x20/debug\x20command:',_0x1fcff0),await this[_0x1a17c1(0x1d4)]?.['sendMessage'](_0x58cf7a,_0x1a17c1(0x1f4));}}),this[_0x5bc975(0x1d4)]['on']('message',async _0x42eb6b=>{const _0x402e29=_0x5bc975;if(_0x42eb6b[_0x402e29(0x16f)]?.['startsWith']('/'))return;const _0x2352ee=_0x42eb6b[_0x402e29(0x226)]['id'],_0x4aa09b=_0x42eb6b[_0x402e29(0x162)]?.['id'][_0x402e29(0x1a3)](),_0x1687d7=_0x42eb6b[_0x402e29(0x16f)]?.[_0x402e29(0x1d7)]();if(!_0x4aa09b||!_0x1687d7)return;try{const _0x4f98f0=await database_1[_0x402e29(0x1ec)]['telegramUser'][_0x402e29(0x202)]({'where':{'telegramId':_0x4aa09b},'include':{'shop':!![]}});if(!_0x4f98f0){await this[_0x402e29(0x1d4)]?.[_0x402e29(0x19d)](_0x2352ee,_0x402e29(0x194));return;}if(_0x4f98f0[_0x402e29(0x1bb)]&&_0x4f98f0[_0x402e29(0x1c9)]&&_0x4f98f0[_0x402e29(0x1db)]){await this['bot']?.[_0x402e29(0x19d)](_0x2352ee,_0x402e29(0x23d)+_0x4f98f0['shop'][_0x402e29(0x181)]+_0x402e29(0x19a)+_0x402e29(0x190),{'parse_mode':_0x402e29(0x164)});return;}const _0x47d341=_0x1687d7[_0x402e29(0x242)](/\s+/);if(_0x47d341[_0x402e29(0x1c8)]!==0x2){await this[_0x402e29(0x1d4)]?.[_0x402e29(0x19d)](_0x2352ee,_0x402e29(0x167)+'üìù\x20Format:\x20`username\x20api_key`\x0a\x0a'+'Example:\x0a'+'`appple\x20pk_aa6450d3f57afbefbb0f3f5be5ce6cca13037536afc5ccf14c81a6cbc7a07de5`\x0a\x0a'+('You\x20sent\x20'+_0x47d341['length']+_0x402e29(0x177)+_0x47d341['map'](_0x44d415=>'`'+_0x44d415+'`')[_0x402e29(0x200)](',\x20')),{'parse_mode':_0x402e29(0x164)});return;}const [_0x4763ea,_0x8907f6]=_0x47d341;console[_0x402e29(0x1f1)](_0x402e29(0x193)+_0x4aa09b+_0x402e29(0x1b6)+_0x4763ea+'\x22,\x20apiKey=\x22'+_0x8907f6[_0x402e29(0x1e1)](0x0,0xa)+_0x402e29(0x256)),await this[_0x402e29(0x208)](_0x2352ee,_0x4aa09b,_0x4763ea,_0x8907f6);}catch(_0x13340d){console[_0x402e29(0x1b7)](_0x402e29(0x18e),_0x13340d),await this[_0x402e29(0x1d4)]?.['sendMessage'](_0x2352ee,'‚ùå\x20An\x20error\x20occurred.\x20Please\x20try\x20again\x20later.');}}),this[_0x5bc975(0x1d4)]['on']('error',_0x45236f=>{const _0x465639=_0x5bc975;console[_0x465639(0x1b7)](_0x465639(0x173),_0x45236f);}),this['bot']['on']('polling_error',_0x302ec1=>{const _0x4b6960=_0x5bc975;console['error'](_0x4b6960(0x169),_0x302ec1);});}async[a83_0x1644d6(0x208)](_0x2eed25,_0x184ea2,_0x3622a6,_0x9dc4ec){const _0x5b9d9c=a83_0x1644d6;try{console[_0x5b9d9c(0x1f1)]('üîÑ\x20Processing\x20single-line\x20verification\x20for\x20user\x20'+_0x184ea2+':\x20username=\x22'+_0x3622a6+'\x22,\x20apiKey=\x22'+_0x9dc4ec['substring'](0x0,0xa)+_0x5b9d9c(0x256));if(!_0x3622a6||_0x3622a6[_0x5b9d9c(0x1c8)]<0x3||_0x3622a6[_0x5b9d9c(0x1c8)]>0x32||!/^[a-zA-Z0-9_]+$/[_0x5b9d9c(0x1eb)](_0x3622a6)){await this[_0x5b9d9c(0x1d4)]?.[_0x5b9d9c(0x19d)](_0x2eed25,_0x5b9d9c(0x191)+_0x3622a6+_0x5b9d9c(0x17a)+_0x5b9d9c(0x203),{'parse_mode':_0x5b9d9c(0x164)});return;}if(!_0x9dc4ec||!_0x9dc4ec[_0x5b9d9c(0x20f)](_0x5b9d9c(0x201))&&!_0x9dc4ec['startsWith']('sk_')){await this[_0x5b9d9c(0x1d4)]?.[_0x5b9d9c(0x19d)](_0x2eed25,'‚ùå\x20Invalid\x20API\x20key\x20format.\x0a\x0a'+'API\x20key\x20must\x20start\x20with\x20`pk\x5c_`\x20or\x20`sk\x5c_`.',{'parse_mode':_0x5b9d9c(0x164)});return;}const _0x4a089d=await database_1[_0x5b9d9c(0x1ec)]['shop'][_0x5b9d9c(0x202)]({'where':{'username':_0x3622a6},'select':{'id':!![],'name':!![],'username':!![],'status':!![],'publicKey':!![],'secretKey':!![]}});if(!_0x4a089d){const _0x2eb01c=_0x5b9d9c(0x231)+_0x3622a6+_0x5b9d9c(0x1e3)+'Please\x20check\x20the\x20spelling\x20and\x20try\x20again.\x0a\x0a'+_0x5b9d9c(0x1b5);await this[_0x5b9d9c(0x1d4)]?.[_0x5b9d9c(0x19d)](_0x2eed25,_0x2eb01c,{'parse_mode':'Markdown'});return;}if(_0x4a089d[_0x5b9d9c(0x1ce)]!==_0x5b9d9c(0x21b)){await this[_0x5b9d9c(0x1d4)]?.[_0x5b9d9c(0x19d)](_0x2eed25,_0x5b9d9c(0x1a4)+_0x3622a6+_0x5b9d9c(0x174)+_0x5b9d9c(0x19b),{'parse_mode':'Markdown'});return;}if(_0x4a089d[_0x5b9d9c(0x199)]!==_0x9dc4ec&&_0x4a089d[_0x5b9d9c(0x23b)]!==_0x9dc4ec){await this['bot']?.[_0x5b9d9c(0x19d)](_0x2eed25,_0x5b9d9c(0x1e4)+_0x3622a6+'`.\x0a\x0a'+'Check\x20the\x20key\x20and\x20try\x20again.\x0a\x0a'+_0x5b9d9c(0x1cc),{'parse_mode':'Markdown'});return;}const _0x41b1fc=await database_1['default'][_0x5b9d9c(0x22f)]['count']({'where':{'shopId':_0x4a089d['id'],'isVerified':!![]}});if(_0x41b1fc>=0x5){await this[_0x5b9d9c(0x1d4)]?.['sendMessage'](_0x2eed25,_0x5b9d9c(0x1dd)+_0x3622a6+'`.\x0a\x0a'+_0x5b9d9c(0x24b),{'parse_mode':_0x5b9d9c(0x164)});return;}await database_1[_0x5b9d9c(0x1ec)]['telegramUser'][_0x5b9d9c(0x196)]({'where':{'telegramId':_0x184ea2},'data':{'shopId':_0x4a089d['id'],'isVerified':!![]}}),await this[_0x5b9d9c(0x1d4)]?.['sendMessage'](_0x2eed25,_0x5b9d9c(0x19f)+'‚úÖ\x20You\x20have\x20been\x20successfully\x20connected\x20to\x20the\x20notification\x20system!\x0a\x0a'+('üì±\x20Shop:\x20*'+_0x4a089d['name']+'*\x0a')+('üë§\x20Username:\x20`'+_0x4a089d[_0x5b9d9c(0x215)]+_0x5b9d9c(0x17a))+_0x5b9d9c(0x1c1)+_0x5b9d9c(0x1e5)+_0x5b9d9c(0x184)+'‚Ä¢\x20Payouts\x0a'+_0x5b9d9c(0x225)+_0x5b9d9c(0x218)+_0x5b9d9c(0x23a)+'/disconnect\x20-\x20disconnect\x20from\x20notifications',{'parse_mode':_0x5b9d9c(0x164)}),console[_0x5b9d9c(0x1f1)](_0x5b9d9c(0x229)+_0x184ea2+_0x5b9d9c(0x1fe)+_0x4a089d[_0x5b9d9c(0x215)]+_0x5b9d9c(0x176));}catch(_0x496040){console['error'](_0x5b9d9c(0x206),_0x496040),await this['bot']?.[_0x5b9d9c(0x19d)](_0x2eed25,_0x5b9d9c(0x192));}}async[a83_0x1644d6(0x207)](_0x4d358a,_0x40b208,_0x324267){const _0x6b6d8d=a83_0x1644d6;if(!this[_0x6b6d8d(0x1d4)]){console[_0x6b6d8d(0x1ff)](_0x6b6d8d(0x1ac));return;}try{const _0x4cbade=await database_1[_0x6b6d8d(0x1ec)]['telegramUser'][_0x6b6d8d(0x244)]({'where':{'shopId':_0x4d358a,'isVerified':!![]}});if(_0x4cbade['length']===0x0){console[_0x6b6d8d(0x1f1)](_0x6b6d8d(0x1f9)+_0x4d358a);return;}const _0x32c1ac=_0x4cbade[_0x6b6d8d(0x1bd)](async _0xa0c7f8=>{const _0x58cd0c=_0x6b6d8d;try{await this[_0x58cd0c(0x1d4)]?.[_0x58cd0c(0x19d)](_0xa0c7f8[_0x58cd0c(0x24a)],_0x40b208,_0x324267),console['log']('‚úÖ\x20Notification\x20sent\x20to\x20Telegram\x20user\x20'+_0xa0c7f8[_0x58cd0c(0x24a)]);}catch(_0x250348){console[_0x58cd0c(0x1b7)](_0x58cd0c(0x21a)+_0xa0c7f8[_0x58cd0c(0x24a)]+':',_0x250348),_0x250348 instanceof Error&&(_0x250348[_0x58cd0c(0x217)]['includes'](_0x58cd0c(0x18a))||_0x250348[_0x58cd0c(0x217)][_0x58cd0c(0x1f8)](_0x58cd0c(0x1a7))||_0x250348[_0x58cd0c(0x217)]['includes'](_0x58cd0c(0x170)))&&(await database_1['default'][_0x58cd0c(0x22f)]['update']({'where':{'id':_0xa0c7f8['id']},'data':{'isVerified':![]}}),console['log'](_0x58cd0c(0x228)+_0xa0c7f8[_0x58cd0c(0x24a)]+_0x58cd0c(0x1ba)));}});await Promise[_0x6b6d8d(0x248)](_0x32c1ac);}catch(_0x5dc545){console[_0x6b6d8d(0x1b7)](_0x6b6d8d(0x22e),_0x5dc545);}}async['sendPaymentNotification'](_0x2341b0,_0x225414,_0x58d321){const _0xda370e=a83_0x1644d6,_0x5e9215={'created':'üÜï','paid':'‚úÖ','failed':'‚ùå','expired':'‚è∞','refund':'üîÑ','chargeback':'‚ö†Ô∏è','processing':'‚öôÔ∏è'},_0x477eae={'created':_0xda370e(0x21d),'paid':_0xda370e(0x1f5),'failed':_0xda370e(0x1d6),'expired':_0xda370e(0x220),'refund':_0xda370e(0x258),'chargeback':_0xda370e(0x1bc),'processing':_0xda370e(0x1ae)},_0x2740cc=_0x5e9215[_0x58d321],_0x10c03b=_0x477eae[_0x58d321],_0xbcc0dd=(0x0,gateway_1[_0xda370e(0x20c)])(_0x225414[_0xda370e(0x179)]);console[_0xda370e(0x1f1)](_0xda370e(0x163)+_0x225414[_0xda370e(0x179)]+_0xda370e(0x1ca)+_0xbcc0dd+'\x22');let _0x2c21b7=_0x2740cc+'\x20*'+_0x10c03b+'*\x0a\x0a'+(_0xda370e(0x1ed)+_0x225414[_0xda370e(0x17b)]+'\x20'+_0x225414[_0xda370e(0x238)]+'*\x0a')+(_0xda370e(0x235)+(_0x225414[_0xda370e(0x180)]||_0x225414['id'])+'`\x0a')+('üÜî\x20Payment\x20ID:\x20`'+_0x225414['id']+'`\x0a')+(_0xda370e(0x1f0)+_0xbcc0dd+'`\x0a')+(_0xda370e(0x1ee)+new Date(_0x225414['createdAt'])['toLocaleString'](_0xda370e(0x1a9))+'\x0a');if(_0x225414['customerName']||_0x225414['customerEmail']||_0x225414[_0xda370e(0x221)]||_0x225414[_0xda370e(0x22b)]||_0x225414[_0xda370e(0x1a1)]){_0x2c21b7+=_0xda370e(0x21f);_0x225414['customerName']&&(_0x2c21b7+='üìõ\x20Name:\x20`'+_0x225414['customerName']+'`\x0a');_0x225414[_0xda370e(0x16d)]&&(_0x2c21b7+=_0xda370e(0x1a8)+_0x225414[_0xda370e(0x16d)]+'`\x0a');_0x225414[_0xda370e(0x221)]&&(_0x2c21b7+=_0xda370e(0x22a)+_0x225414[_0xda370e(0x221)]+'`\x0a');_0x225414[_0xda370e(0x22b)]&&(_0x2c21b7+=_0xda370e(0x183)+_0x225414[_0xda370e(0x22b)]+'`\x0a');if(_0x225414[_0xda370e(0x1a1)]){const _0x495458=_0x225414['customerUa']['length']>0x32?_0x225414[_0xda370e(0x1a1)]['substring'](0x0,0x32)+'...':_0x225414['customerUa'];_0x2c21b7+=_0xda370e(0x24f)+_0x495458+'`\x0a';}}_0x58d321==='chargeback'&&_0x225414[_0xda370e(0x24e)]&&(_0x2c21b7+=_0xda370e(0x17e)+_0x225414[_0xda370e(0x24e)]+'\x20USDT*\x0a'),_0x58d321===_0xda370e(0x214)&&(_0x2c21b7+='‚è≥\x20The\x20payment\x20is\x20currently\x20being\x20processed\x20by\x20the\x20gateway.\x0a'),_0x225414[_0xda370e(0x1e8)]&&(_0x2c21b7+=_0xda370e(0x216)+_0x225414[_0xda370e(0x1e8)]+'\x0a'),await this[_0xda370e(0x207)](_0x2341b0,_0x2c21b7,{'parse_mode':_0xda370e(0x164)});}async[a83_0x1644d6(0x166)](_0x42de5a,_0x1ae3a5){const _0x529769=a83_0x1644d6,_0x23a71e=new Date(_0x1ae3a5[_0x529769(0x18f)])[_0x529769(0x195)](_0x529769(0x1a9),{'year':'numeric','month':_0x529769(0x1d2),'day':'2-digit','hour':_0x529769(0x1d2),'minute':_0x529769(0x1d2),'second':_0x529769(0x1d2)}),_0x552c71='üí∏\x20*New\x20Payout*\x0a\x0a'+(_0x529769(0x24c)+_0x23a71e+'\x0a')+(_0x529769(0x204)+_0x1ae3a5['amount']+_0x529769(0x257))+(_0x529769(0x237)+(_0x1ae3a5[_0x529769(0x25a)]||_0x529769(0x227))+'\x0a')+('üåê\x20*Network:*\x20'+(_0x1ae3a5[_0x529769(0x246)]||_0x529769(0x227))+'\x0a')+(_0x529769(0x1e9)+(_0x1ae3a5['wallet']||_0x529769(0x227))+'`\x0a')+(_0x1ae3a5[_0x529769(0x21c)]?_0x529769(0x20e)+_0x1ae3a5[_0x529769(0x21c)]+'`':_0x529769(0x1ea));await this[_0x529769(0x207)](_0x42de5a,_0x552c71,{'parse_mode':_0x529769(0x164)});}async[a83_0x1644d6(0x25d)](_0x41ccfd,_0x329017){const _0x35656e=a83_0x1644d6;try{const _0x2cb4df=await database_1[_0x35656e(0x1ec)][_0x35656e(0x1c4)][_0x35656e(0x202)]({'where':{'shopId':_0x41ccfd},'select':{'notificationLogin':!![]}});if(!_0x2cb4df?.[_0x35656e(0x1e2)]){console[_0x35656e(0x1f1)]('üì±\x20Login\x20notifications\x20disabled\x20for\x20shop\x20'+_0x41ccfd);return;}const _0x47d8b1=_0x329017[_0x35656e(0x187)]?'üîê':'üö®',_0x58e6ff=_0x329017['success']?'Successful\x20login':_0x35656e(0x250);let _0x3785af=_0x47d8b1+'\x20*'+_0x58e6ff+'*\x0a\x0a'+('üë§\x20Username:\x20`'+_0x329017[_0x35656e(0x215)]+'`\x0a')+(_0x35656e(0x1e0)+_0x329017[_0x35656e(0x253)]['toLocaleString']('en-US')+'\x0a');_0x329017['ipAddress']&&(_0x3785af+=_0x35656e(0x168)+_0x329017[_0x35656e(0x171)]+'`\x0a');_0x329017[_0x35656e(0x1c6)]&&(_0x3785af+=_0x35656e(0x249)+_0x329017[_0x35656e(0x1c6)]+'\x0a');if(_0x329017['userAgent']){const _0x57d3e0=_0x329017[_0x35656e(0x1ab)][_0x35656e(0x1c8)]>0x32?_0x329017[_0x35656e(0x1ab)][_0x35656e(0x1e1)](0x0,0x32)+_0x35656e(0x1c2):_0x329017[_0x35656e(0x1ab)];_0x3785af+=_0x35656e(0x24f)+_0x57d3e0+'`\x0a';}!_0x329017[_0x35656e(0x187)]&&(_0x3785af+=_0x35656e(0x1cf)),await this[_0x35656e(0x207)](_0x41ccfd,_0x3785af,{'parse_mode':_0x35656e(0x164)}),console[_0x35656e(0x1f1)](_0x35656e(0x247)+_0x41ccfd+':\x20'+(_0x329017['success']?_0x35656e(0x187):_0x35656e(0x178)));}catch(_0xd76db5){console[_0x35656e(0x1b7)](_0x35656e(0x1fc),_0xd76db5);}}async[a83_0x1644d6(0x1c5)](_0x251f93,_0x3bff60){const _0x330c13=a83_0x1644d6;try{const _0x38e383=await database_1[_0x330c13(0x1ec)][_0x330c13(0x1c4)]['findUnique']({'where':{'shopId':_0x251f93},'select':{'notificationApiError':!![]}});if(!_0x38e383?.[_0x330c13(0x1f7)]){console[_0x330c13(0x1f1)](_0x330c13(0x1fd)+_0x251f93);return;}let _0x6e3738=_0x330c13(0x1b2)+(_0x330c13(0x1b4)+_0x3bff60[_0x330c13(0x185)]+'\x20'+_0x3bff60['endpoint']+'`\x0a')+(_0x330c13(0x1e0)+_0x3bff60[_0x330c13(0x253)][_0x330c13(0x195)](_0x330c13(0x1a9))+'\x0a');_0x3bff60[_0x330c13(0x189)]&&(_0x6e3738+=_0x330c13(0x186)+_0x3bff60[_0x330c13(0x189)]+'`\x0a'),_0x6e3738+=_0x330c13(0x1b9)+_0x3bff60[_0x330c13(0x16b)]+'`\x0a',_0x3bff60['requestId']&&(_0x6e3738+=_0x330c13(0x1bf)+_0x3bff60[_0x330c13(0x23e)]+'`\x0a'),_0x6e3738+=_0x330c13(0x234),await this[_0x330c13(0x207)](_0x251f93,_0x6e3738,{'parse_mode':_0x330c13(0x164)}),console[_0x330c13(0x1f1)]('‚úÖ\x20API\x20error\x20notification\x20sent\x20for\x20shop\x20'+_0x251f93+':\x20'+_0x3bff60[_0x330c13(0x210)]);}catch(_0x19734c){console[_0x330c13(0x1b7)](_0x330c13(0x25b),_0x19734c);}}async[a83_0x1644d6(0x243)](_0x1c214b,_0x10943e,_0xc18211){const _0x3f49d6=a83_0x1644d6;let _0x38f522=_0x3f49d6(0x23c)+_0x10943e+_0x3f49d6(0x1fa);for(const [_0x264c45,_0x4679fe]of Object['entries'](_0xc18211)){_0x4679fe!==null&&_0x4679fe!==undefined&&(_0x38f522+=_0x264c45+_0x3f49d6(0x19e)+_0x4679fe+'`\x0a');}await this['sendShopNotification'](_0x1c214b,_0x38f522,{'parse_mode':_0x3f49d6(0x164)});}async['sendNotificationToAll'](_0x27771c){const _0x2043ee=a83_0x1644d6;try{console[_0x2043ee(0x1f1)]('üì±\x20Sending\x20notification\x20to\x20all\x20connected\x20users:\x20'+_0x27771c['substring'](0x0,0x32)+_0x2043ee(0x1c2));const _0x2e92a3=await database_1['default'][_0x2043ee(0x22f)][_0x2043ee(0x244)]({'select':{'telegramId':!![]}});if(_0x2e92a3[_0x2043ee(0x1c8)]===0x0){console[_0x2043ee(0x1f1)]('üì±\x20No\x20active\x20Telegram\x20users\x20found');return;}for(const _0x45376c of _0x2e92a3){try{await this[_0x2043ee(0x1d4)]?.['sendMessage'](_0x45376c[_0x2043ee(0x24a)],_0x27771c,{'parse_mode':'Markdown'});}catch(_0x397838){console['error'](_0x2043ee(0x1aa)+_0x45376c[_0x2043ee(0x24a)]+':',_0x397838);}}console[_0x2043ee(0x1f1)](_0x2043ee(0x232)+_0x2e92a3[_0x2043ee(0x1c8)]+'\x20users');}catch(_0x5c4761){console[_0x2043ee(0x1b7)](_0x2043ee(0x25e),_0x5c4761);}}['getBotInfo'](){const _0x510347=a83_0x1644d6;return{'isActive':!!this[_0x510347(0x1d4)],'username':this['botUsername']};}async[a83_0x1644d6(0x1e6)](_0x467dd3,_0xcf92bf,_0x48e6a5,_0x29b8f4){const _0x443497=a83_0x1644d6;try{if(!this[_0x443497(0x1d4)])return console['error'](_0x443497(0x20b)),![];const _0x1b9a26=await database_1[_0x443497(0x1ec)][_0x443497(0x22f)][_0x443497(0x244)]({'where':{'shopId':_0x467dd3,'isVerified':!![]},'select':{'telegramId':!![]}});if(_0x1b9a26[_0x443497(0x1c8)]===0x0)return console[_0x443497(0x1b7)](_0x443497(0x251)+_0x467dd3),![];let _0x371594=0x0;for(const _0x1dfd6e of _0x1b9a26){try{await this[_0x443497(0x1d4)][_0x443497(0x222)](_0x1dfd6e[_0x443497(0x24a)],_0xcf92bf,{},{'filename':_0x48e6a5,'contentType':_0x48e6a5[_0x443497(0x172)]('.png')?_0x443497(0x245):_0x48e6a5[_0x443497(0x172)](_0x443497(0x1af))||_0x48e6a5['endsWith'](_0x443497(0x230))?_0x443497(0x1a2):_0x48e6a5[_0x443497(0x172)](_0x443497(0x205))?'application/pdf':_0x443497(0x1a5)}),_0x29b8f4&&await this[_0x443497(0x1d4)][_0x443497(0x19d)](_0x1dfd6e[_0x443497(0x24a)],_0x29b8f4),_0x371594++;}catch(_0x29ad04){console[_0x443497(0x1b7)]('‚ùå\x20Error\x20sending\x20file\x20to\x20user\x20'+_0x1dfd6e[_0x443497(0x24a)]+':',_0x29ad04);}}return console['log'](_0x443497(0x1e7)+_0x371594+'/'+_0x1b9a26['length']+_0x443497(0x1c7)+_0x467dd3+':\x20'+_0x48e6a5),_0x371594>0x0;}catch(_0x31246e){return console[_0x443497(0x1b7)]('‚ùå\x20Error\x20sending\x20file\x20to\x20shop:',_0x31246e),![];}}async[a83_0x1644d6(0x233)](_0x4cfa8f,_0x3f7e46){const _0x1581d6=a83_0x1644d6;try{if(!this[_0x1581d6(0x1d4)])return console['error'](_0x1581d6(0x20b)),![];return await this[_0x1581d6(0x1d4)]['sendMessage'](_0x4cfa8f,_0x3f7e46),console[_0x1581d6(0x1f1)]('‚úÖ\x20Direct\x20message\x20sent\x20to\x20chat\x20'+_0x4cfa8f),!![];}catch(_0x527ea7){return console['error'](_0x1581d6(0x1f2),_0x527ea7),![];}}async['sendDirectFile'](_0x305392,_0x4ded27,_0x504930,_0x2f44b0){const _0x1be497=a83_0x1644d6;try{if(!this[_0x1be497(0x1d4)])return console['error'](_0x1be497(0x20b)),![];return await this['bot'][_0x1be497(0x222)](_0x305392,_0x4ded27,{},{'filename':_0x504930,'contentType':_0x504930[_0x1be497(0x172)](_0x1be497(0x1a6))?_0x1be497(0x245):_0x504930[_0x1be497(0x172)](_0x1be497(0x1af))||_0x504930[_0x1be497(0x172)](_0x1be497(0x230))?_0x1be497(0x1a2):_0x504930[_0x1be497(0x172)](_0x1be497(0x205))?_0x1be497(0x20d):_0x1be497(0x1a5)}),_0x2f44b0&&await this[_0x1be497(0x1d4)][_0x1be497(0x19d)](_0x305392,_0x2f44b0),console['log']('‚úÖ\x20File\x20sent\x20to\x20chat\x20'+_0x305392+':\x20'+_0x504930),!![];}catch(_0x4ab580){return console['error'](_0x1be497(0x236),_0x4ab580),![];}}[a83_0x1644d6(0x1df)](){const _0x375e98=a83_0x1644d6;this['bot']&&(this['bot'][_0x375e98(0x223)](),this[_0x375e98(0x1d4)]=null,console[_0x375e98(0x1f1)](_0x375e98(0x16a)));}}exports[a83_0x1644d6(0x1f3)]=TelegramBotService,exports[a83_0x1644d6(0x17c)]=new TelegramBotService();