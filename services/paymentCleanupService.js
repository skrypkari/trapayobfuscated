'use strict';const a74_0x5dfb26=a74_0x1907;(function(_0x1bda01,_0x59b5e4){const _0x174b97=a74_0x1907,_0x51db59=_0x1bda01();while(!![]){try{const _0x557534=parseInt(_0x174b97(0x108))/0x1*(-parseInt(_0x174b97(0xe4))/0x2)+-parseInt(_0x174b97(0xcb))/0x3*(parseInt(_0x174b97(0x130))/0x4)+parseInt(_0x174b97(0xd9))/0x5*(parseInt(_0x174b97(0x12b))/0x6)+parseInt(_0x174b97(0x140))/0x7+parseInt(_0x174b97(0x14f))/0x8+-parseInt(_0x174b97(0x137))/0x9*(-parseInt(_0x174b97(0xda))/0xa)+-parseInt(_0x174b97(0xe0))/0xb*(-parseInt(_0x174b97(0x152))/0xc);if(_0x557534===_0x59b5e4)break;else _0x51db59['push'](_0x51db59['shift']());}catch(_0x5a6a99){_0x51db59['push'](_0x51db59['shift']());}}}(a74_0x5e2b,0xd21c4));var __importDefault=this&&this[a74_0x5dfb26(0x126)]||function(_0x41cfd4){return _0x41cfd4&&_0x41cfd4['__esModule']?_0x41cfd4:{'default':_0x41cfd4};};Object[a74_0x5dfb26(0x153)](exports,'__esModule',{'value':!![]}),exports[a74_0x5dfb26(0xbb)]=exports[a74_0x5dfb26(0x122)]=void 0x0;const database_1=__importDefault(require(a74_0x5dfb26(0x11b))),client_1=require('@prisma/client'),loggerService_1=require('./loggerService');function a74_0x1907(_0x40cc8f,_0x549f52){_0x40cc8f=_0x40cc8f-0xb8;const _0x5e2b90=a74_0x5e2b();let _0x1907ac=_0x5e2b90[_0x40cc8f];return _0x1907ac;}class PaymentCleanupService{constructor(){const _0x298007=a74_0x5dfb26;this[_0x298007(0xcd)]=0x5,this[_0x298007(0xe5)]=0x5,this['FAST_TIMEOUT_MINUTES']=0x1e,this['SLOW_TIMEOUT_DAYS']=0x3,this[_0x298007(0x111)]=['squirrelpay',_0x298007(0xf2),_0x298007(0x11a),_0x298007(0xb8),_0x298007(0x11c),_0x298007(0x10c)];}async[a74_0x5dfb26(0xf5)](){const _0x254163=a74_0x5dfb26,_0x5e43c0=[];let _0x510894=0x0,_0x102f6f=0x0;try{console[_0x254163(0x145)](_0x254163(0x107));const _0x349ed1=new Date();_0x349ed1[_0x254163(0xd8)](_0x349ed1[_0x254163(0xd5)]()-this[_0x254163(0xcd)]),console[_0x254163(0x145)](_0x254163(0xe8)+_0x349ed1['toISOString']());const _0x4e2d22=await database_1[_0x254163(0x13b)][_0x254163(0xf1)][_0x254163(0x120)]({'where':{'status':client_1[_0x254163(0x11f)]['PROCESSING'],'createdAt':{'lt':_0x349ed1}},'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![]}}}});console[_0x254163(0x145)](_0x254163(0x105)+_0x4e2d22[_0x254163(0xfb)]+_0x254163(0xe3));if(_0x4e2d22[_0x254163(0xfb)]===0x0)return console[_0x254163(0x145)](_0x254163(0xfc)),{'processed':0x0,'failed':0x0,'errors':[]};for(const _0x2b55da of _0x4e2d22){try{console[_0x254163(0x145)](_0x254163(0x125)+_0x2b55da['id']+'\x20('+_0x2b55da[_0x254163(0xdb)]+',\x20'+_0x2b55da[_0x254163(0x11e)]+'\x20'+_0x2b55da[_0x254163(0xef)]+')'),console[_0x254163(0x145)](_0x254163(0x113)+_0x2b55da[_0x254163(0x128)][_0x254163(0x151)]+'\x20('+_0x2b55da['shop']['username']+')'),console['log']('\x20\x20\x20Created:\x20'+_0x2b55da['createdAt'][_0x254163(0x106)]()),console[_0x254163(0x145)](_0x254163(0x13c)+Math['floor']((Date[_0x254163(0xe1)]()-_0x2b55da[_0x254163(0x100)][_0x254163(0xea)]())/(0x3e8*0x3c*0x3c*0x18))+_0x254163(0x114));const _0xf0b48c=await database_1[_0x254163(0x13b)][_0x254163(0xf1)][_0x254163(0x118)]({'where':{'id':_0x2b55da['id']},'data':{'status':client_1[_0x254163(0x11f)][_0x254163(0x10b)],'statusChangedBy':_0x254163(0x132),'statusChangedAt':new Date(),'failureMessage':_0x254163(0x136)+this['PROCESSING_TIMEOUT_DAYS']+_0x254163(0x114)}});console[_0x254163(0x145)](_0x254163(0xd4)+_0x2b55da['id']+_0x254163(0x143)),loggerService_1[_0x254163(0xbe)][_0x254163(0x131)](_0x2b55da['gateway'],_0x2b55da['id'],_0x254163(0xba),'FAILED',{'reason':_0x254163(0xca),'timeoutDays':this['PROCESSING_TIMEOUT_DAYS']}),_0x510894++;}catch(_0x2c78e8){const _0x614610=_0x254163(0xed)+_0x2b55da['id']+':\x20'+(_0x2c78e8 instanceof Error?_0x2c78e8[_0x254163(0x133)]:_0x254163(0xc5));console[_0x254163(0x14d)]('âŒ\x20'+_0x614610),_0x5e43c0[_0x254163(0x117)](_0x614610),_0x102f6f++;}}const _0x3259f2=_0x254163(0xdf)+_0x510894+'\x20payments\x20updated\x20to\x20FAILED,\x20'+_0x102f6f+_0x254163(0x115);return console[_0x254163(0x145)](_0x254163(0x13d)+_0x3259f2),loggerService_1[_0x254163(0xbe)][_0x254163(0xc9)](_0x254163(0x148),'POST','system',_0x254163(0xc0),{'processed':_0x510894,'failed':_0x102f6f,'errors':_0x5e43c0,'timeoutDays':this[_0x254163(0xcd)]}),{'processed':_0x510894,'failed':_0x102f6f,'errors':_0x5e43c0};}catch(_0x1e690b){const _0xb73517=_0x254163(0xc6)+(_0x1e690b instanceof Error?_0x1e690b[_0x254163(0x133)]:_0x254163(0xc5));return console['error'](_0x254163(0x121)+_0xb73517),_0x5e43c0[_0x254163(0x117)](_0xb73517),loggerService_1[_0x254163(0xbe)]['logWebhookError'](_0x254163(0x148),_0xb73517,{'timeoutDays':this[_0x254163(0xcd)]}),{'processed':_0x510894,'failed':_0x102f6f,'errors':_0x5e43c0};}}async[a74_0x5dfb26(0xd6)](){const _0x11b44a=a74_0x5dfb26,_0x19e404=[];let _0x484641=0x0,_0x2e8098=0x0;try{console[_0x11b44a(0x145)]('ğŸ§¹\x20Starting\x20cleanup\x20of\x20stale\x20PENDING\x20payments...');const _0x1f9056=new Date(),_0x57b656=new Date(_0x1f9056[_0x11b44a(0xea)]()-this[_0x11b44a(0xec)]*0x3c*0x3e8),_0xe679ed=new Date();_0xe679ed['setDate'](_0xe679ed[_0x11b44a(0xd5)]()-this[_0x11b44a(0xcc)]),console[_0x11b44a(0x145)]('ğŸ“…\x20Fast\x20timeout\x20(30\x20min):\x20'+_0x57b656[_0x11b44a(0x106)]()),console['log']('ğŸ“…\x20Slow\x20timeout\x20(3\x20days):\x20'+_0xe679ed[_0x11b44a(0x106)]()),console[_0x11b44a(0x145)](_0x11b44a(0x147)+this['FAST_TIMEOUT_GATEWAYS'][_0x11b44a(0xc8)](',\x20'));const _0x5336c6=await database_1[_0x11b44a(0x13b)][_0x11b44a(0xf1)][_0x11b44a(0x120)]({'where':{'status':client_1[_0x11b44a(0x11f)][_0x11b44a(0xde)],'OR':[{'gateway':{'in':this[_0x11b44a(0x111)]},'createdAt':{'lt':_0x57b656}},{'gateway':{'notIn':this['FAST_TIMEOUT_GATEWAYS']},'createdAt':{'lt':_0xe679ed}}]},'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![]}}}});console[_0x11b44a(0x145)](_0x11b44a(0x105)+_0x5336c6[_0x11b44a(0xfb)]+_0x11b44a(0xf6));if(_0x5336c6[_0x11b44a(0xfb)]===0x0)return console[_0x11b44a(0x145)](_0x11b44a(0x10f)),{'processed':0x0,'failed':0x0,'errors':[]};for(const _0x483e87 of _0x5336c6){try{const _0x50d16e=this[_0x11b44a(0x111)]['includes'](_0x483e87[_0x11b44a(0xdb)]),_0x49b5f4=_0x50d16e?'30\x20minutes':_0x11b44a(0xc4),_0x310470=Math['floor']((Date[_0x11b44a(0xe1)]()-_0x483e87[_0x11b44a(0x100)][_0x11b44a(0xea)]())/(0x3e8*0x3c));console[_0x11b44a(0x145)](_0x11b44a(0x142)+_0x483e87['id']),console[_0x11b44a(0x145)](_0x11b44a(0xb9)+_0x483e87[_0x11b44a(0xdb)]+'\x20('+_0x49b5f4+_0x11b44a(0xe2)),console[_0x11b44a(0x145)](_0x11b44a(0x141)+_0x483e87[_0x11b44a(0x11e)]+'\x20'+_0x483e87[_0x11b44a(0xef)]),console[_0x11b44a(0x145)](_0x11b44a(0x113)+_0x483e87[_0x11b44a(0x128)]['name']+'\x20('+_0x483e87['shop'][_0x11b44a(0xf9)]+')'),console['log']('\x20\x20\x20Created:\x20'+_0x483e87[_0x11b44a(0x100)][_0x11b44a(0x106)]()),console[_0x11b44a(0x145)](_0x11b44a(0x13c)+_0x310470+_0x11b44a(0xf3));const _0x44517c=await database_1[_0x11b44a(0x13b)][_0x11b44a(0xf1)][_0x11b44a(0x118)]({'where':{'id':_0x483e87['id']},'data':{'status':client_1[_0x11b44a(0x11f)][_0x11b44a(0x127)],'statusChangedBy':'system','statusChangedAt':new Date(),'failureMessage':_0x11b44a(0x10e)+_0x49b5f4}});console[_0x11b44a(0x145)]('âœ…\x20Updated\x20payment\x20'+_0x483e87['id']+_0x11b44a(0x11d)),loggerService_1['loggerService']['logWebhookProcessed'](_0x483e87[_0x11b44a(0xdb)],_0x483e87['id'],_0x11b44a(0xde),_0x11b44a(0x127),{'reason':'auto_timeout_pending','timeout':_0x49b5f4,'ageMinutes':_0x310470}),_0x484641++;}catch(_0x1b8377){const _0xe0dd1=_0x11b44a(0xf8)+_0x483e87['id']+':\x20'+(_0x1b8377 instanceof Error?_0x1b8377[_0x11b44a(0x133)]:_0x11b44a(0xc5));console[_0x11b44a(0x14d)]('âŒ\x20'+_0xe0dd1),_0x19e404['push'](_0xe0dd1),_0x2e8098++;}}const _0x2bc612=_0x11b44a(0xd7)+_0x484641+_0x11b44a(0x102)+_0x2e8098+_0x11b44a(0x115);return console[_0x11b44a(0x145)](_0x11b44a(0x13d)+_0x2bc612),loggerService_1[_0x11b44a(0xbe)][_0x11b44a(0xc9)]('pending_payment_cleanup',_0x11b44a(0x13a),_0x11b44a(0x132),_0x11b44a(0xc0),{'processed':_0x484641,'failed':_0x2e8098,'errors':_0x19e404,'fastTimeoutMinutes':this[_0x11b44a(0xec)],'slowTimeoutDays':this[_0x11b44a(0xcc)]}),{'processed':_0x484641,'failed':_0x2e8098,'errors':_0x19e404};}catch(_0x5a08b3){const _0x3230a0=_0x11b44a(0x13f)+(_0x5a08b3 instanceof Error?_0x5a08b3[_0x11b44a(0x133)]:'Unknown\x20error');return console[_0x11b44a(0x14d)]('ğŸ’¥\x20'+_0x3230a0),_0x19e404[_0x11b44a(0x117)](_0x3230a0),loggerService_1[_0x11b44a(0xbe)][_0x11b44a(0x149)](_0x11b44a(0x12d),_0x3230a0,{'timeoutDays':this['PENDING_TIMEOUT_DAYS']}),{'processed':_0x484641,'failed':_0x2e8098,'errors':_0x19e404};}}async[a74_0x5dfb26(0x13e)](){const _0x24eca7=a74_0x5dfb26;try{const _0x4cf5ee=new Date(),_0x366a2d=new Date(_0x4cf5ee[_0x24eca7(0xea)]()-0x1*0x18*0x3c*0x3c*0x3e8),_0x3e35ce=new Date(_0x4cf5ee['getTime']()-0x3*0x18*0x3c*0x3c*0x3e8),_0x1d706b=new Date(_0x4cf5ee[_0x24eca7(0xea)]()-0x5*0x18*0x3c*0x3c*0x3e8),_0x4a4916=await database_1['default'][_0x24eca7(0xf1)][_0x24eca7(0x120)]({'where':{'status':{'in':[client_1[_0x24eca7(0x11f)][_0x24eca7(0xba)],client_1[_0x24eca7(0x11f)][_0x24eca7(0xde)]]}},'select':{'id':!![],'gateway':!![],'status':!![],'createdAt':!![]}}),_0x25f24b={'total':_0x4a4916[_0x24eca7(0xfb)],'byAge':{'fresh':0x0,'recent':0x0,'stale':0x0,'expired':0x0},'byGateway':{},'byStatus':{}};for(const _0x43c1a2 of _0x4a4916){if(_0x43c1a2[_0x24eca7(0x100)]>_0x366a2d)_0x25f24b['byAge']['fresh']++;else{if(_0x43c1a2[_0x24eca7(0x100)]>_0x3e35ce)_0x25f24b['byAge'][_0x24eca7(0x10d)]++;else _0x43c1a2[_0x24eca7(0x100)]>_0x1d706b?_0x25f24b[_0x24eca7(0xbf)][_0x24eca7(0xfd)]++:_0x25f24b['byAge'][_0x24eca7(0xbd)]++;}!_0x25f24b[_0x24eca7(0xc2)][_0x43c1a2[_0x24eca7(0xdb)]]&&(_0x25f24b[_0x24eca7(0xc2)][_0x43c1a2[_0x24eca7(0xdb)]]=0x0);_0x25f24b[_0x24eca7(0xc2)][_0x43c1a2[_0x24eca7(0xdb)]]++;const _0xfdeee6=_0x43c1a2['status'];!_0x25f24b[_0x24eca7(0xbc)][_0xfdeee6]&&(_0x25f24b[_0x24eca7(0xbc)][_0xfdeee6]=0x0),_0x25f24b[_0x24eca7(0xbc)][_0xfdeee6]++;}return _0x25f24b;}catch(_0x311e06){console[_0x24eca7(0x14d)](_0x24eca7(0x138),_0x311e06);throw new Error('Failed\x20to\x20get\x20processing\x20payments\x20stats:\x20'+(_0x311e06 instanceof Error?_0x311e06[_0x24eca7(0x133)]:_0x24eca7(0xc5)));}}async['runCleanupWithReport'](){const _0x28d23e=a74_0x5dfb26;console['log'](_0x28d23e(0xcf));const _0x16a7c2=await this[_0x28d23e(0x13e)]();console[_0x28d23e(0x145)](_0x28d23e(0xc7)),console[_0x28d23e(0x145)]('\x20\x20\x20Total:\x20'+_0x16a7c2[_0x28d23e(0x12a)]),console[_0x28d23e(0x145)](_0x28d23e(0xce)+_0x16a7c2[_0x28d23e(0xbf)][_0x28d23e(0x12f)]),console['log'](_0x28d23e(0x134)+_0x16a7c2[_0x28d23e(0xbf)]['recent']),console['log'](_0x28d23e(0xff)+_0x16a7c2[_0x28d23e(0xbf)][_0x28d23e(0xfd)]),console[_0x28d23e(0x145)]('\x20\x20\x20Expired\x20(>\x205\x20days):\x20'+_0x16a7c2[_0x28d23e(0xbf)][_0x28d23e(0xbd)]),console['log'](_0x28d23e(0x14c),_0x16a7c2[_0x28d23e(0xc2)]),console[_0x28d23e(0x145)](_0x28d23e(0xc1),_0x16a7c2[_0x28d23e(0xbc)]),console['log'](_0x28d23e(0x12e));const _0x2c8c41=await this[_0x28d23e(0xf5)]();console[_0x28d23e(0x145)]('\x0ağŸ”„\x20Running\x20PENDING\x20payments\x20cleanup...');const _0x52626a=await this[_0x28d23e(0xd6)](),_0x39f4d7=await this[_0x28d23e(0x13e)]();console[_0x28d23e(0x145)](_0x28d23e(0xee)),console[_0x28d23e(0x145)](_0x28d23e(0x124)+_0x39f4d7[_0x28d23e(0x12a)]),console[_0x28d23e(0x145)]('\x20\x20\x20Expired\x20(>\x205\x20days):\x20'+_0x39f4d7[_0x28d23e(0xbf)]['expired']),console[_0x28d23e(0x145)](_0x28d23e(0xc1),_0x39f4d7[_0x28d23e(0xbc)]);const _0x52d1d8=_0x2c8c41[_0x28d23e(0x12c)]+_0x52626a[_0x28d23e(0x12c)],_0x29d0d1=_0x2c8c41[_0x28d23e(0xd2)]+_0x52626a[_0x28d23e(0xd2)],_0x26c8e4=[..._0x2c8c41[_0x28d23e(0x101)],..._0x52626a[_0x28d23e(0x101)]];console[_0x28d23e(0x145)](_0x28d23e(0xeb)),console[_0x28d23e(0x145)]('\x20\x20\x20ğŸ”„\x20PROCESSING\x20â†’\x20FAILED:\x20'+_0x2c8c41[_0x28d23e(0x12c)]),console[_0x28d23e(0x145)](_0x28d23e(0xfa)+_0x52626a[_0x28d23e(0x12c)]),console[_0x28d23e(0x145)]('\x20\x20\x20âœ…\x20Total\x20successfully\x20processed:\x20'+_0x52d1d8),console[_0x28d23e(0x145)](_0x28d23e(0x109)+_0x29d0d1),console[_0x28d23e(0x145)](_0x28d23e(0x14a)+(_0x16a7c2[_0x28d23e(0x12a)]-_0x39f4d7[_0x28d23e(0x12a)])),_0x26c8e4['length']>0x0&&(console[_0x28d23e(0x145)]('\x20\x20\x20âš ï¸\x20Errors\x20encountered:'),_0x26c8e4[_0x28d23e(0xdc)]((_0x371f53,_0x3da67a)=>{const _0x54dbb0=_0x28d23e;console['log'](_0x54dbb0(0xf4)+(_0x3da67a+0x1)+'.\x20'+_0x371f53);})),console[_0x28d23e(0x145)]('ğŸ\x20Payment\x20cleanup\x20service\x20completed');}async['runProcessingCleanupOnly'](){const _0x588443=a74_0x5dfb26;console[_0x588443(0x145)](_0x588443(0xd3));const _0x44a282=await this[_0x588443(0x13e)](),_0x6caee0=_0x44a282[_0x588443(0xbc)][_0x588443(0xba)]||0x0;console[_0x588443(0x145)]('ğŸ“Š\x20PROCESSING\x20payments\x20before\x20cleanup:\x20'+_0x6caee0);const _0xc1a082=await this[_0x588443(0xf5)](),_0x495c4b=await this['getProcessingPaymentsStats'](),_0x58ce47=_0x495c4b[_0x588443(0xbc)][_0x588443(0xba)]||0x0;console[_0x588443(0x145)](_0x588443(0x123)+_0x58ce47),console['log'](_0x588443(0x14b)+_0xc1a082['processed']),console[_0x588443(0x145)](_0x588443(0x139));}async[a74_0x5dfb26(0xdd)](){const _0x5409d3=a74_0x5dfb26;console['log'](_0x5409d3(0x150));const _0x2d0b7c=await this[_0x5409d3(0x13e)](),_0x3431d9=_0x2d0b7c[_0x5409d3(0xbc)][_0x5409d3(0xde)]||0x0;console[_0x5409d3(0x145)](_0x5409d3(0x146)+_0x3431d9);const _0x41b6bb=await this[_0x5409d3(0xd6)](),_0x5d7b7a=await this[_0x5409d3(0x13e)](),_0x305f30=_0x5d7b7a[_0x5409d3(0xbc)][_0x5409d3(0xde)]||0x0;console[_0x5409d3(0x145)](_0x5409d3(0x119)+_0x305f30),console['log'](_0x5409d3(0x116)+_0x41b6bb[_0x5409d3(0x12c)]),console[_0x5409d3(0x145)](_0x5409d3(0x129));}async[a74_0x5dfb26(0x144)](){const _0x4eaa02=a74_0x5dfb26,_0x1518d0=[];let _0x493e8b=0x0;try{console[_0x4eaa02(0x145)](_0x4eaa02(0xfe));const _0xd1816=new Date(),_0x26543d=['oxapay',_0x4eaa02(0x11c)],_0x2b0927=[_0x4eaa02(0xe7),'rapyd','visa/mastercard',_0x4eaa02(0xe6)],_0x1f7707=await database_1[_0x4eaa02(0x13b)][_0x4eaa02(0x135)][_0x4eaa02(0x120)]({'where':{'type':_0x4eaa02(0x112),'status':'ACTIVE'},'include':{'payments':{'orderBy':{'createdAt':_0x4eaa02(0x110)},'take':0x1}}});console[_0x4eaa02(0x145)]('ğŸ”\x20Found\x20'+_0x1f7707['length']+'\x20active\x20SINGLE\x20links\x20to\x20check');for(const _0x2f5f50 of _0x1f7707){try{if(_0x2f5f50[_0x4eaa02(0xe9)]['length']===0x0)continue;const _0x149d30=_0x2f5f50[_0x4eaa02(0xe9)][0x0];if(_0x149d30['status']==='PAID')continue;const _0x8f562c=_0xd1816['getTime']()-_0x149d30['createdAt'][_0x4eaa02(0xea)]();let _0x2346fc;_0x26543d[_0x4eaa02(0x10a)](_0x2f5f50[_0x4eaa02(0xdb)])||_0x2b0927[_0x4eaa02(0x10a)](_0x2f5f50['gateway'])?_0x2346fc=0x1e*0x3c*0x3e8:_0x2346fc=0x3*0x18*0x3c*0x3c*0x3e8,_0x8f562c>_0x2346fc&&(await database_1['default'][_0x4eaa02(0x135)][_0x4eaa02(0x118)]({'where':{'id':_0x2f5f50['id']},'data':{'status':_0x4eaa02(0x127)}}),console[_0x4eaa02(0x145)](_0x4eaa02(0xc3)+_0x2f5f50['id']+_0x4eaa02(0x14e)+_0x2f5f50[_0x4eaa02(0xdb)]+_0x4eaa02(0x103)+Math[_0x4eaa02(0xf7)](_0x8f562c/0x3e8/0x3c)+_0x4eaa02(0xf0)),_0x493e8b++);}catch(_0x49bb5c){const _0x5da2ca='Failed\x20to\x20expire\x20link\x20'+_0x2f5f50['id']+':\x20'+(_0x49bb5c instanceof Error?_0x49bb5c[_0x4eaa02(0x133)]:'Unknown\x20error');console[_0x4eaa02(0x14d)]('âŒ\x20'+_0x5da2ca),_0x1518d0['push'](_0x5da2ca);}}return console[_0x4eaa02(0x145)](_0x4eaa02(0x104)+_0x493e8b+_0x4eaa02(0xd1)),{'expired':_0x493e8b,'errors':_0x1518d0};}catch(_0x23665d){const _0x3049d8=_0x4eaa02(0xd0)+(_0x23665d instanceof Error?_0x23665d['message']:_0x4eaa02(0xc5));return console[_0x4eaa02(0x14d)](_0x4eaa02(0x121)+_0x3049d8),_0x1518d0[_0x4eaa02(0x117)](_0x3049d8),{'expired':_0x493e8b,'errors':_0x1518d0};}}}function a74_0x5e2b(){const _0x4bd0f0=['currency','\x20minutes)','payment','squirrel-pay','\x20minutes','\x20\x20\x20\x20\x20\x20','cleanupStaleProcessingPayments','\x20stale\x20PENDING\x20payments','round','Failed\x20to\x20update\x20PENDING\x20payment\x20','username','\x20\x20\x20â°\x20PENDING\x20â†’\x20EXPIRED:\x20','length','âœ…\x20No\x20stale\x20PROCESSING\x20payments\x20found','stale','â°\x20Starting\x20expiration\x20check\x20for\x20SINGLE\x20payment\x20links...','\x20\x20\x20Stale\x20(3-5\x20days):\x20','createdAt','errors','\x20payments\x20updated\x20to\x20EXPIRED,\x20',',\x20payment\x20age:\x20','ğŸ“Š\x20Expiration\x20completed:\x20','ğŸ”\x20Found\x20','toISOString','ğŸ§¹\x20Starting\x20cleanup\x20of\x20stale\x20PROCESSING\x20payments...','1604689EigLXO','\x20\x20\x20âŒ\x20Total\x20failed\x20to\x20process:\x20','includes','FAILED','oxapay','recent','Payment\x20timeout:\x20No\x20payment\x20action\x20received\x20within\x20','âœ…\x20No\x20stale\x20PENDING\x20payments\x20found','desc','FAST_TIMEOUT_GATEWAYS','SINGLE','\x20\x20\x20Shop:\x20','\x20days','\x20failed\x20to\x20update','âœ…\x20PENDING\x20payments\x20processed:\x20','push','update','ğŸ“Š\x20PENDING\x20payments\x20after\x20cleanup:\x20','rapyd','../config/database','plisio','\x20from\x20PENDING\x20to\x20EXPIRED','amount','PaymentStatus','findMany','ğŸ’¥\x20','PaymentCleanupService','ğŸ“Š\x20PROCESSING\x20payments\x20after\x20cleanup:\x20','\x20\x20\x20Total:\x20','â±ï¸\x20Processing\x20stale\x20payment:\x20','__importDefault','EXPIRED','shop','ğŸ\x20PENDING\x20cleanup\x20completed','total','299790FiBWvb','processed','pending_payment_cleanup','\x0ağŸ”„\x20Running\x20PROCESSING\x20payments\x20cleanup...','fresh','177644CoOZrw','logWebhookProcessed','system','message','\x20\x20\x20Recent\x20(1-3\x20days):\x20','paymentLink','Payment\x20timeout:\x20No\x20status\x20update\x20received\x20for\x20','3480723BcDBBn','Failed\x20to\x20get\x20processing\x20payments\x20stats:','ğŸ\x20PROCESSING\x20cleanup\x20completed','POST','default','\x20\x20\x20Age:\x20','ğŸ“Š\x20','getProcessingPaymentsStats','PENDING\x20cleanup\x20service\x20error:\x20','2508282cCqeCk','\x20\x20\x20Amount:\x20','â°\x20Processing\x20stale\x20PENDING\x20payment:\x20','\x20from\x20PROCESSING\x20to\x20FAILED','expireSinglePaymentLinks','log','ğŸ“Š\x20PENDING\x20payments\x20before\x20cleanup:\x20','ğŸ“‹\x20Fast\x20timeout\x20gateways:\x20','payment_cleanup','logWebhookError','\x20\x20\x20ğŸ“‰\x20Total\x20stale\x20payments\x20reduced\x20by:\x20','âœ…\x20PROCESSING\x20payments\x20processed:\x20','\x20\x20\x20By\x20gateway:','error','\x20(gateway:\x20','9682360MomltZ','ğŸš€\x20Starting\x20PENDING\x20payments\x20cleanup\x20only...','name','52716dnvDNK','defineProperty','visa/mastercard','\x20\x20\x20Gateway:\x20','PROCESSING','paymentCleanupService','byStatus','expired','loggerService','byAge','admin','\x20\x20\x20By\x20status:','byGateway','â°\x20Expired\x20link\x20','3\x20days','Unknown\x20error','Cleanup\x20service\x20error:\x20','ğŸ“Š\x20Stale\x20payments\x20(PROCESSING\x20+\x20PENDING)\x20before\x20cleanup:','join','logApiCall','auto_timeout','69nJcXAr','SLOW_TIMEOUT_DAYS','PROCESSING_TIMEOUT_DAYS','\x20\x20\x20Fresh\x20(<\x201\x20day):\x20','ğŸš€\x20Starting\x20payment\x20cleanup\x20service...','Link\x20expiration\x20service\x20error:\x20','\x20links\x20expired','failed','ğŸš€\x20Starting\x20PROCESSING\x20payments\x20cleanup\x20only...','âœ…\x20Updated\x20payment\x20','getDate','cleanupStalePendingPayments','PENDING\x20cleanup\x20completed:\x20','setDate','115mYBHHe','10tHGxyA','gateway','forEach','runPendingCleanupOnly','PENDING','Cleanup\x20completed:\x20','957ssfQhP','now','\x20timeout)','\x20stale\x20PROCESSING\x20payments','2QdkpDB','PENDING_TIMEOUT_DAYS','mastercard','squirrelpay','ğŸ“…\x20Looking\x20for\x20PROCESSING\x20payments\x20older\x20than:\x20','payments','getTime','\x0ağŸ“ˆ\x20Cleanup\x20Summary:','FAST_TIMEOUT_MINUTES','Failed\x20to\x20update\x20payment\x20','\x0ağŸ“Š\x20Stale\x20payments\x20(PROCESSING\x20+\x20PENDING)\x20after\x20cleanup:'];a74_0x5e2b=function(){return _0x4bd0f0;};return a74_0x5e2b();}exports[a74_0x5dfb26(0x122)]=PaymentCleanupService,exports[a74_0x5dfb26(0xbb)]=new PaymentCleanupService();