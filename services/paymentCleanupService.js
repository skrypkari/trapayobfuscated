'use strict';const a76_0x3951b9=a76_0x5320;(function(_0x4567f2,_0xca886a){const _0x1b9c98=a76_0x5320,_0x39aa2a=_0x4567f2();while(!![]){try{const _0x4b05eb=-parseInt(_0x1b9c98(0x194))/0x1*(parseInt(_0x1b9c98(0x1b6))/0x2)+parseInt(_0x1b9c98(0x1c7))/0x3*(parseInt(_0x1b9c98(0x185))/0x4)+parseInt(_0x1b9c98(0x1d3))/0x5+-parseInt(_0x1b9c98(0x176))/0x6+parseInt(_0x1b9c98(0x1e2))/0x7*(-parseInt(_0x1b9c98(0x1aa))/0x8)+parseInt(_0x1b9c98(0x1e0))/0x9*(-parseInt(_0x1b9c98(0x197))/0xa)+parseInt(_0x1b9c98(0x165))/0xb;if(_0x4b05eb===_0xca886a)break;else _0x39aa2a['push'](_0x39aa2a['shift']());}catch(_0x17c324){_0x39aa2a['push'](_0x39aa2a['shift']());}}}(a76_0x1944,0x7d105));function a76_0x5320(_0x5dd438,_0x32a005){_0x5dd438=_0x5dd438-0x15e;const _0x1944e1=a76_0x1944();let _0x5320f1=_0x1944e1[_0x5dd438];return _0x5320f1;}var __importDefault=this&&this[a76_0x3951b9(0x1bf)]||function(_0x16ef25){const _0x1e7f63=a76_0x3951b9;return _0x16ef25&&_0x16ef25[_0x1e7f63(0x1df)]?_0x16ef25:{'default':_0x16ef25};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a76_0x3951b9(0x1e6)]=exports[a76_0x3951b9(0x16d)]=void 0x0;const database_1=__importDefault(require(a76_0x3951b9(0x1d4))),client_1=require(a76_0x3951b9(0x1a3)),loggerService_1=require(a76_0x3951b9(0x15e));class PaymentCleanupService{constructor(){const _0x589a7a=a76_0x3951b9;this[_0x589a7a(0x15f)]=0x5,this[_0x589a7a(0x19c)]=0x5,this[_0x589a7a(0x16b)]=0x1e,this[_0x589a7a(0x1a6)]=0x3,this['FAST_TIMEOUT_GATEWAYS']=[_0x589a7a(0x16c),_0x589a7a(0x183),_0x589a7a(0x1a1),_0x589a7a(0x1e7),_0x589a7a(0x1c6),_0x589a7a(0x1bc)];}async['cleanupStaleProcessingPayments'](){const _0x283c81=a76_0x3951b9,_0x3f34cf=[];let _0x4260a3=0x0,_0x57910b=0x0;try{console[_0x283c81(0x1d6)](_0x283c81(0x1cf));const _0x53c877=new Date();_0x53c877[_0x283c81(0x16a)](_0x53c877[_0x283c81(0x18e)]()-this['PROCESSING_TIMEOUT_DAYS']),console['log']('ðŸ“…\x20Looking\x20for\x20PROCESSING\x20payments\x20older\x20than:\x20'+_0x53c877[_0x283c81(0x174)]());const _0x38c6a5=await database_1['default'][_0x283c81(0x1a0)]['findMany']({'where':{'status':client_1['PaymentStatus'][_0x283c81(0x1a8)],'createdAt':{'lt':_0x53c877}},'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![]}}}});console[_0x283c81(0x1d6)]('ðŸ”\x20Found\x20'+_0x38c6a5[_0x283c81(0x17e)]+_0x283c81(0x172));if(_0x38c6a5['length']===0x0)return console[_0x283c81(0x1d6)](_0x283c81(0x195)),{'processed':0x0,'failed':0x0,'errors':[]};for(const _0x2c2b96 of _0x38c6a5){try{console[_0x283c81(0x1d6)]('â±ï¸\x20Processing\x20stale\x20payment:\x20'+_0x2c2b96['id']+'\x20('+_0x2c2b96[_0x283c81(0x1b7)]+',\x20'+_0x2c2b96[_0x283c81(0x1c2)]+'\x20'+_0x2c2b96['currency']+')'),console['log'](_0x283c81(0x1ca)+_0x2c2b96[_0x283c81(0x19b)][_0x283c81(0x1e1)]+'\x20('+_0x2c2b96['shop'][_0x283c81(0x1d2)]+')'),console[_0x283c81(0x1d6)]('\x20\x20\x20Created:\x20'+_0x2c2b96['createdAt']['toISOString']()),console['log']('\x20\x20\x20Age:\x20'+Math[_0x283c81(0x173)]((Date[_0x283c81(0x16f)]()-_0x2c2b96[_0x283c81(0x1eb)][_0x283c81(0x1d1)]())/(0x3e8*0x3c*0x3c*0x18))+_0x283c81(0x169));const _0x494dab=await database_1[_0x283c81(0x187)]['payment'][_0x283c81(0x192)]({'where':{'id':_0x2c2b96['id']},'data':{'status':client_1['PaymentStatus'][_0x283c81(0x163)],'statusChangedBy':_0x283c81(0x1a7),'statusChangedAt':new Date(),'failureMessage':_0x283c81(0x1c5)+this[_0x283c81(0x15f)]+_0x283c81(0x169)}});console[_0x283c81(0x1d6)](_0x283c81(0x178)+_0x2c2b96['id']+_0x283c81(0x170)),loggerService_1['loggerService'][_0x283c81(0x1ab)](_0x2c2b96[_0x283c81(0x1b7)],_0x2c2b96['id'],_0x283c81(0x1a8),_0x283c81(0x163),{'reason':'auto_timeout','timeoutDays':this[_0x283c81(0x15f)]}),_0x4260a3++;}catch(_0x3310f6){const _0x451402=_0x283c81(0x1ad)+_0x2c2b96['id']+':\x20'+(_0x3310f6 instanceof Error?_0x3310f6[_0x283c81(0x1bb)]:_0x283c81(0x1db));console[_0x283c81(0x17f)]('âŒ\x20'+_0x451402),_0x3f34cf[_0x283c81(0x1a9)](_0x451402),_0x57910b++;}}const _0x341d03=_0x283c81(0x171)+_0x4260a3+_0x283c81(0x162)+_0x57910b+_0x283c81(0x196);return console[_0x283c81(0x1d6)](_0x283c81(0x179)+_0x341d03),loggerService_1[_0x283c81(0x1b5)]['logApiCall']('payment_cleanup',_0x283c81(0x1e5),_0x283c81(0x1a7),_0x283c81(0x186),{'processed':_0x4260a3,'failed':_0x57910b,'errors':_0x3f34cf,'timeoutDays':this[_0x283c81(0x15f)]}),{'processed':_0x4260a3,'failed':_0x57910b,'errors':_0x3f34cf};}catch(_0x4dc239){const _0xc9d2fe='Cleanup\x20service\x20error:\x20'+(_0x4dc239 instanceof Error?_0x4dc239[_0x283c81(0x1bb)]:'Unknown\x20error');return console[_0x283c81(0x17f)](_0x283c81(0x1af)+_0xc9d2fe),_0x3f34cf['push'](_0xc9d2fe),loggerService_1[_0x283c81(0x1b5)]['logWebhookError'](_0x283c81(0x181),_0xc9d2fe,{'timeoutDays':this[_0x283c81(0x15f)]}),{'processed':_0x4260a3,'failed':_0x57910b,'errors':_0x3f34cf};}}async[a76_0x3951b9(0x18c)](){const _0x298507=a76_0x3951b9,_0xd4c293=[];let _0x465ae0=0x0,_0x2b8404=0x0;try{console['log']('ðŸ§¹\x20Starting\x20cleanup\x20of\x20stale\x20PENDING\x20payments...');const _0xdefd5c=new Date(),_0x19bad7=new Date(_0xdefd5c[_0x298507(0x1d1)]()-this[_0x298507(0x16b)]*0x3c*0x3e8),_0x34978e=new Date();_0x34978e[_0x298507(0x16a)](_0x34978e[_0x298507(0x18e)]()-this[_0x298507(0x1a6)]),console[_0x298507(0x1d6)](_0x298507(0x199)+_0x19bad7['toISOString']()),console[_0x298507(0x1d6)](_0x298507(0x1e9)+_0x34978e['toISOString']()),console['log'](_0x298507(0x1d9)+this[_0x298507(0x1b4)][_0x298507(0x19e)](',\x20'));const _0x1e950e=await database_1[_0x298507(0x187)]['payment'][_0x298507(0x1b2)]({'where':{'status':client_1['PaymentStatus'][_0x298507(0x17d)],'OR':[{'gateway':{'in':this[_0x298507(0x1b4)]},'createdAt':{'lt':_0x19bad7}},{'gateway':{'notIn':this[_0x298507(0x1b4)]},'createdAt':{'lt':_0x34978e}}]},'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![]}}}});console['log']('ðŸ”\x20Found\x20'+_0x1e950e[_0x298507(0x17e)]+_0x298507(0x1c8));if(_0x1e950e[_0x298507(0x17e)]===0x0)return console[_0x298507(0x1d6)](_0x298507(0x1e8)),{'processed':0x0,'failed':0x0,'errors':[]};for(const _0x2cd4aa of _0x1e950e){try{const _0x4656a4=this[_0x298507(0x1b4)][_0x298507(0x1ba)](_0x2cd4aa[_0x298507(0x1b7)]),_0x34b0cf=_0x4656a4?_0x298507(0x19f):'3\x20days',_0x402b5e=Math[_0x298507(0x173)]((Date['now']()-_0x2cd4aa[_0x298507(0x1eb)][_0x298507(0x1d1)]())/(0x3e8*0x3c));console[_0x298507(0x1d6)](_0x298507(0x175)+_0x2cd4aa['id']),console['log']('\x20\x20\x20Gateway:\x20'+_0x2cd4aa[_0x298507(0x1b7)]+'\x20('+_0x34b0cf+_0x298507(0x182)),console[_0x298507(0x1d6)](_0x298507(0x1e3)+_0x2cd4aa[_0x298507(0x1c2)]+'\x20'+_0x2cd4aa['currency']),console[_0x298507(0x1d6)](_0x298507(0x1ca)+_0x2cd4aa['shop'][_0x298507(0x1e1)]+'\x20('+_0x2cd4aa['shop'][_0x298507(0x1d2)]+')'),console[_0x298507(0x1d6)]('\x20\x20\x20Created:\x20'+_0x2cd4aa[_0x298507(0x1eb)][_0x298507(0x174)]()),console[_0x298507(0x1d6)](_0x298507(0x1cd)+_0x402b5e+_0x298507(0x1bd));const _0x151675=await database_1[_0x298507(0x187)][_0x298507(0x1a0)]['update']({'where':{'id':_0x2cd4aa['id']},'data':{'status':client_1[_0x298507(0x1b8)][_0x298507(0x1c4)],'statusChangedBy':_0x298507(0x1a7),'statusChangedAt':new Date(),'failureMessage':'Payment\x20timeout:\x20No\x20payment\x20action\x20received\x20within\x20'+_0x34b0cf}});console[_0x298507(0x1d6)]('âœ…\x20Updated\x20payment\x20'+_0x2cd4aa['id']+'\x20from\x20PENDING\x20to\x20EXPIRED'),loggerService_1[_0x298507(0x1b5)][_0x298507(0x1ab)](_0x2cd4aa[_0x298507(0x1b7)],_0x2cd4aa['id'],'PENDING',_0x298507(0x1c4),{'reason':_0x298507(0x18a),'timeout':_0x34b0cf,'ageMinutes':_0x402b5e}),_0x465ae0++;}catch(_0x4f121a){const _0x373ea9='Failed\x20to\x20update\x20PENDING\x20payment\x20'+_0x2cd4aa['id']+':\x20'+(_0x4f121a instanceof Error?_0x4f121a[_0x298507(0x1bb)]:_0x298507(0x1db));console[_0x298507(0x17f)]('âŒ\x20'+_0x373ea9),_0xd4c293[_0x298507(0x1a9)](_0x373ea9),_0x2b8404++;}}const _0x282c5a=_0x298507(0x177)+_0x465ae0+_0x298507(0x1c1)+_0x2b8404+_0x298507(0x196);return console['log'](_0x298507(0x179)+_0x282c5a),loggerService_1['loggerService']['logApiCall']('pending_payment_cleanup',_0x298507(0x1e5),_0x298507(0x1a7),'admin',{'processed':_0x465ae0,'failed':_0x2b8404,'errors':_0xd4c293,'fastTimeoutMinutes':this['FAST_TIMEOUT_MINUTES'],'slowTimeoutDays':this[_0x298507(0x1a6)]}),{'processed':_0x465ae0,'failed':_0x2b8404,'errors':_0xd4c293};}catch(_0x42c258){const _0x22891f=_0x298507(0x160)+(_0x42c258 instanceof Error?_0x42c258[_0x298507(0x1bb)]:_0x298507(0x1db));return console[_0x298507(0x17f)](_0x298507(0x1af)+_0x22891f),_0xd4c293[_0x298507(0x1a9)](_0x22891f),loggerService_1[_0x298507(0x1b5)][_0x298507(0x1d0)]('pending_payment_cleanup',_0x22891f,{'timeoutDays':this[_0x298507(0x19c)]}),{'processed':_0x465ae0,'failed':_0x2b8404,'errors':_0xd4c293};}}async[a76_0x3951b9(0x193)](){const _0x10aace=a76_0x3951b9;try{const _0x4a348c=new Date(),_0x50a2e3=new Date(_0x4a348c[_0x10aace(0x1d1)]()-0x1*0x18*0x3c*0x3c*0x3e8),_0x2de508=new Date(_0x4a348c[_0x10aace(0x1d1)]()-0x3*0x18*0x3c*0x3c*0x3e8),_0x4f0a75=new Date(_0x4a348c['getTime']()-0x5*0x18*0x3c*0x3c*0x3e8),_0x517b55=await database_1[_0x10aace(0x187)][_0x10aace(0x1a0)][_0x10aace(0x1b2)]({'where':{'status':{'in':[client_1[_0x10aace(0x1b8)][_0x10aace(0x1a8)],client_1[_0x10aace(0x1b8)][_0x10aace(0x17d)]]}},'select':{'id':!![],'gateway':!![],'status':!![],'createdAt':!![]}}),_0x2ba7d1={'total':_0x517b55[_0x10aace(0x17e)],'byAge':{'fresh':0x0,'recent':0x0,'stale':0x0,'expired':0x0},'byGateway':{},'byStatus':{}};for(const _0x3e495c of _0x517b55){if(_0x3e495c[_0x10aace(0x1eb)]>_0x50a2e3)_0x2ba7d1[_0x10aace(0x18d)][_0x10aace(0x1ae)]++;else{if(_0x3e495c[_0x10aace(0x1eb)]>_0x2de508)_0x2ba7d1[_0x10aace(0x18d)]['recent']++;else _0x3e495c[_0x10aace(0x1eb)]>_0x4f0a75?_0x2ba7d1[_0x10aace(0x18d)][_0x10aace(0x17a)]++:_0x2ba7d1['byAge'][_0x10aace(0x1ee)]++;}!_0x2ba7d1[_0x10aace(0x1a4)][_0x3e495c[_0x10aace(0x1b7)]]&&(_0x2ba7d1[_0x10aace(0x1a4)][_0x3e495c[_0x10aace(0x1b7)]]=0x0);_0x2ba7d1['byGateway'][_0x3e495c[_0x10aace(0x1b7)]]++;const _0x1b7b63=_0x3e495c['status'];!_0x2ba7d1[_0x10aace(0x198)][_0x1b7b63]&&(_0x2ba7d1['byStatus'][_0x1b7b63]=0x0),_0x2ba7d1[_0x10aace(0x198)][_0x1b7b63]++;}return _0x2ba7d1;}catch(_0xc45748){console['error']('Failed\x20to\x20get\x20processing\x20payments\x20stats:',_0xc45748);throw new Error(_0x10aace(0x164)+(_0xc45748 instanceof Error?_0xc45748['message']:_0x10aace(0x1db)));}}async[a76_0x3951b9(0x1b0)](){const _0x3d0dff=a76_0x3951b9;console[_0x3d0dff(0x1d6)]('ðŸš€\x20Starting\x20payment\x20cleanup\x20service...');const _0xe5bc7b=await this[_0x3d0dff(0x193)]();console['log']('ðŸ“Š\x20Stale\x20payments\x20(PROCESSING\x20+\x20PENDING)\x20before\x20cleanup:'),console[_0x3d0dff(0x1d6)]('\x20\x20\x20Total:\x20'+_0xe5bc7b[_0x3d0dff(0x161)]),console[_0x3d0dff(0x1d6)](_0x3d0dff(0x1dc)+_0xe5bc7b['byAge'][_0x3d0dff(0x1ae)]),console[_0x3d0dff(0x1d6)](_0x3d0dff(0x188)+_0xe5bc7b[_0x3d0dff(0x18d)]['recent']),console[_0x3d0dff(0x1d6)](_0x3d0dff(0x1a2)+_0xe5bc7b['byAge'][_0x3d0dff(0x17a)]),console[_0x3d0dff(0x1d6)](_0x3d0dff(0x1cb)+_0xe5bc7b[_0x3d0dff(0x18d)][_0x3d0dff(0x1ee)]),console[_0x3d0dff(0x1d6)]('\x20\x20\x20By\x20gateway:',_0xe5bc7b[_0x3d0dff(0x1a4)]),console[_0x3d0dff(0x1d6)]('\x20\x20\x20By\x20status:',_0xe5bc7b[_0x3d0dff(0x198)]),console['log']('\x0aðŸ”„\x20Running\x20PROCESSING\x20payments\x20cleanup...');const _0x4b3f6d=await this[_0x3d0dff(0x1ce)]();console['log'](_0x3d0dff(0x1ac));const _0x5ad749=await this['cleanupStalePendingPayments'](),_0x332a23=await this[_0x3d0dff(0x193)]();console[_0x3d0dff(0x1d6)](_0x3d0dff(0x1ec)),console['log'](_0x3d0dff(0x166)+_0x332a23[_0x3d0dff(0x161)]),console[_0x3d0dff(0x1d6)](_0x3d0dff(0x1cb)+_0x332a23[_0x3d0dff(0x18d)][_0x3d0dff(0x1ee)]),console[_0x3d0dff(0x1d6)]('\x20\x20\x20By\x20status:',_0x332a23[_0x3d0dff(0x198)]);const _0x4206a9=_0x4b3f6d[_0x3d0dff(0x1c0)]+_0x5ad749['processed'],_0x41b012=_0x4b3f6d['failed']+_0x5ad749[_0x3d0dff(0x16e)],_0x18ec8e=[..._0x4b3f6d[_0x3d0dff(0x1da)],..._0x5ad749[_0x3d0dff(0x1da)]];console[_0x3d0dff(0x1d6)]('\x0aðŸ“ˆ\x20Cleanup\x20Summary:'),console[_0x3d0dff(0x1d6)](_0x3d0dff(0x1ea)+_0x4b3f6d[_0x3d0dff(0x1c0)]),console[_0x3d0dff(0x1d6)]('\x20\x20\x20â°\x20PENDING\x20â†’\x20EXPIRED:\x20'+_0x5ad749[_0x3d0dff(0x1c0)]),console[_0x3d0dff(0x1d6)](_0x3d0dff(0x1d8)+_0x4206a9),console[_0x3d0dff(0x1d6)]('\x20\x20\x20âŒ\x20Total\x20failed\x20to\x20process:\x20'+_0x41b012),console[_0x3d0dff(0x1d6)]('\x20\x20\x20ðŸ“‰\x20Total\x20stale\x20payments\x20reduced\x20by:\x20'+(_0xe5bc7b['total']-_0x332a23['total'])),_0x18ec8e[_0x3d0dff(0x17e)]>0x0&&(console['log'](_0x3d0dff(0x1e4)),_0x18ec8e['forEach']((_0x22be73,_0x5f2226)=>{const _0x24704e=_0x3d0dff;console[_0x24704e(0x1d6)](_0x24704e(0x19d)+(_0x5f2226+0x1)+'.\x20'+_0x22be73);})),console[_0x3d0dff(0x1d6)](_0x3d0dff(0x184));}async['runProcessingCleanupOnly'](){const _0x2512b6=a76_0x3951b9;console['log'](_0x2512b6(0x1ef));const _0x3ae0eb=await this[_0x2512b6(0x193)](),_0xdf141b=_0x3ae0eb[_0x2512b6(0x198)][_0x2512b6(0x1a8)]||0x0;console[_0x2512b6(0x1d6)](_0x2512b6(0x180)+_0xdf141b);const _0x3fe67a=await this['cleanupStaleProcessingPayments'](),_0xb3c5a3=await this['getProcessingPaymentsStats'](),_0x3f3ca0=_0xb3c5a3[_0x2512b6(0x198)][_0x2512b6(0x1a8)]||0x0;console[_0x2512b6(0x1d6)]('ðŸ“Š\x20PROCESSING\x20payments\x20after\x20cleanup:\x20'+_0x3f3ca0),console[_0x2512b6(0x1d6)](_0x2512b6(0x1b3)+_0x3fe67a[_0x2512b6(0x1c0)]),console[_0x2512b6(0x1d6)]('ðŸ\x20PROCESSING\x20cleanup\x20completed');}async[a76_0x3951b9(0x1c3)](){const _0x579ebe=a76_0x3951b9;console[_0x579ebe(0x1d6)](_0x579ebe(0x168));const _0x170016=await this[_0x579ebe(0x193)](),_0x1bb3a3=_0x170016[_0x579ebe(0x198)][_0x579ebe(0x17d)]||0x0;console['log'](_0x579ebe(0x1a5)+_0x1bb3a3);const _0x3bdf4f=await this[_0x579ebe(0x18c)](),_0x6681cf=await this[_0x579ebe(0x193)](),_0x25f348=_0x6681cf[_0x579ebe(0x198)][_0x579ebe(0x17d)]||0x0;console[_0x579ebe(0x1d6)]('ðŸ“Š\x20PENDING\x20payments\x20after\x20cleanup:\x20'+_0x25f348),console[_0x579ebe(0x1d6)](_0x579ebe(0x17c)+_0x3bdf4f[_0x579ebe(0x1c0)]),console['log']('ðŸ\x20PENDING\x20cleanup\x20completed');}async[a76_0x3951b9(0x19a)](){const _0x4c566f=a76_0x3951b9,_0x2a12b3=[];let _0x37a95c=0x0;try{console[_0x4c566f(0x1d6)](_0x4c566f(0x167));const _0x2cb2fc=new Date(),_0x1b086a=['oxapay',_0x4c566f(0x1c6)],_0x5d3930=[_0x4c566f(0x16c),_0x4c566f(0x1a1),_0x4c566f(0x1e7),_0x4c566f(0x1ed)],_0x332500=await database_1['default'][_0x4c566f(0x191)][_0x4c566f(0x1b2)]({'where':{'type':_0x4c566f(0x17b),'status':_0x4c566f(0x1be)},'include':{'payments':{'orderBy':{'createdAt':_0x4c566f(0x1cc)},'take':0x1}}});console['log'](_0x4c566f(0x1de)+_0x332500[_0x4c566f(0x17e)]+'\x20active\x20SINGLE\x20links\x20to\x20check');for(const _0x5d35cc of _0x332500){try{if(_0x5d35cc['payments']['length']===0x0)continue;const _0x4d24fa=_0x5d35cc[_0x4c566f(0x1dd)][0x0];if(_0x4d24fa[_0x4c566f(0x189)]===_0x4c566f(0x190))continue;const _0x1be03a=_0x2cb2fc[_0x4c566f(0x1d1)]()-_0x4d24fa[_0x4c566f(0x1eb)][_0x4c566f(0x1d1)]();let _0x2f549c;_0x1b086a[_0x4c566f(0x1ba)](_0x5d35cc[_0x4c566f(0x1b7)])||_0x5d3930[_0x4c566f(0x1ba)](_0x5d35cc[_0x4c566f(0x1b7)])?_0x2f549c=0x1e*0x3c*0x3e8:_0x2f549c=0x3*0x18*0x3c*0x3c*0x3e8,_0x1be03a>_0x2f549c&&(await database_1[_0x4c566f(0x187)][_0x4c566f(0x191)][_0x4c566f(0x192)]({'where':{'id':_0x5d35cc['id']},'data':{'status':_0x4c566f(0x1c4)}}),console['log'](_0x4c566f(0x18b)+_0x5d35cc['id']+_0x4c566f(0x1c9)+_0x5d35cc[_0x4c566f(0x1b7)]+_0x4c566f(0x1d5)+Math['round'](_0x1be03a/0x3e8/0x3c)+_0x4c566f(0x1b1)),_0x37a95c++);}catch(_0x2d54b0){const _0x42e421=_0x4c566f(0x18f)+_0x5d35cc['id']+':\x20'+(_0x2d54b0 instanceof Error?_0x2d54b0[_0x4c566f(0x1bb)]:'Unknown\x20error');console[_0x4c566f(0x17f)]('âŒ\x20'+_0x42e421),_0x2a12b3[_0x4c566f(0x1a9)](_0x42e421);}}return console['log'](_0x4c566f(0x1b9)+_0x37a95c+'\x20links\x20expired'),{'expired':_0x37a95c,'errors':_0x2a12b3};}catch(_0x4b8873){const _0x3b5d8b=_0x4c566f(0x1d7)+(_0x4b8873 instanceof Error?_0x4b8873[_0x4c566f(0x1bb)]:'Unknown\x20error');return console[_0x4c566f(0x17f)]('ðŸ’¥\x20'+_0x3b5d8b),_0x2a12b3[_0x4c566f(0x1a9)](_0x3b5d8b),{'expired':_0x37a95c,'errors':_0x2a12b3};}}}exports[a76_0x3951b9(0x16d)]=PaymentCleanupService,exports[a76_0x3951b9(0x1e6)]=new PaymentCleanupService();function a76_0x1944(){const _0x45b253=['ðŸ“Š\x20','stale','SINGLE','âœ…\x20PENDING\x20payments\x20processed:\x20','PENDING','length','error','ðŸ“Š\x20PROCESSING\x20payments\x20before\x20cleanup:\x20','payment_cleanup','\x20timeout)','squirrel-pay','ðŸ\x20Payment\x20cleanup\x20service\x20completed','5036DDoJEV','admin','default','\x20\x20\x20Recent\x20(1-3\x20days):\x20','status','auto_timeout_pending','â°\x20Expired\x20link\x20','cleanupStalePendingPayments','byAge','getDate','Failed\x20to\x20expire\x20link\x20','PAID','paymentLink','update','getProcessingPaymentsStats','11Ggfnvm','âœ…\x20No\x20stale\x20PROCESSING\x20payments\x20found','\x20failed\x20to\x20update','5590yvIDgJ','byStatus','ðŸ“…\x20Fast\x20timeout\x20(30\x20min):\x20','expireSinglePaymentLinks','shop','PENDING_TIMEOUT_DAYS','\x20\x20\x20\x20\x20\x20','join','30\x20minutes','payment','rapyd','\x20\x20\x20Stale\x20(3-5\x20days):\x20','@prisma/client','byGateway','ðŸ“Š\x20PENDING\x20payments\x20before\x20cleanup:\x20','SLOW_TIMEOUT_DAYS','system','PROCESSING','push','1896TdBQFt','logWebhookProcessed','\x0aðŸ”„\x20Running\x20PENDING\x20payments\x20cleanup...','Failed\x20to\x20update\x20payment\x20','fresh','ðŸ’¥\x20','runCleanupWithReport','\x20minutes)','findMany','âœ…\x20PROCESSING\x20payments\x20processed:\x20','FAST_TIMEOUT_GATEWAYS','loggerService','25784BsDFhP','gateway','PaymentStatus','ðŸ“Š\x20Expiration\x20completed:\x20','includes','message','oxapay','\x20minutes','ACTIVE','__importDefault','processed','\x20payments\x20updated\x20to\x20EXPIRED,\x20','amount','runPendingCleanupOnly','EXPIRED','Payment\x20timeout:\x20No\x20status\x20update\x20received\x20for\x20','plisio','495XejJoU','\x20stale\x20PENDING\x20payments','\x20(gateway:\x20','\x20\x20\x20Shop:\x20','\x20\x20\x20Expired\x20(>\x205\x20days):\x20','desc','\x20\x20\x20Age:\x20','cleanupStaleProcessingPayments','ðŸ§¹\x20Starting\x20cleanup\x20of\x20stale\x20PROCESSING\x20payments...','logWebhookError','getTime','username','4917675QixvBx','../config/database',',\x20payment\x20age:\x20','log','Link\x20expiration\x20service\x20error:\x20','\x20\x20\x20âœ…\x20Total\x20successfully\x20processed:\x20','ðŸ“‹\x20Fast\x20timeout\x20gateways:\x20','errors','Unknown\x20error','\x20\x20\x20Fresh\x20(<\x201\x20day):\x20','payments','ðŸ”\x20Found\x20','__esModule','4761jqNrhA','name','1603dvreTW','\x20\x20\x20Amount:\x20','\x20\x20\x20âš ï¸\x20Errors\x20encountered:','POST','paymentCleanupService','visa/mastercard','âœ…\x20No\x20stale\x20PENDING\x20payments\x20found','ðŸ“…\x20Slow\x20timeout\x20(3\x20days):\x20','\x20\x20\x20ðŸ”„\x20PROCESSING\x20â†’\x20FAILED:\x20','createdAt','\x0aðŸ“Š\x20Stale\x20payments\x20(PROCESSING\x20+\x20PENDING)\x20after\x20cleanup:','mastercard','expired','ðŸš€\x20Starting\x20PROCESSING\x20payments\x20cleanup\x20only...','./loggerService','PROCESSING_TIMEOUT_DAYS','PENDING\x20cleanup\x20service\x20error:\x20','total','\x20payments\x20updated\x20to\x20FAILED,\x20','FAILED','Failed\x20to\x20get\x20processing\x20payments\x20stats:\x20','2330317ISZIrC','\x20\x20\x20Total:\x20','â°\x20Starting\x20expiration\x20check\x20for\x20SINGLE\x20payment\x20links...','ðŸš€\x20Starting\x20PENDING\x20payments\x20cleanup\x20only...','\x20days','setDate','FAST_TIMEOUT_MINUTES','squirrelpay','PaymentCleanupService','failed','now','\x20from\x20PROCESSING\x20to\x20FAILED','Cleanup\x20completed:\x20','\x20stale\x20PROCESSING\x20payments','floor','toISOString','â°\x20Processing\x20stale\x20PENDING\x20payment:\x20','2394360lVBnEW','PENDING\x20cleanup\x20completed:\x20','âœ…\x20Updated\x20payment\x20'];a76_0x1944=function(){return _0x45b253;};return a76_0x1944();}