'use strict';function a80_0x2542(_0x14219a,_0x5d9b7a){_0x14219a=_0x14219a-0x1da;const _0x1c8524=a80_0x1c85();let _0x254264=_0x1c8524[_0x14219a];return _0x254264;}function a80_0x1c85(){const _0x3f04ef=['runCleanupWithReport','auto_timeout_pending','PENDING\x20cleanup\x20service\x20error:\x20','pending_payment_cleanup','\x0ağŸ“ˆ\x20Cleanup\x20Summary:','status','34wFqKVy','Cleanup\x20service\x20error:\x20','751kNYutV','expireSinglePaymentLinks','__importDefault','username','createdAt','cleanupStalePendingPayments','@prisma/client','â°\x20Expired\x20link\x20','\x20\x20\x20By\x20status:','name','shop','Failed\x20to\x20update\x20PENDING\x20payment\x20','SLOW_TIMEOUT_DAYS','ğŸ“…\x20Looking\x20for\x20PROCESSING\x20payments\x20older\x20than:\x20','ACTIVE','amount','ğŸ§¹\x20Starting\x20cleanup\x20of\x20stale\x20PENDING\x20payments...','Failed\x20to\x20get\x20processing\x20payments\x20stats:','Payment\x20timeout:\x20No\x20status\x20update\x20received\x20for\x20','312040JJWiEX','auto_timeout','squirrelpay','\x0ağŸ“Š\x20Stale\x20payments\x20(PROCESSING\x20+\x20PENDING)\x20after\x20cleanup:','3\x20days','PAID','payments','\x20payments\x20updated\x20to\x20FAILED,\x20','ğŸ“Š\x20','stale','EXPIRED','paymentLink','ğŸ”\x20Found\x20','FAILED','730723WQgBdH','oxapay','âœ…\x20Updated\x20payment\x20','\x0ağŸ”„\x20Running\x20PENDING\x20payments\x20cleanup...','\x20from\x20PROCESSING\x20to\x20FAILED','POST','getDate','mastercard','paymentCleanupService','330411WeCDnJ','PENDING\x20cleanup\x20completed:\x20','findMany','ğŸ’¥\x20','\x20failed\x20to\x20update','payment_cleanup','FAST_TIMEOUT_MINUTES','ğŸ“Š\x20PENDING\x20payments\x20before\x20cleanup:\x20','âœ…\x20PROCESSING\x20payments\x20processed:\x20','visa/mastercard','\x20\x20\x20Recent\x20(1-3\x20days):\x20','byGateway','total','Cleanup\x20completed:\x20','__esModule','\x20stale\x20PENDING\x20payments','\x20(gateway:\x20','ğŸ“Š\x20Expiration\x20completed:\x20','ğŸ“Š\x20Stale\x20payments\x20(PROCESSING\x20+\x20PENDING)\x20before\x20cleanup:','rapyd','PENDING','logWebhookProcessed','processed','\x20\x20\x20By\x20gateway:','FAST_TIMEOUT_GATEWAYS','ğŸ“Š\x20PENDING\x20payments\x20after\x20cleanup:\x20','ğŸ\x20PROCESSING\x20cleanup\x20completed','\x20\x20\x20Created:\x20','floor','PROCESSING_TIMEOUT_DAYS','Link\x20expiration\x20service\x20error:\x20','\x20days','includes','getProcessingPaymentsStats','\x20minutes','byStatus','logWebhookError','PaymentCleanupService','1470015NMcxnA','\x20stale\x20PROCESSING\x20payments','loggerService','error','SINGLE','currency','8aKUbEY','byAge','\x20\x20\x20â°\x20PENDING\x20â†’\x20EXPIRED:\x20','ğŸš€\x20Starting\x20PROCESSING\x20payments\x20cleanup\x20only...','â°\x20Processing\x20stale\x20PENDING\x20payment:\x20','\x20timeout)','\x0ağŸ”„\x20Running\x20PROCESSING\x20payments\x20cleanup...','expired',',\x20payment\x20age:\x20','squirrel-pay','\x20active\x20SINGLE\x20links\x20to\x20check','\x20\x20\x20Fresh\x20(<\x201\x20day):\x20','ğŸ§¹\x20Starting\x20cleanup\x20of\x20stale\x20PROCESSING\x20payments...','ğŸ“Š\x20PROCESSING\x20payments\x20after\x20cleanup:\x20','565500lBfbda','ğŸš€\x20Starting\x20PENDING\x20payments\x20cleanup\x20only...','fresh','./loggerService','\x20\x20\x20Total:\x20','PENDING_TIMEOUT_DAYS','âœ…\x20PENDING\x20payments\x20processed:\x20','push','\x20\x20\x20Expired\x20(>\x205\x20days):\x20','\x20\x20\x20âœ…\x20Total\x20successfully\x20processed:\x20','ğŸš€\x20Starting\x20payment\x20cleanup\x20service...','getTime','recent','gateway','ğŸ\x20PENDING\x20cleanup\x20completed','admin','PROCESSING','failed','payment','errors','ğŸ“Š\x20PROCESSING\x20payments\x20before\x20cleanup:\x20','cleanupStaleProcessingPayments','PaymentStatus','ğŸ\x20Payment\x20cleanup\x20service\x20completed','length','now','796698kiWAsZ','../config/database','message','system','\x20links\x20expired','Failed\x20to\x20expire\x20link\x20','logApiCall','â°\x20Starting\x20expiration\x20check\x20for\x20SINGLE\x20payment\x20links...','Unknown\x20error','desc','toISOString','log','\x20\x20\x20\x20\x20\x20','join','update','\x20\x20\x20Shop:\x20','default','ğŸ“‹\x20Fast\x20timeout\x20gateways:\x20'];a80_0x1c85=function(){return _0x3f04ef;};return a80_0x1c85();}const a80_0xa67f0b=a80_0x2542;(function(_0x4bcc97,_0x4d275e){const _0x3eaaa2=a80_0x2542,_0x474278=_0x4bcc97();while(!![]){try{const _0x63d36e=-parseInt(_0x3eaaa2(0x1e5))/0x1*(parseInt(_0x3eaaa2(0x1e3))/0x2)+parseInt(_0x3eaaa2(0x20f))/0x3*(-parseInt(_0x3eaaa2(0x23b))/0x4)+parseInt(_0x3eaaa2(0x249))/0x5+parseInt(_0x3eaaa2(0x263))/0x6+-parseInt(_0x3eaaa2(0x206))/0x7+parseInt(_0x3eaaa2(0x1f8))/0x8+parseInt(_0x3eaaa2(0x235))/0x9;if(_0x63d36e===_0x4d275e)break;else _0x474278['push'](_0x474278['shift']());}catch(_0x45ae1f){_0x474278['push'](_0x474278['shift']());}}}(a80_0x1c85,0x1b0c9));var __importDefault=this&&this[a80_0xa67f0b(0x1e7)]||function(_0x532929){const _0x438850=a80_0xa67f0b;return _0x532929&&_0x532929[_0x438850(0x21d)]?_0x532929:{'default':_0x532929};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a80_0xa67f0b(0x20e)]=exports[a80_0xa67f0b(0x234)]=void 0x0;const database_1=__importDefault(require(a80_0xa67f0b(0x264))),client_1=require(a80_0xa67f0b(0x1eb)),loggerService_1=require(a80_0xa67f0b(0x24c));class PaymentCleanupService{constructor(){const _0x1bfe96=a80_0xa67f0b;this[_0x1bfe96(0x22c)]=0x5,this['PENDING_TIMEOUT_DAYS']=0x5,this[_0x1bfe96(0x215)]=0x1e,this['SLOW_TIMEOUT_DAYS']=0x3,this[_0x1bfe96(0x227)]=['squirrelpay',_0x1bfe96(0x244),_0x1bfe96(0x222),_0x1bfe96(0x218),'plisio',_0x1bfe96(0x207)];}async[a80_0xa67f0b(0x25e)](){const _0x29a95a=a80_0xa67f0b,_0x6f0879=[];let _0x36a778=0x0,_0x91dd4=0x0;try{console['log'](_0x29a95a(0x247));const _0x2175ed=new Date();_0x2175ed['setDate'](_0x2175ed['getDate']()-this[_0x29a95a(0x22c)]),console[_0x29a95a(0x26e)](_0x29a95a(0x1f2)+_0x2175ed['toISOString']());const _0x53b643=await database_1[_0x29a95a(0x1db)]['payment'][_0x29a95a(0x211)]({'where':{'status':client_1[_0x29a95a(0x25f)][_0x29a95a(0x259)],'createdAt':{'lt':_0x2175ed}},'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![]}}}});console[_0x29a95a(0x26e)](_0x29a95a(0x204)+_0x53b643[_0x29a95a(0x261)]+_0x29a95a(0x236));if(_0x53b643[_0x29a95a(0x261)]===0x0)return console[_0x29a95a(0x26e)]('âœ…\x20No\x20stale\x20PROCESSING\x20payments\x20found'),{'processed':0x0,'failed':0x0,'errors':[]};for(const _0x8ab746 of _0x53b643){try{console[_0x29a95a(0x26e)]('â±ï¸\x20Processing\x20stale\x20payment:\x20'+_0x8ab746['id']+'\x20('+_0x8ab746['gateway']+',\x20'+_0x8ab746[_0x29a95a(0x1f4)]+'\x20'+_0x8ab746[_0x29a95a(0x23a)]+')'),console[_0x29a95a(0x26e)](_0x29a95a(0x1da)+_0x8ab746[_0x29a95a(0x1ef)][_0x29a95a(0x1ee)]+'\x20('+_0x8ab746[_0x29a95a(0x1ef)][_0x29a95a(0x1e8)]+')'),console['log']('\x20\x20\x20Created:\x20'+_0x8ab746[_0x29a95a(0x1e9)]['toISOString']()),console[_0x29a95a(0x26e)]('\x20\x20\x20Age:\x20'+Math[_0x29a95a(0x22b)]((Date[_0x29a95a(0x262)]()-_0x8ab746['createdAt'][_0x29a95a(0x254)]())/(0x3e8*0x3c*0x3c*0x18))+_0x29a95a(0x22e));const _0x3a24e0=await database_1[_0x29a95a(0x1db)]['payment'][_0x29a95a(0x271)]({'where':{'id':_0x8ab746['id']},'data':{'status':client_1['PaymentStatus'][_0x29a95a(0x205)],'statusChangedBy':_0x29a95a(0x266),'statusChangedAt':new Date(),'failureMessage':_0x29a95a(0x1f7)+this[_0x29a95a(0x22c)]+_0x29a95a(0x22e)}});console['log'](_0x29a95a(0x208)+_0x8ab746['id']+_0x29a95a(0x20a)),loggerService_1[_0x29a95a(0x237)][_0x29a95a(0x224)](_0x8ab746['gateway'],_0x8ab746['id'],'PROCESSING',_0x29a95a(0x205),{'reason':_0x29a95a(0x1f9),'timeoutDays':this[_0x29a95a(0x22c)]}),_0x36a778++;}catch(_0xc289ae){const _0x5953eb='Failed\x20to\x20update\x20payment\x20'+_0x8ab746['id']+':\x20'+(_0xc289ae instanceof Error?_0xc289ae[_0x29a95a(0x265)]:_0x29a95a(0x26b));console[_0x29a95a(0x238)]('âŒ\x20'+_0x5953eb),_0x6f0879['push'](_0x5953eb),_0x91dd4++;}}const _0x5183d5=_0x29a95a(0x21c)+_0x36a778+_0x29a95a(0x1ff)+_0x91dd4+'\x20failed\x20to\x20update';return console[_0x29a95a(0x26e)](_0x29a95a(0x200)+_0x5183d5),loggerService_1[_0x29a95a(0x237)][_0x29a95a(0x269)](_0x29a95a(0x214),'POST',_0x29a95a(0x266),_0x29a95a(0x258),{'processed':_0x36a778,'failed':_0x91dd4,'errors':_0x6f0879,'timeoutDays':this[_0x29a95a(0x22c)]}),{'processed':_0x36a778,'failed':_0x91dd4,'errors':_0x6f0879};}catch(_0x54d2c2){const _0x37e23d=_0x29a95a(0x1e4)+(_0x54d2c2 instanceof Error?_0x54d2c2[_0x29a95a(0x265)]:'Unknown\x20error');return console[_0x29a95a(0x238)](_0x29a95a(0x212)+_0x37e23d),_0x6f0879[_0x29a95a(0x250)](_0x37e23d),loggerService_1['loggerService'][_0x29a95a(0x233)](_0x29a95a(0x214),_0x37e23d,{'timeoutDays':this[_0x29a95a(0x22c)]}),{'processed':_0x36a778,'failed':_0x91dd4,'errors':_0x6f0879};}}async[a80_0xa67f0b(0x1ea)](){const _0x59512b=a80_0xa67f0b,_0x27d161=[];let _0x562a83=0x0,_0x5017dd=0x0;try{console[_0x59512b(0x26e)](_0x59512b(0x1f5));const _0x2fe527=new Date(),_0x5ac3df=new Date(_0x2fe527[_0x59512b(0x254)]()-this[_0x59512b(0x215)]*0x3c*0x3e8),_0x1eff74=new Date();_0x1eff74['setDate'](_0x1eff74[_0x59512b(0x20c)]()-this[_0x59512b(0x1f1)]),console['log']('ğŸ“…\x20Fast\x20timeout\x20(30\x20min):\x20'+_0x5ac3df[_0x59512b(0x26d)]()),console[_0x59512b(0x26e)]('ğŸ“…\x20Slow\x20timeout\x20(3\x20days):\x20'+_0x1eff74['toISOString']()),console[_0x59512b(0x26e)](_0x59512b(0x1dc)+this[_0x59512b(0x227)][_0x59512b(0x270)](',\x20'));const _0x25b83d=await database_1['default'][_0x59512b(0x25b)][_0x59512b(0x211)]({'where':{'status':client_1[_0x59512b(0x25f)][_0x59512b(0x223)],'OR':[{'gateway':{'in':this[_0x59512b(0x227)]},'createdAt':{'lt':_0x5ac3df}},{'gateway':{'notIn':this[_0x59512b(0x227)]},'createdAt':{'lt':_0x1eff74}}]},'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![]}}}});console[_0x59512b(0x26e)](_0x59512b(0x204)+_0x25b83d[_0x59512b(0x261)]+_0x59512b(0x21e));if(_0x25b83d[_0x59512b(0x261)]===0x0)return console['log']('âœ…\x20No\x20stale\x20PENDING\x20payments\x20found'),{'processed':0x0,'failed':0x0,'errors':[]};for(const _0x2f9dc0 of _0x25b83d){try{const _0x2f86c2=this[_0x59512b(0x227)][_0x59512b(0x22f)](_0x2f9dc0['gateway']),_0x360ee6=_0x2f86c2?'30\x20minutes':_0x59512b(0x1fc),_0x56b009=Math['floor']((Date[_0x59512b(0x262)]()-_0x2f9dc0['createdAt'][_0x59512b(0x254)]())/(0x3e8*0x3c));console['log'](_0x59512b(0x23f)+_0x2f9dc0['id']),console[_0x59512b(0x26e)]('\x20\x20\x20Gateway:\x20'+_0x2f9dc0['gateway']+'\x20('+_0x360ee6+_0x59512b(0x240)),console['log']('\x20\x20\x20Amount:\x20'+_0x2f9dc0[_0x59512b(0x1f4)]+'\x20'+_0x2f9dc0[_0x59512b(0x23a)]),console[_0x59512b(0x26e)]('\x20\x20\x20Shop:\x20'+_0x2f9dc0['shop'][_0x59512b(0x1ee)]+'\x20('+_0x2f9dc0['shop'][_0x59512b(0x1e8)]+')'),console['log'](_0x59512b(0x22a)+_0x2f9dc0[_0x59512b(0x1e9)]['toISOString']()),console[_0x59512b(0x26e)]('\x20\x20\x20Age:\x20'+_0x56b009+_0x59512b(0x231));const _0x7bb3c4=await database_1[_0x59512b(0x1db)][_0x59512b(0x25b)]['update']({'where':{'id':_0x2f9dc0['id']},'data':{'status':client_1[_0x59512b(0x25f)][_0x59512b(0x202)],'statusChangedBy':_0x59512b(0x266),'statusChangedAt':new Date(),'failureMessage':'Payment\x20timeout:\x20No\x20payment\x20action\x20received\x20within\x20'+_0x360ee6}});console[_0x59512b(0x26e)](_0x59512b(0x208)+_0x2f9dc0['id']+'\x20from\x20PENDING\x20to\x20EXPIRED'),loggerService_1[_0x59512b(0x237)][_0x59512b(0x224)](_0x2f9dc0[_0x59512b(0x256)],_0x2f9dc0['id'],_0x59512b(0x223),_0x59512b(0x202),{'reason':_0x59512b(0x1de),'timeout':_0x360ee6,'ageMinutes':_0x56b009}),_0x562a83++;}catch(_0x47f5b2){const _0x47fd30=_0x59512b(0x1f0)+_0x2f9dc0['id']+':\x20'+(_0x47f5b2 instanceof Error?_0x47f5b2[_0x59512b(0x265)]:'Unknown\x20error');console[_0x59512b(0x238)]('âŒ\x20'+_0x47fd30),_0x27d161[_0x59512b(0x250)](_0x47fd30),_0x5017dd++;}}const _0x56c6a0=_0x59512b(0x210)+_0x562a83+'\x20payments\x20updated\x20to\x20EXPIRED,\x20'+_0x5017dd+_0x59512b(0x213);return console[_0x59512b(0x26e)](_0x59512b(0x200)+_0x56c6a0),loggerService_1[_0x59512b(0x237)]['logApiCall'](_0x59512b(0x1e0),_0x59512b(0x20b),_0x59512b(0x266),_0x59512b(0x258),{'processed':_0x562a83,'failed':_0x5017dd,'errors':_0x27d161,'fastTimeoutMinutes':this[_0x59512b(0x215)],'slowTimeoutDays':this['SLOW_TIMEOUT_DAYS']}),{'processed':_0x562a83,'failed':_0x5017dd,'errors':_0x27d161};}catch(_0x4f3f53){const _0x1b4feb=_0x59512b(0x1df)+(_0x4f3f53 instanceof Error?_0x4f3f53[_0x59512b(0x265)]:_0x59512b(0x26b));return console[_0x59512b(0x238)]('ğŸ’¥\x20'+_0x1b4feb),_0x27d161[_0x59512b(0x250)](_0x1b4feb),loggerService_1[_0x59512b(0x237)]['logWebhookError'](_0x59512b(0x1e0),_0x1b4feb,{'timeoutDays':this[_0x59512b(0x24e)]}),{'processed':_0x562a83,'failed':_0x5017dd,'errors':_0x27d161};}}async[a80_0xa67f0b(0x230)](){const _0x331213=a80_0xa67f0b;try{const _0x4e9da3=new Date(),_0x486514=new Date(_0x4e9da3[_0x331213(0x254)]()-0x1*0x18*0x3c*0x3c*0x3e8),_0x3929cb=new Date(_0x4e9da3[_0x331213(0x254)]()-0x3*0x18*0x3c*0x3c*0x3e8),_0x10f3e7=new Date(_0x4e9da3[_0x331213(0x254)]()-0x5*0x18*0x3c*0x3c*0x3e8),_0x553aaa=await database_1[_0x331213(0x1db)][_0x331213(0x25b)][_0x331213(0x211)]({'where':{'status':{'in':[client_1[_0x331213(0x25f)][_0x331213(0x259)],client_1[_0x331213(0x25f)][_0x331213(0x223)]]}},'select':{'id':!![],'gateway':!![],'status':!![],'createdAt':!![]}}),_0x426703={'total':_0x553aaa[_0x331213(0x261)],'byAge':{'fresh':0x0,'recent':0x0,'stale':0x0,'expired':0x0},'byGateway':{},'byStatus':{}};for(const _0xbdc8f9 of _0x553aaa){if(_0xbdc8f9[_0x331213(0x1e9)]>_0x486514)_0x426703[_0x331213(0x23c)][_0x331213(0x24b)]++;else{if(_0xbdc8f9[_0x331213(0x1e9)]>_0x3929cb)_0x426703[_0x331213(0x23c)][_0x331213(0x255)]++;else _0xbdc8f9[_0x331213(0x1e9)]>_0x10f3e7?_0x426703[_0x331213(0x23c)]['stale']++:_0x426703['byAge'][_0x331213(0x242)]++;}!_0x426703[_0x331213(0x21a)][_0xbdc8f9[_0x331213(0x256)]]&&(_0x426703[_0x331213(0x21a)][_0xbdc8f9[_0x331213(0x256)]]=0x0);_0x426703['byGateway'][_0xbdc8f9['gateway']]++;const _0x4c7404=_0xbdc8f9[_0x331213(0x1e2)];!_0x426703[_0x331213(0x232)][_0x4c7404]&&(_0x426703[_0x331213(0x232)][_0x4c7404]=0x0),_0x426703[_0x331213(0x232)][_0x4c7404]++;}return _0x426703;}catch(_0x1387bb){console[_0x331213(0x238)](_0x331213(0x1f6),_0x1387bb);throw new Error('Failed\x20to\x20get\x20processing\x20payments\x20stats:\x20'+(_0x1387bb instanceof Error?_0x1387bb[_0x331213(0x265)]:_0x331213(0x26b)));}}async[a80_0xa67f0b(0x1dd)](){const _0xc0d0b5=a80_0xa67f0b;console[_0xc0d0b5(0x26e)](_0xc0d0b5(0x253));const _0x3e0dba=await this[_0xc0d0b5(0x230)]();console[_0xc0d0b5(0x26e)](_0xc0d0b5(0x221)),console[_0xc0d0b5(0x26e)](_0xc0d0b5(0x24d)+_0x3e0dba[_0xc0d0b5(0x21b)]),console['log'](_0xc0d0b5(0x246)+_0x3e0dba['byAge'][_0xc0d0b5(0x24b)]),console['log'](_0xc0d0b5(0x219)+_0x3e0dba[_0xc0d0b5(0x23c)][_0xc0d0b5(0x255)]),console[_0xc0d0b5(0x26e)]('\x20\x20\x20Stale\x20(3-5\x20days):\x20'+_0x3e0dba[_0xc0d0b5(0x23c)][_0xc0d0b5(0x201)]),console[_0xc0d0b5(0x26e)](_0xc0d0b5(0x251)+_0x3e0dba[_0xc0d0b5(0x23c)][_0xc0d0b5(0x242)]),console[_0xc0d0b5(0x26e)](_0xc0d0b5(0x226),_0x3e0dba[_0xc0d0b5(0x21a)]),console['log'](_0xc0d0b5(0x1ed),_0x3e0dba[_0xc0d0b5(0x232)]),console[_0xc0d0b5(0x26e)](_0xc0d0b5(0x241));const _0x2dbb71=await this[_0xc0d0b5(0x25e)]();console[_0xc0d0b5(0x26e)](_0xc0d0b5(0x209));const _0x5526ef=await this[_0xc0d0b5(0x1ea)](),_0x165571=await this[_0xc0d0b5(0x230)]();console[_0xc0d0b5(0x26e)](_0xc0d0b5(0x1fb)),console['log'](_0xc0d0b5(0x24d)+_0x165571[_0xc0d0b5(0x21b)]),console[_0xc0d0b5(0x26e)](_0xc0d0b5(0x251)+_0x165571[_0xc0d0b5(0x23c)]['expired']),console[_0xc0d0b5(0x26e)](_0xc0d0b5(0x1ed),_0x165571['byStatus']);const _0x1a9e2f=_0x2dbb71[_0xc0d0b5(0x225)]+_0x5526ef[_0xc0d0b5(0x225)],_0x5ce030=_0x2dbb71[_0xc0d0b5(0x25a)]+_0x5526ef[_0xc0d0b5(0x25a)],_0x93e986=[..._0x2dbb71['errors'],..._0x5526ef[_0xc0d0b5(0x25c)]];console[_0xc0d0b5(0x26e)](_0xc0d0b5(0x1e1)),console[_0xc0d0b5(0x26e)]('\x20\x20\x20ğŸ”„\x20PROCESSING\x20â†’\x20FAILED:\x20'+_0x2dbb71[_0xc0d0b5(0x225)]),console[_0xc0d0b5(0x26e)](_0xc0d0b5(0x23d)+_0x5526ef[_0xc0d0b5(0x225)]),console['log'](_0xc0d0b5(0x252)+_0x1a9e2f),console['log']('\x20\x20\x20âŒ\x20Total\x20failed\x20to\x20process:\x20'+_0x5ce030),console[_0xc0d0b5(0x26e)]('\x20\x20\x20ğŸ“‰\x20Total\x20stale\x20payments\x20reduced\x20by:\x20'+(_0x3e0dba[_0xc0d0b5(0x21b)]-_0x165571[_0xc0d0b5(0x21b)])),_0x93e986[_0xc0d0b5(0x261)]>0x0&&(console[_0xc0d0b5(0x26e)]('\x20\x20\x20âš ï¸\x20Errors\x20encountered:'),_0x93e986['forEach']((_0x19cabd,_0x5e9cd7)=>{const _0x173de6=_0xc0d0b5;console[_0x173de6(0x26e)](_0x173de6(0x26f)+(_0x5e9cd7+0x1)+'.\x20'+_0x19cabd);})),console[_0xc0d0b5(0x26e)](_0xc0d0b5(0x260));}async['runProcessingCleanupOnly'](){const _0x5487db=a80_0xa67f0b;console[_0x5487db(0x26e)](_0x5487db(0x23e));const _0x325aff=await this['getProcessingPaymentsStats'](),_0xd09ec9=_0x325aff[_0x5487db(0x232)][_0x5487db(0x259)]||0x0;console[_0x5487db(0x26e)](_0x5487db(0x25d)+_0xd09ec9);const _0x45d019=await this[_0x5487db(0x25e)](),_0x2ef1fb=await this[_0x5487db(0x230)](),_0x22b956=_0x2ef1fb['byStatus'][_0x5487db(0x259)]||0x0;console[_0x5487db(0x26e)](_0x5487db(0x248)+_0x22b956),console['log'](_0x5487db(0x217)+_0x45d019[_0x5487db(0x225)]),console['log'](_0x5487db(0x229));}async['runPendingCleanupOnly'](){const _0x315d4a=a80_0xa67f0b;console[_0x315d4a(0x26e)](_0x315d4a(0x24a));const _0xae1e82=await this[_0x315d4a(0x230)](),_0x64d5cc=_0xae1e82[_0x315d4a(0x232)][_0x315d4a(0x223)]||0x0;console[_0x315d4a(0x26e)](_0x315d4a(0x216)+_0x64d5cc);const _0x388a6c=await this[_0x315d4a(0x1ea)](),_0x2ad384=await this[_0x315d4a(0x230)](),_0x264349=_0x2ad384[_0x315d4a(0x232)][_0x315d4a(0x223)]||0x0;console[_0x315d4a(0x26e)](_0x315d4a(0x228)+_0x264349),console[_0x315d4a(0x26e)](_0x315d4a(0x24f)+_0x388a6c[_0x315d4a(0x225)]),console[_0x315d4a(0x26e)](_0x315d4a(0x257));}async[a80_0xa67f0b(0x1e6)](){const _0x23a269=a80_0xa67f0b,_0x4539df=[];let _0x2d26af=0x0;try{console['log'](_0x23a269(0x26a));const _0x4f9930=new Date(),_0x150d06=[_0x23a269(0x207),'plisio'],_0xd8b725=[_0x23a269(0x1fa),'rapyd',_0x23a269(0x218),_0x23a269(0x20d)],_0x461c67=await database_1[_0x23a269(0x1db)][_0x23a269(0x203)]['findMany']({'where':{'type':_0x23a269(0x239),'status':_0x23a269(0x1f3)},'include':{'payments':{'orderBy':{'createdAt':_0x23a269(0x26c)},'take':0x1}}});console['log']('ğŸ”\x20Found\x20'+_0x461c67[_0x23a269(0x261)]+_0x23a269(0x245));for(const _0x160c65 of _0x461c67){try{if(_0x160c65['payments'][_0x23a269(0x261)]===0x0)continue;const _0x5b4cbd=_0x160c65[_0x23a269(0x1fe)][0x0];if(_0x5b4cbd[_0x23a269(0x1e2)]===_0x23a269(0x1fd))continue;const _0x1c8494=_0x4f9930[_0x23a269(0x254)]()-_0x5b4cbd[_0x23a269(0x1e9)]['getTime']();let _0x39001b;_0x150d06[_0x23a269(0x22f)](_0x160c65[_0x23a269(0x256)])||_0xd8b725[_0x23a269(0x22f)](_0x160c65[_0x23a269(0x256)])?_0x39001b=0x1e*0x3c*0x3e8:_0x39001b=0x3*0x18*0x3c*0x3c*0x3e8,_0x1c8494>_0x39001b&&(await database_1[_0x23a269(0x1db)][_0x23a269(0x203)][_0x23a269(0x271)]({'where':{'id':_0x160c65['id']},'data':{'status':_0x23a269(0x202)}}),console[_0x23a269(0x26e)](_0x23a269(0x1ec)+_0x160c65['id']+_0x23a269(0x21f)+_0x160c65['gateway']+_0x23a269(0x243)+Math['round'](_0x1c8494/0x3e8/0x3c)+'\x20minutes)'),_0x2d26af++);}catch(_0x5134e6){const _0xf24041=_0x23a269(0x268)+_0x160c65['id']+':\x20'+(_0x5134e6 instanceof Error?_0x5134e6[_0x23a269(0x265)]:_0x23a269(0x26b));console[_0x23a269(0x238)]('âŒ\x20'+_0xf24041),_0x4539df[_0x23a269(0x250)](_0xf24041);}}return console['log'](_0x23a269(0x220)+_0x2d26af+_0x23a269(0x267)),{'expired':_0x2d26af,'errors':_0x4539df};}catch(_0x3e5451){const _0x2b3aa3=_0x23a269(0x22d)+(_0x3e5451 instanceof Error?_0x3e5451[_0x23a269(0x265)]:_0x23a269(0x26b));return console[_0x23a269(0x238)]('ğŸ’¥\x20'+_0x2b3aa3),_0x4539df[_0x23a269(0x250)](_0x2b3aa3),{'expired':_0x2d26af,'errors':_0x4539df};}}}exports['PaymentCleanupService']=PaymentCleanupService,exports['paymentCleanupService']=new PaymentCleanupService();