'use strict';const a80_0xfed3db=a80_0x3fc2;(function(_0x1bcc10,_0x4743db){const _0x3c42a1=a80_0x3fc2,_0x5150e9=_0x1bcc10();while(!![]){try{const _0x53298a=parseInt(_0x3c42a1(0x1ef))/0x1+-parseInt(_0x3c42a1(0x1fe))/0x2+-parseInt(_0x3c42a1(0x1df))/0x3*(-parseInt(_0x3c42a1(0x242))/0x4)+-parseInt(_0x3c42a1(0x214))/0x5+-parseInt(_0x3c42a1(0x203))/0x6*(-parseInt(_0x3c42a1(0x229))/0x7)+-parseInt(_0x3c42a1(0x237))/0x8+-parseInt(_0x3c42a1(0x22a))/0x9*(-parseInt(_0x3c42a1(0x240))/0xa);if(_0x53298a===_0x4743db)break;else _0x5150e9['push'](_0x5150e9['shift']());}catch(_0x5cde9a){_0x5150e9['push'](_0x5150e9['shift']());}}}(a80_0x340f,0x5263d));var __importDefault=this&&this['__importDefault']||function(_0x1ea8d9){const _0x14a0fb=a80_0x3fc2;return _0x1ea8d9&&_0x1ea8d9[_0x14a0fb(0x24a)]?_0x1ea8d9:{'default':_0x1ea8d9};};function a80_0x3fc2(_0x6a6f86,_0x1080a4){_0x6a6f86=_0x6a6f86-0x1d9;const _0x340f02=a80_0x340f();let _0x3fc2db=_0x340f02[_0x6a6f86];return _0x3fc2db;}Object[a80_0xfed3db(0x221)](exports,a80_0xfed3db(0x24a),{'value':!![]}),exports[a80_0xfed3db(0x1e5)]=exports[a80_0xfed3db(0x21a)]=void 0x0;const database_1=__importDefault(require('../config/database')),client_1=require(a80_0xfed3db(0x21d)),loggerService_1=require(a80_0xfed3db(0x21b));class PaymentCleanupService{constructor(){const _0x54b71a=a80_0xfed3db;this['PROCESSING_TIMEOUT_DAYS']=0x5,this['PENDING_TIMEOUT_DAYS']=0x5,this[_0x54b71a(0x1e9)]=0x1e,this[_0x54b71a(0x252)]=0x3,this[_0x54b71a(0x248)]=[_0x54b71a(0x200),_0x54b71a(0x22f),'rapyd','visa/mastercard',_0x54b71a(0x243),'oxapay'];}async[a80_0xfed3db(0x1e6)](){const _0x5dd116=a80_0xfed3db,_0x2b74b1=[];let _0x5be1eb=0x0,_0x3cc241=0x0;try{console['log']('ğŸ§¹\x20Starting\x20cleanup\x20of\x20stale\x20PROCESSING\x20payments...');const _0x5c35fb=new Date();_0x5c35fb[_0x5dd116(0x212)](_0x5c35fb[_0x5dd116(0x259)]()-this[_0x5dd116(0x211)]),console[_0x5dd116(0x20e)](_0x5dd116(0x256)+_0x5c35fb['toISOString']());const _0x4aa4ae=await database_1[_0x5dd116(0x1f8)][_0x5dd116(0x25d)][_0x5dd116(0x241)]({'where':{'status':client_1[_0x5dd116(0x216)][_0x5dd116(0x1f9)],'createdAt':{'lt':_0x5c35fb}},'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![]}}}});console['log'](_0x5dd116(0x21f)+_0x4aa4ae[_0x5dd116(0x1f2)]+_0x5dd116(0x22c));if(_0x4aa4ae['length']===0x0)return console[_0x5dd116(0x20e)](_0x5dd116(0x206)),{'processed':0x0,'failed':0x0,'errors':[]};for(const _0x4c739e of _0x4aa4ae){try{console[_0x5dd116(0x20e)]('â±ï¸\x20Processing\x20stale\x20payment:\x20'+_0x4c739e['id']+'\x20('+_0x4c739e['gateway']+',\x20'+_0x4c739e[_0x5dd116(0x1ec)]+'\x20'+_0x4c739e[_0x5dd116(0x267)]+')'),console['log'](_0x5dd116(0x266)+_0x4c739e[_0x5dd116(0x215)]['name']+'\x20('+_0x4c739e[_0x5dd116(0x215)]['username']+')'),console[_0x5dd116(0x20e)](_0x5dd116(0x239)+_0x4c739e['createdAt'][_0x5dd116(0x246)]()),console[_0x5dd116(0x20e)](_0x5dd116(0x263)+Math[_0x5dd116(0x265)]((Date['now']()-_0x4c739e[_0x5dd116(0x24b)][_0x5dd116(0x1f7)]())/(0x3e8*0x3c*0x3c*0x18))+'\x20days');const _0x5b42e1=await database_1[_0x5dd116(0x1f8)][_0x5dd116(0x25d)]['update']({'where':{'id':_0x4c739e['id']},'data':{'status':client_1['PaymentStatus'][_0x5dd116(0x25a)],'statusChangedBy':_0x5dd116(0x20c),'statusChangedAt':new Date(),'failureMessage':'Payment\x20timeout:\x20No\x20status\x20update\x20received\x20for\x20'+this[_0x5dd116(0x211)]+_0x5dd116(0x254)}});console[_0x5dd116(0x20e)](_0x5dd116(0x1ff)+_0x4c739e['id']+'\x20from\x20PROCESSING\x20to\x20FAILED'),loggerService_1[_0x5dd116(0x224)][_0x5dd116(0x250)](_0x4c739e[_0x5dd116(0x253)],_0x4c739e['id'],'PROCESSING','FAILED',{'reason':'auto_timeout','timeoutDays':this[_0x5dd116(0x211)]}),_0x5be1eb++;}catch(_0x380ee4){const _0x55b731=_0x5dd116(0x230)+_0x4c739e['id']+':\x20'+(_0x380ee4 instanceof Error?_0x380ee4['message']:_0x5dd116(0x245));console[_0x5dd116(0x217)]('âŒ\x20'+_0x55b731),_0x2b74b1['push'](_0x55b731),_0x3cc241++;}}const _0x2bd33f=_0x5dd116(0x225)+_0x5be1eb+_0x5dd116(0x25c)+_0x3cc241+_0x5dd116(0x1d9);return console[_0x5dd116(0x20e)](_0x5dd116(0x1dd)+_0x2bd33f),loggerService_1[_0x5dd116(0x224)][_0x5dd116(0x268)]('payment_cleanup',_0x5dd116(0x26c),'system',_0x5dd116(0x23a),{'processed':_0x5be1eb,'failed':_0x3cc241,'errors':_0x2b74b1,'timeoutDays':this[_0x5dd116(0x211)]}),{'processed':_0x5be1eb,'failed':_0x3cc241,'errors':_0x2b74b1};}catch(_0x249faf){const _0x5ac1fe='Cleanup\x20service\x20error:\x20'+(_0x249faf instanceof Error?_0x249faf[_0x5dd116(0x22d)]:'Unknown\x20error');return console[_0x5dd116(0x217)](_0x5dd116(0x1ed)+_0x5ac1fe),_0x2b74b1[_0x5dd116(0x21e)](_0x5ac1fe),loggerService_1['loggerService'][_0x5dd116(0x213)](_0x5dd116(0x1e3),_0x5ac1fe,{'timeoutDays':this[_0x5dd116(0x211)]}),{'processed':_0x5be1eb,'failed':_0x3cc241,'errors':_0x2b74b1};}}async['cleanupStalePendingPayments'](){const _0x3d0d97=a80_0xfed3db,_0x447c2c=[];let _0x41ee4f=0x0,_0x27d980=0x0;try{console[_0x3d0d97(0x20e)]('ğŸ§¹\x20Starting\x20cleanup\x20of\x20stale\x20PENDING\x20payments...');const _0x50b629=new Date(),_0x13eed8=new Date(_0x50b629[_0x3d0d97(0x1f7)]()-this[_0x3d0d97(0x1e9)]*0x3c*0x3e8),_0xb68735=new Date();_0xb68735[_0x3d0d97(0x212)](_0xb68735[_0x3d0d97(0x259)]()-this[_0x3d0d97(0x252)]),console[_0x3d0d97(0x20e)]('ğŸ“…\x20Fast\x20timeout\x20(30\x20min):\x20'+_0x13eed8[_0x3d0d97(0x246)]()),console['log'](_0x3d0d97(0x223)+_0xb68735[_0x3d0d97(0x246)]()),console['log']('ğŸ“‹\x20Fast\x20timeout\x20gateways:\x20'+this[_0x3d0d97(0x248)][_0x3d0d97(0x264)](',\x20'));const _0x340c3a=await database_1[_0x3d0d97(0x1f8)]['payment'][_0x3d0d97(0x241)]({'where':{'status':client_1[_0x3d0d97(0x216)]['PENDING'],'OR':[{'gateway':{'in':this['FAST_TIMEOUT_GATEWAYS']},'createdAt':{'lt':_0x13eed8}},{'gateway':{'notIn':this[_0x3d0d97(0x248)]},'createdAt':{'lt':_0xb68735}}]},'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![]}}}});console[_0x3d0d97(0x20e)](_0x3d0d97(0x21f)+_0x340c3a[_0x3d0d97(0x1f2)]+'\x20stale\x20PENDING\x20payments');if(_0x340c3a['length']===0x0)return console[_0x3d0d97(0x20e)](_0x3d0d97(0x226)),{'processed':0x0,'failed':0x0,'errors':[]};for(const _0x39d47f of _0x340c3a){try{const _0x2a56d6=this[_0x3d0d97(0x248)][_0x3d0d97(0x202)](_0x39d47f['gateway']),_0xcb9227=_0x2a56d6?_0x3d0d97(0x24d):_0x3d0d97(0x1eb),_0x1d21db=Math['floor']((Date['now']()-_0x39d47f[_0x3d0d97(0x24b)][_0x3d0d97(0x1f7)]())/(0x3e8*0x3c));console[_0x3d0d97(0x20e)](_0x3d0d97(0x238)+_0x39d47f['id']),console['log'](_0x3d0d97(0x208)+_0x39d47f['gateway']+'\x20('+_0xcb9227+_0x3d0d97(0x219)),console[_0x3d0d97(0x20e)](_0x3d0d97(0x20a)+_0x39d47f[_0x3d0d97(0x1ec)]+'\x20'+_0x39d47f['currency']),console['log']('\x20\x20\x20Shop:\x20'+_0x39d47f[_0x3d0d97(0x215)]['name']+'\x20('+_0x39d47f[_0x3d0d97(0x215)]['username']+')'),console[_0x3d0d97(0x20e)](_0x3d0d97(0x239)+_0x39d47f[_0x3d0d97(0x24b)][_0x3d0d97(0x246)]()),console['log'](_0x3d0d97(0x263)+_0x1d21db+_0x3d0d97(0x1e0));const _0x15cace=await database_1[_0x3d0d97(0x1f8)][_0x3d0d97(0x25d)]['update']({'where':{'id':_0x39d47f['id']},'data':{'status':client_1[_0x3d0d97(0x216)]['EXPIRED'],'statusChangedBy':'system','statusChangedAt':new Date(),'failureMessage':_0x3d0d97(0x1f3)+_0xcb9227}});console[_0x3d0d97(0x20e)](_0x3d0d97(0x1ff)+_0x39d47f['id']+'\x20from\x20PENDING\x20to\x20EXPIRED'),loggerService_1[_0x3d0d97(0x224)][_0x3d0d97(0x250)](_0x39d47f[_0x3d0d97(0x253)],_0x39d47f['id'],_0x3d0d97(0x261),_0x3d0d97(0x251),{'reason':_0x3d0d97(0x234),'timeout':_0xcb9227,'ageMinutes':_0x1d21db}),_0x41ee4f++;}catch(_0x47bd18){const _0x52c0ed=_0x3d0d97(0x23d)+_0x39d47f['id']+':\x20'+(_0x47bd18 instanceof Error?_0x47bd18[_0x3d0d97(0x22d)]:_0x3d0d97(0x245));console[_0x3d0d97(0x217)]('âŒ\x20'+_0x52c0ed),_0x447c2c[_0x3d0d97(0x21e)](_0x52c0ed),_0x27d980++;}}const _0x10452a=_0x3d0d97(0x257)+_0x41ee4f+'\x20payments\x20updated\x20to\x20EXPIRED,\x20'+_0x27d980+_0x3d0d97(0x1d9);return console[_0x3d0d97(0x20e)]('ğŸ“Š\x20'+_0x10452a),loggerService_1[_0x3d0d97(0x224)]['logApiCall'](_0x3d0d97(0x258),_0x3d0d97(0x26c),_0x3d0d97(0x20c),_0x3d0d97(0x23a),{'processed':_0x41ee4f,'failed':_0x27d980,'errors':_0x447c2c,'fastTimeoutMinutes':this['FAST_TIMEOUT_MINUTES'],'slowTimeoutDays':this[_0x3d0d97(0x252)]}),{'processed':_0x41ee4f,'failed':_0x27d980,'errors':_0x447c2c};}catch(_0x226121){const _0x551723='PENDING\x20cleanup\x20service\x20error:\x20'+(_0x226121 instanceof Error?_0x226121['message']:_0x3d0d97(0x245));return console['error'](_0x3d0d97(0x1ed)+_0x551723),_0x447c2c[_0x3d0d97(0x21e)](_0x551723),loggerService_1[_0x3d0d97(0x224)][_0x3d0d97(0x213)]('pending_payment_cleanup',_0x551723,{'timeoutDays':this[_0x3d0d97(0x1ee)]}),{'processed':_0x41ee4f,'failed':_0x27d980,'errors':_0x447c2c};}}async[a80_0xfed3db(0x233)](){const _0x73a753=a80_0xfed3db;try{const _0xbdac96=new Date(),_0x13146a=new Date(_0xbdac96[_0x73a753(0x1f7)]()-0x1*0x18*0x3c*0x3c*0x3e8),_0x16f6a8=new Date(_0xbdac96[_0x73a753(0x1f7)]()-0x3*0x18*0x3c*0x3c*0x3e8),_0x374a31=new Date(_0xbdac96[_0x73a753(0x1f7)]()-0x5*0x18*0x3c*0x3c*0x3e8),_0x23e361=await database_1['default']['payment'][_0x73a753(0x241)]({'where':{'status':{'in':[client_1[_0x73a753(0x216)][_0x73a753(0x1f9)],client_1[_0x73a753(0x216)][_0x73a753(0x261)]]}},'select':{'id':!![],'gateway':!![],'status':!![],'createdAt':!![]}}),_0x8f7ece={'total':_0x23e361[_0x73a753(0x1f2)],'byAge':{'fresh':0x0,'recent':0x0,'stale':0x0,'expired':0x0},'byGateway':{},'byStatus':{}};for(const _0x178f68 of _0x23e361){if(_0x178f68[_0x73a753(0x24b)]>_0x13146a)_0x8f7ece[_0x73a753(0x235)][_0x73a753(0x1f1)]++;else{if(_0x178f68[_0x73a753(0x24b)]>_0x16f6a8)_0x8f7ece[_0x73a753(0x235)]['recent']++;else _0x178f68[_0x73a753(0x24b)]>_0x374a31?_0x8f7ece[_0x73a753(0x235)]['stale']++:_0x8f7ece['byAge'][_0x73a753(0x24f)]++;}!_0x8f7ece[_0x73a753(0x1f0)][_0x178f68[_0x73a753(0x253)]]&&(_0x8f7ece['byGateway'][_0x178f68['gateway']]=0x0);_0x8f7ece[_0x73a753(0x1f0)][_0x178f68[_0x73a753(0x253)]]++;const _0x43db27=_0x178f68[_0x73a753(0x1f6)];!_0x8f7ece[_0x73a753(0x236)][_0x43db27]&&(_0x8f7ece[_0x73a753(0x236)][_0x43db27]=0x0),_0x8f7ece[_0x73a753(0x236)][_0x43db27]++;}return _0x8f7ece;}catch(_0x226681){console[_0x73a753(0x217)](_0x73a753(0x218),_0x226681);throw new Error(_0x73a753(0x220)+(_0x226681 instanceof Error?_0x226681[_0x73a753(0x22d)]:'Unknown\x20error'));}}async[a80_0xfed3db(0x1fd)](){const _0x33b951=a80_0xfed3db;console['log']('ğŸš€\x20Starting\x20payment\x20cleanup\x20service...');const _0x4686a1=await this[_0x33b951(0x233)]();console[_0x33b951(0x20e)](_0x33b951(0x1db)),console[_0x33b951(0x20e)](_0x33b951(0x20d)+_0x4686a1[_0x33b951(0x21c)]),console[_0x33b951(0x20e)](_0x33b951(0x1fb)+_0x4686a1[_0x33b951(0x235)]['fresh']),console[_0x33b951(0x20e)](_0x33b951(0x23c)+_0x4686a1[_0x33b951(0x235)][_0x33b951(0x201)]),console[_0x33b951(0x20e)](_0x33b951(0x1fa)+_0x4686a1[_0x33b951(0x235)][_0x33b951(0x26b)]),console[_0x33b951(0x20e)]('\x20\x20\x20Expired\x20(>\x205\x20days):\x20'+_0x4686a1['byAge']['expired']),console[_0x33b951(0x20e)]('\x20\x20\x20By\x20gateway:',_0x4686a1[_0x33b951(0x1f0)]),console[_0x33b951(0x20e)](_0x33b951(0x247),_0x4686a1[_0x33b951(0x236)]),console[_0x33b951(0x20e)](_0x33b951(0x249));const _0x20e21e=await this[_0x33b951(0x1e6)]();console[_0x33b951(0x20e)](_0x33b951(0x244));const _0x6a331c=await this[_0x33b951(0x1f5)](),_0x20949c=await this[_0x33b951(0x233)]();console[_0x33b951(0x20e)](_0x33b951(0x262)),console['log'](_0x33b951(0x20d)+_0x20949c['total']),console['log'](_0x33b951(0x23f)+_0x20949c[_0x33b951(0x235)]['expired']),console[_0x33b951(0x20e)]('\x20\x20\x20By\x20status:',_0x20949c[_0x33b951(0x236)]);const _0x20d2fe=_0x20e21e[_0x33b951(0x1dc)]+_0x6a331c[_0x33b951(0x1dc)],_0x400da1=_0x20e21e[_0x33b951(0x222)]+_0x6a331c[_0x33b951(0x222)],_0x4fc567=[..._0x20e21e[_0x33b951(0x231)],..._0x6a331c[_0x33b951(0x231)]];console[_0x33b951(0x20e)](_0x33b951(0x24c)),console['log'](_0x33b951(0x1ea)+_0x20e21e[_0x33b951(0x1dc)]),console[_0x33b951(0x20e)](_0x33b951(0x25f)+_0x6a331c['processed']),console[_0x33b951(0x20e)]('\x20\x20\x20âœ…\x20Total\x20successfully\x20processed:\x20'+_0x20d2fe),console[_0x33b951(0x20e)](_0x33b951(0x232)+_0x400da1),console[_0x33b951(0x20e)](_0x33b951(0x1de)+(_0x4686a1['total']-_0x20949c[_0x33b951(0x21c)])),_0x4fc567[_0x33b951(0x1f2)]>0x0&&(console[_0x33b951(0x20e)]('\x20\x20\x20âš ï¸\x20Errors\x20encountered:'),_0x4fc567[_0x33b951(0x26a)]((_0x582e34,_0x32bfd0)=>{const _0x190515=_0x33b951;console[_0x190515(0x20e)](_0x190515(0x255)+(_0x32bfd0+0x1)+'.\x20'+_0x582e34);})),console['log'](_0x33b951(0x22e));}async[a80_0xfed3db(0x24e)](){const _0x13969d=a80_0xfed3db;console[_0x13969d(0x20e)](_0x13969d(0x25e));const _0x4fda90=await this[_0x13969d(0x233)](),_0x45eb56=_0x4fda90[_0x13969d(0x236)]['PROCESSING']||0x0;console[_0x13969d(0x20e)](_0x13969d(0x207)+_0x45eb56);const _0x5afa33=await this[_0x13969d(0x1e6)](),_0x3f7ea0=await this[_0x13969d(0x233)](),_0x5b63a1=_0x3f7ea0[_0x13969d(0x236)][_0x13969d(0x1f9)]||0x0;console[_0x13969d(0x20e)](_0x13969d(0x269)+_0x5b63a1),console[_0x13969d(0x20e)](_0x13969d(0x1da)+_0x5afa33[_0x13969d(0x1dc)]),console[_0x13969d(0x20e)](_0x13969d(0x1e4));}async[a80_0xfed3db(0x25b)](){const _0x1af700=a80_0xfed3db;console[_0x1af700(0x20e)](_0x1af700(0x1e2));const _0xa31b2c=await this['getProcessingPaymentsStats'](),_0x3e7584=_0xa31b2c[_0x1af700(0x236)][_0x1af700(0x261)]||0x0;console[_0x1af700(0x20e)](_0x1af700(0x1f4)+_0x3e7584);const _0x3fb1e7=await this[_0x1af700(0x1f5)](),_0x2ba634=await this[_0x1af700(0x233)](),_0x4b85fe=_0x2ba634['byStatus'][_0x1af700(0x261)]||0x0;console[_0x1af700(0x20e)](_0x1af700(0x20b)+_0x4b85fe),console[_0x1af700(0x20e)]('âœ…\x20PENDING\x20payments\x20processed:\x20'+_0x3fb1e7[_0x1af700(0x1dc)]),console['log'](_0x1af700(0x227));}async['expireSinglePaymentLinks'](){const _0x4e1057=a80_0xfed3db,_0xb8a630=[];let _0xc183a3=0x0;try{console[_0x4e1057(0x20e)](_0x4e1057(0x205));const _0x4c2143=new Date(),_0x1d60be=[_0x4e1057(0x1e1),'plisio'],_0x122f04=[_0x4e1057(0x200),_0x4e1057(0x1e8),_0x4e1057(0x210),'mastercard'],_0x1bac13=await database_1['default']['paymentLink']['findMany']({'where':{'type':'SINGLE','status':_0x4e1057(0x204)},'include':{'payments':{'orderBy':{'createdAt':_0x4e1057(0x209)},'take':0x1}}});console[_0x4e1057(0x20e)](_0x4e1057(0x21f)+_0x1bac13[_0x4e1057(0x1f2)]+_0x4e1057(0x23b));for(const _0x5959c4 of _0x1bac13){try{if(_0x5959c4[_0x4e1057(0x20f)][_0x4e1057(0x1f2)]===0x0)continue;const _0x4d72bb=_0x5959c4[_0x4e1057(0x20f)][0x0];if(_0x4d72bb[_0x4e1057(0x1f6)]==='PAID')continue;const _0x30964d=_0x4c2143['getTime']()-_0x4d72bb[_0x4e1057(0x24b)][_0x4e1057(0x1f7)]();let _0x4ed33f;_0x1d60be[_0x4e1057(0x202)](_0x5959c4['gateway'])||_0x122f04[_0x4e1057(0x202)](_0x5959c4[_0x4e1057(0x253)])?_0x4ed33f=0x1e*0x3c*0x3e8:_0x4ed33f=0x3*0x18*0x3c*0x3c*0x3e8,_0x30964d>_0x4ed33f&&(await database_1[_0x4e1057(0x1f8)]['paymentLink'][_0x4e1057(0x228)]({'where':{'id':_0x5959c4['id']},'data':{'status':_0x4e1057(0x251)}}),console['log'](_0x4e1057(0x1e7)+_0x5959c4['id']+'\x20(gateway:\x20'+_0x5959c4[_0x4e1057(0x253)]+',\x20payment\x20age:\x20'+Math[_0x4e1057(0x260)](_0x30964d/0x3e8/0x3c)+_0x4e1057(0x23e)),_0xc183a3++);}catch(_0x172412){const _0x3b95c4=_0x4e1057(0x22b)+_0x5959c4['id']+':\x20'+(_0x172412 instanceof Error?_0x172412[_0x4e1057(0x22d)]:_0x4e1057(0x245));console[_0x4e1057(0x217)]('âŒ\x20'+_0x3b95c4),_0xb8a630[_0x4e1057(0x21e)](_0x3b95c4);}}return console[_0x4e1057(0x20e)]('ğŸ“Š\x20Expiration\x20completed:\x20'+_0xc183a3+'\x20links\x20expired'),{'expired':_0xc183a3,'errors':_0xb8a630};}catch(_0x1bd2f3){const _0x3211bf=_0x4e1057(0x1fc)+(_0x1bd2f3 instanceof Error?_0x1bd2f3[_0x4e1057(0x22d)]:'Unknown\x20error');return console['error'](_0x4e1057(0x1ed)+_0x3211bf),_0xb8a630[_0x4e1057(0x21e)](_0x3211bf),{'expired':_0xc183a3,'errors':_0xb8a630};}}}function a80_0x340f(){const _0x227a31=['runProcessingCleanupOnly','expired','logWebhookProcessed','EXPIRED','SLOW_TIMEOUT_DAYS','gateway','\x20days','\x20\x20\x20\x20\x20\x20','ğŸ“…\x20Looking\x20for\x20PROCESSING\x20payments\x20older\x20than:\x20','PENDING\x20cleanup\x20completed:\x20','pending_payment_cleanup','getDate','FAILED','runPendingCleanupOnly','\x20payments\x20updated\x20to\x20FAILED,\x20','payment','ğŸš€\x20Starting\x20PROCESSING\x20payments\x20cleanup\x20only...','\x20\x20\x20â°\x20PENDING\x20â†’\x20EXPIRED:\x20','round','PENDING','\x0ağŸ“Š\x20Stale\x20payments\x20(PROCESSING\x20+\x20PENDING)\x20after\x20cleanup:','\x20\x20\x20Age:\x20','join','floor','\x20\x20\x20Shop:\x20','currency','logApiCall','ğŸ“Š\x20PROCESSING\x20payments\x20after\x20cleanup:\x20','forEach','stale','POST','\x20failed\x20to\x20update','âœ…\x20PROCESSING\x20payments\x20processed:\x20','ğŸ“Š\x20Stale\x20payments\x20(PROCESSING\x20+\x20PENDING)\x20before\x20cleanup:','processed','ğŸ“Š\x20','\x20\x20\x20ğŸ“‰\x20Total\x20stale\x20payments\x20reduced\x20by:\x20','1511544GMWpPk','\x20minutes','oxapay','ğŸš€\x20Starting\x20PENDING\x20payments\x20cleanup\x20only...','payment_cleanup','ğŸ\x20PROCESSING\x20cleanup\x20completed','paymentCleanupService','cleanupStaleProcessingPayments','â°\x20Expired\x20link\x20','rapyd','FAST_TIMEOUT_MINUTES','\x20\x20\x20ğŸ”„\x20PROCESSING\x20â†’\x20FAILED:\x20','3\x20days','amount','ğŸ’¥\x20','PENDING_TIMEOUT_DAYS','117361hbfkYx','byGateway','fresh','length','Payment\x20timeout:\x20No\x20payment\x20action\x20received\x20within\x20','ğŸ“Š\x20PENDING\x20payments\x20before\x20cleanup:\x20','cleanupStalePendingPayments','status','getTime','default','PROCESSING','\x20\x20\x20Stale\x20(3-5\x20days):\x20','\x20\x20\x20Fresh\x20(<\x201\x20day):\x20','Link\x20expiration\x20service\x20error:\x20','runCleanupWithReport','1039316MbAiRL','âœ…\x20Updated\x20payment\x20','squirrelpay','recent','includes','61182eDMTYU','ACTIVE','â°\x20Starting\x20expiration\x20check\x20for\x20SINGLE\x20payment\x20links...','âœ…\x20No\x20stale\x20PROCESSING\x20payments\x20found','ğŸ“Š\x20PROCESSING\x20payments\x20before\x20cleanup:\x20','\x20\x20\x20Gateway:\x20','desc','\x20\x20\x20Amount:\x20','ğŸ“Š\x20PENDING\x20payments\x20after\x20cleanup:\x20','system','\x20\x20\x20Total:\x20','log','payments','visa/mastercard','PROCESSING_TIMEOUT_DAYS','setDate','logWebhookError','2730520rrXrUX','shop','PaymentStatus','error','Failed\x20to\x20get\x20processing\x20payments\x20stats:','\x20timeout)','PaymentCleanupService','./loggerService','total','@prisma/client','push','ğŸ”\x20Found\x20','Failed\x20to\x20get\x20processing\x20payments\x20stats:\x20','defineProperty','failed','ğŸ“…\x20Slow\x20timeout\x20(3\x20days):\x20','loggerService','Cleanup\x20completed:\x20','âœ…\x20No\x20stale\x20PENDING\x20payments\x20found','ğŸ\x20PENDING\x20cleanup\x20completed','update','77RwzECb','1255293cnZWXG','Failed\x20to\x20expire\x20link\x20','\x20stale\x20PROCESSING\x20payments','message','ğŸ\x20Payment\x20cleanup\x20service\x20completed','squirrel-pay','Failed\x20to\x20update\x20payment\x20','errors','\x20\x20\x20âŒ\x20Total\x20failed\x20to\x20process:\x20','getProcessingPaymentsStats','auto_timeout_pending','byAge','byStatus','220240KWmALt','â°\x20Processing\x20stale\x20PENDING\x20payment:\x20','\x20\x20\x20Created:\x20','admin','\x20active\x20SINGLE\x20links\x20to\x20check','\x20\x20\x20Recent\x20(1-3\x20days):\x20','Failed\x20to\x20update\x20PENDING\x20payment\x20','\x20minutes)','\x20\x20\x20Expired\x20(>\x205\x20days):\x20','50kMWgQD','findMany','4xYhRQy','plisio','\x0ağŸ”„\x20Running\x20PENDING\x20payments\x20cleanup...','Unknown\x20error','toISOString','\x20\x20\x20By\x20status:','FAST_TIMEOUT_GATEWAYS','\x0ağŸ”„\x20Running\x20PROCESSING\x20payments\x20cleanup...','__esModule','createdAt','\x0ağŸ“ˆ\x20Cleanup\x20Summary:','30\x20minutes'];a80_0x340f=function(){return _0x227a31;};return a80_0x340f();}exports[a80_0xfed3db(0x21a)]=PaymentCleanupService,exports[a80_0xfed3db(0x1e5)]=new PaymentCleanupService();