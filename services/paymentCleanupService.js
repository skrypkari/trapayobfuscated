'use strict';const a74_0xac0f3f=a74_0x3ba3;(function(_0x337142,_0x1954df){const _0x4cfcb4=a74_0x3ba3,_0x590a31=_0x337142();while(!![]){try{const _0x155377=parseInt(_0x4cfcb4(0x1b6))/0x1*(-parseInt(_0x4cfcb4(0x179))/0x2)+-parseInt(_0x4cfcb4(0x12c))/0x3*(-parseInt(_0x4cfcb4(0x1a5))/0x4)+-parseInt(_0x4cfcb4(0x155))/0x5+parseInt(_0x4cfcb4(0x14f))/0x6*(-parseInt(_0x4cfcb4(0x165))/0x7)+-parseInt(_0x4cfcb4(0x1a7))/0x8+parseInt(_0x4cfcb4(0x193))/0x9*(-parseInt(_0x4cfcb4(0x162))/0xa)+parseInt(_0x4cfcb4(0x13e))/0xb*(parseInt(_0x4cfcb4(0x161))/0xc);if(_0x155377===_0x1954df)break;else _0x590a31['push'](_0x590a31['shift']());}catch(_0x3be4ee){_0x590a31['push'](_0x590a31['shift']());}}}(a74_0x3d81,0xb72ac));function a74_0x3ba3(_0x31c5c3,_0x37bc5a){_0x31c5c3=_0x31c5c3-0x11e;const _0x3d819e=a74_0x3d81();let _0x3ba3ee=_0x3d819e[_0x31c5c3];return _0x3ba3ee;}var __importDefault=this&&this['__importDefault']||function(_0x39fa13){const _0xf73430=a74_0x3ba3;return _0x39fa13&&_0x39fa13[_0xf73430(0x142)]?_0x39fa13:{'default':_0x39fa13};};Object[a74_0xac0f3f(0x189)](exports,a74_0xac0f3f(0x142),{'value':!![]}),exports['paymentCleanupService']=exports[a74_0xac0f3f(0x1a9)]=void 0x0;const database_1=__importDefault(require(a74_0xac0f3f(0x16a))),client_1=require(a74_0xac0f3f(0x141)),loggerService_1=require('./loggerService');class PaymentCleanupService{constructor(){const _0x2d26a9=a74_0xac0f3f;this['PROCESSING_TIMEOUT_DAYS']=0x5,this[_0x2d26a9(0x166)]=0x5,this[_0x2d26a9(0x146)]=0x1e,this[_0x2d26a9(0x1a6)]=0x3,this[_0x2d26a9(0x190)]=[_0x2d26a9(0x1aa),_0x2d26a9(0x154),'rapyd',_0x2d26a9(0x121),_0x2d26a9(0x182),'oxapay'];}async[a74_0xac0f3f(0x1ae)](){const _0x29df6f=a74_0xac0f3f,_0x1eaa57=[];let _0x533521=0x0,_0x2ce2b2=0x0;try{console['log'](_0x29df6f(0x185));const _0x299c80=new Date();_0x299c80[_0x29df6f(0x14c)](_0x299c80[_0x29df6f(0x169)]()-this[_0x29df6f(0x158)]),console[_0x29df6f(0x1ba)](_0x29df6f(0x198)+_0x299c80[_0x29df6f(0x16f)]());const _0x1e2fd7=await database_1[_0x29df6f(0x156)][_0x29df6f(0x135)][_0x29df6f(0x18e)]({'where':{'status':client_1[_0x29df6f(0x17f)][_0x29df6f(0x13c)],'createdAt':{'lt':_0x299c80}},'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![]}}}});console[_0x29df6f(0x1ba)](_0x29df6f(0x12a)+_0x1e2fd7[_0x29df6f(0x152)]+'\x20stale\x20PROCESSING\x20payments');if(_0x1e2fd7[_0x29df6f(0x152)]===0x0)return console['log'](_0x29df6f(0x19f)),{'processed':0x0,'failed':0x0,'errors':[]};for(const _0x49e67e of _0x1e2fd7){try{console[_0x29df6f(0x1ba)](_0x29df6f(0x160)+_0x49e67e['id']+'\x20('+_0x49e67e[_0x29df6f(0x17b)]+',\x20'+_0x49e67e[_0x29df6f(0x151)]+'\x20'+_0x49e67e[_0x29df6f(0x16d)]+')'),console[_0x29df6f(0x1ba)](_0x29df6f(0x184)+_0x49e67e[_0x29df6f(0x195)][_0x29df6f(0x18b)]+'\x20('+_0x49e67e[_0x29df6f(0x195)][_0x29df6f(0x183)]+')'),console[_0x29df6f(0x1ba)](_0x29df6f(0x1b4)+_0x49e67e['createdAt'][_0x29df6f(0x16f)]()),console['log'](_0x29df6f(0x136)+Math['floor']((Date[_0x29df6f(0x196)]()-_0x49e67e[_0x29df6f(0x149)][_0x29df6f(0x1a8)]())/(0x3e8*0x3c*0x3c*0x18))+_0x29df6f(0x1b9));const _0x179043=await database_1[_0x29df6f(0x156)][_0x29df6f(0x135)][_0x29df6f(0x138)]({'where':{'id':_0x49e67e['id']},'data':{'status':client_1[_0x29df6f(0x17f)]['FAILED'],'statusChangedBy':_0x29df6f(0x139),'statusChangedAt':new Date(),'failureMessage':_0x29df6f(0x1b0)+this[_0x29df6f(0x158)]+_0x29df6f(0x1b9)}});console[_0x29df6f(0x1ba)](_0x29df6f(0x164)+_0x49e67e['id']+_0x29df6f(0x197)),loggerService_1[_0x29df6f(0x120)][_0x29df6f(0x126)](_0x49e67e['gateway'],_0x49e67e['id'],_0x29df6f(0x13c),'FAILED',{'reason':_0x29df6f(0x147),'timeoutDays':this['PROCESSING_TIMEOUT_DAYS']}),_0x533521++;}catch(_0x560ace){const _0x1b184a='Failed\x20to\x20update\x20payment\x20'+_0x49e67e['id']+':\x20'+(_0x560ace instanceof Error?_0x560ace[_0x29df6f(0x1b3)]:_0x29df6f(0x18a));console[_0x29df6f(0x1a3)]('âŒ\x20'+_0x1b184a),_0x1eaa57[_0x29df6f(0x191)](_0x1b184a),_0x2ce2b2++;}}const _0x5a0adc=_0x29df6f(0x128)+_0x533521+'\x20payments\x20updated\x20to\x20FAILED,\x20'+_0x2ce2b2+_0x29df6f(0x19d);return console[_0x29df6f(0x1ba)](_0x29df6f(0x16b)+_0x5a0adc),loggerService_1['loggerService'][_0x29df6f(0x19c)](_0x29df6f(0x133),_0x29df6f(0x15e),_0x29df6f(0x139),_0x29df6f(0x15c),{'processed':_0x533521,'failed':_0x2ce2b2,'errors':_0x1eaa57,'timeoutDays':this[_0x29df6f(0x158)]}),{'processed':_0x533521,'failed':_0x2ce2b2,'errors':_0x1eaa57};}catch(_0x5e1707){const _0x531a57=_0x29df6f(0x167)+(_0x5e1707 instanceof Error?_0x5e1707[_0x29df6f(0x1b3)]:_0x29df6f(0x18a));return console[_0x29df6f(0x1a3)]('ðŸ’¥\x20'+_0x531a57),_0x1eaa57['push'](_0x531a57),loggerService_1[_0x29df6f(0x120)]['logWebhookError'](_0x29df6f(0x133),_0x531a57,{'timeoutDays':this['PROCESSING_TIMEOUT_DAYS']}),{'processed':_0x533521,'failed':_0x2ce2b2,'errors':_0x1eaa57};}}async[a74_0xac0f3f(0x1a1)](){const _0x2e8e70=a74_0xac0f3f,_0x4bab1d=[];let _0x587315=0x0,_0xab3042=0x0;try{console[_0x2e8e70(0x1ba)](_0x2e8e70(0x1b5));const _0x1ed07d=new Date(),_0x22b118=new Date(_0x1ed07d[_0x2e8e70(0x1a8)]()-this[_0x2e8e70(0x146)]*0x3c*0x3e8),_0x3814df=new Date();_0x3814df[_0x2e8e70(0x14c)](_0x3814df[_0x2e8e70(0x169)]()-this[_0x2e8e70(0x1a6)]),console['log'](_0x2e8e70(0x18d)+_0x22b118[_0x2e8e70(0x16f)]()),console[_0x2e8e70(0x1ba)](_0x2e8e70(0x175)+_0x3814df[_0x2e8e70(0x16f)]()),console[_0x2e8e70(0x1ba)](_0x2e8e70(0x13f)+this[_0x2e8e70(0x190)][_0x2e8e70(0x171)](',\x20'));const _0x4ccf65=await database_1[_0x2e8e70(0x156)][_0x2e8e70(0x135)][_0x2e8e70(0x18e)]({'where':{'status':client_1[_0x2e8e70(0x17f)]['PENDING'],'OR':[{'gateway':{'in':this['FAST_TIMEOUT_GATEWAYS']},'createdAt':{'lt':_0x22b118}},{'gateway':{'notIn':this[_0x2e8e70(0x190)]},'createdAt':{'lt':_0x3814df}}]},'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![]}}}});console[_0x2e8e70(0x1ba)]('ðŸ”\x20Found\x20'+_0x4ccf65[_0x2e8e70(0x152)]+_0x2e8e70(0x11e));if(_0x4ccf65[_0x2e8e70(0x152)]===0x0)return console['log']('âœ…\x20No\x20stale\x20PENDING\x20payments\x20found'),{'processed':0x0,'failed':0x0,'errors':[]};for(const _0x4c8e3a of _0x4ccf65){try{const _0x28e0d5=this[_0x2e8e70(0x190)][_0x2e8e70(0x1ab)](_0x4c8e3a[_0x2e8e70(0x17b)]),_0x2996bc=_0x28e0d5?_0x2e8e70(0x122):_0x2e8e70(0x1ac),_0x4c768a=Math['floor']((Date[_0x2e8e70(0x196)]()-_0x4c8e3a[_0x2e8e70(0x149)]['getTime']())/(0x3e8*0x3c));console[_0x2e8e70(0x1ba)]('â°\x20Processing\x20stale\x20PENDING\x20payment:\x20'+_0x4c8e3a['id']),console[_0x2e8e70(0x1ba)](_0x2e8e70(0x16e)+_0x4c8e3a['gateway']+'\x20('+_0x2996bc+_0x2e8e70(0x15b)),console['log'](_0x2e8e70(0x129)+_0x4c8e3a[_0x2e8e70(0x151)]+'\x20'+_0x4c8e3a[_0x2e8e70(0x16d)]),console[_0x2e8e70(0x1ba)](_0x2e8e70(0x184)+_0x4c8e3a[_0x2e8e70(0x195)][_0x2e8e70(0x18b)]+'\x20('+_0x4c8e3a['shop'][_0x2e8e70(0x183)]+')'),console['log'](_0x2e8e70(0x1b4)+_0x4c8e3a[_0x2e8e70(0x149)][_0x2e8e70(0x16f)]()),console[_0x2e8e70(0x1ba)](_0x2e8e70(0x136)+_0x4c768a+_0x2e8e70(0x1a4));const _0x3b4399=await database_1[_0x2e8e70(0x156)]['payment'][_0x2e8e70(0x138)]({'where':{'id':_0x4c8e3a['id']},'data':{'status':client_1[_0x2e8e70(0x17f)][_0x2e8e70(0x125)],'statusChangedBy':_0x2e8e70(0x139),'statusChangedAt':new Date(),'failureMessage':_0x2e8e70(0x19a)+_0x2996bc}});console[_0x2e8e70(0x1ba)]('âœ…\x20Updated\x20payment\x20'+_0x4c8e3a['id']+_0x2e8e70(0x15d)),loggerService_1[_0x2e8e70(0x120)]['logWebhookProcessed'](_0x4c8e3a[_0x2e8e70(0x17b)],_0x4c8e3a['id'],_0x2e8e70(0x1b1),_0x2e8e70(0x125),{'reason':_0x2e8e70(0x140),'timeout':_0x2996bc,'ageMinutes':_0x4c768a}),_0x587315++;}catch(_0x42ef93){const _0x2e91bb=_0x2e8e70(0x17e)+_0x4c8e3a['id']+':\x20'+(_0x42ef93 instanceof Error?_0x42ef93['message']:'Unknown\x20error');console[_0x2e8e70(0x1a3)]('âŒ\x20'+_0x2e91bb),_0x4bab1d[_0x2e8e70(0x191)](_0x2e91bb),_0xab3042++;}}const _0xcc3348=_0x2e8e70(0x157)+_0x587315+_0x2e8e70(0x172)+_0xab3042+_0x2e8e70(0x19d);return console[_0x2e8e70(0x1ba)](_0x2e8e70(0x16b)+_0xcc3348),loggerService_1[_0x2e8e70(0x120)][_0x2e8e70(0x19c)](_0x2e8e70(0x12b),_0x2e8e70(0x15e),_0x2e8e70(0x139),_0x2e8e70(0x15c),{'processed':_0x587315,'failed':_0xab3042,'errors':_0x4bab1d,'fastTimeoutMinutes':this[_0x2e8e70(0x146)],'slowTimeoutDays':this[_0x2e8e70(0x1a6)]}),{'processed':_0x587315,'failed':_0xab3042,'errors':_0x4bab1d};}catch(_0x44f480){const _0x252156='PENDING\x20cleanup\x20service\x20error:\x20'+(_0x44f480 instanceof Error?_0x44f480['message']:'Unknown\x20error');return console[_0x2e8e70(0x1a3)](_0x2e8e70(0x181)+_0x252156),_0x4bab1d[_0x2e8e70(0x191)](_0x252156),loggerService_1['loggerService'][_0x2e8e70(0x13d)](_0x2e8e70(0x12b),_0x252156,{'timeoutDays':this[_0x2e8e70(0x166)]}),{'processed':_0x587315,'failed':_0xab3042,'errors':_0x4bab1d};}}async[a74_0xac0f3f(0x199)](){const _0x3d0038=a74_0xac0f3f;try{const _0x48e461=new Date(),_0x3e4b56=new Date(_0x48e461[_0x3d0038(0x1a8)]()-0x1*0x18*0x3c*0x3c*0x3e8),_0xafb07=new Date(_0x48e461['getTime']()-0x3*0x18*0x3c*0x3c*0x3e8),_0x58daae=new Date(_0x48e461[_0x3d0038(0x1a8)]()-0x5*0x18*0x3c*0x3c*0x3e8),_0x85574b=await database_1[_0x3d0038(0x156)][_0x3d0038(0x135)][_0x3d0038(0x18e)]({'where':{'status':{'in':[client_1[_0x3d0038(0x17f)]['PROCESSING'],client_1['PaymentStatus']['PENDING']]}},'select':{'id':!![],'gateway':!![],'status':!![],'createdAt':!![]}}),_0x3c363a={'total':_0x85574b[_0x3d0038(0x152)],'byAge':{'fresh':0x0,'recent':0x0,'stale':0x0,'expired':0x0},'byGateway':{},'byStatus':{}};for(const _0x13fd96 of _0x85574b){if(_0x13fd96[_0x3d0038(0x149)]>_0x3e4b56)_0x3c363a[_0x3d0038(0x14e)]['fresh']++;else{if(_0x13fd96['createdAt']>_0xafb07)_0x3c363a[_0x3d0038(0x14e)][_0x3d0038(0x144)]++;else _0x13fd96[_0x3d0038(0x149)]>_0x58daae?_0x3c363a[_0x3d0038(0x14e)][_0x3d0038(0x131)]++:_0x3c363a[_0x3d0038(0x14e)]['expired']++;}!_0x3c363a[_0x3d0038(0x17a)][_0x13fd96[_0x3d0038(0x17b)]]&&(_0x3c363a['byGateway'][_0x13fd96[_0x3d0038(0x17b)]]=0x0);_0x3c363a[_0x3d0038(0x17a)][_0x13fd96['gateway']]++;const _0x2f4ddd=_0x13fd96[_0x3d0038(0x12f)];!_0x3c363a[_0x3d0038(0x16c)][_0x2f4ddd]&&(_0x3c363a['byStatus'][_0x2f4ddd]=0x0),_0x3c363a[_0x3d0038(0x16c)][_0x2f4ddd]++;}return _0x3c363a;}catch(_0x101e73){console[_0x3d0038(0x1a3)]('Failed\x20to\x20get\x20processing\x20payments\x20stats:',_0x101e73);throw new Error(_0x3d0038(0x130)+(_0x101e73 instanceof Error?_0x101e73[_0x3d0038(0x1b3)]:_0x3d0038(0x18a)));}}async[a74_0xac0f3f(0x123)](){const _0x19ffec=a74_0xac0f3f;console[_0x19ffec(0x1ba)](_0x19ffec(0x153));const _0x16c791=await this[_0x19ffec(0x199)]();console[_0x19ffec(0x1ba)](_0x19ffec(0x148)),console['log']('\x20\x20\x20Total:\x20'+_0x16c791[_0x19ffec(0x132)]),console[_0x19ffec(0x1ba)](_0x19ffec(0x150)+_0x16c791[_0x19ffec(0x14e)][_0x19ffec(0x1b7)]),console[_0x19ffec(0x1ba)]('\x20\x20\x20Recent\x20(1-3\x20days):\x20'+_0x16c791[_0x19ffec(0x14e)][_0x19ffec(0x144)]),console[_0x19ffec(0x1ba)](_0x19ffec(0x173)+_0x16c791['byAge'][_0x19ffec(0x131)]),console[_0x19ffec(0x1ba)](_0x19ffec(0x14d)+_0x16c791[_0x19ffec(0x14e)][_0x19ffec(0x192)]),console[_0x19ffec(0x1ba)](_0x19ffec(0x12d),_0x16c791[_0x19ffec(0x17a)]),console[_0x19ffec(0x1ba)]('\x20\x20\x20By\x20status:',_0x16c791[_0x19ffec(0x16c)]),console[_0x19ffec(0x1ba)](_0x19ffec(0x1a0));const _0x1292b2=await this[_0x19ffec(0x1ae)]();console[_0x19ffec(0x1ba)](_0x19ffec(0x13b));const _0x287e67=await this[_0x19ffec(0x1a1)](),_0x171f9d=await this[_0x19ffec(0x199)]();console[_0x19ffec(0x1ba)](_0x19ffec(0x145)),console['log'](_0x19ffec(0x1ad)+_0x171f9d[_0x19ffec(0x132)]),console[_0x19ffec(0x1ba)](_0x19ffec(0x14d)+_0x171f9d['byAge'][_0x19ffec(0x192)]),console[_0x19ffec(0x1ba)](_0x19ffec(0x186),_0x171f9d[_0x19ffec(0x16c)]);const _0x2ef557=_0x1292b2['processed']+_0x287e67[_0x19ffec(0x13a)],_0x10b354=_0x1292b2['failed']+_0x287e67[_0x19ffec(0x188)],_0xbca1aa=[..._0x1292b2['errors'],..._0x287e67[_0x19ffec(0x177)]];console['log'](_0x19ffec(0x19e)),console[_0x19ffec(0x1ba)](_0x19ffec(0x15f)+_0x1292b2['processed']),console[_0x19ffec(0x1ba)]('\x20\x20\x20â°\x20PENDING\x20â†’\x20EXPIRED:\x20'+_0x287e67['processed']),console[_0x19ffec(0x1ba)](_0x19ffec(0x14a)+_0x2ef557),console[_0x19ffec(0x1ba)](_0x19ffec(0x137)+_0x10b354),console['log'](_0x19ffec(0x187)+(_0x16c791[_0x19ffec(0x132)]-_0x171f9d[_0x19ffec(0x132)])),_0xbca1aa[_0x19ffec(0x152)]>0x0&&(console[_0x19ffec(0x1ba)](_0x19ffec(0x11f)),_0xbca1aa[_0x19ffec(0x18f)]((_0x4b6617,_0x48b737)=>{const _0x3c53d1=_0x19ffec;console[_0x3c53d1(0x1ba)](_0x3c53d1(0x1af)+(_0x48b737+0x1)+'.\x20'+_0x4b6617);})),console[_0x19ffec(0x1ba)]('ðŸ\x20Payment\x20cleanup\x20service\x20completed');}async[a74_0xac0f3f(0x1a2)](){const _0x2a2b4f=a74_0xac0f3f;console[_0x2a2b4f(0x1ba)]('ðŸš€\x20Starting\x20PROCESSING\x20payments\x20cleanup\x20only...');const _0x13d701=await this[_0x2a2b4f(0x199)](),_0x58fed7=_0x13d701[_0x2a2b4f(0x16c)]['PROCESSING']||0x0;console['log']('ðŸ“Š\x20PROCESSING\x20payments\x20before\x20cleanup:\x20'+_0x58fed7);const _0x33ae4c=await this[_0x2a2b4f(0x1ae)](),_0x503cf8=await this[_0x2a2b4f(0x199)](),_0x105417=_0x503cf8[_0x2a2b4f(0x16c)][_0x2a2b4f(0x13c)]||0x0;console['log'](_0x2a2b4f(0x159)+_0x105417),console['log']('âœ…\x20PROCESSING\x20payments\x20processed:\x20'+_0x33ae4c[_0x2a2b4f(0x13a)]),console['log'](_0x2a2b4f(0x168));}async[a74_0xac0f3f(0x127)](){const _0x2f3a04=a74_0xac0f3f;console[_0x2f3a04(0x1ba)](_0x2f3a04(0x163));const _0x53d6dc=await this[_0x2f3a04(0x199)](),_0x461652=_0x53d6dc[_0x2f3a04(0x16c)]['PENDING']||0x0;console['log'](_0x2f3a04(0x1bb)+_0x461652);const _0x5dcc33=await this[_0x2f3a04(0x1a1)](),_0x240dd9=await this[_0x2f3a04(0x199)](),_0x1cea98=_0x240dd9['byStatus'][_0x2f3a04(0x1b1)]||0x0;console[_0x2f3a04(0x1ba)](_0x2f3a04(0x15a)+_0x1cea98),console[_0x2f3a04(0x1ba)](_0x2f3a04(0x12e)+_0x5dcc33[_0x2f3a04(0x13a)]),console['log'](_0x2f3a04(0x178));}async[a74_0xac0f3f(0x18c)](){const _0x5af088=a74_0xac0f3f,_0x4cd6b6=[];let _0x3b3a40=0x0;try{console[_0x5af088(0x1ba)]('â°\x20Starting\x20expiration\x20check\x20for\x20SINGLE\x20payment\x20links...');const _0x4dc7c0=new Date(),_0xb935b3=['oxapay',_0x5af088(0x182)],_0x49f180=[_0x5af088(0x1aa),_0x5af088(0x176),_0x5af088(0x121),_0x5af088(0x134)],_0x4d439a=await database_1[_0x5af088(0x156)]['paymentLink'][_0x5af088(0x18e)]({'where':{'type':'SINGLE','status':_0x5af088(0x194)},'include':{'payments':{'orderBy':{'createdAt':_0x5af088(0x14b)},'take':0x1}}});console[_0x5af088(0x1ba)](_0x5af088(0x12a)+_0x4d439a[_0x5af088(0x152)]+_0x5af088(0x170));for(const _0x385683 of _0x4d439a){try{if(_0x385683[_0x5af088(0x17c)]['length']===0x0)continue;const _0xc079c1=_0x385683[_0x5af088(0x17c)][0x0];if(_0xc079c1['status']===_0x5af088(0x124))continue;const _0x573a44=_0x4dc7c0[_0x5af088(0x1a8)]()-_0xc079c1[_0x5af088(0x149)][_0x5af088(0x1a8)]();let _0x31be12;_0xb935b3[_0x5af088(0x1ab)](_0x385683[_0x5af088(0x17b)])||_0x49f180['includes'](_0x385683['gateway'])?_0x31be12=0x1e*0x3c*0x3e8:_0x31be12=0x3*0x18*0x3c*0x3c*0x3e8,_0x573a44>_0x31be12&&(await database_1['default'][_0x5af088(0x143)][_0x5af088(0x138)]({'where':{'id':_0x385683['id']},'data':{'status':'EXPIRED'}}),console[_0x5af088(0x1ba)](_0x5af088(0x174)+_0x385683['id']+_0x5af088(0x1b8)+_0x385683[_0x5af088(0x17b)]+',\x20payment\x20age:\x20'+Math[_0x5af088(0x19b)](_0x573a44/0x3e8/0x3c)+'\x20minutes)'),_0x3b3a40++);}catch(_0x38eecc){const _0x3b0787=_0x5af088(0x1b2)+_0x385683['id']+':\x20'+(_0x38eecc instanceof Error?_0x38eecc[_0x5af088(0x1b3)]:'Unknown\x20error');console[_0x5af088(0x1a3)]('âŒ\x20'+_0x3b0787),_0x4cd6b6['push'](_0x3b0787);}}return console[_0x5af088(0x1ba)](_0x5af088(0x180)+_0x3b3a40+'\x20links\x20expired'),{'expired':_0x3b3a40,'errors':_0x4cd6b6};}catch(_0x33aa08){const _0xa91c7c=_0x5af088(0x17d)+(_0x33aa08 instanceof Error?_0x33aa08[_0x5af088(0x1b3)]:_0x5af088(0x18a));return console[_0x5af088(0x1a3)](_0x5af088(0x181)+_0xa91c7c),_0x4cd6b6[_0x5af088(0x191)](_0xa91c7c),{'expired':_0x3b3a40,'errors':_0x4cd6b6};}}}function a74_0x3d81(){const _0x1720b0=['PROCESSING','logWebhookError','319isYHeP','ðŸ“‹\x20Fast\x20timeout\x20gateways:\x20','auto_timeout_pending','@prisma/client','__esModule','paymentLink','recent','\x0aðŸ“Š\x20Stale\x20payments\x20(PROCESSING\x20+\x20PENDING)\x20after\x20cleanup:','FAST_TIMEOUT_MINUTES','auto_timeout','ðŸ“Š\x20Stale\x20payments\x20(PROCESSING\x20+\x20PENDING)\x20before\x20cleanup:','createdAt','\x20\x20\x20âœ…\x20Total\x20successfully\x20processed:\x20','desc','setDate','\x20\x20\x20Expired\x20(>\x205\x20days):\x20','byAge','1423584bDhjWi','\x20\x20\x20Fresh\x20(<\x201\x20day):\x20','amount','length','ðŸš€\x20Starting\x20payment\x20cleanup\x20service...','squirrel-pay','3052445WqHQOF','default','PENDING\x20cleanup\x20completed:\x20','PROCESSING_TIMEOUT_DAYS','ðŸ“Š\x20PROCESSING\x20payments\x20after\x20cleanup:\x20','ðŸ“Š\x20PENDING\x20payments\x20after\x20cleanup:\x20','\x20timeout)','admin','\x20from\x20PENDING\x20to\x20EXPIRED','POST','\x20\x20\x20ðŸ”„\x20PROCESSING\x20â†’\x20FAILED:\x20','â±ï¸\x20Processing\x20stale\x20payment:\x20','863844iTRBEx','170AZbyKm','ðŸš€\x20Starting\x20PENDING\x20payments\x20cleanup\x20only...','âœ…\x20Updated\x20payment\x20','28RTcuUE','PENDING_TIMEOUT_DAYS','Cleanup\x20service\x20error:\x20','ðŸ\x20PROCESSING\x20cleanup\x20completed','getDate','../config/database','ðŸ“Š\x20','byStatus','currency','\x20\x20\x20Gateway:\x20','toISOString','\x20active\x20SINGLE\x20links\x20to\x20check','join','\x20payments\x20updated\x20to\x20EXPIRED,\x20','\x20\x20\x20Stale\x20(3-5\x20days):\x20','â°\x20Expired\x20link\x20','ðŸ“…\x20Slow\x20timeout\x20(3\x20days):\x20','rapyd','errors','ðŸ\x20PENDING\x20cleanup\x20completed','4538jLnsWu','byGateway','gateway','payments','Link\x20expiration\x20service\x20error:\x20','Failed\x20to\x20update\x20PENDING\x20payment\x20','PaymentStatus','ðŸ“Š\x20Expiration\x20completed:\x20','ðŸ’¥\x20','plisio','username','\x20\x20\x20Shop:\x20','ðŸ§¹\x20Starting\x20cleanup\x20of\x20stale\x20PROCESSING\x20payments...','\x20\x20\x20By\x20status:','\x20\x20\x20ðŸ“‰\x20Total\x20stale\x20payments\x20reduced\x20by:\x20','failed','defineProperty','Unknown\x20error','name','expireSinglePaymentLinks','ðŸ“…\x20Fast\x20timeout\x20(30\x20min):\x20','findMany','forEach','FAST_TIMEOUT_GATEWAYS','push','expired','28521cxaEut','ACTIVE','shop','now','\x20from\x20PROCESSING\x20to\x20FAILED','ðŸ“…\x20Looking\x20for\x20PROCESSING\x20payments\x20older\x20than:\x20','getProcessingPaymentsStats','Payment\x20timeout:\x20No\x20payment\x20action\x20received\x20within\x20','round','logApiCall','\x20failed\x20to\x20update','\x0aðŸ“ˆ\x20Cleanup\x20Summary:','âœ…\x20No\x20stale\x20PROCESSING\x20payments\x20found','\x0aðŸ”„\x20Running\x20PROCESSING\x20payments\x20cleanup...','cleanupStalePendingPayments','runProcessingCleanupOnly','error','\x20minutes','8LaHLmF','SLOW_TIMEOUT_DAYS','3420976AtvSjc','getTime','PaymentCleanupService','squirrelpay','includes','3\x20days','\x20\x20\x20Total:\x20','cleanupStaleProcessingPayments','\x20\x20\x20\x20\x20\x20','Payment\x20timeout:\x20No\x20status\x20update\x20received\x20for\x20','PENDING','Failed\x20to\x20expire\x20link\x20','message','\x20\x20\x20Created:\x20','ðŸ§¹\x20Starting\x20cleanup\x20of\x20stale\x20PENDING\x20payments...','151LBYEkc','fresh','\x20(gateway:\x20','\x20days','log','ðŸ“Š\x20PENDING\x20payments\x20before\x20cleanup:\x20','\x20stale\x20PENDING\x20payments','\x20\x20\x20âš ï¸\x20Errors\x20encountered:','loggerService','visa/mastercard','30\x20minutes','runCleanupWithReport','PAID','EXPIRED','logWebhookProcessed','runPendingCleanupOnly','Cleanup\x20completed:\x20','\x20\x20\x20Amount:\x20','ðŸ”\x20Found\x20','pending_payment_cleanup','1569432xBmLiy','\x20\x20\x20By\x20gateway:','âœ…\x20PENDING\x20payments\x20processed:\x20','status','Failed\x20to\x20get\x20processing\x20payments\x20stats:\x20','stale','total','payment_cleanup','mastercard','payment','\x20\x20\x20Age:\x20','\x20\x20\x20âŒ\x20Total\x20failed\x20to\x20process:\x20','update','system','processed','\x0aðŸ”„\x20Running\x20PENDING\x20payments\x20cleanup...'];a74_0x3d81=function(){return _0x1720b0;};return a74_0x3d81();}exports[a74_0xac0f3f(0x1a9)]=PaymentCleanupService,exports['paymentCleanupService']=new PaymentCleanupService();