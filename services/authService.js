'use strict';const a36_0x12848f=a36_0x58f4;(function(_0x52de5c,_0x88dada){const _0x108acb=a36_0x58f4,_0x3ba7cf=_0x52de5c();while(!![]){try{const _0xe72e77=parseInt(_0x108acb(0x13a))/0x1*(-parseInt(_0x108acb(0x136))/0x2)+parseInt(_0x108acb(0x131))/0x3+parseInt(_0x108acb(0x149))/0x4*(-parseInt(_0x108acb(0x140))/0x5)+parseInt(_0x108acb(0x13d))/0x6+-parseInt(_0x108acb(0x13c))/0x7+-parseInt(_0x108acb(0x143))/0x8+parseInt(_0x108acb(0x147))/0x9;if(_0xe72e77===_0x88dada)break;else _0x3ba7cf['push'](_0x3ba7cf['shift']());}catch(_0x46e62b){_0x3ba7cf['push'](_0x3ba7cf['shift']());}}}(a36_0x2d46,0xcd343));function a36_0x58f4(_0x3947d4,_0xac4393){const _0x2d4699=a36_0x2d46();return a36_0x58f4=function(_0x58f42d,_0x40b101){_0x58f42d=_0x58f42d-0x12b;let _0xe4f1fd=_0x2d4699[_0x58f42d];return _0xe4f1fd;},a36_0x58f4(_0x3947d4,_0xac4393);}var __importDefault=this&&this['__importDefault']||function(_0x13ea2c){const _0xbca921=a36_0x58f4;return _0x13ea2c&&_0x13ea2c[_0xbca921(0x13e)]?_0x13ea2c:{'default':_0x13ea2c};};Object['defineProperty'](exports,a36_0x12848f(0x13e),{'value':!![]}),exports[a36_0x12848f(0x12b)]=void 0x0;const bcryptjs_1=__importDefault(require(a36_0x12848f(0x14a))),jsonwebtoken_1=__importDefault(require(a36_0x12848f(0x146))),database_1=__importDefault(require('../config/database')),config_1=require('../config/config');function a36_0x2d46(){const _0x2e6439=['generateToken','876967QSkTnW','3015690iembMq','__esModule','shop','2416730dHFKyD','findUnique','Invalid\x20credentials','5364904iPDLBI','default','Invalid\x20token','jsonwebtoken','5516604LtBkmN','password','4XzNxEA','bcryptjs','AuthService','config','sign','username','admin','verify','3097482lSjcym','verifyToken','passwordHash','jwt','Account\x20is\x20not\x20active','5662laRaia','name','secret','login','10UcmhoQ'];a36_0x2d46=function(){return _0x2e6439;};return a36_0x2d46();}class AuthService{[a36_0x12848f(0x13b)](_0x4be88a){const _0x1d34a7=a36_0x12848f;return jsonwebtoken_1[_0x1d34a7(0x144)][_0x1d34a7(0x12d)](_0x4be88a,config_1[_0x1d34a7(0x12c)]['jwt']['secret'],{'expiresIn':String(config_1[_0x1d34a7(0x12c)][_0x1d34a7(0x134)]['expiresIn'])});}async[a36_0x12848f(0x139)](_0x5a7d4a){const _0x34999f=a36_0x12848f,{username:_0x1a04fe,password:_0x35e6eb}=_0x5a7d4a;if(_0x1a04fe===config_1[_0x34999f(0x12c)][_0x34999f(0x12f)][_0x34999f(0x12e)]){const _0x5d0dbb=await bcryptjs_1[_0x34999f(0x144)]['compare'](_0x35e6eb,config_1[_0x34999f(0x12c)]['admin'][_0x34999f(0x133)]);if(_0x5d0dbb){const _0x4b95e4=this[_0x34999f(0x13b)]({'id':_0x34999f(0x12f),'username':config_1[_0x34999f(0x12c)][_0x34999f(0x12f)]['username'],'role':_0x34999f(0x12f)});return{'access_token':_0x4b95e4,'role':'admin'};}}const _0x3420f0=await database_1['default'][_0x34999f(0x13f)][_0x34999f(0x141)]({'where':{'username':_0x1a04fe},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x3420f0)throw new Error(_0x34999f(0x142));if(_0x3420f0['status']!=='ACTIVE')throw new Error(_0x34999f(0x135));const _0x3a3ac9=await bcryptjs_1[_0x34999f(0x144)]['compare'](_0x35e6eb,_0x3420f0[_0x34999f(0x148)]);if(!_0x3a3ac9)throw new Error(_0x34999f(0x142));const _0x28dc2d=this[_0x34999f(0x13b)]({'id':_0x3420f0['id'],'username':_0x3420f0[_0x34999f(0x12e)],'role':_0x34999f(0x13f)});return{'access_token':_0x28dc2d,'role':_0x34999f(0x13f),'user':{'id':_0x3420f0['id'],'name':_0x3420f0[_0x34999f(0x137)],'username':_0x3420f0[_0x34999f(0x12e)]}};}async[a36_0x12848f(0x132)](_0x26a654){const _0x133c0c=a36_0x12848f;try{const _0xf651fa=jsonwebtoken_1[_0x133c0c(0x144)][_0x133c0c(0x130)](_0x26a654,config_1[_0x133c0c(0x12c)][_0x133c0c(0x134)][_0x133c0c(0x138)]);return _0xf651fa;}catch(_0x26d8b5){throw new Error(_0x133c0c(0x145));}}}exports[a36_0x12848f(0x12b)]=AuthService;