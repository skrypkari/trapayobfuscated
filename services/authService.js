'use strict';const a36_0x50677b=a36_0x4cfa;function a36_0x4cfa(_0x5a3934,_0x14e4e7){const _0xebb174=a36_0xebb1();return a36_0x4cfa=function(_0x4cfa8c,_0x51884b){_0x4cfa8c=_0x4cfa8c-0xae;let _0x1fa4d3=_0xebb174[_0x4cfa8c];return _0x1fa4d3;},a36_0x4cfa(_0x5a3934,_0x14e4e7);}(function(_0x49c334,_0x2af19d){const _0x1ab71a=a36_0x4cfa,_0x58570f=_0x49c334();while(!![]){try{const _0x3c53ce=parseInt(_0x1ab71a(0xbd))/0x1*(-parseInt(_0x1ab71a(0xbe))/0x2)+-parseInt(_0x1ab71a(0xb8))/0x3+-parseInt(_0x1ab71a(0xb7))/0x4+-parseInt(_0x1ab71a(0xb9))/0x5+-parseInt(_0x1ab71a(0xce))/0x6*(parseInt(_0x1ab71a(0xc4))/0x7)+-parseInt(_0x1ab71a(0xb0))/0x8+parseInt(_0x1ab71a(0xd0))/0x9;if(_0x3c53ce===_0x2af19d)break;else _0x58570f['push'](_0x58570f['shift']());}catch(_0x2ac47b){_0x58570f['push'](_0x58570f['shift']());}}}(a36_0xebb1,0x52333));var __importDefault=this&&this[a36_0x50677b(0xbb)]||function(_0x3c29cc){return _0x3c29cc&&_0x3c29cc['__esModule']?_0x3c29cc:{'default':_0x3c29cc};};function a36_0xebb1(){const _0x4a9d99=['jwt','defineProperty','Invalid\x20credentials','Account\x20is\x20not\x20active','2120856dQQAqm','1549263WuuIdJ','2962875aRulJs','AuthService','__importDefault','jsonwebtoken','15mLVsCL','72606SjoEmT','compare','password','status','verify','../config/config','2781758ZOHiGe','../config/database','shop','secret','name','generateToken','__esModule','config','admin','ACTIVE','6nsIXfS','verifyToken','31883670pxwMwe','expiresIn','Invalid\x20token','bcryptjs','4998320RKFVVR','username','default'];a36_0xebb1=function(){return _0x4a9d99;};return a36_0xebb1();}Object[a36_0x50677b(0xb4)](exports,a36_0x50677b(0xca),{'value':!![]}),exports[a36_0x50677b(0xba)]=void 0x0;const bcryptjs_1=__importDefault(require(a36_0x50677b(0xaf))),jsonwebtoken_1=__importDefault(require(a36_0x50677b(0xbc))),database_1=__importDefault(require(a36_0x50677b(0xc5))),config_1=require(a36_0x50677b(0xc3));class AuthService{['generateToken'](_0x1f9181){const _0x13d7c7=a36_0x50677b;return jsonwebtoken_1[_0x13d7c7(0xb2)]['sign'](_0x1f9181,config_1['config'][_0x13d7c7(0xb3)]['secret'],{'expiresIn':String(config_1['config'][_0x13d7c7(0xb3)][_0x13d7c7(0xd1)])});}async['login'](_0x1efd8d){const _0x532853=a36_0x50677b,{username:_0x52cc93,password:_0x460bdd}=_0x1efd8d;if(_0x52cc93===config_1['config'][_0x532853(0xcc)][_0x532853(0xb1)]){const _0x27c728=await bcryptjs_1[_0x532853(0xb2)]['compare'](_0x460bdd,config_1['config'][_0x532853(0xcc)]['passwordHash']);if(_0x27c728){const _0x5eee51=this['generateToken']({'id':_0x532853(0xcc),'username':config_1[_0x532853(0xcb)][_0x532853(0xcc)]['username'],'role':_0x532853(0xcc)});return{'access_token':_0x5eee51,'role':_0x532853(0xcc)};}}const _0x5e3acc=await database_1[_0x532853(0xb2)][_0x532853(0xc6)]['findUnique']({'where':{'username':_0x52cc93},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x5e3acc)throw new Error(_0x532853(0xb5));if(_0x5e3acc[_0x532853(0xc1)]!==_0x532853(0xcd))throw new Error(_0x532853(0xb6));const _0x508a3a=await bcryptjs_1[_0x532853(0xb2)][_0x532853(0xbf)](_0x460bdd,_0x5e3acc[_0x532853(0xc0)]);if(!_0x508a3a)throw new Error('Invalid\x20credentials');const _0x51a026=this[_0x532853(0xc9)]({'id':_0x5e3acc['id'],'username':_0x5e3acc['username'],'role':_0x532853(0xc6)});return{'access_token':_0x51a026,'role':_0x532853(0xc6),'user':{'id':_0x5e3acc['id'],'name':_0x5e3acc[_0x532853(0xc8)],'username':_0x5e3acc[_0x532853(0xb1)]}};}async[a36_0x50677b(0xcf)](_0x31e169){const _0x57ce63=a36_0x50677b;try{const _0x51307a=jsonwebtoken_1[_0x57ce63(0xb2)][_0x57ce63(0xc2)](_0x31e169,config_1['config'][_0x57ce63(0xb3)][_0x57ce63(0xc7)]);return _0x51307a;}catch(_0x4c7894){throw new Error(_0x57ce63(0xae));}}}exports['AuthService']=AuthService;