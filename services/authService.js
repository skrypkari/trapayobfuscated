'use strict';function a34_0x4460(){const _0x3b36bc=['93904ZbxMta','defineProperty','verify','passwordHash','5044255sSkxkC','AuthService','bcryptjs','name','101682eAzIYV','ACTIVE','config','837smqJce','8473626uGaPDU','20138780wIcAth','secret','Invalid\x20credentials','findUnique','sign','1568384oNoQRB','Account\x20is\x20not\x20active','jsonwebtoken','compare','admin','__esModule','password','generateToken','status','1910eGQjfv','../config/config','default','54ERuMBc','username','__importDefault','6OsVweo','jwt','login','shop'];a34_0x4460=function(){return _0x3b36bc;};return a34_0x4460();}const a34_0x5df772=a34_0x2989;(function(_0xe07c1f,_0x21a5dd){const _0x419618=a34_0x2989,_0x39ad8c=_0xe07c1f();while(!![]){try{const _0x4f8ed2=-parseInt(_0x419618(0x159))/0x1*(parseInt(_0x419618(0x169))/0x2)+parseInt(_0x419618(0x16c))/0x3*(-parseInt(_0x419618(0x14e))/0x4)+parseInt(_0x419618(0x152))/0x5*(-parseInt(_0x419618(0x16f))/0x6)+-parseInt(_0x419618(0x156))/0x7+-parseInt(_0x419618(0x160))/0x8+parseInt(_0x419618(0x15a))/0x9+parseInt(_0x419618(0x15b))/0xa;if(_0x4f8ed2===_0x21a5dd)break;else _0x39ad8c['push'](_0x39ad8c['shift']());}catch(_0x516c43){_0x39ad8c['push'](_0x39ad8c['shift']());}}}(a34_0x4460,0x7d810));var __importDefault=this&&this[a34_0x5df772(0x16e)]||function(_0x3d4596){const _0x8a8eb1=a34_0x5df772;return _0x3d4596&&_0x3d4596[_0x8a8eb1(0x165)]?_0x3d4596:{'default':_0x3d4596};};Object[a34_0x5df772(0x14f)](exports,a34_0x5df772(0x165),{'value':!![]}),exports[a34_0x5df772(0x153)]=void 0x0;function a34_0x2989(_0x2fef0c,_0x199d69){const _0x44607c=a34_0x4460();return a34_0x2989=function(_0x2989d9,_0x29aed0){_0x2989d9=_0x2989d9-0x14c;let _0x1b4072=_0x44607c[_0x2989d9];return _0x1b4072;},a34_0x2989(_0x2fef0c,_0x199d69);}const bcryptjs_1=__importDefault(require(a34_0x5df772(0x154))),jsonwebtoken_1=__importDefault(require(a34_0x5df772(0x162))),database_1=__importDefault(require('../config/database')),config_1=require(a34_0x5df772(0x16a));class AuthService{['generateToken'](_0x3b5902){const _0x23d14a=a34_0x5df772;return jsonwebtoken_1[_0x23d14a(0x16b)][_0x23d14a(0x15f)](_0x3b5902,config_1[_0x23d14a(0x158)][_0x23d14a(0x170)][_0x23d14a(0x15c)],{'expiresIn':String(config_1[_0x23d14a(0x158)]['jwt']['expiresIn'])});}async[a34_0x5df772(0x14c)](_0x5d3865){const _0xe8befd=a34_0x5df772,{username:_0x4032e5,password:_0x5d2d3a}=_0x5d3865;if(_0x4032e5===config_1[_0xe8befd(0x158)][_0xe8befd(0x164)][_0xe8befd(0x16d)]){const _0x617df0=await bcryptjs_1[_0xe8befd(0x16b)][_0xe8befd(0x163)](_0x5d2d3a,config_1[_0xe8befd(0x158)][_0xe8befd(0x164)][_0xe8befd(0x151)]);if(_0x617df0){const _0x102b63=this[_0xe8befd(0x167)]({'id':_0xe8befd(0x164),'username':config_1['config'][_0xe8befd(0x164)][_0xe8befd(0x16d)],'role':'admin'});return{'access_token':_0x102b63,'role':_0xe8befd(0x164)};}}const _0x5862bc=await database_1[_0xe8befd(0x16b)][_0xe8befd(0x14d)][_0xe8befd(0x15e)]({'where':{'username':_0x4032e5},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x5862bc)throw new Error(_0xe8befd(0x15d));if(_0x5862bc[_0xe8befd(0x168)]!==_0xe8befd(0x157))throw new Error(_0xe8befd(0x161));const _0x43b734=await bcryptjs_1[_0xe8befd(0x16b)]['compare'](_0x5d2d3a,_0x5862bc[_0xe8befd(0x166)]);if(!_0x43b734)throw new Error(_0xe8befd(0x15d));const _0x15288d=this[_0xe8befd(0x167)]({'id':_0x5862bc['id'],'username':_0x5862bc[_0xe8befd(0x16d)],'role':'shop'});return{'access_token':_0x15288d,'role':'shop','user':{'id':_0x5862bc['id'],'name':_0x5862bc[_0xe8befd(0x155)],'username':_0x5862bc[_0xe8befd(0x16d)]}};}async['verifyToken'](_0x479f47){const _0x5104e9=a34_0x5df772;try{const _0x4732b2=jsonwebtoken_1[_0x5104e9(0x16b)][_0x5104e9(0x150)](_0x479f47,config_1[_0x5104e9(0x158)][_0x5104e9(0x170)][_0x5104e9(0x15c)]);return _0x4732b2;}catch(_0x1f4763){throw new Error('Invalid\x20token');}}}exports[a34_0x5df772(0x153)]=AuthService;