'use strict';const a37_0xa8c132=a37_0x2a50;(function(_0x2cd607,_0x4ed6d5){const _0x135e57=a37_0x2a50,_0x30ee80=_0x2cd607();while(!![]){try{const _0x2b0df7=-parseInt(_0x135e57(0x1c4))/0x1*(-parseInt(_0x135e57(0x1ca))/0x2)+parseInt(_0x135e57(0x1db))/0x3*(-parseInt(_0x135e57(0x1cd))/0x4)+-parseInt(_0x135e57(0x1e4))/0x5+parseInt(_0x135e57(0x1d7))/0x6*(parseInt(_0x135e57(0x1d5))/0x7)+-parseInt(_0x135e57(0x1cc))/0x8*(parseInt(_0x135e57(0x1e0))/0x9)+parseInt(_0x135e57(0x1c5))/0xa*(parseInt(_0x135e57(0x1d6))/0xb)+-parseInt(_0x135e57(0x1e5))/0xc;if(_0x2b0df7===_0x4ed6d5)break;else _0x30ee80['push'](_0x30ee80['shift']());}catch(_0x55f49b){_0x30ee80['push'](_0x30ee80['shift']());}}}(a37_0x28ac,0x70dfe));function a37_0x2a50(_0x2834f2,_0x1ec10f){const _0x28aca7=a37_0x28ac();return a37_0x2a50=function(_0x2a507b,_0x2d3953){_0x2a507b=_0x2a507b-0x1c3;let _0x322403=_0x28aca7[_0x2a507b];return _0x322403;},a37_0x2a50(_0x2834f2,_0x1ec10f);}var __importDefault=this&&this[a37_0xa8c132(0x1d4)]||function(_0x5e0f96){return _0x5e0f96&&_0x5e0f96['__esModule']?_0x5e0f96:{'default':_0x5e0f96};};Object['defineProperty'](exports,a37_0xa8c132(0x1d0),{'value':!![]}),exports['AuthService']=void 0x0;function a37_0x28ac(){const _0x1e7fed=['default','Account\x20is\x20not\x20active','ACTIVE','577430RWMvey','4543032UqVdDJ','bcryptjs','compare','passwordHash','secret','14mcDksd','10zgRmPQ','findUnique','sign','../config/database','username','82758QQfnhh','admin','1408zvKhNJ','4ZOMpRL','config','login','__esModule','status','jwt','name','__importDefault','4678625VUxise','2399837OrWgSz','6wNTtje','Invalid\x20credentials','password','AuthService','247926dvyNon','generateToken','verifyToken','shop','Invalid\x20token','21825dmWNIh'];a37_0x28ac=function(){return _0x1e7fed;};return a37_0x28ac();}const bcryptjs_1=__importDefault(require(a37_0xa8c132(0x1e6))),jsonwebtoken_1=__importDefault(require('jsonwebtoken')),database_1=__importDefault(require(a37_0xa8c132(0x1c8))),config_1=require('../config/config');class AuthService{[a37_0xa8c132(0x1dc)](_0x44c830){const _0x56eff9=a37_0xa8c132;return jsonwebtoken_1[_0x56eff9(0x1e1)][_0x56eff9(0x1c7)](_0x44c830,config_1[_0x56eff9(0x1ce)][_0x56eff9(0x1d2)][_0x56eff9(0x1c3)],{'expiresIn':String(config_1['config'][_0x56eff9(0x1d2)]['expiresIn'])});}async[a37_0xa8c132(0x1cf)](_0x3d4b66){const _0x5e9f91=a37_0xa8c132,{username:_0x109096,password:_0x3eda79}=_0x3d4b66;if(_0x109096===config_1['config'][_0x5e9f91(0x1cb)][_0x5e9f91(0x1c9)]){const _0x4f9298=await bcryptjs_1[_0x5e9f91(0x1e1)][_0x5e9f91(0x1e7)](_0x3eda79,config_1['config'][_0x5e9f91(0x1cb)][_0x5e9f91(0x1e8)]);if(_0x4f9298){const _0x1ea2a2=this['generateToken']({'id':_0x5e9f91(0x1cb),'username':config_1['config'][_0x5e9f91(0x1cb)][_0x5e9f91(0x1c9)],'role':_0x5e9f91(0x1cb)});return{'access_token':_0x1ea2a2,'role':_0x5e9f91(0x1cb)};}}const _0x3fce73=await database_1['default'][_0x5e9f91(0x1de)][_0x5e9f91(0x1c6)]({'where':{'username':_0x109096},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x3fce73)throw new Error('Invalid\x20credentials');if(_0x3fce73[_0x5e9f91(0x1d1)]!==_0x5e9f91(0x1e3))throw new Error(_0x5e9f91(0x1e2));const _0x1df229=await bcryptjs_1[_0x5e9f91(0x1e1)][_0x5e9f91(0x1e7)](_0x3eda79,_0x3fce73[_0x5e9f91(0x1d9)]);if(!_0x1df229)throw new Error(_0x5e9f91(0x1d8));const _0x25eb1d=this['generateToken']({'id':_0x3fce73['id'],'username':_0x3fce73[_0x5e9f91(0x1c9)],'role':'shop'});return{'access_token':_0x25eb1d,'role':_0x5e9f91(0x1de),'user':{'id':_0x3fce73['id'],'name':_0x3fce73[_0x5e9f91(0x1d3)],'username':_0x3fce73[_0x5e9f91(0x1c9)]}};}async[a37_0xa8c132(0x1dd)](_0x13cd3f){const _0x48cce2=a37_0xa8c132;try{const _0x5e616c=jsonwebtoken_1[_0x48cce2(0x1e1)]['verify'](_0x13cd3f,config_1[_0x48cce2(0x1ce)][_0x48cce2(0x1d2)][_0x48cce2(0x1c3)]);return _0x5e616c;}catch(_0x3700ff){throw new Error(_0x48cce2(0x1df));}}}exports[a37_0xa8c132(0x1da)]=AuthService;