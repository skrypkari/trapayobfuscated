'use strict';function a37_0x48d9(){const _0x36f365=['generateToken','verify','default','15nKPktJ','username','71908gUgqZQ','4080174OeHFJy','__esModule','Invalid\x20credentials','Account\x20is\x20not\x20active','816180jpMCXc','login','15626UjzAwr','__importDefault','3560039kPzBnq','findUnique','278931LNeNBU','bcryptjs','admin','117btEKzo','sign','compare','name','jwt','ACTIVE','../config/config','Invalid\x20token','624744JoLqeV','status','config','shop','password','secret','AuthService'];a37_0x48d9=function(){return _0x36f365;};return a37_0x48d9();}const a37_0x8d34cb=a37_0x237b;(function(_0x1a11cf,_0x495e73){const _0x23aed5=a37_0x237b,_0x5ddda7=_0x1a11cf();while(!![]){try{const _0x5905df=parseInt(_0x23aed5(0x155))/0x1*(parseInt(_0x23aed5(0x15e))/0x2)+-parseInt(_0x23aed5(0x162))/0x3+-parseInt(_0x23aed5(0x157))/0x4+parseInt(_0x23aed5(0x15c))/0x5+parseInt(_0x23aed5(0x158))/0x6+parseInt(_0x23aed5(0x160))/0x7+-parseInt(_0x23aed5(0x14b))/0x8*(parseInt(_0x23aed5(0x143))/0x9);if(_0x5905df===_0x495e73)break;else _0x5ddda7['push'](_0x5ddda7['shift']());}catch(_0x579c86){_0x5ddda7['push'](_0x5ddda7['shift']());}}}(a37_0x48d9,0x53b5a));function a37_0x237b(_0x473f99,_0x13d085){const _0x48d9f5=a37_0x48d9();return a37_0x237b=function(_0x237b3e,_0x15de76){_0x237b3e=_0x237b3e-0x143;let _0x18fe96=_0x48d9f5[_0x237b3e];return _0x18fe96;},a37_0x237b(_0x473f99,_0x13d085);}var __importDefault=this&&this[a37_0x8d34cb(0x15f)]||function(_0x30c859){const _0x608769=a37_0x8d34cb;return _0x30c859&&_0x30c859[_0x608769(0x159)]?_0x30c859:{'default':_0x30c859};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports['AuthService']=void 0x0;const bcryptjs_1=__importDefault(require(a37_0x8d34cb(0x163))),jsonwebtoken_1=__importDefault(require('jsonwebtoken')),database_1=__importDefault(require('../config/database')),config_1=require(a37_0x8d34cb(0x149));class AuthService{[a37_0x8d34cb(0x152)](_0x4deb56){const _0x50b786=a37_0x8d34cb;return jsonwebtoken_1[_0x50b786(0x154)][_0x50b786(0x144)](_0x4deb56,config_1[_0x50b786(0x14d)]['jwt'][_0x50b786(0x150)],{'expiresIn':String(config_1['config'][_0x50b786(0x147)]['expiresIn'])});}async[a37_0x8d34cb(0x15d)](_0x2febfd){const _0x495455=a37_0x8d34cb,{username:_0x3380a0,password:_0x2ef990}=_0x2febfd;if(_0x3380a0===config_1[_0x495455(0x14d)][_0x495455(0x164)][_0x495455(0x156)]){const _0x2dd511=await bcryptjs_1[_0x495455(0x154)][_0x495455(0x145)](_0x2ef990,config_1[_0x495455(0x14d)][_0x495455(0x164)]['passwordHash']);if(_0x2dd511){const _0x1fda76=this[_0x495455(0x152)]({'id':_0x495455(0x164),'username':config_1[_0x495455(0x14d)][_0x495455(0x164)][_0x495455(0x156)],'role':_0x495455(0x164)});return{'access_token':_0x1fda76,'role':'admin'};}}const _0x12969a=await database_1[_0x495455(0x154)][_0x495455(0x14e)][_0x495455(0x161)]({'where':{'username':_0x3380a0},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x12969a)throw new Error(_0x495455(0x15a));if(_0x12969a[_0x495455(0x14c)]!==_0x495455(0x148))throw new Error(_0x495455(0x15b));const _0x11e94c=await bcryptjs_1['default']['compare'](_0x2ef990,_0x12969a[_0x495455(0x14f)]);if(!_0x11e94c)throw new Error(_0x495455(0x15a));const _0x35f1c2=this[_0x495455(0x152)]({'id':_0x12969a['id'],'username':_0x12969a[_0x495455(0x156)],'role':_0x495455(0x14e)});return{'access_token':_0x35f1c2,'role':'shop','user':{'id':_0x12969a['id'],'name':_0x12969a[_0x495455(0x146)],'username':_0x12969a[_0x495455(0x156)]}};}async['verifyToken'](_0x3fbe69){const _0xfff7e5=a37_0x8d34cb;try{const _0x1d75c9=jsonwebtoken_1['default'][_0xfff7e5(0x153)](_0x3fbe69,config_1[_0xfff7e5(0x14d)][_0xfff7e5(0x147)][_0xfff7e5(0x150)]);return _0x1d75c9;}catch(_0xd9169){throw new Error(_0xfff7e5(0x14a));}}}exports[a37_0x8d34cb(0x151)]=AuthService;