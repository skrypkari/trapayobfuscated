'use strict';const a36_0x3ce358=a36_0x4e09;(function(_0x3d500a,_0xc13ff9){const _0x4d603b=a36_0x4e09,_0x1d7f1d=_0x3d500a();while(!![]){try{const _0x43788c=-parseInt(_0x4d603b(0x13c))/0x1+parseInt(_0x4d603b(0x11a))/0x2+-parseInt(_0x4d603b(0x136))/0x3*(parseInt(_0x4d603b(0x121))/0x4)+-parseInt(_0x4d603b(0x135))/0x5+-parseInt(_0x4d603b(0x12a))/0x6*(parseInt(_0x4d603b(0x124))/0x7)+-parseInt(_0x4d603b(0x11f))/0x8*(-parseInt(_0x4d603b(0x13a))/0x9)+parseInt(_0x4d603b(0x130))/0xa*(parseInt(_0x4d603b(0x11b))/0xb);if(_0x43788c===_0xc13ff9)break;else _0x1d7f1d['push'](_0x1d7f1d['shift']());}catch(_0x2c8ebd){_0x1d7f1d['push'](_0x1d7f1d['shift']());}}}(a36_0x25a5,0xd399b));function a36_0x4e09(_0x1a9d56,_0x35898d){const _0x25a5d8=a36_0x25a5();return a36_0x4e09=function(_0x4e09c8,_0x3f7858){_0x4e09c8=_0x4e09c8-0x11a;let _0x29dd72=_0x25a5d8[_0x4e09c8];return _0x29dd72;},a36_0x4e09(_0x1a9d56,_0x35898d);}var __importDefault=this&&this['__importDefault']||function(_0x43b854){return _0x43b854&&_0x43b854['__esModule']?_0x43b854:{'default':_0x43b854};};Object[a36_0x3ce358(0x12f)](exports,a36_0x3ce358(0x134),{'value':!![]}),exports[a36_0x3ce358(0x123)]=void 0x0;const bcryptjs_1=__importDefault(require(a36_0x3ce358(0x13d))),jsonwebtoken_1=__importDefault(require(a36_0x3ce358(0x138))),database_1=__importDefault(require(a36_0x3ce358(0x13b))),config_1=require(a36_0x3ce358(0x122));class AuthService{['generateToken'](_0x4746ad){const _0x558267=a36_0x3ce358;return jsonwebtoken_1[_0x558267(0x13f)][_0x558267(0x12c)](_0x4746ad,config_1[_0x558267(0x140)][_0x558267(0x11d)][_0x558267(0x11e)],{'expiresIn':String(config_1[_0x558267(0x140)][_0x558267(0x11d)][_0x558267(0x126)])});}async[a36_0x3ce358(0x13e)](_0xdff1fa){const _0xb9ab4=a36_0x3ce358,{username:_0x57cf71,password:_0x106e43}=_0xdff1fa;if(_0x57cf71===config_1[_0xb9ab4(0x140)][_0xb9ab4(0x128)]['username']){const _0xb24233=await bcryptjs_1[_0xb9ab4(0x13f)][_0xb9ab4(0x12b)](_0x106e43,config_1[_0xb9ab4(0x140)][_0xb9ab4(0x128)][_0xb9ab4(0x131)]);if(_0xb24233){const _0x5e530c=this['generateToken']({'id':_0xb9ab4(0x128),'username':config_1['config']['admin'][_0xb9ab4(0x133)],'role':_0xb9ab4(0x128)});return{'access_token':_0x5e530c,'role':_0xb9ab4(0x128)};}}const _0x2da408=await database_1[_0xb9ab4(0x13f)][_0xb9ab4(0x120)]['findUnique']({'where':{'username':_0x57cf71},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x2da408)throw new Error(_0xb9ab4(0x139));if(_0x2da408[_0xb9ab4(0x132)]!==_0xb9ab4(0x129))throw new Error(_0xb9ab4(0x11c));const _0x31ae66=await bcryptjs_1[_0xb9ab4(0x13f)][_0xb9ab4(0x12b)](_0x106e43,_0x2da408[_0xb9ab4(0x127)]);if(!_0x31ae66)throw new Error(_0xb9ab4(0x139));const _0x5ed5bb=this[_0xb9ab4(0x12d)]({'id':_0x2da408['id'],'username':_0x2da408[_0xb9ab4(0x133)],'role':'shop'});return{'access_token':_0x5ed5bb,'role':_0xb9ab4(0x120),'user':{'id':_0x2da408['id'],'name':_0x2da408[_0xb9ab4(0x137)],'username':_0x2da408[_0xb9ab4(0x133)]}};}async[a36_0x3ce358(0x125)](_0x40961a){const _0x20dec3=a36_0x3ce358;try{const _0x2edaff=jsonwebtoken_1[_0x20dec3(0x13f)]['verify'](_0x40961a,config_1[_0x20dec3(0x140)][_0x20dec3(0x11d)][_0x20dec3(0x11e)]);return _0x2edaff;}catch(_0x1bebf9){throw new Error(_0x20dec3(0x12e));}}}exports[a36_0x3ce358(0x123)]=AuthService;function a36_0x25a5(){const _0x33c86e=['102616nfjLSn','../config/config','AuthService','4193lBySUX','verifyToken','expiresIn','password','admin','ACTIVE','11202GwUuEN','compare','sign','generateToken','Invalid\x20token','defineProperty','4040740qLBuWw','passwordHash','status','username','__esModule','1602895QHmopg','171KFGgXu','name','jsonwebtoken','Invalid\x20credentials','1512xUihAr','../config/database','789032UzUWPR','bcryptjs','login','default','config','849210WelKNb','66IaLarJ','Account\x20is\x20not\x20active','jwt','secret','81328uqDuqB','shop'];a36_0x25a5=function(){return _0x33c86e;};return a36_0x25a5();}