'use strict';function a36_0x1abb(_0x2d1aef,_0x5c20ad){const _0x125aca=a36_0x125a();return a36_0x1abb=function(_0x1abb10,_0x18338a){_0x1abb10=_0x1abb10-0x113;let _0x57c5f9=_0x125aca[_0x1abb10];return _0x57c5f9;},a36_0x1abb(_0x2d1aef,_0x5c20ad);}const a36_0x36ceb8=a36_0x1abb;(function(_0x421d5e,_0x483261){const _0xf401ed=a36_0x1abb,_0x17018d=_0x421d5e();while(!![]){try{const _0x1ed93b=-parseInt(_0xf401ed(0x128))/0x1*(parseInt(_0xf401ed(0x130))/0x2)+-parseInt(_0xf401ed(0x113))/0x3*(-parseInt(_0xf401ed(0x12e))/0x4)+-parseInt(_0xf401ed(0x139))/0x5*(-parseInt(_0xf401ed(0x12a))/0x6)+-parseInt(_0xf401ed(0x133))/0x7+parseInt(_0xf401ed(0x11f))/0x8+parseInt(_0xf401ed(0x118))/0x9+-parseInt(_0xf401ed(0x11b))/0xa*(parseInt(_0xf401ed(0x138))/0xb);if(_0x1ed93b===_0x483261)break;else _0x17018d['push'](_0x17018d['shift']());}catch(_0x4703a5){_0x17018d['push'](_0x17018d['shift']());}}}(a36_0x125a,0xb385e));var __importDefault=this&&this[a36_0x36ceb8(0x114)]||function(_0x5a4b09){return _0x5a4b09&&_0x5a4b09['__esModule']?_0x5a4b09:{'default':_0x5a4b09};};Object[a36_0x36ceb8(0x116)](exports,'__esModule',{'value':!![]}),exports['AuthService']=void 0x0;function a36_0x125a(){const _0x2fc1bb=['shop','defineProperty','compare','9124857eTVsTK','Invalid\x20credentials','status','22132940nxSsKs','username','passwordHash','Invalid\x20token','6160424BjVtqa','name','bcryptjs','verify','../config/database','default','admin','findUnique','jwt','1TNEgDN','config','6HZITvV','AuthService','password','jsonwebtoken','4WVlfNF','expiresIn','381250OrnHQR','../config/config','secret','3675000rEKJvN','login','ACTIVE','generateToken','verifyToken','11LLLDbD','3227215zdCKCK','sign','3704628wLjZCs','__importDefault'];a36_0x125a=function(){return _0x2fc1bb;};return a36_0x125a();}const bcryptjs_1=__importDefault(require(a36_0x36ceb8(0x121))),jsonwebtoken_1=__importDefault(require(a36_0x36ceb8(0x12d))),database_1=__importDefault(require(a36_0x36ceb8(0x123))),config_1=require(a36_0x36ceb8(0x131));class AuthService{[a36_0x36ceb8(0x136)](_0x5cc405){const _0x46eaf9=a36_0x36ceb8;return jsonwebtoken_1[_0x46eaf9(0x124)][_0x46eaf9(0x13a)](_0x5cc405,config_1[_0x46eaf9(0x129)][_0x46eaf9(0x127)][_0x46eaf9(0x132)],{'expiresIn':String(config_1['config']['jwt'][_0x46eaf9(0x12f)])});}async[a36_0x36ceb8(0x134)](_0xabf2be){const _0x2fe2e4=a36_0x36ceb8,{username:_0x607241,password:_0x4bc099}=_0xabf2be;if(_0x607241===config_1[_0x2fe2e4(0x129)][_0x2fe2e4(0x125)][_0x2fe2e4(0x11c)]){const _0x11e404=await bcryptjs_1[_0x2fe2e4(0x124)][_0x2fe2e4(0x117)](_0x4bc099,config_1[_0x2fe2e4(0x129)][_0x2fe2e4(0x125)][_0x2fe2e4(0x11d)]);if(_0x11e404){const _0x39419d=this[_0x2fe2e4(0x136)]({'id':_0x2fe2e4(0x125),'username':config_1[_0x2fe2e4(0x129)][_0x2fe2e4(0x125)][_0x2fe2e4(0x11c)],'role':_0x2fe2e4(0x125)});return{'access_token':_0x39419d,'role':'admin'};}}const _0x4a45b4=await database_1[_0x2fe2e4(0x124)][_0x2fe2e4(0x115)][_0x2fe2e4(0x126)]({'where':{'username':_0x607241},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x4a45b4)throw new Error(_0x2fe2e4(0x119));if(_0x4a45b4[_0x2fe2e4(0x11a)]!==_0x2fe2e4(0x135))throw new Error('Account\x20is\x20not\x20active');const _0x5afa44=await bcryptjs_1[_0x2fe2e4(0x124)][_0x2fe2e4(0x117)](_0x4bc099,_0x4a45b4[_0x2fe2e4(0x12c)]);if(!_0x5afa44)throw new Error(_0x2fe2e4(0x119));const _0x8f7985=this[_0x2fe2e4(0x136)]({'id':_0x4a45b4['id'],'username':_0x4a45b4[_0x2fe2e4(0x11c)],'role':'shop'});return{'access_token':_0x8f7985,'role':'shop','user':{'id':_0x4a45b4['id'],'name':_0x4a45b4[_0x2fe2e4(0x120)],'username':_0x4a45b4[_0x2fe2e4(0x11c)]}};}async[a36_0x36ceb8(0x137)](_0xdb07be){const _0x1ff033=a36_0x36ceb8;try{const _0x49270d=jsonwebtoken_1['default'][_0x1ff033(0x122)](_0xdb07be,config_1[_0x1ff033(0x129)][_0x1ff033(0x127)][_0x1ff033(0x132)]);return _0x49270d;}catch(_0x5905e0){throw new Error(_0x1ff033(0x11e));}}}exports[a36_0x36ceb8(0x12b)]=AuthService;