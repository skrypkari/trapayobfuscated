'use strict';const a37_0x649206=a37_0x17f9;function a37_0x17f9(_0x4747e3,_0x11c7f9){const _0x10cf92=a37_0x10cf();return a37_0x17f9=function(_0x17f952,_0x50c588){_0x17f952=_0x17f952-0x101;let _0x550069=_0x10cf92[_0x17f952];return _0x550069;},a37_0x17f9(_0x4747e3,_0x11c7f9);}(function(_0xaf1fb3,_0x458780){const _0x2b421b=a37_0x17f9,_0x412b13=_0xaf1fb3();while(!![]){try{const _0x41d13b=parseInt(_0x2b421b(0x121))/0x1*(parseInt(_0x2b421b(0x11c))/0x2)+-parseInt(_0x2b421b(0x105))/0x3*(-parseInt(_0x2b421b(0x103))/0x4)+-parseInt(_0x2b421b(0x120))/0x5+-parseInt(_0x2b421b(0x10d))/0x6*(parseInt(_0x2b421b(0x107))/0x7)+-parseInt(_0x2b421b(0x10e))/0x8*(parseInt(_0x2b421b(0x123))/0x9)+-parseInt(_0x2b421b(0x10b))/0xa*(-parseInt(_0x2b421b(0x114))/0xb)+parseInt(_0x2b421b(0x109))/0xc;if(_0x41d13b===_0x458780)break;else _0x412b13['push'](_0x412b13['shift']());}catch(_0x27d0a3){_0x412b13['push'](_0x412b13['shift']());}}}(a37_0x10cf,0x3d0ca));var __importDefault=this&&this[a37_0x649206(0x10c)]||function(_0x585f96){const _0x51c2e0=a37_0x649206;return _0x585f96&&_0x585f96[_0x51c2e0(0x11b)]?_0x585f96:{'default':_0x585f96};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports['AuthService']=void 0x0;const bcryptjs_1=__importDefault(require(a37_0x649206(0x11a))),jsonwebtoken_1=__importDefault(require(a37_0x649206(0x124))),database_1=__importDefault(require('../config/database')),config_1=require(a37_0x649206(0x11f));class AuthService{['generateToken'](_0x5baa90){const _0x52cf3c=a37_0x649206;return jsonwebtoken_1['default'][_0x52cf3c(0x11e)](_0x5baa90,config_1[_0x52cf3c(0x117)][_0x52cf3c(0x116)][_0x52cf3c(0x102)],{'expiresIn':String(config_1[_0x52cf3c(0x117)][_0x52cf3c(0x116)]['expiresIn'])});}async[a37_0x649206(0x11d)](_0x2653bf){const _0xdd7e6b=a37_0x649206,{username:_0x3757df,password:_0xad765e}=_0x2653bf;if(_0x3757df===config_1[_0xdd7e6b(0x117)]['admin'][_0xdd7e6b(0x125)]){const _0xb46b96=await bcryptjs_1['default'][_0xdd7e6b(0x10a)](_0xad765e,config_1[_0xdd7e6b(0x117)][_0xdd7e6b(0x126)][_0xdd7e6b(0x112)]);if(_0xb46b96){const _0x1b8e1f=this[_0xdd7e6b(0x118)]({'id':_0xdd7e6b(0x126),'username':config_1['config'][_0xdd7e6b(0x126)][_0xdd7e6b(0x125)],'role':'admin'});return{'access_token':_0x1b8e1f,'role':_0xdd7e6b(0x126)};}}const _0x590a33=await database_1[_0xdd7e6b(0x110)][_0xdd7e6b(0x108)][_0xdd7e6b(0x111)]({'where':{'username':_0x3757df},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x590a33)throw new Error(_0xdd7e6b(0x104));if(_0x590a33[_0xdd7e6b(0x119)]!==_0xdd7e6b(0x113))throw new Error(_0xdd7e6b(0x106));const _0x24785d=await bcryptjs_1[_0xdd7e6b(0x110)][_0xdd7e6b(0x10a)](_0xad765e,_0x590a33[_0xdd7e6b(0x115)]);if(!_0x24785d)throw new Error('Invalid\x20credentials');const _0xc097c=this[_0xdd7e6b(0x118)]({'id':_0x590a33['id'],'username':_0x590a33['username'],'role':_0xdd7e6b(0x108)});return{'access_token':_0xc097c,'role':'shop','user':{'id':_0x590a33['id'],'name':_0x590a33['name'],'username':_0x590a33[_0xdd7e6b(0x125)]}};}async['verifyToken'](_0x5ab20f){const _0x2ae5a4=a37_0x649206;try{const _0x1369c4=jsonwebtoken_1[_0x2ae5a4(0x110)][_0x2ae5a4(0x101)](_0x5ab20f,config_1[_0x2ae5a4(0x117)]['jwt'][_0x2ae5a4(0x102)]);return _0x1369c4;}catch(_0x444aad){throw new Error(_0x2ae5a4(0x122));}}}exports[a37_0x649206(0x10f)]=AuthService;function a37_0x10cf(){const _0x2443e6=['username','admin','verify','secret','1034828qOFuLg','Invalid\x20credentials','3YUCgci','Account\x20is\x20not\x20active','7910NuwDhM','shop','1165800sYuSPX','compare','40SbsQeq','__importDefault','168WZeekZ','3912izkshU','AuthService','default','findUnique','passwordHash','ACTIVE','1017885LwdTcH','password','jwt','config','generateToken','status','bcryptjs','__esModule','45068qUloRJ','login','sign','../config/config','2311470TEGlWK','22XVzpVS','Invalid\x20token','8793bBGGTr','jsonwebtoken'];a37_0x10cf=function(){return _0x2443e6;};return a37_0x10cf();}