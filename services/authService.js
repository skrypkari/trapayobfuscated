'use strict';function a36_0x5dc1(_0x4d012f,_0x11a8b9){const _0x5c6e4b=a36_0x5c6e();return a36_0x5dc1=function(_0x5dc1ac,_0x27fd53){_0x5dc1ac=_0x5dc1ac-0x1f3;let _0xa81788=_0x5c6e4b[_0x5dc1ac];return _0xa81788;},a36_0x5dc1(_0x4d012f,_0x11a8b9);}const a36_0x41d7b1=a36_0x5dc1;(function(_0x1a6e4e,_0x72fee5){const _0x2700ac=a36_0x5dc1,_0x41d564=_0x1a6e4e();while(!![]){try{const _0x52c87e=-parseInt(_0x2700ac(0x1f4))/0x1+parseInt(_0x2700ac(0x1fb))/0x2*(parseInt(_0x2700ac(0x206))/0x3)+-parseInt(_0x2700ac(0x1f3))/0x4*(parseInt(_0x2700ac(0x1f8))/0x5)+parseInt(_0x2700ac(0x214))/0x6+-parseInt(_0x2700ac(0x1fe))/0x7+-parseInt(_0x2700ac(0x20e))/0x8+parseInt(_0x2700ac(0x1f7))/0x9;if(_0x52c87e===_0x72fee5)break;else _0x41d564['push'](_0x41d564['shift']());}catch(_0x5c1526){_0x41d564['push'](_0x41d564['shift']());}}}(a36_0x5c6e,0x682a1));function a36_0x5c6e(){const _0x26e012=['__importDefault','14syfTbi','ACTIVE','admin','1619695qpyJfZ','expiresIn','AuthService','findUnique','bcryptjs','__esModule','secret','jsonwebtoken','199059YTmopb','shop','compare','login','Account\x20is\x20not\x20active','sign','config','default','1162552SvLxIf','passwordHash','Invalid\x20credentials','username','jwt','generateToken','869562NgdUzb','status','defineProperty','1479172WTScYO','493423pjZrQW','verify','../config/config','9514611GohOVa','5ocHmFe','verifyToken'];a36_0x5c6e=function(){return _0x26e012;};return a36_0x5c6e();}var __importDefault=this&&this[a36_0x41d7b1(0x1fa)]||function(_0x348a75){const _0x580b95=a36_0x41d7b1;return _0x348a75&&_0x348a75[_0x580b95(0x203)]?_0x348a75:{'default':_0x348a75};};Object[a36_0x41d7b1(0x216)](exports,a36_0x41d7b1(0x203),{'value':!![]}),exports[a36_0x41d7b1(0x200)]=void 0x0;const bcryptjs_1=__importDefault(require(a36_0x41d7b1(0x202))),jsonwebtoken_1=__importDefault(require(a36_0x41d7b1(0x205))),database_1=__importDefault(require('../config/database')),config_1=require(a36_0x41d7b1(0x1f6));class AuthService{[a36_0x41d7b1(0x213)](_0x4fdca3){const _0x1aadb2=a36_0x41d7b1;return jsonwebtoken_1[_0x1aadb2(0x20d)][_0x1aadb2(0x20b)](_0x4fdca3,config_1[_0x1aadb2(0x20c)][_0x1aadb2(0x212)][_0x1aadb2(0x204)],{'expiresIn':String(config_1['config'][_0x1aadb2(0x212)][_0x1aadb2(0x1ff)])});}async[a36_0x41d7b1(0x209)](_0x3c498f){const _0x2f5be4=a36_0x41d7b1,{username:_0x538b39,password:_0x1e2849}=_0x3c498f;if(_0x538b39===config_1[_0x2f5be4(0x20c)][_0x2f5be4(0x1fd)][_0x2f5be4(0x211)]){const _0x4e0883=await bcryptjs_1['default'][_0x2f5be4(0x208)](_0x1e2849,config_1[_0x2f5be4(0x20c)][_0x2f5be4(0x1fd)][_0x2f5be4(0x20f)]);if(_0x4e0883){const _0x23feaf=this[_0x2f5be4(0x213)]({'id':_0x2f5be4(0x1fd),'username':config_1[_0x2f5be4(0x20c)][_0x2f5be4(0x1fd)][_0x2f5be4(0x211)],'role':_0x2f5be4(0x1fd)});return{'access_token':_0x23feaf,'role':_0x2f5be4(0x1fd)};}}const _0x4ef8e4=await database_1[_0x2f5be4(0x20d)][_0x2f5be4(0x207)][_0x2f5be4(0x201)]({'where':{'username':_0x538b39},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x4ef8e4)throw new Error(_0x2f5be4(0x210));if(_0x4ef8e4[_0x2f5be4(0x215)]!==_0x2f5be4(0x1fc))throw new Error(_0x2f5be4(0x20a));const _0x144d9e=await bcryptjs_1[_0x2f5be4(0x20d)][_0x2f5be4(0x208)](_0x1e2849,_0x4ef8e4['password']);if(!_0x144d9e)throw new Error(_0x2f5be4(0x210));const _0x1abc69=this[_0x2f5be4(0x213)]({'id':_0x4ef8e4['id'],'username':_0x4ef8e4[_0x2f5be4(0x211)],'role':'shop'});return{'access_token':_0x1abc69,'role':_0x2f5be4(0x207),'user':{'id':_0x4ef8e4['id'],'name':_0x4ef8e4['name'],'username':_0x4ef8e4[_0x2f5be4(0x211)]}};}async[a36_0x41d7b1(0x1f9)](_0x220af4){const _0x89077d=a36_0x41d7b1;try{const _0x14c8be=jsonwebtoken_1[_0x89077d(0x20d)][_0x89077d(0x1f5)](_0x220af4,config_1['config'][_0x89077d(0x212)][_0x89077d(0x204)]);return _0x14c8be;}catch(_0x398322){throw new Error('Invalid\x20token');}}}exports[a36_0x41d7b1(0x200)]=AuthService;