'use strict';const a34_0x191944=a34_0x557e;function a34_0x23c3(){const _0x328200=['ACTIVE','compare','499051PfaheC','bcryptjs','556387pwHCWk','status','secret','sign','shop','admin','password','12570GUGLqc','1043114CgtTrw','passwordHash','verify','jwt','Invalid\x20credentials','login','default','verifyToken','config','findUnique','expiresIn','156ofzesi','Invalid\x20token','Account\x20is\x20not\x20active','10NLmUYN','username','2666164PuQRAb','41967UGwbdT','generateToken','4DwTTHN','jsonwebtoken','2215041ALvSHq','114DPaLrY','14751DrtjOO','__esModule','2648mZNmwV'];a34_0x23c3=function(){return _0x328200;};return a34_0x23c3();}(function(_0x58186c,_0xf7a2af){const _0x338a76=a34_0x557e,_0x505764=_0x58186c();while(!![]){try{const _0x35800e=-parseInt(_0x338a76(0x1a3))/0x1+-parseInt(_0x338a76(0x190))/0x2*(-parseInt(_0x338a76(0x192))/0x3)+parseInt(_0x338a76(0x18d))/0x4*(-parseInt(_0x338a76(0x18b))/0x5)+parseInt(_0x338a76(0x193))/0x6*(parseInt(_0x338a76(0x199))/0x7)+parseInt(_0x338a76(0x196))/0x8*(parseInt(_0x338a76(0x18e))/0x9)+parseInt(_0x338a76(0x1a2))/0xa*(-parseInt(_0x338a76(0x194))/0xb)+-parseInt(_0x338a76(0x1ae))/0xc*(-parseInt(_0x338a76(0x19b))/0xd);if(_0x35800e===_0xf7a2af)break;else _0x505764['push'](_0x505764['shift']());}catch(_0x635f71){_0x505764['push'](_0x505764['shift']());}}}(a34_0x23c3,0xd4394));var __importDefault=this&&this['__importDefault']||function(_0x43c02a){const _0x5620d3=a34_0x557e;return _0x43c02a&&_0x43c02a[_0x5620d3(0x195)]?_0x43c02a:{'default':_0x43c02a};};function a34_0x557e(_0x88de80,_0x30de3e){const _0x23c3ac=a34_0x23c3();return a34_0x557e=function(_0x557e84,_0x8a0714){_0x557e84=_0x557e84-0x189;let _0x4545b9=_0x23c3ac[_0x557e84];return _0x4545b9;},a34_0x557e(_0x88de80,_0x30de3e);}Object['defineProperty'](exports,a34_0x191944(0x195),{'value':!![]}),exports['AuthService']=void 0x0;const bcryptjs_1=__importDefault(require(a34_0x191944(0x19a))),jsonwebtoken_1=__importDefault(require(a34_0x191944(0x191))),database_1=__importDefault(require('../config/database')),config_1=require('../config/config');class AuthService{[a34_0x191944(0x18f)](_0x57deeb){const _0x27e7b1=a34_0x191944;return jsonwebtoken_1['default'][_0x27e7b1(0x19e)](_0x57deeb,config_1[_0x27e7b1(0x1ab)][_0x27e7b1(0x1a6)][_0x27e7b1(0x19d)],{'expiresIn':String(config_1[_0x27e7b1(0x1ab)]['jwt'][_0x27e7b1(0x1ad)])});}async[a34_0x191944(0x1a8)](_0x429b2c){const _0x39a9fc=a34_0x191944,{username:_0x4a4624,password:_0x512768}=_0x429b2c;if(_0x4a4624===config_1[_0x39a9fc(0x1ab)]['admin'][_0x39a9fc(0x18c)]){const _0x4cedeb=await bcryptjs_1['default'][_0x39a9fc(0x198)](_0x512768,config_1['config'][_0x39a9fc(0x1a0)][_0x39a9fc(0x1a4)]);if(_0x4cedeb){const _0x5cf43f=this[_0x39a9fc(0x18f)]({'id':_0x39a9fc(0x1a0),'username':config_1[_0x39a9fc(0x1ab)][_0x39a9fc(0x1a0)][_0x39a9fc(0x18c)],'role':_0x39a9fc(0x1a0)});return{'access_token':_0x5cf43f,'role':_0x39a9fc(0x1a0)};}}const _0x550a07=await database_1[_0x39a9fc(0x1a9)][_0x39a9fc(0x19f)][_0x39a9fc(0x1ac)]({'where':{'username':_0x4a4624},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x550a07)throw new Error(_0x39a9fc(0x1a7));if(_0x550a07[_0x39a9fc(0x19c)]!==_0x39a9fc(0x197))throw new Error(_0x39a9fc(0x18a));const _0x129d41=await bcryptjs_1[_0x39a9fc(0x1a9)][_0x39a9fc(0x198)](_0x512768,_0x550a07[_0x39a9fc(0x1a1)]);if(!_0x129d41)throw new Error('Invalid\x20credentials');const _0x47bb13=this[_0x39a9fc(0x18f)]({'id':_0x550a07['id'],'username':_0x550a07[_0x39a9fc(0x18c)],'role':_0x39a9fc(0x19f)});return{'access_token':_0x47bb13,'role':_0x39a9fc(0x19f),'user':{'id':_0x550a07['id'],'name':_0x550a07['name'],'username':_0x550a07[_0x39a9fc(0x18c)]}};}async[a34_0x191944(0x1aa)](_0xfee0f4){const _0x50c27d=a34_0x191944;try{const _0x3902fd=jsonwebtoken_1['default'][_0x50c27d(0x1a5)](_0xfee0f4,config_1[_0x50c27d(0x1ab)][_0x50c27d(0x1a6)][_0x50c27d(0x19d)]);return _0x3902fd;}catch(_0x2731b6){throw new Error(_0x50c27d(0x189));}}}exports['AuthService']=AuthService;