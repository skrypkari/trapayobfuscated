'use strict';const a37_0x513faa=a37_0x3636;(function(_0x435c3a,_0x5553f6){const _0x1975b8=a37_0x3636,_0x3b54c0=_0x435c3a();while(!![]){try{const _0x3239b1=-parseInt(_0x1975b8(0x1a6))/0x1*(-parseInt(_0x1975b8(0x1a0))/0x2)+parseInt(_0x1975b8(0x1aa))/0x3*(parseInt(_0x1975b8(0x1a2))/0x4)+-parseInt(_0x1975b8(0x1ae))/0x5+-parseInt(_0x1975b8(0x19f))/0x6*(-parseInt(_0x1975b8(0x18e))/0x7)+-parseInt(_0x1975b8(0x195))/0x8*(parseInt(_0x1975b8(0x192))/0x9)+parseInt(_0x1975b8(0x196))/0xa+-parseInt(_0x1975b8(0x1b2))/0xb;if(_0x3239b1===_0x5553f6)break;else _0x3b54c0['push'](_0x3b54c0['shift']());}catch(_0x44b468){_0x3b54c0['push'](_0x3b54c0['shift']());}}}(a37_0x1006,0xcf7db));var __importDefault=this&&this[a37_0x513faa(0x1ad)]||function(_0x33730e){return _0x33730e&&_0x33730e['__esModule']?_0x33730e:{'default':_0x33730e};};Object[a37_0x513faa(0x1b0)](exports,a37_0x513faa(0x1a7),{'value':!![]}),exports[a37_0x513faa(0x1a1)]=void 0x0;const bcryptjs_1=__importDefault(require(a37_0x513faa(0x191))),jsonwebtoken_1=__importDefault(require(a37_0x513faa(0x19e))),database_1=__importDefault(require('../config/database')),config_1=require(a37_0x513faa(0x1b1));function a37_0x3636(_0x1f2bab,_0x428e79){const _0x1006a0=a37_0x1006();return a37_0x3636=function(_0x3636d6,_0x12d5d9){_0x3636d6=_0x3636d6-0x18e;let _0x4b3a25=_0x1006a0[_0x3636d6];return _0x4b3a25;},a37_0x3636(_0x1f2bab,_0x428e79);}class AuthService{[a37_0x513faa(0x18f)](_0x4d5f7f){const _0x451cd6=a37_0x513faa;return jsonwebtoken_1['default']['sign'](_0x4d5f7f,config_1['config'][_0x451cd6(0x1ab)][_0x451cd6(0x198)],{'expiresIn':String(config_1[_0x451cd6(0x1a3)][_0x451cd6(0x1ab)][_0x451cd6(0x1ac)])});}async['login'](_0xa49ecb){const _0x13c39d=a37_0x513faa,{username:_0x5290ec,password:_0x5c5eee}=_0xa49ecb;if(_0x5290ec===config_1[_0x13c39d(0x1a3)][_0x13c39d(0x1af)][_0x13c39d(0x19b)]){const _0x415a26=await bcryptjs_1['default'][_0x13c39d(0x1a9)](_0x5c5eee,config_1[_0x13c39d(0x1a3)][_0x13c39d(0x1af)][_0x13c39d(0x1a4)]);if(_0x415a26){const _0x3590e3=this[_0x13c39d(0x18f)]({'id':_0x13c39d(0x1af),'username':config_1[_0x13c39d(0x1a3)][_0x13c39d(0x1af)][_0x13c39d(0x19b)],'role':_0x13c39d(0x1af)});return{'access_token':_0x3590e3,'role':_0x13c39d(0x1af)};}}const _0x4d6166=await database_1[_0x13c39d(0x19c)][_0x13c39d(0x197)][_0x13c39d(0x1a8)]({'where':{'username':_0x5290ec},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x4d6166)throw new Error('Invalid\x20credentials');if(_0x4d6166[_0x13c39d(0x19d)]!==_0x13c39d(0x1b3))throw new Error(_0x13c39d(0x199));const _0x11becf=await bcryptjs_1[_0x13c39d(0x19c)][_0x13c39d(0x1a9)](_0x5c5eee,_0x4d6166[_0x13c39d(0x19a)]);if(!_0x11becf)throw new Error(_0x13c39d(0x193));const _0x5b9c3e=this[_0x13c39d(0x18f)]({'id':_0x4d6166['id'],'username':_0x4d6166[_0x13c39d(0x19b)],'role':'shop'});return{'access_token':_0x5b9c3e,'role':'shop','user':{'id':_0x4d6166['id'],'name':_0x4d6166[_0x13c39d(0x194)],'username':_0x4d6166[_0x13c39d(0x19b)]}};}async['verifyToken'](_0x22610d){const _0x2dda53=a37_0x513faa;try{const _0x33957e=jsonwebtoken_1[_0x2dda53(0x19c)][_0x2dda53(0x1a5)](_0x22610d,config_1['config'][_0x2dda53(0x1ab)][_0x2dda53(0x198)]);return _0x33957e;}catch(_0x223943){throw new Error(_0x2dda53(0x190));}}}exports['AuthService']=AuthService;function a37_0x1006(){const _0x2199fa=['ACTIVE','7yiBODJ','generateToken','Invalid\x20token','bcryptjs','270nJHOXT','Invalid\x20credentials','name','139208mrcKAn','869890hhWkpE','shop','secret','Account\x20is\x20not\x20active','password','username','default','status','jsonwebtoken','8335926kxvtlv','3628pYNRCk','AuthService','28748SZJjwo','config','passwordHash','verify','428ahUovA','__esModule','findUnique','compare','333gFJzcE','jwt','expiresIn','__importDefault','6253615XYqZPk','admin','defineProperty','../config/config','4706053grCRTV'];a37_0x1006=function(){return _0x2199fa;};return a37_0x1006();}