'use strict';const a36_0x5b3422=a36_0x1370;(function(_0x5d9cde,_0x4c1273){const _0x4bd6aa=a36_0x1370,_0x3bd930=_0x5d9cde();while(!![]){try{const _0x1836a8=parseInt(_0x4bd6aa(0xd8))/0x1*(-parseInt(_0x4bd6aa(0xbe))/0x2)+-parseInt(_0x4bd6aa(0xde))/0x3+-parseInt(_0x4bd6aa(0xc0))/0x4*(parseInt(_0x4bd6aa(0xd0))/0x5)+-parseInt(_0x4bd6aa(0xc8))/0x6*(-parseInt(_0x4bd6aa(0xbf))/0x7)+parseInt(_0x4bd6aa(0xd2))/0x8+parseInt(_0x4bd6aa(0xcd))/0x9*(parseInt(_0x4bd6aa(0xcb))/0xa)+parseInt(_0x4bd6aa(0xc5))/0xb;if(_0x1836a8===_0x4c1273)break;else _0x3bd930['push'](_0x3bd930['shift']());}catch(_0x28efeb){_0x3bd930['push'](_0x3bd930['shift']());}}}(a36_0x1dfb,0xe9b9d));var __importDefault=this&&this[a36_0x5b3422(0xda)]||function(_0x412fb0){const _0xe35e42=a36_0x5b3422;return _0x412fb0&&_0x412fb0[_0xe35e42(0xcf)]?_0x412fb0:{'default':_0x412fb0};};Object[a36_0x5b3422(0xd3)](exports,a36_0x5b3422(0xcf),{'value':!![]}),exports[a36_0x5b3422(0xd9)]=void 0x0;function a36_0x1370(_0x4458c1,_0x3fd867){const _0x1dfb70=a36_0x1dfb();return a36_0x1370=function(_0x137050,_0xeb80bf){_0x137050=_0x137050-0xbd;let _0x4d450f=_0x1dfb70[_0x137050];return _0x4d450f;},a36_0x1370(_0x4458c1,_0x3fd867);}function a36_0x1dfb(){const _0x313dd5=['1580274NVkzJE','sign','Invalid\x20credentials','84560kNOvka','passwordHash','531AYIsoz','ACTIVE','__esModule','6876665WPPWKK','username','8016592zWpLqn','defineProperty','secret','name','generateToken','login','14810mOaBhk','AuthService','__importDefault','default','jwt','Account\x20is\x20not\x20active','2947914uUpPnF','expiresIn','Invalid\x20token','shop','bcryptjs','214WJoLYM','42irFWhs','4ipfGwX','../config/database','admin','compare','config','20006030jMOOUw','password','verifyToken'];a36_0x1dfb=function(){return _0x313dd5;};return a36_0x1dfb();}const bcryptjs_1=__importDefault(require(a36_0x5b3422(0xbd))),jsonwebtoken_1=__importDefault(require('jsonwebtoken')),database_1=__importDefault(require(a36_0x5b3422(0xc1))),config_1=require('../config/config');class AuthService{[a36_0x5b3422(0xd6)](_0x38e7f1){const _0x1d6819=a36_0x5b3422;return jsonwebtoken_1[_0x1d6819(0xdb)][_0x1d6819(0xc9)](_0x38e7f1,config_1[_0x1d6819(0xc4)]['jwt'][_0x1d6819(0xd4)],{'expiresIn':String(config_1['config'][_0x1d6819(0xdc)][_0x1d6819(0xdf)])});}async[a36_0x5b3422(0xd7)](_0x291ae2){const _0x477767=a36_0x5b3422,{username:_0x432c6d,password:_0x3a7755}=_0x291ae2;if(_0x432c6d===config_1['config'][_0x477767(0xc2)]['username']){const _0x3ce4fa=await bcryptjs_1[_0x477767(0xdb)][_0x477767(0xc3)](_0x3a7755,config_1['config'][_0x477767(0xc2)][_0x477767(0xcc)]);if(_0x3ce4fa){const _0x249f31=this[_0x477767(0xd6)]({'id':_0x477767(0xc2),'username':config_1[_0x477767(0xc4)][_0x477767(0xc2)][_0x477767(0xd1)],'role':_0x477767(0xc2)});return{'access_token':_0x249f31,'role':_0x477767(0xc2)};}}const _0x42aee0=await database_1['default'][_0x477767(0xe1)]['findUnique']({'where':{'username':_0x432c6d},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x42aee0)throw new Error(_0x477767(0xca));if(_0x42aee0['status']!==_0x477767(0xce))throw new Error(_0x477767(0xdd));const _0x2fd9f4=await bcryptjs_1[_0x477767(0xdb)]['compare'](_0x3a7755,_0x42aee0[_0x477767(0xc6)]);if(!_0x2fd9f4)throw new Error(_0x477767(0xca));const _0x2c8f76=this[_0x477767(0xd6)]({'id':_0x42aee0['id'],'username':_0x42aee0[_0x477767(0xd1)],'role':_0x477767(0xe1)});return{'access_token':_0x2c8f76,'role':'shop','user':{'id':_0x42aee0['id'],'name':_0x42aee0[_0x477767(0xd5)],'username':_0x42aee0[_0x477767(0xd1)]}};}async[a36_0x5b3422(0xc7)](_0x5d4419){const _0x8f8610=a36_0x5b3422;try{const _0x55eb6e=jsonwebtoken_1['default']['verify'](_0x5d4419,config_1[_0x8f8610(0xc4)][_0x8f8610(0xdc)]['secret']);return _0x55eb6e;}catch(_0x188651){throw new Error(_0x8f8610(0xe0));}}}exports[a36_0x5b3422(0xd9)]=AuthService;