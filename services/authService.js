'use strict';const a47_0x491ae7=a47_0x5524;(function(_0x5cc070,_0x163423){const _0x30b63d=a47_0x5524,_0x55040f=_0x5cc070();while(!![]){try{const _0x380c9a=-parseInt(_0x30b63d(0xfb))/0x1*(parseInt(_0x30b63d(0xe7))/0x2)+parseInt(_0x30b63d(0xff))/0x3*(-parseInt(_0x30b63d(0xf3))/0x4)+parseInt(_0x30b63d(0xfc))/0x5*(parseInt(_0x30b63d(0xe4))/0x6)+-parseInt(_0x30b63d(0xfe))/0x7*(-parseInt(_0x30b63d(0xee))/0x8)+-parseInt(_0x30b63d(0xf9))/0x9*(parseInt(_0x30b63d(0xf0))/0xa)+-parseInt(_0x30b63d(0xea))/0xb+parseInt(_0x30b63d(0xe6))/0xc;if(_0x380c9a===_0x163423)break;else _0x55040f['push'](_0x55040f['shift']());}catch(_0x3ec6ad){_0x55040f['push'](_0x55040f['shift']());}}}(a47_0x4251,0x85ec6));var __importDefault=this&&this[a47_0x491ae7(0x100)]||function(_0x38d380){const _0x268605=a47_0x491ae7;return _0x38d380&&_0x38d380[_0x268605(0xe3)]?_0x38d380:{'default':_0x38d380};};Object['defineProperty'](exports,a47_0x491ae7(0xe3),{'value':!![]}),exports[a47_0x491ae7(0x101)]=void 0x0;function a47_0x4251(){const _0x5e8162=['41PHifng','65THlkHh','Account\x20is\x20not\x20active','6669285ZARLoF','1053QDXmnO','__importDefault','AuthService','Invalid\x20token','sign','admin','verify','default','__esModule','352338DVlSvK','Invalid\x20credentials','20918448KqOnaQ','13964sbmvjB','../config/database','login','11278223yfzFlc','compare','secret','username','8YEtIDD','status','46340JzZtfM','shop','bcryptjs','7188oVczxF','config','expiresIn','../config/config','ACTIVE','jwt','1881VsGkyj','generateToken'];a47_0x4251=function(){return _0x5e8162;};return a47_0x4251();}const bcryptjs_1=__importDefault(require(a47_0x491ae7(0xf2))),jsonwebtoken_1=__importDefault(require('jsonwebtoken')),database_1=__importDefault(require(a47_0x491ae7(0xe8))),config_1=require(a47_0x491ae7(0xf6));function a47_0x5524(_0x15e7d4,_0x269f70){_0x15e7d4=_0x15e7d4-0xe3;const _0x4251ec=a47_0x4251();let _0x55246f=_0x4251ec[_0x15e7d4];return _0x55246f;}class AuthService{[a47_0x491ae7(0xfa)](_0x262c01){const _0x33ab0a=a47_0x491ae7;return jsonwebtoken_1[_0x33ab0a(0x106)][_0x33ab0a(0x103)](_0x262c01,config_1['config']['jwt'][_0x33ab0a(0xec)],{'expiresIn':String(config_1[_0x33ab0a(0xf4)]['jwt'][_0x33ab0a(0xf5)])});}async[a47_0x491ae7(0xe9)](_0x2bb7cf){const _0x15a06c=a47_0x491ae7,{username:_0x44714,password:_0x447877}=_0x2bb7cf;if(_0x44714===config_1['config'][_0x15a06c(0x104)][_0x15a06c(0xed)]){const _0x52e70a=await bcryptjs_1[_0x15a06c(0x106)][_0x15a06c(0xeb)](_0x447877,config_1[_0x15a06c(0xf4)]['admin']['passwordHash']);if(_0x52e70a){const _0x3ead91=this[_0x15a06c(0xfa)]({'id':_0x15a06c(0x104),'username':config_1[_0x15a06c(0xf4)]['admin'][_0x15a06c(0xed)],'role':_0x15a06c(0x104)});return{'access_token':_0x3ead91,'role':_0x15a06c(0x104)};}}const _0x5b4df8=await database_1[_0x15a06c(0x106)][_0x15a06c(0xf1)]['findUnique']({'where':{'username':_0x44714},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x5b4df8)throw new Error(_0x15a06c(0xe5));if(_0x5b4df8[_0x15a06c(0xef)]!==_0x15a06c(0xf7))throw new Error(_0x15a06c(0xfd));const _0x1b6ea1=await bcryptjs_1[_0x15a06c(0x106)][_0x15a06c(0xeb)](_0x447877,_0x5b4df8['password']);if(!_0x1b6ea1)throw new Error(_0x15a06c(0xe5));const _0x23c46a=this[_0x15a06c(0xfa)]({'id':_0x5b4df8['id'],'username':_0x5b4df8['username'],'role':_0x15a06c(0xf1)});return{'access_token':_0x23c46a,'role':_0x15a06c(0xf1),'user':{'id':_0x5b4df8['id'],'name':_0x5b4df8['name'],'username':_0x5b4df8[_0x15a06c(0xed)]}};}async['verifyToken'](_0x22ff6e){const _0x1a9fc8=a47_0x491ae7;try{const _0x1aacd2=jsonwebtoken_1['default'][_0x1a9fc8(0x105)](_0x22ff6e,config_1[_0x1a9fc8(0xf4)][_0x1a9fc8(0xf8)][_0x1a9fc8(0xec)]);return _0x1aacd2;}catch(_0x57ab56){throw new Error(_0x1a9fc8(0x102));}}}exports[a47_0x491ae7(0x101)]=AuthService;