'use strict';const a47_0x38c9e9=a47_0x3dd0;(function(_0x3051c3,_0xe21be4){const _0x4c4b2b=a47_0x3dd0,_0x4ed89a=_0x3051c3();while(!![]){try{const _0x131efd=parseInt(_0x4c4b2b(0x168))/0x1+parseInt(_0x4c4b2b(0x169))/0x2*(-parseInt(_0x4c4b2b(0x162))/0x3)+-parseInt(_0x4c4b2b(0x14c))/0x4+-parseInt(_0x4c4b2b(0x147))/0x5*(parseInt(_0x4c4b2b(0x163))/0x6)+-parseInt(_0x4c4b2b(0x161))/0x7*(parseInt(_0x4c4b2b(0x15b))/0x8)+-parseInt(_0x4c4b2b(0x15d))/0x9*(-parseInt(_0x4c4b2b(0x148))/0xa)+-parseInt(_0x4c4b2b(0x155))/0xb*(-parseInt(_0x4c4b2b(0x165))/0xc);if(_0x131efd===_0xe21be4)break;else _0x4ed89a['push'](_0x4ed89a['shift']());}catch(_0x1ff5c2){_0x4ed89a['push'](_0x4ed89a['shift']());}}}(a47_0x2e2d,0xe457e));function a47_0x2e2d(){const _0x34d4d3=['password','login','username','jwt','../config/config','jsonwebtoken','77vxFROM','Invalid\x20credentials','name','defineProperty','default','verifyToken','5490824SNgglY','generateToken','612nbYMeV','admin','AuthService','sign','7PePDDf','1715397rQAJbc','6SrUdHR','ACTIVE','5479128icbHna','compare','findUnique','887460DDbTFX','2TAOedP','expiresIn','bcryptjs','shop','1506590BvaVyo','13190RtPwer','passwordHash','config','secret','6714184TZMmXS','../config/database','__esModule'];a47_0x2e2d=function(){return _0x34d4d3;};return a47_0x2e2d();}function a47_0x3dd0(_0x3aaddb,_0x36477d){_0x3aaddb=_0x3aaddb-0x144;const _0x2e2dc1=a47_0x2e2d();let _0x3dd041=_0x2e2dc1[_0x3aaddb];return _0x3dd041;}var __importDefault=this&&this['__importDefault']||function(_0x3e2d9d){const _0x5c97bc=a47_0x3dd0;return _0x3e2d9d&&_0x3e2d9d[_0x5c97bc(0x14e)]?_0x3e2d9d:{'default':_0x3e2d9d};};Object[a47_0x38c9e9(0x158)](exports,a47_0x38c9e9(0x14e),{'value':!![]}),exports[a47_0x38c9e9(0x15f)]=void 0x0;const bcryptjs_1=__importDefault(require(a47_0x38c9e9(0x145))),jsonwebtoken_1=__importDefault(require(a47_0x38c9e9(0x154))),database_1=__importDefault(require(a47_0x38c9e9(0x14d))),config_1=require(a47_0x38c9e9(0x153));class AuthService{[a47_0x38c9e9(0x15c)](_0x1aa4ec){const _0x4c35d2=a47_0x38c9e9;return jsonwebtoken_1['default'][_0x4c35d2(0x160)](_0x1aa4ec,config_1[_0x4c35d2(0x14a)][_0x4c35d2(0x152)][_0x4c35d2(0x14b)],{'expiresIn':String(config_1[_0x4c35d2(0x14a)][_0x4c35d2(0x152)][_0x4c35d2(0x144)])});}async[a47_0x38c9e9(0x150)](_0x5558b0){const _0x399cab=a47_0x38c9e9,{username:_0x127ac2,password:_0x588bac}=_0x5558b0;if(_0x127ac2===config_1['config'][_0x399cab(0x15e)][_0x399cab(0x151)]){const _0xf4cce7=await bcryptjs_1[_0x399cab(0x159)][_0x399cab(0x166)](_0x588bac,config_1['config']['admin'][_0x399cab(0x149)]);if(_0xf4cce7){const _0x3acead=this['generateToken']({'id':'admin','username':config_1['config']['admin'][_0x399cab(0x151)],'role':'admin'});return{'access_token':_0x3acead,'role':'admin'};}}const _0x8bdeaa=await database_1[_0x399cab(0x159)][_0x399cab(0x146)][_0x399cab(0x167)]({'where':{'username':_0x127ac2},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x8bdeaa)throw new Error('Invalid\x20credentials');if(_0x8bdeaa['status']!==_0x399cab(0x164))throw new Error('Account\x20is\x20not\x20active');const _0xfbe355=await bcryptjs_1[_0x399cab(0x159)][_0x399cab(0x166)](_0x588bac,_0x8bdeaa[_0x399cab(0x14f)]);if(!_0xfbe355)throw new Error(_0x399cab(0x156));const _0xe9c88b=this[_0x399cab(0x15c)]({'id':_0x8bdeaa['id'],'username':_0x8bdeaa['username'],'role':_0x399cab(0x146)});return{'access_token':_0xe9c88b,'role':_0x399cab(0x146),'user':{'id':_0x8bdeaa['id'],'name':_0x8bdeaa[_0x399cab(0x157)],'username':_0x8bdeaa['username']}};}async[a47_0x38c9e9(0x15a)](_0x31ac76){const _0x57538d=a47_0x38c9e9;try{const _0x5a533f=jsonwebtoken_1[_0x57538d(0x159)]['verify'](_0x31ac76,config_1['config'][_0x57538d(0x152)][_0x57538d(0x14b)]);return _0x5a533f;}catch(_0x58d418){throw new Error('Invalid\x20token');}}}exports['AuthService']=AuthService;