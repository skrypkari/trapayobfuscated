'use strict';function a36_0xc633(_0x3f616f,_0x16c4d1){const _0x53e198=a36_0x53e1();return a36_0xc633=function(_0xc6333b,_0x421ef6){_0xc6333b=_0xc6333b-0x74;let _0x31d62b=_0x53e198[_0xc6333b];return _0x31d62b;},a36_0xc633(_0x3f616f,_0x16c4d1);}const a36_0x4c4239=a36_0xc633;(function(_0x3aa8d1,_0x2a3da6){const _0x2ec369=a36_0xc633,_0x5eef6d=_0x3aa8d1();while(!![]){try{const _0x3f68b3=-parseInt(_0x2ec369(0x84))/0x1+-parseInt(_0x2ec369(0x85))/0x2*(-parseInt(_0x2ec369(0x7e))/0x3)+-parseInt(_0x2ec369(0x8c))/0x4+parseInt(_0x2ec369(0x81))/0x5*(-parseInt(_0x2ec369(0x94))/0x6)+-parseInt(_0x2ec369(0x78))/0x7*(-parseInt(_0x2ec369(0x95))/0x8)+-parseInt(_0x2ec369(0x92))/0x9*(-parseInt(_0x2ec369(0x91))/0xa)+-parseInt(_0x2ec369(0x8a))/0xb*(-parseInt(_0x2ec369(0x99))/0xc);if(_0x3f68b3===_0x2a3da6)break;else _0x5eef6d['push'](_0x5eef6d['shift']());}catch(_0x2d39d8){_0x5eef6d['push'](_0x5eef6d['shift']());}}}(a36_0x53e1,0xec20a));var __importDefault=this&&this[a36_0x4c4239(0x82)]||function(_0x12650e){const _0x7e369f=a36_0x4c4239;return _0x12650e&&_0x12650e[_0x7e369f(0x74)]?_0x12650e:{'default':_0x12650e};};function a36_0x53e1(){const _0x4a2a74=['status','passwordHash','name','75hglDsu','default','../config/config','588435KkPymY','__importDefault','verify','1666498GkYHAV','77834KBicKW','admin','bcryptjs','jwt','compare','191279WZZdlX','defineProperty','412056yCcnAe','shop','verifyToken','username','generateToken','10YnQrqT','6698547FPZxyX','Invalid\x20credentials','42kDgNkt','3895592xEWHfP','login','password','../config/database','936EhPxgX','AuthService','jsonwebtoken','Invalid\x20token','__esModule','secret','sign','findUnique','7uJBNfD','ACTIVE','config'];a36_0x53e1=function(){return _0x4a2a74;};return a36_0x53e1();}Object[a36_0x4c4239(0x8b)](exports,a36_0x4c4239(0x74),{'value':!![]}),exports['AuthService']=void 0x0;const bcryptjs_1=__importDefault(require(a36_0x4c4239(0x87))),jsonwebtoken_1=__importDefault(require(a36_0x4c4239(0x9b))),database_1=__importDefault(require(a36_0x4c4239(0x98))),config_1=require(a36_0x4c4239(0x80));class AuthService{[a36_0x4c4239(0x90)](_0x357be3){const _0x38f528=a36_0x4c4239;return jsonwebtoken_1['default'][_0x38f528(0x76)](_0x357be3,config_1[_0x38f528(0x7a)][_0x38f528(0x88)][_0x38f528(0x75)],{'expiresIn':String(config_1[_0x38f528(0x7a)]['jwt']['expiresIn'])});}async[a36_0x4c4239(0x96)](_0x181c84){const _0x46fffa=a36_0x4c4239,{username:_0x976915,password:_0x588b87}=_0x181c84;if(_0x976915===config_1[_0x46fffa(0x7a)][_0x46fffa(0x86)][_0x46fffa(0x8f)]){const _0xe66998=await bcryptjs_1[_0x46fffa(0x7f)]['compare'](_0x588b87,config_1[_0x46fffa(0x7a)][_0x46fffa(0x86)][_0x46fffa(0x7c)]);if(_0xe66998){const _0x26c8a2=this[_0x46fffa(0x90)]({'id':'admin','username':config_1['config'][_0x46fffa(0x86)][_0x46fffa(0x8f)],'role':'admin'});return{'access_token':_0x26c8a2,'role':'admin'};}}const _0x2a6fd3=await database_1[_0x46fffa(0x7f)]['shop'][_0x46fffa(0x77)]({'where':{'username':_0x976915},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x2a6fd3)throw new Error(_0x46fffa(0x93));if(_0x2a6fd3[_0x46fffa(0x7b)]!==_0x46fffa(0x79))throw new Error('Account\x20is\x20not\x20active');const _0x39d8a9=await bcryptjs_1[_0x46fffa(0x7f)][_0x46fffa(0x89)](_0x588b87,_0x2a6fd3[_0x46fffa(0x97)]);if(!_0x39d8a9)throw new Error(_0x46fffa(0x93));const _0x24b68c=this[_0x46fffa(0x90)]({'id':_0x2a6fd3['id'],'username':_0x2a6fd3['username'],'role':_0x46fffa(0x8d)});return{'access_token':_0x24b68c,'role':_0x46fffa(0x8d),'user':{'id':_0x2a6fd3['id'],'name':_0x2a6fd3[_0x46fffa(0x7d)],'username':_0x2a6fd3[_0x46fffa(0x8f)]}};}async[a36_0x4c4239(0x8e)](_0x4bd6ec){const _0x4a317c=a36_0x4c4239;try{const _0x50425c=jsonwebtoken_1[_0x4a317c(0x7f)][_0x4a317c(0x83)](_0x4bd6ec,config_1[_0x4a317c(0x7a)][_0x4a317c(0x88)][_0x4a317c(0x75)]);return _0x50425c;}catch(_0xa1218c){throw new Error(_0x4a317c(0x9c));}}}exports[a36_0x4c4239(0x9a)]=AuthService;