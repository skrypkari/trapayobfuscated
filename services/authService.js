'use strict';const a34_0x260281=a34_0x18fb;(function(_0x435d5c,_0x46813b){const _0x58cfa1=a34_0x18fb,_0x1a1f6c=_0x435d5c();while(!![]){try{const _0x129d5d=-parseInt(_0x58cfa1(0xaf))/0x1*(-parseInt(_0x58cfa1(0xb2))/0x2)+-parseInt(_0x58cfa1(0x9c))/0x3*(parseInt(_0x58cfa1(0xa6))/0x4)+-parseInt(_0x58cfa1(0x92))/0x5+-parseInt(_0x58cfa1(0xac))/0x6*(-parseInt(_0x58cfa1(0x9f))/0x7)+-parseInt(_0x58cfa1(0xad))/0x8+-parseInt(_0x58cfa1(0x8e))/0x9+-parseInt(_0x58cfa1(0xa3))/0xa*(-parseInt(_0x58cfa1(0x95))/0xb);if(_0x129d5d===_0x46813b)break;else _0x1a1f6c['push'](_0x1a1f6c['shift']());}catch(_0x10535e){_0x1a1f6c['push'](_0x1a1f6c['shift']());}}}(a34_0x4396,0x65517));var __importDefault=this&&this[a34_0x260281(0x9e)]||function(_0x2fb13b){const _0x421d5c=a34_0x260281;return _0x2fb13b&&_0x2fb13b[_0x421d5c(0xa0)]?_0x2fb13b:{'default':_0x2fb13b};};function a34_0x18fb(_0x46a090,_0x4e0295){const _0x43968d=a34_0x4396();return a34_0x18fb=function(_0x18fbe6,_0x3b3086){_0x18fbe6=_0x18fbe6-0x8d;let _0x4d7f44=_0x43968d[_0x18fbe6];return _0x4d7f44;},a34_0x18fb(_0x46a090,_0x4e0295);}Object[a34_0x260281(0xab)](exports,a34_0x260281(0xa0),{'value':!![]}),exports[a34_0x260281(0x9d)]=void 0x0;const bcryptjs_1=__importDefault(require(a34_0x260281(0x96))),jsonwebtoken_1=__importDefault(require(a34_0x260281(0x8f))),database_1=__importDefault(require(a34_0x260281(0xa5))),config_1=require('../config/config');class AuthService{[a34_0x260281(0x97)](_0x334568){const _0x29a705=a34_0x260281;return jsonwebtoken_1[_0x29a705(0xa9)][_0x29a705(0xaa)](_0x334568,config_1[_0x29a705(0xa1)][_0x29a705(0xb1)][_0x29a705(0x94)],{'expiresIn':String(config_1[_0x29a705(0xa1)][_0x29a705(0xb1)][_0x29a705(0x99)])});}async['login'](_0x1782a3){const _0x10ce07=a34_0x260281,{username:_0x25fdbe,password:_0x3c48fd}=_0x1782a3;if(_0x25fdbe===config_1[_0x10ce07(0xa1)][_0x10ce07(0xa2)][_0x10ce07(0x9b)]){const _0x15f8d3=await bcryptjs_1[_0x10ce07(0xa9)][_0x10ce07(0x98)](_0x3c48fd,config_1[_0x10ce07(0xa1)][_0x10ce07(0xa2)][_0x10ce07(0xae)]);if(_0x15f8d3){const _0x76f24a=this[_0x10ce07(0x97)]({'id':_0x10ce07(0xa2),'username':config_1[_0x10ce07(0xa1)]['admin']['username'],'role':_0x10ce07(0xa2)});return{'access_token':_0x76f24a,'role':_0x10ce07(0xa2)};}}const _0x227870=await database_1['default']['shop'][_0x10ce07(0x90)]({'where':{'username':_0x25fdbe},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x227870)throw new Error(_0x10ce07(0xa7));if(_0x227870[_0x10ce07(0xa4)]!==_0x10ce07(0xb0))throw new Error(_0x10ce07(0x8d));const _0x30ac60=await bcryptjs_1[_0x10ce07(0xa9)]['compare'](_0x3c48fd,_0x227870['password']);if(!_0x30ac60)throw new Error(_0x10ce07(0xa7));const _0x29a856=this[_0x10ce07(0x97)]({'id':_0x227870['id'],'username':_0x227870[_0x10ce07(0x9b)],'role':_0x10ce07(0x93)});return{'access_token':_0x29a856,'role':_0x10ce07(0x93),'user':{'id':_0x227870['id'],'name':_0x227870[_0x10ce07(0x91)],'username':_0x227870[_0x10ce07(0x9b)]}};}async[a34_0x260281(0xa8)](_0x292e08){const _0x4016d2=a34_0x260281;try{const _0x162694=jsonwebtoken_1[_0x4016d2(0xa9)][_0x4016d2(0x9a)](_0x292e08,config_1[_0x4016d2(0xa1)][_0x4016d2(0xb1)][_0x4016d2(0x94)]);return _0x162694;}catch(_0x3e5d0f){throw new Error('Invalid\x20token');}}}function a34_0x4396(){const _0x11ad86=['50KspbFz','status','../config/database','4GLrsuL','Invalid\x20credentials','verifyToken','default','sign','defineProperty','1478646gpmRoW','6021120mEpQDQ','passwordHash','4217IyjBXq','ACTIVE','jwt','318siTkkY','Account\x20is\x20not\x20active','2517093GPUjpW','jsonwebtoken','findUnique','name','3888780MuYJIq','shop','secret','3775827DbJmmK','bcryptjs','generateToken','compare','expiresIn','verify','username','1224471tCBMkK','AuthService','__importDefault','7uYyDLr','__esModule','config','admin'];a34_0x4396=function(){return _0x11ad86;};return a34_0x4396();}exports[a34_0x260281(0x9d)]=AuthService;