'use strict';const a36_0xc7b76b=a36_0x358c;(function(_0x5a0434,_0x245da3){const _0xf4b8af=a36_0x358c,_0x5becb0=_0x5a0434();while(!![]){try{const _0x4a99e1=parseInt(_0xf4b8af(0x11f))/0x1+-parseInt(_0xf4b8af(0x128))/0x2+parseInt(_0xf4b8af(0x12a))/0x3*(-parseInt(_0xf4b8af(0x12d))/0x4)+parseInt(_0xf4b8af(0x125))/0x5+-parseInt(_0xf4b8af(0x137))/0x6+parseInt(_0xf4b8af(0x136))/0x7+parseInt(_0xf4b8af(0x12c))/0x8;if(_0x4a99e1===_0x245da3)break;else _0x5becb0['push'](_0x5becb0['shift']());}catch(_0x2d0b49){_0x5becb0['push'](_0x5becb0['shift']());}}}(a36_0x19c6,0xbe157));var __importDefault=this&&this[a36_0xc7b76b(0x126)]||function(_0x469621){const _0x4bee0f=a36_0xc7b76b;return _0x469621&&_0x469621[_0x4bee0f(0x13a)]?_0x469621:{'default':_0x469621};};Object['defineProperty'](exports,a36_0xc7b76b(0x13a),{'value':!![]}),exports[a36_0xc7b76b(0x133)]=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),jsonwebtoken_1=__importDefault(require('jsonwebtoken')),database_1=__importDefault(require('../config/database')),config_1=require(a36_0xc7b76b(0x12e));class AuthService{['generateToken'](_0x3a0629){const _0x4fc6d8=a36_0xc7b76b;return jsonwebtoken_1[_0x4fc6d8(0x11d)][_0x4fc6d8(0x12b)](_0x3a0629,config_1[_0x4fc6d8(0x135)]['jwt'][_0x4fc6d8(0x11c)],{'expiresIn':String(config_1[_0x4fc6d8(0x135)][_0x4fc6d8(0x12f)][_0x4fc6d8(0x13b)])});}async['login'](_0x3b5e0f){const _0x4916c9=a36_0xc7b76b,{username:_0x41514b,password:_0x100bf1}=_0x3b5e0f;if(_0x41514b===config_1[_0x4916c9(0x135)]['admin'][_0x4916c9(0x11e)]){const _0x373d19=await bcryptjs_1[_0x4916c9(0x11d)][_0x4916c9(0x132)](_0x100bf1,config_1['config'][_0x4916c9(0x134)][_0x4916c9(0x123)]);if(_0x373d19){const _0x5001ca=this[_0x4916c9(0x120)]({'id':_0x4916c9(0x134),'username':config_1[_0x4916c9(0x135)][_0x4916c9(0x134)][_0x4916c9(0x11e)],'role':_0x4916c9(0x134)});return{'access_token':_0x5001ca,'role':_0x4916c9(0x134)};}}const _0x592673=await database_1['default'][_0x4916c9(0x122)][_0x4916c9(0x127)]({'where':{'username':_0x41514b},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x592673)throw new Error('Invalid\x20credentials');if(_0x592673[_0x4916c9(0x129)]!==_0x4916c9(0x138))throw new Error(_0x4916c9(0x121));const _0x4b1a48=await bcryptjs_1['default'][_0x4916c9(0x132)](_0x100bf1,_0x592673[_0x4916c9(0x139)]);if(!_0x4b1a48)throw new Error(_0x4916c9(0x124));const _0x4b4489=this[_0x4916c9(0x120)]({'id':_0x592673['id'],'username':_0x592673[_0x4916c9(0x11e)],'role':_0x4916c9(0x122)});return{'access_token':_0x4b4489,'role':_0x4916c9(0x122),'user':{'id':_0x592673['id'],'name':_0x592673['name'],'username':_0x592673[_0x4916c9(0x11e)]}};}async[a36_0xc7b76b(0x131)](_0x45319f){const _0x439f44=a36_0xc7b76b;try{const _0xbbeb1a=jsonwebtoken_1[_0x439f44(0x11d)]['verify'](_0x45319f,config_1[_0x439f44(0x135)][_0x439f44(0x12f)][_0x439f44(0x11c)]);return _0xbbeb1a;}catch(_0x32d06e){throw new Error(_0x439f44(0x130));}}}function a36_0x19c6(){const _0x14218e=['admin','config','10085502jvUoPI','6940758BwxVyy','ACTIVE','password','__esModule','expiresIn','secret','default','username','326617UifaPa','generateToken','Account\x20is\x20not\x20active','shop','passwordHash','Invalid\x20credentials','7536005dWZnoW','__importDefault','findUnique','2120922reSbwU','status','6VhYQdo','sign','4539480JsVKFi','1692404GOEBBz','../config/config','jwt','Invalid\x20token','verifyToken','compare','AuthService'];a36_0x19c6=function(){return _0x14218e;};return a36_0x19c6();}function a36_0x358c(_0x1481f7,_0x35e1ae){const _0x19c68c=a36_0x19c6();return a36_0x358c=function(_0x358cbe,_0x434f33){_0x358cbe=_0x358cbe-0x11c;let _0x3e03ef=_0x19c68c[_0x358cbe];return _0x3e03ef;},a36_0x358c(_0x1481f7,_0x35e1ae);}exports['AuthService']=AuthService;