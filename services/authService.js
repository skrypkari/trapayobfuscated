'use strict';const a36_0x474f2e=a36_0xa8f2;(function(_0x14740c,_0x1ef98a){const _0x26eb9a=a36_0xa8f2,_0x1dd290=_0x14740c();while(!![]){try{const _0x4a91b0=parseInt(_0x26eb9a(0x119))/0x1*(-parseInt(_0x26eb9a(0x136))/0x2)+-parseInt(_0x26eb9a(0x12a))/0x3*(-parseInt(_0x26eb9a(0x125))/0x4)+-parseInt(_0x26eb9a(0x11e))/0x5*(-parseInt(_0x26eb9a(0x11f))/0x6)+parseInt(_0x26eb9a(0x12b))/0x7*(parseInt(_0x26eb9a(0x132))/0x8)+parseInt(_0x26eb9a(0x12e))/0x9*(parseInt(_0x26eb9a(0x130))/0xa)+-parseInt(_0x26eb9a(0x135))/0xb*(-parseInt(_0x26eb9a(0x111))/0xc)+-parseInt(_0x26eb9a(0x118))/0xd*(parseInt(_0x26eb9a(0x112))/0xe);if(_0x4a91b0===_0x1ef98a)break;else _0x1dd290['push'](_0x1dd290['shift']());}catch(_0xce76e4){_0x1dd290['push'](_0x1dd290['shift']());}}}(a36_0x4d91,0x6685f));function a36_0x4d91(){const _0x4ea268=['jwt','Invalid\x20token','generateToken','admin','__esModule','1928laQqhu','jsonwebtoken','status','../config/database','config','3417fIPbrV','2971990vvaFij','compare','sign','873AaxImN','bcryptjs','33230kiintK','password','8sFvLii','INACTIVE','shop','40568lQgZWJ','2KWjCbY','username','SUSPENDED','576YmLsco','4298UpBMhM','AuthService','secret','passwordHash','name','Account\x20is\x20not\x20active','66131TbCHRy','165123LbEuPc','default','findUnique','verify','expiresIn','1684610hnZNRq','12wasklC'];a36_0x4d91=function(){return _0x4ea268;};return a36_0x4d91();}function a36_0xa8f2(_0x484ada,_0x515be){const _0x4d91fe=a36_0x4d91();return a36_0xa8f2=function(_0xa8f2bd,_0x1ba7ab){_0xa8f2bd=_0xa8f2bd-0x111;let _0x47bef2=_0x4d91fe[_0xa8f2bd];return _0x47bef2;},a36_0xa8f2(_0x484ada,_0x515be);}var __importDefault=this&&this['__importDefault']||function(_0x3a1cd4){const _0x3fdb30=a36_0xa8f2;return _0x3a1cd4&&_0x3a1cd4[_0x3fdb30(0x124)]?_0x3a1cd4:{'default':_0x3a1cd4};};Object['defineProperty'](exports,a36_0x474f2e(0x124),{'value':!![]}),exports[a36_0x474f2e(0x113)]=void 0x0;const bcryptjs_1=__importDefault(require(a36_0x474f2e(0x12f))),jsonwebtoken_1=__importDefault(require(a36_0x474f2e(0x126))),database_1=__importDefault(require(a36_0x474f2e(0x128))),config_1=require('../config/config');class AuthService{[a36_0x474f2e(0x122)](_0x3cc380){const _0x36ad86=a36_0x474f2e;return jsonwebtoken_1['default'][_0x36ad86(0x12d)](_0x3cc380,config_1['config']['jwt'][_0x36ad86(0x114)],{'expiresIn':String(config_1[_0x36ad86(0x129)][_0x36ad86(0x120)][_0x36ad86(0x11d)])});}async['login'](_0xcdfbfe){const _0x19db90=a36_0x474f2e,{username:_0xa6d53b,password:_0x341787}=_0xcdfbfe;if(_0xa6d53b===config_1[_0x19db90(0x129)][_0x19db90(0x123)][_0x19db90(0x137)]){const _0x445c08=await bcryptjs_1[_0x19db90(0x11a)][_0x19db90(0x12c)](_0x341787,config_1['config'][_0x19db90(0x123)][_0x19db90(0x115)]);if(_0x445c08){const _0x4bd0c9=this['generateToken']({'id':_0x19db90(0x123),'username':config_1['config'][_0x19db90(0x123)][_0x19db90(0x137)],'role':_0x19db90(0x123)});return{'access_token':_0x4bd0c9,'role':_0x19db90(0x123)};}}const _0x54ae5e=await database_1['default'][_0x19db90(0x134)][_0x19db90(0x11b)]({'where':{'username':_0xa6d53b},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x54ae5e)throw new Error('Invalid\x20credentials');if(_0x54ae5e[_0x19db90(0x127)]===_0x19db90(0x133))throw new Error(_0x19db90(0x117));const _0x4f991a=await bcryptjs_1[_0x19db90(0x11a)]['compare'](_0x341787,_0x54ae5e[_0x19db90(0x131)]);if(!_0x4f991a)throw new Error('Invalid\x20credentials');const _0x42fb02=this['generateToken']({'id':_0x54ae5e['id'],'username':_0x54ae5e[_0x19db90(0x137)],'role':_0x19db90(0x134)});return{'access_token':_0x42fb02,'role':_0x19db90(0x134),'user':{'id':_0x54ae5e['id'],'name':_0x54ae5e[_0x19db90(0x116)],'username':_0x54ae5e[_0x19db90(0x137)],'status':_0x54ae5e[_0x19db90(0x127)]},'suspended':_0x54ae5e[_0x19db90(0x127)]===_0x19db90(0x138)};}async['verifyToken'](_0x256464){const _0x3c5e09=a36_0x474f2e;try{const _0x3aad01=jsonwebtoken_1[_0x3c5e09(0x11a)][_0x3c5e09(0x11c)](_0x256464,config_1[_0x3c5e09(0x129)][_0x3c5e09(0x120)]['secret']);return _0x3aad01;}catch(_0x5e21d1){throw new Error(_0x3c5e09(0x121));}}}exports[a36_0x474f2e(0x113)]=AuthService;