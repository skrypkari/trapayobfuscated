'use strict';const a34_0x3dee1d=a34_0x14a7;function a34_0x14a7(_0x418e36,_0x3d45d2){const _0x2d1f73=a34_0x2d1f();return a34_0x14a7=function(_0x14a749,_0xe43007){_0x14a749=_0x14a749-0x19d;let _0x3c0d81=_0x2d1f73[_0x14a749];return _0x3c0d81;},a34_0x14a7(_0x418e36,_0x3d45d2);}(function(_0x5512c3,_0x50720b){const _0x49d309=a34_0x14a7,_0x1f0802=_0x5512c3();while(!![]){try{const _0x2a3fde=parseInt(_0x49d309(0x19e))/0x1*(parseInt(_0x49d309(0x1aa))/0x2)+-parseInt(_0x49d309(0x1a9))/0x3+parseInt(_0x49d309(0x1a6))/0x4+-parseInt(_0x49d309(0x1af))/0x5*(-parseInt(_0x49d309(0x1b3))/0x6)+parseInt(_0x49d309(0x1b7))/0x7+parseInt(_0x49d309(0x1b2))/0x8*(parseInt(_0x49d309(0x1b6))/0x9)+-parseInt(_0x49d309(0x19f))/0xa*(parseInt(_0x49d309(0x1ba))/0xb);if(_0x2a3fde===_0x50720b)break;else _0x1f0802['push'](_0x1f0802['shift']());}catch(_0xd81e16){_0x1f0802['push'](_0x1f0802['shift']());}}}(a34_0x2d1f,0xd3705));var __importDefault=this&&this[a34_0x3dee1d(0x1a5)]||function(_0x17c8bf){const _0x158f0d=a34_0x3dee1d;return _0x17c8bf&&_0x17c8bf[_0x158f0d(0x1b9)]?_0x17c8bf:{'default':_0x17c8bf};};Object[a34_0x3dee1d(0x1a4)](exports,a34_0x3dee1d(0x1b9),{'value':!![]}),exports[a34_0x3dee1d(0x1a3)]=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),jsonwebtoken_1=__importDefault(require(a34_0x3dee1d(0x1a8))),database_1=__importDefault(require(a34_0x3dee1d(0x1b0))),config_1=require(a34_0x3dee1d(0x1bd));function a34_0x2d1f(){const _0x315a50=['ACTIVE','admin','../config/config','status','Account\x20is\x20not\x20active','verifyToken','jwt','130SJvPJC','1861960dSJKXs','Invalid\x20credentials','password','expiresIn','AuthService','defineProperty','__importDefault','5216880brekzL','shop','jsonwebtoken','1852137uXQohl','10082zzToTF','default','username','passwordHash','secret','15hCWtAT','../config/database','generateToken','49776nxmCWo','3261318ZzMiBd','verify','compare','108KrzviL','1673749mdcwSD','config','__esModule','143tANFlc'];a34_0x2d1f=function(){return _0x315a50;};return a34_0x2d1f();}class AuthService{['generateToken'](_0x2e8d1a){const _0x17a7a8=a34_0x3dee1d;return jsonwebtoken_1[_0x17a7a8(0x1ab)]['sign'](_0x2e8d1a,config_1[_0x17a7a8(0x1b8)]['jwt'][_0x17a7a8(0x1ae)],{'expiresIn':String(config_1[_0x17a7a8(0x1b8)]['jwt'][_0x17a7a8(0x1a2)])});}async['login'](_0x2befba){const _0x47f153=a34_0x3dee1d,{username:_0x32f6e3,password:_0x546a85}=_0x2befba;if(_0x32f6e3===config_1[_0x47f153(0x1b8)][_0x47f153(0x1bc)][_0x47f153(0x1ac)]){const _0x253f46=await bcryptjs_1[_0x47f153(0x1ab)][_0x47f153(0x1b5)](_0x546a85,config_1['config'][_0x47f153(0x1bc)][_0x47f153(0x1ad)]);if(_0x253f46){const _0x4eda59=this[_0x47f153(0x1b1)]({'id':_0x47f153(0x1bc),'username':config_1[_0x47f153(0x1b8)][_0x47f153(0x1bc)][_0x47f153(0x1ac)],'role':'admin'});return{'access_token':_0x4eda59,'role':_0x47f153(0x1bc)};}}const _0x4ed9c6=await database_1['default'][_0x47f153(0x1a7)]['findUnique']({'where':{'username':_0x32f6e3},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x4ed9c6)throw new Error('Invalid\x20credentials');if(_0x4ed9c6[_0x47f153(0x1be)]!==_0x47f153(0x1bb))throw new Error(_0x47f153(0x1bf));const _0x12cd9f=await bcryptjs_1['default']['compare'](_0x546a85,_0x4ed9c6[_0x47f153(0x1a1)]);if(!_0x12cd9f)throw new Error(_0x47f153(0x1a0));const _0x4c32a6=this[_0x47f153(0x1b1)]({'id':_0x4ed9c6['id'],'username':_0x4ed9c6[_0x47f153(0x1ac)],'role':_0x47f153(0x1a7)});return{'access_token':_0x4c32a6,'role':'shop','user':{'id':_0x4ed9c6['id'],'name':_0x4ed9c6['name'],'username':_0x4ed9c6[_0x47f153(0x1ac)]}};}async[a34_0x3dee1d(0x1c0)](_0x29b6b5){const _0x3fc635=a34_0x3dee1d;try{const _0x1985a1=jsonwebtoken_1['default'][_0x3fc635(0x1b4)](_0x29b6b5,config_1[_0x3fc635(0x1b8)][_0x3fc635(0x19d)][_0x3fc635(0x1ae)]);return _0x1985a1;}catch(_0xff5529){throw new Error('Invalid\x20token');}}}exports[a34_0x3dee1d(0x1a3)]=AuthService;