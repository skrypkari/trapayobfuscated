'use strict';const a34_0x4f1ad3=a34_0x1028;function a34_0x1028(_0x520c2f,_0x4373c6){const _0x3d83b8=a34_0x3d83();return a34_0x1028=function(_0x10282e,_0x327236){_0x10282e=_0x10282e-0x93;let _0x28ae01=_0x3d83b8[_0x10282e];return _0x28ae01;},a34_0x1028(_0x520c2f,_0x4373c6);}(function(_0x52f44f,_0x47b6f4){const _0x22944c=a34_0x1028,_0x4a317f=_0x52f44f();while(!![]){try{const _0x2a0ba8=-parseInt(_0x22944c(0xa3))/0x1*(-parseInt(_0x22944c(0x9d))/0x2)+parseInt(_0x22944c(0xb2))/0x3+-parseInt(_0x22944c(0x96))/0x4+-parseInt(_0x22944c(0x9c))/0x5*(parseInt(_0x22944c(0x99))/0x6)+parseInt(_0x22944c(0x95))/0x7+parseInt(_0x22944c(0xae))/0x8*(parseInt(_0x22944c(0xb3))/0x9)+parseInt(_0x22944c(0xa7))/0xa*(-parseInt(_0x22944c(0x9e))/0xb);if(_0x2a0ba8===_0x47b6f4)break;else _0x4a317f['push'](_0x4a317f['shift']());}catch(_0x2f66f5){_0x4a317f['push'](_0x4a317f['shift']());}}}(a34_0x3d83,0xefa4c));var __importDefault=this&&this['__importDefault']||function(_0x244e5b){const _0x25ba7b=a34_0x1028;return _0x244e5b&&_0x244e5b[_0x25ba7b(0xab)]?_0x244e5b:{'default':_0x244e5b};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports['AuthService']=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),jsonwebtoken_1=__importDefault(require(a34_0x4f1ad3(0xad))),database_1=__importDefault(require(a34_0x4f1ad3(0x97))),config_1=require(a34_0x4f1ad3(0x9b));class AuthService{[a34_0x4f1ad3(0xa2)](_0x25fe14){const _0x3a0f96=a34_0x4f1ad3;return jsonwebtoken_1[_0x3a0f96(0x9f)]['sign'](_0x25fe14,config_1[_0x3a0f96(0xa5)][_0x3a0f96(0xa4)]['secret'],{'expiresIn':String(config_1[_0x3a0f96(0xa5)][_0x3a0f96(0xa4)][_0x3a0f96(0xaa)])});}async['login'](_0x3e51fb){const _0x3f4fc6=a34_0x4f1ad3,{username:_0x5c7d21,password:_0x3d51f5}=_0x3e51fb;if(_0x5c7d21===config_1[_0x3f4fc6(0xa5)][_0x3f4fc6(0x9a)]['username']){const _0x5f3f3c=await bcryptjs_1[_0x3f4fc6(0x9f)][_0x3f4fc6(0x98)](_0x3d51f5,config_1[_0x3f4fc6(0xa5)][_0x3f4fc6(0x9a)][_0x3f4fc6(0xb1)]);if(_0x5f3f3c){const _0x4db825=this[_0x3f4fc6(0xa2)]({'id':_0x3f4fc6(0x9a),'username':config_1[_0x3f4fc6(0xa5)][_0x3f4fc6(0x9a)][_0x3f4fc6(0x94)],'role':'admin'});return{'access_token':_0x4db825,'role':_0x3f4fc6(0x9a)};}}const _0x299967=await database_1[_0x3f4fc6(0x9f)][_0x3f4fc6(0x93)][_0x3f4fc6(0xa6)]({'where':{'username':_0x5c7d21},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x299967)throw new Error(_0x3f4fc6(0xa0));if(_0x299967['status']!==_0x3f4fc6(0xb0))throw new Error(_0x3f4fc6(0xa1));const _0x1ce0f2=await bcryptjs_1['default'][_0x3f4fc6(0x98)](_0x3d51f5,_0x299967[_0x3f4fc6(0xa8)]);if(!_0x1ce0f2)throw new Error(_0x3f4fc6(0xa0));const _0x16a173=this[_0x3f4fc6(0xa2)]({'id':_0x299967['id'],'username':_0x299967[_0x3f4fc6(0x94)],'role':_0x3f4fc6(0x93)});return{'access_token':_0x16a173,'role':'shop','user':{'id':_0x299967['id'],'name':_0x299967[_0x3f4fc6(0xac)],'username':_0x299967[_0x3f4fc6(0x94)]}};}async[a34_0x4f1ad3(0xa9)](_0x56ef1c){const _0x35b5ca=a34_0x4f1ad3;try{const _0x45e6c3=jsonwebtoken_1[_0x35b5ca(0x9f)]['verify'](_0x56ef1c,config_1[_0x35b5ca(0xa5)][_0x35b5ca(0xa4)]['secret']);return _0x45e6c3;}catch(_0x590c9f){throw new Error('Invalid\x20token');}}}exports[a34_0x4f1ad3(0xaf)]=AuthService;function a34_0x3d83(){const _0x314bb2=['__esModule','name','jsonwebtoken','8mpcLze','AuthService','ACTIVE','passwordHash','826461ntafoe','5016807wroiCC','shop','username','13134443xYqIJD','1369984xTIRND','../config/database','compare','10220106QkjwFK','admin','../config/config','5GbldTg','6jEUJSe','11MXdHhs','default','Invalid\x20credentials','Account\x20is\x20not\x20active','generateToken','342829nUNMMu','jwt','config','findUnique','7103190aEcFEz','password','verifyToken','expiresIn'];a34_0x3d83=function(){return _0x314bb2;};return a34_0x3d83();}