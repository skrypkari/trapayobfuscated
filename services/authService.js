'use strict';const a47_0x256c77=a47_0x4740;(function(_0x14cf25,_0x1d9086){const _0x55c0f4=a47_0x4740,_0x1b14f1=_0x14cf25();while(!![]){try{const _0x2a9d36=-parseInt(_0x55c0f4(0x1ba))/0x1+parseInt(_0x55c0f4(0x1a3))/0x2*(-parseInt(_0x55c0f4(0x1bd))/0x3)+parseInt(_0x55c0f4(0x1ab))/0x4*(-parseInt(_0x55c0f4(0x1b2))/0x5)+parseInt(_0x55c0f4(0x1a6))/0x6+-parseInt(_0x55c0f4(0x1a2))/0x7+parseInt(_0x55c0f4(0x19d))/0x8+-parseInt(_0x55c0f4(0x1ad))/0x9*(-parseInt(_0x55c0f4(0x1a9))/0xa);if(_0x2a9d36===_0x1d9086)break;else _0x1b14f1['push'](_0x1b14f1['shift']());}catch(_0x5b2a76){_0x1b14f1['push'](_0x1b14f1['shift']());}}}(a47_0x441e,0x65466));function a47_0x4740(_0x569b3c,_0xaf4936){_0x569b3c=_0x569b3c-0x19c;const _0x441e6a=a47_0x441e();let _0x47402b=_0x441e6a[_0x569b3c];return _0x47402b;}var __importDefault=this&&this[a47_0x256c77(0x19f)]||function(_0x4eabc8){const _0x3078b6=a47_0x256c77;return _0x4eabc8&&_0x4eabc8[_0x3078b6(0x1ae)]?_0x4eabc8:{'default':_0x4eabc8};};Object['defineProperty'](exports,a47_0x256c77(0x1ae),{'value':!![]}),exports[a47_0x256c77(0x1ac)]=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),jsonwebtoken_1=__importDefault(require('jsonwebtoken')),database_1=__importDefault(require(a47_0x256c77(0x1a8))),config_1=require(a47_0x256c77(0x1a5));class AuthService{[a47_0x256c77(0x1aa)](_0x57607d){const _0x30f9c0=a47_0x256c77;return jsonwebtoken_1[_0x30f9c0(0x1b4)][_0x30f9c0(0x1bc)](_0x57607d,config_1[_0x30f9c0(0x1a1)]['jwt'][_0x30f9c0(0x1b8)],{'expiresIn':String(config_1[_0x30f9c0(0x1a1)][_0x30f9c0(0x1a7)][_0x30f9c0(0x19e)])});}async[a47_0x256c77(0x1b6)](_0x205393){const _0x4a96bb=a47_0x256c77,{username:_0x18e488,password:_0x277de1}=_0x205393;if(_0x18e488===config_1['config'][_0x4a96bb(0x1b3)][_0x4a96bb(0x1b9)]){const _0x576e9e=await bcryptjs_1['default'][_0x4a96bb(0x1b0)](_0x277de1,config_1['config']['admin'][_0x4a96bb(0x1b7)]);if(_0x576e9e){const _0x183408=this[_0x4a96bb(0x1aa)]({'id':_0x4a96bb(0x1b3),'username':config_1['config'][_0x4a96bb(0x1b3)]['username'],'role':'admin'});return{'access_token':_0x183408,'role':'admin'};}}const _0x528bde=await database_1[_0x4a96bb(0x1b4)]['shop'][_0x4a96bb(0x1bf)]({'where':{'username':_0x18e488},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x528bde)throw new Error('Invalid\x20credentials');if(_0x528bde[_0x4a96bb(0x1a0)]!=='ACTIVE')throw new Error('Account\x20is\x20not\x20active');const _0x10237f=await bcryptjs_1['default'][_0x4a96bb(0x1b0)](_0x277de1,_0x528bde[_0x4a96bb(0x1be)]);if(!_0x10237f)throw new Error(_0x4a96bb(0x19c));const _0x4cb3ad=this[_0x4a96bb(0x1aa)]({'id':_0x528bde['id'],'username':_0x528bde['username'],'role':_0x4a96bb(0x1af)});return{'access_token':_0x4cb3ad,'role':_0x4a96bb(0x1af),'user':{'id':_0x528bde['id'],'name':_0x528bde[_0x4a96bb(0x1b1)],'username':_0x528bde[_0x4a96bb(0x1b9)]}};}async[a47_0x256c77(0x1bb)](_0x54b25a){const _0x272c22=a47_0x256c77;try{const _0x38ee3b=jsonwebtoken_1['default'][_0x272c22(0x1b5)](_0x54b25a,config_1[_0x272c22(0x1a1)][_0x272c22(0x1a7)][_0x272c22(0x1b8)]);return _0x38ee3b;}catch(_0x1ca20d){throw new Error(_0x272c22(0x1a4));}}}function a47_0x441e(){const _0x1188d7=['default','verify','login','passwordHash','secret','username','149242Awmimq','verifyToken','sign','87jgAdDm','password','findUnique','Invalid\x20credentials','4240XpJbon','expiresIn','__importDefault','status','config','570794JqLKGA','33874quqeoQ','Invalid\x20token','../config/config','4460436KbwKUZ','jwt','../config/database','15890hieDYx','generateToken','248UyQeRa','AuthService','4581JBDKKC','__esModule','shop','compare','name','33545zExZke','admin'];a47_0x441e=function(){return _0x1188d7;};return a47_0x441e();}exports['AuthService']=AuthService;