'use strict';const a37_0x121637=a37_0x4b3d;(function(_0x31e9c4,_0x3498d2){const _0x5815b4=a37_0x4b3d,_0x385dd5=_0x31e9c4();while(!![]){try{const _0x19eef4=parseInt(_0x5815b4(0x14a))/0x1+parseInt(_0x5815b4(0x157))/0x2*(parseInt(_0x5815b4(0x14c))/0x3)+-parseInt(_0x5815b4(0x150))/0x4+parseInt(_0x5815b4(0x164))/0x5*(parseInt(_0x5815b4(0x15d))/0x6)+-parseInt(_0x5815b4(0x166))/0x7*(-parseInt(_0x5815b4(0x148))/0x8)+-parseInt(_0x5815b4(0x155))/0x9*(-parseInt(_0x5815b4(0x144))/0xa)+-parseInt(_0x5815b4(0x14d))/0xb;if(_0x19eef4===_0x3498d2)break;else _0x385dd5['push'](_0x385dd5['shift']());}catch(_0x1d1f8e){_0x385dd5['push'](_0x385dd5['shift']());}}}(a37_0x2200,0x60064));var __importDefault=this&&this[a37_0x121637(0x152)]||function(_0x1864f1){const _0x377a77=a37_0x121637;return _0x1864f1&&_0x1864f1[_0x377a77(0x151)]?_0x1864f1:{'default':_0x1864f1};};function a37_0x4b3d(_0x4a5613,_0xbc0f32){const _0x22009b=a37_0x2200();return a37_0x4b3d=function(_0x4b3de8,_0x4fd525){_0x4b3de8=_0x4b3de8-0x143;let _0x1ee37d=_0x22009b[_0x4b3de8];return _0x1ee37d;},a37_0x4b3d(_0x4a5613,_0xbc0f32);}Object[a37_0x121637(0x153)](exports,a37_0x121637(0x151),{'value':!![]}),exports['AuthService']=void 0x0;const bcryptjs_1=__importDefault(require(a37_0x121637(0x162))),jsonwebtoken_1=__importDefault(require(a37_0x121637(0x15c))),database_1=__importDefault(require(a37_0x121637(0x160))),config_1=require(a37_0x121637(0x147));class AuthService{[a37_0x121637(0x14f)](_0x58976f){const _0x27fc57=a37_0x121637;return jsonwebtoken_1[_0x27fc57(0x15b)][_0x27fc57(0x14e)](_0x58976f,config_1[_0x27fc57(0x159)][_0x27fc57(0x15a)]['secret'],{'expiresIn':String(config_1[_0x27fc57(0x159)]['jwt'][_0x27fc57(0x154)])});}async['login'](_0x454365){const _0x3317b7=a37_0x121637,{username:_0x8a8efd,password:_0x10a32e}=_0x454365;if(_0x8a8efd===config_1[_0x3317b7(0x159)]['admin']['username']){const _0x42c88f=await bcryptjs_1[_0x3317b7(0x15b)][_0x3317b7(0x15f)](_0x10a32e,config_1[_0x3317b7(0x159)][_0x3317b7(0x168)][_0x3317b7(0x149)]);if(_0x42c88f){const _0x4635f0=this[_0x3317b7(0x14f)]({'id':_0x3317b7(0x168),'username':config_1['config']['admin'][_0x3317b7(0x163)],'role':_0x3317b7(0x168)});return{'access_token':_0x4635f0,'role':_0x3317b7(0x168)};}}const _0x3f6fac=await database_1[_0x3317b7(0x15b)][_0x3317b7(0x15e)][_0x3317b7(0x158)]({'where':{'username':_0x8a8efd},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x3f6fac)throw new Error(_0x3317b7(0x156));if(_0x3f6fac[_0x3317b7(0x146)]!==_0x3317b7(0x167))throw new Error('Account\x20is\x20not\x20active');const _0x31ee54=await bcryptjs_1[_0x3317b7(0x15b)]['compare'](_0x10a32e,_0x3f6fac['password']);if(!_0x31ee54)throw new Error(_0x3317b7(0x156));const _0x35ca42=this[_0x3317b7(0x14f)]({'id':_0x3f6fac['id'],'username':_0x3f6fac[_0x3317b7(0x163)],'role':_0x3317b7(0x15e)});return{'access_token':_0x35ca42,'role':_0x3317b7(0x15e),'user':{'id':_0x3f6fac['id'],'name':_0x3f6fac[_0x3317b7(0x165)],'username':_0x3f6fac[_0x3317b7(0x163)]}};}async['verifyToken'](_0x15e942){const _0x5324f1=a37_0x121637;try{const _0x56e275=jsonwebtoken_1[_0x5324f1(0x15b)][_0x5324f1(0x143)](_0x15e942,config_1[_0x5324f1(0x159)][_0x5324f1(0x15a)][_0x5324f1(0x161)]);return _0x56e275;}catch(_0x5db645){throw new Error(_0x5324f1(0x145));}}}exports[a37_0x121637(0x14b)]=AuthService;function a37_0x2200(){const _0x4def71=['__esModule','__importDefault','defineProperty','expiresIn','2340333eAKQYC','Invalid\x20credentials','120hnzGME','findUnique','config','jwt','default','jsonwebtoken','709026wmMWJc','shop','compare','../config/database','secret','bcryptjs','username','30bxxXlA','name','3372551QgyjpR','ACTIVE','admin','verify','10ZJQSvs','Invalid\x20token','status','../config/config','8RThKOX','passwordHash','458108duwAxG','AuthService','11025dWvuYe','11835362lAjccd','sign','generateToken','2640824YgKjVx'];a37_0x2200=function(){return _0x4def71;};return a37_0x2200();}