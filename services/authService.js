'use strict';const a36_0x47e30d=a36_0x422c;function a36_0x422c(_0x6cb9cf,_0x3da181){const _0x2c3b23=a36_0x2c3b();return a36_0x422c=function(_0x422c62,_0xcd9fad){_0x422c62=_0x422c62-0x1a4;let _0x146cd3=_0x2c3b23[_0x422c62];return _0x146cd3;},a36_0x422c(_0x6cb9cf,_0x3da181);}(function(_0x3a700c,_0x47b3ce){const _0x2a6c72=a36_0x422c,_0x6e5d64=_0x3a700c();while(!![]){try{const _0x473f9c=-parseInt(_0x2a6c72(0x1b8))/0x1*(parseInt(_0x2a6c72(0x1b1))/0x2)+parseInt(_0x2a6c72(0x1c9))/0x3*(parseInt(_0x2a6c72(0x1ca))/0x4)+-parseInt(_0x2a6c72(0x1bc))/0x5*(-parseInt(_0x2a6c72(0x1aa))/0x6)+parseInt(_0x2a6c72(0x1c0))/0x7*(parseInt(_0x2a6c72(0x1ae))/0x8)+-parseInt(_0x2a6c72(0x1c6))/0x9*(-parseInt(_0x2a6c72(0x1ac))/0xa)+parseInt(_0x2a6c72(0x1b6))/0xb+-parseInt(_0x2a6c72(0x1a4))/0xc;if(_0x473f9c===_0x47b3ce)break;else _0x6e5d64['push'](_0x6e5d64['shift']());}catch(_0x52ac11){_0x6e5d64['push'](_0x6e5d64['shift']());}}}(a36_0x2c3b,0x55a16));function a36_0x2c3b(){const _0x5091a5=['2952rvsDTa','generateToken','verifyToken','2fCkJxQ','Invalid\x20token','expiresIn','__esModule','passwordHash','3107852NOQFZk','name','451065dzYpME','../config/database','INACTIVE','jsonwebtoken','1152590TzVeBU','AuthService','Invalid\x20credentials','Account\x20is\x20not\x20active','1561LIhflR','shop','status','jwt','defineProperty','verify','36proPTO','default','findUnique','1683ueylaT','1780lpZZIl','admin','8116812bJdkaL','login','../config/config','config','compare','bcryptjs','12njQgpl','username','1006770rlXmmG','secret'];a36_0x2c3b=function(){return _0x5091a5;};return a36_0x2c3b();}var __importDefault=this&&this['__importDefault']||function(_0x36b604){return _0x36b604&&_0x36b604['__esModule']?_0x36b604:{'default':_0x36b604};};Object[a36_0x47e30d(0x1c4)](exports,a36_0x47e30d(0x1b4),{'value':!![]}),exports[a36_0x47e30d(0x1bd)]=void 0x0;const bcryptjs_1=__importDefault(require(a36_0x47e30d(0x1a9))),jsonwebtoken_1=__importDefault(require(a36_0x47e30d(0x1bb))),database_1=__importDefault(require(a36_0x47e30d(0x1b9))),config_1=require(a36_0x47e30d(0x1a6));class AuthService{['generateToken'](_0x28d0a0){const _0x25188b=a36_0x47e30d;return jsonwebtoken_1[_0x25188b(0x1c7)]['sign'](_0x28d0a0,config_1[_0x25188b(0x1a7)][_0x25188b(0x1c3)]['secret'],{'expiresIn':String(config_1['config'][_0x25188b(0x1c3)][_0x25188b(0x1b3)])});}async[a36_0x47e30d(0x1a5)](_0x30ba68){const _0x5f02ea=a36_0x47e30d,{username:_0x5b72c1,password:_0x55cf26}=_0x30ba68;if(_0x5b72c1===config_1[_0x5f02ea(0x1a7)][_0x5f02ea(0x1cb)]['username']){const _0x37774c=await bcryptjs_1[_0x5f02ea(0x1c7)][_0x5f02ea(0x1a8)](_0x55cf26,config_1['config']['admin'][_0x5f02ea(0x1b5)]);if(_0x37774c){const _0x3e9084=this[_0x5f02ea(0x1af)]({'id':_0x5f02ea(0x1cb),'username':config_1['config'][_0x5f02ea(0x1cb)]['username'],'role':'admin'});return{'access_token':_0x3e9084,'role':_0x5f02ea(0x1cb)};}}const _0x322cbf=await database_1[_0x5f02ea(0x1c7)][_0x5f02ea(0x1c1)][_0x5f02ea(0x1c8)]({'where':{'username':_0x5b72c1},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x322cbf)throw new Error(_0x5f02ea(0x1be));if(_0x322cbf[_0x5f02ea(0x1c2)]===_0x5f02ea(0x1ba))throw new Error(_0x5f02ea(0x1bf));const _0x39acbd=await bcryptjs_1[_0x5f02ea(0x1c7)][_0x5f02ea(0x1a8)](_0x55cf26,_0x322cbf['password']);if(!_0x39acbd)throw new Error('Invalid\x20credentials');const _0x159476=this[_0x5f02ea(0x1af)]({'id':_0x322cbf['id'],'username':_0x322cbf[_0x5f02ea(0x1ab)],'role':'shop'});return{'access_token':_0x159476,'role':'shop','user':{'id':_0x322cbf['id'],'name':_0x322cbf[_0x5f02ea(0x1b7)],'username':_0x322cbf[_0x5f02ea(0x1ab)],'status':_0x322cbf[_0x5f02ea(0x1c2)]},'suspended':_0x322cbf['status']==='SUSPENDED'};}async[a36_0x47e30d(0x1b0)](_0x56f954){const _0x1b7b1a=a36_0x47e30d;try{const _0x3dc2ed=jsonwebtoken_1[_0x1b7b1a(0x1c7)][_0x1b7b1a(0x1c5)](_0x56f954,config_1[_0x1b7b1a(0x1a7)][_0x1b7b1a(0x1c3)][_0x1b7b1a(0x1ad)]);return _0x3dc2ed;}catch(_0x2c6832){throw new Error(_0x1b7b1a(0x1b2));}}}exports['AuthService']=AuthService;