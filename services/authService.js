'use strict';const a47_0x19e6d0=a47_0x4110;(function(_0x449504,_0xd79225){const _0x3c8965=a47_0x4110,_0x24c7f9=_0x449504();while(!![]){try{const _0x47cd82=parseInt(_0x3c8965(0x1c3))/0x1+parseInt(_0x3c8965(0x1ca))/0x2*(parseInt(_0x3c8965(0x1bf))/0x3)+parseInt(_0x3c8965(0x1d2))/0x4*(-parseInt(_0x3c8965(0x1d1))/0x5)+-parseInt(_0x3c8965(0x1bb))/0x6*(parseInt(_0x3c8965(0x1d3))/0x7)+-parseInt(_0x3c8965(0x1bc))/0x8*(parseInt(_0x3c8965(0x1d6))/0x9)+parseInt(_0x3c8965(0x1c7))/0xa*(-parseInt(_0x3c8965(0x1c1))/0xb)+-parseInt(_0x3c8965(0x1d5))/0xc*(-parseInt(_0x3c8965(0x1b9))/0xd);if(_0x47cd82===_0xd79225)break;else _0x24c7f9['push'](_0x24c7f9['shift']());}catch(_0x2eb8b0){_0x24c7f9['push'](_0x24c7f9['shift']());}}}(a47_0x287b,0x9fd61));function a47_0x287b(){const _0xdc031d=['shop','secret','215uLVJOo','115972crFzdB','28qIirhT','default','24WADNtO','5248359euLQZC','password','passwordHash','findUnique','bcryptjs','config','Account\x20is\x20not\x20active','__importDefault','13792493bbbYRc','username','1863294NHYabA','8YgZATO','expiresIn','login','243462JXQTtc','verifyToken','77XhFVvp','../config/database','1068128JRrrBE','defineProperty','jsonwebtoken','admin','392650tTgJJG','AuthService','ACTIVE','20kIFudK','Invalid\x20credentials','__esModule','compare','../config/config'];a47_0x287b=function(){return _0xdc031d;};return a47_0x287b();}var __importDefault=this&&this[a47_0x19e6d0(0x1b8)]||function(_0x31a10a){const _0x5cdc92=a47_0x19e6d0;return _0x31a10a&&_0x31a10a[_0x5cdc92(0x1cc)]?_0x31a10a:{'default':_0x31a10a};};Object[a47_0x19e6d0(0x1c4)](exports,a47_0x19e6d0(0x1cc),{'value':!![]}),exports[a47_0x19e6d0(0x1c8)]=void 0x0;function a47_0x4110(_0xc20846,_0x58640c){_0xc20846=_0xc20846-0x1b6;const _0x287bfe=a47_0x287b();let _0x41107c=_0x287bfe[_0xc20846];return _0x41107c;}const bcryptjs_1=__importDefault(require(a47_0x19e6d0(0x1da))),jsonwebtoken_1=__importDefault(require(a47_0x19e6d0(0x1c5))),database_1=__importDefault(require(a47_0x19e6d0(0x1c2))),config_1=require(a47_0x19e6d0(0x1ce));class AuthService{['generateToken'](_0x58f86c){const _0x1fd52e=a47_0x19e6d0;return jsonwebtoken_1[_0x1fd52e(0x1d4)]['sign'](_0x58f86c,config_1['config']['jwt']['secret'],{'expiresIn':String(config_1[_0x1fd52e(0x1b6)]['jwt'][_0x1fd52e(0x1bd)])});}async[a47_0x19e6d0(0x1be)](_0x526503){const _0x129293=a47_0x19e6d0,{username:_0xd0bf7d,password:_0x4c65c5}=_0x526503;if(_0xd0bf7d===config_1[_0x129293(0x1b6)][_0x129293(0x1c6)]['username']){const _0x270e01=await bcryptjs_1[_0x129293(0x1d4)][_0x129293(0x1cd)](_0x4c65c5,config_1[_0x129293(0x1b6)][_0x129293(0x1c6)][_0x129293(0x1d8)]);if(_0x270e01){const _0x88fb2=this['generateToken']({'id':_0x129293(0x1c6),'username':config_1[_0x129293(0x1b6)][_0x129293(0x1c6)][_0x129293(0x1ba)],'role':_0x129293(0x1c6)});return{'access_token':_0x88fb2,'role':_0x129293(0x1c6)};}}const _0x745a1c=await database_1[_0x129293(0x1d4)][_0x129293(0x1cf)][_0x129293(0x1d9)]({'where':{'username':_0xd0bf7d},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x745a1c)throw new Error(_0x129293(0x1cb));if(_0x745a1c['status']!==_0x129293(0x1c9))throw new Error(_0x129293(0x1b7));const _0x1c4461=await bcryptjs_1[_0x129293(0x1d4)][_0x129293(0x1cd)](_0x4c65c5,_0x745a1c[_0x129293(0x1d7)]);if(!_0x1c4461)throw new Error('Invalid\x20credentials');const _0x3dd8fc=this['generateToken']({'id':_0x745a1c['id'],'username':_0x745a1c[_0x129293(0x1ba)],'role':_0x129293(0x1cf)});return{'access_token':_0x3dd8fc,'role':_0x129293(0x1cf),'user':{'id':_0x745a1c['id'],'name':_0x745a1c['name'],'username':_0x745a1c[_0x129293(0x1ba)]}};}async[a47_0x19e6d0(0x1c0)](_0x42fc8d){const _0x449c58=a47_0x19e6d0;try{const _0x556beb=jsonwebtoken_1[_0x449c58(0x1d4)]['verify'](_0x42fc8d,config_1[_0x449c58(0x1b6)]['jwt'][_0x449c58(0x1d0)]);return _0x556beb;}catch(_0x5b47fb){throw new Error('Invalid\x20token');}}}exports['AuthService']=AuthService;