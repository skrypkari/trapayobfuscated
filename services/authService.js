'use strict';const a36_0x12f45a=a36_0x2664;(function(_0x108cd0,_0x4c901f){const _0x16c4ad=a36_0x2664,_0x911e66=_0x108cd0();while(!![]){try{const _0x32673e=-parseInt(_0x16c4ad(0x143))/0x1+parseInt(_0x16c4ad(0x14b))/0x2+parseInt(_0x16c4ad(0x12d))/0x3*(parseInt(_0x16c4ad(0x134))/0x4)+parseInt(_0x16c4ad(0x13b))/0x5+parseInt(_0x16c4ad(0x131))/0x6+-parseInt(_0x16c4ad(0x137))/0x7*(parseInt(_0x16c4ad(0x12e))/0x8)+-parseInt(_0x16c4ad(0x142))/0x9;if(_0x32673e===_0x4c901f)break;else _0x911e66['push'](_0x911e66['shift']());}catch(_0x209bb1){_0x911e66['push'](_0x911e66['shift']());}}}(a36_0x300a,0x8223c));function a36_0x2664(_0x5de0ed,_0x2781f2){const _0x300ab6=a36_0x300a();return a36_0x2664=function(_0x2664f4,_0x4985ec){_0x2664f4=_0x2664f4-0x127;let _0x12ccc4=_0x300ab6[_0x2664f4];return _0x12ccc4;},a36_0x2664(_0x5de0ed,_0x2781f2);}var __importDefault=this&&this[a36_0x12f45a(0x14a)]||function(_0x294ffe){const _0x371154=a36_0x12f45a;return _0x294ffe&&_0x294ffe[_0x371154(0x135)]?_0x294ffe:{'default':_0x294ffe};};Object[a36_0x12f45a(0x141)](exports,'__esModule',{'value':!![]}),exports[a36_0x12f45a(0x127)]=void 0x0;const bcryptjs_1=__importDefault(require(a36_0x12f45a(0x145))),jsonwebtoken_1=__importDefault(require(a36_0x12f45a(0x133))),database_1=__importDefault(require(a36_0x12f45a(0x149))),config_1=require(a36_0x12f45a(0x13d));function a36_0x300a(){const _0x528c14=['config','password','expiresIn','generateToken','1623itPjEt','18584cyxFpI','passwordHash','shop','540396ufFFFz','secret','jsonwebtoken','4204JaZDly','__esModule','jwt','364jSyJNM','status','name','login','2875410TlggnC','Invalid\x20token','../config/config','verifyToken','ACTIVE','Invalid\x20credentials','defineProperty','8557551gMronB','191809lSOmLp','compare','bcryptjs','sign','default','username','../config/database','__importDefault','1125514jpxcQG','AuthService','admin'];a36_0x300a=function(){return _0x528c14;};return a36_0x300a();}class AuthService{['generateToken'](_0x351968){const _0x15e594=a36_0x12f45a;return jsonwebtoken_1[_0x15e594(0x147)][_0x15e594(0x146)](_0x351968,config_1['config']['jwt'][_0x15e594(0x132)],{'expiresIn':String(config_1[_0x15e594(0x129)][_0x15e594(0x136)][_0x15e594(0x12b)])});}async[a36_0x12f45a(0x13a)](_0x55ac9c){const _0x2eadff=a36_0x12f45a,{username:_0x458aca,password:_0x2a84d1}=_0x55ac9c;if(_0x458aca===config_1[_0x2eadff(0x129)][_0x2eadff(0x128)][_0x2eadff(0x148)]){const _0x5afcd9=await bcryptjs_1[_0x2eadff(0x147)][_0x2eadff(0x144)](_0x2a84d1,config_1[_0x2eadff(0x129)][_0x2eadff(0x128)][_0x2eadff(0x12f)]);if(_0x5afcd9){const _0x1828ab=this[_0x2eadff(0x12c)]({'id':_0x2eadff(0x128),'username':config_1[_0x2eadff(0x129)][_0x2eadff(0x128)]['username'],'role':_0x2eadff(0x128)});return{'access_token':_0x1828ab,'role':_0x2eadff(0x128)};}}const _0x23a752=await database_1['default'][_0x2eadff(0x130)]['findUnique']({'where':{'username':_0x458aca},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x23a752)throw new Error('Invalid\x20credentials');if(_0x23a752[_0x2eadff(0x138)]!==_0x2eadff(0x13f))throw new Error('Account\x20is\x20not\x20active');const _0x2e1d66=await bcryptjs_1['default'][_0x2eadff(0x144)](_0x2a84d1,_0x23a752[_0x2eadff(0x12a)]);if(!_0x2e1d66)throw new Error(_0x2eadff(0x140));const _0x5353fd=this[_0x2eadff(0x12c)]({'id':_0x23a752['id'],'username':_0x23a752['username'],'role':_0x2eadff(0x130)});return{'access_token':_0x5353fd,'role':_0x2eadff(0x130),'user':{'id':_0x23a752['id'],'name':_0x23a752[_0x2eadff(0x139)],'username':_0x23a752['username']}};}async[a36_0x12f45a(0x13e)](_0x5e4299){const _0x1be129=a36_0x12f45a;try{const _0x4ad154=jsonwebtoken_1['default']['verify'](_0x5e4299,config_1[_0x1be129(0x129)][_0x1be129(0x136)][_0x1be129(0x132)]);return _0x4ad154;}catch(_0x3fffc3){throw new Error(_0x1be129(0x13c));}}}exports[a36_0x12f45a(0x127)]=AuthService;