'use strict';const a36_0x99abe7=a36_0x1fd2;(function(_0x4c9dcc,_0x46df6a){const _0x478fe3=a36_0x1fd2,_0x4f731f=_0x4c9dcc();while(!![]){try{const _0x4e6ff6=parseInt(_0x478fe3(0x1be))/0x1+-parseInt(_0x478fe3(0x19f))/0x2+parseInt(_0x478fe3(0x1b5))/0x3*(-parseInt(_0x478fe3(0x1b8))/0x4)+parseInt(_0x478fe3(0x1bc))/0x5*(-parseInt(_0x478fe3(0x1a7))/0x6)+parseInt(_0x478fe3(0x1bd))/0x7*(-parseInt(_0x478fe3(0x1b0))/0x8)+parseInt(_0x478fe3(0x1a0))/0x9*(-parseInt(_0x478fe3(0x1b1))/0xa)+-parseInt(_0x478fe3(0x1b3))/0xb*(-parseInt(_0x478fe3(0x1ad))/0xc);if(_0x4e6ff6===_0x46df6a)break;else _0x4f731f['push'](_0x4f731f['shift']());}catch(_0x557938){_0x4f731f['push'](_0x4f731f['shift']());}}}(a36_0x3ee7,0x3326a));function a36_0x1fd2(_0x4626d6,_0x53fde2){const _0x3ee740=a36_0x3ee7();return a36_0x1fd2=function(_0x1fd25e,_0xfbcc64){_0x1fd25e=_0x1fd25e-0x19d;let _0x4efb0a=_0x3ee740[_0x1fd25e];return _0x4efb0a;},a36_0x1fd2(_0x4626d6,_0x53fde2);}var __importDefault=this&&this[a36_0x99abe7(0x1c2)]||function(_0xbc4772){return _0xbc4772&&_0xbc4772['__esModule']?_0xbc4772:{'default':_0xbc4772};};Object[a36_0x99abe7(0x1bb)](exports,a36_0x99abe7(0x1c4),{'value':!![]}),exports[a36_0x99abe7(0x19e)]=void 0x0;function a36_0x3ee7(){const _0x2600bb=['secret','generateToken','findUnique','password','expiresIn','12EPaMRf','ACTIVE','Account\x20is\x20not\x20active','248WiZyzA','20gQaQjC','login','7658893lYHXMj','username','321vjxHLT','verify','../config/database','2708BxfJbT','config','verifyToken','defineProperty','718535LIEIrv','16205DDrnVc','150016ajqOQy','../config/config','default','status','__importDefault','passwordHash','__esModule','bcryptjs','AuthService','624760bdXspB','164133ANjLyD','sign','Invalid\x20credentials','Invalid\x20token','admin','jwt','shop','6pTCQnm'];a36_0x3ee7=function(){return _0x2600bb;};return a36_0x3ee7();}const bcryptjs_1=__importDefault(require(a36_0x99abe7(0x19d))),jsonwebtoken_1=__importDefault(require('jsonwebtoken')),database_1=__importDefault(require(a36_0x99abe7(0x1b7))),config_1=require(a36_0x99abe7(0x1bf));class AuthService{['generateToken'](_0x59a9cf){const _0x369994=a36_0x99abe7;return jsonwebtoken_1[_0x369994(0x1c0)][_0x369994(0x1a1)](_0x59a9cf,config_1['config'][_0x369994(0x1a5)][_0x369994(0x1a8)],{'expiresIn':String(config_1[_0x369994(0x1b9)][_0x369994(0x1a5)][_0x369994(0x1ac)])});}async[a36_0x99abe7(0x1b2)](_0x165719){const _0x5eb52c=a36_0x99abe7,{username:_0x4a00fb,password:_0x5191a8}=_0x165719;if(_0x4a00fb===config_1[_0x5eb52c(0x1b9)][_0x5eb52c(0x1a4)]['username']){const _0x2738af=await bcryptjs_1[_0x5eb52c(0x1c0)]['compare'](_0x5191a8,config_1[_0x5eb52c(0x1b9)][_0x5eb52c(0x1a4)][_0x5eb52c(0x1c3)]);if(_0x2738af){const _0x1138ae=this['generateToken']({'id':_0x5eb52c(0x1a4),'username':config_1['config'][_0x5eb52c(0x1a4)][_0x5eb52c(0x1b4)],'role':_0x5eb52c(0x1a4)});return{'access_token':_0x1138ae,'role':_0x5eb52c(0x1a4)};}}const _0x12ab91=await database_1[_0x5eb52c(0x1c0)]['shop'][_0x5eb52c(0x1aa)]({'where':{'username':_0x4a00fb},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x12ab91)throw new Error(_0x5eb52c(0x1a2));if(_0x12ab91[_0x5eb52c(0x1c1)]!==_0x5eb52c(0x1ae))throw new Error(_0x5eb52c(0x1af));const _0x4176bc=await bcryptjs_1[_0x5eb52c(0x1c0)]['compare'](_0x5191a8,_0x12ab91[_0x5eb52c(0x1ab)]);if(!_0x4176bc)throw new Error('Invalid\x20credentials');const _0xd3d6a1=this[_0x5eb52c(0x1a9)]({'id':_0x12ab91['id'],'username':_0x12ab91[_0x5eb52c(0x1b4)],'role':'shop'});return{'access_token':_0xd3d6a1,'role':_0x5eb52c(0x1a6),'user':{'id':_0x12ab91['id'],'name':_0x12ab91['name'],'username':_0x12ab91['username']}};}async[a36_0x99abe7(0x1ba)](_0x254e72){const _0x19c8f4=a36_0x99abe7;try{const _0x486351=jsonwebtoken_1[_0x19c8f4(0x1c0)][_0x19c8f4(0x1b6)](_0x254e72,config_1[_0x19c8f4(0x1b9)][_0x19c8f4(0x1a5)][_0x19c8f4(0x1a8)]);return _0x486351;}catch(_0x3e954f){throw new Error(_0x19c8f4(0x1a3));}}}exports[a36_0x99abe7(0x19e)]=AuthService;