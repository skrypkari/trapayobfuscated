'use strict';const a39_0x79627c=a39_0x447c;(function(_0x5f15d8,_0x59fe7b){const _0xe5c4f3=a39_0x447c,_0x5c08e9=_0x5f15d8();while(!![]){try{const _0x2d3d10=-parseInt(_0xe5c4f3(0x1ba))/0x1+-parseInt(_0xe5c4f3(0x1c4))/0x2*(parseInt(_0xe5c4f3(0x1bd))/0x3)+-parseInt(_0xe5c4f3(0x1ca))/0x4+parseInt(_0xe5c4f3(0x1b7))/0x5+-parseInt(_0xe5c4f3(0x1c1))/0x6*(-parseInt(_0xe5c4f3(0x1b8))/0x7)+parseInt(_0xe5c4f3(0x1bc))/0x8+parseInt(_0xe5c4f3(0x1b9))/0x9*(parseInt(_0xe5c4f3(0x1bf))/0xa);if(_0x2d3d10===_0x59fe7b)break;else _0x5c08e9['push'](_0x5c08e9['shift']());}catch(_0x158be8){_0x5c08e9['push'](_0x5c08e9['shift']());}}}(a39_0x1ca0,0xdf8fa));function a39_0x1ca0(){const _0x3caed8=['config','expiresIn','sign','status','login','name','AuthService','passwordHash','__esModule','secret','username','3123915GEawvp','124565ZalQtX','1951407sLSEAX','356186vsFkmW','__importDefault','5919992QtEKEb','2443275YwYxvA','Invalid\x20credentials','30WIqpHh','shop','66vrbvWK','jwt','../config/config','2XPeZvk','compare','Invalid\x20token','generateToken','findUnique','verifyToken','498716KbmleW','admin','jsonwebtoken','default','../config/database'];a39_0x1ca0=function(){return _0x3caed8;};return a39_0x1ca0();}function a39_0x447c(_0x348e31,_0x5bd41e){const _0x1ca03c=a39_0x1ca0();return a39_0x447c=function(_0x447c7b,_0x3648d0){_0x447c7b=_0x447c7b-0x1b1;let _0x4a4836=_0x1ca03c[_0x447c7b];return _0x4a4836;},a39_0x447c(_0x348e31,_0x5bd41e);}var __importDefault=this&&this[a39_0x79627c(0x1bb)]||function(_0x20f064){const _0x23be3f=a39_0x79627c;return _0x20f064&&_0x20f064[_0x23be3f(0x1b4)]?_0x20f064:{'default':_0x20f064};};Object['defineProperty'](exports,a39_0x79627c(0x1b4),{'value':!![]}),exports[a39_0x79627c(0x1b2)]=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),jsonwebtoken_1=__importDefault(require(a39_0x79627c(0x1cc))),database_1=__importDefault(require(a39_0x79627c(0x1ce))),config_1=require(a39_0x79627c(0x1c3));class AuthService{[a39_0x79627c(0x1c7)](_0x19dca9){const _0x11e9ae=a39_0x79627c;return jsonwebtoken_1[_0x11e9ae(0x1cd)][_0x11e9ae(0x1d1)](_0x19dca9,config_1[_0x11e9ae(0x1cf)][_0x11e9ae(0x1c2)][_0x11e9ae(0x1b5)],{'expiresIn':String(config_1[_0x11e9ae(0x1cf)]['jwt'][_0x11e9ae(0x1d0)])});}async[a39_0x79627c(0x1d3)](_0x23b807){const _0x2d9a87=a39_0x79627c,{username:_0x5af7d5,password:_0x5426a6}=_0x23b807;if(_0x5af7d5===config_1[_0x2d9a87(0x1cf)][_0x2d9a87(0x1cb)][_0x2d9a87(0x1b6)]){const _0x3c29cd=await bcryptjs_1[_0x2d9a87(0x1cd)]['compare'](_0x5426a6,config_1[_0x2d9a87(0x1cf)][_0x2d9a87(0x1cb)][_0x2d9a87(0x1b3)]);if(_0x3c29cd){const _0x352d49=this[_0x2d9a87(0x1c7)]({'id':_0x2d9a87(0x1cb),'username':config_1[_0x2d9a87(0x1cf)]['admin'][_0x2d9a87(0x1b6)],'role':_0x2d9a87(0x1cb)});return{'access_token':_0x352d49,'role':_0x2d9a87(0x1cb)};}}const _0x597b97=await database_1[_0x2d9a87(0x1cd)][_0x2d9a87(0x1c0)][_0x2d9a87(0x1c8)]({'where':{'username':_0x5af7d5},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x597b97)throw new Error(_0x2d9a87(0x1be));if(_0x597b97[_0x2d9a87(0x1d2)]!=='ACTIVE')throw new Error('Account\x20is\x20not\x20active');const _0x231bbb=await bcryptjs_1['default'][_0x2d9a87(0x1c5)](_0x5426a6,_0x597b97['password']);if(!_0x231bbb)throw new Error(_0x2d9a87(0x1be));const _0x3d1160=this['generateToken']({'id':_0x597b97['id'],'username':_0x597b97[_0x2d9a87(0x1b6)],'role':_0x2d9a87(0x1c0)});return{'access_token':_0x3d1160,'role':_0x2d9a87(0x1c0),'user':{'id':_0x597b97['id'],'name':_0x597b97[_0x2d9a87(0x1b1)],'username':_0x597b97[_0x2d9a87(0x1b6)]}};}async[a39_0x79627c(0x1c9)](_0x2d5323){const _0x2de5c8=a39_0x79627c;try{const _0x56ed67=jsonwebtoken_1['default']['verify'](_0x2d5323,config_1['config'][_0x2de5c8(0x1c2)][_0x2de5c8(0x1b5)]);return _0x56ed67;}catch(_0x488725){throw new Error(_0x2de5c8(0x1c6));}}}exports[a39_0x79627c(0x1b2)]=AuthService;