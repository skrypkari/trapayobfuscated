'use strict';const a34_0x2d6b8b=a34_0x2bbd;(function(_0xd61022,_0x3db9f8){const _0x2236c0=a34_0x2bbd,_0x4b2ebd=_0xd61022();while(!![]){try{const _0x1258f4=-parseInt(_0x2236c0(0x184))/0x1*(-parseInt(_0x2236c0(0x19b))/0x2)+-parseInt(_0x2236c0(0x185))/0x3+-parseInt(_0x2236c0(0x188))/0x4+-parseInt(_0x2236c0(0x182))/0x5*(parseInt(_0x2236c0(0x18a))/0x6)+-parseInt(_0x2236c0(0x189))/0x7*(parseInt(_0x2236c0(0x18d))/0x8)+-parseInt(_0x2236c0(0x196))/0x9*(-parseInt(_0x2236c0(0x181))/0xa)+parseInt(_0x2236c0(0x179))/0xb;if(_0x1258f4===_0x3db9f8)break;else _0x4b2ebd['push'](_0x4b2ebd['shift']());}catch(_0x36a9fd){_0x4b2ebd['push'](_0x4b2ebd['shift']());}}}(a34_0x141e,0x4d845));var __importDefault=this&&this[a34_0x2d6b8b(0x17d)]||function(_0x3ff155){const _0x444500=a34_0x2d6b8b;return _0x3ff155&&_0x3ff155[_0x444500(0x193)]?_0x3ff155:{'default':_0x3ff155};};Object[a34_0x2d6b8b(0x17a)](exports,a34_0x2d6b8b(0x193),{'value':!![]}),exports['AuthService']=void 0x0;const bcryptjs_1=__importDefault(require(a34_0x2d6b8b(0x190))),jsonwebtoken_1=__importDefault(require(a34_0x2d6b8b(0x198))),database_1=__importDefault(require(a34_0x2d6b8b(0x18c))),config_1=require('../config/config');function a34_0x141e(){const _0x4552b9=['Invalid\x20credentials','secret','shop','580eOxHdN','18545BTjgpJ','config','5YWKPLK','731835AeBgat','generateToken','verifyToken','374368yBWzWU','1946357hAKoyn','84gppxOX','AuthService','../config/database','8fglluc','password','ACTIVE','bcryptjs','passwordHash','findUnique','__esModule','verify','status','35622SphrCm','expiresIn','jsonwebtoken','default','username','171494DtJlNh','3593964zYwRsk','defineProperty','admin','jwt','__importDefault'];a34_0x141e=function(){return _0x4552b9;};return a34_0x141e();}class AuthService{['generateToken'](_0x56a26e){const _0x47cd41=a34_0x2d6b8b;return jsonwebtoken_1[_0x47cd41(0x199)]['sign'](_0x56a26e,config_1[_0x47cd41(0x183)][_0x47cd41(0x17c)]['secret'],{'expiresIn':String(config_1[_0x47cd41(0x183)][_0x47cd41(0x17c)][_0x47cd41(0x197)])});}async['login'](_0x226e02){const _0x20e761=a34_0x2d6b8b,{username:_0x44747c,password:_0x8fce74}=_0x226e02;if(_0x44747c===config_1[_0x20e761(0x183)][_0x20e761(0x17b)]['username']){const _0x2b8e46=await bcryptjs_1[_0x20e761(0x199)]['compare'](_0x8fce74,config_1[_0x20e761(0x183)][_0x20e761(0x17b)][_0x20e761(0x191)]);if(_0x2b8e46){const _0x44221e=this[_0x20e761(0x186)]({'id':_0x20e761(0x17b),'username':config_1[_0x20e761(0x183)][_0x20e761(0x17b)][_0x20e761(0x19a)],'role':_0x20e761(0x17b)});return{'access_token':_0x44221e,'role':'admin'};}}const _0xcacfdc=await database_1[_0x20e761(0x199)][_0x20e761(0x180)][_0x20e761(0x192)]({'where':{'username':_0x44747c},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0xcacfdc)throw new Error('Invalid\x20credentials');if(_0xcacfdc[_0x20e761(0x195)]!==_0x20e761(0x18f))throw new Error('Account\x20is\x20not\x20active');const _0x182e27=await bcryptjs_1[_0x20e761(0x199)]['compare'](_0x8fce74,_0xcacfdc[_0x20e761(0x18e)]);if(!_0x182e27)throw new Error(_0x20e761(0x17e));const _0x227a37=this[_0x20e761(0x186)]({'id':_0xcacfdc['id'],'username':_0xcacfdc[_0x20e761(0x19a)],'role':_0x20e761(0x180)});return{'access_token':_0x227a37,'role':_0x20e761(0x180),'user':{'id':_0xcacfdc['id'],'name':_0xcacfdc['name'],'username':_0xcacfdc[_0x20e761(0x19a)]}};}async[a34_0x2d6b8b(0x187)](_0x1d4d8f){const _0x43d3a7=a34_0x2d6b8b;try{const _0x3a069b=jsonwebtoken_1['default'][_0x43d3a7(0x194)](_0x1d4d8f,config_1[_0x43d3a7(0x183)]['jwt'][_0x43d3a7(0x17f)]);return _0x3a069b;}catch(_0x40c501){throw new Error('Invalid\x20token');}}}function a34_0x2bbd(_0x1d9bd1,_0x181fe8){const _0x141e98=a34_0x141e();return a34_0x2bbd=function(_0x2bbde6,_0x34ee8c){_0x2bbde6=_0x2bbde6-0x179;let _0x3951c2=_0x141e98[_0x2bbde6];return _0x3951c2;},a34_0x2bbd(_0x1d9bd1,_0x181fe8);}exports[a34_0x2d6b8b(0x18b)]=AuthService;