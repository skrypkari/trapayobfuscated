'use strict';const a36_0x124b02=a36_0x1105;function a36_0x3792(){const _0x5302e4=['623965pOFFOJ','status','admin','141324xzbKEE','jwt','username','config','__importDefault','expiresIn','shop','8mQNUIY','default','173744GuojTl','10893552UgiUeW','generateToken','../config/database','5541AzPUjU','AuthService','../config/config','11LzRRzs','71712TYrASg','Account\x20is\x20not\x20active','152Ufahmg','ACTIVE','Invalid\x20token','Invalid\x20credentials','compare','414280qPTMEP','84AbBWxh','296DAkSJS','bcryptjs','verifyToken','findUnique','secret','defineProperty','__esModule','sign','passwordHash'];a36_0x3792=function(){return _0x5302e4;};return a36_0x3792();}(function(_0xd24437,_0x21b9a8){const _0x22b4ba=a36_0x1105,_0x438968=_0xd24437();while(!![]){try{const _0x95bb0f=parseInt(_0x22b4ba(0x136))/0x1+parseInt(_0x22b4ba(0x121))/0x2*(parseInt(_0x22b4ba(0x13a))/0x3)+parseInt(_0x22b4ba(0x134))/0x4*(parseInt(_0x22b4ba(0x12a))/0x5)+-parseInt(_0x22b4ba(0x12d))/0x6*(-parseInt(_0x22b4ba(0x120))/0x7)+parseInt(_0x22b4ba(0x140))/0x8*(parseInt(_0x22b4ba(0x13e))/0x9)+-parseInt(_0x22b4ba(0x11f))/0xa*(-parseInt(_0x22b4ba(0x13d))/0xb)+-parseInt(_0x22b4ba(0x137))/0xc;if(_0x95bb0f===_0x21b9a8)break;else _0x438968['push'](_0x438968['shift']());}catch(_0x578bf5){_0x438968['push'](_0x438968['shift']());}}}(a36_0x3792,0x408a6));var __importDefault=this&&this[a36_0x124b02(0x131)]||function(_0x542a26){const _0x251710=a36_0x124b02;return _0x542a26&&_0x542a26[_0x251710(0x127)]?_0x542a26:{'default':_0x542a26};};function a36_0x1105(_0x112b4c,_0x5e4aa6){const _0x379264=a36_0x3792();return a36_0x1105=function(_0x11059f,_0x462f37){_0x11059f=_0x11059f-0x11e;let _0x23c219=_0x379264[_0x11059f];return _0x23c219;},a36_0x1105(_0x112b4c,_0x5e4aa6);}Object[a36_0x124b02(0x126)](exports,'__esModule',{'value':!![]}),exports[a36_0x124b02(0x13b)]=void 0x0;const bcryptjs_1=__importDefault(require(a36_0x124b02(0x122))),jsonwebtoken_1=__importDefault(require('jsonwebtoken')),database_1=__importDefault(require(a36_0x124b02(0x139))),config_1=require(a36_0x124b02(0x13c));class AuthService{[a36_0x124b02(0x138)](_0x426ef3){const _0x38a85c=a36_0x124b02;return jsonwebtoken_1['default'][_0x38a85c(0x128)](_0x426ef3,config_1[_0x38a85c(0x130)][_0x38a85c(0x12e)][_0x38a85c(0x125)],{'expiresIn':String(config_1[_0x38a85c(0x130)][_0x38a85c(0x12e)][_0x38a85c(0x132)])});}async['login'](_0x2e9b06){const _0x48db7e=a36_0x124b02,{username:_0x54ae1e,password:_0x32007d}=_0x2e9b06;if(_0x54ae1e===config_1[_0x48db7e(0x130)][_0x48db7e(0x12c)][_0x48db7e(0x12f)]){const _0x3d46f0=await bcryptjs_1[_0x48db7e(0x135)][_0x48db7e(0x11e)](_0x32007d,config_1[_0x48db7e(0x130)][_0x48db7e(0x12c)][_0x48db7e(0x129)]);if(_0x3d46f0){const _0x597ef0=this[_0x48db7e(0x138)]({'id':'admin','username':config_1[_0x48db7e(0x130)][_0x48db7e(0x12c)][_0x48db7e(0x12f)],'role':_0x48db7e(0x12c)});return{'access_token':_0x597ef0,'role':'admin'};}}const _0x92429=await database_1[_0x48db7e(0x135)][_0x48db7e(0x133)][_0x48db7e(0x124)]({'where':{'username':_0x54ae1e},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x92429)throw new Error('Invalid\x20credentials');if(_0x92429[_0x48db7e(0x12b)]!==_0x48db7e(0x141))throw new Error(_0x48db7e(0x13f));const _0x2c7bc2=await bcryptjs_1[_0x48db7e(0x135)]['compare'](_0x32007d,_0x92429['password']);if(!_0x2c7bc2)throw new Error(_0x48db7e(0x143));const _0x2471dc=this['generateToken']({'id':_0x92429['id'],'username':_0x92429[_0x48db7e(0x12f)],'role':_0x48db7e(0x133)});return{'access_token':_0x2471dc,'role':'shop','user':{'id':_0x92429['id'],'name':_0x92429['name'],'username':_0x92429[_0x48db7e(0x12f)]}};}async[a36_0x124b02(0x123)](_0x529c1b){const _0x37943a=a36_0x124b02;try{const _0x16ebb8=jsonwebtoken_1['default']['verify'](_0x529c1b,config_1['config'][_0x37943a(0x12e)][_0x37943a(0x125)]);return _0x16ebb8;}catch(_0xc0a908){throw new Error(_0x37943a(0x142));}}}exports[a36_0x124b02(0x13b)]=AuthService;