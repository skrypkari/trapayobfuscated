'use strict';const a39_0xdc8765=a39_0x325f;(function(_0x2eee23,_0x595102){const _0x273648=a39_0x325f,_0x22ede9=_0x2eee23();while(!![]){try{const _0x101676=-parseInt(_0x273648(0xdf))/0x1+-parseInt(_0x273648(0xf8))/0x2*(-parseInt(_0x273648(0xea))/0x3)+-parseInt(_0x273648(0xf3))/0x4*(parseInt(_0x273648(0xe1))/0x5)+parseInt(_0x273648(0xf6))/0x6+-parseInt(_0x273648(0xe8))/0x7+parseInt(_0x273648(0xe3))/0x8+parseInt(_0x273648(0xd9))/0x9;if(_0x101676===_0x595102)break;else _0x22ede9['push'](_0x22ede9['shift']());}catch(_0x39f145){_0x22ede9['push'](_0x22ede9['shift']());}}}(a39_0x428b,0xb5f34));var __importDefault=this&&this[a39_0xdc8765(0xda)]||function(_0x5583ab){return _0x5583ab&&_0x5583ab['__esModule']?_0x5583ab:{'default':_0x5583ab};};function a39_0x428b(){const _0x1dc650=['60300aQFTkq','expiresIn','login','Invalid\x20token','default','7159356hkqAnj','__importDefault','password','username','ACTIVE','Invalid\x20credentials','664857gGBMgz','verifyToken','25oBLyei','../config/config','5416288ufCuzu','secret','name','defineProperty','generateToken','1862560qREWOm','jwt','21GaoENu','shop','Account\x20is\x20not\x20active','verify','config','AuthService','passwordHash','bcryptjs','../config/database','1125884OBhBHz','sign','compare','8399940nPYVGk','admin'];a39_0x428b=function(){return _0x1dc650;};return a39_0x428b();}Object[a39_0xdc8765(0xe6)](exports,'__esModule',{'value':!![]}),exports[a39_0xdc8765(0xef)]=void 0x0;const bcryptjs_1=__importDefault(require(a39_0xdc8765(0xf1))),jsonwebtoken_1=__importDefault(require('jsonwebtoken')),database_1=__importDefault(require(a39_0xdc8765(0xf2))),config_1=require(a39_0xdc8765(0xe2));function a39_0x325f(_0x4d9971,_0xfb0aeb){const _0x428bc1=a39_0x428b();return a39_0x325f=function(_0x325f28,_0x1d7290){_0x325f28=_0x325f28-0xd6;let _0x40e75e=_0x428bc1[_0x325f28];return _0x40e75e;},a39_0x325f(_0x4d9971,_0xfb0aeb);}class AuthService{[a39_0xdc8765(0xe7)](_0x5888dc){const _0x27a6ee=a39_0xdc8765;return jsonwebtoken_1[_0x27a6ee(0xd8)][_0x27a6ee(0xf4)](_0x5888dc,config_1[_0x27a6ee(0xee)][_0x27a6ee(0xe9)][_0x27a6ee(0xe4)],{'expiresIn':String(config_1[_0x27a6ee(0xee)][_0x27a6ee(0xe9)][_0x27a6ee(0xf9)])});}async[a39_0xdc8765(0xd6)](_0x25df82){const _0x4cc9b9=a39_0xdc8765,{username:_0x251a97,password:_0x40ec66}=_0x25df82;if(_0x251a97===config_1[_0x4cc9b9(0xee)][_0x4cc9b9(0xf7)][_0x4cc9b9(0xdc)]){const _0x4fef33=await bcryptjs_1[_0x4cc9b9(0xd8)][_0x4cc9b9(0xf5)](_0x40ec66,config_1[_0x4cc9b9(0xee)][_0x4cc9b9(0xf7)][_0x4cc9b9(0xf0)]);if(_0x4fef33){const _0x14e13e=this[_0x4cc9b9(0xe7)]({'id':_0x4cc9b9(0xf7),'username':config_1[_0x4cc9b9(0xee)][_0x4cc9b9(0xf7)][_0x4cc9b9(0xdc)],'role':_0x4cc9b9(0xf7)});return{'access_token':_0x14e13e,'role':_0x4cc9b9(0xf7)};}}const _0x28f4a6=await database_1[_0x4cc9b9(0xd8)]['shop']['findUnique']({'where':{'username':_0x251a97},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x28f4a6)throw new Error(_0x4cc9b9(0xde));if(_0x28f4a6['status']!==_0x4cc9b9(0xdd))throw new Error(_0x4cc9b9(0xec));const _0x182143=await bcryptjs_1[_0x4cc9b9(0xd8)][_0x4cc9b9(0xf5)](_0x40ec66,_0x28f4a6[_0x4cc9b9(0xdb)]);if(!_0x182143)throw new Error('Invalid\x20credentials');const _0x269185=this['generateToken']({'id':_0x28f4a6['id'],'username':_0x28f4a6[_0x4cc9b9(0xdc)],'role':'shop'});return{'access_token':_0x269185,'role':_0x4cc9b9(0xeb),'user':{'id':_0x28f4a6['id'],'name':_0x28f4a6[_0x4cc9b9(0xe5)],'username':_0x28f4a6['username']}};}async[a39_0xdc8765(0xe0)](_0x12c19a){const _0x162078=a39_0xdc8765;try{const _0x22640c=jsonwebtoken_1[_0x162078(0xd8)][_0x162078(0xed)](_0x12c19a,config_1[_0x162078(0xee)][_0x162078(0xe9)][_0x162078(0xe4)]);return _0x22640c;}catch(_0x10458b){throw new Error(_0x162078(0xd7));}}}exports['AuthService']=AuthService;