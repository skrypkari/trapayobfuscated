'use strict';function a36_0x51ef(_0x6e66a3,_0x4388cb){const _0x45660a=a36_0x4566();return a36_0x51ef=function(_0x51ef7b,_0x28ff05){_0x51ef7b=_0x51ef7b-0x8b;let _0x37a5bd=_0x45660a[_0x51ef7b];return _0x37a5bd;},a36_0x51ef(_0x6e66a3,_0x4388cb);}const a36_0x5e82d1=a36_0x51ef;function a36_0x4566(){const _0x3da6b9=['3931662SWlCFK','jwt','__importDefault','AuthService','config','passwordHash','default','1145LuRXIw','3393592dVktpf','Invalid\x20credentials','defineProperty','verifyToken','1159395RblOLV','2TDszTb','17128ZxdnOS','name','shop','secret','ACTIVE','expiresIn','sign','admin','../config/database','90510BxDkAJ','login','3323268lVxONi','generateToken','Account\x20is\x20not\x20active','status','__esModule','22035510ncrioY','username'];a36_0x4566=function(){return _0x3da6b9;};return a36_0x4566();}(function(_0x51ea40,_0xad57fa){const _0x37692e=a36_0x51ef,_0x50c766=_0x51ea40();while(!![]){try{const _0x586cf0=-parseInt(_0x37692e(0xa3))/0x1+-parseInt(_0x37692e(0xa4))/0x2*(-parseInt(_0x37692e(0x8e))/0x3)+-parseInt(_0x37692e(0xa5))/0x4*(parseInt(_0x37692e(0x9e))/0x5)+parseInt(_0x37692e(0x90))/0x6+-parseInt(_0x37692e(0x97))/0x7+parseInt(_0x37692e(0x9f))/0x8+parseInt(_0x37692e(0x95))/0x9;if(_0x586cf0===_0xad57fa)break;else _0x50c766['push'](_0x50c766['shift']());}catch(_0x171d81){_0x50c766['push'](_0x50c766['shift']());}}}(a36_0x4566,0xb8536));var __importDefault=this&&this[a36_0x5e82d1(0x99)]||function(_0x4bad5c){const _0x2d14d1=a36_0x5e82d1;return _0x4bad5c&&_0x4bad5c[_0x2d14d1(0x94)]?_0x4bad5c:{'default':_0x4bad5c};};Object[a36_0x5e82d1(0xa1)](exports,a36_0x5e82d1(0x94),{'value':!![]}),exports['AuthService']=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),jsonwebtoken_1=__importDefault(require('jsonwebtoken')),database_1=__importDefault(require(a36_0x5e82d1(0x8d))),config_1=require('../config/config');class AuthService{[a36_0x5e82d1(0x91)](_0x38039f){const _0x54299a=a36_0x5e82d1;return jsonwebtoken_1[_0x54299a(0x9d)][_0x54299a(0x8b)](_0x38039f,config_1[_0x54299a(0x9b)]['jwt']['secret'],{'expiresIn':String(config_1[_0x54299a(0x9b)][_0x54299a(0x98)][_0x54299a(0xaa)])});}async[a36_0x5e82d1(0x8f)](_0x440671){const _0x28348f=a36_0x5e82d1,{username:_0x4f5e9d,password:_0x36b074}=_0x440671;if(_0x4f5e9d===config_1[_0x28348f(0x9b)]['admin'][_0x28348f(0x96)]){const _0x320725=await bcryptjs_1[_0x28348f(0x9d)]['compare'](_0x36b074,config_1['config'][_0x28348f(0x8c)][_0x28348f(0x9c)]);if(_0x320725){const _0xfe677b=this['generateToken']({'id':_0x28348f(0x8c),'username':config_1[_0x28348f(0x9b)][_0x28348f(0x8c)][_0x28348f(0x96)],'role':_0x28348f(0x8c)});return{'access_token':_0xfe677b,'role':_0x28348f(0x8c)};}}const _0x3b8cf1=await database_1[_0x28348f(0x9d)][_0x28348f(0xa7)]['findUnique']({'where':{'username':_0x4f5e9d},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x3b8cf1)throw new Error(_0x28348f(0xa0));if(_0x3b8cf1[_0x28348f(0x93)]!==_0x28348f(0xa9))throw new Error(_0x28348f(0x92));const _0x49746f=await bcryptjs_1['default']['compare'](_0x36b074,_0x3b8cf1['password']);if(!_0x49746f)throw new Error(_0x28348f(0xa0));const _0x3b7afb=this['generateToken']({'id':_0x3b8cf1['id'],'username':_0x3b8cf1[_0x28348f(0x96)],'role':_0x28348f(0xa7)});return{'access_token':_0x3b7afb,'role':_0x28348f(0xa7),'user':{'id':_0x3b8cf1['id'],'name':_0x3b8cf1[_0x28348f(0xa6)],'username':_0x3b8cf1['username']}};}async[a36_0x5e82d1(0xa2)](_0x44c5a2){const _0x1b577d=a36_0x5e82d1;try{const _0x24c029=jsonwebtoken_1[_0x1b577d(0x9d)]['verify'](_0x44c5a2,config_1[_0x1b577d(0x9b)][_0x1b577d(0x98)][_0x1b577d(0xa8)]);return _0x24c029;}catch(_0x3ad347){throw new Error('Invalid\x20token');}}}exports[a36_0x5e82d1(0x9a)]=AuthService;