'use strict';function a39_0x4410(_0x193a2e,_0x390da5){const _0x1351b2=a39_0x1351();return a39_0x4410=function(_0x441016,_0x126a24){_0x441016=_0x441016-0xd5;let _0x2c0efb=_0x1351b2[_0x441016];return _0x2c0efb;},a39_0x4410(_0x193a2e,_0x390da5);}const a39_0x1806c7=a39_0x4410;(function(_0x49fcd8,_0x3ced4d){const _0x36771c=a39_0x4410,_0x3f7b87=_0x49fcd8();while(!![]){try{const _0x10d593=parseInt(_0x36771c(0xdd))/0x1*(-parseInt(_0x36771c(0xf6))/0x2)+parseInt(_0x36771c(0xe2))/0x3*(parseInt(_0x36771c(0xf8))/0x4)+parseInt(_0x36771c(0xdc))/0x5*(-parseInt(_0x36771c(0xea))/0x6)+parseInt(_0x36771c(0xe3))/0x7*(-parseInt(_0x36771c(0xe6))/0x8)+parseInt(_0x36771c(0xf3))/0x9+-parseInt(_0x36771c(0xd7))/0xa*(-parseInt(_0x36771c(0xed))/0xb)+-parseInt(_0x36771c(0xe0))/0xc;if(_0x10d593===_0x3ced4d)break;else _0x3f7b87['push'](_0x3f7b87['shift']());}catch(_0x9851b1){_0x3f7b87['push'](_0x3f7b87['shift']());}}}(a39_0x1351,0x3ce0a));var __importDefault=this&&this[a39_0x1806c7(0xf4)]||function(_0xb970d){const _0x38fffb=a39_0x1806c7;return _0xb970d&&_0xb970d[_0x38fffb(0xef)]?_0xb970d:{'default':_0xb970d};};Object[a39_0x1806c7(0xd5)](exports,'__esModule',{'value':!![]}),exports[a39_0x1806c7(0xda)]=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),jsonwebtoken_1=__importDefault(require(a39_0x1806c7(0xf9))),database_1=__importDefault(require(a39_0x1806c7(0xf1))),config_1=require('../config/config');class AuthService{[a39_0x1806c7(0xe7)](_0x5eefcc){const _0x277ad3=a39_0x1806c7;return jsonwebtoken_1[_0x277ad3(0xec)]['sign'](_0x5eefcc,config_1[_0x277ad3(0xd6)][_0x277ad3(0xde)][_0x277ad3(0xe8)],{'expiresIn':String(config_1['config'][_0x277ad3(0xde)][_0x277ad3(0xee)])});}async[a39_0x1806c7(0xf7)](_0xde0028){const _0x3f5437=a39_0x1806c7,{username:_0x367bf8,password:_0x323ece}=_0xde0028;if(_0x367bf8===config_1[_0x3f5437(0xd6)]['admin']['username']){const _0x29ff3e=await bcryptjs_1[_0x3f5437(0xec)]['compare'](_0x323ece,config_1[_0x3f5437(0xd6)][_0x3f5437(0xdb)][_0x3f5437(0xf0)]);if(_0x29ff3e){const _0x1aa570=this[_0x3f5437(0xe7)]({'id':'admin','username':config_1[_0x3f5437(0xd6)][_0x3f5437(0xdb)][_0x3f5437(0xf2)],'role':_0x3f5437(0xdb)});return{'access_token':_0x1aa570,'role':_0x3f5437(0xdb)};}}const _0x9357eb=await database_1[_0x3f5437(0xec)]['shop'][_0x3f5437(0xe9)]({'where':{'username':_0x367bf8},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x9357eb)throw new Error(_0x3f5437(0xf5));if(_0x9357eb['status']!==_0x3f5437(0xe5))throw new Error('Account\x20is\x20not\x20active');const _0x2905cc=await bcryptjs_1[_0x3f5437(0xec)][_0x3f5437(0xd9)](_0x323ece,_0x9357eb[_0x3f5437(0xeb)]);if(!_0x2905cc)throw new Error(_0x3f5437(0xf5));const _0x157646=this[_0x3f5437(0xe7)]({'id':_0x9357eb['id'],'username':_0x9357eb[_0x3f5437(0xf2)],'role':_0x3f5437(0xd8)});return{'access_token':_0x157646,'role':_0x3f5437(0xd8),'user':{'id':_0x9357eb['id'],'name':_0x9357eb[_0x3f5437(0xe4)],'username':_0x9357eb[_0x3f5437(0xf2)]}};}async[a39_0x1806c7(0xdf)](_0x53a855){const _0x406fbc=a39_0x1806c7;try{const _0x9304a8=jsonwebtoken_1[_0x406fbc(0xec)][_0x406fbc(0xe1)](_0x53a855,config_1[_0x406fbc(0xd6)][_0x406fbc(0xde)][_0x406fbc(0xe8)]);return _0x9304a8;}catch(_0x5961e9){throw new Error('Invalid\x20token');}}}function a39_0x1351(){const _0x215ad2=['admin','251445iiVTPp','48193jWsthj','jwt','verifyToken','2974608ojdqBJ','verify','1368lXSIMw','1204ZvNwGw','name','ACTIVE','112dWZSMV','generateToken','secret','findUnique','24xoFbkc','password','default','11wgJicv','expiresIn','__esModule','passwordHash','../config/database','username','1278126vcqSCK','__importDefault','Invalid\x20credentials','6jNnidA','login','3992jaaYsZ','jsonwebtoken','defineProperty','config','2482790VvLrLE','shop','compare','AuthService'];a39_0x1351=function(){return _0x215ad2;};return a39_0x1351();}exports[a39_0x1806c7(0xda)]=AuthService;