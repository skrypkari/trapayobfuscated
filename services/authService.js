'use strict';function a41_0x5461(_0x325e17,_0x451f27){const _0x2022f9=a41_0x2022();return a41_0x5461=function(_0x546101,_0x185e9e){_0x546101=_0x546101-0x19d;let _0x1c9493=_0x2022f9[_0x546101];return _0x1c9493;},a41_0x5461(_0x325e17,_0x451f27);}const a41_0x3b04c0=a41_0x5461;(function(_0x1e2c12,_0x4031be){const _0x19ea24=a41_0x5461,_0x7ea2fb=_0x1e2c12();while(!![]){try{const _0xe0791a=parseInt(_0x19ea24(0x1bf))/0x1+-parseInt(_0x19ea24(0x1b7))/0x2+-parseInt(_0x19ea24(0x1bc))/0x3*(-parseInt(_0x19ea24(0x1ba))/0x4)+-parseInt(_0x19ea24(0x1a6))/0x5+-parseInt(_0x19ea24(0x19d))/0x6*(parseInt(_0x19ea24(0x1a8))/0x7)+-parseInt(_0x19ea24(0x1a7))/0x8+parseInt(_0x19ea24(0x1ac))/0x9;if(_0xe0791a===_0x4031be)break;else _0x7ea2fb['push'](_0x7ea2fb['shift']());}catch(_0x1e7171){_0x7ea2fb['push'](_0x7ea2fb['shift']());}}}(a41_0x2022,0x71e77));var __importDefault=this&&this[a41_0x3b04c0(0x1b4)]||function(_0x29d19c){return _0x29d19c&&_0x29d19c['__esModule']?_0x29d19c:{'default':_0x29d19c};};Object[a41_0x3b04c0(0x1b9)](exports,a41_0x3b04c0(0x1b3),{'value':!![]}),exports['AuthService']=void 0x0;function a41_0x2022(){const _0xdb5643=['config','findUnique','verifyToken','896265nemZvH','7296424aNURie','4816EnhUVq','AuthService','bcryptjs','shop','9024597AGkPtn','expiresIn','login','name','compare','verify','Invalid\x20token','__esModule','__importDefault','Account\x20is\x20not\x20active','ACTIVE','814736SSZhDf','default','defineProperty','112WQJSzt','admin','94803CwywHq','secret','username','724384PlDBQX','passwordHash','password','5640ghjYWD','generateToken','Invalid\x20credentials','jwt','../config/config','status'];a41_0x2022=function(){return _0xdb5643;};return a41_0x2022();}const bcryptjs_1=__importDefault(require(a41_0x3b04c0(0x1aa))),jsonwebtoken_1=__importDefault(require('jsonwebtoken')),database_1=__importDefault(require('../config/database')),config_1=require(a41_0x3b04c0(0x1a1));class AuthService{[a41_0x3b04c0(0x19e)](_0xd0c10c){const _0x1eb27a=a41_0x3b04c0;return jsonwebtoken_1[_0x1eb27a(0x1b8)]['sign'](_0xd0c10c,config_1[_0x1eb27a(0x1a3)][_0x1eb27a(0x1a0)][_0x1eb27a(0x1bd)],{'expiresIn':String(config_1['config']['jwt'][_0x1eb27a(0x1ad)])});}async[a41_0x3b04c0(0x1ae)](_0x2e65c){const _0x3960da=a41_0x3b04c0,{username:_0xe7a217,password:_0xa75cb0}=_0x2e65c;if(_0xe7a217===config_1[_0x3960da(0x1a3)][_0x3960da(0x1bb)]['username']){const _0x177ff6=await bcryptjs_1['default']['compare'](_0xa75cb0,config_1[_0x3960da(0x1a3)][_0x3960da(0x1bb)][_0x3960da(0x1c0)]);if(_0x177ff6){const _0x3c471a=this['generateToken']({'id':_0x3960da(0x1bb),'username':config_1[_0x3960da(0x1a3)][_0x3960da(0x1bb)][_0x3960da(0x1be)],'role':_0x3960da(0x1bb)});return{'access_token':_0x3c471a,'role':_0x3960da(0x1bb)};}}const _0x1ce1b2=await database_1[_0x3960da(0x1b8)][_0x3960da(0x1ab)][_0x3960da(0x1a4)]({'where':{'username':_0xe7a217},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x1ce1b2)throw new Error('Invalid\x20credentials');if(_0x1ce1b2[_0x3960da(0x1a2)]!==_0x3960da(0x1b6))throw new Error(_0x3960da(0x1b5));const _0x5dc0f3=await bcryptjs_1[_0x3960da(0x1b8)][_0x3960da(0x1b0)](_0xa75cb0,_0x1ce1b2[_0x3960da(0x1c1)]);if(!_0x5dc0f3)throw new Error(_0x3960da(0x19f));const _0x2f2f40=this['generateToken']({'id':_0x1ce1b2['id'],'username':_0x1ce1b2['username'],'role':_0x3960da(0x1ab)});return{'access_token':_0x2f2f40,'role':_0x3960da(0x1ab),'user':{'id':_0x1ce1b2['id'],'name':_0x1ce1b2[_0x3960da(0x1af)],'username':_0x1ce1b2['username']}};}async[a41_0x3b04c0(0x1a5)](_0x426e49){const _0x1777d0=a41_0x3b04c0;try{const _0x3780f4=jsonwebtoken_1[_0x1777d0(0x1b8)][_0x1777d0(0x1b1)](_0x426e49,config_1[_0x1777d0(0x1a3)][_0x1777d0(0x1a0)]['secret']);return _0x3780f4;}catch(_0x506887){throw new Error(_0x1777d0(0x1b2));}}}exports[a41_0x3b04c0(0x1a9)]=AuthService;