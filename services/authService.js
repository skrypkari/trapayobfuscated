'use strict';const a36_0x5887ee=a36_0x1df5;(function(_0x4c8ccc,_0x523566){const _0x5326c5=a36_0x1df5,_0xb34615=_0x4c8ccc();while(!![]){try{const _0x411cc5=-parseInt(_0x5326c5(0x7b))/0x1+-parseInt(_0x5326c5(0x6a))/0x2+parseInt(_0x5326c5(0x85))/0x3+-parseInt(_0x5326c5(0x7a))/0x4*(-parseInt(_0x5326c5(0x6c))/0x5)+parseInt(_0x5326c5(0x71))/0x6+parseInt(_0x5326c5(0x82))/0x7+-parseInt(_0x5326c5(0x81))/0x8;if(_0x411cc5===_0x523566)break;else _0xb34615['push'](_0xb34615['shift']());}catch(_0x209dfd){_0xb34615['push'](_0xb34615['shift']());}}}(a36_0x51c7,0x9700b));function a36_0x1df5(_0x4b7993,_0x45d9ed){const _0x51c7ee=a36_0x51c7();return a36_0x1df5=function(_0x1df57c,_0x13aeb5){_0x1df57c=_0x1df57c-0x65;let _0x170662=_0x51c7ee[_0x1df57c];return _0x170662;},a36_0x1df5(_0x4b7993,_0x45d9ed);}var __importDefault=this&&this[a36_0x5887ee(0x7f)]||function(_0x5065f2){const _0x56e103=a36_0x5887ee;return _0x5065f2&&_0x5065f2[_0x56e103(0x80)]?_0x5065f2:{'default':_0x5065f2};};function a36_0x51c7(){const _0x38f9f4=['name','admin','login','AuthService','556288nVWoMH','config','711095ZBikmO','expiresIn','secret','jsonwebtoken','shop','3398238ZWULMn','verify','Account\x20is\x20not\x20active','username','sign','Invalid\x20credentials','default','compare','jwt','24ZNtdWY','597900bbEabt','password','../config/config','status','__importDefault','__esModule','13573848bUHlTl','6336092BTBwVI','ACTIVE','bcryptjs','2599317tiUzlE','passwordHash','generateToken','Invalid\x20token'];a36_0x51c7=function(){return _0x38f9f4;};return a36_0x51c7();}Object['defineProperty'](exports,a36_0x5887ee(0x80),{'value':!![]}),exports[a36_0x5887ee(0x69)]=void 0x0;const bcryptjs_1=__importDefault(require(a36_0x5887ee(0x84))),jsonwebtoken_1=__importDefault(require(a36_0x5887ee(0x6f))),database_1=__importDefault(require('../config/database')),config_1=require(a36_0x5887ee(0x7d));class AuthService{[a36_0x5887ee(0x87)](_0x2bcd89){const _0x14d631=a36_0x5887ee;return jsonwebtoken_1[_0x14d631(0x77)][_0x14d631(0x75)](_0x2bcd89,config_1[_0x14d631(0x6b)][_0x14d631(0x79)][_0x14d631(0x6e)],{'expiresIn':String(config_1[_0x14d631(0x6b)][_0x14d631(0x79)][_0x14d631(0x6d)])});}async[a36_0x5887ee(0x68)](_0x22d70c){const _0x2b1060=a36_0x5887ee,{username:_0x40c730,password:_0x2795c2}=_0x22d70c;if(_0x40c730===config_1[_0x2b1060(0x6b)][_0x2b1060(0x67)][_0x2b1060(0x74)]){const _0x4b7da7=await bcryptjs_1[_0x2b1060(0x77)][_0x2b1060(0x78)](_0x2795c2,config_1['config'][_0x2b1060(0x67)][_0x2b1060(0x86)]);if(_0x4b7da7){const _0x30079b=this[_0x2b1060(0x87)]({'id':'admin','username':config_1[_0x2b1060(0x6b)][_0x2b1060(0x67)][_0x2b1060(0x74)],'role':'admin'});return{'access_token':_0x30079b,'role':'admin'};}}const _0x2865ab=await database_1[_0x2b1060(0x77)]['shop']['findUnique']({'where':{'username':_0x40c730},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x2865ab)throw new Error(_0x2b1060(0x76));if(_0x2865ab[_0x2b1060(0x7e)]!==_0x2b1060(0x83))throw new Error(_0x2b1060(0x73));const _0xc04cba=await bcryptjs_1[_0x2b1060(0x77)][_0x2b1060(0x78)](_0x2795c2,_0x2865ab[_0x2b1060(0x7c)]);if(!_0xc04cba)throw new Error(_0x2b1060(0x76));const _0x1b4ffd=this[_0x2b1060(0x87)]({'id':_0x2865ab['id'],'username':_0x2865ab['username'],'role':_0x2b1060(0x70)});return{'access_token':_0x1b4ffd,'role':_0x2b1060(0x70),'user':{'id':_0x2865ab['id'],'name':_0x2865ab[_0x2b1060(0x66)],'username':_0x2865ab[_0x2b1060(0x74)]}};}async['verifyToken'](_0x23a340){const _0x3341df=a36_0x5887ee;try{const _0x3ce8d7=jsonwebtoken_1[_0x3341df(0x77)][_0x3341df(0x72)](_0x23a340,config_1[_0x3341df(0x6b)][_0x3341df(0x79)][_0x3341df(0x6e)]);return _0x3ce8d7;}catch(_0x334328){throw new Error(_0x3341df(0x65));}}}exports[a36_0x5887ee(0x69)]=AuthService;