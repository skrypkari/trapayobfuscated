'use strict';const a36_0xc60b83=a36_0x4b7e;(function(_0x13fd16,_0x1f871e){const _0x37beaf=a36_0x4b7e,_0x1ff5c6=_0x13fd16();while(!![]){try{const _0x395e85=-parseInt(_0x37beaf(0xf9))/0x1*(-parseInt(_0x37beaf(0xe8))/0x2)+parseInt(_0x37beaf(0xeb))/0x3+-parseInt(_0x37beaf(0xf0))/0x4*(-parseInt(_0x37beaf(0xf8))/0x5)+-parseInt(_0x37beaf(0xef))/0x6*(-parseInt(_0x37beaf(0xee))/0x7)+-parseInt(_0x37beaf(0xea))/0x8+-parseInt(_0x37beaf(0xf4))/0x9*(parseInt(_0x37beaf(0xec))/0xa)+parseInt(_0x37beaf(0xf7))/0xb;if(_0x395e85===_0x1f871e)break;else _0x1ff5c6['push'](_0x1ff5c6['shift']());}catch(_0x2f4b5e){_0x1ff5c6['push'](_0x1ff5c6['shift']());}}}(a36_0x4424,0xde093));var __importDefault=this&&this[a36_0xc60b83(0xf2)]||function(_0x489866){const _0x421534=a36_0xc60b83;return _0x489866&&_0x489866[_0x421534(0xe9)]?_0x489866:{'default':_0x489866};};Object[a36_0xc60b83(0xfd)](exports,a36_0xc60b83(0xe9),{'value':!![]}),exports[a36_0xc60b83(0xe5)]=void 0x0;function a36_0x4b7e(_0x1adcad,_0x2b0543){const _0x442406=a36_0x4424();return a36_0x4b7e=function(_0x4b7e41,_0x20d8a1){_0x4b7e41=_0x4b7e41-0xe0;let _0x5a1e86=_0x442406[_0x4b7e41];return _0x5a1e86;},a36_0x4b7e(_0x1adcad,_0x2b0543);}const bcryptjs_1=__importDefault(require('bcryptjs')),jsonwebtoken_1=__importDefault(require('jsonwebtoken')),database_1=__importDefault(require(a36_0xc60b83(0xff))),config_1=require(a36_0xc60b83(0x101));function a36_0x4424(){const _0x1ba832=['login','compare','10479205pTvkQK','256775mHsmps','40fkdavH','jwt','ACTIVE','findUnique','defineProperty','shop','../config/database','password','../config/config','username','name','generateToken','verifyToken','admin','secret','AuthService','default','passwordHash','2722yBgLyA','__esModule','13496784OPAZFL','4871646fOCCjd','180fjVFFN','sign','7XDDjow','3204018eVMEfK','68QBUGgi','config','__importDefault','Account\x20is\x20not\x20active','720729iGhWBt'];a36_0x4424=function(){return _0x1ba832;};return a36_0x4424();}class AuthService{[a36_0xc60b83(0xe1)](_0x1c6f1a){const _0x4e280=a36_0xc60b83;return jsonwebtoken_1['default'][_0x4e280(0xed)](_0x1c6f1a,config_1[_0x4e280(0xf1)][_0x4e280(0xfa)][_0x4e280(0xe4)],{'expiresIn':String(config_1[_0x4e280(0xf1)][_0x4e280(0xfa)]['expiresIn'])});}async[a36_0xc60b83(0xf5)](_0x5c2872){const _0x1f5af0=a36_0xc60b83,{username:_0x5190f3,password:_0x34ef09}=_0x5c2872;if(_0x5190f3===config_1['config'][_0x1f5af0(0xe3)][_0x1f5af0(0x102)]){const _0x3485b0=await bcryptjs_1[_0x1f5af0(0xe6)][_0x1f5af0(0xf6)](_0x34ef09,config_1[_0x1f5af0(0xf1)][_0x1f5af0(0xe3)][_0x1f5af0(0xe7)]);if(_0x3485b0){const _0x5bda00=this[_0x1f5af0(0xe1)]({'id':_0x1f5af0(0xe3),'username':config_1[_0x1f5af0(0xf1)][_0x1f5af0(0xe3)][_0x1f5af0(0x102)],'role':_0x1f5af0(0xe3)});return{'access_token':_0x5bda00,'role':'admin'};}}const _0x3adf06=await database_1['default'][_0x1f5af0(0xfe)][_0x1f5af0(0xfc)]({'where':{'username':_0x5190f3},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x3adf06)throw new Error('Invalid\x20credentials');if(_0x3adf06['status']!==_0x1f5af0(0xfb))throw new Error(_0x1f5af0(0xf3));const _0x3f1844=await bcryptjs_1[_0x1f5af0(0xe6)][_0x1f5af0(0xf6)](_0x34ef09,_0x3adf06[_0x1f5af0(0x100)]);if(!_0x3f1844)throw new Error('Invalid\x20credentials');const _0x186af4=this['generateToken']({'id':_0x3adf06['id'],'username':_0x3adf06[_0x1f5af0(0x102)],'role':'shop'});return{'access_token':_0x186af4,'role':_0x1f5af0(0xfe),'user':{'id':_0x3adf06['id'],'name':_0x3adf06[_0x1f5af0(0xe0)],'username':_0x3adf06['username']}};}async[a36_0xc60b83(0xe2)](_0x39ef6e){const _0x2feda1=a36_0xc60b83;try{const _0x524696=jsonwebtoken_1[_0x2feda1(0xe6)]['verify'](_0x39ef6e,config_1[_0x2feda1(0xf1)]['jwt'][_0x2feda1(0xe4)]);return _0x524696;}catch(_0x29ed6f){throw new Error('Invalid\x20token');}}}exports[a36_0xc60b83(0xe5)]=AuthService;