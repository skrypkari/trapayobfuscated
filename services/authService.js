'use strict';const a41_0x489073=a41_0x3e71;(function(_0x368c0c,_0x326ad7){const _0x332055=a41_0x3e71,_0x4ddb5d=_0x368c0c();while(!![]){try{const _0x4c3b62=parseInt(_0x332055(0x122))/0x1+parseInt(_0x332055(0x126))/0x2*(-parseInt(_0x332055(0x133))/0x3)+parseInt(_0x332055(0x12b))/0x4*(-parseInt(_0x332055(0x127))/0x5)+-parseInt(_0x332055(0x12d))/0x6*(-parseInt(_0x332055(0x130))/0x7)+parseInt(_0x332055(0x11d))/0x8+-parseInt(_0x332055(0x114))/0x9+parseInt(_0x332055(0x118))/0xa;if(_0x4c3b62===_0x326ad7)break;else _0x4ddb5d['push'](_0x4ddb5d['shift']());}catch(_0x501490){_0x4ddb5d['push'](_0x4ddb5d['shift']());}}}(a41_0x4c56,0x26e72));var __importDefault=this&&this[a41_0x489073(0x124)]||function(_0x251127){const _0x3a6b6a=a41_0x489073;return _0x251127&&_0x251127[_0x3a6b6a(0x115)]?_0x251127:{'default':_0x251127};};function a41_0x3e71(_0xeb6030,_0x21e0b8){const _0x4c5661=a41_0x4c56();return a41_0x3e71=function(_0x3e71e6,_0x2aba68){_0x3e71e6=_0x3e71e6-0x113;let _0x4fc703=_0x4c5661[_0x3e71e6];return _0x4fc703;},a41_0x3e71(_0xeb6030,_0x21e0b8);}Object[a41_0x489073(0x117)](exports,a41_0x489073(0x115),{'value':!![]}),exports[a41_0x489073(0x131)]=void 0x0;function a41_0x4c56(){const _0x1e0188=['../config/database','1434320yGYVZp','compare','login','ACTIVE','password','190129uEAkcD','generateToken','__importDefault','secret','598642SalEVr','5ruQebe','Invalid\x20credentials','username','config','743404vdEtUj','jwt','1395138FxTAIK','default','Account\x20is\x20not\x20active','7JnJfZv','AuthService','findUnique','3oMqWYH','verify','../config/config','1790262lJYvsY','__esModule','Invalid\x20token','defineProperty','2414940yrmGdG','shop','admin','expiresIn'];a41_0x4c56=function(){return _0x1e0188;};return a41_0x4c56();}const bcryptjs_1=__importDefault(require('bcryptjs')),jsonwebtoken_1=__importDefault(require('jsonwebtoken')),database_1=__importDefault(require(a41_0x489073(0x11c))),config_1=require(a41_0x489073(0x113));class AuthService{[a41_0x489073(0x123)](_0x22264a){const _0xf9e3b3=a41_0x489073;return jsonwebtoken_1[_0xf9e3b3(0x12e)]['sign'](_0x22264a,config_1[_0xf9e3b3(0x12a)][_0xf9e3b3(0x12c)][_0xf9e3b3(0x125)],{'expiresIn':String(config_1[_0xf9e3b3(0x12a)]['jwt'][_0xf9e3b3(0x11b)])});}async[a41_0x489073(0x11f)](_0x14a2e6){const _0x5318b1=a41_0x489073,{username:_0x1e8b09,password:_0x3f717e}=_0x14a2e6;if(_0x1e8b09===config_1[_0x5318b1(0x12a)]['admin'][_0x5318b1(0x129)]){const _0x5eca1e=await bcryptjs_1[_0x5318b1(0x12e)][_0x5318b1(0x11e)](_0x3f717e,config_1['config'][_0x5318b1(0x11a)]['passwordHash']);if(_0x5eca1e){const _0x2f437c=this[_0x5318b1(0x123)]({'id':_0x5318b1(0x11a),'username':config_1[_0x5318b1(0x12a)][_0x5318b1(0x11a)][_0x5318b1(0x129)],'role':'admin'});return{'access_token':_0x2f437c,'role':_0x5318b1(0x11a)};}}const _0x46e5d5=await database_1[_0x5318b1(0x12e)]['shop'][_0x5318b1(0x132)]({'where':{'username':_0x1e8b09},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x46e5d5)throw new Error(_0x5318b1(0x128));if(_0x46e5d5['status']!==_0x5318b1(0x120))throw new Error(_0x5318b1(0x12f));const _0x488084=await bcryptjs_1[_0x5318b1(0x12e)][_0x5318b1(0x11e)](_0x3f717e,_0x46e5d5[_0x5318b1(0x121)]);if(!_0x488084)throw new Error(_0x5318b1(0x128));const _0x30b8a8=this[_0x5318b1(0x123)]({'id':_0x46e5d5['id'],'username':_0x46e5d5[_0x5318b1(0x129)],'role':_0x5318b1(0x119)});return{'access_token':_0x30b8a8,'role':_0x5318b1(0x119),'user':{'id':_0x46e5d5['id'],'name':_0x46e5d5['name'],'username':_0x46e5d5[_0x5318b1(0x129)]}};}async['verifyToken'](_0x23bef7){const _0x532169=a41_0x489073;try{const _0x23dbeb=jsonwebtoken_1[_0x532169(0x12e)][_0x532169(0x134)](_0x23bef7,config_1[_0x532169(0x12a)]['jwt'][_0x532169(0x125)]);return _0x23dbeb;}catch(_0x360d58){throw new Error(_0x532169(0x116));}}}exports[a41_0x489073(0x131)]=AuthService;