'use strict';const a36_0x3e2c72=a36_0x4d84;(function(_0x4dd489,_0x32b7b2){const _0x5dc797=a36_0x4d84,_0x6cd81a=_0x4dd489();while(!![]){try{const _0x2239ee=parseInt(_0x5dc797(0x19e))/0x1+-parseInt(_0x5dc797(0x198))/0x2*(-parseInt(_0x5dc797(0x1b3))/0x3)+parseInt(_0x5dc797(0x199))/0x4*(-parseInt(_0x5dc797(0x1be))/0x5)+parseInt(_0x5dc797(0x1aa))/0x6+parseInt(_0x5dc797(0x1a1))/0x7+-parseInt(_0x5dc797(0x1a9))/0x8*(-parseInt(_0x5dc797(0x1b1))/0x9)+-parseInt(_0x5dc797(0x1bc))/0xa;if(_0x2239ee===_0x32b7b2)break;else _0x6cd81a['push'](_0x6cd81a['shift']());}catch(_0x4d8e4a){_0x6cd81a['push'](_0x6cd81a['shift']());}}}(a36_0x2a7a,0x7424f));function a36_0x2a7a(){const _0x499290=['2441380iODjVO','../config/config','sign','password','admin','120808YLcjfV','__importDefault','status','6412791piGhTq','expiresIn','username','__esModule','findUnique','login','bcryptjs','shop','3201488thFmcM','5410914wsBmka','config','../config/database','Account\x20is\x20not\x20active','AuthService','secret','Invalid\x20credentials','9lKVeie','ACTIVE','1718529msqjyx','Invalid\x20token','passwordHash','jsonwebtoken','verify','generateToken','name','defineProperty','jwt','18256970yKTGFe','compare','5IRIVcp','default','2rBXDkq'];a36_0x2a7a=function(){return _0x499290;};return a36_0x2a7a();}var __importDefault=this&&this[a36_0x3e2c72(0x19f)]||function(_0x1a46b5){const _0x58f5d2=a36_0x3e2c72;return _0x1a46b5&&_0x1a46b5[_0x58f5d2(0x1a4)]?_0x1a46b5:{'default':_0x1a46b5};};Object[a36_0x3e2c72(0x1ba)](exports,a36_0x3e2c72(0x1a4),{'value':!![]}),exports[a36_0x3e2c72(0x1ae)]=void 0x0;const bcryptjs_1=__importDefault(require(a36_0x3e2c72(0x1a7))),jsonwebtoken_1=__importDefault(require(a36_0x3e2c72(0x1b6))),database_1=__importDefault(require(a36_0x3e2c72(0x1ac))),config_1=require(a36_0x3e2c72(0x19a));function a36_0x4d84(_0x27cbe9,_0x591f89){const _0x2a7ac4=a36_0x2a7a();return a36_0x4d84=function(_0x4d8468,_0x243a66){_0x4d8468=_0x4d8468-0x197;let _0x58219f=_0x2a7ac4[_0x4d8468];return _0x58219f;},a36_0x4d84(_0x27cbe9,_0x591f89);}class AuthService{[a36_0x3e2c72(0x1b8)](_0x2d7ba8){const _0x575eb9=a36_0x3e2c72;return jsonwebtoken_1[_0x575eb9(0x197)][_0x575eb9(0x19b)](_0x2d7ba8,config_1[_0x575eb9(0x1ab)][_0x575eb9(0x1bb)]['secret'],{'expiresIn':String(config_1[_0x575eb9(0x1ab)][_0x575eb9(0x1bb)][_0x575eb9(0x1a2)])});}async[a36_0x3e2c72(0x1a6)](_0x3dec88){const _0x4c5ac2=a36_0x3e2c72,{username:_0x384caf,password:_0x237b9d}=_0x3dec88;if(_0x384caf===config_1[_0x4c5ac2(0x1ab)][_0x4c5ac2(0x19d)][_0x4c5ac2(0x1a3)]){const _0x4cdbee=await bcryptjs_1[_0x4c5ac2(0x197)]['compare'](_0x237b9d,config_1['config'][_0x4c5ac2(0x19d)][_0x4c5ac2(0x1b5)]);if(_0x4cdbee){const _0x262e09=this[_0x4c5ac2(0x1b8)]({'id':_0x4c5ac2(0x19d),'username':config_1['config']['admin']['username'],'role':_0x4c5ac2(0x19d)});return{'access_token':_0x262e09,'role':_0x4c5ac2(0x19d)};}}const _0x43c7a4=await database_1[_0x4c5ac2(0x197)][_0x4c5ac2(0x1a8)][_0x4c5ac2(0x1a5)]({'where':{'username':_0x384caf},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x43c7a4)throw new Error(_0x4c5ac2(0x1b0));if(_0x43c7a4[_0x4c5ac2(0x1a0)]!==_0x4c5ac2(0x1b2))throw new Error(_0x4c5ac2(0x1ad));const _0x17b44a=await bcryptjs_1[_0x4c5ac2(0x197)][_0x4c5ac2(0x1bd)](_0x237b9d,_0x43c7a4[_0x4c5ac2(0x19c)]);if(!_0x17b44a)throw new Error(_0x4c5ac2(0x1b0));const _0x518344=this['generateToken']({'id':_0x43c7a4['id'],'username':_0x43c7a4['username'],'role':_0x4c5ac2(0x1a8)});return{'access_token':_0x518344,'role':_0x4c5ac2(0x1a8),'user':{'id':_0x43c7a4['id'],'name':_0x43c7a4[_0x4c5ac2(0x1b9)],'username':_0x43c7a4[_0x4c5ac2(0x1a3)]}};}async['verifyToken'](_0x34e2b7){const _0x313cb6=a36_0x3e2c72;try{const _0x46cce7=jsonwebtoken_1['default'][_0x313cb6(0x1b7)](_0x34e2b7,config_1[_0x313cb6(0x1ab)][_0x313cb6(0x1bb)][_0x313cb6(0x1af)]);return _0x46cce7;}catch(_0x206ced){throw new Error(_0x313cb6(0x1b4));}}}exports[a36_0x3e2c72(0x1ae)]=AuthService;