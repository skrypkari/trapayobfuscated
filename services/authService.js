'use strict';const a34_0x32ed04=a34_0x39cc;(function(_0x4c000d,_0x2abba8){const _0x4d1c23=a34_0x39cc,_0x37f1f4=_0x4c000d();while(!![]){try{const _0x1d7e56=parseInt(_0x4d1c23(0x144))/0x1*(-parseInt(_0x4d1c23(0x128))/0x2)+parseInt(_0x4d1c23(0x135))/0x3*(parseInt(_0x4d1c23(0x142))/0x4)+parseInt(_0x4d1c23(0x12d))/0x5*(-parseInt(_0x4d1c23(0x147))/0x6)+parseInt(_0x4d1c23(0x127))/0x7+parseInt(_0x4d1c23(0x137))/0x8+parseInt(_0x4d1c23(0x134))/0x9+-parseInt(_0x4d1c23(0x138))/0xa*(parseInt(_0x4d1c23(0x131))/0xb);if(_0x1d7e56===_0x2abba8)break;else _0x37f1f4['push'](_0x37f1f4['shift']());}catch(_0x21444b){_0x37f1f4['push'](_0x37f1f4['shift']());}}}(a34_0x418b,0x3e6fe));function a34_0x418b(){const _0x5036d2=['17941RkNMXN','secret','admin','2572632Efnvin','3qoJqwU','Invalid\x20credentials','2267680fOPmnl','450neBJoG','defineProperty','jsonwebtoken','ACTIVE','AuthService','Invalid\x20token','default','generateToken','../config/config','password','1598308YmDVRj','username','54jiKanz','name','compare','2906730ZyBwyT','verifyToken','findUnique','1809941fiRskl','15328UkApzs','jwt','__importDefault','__esModule','config','5ErvyiR','shop','passwordHash','status'];a34_0x418b=function(){return _0x5036d2;};return a34_0x418b();}var __importDefault=this&&this[a34_0x32ed04(0x12a)]||function(_0x654b3d){const _0x277144=a34_0x32ed04;return _0x654b3d&&_0x654b3d[_0x277144(0x12b)]?_0x654b3d:{'default':_0x654b3d};};Object[a34_0x32ed04(0x139)](exports,a34_0x32ed04(0x12b),{'value':!![]}),exports[a34_0x32ed04(0x13c)]=void 0x0;function a34_0x39cc(_0x32eca8,_0x31066b){const _0x418b2c=a34_0x418b();return a34_0x39cc=function(_0x39cce7,_0x1285f0){_0x39cce7=_0x39cce7-0x126;let _0x32deb4=_0x418b2c[_0x39cce7];return _0x32deb4;},a34_0x39cc(_0x32eca8,_0x31066b);}const bcryptjs_1=__importDefault(require('bcryptjs')),jsonwebtoken_1=__importDefault(require(a34_0x32ed04(0x13a))),database_1=__importDefault(require('../config/database')),config_1=require(a34_0x32ed04(0x140));class AuthService{[a34_0x32ed04(0x13f)](_0x3a4192){const _0x4f70b0=a34_0x32ed04;return jsonwebtoken_1['default']['sign'](_0x3a4192,config_1[_0x4f70b0(0x12c)]['jwt'][_0x4f70b0(0x132)],{'expiresIn':String(config_1[_0x4f70b0(0x12c)][_0x4f70b0(0x129)]['expiresIn'])});}async['login'](_0x8e6784){const _0x5a23b2=a34_0x32ed04,{username:_0x5bd888,password:_0x1f155b}=_0x8e6784;if(_0x5bd888===config_1['config']['admin'][_0x5a23b2(0x143)]){const _0x5a0338=await bcryptjs_1[_0x5a23b2(0x13e)][_0x5a23b2(0x146)](_0x1f155b,config_1['config']['admin'][_0x5a23b2(0x12f)]);if(_0x5a0338){const _0x2f36ee=this[_0x5a23b2(0x13f)]({'id':_0x5a23b2(0x133),'username':config_1['config'][_0x5a23b2(0x133)][_0x5a23b2(0x143)],'role':_0x5a23b2(0x133)});return{'access_token':_0x2f36ee,'role':_0x5a23b2(0x133)};}}const _0x86a68f=await database_1['default']['shop'][_0x5a23b2(0x126)]({'where':{'username':_0x5bd888},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x86a68f)throw new Error(_0x5a23b2(0x136));if(_0x86a68f[_0x5a23b2(0x130)]!==_0x5a23b2(0x13b))throw new Error('Account\x20is\x20not\x20active');const _0x251e00=await bcryptjs_1[_0x5a23b2(0x13e)][_0x5a23b2(0x146)](_0x1f155b,_0x86a68f[_0x5a23b2(0x141)]);if(!_0x251e00)throw new Error(_0x5a23b2(0x136));const _0x25aeab=this[_0x5a23b2(0x13f)]({'id':_0x86a68f['id'],'username':_0x86a68f[_0x5a23b2(0x143)],'role':_0x5a23b2(0x12e)});return{'access_token':_0x25aeab,'role':_0x5a23b2(0x12e),'user':{'id':_0x86a68f['id'],'name':_0x86a68f[_0x5a23b2(0x145)],'username':_0x86a68f[_0x5a23b2(0x143)]}};}async[a34_0x32ed04(0x148)](_0x387ea0){const _0x3e870b=a34_0x32ed04;try{const _0x55c1cb=jsonwebtoken_1['default']['verify'](_0x387ea0,config_1[_0x3e870b(0x12c)]['jwt'][_0x3e870b(0x132)]);return _0x55c1cb;}catch(_0x30baf7){throw new Error(_0x3e870b(0x13d));}}}exports[a34_0x32ed04(0x13c)]=AuthService;