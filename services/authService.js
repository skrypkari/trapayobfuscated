'use strict';const a36_0x57cae8=a36_0x5284;(function(_0x326eb1,_0x4b20d6){const _0x283afa=a36_0x5284,_0x475a91=_0x326eb1();while(!![]){try{const _0x24cbde=parseInt(_0x283afa(0x16e))/0x1*(-parseInt(_0x283afa(0x172))/0x2)+-parseInt(_0x283afa(0x179))/0x3*(parseInt(_0x283afa(0x175))/0x4)+-parseInt(_0x283afa(0x182))/0x5*(-parseInt(_0x283afa(0x17e))/0x6)+parseInt(_0x283afa(0x17a))/0x7*(-parseInt(_0x283afa(0x177))/0x8)+-parseInt(_0x283afa(0x170))/0x9+parseInt(_0x283afa(0x185))/0xa+parseInt(_0x283afa(0x17f))/0xb;if(_0x24cbde===_0x4b20d6)break;else _0x475a91['push'](_0x475a91['shift']());}catch(_0x1b6bdf){_0x475a91['push'](_0x475a91['shift']());}}}(a36_0xb278,0x60e9d));function a36_0xb278(){const _0x4c350a=['default','38LWBhzx','username','4389471htdvAJ','__esModule','34022fYwltY','bcryptjs','../config/database','118424gbyztT','findUnique','8FXJdEV','Account\x20is\x20not\x20active','75vHHPls','1972033soEwfV','Invalid\x20token','admin','config','6NFDZVy','20565424bjYSXB','expiresIn','../config/config','16285KAAogz','defineProperty','password','6801220bLtqFN','jwt','Invalid\x20credentials','shop','AuthService','passwordHash','login','verify','__importDefault','status','compare','generateToken','ACTIVE','sign','secret'];a36_0xb278=function(){return _0x4c350a;};return a36_0xb278();}var __importDefault=this&&this[a36_0x57cae8(0x18d)]||function(_0x5e7335){return _0x5e7335&&_0x5e7335['__esModule']?_0x5e7335:{'default':_0x5e7335};};Object[a36_0x57cae8(0x183)](exports,a36_0x57cae8(0x171),{'value':!![]}),exports[a36_0x57cae8(0x189)]=void 0x0;const bcryptjs_1=__importDefault(require(a36_0x57cae8(0x173))),jsonwebtoken_1=__importDefault(require('jsonwebtoken')),database_1=__importDefault(require(a36_0x57cae8(0x174))),config_1=require(a36_0x57cae8(0x181));class AuthService{['generateToken'](_0x846c48){const _0x5a3084=a36_0x57cae8;return jsonwebtoken_1['default'][_0x5a3084(0x16b)](_0x846c48,config_1['config'][_0x5a3084(0x186)][_0x5a3084(0x16c)],{'expiresIn':String(config_1[_0x5a3084(0x17d)][_0x5a3084(0x186)][_0x5a3084(0x180)])});}async[a36_0x57cae8(0x18b)](_0x511a83){const _0x431094=a36_0x57cae8,{username:_0x2ce86b,password:_0x590ff0}=_0x511a83;if(_0x2ce86b===config_1[_0x431094(0x17d)][_0x431094(0x17c)][_0x431094(0x16f)]){const _0x555061=await bcryptjs_1[_0x431094(0x16d)][_0x431094(0x18f)](_0x590ff0,config_1['config']['admin'][_0x431094(0x18a)]);if(_0x555061){const _0x41f642=this[_0x431094(0x169)]({'id':_0x431094(0x17c),'username':config_1[_0x431094(0x17d)][_0x431094(0x17c)][_0x431094(0x16f)],'role':_0x431094(0x17c)});return{'access_token':_0x41f642,'role':_0x431094(0x17c)};}}const _0x30e13c=await database_1[_0x431094(0x16d)]['shop'][_0x431094(0x176)]({'where':{'username':_0x2ce86b},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x30e13c)throw new Error(_0x431094(0x187));if(_0x30e13c[_0x431094(0x18e)]!==_0x431094(0x16a))throw new Error(_0x431094(0x178));const _0x31b576=await bcryptjs_1[_0x431094(0x16d)]['compare'](_0x590ff0,_0x30e13c[_0x431094(0x184)]);if(!_0x31b576)throw new Error('Invalid\x20credentials');const _0x32d191=this[_0x431094(0x169)]({'id':_0x30e13c['id'],'username':_0x30e13c[_0x431094(0x16f)],'role':_0x431094(0x188)});return{'access_token':_0x32d191,'role':'shop','user':{'id':_0x30e13c['id'],'name':_0x30e13c['name'],'username':_0x30e13c[_0x431094(0x16f)]}};}async['verifyToken'](_0xd9c649){const _0x311e4c=a36_0x57cae8;try{const _0x35e398=jsonwebtoken_1['default'][_0x311e4c(0x18c)](_0xd9c649,config_1[_0x311e4c(0x17d)][_0x311e4c(0x186)]['secret']);return _0x35e398;}catch(_0x5bdd3a){throw new Error(_0x311e4c(0x17b));}}}function a36_0x5284(_0x512830,_0x221832){const _0xb278f4=a36_0xb278();return a36_0x5284=function(_0x5284a8,_0x496e66){_0x5284a8=_0x5284a8-0x169;let _0x439f1e=_0xb278f4[_0x5284a8];return _0x439f1e;},a36_0x5284(_0x512830,_0x221832);}exports[a36_0x57cae8(0x189)]=AuthService;