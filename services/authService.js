'use strict';const a37_0x1ba93b=a37_0x42aa;(function(_0x41ff55,_0x12c243){const _0x8261d9=a37_0x42aa,_0x193d4d=_0x41ff55();while(!![]){try{const _0x531003=parseInt(_0x8261d9(0x19f))/0x1*(-parseInt(_0x8261d9(0x1a2))/0x2)+-parseInt(_0x8261d9(0x191))/0x3+-parseInt(_0x8261d9(0x1ac))/0x4+-parseInt(_0x8261d9(0x1a0))/0x5+parseInt(_0x8261d9(0x18f))/0x6*(parseInt(_0x8261d9(0x18a))/0x7)+-parseInt(_0x8261d9(0x193))/0x8*(-parseInt(_0x8261d9(0x190))/0x9)+-parseInt(_0x8261d9(0x1a3))/0xa*(-parseInt(_0x8261d9(0x1ab))/0xb);if(_0x531003===_0x12c243)break;else _0x193d4d['push'](_0x193d4d['shift']());}catch(_0x399be9){_0x193d4d['push'](_0x193d4d['shift']());}}}(a37_0x3bfb,0xcff73));var __importDefault=this&&this['__importDefault']||function(_0xe5e6f3){const _0x3e5a6a=a37_0x42aa;return _0xe5e6f3&&_0xe5e6f3[_0x3e5a6a(0x18d)]?_0xe5e6f3:{'default':_0xe5e6f3};};function a37_0x42aa(_0x3ba36e,_0x3b99ba){const _0x3bfb4b=a37_0x3bfb();return a37_0x42aa=function(_0x42aaf0,_0x118cd5){_0x42aaf0=_0x42aaf0-0x18a;let _0x4925a0=_0x3bfb4b[_0x42aaf0];return _0x4925a0;},a37_0x42aa(_0x3ba36e,_0x3b99ba);}Object[a37_0x1ba93b(0x19e)](exports,a37_0x1ba93b(0x18d),{'value':!![]}),exports['AuthService']=void 0x0;const bcryptjs_1=__importDefault(require(a37_0x1ba93b(0x196))),jsonwebtoken_1=__importDefault(require('jsonwebtoken')),database_1=__importDefault(require('../config/database')),config_1=require(a37_0x1ba93b(0x1ad));function a37_0x3bfb(){const _0xc2c251=['1607604ZcCTnA','login','8xZfGRl','sign','expiresIn','bcryptjs','compare','verifyToken','jwt','passwordHash','Account\x20is\x20not\x20active','shop','name','defineProperty','95619GlKiuQ','6303305xStFOM','AuthService','34ZpEENx','10FIGUFx','default','password','admin','findUnique','config','ACTIVE','verify','43722591ILjAzh','3813812xAQkhA','../config/config','secret','112FAhIuq','username','Invalid\x20token','__esModule','generateToken','245472OYQREi','5381631BFImrO'];a37_0x3bfb=function(){return _0xc2c251;};return a37_0x3bfb();}class AuthService{[a37_0x1ba93b(0x18e)](_0x257b8f){const _0x598a2d=a37_0x1ba93b;return jsonwebtoken_1['default'][_0x598a2d(0x194)](_0x257b8f,config_1[_0x598a2d(0x1a8)]['jwt'][_0x598a2d(0x1ae)],{'expiresIn':String(config_1[_0x598a2d(0x1a8)][_0x598a2d(0x199)][_0x598a2d(0x195)])});}async[a37_0x1ba93b(0x192)](_0x25f87b){const _0x4bec3f=a37_0x1ba93b,{username:_0x1d69e0,password:_0x2e3b84}=_0x25f87b;if(_0x1d69e0===config_1[_0x4bec3f(0x1a8)][_0x4bec3f(0x1a6)][_0x4bec3f(0x18b)]){const _0x2e6bc7=await bcryptjs_1['default'][_0x4bec3f(0x197)](_0x2e3b84,config_1['config'][_0x4bec3f(0x1a6)][_0x4bec3f(0x19a)]);if(_0x2e6bc7){const _0xdce966=this[_0x4bec3f(0x18e)]({'id':_0x4bec3f(0x1a6),'username':config_1[_0x4bec3f(0x1a8)][_0x4bec3f(0x1a6)]['username'],'role':_0x4bec3f(0x1a6)});return{'access_token':_0xdce966,'role':_0x4bec3f(0x1a6)};}}const _0x37bf53=await database_1[_0x4bec3f(0x1a4)][_0x4bec3f(0x19c)][_0x4bec3f(0x1a7)]({'where':{'username':_0x1d69e0},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x37bf53)throw new Error('Invalid\x20credentials');if(_0x37bf53['status']!==_0x4bec3f(0x1a9))throw new Error(_0x4bec3f(0x19b));const _0x38f0b9=await bcryptjs_1[_0x4bec3f(0x1a4)]['compare'](_0x2e3b84,_0x37bf53[_0x4bec3f(0x1a5)]);if(!_0x38f0b9)throw new Error('Invalid\x20credentials');const _0x5a0e66=this['generateToken']({'id':_0x37bf53['id'],'username':_0x37bf53['username'],'role':'shop'});return{'access_token':_0x5a0e66,'role':'shop','user':{'id':_0x37bf53['id'],'name':_0x37bf53[_0x4bec3f(0x19d)],'username':_0x37bf53[_0x4bec3f(0x18b)]}};}async[a37_0x1ba93b(0x198)](_0x3c0876){const _0x2b9bb4=a37_0x1ba93b;try{const _0x1f157e=jsonwebtoken_1[_0x2b9bb4(0x1a4)][_0x2b9bb4(0x1aa)](_0x3c0876,config_1[_0x2b9bb4(0x1a8)]['jwt']['secret']);return _0x1f157e;}catch(_0x548db1){throw new Error(_0x2b9bb4(0x18c));}}}exports[a37_0x1ba93b(0x1a1)]=AuthService;