'use strict';const a36_0x26db59=a36_0x54e5;function a36_0x54e5(_0x2e8e4b,_0x10c434){const _0x3917bb=a36_0x3917();return a36_0x54e5=function(_0x54e53f,_0x476e43){_0x54e53f=_0x54e53f-0x169;let _0x501f60=_0x3917bb[_0x54e53f];return _0x501f60;},a36_0x54e5(_0x2e8e4b,_0x10c434);}function a36_0x3917(){const _0xcc6224=['ACTIVE','1775330IeQKPp','Invalid\x20credentials','5972376sgaBac','Account\x20is\x20not\x20active','findUnique','487818HeIjft','status','1677565yKbtWS','verifyToken','../config/config','name','Invalid\x20token','compare','password','AuthService','sign','4dKxUNs','4557996RiAPaz','bcryptjs','secret','__esModule','username','config','jsonwebtoken','default','login','admin','jwt','passwordHash','70eIIHtS','854820ygQaWo','45CVPgag','1927494ASxTWT','shop','__importDefault','generateToken'];a36_0x3917=function(){return _0xcc6224;};return a36_0x3917();}(function(_0x2e7bca,_0x5cb53f){const _0x163068=a36_0x54e5,_0x4a93cb=_0x2e7bca();while(!![]){try{const _0xcb1c4d=-parseInt(_0x163068(0x18d))/0x1+parseInt(_0x163068(0x183))/0x2+parseInt(_0x163068(0x174))/0x3+parseInt(_0x163068(0x173))/0x4*(parseInt(_0x163068(0x16a))/0x5)+-parseInt(_0x163068(0x181))/0x6*(parseInt(_0x163068(0x180))/0x7)+parseInt(_0x163068(0x18a))/0x8+-parseInt(_0x163068(0x182))/0x9*(parseInt(_0x163068(0x188))/0xa);if(_0xcb1c4d===_0x5cb53f)break;else _0x4a93cb['push'](_0x4a93cb['shift']());}catch(_0xfe2bad){_0x4a93cb['push'](_0x4a93cb['shift']());}}}(a36_0x3917,0xbac1c));var __importDefault=this&&this[a36_0x26db59(0x185)]||function(_0x61e8db){return _0x61e8db&&_0x61e8db['__esModule']?_0x61e8db:{'default':_0x61e8db};};Object['defineProperty'](exports,a36_0x26db59(0x177),{'value':!![]}),exports[a36_0x26db59(0x171)]=void 0x0;const bcryptjs_1=__importDefault(require(a36_0x26db59(0x175))),jsonwebtoken_1=__importDefault(require(a36_0x26db59(0x17a))),database_1=__importDefault(require('../config/database')),config_1=require(a36_0x26db59(0x16c));class AuthService{['generateToken'](_0x5a2ee3){const _0x584ab8=a36_0x26db59;return jsonwebtoken_1[_0x584ab8(0x17b)][_0x584ab8(0x172)](_0x5a2ee3,config_1[_0x584ab8(0x179)][_0x584ab8(0x17e)][_0x584ab8(0x176)],{'expiresIn':String(config_1['config'][_0x584ab8(0x17e)]['expiresIn'])});}async[a36_0x26db59(0x17c)](_0x31591c){const _0x256cd2=a36_0x26db59,{username:_0x194747,password:_0x357b20}=_0x31591c;if(_0x194747===config_1[_0x256cd2(0x179)][_0x256cd2(0x17d)][_0x256cd2(0x178)]){const _0x8eb0b1=await bcryptjs_1[_0x256cd2(0x17b)][_0x256cd2(0x16f)](_0x357b20,config_1[_0x256cd2(0x179)][_0x256cd2(0x17d)][_0x256cd2(0x17f)]);if(_0x8eb0b1){const _0x3f9a63=this[_0x256cd2(0x186)]({'id':_0x256cd2(0x17d),'username':config_1[_0x256cd2(0x179)][_0x256cd2(0x17d)]['username'],'role':'admin'});return{'access_token':_0x3f9a63,'role':_0x256cd2(0x17d)};}}const _0x4c25b1=await database_1[_0x256cd2(0x17b)][_0x256cd2(0x184)][_0x256cd2(0x18c)]({'where':{'username':_0x194747},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x4c25b1)throw new Error(_0x256cd2(0x189));if(_0x4c25b1[_0x256cd2(0x169)]!==_0x256cd2(0x187))throw new Error(_0x256cd2(0x18b));const _0x20205b=await bcryptjs_1[_0x256cd2(0x17b)][_0x256cd2(0x16f)](_0x357b20,_0x4c25b1[_0x256cd2(0x170)]);if(!_0x20205b)throw new Error(_0x256cd2(0x189));const _0x918954=this[_0x256cd2(0x186)]({'id':_0x4c25b1['id'],'username':_0x4c25b1[_0x256cd2(0x178)],'role':_0x256cd2(0x184)});return{'access_token':_0x918954,'role':_0x256cd2(0x184),'user':{'id':_0x4c25b1['id'],'name':_0x4c25b1[_0x256cd2(0x16d)],'username':_0x4c25b1[_0x256cd2(0x178)]}};}async[a36_0x26db59(0x16b)](_0xc6d1d6){const _0x2ca460=a36_0x26db59;try{const _0x5374f8=jsonwebtoken_1['default']['verify'](_0xc6d1d6,config_1['config'][_0x2ca460(0x17e)][_0x2ca460(0x176)]);return _0x5374f8;}catch(_0x313db4){throw new Error(_0x2ca460(0x16e));}}}exports['AuthService']=AuthService;