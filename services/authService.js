'use strict';const a41_0x541435=a41_0x44f1;(function(_0x26884b,_0x70cc52){const _0x4d2413=a41_0x44f1,_0xa60f6d=_0x26884b();while(!![]){try{const _0x2db5f0=-parseInt(_0x4d2413(0x1a8))/0x1*(parseInt(_0x4d2413(0x1af))/0x2)+-parseInt(_0x4d2413(0x1a4))/0x3+-parseInt(_0x4d2413(0x1a5))/0x4+parseInt(_0x4d2413(0x1a3))/0x5*(-parseInt(_0x4d2413(0x19f))/0x6)+-parseInt(_0x4d2413(0x1ac))/0x7*(-parseInt(_0x4d2413(0x190))/0x8)+-parseInt(_0x4d2413(0x193))/0x9+-parseInt(_0x4d2413(0x1ae))/0xa*(-parseInt(_0x4d2413(0x19c))/0xb);if(_0x2db5f0===_0x70cc52)break;else _0xa60f6d['push'](_0xa60f6d['shift']());}catch(_0x4d2156){_0xa60f6d['push'](_0xa60f6d['shift']());}}}(a41_0x97ee,0x28c19));function a41_0x44f1(_0x2ccdf7,_0x2e3abe){const _0x97eef5=a41_0x97ee();return a41_0x44f1=function(_0x44f138,_0x2179f1){_0x44f138=_0x44f138-0x18e;let _0x5e5cbc=_0x97eef5[_0x44f138];return _0x5e5cbc;},a41_0x44f1(_0x2ccdf7,_0x2e3abe);}var __importDefault=this&&this['__importDefault']||function(_0x3bcab9){const _0x25bea8=a41_0x44f1;return _0x3bcab9&&_0x3bcab9[_0x25bea8(0x198)]?_0x3bcab9:{'default':_0x3bcab9};};function a41_0x97ee(){const _0x1de9b4=['default','__esModule','Invalid\x20token','jwt','bcryptjs','3865521icgTcs','../config/config','password','174xWCiIc','verifyToken','status','generateToken','37755WRgeNy','391026TFCZaC','703124rYEfrP','compare','AuthService','3yqxzNh','passwordHash','../config/database','admin','21KREqIg','shop','30bfIhOH','101390zACQOE','defineProperty','jsonwebtoken','username','79872XxQFVX','Account\x20is\x20not\x20active','verify','2160549wzlhyr','config','secret','Invalid\x20credentials'];a41_0x97ee=function(){return _0x1de9b4;};return a41_0x97ee();}Object[a41_0x541435(0x1b0)](exports,'__esModule',{'value':!![]}),exports[a41_0x541435(0x1a7)]=void 0x0;const bcryptjs_1=__importDefault(require(a41_0x541435(0x19b))),jsonwebtoken_1=__importDefault(require(a41_0x541435(0x18e))),database_1=__importDefault(require(a41_0x541435(0x1aa))),config_1=require(a41_0x541435(0x19d));class AuthService{[a41_0x541435(0x1a2)](_0x47d7f7){const _0x24bf07=a41_0x541435;return jsonwebtoken_1[_0x24bf07(0x197)]['sign'](_0x47d7f7,config_1['config']['jwt'][_0x24bf07(0x195)],{'expiresIn':String(config_1['config'][_0x24bf07(0x19a)]['expiresIn'])});}async['login'](_0x44a5f6){const _0x2be3da=a41_0x541435,{username:_0x1a1fe4,password:_0x51a2e2}=_0x44a5f6;if(_0x1a1fe4===config_1[_0x2be3da(0x194)][_0x2be3da(0x1ab)]['username']){const _0x260bb1=await bcryptjs_1[_0x2be3da(0x197)][_0x2be3da(0x1a6)](_0x51a2e2,config_1['config'][_0x2be3da(0x1ab)][_0x2be3da(0x1a9)]);if(_0x260bb1){const _0x2834f8=this[_0x2be3da(0x1a2)]({'id':_0x2be3da(0x1ab),'username':config_1['config'][_0x2be3da(0x1ab)][_0x2be3da(0x18f)],'role':_0x2be3da(0x1ab)});return{'access_token':_0x2834f8,'role':_0x2be3da(0x1ab)};}}const _0x3db1ad=await database_1[_0x2be3da(0x197)][_0x2be3da(0x1ad)]['findUnique']({'where':{'username':_0x1a1fe4},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x3db1ad)throw new Error('Invalid\x20credentials');if(_0x3db1ad[_0x2be3da(0x1a1)]!=='ACTIVE')throw new Error(_0x2be3da(0x191));const _0x267235=await bcryptjs_1[_0x2be3da(0x197)][_0x2be3da(0x1a6)](_0x51a2e2,_0x3db1ad[_0x2be3da(0x19e)]);if(!_0x267235)throw new Error(_0x2be3da(0x196));const _0x350d8d=this[_0x2be3da(0x1a2)]({'id':_0x3db1ad['id'],'username':_0x3db1ad[_0x2be3da(0x18f)],'role':'shop'});return{'access_token':_0x350d8d,'role':_0x2be3da(0x1ad),'user':{'id':_0x3db1ad['id'],'name':_0x3db1ad['name'],'username':_0x3db1ad[_0x2be3da(0x18f)]}};}async[a41_0x541435(0x1a0)](_0x1de2a2){const _0x2bc32c=a41_0x541435;try{const _0x5a9b4e=jsonwebtoken_1[_0x2bc32c(0x197)][_0x2bc32c(0x192)](_0x1de2a2,config_1[_0x2bc32c(0x194)]['jwt'][_0x2bc32c(0x195)]);return _0x5a9b4e;}catch(_0x42348b){throw new Error(_0x2bc32c(0x199));}}}exports['AuthService']=AuthService;