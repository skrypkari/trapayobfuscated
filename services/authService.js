'use strict';function a39_0x24e9(_0x4232e1,_0x2c2682){const _0x2e248e=a39_0x2e24();return a39_0x24e9=function(_0x24e9a5,_0x57a3d4){_0x24e9a5=_0x24e9a5-0x1ac;let _0x423000=_0x2e248e[_0x24e9a5];return _0x423000;},a39_0x24e9(_0x4232e1,_0x2c2682);}const a39_0x21f5c5=a39_0x24e9;(function(_0x30ec63,_0x12728f){const _0x5c0040=a39_0x24e9,_0x1be41f=_0x30ec63();while(!![]){try{const _0x804f1=-parseInt(_0x5c0040(0x1bb))/0x1*(parseInt(_0x5c0040(0x1b5))/0x2)+parseInt(_0x5c0040(0x1b1))/0x3+-parseInt(_0x5c0040(0x1bf))/0x4+parseInt(_0x5c0040(0x1cc))/0x5*(parseInt(_0x5c0040(0x1af))/0x6)+-parseInt(_0x5c0040(0x1c6))/0x7+-parseInt(_0x5c0040(0x1d0))/0x8+parseInt(_0x5c0040(0x1b0))/0x9;if(_0x804f1===_0x12728f)break;else _0x1be41f['push'](_0x1be41f['shift']());}catch(_0x46b2a2){_0x1be41f['push'](_0x1be41f['shift']());}}}(a39_0x2e24,0x6f3cd));var __importDefault=this&&this[a39_0x21f5c5(0x1ca)]||function(_0x2c5f){return _0x2c5f&&_0x2c5f['__esModule']?_0x2c5f:{'default':_0x2c5f};};Object[a39_0x21f5c5(0x1be)](exports,a39_0x21f5c5(0x1c2),{'value':!![]}),exports[a39_0x21f5c5(0x1cd)]=void 0x0;const bcryptjs_1=__importDefault(require(a39_0x21f5c5(0x1ac))),jsonwebtoken_1=__importDefault(require(a39_0x21f5c5(0x1b6))),database_1=__importDefault(require(a39_0x21f5c5(0x1ba))),config_1=require(a39_0x21f5c5(0x1ad));class AuthService{[a39_0x21f5c5(0x1cb)](_0x69240e){const _0x10233a=a39_0x21f5c5;return jsonwebtoken_1[_0x10233a(0x1c0)]['sign'](_0x69240e,config_1[_0x10233a(0x1b2)]['jwt'][_0x10233a(0x1ae)],{'expiresIn':String(config_1[_0x10233a(0x1b2)][_0x10233a(0x1bc)][_0x10233a(0x1b9)])});}async[a39_0x21f5c5(0x1cf)](_0x576998){const _0x201c17=a39_0x21f5c5,{username:_0x4bbd6d,password:_0xfc6708}=_0x576998;if(_0x4bbd6d===config_1['config'][_0x201c17(0x1b8)][_0x201c17(0x1c8)]){const _0x530d6e=await bcryptjs_1[_0x201c17(0x1c0)][_0x201c17(0x1bd)](_0xfc6708,config_1[_0x201c17(0x1b2)][_0x201c17(0x1b8)][_0x201c17(0x1b7)]);if(_0x530d6e){const _0x275698=this[_0x201c17(0x1cb)]({'id':'admin','username':config_1['config'][_0x201c17(0x1b8)][_0x201c17(0x1c8)],'role':_0x201c17(0x1b8)});return{'access_token':_0x275698,'role':_0x201c17(0x1b8)};}}const _0x25540f=await database_1[_0x201c17(0x1c0)][_0x201c17(0x1b3)][_0x201c17(0x1c7)]({'where':{'username':_0x4bbd6d},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x25540f)throw new Error(_0x201c17(0x1ce));if(_0x25540f['status']!==_0x201c17(0x1c5))throw new Error(_0x201c17(0x1c3));const _0x4ee5d8=await bcryptjs_1[_0x201c17(0x1c0)][_0x201c17(0x1bd)](_0xfc6708,_0x25540f[_0x201c17(0x1c9)]);if(!_0x4ee5d8)throw new Error(_0x201c17(0x1ce));const _0x178eb3=this[_0x201c17(0x1cb)]({'id':_0x25540f['id'],'username':_0x25540f[_0x201c17(0x1c8)],'role':_0x201c17(0x1b3)});return{'access_token':_0x178eb3,'role':_0x201c17(0x1b3),'user':{'id':_0x25540f['id'],'name':_0x25540f[_0x201c17(0x1c4)],'username':_0x25540f[_0x201c17(0x1c8)]}};}async[a39_0x21f5c5(0x1b4)](_0x37988e){const _0x234f2d=a39_0x21f5c5;try{const _0x12f3dd=jsonwebtoken_1['default'][_0x234f2d(0x1c1)](_0x37988e,config_1['config'][_0x234f2d(0x1bc)][_0x234f2d(0x1ae)]);return _0x12f3dd;}catch(_0x2ea293){throw new Error('Invalid\x20token');}}}function a39_0x2e24(){const _0x4a5598=['login','6386312ffDjQO','bcryptjs','../config/config','secret','2453232AsbmtB','20308527LbEUWJ','1130157cKrjvQ','config','shop','verifyToken','2sUpGTV','jsonwebtoken','passwordHash','admin','expiresIn','../config/database','344614UxgfdK','jwt','compare','defineProperty','2738048qpuKmz','default','verify','__esModule','Account\x20is\x20not\x20active','name','ACTIVE','5313350DvtBgR','findUnique','username','password','__importDefault','generateToken','5shIPHY','AuthService','Invalid\x20credentials'];a39_0x2e24=function(){return _0x4a5598;};return a39_0x2e24();}exports[a39_0x21f5c5(0x1cd)]=AuthService;