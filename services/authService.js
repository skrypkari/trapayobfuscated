'use strict';const a36_0x4b8046=a36_0x3b44;(function(_0x1456fc,_0x1df480){const _0x4c335f=a36_0x3b44,_0x1487ac=_0x1456fc();while(!![]){try{const _0x2a381c=parseInt(_0x4c335f(0x174))/0x1+parseInt(_0x4c335f(0x155))/0x2*(parseInt(_0x4c335f(0x16c))/0x3)+parseInt(_0x4c335f(0x167))/0x4+parseInt(_0x4c335f(0x165))/0x5*(parseInt(_0x4c335f(0x176))/0x6)+-parseInt(_0x4c335f(0x173))/0x7*(-parseInt(_0x4c335f(0x17a))/0x8)+-parseInt(_0x4c335f(0x15d))/0x9*(-parseInt(_0x4c335f(0x169))/0xa)+parseInt(_0x4c335f(0x158))/0xb*(-parseInt(_0x4c335f(0x15e))/0xc);if(_0x2a381c===_0x1df480)break;else _0x1487ac['push'](_0x1487ac['shift']());}catch(_0x473efa){_0x1487ac['push'](_0x1487ac['shift']());}}}(a36_0x276a,0xe2cb5));function a36_0x276a(){const _0x371fc4=['1991648ZNrlwR','name','findUnique','jwt','../config/database','2wPEcMu','Invalid\x20token','jsonwebtoken','11qVnhGO','password','secret','ACTIVE','default','279wZlRtq','40820544xNVWEI','verify','bcryptjs','__importDefault','verifyToken','login','username','55HeAXJp','Invalid\x20credentials','1394440xWndJb','status','188040zwzerw','shop','passwordHash','5024067BSrqMo','admin','sign','generateToken','compare','Account\x20is\x20not\x20active','__esModule','21OxDRya','810491fVAmdd','expiresIn','91134uDHwGR','config','AuthService','../config/config'];a36_0x276a=function(){return _0x371fc4;};return a36_0x276a();}var __importDefault=this&&this[a36_0x4b8046(0x161)]||function(_0x552507){const _0x45de5a=a36_0x4b8046;return _0x552507&&_0x552507[_0x45de5a(0x172)]?_0x552507:{'default':_0x552507};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a36_0x4b8046(0x178)]=void 0x0;const bcryptjs_1=__importDefault(require(a36_0x4b8046(0x160))),jsonwebtoken_1=__importDefault(require(a36_0x4b8046(0x157))),database_1=__importDefault(require(a36_0x4b8046(0x154))),config_1=require(a36_0x4b8046(0x179));function a36_0x3b44(_0x445c18,_0xf557cb){const _0x276ae4=a36_0x276a();return a36_0x3b44=function(_0x3b444d,_0x2ff473){_0x3b444d=_0x3b444d-0x153;let _0x3d3d72=_0x276ae4[_0x3b444d];return _0x3d3d72;},a36_0x3b44(_0x445c18,_0xf557cb);}class AuthService{[a36_0x4b8046(0x16f)](_0x3ee23a){const _0x41e5f4=a36_0x4b8046;return jsonwebtoken_1[_0x41e5f4(0x15c)][_0x41e5f4(0x16e)](_0x3ee23a,config_1[_0x41e5f4(0x177)][_0x41e5f4(0x153)][_0x41e5f4(0x15a)],{'expiresIn':String(config_1[_0x41e5f4(0x177)][_0x41e5f4(0x153)][_0x41e5f4(0x175)])});}async[a36_0x4b8046(0x163)](_0x35665b){const _0x3d3508=a36_0x4b8046,{username:_0x4ea40a,password:_0x3b6379}=_0x35665b;if(_0x4ea40a===config_1[_0x3d3508(0x177)][_0x3d3508(0x16d)][_0x3d3508(0x164)]){const _0x414e15=await bcryptjs_1[_0x3d3508(0x15c)][_0x3d3508(0x170)](_0x3b6379,config_1[_0x3d3508(0x177)][_0x3d3508(0x16d)][_0x3d3508(0x16b)]);if(_0x414e15){const _0x31d331=this[_0x3d3508(0x16f)]({'id':_0x3d3508(0x16d),'username':config_1['config'][_0x3d3508(0x16d)][_0x3d3508(0x164)],'role':_0x3d3508(0x16d)});return{'access_token':_0x31d331,'role':'admin'};}}const _0x1c2792=await database_1[_0x3d3508(0x15c)][_0x3d3508(0x16a)][_0x3d3508(0x17c)]({'where':{'username':_0x4ea40a},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x1c2792)throw new Error(_0x3d3508(0x166));if(_0x1c2792[_0x3d3508(0x168)]!==_0x3d3508(0x15b))throw new Error(_0x3d3508(0x171));const _0x395258=await bcryptjs_1[_0x3d3508(0x15c)]['compare'](_0x3b6379,_0x1c2792[_0x3d3508(0x159)]);if(!_0x395258)throw new Error(_0x3d3508(0x166));const _0xbb19ab=this[_0x3d3508(0x16f)]({'id':_0x1c2792['id'],'username':_0x1c2792[_0x3d3508(0x164)],'role':_0x3d3508(0x16a)});return{'access_token':_0xbb19ab,'role':_0x3d3508(0x16a),'user':{'id':_0x1c2792['id'],'name':_0x1c2792[_0x3d3508(0x17b)],'username':_0x1c2792[_0x3d3508(0x164)]}};}async[a36_0x4b8046(0x162)](_0x5c7caa){const _0x189ac9=a36_0x4b8046;try{const _0x353830=jsonwebtoken_1[_0x189ac9(0x15c)][_0x189ac9(0x15f)](_0x5c7caa,config_1[_0x189ac9(0x177)]['jwt'][_0x189ac9(0x15a)]);return _0x353830;}catch(_0x5ea1ae){throw new Error(_0x189ac9(0x156));}}}exports[a36_0x4b8046(0x178)]=AuthService;