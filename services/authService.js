'use strict';const a34_0x1ce9f3=a34_0x5c9f;(function(_0x33d8c4,_0x2ed017){const _0x3eb82e=a34_0x5c9f,_0x309dff=_0x33d8c4();while(!![]){try{const _0x2f6d09=-parseInt(_0x3eb82e(0xfc))/0x1+parseInt(_0x3eb82e(0x119))/0x2+parseInt(_0x3eb82e(0xff))/0x3+-parseInt(_0x3eb82e(0xf8))/0x4+-parseInt(_0x3eb82e(0x100))/0x5+parseInt(_0x3eb82e(0x113))/0x6*(-parseInt(_0x3eb82e(0x111))/0x7)+parseInt(_0x3eb82e(0xfb))/0x8*(parseInt(_0x3eb82e(0xfd))/0x9);if(_0x2f6d09===_0x2ed017)break;else _0x309dff['push'](_0x309dff['shift']());}catch(_0xe9afd5){_0x309dff['push'](_0x309dff['shift']());}}}(a34_0x4055,0xc2373));function a34_0x5c9f(_0x470533,_0x240279){const _0x40553c=a34_0x4055();return a34_0x5c9f=function(_0x5c9fc1,_0x53c6a4){_0x5c9fc1=_0x5c9fc1-0xf5;let _0x250bca=_0x40553c[_0x5c9fc1];return _0x250bca;},a34_0x5c9f(_0x470533,_0x240279);}var __importDefault=this&&this[a34_0x1ce9f3(0x101)]||function(_0x32f263){const _0x3eddfa=a34_0x1ce9f3;return _0x32f263&&_0x32f263[_0x3eddfa(0x102)]?_0x32f263:{'default':_0x32f263};};Object[a34_0x1ce9f3(0x118)](exports,a34_0x1ce9f3(0x102),{'value':!![]}),exports['AuthService']=void 0x0;const bcryptjs_1=__importDefault(require(a34_0x1ce9f3(0xfa))),jsonwebtoken_1=__importDefault(require(a34_0x1ce9f3(0x10c))),database_1=__importDefault(require(a34_0x1ce9f3(0x10e))),config_1=require(a34_0x1ce9f3(0x108));class AuthService{['generateToken'](_0x42f477){const _0x5ed7b7=a34_0x1ce9f3;return jsonwebtoken_1[_0x5ed7b7(0x114)][_0x5ed7b7(0x106)](_0x42f477,config_1[_0x5ed7b7(0x103)][_0x5ed7b7(0xf5)][_0x5ed7b7(0x105)],{'expiresIn':String(config_1['config'][_0x5ed7b7(0xf5)]['expiresIn'])});}async[a34_0x1ce9f3(0x107)](_0x3795c7){const _0x496e61=a34_0x1ce9f3,{username:_0x32c70b,password:_0xddbe6a}=_0x3795c7;if(_0x32c70b===config_1[_0x496e61(0x103)][_0x496e61(0x116)]['username']){const _0x2219bd=await bcryptjs_1['default'][_0x496e61(0x115)](_0xddbe6a,config_1[_0x496e61(0x103)][_0x496e61(0x116)][_0x496e61(0xfe)]);if(_0x2219bd){const _0x22860f=this['generateToken']({'id':_0x496e61(0x116),'username':config_1['config']['admin'][_0x496e61(0xf9)],'role':'admin'});return{'access_token':_0x22860f,'role':_0x496e61(0x116)};}}const _0x365229=await database_1['default'][_0x496e61(0xf6)][_0x496e61(0x110)]({'where':{'username':_0x32c70b},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x365229)throw new Error('Invalid\x20credentials');if(_0x365229[_0x496e61(0xf7)]!==_0x496e61(0x109))throw new Error(_0x496e61(0x10f));const _0x49eb74=await bcryptjs_1['default'][_0x496e61(0x115)](_0xddbe6a,_0x365229[_0x496e61(0x10a)]);if(!_0x49eb74)throw new Error(_0x496e61(0x104));const _0x2d84f7=this['generateToken']({'id':_0x365229['id'],'username':_0x365229[_0x496e61(0xf9)],'role':'shop'});return{'access_token':_0x2d84f7,'role':_0x496e61(0xf6),'user':{'id':_0x365229['id'],'name':_0x365229[_0x496e61(0x117)],'username':_0x365229[_0x496e61(0xf9)]}};}async[a34_0x1ce9f3(0x10b)](_0x1adf92){const _0x401921=a34_0x1ce9f3;try{const _0x4dc021=jsonwebtoken_1[_0x401921(0x114)][_0x401921(0x112)](_0x1adf92,config_1['config'][_0x401921(0xf5)][_0x401921(0x105)]);return _0x4dc021;}catch(_0x2c784e){throw new Error('Invalid\x20token');}}}function a34_0x4055(){const _0x21c004=['589435LiqYAq','verify','102JGAaTJ','default','compare','admin','name','defineProperty','1072416FnIMFO','jwt','shop','status','5478016KhQbGn','username','bcryptjs','734848sJBYfH','1316224hRTgyp','279mVxqbJ','passwordHash','4763649IKhNyW','294535VPAozq','__importDefault','__esModule','config','Invalid\x20credentials','secret','sign','login','../config/config','ACTIVE','password','verifyToken','jsonwebtoken','AuthService','../config/database','Account\x20is\x20not\x20active','findUnique'];a34_0x4055=function(){return _0x21c004;};return a34_0x4055();}exports[a34_0x1ce9f3(0x10d)]=AuthService;