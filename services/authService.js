'use strict';function a39_0x203b(){const _0x3b61a3=['40QrotyY','AuthService','../config/config','90RjcLnI','92AfveCH','__esModule','username','sign','shop','2531280SAlWii','1263879PZvQOv','generateToken','179505qFTUhe','jsonwebtoken','secret','defineProperty','findUnique','../config/database','771876oFsopu','name','jwt','Invalid\x20token','compare','1336928pLxnDv','login','Account\x20is\x20not\x20active','admin','495866zvJyJk','21276620mFtkgg','expiresIn','verify','password','bcryptjs','config','default'];a39_0x203b=function(){return _0x3b61a3;};return a39_0x203b();}function a39_0x5744(_0x4baa30,_0x36ce89){const _0x203b10=a39_0x203b();return a39_0x5744=function(_0x5744ad,_0x5c5cb3){_0x5744ad=_0x5744ad-0x98;let _0x26aeb3=_0x203b10[_0x5744ad];return _0x26aeb3;},a39_0x5744(_0x4baa30,_0x36ce89);}const a39_0x2f9514=a39_0x5744;(function(_0x8913ea,_0x38505b){const _0x2c2876=a39_0x5744,_0x2551ab=_0x8913ea();while(!![]){try{const _0x45106b=-parseInt(_0x2c2876(0xaa))/0x1+-parseInt(_0x2c2876(0xa5))/0x2+-parseInt(_0x2c2876(0x9c))/0x3+parseInt(_0x2c2876(0xba))/0x4*(parseInt(_0x2c2876(0x9f))/0x5)+parseInt(_0x2c2876(0xb9))/0x6*(parseInt(_0x2c2876(0xae))/0x7)+-parseInt(_0x2c2876(0xb6))/0x8*(parseInt(_0x2c2876(0x9d))/0x9)+parseInt(_0x2c2876(0xaf))/0xa;if(_0x45106b===_0x38505b)break;else _0x2551ab['push'](_0x2551ab['shift']());}catch(_0x57bfd4){_0x2551ab['push'](_0x2551ab['shift']());}}}(a39_0x203b,0xb66a6));var __importDefault=this&&this['__importDefault']||function(_0x18ff54){const _0x46859b=a39_0x5744;return _0x18ff54&&_0x18ff54[_0x46859b(0x98)]?_0x18ff54:{'default':_0x18ff54};};Object[a39_0x2f9514(0xa2)](exports,a39_0x2f9514(0x98),{'value':!![]}),exports[a39_0x2f9514(0xb7)]=void 0x0;const bcryptjs_1=__importDefault(require(a39_0x2f9514(0xb3))),jsonwebtoken_1=__importDefault(require(a39_0x2f9514(0xa0))),database_1=__importDefault(require(a39_0x2f9514(0xa4))),config_1=require(a39_0x2f9514(0xb8));class AuthService{[a39_0x2f9514(0x9e)](_0x49539f){const _0x1b1294=a39_0x2f9514;return jsonwebtoken_1[_0x1b1294(0xb5)][_0x1b1294(0x9a)](_0x49539f,config_1[_0x1b1294(0xb4)]['jwt'][_0x1b1294(0xa1)],{'expiresIn':String(config_1['config']['jwt'][_0x1b1294(0xb0)])});}async[a39_0x2f9514(0xab)](_0x249c8a){const _0x121abb=a39_0x2f9514,{username:_0x20e07d,password:_0x350465}=_0x249c8a;if(_0x20e07d===config_1[_0x121abb(0xb4)][_0x121abb(0xad)][_0x121abb(0x99)]){const _0xd1fff2=await bcryptjs_1[_0x121abb(0xb5)][_0x121abb(0xa9)](_0x350465,config_1[_0x121abb(0xb4)][_0x121abb(0xad)]['passwordHash']);if(_0xd1fff2){const _0x5e9221=this['generateToken']({'id':_0x121abb(0xad),'username':config_1[_0x121abb(0xb4)]['admin']['username'],'role':'admin'});return{'access_token':_0x5e9221,'role':_0x121abb(0xad)};}}const _0x4f41b3=await database_1[_0x121abb(0xb5)][_0x121abb(0x9b)][_0x121abb(0xa3)]({'where':{'username':_0x20e07d},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x4f41b3)throw new Error('Invalid\x20credentials');if(_0x4f41b3['status']!=='ACTIVE')throw new Error(_0x121abb(0xac));const _0x5a3752=await bcryptjs_1['default'][_0x121abb(0xa9)](_0x350465,_0x4f41b3[_0x121abb(0xb2)]);if(!_0x5a3752)throw new Error('Invalid\x20credentials');const _0x501f86=this[_0x121abb(0x9e)]({'id':_0x4f41b3['id'],'username':_0x4f41b3[_0x121abb(0x99)],'role':_0x121abb(0x9b)});return{'access_token':_0x501f86,'role':'shop','user':{'id':_0x4f41b3['id'],'name':_0x4f41b3[_0x121abb(0xa6)],'username':_0x4f41b3['username']}};}async['verifyToken'](_0x4799b0){const _0x3f116e=a39_0x2f9514;try{const _0x2ca409=jsonwebtoken_1[_0x3f116e(0xb5)][_0x3f116e(0xb1)](_0x4799b0,config_1['config'][_0x3f116e(0xa7)][_0x3f116e(0xa1)]);return _0x2ca409;}catch(_0x562832){throw new Error(_0x3f116e(0xa8));}}}exports[a39_0x2f9514(0xb7)]=AuthService;