'use strict';function a41_0x3d2f(){const _0x445d65=['verifyToken','AuthService','20ydYKZg','2712603iyBpXj','name','Account\x20is\x20not\x20active','findUnique','99183WewhVO','generateToken','passwordHash','Invalid\x20token','shop','9MKpibY','jsonwebtoken','admin','247799QJpLJr','3099252rRgeqh','expiresIn','2UcPqTS','5705096QNHiLZ','__esModule','compare','../config/database','verify','default','1368995dDvEVy','secret','login','1078143YtlZJD','jwt','username','270qlZwXv','Invalid\x20credentials','config'];a41_0x3d2f=function(){return _0x445d65;};return a41_0x3d2f();}const a41_0x59af8=a41_0x5fb1;(function(_0xb70ec3,_0x4c64fd){const _0x3f043b=a41_0x5fb1,_0xa721bb=_0xb70ec3();while(!![]){try{const _0x57de9b=-parseInt(_0x3f043b(0x14a))/0x1+parseInt(_0x3f043b(0x14d))/0x2*(-parseInt(_0x3f043b(0x13e))/0x3)+parseInt(_0x3f043b(0x14b))/0x4+-parseInt(_0x3f043b(0x154))/0x5+parseInt(_0x3f043b(0x15a))/0x6*(parseInt(_0x3f043b(0x142))/0x7)+-parseInt(_0x3f043b(0x14e))/0x8*(-parseInt(_0x3f043b(0x147))/0x9)+parseInt(_0x3f043b(0x15f))/0xa*(-parseInt(_0x3f043b(0x157))/0xb);if(_0x57de9b===_0x4c64fd)break;else _0xa721bb['push'](_0xa721bb['shift']());}catch(_0x23be57){_0xa721bb['push'](_0xa721bb['shift']());}}}(a41_0x3d2f,0x7afb2));var __importDefault=this&&this['__importDefault']||function(_0x339f95){const _0x56a630=a41_0x5fb1;return _0x339f95&&_0x339f95[_0x56a630(0x14f)]?_0x339f95:{'default':_0x339f95};};Object['defineProperty'](exports,a41_0x59af8(0x14f),{'value':!![]}),exports[a41_0x59af8(0x15e)]=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),jsonwebtoken_1=__importDefault(require(a41_0x59af8(0x148))),database_1=__importDefault(require(a41_0x59af8(0x151))),config_1=require('../config/config');class AuthService{['generateToken'](_0x290f7d){const _0x42f879=a41_0x59af8;return jsonwebtoken_1[_0x42f879(0x153)]['sign'](_0x290f7d,config_1[_0x42f879(0x15c)][_0x42f879(0x158)][_0x42f879(0x155)],{'expiresIn':String(config_1[_0x42f879(0x15c)][_0x42f879(0x158)][_0x42f879(0x14c)])});}async[a41_0x59af8(0x156)](_0x44c34e){const _0x417394=a41_0x59af8,{username:_0x45527a,password:_0x51a530}=_0x44c34e;if(_0x45527a===config_1['config'][_0x417394(0x149)][_0x417394(0x159)]){const _0x373191=await bcryptjs_1['default'][_0x417394(0x150)](_0x51a530,config_1['config'][_0x417394(0x149)][_0x417394(0x144)]);if(_0x373191){const _0x5e4a26=this[_0x417394(0x143)]({'id':'admin','username':config_1[_0x417394(0x15c)]['admin'][_0x417394(0x159)],'role':'admin'});return{'access_token':_0x5e4a26,'role':_0x417394(0x149)};}}const _0x48d241=await database_1[_0x417394(0x153)]['shop'][_0x417394(0x141)]({'where':{'username':_0x45527a},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x48d241)throw new Error(_0x417394(0x15b));if(_0x48d241['status']!=='ACTIVE')throw new Error(_0x417394(0x140));const _0x4c1baf=await bcryptjs_1[_0x417394(0x153)][_0x417394(0x150)](_0x51a530,_0x48d241['password']);if(!_0x4c1baf)throw new Error(_0x417394(0x15b));const _0x5924ec=this[_0x417394(0x143)]({'id':_0x48d241['id'],'username':_0x48d241['username'],'role':_0x417394(0x146)});return{'access_token':_0x5924ec,'role':_0x417394(0x146),'user':{'id':_0x48d241['id'],'name':_0x48d241[_0x417394(0x13f)],'username':_0x48d241[_0x417394(0x159)]}};}async[a41_0x59af8(0x15d)](_0x37ff72){const _0x131b2d=a41_0x59af8;try{const _0x5780b8=jsonwebtoken_1['default'][_0x131b2d(0x152)](_0x37ff72,config_1[_0x131b2d(0x15c)][_0x131b2d(0x158)][_0x131b2d(0x155)]);return _0x5780b8;}catch(_0x489274){throw new Error(_0x131b2d(0x145));}}}function a41_0x5fb1(_0x3d15df,_0x25a1b4){const _0x3d2fd4=a41_0x3d2f();return a41_0x5fb1=function(_0x5fb1ca,_0x2ef9dd){_0x5fb1ca=_0x5fb1ca-0x13e;let _0x375e1e=_0x3d2fd4[_0x5fb1ca];return _0x375e1e;},a41_0x5fb1(_0x3d15df,_0x25a1b4);}exports[a41_0x59af8(0x15e)]=AuthService;