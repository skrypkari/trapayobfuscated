'use strict';const a34_0x126ac0=a34_0x354b;(function(_0x123bd7,_0x1c6521){const _0x49dd37=a34_0x354b,_0x2dff23=_0x123bd7();while(!![]){try{const _0x3dc60e=parseInt(_0x49dd37(0x1b4))/0x1+-parseInt(_0x49dd37(0x194))/0x2*(-parseInt(_0x49dd37(0x192))/0x3)+parseInt(_0x49dd37(0x195))/0x4*(-parseInt(_0x49dd37(0x196))/0x5)+-parseInt(_0x49dd37(0x19e))/0x6+parseInt(_0x49dd37(0x1a4))/0x7*(-parseInt(_0x49dd37(0x1ab))/0x8)+-parseInt(_0x49dd37(0x1b2))/0x9*(parseInt(_0x49dd37(0x193))/0xa)+parseInt(_0x49dd37(0x1ad))/0xb*(parseInt(_0x49dd37(0x1a6))/0xc);if(_0x3dc60e===_0x1c6521)break;else _0x2dff23['push'](_0x2dff23['shift']());}catch(_0x55a9b1){_0x2dff23['push'](_0x2dff23['shift']());}}}(a34_0x3d45,0x5a996));function a34_0x3d45(){const _0x1a2143=['520367fCAfxC','passwordHash','__importDefault','default','password','2805EPIHDn','166610wpcSAw','1358gRGbTE','760KwDGUu','6300NVjmfU','sign','generateToken','login','shop','jsonwebtoken','config','status','4341078lcWjov','Invalid\x20token','verifyToken','admin','Account\x20is\x20not\x20active','secret','7YprGLQ','__esModule','6686868YTbEjh','Invalid\x20credentials','AuthService','verify','expiresIn','761816nTkvrA','bcryptjs','11HTqBjt','jwt','username','defineProperty','compare','153vWMDkC','findUnique'];a34_0x3d45=function(){return _0x1a2143;};return a34_0x3d45();}function a34_0x354b(_0x36164a,_0x478562){const _0x3d4506=a34_0x3d45();return a34_0x354b=function(_0x354b2a,_0x4cff2d){_0x354b2a=_0x354b2a-0x192;let _0x512b51=_0x3d4506[_0x354b2a];return _0x512b51;},a34_0x354b(_0x36164a,_0x478562);}var __importDefault=this&&this[a34_0x126ac0(0x1b6)]||function(_0x55aa18){const _0x1aff7e=a34_0x126ac0;return _0x55aa18&&_0x55aa18[_0x1aff7e(0x1a5)]?_0x55aa18:{'default':_0x55aa18};};Object[a34_0x126ac0(0x1b0)](exports,'__esModule',{'value':!![]}),exports[a34_0x126ac0(0x1a8)]=void 0x0;const bcryptjs_1=__importDefault(require(a34_0x126ac0(0x1ac))),jsonwebtoken_1=__importDefault(require(a34_0x126ac0(0x19b))),database_1=__importDefault(require('../config/database')),config_1=require('../config/config');class AuthService{[a34_0x126ac0(0x198)](_0xba7592){const _0x2c82b6=a34_0x126ac0;return jsonwebtoken_1[_0x2c82b6(0x1b7)][_0x2c82b6(0x197)](_0xba7592,config_1['config'][_0x2c82b6(0x1ae)][_0x2c82b6(0x1a3)],{'expiresIn':String(config_1[_0x2c82b6(0x19c)][_0x2c82b6(0x1ae)][_0x2c82b6(0x1aa)])});}async[a34_0x126ac0(0x199)](_0x3e185a){const _0x2db2d9=a34_0x126ac0,{username:_0x5a2b4d,password:_0x26d078}=_0x3e185a;if(_0x5a2b4d===config_1['config']['admin'][_0x2db2d9(0x1af)]){const _0xd6487e=await bcryptjs_1[_0x2db2d9(0x1b7)][_0x2db2d9(0x1b1)](_0x26d078,config_1['config'][_0x2db2d9(0x1a1)][_0x2db2d9(0x1b5)]);if(_0xd6487e){const _0x3d88dd=this['generateToken']({'id':_0x2db2d9(0x1a1),'username':config_1[_0x2db2d9(0x19c)][_0x2db2d9(0x1a1)][_0x2db2d9(0x1af)],'role':_0x2db2d9(0x1a1)});return{'access_token':_0x3d88dd,'role':'admin'};}}const _0x29d4ac=await database_1[_0x2db2d9(0x1b7)]['shop'][_0x2db2d9(0x1b3)]({'where':{'username':_0x5a2b4d},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x29d4ac)throw new Error(_0x2db2d9(0x1a7));if(_0x29d4ac[_0x2db2d9(0x19d)]!=='ACTIVE')throw new Error(_0x2db2d9(0x1a2));const _0x1d21f0=await bcryptjs_1[_0x2db2d9(0x1b7)]['compare'](_0x26d078,_0x29d4ac[_0x2db2d9(0x1b8)]);if(!_0x1d21f0)throw new Error(_0x2db2d9(0x1a7));const _0x1bf3a2=this['generateToken']({'id':_0x29d4ac['id'],'username':_0x29d4ac[_0x2db2d9(0x1af)],'role':_0x2db2d9(0x19a)});return{'access_token':_0x1bf3a2,'role':_0x2db2d9(0x19a),'user':{'id':_0x29d4ac['id'],'name':_0x29d4ac['name'],'username':_0x29d4ac[_0x2db2d9(0x1af)]}};}async[a34_0x126ac0(0x1a0)](_0x208f5){const _0x42a3c5=a34_0x126ac0;try{const _0x496d3a=jsonwebtoken_1['default'][_0x42a3c5(0x1a9)](_0x208f5,config_1['config']['jwt'][_0x42a3c5(0x1a3)]);return _0x496d3a;}catch(_0x555fda){throw new Error(_0x42a3c5(0x19f));}}}exports[a34_0x126ac0(0x1a8)]=AuthService;