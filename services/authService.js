'use strict';const a36_0x36cd03=a36_0x2c49;(function(_0x399aa8,_0x70c3b0){const _0x4e205e=a36_0x2c49,_0x5825c6=_0x399aa8();while(!![]){try{const _0x31fa8f=-parseInt(_0x4e205e(0x93))/0x1*(parseInt(_0x4e205e(0x97))/0x2)+-parseInt(_0x4e205e(0xac))/0x3+-parseInt(_0x4e205e(0xae))/0x4*(-parseInt(_0x4e205e(0xb8))/0x5)+-parseInt(_0x4e205e(0xb5))/0x6+parseInt(_0x4e205e(0x99))/0x7+parseInt(_0x4e205e(0xb1))/0x8+parseInt(_0x4e205e(0x98))/0x9*(parseInt(_0x4e205e(0x9c))/0xa);if(_0x31fa8f===_0x70c3b0)break;else _0x5825c6['push'](_0x5825c6['shift']());}catch(_0x5ad48d){_0x5825c6['push'](_0x5825c6['shift']());}}}(a36_0x5614,0xa0819));function a36_0x5614(){const _0xa6483=['Invalid\x20credentials','1642299amDYMP','default','2197924lhVtLT','ACTIVE','expiresIn','7325880aqSDZj','jsonwebtoken','generateToken','__importDefault','7242216WuNoRU','passwordHash','verifyToken','5NyarRu','../config/config','AuthService','236297ucpcUh','login','findUnique','Account\x20is\x20not\x20active','2xqUGmd','9koPonG','5309556nMeXSb','config','../config/database','4244750pOkcWc','Invalid\x20token','admin','password','username','verify','status','secret','name','defineProperty','jwt','__esModule','sign','shop','compare'];a36_0x5614=function(){return _0xa6483;};return a36_0x5614();}var __importDefault=this&&this[a36_0x36cd03(0xb4)]||function(_0x1d1d5c){return _0x1d1d5c&&_0x1d1d5c['__esModule']?_0x1d1d5c:{'default':_0x1d1d5c};};function a36_0x2c49(_0x52c134,_0x2b60e4){const _0x56145a=a36_0x5614();return a36_0x2c49=function(_0x2c49fc,_0x551a61){_0x2c49fc=_0x2c49fc-0x92;let _0x1de0b7=_0x56145a[_0x2c49fc];return _0x1de0b7;},a36_0x2c49(_0x52c134,_0x2b60e4);}Object[a36_0x36cd03(0xa5)](exports,a36_0x36cd03(0xa7),{'value':!![]}),exports['AuthService']=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),jsonwebtoken_1=__importDefault(require(a36_0x36cd03(0xb2))),database_1=__importDefault(require(a36_0x36cd03(0x9b))),config_1=require(a36_0x36cd03(0xb9));class AuthService{[a36_0x36cd03(0xb3)](_0x514442){const _0x2118bb=a36_0x36cd03;return jsonwebtoken_1[_0x2118bb(0xad)][_0x2118bb(0xa8)](_0x514442,config_1['config'][_0x2118bb(0xa6)]['secret'],{'expiresIn':String(config_1[_0x2118bb(0x9a)][_0x2118bb(0xa6)][_0x2118bb(0xb0)])});}async[a36_0x36cd03(0x94)](_0x3c5798){const _0x590646=a36_0x36cd03,{username:_0x3fdd60,password:_0x7b1989}=_0x3c5798;if(_0x3fdd60===config_1[_0x590646(0x9a)]['admin'][_0x590646(0xa0)]){const _0x2d6f9a=await bcryptjs_1[_0x590646(0xad)][_0x590646(0xaa)](_0x7b1989,config_1[_0x590646(0x9a)]['admin'][_0x590646(0xb6)]);if(_0x2d6f9a){const _0x564521=this[_0x590646(0xb3)]({'id':_0x590646(0x9e),'username':config_1[_0x590646(0x9a)][_0x590646(0x9e)][_0x590646(0xa0)],'role':_0x590646(0x9e)});return{'access_token':_0x564521,'role':_0x590646(0x9e)};}}const _0x4c9fe9=await database_1[_0x590646(0xad)]['shop'][_0x590646(0x95)]({'where':{'username':_0x3fdd60},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x4c9fe9)throw new Error(_0x590646(0xab));if(_0x4c9fe9[_0x590646(0xa2)]!==_0x590646(0xaf))throw new Error(_0x590646(0x96));const _0x3344c3=await bcryptjs_1[_0x590646(0xad)]['compare'](_0x7b1989,_0x4c9fe9[_0x590646(0x9f)]);if(!_0x3344c3)throw new Error('Invalid\x20credentials');const _0x53862e=this[_0x590646(0xb3)]({'id':_0x4c9fe9['id'],'username':_0x4c9fe9['username'],'role':_0x590646(0xa9)});return{'access_token':_0x53862e,'role':_0x590646(0xa9),'user':{'id':_0x4c9fe9['id'],'name':_0x4c9fe9[_0x590646(0xa4)],'username':_0x4c9fe9[_0x590646(0xa0)]}};}async[a36_0x36cd03(0xb7)](_0x358a81){const _0x4a2c86=a36_0x36cd03;try{const _0x59012c=jsonwebtoken_1[_0x4a2c86(0xad)][_0x4a2c86(0xa1)](_0x358a81,config_1[_0x4a2c86(0x9a)][_0x4a2c86(0xa6)][_0x4a2c86(0xa3)]);return _0x59012c;}catch(_0x4d17dd){throw new Error(_0x4a2c86(0x9d));}}}exports[a36_0x36cd03(0x92)]=AuthService;