'use strict';function a34_0x2f36(_0x1471a9,_0x50e8f4){const _0x636947=a34_0x6369();return a34_0x2f36=function(_0x2f36cc,_0x5421b0){_0x2f36cc=_0x2f36cc-0xeb;let _0x103c4a=_0x636947[_0x2f36cc];return _0x103c4a;},a34_0x2f36(_0x1471a9,_0x50e8f4);}const a34_0x2426d9=a34_0x2f36;(function(_0x28b77c,_0x1ecb0e){const _0x5430b1=a34_0x2f36,_0x1487bb=_0x28b77c();while(!![]){try{const _0x5a9d5c=-parseInt(_0x5430b1(0xef))/0x1*(parseInt(_0x5430b1(0xf0))/0x2)+-parseInt(_0x5430b1(0xf1))/0x3*(-parseInt(_0x5430b1(0x10d))/0x4)+-parseInt(_0x5430b1(0x101))/0x5+-parseInt(_0x5430b1(0x104))/0x6*(parseInt(_0x5430b1(0x109))/0x7)+parseInt(_0x5430b1(0xf5))/0x8+parseInt(_0x5430b1(0x10a))/0x9*(parseInt(_0x5430b1(0xfa))/0xa)+-parseInt(_0x5430b1(0xee))/0xb;if(_0x5a9d5c===_0x1ecb0e)break;else _0x1487bb['push'](_0x1487bb['shift']());}catch(_0x53b687){_0x1487bb['push'](_0x1487bb['shift']());}}}(a34_0x6369,0xba0d9));function a34_0x6369(){const _0x45be3b=['1697ZHhJrT','6fpJBRQ','80097rmmJuE','sign','verifyToken','__esModule','8511344PqDLPT','admin','Invalid\x20token','password','jwt','121460oyUupe','generateToken','ACTIVE','username','secret','login','compare','2324080tfBuqE','verify','Account\x20is\x20not\x20active','4554714oZSbUw','AuthService','config','passwordHash','__importDefault','7NVJGcl','1035weBDKX','defineProperty','default','220JpShBn','jsonwebtoken','status','shop','21318594uvwmja'];a34_0x6369=function(){return _0x45be3b;};return a34_0x6369();}var __importDefault=this&&this[a34_0x2426d9(0x108)]||function(_0x3abe66){const _0x269c7d=a34_0x2426d9;return _0x3abe66&&_0x3abe66[_0x269c7d(0xf4)]?_0x3abe66:{'default':_0x3abe66};};Object[a34_0x2426d9(0x10b)](exports,a34_0x2426d9(0xf4),{'value':!![]}),exports[a34_0x2426d9(0x105)]=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),jsonwebtoken_1=__importDefault(require(a34_0x2426d9(0xeb))),database_1=__importDefault(require('../config/database')),config_1=require('../config/config');class AuthService{[a34_0x2426d9(0xfb)](_0x350a6a){const _0x4a5f69=a34_0x2426d9;return jsonwebtoken_1[_0x4a5f69(0x10c)][_0x4a5f69(0xf2)](_0x350a6a,config_1[_0x4a5f69(0x106)][_0x4a5f69(0xf9)][_0x4a5f69(0xfe)],{'expiresIn':String(config_1['config']['jwt']['expiresIn'])});}async[a34_0x2426d9(0xff)](_0x3c2aa0){const _0x1e1710=a34_0x2426d9,{username:_0x18b217,password:_0x4c9d42}=_0x3c2aa0;if(_0x18b217===config_1[_0x1e1710(0x106)][_0x1e1710(0xf6)][_0x1e1710(0xfd)]){const _0x9b8772=await bcryptjs_1[_0x1e1710(0x10c)][_0x1e1710(0x100)](_0x4c9d42,config_1[_0x1e1710(0x106)]['admin'][_0x1e1710(0x107)]);if(_0x9b8772){const _0x16621e=this[_0x1e1710(0xfb)]({'id':_0x1e1710(0xf6),'username':config_1['config'][_0x1e1710(0xf6)][_0x1e1710(0xfd)],'role':_0x1e1710(0xf6)});return{'access_token':_0x16621e,'role':_0x1e1710(0xf6)};}}const _0x100b05=await database_1[_0x1e1710(0x10c)][_0x1e1710(0xed)]['findUnique']({'where':{'username':_0x18b217},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x100b05)throw new Error('Invalid\x20credentials');if(_0x100b05[_0x1e1710(0xec)]!==_0x1e1710(0xfc))throw new Error(_0x1e1710(0x103));const _0x1e1ed3=await bcryptjs_1[_0x1e1710(0x10c)][_0x1e1710(0x100)](_0x4c9d42,_0x100b05[_0x1e1710(0xf8)]);if(!_0x1e1ed3)throw new Error('Invalid\x20credentials');const _0x5b0b5a=this[_0x1e1710(0xfb)]({'id':_0x100b05['id'],'username':_0x100b05[_0x1e1710(0xfd)],'role':_0x1e1710(0xed)});return{'access_token':_0x5b0b5a,'role':'shop','user':{'id':_0x100b05['id'],'name':_0x100b05['name'],'username':_0x100b05[_0x1e1710(0xfd)]}};}async[a34_0x2426d9(0xf3)](_0xd7a93){const _0x16d9aa=a34_0x2426d9;try{const _0x5512bf=jsonwebtoken_1[_0x16d9aa(0x10c)][_0x16d9aa(0x102)](_0xd7a93,config_1['config'][_0x16d9aa(0xf9)][_0x16d9aa(0xfe)]);return _0x5512bf;}catch(_0x3ee6aa){throw new Error(_0x16d9aa(0xf7));}}}exports[a34_0x2426d9(0x105)]=AuthService;