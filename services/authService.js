'use strict';const a36_0x3bd6c7=a36_0x162e;(function(_0x55043e,_0x3befbf){const _0x7a4de9=a36_0x162e,_0x5966cc=_0x55043e();while(!![]){try{const _0xe05ab7=-parseInt(_0x7a4de9(0xec))/0x1*(-parseInt(_0x7a4de9(0xe9))/0x2)+-parseInt(_0x7a4de9(0xd2))/0x3*(parseInt(_0x7a4de9(0xeb))/0x4)+parseInt(_0x7a4de9(0xef))/0x5*(parseInt(_0x7a4de9(0xed))/0x6)+parseInt(_0x7a4de9(0xe1))/0x7*(-parseInt(_0x7a4de9(0xda))/0x8)+parseInt(_0x7a4de9(0xdd))/0x9*(-parseInt(_0x7a4de9(0xf0))/0xa)+parseInt(_0x7a4de9(0xde))/0xb+-parseInt(_0x7a4de9(0xca))/0xc*(parseInt(_0x7a4de9(0xf1))/0xd);if(_0xe05ab7===_0x3befbf)break;else _0x5966cc['push'](_0x5966cc['shift']());}catch(_0x88a209){_0x5966cc['push'](_0x5966cc['shift']());}}}(a36_0x5064,0x89f51));function a36_0x5064(){const _0x1948db=['104IGbunw','expiresIn','generateToken','5823PzVeTk','12242923pcMGvu','INACTIVE','Invalid\x20token','226961bqjVMB','compare','default','__importDefault','admin','jsonwebtoken','name','verifyToken','2cxHFuG','../config/database','848828TTrUTI','412323dJjPSb','270498uKrlTW','findUnique','115lNavEW','14120MvMVTW','325mKOPmp','sign','114084IIeHtB','shop','Invalid\x20credentials','__esModule','verify','status','password','username','6uBmJzw','config','AuthService','SUSPENDED','../config/config','defineProperty','secret','jwt'];a36_0x5064=function(){return _0x1948db;};return a36_0x5064();}var __importDefault=this&&this[a36_0x3bd6c7(0xe4)]||function(_0x1771c8){const _0x106318=a36_0x3bd6c7;return _0x1771c8&&_0x1771c8[_0x106318(0xcd)]?_0x1771c8:{'default':_0x1771c8};};Object[a36_0x3bd6c7(0xd7)](exports,a36_0x3bd6c7(0xcd),{'value':!![]}),exports[a36_0x3bd6c7(0xd4)]=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),jsonwebtoken_1=__importDefault(require(a36_0x3bd6c7(0xe6))),database_1=__importDefault(require(a36_0x3bd6c7(0xea))),config_1=require(a36_0x3bd6c7(0xd6));class AuthService{[a36_0x3bd6c7(0xdc)](_0x2cdced){const _0x20cb1d=a36_0x3bd6c7;return jsonwebtoken_1[_0x20cb1d(0xe3)][_0x20cb1d(0xc9)](_0x2cdced,config_1[_0x20cb1d(0xd3)]['jwt'][_0x20cb1d(0xd8)],{'expiresIn':String(config_1[_0x20cb1d(0xd3)][_0x20cb1d(0xd9)][_0x20cb1d(0xdb)])});}async['login'](_0x1f4e9c){const _0x435629=a36_0x3bd6c7,{username:_0x11f94c,password:_0x368b83}=_0x1f4e9c;if(_0x11f94c===config_1[_0x435629(0xd3)][_0x435629(0xe5)][_0x435629(0xd1)]){const _0x23ba85=await bcryptjs_1[_0x435629(0xe3)][_0x435629(0xe2)](_0x368b83,config_1[_0x435629(0xd3)][_0x435629(0xe5)]['passwordHash']);if(_0x23ba85){const _0x3fb3c6=this['generateToken']({'id':'admin','username':config_1[_0x435629(0xd3)][_0x435629(0xe5)][_0x435629(0xd1)],'role':_0x435629(0xe5)});return{'access_token':_0x3fb3c6,'role':_0x435629(0xe5)};}}const _0x2c5e9f=await database_1[_0x435629(0xe3)][_0x435629(0xcb)][_0x435629(0xee)]({'where':{'username':_0x11f94c},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x2c5e9f)throw new Error(_0x435629(0xcc));if(_0x2c5e9f[_0x435629(0xcf)]===_0x435629(0xdf))throw new Error('Account\x20is\x20not\x20active');const _0x5bde2f=await bcryptjs_1[_0x435629(0xe3)][_0x435629(0xe2)](_0x368b83,_0x2c5e9f[_0x435629(0xd0)]);if(!_0x5bde2f)throw new Error(_0x435629(0xcc));const _0x571f84=this['generateToken']({'id':_0x2c5e9f['id'],'username':_0x2c5e9f[_0x435629(0xd1)],'role':_0x435629(0xcb)});return{'access_token':_0x571f84,'role':_0x435629(0xcb),'user':{'id':_0x2c5e9f['id'],'name':_0x2c5e9f[_0x435629(0xe7)],'username':_0x2c5e9f[_0x435629(0xd1)],'status':_0x2c5e9f[_0x435629(0xcf)]},'suspended':_0x2c5e9f[_0x435629(0xcf)]===_0x435629(0xd5)};}async[a36_0x3bd6c7(0xe8)](_0x28da90){const _0x5aecac=a36_0x3bd6c7;try{const _0x1c3cdf=jsonwebtoken_1['default'][_0x5aecac(0xce)](_0x28da90,config_1[_0x5aecac(0xd3)][_0x5aecac(0xd9)][_0x5aecac(0xd8)]);return _0x1c3cdf;}catch(_0x28c4d8){throw new Error(_0x5aecac(0xe0));}}}function a36_0x162e(_0x2ce692,_0x5bcc29){const _0x5064cc=a36_0x5064();return a36_0x162e=function(_0x162efc,_0x1d085f){_0x162efc=_0x162efc-0xc9;let _0xdb5c8f=_0x5064cc[_0x162efc];return _0xdb5c8f;},a36_0x162e(_0x2ce692,_0x5bcc29);}exports[a36_0x3bd6c7(0xd4)]=AuthService;