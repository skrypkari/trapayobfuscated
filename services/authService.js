'use strict';const a36_0x1a0e98=a36_0x1370;function a36_0x2a00(){const _0x58ea73=['findUnique','verifyToken','4baUJhr','name','ACTIVE','__esModule','1349621zZhobh','11062280wQhUyZ','defineProperty','9166245KsLrLW','bcryptjs','verify','4375866DsJNLC','shop','config','755372FRGnzg','Account\x20is\x20not\x20active','status','admin','login','generateToken','jwt','9dkcgxS','jsonwebtoken','sign','9NMLmiT','566738AyvFgN','default','secret','Invalid\x20credentials','AuthService','username','password','10927712MLqFbf','compare'];a36_0x2a00=function(){return _0x58ea73;};return a36_0x2a00();}(function(_0x36f109,_0xed8040){const _0x1053fd=a36_0x1370,_0x410b47=_0x36f109();while(!![]){try{const _0x1a78f2=parseInt(_0x1053fd(0x17e))/0x1*(-parseInt(_0x1053fd(0x189))/0x2)+parseInt(_0x1053fd(0x17a))/0x3*(-parseInt(_0x1053fd(0x196))/0x4)+parseInt(_0x1053fd(0x190))/0x5+parseInt(_0x1053fd(0x193))/0x6+-parseInt(_0x1053fd(0x18d))/0x7+parseInt(_0x1053fd(0x185))/0x8+parseInt(_0x1053fd(0x17d))/0x9*(-parseInt(_0x1053fd(0x18e))/0xa);if(_0x1a78f2===_0xed8040)break;else _0x410b47['push'](_0x410b47['shift']());}catch(_0x40630c){_0x410b47['push'](_0x410b47['shift']());}}}(a36_0x2a00,0xe2ed0));function a36_0x1370(_0x590f4e,_0x2e8ed3){const _0x2a0003=a36_0x2a00();return a36_0x1370=function(_0x1370ce,_0x29b89c){_0x1370ce=_0x1370ce-0x175;let _0x445f32=_0x2a0003[_0x1370ce];return _0x445f32;},a36_0x1370(_0x590f4e,_0x2e8ed3);}var __importDefault=this&&this['__importDefault']||function(_0x1bb9fe){const _0x1521ed=a36_0x1370;return _0x1bb9fe&&_0x1bb9fe[_0x1521ed(0x18c)]?_0x1bb9fe:{'default':_0x1bb9fe};};Object[a36_0x1a0e98(0x18f)](exports,a36_0x1a0e98(0x18c),{'value':!![]}),exports[a36_0x1a0e98(0x182)]=void 0x0;const bcryptjs_1=__importDefault(require(a36_0x1a0e98(0x191))),jsonwebtoken_1=__importDefault(require(a36_0x1a0e98(0x17b))),database_1=__importDefault(require('../config/database')),config_1=require('../config/config');class AuthService{[a36_0x1a0e98(0x178)](_0x4a4cb8){const _0x5310e1=a36_0x1a0e98;return jsonwebtoken_1[_0x5310e1(0x17f)][_0x5310e1(0x17c)](_0x4a4cb8,config_1[_0x5310e1(0x195)]['jwt'][_0x5310e1(0x180)],{'expiresIn':String(config_1[_0x5310e1(0x195)][_0x5310e1(0x179)]['expiresIn'])});}async[a36_0x1a0e98(0x177)](_0x942483){const _0x391897=a36_0x1a0e98,{username:_0x3754a8,password:_0x37cc0e}=_0x942483;if(_0x3754a8===config_1[_0x391897(0x195)][_0x391897(0x176)]['username']){const _0x5c6ce6=await bcryptjs_1[_0x391897(0x17f)][_0x391897(0x186)](_0x37cc0e,config_1[_0x391897(0x195)]['admin']['passwordHash']);if(_0x5c6ce6){const _0x152e97=this[_0x391897(0x178)]({'id':'admin','username':config_1[_0x391897(0x195)][_0x391897(0x176)][_0x391897(0x183)],'role':'admin'});return{'access_token':_0x152e97,'role':_0x391897(0x176)};}}const _0x100fde=await database_1[_0x391897(0x17f)]['shop'][_0x391897(0x187)]({'where':{'username':_0x3754a8},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x100fde)throw new Error(_0x391897(0x181));if(_0x100fde[_0x391897(0x175)]!==_0x391897(0x18b))throw new Error(_0x391897(0x197));const _0x21270b=await bcryptjs_1[_0x391897(0x17f)]['compare'](_0x37cc0e,_0x100fde[_0x391897(0x184)]);if(!_0x21270b)throw new Error(_0x391897(0x181));const _0x25c574=this[_0x391897(0x178)]({'id':_0x100fde['id'],'username':_0x100fde['username'],'role':_0x391897(0x194)});return{'access_token':_0x25c574,'role':_0x391897(0x194),'user':{'id':_0x100fde['id'],'name':_0x100fde[_0x391897(0x18a)],'username':_0x100fde[_0x391897(0x183)]}};}async[a36_0x1a0e98(0x188)](_0x33a8af){const _0x308fed=a36_0x1a0e98;try{const _0x5c0d7a=jsonwebtoken_1['default'][_0x308fed(0x192)](_0x33a8af,config_1[_0x308fed(0x195)][_0x308fed(0x179)][_0x308fed(0x180)]);return _0x5c0d7a;}catch(_0x3a98a8){throw new Error('Invalid\x20token');}}}exports[a36_0x1a0e98(0x182)]=AuthService;