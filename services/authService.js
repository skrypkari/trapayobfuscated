'use strict';function a34_0x2b2b(_0x15bb2f,_0x4993e2){const _0x2e5a7e=a34_0x2e5a();return a34_0x2b2b=function(_0x2b2b6f,_0x4a7e67){_0x2b2b6f=_0x2b2b6f-0x110;let _0x32bcc4=_0x2e5a7e[_0x2b2b6f];return _0x32bcc4;},a34_0x2b2b(_0x15bb2f,_0x4993e2);}function a34_0x2e5a(){const _0xb2ca11=['../config/database','passwordHash','7019IYuJSq','status','625521UERcFv','726072INTrxc','2623208FIJQAr','shop','compare','6ApIuPv','jwt','634015YopYjk','122hfZPkZ','findUnique','AuthService','expiresIn','generateToken','verify','__importDefault','default','1148720afdtwN','__esModule','config','Invalid\x20token','name','password','jsonwebtoken','username','admin','Invalid\x20credentials','1718235JJSDyX','defineProperty','secret','verifyToken'];a34_0x2e5a=function(){return _0xb2ca11;};return a34_0x2e5a();}const a34_0x4224bf=a34_0x2b2b;(function(_0x1e00aa,_0x3d7180){const _0x3ae813=a34_0x2b2b,_0x146ffd=_0x1e00aa();while(!![]){try{const _0x50afa2=-parseInt(_0x3ae813(0x12e))/0x1*(parseInt(_0x3ae813(0x116))/0x2)+parseInt(_0x3ae813(0x130))/0x3+parseInt(_0x3ae813(0x11e))/0x4+-parseInt(_0x3ae813(0x115))/0x5*(parseInt(_0x3ae813(0x113))/0x6)+parseInt(_0x3ae813(0x110))/0x7+parseInt(_0x3ae813(0x131))/0x8+-parseInt(_0x3ae813(0x128))/0x9;if(_0x50afa2===_0x3d7180)break;else _0x146ffd['push'](_0x146ffd['shift']());}catch(_0x32f035){_0x146ffd['push'](_0x146ffd['shift']());}}}(a34_0x2e5a,0x34911));var __importDefault=this&&this[a34_0x4224bf(0x11c)]||function(_0x31559b){const _0x442470=a34_0x4224bf;return _0x31559b&&_0x31559b[_0x442470(0x11f)]?_0x31559b:{'default':_0x31559b};};Object[a34_0x4224bf(0x129)](exports,a34_0x4224bf(0x11f),{'value':!![]}),exports[a34_0x4224bf(0x118)]=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),jsonwebtoken_1=__importDefault(require(a34_0x4224bf(0x124))),database_1=__importDefault(require(a34_0x4224bf(0x12c))),config_1=require('../config/config');class AuthService{[a34_0x4224bf(0x11a)](_0x207d75){const _0x1b40ee=a34_0x4224bf;return jsonwebtoken_1[_0x1b40ee(0x11d)]['sign'](_0x207d75,config_1[_0x1b40ee(0x120)]['jwt'][_0x1b40ee(0x12a)],{'expiresIn':String(config_1[_0x1b40ee(0x120)]['jwt'][_0x1b40ee(0x119)])});}async['login'](_0x1e1c40){const _0x42b749=a34_0x4224bf,{username:_0x23eb57,password:_0x4b60c5}=_0x1e1c40;if(_0x23eb57===config_1['config'][_0x42b749(0x126)]['username']){const _0x9b527=await bcryptjs_1[_0x42b749(0x11d)][_0x42b749(0x112)](_0x4b60c5,config_1['config'][_0x42b749(0x126)][_0x42b749(0x12d)]);if(_0x9b527){const _0x203d61=this[_0x42b749(0x11a)]({'id':_0x42b749(0x126),'username':config_1[_0x42b749(0x120)]['admin'][_0x42b749(0x125)],'role':_0x42b749(0x126)});return{'access_token':_0x203d61,'role':_0x42b749(0x126)};}}const _0x123e5e=await database_1[_0x42b749(0x11d)][_0x42b749(0x111)][_0x42b749(0x117)]({'where':{'username':_0x23eb57},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x123e5e)throw new Error('Invalid\x20credentials');if(_0x123e5e[_0x42b749(0x12f)]!=='ACTIVE')throw new Error('Account\x20is\x20not\x20active');const _0x80a4e2=await bcryptjs_1[_0x42b749(0x11d)][_0x42b749(0x112)](_0x4b60c5,_0x123e5e[_0x42b749(0x123)]);if(!_0x80a4e2)throw new Error(_0x42b749(0x127));const _0x58a6ae=this[_0x42b749(0x11a)]({'id':_0x123e5e['id'],'username':_0x123e5e[_0x42b749(0x125)],'role':_0x42b749(0x111)});return{'access_token':_0x58a6ae,'role':_0x42b749(0x111),'user':{'id':_0x123e5e['id'],'name':_0x123e5e[_0x42b749(0x122)],'username':_0x123e5e['username']}};}async[a34_0x4224bf(0x12b)](_0x544393){const _0x4fe335=a34_0x4224bf;try{const _0x509718=jsonwebtoken_1['default'][_0x4fe335(0x11b)](_0x544393,config_1[_0x4fe335(0x120)][_0x4fe335(0x114)]['secret']);return _0x509718;}catch(_0x22c8f9){throw new Error(_0x4fe335(0x121));}}}exports['AuthService']=AuthService;