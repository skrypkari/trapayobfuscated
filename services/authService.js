'use strict';function a37_0x24ea(_0xdfcaef,_0x26a3d8){const _0x263fd3=a37_0x263f();return a37_0x24ea=function(_0x24eaa3,_0x258740){_0x24eaa3=_0x24eaa3-0x139;let _0xce5c31=_0x263fd3[_0x24eaa3];return _0xce5c31;},a37_0x24ea(_0xdfcaef,_0x26a3d8);}const a37_0x494537=a37_0x24ea;(function(_0x37cc68,_0x3bd307){const _0x12e5e1=a37_0x24ea,_0x12ff4a=_0x37cc68();while(!![]){try{const _0xdd12f6=-parseInt(_0x12e5e1(0x142))/0x1*(parseInt(_0x12e5e1(0x143))/0x2)+parseInt(_0x12e5e1(0x14b))/0x3+-parseInt(_0x12e5e1(0x14a))/0x4*(parseInt(_0x12e5e1(0x151))/0x5)+parseInt(_0x12e5e1(0x140))/0x6*(-parseInt(_0x12e5e1(0x145))/0x7)+-parseInt(_0x12e5e1(0x152))/0x8*(-parseInt(_0x12e5e1(0x144))/0x9)+parseInt(_0x12e5e1(0x153))/0xa+parseInt(_0x12e5e1(0x14f))/0xb;if(_0xdd12f6===_0x3bd307)break;else _0x12ff4a['push'](_0x12ff4a['shift']());}catch(_0x665177){_0x12ff4a['push'](_0x12ff4a['shift']());}}}(a37_0x263f,0xdb671));var __importDefault=this&&this[a37_0x494537(0x15a)]||function(_0x445411){const _0x1c88ac=a37_0x494537;return _0x445411&&_0x445411[_0x1c88ac(0x15d)]?_0x445411:{'default':_0x445411};};Object[a37_0x494537(0x139)](exports,a37_0x494537(0x15d),{'value':!![]}),exports[a37_0x494537(0x155)]=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),jsonwebtoken_1=__importDefault(require('jsonwebtoken')),database_1=__importDefault(require(a37_0x494537(0x15c))),config_1=require(a37_0x494537(0x15b));class AuthService{[a37_0x494537(0x156)](_0x730833){const _0x48ee3d=a37_0x494537;return jsonwebtoken_1[_0x48ee3d(0x13f)][_0x48ee3d(0x158)](_0x730833,config_1['config'][_0x48ee3d(0x14c)][_0x48ee3d(0x14d)],{'expiresIn':String(config_1[_0x48ee3d(0x13d)][_0x48ee3d(0x14c)][_0x48ee3d(0x150)])});}async[a37_0x494537(0x154)](_0x5ebf17){const _0x4e9eab=a37_0x494537,{username:_0x23fc8b,password:_0x26bb1a}=_0x5ebf17;if(_0x23fc8b===config_1[_0x4e9eab(0x13d)]['admin'][_0x4e9eab(0x148)]){const _0x32094e=await bcryptjs_1[_0x4e9eab(0x13f)]['compare'](_0x26bb1a,config_1[_0x4e9eab(0x13d)][_0x4e9eab(0x14e)][_0x4e9eab(0x147)]);if(_0x32094e){const _0x34e4d9=this[_0x4e9eab(0x156)]({'id':_0x4e9eab(0x14e),'username':config_1[_0x4e9eab(0x13d)][_0x4e9eab(0x14e)][_0x4e9eab(0x148)],'role':_0x4e9eab(0x14e)});return{'access_token':_0x34e4d9,'role':'admin'};}}const _0x33127f=await database_1[_0x4e9eab(0x13f)][_0x4e9eab(0x149)][_0x4e9eab(0x13a)]({'where':{'username':_0x23fc8b},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x33127f)throw new Error(_0x4e9eab(0x13c));if(_0x33127f[_0x4e9eab(0x159)]!=='ACTIVE')throw new Error('Account\x20is\x20not\x20active');const _0x1f0a04=await bcryptjs_1[_0x4e9eab(0x13f)][_0x4e9eab(0x141)](_0x26bb1a,_0x33127f[_0x4e9eab(0x157)]);if(!_0x1f0a04)throw new Error(_0x4e9eab(0x13c));const _0x1223ce=this[_0x4e9eab(0x156)]({'id':_0x33127f['id'],'username':_0x33127f[_0x4e9eab(0x148)],'role':'shop'});return{'access_token':_0x1223ce,'role':_0x4e9eab(0x149),'user':{'id':_0x33127f['id'],'name':_0x33127f[_0x4e9eab(0x13e)],'username':_0x33127f[_0x4e9eab(0x148)]}};}async[a37_0x494537(0x13b)](_0x1a8044){const _0x31ee03=a37_0x494537;try{const _0x2eca52=jsonwebtoken_1[_0x31ee03(0x13f)][_0x31ee03(0x146)](_0x1a8044,config_1['config'][_0x31ee03(0x14c)][_0x31ee03(0x14d)]);return _0x2eca52;}catch(_0x20c02a){throw new Error('Invalid\x20token');}}}exports[a37_0x494537(0x155)]=AuthService;function a37_0x263f(){const _0x484d43=['__importDefault','../config/config','../config/database','__esModule','defineProperty','findUnique','verifyToken','Invalid\x20credentials','config','name','default','1285344VntpqX','compare','2nHDmot','1355534iTEUfF','18KRlDBV','56tDreuw','verify','passwordHash','username','shop','4BCVRye','1840491TbkjzW','jwt','secret','admin','21409740yDCrfB','expiresIn','7069555YzLGHB','5097768sDvIui','15476310GDWnLz','login','AuthService','generateToken','password','sign','status'];a37_0x263f=function(){return _0x484d43;};return a37_0x263f();}