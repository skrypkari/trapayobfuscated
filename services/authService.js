'use strict';const a37_0x12ab4a=a37_0x46d9;(function(_0x512fe4,_0x49f165){const _0x259767=a37_0x46d9,_0x1338db=_0x512fe4();while(!![]){try{const _0x58b13d=-parseInt(_0x259767(0x159))/0x1+-parseInt(_0x259767(0x156))/0x2+parseInt(_0x259767(0x14c))/0x3*(-parseInt(_0x259767(0x157))/0x4)+parseInt(_0x259767(0x14a))/0x5+-parseInt(_0x259767(0x167))/0x6*(parseInt(_0x259767(0x164))/0x7)+-parseInt(_0x259767(0x160))/0x8+parseInt(_0x259767(0x16b))/0x9;if(_0x58b13d===_0x49f165)break;else _0x1338db['push'](_0x1338db['shift']());}catch(_0x1977d6){_0x1338db['push'](_0x1338db['shift']());}}}(a37_0x458d,0x22e0b));var __importDefault=this&&this[a37_0x12ab4a(0x14e)]||function(_0x4f22a1){const _0x3bbc12=a37_0x12ab4a;return _0x4f22a1&&_0x4f22a1[_0x3bbc12(0x165)]?_0x4f22a1:{'default':_0x4f22a1};};Object[a37_0x12ab4a(0x14f)](exports,a37_0x12ab4a(0x165),{'value':!![]}),exports['AuthService']=void 0x0;const bcryptjs_1=__importDefault(require(a37_0x12ab4a(0x16a))),jsonwebtoken_1=__importDefault(require(a37_0x12ab4a(0x15b))),database_1=__importDefault(require(a37_0x12ab4a(0x150))),config_1=require(a37_0x12ab4a(0x161));class AuthService{[a37_0x12ab4a(0x155)](_0x5f5b38){const _0x5037df=a37_0x12ab4a;return jsonwebtoken_1[_0x5037df(0x162)][_0x5037df(0x15f)](_0x5f5b38,config_1[_0x5037df(0x158)][_0x5037df(0x15d)][_0x5037df(0x152)],{'expiresIn':String(config_1[_0x5037df(0x158)]['jwt'][_0x5037df(0x154)])});}async[a37_0x12ab4a(0x153)](_0x33c1df){const _0x1071cc=a37_0x12ab4a,{username:_0x5a5749,password:_0x409ca0}=_0x33c1df;if(_0x5a5749===config_1[_0x1071cc(0x158)][_0x1071cc(0x151)][_0x1071cc(0x16d)]){const _0x279d0e=await bcryptjs_1[_0x1071cc(0x162)][_0x1071cc(0x169)](_0x409ca0,config_1[_0x1071cc(0x158)][_0x1071cc(0x151)][_0x1071cc(0x15c)]);if(_0x279d0e){const _0xb9a9c7=this[_0x1071cc(0x155)]({'id':'admin','username':config_1['config'][_0x1071cc(0x151)][_0x1071cc(0x16d)],'role':_0x1071cc(0x151)});return{'access_token':_0xb9a9c7,'role':_0x1071cc(0x151)};}}const _0x374f26=await database_1[_0x1071cc(0x162)][_0x1071cc(0x168)][_0x1071cc(0x15e)]({'where':{'username':_0x5a5749},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x374f26)throw new Error('Invalid\x20credentials');if(_0x374f26[_0x1071cc(0x166)]!==_0x1071cc(0x15a))throw new Error('Account\x20is\x20not\x20active');const _0xfdd470=await bcryptjs_1[_0x1071cc(0x162)][_0x1071cc(0x169)](_0x409ca0,_0x374f26[_0x1071cc(0x14b)]);if(!_0xfdd470)throw new Error(_0x1071cc(0x16c));const _0x5aa3ac=this['generateToken']({'id':_0x374f26['id'],'username':_0x374f26[_0x1071cc(0x16d)],'role':_0x1071cc(0x168)});return{'access_token':_0x5aa3ac,'role':'shop','user':{'id':_0x374f26['id'],'name':_0x374f26['name'],'username':_0x374f26[_0x1071cc(0x16d)]}};}async[a37_0x12ab4a(0x163)](_0x4488bb){const _0x514245=a37_0x12ab4a;try{const _0x230257=jsonwebtoken_1['default'][_0x514245(0x14d)](_0x4488bb,config_1[_0x514245(0x158)]['jwt'][_0x514245(0x152)]);return _0x230257;}catch(_0x32adaa){throw new Error('Invalid\x20token');}}}exports[a37_0x12ab4a(0x149)]=AuthService;function a37_0x46d9(_0x56fa9b,_0x5b444b){const _0x458d2a=a37_0x458d();return a37_0x46d9=function(_0x46d9d0,_0x216c72){_0x46d9d0=_0x46d9d0-0x149;let _0x3e7770=_0x458d2a[_0x46d9d0];return _0x3e7770;},a37_0x46d9(_0x56fa9b,_0x5b444b);}function a37_0x458d(){const _0xd258a8=['255930NfCNzp','password','133134fBacgx','verify','__importDefault','defineProperty','../config/database','admin','secret','login','expiresIn','generateToken','346916fkIfur','4IBjxsN','config','100824ftOtzq','ACTIVE','jsonwebtoken','passwordHash','jwt','findUnique','sign','755744nTQxUW','../config/config','default','verifyToken','7rXPzJz','__esModule','status','1384848UIdKvA','shop','compare','bcryptjs','6620481ICIERp','Invalid\x20credentials','username','AuthService'];a37_0x458d=function(){return _0xd258a8;};return a37_0x458d();}