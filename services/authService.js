'use strict';const a36_0x4749b8=a36_0xbf7d;(function(_0xa2022d,_0x55a494){const _0x22c330=a36_0xbf7d,_0x3e0896=_0xa2022d();while(!![]){try{const _0x1e8dc8=-parseInt(_0x22c330(0x1c1))/0x1*(-parseInt(_0x22c330(0x1b2))/0x2)+parseInt(_0x22c330(0x1b5))/0x3*(-parseInt(_0x22c330(0x1b4))/0x4)+parseInt(_0x22c330(0x1a5))/0x5*(parseInt(_0x22c330(0x1af))/0x6)+-parseInt(_0x22c330(0x1be))/0x7+-parseInt(_0x22c330(0x1ab))/0x8+parseInt(_0x22c330(0x1b8))/0x9*(parseInt(_0x22c330(0x1ad))/0xa)+parseInt(_0x22c330(0x1a7))/0xb;if(_0x1e8dc8===_0x55a494)break;else _0x3e0896['push'](_0x3e0896['shift']());}catch(_0x348140){_0x3e0896['push'](_0x3e0896['shift']());}}}(a36_0x1370,0xd8128));function a36_0xbf7d(_0x5cad46,_0x40385b){const _0x137048=a36_0x1370();return a36_0xbf7d=function(_0xbf7d9a,_0x4975d6){_0xbf7d9a=_0xbf7d9a-0x1a0;let _0x14b945=_0x137048[_0xbf7d9a];return _0x14b945;},a36_0xbf7d(_0x5cad46,_0x40385b);}var __importDefault=this&&this['__importDefault']||function(_0x1c2216){const _0x204c95=a36_0xbf7d;return _0x1c2216&&_0x1c2216[_0x204c95(0x1bc)]?_0x1c2216:{'default':_0x1c2216};};Object['defineProperty'](exports,a36_0x4749b8(0x1bc),{'value':!![]}),exports[a36_0x4749b8(0x1a3)]=void 0x0;function a36_0x1370(){const _0x1875dd=['22410QIpYcg','generateToken','config','522SInfWP','Invalid\x20credentials','shop','Account\x20is\x20not\x20active','__esModule','expiresIn','5029696mxStzd','Invalid\x20token','jsonwebtoken','168666vIjriM','passwordHash','bcryptjs','status','default','secret','password','AuthService','verify','5laJeDU','username','32708313uOmHTE','jwt','name','../config/database','9736800HTylzo','../config/config','206330uJhhLt','login','142566EMbvQA','compare','admin','4OHbxNE','sign','916QuWFSQ'];a36_0x1370=function(){return _0x1875dd;};return a36_0x1370();}const bcryptjs_1=__importDefault(require(a36_0x4749b8(0x1c3))),jsonwebtoken_1=__importDefault(require(a36_0x4749b8(0x1c0))),database_1=__importDefault(require(a36_0x4749b8(0x1aa))),config_1=require(a36_0x4749b8(0x1ac));class AuthService{['generateToken'](_0x141291){const _0x158108=a36_0x4749b8;return jsonwebtoken_1[_0x158108(0x1a0)][_0x158108(0x1b3)](_0x141291,config_1[_0x158108(0x1b7)][_0x158108(0x1a8)][_0x158108(0x1a1)],{'expiresIn':String(config_1[_0x158108(0x1b7)]['jwt'][_0x158108(0x1bd)])});}async[a36_0x4749b8(0x1ae)](_0x274634){const _0x2d3e31=a36_0x4749b8,{username:_0x4746f8,password:_0xfeee62}=_0x274634;if(_0x4746f8===config_1[_0x2d3e31(0x1b7)][_0x2d3e31(0x1b1)][_0x2d3e31(0x1a6)]){const _0x1ea119=await bcryptjs_1[_0x2d3e31(0x1a0)][_0x2d3e31(0x1b0)](_0xfeee62,config_1[_0x2d3e31(0x1b7)][_0x2d3e31(0x1b1)][_0x2d3e31(0x1c2)]);if(_0x1ea119){const _0xb21fba=this[_0x2d3e31(0x1b6)]({'id':_0x2d3e31(0x1b1),'username':config_1[_0x2d3e31(0x1b7)][_0x2d3e31(0x1b1)][_0x2d3e31(0x1a6)],'role':_0x2d3e31(0x1b1)});return{'access_token':_0xb21fba,'role':_0x2d3e31(0x1b1)};}}const _0x1048f9=await database_1[_0x2d3e31(0x1a0)][_0x2d3e31(0x1ba)]['findUnique']({'where':{'username':_0x4746f8},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x1048f9)throw new Error(_0x2d3e31(0x1b9));if(_0x1048f9[_0x2d3e31(0x1c4)]!=='ACTIVE')throw new Error(_0x2d3e31(0x1bb));const _0x1f5811=await bcryptjs_1[_0x2d3e31(0x1a0)][_0x2d3e31(0x1b0)](_0xfeee62,_0x1048f9[_0x2d3e31(0x1a2)]);if(!_0x1f5811)throw new Error('Invalid\x20credentials');const _0x101a7d=this['generateToken']({'id':_0x1048f9['id'],'username':_0x1048f9[_0x2d3e31(0x1a6)],'role':_0x2d3e31(0x1ba)});return{'access_token':_0x101a7d,'role':'shop','user':{'id':_0x1048f9['id'],'name':_0x1048f9[_0x2d3e31(0x1a9)],'username':_0x1048f9['username']}};}async['verifyToken'](_0x49d118){const _0x1988b4=a36_0x4749b8;try{const _0x135ecd=jsonwebtoken_1[_0x1988b4(0x1a0)][_0x1988b4(0x1a4)](_0x49d118,config_1[_0x1988b4(0x1b7)][_0x1988b4(0x1a8)][_0x1988b4(0x1a1)]);return _0x135ecd;}catch(_0x1cb615){throw new Error(_0x1988b4(0x1bf));}}}exports['AuthService']=AuthService;