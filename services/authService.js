'use strict';const a36_0x54e4a3=a36_0x14c2;function a36_0x2a2d(){const _0x11320e=['261592UwBKYq','12aSKFZk','sign','generateToken','passwordHash','compare','1121370RCPcgM','1898568GPOYAk','default','status','verify','__esModule','admin','Account\x20is\x20not\x20active','Invalid\x20credentials','name','shop','username','config','15743979YFnOPO','__importDefault','defineProperty','148825ujqkMW','ACTIVE','822486PmYkxk','jsonwebtoken','AuthService','8vEZiaf','secret','5872426IGiFKX','../config/config','login','../config/database','jwt','password','bcryptjs','findUnique'];a36_0x2a2d=function(){return _0x11320e;};return a36_0x2a2d();}(function(_0x254bdd,_0x4dee0c){const _0x319987=a36_0x14c2,_0x4e4eb2=_0x254bdd();while(!![]){try{const _0x4bc7e2=parseInt(_0x319987(0x139))/0x1+-parseInt(_0x319987(0x13f))/0x2+parseInt(_0x319987(0x12c))/0x3+parseInt(_0x319987(0x13a))/0x4*(-parseInt(_0x319987(0x12a))/0x5)+-parseInt(_0x319987(0x140))/0x6+-parseInt(_0x319987(0x131))/0x7+parseInt(_0x319987(0x12f))/0x8*(parseInt(_0x319987(0x127))/0x9);if(_0x4bc7e2===_0x4dee0c)break;else _0x4e4eb2['push'](_0x4e4eb2['shift']());}catch(_0xdb0724){_0x4e4eb2['push'](_0x4e4eb2['shift']());}}}(a36_0x2a2d,0x7520f));var __importDefault=this&&this[a36_0x54e4a3(0x128)]||function(_0x212b1a){const _0x38d43e=a36_0x54e4a3;return _0x212b1a&&_0x212b1a[_0x38d43e(0x144)]?_0x212b1a:{'default':_0x212b1a};};function a36_0x14c2(_0x1e614b,_0x3090f4){const _0x2a2d2d=a36_0x2a2d();return a36_0x14c2=function(_0x14c29d,_0x118dd){_0x14c29d=_0x14c29d-0x124;let _0x3b2189=_0x2a2d2d[_0x14c29d];return _0x3b2189;},a36_0x14c2(_0x1e614b,_0x3090f4);}Object[a36_0x54e4a3(0x129)](exports,'__esModule',{'value':!![]}),exports[a36_0x54e4a3(0x12e)]=void 0x0;const bcryptjs_1=__importDefault(require(a36_0x54e4a3(0x137))),jsonwebtoken_1=__importDefault(require(a36_0x54e4a3(0x12d))),database_1=__importDefault(require(a36_0x54e4a3(0x134))),config_1=require(a36_0x54e4a3(0x132));class AuthService{[a36_0x54e4a3(0x13c)](_0x3a4d33){const _0x403b54=a36_0x54e4a3;return jsonwebtoken_1[_0x403b54(0x141)][_0x403b54(0x13b)](_0x3a4d33,config_1[_0x403b54(0x126)]['jwt'][_0x403b54(0x130)],{'expiresIn':String(config_1[_0x403b54(0x126)][_0x403b54(0x135)]['expiresIn'])});}async[a36_0x54e4a3(0x133)](_0x2bb352){const _0x2b90ac=a36_0x54e4a3,{username:_0x528d7f,password:_0x174714}=_0x2bb352;if(_0x528d7f===config_1[_0x2b90ac(0x126)]['admin'][_0x2b90ac(0x125)]){const _0x10cb27=await bcryptjs_1['default'][_0x2b90ac(0x13e)](_0x174714,config_1['config'][_0x2b90ac(0x145)][_0x2b90ac(0x13d)]);if(_0x10cb27){const _0x59b575=this[_0x2b90ac(0x13c)]({'id':_0x2b90ac(0x145),'username':config_1[_0x2b90ac(0x126)][_0x2b90ac(0x145)][_0x2b90ac(0x125)],'role':_0x2b90ac(0x145)});return{'access_token':_0x59b575,'role':_0x2b90ac(0x145)};}}const _0x4eec8e=await database_1[_0x2b90ac(0x141)][_0x2b90ac(0x124)][_0x2b90ac(0x138)]({'where':{'username':_0x528d7f},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x4eec8e)throw new Error(_0x2b90ac(0x147));if(_0x4eec8e[_0x2b90ac(0x142)]!==_0x2b90ac(0x12b))throw new Error(_0x2b90ac(0x146));const _0x474db3=await bcryptjs_1[_0x2b90ac(0x141)][_0x2b90ac(0x13e)](_0x174714,_0x4eec8e[_0x2b90ac(0x136)]);if(!_0x474db3)throw new Error(_0x2b90ac(0x147));const _0x2c4bcf=this[_0x2b90ac(0x13c)]({'id':_0x4eec8e['id'],'username':_0x4eec8e[_0x2b90ac(0x125)],'role':_0x2b90ac(0x124)});return{'access_token':_0x2c4bcf,'role':_0x2b90ac(0x124),'user':{'id':_0x4eec8e['id'],'name':_0x4eec8e[_0x2b90ac(0x148)],'username':_0x4eec8e[_0x2b90ac(0x125)]}};}async['verifyToken'](_0x52179e){const _0x5c5504=a36_0x54e4a3;try{const _0x47e039=jsonwebtoken_1['default'][_0x5c5504(0x143)](_0x52179e,config_1[_0x5c5504(0x126)][_0x5c5504(0x135)][_0x5c5504(0x130)]);return _0x47e039;}catch(_0x47e92d){throw new Error('Invalid\x20token');}}}exports[a36_0x54e4a3(0x12e)]=AuthService;