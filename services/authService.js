'use strict';const a36_0x1ab468=a36_0x25d1;function a36_0x25d1(_0x4b1f7d,_0x28c6b4){const _0x4bdba8=a36_0x4bdb();return a36_0x25d1=function(_0x25d17d,_0x3f6192){_0x25d17d=_0x25d17d-0xc8;let _0x10e22f=_0x4bdba8[_0x25d17d];return _0x10e22f;},a36_0x25d1(_0x4b1f7d,_0x28c6b4);}(function(_0x3231cd,_0xd42859){const _0xd8897f=a36_0x25d1,_0x42cc7b=_0x3231cd();while(!![]){try{const _0x4558da=parseInt(_0xd8897f(0xd3))/0x1+parseInt(_0xd8897f(0xe5))/0x2+parseInt(_0xd8897f(0xd9))/0x3+-parseInt(_0xd8897f(0xd1))/0x4*(parseInt(_0xd8897f(0xe4))/0x5)+-parseInt(_0xd8897f(0xcf))/0x6*(-parseInt(_0xd8897f(0xe2))/0x7)+-parseInt(_0xd8897f(0xe9))/0x8+parseInt(_0xd8897f(0xdb))/0x9*(-parseInt(_0xd8897f(0xd8))/0xa);if(_0x4558da===_0xd42859)break;else _0x42cc7b['push'](_0x42cc7b['shift']());}catch(_0xa54605){_0x42cc7b['push'](_0x42cc7b['shift']());}}}(a36_0x4bdb,0x29053));var __importDefault=this&&this[a36_0x1ab468(0xde)]||function(_0x4188c3){const _0x295dfa=a36_0x1ab468;return _0x4188c3&&_0x4188c3[_0x295dfa(0xda)]?_0x4188c3:{'default':_0x4188c3};};function a36_0x4bdb(){const _0x279b2c=['shop','3083590sCSScI','793533qNcHQD','__esModule','9WbTQzG','admin','compare','__importDefault','passwordHash','AuthService','defineProperty','1710737KTwZXA','name','220895mdoENY','525556VtXqhU','secret','jwt','jsonwebtoken','2466464JFPVlk','login','expiresIn','config','verify','../config/config','username','bcryptjs','default','6hKazcB','ACTIVE','28jhLWLK','../config/database','322259dJfLEf','generateToken','verifyToken','Invalid\x20credentials'];a36_0x4bdb=function(){return _0x279b2c;};return a36_0x4bdb();}Object[a36_0x1ab468(0xe1)](exports,a36_0x1ab468(0xda),{'value':!![]}),exports[a36_0x1ab468(0xe0)]=void 0x0;const bcryptjs_1=__importDefault(require(a36_0x1ab468(0xcd))),jsonwebtoken_1=__importDefault(require(a36_0x1ab468(0xe8))),database_1=__importDefault(require(a36_0x1ab468(0xd2))),config_1=require(a36_0x1ab468(0xcb));class AuthService{[a36_0x1ab468(0xd4)](_0x4d0bd3){const _0x3fd2d3=a36_0x1ab468;return jsonwebtoken_1[_0x3fd2d3(0xce)]['sign'](_0x4d0bd3,config_1[_0x3fd2d3(0xc9)]['jwt'][_0x3fd2d3(0xe6)],{'expiresIn':String(config_1[_0x3fd2d3(0xc9)][_0x3fd2d3(0xe7)][_0x3fd2d3(0xc8)])});}async[a36_0x1ab468(0xea)](_0x44484f){const _0x196549=a36_0x1ab468,{username:_0x23d3f7,password:_0x3a7b85}=_0x44484f;if(_0x23d3f7===config_1[_0x196549(0xc9)]['admin'][_0x196549(0xcc)]){const _0x1f1e95=await bcryptjs_1['default'][_0x196549(0xdd)](_0x3a7b85,config_1['config'][_0x196549(0xdc)][_0x196549(0xdf)]);if(_0x1f1e95){const _0x47221d=this[_0x196549(0xd4)]({'id':_0x196549(0xdc),'username':config_1[_0x196549(0xc9)][_0x196549(0xdc)][_0x196549(0xcc)],'role':_0x196549(0xdc)});return{'access_token':_0x47221d,'role':'admin'};}}const _0x4896d9=await database_1[_0x196549(0xce)][_0x196549(0xd7)]['findUnique']({'where':{'username':_0x23d3f7},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x4896d9)throw new Error(_0x196549(0xd6));if(_0x4896d9['status']!==_0x196549(0xd0))throw new Error('Account\x20is\x20not\x20active');const _0x2ed72d=await bcryptjs_1[_0x196549(0xce)][_0x196549(0xdd)](_0x3a7b85,_0x4896d9['password']);if(!_0x2ed72d)throw new Error('Invalid\x20credentials');const _0x4430be=this[_0x196549(0xd4)]({'id':_0x4896d9['id'],'username':_0x4896d9[_0x196549(0xcc)],'role':_0x196549(0xd7)});return{'access_token':_0x4430be,'role':_0x196549(0xd7),'user':{'id':_0x4896d9['id'],'name':_0x4896d9[_0x196549(0xe3)],'username':_0x4896d9[_0x196549(0xcc)]}};}async[a36_0x1ab468(0xd5)](_0x231f73){const _0x3f644f=a36_0x1ab468;try{const _0x403943=jsonwebtoken_1[_0x3f644f(0xce)][_0x3f644f(0xca)](_0x231f73,config_1[_0x3f644f(0xc9)][_0x3f644f(0xe7)]['secret']);return _0x403943;}catch(_0x1a4039){throw new Error('Invalid\x20token');}}}exports[a36_0x1ab468(0xe0)]=AuthService;