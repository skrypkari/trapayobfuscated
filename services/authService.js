'use strict';const a37_0x692b44=a37_0x683e;function a37_0x683e(_0x15562f,_0x4282f1){const _0x1cb3d4=a37_0x1cb3();return a37_0x683e=function(_0x683e3a,_0x468266){_0x683e3a=_0x683e3a-0x111;let _0x1838eb=_0x1cb3d4[_0x683e3a];return _0x1838eb;},a37_0x683e(_0x15562f,_0x4282f1);}function a37_0x1cb3(){const _0x5734dc=['defineProperty','secret','expiresIn','2097uJHynF','sign','2yvdITd','bcryptjs','ACTIVE','config','Account\x20is\x20not\x20active','11020EISKrM','AuthService','__importDefault','admin','username','login','compare','43047rYtVqi','28kWdtQw','144205qfyyQe','jwt','5292089HSknAD','default','generateToken','findUnique','85809rsptfU','48SYQMor','../config/database','jsonwebtoken','name','../config/config','__esModule','24IMwebR','passwordHash','password','shop','274632urpaip','1785468bnbuFn','Invalid\x20credentials'];a37_0x1cb3=function(){return _0x5734dc;};return a37_0x1cb3();}(function(_0x3c6b4d,_0x202683){const _0x2c3a10=a37_0x683e,_0x2de020=_0x3c6b4d();while(!![]){try{const _0x177941=parseInt(_0x2c3a10(0x124))/0x1*(parseInt(_0x2c3a10(0x137))/0x2)+-parseInt(_0x2c3a10(0x11c))/0x3*(parseInt(_0x2c3a10(0x125))/0x4)+-parseInt(_0x2c3a10(0x11e))/0x5*(parseInt(_0x2c3a10(0x12b))/0x6)+-parseInt(_0x2c3a10(0x11d))/0x7*(parseInt(_0x2c3a10(0x12f))/0x8)+-parseInt(_0x2c3a10(0x135))/0x9*(-parseInt(_0x2c3a10(0x115))/0xa)+parseInt(_0x2c3a10(0x120))/0xb+-parseInt(_0x2c3a10(0x130))/0xc;if(_0x177941===_0x202683)break;else _0x2de020['push'](_0x2de020['shift']());}catch(_0x9dbe99){_0x2de020['push'](_0x2de020['shift']());}}}(a37_0x1cb3,0x3d0a1));var __importDefault=this&&this[a37_0x692b44(0x117)]||function(_0x76a75f){const _0x45a41=a37_0x692b44;return _0x76a75f&&_0x76a75f[_0x45a41(0x12a)]?_0x76a75f:{'default':_0x76a75f};};Object[a37_0x692b44(0x132)](exports,a37_0x692b44(0x12a),{'value':!![]}),exports[a37_0x692b44(0x116)]=void 0x0;const bcryptjs_1=__importDefault(require(a37_0x692b44(0x111))),jsonwebtoken_1=__importDefault(require(a37_0x692b44(0x127))),database_1=__importDefault(require(a37_0x692b44(0x126))),config_1=require(a37_0x692b44(0x129));class AuthService{[a37_0x692b44(0x122)](_0x53694d){const _0x11273a=a37_0x692b44;return jsonwebtoken_1[_0x11273a(0x121)][_0x11273a(0x136)](_0x53694d,config_1[_0x11273a(0x113)][_0x11273a(0x11f)][_0x11273a(0x133)],{'expiresIn':String(config_1[_0x11273a(0x113)][_0x11273a(0x11f)][_0x11273a(0x134)])});}async[a37_0x692b44(0x11a)](_0x5220a1){const _0x1729ef=a37_0x692b44,{username:_0x101df1,password:_0x515b30}=_0x5220a1;if(_0x101df1===config_1[_0x1729ef(0x113)][_0x1729ef(0x118)][_0x1729ef(0x119)]){const _0x1abc90=await bcryptjs_1[_0x1729ef(0x121)][_0x1729ef(0x11b)](_0x515b30,config_1['config'][_0x1729ef(0x118)][_0x1729ef(0x12c)]);if(_0x1abc90){const _0x384461=this[_0x1729ef(0x122)]({'id':_0x1729ef(0x118),'username':config_1[_0x1729ef(0x113)][_0x1729ef(0x118)][_0x1729ef(0x119)],'role':_0x1729ef(0x118)});return{'access_token':_0x384461,'role':_0x1729ef(0x118)};}}const _0x3c51e4=await database_1[_0x1729ef(0x121)][_0x1729ef(0x12e)][_0x1729ef(0x123)]({'where':{'username':_0x101df1},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x3c51e4)throw new Error(_0x1729ef(0x131));if(_0x3c51e4['status']!==_0x1729ef(0x112))throw new Error(_0x1729ef(0x114));const _0x36e3bb=await bcryptjs_1['default'][_0x1729ef(0x11b)](_0x515b30,_0x3c51e4[_0x1729ef(0x12d)]);if(!_0x36e3bb)throw new Error(_0x1729ef(0x131));const _0x52ee5e=this[_0x1729ef(0x122)]({'id':_0x3c51e4['id'],'username':_0x3c51e4['username'],'role':'shop'});return{'access_token':_0x52ee5e,'role':_0x1729ef(0x12e),'user':{'id':_0x3c51e4['id'],'name':_0x3c51e4[_0x1729ef(0x128)],'username':_0x3c51e4[_0x1729ef(0x119)]}};}async['verifyToken'](_0x354419){const _0x5995a6=a37_0x692b44;try{const _0x6f690c=jsonwebtoken_1[_0x5995a6(0x121)]['verify'](_0x354419,config_1[_0x5995a6(0x113)][_0x5995a6(0x11f)][_0x5995a6(0x133)]);return _0x6f690c;}catch(_0xb4ce63){throw new Error('Invalid\x20token');}}}exports[a37_0x692b44(0x116)]=AuthService;