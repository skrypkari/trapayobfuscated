'use strict';const a36_0x597fa2=a36_0xd62e;(function(_0x47c989,_0x43e09c){const _0x42556f=a36_0xd62e,_0x5d44a6=_0x47c989();while(!![]){try{const _0x170fa6=-parseInt(_0x42556f(0x137))/0x1+-parseInt(_0x42556f(0x13a))/0x2+-parseInt(_0x42556f(0x13c))/0x3+parseInt(_0x42556f(0x14b))/0x4+-parseInt(_0x42556f(0x133))/0x5+parseInt(_0x42556f(0x136))/0x6*(parseInt(_0x42556f(0x139))/0x7)+-parseInt(_0x42556f(0x131))/0x8*(-parseInt(_0x42556f(0x138))/0x9);if(_0x170fa6===_0x43e09c)break;else _0x5d44a6['push'](_0x5d44a6['shift']());}catch(_0x22852b){_0x5d44a6['push'](_0x5d44a6['shift']());}}}(a36_0x1bc9,0x5441d));function a36_0xd62e(_0x19913e,_0x40f75f){const _0x1bc9cb=a36_0x1bc9();return a36_0xd62e=function(_0xd62eca,_0x4a7ce5){_0xd62eca=_0xd62eca-0x12e;let _0x543aaf=_0x1bc9cb[_0xd62eca];return _0x543aaf;},a36_0xd62e(_0x19913e,_0x40f75f);}var __importDefault=this&&this['__importDefault']||function(_0x4fe5aa){const _0x4be4ca=a36_0xd62e;return _0x4fe5aa&&_0x4fe5aa[_0x4be4ca(0x140)]?_0x4fe5aa:{'default':_0x4fe5aa};};Object[a36_0x597fa2(0x13f)](exports,a36_0x597fa2(0x140),{'value':!![]}),exports[a36_0x597fa2(0x135)]=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),jsonwebtoken_1=__importDefault(require(a36_0x597fa2(0x13d))),database_1=__importDefault(require(a36_0x597fa2(0x14a))),config_1=require(a36_0x597fa2(0x14e));class AuthService{[a36_0x597fa2(0x146)](_0x2fcbb4){const _0x28d28e=a36_0x597fa2;return jsonwebtoken_1[_0x28d28e(0x144)][_0x28d28e(0x149)](_0x2fcbb4,config_1[_0x28d28e(0x12f)][_0x28d28e(0x141)]['secret'],{'expiresIn':String(config_1[_0x28d28e(0x12f)][_0x28d28e(0x141)][_0x28d28e(0x145)])});}async['login'](_0x2474bb){const _0x1399c6=a36_0x597fa2,{username:_0x49e262,password:_0x51d984}=_0x2474bb;if(_0x49e262===config_1[_0x1399c6(0x12f)]['admin']['username']){const _0x4511c7=await bcryptjs_1[_0x1399c6(0x144)][_0x1399c6(0x13e)](_0x51d984,config_1[_0x1399c6(0x12f)]['admin']['passwordHash']);if(_0x4511c7){const _0xb1bbe9=this[_0x1399c6(0x146)]({'id':_0x1399c6(0x148),'username':config_1[_0x1399c6(0x12f)][_0x1399c6(0x148)][_0x1399c6(0x147)],'role':_0x1399c6(0x148)});return{'access_token':_0xb1bbe9,'role':_0x1399c6(0x148)};}}const _0x3d3765=await database_1['default']['shop']['findUnique']({'where':{'username':_0x49e262},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x3d3765)throw new Error(_0x1399c6(0x13b));if(_0x3d3765[_0x1399c6(0x134)]!==_0x1399c6(0x130))throw new Error('Account\x20is\x20not\x20active');const _0x166669=await bcryptjs_1[_0x1399c6(0x144)][_0x1399c6(0x13e)](_0x51d984,_0x3d3765[_0x1399c6(0x142)]);if(!_0x166669)throw new Error('Invalid\x20credentials');const _0x27c549=this['generateToken']({'id':_0x3d3765['id'],'username':_0x3d3765['username'],'role':_0x1399c6(0x14c)});return{'access_token':_0x27c549,'role':_0x1399c6(0x14c),'user':{'id':_0x3d3765['id'],'name':_0x3d3765[_0x1399c6(0x132)],'username':_0x3d3765[_0x1399c6(0x147)]}};}async[a36_0x597fa2(0x143)](_0x54ca1a){const _0x2d3b69=a36_0x597fa2;try{const _0x35b3b1=jsonwebtoken_1[_0x2d3b69(0x144)][_0x2d3b69(0x14d)](_0x54ca1a,config_1[_0x2d3b69(0x12f)][_0x2d3b69(0x141)][_0x2d3b69(0x12e)]);return _0x35b3b1;}catch(_0x152f43){throw new Error('Invalid\x20token');}}}exports['AuthService']=AuthService;function a36_0x1bc9(){const _0x52de4b=['24itsDzl','name','203325RYOBFb','status','AuthService','4009182PUnLav','50241FGBWtQ','1412541mLooSO','7zvPGKW','512386NkJBBl','Invalid\x20credentials','1787340tPjqsl','jsonwebtoken','compare','defineProperty','__esModule','jwt','password','verifyToken','default','expiresIn','generateToken','username','admin','sign','../config/database','595808xrukHa','shop','verify','../config/config','secret','config','ACTIVE'];a36_0x1bc9=function(){return _0x52de4b;};return a36_0x1bc9();}