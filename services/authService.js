'use strict';const a36_0x57e124=a36_0x1ceb;function a36_0x3aa7(){const _0x300d58=['107361RSrZLb','login','expiresIn','admin','2628915nallTZ','6ApIvSN','name','verify','secret','190hXaXCO','1592788KPtWXE','1764973RlcczM','AuthService','__importDefault','jsonwebtoken','default','22yJRyeA','config','passwordHash','Invalid\x20credentials','jwt','shop','ACTIVE','3SyWSjl','4641824LFhJQX','44zRukgG','verifyToken','__esModule','sign','../config/database','username','status','39352NtjFin','compare','1102728inFOLs','password','findUnique','Account\x20is\x20not\x20active','generateToken','Invalid\x20token'];a36_0x3aa7=function(){return _0x300d58;};return a36_0x3aa7();}(function(_0x3d33c2,_0xc9bdeb){const _0x60eed0=a36_0x1ceb,_0x773c91=_0x3d33c2();while(!![]){try{const _0x30d845=parseInt(_0x60eed0(0xc1))/0x1*(parseInt(_0x60eed0(0xc8))/0x2)+-parseInt(_0x60eed0(0xbf))/0x3*(-parseInt(_0x60eed0(0xb2))/0x4)+parseInt(_0x60eed0(0xd4))/0x5+-parseInt(_0x60eed0(0xad))/0x6*(parseInt(_0x60eed0(0xb3))/0x7)+-parseInt(_0x60eed0(0xc0))/0x8+parseInt(_0x60eed0(0xd0))/0x9*(-parseInt(_0x60eed0(0xb1))/0xa)+parseInt(_0x60eed0(0xb8))/0xb*(-parseInt(_0x60eed0(0xca))/0xc);if(_0x30d845===_0xc9bdeb)break;else _0x773c91['push'](_0x773c91['shift']());}catch(_0xcd6452){_0x773c91['push'](_0x773c91['shift']());}}}(a36_0x3aa7,0x85866));var __importDefault=this&&this[a36_0x57e124(0xb5)]||function(_0xb5fc09){return _0xb5fc09&&_0xb5fc09['__esModule']?_0xb5fc09:{'default':_0xb5fc09};};Object['defineProperty'](exports,a36_0x57e124(0xc3),{'value':!![]}),exports[a36_0x57e124(0xb4)]=void 0x0;function a36_0x1ceb(_0x336e13,_0x3ed997){const _0x3aa7e5=a36_0x3aa7();return a36_0x1ceb=function(_0x1ceb1b,_0x70f65e){_0x1ceb1b=_0x1ceb1b-0xad;let _0x8a0404=_0x3aa7e5[_0x1ceb1b];return _0x8a0404;},a36_0x1ceb(_0x336e13,_0x3ed997);}const bcryptjs_1=__importDefault(require('bcryptjs')),jsonwebtoken_1=__importDefault(require(a36_0x57e124(0xb6))),database_1=__importDefault(require(a36_0x57e124(0xc5))),config_1=require('../config/config');class AuthService{[a36_0x57e124(0xce)](_0x2e987d){const _0x238e1b=a36_0x57e124;return jsonwebtoken_1['default'][_0x238e1b(0xc4)](_0x2e987d,config_1[_0x238e1b(0xb9)][_0x238e1b(0xbc)][_0x238e1b(0xb0)],{'expiresIn':String(config_1[_0x238e1b(0xb9)][_0x238e1b(0xbc)][_0x238e1b(0xd2)])});}async[a36_0x57e124(0xd1)](_0x578a0b){const _0x4e824a=a36_0x57e124,{username:_0x334da2,password:_0x1d5fa8}=_0x578a0b;if(_0x334da2===config_1['config'][_0x4e824a(0xd3)][_0x4e824a(0xc6)]){const _0x56a070=await bcryptjs_1[_0x4e824a(0xb7)][_0x4e824a(0xc9)](_0x1d5fa8,config_1[_0x4e824a(0xb9)][_0x4e824a(0xd3)][_0x4e824a(0xba)]);if(_0x56a070){const _0x5cdd9e=this[_0x4e824a(0xce)]({'id':_0x4e824a(0xd3),'username':config_1[_0x4e824a(0xb9)]['admin'][_0x4e824a(0xc6)],'role':_0x4e824a(0xd3)});return{'access_token':_0x5cdd9e,'role':'admin'};}}const _0x3d9555=await database_1[_0x4e824a(0xb7)][_0x4e824a(0xbd)][_0x4e824a(0xcc)]({'where':{'username':_0x334da2},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x3d9555)throw new Error(_0x4e824a(0xbb));if(_0x3d9555[_0x4e824a(0xc7)]!==_0x4e824a(0xbe))throw new Error(_0x4e824a(0xcd));const _0x1b7d8a=await bcryptjs_1[_0x4e824a(0xb7)][_0x4e824a(0xc9)](_0x1d5fa8,_0x3d9555[_0x4e824a(0xcb)]);if(!_0x1b7d8a)throw new Error(_0x4e824a(0xbb));const _0x1dec4e=this[_0x4e824a(0xce)]({'id':_0x3d9555['id'],'username':_0x3d9555['username'],'role':_0x4e824a(0xbd)});return{'access_token':_0x1dec4e,'role':_0x4e824a(0xbd),'user':{'id':_0x3d9555['id'],'name':_0x3d9555[_0x4e824a(0xae)],'username':_0x3d9555[_0x4e824a(0xc6)]}};}async[a36_0x57e124(0xc2)](_0xd01109){const _0x173810=a36_0x57e124;try{const _0x4c6074=jsonwebtoken_1[_0x173810(0xb7)][_0x173810(0xaf)](_0xd01109,config_1[_0x173810(0xb9)]['jwt'][_0x173810(0xb0)]);return _0x4c6074;}catch(_0x1ef4f9){throw new Error(_0x173810(0xcf));}}}exports[a36_0x57e124(0xb4)]=AuthService;