'use strict';const a37_0xd4e137=a37_0x3da8;(function(_0x357bf6,_0x516b43){const _0x41fe99=a37_0x3da8,_0x135803=_0x357bf6();while(!![]){try{const _0x2085a8=parseInt(_0x41fe99(0x181))/0x1+parseInt(_0x41fe99(0x18e))/0x2*(parseInt(_0x41fe99(0x176))/0x3)+-parseInt(_0x41fe99(0x17f))/0x4*(parseInt(_0x41fe99(0x185))/0x5)+-parseInt(_0x41fe99(0x18f))/0x6+parseInt(_0x41fe99(0x18b))/0x7+parseInt(_0x41fe99(0x195))/0x8+-parseInt(_0x41fe99(0x193))/0x9*(parseInt(_0x41fe99(0x177))/0xa);if(_0x2085a8===_0x516b43)break;else _0x135803['push'](_0x135803['shift']());}catch(_0x35598a){_0x135803['push'](_0x135803['shift']());}}}(a37_0x4121,0xeb4a8));var __importDefault=this&&this[a37_0xd4e137(0x196)]||function(_0x19e486){return _0x19e486&&_0x19e486['__esModule']?_0x19e486:{'default':_0x19e486};};Object[a37_0xd4e137(0x18d)](exports,a37_0xd4e137(0x17d),{'value':!![]}),exports[a37_0xd4e137(0x179)]=void 0x0;function a37_0x3da8(_0x4f0bb2,_0x2592ad){const _0x412180=a37_0x4121();return a37_0x3da8=function(_0x3da836,_0x22eb06){_0x3da836=_0x3da836-0x176;let _0x29975a=_0x412180[_0x3da836];return _0x29975a;},a37_0x3da8(_0x4f0bb2,_0x2592ad);}const bcryptjs_1=__importDefault(require(a37_0xd4e137(0x183))),jsonwebtoken_1=__importDefault(require(a37_0xd4e137(0x198))),database_1=__importDefault(require(a37_0xd4e137(0x182))),config_1=require('../config/config');class AuthService{['generateToken'](_0x1c72be){const _0x114b8f=a37_0xd4e137;return jsonwebtoken_1[_0x114b8f(0x187)]['sign'](_0x1c72be,config_1[_0x114b8f(0x191)][_0x114b8f(0x19a)][_0x114b8f(0x186)],{'expiresIn':String(config_1['config'][_0x114b8f(0x19a)][_0x114b8f(0x18c)])});}async[a37_0xd4e137(0x184)](_0x2e0141){const _0x4bd52d=a37_0xd4e137,{username:_0x2b26a0,password:_0x3594ed}=_0x2e0141;if(_0x2b26a0===config_1[_0x4bd52d(0x191)][_0x4bd52d(0x17b)][_0x4bd52d(0x17e)]){const _0x43c9e5=await bcryptjs_1[_0x4bd52d(0x187)][_0x4bd52d(0x17c)](_0x3594ed,config_1[_0x4bd52d(0x191)][_0x4bd52d(0x17b)][_0x4bd52d(0x190)]);if(_0x43c9e5){const _0x111e0b=this[_0x4bd52d(0x194)]({'id':_0x4bd52d(0x17b),'username':config_1['config'][_0x4bd52d(0x17b)][_0x4bd52d(0x17e)],'role':_0x4bd52d(0x17b)});return{'access_token':_0x111e0b,'role':'admin'};}}const _0x182a8e=await database_1[_0x4bd52d(0x187)][_0x4bd52d(0x189)]['findUnique']({'where':{'username':_0x2b26a0},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x182a8e)throw new Error(_0x4bd52d(0x199));if(_0x182a8e['status']!==_0x4bd52d(0x17a))throw new Error(_0x4bd52d(0x192));const _0x4a1bd3=await bcryptjs_1[_0x4bd52d(0x187)][_0x4bd52d(0x17c)](_0x3594ed,_0x182a8e[_0x4bd52d(0x180)]);if(!_0x4a1bd3)throw new Error(_0x4bd52d(0x199));const _0x2c37b9=this['generateToken']({'id':_0x182a8e['id'],'username':_0x182a8e[_0x4bd52d(0x17e)],'role':_0x4bd52d(0x189)});return{'access_token':_0x2c37b9,'role':_0x4bd52d(0x189),'user':{'id':_0x182a8e['id'],'name':_0x182a8e[_0x4bd52d(0x178)],'username':_0x182a8e[_0x4bd52d(0x17e)]}};}async[a37_0xd4e137(0x188)](_0x37afb6){const _0x29c15f=a37_0xd4e137;try{const _0x3fe6ab=jsonwebtoken_1[_0x29c15f(0x187)][_0x29c15f(0x18a)](_0x37afb6,config_1[_0x29c15f(0x191)][_0x29c15f(0x19a)][_0x29c15f(0x186)]);return _0x3fe6ab;}catch(_0x1feec3){throw new Error(_0x29c15f(0x197));}}}exports[a37_0xd4e137(0x179)]=AuthService;function a37_0x4121(){const _0x634f5c=['config','Account\x20is\x20not\x20active','531pNKthT','generateToken','13959544NVckhc','__importDefault','Invalid\x20token','jsonwebtoken','Invalid\x20credentials','jwt','6vVTWdR','627690ksbYBR','name','AuthService','ACTIVE','admin','compare','__esModule','username','20WUTMXP','password','1251674BtFLMp','../config/database','bcryptjs','login','46775GriIdM','secret','default','verifyToken','shop','verify','8308797GkQlSU','expiresIn','defineProperty','1278472QNFlBQ','4488972ZDDvmB','passwordHash'];a37_0x4121=function(){return _0x634f5c;};return a37_0x4121();}