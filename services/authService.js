'use strict';const a34_0x40902f=a34_0x4fd1;function a34_0x37bf(){const _0x1d8b06=['status','verifyToken','../config/database','__importDefault','jsonwebtoken','passwordHash','6137032RSGyTV','365481yauvgW','config','4702663XHciQP','Invalid\x20credentials','compare','AuthService','username','ACTIVE','Account\x20is\x20not\x20active','45295SVrdbY','expiresIn','689154HZgmci','9ouluuh','1426743ohdvbQ','name','378UUHdnc','secret','generateToken','bcryptjs','8cxidHP','jwt','login','shop','admin','sign','verify','8681130OopYgv','../config/config','default','defineProperty','password'];a34_0x37bf=function(){return _0x1d8b06;};return a34_0x37bf();}function a34_0x4fd1(_0x354df8,_0x13d7bc){const _0x37bf0b=a34_0x37bf();return a34_0x4fd1=function(_0x4fd128,_0x79d023){_0x4fd128=_0x4fd128-0xee;let _0x5f2158=_0x37bf0b[_0x4fd128];return _0x5f2158;},a34_0x4fd1(_0x354df8,_0x13d7bc);}(function(_0x4c9338,_0x1a0ed8){const _0xae581a=a34_0x4fd1,_0x27ccfc=_0x4c9338();while(!![]){try{const _0x1698a6=parseInt(_0xae581a(0xf2))/0x1+-parseInt(_0xae581a(0xfd))/0x2+-parseInt(_0xae581a(0xff))/0x3*(parseInt(_0xae581a(0x105))/0x4)+parseInt(_0xae581a(0xfb))/0x5*(parseInt(_0xae581a(0x101))/0x6)+-parseInt(_0xae581a(0xf4))/0x7+parseInt(_0xae581a(0xf1))/0x8+-parseInt(_0xae581a(0xfe))/0x9*(-parseInt(_0xae581a(0x10c))/0xa);if(_0x1698a6===_0x1a0ed8)break;else _0x27ccfc['push'](_0x27ccfc['shift']());}catch(_0x47ea40){_0x27ccfc['push'](_0x27ccfc['shift']());}}}(a34_0x37bf,0x936f4));var __importDefault=this&&this[a34_0x40902f(0xee)]||function(_0x31e2fb){return _0x31e2fb&&_0x31e2fb['__esModule']?_0x31e2fb:{'default':_0x31e2fb};};Object[a34_0x40902f(0x10f)](exports,'__esModule',{'value':!![]}),exports[a34_0x40902f(0xf7)]=void 0x0;const bcryptjs_1=__importDefault(require(a34_0x40902f(0x104))),jsonwebtoken_1=__importDefault(require(a34_0x40902f(0xef))),database_1=__importDefault(require(a34_0x40902f(0x113))),config_1=require(a34_0x40902f(0x10d));class AuthService{[a34_0x40902f(0x103)](_0x480c25){const _0x14132f=a34_0x40902f;return jsonwebtoken_1['default'][_0x14132f(0x10a)](_0x480c25,config_1['config'][_0x14132f(0x106)][_0x14132f(0x102)],{'expiresIn':String(config_1['config'][_0x14132f(0x106)][_0x14132f(0xfc)])});}async[a34_0x40902f(0x107)](_0x37395a){const _0x44dc3c=a34_0x40902f,{username:_0x514ca9,password:_0x4fd1c3}=_0x37395a;if(_0x514ca9===config_1[_0x44dc3c(0xf3)]['admin'][_0x44dc3c(0xf8)]){const _0x9eeab1=await bcryptjs_1[_0x44dc3c(0x10e)][_0x44dc3c(0xf6)](_0x4fd1c3,config_1[_0x44dc3c(0xf3)][_0x44dc3c(0x109)][_0x44dc3c(0xf0)]);if(_0x9eeab1){const _0x5a5bce=this[_0x44dc3c(0x103)]({'id':_0x44dc3c(0x109),'username':config_1[_0x44dc3c(0xf3)][_0x44dc3c(0x109)][_0x44dc3c(0xf8)],'role':_0x44dc3c(0x109)});return{'access_token':_0x5a5bce,'role':_0x44dc3c(0x109)};}}const _0x2d123a=await database_1['default'][_0x44dc3c(0x108)]['findUnique']({'where':{'username':_0x514ca9},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x2d123a)throw new Error(_0x44dc3c(0xf5));if(_0x2d123a[_0x44dc3c(0x111)]!==_0x44dc3c(0xf9))throw new Error(_0x44dc3c(0xfa));const _0x1ffa6b=await bcryptjs_1[_0x44dc3c(0x10e)][_0x44dc3c(0xf6)](_0x4fd1c3,_0x2d123a[_0x44dc3c(0x110)]);if(!_0x1ffa6b)throw new Error(_0x44dc3c(0xf5));const _0x434d9e=this[_0x44dc3c(0x103)]({'id':_0x2d123a['id'],'username':_0x2d123a[_0x44dc3c(0xf8)],'role':_0x44dc3c(0x108)});return{'access_token':_0x434d9e,'role':_0x44dc3c(0x108),'user':{'id':_0x2d123a['id'],'name':_0x2d123a[_0x44dc3c(0x100)],'username':_0x2d123a[_0x44dc3c(0xf8)]}};}async[a34_0x40902f(0x112)](_0x52193e){const _0x32714c=a34_0x40902f;try{const _0x361d18=jsonwebtoken_1['default'][_0x32714c(0x10b)](_0x52193e,config_1[_0x32714c(0xf3)][_0x32714c(0x106)][_0x32714c(0x102)]);return _0x361d18;}catch(_0x4d2938){throw new Error('Invalid\x20token');}}}exports['AuthService']=AuthService;