'use strict';const a37_0x1040e5=a37_0x4bd9;(function(_0x351db2,_0x2d89c0){const _0x2512c8=a37_0x4bd9,_0x3b9391=_0x351db2();while(!![]){try{const _0x1db8f3=-parseInt(_0x2512c8(0x1e4))/0x1+-parseInt(_0x2512c8(0x1c5))/0x2*(parseInt(_0x2512c8(0x1d2))/0x3)+-parseInt(_0x2512c8(0x1e1))/0x4*(parseInt(_0x2512c8(0x1d1))/0x5)+parseInt(_0x2512c8(0x1dc))/0x6+parseInt(_0x2512c8(0x1db))/0x7*(parseInt(_0x2512c8(0x1cb))/0x8)+parseInt(_0x2512c8(0x1be))/0x9*(parseInt(_0x2512c8(0x1c6))/0xa)+parseInt(_0x2512c8(0x1c7))/0xb;if(_0x1db8f3===_0x2d89c0)break;else _0x3b9391['push'](_0x3b9391['shift']());}catch(_0x3a37c3){_0x3b9391['push'](_0x3b9391['shift']());}}}(a37_0x4cef,0x52a84));function a37_0x4cef(){const _0xb4cb60=['__importDefault','generateToken','login','1304288RaJicv','verify','../config/config','377199iVmdMo','207rbxOTT','password','__esModule','../config/database','Invalid\x20credentials','passwordHash','AuthService','2enFGju','283670ONzbBT','10506430cvgURt','default','Invalid\x20token','jsonwebtoken','381544RaqNxT','admin','config','sign','jwt','secret','10PewbOV','1297983MOiNmI','status','username','shop','defineProperty','ACTIVE','verifyToken','findUnique','compare','7QVYbSJ','871824LTKxPD','name'];a37_0x4cef=function(){return _0xb4cb60;};return a37_0x4cef();}var __importDefault=this&&this[a37_0x1040e5(0x1de)]||function(_0x266f35){const _0xbae240=a37_0x1040e5;return _0x266f35&&_0x266f35[_0xbae240(0x1c0)]?_0x266f35:{'default':_0x266f35};};function a37_0x4bd9(_0x54b9c7,_0x330887){const _0x4cef1f=a37_0x4cef();return a37_0x4bd9=function(_0x4bd937,_0x269263){_0x4bd937=_0x4bd937-0x1be;let _0x5c007d=_0x4cef1f[_0x4bd937];return _0x5c007d;},a37_0x4bd9(_0x54b9c7,_0x330887);}Object[a37_0x1040e5(0x1d6)](exports,a37_0x1040e5(0x1c0),{'value':!![]}),exports['AuthService']=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),jsonwebtoken_1=__importDefault(require(a37_0x1040e5(0x1ca))),database_1=__importDefault(require(a37_0x1040e5(0x1c1))),config_1=require(a37_0x1040e5(0x1e3));class AuthService{[a37_0x1040e5(0x1df)](_0xa9645a){const _0x3838a2=a37_0x1040e5;return jsonwebtoken_1[_0x3838a2(0x1c8)][_0x3838a2(0x1ce)](_0xa9645a,config_1[_0x3838a2(0x1cd)][_0x3838a2(0x1cf)]['secret'],{'expiresIn':String(config_1[_0x3838a2(0x1cd)][_0x3838a2(0x1cf)]['expiresIn'])});}async[a37_0x1040e5(0x1e0)](_0x13ade7){const _0x574628=a37_0x1040e5,{username:_0x3f7334,password:_0x2fbc14}=_0x13ade7;if(_0x3f7334===config_1[_0x574628(0x1cd)][_0x574628(0x1cc)][_0x574628(0x1d4)]){const _0xd1fe5d=await bcryptjs_1[_0x574628(0x1c8)][_0x574628(0x1da)](_0x2fbc14,config_1[_0x574628(0x1cd)][_0x574628(0x1cc)][_0x574628(0x1c3)]);if(_0xd1fe5d){const _0x10823d=this['generateToken']({'id':_0x574628(0x1cc),'username':config_1[_0x574628(0x1cd)]['admin'][_0x574628(0x1d4)],'role':'admin'});return{'access_token':_0x10823d,'role':_0x574628(0x1cc)};}}const _0x495e5d=await database_1[_0x574628(0x1c8)][_0x574628(0x1d5)][_0x574628(0x1d9)]({'where':{'username':_0x3f7334},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x495e5d)throw new Error(_0x574628(0x1c2));if(_0x495e5d[_0x574628(0x1d3)]!==_0x574628(0x1d7))throw new Error('Account\x20is\x20not\x20active');const _0x73ef63=await bcryptjs_1[_0x574628(0x1c8)][_0x574628(0x1da)](_0x2fbc14,_0x495e5d[_0x574628(0x1bf)]);if(!_0x73ef63)throw new Error('Invalid\x20credentials');const _0x3cb27f=this[_0x574628(0x1df)]({'id':_0x495e5d['id'],'username':_0x495e5d[_0x574628(0x1d4)],'role':_0x574628(0x1d5)});return{'access_token':_0x3cb27f,'role':'shop','user':{'id':_0x495e5d['id'],'name':_0x495e5d[_0x574628(0x1dd)],'username':_0x495e5d[_0x574628(0x1d4)]}};}async[a37_0x1040e5(0x1d8)](_0xa2181f){const _0x201c9f=a37_0x1040e5;try{const _0x35d47e=jsonwebtoken_1[_0x201c9f(0x1c8)][_0x201c9f(0x1e2)](_0xa2181f,config_1[_0x201c9f(0x1cd)][_0x201c9f(0x1cf)][_0x201c9f(0x1d0)]);return _0x35d47e;}catch(_0x47900b){throw new Error(_0x201c9f(0x1c9));}}}exports[a37_0x1040e5(0x1c4)]=AuthService;