'use strict';const a39_0x220f9e=a39_0x3590;(function(_0x9455aa,_0xbbd2fb){const _0x2d6825=a39_0x3590,_0x319299=_0x9455aa();while(!![]){try{const _0x5407ff=parseInt(_0x2d6825(0x185))/0x1*(-parseInt(_0x2d6825(0x18b))/0x2)+parseInt(_0x2d6825(0x18c))/0x3*(parseInt(_0x2d6825(0x17a))/0x4)+-parseInt(_0x2d6825(0x17e))/0x5*(-parseInt(_0x2d6825(0x18e))/0x6)+-parseInt(_0x2d6825(0x17d))/0x7+-parseInt(_0x2d6825(0x17b))/0x8+-parseInt(_0x2d6825(0x174))/0x9+-parseInt(_0x2d6825(0x192))/0xa*(-parseInt(_0x2d6825(0x181))/0xb);if(_0x5407ff===_0xbbd2fb)break;else _0x319299['push'](_0x319299['shift']());}catch(_0x30150f){_0x319299['push'](_0x319299['shift']());}}}(a39_0x2767,0x29ea1));function a39_0x3590(_0x52c7fc,_0x1aabe6){const _0x2767e7=a39_0x2767();return a39_0x3590=function(_0x35908b,_0x26d91a){_0x35908b=_0x35908b-0x173;let _0x1bb319=_0x2767e7[_0x35908b];return _0x1bb319;},a39_0x3590(_0x52c7fc,_0x1aabe6);}var __importDefault=this&&this[a39_0x220f9e(0x180)]||function(_0x127567){const _0x45a905=a39_0x220f9e;return _0x127567&&_0x127567[_0x45a905(0x179)]?_0x127567:{'default':_0x127567};};Object[a39_0x220f9e(0x193)](exports,a39_0x220f9e(0x179),{'value':!![]}),exports[a39_0x220f9e(0x187)]=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),jsonwebtoken_1=__importDefault(require('jsonwebtoken')),database_1=__importDefault(require(a39_0x220f9e(0x177))),config_1=require(a39_0x220f9e(0x175));class AuthService{[a39_0x220f9e(0x17c)](_0x518c41){const _0xefd0cc=a39_0x220f9e;return jsonwebtoken_1[_0xefd0cc(0x197)]['sign'](_0x518c41,config_1[_0xefd0cc(0x178)][_0xefd0cc(0x189)][_0xefd0cc(0x182)],{'expiresIn':String(config_1[_0xefd0cc(0x178)][_0xefd0cc(0x189)][_0xefd0cc(0x18a)])});}async[a39_0x220f9e(0x176)](_0x433a1){const _0x4bd383=a39_0x220f9e,{username:_0x329b87,password:_0xe0bf58}=_0x433a1;if(_0x329b87===config_1[_0x4bd383(0x178)][_0x4bd383(0x195)]['username']){const _0x380a61=await bcryptjs_1[_0x4bd383(0x197)][_0x4bd383(0x190)](_0xe0bf58,config_1[_0x4bd383(0x178)][_0x4bd383(0x195)][_0x4bd383(0x186)]);if(_0x380a61){const _0x2e7278=this[_0x4bd383(0x17c)]({'id':_0x4bd383(0x195),'username':config_1[_0x4bd383(0x178)]['admin'][_0x4bd383(0x194)],'role':_0x4bd383(0x195)});return{'access_token':_0x2e7278,'role':_0x4bd383(0x195)};}}const _0x5118ae=await database_1['default'][_0x4bd383(0x173)][_0x4bd383(0x188)]({'where':{'username':_0x329b87},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x5118ae)throw new Error(_0x4bd383(0x183));if(_0x5118ae[_0x4bd383(0x184)]!=='ACTIVE')throw new Error(_0x4bd383(0x196));const _0x51ecba=await bcryptjs_1['default'][_0x4bd383(0x190)](_0xe0bf58,_0x5118ae[_0x4bd383(0x18f)]);if(!_0x51ecba)throw new Error(_0x4bd383(0x183));const _0x254ad4=this[_0x4bd383(0x17c)]({'id':_0x5118ae['id'],'username':_0x5118ae['username'],'role':'shop'});return{'access_token':_0x254ad4,'role':_0x4bd383(0x173),'user':{'id':_0x5118ae['id'],'name':_0x5118ae[_0x4bd383(0x18d)],'username':_0x5118ae[_0x4bd383(0x194)]}};}async[a39_0x220f9e(0x191)](_0x26c6fb){const _0x2f8cbe=a39_0x220f9e;try{const _0x717ce0=jsonwebtoken_1[_0x2f8cbe(0x197)][_0x2f8cbe(0x17f)](_0x26c6fb,config_1[_0x2f8cbe(0x178)][_0x2f8cbe(0x189)][_0x2f8cbe(0x182)]);return _0x717ce0;}catch(_0x21e836){throw new Error('Invalid\x20token');}}}function a39_0x2767(){const _0x4cb447=['110DdnNNU','6dbyKNE','name','6LPJhgt','password','compare','verifyToken','10HUtVny','defineProperty','username','admin','Account\x20is\x20not\x20active','default','shop','72387sopQUw','../config/config','login','../config/database','config','__esModule','340108EmGkEd','1330096TbHcCR','generateToken','885213uoseQr','1651645vziunF','verify','__importDefault','202697mtugAz','secret','Invalid\x20credentials','status','843FuVjMJ','passwordHash','AuthService','findUnique','jwt','expiresIn'];a39_0x2767=function(){return _0x4cb447;};return a39_0x2767();}exports['AuthService']=AuthService;