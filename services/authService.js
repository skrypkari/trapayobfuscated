'use strict';const a36_0x397feb=a36_0x51ac;(function(_0x1efd2d,_0x4ab0a4){const _0x2e9c9a=a36_0x51ac,_0x3c734f=_0x1efd2d();while(!![]){try{const _0x2a706d=-parseInt(_0x2e9c9a(0x10f))/0x1*(-parseInt(_0x2e9c9a(0xf3))/0x2)+-parseInt(_0x2e9c9a(0xf9))/0x3*(parseInt(_0x2e9c9a(0xf4))/0x4)+-parseInt(_0x2e9c9a(0xef))/0x5+-parseInt(_0x2e9c9a(0x101))/0x6+-parseInt(_0x2e9c9a(0x10e))/0x7+-parseInt(_0x2e9c9a(0x104))/0x8*(parseInt(_0x2e9c9a(0x110))/0x9)+parseInt(_0x2e9c9a(0xfe))/0xa*(parseInt(_0x2e9c9a(0xfc))/0xb);if(_0x2a706d===_0x4ab0a4)break;else _0x3c734f['push'](_0x3c734f['shift']());}catch(_0x5c31fe){_0x3c734f['push'](_0x3c734f['shift']());}}}(a36_0x176e,0xad534));function a36_0x176e(){const _0x2ac384=['password','verify','6025341EmEFzl','1xLbGqg','6282423sMvwqa','defineProperty','username','jwt','admin','5336120sIjdyw','default','expiresIn','jsonwebtoken','1724456QtJzmU','4CStUDG','bcryptjs','findUnique','sign','config','2852319RWOWES','passwordHash','Invalid\x20token','11owTCnr','secret','41949670tackez','__esModule','../config/config','4622688FUBqxx','Invalid\x20credentials','name','8ttWWYE','verifyToken','AuthService','shop','compare','generateToken','login','../config/database'];a36_0x176e=function(){return _0x2ac384;};return a36_0x176e();}function a36_0x51ac(_0x589f8c,_0x4e06b4){const _0x176e33=a36_0x176e();return a36_0x51ac=function(_0x51ac32,_0x714b55){_0x51ac32=_0x51ac32-0xed;let _0x4141e8=_0x176e33[_0x51ac32];return _0x4141e8;},a36_0x51ac(_0x589f8c,_0x4e06b4);}var __importDefault=this&&this['__importDefault']||function(_0x4a3806){const _0x55bb44=a36_0x51ac;return _0x4a3806&&_0x4a3806[_0x55bb44(0xff)]?_0x4a3806:{'default':_0x4a3806};};Object[a36_0x397feb(0x111)](exports,'__esModule',{'value':!![]}),exports[a36_0x397feb(0x106)]=void 0x0;const bcryptjs_1=__importDefault(require(a36_0x397feb(0xf5))),jsonwebtoken_1=__importDefault(require(a36_0x397feb(0xf2))),database_1=__importDefault(require(a36_0x397feb(0x10b))),config_1=require(a36_0x397feb(0x100));class AuthService{['generateToken'](_0x5d8cac){const _0x57d705=a36_0x397feb;return jsonwebtoken_1['default'][_0x57d705(0xf7)](_0x5d8cac,config_1[_0x57d705(0xf8)][_0x57d705(0xed)][_0x57d705(0xfd)],{'expiresIn':String(config_1[_0x57d705(0xf8)][_0x57d705(0xed)][_0x57d705(0xf1)])});}async[a36_0x397feb(0x10a)](_0x56a2af){const _0x7d9530=a36_0x397feb,{username:_0x53a0d8,password:_0x2cb8d5}=_0x56a2af;if(_0x53a0d8===config_1['config'][_0x7d9530(0xee)][_0x7d9530(0x112)]){const _0x2cbba5=await bcryptjs_1['default'][_0x7d9530(0x108)](_0x2cb8d5,config_1[_0x7d9530(0xf8)]['admin'][_0x7d9530(0xfa)]);if(_0x2cbba5){const _0x5b169d=this[_0x7d9530(0x109)]({'id':_0x7d9530(0xee),'username':config_1[_0x7d9530(0xf8)]['admin']['username'],'role':'admin'});return{'access_token':_0x5b169d,'role':'admin'};}}const _0x29d9ec=await database_1[_0x7d9530(0xf0)][_0x7d9530(0x107)][_0x7d9530(0xf6)]({'where':{'username':_0x53a0d8},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x29d9ec)throw new Error(_0x7d9530(0x102));if(_0x29d9ec['status']!=='ACTIVE')throw new Error('Account\x20is\x20not\x20active');const _0x37d12a=await bcryptjs_1[_0x7d9530(0xf0)][_0x7d9530(0x108)](_0x2cb8d5,_0x29d9ec[_0x7d9530(0x10c)]);if(!_0x37d12a)throw new Error(_0x7d9530(0x102));const _0xb184df=this[_0x7d9530(0x109)]({'id':_0x29d9ec['id'],'username':_0x29d9ec['username'],'role':_0x7d9530(0x107)});return{'access_token':_0xb184df,'role':_0x7d9530(0x107),'user':{'id':_0x29d9ec['id'],'name':_0x29d9ec[_0x7d9530(0x103)],'username':_0x29d9ec[_0x7d9530(0x112)]}};}async[a36_0x397feb(0x105)](_0x8976a0){const _0xc60103=a36_0x397feb;try{const _0x48c817=jsonwebtoken_1[_0xc60103(0xf0)][_0xc60103(0x10d)](_0x8976a0,config_1[_0xc60103(0xf8)][_0xc60103(0xed)][_0xc60103(0xfd)]);return _0x48c817;}catch(_0x57749f){throw new Error(_0xc60103(0xfb));}}}exports['AuthService']=AuthService;