'use strict';const a36_0x28650d=a36_0x5d7a;(function(_0x4effcd,_0x878cae){const _0x419d4a=a36_0x5d7a,_0x40b046=_0x4effcd();while(!![]){try{const _0x2e38cc=-parseInt(_0x419d4a(0x1ea))/0x1*(-parseInt(_0x419d4a(0x1d3))/0x2)+parseInt(_0x419d4a(0x1dd))/0x3+parseInt(_0x419d4a(0x1dc))/0x4*(parseInt(_0x419d4a(0x1e7))/0x5)+parseInt(_0x419d4a(0x1f2))/0x6*(parseInt(_0x419d4a(0x1db))/0x7)+parseInt(_0x419d4a(0x1e8))/0x8+-parseInt(_0x419d4a(0x1f0))/0x9*(-parseInt(_0x419d4a(0x1e4))/0xa)+-parseInt(_0x419d4a(0x1e9))/0xb;if(_0x2e38cc===_0x878cae)break;else _0x40b046['push'](_0x40b046['shift']());}catch(_0x3bf010){_0x40b046['push'](_0x40b046['shift']());}}}(a36_0x35d3,0xa7d63));function a36_0x5d7a(_0x547431,_0xc5991b){const _0x35d3a4=a36_0x35d3();return a36_0x5d7a=function(_0x5d7a00,_0xdbad89){_0x5d7a00=_0x5d7a00-0x1d2;let _0x6644ce=_0x35d3a4[_0x5d7a00];return _0x6644ce;},a36_0x5d7a(_0x547431,_0xc5991b);}var __importDefault=this&&this[a36_0x28650d(0x1d7)]||function(_0x19352d){const _0x2e563b=a36_0x28650d;return _0x19352d&&_0x19352d[_0x2e563b(0x1d6)]?_0x19352d:{'default':_0x19352d};};Object['defineProperty'](exports,a36_0x28650d(0x1d6),{'value':!![]}),exports[a36_0x28650d(0x1e3)]=void 0x0;const bcryptjs_1=__importDefault(require(a36_0x28650d(0x1d2))),jsonwebtoken_1=__importDefault(require(a36_0x28650d(0x1d9))),database_1=__importDefault(require(a36_0x28650d(0x1f4))),config_1=require('../config/config');class AuthService{['generateToken'](_0x43007e){const _0x1c6ac9=a36_0x28650d;return jsonwebtoken_1[_0x1c6ac9(0x1e0)][_0x1c6ac9(0x1f1)](_0x43007e,config_1[_0x1c6ac9(0x1f3)]['jwt'][_0x1c6ac9(0x1de)],{'expiresIn':String(config_1[_0x1c6ac9(0x1f3)]['jwt']['expiresIn'])});}async[a36_0x28650d(0x1ed)](_0x3a465e){const _0x2795ee=a36_0x28650d,{username:_0x8f17f6,password:_0x186ae5}=_0x3a465e;if(_0x8f17f6===config_1[_0x2795ee(0x1f3)][_0x2795ee(0x1e2)][_0x2795ee(0x1ee)]){const _0x2b2cb5=await bcryptjs_1[_0x2795ee(0x1e0)][_0x2795ee(0x1e1)](_0x186ae5,config_1[_0x2795ee(0x1f3)]['admin']['passwordHash']);if(_0x2b2cb5){const _0x2b7732=this['generateToken']({'id':_0x2795ee(0x1e2),'username':config_1[_0x2795ee(0x1f3)][_0x2795ee(0x1e2)][_0x2795ee(0x1ee)],'role':_0x2795ee(0x1e2)});return{'access_token':_0x2b7732,'role':_0x2795ee(0x1e2)};}}const _0x4ddd44=await database_1['default'][_0x2795ee(0x1d5)]['findUnique']({'where':{'username':_0x8f17f6},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x4ddd44)throw new Error(_0x2795ee(0x1eb));if(_0x4ddd44['status']!==_0x2795ee(0x1ec))throw new Error(_0x2795ee(0x1df));const _0x5071b3=await bcryptjs_1[_0x2795ee(0x1e0)][_0x2795ee(0x1e1)](_0x186ae5,_0x4ddd44[_0x2795ee(0x1e6)]);if(!_0x5071b3)throw new Error(_0x2795ee(0x1eb));const _0x493d59=this[_0x2795ee(0x1d4)]({'id':_0x4ddd44['id'],'username':_0x4ddd44[_0x2795ee(0x1ee)],'role':_0x2795ee(0x1d5)});return{'access_token':_0x493d59,'role':_0x2795ee(0x1d5),'user':{'id':_0x4ddd44['id'],'name':_0x4ddd44[_0x2795ee(0x1da)],'username':_0x4ddd44['username']}};}async[a36_0x28650d(0x1e5)](_0x3681a8){const _0xc95b3c=a36_0x28650d;try{const _0x248078=jsonwebtoken_1[_0xc95b3c(0x1e0)][_0xc95b3c(0x1ef)](_0x3681a8,config_1[_0xc95b3c(0x1f3)]['jwt'][_0xc95b3c(0x1de)]);return _0x248078;}catch(_0xf0cd1d){throw new Error(_0xc95b3c(0x1d8));}}}function a36_0x35d3(){const _0x5b673c=['36dAOjyL','config','../config/database','bcryptjs','4058HycYZQ','generateToken','shop','__esModule','__importDefault','Invalid\x20token','jsonwebtoken','name','422702dqiBvn','135924qyWMSe','3051942sJHawd','secret','Account\x20is\x20not\x20active','default','compare','admin','AuthService','2150VZrCgh','verifyToken','password','85NOqgQy','1629568RZLMyq','22351681HWMdHf','138GrZNtj','Invalid\x20credentials','ACTIVE','login','username','verify','11655dlEAgv','sign'];a36_0x35d3=function(){return _0x5b673c;};return a36_0x35d3();}exports[a36_0x28650d(0x1e3)]=AuthService;