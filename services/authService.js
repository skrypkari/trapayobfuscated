'use strict';const a36_0x344bb7=a36_0x53b6;(function(_0x2ac748,_0x4b9d98){const _0x42d036=a36_0x53b6,_0x3b4207=_0x2ac748();while(!![]){try{const _0x4edfd3=parseInt(_0x42d036(0x119))/0x1+parseInt(_0x42d036(0x130))/0x2+parseInt(_0x42d036(0x123))/0x3+-parseInt(_0x42d036(0x12f))/0x4*(-parseInt(_0x42d036(0x120))/0x5)+-parseInt(_0x42d036(0x127))/0x6*(-parseInt(_0x42d036(0x128))/0x7)+-parseInt(_0x42d036(0x113))/0x8+-parseInt(_0x42d036(0x126))/0x9;if(_0x4edfd3===_0x4b9d98)break;else _0x3b4207['push'](_0x3b4207['shift']());}catch(_0x56c0d8){_0x3b4207['push'](_0x3b4207['shift']());}}}(a36_0x2c6d,0xd859a));function a36_0x2c6d(){const _0x2faac5=['__importDefault','6152216mXTyUJ','2742532XgAsDZ','name','bcryptjs','ACTIVE','../config/database','Invalid\x20token','Invalid\x20credentials','compare','username','8867320ChkZwd','defineProperty','__esModule','admin','AuthService','jwt','1740507aGlpGd','login','shop','verifyToken','sign','default','generateToken','5pacxGp','verify','findUnique','4073778GPQGdl','../config/config','config','45475866MDwPyB','804jueAxx','54313qKNjLJ','Account\x20is\x20not\x20active','secret','expiresIn','jsonwebtoken','passwordHash'];a36_0x2c6d=function(){return _0x2faac5;};return a36_0x2c6d();}var __importDefault=this&&this[a36_0x344bb7(0x12e)]||function(_0x125e70){const _0x153f27=a36_0x344bb7;return _0x125e70&&_0x125e70[_0x153f27(0x115)]?_0x125e70:{'default':_0x125e70};};function a36_0x53b6(_0xca7119,_0x35d5d8){const _0x2c6d05=a36_0x2c6d();return a36_0x53b6=function(_0x53b690,_0xacb777){_0x53b690=_0x53b690-0x10f;let _0x373214=_0x2c6d05[_0x53b690];return _0x373214;},a36_0x53b6(_0xca7119,_0x35d5d8);}Object[a36_0x344bb7(0x114)](exports,a36_0x344bb7(0x115),{'value':!![]}),exports[a36_0x344bb7(0x117)]=void 0x0;const bcryptjs_1=__importDefault(require(a36_0x344bb7(0x132))),jsonwebtoken_1=__importDefault(require(a36_0x344bb7(0x12c))),database_1=__importDefault(require(a36_0x344bb7(0x134))),config_1=require(a36_0x344bb7(0x124));class AuthService{['generateToken'](_0x1ccaf2){const _0x405a33=a36_0x344bb7;return jsonwebtoken_1[_0x405a33(0x11e)][_0x405a33(0x11d)](_0x1ccaf2,config_1[_0x405a33(0x125)][_0x405a33(0x118)][_0x405a33(0x12a)],{'expiresIn':String(config_1[_0x405a33(0x125)][_0x405a33(0x118)][_0x405a33(0x12b)])});}async[a36_0x344bb7(0x11a)](_0x2f1f74){const _0x46ede1=a36_0x344bb7,{username:_0x5821f3,password:_0x31aa04}=_0x2f1f74;if(_0x5821f3===config_1['config'][_0x46ede1(0x116)][_0x46ede1(0x112)]){const _0x58170a=await bcryptjs_1['default'][_0x46ede1(0x111)](_0x31aa04,config_1['config'][_0x46ede1(0x116)][_0x46ede1(0x12d)]);if(_0x58170a){const _0x134378=this[_0x46ede1(0x11f)]({'id':_0x46ede1(0x116),'username':config_1[_0x46ede1(0x125)][_0x46ede1(0x116)]['username'],'role':_0x46ede1(0x116)});return{'access_token':_0x134378,'role':'admin'};}}const _0x4c0ce6=await database_1['default'][_0x46ede1(0x11b)][_0x46ede1(0x122)]({'where':{'username':_0x5821f3},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x4c0ce6)throw new Error(_0x46ede1(0x110));if(_0x4c0ce6['status']!==_0x46ede1(0x133))throw new Error(_0x46ede1(0x129));const _0x37ad95=await bcryptjs_1['default']['compare'](_0x31aa04,_0x4c0ce6['password']);if(!_0x37ad95)throw new Error(_0x46ede1(0x110));const _0x2bfc5b=this[_0x46ede1(0x11f)]({'id':_0x4c0ce6['id'],'username':_0x4c0ce6[_0x46ede1(0x112)],'role':_0x46ede1(0x11b)});return{'access_token':_0x2bfc5b,'role':'shop','user':{'id':_0x4c0ce6['id'],'name':_0x4c0ce6[_0x46ede1(0x131)],'username':_0x4c0ce6[_0x46ede1(0x112)]}};}async[a36_0x344bb7(0x11c)](_0x56cf4d){const _0x277c5e=a36_0x344bb7;try{const _0x51833d=jsonwebtoken_1[_0x277c5e(0x11e)][_0x277c5e(0x121)](_0x56cf4d,config_1[_0x277c5e(0x125)]['jwt'][_0x277c5e(0x12a)]);return _0x51833d;}catch(_0x23340f){throw new Error(_0x277c5e(0x10f));}}}exports[a36_0x344bb7(0x117)]=AuthService;