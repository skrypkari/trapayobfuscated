'use strict';const a34_0x2fb9de=a34_0x2e0b;function a34_0x2e0b(_0xe3e622,_0x232b1b){const _0x4213cd=a34_0x4213();return a34_0x2e0b=function(_0x2e0bad,_0x4b7a08){_0x2e0bad=_0x2e0bad-0xd0;let _0x14a5ad=_0x4213cd[_0x2e0bad];return _0x14a5ad;},a34_0x2e0b(_0xe3e622,_0x232b1b);}(function(_0x41a2f7,_0x40a133){const _0x4949b5=a34_0x2e0b,_0x2b9502=_0x41a2f7();while(!![]){try{const _0x377566=-parseInt(_0x4949b5(0xd7))/0x1*(parseInt(_0x4949b5(0xe1))/0x2)+-parseInt(_0x4949b5(0xd0))/0x3+-parseInt(_0x4949b5(0xdb))/0x4*(-parseInt(_0x4949b5(0xd2))/0x5)+-parseInt(_0x4949b5(0xd4))/0x6*(parseInt(_0x4949b5(0xee))/0x7)+-parseInt(_0x4949b5(0xe3))/0x8+parseInt(_0x4949b5(0xed))/0x9*(-parseInt(_0x4949b5(0xec))/0xa)+parseInt(_0x4949b5(0xd9))/0xb;if(_0x377566===_0x40a133)break;else _0x2b9502['push'](_0x2b9502['shift']());}catch(_0x25cb75){_0x2b9502['push'](_0x2b9502['shift']());}}}(a34_0x4213,0x5e76c));function a34_0x4213(){const _0x1a5fde=['ACTIVE','1974711BVRyfm','bcryptjs','850lmoNAF','defineProperty','74058hqevuY','passwordHash','password','146909MiEguu','findUnique','33173668gHCVQi','name','6032JVqeWm','secret','../config/config','status','AuthService','jwt','6tYLqhh','compare','5052088JWgALz','default','Invalid\x20token','Invalid\x20credentials','verify','admin','Account\x20is\x20not\x20active','../config/database','sign','2450290iNQquS','27aVqKuv','238cTqAai','shop','config','__esModule','username','generateToken'];a34_0x4213=function(){return _0x1a5fde;};return a34_0x4213();}var __importDefault=this&&this['__importDefault']||function(_0x1efe67){return _0x1efe67&&_0x1efe67['__esModule']?_0x1efe67:{'default':_0x1efe67};};Object[a34_0x2fb9de(0xd3)](exports,a34_0x2fb9de(0xf1),{'value':!![]}),exports[a34_0x2fb9de(0xdf)]=void 0x0;const bcryptjs_1=__importDefault(require(a34_0x2fb9de(0xd1))),jsonwebtoken_1=__importDefault(require('jsonwebtoken')),database_1=__importDefault(require(a34_0x2fb9de(0xea))),config_1=require(a34_0x2fb9de(0xdd));class AuthService{['generateToken'](_0x498f75){const _0x1e82c0=a34_0x2fb9de;return jsonwebtoken_1['default'][_0x1e82c0(0xeb)](_0x498f75,config_1[_0x1e82c0(0xf0)][_0x1e82c0(0xe0)][_0x1e82c0(0xdc)],{'expiresIn':String(config_1['config'][_0x1e82c0(0xe0)]['expiresIn'])});}async['login'](_0x1cd06b){const _0x3ea23b=a34_0x2fb9de,{username:_0x45a66f,password:_0x34d09d}=_0x1cd06b;if(_0x45a66f===config_1['config'][_0x3ea23b(0xe8)][_0x3ea23b(0xf2)]){const _0x4bd1b1=await bcryptjs_1[_0x3ea23b(0xe4)][_0x3ea23b(0xe2)](_0x34d09d,config_1['config'][_0x3ea23b(0xe8)][_0x3ea23b(0xd5)]);if(_0x4bd1b1){const _0x170415=this['generateToken']({'id':_0x3ea23b(0xe8),'username':config_1[_0x3ea23b(0xf0)][_0x3ea23b(0xe8)]['username'],'role':'admin'});return{'access_token':_0x170415,'role':_0x3ea23b(0xe8)};}}const _0x31a5fe=await database_1['default']['shop'][_0x3ea23b(0xd8)]({'where':{'username':_0x45a66f},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x31a5fe)throw new Error('Invalid\x20credentials');if(_0x31a5fe[_0x3ea23b(0xde)]!==_0x3ea23b(0xf4))throw new Error(_0x3ea23b(0xe9));const _0x42a7ea=await bcryptjs_1[_0x3ea23b(0xe4)]['compare'](_0x34d09d,_0x31a5fe[_0x3ea23b(0xd6)]);if(!_0x42a7ea)throw new Error(_0x3ea23b(0xe6));const _0x564ee6=this[_0x3ea23b(0xf3)]({'id':_0x31a5fe['id'],'username':_0x31a5fe[_0x3ea23b(0xf2)],'role':_0x3ea23b(0xef)});return{'access_token':_0x564ee6,'role':_0x3ea23b(0xef),'user':{'id':_0x31a5fe['id'],'name':_0x31a5fe[_0x3ea23b(0xda)],'username':_0x31a5fe[_0x3ea23b(0xf2)]}};}async['verifyToken'](_0x5b11b3){const _0x4f1be1=a34_0x2fb9de;try{const _0x2aa4d4=jsonwebtoken_1[_0x4f1be1(0xe4)][_0x4f1be1(0xe7)](_0x5b11b3,config_1[_0x4f1be1(0xf0)]['jwt'][_0x4f1be1(0xdc)]);return _0x2aa4d4;}catch(_0x52c681){throw new Error(_0x4f1be1(0xe5));}}}exports[a34_0x2fb9de(0xdf)]=AuthService;