'use strict';const a34_0x16ffd3=a34_0xd98f;(function(_0x31e5fd,_0x4e1886){const _0x23b577=a34_0xd98f,_0x10cde9=_0x31e5fd();while(!![]){try{const _0x5f5aa9=-parseInt(_0x23b577(0x8d))/0x1*(parseInt(_0x23b577(0x93))/0x2)+parseInt(_0x23b577(0x85))/0x3+-parseInt(_0x23b577(0xa2))/0x4*(parseInt(_0x23b577(0x9a))/0x5)+parseInt(_0x23b577(0x90))/0x6+parseInt(_0x23b577(0xa8))/0x7*(-parseInt(_0x23b577(0xa1))/0x8)+parseInt(_0x23b577(0x9b))/0x9*(parseInt(_0x23b577(0xa6))/0xa)+-parseInt(_0x23b577(0x99))/0xb*(-parseInt(_0x23b577(0x9f))/0xc);if(_0x5f5aa9===_0x4e1886)break;else _0x10cde9['push'](_0x10cde9['shift']());}catch(_0x2d7ce0){_0x10cde9['push'](_0x10cde9['shift']());}}}(a34_0x6ee1,0x71c9a));function a34_0x6ee1(){const _0x6d5f35=['bcryptjs','compare','__importDefault','3upwrAk','../config/config','default','3084552PcDPnm','findUnique','username','334538ZlkFOj','../config/database','verifyToken','status','admin','password','11NGjSRu','25yDoWdT','1699335JrKWSq','AuthService','defineProperty','name','11515836rZEMNK','jwt','528848wjAmWJ','322860VYIwRi','secret','verify','__esModule','10FBUbNa','shop','98ESFdev','ACTIVE','Invalid\x20credentials','1903140mTrHRw','passwordHash','Invalid\x20token','config','generateToken'];a34_0x6ee1=function(){return _0x6d5f35;};return a34_0x6ee1();}var __importDefault=this&&this[a34_0x16ffd3(0x8c)]||function(_0x25ce36){return _0x25ce36&&_0x25ce36['__esModule']?_0x25ce36:{'default':_0x25ce36};};function a34_0xd98f(_0x31a8ed,_0x15e47b){const _0x6ee173=a34_0x6ee1();return a34_0xd98f=function(_0xd98f80,_0xcb72d8){_0xd98f80=_0xd98f80-0x85;let _0x55dcd2=_0x6ee173[_0xd98f80];return _0x55dcd2;},a34_0xd98f(_0x31a8ed,_0x15e47b);}Object[a34_0x16ffd3(0x9d)](exports,a34_0x16ffd3(0xa5),{'value':!![]}),exports[a34_0x16ffd3(0x9c)]=void 0x0;const bcryptjs_1=__importDefault(require(a34_0x16ffd3(0x8a))),jsonwebtoken_1=__importDefault(require('jsonwebtoken')),database_1=__importDefault(require(a34_0x16ffd3(0x94))),config_1=require(a34_0x16ffd3(0x8e));class AuthService{[a34_0x16ffd3(0x89)](_0x5c1f23){const _0x1b7993=a34_0x16ffd3;return jsonwebtoken_1[_0x1b7993(0x8f)]['sign'](_0x5c1f23,config_1[_0x1b7993(0x88)][_0x1b7993(0xa0)][_0x1b7993(0xa3)],{'expiresIn':String(config_1['config'][_0x1b7993(0xa0)]['expiresIn'])});}async['login'](_0xf607d4){const _0xd8dc0c=a34_0x16ffd3,{username:_0x15ff04,password:_0x149528}=_0xf607d4;if(_0x15ff04===config_1[_0xd8dc0c(0x88)]['admin'][_0xd8dc0c(0x92)]){const _0x3c9340=await bcryptjs_1[_0xd8dc0c(0x8f)][_0xd8dc0c(0x8b)](_0x149528,config_1[_0xd8dc0c(0x88)][_0xd8dc0c(0x97)][_0xd8dc0c(0x86)]);if(_0x3c9340){const _0x4052a4=this[_0xd8dc0c(0x89)]({'id':'admin','username':config_1[_0xd8dc0c(0x88)]['admin']['username'],'role':'admin'});return{'access_token':_0x4052a4,'role':'admin'};}}const _0x34236d=await database_1[_0xd8dc0c(0x8f)][_0xd8dc0c(0xa7)][_0xd8dc0c(0x91)]({'where':{'username':_0x15ff04},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x34236d)throw new Error(_0xd8dc0c(0xaa));if(_0x34236d[_0xd8dc0c(0x96)]!==_0xd8dc0c(0xa9))throw new Error('Account\x20is\x20not\x20active');const _0x4548f2=await bcryptjs_1[_0xd8dc0c(0x8f)][_0xd8dc0c(0x8b)](_0x149528,_0x34236d[_0xd8dc0c(0x98)]);if(!_0x4548f2)throw new Error(_0xd8dc0c(0xaa));const _0x328eba=this[_0xd8dc0c(0x89)]({'id':_0x34236d['id'],'username':_0x34236d[_0xd8dc0c(0x92)],'role':_0xd8dc0c(0xa7)});return{'access_token':_0x328eba,'role':'shop','user':{'id':_0x34236d['id'],'name':_0x34236d[_0xd8dc0c(0x9e)],'username':_0x34236d[_0xd8dc0c(0x92)]}};}async[a34_0x16ffd3(0x95)](_0xf9e74c){const _0x13a565=a34_0x16ffd3;try{const _0x581dc7=jsonwebtoken_1[_0x13a565(0x8f)][_0x13a565(0xa4)](_0xf9e74c,config_1[_0x13a565(0x88)][_0x13a565(0xa0)][_0x13a565(0xa3)]);return _0x581dc7;}catch(_0x5362df){throw new Error(_0x13a565(0x87));}}}exports[a34_0x16ffd3(0x9c)]=AuthService;