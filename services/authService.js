'use strict';function a37_0x505a(_0x32813f,_0x48cb72){const _0x58048c=a37_0x5804();return a37_0x505a=function(_0x505aae,_0x5f1a4d){_0x505aae=_0x505aae-0x17c;let _0x16fe8e=_0x58048c[_0x505aae];return _0x16fe8e;},a37_0x505a(_0x32813f,_0x48cb72);}const a37_0x55d86f=a37_0x505a;(function(_0x576dc1,_0x50a96a){const _0xc21dcb=a37_0x505a,_0x2c5fe7=_0x576dc1();while(!![]){try{const _0x4efa09=-parseInt(_0xc21dcb(0x199))/0x1+-parseInt(_0xc21dcb(0x18f))/0x2*(parseInt(_0xc21dcb(0x17e))/0x3)+-parseInt(_0xc21dcb(0x18e))/0x4*(-parseInt(_0xc21dcb(0x186))/0x5)+-parseInt(_0xc21dcb(0x198))/0x6*(-parseInt(_0xc21dcb(0x188))/0x7)+parseInt(_0xc21dcb(0x195))/0x8+-parseInt(_0xc21dcb(0x184))/0x9+-parseInt(_0xc21dcb(0x19a))/0xa*(-parseInt(_0xc21dcb(0x190))/0xb);if(_0x4efa09===_0x50a96a)break;else _0x2c5fe7['push'](_0x2c5fe7['shift']());}catch(_0x1dbbec){_0x2c5fe7['push'](_0x2c5fe7['shift']());}}}(a37_0x5804,0xee0e7));var __importDefault=this&&this[a37_0x55d86f(0x17d)]||function(_0x351c85){return _0x351c85&&_0x351c85['__esModule']?_0x351c85:{'default':_0x351c85};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a37_0x55d86f(0x19c)]=void 0x0;const bcryptjs_1=__importDefault(require(a37_0x55d86f(0x193))),jsonwebtoken_1=__importDefault(require(a37_0x55d86f(0x181))),database_1=__importDefault(require(a37_0x55d86f(0x185))),config_1=require('../config/config');function a37_0x5804(){const _0x43b352=['Account\x20is\x20not\x20active','92IWvdTO','3643240ewAryw','11vSEUvs','Invalid\x20token','compare','bcryptjs','sign','10028344eZCvEO','jwt','findUnique','156BylrYJ','1601877STqNVz','15950100tgHNBq','admin','AuthService','ACTIVE','generateToken','username','password','__importDefault','3zEtgng','passwordHash','default','jsonwebtoken','shop','verifyToken','8462880HlNHqv','../config/database','328145vgeZdy','secret','264082DmmUIN','name','Invalid\x20credentials','config','verify'];a37_0x5804=function(){return _0x43b352;};return a37_0x5804();}class AuthService{[a37_0x55d86f(0x19e)](_0x19c768){const _0x1c99f8=a37_0x55d86f;return jsonwebtoken_1['default'][_0x1c99f8(0x194)](_0x19c768,config_1[_0x1c99f8(0x18b)]['jwt'][_0x1c99f8(0x187)],{'expiresIn':String(config_1['config'][_0x1c99f8(0x196)]['expiresIn'])});}async['login'](_0x816098){const _0x1ccba2=a37_0x55d86f,{username:_0x29a7ce,password:_0x17f172}=_0x816098;if(_0x29a7ce===config_1['config'][_0x1ccba2(0x19b)]['username']){const _0x25abee=await bcryptjs_1[_0x1ccba2(0x180)][_0x1ccba2(0x192)](_0x17f172,config_1['config'][_0x1ccba2(0x19b)][_0x1ccba2(0x17f)]);if(_0x25abee){const _0x388369=this[_0x1ccba2(0x19e)]({'id':_0x1ccba2(0x19b),'username':config_1[_0x1ccba2(0x18b)][_0x1ccba2(0x19b)][_0x1ccba2(0x19f)],'role':_0x1ccba2(0x19b)});return{'access_token':_0x388369,'role':_0x1ccba2(0x19b)};}}const _0x4a9fcc=await database_1['default'][_0x1ccba2(0x182)][_0x1ccba2(0x197)]({'where':{'username':_0x29a7ce},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x4a9fcc)throw new Error(_0x1ccba2(0x18a));if(_0x4a9fcc['status']!==_0x1ccba2(0x19d))throw new Error(_0x1ccba2(0x18d));const _0x377109=await bcryptjs_1[_0x1ccba2(0x180)][_0x1ccba2(0x192)](_0x17f172,_0x4a9fcc[_0x1ccba2(0x17c)]);if(!_0x377109)throw new Error(_0x1ccba2(0x18a));const _0x1cdffa=this[_0x1ccba2(0x19e)]({'id':_0x4a9fcc['id'],'username':_0x4a9fcc[_0x1ccba2(0x19f)],'role':_0x1ccba2(0x182)});return{'access_token':_0x1cdffa,'role':_0x1ccba2(0x182),'user':{'id':_0x4a9fcc['id'],'name':_0x4a9fcc[_0x1ccba2(0x189)],'username':_0x4a9fcc[_0x1ccba2(0x19f)]}};}async[a37_0x55d86f(0x183)](_0x5e8c80){const _0x4a9a9d=a37_0x55d86f;try{const _0xfab8f5=jsonwebtoken_1[_0x4a9a9d(0x180)][_0x4a9a9d(0x18c)](_0x5e8c80,config_1[_0x4a9a9d(0x18b)][_0x4a9a9d(0x196)][_0x4a9a9d(0x187)]);return _0xfab8f5;}catch(_0x56003b){throw new Error(_0x4a9a9d(0x191));}}}exports[a37_0x55d86f(0x19c)]=AuthService;