'use strict';const a37_0x225509=a37_0x47e5;(function(_0x1ac9ed,_0x537196){const _0x1961a8=a37_0x47e5,_0x56bb58=_0x1ac9ed();while(!![]){try{const _0x485a31=parseInt(_0x1961a8(0x1c3))/0x1+-parseInt(_0x1961a8(0x1c5))/0x2+parseInt(_0x1961a8(0x1e2))/0x3*(-parseInt(_0x1961a8(0x1c1))/0x4)+-parseInt(_0x1961a8(0x1d3))/0x5+-parseInt(_0x1961a8(0x1c7))/0x6*(parseInt(_0x1961a8(0x1d7))/0x7)+-parseInt(_0x1961a8(0x1cb))/0x8+-parseInt(_0x1961a8(0x1d1))/0x9*(-parseInt(_0x1961a8(0x1dc))/0xa);if(_0x485a31===_0x537196)break;else _0x56bb58['push'](_0x56bb58['shift']());}catch(_0x32ecfd){_0x56bb58['push'](_0x56bb58['shift']());}}}(a37_0xdfb3,0x316dd));var __importDefault=this&&this[a37_0x225509(0x1d6)]||function(_0x208a40){const _0x5c9e00=a37_0x225509;return _0x208a40&&_0x208a40[_0x5c9e00(0x1c9)]?_0x208a40:{'default':_0x208a40};};Object[a37_0x225509(0x1c2)](exports,a37_0x225509(0x1c9),{'value':!![]}),exports['AuthService']=void 0x0;function a37_0x47e5(_0x138e76,_0x2f0af1){const _0xdfb3a4=a37_0xdfb3();return a37_0x47e5=function(_0x47e567,_0x1f7cea){_0x47e567=_0x47e567-0x1c0;let _0x421bed=_0xdfb3a4[_0x47e567];return _0x421bed;},a37_0x47e5(_0x138e76,_0x2f0af1);}const bcryptjs_1=__importDefault(require(a37_0x225509(0x1ca))),jsonwebtoken_1=__importDefault(require(a37_0x225509(0x1da))),database_1=__importDefault(require('../config/database')),config_1=require(a37_0x225509(0x1d8));class AuthService{[a37_0x225509(0x1ce)](_0x577fcf){const _0x46ea58=a37_0x225509;return jsonwebtoken_1[_0x46ea58(0x1db)]['sign'](_0x577fcf,config_1[_0x46ea58(0x1cf)]['jwt'][_0x46ea58(0x1d0)],{'expiresIn':String(config_1['config'][_0x46ea58(0x1d2)]['expiresIn'])});}async[a37_0x225509(0x1d4)](_0x10b958){const _0x34d50c=a37_0x225509,{username:_0x4ce60e,password:_0x2a6cbe}=_0x10b958;if(_0x4ce60e===config_1['config'][_0x34d50c(0x1df)][_0x34d50c(0x1c0)]){const _0x3abe5b=await bcryptjs_1['default'][_0x34d50c(0x1d5)](_0x2a6cbe,config_1['config']['admin'][_0x34d50c(0x1de)]);if(_0x3abe5b){const _0x317024=this[_0x34d50c(0x1ce)]({'id':_0x34d50c(0x1df),'username':config_1[_0x34d50c(0x1cf)][_0x34d50c(0x1df)][_0x34d50c(0x1c0)],'role':_0x34d50c(0x1df)});return{'access_token':_0x317024,'role':'admin'};}}const _0x507bf8=await database_1[_0x34d50c(0x1db)]['shop'][_0x34d50c(0x1c8)]({'where':{'username':_0x4ce60e},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x507bf8)throw new Error(_0x34d50c(0x1c6));if(_0x507bf8[_0x34d50c(0x1e0)]!==_0x34d50c(0x1cd))throw new Error(_0x34d50c(0x1dd));const _0x195c8d=await bcryptjs_1[_0x34d50c(0x1db)][_0x34d50c(0x1d5)](_0x2a6cbe,_0x507bf8[_0x34d50c(0x1e1)]);if(!_0x195c8d)throw new Error(_0x34d50c(0x1c6));const _0x7f0730=this['generateToken']({'id':_0x507bf8['id'],'username':_0x507bf8[_0x34d50c(0x1c0)],'role':'shop'});return{'access_token':_0x7f0730,'role':'shop','user':{'id':_0x507bf8['id'],'name':_0x507bf8['name'],'username':_0x507bf8[_0x34d50c(0x1c0)]}};}async[a37_0x225509(0x1d9)](_0x2353c5){const _0x48c715=a37_0x225509;try{const _0x90bb4e=jsonwebtoken_1[_0x48c715(0x1db)]['verify'](_0x2353c5,config_1['config'][_0x48c715(0x1d2)]['secret']);return _0x90bb4e;}catch(_0x50c180){throw new Error(_0x48c715(0x1cc));}}}function a37_0xdfb3(){const _0xac42ad=['Invalid\x20credentials','17592BRAnRC','findUnique','__esModule','bcryptjs','2609152hBnZzt','Invalid\x20token','ACTIVE','generateToken','config','secret','63cQoEUb','jwt','1825640yoOHaK','login','compare','__importDefault','273NBBasx','../config/config','verifyToken','jsonwebtoken','default','1358090pONhid','Account\x20is\x20not\x20active','passwordHash','admin','status','password','49749DIDLsh','username','4SqQCxo','defineProperty','223452zjPIcB','AuthService','298902xfaDEb'];a37_0xdfb3=function(){return _0xac42ad;};return a37_0xdfb3();}exports[a37_0x225509(0x1c4)]=AuthService;