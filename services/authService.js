'use strict';const a36_0x2b61d4=a36_0x3f80;(function(_0x5b48c2,_0x3c53be){const _0x412328=a36_0x3f80,_0x1b023e=_0x5b48c2();while(!![]){try{const _0xa682f1=-parseInt(_0x412328(0x16c))/0x1+parseInt(_0x412328(0x15f))/0x2+parseInt(_0x412328(0x169))/0x3*(-parseInt(_0x412328(0x161))/0x4)+parseInt(_0x412328(0x178))/0x5*(-parseInt(_0x412328(0x175))/0x6)+-parseInt(_0x412328(0x16a))/0x7*(parseInt(_0x412328(0x16e))/0x8)+-parseInt(_0x412328(0x16d))/0x9+-parseInt(_0x412328(0x177))/0xa*(-parseInt(_0x412328(0x15b))/0xb);if(_0xa682f1===_0x3c53be)break;else _0x1b023e['push'](_0x1b023e['shift']());}catch(_0x29d3c3){_0x1b023e['push'](_0x1b023e['shift']());}}}(a36_0x1841,0xa1484));var __importDefault=this&&this[a36_0x2b61d4(0x166)]||function(_0x56bc50){return _0x56bc50&&_0x56bc50['__esModule']?_0x56bc50:{'default':_0x56bc50};};Object[a36_0x2b61d4(0x158)](exports,a36_0x2b61d4(0x165),{'value':!![]}),exports['AuthService']=void 0x0;function a36_0x1841(){const _0xe2ef9b=['login','defineProperty','Invalid\x20credentials','bcryptjs','34224014otADVy','jsonwebtoken','status','shop','1211142hifpYK','jwt','3625268FUHteS','admin','Account\x20is\x20not\x20active','Invalid\x20token','__esModule','__importDefault','../config/config','generateToken','3cYEZEz','4977PxgNmK','expiresIn','333617pGzimw','6020136rylAMF','1864nYWhid','config','sign','secret','name','verifyToken','default','42684hhcSTv','ACTIVE','10wEczEi','690UQLdRF','username'];a36_0x1841=function(){return _0xe2ef9b;};return a36_0x1841();}function a36_0x3f80(_0x31ad81,_0x26dcbf){const _0x1841d3=a36_0x1841();return a36_0x3f80=function(_0x3f801b,_0x5b4b79){_0x3f801b=_0x3f801b-0x157;let _0x30e0c1=_0x1841d3[_0x3f801b];return _0x30e0c1;},a36_0x3f80(_0x31ad81,_0x26dcbf);}const bcryptjs_1=__importDefault(require(a36_0x2b61d4(0x15a))),jsonwebtoken_1=__importDefault(require(a36_0x2b61d4(0x15c))),database_1=__importDefault(require('../config/database')),config_1=require(a36_0x2b61d4(0x167));class AuthService{[a36_0x2b61d4(0x168)](_0x40b351){const _0x2112e2=a36_0x2b61d4;return jsonwebtoken_1[_0x2112e2(0x174)][_0x2112e2(0x170)](_0x40b351,config_1[_0x2112e2(0x16f)][_0x2112e2(0x160)][_0x2112e2(0x171)],{'expiresIn':String(config_1['config'][_0x2112e2(0x160)][_0x2112e2(0x16b)])});}async[a36_0x2b61d4(0x157)](_0x26ce8c){const _0x5c5007=a36_0x2b61d4,{username:_0x487164,password:_0x583cc4}=_0x26ce8c;if(_0x487164===config_1[_0x5c5007(0x16f)][_0x5c5007(0x162)][_0x5c5007(0x179)]){const _0x1b7532=await bcryptjs_1['default']['compare'](_0x583cc4,config_1[_0x5c5007(0x16f)][_0x5c5007(0x162)]['passwordHash']);if(_0x1b7532){const _0x2cda21=this[_0x5c5007(0x168)]({'id':'admin','username':config_1[_0x5c5007(0x16f)][_0x5c5007(0x162)][_0x5c5007(0x179)],'role':_0x5c5007(0x162)});return{'access_token':_0x2cda21,'role':_0x5c5007(0x162)};}}const _0x48d39a=await database_1[_0x5c5007(0x174)][_0x5c5007(0x15e)]['findUnique']({'where':{'username':_0x487164},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x48d39a)throw new Error(_0x5c5007(0x159));if(_0x48d39a[_0x5c5007(0x15d)]!==_0x5c5007(0x176))throw new Error(_0x5c5007(0x163));const _0x73bd85=await bcryptjs_1[_0x5c5007(0x174)]['compare'](_0x583cc4,_0x48d39a['password']);if(!_0x73bd85)throw new Error(_0x5c5007(0x159));const _0x32cdae=this['generateToken']({'id':_0x48d39a['id'],'username':_0x48d39a[_0x5c5007(0x179)],'role':_0x5c5007(0x15e)});return{'access_token':_0x32cdae,'role':_0x5c5007(0x15e),'user':{'id':_0x48d39a['id'],'name':_0x48d39a[_0x5c5007(0x172)],'username':_0x48d39a[_0x5c5007(0x179)]}};}async[a36_0x2b61d4(0x173)](_0x3d7555){const _0x49c7cd=a36_0x2b61d4;try{const _0x55623b=jsonwebtoken_1[_0x49c7cd(0x174)]['verify'](_0x3d7555,config_1[_0x49c7cd(0x16f)][_0x49c7cd(0x160)][_0x49c7cd(0x171)]);return _0x55623b;}catch(_0x58a713){throw new Error(_0x49c7cd(0x164));}}}exports['AuthService']=AuthService;