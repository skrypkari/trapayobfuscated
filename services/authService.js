'use strict';const a34_0x13ef1b=a34_0x8400;(function(_0x4b2cf7,_0x29ffd1){const _0x1f58eb=a34_0x8400,_0xa67636=_0x4b2cf7();while(!![]){try{const _0x34c044=-parseInt(_0x1f58eb(0x111))/0x1*(parseInt(_0x1f58eb(0x120))/0x2)+parseInt(_0x1f58eb(0x10c))/0x3*(parseInt(_0x1f58eb(0x124))/0x4)+parseInt(_0x1f58eb(0x112))/0x5+parseInt(_0x1f58eb(0x122))/0x6*(parseInt(_0x1f58eb(0x109))/0x7)+parseInt(_0x1f58eb(0x11b))/0x8*(parseInt(_0x1f58eb(0x11c))/0x9)+parseInt(_0x1f58eb(0x110))/0xa+-parseInt(_0x1f58eb(0x10e))/0xb*(parseInt(_0x1f58eb(0x107))/0xc);if(_0x34c044===_0x29ffd1)break;else _0xa67636['push'](_0xa67636['shift']());}catch(_0x3269ab){_0xa67636['push'](_0xa67636['shift']());}}}(a34_0x5a49,0x1d052));function a34_0x8400(_0x222367,_0x3fca3a){const _0x5a49b4=a34_0x5a49();return a34_0x8400=function(_0x84009a,_0x3b8099){_0x84009a=_0x84009a-0x107;let _0x5236db=_0x5a49b4[_0x84009a];return _0x5236db;},a34_0x8400(_0x222367,_0x3fca3a);}var __importDefault=this&&this[a34_0x13ef1b(0x128)]||function(_0x23d295){return _0x23d295&&_0x23d295['__esModule']?_0x23d295:{'default':_0x23d295};};function a34_0x5a49(){const _0x4087b1=['shop','Invalid\x20credentials','jwt','24mgnQUR','652599bLFKPh','login','name','default','122NibPSK','admin','785796cZLcwb','bcryptjs','8WXVmNI','status','expiresIn','defineProperty','__importDefault','jsonwebtoken','verifyToken','username','__esModule','12MtnPhI','findUnique','7iRfIPp','password','passwordHash','14493jOtdyv','verify','4074499lbYobP','compare','2156090LozOFD','2749nyvGKJ','415970mEHOfX','generateToken','AuthService','Invalid\x20token','../config/config','config'];a34_0x5a49=function(){return _0x4087b1;};return a34_0x5a49();}Object[a34_0x13ef1b(0x127)](exports,a34_0x13ef1b(0x12c),{'value':!![]}),exports[a34_0x13ef1b(0x114)]=void 0x0;const bcryptjs_1=__importDefault(require(a34_0x13ef1b(0x123))),jsonwebtoken_1=__importDefault(require(a34_0x13ef1b(0x129))),database_1=__importDefault(require('../config/database')),config_1=require(a34_0x13ef1b(0x116));class AuthService{[a34_0x13ef1b(0x113)](_0x4263b0){const _0x2fc808=a34_0x13ef1b;return jsonwebtoken_1['default']['sign'](_0x4263b0,config_1[_0x2fc808(0x117)][_0x2fc808(0x11a)]['secret'],{'expiresIn':String(config_1['config']['jwt'][_0x2fc808(0x126)])});}async[a34_0x13ef1b(0x11d)](_0x272111){const _0x490f0d=a34_0x13ef1b,{username:_0x1c396d,password:_0x3219ef}=_0x272111;if(_0x1c396d===config_1[_0x490f0d(0x117)][_0x490f0d(0x121)][_0x490f0d(0x12b)]){const _0x204ee7=await bcryptjs_1['default'][_0x490f0d(0x10f)](_0x3219ef,config_1[_0x490f0d(0x117)][_0x490f0d(0x121)][_0x490f0d(0x10b)]);if(_0x204ee7){const _0x1a7f45=this[_0x490f0d(0x113)]({'id':'admin','username':config_1[_0x490f0d(0x117)][_0x490f0d(0x121)]['username'],'role':_0x490f0d(0x121)});return{'access_token':_0x1a7f45,'role':_0x490f0d(0x121)};}}const _0x43d072=await database_1[_0x490f0d(0x11f)][_0x490f0d(0x118)][_0x490f0d(0x108)]({'where':{'username':_0x1c396d},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x43d072)throw new Error(_0x490f0d(0x119));if(_0x43d072[_0x490f0d(0x125)]!=='ACTIVE')throw new Error('Account\x20is\x20not\x20active');const _0x4c5391=await bcryptjs_1[_0x490f0d(0x11f)][_0x490f0d(0x10f)](_0x3219ef,_0x43d072[_0x490f0d(0x10a)]);if(!_0x4c5391)throw new Error(_0x490f0d(0x119));const _0x35a559=this[_0x490f0d(0x113)]({'id':_0x43d072['id'],'username':_0x43d072[_0x490f0d(0x12b)],'role':_0x490f0d(0x118)});return{'access_token':_0x35a559,'role':_0x490f0d(0x118),'user':{'id':_0x43d072['id'],'name':_0x43d072[_0x490f0d(0x11e)],'username':_0x43d072[_0x490f0d(0x12b)]}};}async[a34_0x13ef1b(0x12a)](_0x482934){const _0x52159e=a34_0x13ef1b;try{const _0x33c682=jsonwebtoken_1[_0x52159e(0x11f)][_0x52159e(0x10d)](_0x482934,config_1[_0x52159e(0x117)][_0x52159e(0x11a)]['secret']);return _0x33c682;}catch(_0x3e753f){throw new Error(_0x52159e(0x115));}}}exports['AuthService']=AuthService;