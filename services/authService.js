'use strict';const a37_0xab0370=a37_0x575d;(function(_0x3dc38b,_0x4bfb27){const _0x5b1d78=a37_0x575d,_0x10ac3f=_0x3dc38b();while(!![]){try{const _0x47b4cd=-parseInt(_0x5b1d78(0x19b))/0x1*(parseInt(_0x5b1d78(0x1a2))/0x2)+-parseInt(_0x5b1d78(0x1a9))/0x3+-parseInt(_0x5b1d78(0x18e))/0x4*(parseInt(_0x5b1d78(0x1ad))/0x5)+parseInt(_0x5b1d78(0x18a))/0x6*(parseInt(_0x5b1d78(0x1a1))/0x7)+-parseInt(_0x5b1d78(0x19f))/0x8+-parseInt(_0x5b1d78(0x1ac))/0x9+-parseInt(_0x5b1d78(0x18b))/0xa*(-parseInt(_0x5b1d78(0x189))/0xb);if(_0x47b4cd===_0x4bfb27)break;else _0x10ac3f['push'](_0x10ac3f['shift']());}catch(_0xe6178e){_0x10ac3f['push'](_0x10ac3f['shift']());}}}(a37_0x1e0d,0xa226c));var __importDefault=this&&this[a37_0xab0370(0x18c)]||function(_0x5755cc){const _0x2d1072=a37_0xab0370;return _0x5755cc&&_0x5755cc[_0x2d1072(0x193)]?_0x5755cc:{'default':_0x5755cc};};function a37_0x1e0d(){const _0x38a94a=['admin','Account\x20is\x20not\x20active','__esModule','defineProperty','bcryptjs','compare','jsonwebtoken','expiresIn','login','../config/config','17Syjcxx','findUnique','Invalid\x20credentials','secret','8856840FtYRom','password','35OzfZMU','49866mLlbau','config','ACTIVE','jwt','verifyToken','../config/database','shop','3955755fuocEs','default','AuthService','4745277mVgpRA','241785lYBkAv','3624423WwJZwI','557892PzFqRR','110wiczvS','__importDefault','generateToken','4PfxxjW','sign','username'];a37_0x1e0d=function(){return _0x38a94a;};return a37_0x1e0d();}Object[a37_0xab0370(0x194)](exports,'__esModule',{'value':!![]}),exports[a37_0xab0370(0x1ab)]=void 0x0;const bcryptjs_1=__importDefault(require(a37_0xab0370(0x195))),jsonwebtoken_1=__importDefault(require(a37_0xab0370(0x197))),database_1=__importDefault(require(a37_0xab0370(0x1a7))),config_1=require(a37_0xab0370(0x19a));function a37_0x575d(_0x26ba91,_0xb2da24){const _0x1e0d52=a37_0x1e0d();return a37_0x575d=function(_0x575d60,_0x2dc85b){_0x575d60=_0x575d60-0x189;let _0x313751=_0x1e0d52[_0x575d60];return _0x313751;},a37_0x575d(_0x26ba91,_0xb2da24);}class AuthService{[a37_0xab0370(0x18d)](_0x6de486){const _0x21b56f=a37_0xab0370;return jsonwebtoken_1[_0x21b56f(0x1aa)][_0x21b56f(0x18f)](_0x6de486,config_1['config']['jwt'][_0x21b56f(0x19e)],{'expiresIn':String(config_1[_0x21b56f(0x1a3)][_0x21b56f(0x1a5)][_0x21b56f(0x198)])});}async[a37_0xab0370(0x199)](_0x3464b6){const _0x475bbd=a37_0xab0370,{username:_0x18f1b0,password:_0x2e00b0}=_0x3464b6;if(_0x18f1b0===config_1['config']['admin'][_0x475bbd(0x190)]){const _0x10594c=await bcryptjs_1['default'][_0x475bbd(0x196)](_0x2e00b0,config_1[_0x475bbd(0x1a3)][_0x475bbd(0x191)]['passwordHash']);if(_0x10594c){const _0x5409d4=this[_0x475bbd(0x18d)]({'id':_0x475bbd(0x191),'username':config_1[_0x475bbd(0x1a3)][_0x475bbd(0x191)][_0x475bbd(0x190)],'role':_0x475bbd(0x191)});return{'access_token':_0x5409d4,'role':_0x475bbd(0x191)};}}const _0x2ea572=await database_1['default'][_0x475bbd(0x1a8)][_0x475bbd(0x19c)]({'where':{'username':_0x18f1b0},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x2ea572)throw new Error(_0x475bbd(0x19d));if(_0x2ea572['status']!==_0x475bbd(0x1a4))throw new Error(_0x475bbd(0x192));const _0x5439ef=await bcryptjs_1['default'][_0x475bbd(0x196)](_0x2e00b0,_0x2ea572[_0x475bbd(0x1a0)]);if(!_0x5439ef)throw new Error('Invalid\x20credentials');const _0x18f10d=this[_0x475bbd(0x18d)]({'id':_0x2ea572['id'],'username':_0x2ea572['username'],'role':_0x475bbd(0x1a8)});return{'access_token':_0x18f10d,'role':_0x475bbd(0x1a8),'user':{'id':_0x2ea572['id'],'name':_0x2ea572['name'],'username':_0x2ea572['username']}};}async[a37_0xab0370(0x1a6)](_0x652d3e){const _0x1ab43d=a37_0xab0370;try{const _0x2aa3ca=jsonwebtoken_1[_0x1ab43d(0x1aa)]['verify'](_0x652d3e,config_1[_0x1ab43d(0x1a3)]['jwt'][_0x1ab43d(0x19e)]);return _0x2aa3ca;}catch(_0x453c7c){throw new Error('Invalid\x20token');}}}exports[a37_0xab0370(0x1ab)]=AuthService;