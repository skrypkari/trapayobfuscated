'use strict';function a36_0x7038(){const _0x586c1a=['AuthService','889000RZMWJS','shop','secret','findUnique','default','defineProperty','393582rgixKC','username','../config/config','login','jwt','16132aTwBoc','10yTCVPn','534846BqEUul','../config/database','password','15EAqTDM','Account\x20is\x20not\x20active','__esModule','302654aMRnNX','__importDefault','5615811kMmTTz','verify','189EpTKsz','verifyToken','admin','name','generateToken','1470791AmTsBy','config','Invalid\x20token','passwordHash','compare','bcryptjs'];a36_0x7038=function(){return _0x586c1a;};return a36_0x7038();}const a36_0x5aecb6=a36_0x10f2;function a36_0x10f2(_0x3b13d0,_0x3dc9a2){const _0x70386b=a36_0x7038();return a36_0x10f2=function(_0x10f275,_0x160655){_0x10f275=_0x10f275-0x1d5;let _0x9ca864=_0x70386b[_0x10f275];return _0x9ca864;},a36_0x10f2(_0x3b13d0,_0x3dc9a2);}(function(_0x4eda5b,_0xdd6872){const _0x4fdd24=a36_0x10f2,_0x10c329=_0x4eda5b();while(!![]){try{const _0x308b31=-parseInt(_0x4fdd24(0x1db))/0x1+parseInt(_0x4fdd24(0x1f1))/0x2+-parseInt(_0x4fdd24(0x1df))/0x3*(-parseInt(_0x4fdd24(0x1f6))/0x4)+-parseInt(_0x4fdd24(0x1d8))/0x5*(parseInt(_0x4fdd24(0x1d5))/0x6)+-parseInt(_0x4fdd24(0x1e4))/0x7+-parseInt(_0x4fdd24(0x1eb))/0x8+-parseInt(_0x4fdd24(0x1dd))/0x9*(-parseInt(_0x4fdd24(0x1f7))/0xa);if(_0x308b31===_0xdd6872)break;else _0x10c329['push'](_0x10c329['shift']());}catch(_0x30cc28){_0x10c329['push'](_0x10c329['shift']());}}}(a36_0x7038,0x2ccee));var __importDefault=this&&this[a36_0x5aecb6(0x1dc)]||function(_0x30592d){return _0x30592d&&_0x30592d['__esModule']?_0x30592d:{'default':_0x30592d};};Object[a36_0x5aecb6(0x1f0)](exports,a36_0x5aecb6(0x1da),{'value':!![]}),exports[a36_0x5aecb6(0x1ea)]=void 0x0;const bcryptjs_1=__importDefault(require(a36_0x5aecb6(0x1e9))),jsonwebtoken_1=__importDefault(require('jsonwebtoken')),database_1=__importDefault(require(a36_0x5aecb6(0x1d6))),config_1=require(a36_0x5aecb6(0x1f3));class AuthService{[a36_0x5aecb6(0x1e3)](_0x4dbf9f){const _0x538b41=a36_0x5aecb6;return jsonwebtoken_1[_0x538b41(0x1ef)]['sign'](_0x4dbf9f,config_1['config'][_0x538b41(0x1f5)][_0x538b41(0x1ed)],{'expiresIn':String(config_1[_0x538b41(0x1e5)][_0x538b41(0x1f5)]['expiresIn'])});}async[a36_0x5aecb6(0x1f4)](_0x244c63){const _0x2431b3=a36_0x5aecb6,{username:_0x1156ef,password:_0x108bd9}=_0x244c63;if(_0x1156ef===config_1['config'][_0x2431b3(0x1e1)][_0x2431b3(0x1f2)]){const _0x3c930f=await bcryptjs_1[_0x2431b3(0x1ef)][_0x2431b3(0x1e8)](_0x108bd9,config_1[_0x2431b3(0x1e5)][_0x2431b3(0x1e1)][_0x2431b3(0x1e7)]);if(_0x3c930f){const _0x2ea28f=this['generateToken']({'id':_0x2431b3(0x1e1),'username':config_1['config'][_0x2431b3(0x1e1)][_0x2431b3(0x1f2)],'role':_0x2431b3(0x1e1)});return{'access_token':_0x2ea28f,'role':'admin'};}}const _0x538e39=await database_1['default'][_0x2431b3(0x1ec)][_0x2431b3(0x1ee)]({'where':{'username':_0x1156ef},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x538e39)throw new Error('Invalid\x20credentials');if(_0x538e39['status']!=='ACTIVE')throw new Error(_0x2431b3(0x1d9));const _0x3ff0ac=await bcryptjs_1[_0x2431b3(0x1ef)][_0x2431b3(0x1e8)](_0x108bd9,_0x538e39[_0x2431b3(0x1d7)]);if(!_0x3ff0ac)throw new Error('Invalid\x20credentials');const _0x55251a=this[_0x2431b3(0x1e3)]({'id':_0x538e39['id'],'username':_0x538e39['username'],'role':_0x2431b3(0x1ec)});return{'access_token':_0x55251a,'role':_0x2431b3(0x1ec),'user':{'id':_0x538e39['id'],'name':_0x538e39[_0x2431b3(0x1e2)],'username':_0x538e39[_0x2431b3(0x1f2)]}};}async[a36_0x5aecb6(0x1e0)](_0x59d1a9){const _0x2dbcc1=a36_0x5aecb6;try{const _0x2d4c43=jsonwebtoken_1[_0x2dbcc1(0x1ef)][_0x2dbcc1(0x1de)](_0x59d1a9,config_1[_0x2dbcc1(0x1e5)][_0x2dbcc1(0x1f5)][_0x2dbcc1(0x1ed)]);return _0x2d4c43;}catch(_0x1826a7){throw new Error(_0x2dbcc1(0x1e6));}}}exports[a36_0x5aecb6(0x1ea)]=AuthService;