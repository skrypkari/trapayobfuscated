'use strict';function a34_0x408e(_0x5e5eb3,_0x344ed3){const _0x34449f=a34_0x3444();return a34_0x408e=function(_0x408ebb,_0x50772a){_0x408ebb=_0x408ebb-0x68;let _0x5b97d3=_0x34449f[_0x408ebb];return _0x5b97d3;},a34_0x408e(_0x5e5eb3,_0x344ed3);}const a34_0x64270=a34_0x408e;function a34_0x3444(){const _0x5f34cd=['132kIXfii','2634680SyoqIS','generateToken','sign','verifyToken','username','Account\x20is\x20not\x20active','1373964JrQZba','status','20FtHIKM','__importDefault','__esModule','findUnique','secret','2248938yhKgkn','bcryptjs','default','jwt','shop','ACTIVE','1069754AltDio','../config/config','Invalid\x20token','149997EvlOts','admin','password','33ttQRFs','expiresIn','278hvvpgQ','compare','Invalid\x20credentials','10QJBwzU','jsonwebtoken','verify','../config/database','34805wLqrQa','defineProperty','config','1038Bkjyjc','AuthService'];a34_0x3444=function(){return _0x5f34cd;};return a34_0x3444();}(function(_0x220311,_0x379197){const _0xfe913a=a34_0x408e,_0x3e151e=_0x220311();while(!![]){try{const _0x8ab75d=-parseInt(_0xfe913a(0x77))/0x1*(parseInt(_0xfe913a(0x81))/0x2)+-parseInt(_0xfe913a(0x72))/0x3*(parseInt(_0xfe913a(0x8c))/0x4)+-parseInt(_0xfe913a(0x7e))/0x5*(parseInt(_0xfe913a(0x83))/0x6)+-parseInt(_0xfe913a(0x6f))/0x7+parseInt(_0xfe913a(0x84))/0x8+-parseInt(_0xfe913a(0x69))/0x9*(-parseInt(_0xfe913a(0x7a))/0xa)+-parseInt(_0xfe913a(0x75))/0xb*(-parseInt(_0xfe913a(0x8a))/0xc);if(_0x8ab75d===_0x379197)break;else _0x3e151e['push'](_0x3e151e['shift']());}catch(_0x2dd54b){_0x3e151e['push'](_0x3e151e['shift']());}}}(a34_0x3444,0x36503));var __importDefault=this&&this[a34_0x64270(0x8d)]||function(_0x53c72a){const _0x37ca0f=a34_0x64270;return _0x53c72a&&_0x53c72a[_0x37ca0f(0x8e)]?_0x53c72a:{'default':_0x53c72a};};Object[a34_0x64270(0x7f)](exports,'__esModule',{'value':!![]}),exports[a34_0x64270(0x82)]=void 0x0;const bcryptjs_1=__importDefault(require(a34_0x64270(0x6a))),jsonwebtoken_1=__importDefault(require(a34_0x64270(0x7b))),database_1=__importDefault(require(a34_0x64270(0x7d))),config_1=require(a34_0x64270(0x70));class AuthService{[a34_0x64270(0x85)](_0x4d56bd){const _0xcfa1d7=a34_0x64270;return jsonwebtoken_1[_0xcfa1d7(0x6b)][_0xcfa1d7(0x86)](_0x4d56bd,config_1[_0xcfa1d7(0x80)][_0xcfa1d7(0x6c)]['secret'],{'expiresIn':String(config_1['config'][_0xcfa1d7(0x6c)][_0xcfa1d7(0x76)])});}async['login'](_0x295888){const _0x4586d9=a34_0x64270,{username:_0x2a4294,password:_0x581968}=_0x295888;if(_0x2a4294===config_1[_0x4586d9(0x80)]['admin'][_0x4586d9(0x88)]){const _0x520832=await bcryptjs_1[_0x4586d9(0x6b)][_0x4586d9(0x78)](_0x581968,config_1['config'][_0x4586d9(0x73)]['passwordHash']);if(_0x520832){const _0x31bc63=this[_0x4586d9(0x85)]({'id':_0x4586d9(0x73),'username':config_1['config'][_0x4586d9(0x73)][_0x4586d9(0x88)],'role':_0x4586d9(0x73)});return{'access_token':_0x31bc63,'role':'admin'};}}const _0x2809f7=await database_1[_0x4586d9(0x6b)][_0x4586d9(0x6d)][_0x4586d9(0x8f)]({'where':{'username':_0x2a4294},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x2809f7)throw new Error('Invalid\x20credentials');if(_0x2809f7[_0x4586d9(0x8b)]!==_0x4586d9(0x6e))throw new Error(_0x4586d9(0x89));const _0x26d7f6=await bcryptjs_1[_0x4586d9(0x6b)]['compare'](_0x581968,_0x2809f7[_0x4586d9(0x74)]);if(!_0x26d7f6)throw new Error(_0x4586d9(0x79));const _0x4d1a22=this[_0x4586d9(0x85)]({'id':_0x2809f7['id'],'username':_0x2809f7[_0x4586d9(0x88)],'role':_0x4586d9(0x6d)});return{'access_token':_0x4d1a22,'role':_0x4586d9(0x6d),'user':{'id':_0x2809f7['id'],'name':_0x2809f7['name'],'username':_0x2809f7[_0x4586d9(0x88)]}};}async[a34_0x64270(0x87)](_0xe6cfe){const _0x4c43b9=a34_0x64270;try{const _0x6d99ee=jsonwebtoken_1[_0x4c43b9(0x6b)][_0x4c43b9(0x7c)](_0xe6cfe,config_1[_0x4c43b9(0x80)]['jwt'][_0x4c43b9(0x68)]);return _0x6d99ee;}catch(_0x5ca3b3){throw new Error(_0x4c43b9(0x71));}}}exports['AuthService']=AuthService;