'use strict';const a49_0x5e70e2=a49_0x41d9;function a49_0x41d9(_0x481b48,_0x145562){_0x481b48=_0x481b48-0x138;const _0x449ad1=a49_0x449a();let _0x41d947=_0x449ad1[_0x481b48];return _0x41d947;}(function(_0x44c38b,_0x3ea4be){const _0xa97522=a49_0x41d9,_0x473862=_0x44c38b();while(!![]){try{const _0x2123b8=-parseInt(_0xa97522(0x14a))/0x1+parseInt(_0xa97522(0x138))/0x2*(-parseInt(_0xa97522(0x141))/0x3)+parseInt(_0xa97522(0x158))/0x4*(-parseInt(_0xa97522(0x13e))/0x5)+parseInt(_0xa97522(0x14c))/0x6*(-parseInt(_0xa97522(0x14f))/0x7)+parseInt(_0xa97522(0x15c))/0x8*(parseInt(_0xa97522(0x152))/0x9)+-parseInt(_0xa97522(0x150))/0xa*(-parseInt(_0xa97522(0x140))/0xb)+parseInt(_0xa97522(0x15a))/0xc;if(_0x2123b8===_0x3ea4be)break;else _0x473862['push'](_0x473862['shift']());}catch(_0x343706){_0x473862['push'](_0x473862['shift']());}}}(a49_0x449a,0x8eed0));var __importDefault=this&&this['__importDefault']||function(_0x39ccfa){const _0x2c169f=a49_0x41d9;return _0x39ccfa&&_0x39ccfa[_0x2c169f(0x14e)]?_0x39ccfa:{'default':_0x39ccfa};};Object[a49_0x5e70e2(0x159)](exports,a49_0x5e70e2(0x14e),{'value':!![]}),exports[a49_0x5e70e2(0x14d)]=void 0x0;const bcryptjs_1=__importDefault(require(a49_0x5e70e2(0x153))),jsonwebtoken_1=__importDefault(require('jsonwebtoken')),database_1=__importDefault(require(a49_0x5e70e2(0x14b))),config_1=require(a49_0x5e70e2(0x145));class AuthService{[a49_0x5e70e2(0x154)](_0x12ac25){const _0x179139=a49_0x5e70e2;return jsonwebtoken_1[_0x179139(0x149)]['sign'](_0x12ac25,config_1[_0x179139(0x13f)]['jwt'][_0x179139(0x146)],{'expiresIn':String(config_1[_0x179139(0x13f)]['jwt'][_0x179139(0x13d)])});}async[a49_0x5e70e2(0x139)](_0x4b8f38){const _0x2e4bd9=a49_0x5e70e2,{username:_0x487081,password:_0x19dd84}=_0x4b8f38;if(_0x487081===config_1[_0x2e4bd9(0x13f)][_0x2e4bd9(0x13a)][_0x2e4bd9(0x142)]){const _0x10c274=await bcryptjs_1['default']['compare'](_0x19dd84,config_1[_0x2e4bd9(0x13f)][_0x2e4bd9(0x13a)][_0x2e4bd9(0x144)]);if(_0x10c274){const _0x25acdc=this[_0x2e4bd9(0x154)]({'id':_0x2e4bd9(0x13a),'username':config_1[_0x2e4bd9(0x13f)][_0x2e4bd9(0x13a)]['username'],'role':_0x2e4bd9(0x13a)});return{'access_token':_0x25acdc,'role':_0x2e4bd9(0x13a)};}}const _0x5c08ef=await database_1[_0x2e4bd9(0x149)]['shop'][_0x2e4bd9(0x155)]({'where':{'username':_0x487081},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x5c08ef)throw new Error(_0x2e4bd9(0x15b));if(_0x5c08ef[_0x2e4bd9(0x157)]!==_0x2e4bd9(0x147))throw new Error(_0x2e4bd9(0x148));const _0x5debca=await bcryptjs_1[_0x2e4bd9(0x149)][_0x2e4bd9(0x156)](_0x19dd84,_0x5c08ef[_0x2e4bd9(0x143)]);if(!_0x5debca)throw new Error(_0x2e4bd9(0x15b));const _0x3467d4=this[_0x2e4bd9(0x154)]({'id':_0x5c08ef['id'],'username':_0x5c08ef['username'],'role':'shop'});return{'access_token':_0x3467d4,'role':_0x2e4bd9(0x151),'user':{'id':_0x5c08ef['id'],'name':_0x5c08ef[_0x2e4bd9(0x13b)],'username':_0x5c08ef[_0x2e4bd9(0x142)]}};}async['verifyToken'](_0x224dba){const _0x51b71f=a49_0x5e70e2;try{const _0x13bc74=jsonwebtoken_1['default']['verify'](_0x224dba,config_1['config'][_0x51b71f(0x13c)]['secret']);return _0x13bc74;}catch(_0x5cab57){throw new Error('Invalid\x20token');}}}function a49_0x449a(){const _0x418d4d=['8776VRKaeR','defineProperty','23234112JHumzs','Invalid\x20credentials','16mDhTdS','603742ymRscP','login','admin','name','jwt','expiresIn','2325HlryFo','config','4873JRByCL','3aYPPxr','username','password','passwordHash','../config/config','secret','ACTIVE','Account\x20is\x20not\x20active','default','58962YEAobb','../config/database','24qRiFeF','AuthService','__esModule','1438850lODlOk','13710rnmdgB','shop','1103121zuXnLS','bcryptjs','generateToken','findUnique','compare','status'];a49_0x449a=function(){return _0x418d4d;};return a49_0x449a();}exports[a49_0x5e70e2(0x14d)]=AuthService;