'use strict';const a37_0x94d8bd=a37_0x46c8;(function(_0x16061a,_0x110294){const _0x44bf99=a37_0x46c8,_0x5ad20a=_0x16061a();while(!![]){try{const _0x55c365=parseInt(_0x44bf99(0x1df))/0x1+parseInt(_0x44bf99(0x1e6))/0x2+parseInt(_0x44bf99(0x1d3))/0x3+parseInt(_0x44bf99(0x1d1))/0x4+-parseInt(_0x44bf99(0x1e0))/0x5*(-parseInt(_0x44bf99(0x1e7))/0x6)+parseInt(_0x44bf99(0x1e3))/0x7*(parseInt(_0x44bf99(0x1d7))/0x8)+-parseInt(_0x44bf99(0x1eb))/0x9*(parseInt(_0x44bf99(0x1d6))/0xa);if(_0x55c365===_0x110294)break;else _0x5ad20a['push'](_0x5ad20a['shift']());}catch(_0x49d3a7){_0x5ad20a['push'](_0x5ad20a['shift']());}}}(a37_0x2696,0xc916b));var __importDefault=this&&this[a37_0x94d8bd(0x1ee)]||function(_0x41fabe){const _0xc9efda=a37_0x94d8bd;return _0x41fabe&&_0x41fabe[_0xc9efda(0x1e9)]?_0x41fabe:{'default':_0x41fabe};};Object[a37_0x94d8bd(0x1e8)](exports,a37_0x94d8bd(0x1e9),{'value':!![]}),exports[a37_0x94d8bd(0x1d9)]=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),jsonwebtoken_1=__importDefault(require(a37_0x94d8bd(0x1d4))),database_1=__importDefault(require('../config/database')),config_1=require(a37_0x94d8bd(0x1d5));function a37_0x2696(){const _0x314fb5=['AuthService','verifyToken','name','default','config','sign','1460614xzVWlB','9275XbjgTF','Account\x20is\x20not\x20active','username','79079yMDdye','password','status','1451580PybNcT','798akmjob','defineProperty','__esModule','admin','15003aoaFiE','secret','expiresIn','__importDefault','passwordHash','jwt','Invalid\x20token','shop','compare','generateToken','6562912MwWQlo','ACTIVE','3234306XJtqTw','jsonwebtoken','../config/config','26710VMUxUM','88joXGmp','Invalid\x20credentials'];a37_0x2696=function(){return _0x314fb5;};return a37_0x2696();}function a37_0x46c8(_0x41603e,_0x4298e9){const _0x269676=a37_0x2696();return a37_0x46c8=function(_0x46c861,_0x2bab74){_0x46c861=_0x46c861-0x1cd;let _0x42ef30=_0x269676[_0x46c861];return _0x42ef30;},a37_0x46c8(_0x41603e,_0x4298e9);}class AuthService{[a37_0x94d8bd(0x1d0)](_0x9c23c0){const _0x5d6763=a37_0x94d8bd;return jsonwebtoken_1[_0x5d6763(0x1dc)][_0x5d6763(0x1de)](_0x9c23c0,config_1[_0x5d6763(0x1dd)][_0x5d6763(0x1f0)]['secret'],{'expiresIn':String(config_1[_0x5d6763(0x1dd)][_0x5d6763(0x1f0)][_0x5d6763(0x1ed)])});}async['login'](_0xc1c6da){const _0x5f30ed=a37_0x94d8bd,{username:_0xd3ae64,password:_0x1894ac}=_0xc1c6da;if(_0xd3ae64===config_1[_0x5f30ed(0x1dd)][_0x5f30ed(0x1ea)][_0x5f30ed(0x1e2)]){const _0x1d317e=await bcryptjs_1[_0x5f30ed(0x1dc)][_0x5f30ed(0x1cf)](_0x1894ac,config_1['config'][_0x5f30ed(0x1ea)][_0x5f30ed(0x1ef)]);if(_0x1d317e){const _0x5e7236=this[_0x5f30ed(0x1d0)]({'id':'admin','username':config_1[_0x5f30ed(0x1dd)][_0x5f30ed(0x1ea)][_0x5f30ed(0x1e2)],'role':_0x5f30ed(0x1ea)});return{'access_token':_0x5e7236,'role':'admin'};}}const _0x1c0ff0=await database_1[_0x5f30ed(0x1dc)][_0x5f30ed(0x1ce)]['findUnique']({'where':{'username':_0xd3ae64},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x1c0ff0)throw new Error(_0x5f30ed(0x1d8));if(_0x1c0ff0[_0x5f30ed(0x1e5)]!==_0x5f30ed(0x1d2))throw new Error(_0x5f30ed(0x1e1));const _0x5b5195=await bcryptjs_1[_0x5f30ed(0x1dc)][_0x5f30ed(0x1cf)](_0x1894ac,_0x1c0ff0[_0x5f30ed(0x1e4)]);if(!_0x5b5195)throw new Error(_0x5f30ed(0x1d8));const _0x5c8305=this[_0x5f30ed(0x1d0)]({'id':_0x1c0ff0['id'],'username':_0x1c0ff0[_0x5f30ed(0x1e2)],'role':'shop'});return{'access_token':_0x5c8305,'role':'shop','user':{'id':_0x1c0ff0['id'],'name':_0x1c0ff0[_0x5f30ed(0x1db)],'username':_0x1c0ff0['username']}};}async[a37_0x94d8bd(0x1da)](_0xe90561){const _0xfa46d9=a37_0x94d8bd;try{const _0x695810=jsonwebtoken_1[_0xfa46d9(0x1dc)]['verify'](_0xe90561,config_1['config'][_0xfa46d9(0x1f0)][_0xfa46d9(0x1ec)]);return _0x695810;}catch(_0x1c0450){throw new Error(_0xfa46d9(0x1cd));}}}exports['AuthService']=AuthService;