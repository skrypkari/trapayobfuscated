'use strict';function a36_0xd221(_0x3c5754,_0x365478){const _0x2aff8a=a36_0x2aff();return a36_0xd221=function(_0xd221a2,_0x269a6b){_0xd221a2=_0xd221a2-0x104;let _0x535ecc=_0x2aff8a[_0xd221a2];return _0x535ecc;},a36_0xd221(_0x3c5754,_0x365478);}const a36_0x53dd46=a36_0xd221;(function(_0x5df3b2,_0x5463c3){const _0x492ff9=a36_0xd221,_0xf6deab=_0x5df3b2();while(!![]){try{const _0x448385=parseInt(_0x492ff9(0x124))/0x1*(-parseInt(_0x492ff9(0x112))/0x2)+parseInt(_0x492ff9(0x114))/0x3*(parseInt(_0x492ff9(0x110))/0x4)+-parseInt(_0x492ff9(0x115))/0x5+parseInt(_0x492ff9(0x118))/0x6*(-parseInt(_0x492ff9(0x119))/0x7)+parseInt(_0x492ff9(0x10c))/0x8+-parseInt(_0x492ff9(0x10b))/0x9+parseInt(_0x492ff9(0x10f))/0xa*(parseInt(_0x492ff9(0x11d))/0xb);if(_0x448385===_0x5463c3)break;else _0xf6deab['push'](_0xf6deab['shift']());}catch(_0xa23de9){_0xf6deab['push'](_0xf6deab['shift']());}}}(a36_0x2aff,0x3afc9));function a36_0x2aff(){const _0x2f3166=['AuthService','jsonwebtoken','default','../config/config','2580957SxFxrn','3257008LCFKEa','generateToken','username','1230IjTNPi','892bHnOtU','__esModule','2IcXYax','shop','3585jCOMUF','983240mYuWfw','ACTIVE','secret','42nkrrPf','128051AXwPfi','compare','admin','jwt','48719kSknfD','verify','sign','passwordHash','status','Invalid\x20credentials','../config/database','365297lCHvjM','bcryptjs','name','password','config','Account\x20is\x20not\x20active','login'];a36_0x2aff=function(){return _0x2f3166;};return a36_0x2aff();}var __importDefault=this&&this['__importDefault']||function(_0x211b8c){return _0x211b8c&&_0x211b8c['__esModule']?_0x211b8c:{'default':_0x211b8c};};Object['defineProperty'](exports,a36_0x53dd46(0x111),{'value':!![]}),exports[a36_0x53dd46(0x107)]=void 0x0;const bcryptjs_1=__importDefault(require(a36_0x53dd46(0x125))),jsonwebtoken_1=__importDefault(require(a36_0x53dd46(0x108))),database_1=__importDefault(require(a36_0x53dd46(0x123))),config_1=require(a36_0x53dd46(0x10a));class AuthService{['generateToken'](_0x199ac4){const _0x5ccb03=a36_0x53dd46;return jsonwebtoken_1['default'][_0x5ccb03(0x11f)](_0x199ac4,config_1['config'][_0x5ccb03(0x11c)]['secret'],{'expiresIn':String(config_1[_0x5ccb03(0x104)]['jwt']['expiresIn'])});}async[a36_0x53dd46(0x106)](_0x21f9fc){const _0x1da83b=a36_0x53dd46,{username:_0x2a2440,password:_0x1b62f8}=_0x21f9fc;if(_0x2a2440===config_1['config'][_0x1da83b(0x11b)]['username']){const _0x5a1d8a=await bcryptjs_1['default'][_0x1da83b(0x11a)](_0x1b62f8,config_1['config'][_0x1da83b(0x11b)][_0x1da83b(0x120)]);if(_0x5a1d8a){const _0x1641a7=this['generateToken']({'id':_0x1da83b(0x11b),'username':config_1['config'][_0x1da83b(0x11b)]['username'],'role':_0x1da83b(0x11b)});return{'access_token':_0x1641a7,'role':_0x1da83b(0x11b)};}}const _0x5e35a0=await database_1[_0x1da83b(0x109)][_0x1da83b(0x113)]['findUnique']({'where':{'username':_0x2a2440},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x5e35a0)throw new Error(_0x1da83b(0x122));if(_0x5e35a0[_0x1da83b(0x121)]!==_0x1da83b(0x116))throw new Error(_0x1da83b(0x105));const _0x413f10=await bcryptjs_1[_0x1da83b(0x109)][_0x1da83b(0x11a)](_0x1b62f8,_0x5e35a0[_0x1da83b(0x127)]);if(!_0x413f10)throw new Error(_0x1da83b(0x122));const _0x18350a=this[_0x1da83b(0x10d)]({'id':_0x5e35a0['id'],'username':_0x5e35a0['username'],'role':_0x1da83b(0x113)});return{'access_token':_0x18350a,'role':_0x1da83b(0x113),'user':{'id':_0x5e35a0['id'],'name':_0x5e35a0[_0x1da83b(0x126)],'username':_0x5e35a0[_0x1da83b(0x10e)]}};}async['verifyToken'](_0x26eccb){const _0xadc1fc=a36_0x53dd46;try{const _0x417894=jsonwebtoken_1[_0xadc1fc(0x109)][_0xadc1fc(0x11e)](_0x26eccb,config_1['config']['jwt'][_0xadc1fc(0x117)]);return _0x417894;}catch(_0x33940a){throw new Error('Invalid\x20token');}}}exports[a36_0x53dd46(0x107)]=AuthService;