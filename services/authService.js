'use strict';const a36_0x200677=a36_0x456b;(function(_0x2391a0,_0x204431){const _0x29bc7f=a36_0x456b,_0x4985d5=_0x2391a0();while(!![]){try{const _0x5dad7d=-parseInt(_0x29bc7f(0x17d))/0x1*(-parseInt(_0x29bc7f(0x188))/0x2)+-parseInt(_0x29bc7f(0x18b))/0x3+parseInt(_0x29bc7f(0x176))/0x4*(-parseInt(_0x29bc7f(0x177))/0x5)+-parseInt(_0x29bc7f(0x18c))/0x6*(parseInt(_0x29bc7f(0x183))/0x7)+-parseInt(_0x29bc7f(0x185))/0x8+parseInt(_0x29bc7f(0x173))/0x9*(parseInt(_0x29bc7f(0x191))/0xa)+-parseInt(_0x29bc7f(0x175))/0xb*(-parseInt(_0x29bc7f(0x17a))/0xc);if(_0x5dad7d===_0x204431)break;else _0x4985d5['push'](_0x4985d5['shift']());}catch(_0x22638d){_0x4985d5['push'](_0x4985d5['shift']());}}}(a36_0x5f21,0x99d76));var __importDefault=this&&this['__importDefault']||function(_0x3b99b2){return _0x3b99b2&&_0x3b99b2['__esModule']?_0x3b99b2:{'default':_0x3b99b2};};Object[a36_0x200677(0x182)](exports,a36_0x200677(0x179),{'value':!![]}),exports[a36_0x200677(0x18a)]=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),jsonwebtoken_1=__importDefault(require(a36_0x200677(0x17b))),database_1=__importDefault(require(a36_0x200677(0x18e))),config_1=require(a36_0x200677(0x187));function a36_0x456b(_0x1f5aa3,_0x3440cf){const _0x5f2180=a36_0x5f21();return a36_0x456b=function(_0x456b6b,_0x578c81){_0x456b6b=_0x456b6b-0x16e;let _0x5f2c2a=_0x5f2180[_0x456b6b];return _0x5f2c2a;},a36_0x456b(_0x1f5aa3,_0x3440cf);}function a36_0x5f21(){const _0x4444bb=['342wcjVGT','generateToken','92818cuCeIN','370556jePgpJ','20DITrpa','config','__esModule','1368pgITrj','jsonwebtoken','Invalid\x20credentials','23oroQKG','status','passwordHash','username','default','defineProperty','538356bXZWFt','compare','120632qtsEAB','name','../config/config','88198uKHAJW','verifyToken','AuthService','3098082YXAXdV','24odxmLW','admin','../config/database','sign','password','99970cFBlCf','ACTIVE','login','expiresIn','jwt','Invalid\x20token','secret'];a36_0x5f21=function(){return _0x4444bb;};return a36_0x5f21();}class AuthService{[a36_0x200677(0x174)](_0xf6666d){const _0x57d744=a36_0x200677;return jsonwebtoken_1['default'][_0x57d744(0x18f)](_0xf6666d,config_1[_0x57d744(0x178)][_0x57d744(0x170)][_0x57d744(0x172)],{'expiresIn':String(config_1['config'][_0x57d744(0x170)][_0x57d744(0x16f)])});}async[a36_0x200677(0x16e)](_0x59a150){const _0x542ccc=a36_0x200677,{username:_0x123a6a,password:_0x5c5c43}=_0x59a150;if(_0x123a6a===config_1[_0x542ccc(0x178)]['admin'][_0x542ccc(0x180)]){const _0x2a0630=await bcryptjs_1['default']['compare'](_0x5c5c43,config_1[_0x542ccc(0x178)][_0x542ccc(0x18d)][_0x542ccc(0x17f)]);if(_0x2a0630){const _0x228631=this[_0x542ccc(0x174)]({'id':_0x542ccc(0x18d),'username':config_1[_0x542ccc(0x178)]['admin']['username'],'role':_0x542ccc(0x18d)});return{'access_token':_0x228631,'role':_0x542ccc(0x18d)};}}const _0x26add4=await database_1[_0x542ccc(0x181)]['shop']['findUnique']({'where':{'username':_0x123a6a},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x26add4)throw new Error(_0x542ccc(0x17c));if(_0x26add4[_0x542ccc(0x17e)]!==_0x542ccc(0x192))throw new Error('Account\x20is\x20not\x20active');const _0x7a20a1=await bcryptjs_1[_0x542ccc(0x181)][_0x542ccc(0x184)](_0x5c5c43,_0x26add4[_0x542ccc(0x190)]);if(!_0x7a20a1)throw new Error('Invalid\x20credentials');const _0x1722e8=this[_0x542ccc(0x174)]({'id':_0x26add4['id'],'username':_0x26add4['username'],'role':'shop'});return{'access_token':_0x1722e8,'role':'shop','user':{'id':_0x26add4['id'],'name':_0x26add4[_0x542ccc(0x186)],'username':_0x26add4[_0x542ccc(0x180)]}};}async[a36_0x200677(0x189)](_0x505518){const _0x32f0dd=a36_0x200677;try{const _0x23423f=jsonwebtoken_1[_0x32f0dd(0x181)]['verify'](_0x505518,config_1[_0x32f0dd(0x178)]['jwt']['secret']);return _0x23423f;}catch(_0x3a3117){throw new Error(_0x32f0dd(0x171));}}}exports[a36_0x200677(0x18a)]=AuthService;