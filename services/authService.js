'use strict';const a36_0x21dea1=a36_0x223f;(function(_0x4b6eec,_0xa2f1af){const _0x299313=a36_0x223f,_0x5597fb=_0x4b6eec();while(!![]){try{const _0x4b2146=parseInt(_0x299313(0x13d))/0x1*(parseInt(_0x299313(0x12d))/0x2)+parseInt(_0x299313(0x140))/0x3+-parseInt(_0x299313(0x144))/0x4+-parseInt(_0x299313(0x130))/0x5*(-parseInt(_0x299313(0x149))/0x6)+-parseInt(_0x299313(0x136))/0x7*(parseInt(_0x299313(0x14a))/0x8)+parseInt(_0x299313(0x13b))/0x9+parseInt(_0x299313(0x146))/0xa*(-parseInt(_0x299313(0x142))/0xb);if(_0x4b2146===_0xa2f1af)break;else _0x5597fb['push'](_0x5597fb['shift']());}catch(_0x45646a){_0x5597fb['push'](_0x5597fb['shift']());}}}(a36_0xb8b3,0x855b3));function a36_0x223f(_0xb642a7,_0x4e125e){const _0xb8b3d=a36_0xb8b3();return a36_0x223f=function(_0x223f26,_0x58724d){_0x223f26=_0x223f26-0x12c;let _0x48001e=_0xb8b3d[_0x223f26];return _0x48001e;},a36_0x223f(_0xb642a7,_0x4e125e);}var __importDefault=this&&this['__importDefault']||function(_0x253a18){return _0x253a18&&_0x253a18['__esModule']?_0x253a18:{'default':_0x253a18};};Object['defineProperty'](exports,a36_0x21dea1(0x145),{'value':!![]}),exports['AuthService']=void 0x0;function a36_0xb8b3(){const _0x1111d0=['generateToken','default','shop','370iysogl','bcryptjs','jwt','5Tmqxjf','../config/database','verifyToken','login','passwordHash','compare','7aEHhCR','Invalid\x20credentials','Account\x20is\x20not\x20active','../config/config','sign','7345332tUNOYq','AuthService','1221bEKHyv','verify','admin','766026BPXDyg','expiresIn','90673uNoXUB','jsonwebtoken','1162648AUmqWU','__esModule','1130XYFHNh','Invalid\x20token','username','4466808fkjUOV','2187960rKpqlK','secret','name','ACTIVE','config'];a36_0xb8b3=function(){return _0x1111d0;};return a36_0xb8b3();}const bcryptjs_1=__importDefault(require(a36_0x21dea1(0x12e))),jsonwebtoken_1=__importDefault(require(a36_0x21dea1(0x143))),database_1=__importDefault(require(a36_0x21dea1(0x131))),config_1=require(a36_0x21dea1(0x139));class AuthService{['generateToken'](_0x492f73){const _0x1c39d2=a36_0x21dea1;return jsonwebtoken_1['default'][_0x1c39d2(0x13a)](_0x492f73,config_1[_0x1c39d2(0x14e)]['jwt'][_0x1c39d2(0x14b)],{'expiresIn':String(config_1[_0x1c39d2(0x14e)]['jwt'][_0x1c39d2(0x141)])});}async[a36_0x21dea1(0x133)](_0x5a30e3){const _0x25f6e7=a36_0x21dea1,{username:_0x163f54,password:_0x31849b}=_0x5a30e3;if(_0x163f54===config_1[_0x25f6e7(0x14e)][_0x25f6e7(0x13f)][_0x25f6e7(0x148)]){const _0x301d77=await bcryptjs_1[_0x25f6e7(0x150)][_0x25f6e7(0x135)](_0x31849b,config_1[_0x25f6e7(0x14e)][_0x25f6e7(0x13f)][_0x25f6e7(0x134)]);if(_0x301d77){const _0x37ec7f=this[_0x25f6e7(0x14f)]({'id':_0x25f6e7(0x13f),'username':config_1[_0x25f6e7(0x14e)][_0x25f6e7(0x13f)]['username'],'role':_0x25f6e7(0x13f)});return{'access_token':_0x37ec7f,'role':_0x25f6e7(0x13f)};}}const _0xb2fb50=await database_1[_0x25f6e7(0x150)][_0x25f6e7(0x12c)]['findUnique']({'where':{'username':_0x163f54},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0xb2fb50)throw new Error(_0x25f6e7(0x137));if(_0xb2fb50['status']!==_0x25f6e7(0x14d))throw new Error(_0x25f6e7(0x138));const _0x17add5=await bcryptjs_1['default'][_0x25f6e7(0x135)](_0x31849b,_0xb2fb50['password']);if(!_0x17add5)throw new Error(_0x25f6e7(0x137));const _0x499435=this[_0x25f6e7(0x14f)]({'id':_0xb2fb50['id'],'username':_0xb2fb50[_0x25f6e7(0x148)],'role':_0x25f6e7(0x12c)});return{'access_token':_0x499435,'role':_0x25f6e7(0x12c),'user':{'id':_0xb2fb50['id'],'name':_0xb2fb50[_0x25f6e7(0x14c)],'username':_0xb2fb50['username']}};}async[a36_0x21dea1(0x132)](_0x20615b){const _0x32652b=a36_0x21dea1;try{const _0x48b93d=jsonwebtoken_1[_0x32652b(0x150)][_0x32652b(0x13e)](_0x20615b,config_1[_0x32652b(0x14e)][_0x32652b(0x12f)][_0x32652b(0x14b)]);return _0x48b93d;}catch(_0x54536d){throw new Error(_0x32652b(0x147));}}}exports[a36_0x21dea1(0x13c)]=AuthService;