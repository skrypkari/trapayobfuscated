'use strict';function a37_0x1dc5(){const _0xde8a32=['Invalid\x20token','4286208mQyWEJ','4269852phVbAP','default','secret','4002872hqOUEt','3BYybOc','Account\x20is\x20not\x20active','450234hxyzTz','login','findUnique','5489302eHRWEB','admin','compare','3953590iTaKud','expiresIn','jwt','Invalid\x20credentials','status','verify','bcryptjs','2483312FUyDfv','generateToken','username','AuthService','3uxCEeO','../config/database','sign','name','../config/config','shop','__esModule','config','verifyToken'];a37_0x1dc5=function(){return _0xde8a32;};return a37_0x1dc5();}const a37_0x23bb92=a37_0x5916;(function(_0x3bf0b6,_0x35d97f){const _0x2cb9cb=a37_0x5916,_0x3036c6=_0x3bf0b6();while(!![]){try{const _0x587c1e=parseInt(_0x2cb9cb(0xd2))/0x1*(parseInt(_0x2cb9cb(0xd4))/0x2)+-parseInt(_0x2cb9cb(0xe5))/0x3*(-parseInt(_0x2cb9cb(0xe1))/0x4)+-parseInt(_0x2cb9cb(0xda))/0x5+parseInt(_0x2cb9cb(0xcd))/0x6+-parseInt(_0x2cb9cb(0xd7))/0x7+-parseInt(_0x2cb9cb(0xd1))/0x8+parseInt(_0x2cb9cb(0xce))/0x9;if(_0x587c1e===_0x35d97f)break;else _0x3036c6['push'](_0x3036c6['shift']());}catch(_0xce17b5){_0x3036c6['push'](_0x3036c6['shift']());}}}(a37_0x1dc5,0x64070));var __importDefault=this&&this['__importDefault']||function(_0x192b98){const _0x533a2f=a37_0x5916;return _0x192b98&&_0x192b98[_0x533a2f(0xc9)]?_0x192b98:{'default':_0x192b98};};Object['defineProperty'](exports,a37_0x23bb92(0xc9),{'value':!![]}),exports['AuthService']=void 0x0;const bcryptjs_1=__importDefault(require(a37_0x23bb92(0xe0))),jsonwebtoken_1=__importDefault(require('jsonwebtoken')),database_1=__importDefault(require(a37_0x23bb92(0xe6))),config_1=require(a37_0x23bb92(0xe9));function a37_0x5916(_0x22a1e0,_0x33b1d5){const _0x1dc501=a37_0x1dc5();return a37_0x5916=function(_0x5916c0,_0x207eb2){_0x5916c0=_0x5916c0-0xc9;let _0x43d9f6=_0x1dc501[_0x5916c0];return _0x43d9f6;},a37_0x5916(_0x22a1e0,_0x33b1d5);}class AuthService{[a37_0x23bb92(0xe2)](_0x140fed){const _0x4ca2aa=a37_0x23bb92;return jsonwebtoken_1[_0x4ca2aa(0xcf)][_0x4ca2aa(0xe7)](_0x140fed,config_1[_0x4ca2aa(0xca)]['jwt']['secret'],{'expiresIn':String(config_1['config'][_0x4ca2aa(0xdc)][_0x4ca2aa(0xdb)])});}async[a37_0x23bb92(0xd5)](_0x342567){const _0x1b03dc=a37_0x23bb92,{username:_0x154357,password:_0x571bfd}=_0x342567;if(_0x154357===config_1[_0x1b03dc(0xca)][_0x1b03dc(0xd8)][_0x1b03dc(0xe3)]){const _0x2a28c5=await bcryptjs_1[_0x1b03dc(0xcf)][_0x1b03dc(0xd9)](_0x571bfd,config_1['config'][_0x1b03dc(0xd8)]['passwordHash']);if(_0x2a28c5){const _0x89417=this['generateToken']({'id':_0x1b03dc(0xd8),'username':config_1[_0x1b03dc(0xca)][_0x1b03dc(0xd8)][_0x1b03dc(0xe3)],'role':_0x1b03dc(0xd8)});return{'access_token':_0x89417,'role':_0x1b03dc(0xd8)};}}const _0x5de8f9=await database_1[_0x1b03dc(0xcf)][_0x1b03dc(0xea)][_0x1b03dc(0xd6)]({'where':{'username':_0x154357},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x5de8f9)throw new Error(_0x1b03dc(0xdd));if(_0x5de8f9[_0x1b03dc(0xde)]!=='ACTIVE')throw new Error(_0x1b03dc(0xd3));const _0x5e9cd3=await bcryptjs_1[_0x1b03dc(0xcf)][_0x1b03dc(0xd9)](_0x571bfd,_0x5de8f9['password']);if(!_0x5e9cd3)throw new Error(_0x1b03dc(0xdd));const _0x38a9a8=this['generateToken']({'id':_0x5de8f9['id'],'username':_0x5de8f9['username'],'role':'shop'});return{'access_token':_0x38a9a8,'role':_0x1b03dc(0xea),'user':{'id':_0x5de8f9['id'],'name':_0x5de8f9[_0x1b03dc(0xe8)],'username':_0x5de8f9[_0x1b03dc(0xe3)]}};}async[a37_0x23bb92(0xcb)](_0x42e666){const _0x2af518=a37_0x23bb92;try{const _0x2a976f=jsonwebtoken_1[_0x2af518(0xcf)][_0x2af518(0xdf)](_0x42e666,config_1['config'][_0x2af518(0xdc)][_0x2af518(0xd0)]);return _0x2a976f;}catch(_0x3678b0){throw new Error(_0x2af518(0xcc));}}}exports[a37_0x23bb92(0xe4)]=AuthService;