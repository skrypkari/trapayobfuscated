'use strict';const a36_0x7643a9=a36_0x441f;function a36_0x441f(_0x42ee9a,_0x3f9f17){const _0x2bbb2c=a36_0x2bbb();return a36_0x441f=function(_0x441fbe,_0x4d870d){_0x441fbe=_0x441fbe-0x1ad;let _0x4d9f1f=_0x2bbb2c[_0x441fbe];return _0x4d9f1f;},a36_0x441f(_0x42ee9a,_0x3f9f17);}(function(_0x437780,_0x49dfe7){const _0x53238a=a36_0x441f,_0x5be73d=_0x437780();while(!![]){try{const _0x2ca3c9=parseInt(_0x53238a(0x1c1))/0x1*(parseInt(_0x53238a(0x1ce))/0x2)+-parseInt(_0x53238a(0x1bf))/0x3+-parseInt(_0x53238a(0x1cb))/0x4*(parseInt(_0x53238a(0x1c2))/0x5)+-parseInt(_0x53238a(0x1b7))/0x6*(-parseInt(_0x53238a(0x1c6))/0x7)+-parseInt(_0x53238a(0x1b3))/0x8+-parseInt(_0x53238a(0x1cc))/0x9+parseInt(_0x53238a(0x1be))/0xa;if(_0x2ca3c9===_0x49dfe7)break;else _0x5be73d['push'](_0x5be73d['shift']());}catch(_0x44e71d){_0x5be73d['push'](_0x5be73d['shift']());}}}(a36_0x2bbb,0xe681d));var __importDefault=this&&this[a36_0x7643a9(0x1d3)]||function(_0x7ab15c){const _0x49b1fd=a36_0x7643a9;return _0x7ab15c&&_0x7ab15c[_0x49b1fd(0x1c8)]?_0x7ab15c:{'default':_0x7ab15c};};Object[a36_0x7643a9(0x1af)](exports,a36_0x7643a9(0x1c8),{'value':!![]}),exports[a36_0x7643a9(0x1b9)]=void 0x0;const bcryptjs_1=__importDefault(require(a36_0x7643a9(0x1b0))),jsonwebtoken_1=__importDefault(require(a36_0x7643a9(0x1c0))),database_1=__importDefault(require(a36_0x7643a9(0x1d2))),config_1=require(a36_0x7643a9(0x1c3));class AuthService{['generateToken'](_0x1bc63b){const _0x19b1ba=a36_0x7643a9;return jsonwebtoken_1[_0x19b1ba(0x1ad)][_0x19b1ba(0x1b6)](_0x1bc63b,config_1[_0x19b1ba(0x1cf)][_0x19b1ba(0x1c5)][_0x19b1ba(0x1b4)],{'expiresIn':String(config_1[_0x19b1ba(0x1cf)]['jwt'][_0x19b1ba(0x1bd)])});}async[a36_0x7643a9(0x1b5)](_0x3b955c){const _0x4466af=a36_0x7643a9,{username:_0x5907f0,password:_0x56f4eb}=_0x3b955c;if(_0x5907f0===config_1[_0x4466af(0x1cf)][_0x4466af(0x1b2)][_0x4466af(0x1b1)]){const _0x410236=await bcryptjs_1[_0x4466af(0x1ad)][_0x4466af(0x1d1)](_0x56f4eb,config_1['config']['admin'][_0x4466af(0x1b8)]);if(_0x410236){const _0x1ac734=this[_0x4466af(0x1c4)]({'id':_0x4466af(0x1b2),'username':config_1['config']['admin'][_0x4466af(0x1b1)],'role':_0x4466af(0x1b2)});return{'access_token':_0x1ac734,'role':_0x4466af(0x1b2)};}}const _0x1707aa=await database_1[_0x4466af(0x1ad)][_0x4466af(0x1ba)][_0x4466af(0x1d0)]({'where':{'username':_0x5907f0},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x1707aa)throw new Error(_0x4466af(0x1ae));if(_0x1707aa[_0x4466af(0x1ca)]!==_0x4466af(0x1bb))throw new Error(_0x4466af(0x1c7));const _0x1a134e=await bcryptjs_1[_0x4466af(0x1ad)]['compare'](_0x56f4eb,_0x1707aa[_0x4466af(0x1bc)]);if(!_0x1a134e)throw new Error(_0x4466af(0x1ae));const _0x37639d=this[_0x4466af(0x1c4)]({'id':_0x1707aa['id'],'username':_0x1707aa[_0x4466af(0x1b1)],'role':'shop'});return{'access_token':_0x37639d,'role':_0x4466af(0x1ba),'user':{'id':_0x1707aa['id'],'name':_0x1707aa['name'],'username':_0x1707aa['username']}};}async[a36_0x7643a9(0x1cd)](_0x33bab9){const _0x3bfe52=a36_0x7643a9;try{const _0x595a63=jsonwebtoken_1[_0x3bfe52(0x1ad)][_0x3bfe52(0x1c9)](_0x33bab9,config_1[_0x3bfe52(0x1cf)]['jwt'][_0x3bfe52(0x1b4)]);return _0x595a63;}catch(_0x1c033a){throw new Error(_0x3bfe52(0x1d4));}}}function a36_0x2bbb(){const _0x963cbe=['14508630lxLuBC','verifyToken','2cQEhsp','config','findUnique','compare','../config/database','__importDefault','Invalid\x20token','default','Invalid\x20credentials','defineProperty','bcryptjs','username','admin','7649712AXOmTo','secret','login','sign','420XyUuqW','passwordHash','AuthService','shop','ACTIVE','password','expiresIn','34166750gafNbr','698877CilSYs','jsonwebtoken','87956pxNbJE','6238205kDWIyj','../config/config','generateToken','jwt','148841NkuWqE','Account\x20is\x20not\x20active','__esModule','verify','status','4tqBYoQ'];a36_0x2bbb=function(){return _0x963cbe;};return a36_0x2bbb();}exports[a36_0x7643a9(0x1b9)]=AuthService;