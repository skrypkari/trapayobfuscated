'use strict';function a37_0x3d62(){const _0xadbeca=['Invalid\x20credentials','22798307GYBtOT','__importDefault','default','shop','ACTIVE','779082lrrcrr','3847497LwsATW','__esModule','bcryptjs','login','username','5387885lXsYyb','2804244rlUJgK','../config/config','1216446WAcXpD','verifyToken','Invalid\x20token','secret','generateToken','verify','3883040gelBDx','admin','findUnique','Account\x20is\x20not\x20active','config','status','jwt','compare','AuthService','expiresIn','name'];a37_0x3d62=function(){return _0xadbeca;};return a37_0x3d62();}const a37_0x411640=a37_0x4219;(function(_0x2b536d,_0x2df97b){const _0x182026=a37_0x4219,_0x1caf2f=_0x2b536d();while(!![]){try{const _0x5d2476=-parseInt(_0x182026(0xe3))/0x1+parseInt(_0x182026(0xea))/0x2+parseInt(_0x182026(0xe4))/0x3+parseInt(_0x182026(0xf2))/0x4+parseInt(_0x182026(0xe9))/0x5+parseInt(_0x182026(0xec))/0x6+-parseInt(_0x182026(0xde))/0x7;if(_0x5d2476===_0x2df97b)break;else _0x1caf2f['push'](_0x1caf2f['shift']());}catch(_0x2c1558){_0x1caf2f['push'](_0x1caf2f['shift']());}}}(a37_0x3d62,0xdba84));function a37_0x4219(_0x527943,_0x14f2e9){const _0x3d624b=a37_0x3d62();return a37_0x4219=function(_0x4219ce,_0x83685a){_0x4219ce=_0x4219ce-0xd6;let _0x4ab934=_0x3d624b[_0x4219ce];return _0x4ab934;},a37_0x4219(_0x527943,_0x14f2e9);}var __importDefault=this&&this[a37_0x411640(0xdf)]||function(_0x83a68e){return _0x83a68e&&_0x83a68e['__esModule']?_0x83a68e:{'default':_0x83a68e};};Object['defineProperty'](exports,a37_0x411640(0xe5),{'value':!![]}),exports[a37_0x411640(0xda)]=void 0x0;const bcryptjs_1=__importDefault(require(a37_0x411640(0xe6))),jsonwebtoken_1=__importDefault(require('jsonwebtoken')),database_1=__importDefault(require('../config/database')),config_1=require(a37_0x411640(0xeb));class AuthService{[a37_0x411640(0xf0)](_0x12b913){const _0x20ede4=a37_0x411640;return jsonwebtoken_1[_0x20ede4(0xe0)]['sign'](_0x12b913,config_1[_0x20ede4(0xd6)][_0x20ede4(0xd8)][_0x20ede4(0xef)],{'expiresIn':String(config_1[_0x20ede4(0xd6)][_0x20ede4(0xd8)][_0x20ede4(0xdb)])});}async[a37_0x411640(0xe7)](_0x5d42fa){const _0x45fee6=a37_0x411640,{username:_0x4ba102,password:_0x3e7414}=_0x5d42fa;if(_0x4ba102===config_1['config'][_0x45fee6(0xf3)]['username']){const _0xdbad2d=await bcryptjs_1[_0x45fee6(0xe0)][_0x45fee6(0xd9)](_0x3e7414,config_1['config'][_0x45fee6(0xf3)]['passwordHash']);if(_0xdbad2d){const _0xeb1709=this[_0x45fee6(0xf0)]({'id':_0x45fee6(0xf3),'username':config_1[_0x45fee6(0xd6)][_0x45fee6(0xf3)][_0x45fee6(0xe8)],'role':_0x45fee6(0xf3)});return{'access_token':_0xeb1709,'role':_0x45fee6(0xf3)};}}const _0x4f4c51=await database_1[_0x45fee6(0xe0)]['shop'][_0x45fee6(0xf4)]({'where':{'username':_0x4ba102},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x4f4c51)throw new Error(_0x45fee6(0xdd));if(_0x4f4c51[_0x45fee6(0xd7)]!==_0x45fee6(0xe2))throw new Error(_0x45fee6(0xf5));const _0x57dcc0=await bcryptjs_1['default'][_0x45fee6(0xd9)](_0x3e7414,_0x4f4c51['password']);if(!_0x57dcc0)throw new Error(_0x45fee6(0xdd));const _0x5dccef=this['generateToken']({'id':_0x4f4c51['id'],'username':_0x4f4c51[_0x45fee6(0xe8)],'role':_0x45fee6(0xe1)});return{'access_token':_0x5dccef,'role':'shop','user':{'id':_0x4f4c51['id'],'name':_0x4f4c51[_0x45fee6(0xdc)],'username':_0x4f4c51[_0x45fee6(0xe8)]}};}async[a37_0x411640(0xed)](_0xa3f7ae){const _0x344604=a37_0x411640;try{const _0x47106f=jsonwebtoken_1[_0x344604(0xe0)][_0x344604(0xf1)](_0xa3f7ae,config_1['config'][_0x344604(0xd8)]['secret']);return _0x47106f;}catch(_0x4ed9a5){throw new Error(_0x344604(0xee));}}}exports[a37_0x411640(0xda)]=AuthService;