'use strict';function a39_0xa358(_0x456880,_0x43e39d){const _0x193a13=a39_0x193a();return a39_0xa358=function(_0xa358e5,_0x5c9d36){_0xa358e5=_0xa358e5-0xd5;let _0x4967b7=_0x193a13[_0xa358e5];return _0x4967b7;},a39_0xa358(_0x456880,_0x43e39d);}const a39_0x47c9f1=a39_0xa358;(function(_0x3f4fed,_0x7729ad){const _0x1cdf1a=a39_0xa358,_0x4a406c=_0x3f4fed();while(!![]){try{const _0x481a0e=parseInt(_0x1cdf1a(0xf7))/0x1*(-parseInt(_0x1cdf1a(0xda))/0x2)+-parseInt(_0x1cdf1a(0xdb))/0x3*(-parseInt(_0x1cdf1a(0xf3))/0x4)+-parseInt(_0x1cdf1a(0xf6))/0x5*(parseInt(_0x1cdf1a(0xd6))/0x6)+-parseInt(_0x1cdf1a(0xe0))/0x7*(parseInt(_0x1cdf1a(0xfb))/0x8)+-parseInt(_0x1cdf1a(0xf9))/0x9*(-parseInt(_0x1cdf1a(0xfe))/0xa)+-parseInt(_0x1cdf1a(0xf1))/0xb*(parseInt(_0x1cdf1a(0xd9))/0xc)+parseInt(_0x1cdf1a(0xe3))/0xd*(parseInt(_0x1cdf1a(0xdc))/0xe);if(_0x481a0e===_0x7729ad)break;else _0x4a406c['push'](_0x4a406c['shift']());}catch(_0x1e6a86){_0x4a406c['push'](_0x4a406c['shift']());}}}(a39_0x193a,0xa91c7));var __importDefault=this&&this[a39_0x47c9f1(0xd8)]||function(_0x44d14a){return _0x44d14a&&_0x44d14a['__esModule']?_0x44d14a:{'default':_0x44d14a};};Object[a39_0x47c9f1(0xee)](exports,a39_0x47c9f1(0xd7),{'value':!![]}),exports[a39_0x47c9f1(0xe6)]=void 0x0;const bcryptjs_1=__importDefault(require(a39_0x47c9f1(0xeb))),jsonwebtoken_1=__importDefault(require(a39_0x47c9f1(0xfc))),database_1=__importDefault(require(a39_0x47c9f1(0xe1))),config_1=require(a39_0x47c9f1(0xf5));class AuthService{['generateToken'](_0x7d0ec7){const _0x37d5ad=a39_0x47c9f1;return jsonwebtoken_1[_0x37d5ad(0xfa)]['sign'](_0x7d0ec7,config_1[_0x37d5ad(0xe5)]['jwt']['secret'],{'expiresIn':String(config_1[_0x37d5ad(0xe5)]['jwt']['expiresIn'])});}async[a39_0x47c9f1(0xf4)](_0x5df4c0){const _0x475ada=a39_0x47c9f1,{username:_0x175ca6,password:_0x1f6598}=_0x5df4c0;if(_0x175ca6===config_1['config']['admin']['username']){const _0x8cdb17=await bcryptjs_1[_0x475ada(0xfa)]['compare'](_0x1f6598,config_1[_0x475ada(0xe5)][_0x475ada(0xe7)][_0x475ada(0xf8)]);if(_0x8cdb17){const _0x2ab6d8=this[_0x475ada(0xf2)]({'id':'admin','username':config_1[_0x475ada(0xe5)][_0x475ada(0xe7)]['username'],'role':_0x475ada(0xe7)});return{'access_token':_0x2ab6d8,'role':_0x475ada(0xe7)};}}const _0x242618=await database_1[_0x475ada(0xfa)][_0x475ada(0xe2)][_0x475ada(0xde)]({'where':{'username':_0x175ca6},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x242618)throw new Error(_0x475ada(0xfd));if(_0x242618[_0x475ada(0xdf)]!==_0x475ada(0xef))throw new Error(_0x475ada(0xf0));const _0x4b1587=await bcryptjs_1[_0x475ada(0xfa)][_0x475ada(0xdd)](_0x1f6598,_0x242618[_0x475ada(0xe9)]);if(!_0x4b1587)throw new Error(_0x475ada(0xfd));const _0x247768=this[_0x475ada(0xf2)]({'id':_0x242618['id'],'username':_0x242618[_0x475ada(0xff)],'role':_0x475ada(0xe2)});return{'access_token':_0x247768,'role':_0x475ada(0xe2),'user':{'id':_0x242618['id'],'name':_0x242618[_0x475ada(0xe8)],'username':_0x242618[_0x475ada(0xff)]}};}async[a39_0x47c9f1(0xec)](_0x2cacb5){const _0x1bb876=a39_0x47c9f1;try{const _0x2b3d51=jsonwebtoken_1[_0x1bb876(0xfa)][_0x1bb876(0xe4)](_0x2cacb5,config_1[_0x1bb876(0xe5)][_0x1bb876(0xea)][_0x1bb876(0xd5)]);return _0x2b3d51;}catch(_0x496f31){throw new Error(_0x1bb876(0xed));}}}function a39_0x193a(){const _0x4c0e7c=['bcryptjs','verifyToken','Invalid\x20token','defineProperty','ACTIVE','Account\x20is\x20not\x20active','1595ycKUYM','generateToken','8AVRPBy','login','../config/config','15055oEFoQp','1607BKpDNl','passwordHash','9153yeXYNE','default','32ymTuKS','jsonwebtoken','Invalid\x20credentials','4250znXFzk','username','secret','1386BPPrUH','__esModule','__importDefault','72252LlGgyC','1246xWeWIS','2005962GsQmaO','853174hgTGSF','compare','findUnique','status','480193XcTuSZ','../config/database','shop','377ewXAPS','verify','config','AuthService','admin','name','password','jwt'];a39_0x193a=function(){return _0x4c0e7c;};return a39_0x193a();}exports[a39_0x47c9f1(0xe6)]=AuthService;