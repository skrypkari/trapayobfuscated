'use strict';const a34_0x2dd0b3=a34_0x54ee;(function(_0x30a733,_0x3b340e){const _0x1c44a8=a34_0x54ee,_0xee988e=_0x30a733();while(!![]){try{const _0x150608=parseInt(_0x1c44a8(0x13f))/0x1*(parseInt(_0x1c44a8(0x12a))/0x2)+-parseInt(_0x1c44a8(0x13b))/0x3*(parseInt(_0x1c44a8(0x13a))/0x4)+-parseInt(_0x1c44a8(0x13e))/0x5*(parseInt(_0x1c44a8(0x131))/0x6)+-parseInt(_0x1c44a8(0x134))/0x7*(parseInt(_0x1c44a8(0x125))/0x8)+-parseInt(_0x1c44a8(0x139))/0x9+-parseInt(_0x1c44a8(0x128))/0xa*(parseInt(_0x1c44a8(0x123))/0xb)+parseInt(_0x1c44a8(0x12d))/0xc;if(_0x150608===_0x3b340e)break;else _0xee988e['push'](_0xee988e['shift']());}catch(_0x1afe58){_0xee988e['push'](_0xee988e['shift']());}}}(a34_0x3132,0xb8afe));var __importDefault=this&&this['__importDefault']||function(_0x57a6aa){return _0x57a6aa&&_0x57a6aa['__esModule']?_0x57a6aa:{'default':_0x57a6aa};};function a34_0x54ee(_0x9c15cf,_0x132a7c){const _0x3132f5=a34_0x3132();return a34_0x54ee=function(_0x54eea8,_0xfe6fb5){_0x54eea8=_0x54eea8-0x11a;let _0x5a07d1=_0x3132f5[_0x54eea8];return _0x5a07d1;},a34_0x54ee(_0x9c15cf,_0x132a7c);}Object[a34_0x2dd0b3(0x130)](exports,a34_0x2dd0b3(0x12c),{'value':!![]}),exports[a34_0x2dd0b3(0x11d)]=void 0x0;const bcryptjs_1=__importDefault(require(a34_0x2dd0b3(0x137))),jsonwebtoken_1=__importDefault(require(a34_0x2dd0b3(0x121))),database_1=__importDefault(require(a34_0x2dd0b3(0x13d))),config_1=require('../config/config');class AuthService{[a34_0x2dd0b3(0x129)](_0x37a9e4){const _0x40d78f=a34_0x2dd0b3;return jsonwebtoken_1[_0x40d78f(0x124)][_0x40d78f(0x12f)](_0x37a9e4,config_1[_0x40d78f(0x126)][_0x40d78f(0x11e)][_0x40d78f(0x132)],{'expiresIn':String(config_1[_0x40d78f(0x126)][_0x40d78f(0x11e)][_0x40d78f(0x120)])});}async[a34_0x2dd0b3(0x11a)](_0x10b76d){const _0x212f59=a34_0x2dd0b3,{username:_0x6b8218,password:_0x494b0b}=_0x10b76d;if(_0x6b8218===config_1['config'][_0x212f59(0x133)]['username']){const _0x3c2d1a=await bcryptjs_1[_0x212f59(0x124)][_0x212f59(0x138)](_0x494b0b,config_1[_0x212f59(0x126)][_0x212f59(0x133)][_0x212f59(0x13c)]);if(_0x3c2d1a){const _0x49b8b8=this[_0x212f59(0x129)]({'id':_0x212f59(0x133),'username':config_1['config'][_0x212f59(0x133)][_0x212f59(0x11b)],'role':'admin'});return{'access_token':_0x49b8b8,'role':_0x212f59(0x133)};}}const _0x2d95c6=await database_1[_0x212f59(0x124)][_0x212f59(0x122)][_0x212f59(0x11f)]({'where':{'username':_0x6b8218},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x2d95c6)throw new Error('Invalid\x20credentials');if(_0x2d95c6[_0x212f59(0x12b)]!==_0x212f59(0x127))throw new Error('Account\x20is\x20not\x20active');const _0x36ed0d=await bcryptjs_1['default']['compare'](_0x494b0b,_0x2d95c6['password']);if(!_0x36ed0d)throw new Error(_0x212f59(0x135));const _0x43b1d6=this[_0x212f59(0x129)]({'id':_0x2d95c6['id'],'username':_0x2d95c6[_0x212f59(0x11b)],'role':_0x212f59(0x122)});return{'access_token':_0x43b1d6,'role':_0x212f59(0x122),'user':{'id':_0x2d95c6['id'],'name':_0x2d95c6[_0x212f59(0x12e)],'username':_0x2d95c6[_0x212f59(0x11b)]}};}async[a34_0x2dd0b3(0x136)](_0x26f96c){const _0x31af58=a34_0x2dd0b3;try{const _0x3f20f1=jsonwebtoken_1[_0x31af58(0x124)][_0x31af58(0x11c)](_0x26f96c,config_1[_0x31af58(0x126)][_0x31af58(0x11e)][_0x31af58(0x132)]);return _0x3f20f1;}catch(_0x530208){throw new Error('Invalid\x20token');}}}exports[a34_0x2dd0b3(0x11d)]=AuthService;function a34_0x3132(){const _0x3731f0=['admin','7Mpdwmh','Invalid\x20credentials','verifyToken','bcryptjs','compare','3312027udobwc','3340TQOpCy','1611NLdXHf','passwordHash','../config/database','5Okyzwa','1388796xEpPzz','login','username','verify','AuthService','jwt','findUnique','expiresIn','jsonwebtoken','shop','11JaGEOF','default','206128EQYRSM','config','ACTIVE','14815540dgXYGK','generateToken','2Uvuoay','status','__esModule','37868532QUJcmg','name','sign','defineProperty','8785866fFenup','secret'];a34_0x3132=function(){return _0x3731f0;};return a34_0x3132();}