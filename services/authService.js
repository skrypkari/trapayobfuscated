'use strict';const a34_0x2b9551=a34_0x1554;function a34_0x122a(){const _0x3ea97a=['config','admin','40KBukNT','jwt','expiresIn','password','secret','../config/config','__importDefault','verifyToken','status','jsonwebtoken','default','9465012AkuzhZ','generateToken','4072824CIoYSm','AuthService','compare','2891322sNyREy','154600Crkedr','949242xOSuci','username','Invalid\x20credentials','20BxkjnL','Account\x20is\x20not\x20active','defineProperty','bcryptjs','102FOIvhk','findUnique','1055012KMcnCv','verify','shop','passwordHash','1127882CwCqXS','Invalid\x20token','__esModule'];a34_0x122a=function(){return _0x3ea97a;};return a34_0x122a();}(function(_0x21bb7d,_0x165f90){const _0x5c8086=a34_0x1554,_0x4974f1=_0x21bb7d();while(!![]){try{const _0x51e1d0=parseInt(_0x5c8086(0x92))/0x1+parseInt(_0x5c8086(0x9f))/0x2+parseInt(_0x5c8086(0x90))/0x3+-parseInt(_0x5c8086(0x8d))/0x4+-parseInt(_0x5c8086(0x91))/0x5*(-parseInt(_0x5c8086(0x99))/0x6)+parseInt(_0x5c8086(0x9b))/0x7*(parseInt(_0x5c8086(0xa4))/0x8)+parseInt(_0x5c8086(0x8b))/0x9*(-parseInt(_0x5c8086(0x95))/0xa);if(_0x51e1d0===_0x165f90)break;else _0x4974f1['push'](_0x4974f1['shift']());}catch(_0x4158a0){_0x4974f1['push'](_0x4974f1['shift']());}}}(a34_0x122a,0x9af0b));var __importDefault=this&&this[a34_0x2b9551(0x86)]||function(_0x47f87f){const _0x2bd8da=a34_0x2b9551;return _0x47f87f&&_0x47f87f[_0x2bd8da(0xa1)]?_0x47f87f:{'default':_0x47f87f};};Object[a34_0x2b9551(0x97)](exports,a34_0x2b9551(0xa1),{'value':!![]}),exports[a34_0x2b9551(0x8e)]=void 0x0;const bcryptjs_1=__importDefault(require(a34_0x2b9551(0x98))),jsonwebtoken_1=__importDefault(require(a34_0x2b9551(0x89))),database_1=__importDefault(require('../config/database')),config_1=require(a34_0x2b9551(0x85));class AuthService{[a34_0x2b9551(0x8c)](_0x311061){const _0x237b08=a34_0x2b9551;return jsonwebtoken_1[_0x237b08(0x8a)]['sign'](_0x311061,config_1[_0x237b08(0xa2)]['jwt'][_0x237b08(0x84)],{'expiresIn':String(config_1['config'][_0x237b08(0xa5)][_0x237b08(0xa6)])});}async['login'](_0x2caec4){const _0x55b0d3=a34_0x2b9551,{username:_0x59d505,password:_0x29075c}=_0x2caec4;if(_0x59d505===config_1[_0x55b0d3(0xa2)][_0x55b0d3(0xa3)][_0x55b0d3(0x93)]){const _0x5ee24e=await bcryptjs_1['default'][_0x55b0d3(0x8f)](_0x29075c,config_1[_0x55b0d3(0xa2)][_0x55b0d3(0xa3)][_0x55b0d3(0x9e)]);if(_0x5ee24e){const _0x1b3587=this[_0x55b0d3(0x8c)]({'id':_0x55b0d3(0xa3),'username':config_1[_0x55b0d3(0xa2)][_0x55b0d3(0xa3)]['username'],'role':'admin'});return{'access_token':_0x1b3587,'role':'admin'};}}const _0x4330eb=await database_1['default']['shop'][_0x55b0d3(0x9a)]({'where':{'username':_0x59d505},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x4330eb)throw new Error(_0x55b0d3(0x94));if(_0x4330eb[_0x55b0d3(0x88)]!=='ACTIVE')throw new Error(_0x55b0d3(0x96));const _0x14ff08=await bcryptjs_1['default'][_0x55b0d3(0x8f)](_0x29075c,_0x4330eb[_0x55b0d3(0xa7)]);if(!_0x14ff08)throw new Error(_0x55b0d3(0x94));const _0x408fcf=this[_0x55b0d3(0x8c)]({'id':_0x4330eb['id'],'username':_0x4330eb[_0x55b0d3(0x93)],'role':_0x55b0d3(0x9d)});return{'access_token':_0x408fcf,'role':'shop','user':{'id':_0x4330eb['id'],'name':_0x4330eb['name'],'username':_0x4330eb[_0x55b0d3(0x93)]}};}async[a34_0x2b9551(0x87)](_0x149a85){const _0x482689=a34_0x2b9551;try{const _0x3e5e24=jsonwebtoken_1[_0x482689(0x8a)][_0x482689(0x9c)](_0x149a85,config_1[_0x482689(0xa2)]['jwt'][_0x482689(0x84)]);return _0x3e5e24;}catch(_0x4dedb7){throw new Error(_0x482689(0xa0));}}}function a34_0x1554(_0x3cf6c1,_0x904f87){const _0x122a5b=a34_0x122a();return a34_0x1554=function(_0x1554aa,_0x252036){_0x1554aa=_0x1554aa-0x84;let _0x406b59=_0x122a5b[_0x1554aa];return _0x406b59;},a34_0x1554(_0x3cf6c1,_0x904f87);}exports[a34_0x2b9551(0x8e)]=AuthService;