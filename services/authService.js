'use strict';const a34_0x5ca9d7=a34_0x54f2;(function(_0x155354,_0x1b9bcc){const _0x155237=a34_0x54f2,_0x490bee=_0x155354();while(!![]){try{const _0x5bd6b9=parseInt(_0x155237(0x1d1))/0x1*(-parseInt(_0x155237(0x1d7))/0x2)+parseInt(_0x155237(0x1be))/0x3+-parseInt(_0x155237(0x1b7))/0x4*(-parseInt(_0x155237(0x1d5))/0x5)+-parseInt(_0x155237(0x1c7))/0x6*(-parseInt(_0x155237(0x1cf))/0x7)+parseInt(_0x155237(0x1cb))/0x8*(-parseInt(_0x155237(0x1cd))/0x9)+parseInt(_0x155237(0x1ce))/0xa*(-parseInt(_0x155237(0x1c1))/0xb)+parseInt(_0x155237(0x1bd))/0xc;if(_0x5bd6b9===_0x1b9bcc)break;else _0x490bee['push'](_0x490bee['shift']());}catch(_0x31a3d8){_0x490bee['push'](_0x490bee['shift']());}}}(a34_0x4e52,0x95e41));function a34_0x54f2(_0x8da5c8,_0x14aa0a){const _0x4e527f=a34_0x4e52();return a34_0x54f2=function(_0x54f271,_0x3de384){_0x54f271=_0x54f271-0x1b5;let _0x2b2058=_0x4e527f[_0x54f271];return _0x2b2058;},a34_0x54f2(_0x8da5c8,_0x14aa0a);}var __importDefault=this&&this[a34_0x5ca9d7(0x1b6)]||function(_0x2faf92){const _0x1f8123=a34_0x5ca9d7;return _0x2faf92&&_0x2faf92[_0x1f8123(0x1bf)]?_0x2faf92:{'default':_0x2faf92};};function a34_0x4e52(){const _0x1b52e3=['Account\x20is\x20not\x20active','1012014ZAZnFT','6310790qpFUzz','1351sztkGM','../config/config','78uShOtQ','expiresIn','secret','jsonwebtoken','88225chrQXJ','ACTIVE','30248AnIfpP','login','password','__importDefault','116qEAeJq','username','admin','compare','defineProperty','verify','6948192kWCxzD','3665910lazSPR','__esModule','generateToken','11QusYxy','Invalid\x20credentials','AuthService','config','shop','bcryptjs','6978kiDHwu','default','../config/database','status','8uSdeSn'];a34_0x4e52=function(){return _0x1b52e3;};return a34_0x4e52();}Object[a34_0x5ca9d7(0x1bb)](exports,a34_0x5ca9d7(0x1bf),{'value':!![]}),exports[a34_0x5ca9d7(0x1c3)]=void 0x0;const bcryptjs_1=__importDefault(require(a34_0x5ca9d7(0x1c6))),jsonwebtoken_1=__importDefault(require(a34_0x5ca9d7(0x1d4))),database_1=__importDefault(require(a34_0x5ca9d7(0x1c9))),config_1=require(a34_0x5ca9d7(0x1d0));class AuthService{[a34_0x5ca9d7(0x1c0)](_0x62b866){const _0x4f235c=a34_0x5ca9d7;return jsonwebtoken_1[_0x4f235c(0x1c8)]['sign'](_0x62b866,config_1['config']['jwt'][_0x4f235c(0x1d3)],{'expiresIn':String(config_1[_0x4f235c(0x1c4)]['jwt'][_0x4f235c(0x1d2)])});}async[a34_0x5ca9d7(0x1d8)](_0x45fcf4){const _0x153301=a34_0x5ca9d7,{username:_0x493069,password:_0x43aa73}=_0x45fcf4;if(_0x493069===config_1[_0x153301(0x1c4)][_0x153301(0x1b9)][_0x153301(0x1b8)]){const _0x21bdcd=await bcryptjs_1[_0x153301(0x1c8)][_0x153301(0x1ba)](_0x43aa73,config_1['config'][_0x153301(0x1b9)]['passwordHash']);if(_0x21bdcd){const _0x3cbd13=this[_0x153301(0x1c0)]({'id':_0x153301(0x1b9),'username':config_1['config'][_0x153301(0x1b9)][_0x153301(0x1b8)],'role':_0x153301(0x1b9)});return{'access_token':_0x3cbd13,'role':_0x153301(0x1b9)};}}const _0x5ef3d7=await database_1[_0x153301(0x1c8)]['shop']['findUnique']({'where':{'username':_0x493069},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x5ef3d7)throw new Error(_0x153301(0x1c2));if(_0x5ef3d7[_0x153301(0x1ca)]!==_0x153301(0x1d6))throw new Error(_0x153301(0x1cc));const _0x6161a2=await bcryptjs_1[_0x153301(0x1c8)][_0x153301(0x1ba)](_0x43aa73,_0x5ef3d7[_0x153301(0x1b5)]);if(!_0x6161a2)throw new Error(_0x153301(0x1c2));const _0xd51ca4=this[_0x153301(0x1c0)]({'id':_0x5ef3d7['id'],'username':_0x5ef3d7[_0x153301(0x1b8)],'role':_0x153301(0x1c5)});return{'access_token':_0xd51ca4,'role':'shop','user':{'id':_0x5ef3d7['id'],'name':_0x5ef3d7['name'],'username':_0x5ef3d7['username']}};}async['verifyToken'](_0x207ce4){const _0x2917f3=a34_0x5ca9d7;try{const _0x46c0de=jsonwebtoken_1[_0x2917f3(0x1c8)][_0x2917f3(0x1bc)](_0x207ce4,config_1['config']['jwt'][_0x2917f3(0x1d3)]);return _0x46c0de;}catch(_0x4684f5){throw new Error('Invalid\x20token');}}}exports[a34_0x5ca9d7(0x1c3)]=AuthService;