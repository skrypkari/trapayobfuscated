'use strict';const a36_0x4db74b=a36_0x1f09;(function(_0x529ce3,_0x3d2c85){const _0x5d7f94=a36_0x1f09,_0x579be0=_0x529ce3();while(!![]){try{const _0x304552=-parseInt(_0x5d7f94(0xb2))/0x1+-parseInt(_0x5d7f94(0xa4))/0x2*(-parseInt(_0x5d7f94(0xa7))/0x3)+parseInt(_0x5d7f94(0xae))/0x4*(parseInt(_0x5d7f94(0xba))/0x5)+parseInt(_0x5d7f94(0xb6))/0x6+-parseInt(_0x5d7f94(0xab))/0x7*(parseInt(_0x5d7f94(0xb3))/0x8)+parseInt(_0x5d7f94(0xbe))/0x9*(-parseInt(_0x5d7f94(0xad))/0xa)+-parseInt(_0x5d7f94(0xb7))/0xb;if(_0x304552===_0x3d2c85)break;else _0x579be0['push'](_0x579be0['shift']());}catch(_0x37403d){_0x579be0['push'](_0x579be0['shift']());}}}(a36_0x28a8,0x5858e));var __importDefault=this&&this[a36_0x4db74b(0xaf)]||function(_0x142f99){const _0x371e4d=a36_0x4db74b;return _0x142f99&&_0x142f99[_0x371e4d(0xa5)]?_0x142f99:{'default':_0x142f99};};function a36_0x28a8(){const _0x245aa9=['admin','3955ViyQDs','secret','expiresIn','Invalid\x20credentials','745506WFgIyq','verify','login','username','defineProperty','password','ACTIVE','default','jwt','verifyToken','../config/database','18jfuYeT','__esModule','passwordHash','63156OjNIiy','jsonwebtoken','../config/config','generateToken','49sBrfFS','status','10phPaWR','444lJnUmQ','__importDefault','compare','Account\x20is\x20not\x20active','98950JzTWqY','125744PKHQpx','name','shop','3853872zgHmyn','2924911hsmNst','config'];a36_0x28a8=function(){return _0x245aa9;};return a36_0x28a8();}Object[a36_0x4db74b(0x9d)](exports,'__esModule',{'value':!![]}),exports['AuthService']=void 0x0;function a36_0x1f09(_0x4ec380,_0x5627ee){const _0x28a872=a36_0x28a8();return a36_0x1f09=function(_0x1f09f8,_0x18c955){_0x1f09f8=_0x1f09f8-0x9b;let _0x1fc704=_0x28a872[_0x1f09f8];return _0x1fc704;},a36_0x1f09(_0x4ec380,_0x5627ee);}const bcryptjs_1=__importDefault(require('bcryptjs')),jsonwebtoken_1=__importDefault(require(a36_0x4db74b(0xa8))),database_1=__importDefault(require(a36_0x4db74b(0xa3))),config_1=require(a36_0x4db74b(0xa9));class AuthService{['generateToken'](_0x493640){const _0x4c06f0=a36_0x4db74b;return jsonwebtoken_1[_0x4c06f0(0xa0)]['sign'](_0x493640,config_1[_0x4c06f0(0xb8)][_0x4c06f0(0xa1)][_0x4c06f0(0xbb)],{'expiresIn':String(config_1[_0x4c06f0(0xb8)][_0x4c06f0(0xa1)][_0x4c06f0(0xbc)])});}async[a36_0x4db74b(0x9b)](_0x5f19cf){const _0x2331ad=a36_0x4db74b,{username:_0x321fda,password:_0x292428}=_0x5f19cf;if(_0x321fda===config_1[_0x2331ad(0xb8)]['admin']['username']){const _0x5d4cab=await bcryptjs_1[_0x2331ad(0xa0)][_0x2331ad(0xb0)](_0x292428,config_1[_0x2331ad(0xb8)][_0x2331ad(0xb9)][_0x2331ad(0xa6)]);if(_0x5d4cab){const _0x5ca7d3=this['generateToken']({'id':_0x2331ad(0xb9),'username':config_1['config'][_0x2331ad(0xb9)][_0x2331ad(0x9c)],'role':'admin'});return{'access_token':_0x5ca7d3,'role':_0x2331ad(0xb9)};}}const _0x31da3a=await database_1[_0x2331ad(0xa0)][_0x2331ad(0xb5)]['findUnique']({'where':{'username':_0x321fda},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x31da3a)throw new Error(_0x2331ad(0xbd));if(_0x31da3a[_0x2331ad(0xac)]!==_0x2331ad(0x9f))throw new Error(_0x2331ad(0xb1));const _0x59d093=await bcryptjs_1['default']['compare'](_0x292428,_0x31da3a[_0x2331ad(0x9e)]);if(!_0x59d093)throw new Error(_0x2331ad(0xbd));const _0x4e2451=this[_0x2331ad(0xaa)]({'id':_0x31da3a['id'],'username':_0x31da3a[_0x2331ad(0x9c)],'role':_0x2331ad(0xb5)});return{'access_token':_0x4e2451,'role':_0x2331ad(0xb5),'user':{'id':_0x31da3a['id'],'name':_0x31da3a[_0x2331ad(0xb4)],'username':_0x31da3a[_0x2331ad(0x9c)]}};}async[a36_0x4db74b(0xa2)](_0x548966){const _0x5a7188=a36_0x4db74b;try{const _0x44d4ec=jsonwebtoken_1[_0x5a7188(0xa0)][_0x5a7188(0xbf)](_0x548966,config_1[_0x5a7188(0xb8)][_0x5a7188(0xa1)]['secret']);return _0x44d4ec;}catch(_0x342fe2){throw new Error('Invalid\x20token');}}}exports['AuthService']=AuthService;