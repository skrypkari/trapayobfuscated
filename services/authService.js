'use strict';const a36_0x31fb34=a36_0x51a9;function a36_0x51a9(_0x1c0807,_0x208205){const _0x71c831=a36_0x71c8();return a36_0x51a9=function(_0x51a95e,_0x379835){_0x51a95e=_0x51a95e-0x1d5;let _0x5ab844=_0x71c831[_0x51a95e];return _0x5ab844;},a36_0x51a9(_0x1c0807,_0x208205);}(function(_0x1fcec0,_0x155396){const _0x221e04=a36_0x51a9,_0x3c11af=_0x1fcec0();while(!![]){try{const _0x1d9a07=-parseInt(_0x221e04(0x1f4))/0x1+parseInt(_0x221e04(0x1f0))/0x2+parseInt(_0x221e04(0x1da))/0x3+parseInt(_0x221e04(0x1e8))/0x4*(-parseInt(_0x221e04(0x1ee))/0x5)+parseInt(_0x221e04(0x1e0))/0x6*(parseInt(_0x221e04(0x1ea))/0x7)+-parseInt(_0x221e04(0x1df))/0x8+-parseInt(_0x221e04(0x1eb))/0x9*(parseInt(_0x221e04(0x1e3))/0xa);if(_0x1d9a07===_0x155396)break;else _0x3c11af['push'](_0x3c11af['shift']());}catch(_0x4efd0b){_0x3c11af['push'](_0x3c11af['shift']());}}}(a36_0x71c8,0x837d7));function a36_0x71c8(){const _0x3635a6=['username','secret','jwt','Invalid\x20token','default','AuthService','__esModule','1284612cGNJRg','__importDefault','defineProperty','name','../config/database','6879000fVqepD','72LJYeXQ','config','findUnique','704950iXfpTd','shop','admin','status','jsonwebtoken','292676wOzdhF','verify','447573eywAuo','27ExzsRp','compare','login','10cIihGF','ACTIVE','1712648Nnnbup','Account\x20is\x20not\x20active','generateToken','../config/config','295515NYhLPJ','Invalid\x20credentials','password'];a36_0x71c8=function(){return _0x3635a6;};return a36_0x71c8();}var __importDefault=this&&this[a36_0x31fb34(0x1db)]||function(_0x29bf19){const _0x166170=a36_0x31fb34;return _0x29bf19&&_0x29bf19[_0x166170(0x1d9)]?_0x29bf19:{'default':_0x29bf19};};Object[a36_0x31fb34(0x1dc)](exports,a36_0x31fb34(0x1d9),{'value':!![]}),exports[a36_0x31fb34(0x1d8)]=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),jsonwebtoken_1=__importDefault(require(a36_0x31fb34(0x1e7))),database_1=__importDefault(require(a36_0x31fb34(0x1de))),config_1=require(a36_0x31fb34(0x1f3));class AuthService{['generateToken'](_0x41fc74){const _0xadb120=a36_0x31fb34;return jsonwebtoken_1['default']['sign'](_0x41fc74,config_1['config'][_0xadb120(0x1d5)][_0xadb120(0x1f8)],{'expiresIn':String(config_1[_0xadb120(0x1e1)][_0xadb120(0x1d5)]['expiresIn'])});}async[a36_0x31fb34(0x1ed)](_0x108235){const _0x4637cd=a36_0x31fb34,{username:_0x20a629,password:_0x2098a3}=_0x108235;if(_0x20a629===config_1['config']['admin'][_0x4637cd(0x1f7)]){const _0x459c2b=await bcryptjs_1[_0x4637cd(0x1d7)]['compare'](_0x2098a3,config_1['config'][_0x4637cd(0x1e5)]['passwordHash']);if(_0x459c2b){const _0x11af8e=this[_0x4637cd(0x1f2)]({'id':'admin','username':config_1[_0x4637cd(0x1e1)][_0x4637cd(0x1e5)]['username'],'role':_0x4637cd(0x1e5)});return{'access_token':_0x11af8e,'role':'admin'};}}const _0x4dd845=await database_1[_0x4637cd(0x1d7)][_0x4637cd(0x1e4)][_0x4637cd(0x1e2)]({'where':{'username':_0x20a629},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x4dd845)throw new Error('Invalid\x20credentials');if(_0x4dd845[_0x4637cd(0x1e6)]!==_0x4637cd(0x1ef))throw new Error(_0x4637cd(0x1f1));const _0x3116a7=await bcryptjs_1[_0x4637cd(0x1d7)][_0x4637cd(0x1ec)](_0x2098a3,_0x4dd845[_0x4637cd(0x1f6)]);if(!_0x3116a7)throw new Error(_0x4637cd(0x1f5));const _0x1f909b=this['generateToken']({'id':_0x4dd845['id'],'username':_0x4dd845[_0x4637cd(0x1f7)],'role':_0x4637cd(0x1e4)});return{'access_token':_0x1f909b,'role':'shop','user':{'id':_0x4dd845['id'],'name':_0x4dd845[_0x4637cd(0x1dd)],'username':_0x4dd845[_0x4637cd(0x1f7)]}};}async['verifyToken'](_0x3e7cb2){const _0xb15fac=a36_0x31fb34;try{const _0x47fc5c=jsonwebtoken_1['default'][_0xb15fac(0x1e9)](_0x3e7cb2,config_1[_0xb15fac(0x1e1)][_0xb15fac(0x1d5)][_0xb15fac(0x1f8)]);return _0x47fc5c;}catch(_0x1cb50e){throw new Error(_0xb15fac(0x1d6));}}}exports[a36_0x31fb34(0x1d8)]=AuthService;