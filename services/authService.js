'use strict';function a34_0x4f08(){const _0x54dfc4=['verifyToken','verify','__importDefault','expiresIn','AuthService','default','15QsRkKK','jwt','9HZRwWH','generateToken','sign','15YcQwnv','../config/database','Account\x20is\x20not\x20active','99451nGxaMa','Invalid\x20token','2831286PdnGjA','admin','passwordHash','../config/config','2RUsoip','bcryptjs','config','jsonwebtoken','36118VvqYLM','983432GxRWWN','compare','login','password','Invalid\x20credentials','shop','defineProperty','status','username','__esModule','5638128Gfwqks','53800812GrEOmC','name','460qgxveF','secret','10758188IaOVXH'];a34_0x4f08=function(){return _0x54dfc4;};return a34_0x4f08();}const a34_0x2fc9a9=a34_0x40ce;(function(_0x1c9435,_0x241aef){const _0x4a9128=a34_0x40ce,_0x4463ca=_0x1c9435();while(!![]){try{const _0x21dc34=-parseInt(_0x4a9128(0x121))/0x1*(parseInt(_0x4a9128(0x11d))/0x2)+parseInt(_0x4a9128(0x138))/0x3*(parseInt(_0x4a9128(0x122))/0x4)+parseInt(_0x4a9128(0x13d))/0x5*(parseInt(_0x4a9128(0x119))/0x6)+parseInt(_0x4a9128(0x131))/0x7+-parseInt(_0x4a9128(0x12c))/0x8*(-parseInt(_0x4a9128(0x13a))/0x9)+-parseInt(_0x4a9128(0x12f))/0xa*(-parseInt(_0x4a9128(0x117))/0xb)+-parseInt(_0x4a9128(0x12d))/0xc;if(_0x21dc34===_0x241aef)break;else _0x4463ca['push'](_0x4463ca['shift']());}catch(_0x20dc64){_0x4463ca['push'](_0x4463ca['shift']());}}}(a34_0x4f08,0xbf266));function a34_0x40ce(_0xb491f,_0x511ce5){const _0x4f083c=a34_0x4f08();return a34_0x40ce=function(_0x40ce18,_0x56bd20){_0x40ce18=_0x40ce18-0x116;let _0x3263b1=_0x4f083c[_0x40ce18];return _0x3263b1;},a34_0x40ce(_0xb491f,_0x511ce5);}var __importDefault=this&&this[a34_0x2fc9a9(0x134)]||function(_0x2d9eff){return _0x2d9eff&&_0x2d9eff['__esModule']?_0x2d9eff:{'default':_0x2d9eff};};Object[a34_0x2fc9a9(0x128)](exports,a34_0x2fc9a9(0x12b),{'value':!![]}),exports[a34_0x2fc9a9(0x136)]=void 0x0;const bcryptjs_1=__importDefault(require(a34_0x2fc9a9(0x11e))),jsonwebtoken_1=__importDefault(require(a34_0x2fc9a9(0x120))),database_1=__importDefault(require(a34_0x2fc9a9(0x13e))),config_1=require(a34_0x2fc9a9(0x11c));class AuthService{['generateToken'](_0x9ed65f){const _0x3c8142=a34_0x2fc9a9;return jsonwebtoken_1[_0x3c8142(0x137)][_0x3c8142(0x13c)](_0x9ed65f,config_1[_0x3c8142(0x11f)]['jwt']['secret'],{'expiresIn':String(config_1[_0x3c8142(0x11f)][_0x3c8142(0x139)][_0x3c8142(0x135)])});}async[a34_0x2fc9a9(0x124)](_0x5ed247){const _0x247e3b=a34_0x2fc9a9,{username:_0x4d6964,password:_0x39c4de}=_0x5ed247;if(_0x4d6964===config_1[_0x247e3b(0x11f)][_0x247e3b(0x11a)][_0x247e3b(0x12a)]){const _0xebb972=await bcryptjs_1[_0x247e3b(0x137)][_0x247e3b(0x123)](_0x39c4de,config_1[_0x247e3b(0x11f)][_0x247e3b(0x11a)][_0x247e3b(0x11b)]);if(_0xebb972){const _0xdba259=this[_0x247e3b(0x13b)]({'id':_0x247e3b(0x11a),'username':config_1[_0x247e3b(0x11f)][_0x247e3b(0x11a)][_0x247e3b(0x12a)],'role':'admin'});return{'access_token':_0xdba259,'role':'admin'};}}const _0x339586=await database_1[_0x247e3b(0x137)][_0x247e3b(0x127)]['findUnique']({'where':{'username':_0x4d6964},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x339586)throw new Error(_0x247e3b(0x126));if(_0x339586[_0x247e3b(0x129)]!=='ACTIVE')throw new Error(_0x247e3b(0x116));const _0x480404=await bcryptjs_1[_0x247e3b(0x137)][_0x247e3b(0x123)](_0x39c4de,_0x339586[_0x247e3b(0x125)]);if(!_0x480404)throw new Error('Invalid\x20credentials');const _0x1cc1c6=this[_0x247e3b(0x13b)]({'id':_0x339586['id'],'username':_0x339586[_0x247e3b(0x12a)],'role':_0x247e3b(0x127)});return{'access_token':_0x1cc1c6,'role':_0x247e3b(0x127),'user':{'id':_0x339586['id'],'name':_0x339586[_0x247e3b(0x12e)],'username':_0x339586['username']}};}async[a34_0x2fc9a9(0x132)](_0x34faee){const _0x415ada=a34_0x2fc9a9;try{const _0x431ebf=jsonwebtoken_1[_0x415ada(0x137)][_0x415ada(0x133)](_0x34faee,config_1['config'][_0x415ada(0x139)][_0x415ada(0x130)]);return _0x431ebf;}catch(_0x49c5f6){throw new Error(_0x415ada(0x118));}}}exports[a34_0x2fc9a9(0x136)]=AuthService;