'use strict';const a36_0x2f82fa=a36_0xfdd2;(function(_0x46a135,_0x2331b9){const _0x1cbf1e=a36_0xfdd2,_0x5c8675=_0x46a135();while(!![]){try{const _0x1ce8ff=parseInt(_0x1cbf1e(0x188))/0x1+-parseInt(_0x1cbf1e(0x19b))/0x2+parseInt(_0x1cbf1e(0x199))/0x3*(-parseInt(_0x1cbf1e(0x17f))/0x4)+parseInt(_0x1cbf1e(0x18d))/0x5*(-parseInt(_0x1cbf1e(0x191))/0x6)+-parseInt(_0x1cbf1e(0x185))/0x7*(parseInt(_0x1cbf1e(0x19f))/0x8)+-parseInt(_0x1cbf1e(0x196))/0x9+parseInt(_0x1cbf1e(0x198))/0xa*(parseInt(_0x1cbf1e(0x190))/0xb);if(_0x1ce8ff===_0x2331b9)break;else _0x5c8675['push'](_0x5c8675['shift']());}catch(_0x15e7b7){_0x5c8675['push'](_0x5c8675['shift']());}}}(a36_0x4dfa,0xbf19b));function a36_0xfdd2(_0x19ad2a,_0x7210d8){const _0x4dfa2a=a36_0x4dfa();return a36_0xfdd2=function(_0xfdd287,_0x5c8d62){_0xfdd287=_0xfdd287-0x17b;let _0x184a96=_0x4dfa2a[_0xfdd287];return _0x184a96;},a36_0xfdd2(_0x19ad2a,_0x7210d8);}var __importDefault=this&&this[a36_0x2f82fa(0x184)]||function(_0x4b5386){const _0x5ff749=a36_0x2f82fa;return _0x4b5386&&_0x4b5386[_0x5ff749(0x17e)]?_0x4b5386:{'default':_0x4b5386};};Object[a36_0x2f82fa(0x197)](exports,'__esModule',{'value':!![]}),exports[a36_0x2f82fa(0x17b)]=void 0x0;const bcryptjs_1=__importDefault(require(a36_0x2f82fa(0x180))),jsonwebtoken_1=__importDefault(require(a36_0x2f82fa(0x19a))),database_1=__importDefault(require(a36_0x2f82fa(0x1a1))),config_1=require(a36_0x2f82fa(0x1a0));class AuthService{['generateToken'](_0x140597){const _0x3e5e05=a36_0x2f82fa;return jsonwebtoken_1[_0x3e5e05(0x18a)]['sign'](_0x140597,config_1['config']['jwt'][_0x3e5e05(0x18e)],{'expiresIn':String(config_1['config'][_0x3e5e05(0x183)][_0x3e5e05(0x195)])});}async[a36_0x2f82fa(0x17c)](_0x2871de){const _0xe07aa9=a36_0x2f82fa,{username:_0x149cfd,password:_0x4cc2bb}=_0x2871de;if(_0x149cfd===config_1['config']['admin'][_0xe07aa9(0x17d)]){const _0x468ac2=await bcryptjs_1[_0xe07aa9(0x18a)][_0xe07aa9(0x18b)](_0x4cc2bb,config_1[_0xe07aa9(0x18f)]['admin']['passwordHash']);if(_0x468ac2){const _0x2f3e1c=this['generateToken']({'id':_0xe07aa9(0x182),'username':config_1[_0xe07aa9(0x18f)][_0xe07aa9(0x182)][_0xe07aa9(0x17d)],'role':_0xe07aa9(0x182)});return{'access_token':_0x2f3e1c,'role':_0xe07aa9(0x182)};}}const _0x42cd41=await database_1[_0xe07aa9(0x18a)]['shop'][_0xe07aa9(0x193)]({'where':{'username':_0x149cfd},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x42cd41)throw new Error(_0xe07aa9(0x18c));if(_0x42cd41[_0xe07aa9(0x19d)]===_0xe07aa9(0x186))throw new Error(_0xe07aa9(0x1a2));const _0x4949c2=await bcryptjs_1['default'][_0xe07aa9(0x18b)](_0x4cc2bb,_0x42cd41[_0xe07aa9(0x192)]);if(!_0x4949c2)throw new Error(_0xe07aa9(0x18c));const _0x3d9011=this[_0xe07aa9(0x187)]({'id':_0x42cd41['id'],'username':_0x42cd41[_0xe07aa9(0x17d)],'role':_0xe07aa9(0x19e)});return{'access_token':_0x3d9011,'role':_0xe07aa9(0x19e),'user':{'id':_0x42cd41['id'],'name':_0x42cd41[_0xe07aa9(0x189)],'username':_0x42cd41[_0xe07aa9(0x17d)],'status':_0x42cd41['status']},'suspended':_0x42cd41['status']===_0xe07aa9(0x181)};}async[a36_0x2f82fa(0x19c)](_0x25f4d4){const _0x2d0f97=a36_0x2f82fa;try{const _0x280da3=jsonwebtoken_1[_0x2d0f97(0x18a)]['verify'](_0x25f4d4,config_1[_0x2d0f97(0x18f)][_0x2d0f97(0x183)][_0x2d0f97(0x18e)]);return _0x280da3;}catch(_0x300de6){throw new Error(_0x2d0f97(0x194));}}}exports[a36_0x2f82fa(0x17b)]=AuthService;function a36_0x4dfa(){const _0x194775=['jwt','__importDefault','1622495pnHRjR','INACTIVE','generateToken','1549626NnPZve','name','default','compare','Invalid\x20credentials','308015pHqfbT','secret','config','1722721pLxzws','6TjxvxT','password','findUnique','Invalid\x20token','expiresIn','6646554EdxBgT','defineProperty','100IxMlSC','291mYXiOy','jsonwebtoken','214632RZiYSo','verifyToken','status','shop','8KWLwZb','../config/config','../config/database','Account\x20is\x20not\x20active','AuthService','login','username','__esModule','49228xIWvWi','bcryptjs','SUSPENDED','admin'];a36_0x4dfa=function(){return _0x194775;};return a36_0x4dfa();}