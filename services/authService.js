'use strict';const a34_0x4f6123=a34_0x1fc8;(function(_0x39e7b3,_0x398b63){const _0x498c0a=a34_0x1fc8,_0x31bdd4=_0x39e7b3();while(!![]){try{const _0x26b3db=-parseInt(_0x498c0a(0x1ee))/0x1*(parseInt(_0x498c0a(0x1f9))/0x2)+parseInt(_0x498c0a(0x1f6))/0x3+-parseInt(_0x498c0a(0x20b))/0x4*(parseInt(_0x498c0a(0x201))/0x5)+parseInt(_0x498c0a(0x1ef))/0x6*(parseInt(_0x498c0a(0x203))/0x7)+-parseInt(_0x498c0a(0x1ff))/0x8*(-parseInt(_0x498c0a(0x20d))/0x9)+-parseInt(_0x498c0a(0x207))/0xa+-parseInt(_0x498c0a(0x211))/0xb*(-parseInt(_0x498c0a(0x210))/0xc);if(_0x26b3db===_0x398b63)break;else _0x31bdd4['push'](_0x31bdd4['shift']());}catch(_0x5f5cf0){_0x31bdd4['push'](_0x31bdd4['shift']());}}}(a34_0x26d1,0x60322));var __importDefault=this&&this[a34_0x4f6123(0x204)]||function(_0x585c51){const _0x282092=a34_0x4f6123;return _0x585c51&&_0x585c51[_0x282092(0x216)]?_0x585c51:{'default':_0x585c51};};Object[a34_0x4f6123(0x1f7)](exports,a34_0x4f6123(0x216),{'value':!![]}),exports[a34_0x4f6123(0x202)]=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),jsonwebtoken_1=__importDefault(require(a34_0x4f6123(0x1f1))),database_1=__importDefault(require(a34_0x4f6123(0x1f8))),config_1=require(a34_0x4f6123(0x1f5));class AuthService{[a34_0x4f6123(0x1f3)](_0x4b01b8){const _0x10459a=a34_0x4f6123;return jsonwebtoken_1[_0x10459a(0x1f0)][_0x10459a(0x1fc)](_0x4b01b8,config_1[_0x10459a(0x213)][_0x10459a(0x205)][_0x10459a(0x215)],{'expiresIn':String(config_1[_0x10459a(0x213)][_0x10459a(0x205)][_0x10459a(0x214)])});}async[a34_0x4f6123(0x20c)](_0x11eadd){const _0x37722f=a34_0x4f6123,{username:_0x18ee51,password:_0x4c6074}=_0x11eadd;if(_0x18ee51===config_1['config']['admin'][_0x37722f(0x212)]){const _0x2008e7=await bcryptjs_1['default'][_0x37722f(0x20a)](_0x4c6074,config_1[_0x37722f(0x213)][_0x37722f(0x20f)][_0x37722f(0x1fd)]);if(_0x2008e7){const _0x503b05=this[_0x37722f(0x1f3)]({'id':_0x37722f(0x20f),'username':config_1[_0x37722f(0x213)]['admin']['username'],'role':_0x37722f(0x20f)});return{'access_token':_0x503b05,'role':_0x37722f(0x20f)};}}const _0x367aeb=await database_1[_0x37722f(0x1f0)]['shop'][_0x37722f(0x200)]({'where':{'username':_0x18ee51},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x367aeb)throw new Error(_0x37722f(0x209));if(_0x367aeb[_0x37722f(0x1fb)]!==_0x37722f(0x1f4))throw new Error(_0x37722f(0x208));const _0x1e7fb7=await bcryptjs_1[_0x37722f(0x1f0)]['compare'](_0x4c6074,_0x367aeb['password']);if(!_0x1e7fb7)throw new Error(_0x37722f(0x209));const _0x38c144=this[_0x37722f(0x1f3)]({'id':_0x367aeb['id'],'username':_0x367aeb['username'],'role':_0x37722f(0x1fa)});return{'access_token':_0x38c144,'role':_0x37722f(0x1fa),'user':{'id':_0x367aeb['id'],'name':_0x367aeb[_0x37722f(0x206)],'username':_0x367aeb[_0x37722f(0x212)]}};}async[a34_0x4f6123(0x1f2)](_0x3e11f1){const _0x9e3cee=a34_0x4f6123;try{const _0x5976c1=jsonwebtoken_1[_0x9e3cee(0x1f0)][_0x9e3cee(0x1fe)](_0x3e11f1,config_1[_0x9e3cee(0x213)][_0x9e3cee(0x205)][_0x9e3cee(0x215)]);return _0x5976c1;}catch(_0x489567){throw new Error(_0x9e3cee(0x20e));}}}exports['AuthService']=AuthService;function a34_0x1fc8(_0x580121,_0x1ddf7f){const _0x26d191=a34_0x26d1();return a34_0x1fc8=function(_0x1fc8d1,_0x48875f){_0x1fc8d1=_0x1fc8d1-0x1ee;let _0x5ec740=_0x26d191[_0x1fc8d1];return _0x5ec740;},a34_0x1fc8(_0x580121,_0x1ddf7f);}function a34_0x26d1(){const _0x1edbec=['Invalid\x20token','admin','36eCeubX','1669943geAcHF','username','config','expiresIn','secret','__esModule','98ZDVncx','4400562clQqMs','default','jsonwebtoken','verifyToken','generateToken','ACTIVE','../config/config','1709739RsElae','defineProperty','../config/database','10872zCRTBj','shop','status','sign','passwordHash','verify','738152sMfiMc','findUnique','30FGLYuY','AuthService','7kHQiQW','__importDefault','jwt','name','5873480iOGjTn','Account\x20is\x20not\x20active','Invalid\x20credentials','compare','224636juUrdj','login','9AmHrOI'];a34_0x26d1=function(){return _0x1edbec;};return a34_0x26d1();}