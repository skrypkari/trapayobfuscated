'use strict';const a36_0x2a54a9=a36_0x2252;(function(_0x4a360c,_0x398ac3){const _0x16fefb=a36_0x2252,_0x23328b=_0x4a360c();while(!![]){try{const _0x1f33db=parseInt(_0x16fefb(0xec))/0x1*(parseInt(_0x16fefb(0xe1))/0x2)+-parseInt(_0x16fefb(0xe5))/0x3+parseInt(_0x16fefb(0xf5))/0x4+-parseInt(_0x16fefb(0xfd))/0x5+parseInt(_0x16fefb(0xdd))/0x6*(parseInt(_0x16fefb(0xff))/0x7)+-parseInt(_0x16fefb(0xeb))/0x8+parseInt(_0x16fefb(0xdf))/0x9;if(_0x1f33db===_0x398ac3)break;else _0x23328b['push'](_0x23328b['shift']());}catch(_0x2bf88b){_0x23328b['push'](_0x23328b['shift']());}}}(a36_0x2a77,0xa6945));var __importDefault=this&&this['__importDefault']||function(_0x112cbc){const _0x437937=a36_0x2252;return _0x112cbc&&_0x112cbc[_0x437937(0xe4)]?_0x112cbc:{'default':_0x112cbc};};function a36_0x2a77(){const _0x5c1b60=['findUnique','Account\x20is\x20not\x20active','config','verifyToken','secret','generateToken','4326160MCULXs','expiresIn','346759kMbVmy','bcryptjs','60SvLioV','Invalid\x20token','9184419BVYxbO','shop','2ijKeKq','jsonwebtoken','ACTIVE','__esModule','1152453QGQUQF','jwt','sign','defineProperty','status','AuthService','10686624tXyUAO','691271mzOTWQ','default','compare','login','name','admin','verify','../config/config','username','4241552JwUbZK','Invalid\x20credentials'];a36_0x2a77=function(){return _0x5c1b60;};return a36_0x2a77();}function a36_0x2252(_0x5d399f,_0x23162b){const _0x2a7776=a36_0x2a77();return a36_0x2252=function(_0x225291,_0x195721){_0x225291=_0x225291-0xdd;let _0x3e8cb9=_0x2a7776[_0x225291];return _0x3e8cb9;},a36_0x2252(_0x5d399f,_0x23162b);}Object[a36_0x2a54a9(0xe8)](exports,a36_0x2a54a9(0xe4),{'value':!![]}),exports[a36_0x2a54a9(0xea)]=void 0x0;const bcryptjs_1=__importDefault(require(a36_0x2a54a9(0x100))),jsonwebtoken_1=__importDefault(require(a36_0x2a54a9(0xe2))),database_1=__importDefault(require('../config/database')),config_1=require(a36_0x2a54a9(0xf3));class AuthService{[a36_0x2a54a9(0xfc)](_0x48af0a){const _0x481870=a36_0x2a54a9;return jsonwebtoken_1[_0x481870(0xed)][_0x481870(0xe7)](_0x48af0a,config_1[_0x481870(0xf9)][_0x481870(0xe6)][_0x481870(0xfb)],{'expiresIn':String(config_1['config'][_0x481870(0xe6)][_0x481870(0xfe)])});}async[a36_0x2a54a9(0xef)](_0x29ce5d){const _0x34ccf0=a36_0x2a54a9,{username:_0x3fea23,password:_0x46cbf8}=_0x29ce5d;if(_0x3fea23===config_1[_0x34ccf0(0xf9)]['admin'][_0x34ccf0(0xf4)]){const _0x2d9f1d=await bcryptjs_1['default'][_0x34ccf0(0xee)](_0x46cbf8,config_1[_0x34ccf0(0xf9)]['admin']['passwordHash']);if(_0x2d9f1d){const _0x146d7d=this[_0x34ccf0(0xfc)]({'id':_0x34ccf0(0xf1),'username':config_1['config'][_0x34ccf0(0xf1)][_0x34ccf0(0xf4)],'role':_0x34ccf0(0xf1)});return{'access_token':_0x146d7d,'role':_0x34ccf0(0xf1)};}}const _0x33f5c8=await database_1[_0x34ccf0(0xed)][_0x34ccf0(0xe0)][_0x34ccf0(0xf7)]({'where':{'username':_0x3fea23},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x33f5c8)throw new Error(_0x34ccf0(0xf6));if(_0x33f5c8[_0x34ccf0(0xe9)]!==_0x34ccf0(0xe3))throw new Error(_0x34ccf0(0xf8));const _0x31b320=await bcryptjs_1[_0x34ccf0(0xed)][_0x34ccf0(0xee)](_0x46cbf8,_0x33f5c8['password']);if(!_0x31b320)throw new Error(_0x34ccf0(0xf6));const _0x1c9197=this[_0x34ccf0(0xfc)]({'id':_0x33f5c8['id'],'username':_0x33f5c8[_0x34ccf0(0xf4)],'role':_0x34ccf0(0xe0)});return{'access_token':_0x1c9197,'role':'shop','user':{'id':_0x33f5c8['id'],'name':_0x33f5c8[_0x34ccf0(0xf0)],'username':_0x33f5c8[_0x34ccf0(0xf4)]}};}async[a36_0x2a54a9(0xfa)](_0x3c73e7){const _0x8c9b42=a36_0x2a54a9;try{const _0x32cb84=jsonwebtoken_1[_0x8c9b42(0xed)][_0x8c9b42(0xf2)](_0x3c73e7,config_1[_0x8c9b42(0xf9)][_0x8c9b42(0xe6)]['secret']);return _0x32cb84;}catch(_0x25b8cc){throw new Error(_0x8c9b42(0xde));}}}exports[a36_0x2a54a9(0xea)]=AuthService;