'use strict';const a36_0x5ac58a=a36_0x3082;(function(_0x94aae8,_0x5831ea){const _0x443131=a36_0x3082,_0x296f42=_0x94aae8();while(!![]){try{const _0x28f521=parseInt(_0x443131(0x134))/0x1+parseInt(_0x443131(0x12a))/0x2*(-parseInt(_0x443131(0x137))/0x3)+-parseInt(_0x443131(0x135))/0x4*(parseInt(_0x443131(0x128))/0x5)+-parseInt(_0x443131(0x149))/0x6*(parseInt(_0x443131(0x143))/0x7)+-parseInt(_0x443131(0x147))/0x8+-parseInt(_0x443131(0x141))/0x9*(parseInt(_0x443131(0x14b))/0xa)+parseInt(_0x443131(0x145))/0xb*(parseInt(_0x443131(0x146))/0xc);if(_0x28f521===_0x5831ea)break;else _0x296f42['push'](_0x296f42['shift']());}catch(_0x44c02f){_0x296f42['push'](_0x296f42['shift']());}}}(a36_0x3046,0x79404));var __importDefault=this&&this[a36_0x5ac58a(0x127)]||function(_0x2f7d3a){return _0x2f7d3a&&_0x2f7d3a['__esModule']?_0x2f7d3a:{'default':_0x2f7d3a};};Object['defineProperty'](exports,a36_0x5ac58a(0x142),{'value':!![]}),exports[a36_0x5ac58a(0x139)]=void 0x0;const bcryptjs_1=__importDefault(require(a36_0x5ac58a(0x136))),jsonwebtoken_1=__importDefault(require(a36_0x5ac58a(0x140))),database_1=__importDefault(require(a36_0x5ac58a(0x148))),config_1=require('../config/config');function a36_0x3046(){const _0x31f6e5=['shop','name','expiresIn','sign','username','Invalid\x20credentials','default','verify','jwt','1526pAWbUd','52bIYaBf','bcryptjs','9yuLwgE','status','AuthService','config','passwordHash','secret','findUnique','admin','Account\x20is\x20not\x20active','jsonwebtoken','9171jPxvGy','__esModule','7bZgffx','generateToken','200497bRXSVx','1788ZRolSv','1553712VUAkZr','../config/database','1238598aNxotO','Invalid\x20token','9310woqbyi','__importDefault','8090sMuJrS','compare','566890JvvsKE'];a36_0x3046=function(){return _0x31f6e5;};return a36_0x3046();}function a36_0x3082(_0x55d8aa,_0x9c353f){const _0x3046e9=a36_0x3046();return a36_0x3082=function(_0x3082c2,_0x2990f3){_0x3082c2=_0x3082c2-0x127;let _0x4a33d4=_0x3046e9[_0x3082c2];return _0x4a33d4;},a36_0x3082(_0x55d8aa,_0x9c353f);}class AuthService{[a36_0x5ac58a(0x144)](_0xad02f7){const _0x5dd523=a36_0x5ac58a;return jsonwebtoken_1[_0x5dd523(0x131)][_0x5dd523(0x12e)](_0xad02f7,config_1[_0x5dd523(0x13a)][_0x5dd523(0x133)][_0x5dd523(0x13c)],{'expiresIn':String(config_1[_0x5dd523(0x13a)]['jwt'][_0x5dd523(0x12d)])});}async['login'](_0x492181){const _0x57f280=a36_0x5ac58a,{username:_0xeed172,password:_0x52795c}=_0x492181;if(_0xeed172===config_1[_0x57f280(0x13a)]['admin']['username']){const _0x2faede=await bcryptjs_1['default']['compare'](_0x52795c,config_1[_0x57f280(0x13a)][_0x57f280(0x13e)][_0x57f280(0x13b)]);if(_0x2faede){const _0x447733=this[_0x57f280(0x144)]({'id':_0x57f280(0x13e),'username':config_1[_0x57f280(0x13a)][_0x57f280(0x13e)][_0x57f280(0x12f)],'role':_0x57f280(0x13e)});return{'access_token':_0x447733,'role':_0x57f280(0x13e)};}}const _0x2d07a3=await database_1[_0x57f280(0x131)][_0x57f280(0x12b)][_0x57f280(0x13d)]({'where':{'username':_0xeed172},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x2d07a3)throw new Error(_0x57f280(0x130));if(_0x2d07a3[_0x57f280(0x138)]!=='ACTIVE')throw new Error(_0x57f280(0x13f));const _0x48552e=await bcryptjs_1[_0x57f280(0x131)][_0x57f280(0x129)](_0x52795c,_0x2d07a3['password']);if(!_0x48552e)throw new Error(_0x57f280(0x130));const _0x4a56ec=this[_0x57f280(0x144)]({'id':_0x2d07a3['id'],'username':_0x2d07a3[_0x57f280(0x12f)],'role':'shop'});return{'access_token':_0x4a56ec,'role':_0x57f280(0x12b),'user':{'id':_0x2d07a3['id'],'name':_0x2d07a3[_0x57f280(0x12c)],'username':_0x2d07a3['username']}};}async['verifyToken'](_0x120c95){const _0x41ae45=a36_0x5ac58a;try{const _0x4abdea=jsonwebtoken_1[_0x41ae45(0x131)][_0x41ae45(0x132)](_0x120c95,config_1['config'][_0x41ae45(0x133)][_0x41ae45(0x13c)]);return _0x4abdea;}catch(_0x201839){throw new Error(_0x41ae45(0x14a));}}}exports[a36_0x5ac58a(0x139)]=AuthService;