'use strict';const a36_0x5863e1=a36_0x1b52;(function(_0x36978e,_0x175534){const _0x33eaa8=a36_0x1b52,_0x50a591=_0x36978e();while(!![]){try{const _0x41af17=-parseInt(_0x33eaa8(0xcf))/0x1*(-parseInt(_0x33eaa8(0xd4))/0x2)+-parseInt(_0x33eaa8(0xbb))/0x3+-parseInt(_0x33eaa8(0xc3))/0x4*(-parseInt(_0x33eaa8(0xcb))/0x5)+-parseInt(_0x33eaa8(0xca))/0x6+-parseInt(_0x33eaa8(0xb2))/0x7*(parseInt(_0x33eaa8(0xc9))/0x8)+-parseInt(_0x33eaa8(0xc0))/0x9+parseInt(_0x33eaa8(0xc1))/0xa;if(_0x41af17===_0x175534)break;else _0x50a591['push'](_0x50a591['shift']());}catch(_0x923272){_0x50a591['push'](_0x50a591['shift']());}}}(a36_0x2271,0x4bf85));var __importDefault=this&&this[a36_0x5863e1(0xd5)]||function(_0x1c23b2){const _0x35c2b6=a36_0x5863e1;return _0x1c23b2&&_0x1c23b2[_0x35c2b6(0xd3)]?_0x1c23b2:{'default':_0x1c23b2};};Object[a36_0x5863e1(0xd6)](exports,'__esModule',{'value':!![]}),exports[a36_0x5863e1(0xc4)]=void 0x0;const bcryptjs_1=__importDefault(require(a36_0x5863e1(0xc7))),jsonwebtoken_1=__importDefault(require(a36_0x5863e1(0xd0))),database_1=__importDefault(require(a36_0x5863e1(0xb3))),config_1=require('../config/config');class AuthService{[a36_0x5863e1(0xc2)](_0x551c31){const _0x11dcb4=a36_0x5863e1;return jsonwebtoken_1['default'][_0x11dcb4(0xc5)](_0x551c31,config_1[_0x11dcb4(0xb6)][_0x11dcb4(0xb5)]['secret'],{'expiresIn':String(config_1['config'][_0x11dcb4(0xb5)][_0x11dcb4(0xb8)])});}async[a36_0x5863e1(0xd2)](_0x58ce8c){const _0x45ed8b=a36_0x5863e1,{username:_0x58ea8f,password:_0x3014e3}=_0x58ce8c;if(_0x58ea8f===config_1['config'][_0x45ed8b(0xc6)]['username']){const _0x10c0df=await bcryptjs_1[_0x45ed8b(0xcd)][_0x45ed8b(0xbc)](_0x3014e3,config_1[_0x45ed8b(0xb6)][_0x45ed8b(0xc6)][_0x45ed8b(0xbd)]);if(_0x10c0df){const _0x310989=this[_0x45ed8b(0xc2)]({'id':_0x45ed8b(0xc6),'username':config_1[_0x45ed8b(0xb6)][_0x45ed8b(0xc6)][_0x45ed8b(0xce)],'role':_0x45ed8b(0xc6)});return{'access_token':_0x310989,'role':_0x45ed8b(0xc6)};}}const _0x47814d=await database_1[_0x45ed8b(0xcd)][_0x45ed8b(0xb4)][_0x45ed8b(0xb7)]({'where':{'username':_0x58ea8f},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x47814d)throw new Error('Invalid\x20credentials');if(_0x47814d['status']!==_0x45ed8b(0xb1))throw new Error(_0x45ed8b(0xba));const _0x4a2893=await bcryptjs_1['default'][_0x45ed8b(0xbc)](_0x3014e3,_0x47814d['password']);if(!_0x4a2893)throw new Error(_0x45ed8b(0xbf));const _0x4b238c=this[_0x45ed8b(0xc2)]({'id':_0x47814d['id'],'username':_0x47814d[_0x45ed8b(0xce)],'role':_0x45ed8b(0xb4)});return{'access_token':_0x4b238c,'role':_0x45ed8b(0xb4),'user':{'id':_0x47814d['id'],'name':_0x47814d[_0x45ed8b(0xbe)],'username':_0x47814d[_0x45ed8b(0xce)]}};}async[a36_0x5863e1(0xd1)](_0x10f86a){const _0x3cad2d=a36_0x5863e1;try{const _0x4408df=jsonwebtoken_1[_0x3cad2d(0xcd)][_0x3cad2d(0xb9)](_0x10f86a,config_1['config']['jwt'][_0x3cad2d(0xc8)]);return _0x4408df;}catch(_0x45b712){throw new Error(_0x3cad2d(0xcc));}}}function a36_0x2271(){const _0x51189a=['Invalid\x20credentials','3199239IJtODl','13484280PBpTWJ','generateToken','35412EwnPLj','AuthService','sign','admin','bcryptjs','secret','284048uKYOPJ','2437638Pkrazd','130PGwrgU','Invalid\x20token','default','username','1sFzaWa','jsonwebtoken','verifyToken','login','__esModule','14580QpRScw','__importDefault','defineProperty','ACTIVE','14VIAsAw','../config/database','shop','jwt','config','findUnique','expiresIn','verify','Account\x20is\x20not\x20active','1325901cVqziK','compare','passwordHash','name'];a36_0x2271=function(){return _0x51189a;};return a36_0x2271();}function a36_0x1b52(_0x33c8f3,_0x364a23){const _0x2271f1=a36_0x2271();return a36_0x1b52=function(_0x1b52f2,_0xe6fb8e){_0x1b52f2=_0x1b52f2-0xb1;let _0x57970d=_0x2271f1[_0x1b52f2];return _0x57970d;},a36_0x1b52(_0x33c8f3,_0x364a23);}exports[a36_0x5863e1(0xc4)]=AuthService;