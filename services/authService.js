'use strict';function a39_0x30bf(){const _0x4fc3ce=['secret','compare','../config/config','login','jsonwebtoken','defineProperty','generateToken','32JwHlah','bcryptjs','4UZKEvy','config','verify','2797290SUHUMq','2276748EgmklT','__esModule','50343510YyatYH','verifyToken','701383naaARk','sign','jwt','AuthService','3346215yfhSYf','name','default','expiresIn','passwordHash','__importDefault','2775934LSdAgK','admin','status','2751815IKzBEJ','Invalid\x20token','ACTIVE','username','shop','7eJvDfY'];a39_0x30bf=function(){return _0x4fc3ce;};return a39_0x30bf();}const a39_0x7e6e24=a39_0x1812;(function(_0x43217e,_0x2ca735){const _0x39d6d2=a39_0x1812,_0x54ef09=_0x43217e();while(!![]){try{const _0x3816b0=-parseInt(_0x39d6d2(0xc0))/0x1+-parseInt(_0x39d6d2(0xca))/0x2+-parseInt(_0x39d6d2(0xc4))/0x3+-parseInt(_0x39d6d2(0xdc))/0x4*(-parseInt(_0x39d6d2(0xcd))/0x5)+-parseInt(_0x39d6d2(0xdf))/0x6*(parseInt(_0x39d6d2(0xd2))/0x7)+parseInt(_0x39d6d2(0xda))/0x8*(-parseInt(_0x39d6d2(0xbc))/0x9)+parseInt(_0x39d6d2(0xbe))/0xa;if(_0x3816b0===_0x2ca735)break;else _0x54ef09['push'](_0x54ef09['shift']());}catch(_0x45fc1b){_0x54ef09['push'](_0x54ef09['shift']());}}}(a39_0x30bf,0xdc2e0));var __importDefault=this&&this[a39_0x7e6e24(0xc9)]||function(_0x4ec7c){return _0x4ec7c&&_0x4ec7c['__esModule']?_0x4ec7c:{'default':_0x4ec7c};};Object[a39_0x7e6e24(0xd8)](exports,a39_0x7e6e24(0xbd),{'value':!![]}),exports[a39_0x7e6e24(0xc3)]=void 0x0;function a39_0x1812(_0xd9f6e8,_0xd7bcbd){const _0x30bf8f=a39_0x30bf();return a39_0x1812=function(_0x1812fc,_0x1c43b8){_0x1812fc=_0x1812fc-0xbc;let _0x2b5ce6=_0x30bf8f[_0x1812fc];return _0x2b5ce6;},a39_0x1812(_0xd9f6e8,_0xd7bcbd);}const bcryptjs_1=__importDefault(require(a39_0x7e6e24(0xdb))),jsonwebtoken_1=__importDefault(require(a39_0x7e6e24(0xd7))),database_1=__importDefault(require('../config/database')),config_1=require(a39_0x7e6e24(0xd5));class AuthService{[a39_0x7e6e24(0xd9)](_0x50c728){const _0x3a8395=a39_0x7e6e24;return jsonwebtoken_1[_0x3a8395(0xc6)][_0x3a8395(0xc1)](_0x50c728,config_1[_0x3a8395(0xdd)][_0x3a8395(0xc2)][_0x3a8395(0xd3)],{'expiresIn':String(config_1['config'][_0x3a8395(0xc2)][_0x3a8395(0xc7)])});}async[a39_0x7e6e24(0xd6)](_0x562530){const _0x3eb88d=a39_0x7e6e24,{username:_0x4c542c,password:_0x26acc8}=_0x562530;if(_0x4c542c===config_1[_0x3eb88d(0xdd)][_0x3eb88d(0xcb)]['username']){const _0x177f4b=await bcryptjs_1[_0x3eb88d(0xc6)][_0x3eb88d(0xd4)](_0x26acc8,config_1['config'][_0x3eb88d(0xcb)][_0x3eb88d(0xc8)]);if(_0x177f4b){const _0x599a7d=this[_0x3eb88d(0xd9)]({'id':'admin','username':config_1[_0x3eb88d(0xdd)]['admin'][_0x3eb88d(0xd0)],'role':_0x3eb88d(0xcb)});return{'access_token':_0x599a7d,'role':_0x3eb88d(0xcb)};}}const _0xdc90fa=await database_1[_0x3eb88d(0xc6)]['shop']['findUnique']({'where':{'username':_0x4c542c},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0xdc90fa)throw new Error('Invalid\x20credentials');if(_0xdc90fa[_0x3eb88d(0xcc)]!==_0x3eb88d(0xcf))throw new Error('Account\x20is\x20not\x20active');const _0x3b8ee0=await bcryptjs_1['default'][_0x3eb88d(0xd4)](_0x26acc8,_0xdc90fa['password']);if(!_0x3b8ee0)throw new Error('Invalid\x20credentials');const _0x3b8cfb=this[_0x3eb88d(0xd9)]({'id':_0xdc90fa['id'],'username':_0xdc90fa[_0x3eb88d(0xd0)],'role':_0x3eb88d(0xd1)});return{'access_token':_0x3b8cfb,'role':_0x3eb88d(0xd1),'user':{'id':_0xdc90fa['id'],'name':_0xdc90fa[_0x3eb88d(0xc5)],'username':_0xdc90fa[_0x3eb88d(0xd0)]}};}async[a39_0x7e6e24(0xbf)](_0x45d4f6){const _0x5d2d3c=a39_0x7e6e24;try{const _0x3064bd=jsonwebtoken_1[_0x5d2d3c(0xc6)][_0x5d2d3c(0xde)](_0x45d4f6,config_1['config']['jwt'][_0x5d2d3c(0xd3)]);return _0x3064bd;}catch(_0x373857){throw new Error(_0x5d2d3c(0xce));}}}exports[a39_0x7e6e24(0xc3)]=AuthService;