'use strict';const a37_0x1e5ea=a37_0x523c;(function(_0x161e95,_0xe37131){const _0x17a5c3=a37_0x523c,_0x48c974=_0x161e95();while(!![]){try{const _0xce9484=parseInt(_0x17a5c3(0xac))/0x1*(-parseInt(_0x17a5c3(0xa2))/0x2)+-parseInt(_0x17a5c3(0x96))/0x3+-parseInt(_0x17a5c3(0x8e))/0x4*(parseInt(_0x17a5c3(0x90))/0x5)+parseInt(_0x17a5c3(0xa1))/0x6+parseInt(_0x17a5c3(0x94))/0x7+parseInt(_0x17a5c3(0xa5))/0x8*(-parseInt(_0x17a5c3(0xa7))/0x9)+parseInt(_0x17a5c3(0x9e))/0xa;if(_0xce9484===_0xe37131)break;else _0x48c974['push'](_0x48c974['shift']());}catch(_0x265000){_0x48c974['push'](_0x48c974['shift']());}}}(a37_0xf769,0xae502));var __importDefault=this&&this['__importDefault']||function(_0x33ce48){const _0x1426be=a37_0x523c;return _0x33ce48&&_0x33ce48[_0x1426be(0x8f)]?_0x33ce48:{'default':_0x33ce48};};function a37_0xf769(){const _0x5cf5aa=['../config/config','expiresIn','jsonwebtoken','AuthService','4632160YzSrsH','secret','compare','5430972oDXdzE','2JifJaS','admin','username','431736AIDjIv','default','54DMNFHD','Invalid\x20credentials','status','sign','verifyToken','243037QCAQUH','shop','config','286344LJauBs','__esModule','5ZuZNhV','password','generateToken','jwt','110173nmuIXz','../config/database','95118RabtqC','Invalid\x20token','login','ACTIVE'];a37_0xf769=function(){return _0x5cf5aa;};return a37_0xf769();}Object['defineProperty'](exports,a37_0x1e5ea(0x8f),{'value':!![]}),exports['AuthService']=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),jsonwebtoken_1=__importDefault(require(a37_0x1e5ea(0x9c))),database_1=__importDefault(require(a37_0x1e5ea(0x95))),config_1=require(a37_0x1e5ea(0x9a));function a37_0x523c(_0x488552,_0x16865d){const _0xf769df=a37_0xf769();return a37_0x523c=function(_0x523ce2,_0x21cf6c){_0x523ce2=_0x523ce2-0x8c;let _0x26e8f8=_0xf769df[_0x523ce2];return _0x26e8f8;},a37_0x523c(_0x488552,_0x16865d);}class AuthService{[a37_0x1e5ea(0x92)](_0x38028a){const _0x85b813=a37_0x1e5ea;return jsonwebtoken_1[_0x85b813(0xa6)][_0x85b813(0xaa)](_0x38028a,config_1[_0x85b813(0x8d)]['jwt'][_0x85b813(0x9f)],{'expiresIn':String(config_1[_0x85b813(0x8d)][_0x85b813(0x93)][_0x85b813(0x9b)])});}async[a37_0x1e5ea(0x98)](_0x2d4b7f){const _0x4547c0=a37_0x1e5ea,{username:_0x1de287,password:_0x1bbcd5}=_0x2d4b7f;if(_0x1de287===config_1['config'][_0x4547c0(0xa3)]['username']){const _0x4ff9da=await bcryptjs_1[_0x4547c0(0xa6)][_0x4547c0(0xa0)](_0x1bbcd5,config_1[_0x4547c0(0x8d)][_0x4547c0(0xa3)]['passwordHash']);if(_0x4ff9da){const _0x4ab030=this['generateToken']({'id':_0x4547c0(0xa3),'username':config_1['config'][_0x4547c0(0xa3)][_0x4547c0(0xa4)],'role':_0x4547c0(0xa3)});return{'access_token':_0x4ab030,'role':_0x4547c0(0xa3)};}}const _0x3dcf58=await database_1[_0x4547c0(0xa6)][_0x4547c0(0x8c)]['findUnique']({'where':{'username':_0x1de287},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x3dcf58)throw new Error(_0x4547c0(0xa8));if(_0x3dcf58[_0x4547c0(0xa9)]!==_0x4547c0(0x99))throw new Error('Account\x20is\x20not\x20active');const _0xd72698=await bcryptjs_1[_0x4547c0(0xa6)][_0x4547c0(0xa0)](_0x1bbcd5,_0x3dcf58[_0x4547c0(0x91)]);if(!_0xd72698)throw new Error(_0x4547c0(0xa8));const _0x5939ab=this[_0x4547c0(0x92)]({'id':_0x3dcf58['id'],'username':_0x3dcf58['username'],'role':_0x4547c0(0x8c)});return{'access_token':_0x5939ab,'role':_0x4547c0(0x8c),'user':{'id':_0x3dcf58['id'],'name':_0x3dcf58['name'],'username':_0x3dcf58[_0x4547c0(0xa4)]}};}async[a37_0x1e5ea(0xab)](_0x310ce8){const _0x465b45=a37_0x1e5ea;try{const _0xdfb445=jsonwebtoken_1['default']['verify'](_0x310ce8,config_1[_0x465b45(0x8d)]['jwt']['secret']);return _0xdfb445;}catch(_0x238521){throw new Error(_0x465b45(0x97));}}}exports[a37_0x1e5ea(0x9d)]=AuthService;