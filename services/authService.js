'use strict';const a37_0x1c5369=a37_0x4be0;(function(_0x334be6,_0x3cb468){const _0xd89e13=a37_0x4be0,_0x38cccd=_0x334be6();while(!![]){try{const _0x4b011c=-parseInt(_0xd89e13(0x76))/0x1*(-parseInt(_0xd89e13(0x8d))/0x2)+-parseInt(_0xd89e13(0x8e))/0x3+-parseInt(_0xd89e13(0x85))/0x4*(parseInt(_0xd89e13(0x8b))/0x5)+parseInt(_0xd89e13(0x84))/0x6*(-parseInt(_0xd89e13(0x73))/0x7)+parseInt(_0xd89e13(0x79))/0x8+-parseInt(_0xd89e13(0x87))/0x9*(parseInt(_0xd89e13(0x75))/0xa)+parseInt(_0xd89e13(0x80))/0xb*(parseInt(_0xd89e13(0x86))/0xc);if(_0x4b011c===_0x3cb468)break;else _0x38cccd['push'](_0x38cccd['shift']());}catch(_0x1ece8d){_0x38cccd['push'](_0x38cccd['shift']());}}}(a37_0x22fa,0x443e8));var __importDefault=this&&this['__importDefault']||function(_0x1e163c){const _0x561475=a37_0x4be0;return _0x1e163c&&_0x1e163c[_0x561475(0x72)]?_0x1e163c:{'default':_0x1e163c};};Object[a37_0x1c5369(0x6a)](exports,a37_0x1c5369(0x72),{'value':!![]}),exports['AuthService']=void 0x0;const bcryptjs_1=__importDefault(require(a37_0x1c5369(0x7b))),jsonwebtoken_1=__importDefault(require(a37_0x1c5369(0x7d))),database_1=__importDefault(require(a37_0x1c5369(0x6b))),config_1=require(a37_0x1c5369(0x7c));function a37_0x4be0(_0x1882d8,_0x5011ca){const _0x22fa32=a37_0x22fa();return a37_0x4be0=function(_0x4be044,_0xed9afc){_0x4be044=_0x4be044-0x6a;let _0x46217b=_0x22fa32[_0x4be044];return _0x46217b;},a37_0x4be0(_0x1882d8,_0x5011ca);}function a37_0x22fa(){const _0x839f88=['4loBFyV','1375437CupCVF','ACTIVE','login','defineProperty','../config/database','secret','findUnique','shop','Invalid\x20token','username','Invalid\x20credentials','__esModule','7JhWUAN','default','670aLuzWo','164701hJRSLE','password','generateToken','517328CBZbQB','admin','bcryptjs','../config/config','jsonwebtoken','passwordHash','config','11rfbVwy','name','expiresIn','verifyToken','2221278fWaNSi','125408BuMhid','15097308fErhBs','56223aJjsPq','sign','compare','jwt','20rrzOFa','verify'];a37_0x22fa=function(){return _0x839f88;};return a37_0x22fa();}class AuthService{[a37_0x1c5369(0x78)](_0x139c90){const _0x3abfdb=a37_0x1c5369;return jsonwebtoken_1[_0x3abfdb(0x74)][_0x3abfdb(0x88)](_0x139c90,config_1[_0x3abfdb(0x7f)][_0x3abfdb(0x8a)][_0x3abfdb(0x6c)],{'expiresIn':String(config_1[_0x3abfdb(0x7f)][_0x3abfdb(0x8a)][_0x3abfdb(0x82)])});}async[a37_0x1c5369(0x90)](_0x4eb232){const _0x1b1edc=a37_0x1c5369,{username:_0x14e72e,password:_0x550bf4}=_0x4eb232;if(_0x14e72e===config_1['config'][_0x1b1edc(0x7a)][_0x1b1edc(0x70)]){const _0x4ff76b=await bcryptjs_1[_0x1b1edc(0x74)][_0x1b1edc(0x89)](_0x550bf4,config_1[_0x1b1edc(0x7f)][_0x1b1edc(0x7a)][_0x1b1edc(0x7e)]);if(_0x4ff76b){const _0x4df347=this[_0x1b1edc(0x78)]({'id':'admin','username':config_1[_0x1b1edc(0x7f)][_0x1b1edc(0x7a)]['username'],'role':_0x1b1edc(0x7a)});return{'access_token':_0x4df347,'role':_0x1b1edc(0x7a)};}}const _0x454f4c=await database_1['default'][_0x1b1edc(0x6e)][_0x1b1edc(0x6d)]({'where':{'username':_0x14e72e},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x454f4c)throw new Error(_0x1b1edc(0x71));if(_0x454f4c['status']!==_0x1b1edc(0x8f))throw new Error('Account\x20is\x20not\x20active');const _0x356195=await bcryptjs_1[_0x1b1edc(0x74)][_0x1b1edc(0x89)](_0x550bf4,_0x454f4c[_0x1b1edc(0x77)]);if(!_0x356195)throw new Error('Invalid\x20credentials');const _0x123381=this[_0x1b1edc(0x78)]({'id':_0x454f4c['id'],'username':_0x454f4c[_0x1b1edc(0x70)],'role':_0x1b1edc(0x6e)});return{'access_token':_0x123381,'role':_0x1b1edc(0x6e),'user':{'id':_0x454f4c['id'],'name':_0x454f4c[_0x1b1edc(0x81)],'username':_0x454f4c[_0x1b1edc(0x70)]}};}async[a37_0x1c5369(0x83)](_0x1e8fda){const _0x4bbf40=a37_0x1c5369;try{const _0x10cbbb=jsonwebtoken_1[_0x4bbf40(0x74)][_0x4bbf40(0x8c)](_0x1e8fda,config_1[_0x4bbf40(0x7f)][_0x4bbf40(0x8a)][_0x4bbf40(0x6c)]);return _0x10cbbb;}catch(_0x55c5f5){throw new Error(_0x4bbf40(0x6f));}}}exports['AuthService']=AuthService;