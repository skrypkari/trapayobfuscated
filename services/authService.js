'use strict';const a39_0x793ede=a39_0x216e;(function(_0x4dd79e,_0x12b8a4){const _0x573bad=a39_0x216e,_0x25bf36=_0x4dd79e();while(!![]){try{const _0x171624=-parseInt(_0x573bad(0x120))/0x1+-parseInt(_0x573bad(0x117))/0x2*(parseInt(_0x573bad(0x11b))/0x3)+-parseInt(_0x573bad(0x12d))/0x4+parseInt(_0x573bad(0x128))/0x5+-parseInt(_0x573bad(0x12c))/0x6+parseInt(_0x573bad(0x133))/0x7*(parseInt(_0x573bad(0x114))/0x8)+parseInt(_0x573bad(0x132))/0x9*(parseInt(_0x573bad(0x11f))/0xa);if(_0x171624===_0x12b8a4)break;else _0x25bf36['push'](_0x25bf36['shift']());}catch(_0x1f2b42){_0x25bf36['push'](_0x25bf36['shift']());}}}(a39_0x229c,0xb2ad5));function a39_0x229c(){const _0x382103=['ACTIVE','defineProperty','1383759bbbGoA','6244vnkfJW','expiresIn','passwordHash','Invalid\x20credentials','generateToken','10832RJACTN','admin','../config/config','1730846lCGwav','compare','findUnique','config','3ALGgyg','default','jsonwebtoken','Invalid\x20token','50qEtPRJ','197362XDnYrW','username','shop','jwt','status','sign','../config/database','Account\x20is\x20not\x20active','7040590PqgdJT','AuthService','__esModule','secret','1826154XtkBdv','5142544tAZMKV','__importDefault','verifyToken'];a39_0x229c=function(){return _0x382103;};return a39_0x229c();}function a39_0x216e(_0x22d3f9,_0x2909c8){const _0x229c6b=a39_0x229c();return a39_0x216e=function(_0x216e20,_0x338b70){_0x216e20=_0x216e20-0x114;let _0x3e4978=_0x229c6b[_0x216e20];return _0x3e4978;},a39_0x216e(_0x22d3f9,_0x2909c8);}var __importDefault=this&&this[a39_0x793ede(0x12e)]||function(_0x52b2b0){const _0x534dbb=a39_0x793ede;return _0x52b2b0&&_0x52b2b0[_0x534dbb(0x12a)]?_0x52b2b0:{'default':_0x52b2b0};};Object[a39_0x793ede(0x131)](exports,a39_0x793ede(0x12a),{'value':!![]}),exports[a39_0x793ede(0x129)]=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),jsonwebtoken_1=__importDefault(require(a39_0x793ede(0x11d))),database_1=__importDefault(require(a39_0x793ede(0x126))),config_1=require(a39_0x793ede(0x116));class AuthService{[a39_0x793ede(0x137)](_0x53d3aa){const _0x18e52b=a39_0x793ede;return jsonwebtoken_1[_0x18e52b(0x11c)][_0x18e52b(0x125)](_0x53d3aa,config_1[_0x18e52b(0x11a)]['jwt'][_0x18e52b(0x12b)],{'expiresIn':String(config_1[_0x18e52b(0x11a)][_0x18e52b(0x123)][_0x18e52b(0x134)])});}async['login'](_0x120252){const _0x10762c=a39_0x793ede,{username:_0x46d015,password:_0x2bf624}=_0x120252;if(_0x46d015===config_1[_0x10762c(0x11a)][_0x10762c(0x115)]['username']){const _0x56e92c=await bcryptjs_1[_0x10762c(0x11c)][_0x10762c(0x118)](_0x2bf624,config_1[_0x10762c(0x11a)][_0x10762c(0x115)][_0x10762c(0x135)]);if(_0x56e92c){const _0x56a838=this[_0x10762c(0x137)]({'id':_0x10762c(0x115),'username':config_1['config'][_0x10762c(0x115)]['username'],'role':_0x10762c(0x115)});return{'access_token':_0x56a838,'role':_0x10762c(0x115)};}}const _0x344905=await database_1[_0x10762c(0x11c)][_0x10762c(0x122)][_0x10762c(0x119)]({'where':{'username':_0x46d015},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x344905)throw new Error(_0x10762c(0x136));if(_0x344905[_0x10762c(0x124)]!==_0x10762c(0x130))throw new Error(_0x10762c(0x127));const _0x590071=await bcryptjs_1[_0x10762c(0x11c)][_0x10762c(0x118)](_0x2bf624,_0x344905['password']);if(!_0x590071)throw new Error(_0x10762c(0x136));const _0x50029c=this[_0x10762c(0x137)]({'id':_0x344905['id'],'username':_0x344905[_0x10762c(0x121)],'role':_0x10762c(0x122)});return{'access_token':_0x50029c,'role':'shop','user':{'id':_0x344905['id'],'name':_0x344905['name'],'username':_0x344905['username']}};}async[a39_0x793ede(0x12f)](_0x2a3d30){const _0x168a0c=a39_0x793ede;try{const _0x16c99b=jsonwebtoken_1['default']['verify'](_0x2a3d30,config_1[_0x168a0c(0x11a)]['jwt'][_0x168a0c(0x12b)]);return _0x16c99b;}catch(_0x3563cd){throw new Error(_0x168a0c(0x11e));}}}exports[a39_0x793ede(0x129)]=AuthService;