'use strict';const a47_0x4f8be1=a47_0x3df9;(function(_0x2293b8,_0x1f8829){const _0x260932=a47_0x3df9,_0x4b86a5=_0x2293b8();while(!![]){try{const _0x5465af=-parseInt(_0x260932(0xea))/0x1*(parseInt(_0x260932(0xd9))/0x2)+-parseInt(_0x260932(0xf6))/0x3*(-parseInt(_0x260932(0xdb))/0x4)+-parseInt(_0x260932(0xe5))/0x5*(parseInt(_0x260932(0xde))/0x6)+-parseInt(_0x260932(0xda))/0x7+-parseInt(_0x260932(0xf3))/0x8*(parseInt(_0x260932(0xd6))/0x9)+parseInt(_0x260932(0xeb))/0xa+parseInt(_0x260932(0xe4))/0xb*(parseInt(_0x260932(0xf2))/0xc);if(_0x5465af===_0x1f8829)break;else _0x4b86a5['push'](_0x4b86a5['shift']());}catch(_0x338da0){_0x4b86a5['push'](_0x4b86a5['shift']());}}}(a47_0x199b,0xf0bfd));var __importDefault=this&&this[a47_0x4f8be1(0xe1)]||function(_0x3a1378){const _0x157ba6=a47_0x4f8be1;return _0x3a1378&&_0x3a1378[_0x157ba6(0xee)]?_0x3a1378:{'default':_0x3a1378};};Object[a47_0x4f8be1(0xd7)](exports,a47_0x4f8be1(0xee),{'value':!![]}),exports[a47_0x4f8be1(0xf7)]=void 0x0;const bcryptjs_1=__importDefault(require(a47_0x4f8be1(0xd5))),jsonwebtoken_1=__importDefault(require(a47_0x4f8be1(0xdc))),database_1=__importDefault(require('../config/database')),config_1=require(a47_0x4f8be1(0xf5));function a47_0x3df9(_0x5490a4,_0x1ab167){_0x5490a4=_0x5490a4-0xd2;const _0x199ba6=a47_0x199b();let _0x3df9d8=_0x199ba6[_0x5490a4];return _0x3df9d8;}class AuthService{[a47_0x4f8be1(0xe9)](_0x4366be){const _0x4d120f=a47_0x4f8be1;return jsonwebtoken_1['default'][_0x4d120f(0xe8)](_0x4366be,config_1[_0x4d120f(0xf4)][_0x4d120f(0xdf)][_0x4d120f(0xe6)],{'expiresIn':String(config_1[_0x4d120f(0xf4)][_0x4d120f(0xdf)][_0x4d120f(0xf0)])});}async[a47_0x4f8be1(0xe2)](_0x4454c4){const _0x377ab7=a47_0x4f8be1,{username:_0x4ef899,password:_0x501894}=_0x4454c4;if(_0x4ef899===config_1[_0x377ab7(0xf4)][_0x377ab7(0xec)][_0x377ab7(0xe7)]){const _0x501446=await bcryptjs_1[_0x377ab7(0xd4)][_0x377ab7(0xf1)](_0x501894,config_1[_0x377ab7(0xf4)][_0x377ab7(0xec)][_0x377ab7(0xe0)]);if(_0x501446){const _0x1e6fb5=this[_0x377ab7(0xe9)]({'id':'admin','username':config_1[_0x377ab7(0xf4)][_0x377ab7(0xec)][_0x377ab7(0xe7)],'role':_0x377ab7(0xec)});return{'access_token':_0x1e6fb5,'role':_0x377ab7(0xec)};}}const _0x3f456f=await database_1[_0x377ab7(0xd4)][_0x377ab7(0xef)][_0x377ab7(0xed)]({'where':{'username':_0x4ef899},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x3f456f)throw new Error(_0x377ab7(0xdd));if(_0x3f456f['status']!==_0x377ab7(0xd3))throw new Error('Account\x20is\x20not\x20active');const _0xd63878=await bcryptjs_1['default']['compare'](_0x501894,_0x3f456f['password']);if(!_0xd63878)throw new Error(_0x377ab7(0xdd));const _0x3bd318=this[_0x377ab7(0xe9)]({'id':_0x3f456f['id'],'username':_0x3f456f[_0x377ab7(0xe7)],'role':_0x377ab7(0xef)});return{'access_token':_0x3bd318,'role':_0x377ab7(0xef),'user':{'id':_0x3f456f['id'],'name':_0x3f456f['name'],'username':_0x3f456f['username']}};}async[a47_0x4f8be1(0xd8)](_0x2402e4){const _0x394ea5=a47_0x4f8be1;try{const _0x47fcc1=jsonwebtoken_1[_0x394ea5(0xd4)][_0x394ea5(0xe3)](_0x2402e4,config_1[_0x394ea5(0xf4)][_0x394ea5(0xdf)][_0x394ea5(0xe6)]);return _0x47fcc1;}catch(_0x52c283){throw new Error(_0x394ea5(0xd2));}}}function a47_0x199b(){const _0x119442=['2682840mmewRt','99656JUBAxz','config','../config/config','3QyyYYP','AuthService','Invalid\x20token','ACTIVE','default','bcryptjs','135clUvDp','defineProperty','verifyToken','66yPaTAV','13759970KhseLO','444756zXdOgv','jsonwebtoken','Invalid\x20credentials','249888HgYiZs','jwt','passwordHash','__importDefault','login','verify','209DIKahH','235sbRkbN','secret','username','sign','generateToken','8039nsdTyw','10023980ztzWZK','admin','findUnique','__esModule','shop','expiresIn','compare'];a47_0x199b=function(){return _0x119442;};return a47_0x199b();}exports[a47_0x4f8be1(0xf7)]=AuthService;