'use strict';const a41_0xeffe7=a41_0x5f28;(function(_0x44e5fa,_0x40b386){const _0x35de86=a41_0x5f28,_0x1b59fa=_0x44e5fa();while(!![]){try{const _0x1bf3aa=-parseInt(_0x35de86(0xe6))/0x1+-parseInt(_0x35de86(0x103))/0x2+-parseInt(_0x35de86(0xf8))/0x3*(parseInt(_0x35de86(0xef))/0x4)+-parseInt(_0x35de86(0xf2))/0x5+parseInt(_0x35de86(0xfd))/0x6*(-parseInt(_0x35de86(0x101))/0x7)+parseInt(_0x35de86(0xf0))/0x8*(parseInt(_0x35de86(0xe8))/0x9)+-parseInt(_0x35de86(0x100))/0xa*(-parseInt(_0x35de86(0xe2))/0xb);if(_0x1bf3aa===_0x40b386)break;else _0x1b59fa['push'](_0x1b59fa['shift']());}catch(_0x54e8fd){_0x1b59fa['push'](_0x1b59fa['shift']());}}}(a41_0x1894,0x955d4));var __importDefault=this&&this[a41_0xeffe7(0xf4)]||function(_0x435537){const _0x57370e=a41_0xeffe7;return _0x435537&&_0x435537[_0x57370e(0x102)]?_0x435537:{'default':_0x435537};};Object[a41_0xeffe7(0xe0)](exports,'__esModule',{'value':!![]}),exports[a41_0xeffe7(0xff)]=void 0x0;function a41_0x5f28(_0x201fc7,_0x25345c){const _0x1894db=a41_0x1894();return a41_0x5f28=function(_0x5f2837,_0x546b1f){_0x5f2837=_0x5f2837-0xe0;let _0x1d487e=_0x1894db[_0x5f2837];return _0x1d487e;},a41_0x5f28(_0x201fc7,_0x25345c);}const bcryptjs_1=__importDefault(require('bcryptjs')),jsonwebtoken_1=__importDefault(require(a41_0xeffe7(0xf9))),database_1=__importDefault(require(a41_0xeffe7(0xf5))),config_1=require(a41_0xeffe7(0xe3));function a41_0x1894(){const _0x58b5bd=['jsonwebtoken','jwt','ACTIVE','secret','9006IZdcpm','generateToken','AuthService','5290sfcROY','2338qMICoi','__esModule','117312pelnfe','name','passwordHash','defineProperty','compare','63811cYCMer','../config/config','Invalid\x20credentials','default','990327asNetZ','shop','54oFaDSL','sign','findUnique','login','Invalid\x20token','expiresIn','Account\x20is\x20not\x20active','22124HPrfno','1260648bkiKLI','verifyToken','4891020BFJXvm','config','__importDefault','../config/database','admin','username','474ILjzCd'];a41_0x1894=function(){return _0x58b5bd;};return a41_0x1894();}class AuthService{[a41_0xeffe7(0xfe)](_0x5526dc){const _0x328ebe=a41_0xeffe7;return jsonwebtoken_1['default'][_0x328ebe(0xe9)](_0x5526dc,config_1[_0x328ebe(0xf3)][_0x328ebe(0xfa)][_0x328ebe(0xfc)],{'expiresIn':String(config_1['config']['jwt'][_0x328ebe(0xed)])});}async[a41_0xeffe7(0xeb)](_0x26d9b1){const _0x4c87a7=a41_0xeffe7,{username:_0x1c7315,password:_0x4173e6}=_0x26d9b1;if(_0x1c7315===config_1[_0x4c87a7(0xf3)][_0x4c87a7(0xf6)][_0x4c87a7(0xf7)]){const _0x25f3c0=await bcryptjs_1['default'][_0x4c87a7(0xe1)](_0x4173e6,config_1['config'][_0x4c87a7(0xf6)][_0x4c87a7(0x105)]);if(_0x25f3c0){const _0x41aad5=this[_0x4c87a7(0xfe)]({'id':_0x4c87a7(0xf6),'username':config_1[_0x4c87a7(0xf3)]['admin']['username'],'role':'admin'});return{'access_token':_0x41aad5,'role':_0x4c87a7(0xf6)};}}const _0x4f0191=await database_1['default'][_0x4c87a7(0xe7)][_0x4c87a7(0xea)]({'where':{'username':_0x1c7315},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x4f0191)throw new Error(_0x4c87a7(0xe4));if(_0x4f0191['status']!==_0x4c87a7(0xfb))throw new Error(_0x4c87a7(0xee));const _0x13ae5b=await bcryptjs_1[_0x4c87a7(0xe5)][_0x4c87a7(0xe1)](_0x4173e6,_0x4f0191['password']);if(!_0x13ae5b)throw new Error(_0x4c87a7(0xe4));const _0x566683=this[_0x4c87a7(0xfe)]({'id':_0x4f0191['id'],'username':_0x4f0191[_0x4c87a7(0xf7)],'role':_0x4c87a7(0xe7)});return{'access_token':_0x566683,'role':_0x4c87a7(0xe7),'user':{'id':_0x4f0191['id'],'name':_0x4f0191[_0x4c87a7(0x104)],'username':_0x4f0191['username']}};}async[a41_0xeffe7(0xf1)](_0x280a9e){const _0x4556c4=a41_0xeffe7;try{const _0x55c2ef=jsonwebtoken_1[_0x4556c4(0xe5)]['verify'](_0x280a9e,config_1[_0x4556c4(0xf3)]['jwt']['secret']);return _0x55c2ef;}catch(_0x5f06cd){throw new Error(_0x4556c4(0xec));}}}exports['AuthService']=AuthService;