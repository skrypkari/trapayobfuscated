'use strict';const a36_0x33a530=a36_0x59d7;(function(_0x39ae96,_0xd92ce0){const _0x7b94f1=a36_0x59d7,_0x31b0d4=_0x39ae96();while(!![]){try{const _0x1ed89e=parseInt(_0x7b94f1(0x13f))/0x1+parseInt(_0x7b94f1(0x13e))/0x2+parseInt(_0x7b94f1(0x13b))/0x3*(parseInt(_0x7b94f1(0x134))/0x4)+-parseInt(_0x7b94f1(0x11f))/0x5*(parseInt(_0x7b94f1(0x125))/0x6)+-parseInt(_0x7b94f1(0x13c))/0x7*(-parseInt(_0x7b94f1(0x12a))/0x8)+-parseInt(_0x7b94f1(0x12d))/0x9+parseInt(_0x7b94f1(0x11d))/0xa;if(_0x1ed89e===_0xd92ce0)break;else _0x31b0d4['push'](_0x31b0d4['shift']());}catch(_0xea29dd){_0x31b0d4['push'](_0x31b0d4['shift']());}}}(a36_0x5d10,0xdf10c));var __importDefault=this&&this[a36_0x33a530(0x122)]||function(_0x57dd50){const _0x10d9cb=a36_0x33a530;return _0x57dd50&&_0x57dd50[_0x10d9cb(0x12e)]?_0x57dd50:{'default':_0x57dd50};};function a36_0x59d7(_0x85d8e8,_0x1ad61b){const _0x5d10ac=a36_0x5d10();return a36_0x59d7=function(_0x59d70b,_0x52ae0f){_0x59d70b=_0x59d70b-0x11c;let _0x1eed8=_0x5d10ac[_0x59d70b];return _0x1eed8;},a36_0x59d7(_0x85d8e8,_0x1ad61b);}Object[a36_0x33a530(0x138)](exports,a36_0x33a530(0x12e),{'value':!![]}),exports[a36_0x33a530(0x126)]=void 0x0;const bcryptjs_1=__importDefault(require(a36_0x33a530(0x132))),jsonwebtoken_1=__importDefault(require(a36_0x33a530(0x133))),database_1=__importDefault(require(a36_0x33a530(0x139))),config_1=require(a36_0x33a530(0x130));class AuthService{['generateToken'](_0x597b07){const _0x1392f2=a36_0x33a530;return jsonwebtoken_1[_0x1392f2(0x12c)][_0x1392f2(0x12b)](_0x597b07,config_1[_0x1392f2(0x137)][_0x1392f2(0x120)][_0x1392f2(0x121)],{'expiresIn':String(config_1['config']['jwt']['expiresIn'])});}async['login'](_0x10f80e){const _0x4063aa=a36_0x33a530,{username:_0x301bb9,password:_0x3f9faf}=_0x10f80e;if(_0x301bb9===config_1[_0x4063aa(0x137)][_0x4063aa(0x11e)][_0x4063aa(0x11c)]){const _0x17e691=await bcryptjs_1['default']['compare'](_0x3f9faf,config_1[_0x4063aa(0x137)][_0x4063aa(0x11e)][_0x4063aa(0x13a)]);if(_0x17e691){const _0x12d605=this[_0x4063aa(0x129)]({'id':_0x4063aa(0x11e),'username':config_1[_0x4063aa(0x137)]['admin'][_0x4063aa(0x11c)],'role':_0x4063aa(0x11e)});return{'access_token':_0x12d605,'role':_0x4063aa(0x11e)};}}const _0x1e58d0=await database_1[_0x4063aa(0x12c)][_0x4063aa(0x135)][_0x4063aa(0x131)]({'where':{'username':_0x301bb9},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x1e58d0)throw new Error(_0x4063aa(0x123));if(_0x1e58d0[_0x4063aa(0x12f)]!==_0x4063aa(0x128))throw new Error('Account\x20is\x20not\x20active');const _0x3fece0=await bcryptjs_1[_0x4063aa(0x12c)][_0x4063aa(0x127)](_0x3f9faf,_0x1e58d0[_0x4063aa(0x136)]);if(!_0x3fece0)throw new Error(_0x4063aa(0x123));const _0x454614=this[_0x4063aa(0x129)]({'id':_0x1e58d0['id'],'username':_0x1e58d0[_0x4063aa(0x11c)],'role':_0x4063aa(0x135)});return{'access_token':_0x454614,'role':'shop','user':{'id':_0x1e58d0['id'],'name':_0x1e58d0['name'],'username':_0x1e58d0[_0x4063aa(0x11c)]}};}async[a36_0x33a530(0x13d)](_0xaf154f){const _0x2d93a8=a36_0x33a530;try{const _0x478918=jsonwebtoken_1[_0x2d93a8(0x12c)][_0x2d93a8(0x124)](_0xaf154f,config_1[_0x2d93a8(0x137)][_0x2d93a8(0x120)]['secret']);return _0x478918;}catch(_0x5f0d63){throw new Error('Invalid\x20token');}}}function a36_0x5d10(){const _0x1f503b=['verifyToken','2907452GjEayi','822491AQyZHj','username','3549410omqTWq','admin','5MTvVIg','jwt','secret','__importDefault','Invalid\x20credentials','verify','7364586jzdSAL','AuthService','compare','ACTIVE','generateToken','7064MiQEHN','sign','default','15833664hTLvxo','__esModule','status','../config/config','findUnique','bcryptjs','jsonwebtoken','136ROfVVm','shop','password','config','defineProperty','../config/database','passwordHash','98046CaKtVj','1253JAQNZT'];a36_0x5d10=function(){return _0x1f503b;};return a36_0x5d10();}exports[a36_0x33a530(0x126)]=AuthService;