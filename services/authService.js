'use strict';const a36_0x5536e6=a36_0x3af7;(function(_0x31a1b2,_0x2e226a){const _0x134a33=a36_0x3af7,_0x495958=_0x31a1b2();while(!![]){try{const _0x180499=parseInt(_0x134a33(0x1d9))/0x1+-parseInt(_0x134a33(0x1d4))/0x2*(-parseInt(_0x134a33(0x1de))/0x3)+-parseInt(_0x134a33(0x1eb))/0x4+-parseInt(_0x134a33(0x1d7))/0x5+-parseInt(_0x134a33(0x1e5))/0x6+parseInt(_0x134a33(0x1e3))/0x7+parseInt(_0x134a33(0x1dd))/0x8*(-parseInt(_0x134a33(0x1da))/0x9);if(_0x180499===_0x2e226a)break;else _0x495958['push'](_0x495958['shift']());}catch(_0x45af5c){_0x495958['push'](_0x495958['shift']());}}}(a36_0x13cc,0x60a9d));var __importDefault=this&&this[a36_0x5536e6(0x1df)]||function(_0x5bb40d){const _0x5a5e3e=a36_0x5536e6;return _0x5bb40d&&_0x5bb40d[_0x5a5e3e(0x1ec)]?_0x5bb40d:{'default':_0x5bb40d};};function a36_0x3af7(_0x1a5a92,_0xab9fbe){const _0x13cc95=a36_0x13cc();return a36_0x3af7=function(_0x3af7ff,_0x304901){_0x3af7ff=_0x3af7ff-0x1ce;let _0x282347=_0x13cc95[_0x3af7ff];return _0x282347;},a36_0x3af7(_0x1a5a92,_0xab9fbe);}Object['defineProperty'](exports,a36_0x5536e6(0x1ec),{'value':!![]}),exports[a36_0x5536e6(0x1f0)]=void 0x0;function a36_0x13cc(){const _0x57884f=['20VevRhi','generateToken','config','1693690jBBomJ','findUnique','608758SCcNRF','261qSfOkP','admin','verify','8152IEhBUQ','225579FuYcQW','__importDefault','default','shop','sign','2083382eDIVCd','username','4384764IofajL','../config/database','Account\x20is\x20not\x20active','name','password','expiresIn','653192wAAzra','__esModule','verifyToken','Invalid\x20credentials','secret','AuthService','passwordHash','jwt','bcryptjs','jsonwebtoken','compare','status','../config/config'];a36_0x13cc=function(){return _0x57884f;};return a36_0x13cc();}const bcryptjs_1=__importDefault(require(a36_0x5536e6(0x1cf))),jsonwebtoken_1=__importDefault(require(a36_0x5536e6(0x1d0))),database_1=__importDefault(require(a36_0x5536e6(0x1e6))),config_1=require(a36_0x5536e6(0x1d3));class AuthService{[a36_0x5536e6(0x1d5)](_0x5e595f){const _0x28e6c4=a36_0x5536e6;return jsonwebtoken_1[_0x28e6c4(0x1e0)][_0x28e6c4(0x1e2)](_0x5e595f,config_1[_0x28e6c4(0x1d6)][_0x28e6c4(0x1ce)][_0x28e6c4(0x1ef)],{'expiresIn':String(config_1[_0x28e6c4(0x1d6)][_0x28e6c4(0x1ce)][_0x28e6c4(0x1ea)])});}async['login'](_0x55238f){const _0x2070d2=a36_0x5536e6,{username:_0x548044,password:_0x191af7}=_0x55238f;if(_0x548044===config_1[_0x2070d2(0x1d6)][_0x2070d2(0x1db)][_0x2070d2(0x1e4)]){const _0x94122=await bcryptjs_1['default']['compare'](_0x191af7,config_1['config'][_0x2070d2(0x1db)][_0x2070d2(0x1f1)]);if(_0x94122){const _0x21c7b2=this['generateToken']({'id':_0x2070d2(0x1db),'username':config_1['config'][_0x2070d2(0x1db)][_0x2070d2(0x1e4)],'role':_0x2070d2(0x1db)});return{'access_token':_0x21c7b2,'role':_0x2070d2(0x1db)};}}const _0x362124=await database_1[_0x2070d2(0x1e0)][_0x2070d2(0x1e1)][_0x2070d2(0x1d8)]({'where':{'username':_0x548044},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x362124)throw new Error(_0x2070d2(0x1ee));if(_0x362124[_0x2070d2(0x1d2)]!=='ACTIVE')throw new Error(_0x2070d2(0x1e7));const _0xb51386=await bcryptjs_1[_0x2070d2(0x1e0)][_0x2070d2(0x1d1)](_0x191af7,_0x362124[_0x2070d2(0x1e9)]);if(!_0xb51386)throw new Error(_0x2070d2(0x1ee));const _0x267cc9=this[_0x2070d2(0x1d5)]({'id':_0x362124['id'],'username':_0x362124[_0x2070d2(0x1e4)],'role':'shop'});return{'access_token':_0x267cc9,'role':_0x2070d2(0x1e1),'user':{'id':_0x362124['id'],'name':_0x362124[_0x2070d2(0x1e8)],'username':_0x362124[_0x2070d2(0x1e4)]}};}async[a36_0x5536e6(0x1ed)](_0x47fb39){const _0x5aca9b=a36_0x5536e6;try{const _0x481497=jsonwebtoken_1[_0x5aca9b(0x1e0)][_0x5aca9b(0x1dc)](_0x47fb39,config_1[_0x5aca9b(0x1d6)][_0x5aca9b(0x1ce)]['secret']);return _0x481497;}catch(_0x45ea54){throw new Error('Invalid\x20token');}}}exports[a36_0x5536e6(0x1f0)]=AuthService;