'use strict';const a37_0x29e817=a37_0x408a;(function(_0x4a0a7f,_0x118480){const _0x33ff91=a37_0x408a,_0x53fd98=_0x4a0a7f();while(!![]){try{const _0x2c5044=-parseInt(_0x33ff91(0x81))/0x1+-parseInt(_0x33ff91(0x67))/0x2+parseInt(_0x33ff91(0x6b))/0x3*(parseInt(_0x33ff91(0x7f))/0x4)+-parseInt(_0x33ff91(0x83))/0x5+-parseInt(_0x33ff91(0x64))/0x6*(-parseInt(_0x33ff91(0x65))/0x7)+parseInt(_0x33ff91(0x72))/0x8*(parseInt(_0x33ff91(0x84))/0x9)+parseInt(_0x33ff91(0x7d))/0xa*(parseInt(_0x33ff91(0x82))/0xb);if(_0x2c5044===_0x118480)break;else _0x53fd98['push'](_0x53fd98['shift']());}catch(_0x10c9ac){_0x53fd98['push'](_0x53fd98['shift']());}}}(a37_0x537a,0x5190e));function a37_0x537a(){const _0x4cf07f=['shop','__esModule','Invalid\x20credentials','verifyToken','password','9910TRpFVv','login','5636JryzPi','compare','236621ittYXC','935wpJpXs','2942415tfwheR','1149327VsIhOu','ACTIVE','sign','username','__importDefault','config','6MNHujH','3835433oXEUFa','secret','470172rieoeQ','../config/database','defineProperty','bcryptjs','807kbSkxt','verify','admin','expiresIn','generateToken','jwt','name','24kOgMjh','AuthService','default','../config/config','findUnique','status'];a37_0x537a=function(){return _0x4cf07f;};return a37_0x537a();}function a37_0x408a(_0x2a0ac7,_0x49ac3d){const _0x537aa7=a37_0x537a();return a37_0x408a=function(_0x408acf,_0x4b6aa0){_0x408acf=_0x408acf-0x64;let _0x5e3b79=_0x537aa7[_0x408acf];return _0x5e3b79;},a37_0x408a(_0x2a0ac7,_0x49ac3d);}var __importDefault=this&&this[a37_0x29e817(0x88)]||function(_0x21c7a8){return _0x21c7a8&&_0x21c7a8['__esModule']?_0x21c7a8:{'default':_0x21c7a8};};Object[a37_0x29e817(0x69)](exports,a37_0x29e817(0x79),{'value':!![]}),exports[a37_0x29e817(0x73)]=void 0x0;const bcryptjs_1=__importDefault(require(a37_0x29e817(0x6a))),jsonwebtoken_1=__importDefault(require('jsonwebtoken')),database_1=__importDefault(require(a37_0x29e817(0x68))),config_1=require(a37_0x29e817(0x75));class AuthService{[a37_0x29e817(0x6f)](_0x5265db){const _0x26bbb0=a37_0x29e817;return jsonwebtoken_1[_0x26bbb0(0x74)][_0x26bbb0(0x86)](_0x5265db,config_1[_0x26bbb0(0x89)]['jwt']['secret'],{'expiresIn':String(config_1[_0x26bbb0(0x89)]['jwt'][_0x26bbb0(0x6e)])});}async[a37_0x29e817(0x7e)](_0x5b71c8){const _0x25c5c9=a37_0x29e817,{username:_0x37730c,password:_0x108655}=_0x5b71c8;if(_0x37730c===config_1['config'][_0x25c5c9(0x6d)]['username']){const _0x36dd61=await bcryptjs_1[_0x25c5c9(0x74)][_0x25c5c9(0x80)](_0x108655,config_1[_0x25c5c9(0x89)][_0x25c5c9(0x6d)]['passwordHash']);if(_0x36dd61){const _0x59206f=this['generateToken']({'id':'admin','username':config_1['config'][_0x25c5c9(0x6d)][_0x25c5c9(0x87)],'role':_0x25c5c9(0x6d)});return{'access_token':_0x59206f,'role':'admin'};}}const _0x2c458c=await database_1[_0x25c5c9(0x74)][_0x25c5c9(0x78)][_0x25c5c9(0x76)]({'where':{'username':_0x37730c},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x2c458c)throw new Error(_0x25c5c9(0x7a));if(_0x2c458c[_0x25c5c9(0x77)]!==_0x25c5c9(0x85))throw new Error('Account\x20is\x20not\x20active');const _0x576bf2=await bcryptjs_1['default'][_0x25c5c9(0x80)](_0x108655,_0x2c458c[_0x25c5c9(0x7c)]);if(!_0x576bf2)throw new Error(_0x25c5c9(0x7a));const _0xdb36ef=this[_0x25c5c9(0x6f)]({'id':_0x2c458c['id'],'username':_0x2c458c['username'],'role':_0x25c5c9(0x78)});return{'access_token':_0xdb36ef,'role':'shop','user':{'id':_0x2c458c['id'],'name':_0x2c458c[_0x25c5c9(0x71)],'username':_0x2c458c['username']}};}async[a37_0x29e817(0x7b)](_0x4ece7c){const _0x478c53=a37_0x29e817;try{const _0x58bbe1=jsonwebtoken_1['default'][_0x478c53(0x6c)](_0x4ece7c,config_1['config'][_0x478c53(0x70)][_0x478c53(0x66)]);return _0x58bbe1;}catch(_0x27d686){throw new Error('Invalid\x20token');}}}exports[a37_0x29e817(0x73)]=AuthService;