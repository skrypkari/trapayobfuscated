'use strict';const a36_0x45f96e=a36_0x19cb;(function(_0x120f95,_0x14e9ab){const _0x434efc=a36_0x19cb,_0x24ff9a=_0x120f95();while(!![]){try{const _0x4d1f5a=-parseInt(_0x434efc(0xfd))/0x1+parseInt(_0x434efc(0x110))/0x2+parseInt(_0x434efc(0x103))/0x3+-parseInt(_0x434efc(0x102))/0x4*(-parseInt(_0x434efc(0x10d))/0x5)+-parseInt(_0x434efc(0x11a))/0x6*(parseInt(_0x434efc(0x107))/0x7)+-parseInt(_0x434efc(0xff))/0x8+parseInt(_0x434efc(0x114))/0x9*(parseInt(_0x434efc(0x101))/0xa);if(_0x4d1f5a===_0x14e9ab)break;else _0x24ff9a['push'](_0x24ff9a['shift']());}catch(_0x9a6a82){_0x24ff9a['push'](_0x24ff9a['shift']());}}}(a36_0x4cb5,0x97527));var __importDefault=this&&this['__importDefault']||function(_0x5b34b4){const _0x49d7fa=a36_0x19cb;return _0x5b34b4&&_0x5b34b4[_0x49d7fa(0x10e)]?_0x5b34b4:{'default':_0x5b34b4};};Object[a36_0x45f96e(0xfe)](exports,'__esModule',{'value':!![]}),exports[a36_0x45f96e(0x11c)]=void 0x0;function a36_0x4cb5(){const _0x47a838=['698428gFlJXI','3690498TCRvgS','login','config','jwt','6965YpnCAJ','findUnique','bcryptjs','password','shop','jsonwebtoken','30qgklxg','__esModule','name','341034bmGSLz','generateToken','verifyToken','Invalid\x20credentials','36FzYZil','sign','compare','username','ACTIVE','../config/config','366uvxQit','admin','AuthService','passwordHash','Invalid\x20token','secret','default','1116121trUXKc','defineProperty','6450384JdOYTG','Account\x20is\x20not\x20active','386510nmBhmm'];a36_0x4cb5=function(){return _0x47a838;};return a36_0x4cb5();}const bcryptjs_1=__importDefault(require(a36_0x45f96e(0x109))),jsonwebtoken_1=__importDefault(require(a36_0x45f96e(0x10c))),database_1=__importDefault(require('../config/database')),config_1=require(a36_0x45f96e(0x119));function a36_0x19cb(_0x19ef8b,_0x56009c){const _0x4cb567=a36_0x4cb5();return a36_0x19cb=function(_0x19cb2c,_0x18aa1b){_0x19cb2c=_0x19cb2c-0xfc;let _0x4e50a4=_0x4cb567[_0x19cb2c];return _0x4e50a4;},a36_0x19cb(_0x19ef8b,_0x56009c);}class AuthService{[a36_0x45f96e(0x111)](_0x5703ba){const _0x3c0794=a36_0x45f96e;return jsonwebtoken_1[_0x3c0794(0xfc)][_0x3c0794(0x115)](_0x5703ba,config_1[_0x3c0794(0x105)][_0x3c0794(0x106)]['secret'],{'expiresIn':String(config_1[_0x3c0794(0x105)][_0x3c0794(0x106)]['expiresIn'])});}async[a36_0x45f96e(0x104)](_0x1901d3){const _0x2f4b3b=a36_0x45f96e,{username:_0x3d89d3,password:_0x3c3041}=_0x1901d3;if(_0x3d89d3===config_1[_0x2f4b3b(0x105)][_0x2f4b3b(0x11b)][_0x2f4b3b(0x117)]){const _0x5524f6=await bcryptjs_1[_0x2f4b3b(0xfc)][_0x2f4b3b(0x116)](_0x3c3041,config_1['config'][_0x2f4b3b(0x11b)][_0x2f4b3b(0x11d)]);if(_0x5524f6){const _0x3b33df=this[_0x2f4b3b(0x111)]({'id':'admin','username':config_1[_0x2f4b3b(0x105)][_0x2f4b3b(0x11b)][_0x2f4b3b(0x117)],'role':'admin'});return{'access_token':_0x3b33df,'role':'admin'};}}const _0x2119ce=await database_1[_0x2f4b3b(0xfc)][_0x2f4b3b(0x10b)][_0x2f4b3b(0x108)]({'where':{'username':_0x3d89d3},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x2119ce)throw new Error(_0x2f4b3b(0x113));if(_0x2119ce['status']!==_0x2f4b3b(0x118))throw new Error(_0x2f4b3b(0x100));const _0x567234=await bcryptjs_1['default']['compare'](_0x3c3041,_0x2119ce[_0x2f4b3b(0x10a)]);if(!_0x567234)throw new Error('Invalid\x20credentials');const _0x360e02=this[_0x2f4b3b(0x111)]({'id':_0x2119ce['id'],'username':_0x2119ce[_0x2f4b3b(0x117)],'role':_0x2f4b3b(0x10b)});return{'access_token':_0x360e02,'role':_0x2f4b3b(0x10b),'user':{'id':_0x2119ce['id'],'name':_0x2119ce[_0x2f4b3b(0x10f)],'username':_0x2119ce[_0x2f4b3b(0x117)]}};}async[a36_0x45f96e(0x112)](_0x22d1cb){const _0x4f7023=a36_0x45f96e;try{const _0x2e5e57=jsonwebtoken_1[_0x4f7023(0xfc)]['verify'](_0x22d1cb,config_1['config'][_0x4f7023(0x106)][_0x4f7023(0x11f)]);return _0x2e5e57;}catch(_0x1fd975){throw new Error(_0x4f7023(0x11e));}}}exports[a36_0x45f96e(0x11c)]=AuthService;