'use strict';const a34_0x4386c2=a34_0xccad;(function(_0x2a81aa,_0x3984df){const _0x212185=a34_0xccad,_0x4507b7=_0x2a81aa();while(!![]){try{const _0x1f9d04=-parseInt(_0x212185(0xac))/0x1+-parseInt(_0x212185(0xbc))/0x2*(-parseInt(_0x212185(0xb2))/0x3)+parseInt(_0x212185(0xbb))/0x4*(parseInt(_0x212185(0xb9))/0x5)+-parseInt(_0x212185(0xc7))/0x6+-parseInt(_0x212185(0xb6))/0x7+-parseInt(_0x212185(0xc3))/0x8+parseInt(_0x212185(0xc9))/0x9*(parseInt(_0x212185(0xbf))/0xa);if(_0x1f9d04===_0x3984df)break;else _0x4507b7['push'](_0x4507b7['shift']());}catch(_0x4b68a5){_0x4507b7['push'](_0x4507b7['shift']());}}}(a34_0x45d1,0x74b91));var __importDefault=this&&this['__importDefault']||function(_0x381d39){return _0x381d39&&_0x381d39['__esModule']?_0x381d39:{'default':_0x381d39};};Object[a34_0x4386c2(0xbe)](exports,a34_0x4386c2(0xb5),{'value':!![]}),exports['AuthService']=void 0x0;function a34_0x45d1(){const _0x23226b=['ACTIVE','566526hxtQnn','../config/config','sign','secret','login','jwt','213MaAzab','verifyToken','config','__esModule','5309486syDjKa','name','findUnique','12865ZbFwYo','Invalid\x20credentials','1396aSWzpY','12224psyqeA','default','defineProperty','10JxhcJk','AuthService','username','expiresIn','1663920aGxNxy','Account\x20is\x20not\x20active','passwordHash','compare','1864290CmTnth','bcryptjs','8909073jlrPNW','admin','shop','jsonwebtoken','password','generateToken'];a34_0x45d1=function(){return _0x23226b;};return a34_0x45d1();}const bcryptjs_1=__importDefault(require(a34_0x4386c2(0xc8))),jsonwebtoken_1=__importDefault(require(a34_0x4386c2(0xcc))),database_1=__importDefault(require('../config/database')),config_1=require(a34_0x4386c2(0xad));class AuthService{[a34_0x4386c2(0xaa)](_0x2fb732){const _0x4463e9=a34_0x4386c2;return jsonwebtoken_1['default'][_0x4463e9(0xae)](_0x2fb732,config_1[_0x4463e9(0xb4)]['jwt'][_0x4463e9(0xaf)],{'expiresIn':String(config_1[_0x4463e9(0xb4)]['jwt'][_0x4463e9(0xc2)])});}async[a34_0x4386c2(0xb0)](_0x31996f){const _0x2edc9f=a34_0x4386c2,{username:_0x45eb63,password:_0x900757}=_0x31996f;if(_0x45eb63===config_1[_0x2edc9f(0xb4)][_0x2edc9f(0xca)]['username']){const _0x4bb8c8=await bcryptjs_1[_0x2edc9f(0xbd)][_0x2edc9f(0xc6)](_0x900757,config_1['config'][_0x2edc9f(0xca)][_0x2edc9f(0xc5)]);if(_0x4bb8c8){const _0x1cb894=this[_0x2edc9f(0xaa)]({'id':'admin','username':config_1['config']['admin'][_0x2edc9f(0xc1)],'role':_0x2edc9f(0xca)});return{'access_token':_0x1cb894,'role':'admin'};}}const _0x206bc5=await database_1[_0x2edc9f(0xbd)]['shop'][_0x2edc9f(0xb8)]({'where':{'username':_0x45eb63},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x206bc5)throw new Error(_0x2edc9f(0xba));if(_0x206bc5['status']!==_0x2edc9f(0xab))throw new Error(_0x2edc9f(0xc4));const _0x323cea=await bcryptjs_1['default'][_0x2edc9f(0xc6)](_0x900757,_0x206bc5[_0x2edc9f(0xcd)]);if(!_0x323cea)throw new Error(_0x2edc9f(0xba));const _0x51c084=this[_0x2edc9f(0xaa)]({'id':_0x206bc5['id'],'username':_0x206bc5[_0x2edc9f(0xc1)],'role':'shop'});return{'access_token':_0x51c084,'role':_0x2edc9f(0xcb),'user':{'id':_0x206bc5['id'],'name':_0x206bc5[_0x2edc9f(0xb7)],'username':_0x206bc5[_0x2edc9f(0xc1)]}};}async[a34_0x4386c2(0xb3)](_0xae8001){const _0x92e157=a34_0x4386c2;try{const _0x12e600=jsonwebtoken_1[_0x92e157(0xbd)]['verify'](_0xae8001,config_1[_0x92e157(0xb4)][_0x92e157(0xb1)][_0x92e157(0xaf)]);return _0x12e600;}catch(_0x217507){throw new Error('Invalid\x20token');}}}function a34_0xccad(_0x3ddd30,_0x167e21){const _0x45d100=a34_0x45d1();return a34_0xccad=function(_0xccad79,_0x1cb9db){_0xccad79=_0xccad79-0xaa;let _0x4c08dd=_0x45d100[_0xccad79];return _0x4c08dd;},a34_0xccad(_0x3ddd30,_0x167e21);}exports[a34_0x4386c2(0xc0)]=AuthService;