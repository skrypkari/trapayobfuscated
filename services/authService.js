'use strict';const a37_0x3d0d79=a37_0x5bfc;(function(_0x443c35,_0x41a105){const _0x490ca4=a37_0x5bfc,_0xdb1ae7=_0x443c35();while(!![]){try{const _0x408880=-parseInt(_0x490ca4(0x18a))/0x1*(-parseInt(_0x490ca4(0x17f))/0x2)+-parseInt(_0x490ca4(0x186))/0x3+-parseInt(_0x490ca4(0x180))/0x4*(parseInt(_0x490ca4(0x185))/0x5)+-parseInt(_0x490ca4(0x188))/0x6+-parseInt(_0x490ca4(0x197))/0x7+parseInt(_0x490ca4(0x18e))/0x8*(parseInt(_0x490ca4(0x17e))/0x9)+-parseInt(_0x490ca4(0x19e))/0xa*(-parseInt(_0x490ca4(0x181))/0xb);if(_0x408880===_0x41a105)break;else _0xdb1ae7['push'](_0xdb1ae7['shift']());}catch(_0x2a1d63){_0xdb1ae7['push'](_0xdb1ae7['shift']());}}}(a37_0x40c3,0xef6b5));function a37_0x40c3(){const _0x375867=['shop','login','secret','128biRSzA','Account\x20is\x20not\x20active','AuthService','status','verify','config','Invalid\x20token','../config/config','jwt','5804491dCdzXr','passwordHash','username','findUnique','default','password','verifyToken','4120660zGlDlC','admin','generateToken','ACTIVE','732663Xbqytk','1028914LucYqW','340lTzMxS','44rdbToL','name','Invalid\x20credentials','__esModule','56675QlfTsE','38850eRbbcI','../config/database','4073604FKiCeu','bcryptjs','1huAufr'];a37_0x40c3=function(){return _0x375867;};return a37_0x40c3();}function a37_0x5bfc(_0x3b7685,_0x987a3c){const _0x40c36f=a37_0x40c3();return a37_0x5bfc=function(_0x5bfc87,_0x53e449){_0x5bfc87=_0x5bfc87-0x17e;let _0x15324d=_0x40c36f[_0x5bfc87];return _0x15324d;},a37_0x5bfc(_0x3b7685,_0x987a3c);}var __importDefault=this&&this['__importDefault']||function(_0x52a098){return _0x52a098&&_0x52a098['__esModule']?_0x52a098:{'default':_0x52a098};};Object['defineProperty'](exports,a37_0x3d0d79(0x184),{'value':!![]}),exports[a37_0x3d0d79(0x190)]=void 0x0;const bcryptjs_1=__importDefault(require(a37_0x3d0d79(0x189))),jsonwebtoken_1=__importDefault(require('jsonwebtoken')),database_1=__importDefault(require(a37_0x3d0d79(0x187))),config_1=require(a37_0x3d0d79(0x195));class AuthService{[a37_0x3d0d79(0x1a0)](_0x4406e3){const _0x54518c=a37_0x3d0d79;return jsonwebtoken_1[_0x54518c(0x19b)]['sign'](_0x4406e3,config_1[_0x54518c(0x193)][_0x54518c(0x196)][_0x54518c(0x18d)],{'expiresIn':String(config_1[_0x54518c(0x193)][_0x54518c(0x196)]['expiresIn'])});}async[a37_0x3d0d79(0x18c)](_0x562040){const _0x14bcab=a37_0x3d0d79,{username:_0x2bc8d0,password:_0x28774c}=_0x562040;if(_0x2bc8d0===config_1[_0x14bcab(0x193)][_0x14bcab(0x19f)][_0x14bcab(0x199)]){const _0x8d6cbf=await bcryptjs_1[_0x14bcab(0x19b)]['compare'](_0x28774c,config_1[_0x14bcab(0x193)]['admin'][_0x14bcab(0x198)]);if(_0x8d6cbf){const _0x39d3a6=this[_0x14bcab(0x1a0)]({'id':'admin','username':config_1[_0x14bcab(0x193)][_0x14bcab(0x19f)][_0x14bcab(0x199)],'role':_0x14bcab(0x19f)});return{'access_token':_0x39d3a6,'role':_0x14bcab(0x19f)};}}const _0x546f93=await database_1[_0x14bcab(0x19b)][_0x14bcab(0x18b)][_0x14bcab(0x19a)]({'where':{'username':_0x2bc8d0},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x546f93)throw new Error(_0x14bcab(0x183));if(_0x546f93[_0x14bcab(0x191)]!==_0x14bcab(0x1a1))throw new Error(_0x14bcab(0x18f));const _0x5e9204=await bcryptjs_1[_0x14bcab(0x19b)]['compare'](_0x28774c,_0x546f93[_0x14bcab(0x19c)]);if(!_0x5e9204)throw new Error('Invalid\x20credentials');const _0x12c03d=this[_0x14bcab(0x1a0)]({'id':_0x546f93['id'],'username':_0x546f93[_0x14bcab(0x199)],'role':_0x14bcab(0x18b)});return{'access_token':_0x12c03d,'role':_0x14bcab(0x18b),'user':{'id':_0x546f93['id'],'name':_0x546f93[_0x14bcab(0x182)],'username':_0x546f93['username']}};}async[a37_0x3d0d79(0x19d)](_0xb4ce08){const _0x127e5f=a37_0x3d0d79;try{const _0x400b9c=jsonwebtoken_1['default'][_0x127e5f(0x192)](_0xb4ce08,config_1[_0x127e5f(0x193)][_0x127e5f(0x196)][_0x127e5f(0x18d)]);return _0x400b9c;}catch(_0x3745cc){throw new Error(_0x127e5f(0x194));}}}exports[a37_0x3d0d79(0x190)]=AuthService;