'use strict';function a41_0x53bf(_0x459b58,_0x3f2313){const _0x52cf2e=a41_0x52cf();return a41_0x53bf=function(_0x53bfb5,_0x5230c2){_0x53bfb5=_0x53bfb5-0x8c;let _0x40d4a9=_0x52cf2e[_0x53bfb5];return _0x40d4a9;},a41_0x53bf(_0x459b58,_0x3f2313);}const a41_0x11fbd3=a41_0x53bf;(function(_0x13b696,_0xa35b9c){const _0x584d6d=a41_0x53bf,_0xeab0ea=_0x13b696();while(!![]){try{const _0x3bc802=-parseInt(_0x584d6d(0xaa))/0x1*(-parseInt(_0x584d6d(0x90))/0x2)+parseInt(_0x584d6d(0xb2))/0x3*(-parseInt(_0x584d6d(0xa5))/0x4)+parseInt(_0x584d6d(0xa8))/0x5*(parseInt(_0x584d6d(0x8f))/0x6)+parseInt(_0x584d6d(0x96))/0x7+parseInt(_0x584d6d(0xa3))/0x8*(-parseInt(_0x584d6d(0xab))/0x9)+parseInt(_0x584d6d(0xa2))/0xa*(-parseInt(_0x584d6d(0xb0))/0xb)+parseInt(_0x584d6d(0xae))/0xc;if(_0x3bc802===_0xa35b9c)break;else _0xeab0ea['push'](_0xeab0ea['shift']());}catch(_0x56f1d4){_0xeab0ea['push'](_0xeab0ea['shift']());}}}(a41_0x52cf,0x36178));function a41_0x52cf(){const _0x1526c8=['compare','Invalid\x20credentials','name','passwordHash','__esModule','81305llekxG','jwt','ACTIVE','config','sign','Account\x20is\x20not\x20active','shop','defineProperty','../config/database','admin','secret','__importDefault','2750cYeief','180216JdwumK','default','5872MfBcHA','status','findUnique','1235RGTyEb','jsonwebtoken','1JsxWRG','153teHJgl','AuthService','login','1653204Xsvvnh','verify','5137uJkTUV','bcryptjs','102mnaUuz','password','verifyToken','username','6906FGpfpa','698354yorBah'];a41_0x52cf=function(){return _0x1526c8;};return a41_0x52cf();}var __importDefault=this&&this[a41_0x11fbd3(0xa1)]||function(_0xe36ed7){return _0xe36ed7&&_0xe36ed7['__esModule']?_0xe36ed7:{'default':_0xe36ed7};};Object[a41_0x11fbd3(0x9d)](exports,a41_0x11fbd3(0x95),{'value':!![]}),exports[a41_0x11fbd3(0xac)]=void 0x0;const bcryptjs_1=__importDefault(require(a41_0x11fbd3(0xb1))),jsonwebtoken_1=__importDefault(require(a41_0x11fbd3(0xa9))),database_1=__importDefault(require(a41_0x11fbd3(0x9e))),config_1=require('../config/config');class AuthService{['generateToken'](_0x15ed2c){const _0x4d84f4=a41_0x11fbd3;return jsonwebtoken_1['default'][_0x4d84f4(0x9a)](_0x15ed2c,config_1[_0x4d84f4(0x99)]['jwt'][_0x4d84f4(0xa0)],{'expiresIn':String(config_1[_0x4d84f4(0x99)][_0x4d84f4(0x97)]['expiresIn'])});}async[a41_0x11fbd3(0xad)](_0x51a41a){const _0x29135c=a41_0x11fbd3,{username:_0x4a057f,password:_0x22538f}=_0x51a41a;if(_0x4a057f===config_1[_0x29135c(0x99)][_0x29135c(0x9f)]['username']){const _0x3e2a02=await bcryptjs_1[_0x29135c(0xa4)][_0x29135c(0x91)](_0x22538f,config_1[_0x29135c(0x99)][_0x29135c(0x9f)][_0x29135c(0x94)]);if(_0x3e2a02){const _0x3408bf=this['generateToken']({'id':'admin','username':config_1[_0x29135c(0x99)][_0x29135c(0x9f)]['username'],'role':_0x29135c(0x9f)});return{'access_token':_0x3408bf,'role':'admin'};}}const _0x1a3304=await database_1[_0x29135c(0xa4)][_0x29135c(0x9c)][_0x29135c(0xa7)]({'where':{'username':_0x4a057f},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x1a3304)throw new Error(_0x29135c(0x92));if(_0x1a3304[_0x29135c(0xa6)]!==_0x29135c(0x98))throw new Error(_0x29135c(0x9b));const _0x3d5488=await bcryptjs_1[_0x29135c(0xa4)]['compare'](_0x22538f,_0x1a3304[_0x29135c(0x8c)]);if(!_0x3d5488)throw new Error(_0x29135c(0x92));const _0x4340be=this['generateToken']({'id':_0x1a3304['id'],'username':_0x1a3304[_0x29135c(0x8e)],'role':_0x29135c(0x9c)});return{'access_token':_0x4340be,'role':_0x29135c(0x9c),'user':{'id':_0x1a3304['id'],'name':_0x1a3304[_0x29135c(0x93)],'username':_0x1a3304[_0x29135c(0x8e)]}};}async[a41_0x11fbd3(0x8d)](_0x4b3a4f){const _0x343b56=a41_0x11fbd3;try{const _0x3921b4=jsonwebtoken_1[_0x343b56(0xa4)][_0x343b56(0xaf)](_0x4b3a4f,config_1[_0x343b56(0x99)][_0x343b56(0x97)][_0x343b56(0xa0)]);return _0x3921b4;}catch(_0x153b27){throw new Error('Invalid\x20token');}}}exports[a41_0x11fbd3(0xac)]=AuthService;