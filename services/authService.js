'use strict';function a37_0x4484(){const _0x56ecfc=['../config/database','verify','jwt','compare','username','572930KWTOPk','config','admin','Invalid\x20credentials','sign','defineProperty','login','passwordHash','name','__esModule','secret','2205628AipQLr','Account\x20is\x20not\x20active','shop','204LNkCwp','508013XGuVNz','10024nbRtCc','password','ACTIVE','865026YqtKpq','1058466QRLJYB','default','generateToken','jsonwebtoken','status','verifyToken','expiresIn','3818560ldDHHh'];a37_0x4484=function(){return _0x56ecfc;};return a37_0x4484();}const a37_0x194b56=a37_0x2f44;(function(_0x5891be,_0x539908){const _0x1dec2d=a37_0x2f44,_0x348eb6=_0x5891be();while(!![]){try{const _0x415fbc=-parseInt(_0x1dec2d(0xfe))/0x1+parseInt(_0x1dec2d(0x102))/0x2+parseInt(_0x1dec2d(0x103))/0x3+parseInt(_0x1dec2d(0xfa))/0x4+-parseInt(_0x1dec2d(0x110))/0x5+parseInt(_0x1dec2d(0xfd))/0x6*(parseInt(_0x1dec2d(0xff))/0x7)+-parseInt(_0x1dec2d(0x10a))/0x8;if(_0x415fbc===_0x539908)break;else _0x348eb6['push'](_0x348eb6['shift']());}catch(_0x223937){_0x348eb6['push'](_0x348eb6['shift']());}}}(a37_0x4484,0x45b47));var __importDefault=this&&this['__importDefault']||function(_0x123f75){const _0x5df4a4=a37_0x2f44;return _0x123f75&&_0x123f75[_0x5df4a4(0xf8)]?_0x123f75:{'default':_0x123f75};};Object[a37_0x194b56(0x115)](exports,a37_0x194b56(0xf8),{'value':!![]}),exports['AuthService']=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),jsonwebtoken_1=__importDefault(require(a37_0x194b56(0x106))),database_1=__importDefault(require(a37_0x194b56(0x10b))),config_1=require('../config/config');function a37_0x2f44(_0x8f9e1f,_0x17a865){const _0x448420=a37_0x4484();return a37_0x2f44=function(_0x2f44ba,_0x10e239){_0x2f44ba=_0x2f44ba-0xf8;let _0x273bea=_0x448420[_0x2f44ba];return _0x273bea;},a37_0x2f44(_0x8f9e1f,_0x17a865);}class AuthService{['generateToken'](_0x30fdb4){const _0x223747=a37_0x194b56;return jsonwebtoken_1['default'][_0x223747(0x114)](_0x30fdb4,config_1[_0x223747(0x111)][_0x223747(0x10d)][_0x223747(0xf9)],{'expiresIn':String(config_1['config']['jwt'][_0x223747(0x109)])});}async[a37_0x194b56(0x116)](_0x5ebf9a){const _0x24eeb0=a37_0x194b56,{username:_0x39c9b9,password:_0x4b4833}=_0x5ebf9a;if(_0x39c9b9===config_1[_0x24eeb0(0x111)][_0x24eeb0(0x112)][_0x24eeb0(0x10f)]){const _0x5aa9f5=await bcryptjs_1[_0x24eeb0(0x104)]['compare'](_0x4b4833,config_1[_0x24eeb0(0x111)][_0x24eeb0(0x112)][_0x24eeb0(0x117)]);if(_0x5aa9f5){const _0x2b663f=this[_0x24eeb0(0x105)]({'id':_0x24eeb0(0x112),'username':config_1['config'][_0x24eeb0(0x112)][_0x24eeb0(0x10f)],'role':'admin'});return{'access_token':_0x2b663f,'role':_0x24eeb0(0x112)};}}const _0x1a7853=await database_1[_0x24eeb0(0x104)][_0x24eeb0(0xfc)]['findUnique']({'where':{'username':_0x39c9b9},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x1a7853)throw new Error(_0x24eeb0(0x113));if(_0x1a7853[_0x24eeb0(0x107)]!==_0x24eeb0(0x101))throw new Error(_0x24eeb0(0xfb));const _0x3499fd=await bcryptjs_1[_0x24eeb0(0x104)][_0x24eeb0(0x10e)](_0x4b4833,_0x1a7853[_0x24eeb0(0x100)]);if(!_0x3499fd)throw new Error(_0x24eeb0(0x113));const _0x3e9207=this[_0x24eeb0(0x105)]({'id':_0x1a7853['id'],'username':_0x1a7853['username'],'role':_0x24eeb0(0xfc)});return{'access_token':_0x3e9207,'role':_0x24eeb0(0xfc),'user':{'id':_0x1a7853['id'],'name':_0x1a7853[_0x24eeb0(0x118)],'username':_0x1a7853[_0x24eeb0(0x10f)]}};}async[a37_0x194b56(0x108)](_0xc5621a){const _0x4ffd6e=a37_0x194b56;try{const _0x1ce146=jsonwebtoken_1['default'][_0x4ffd6e(0x10c)](_0xc5621a,config_1[_0x4ffd6e(0x111)]['jwt']['secret']);return _0x1ce146;}catch(_0x22aea4){throw new Error('Invalid\x20token');}}}exports['AuthService']=AuthService;