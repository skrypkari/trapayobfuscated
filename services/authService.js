'use strict';const a36_0x4ed647=a36_0x5547;(function(_0x3d0880,_0x40f8f1){const _0x27fe72=a36_0x5547,_0x25ef41=_0x3d0880();while(!![]){try{const _0x14148f=parseInt(_0x27fe72(0x12f))/0x1+-parseInt(_0x27fe72(0x121))/0x2+-parseInt(_0x27fe72(0x13a))/0x3+-parseInt(_0x27fe72(0x11f))/0x4+parseInt(_0x27fe72(0x11c))/0x5*(-parseInt(_0x27fe72(0x129))/0x6)+parseInt(_0x27fe72(0x12d))/0x7+parseInt(_0x27fe72(0x12c))/0x8*(parseInt(_0x27fe72(0x126))/0x9);if(_0x14148f===_0x40f8f1)break;else _0x25ef41['push'](_0x25ef41['shift']());}catch(_0x1ebfa7){_0x25ef41['push'](_0x25ef41['shift']());}}}(a36_0x49f3,0xe9ce7));var __importDefault=this&&this[a36_0x4ed647(0x130)]||function(_0x1fdc7f){const _0x42bc28=a36_0x4ed647;return _0x1fdc7f&&_0x1fdc7f[_0x42bc28(0x11a)]?_0x1fdc7f:{'default':_0x1fdc7f};};Object['defineProperty'](exports,a36_0x4ed647(0x11a),{'value':!![]}),exports['AuthService']=void 0x0;function a36_0x5547(_0x1764b4,_0x6be002){const _0x49f38c=a36_0x49f3();return a36_0x5547=function(_0x55475a,_0x2035aa){_0x55475a=_0x55475a-0x119;let _0x276a97=_0x49f38c[_0x55475a];return _0x276a97;},a36_0x5547(_0x1764b4,_0x6be002);}const bcryptjs_1=__importDefault(require(a36_0x4ed647(0x11d))),jsonwebtoken_1=__importDefault(require(a36_0x4ed647(0x122))),database_1=__importDefault(require(a36_0x4ed647(0x120))),config_1=require(a36_0x4ed647(0x11e));function a36_0x49f3(){const _0x4785e8=['config','admin','username','default','AuthService','passwordHash','compare','2044512ZBfaxP','verifyToken','name','sign','__esModule','jwt','155fwgcBD','bcryptjs','../config/config','1528408ZflWOY','../config/database','2547748Oneuwz','jsonwebtoken','Account\x20is\x20not\x20active','shop','findUnique','1719AjENBe','expiresIn','login','197502zsSsCy','generateToken','ACTIVE','114640ukfPzm','10870951dcPYxj','secret','25555GkapJQ','__importDefault','Invalid\x20credentials','status'];a36_0x49f3=function(){return _0x4785e8;};return a36_0x49f3();}class AuthService{[a36_0x4ed647(0x12a)](_0x59c7db){const _0x2d5043=a36_0x4ed647;return jsonwebtoken_1[_0x2d5043(0x136)][_0x2d5043(0x119)](_0x59c7db,config_1[_0x2d5043(0x133)][_0x2d5043(0x11b)]['secret'],{'expiresIn':String(config_1[_0x2d5043(0x133)][_0x2d5043(0x11b)][_0x2d5043(0x127)])});}async[a36_0x4ed647(0x128)](_0x3d3fc9){const _0x356981=a36_0x4ed647,{username:_0x5d867e,password:_0x4be3fe}=_0x3d3fc9;if(_0x5d867e===config_1[_0x356981(0x133)][_0x356981(0x134)]['username']){const _0x2b34d3=await bcryptjs_1[_0x356981(0x136)][_0x356981(0x139)](_0x4be3fe,config_1[_0x356981(0x133)][_0x356981(0x134)][_0x356981(0x138)]);if(_0x2b34d3){const _0x203691=this[_0x356981(0x12a)]({'id':_0x356981(0x134),'username':config_1[_0x356981(0x133)][_0x356981(0x134)][_0x356981(0x135)],'role':_0x356981(0x134)});return{'access_token':_0x203691,'role':_0x356981(0x134)};}}const _0x479078=await database_1[_0x356981(0x136)]['shop'][_0x356981(0x125)]({'where':{'username':_0x5d867e},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x479078)throw new Error(_0x356981(0x131));if(_0x479078[_0x356981(0x132)]!==_0x356981(0x12b))throw new Error(_0x356981(0x123));const _0x50d89a=await bcryptjs_1[_0x356981(0x136)][_0x356981(0x139)](_0x4be3fe,_0x479078['password']);if(!_0x50d89a)throw new Error('Invalid\x20credentials');const _0x8d8568=this[_0x356981(0x12a)]({'id':_0x479078['id'],'username':_0x479078['username'],'role':_0x356981(0x124)});return{'access_token':_0x8d8568,'role':_0x356981(0x124),'user':{'id':_0x479078['id'],'name':_0x479078[_0x356981(0x13c)],'username':_0x479078['username']}};}async[a36_0x4ed647(0x13b)](_0x55973b){const _0x22a4c2=a36_0x4ed647;try{const _0x4f839e=jsonwebtoken_1['default']['verify'](_0x55973b,config_1[_0x22a4c2(0x133)][_0x22a4c2(0x11b)][_0x22a4c2(0x12e)]);return _0x4f839e;}catch(_0x36a4f0){throw new Error('Invalid\x20token');}}}exports[a36_0x4ed647(0x137)]=AuthService;