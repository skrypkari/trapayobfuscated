'use strict';function a37_0x47cf(){const _0x5b8d90=['Account\x20is\x20not\x20active','297XHDVET','ACTIVE','shop','name','compare','verify','findUnique','Invalid\x20token','expiresIn','username','AuthService','passwordHash','config','secret','jwt','defineProperty','360202EvpxXO','bcryptjs','110590lXkPEA','password','default','357KLCBxF','38258vbeUeq','4308CsZAaW','4euYnZs','__esModule','verifyToken','Invalid\x20credentials','status','../config/config','1030734tbDIoy','generateToken','58180AWvVwv','admin','9294aVLADf','__importDefault','1329096oULFyM','sign','jsonwebtoken','36INNXsJ'];a37_0x47cf=function(){return _0x5b8d90;};return a37_0x47cf();}const a37_0x158b7e=a37_0x1b24;(function(_0x267cc2,_0x10ce35){const _0x3d9c6a=a37_0x1b24,_0x4f3592=_0x267cc2();while(!![]){try{const _0x5c62ab=parseInt(_0x3d9c6a(0x18d))/0x1*(-parseInt(_0x3d9c6a(0x185))/0x2)+-parseInt(_0x3d9c6a(0x193))/0x3+parseInt(_0x3d9c6a(0x173))/0x4*(-parseInt(_0x3d9c6a(0x195))/0x5)+-parseInt(_0x3d9c6a(0x197))/0x6*(parseInt(_0x3d9c6a(0x18a))/0x7)+parseInt(_0x3d9c6a(0x199))/0x8+-parseInt(_0x3d9c6a(0x175))/0x9*(-parseInt(_0x3d9c6a(0x187))/0xa)+parseInt(_0x3d9c6a(0x18b))/0xb*(parseInt(_0x3d9c6a(0x18c))/0xc);if(_0x5c62ab===_0x10ce35)break;else _0x4f3592['push'](_0x4f3592['shift']());}catch(_0xa69c0c){_0x4f3592['push'](_0x4f3592['shift']());}}}(a37_0x47cf,0x81e0d));var __importDefault=this&&this[a37_0x158b7e(0x198)]||function(_0x2fdef6){const _0x3d6957=a37_0x158b7e;return _0x2fdef6&&_0x2fdef6[_0x3d6957(0x18e)]?_0x2fdef6:{'default':_0x2fdef6};};Object[a37_0x158b7e(0x184)](exports,a37_0x158b7e(0x18e),{'value':!![]}),exports[a37_0x158b7e(0x17f)]=void 0x0;const bcryptjs_1=__importDefault(require(a37_0x158b7e(0x186))),jsonwebtoken_1=__importDefault(require(a37_0x158b7e(0x172))),database_1=__importDefault(require('../config/database')),config_1=require(a37_0x158b7e(0x192));function a37_0x1b24(_0xc28728,_0xded5c7){const _0x47cf23=a37_0x47cf();return a37_0x1b24=function(_0x1b2417,_0x16004d){_0x1b2417=_0x1b2417-0x171;let _0x58d97b=_0x47cf23[_0x1b2417];return _0x58d97b;},a37_0x1b24(_0xc28728,_0xded5c7);}class AuthService{['generateToken'](_0x3422a5){const _0x4b3d19=a37_0x158b7e;return jsonwebtoken_1[_0x4b3d19(0x189)][_0x4b3d19(0x171)](_0x3422a5,config_1[_0x4b3d19(0x181)]['jwt'][_0x4b3d19(0x182)],{'expiresIn':String(config_1[_0x4b3d19(0x181)][_0x4b3d19(0x183)][_0x4b3d19(0x17d)])});}async['login'](_0x2877a7){const _0x25c248=a37_0x158b7e,{username:_0x3a6279,password:_0x3f9a26}=_0x2877a7;if(_0x3a6279===config_1['config'][_0x25c248(0x196)][_0x25c248(0x17e)]){const _0x566bf9=await bcryptjs_1[_0x25c248(0x189)]['compare'](_0x3f9a26,config_1[_0x25c248(0x181)][_0x25c248(0x196)][_0x25c248(0x180)]);if(_0x566bf9){const _0x4b507b=this['generateToken']({'id':'admin','username':config_1['config']['admin'][_0x25c248(0x17e)],'role':'admin'});return{'access_token':_0x4b507b,'role':_0x25c248(0x196)};}}const _0x50fff2=await database_1[_0x25c248(0x189)][_0x25c248(0x177)][_0x25c248(0x17b)]({'where':{'username':_0x3a6279},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x50fff2)throw new Error(_0x25c248(0x190));if(_0x50fff2[_0x25c248(0x191)]!==_0x25c248(0x176))throw new Error(_0x25c248(0x174));const _0x4bf8fb=await bcryptjs_1['default'][_0x25c248(0x179)](_0x3f9a26,_0x50fff2[_0x25c248(0x188)]);if(!_0x4bf8fb)throw new Error(_0x25c248(0x190));const _0x177334=this[_0x25c248(0x194)]({'id':_0x50fff2['id'],'username':_0x50fff2[_0x25c248(0x17e)],'role':'shop'});return{'access_token':_0x177334,'role':_0x25c248(0x177),'user':{'id':_0x50fff2['id'],'name':_0x50fff2[_0x25c248(0x178)],'username':_0x50fff2[_0x25c248(0x17e)]}};}async[a37_0x158b7e(0x18f)](_0xfddf99){const _0x619c95=a37_0x158b7e;try{const _0x4b9332=jsonwebtoken_1[_0x619c95(0x189)][_0x619c95(0x17a)](_0xfddf99,config_1[_0x619c95(0x181)][_0x619c95(0x183)][_0x619c95(0x182)]);return _0x4b9332;}catch(_0x23d2b6){throw new Error(_0x619c95(0x17c));}}}exports[a37_0x158b7e(0x17f)]=AuthService;