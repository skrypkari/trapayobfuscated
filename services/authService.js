'use strict';const a47_0x13ce14=a47_0x3867;function a47_0x3867(_0x37a962,_0x377949){_0x37a962=_0x37a962-0x194;const _0x16c437=a47_0x16c4();let _0x386797=_0x16c437[_0x37a962];return _0x386797;}(function(_0x23104f,_0x47cf96){const _0x4ae25d=a47_0x3867,_0x25f8d0=_0x23104f();while(!![]){try{const _0x2038d1=parseInt(_0x4ae25d(0x1ad))/0x1+parseInt(_0x4ae25d(0x19e))/0x2*(-parseInt(_0x4ae25d(0x1b3))/0x3)+parseInt(_0x4ae25d(0x194))/0x4+parseInt(_0x4ae25d(0x1a7))/0x5+-parseInt(_0x4ae25d(0x199))/0x6+parseInt(_0x4ae25d(0x196))/0x7*(parseInt(_0x4ae25d(0x1a1))/0x8)+-parseInt(_0x4ae25d(0x1a5))/0x9;if(_0x2038d1===_0x47cf96)break;else _0x25f8d0['push'](_0x25f8d0['shift']());}catch(_0x11933a){_0x25f8d0['push'](_0x25f8d0['shift']());}}}(a47_0x16c4,0x37d66));var __importDefault=this&&this[a47_0x13ce14(0x1ab)]||function(_0x1a7c5b){return _0x1a7c5b&&_0x1a7c5b['__esModule']?_0x1a7c5b:{'default':_0x1a7c5b};};Object[a47_0x13ce14(0x195)](exports,a47_0x13ce14(0x1a0),{'value':!![]}),exports[a47_0x13ce14(0x1b0)]=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),jsonwebtoken_1=__importDefault(require('jsonwebtoken')),database_1=__importDefault(require('../config/database')),config_1=require(a47_0x13ce14(0x1a8));class AuthService{['generateToken'](_0x42e5d9){const _0x181e5d=a47_0x13ce14;return jsonwebtoken_1[_0x181e5d(0x19b)]['sign'](_0x42e5d9,config_1[_0x181e5d(0x1b1)][_0x181e5d(0x1ac)][_0x181e5d(0x197)],{'expiresIn':String(config_1['config'][_0x181e5d(0x1ac)][_0x181e5d(0x1a2)])});}async[a47_0x13ce14(0x19d)](_0x5e46e5){const _0x468a94=a47_0x13ce14,{username:_0x44d115,password:_0x1a1130}=_0x5e46e5;if(_0x44d115===config_1[_0x468a94(0x1b1)][_0x468a94(0x1a3)][_0x468a94(0x198)]){const _0x1e68f6=await bcryptjs_1[_0x468a94(0x19b)]['compare'](_0x1a1130,config_1['config']['admin']['passwordHash']);if(_0x1e68f6){const _0x12ba1d=this['generateToken']({'id':_0x468a94(0x1a3),'username':config_1[_0x468a94(0x1b1)][_0x468a94(0x1a3)]['username'],'role':_0x468a94(0x1a3)});return{'access_token':_0x12ba1d,'role':'admin'};}}const _0x246dc7=await database_1[_0x468a94(0x19b)][_0x468a94(0x1a4)][_0x468a94(0x1aa)]({'where':{'username':_0x44d115},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x246dc7)throw new Error(_0x468a94(0x19c));if(_0x246dc7[_0x468a94(0x1b2)]!=='ACTIVE')throw new Error(_0x468a94(0x1af));const _0x188d49=await bcryptjs_1[_0x468a94(0x19b)][_0x468a94(0x19f)](_0x1a1130,_0x246dc7[_0x468a94(0x1a9)]);if(!_0x188d49)throw new Error(_0x468a94(0x19c));const _0x123561=this[_0x468a94(0x1a6)]({'id':_0x246dc7['id'],'username':_0x246dc7[_0x468a94(0x198)],'role':'shop'});return{'access_token':_0x123561,'role':'shop','user':{'id':_0x246dc7['id'],'name':_0x246dc7[_0x468a94(0x19a)],'username':_0x246dc7[_0x468a94(0x198)]}};}async[a47_0x13ce14(0x1ae)](_0x482b6e){const _0x2fc864=a47_0x13ce14;try{const _0x4827e8=jsonwebtoken_1[_0x2fc864(0x19b)]['verify'](_0x482b6e,config_1['config'][_0x2fc864(0x1ac)][_0x2fc864(0x197)]);return _0x4827e8;}catch(_0x392855){throw new Error('Invalid\x20token');}}}function a47_0x16c4(){const _0x5f2e08=['2793352AHbGik','expiresIn','admin','shop','2913426GUprZT','generateToken','1166545aKZJlm','../config/config','password','findUnique','__importDefault','jwt','192955egMoIL','verifyToken','Account\x20is\x20not\x20active','AuthService','config','status','3Zvukvq','498348sRUdLy','defineProperty','7OoKatC','secret','username','780678qpsgQR','name','default','Invalid\x20credentials','login','434966iviEWb','compare','__esModule'];a47_0x16c4=function(){return _0x5f2e08;};return a47_0x16c4();}exports['AuthService']=AuthService;