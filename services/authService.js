'use strict';const a34_0x50a5b7=a34_0xdaa3;(function(_0x33fb85,_0x371248){const _0x5bc047=a34_0xdaa3,_0x7392a5=_0x33fb85();while(!![]){try{const _0x357251=-parseInt(_0x5bc047(0x11b))/0x1+-parseInt(_0x5bc047(0x117))/0x2*(parseInt(_0x5bc047(0x108))/0x3)+-parseInt(_0x5bc047(0x10d))/0x4*(-parseInt(_0x5bc047(0x115))/0x5)+parseInt(_0x5bc047(0x10f))/0x6+-parseInt(_0x5bc047(0x10a))/0x7+parseInt(_0x5bc047(0x113))/0x8+parseInt(_0x5bc047(0x105))/0x9;if(_0x357251===_0x371248)break;else _0x7392a5['push'](_0x7392a5['shift']());}catch(_0x58ac90){_0x7392a5['push'](_0x7392a5['shift']());}}}(a34_0x3d76,0x504e5));var __importDefault=this&&this[a34_0x50a5b7(0x11f)]||function(_0x269ae2){const _0x3036c8=a34_0x50a5b7;return _0x269ae2&&_0x269ae2[_0x3036c8(0x10c)]?_0x269ae2:{'default':_0x269ae2};};Object[a34_0x50a5b7(0x116)](exports,a34_0x50a5b7(0x10c),{'value':!![]}),exports[a34_0x50a5b7(0xff)]=void 0x0;function a34_0x3d76(){const _0x36dfde=['passwordHash','admin','443226GIKBuO','default','generateToken','compare','__importDefault','jsonwebtoken','AuthService','findUnique','password','verify','secret','../config/database','177948AkuzfH','jwt','sign','690726AxsAdP','username','4113095KVVRtr','verifyToken','__esModule','3164ewblPb','shop','2501424yKvBla','Invalid\x20credentials','Invalid\x20token','config','5031016PQjvpg','ACTIVE','3315OYSIRy','defineProperty','2AQMOnl','login'];a34_0x3d76=function(){return _0x36dfde;};return a34_0x3d76();}function a34_0xdaa3(_0x4be971,_0x5629b8){const _0x3d7638=a34_0x3d76();return a34_0xdaa3=function(_0xdaa389,_0x48e157){_0xdaa389=_0xdaa389-0xff;let _0x4ca552=_0x3d7638[_0xdaa389];return _0x4ca552;},a34_0xdaa3(_0x4be971,_0x5629b8);}const bcryptjs_1=__importDefault(require('bcryptjs')),jsonwebtoken_1=__importDefault(require(a34_0x50a5b7(0x120))),database_1=__importDefault(require(a34_0x50a5b7(0x104))),config_1=require('../config/config');class AuthService{['generateToken'](_0x1205ea){const _0x51c3ff=a34_0x50a5b7;return jsonwebtoken_1[_0x51c3ff(0x11c)][_0x51c3ff(0x107)](_0x1205ea,config_1[_0x51c3ff(0x112)][_0x51c3ff(0x106)][_0x51c3ff(0x103)],{'expiresIn':String(config_1[_0x51c3ff(0x112)][_0x51c3ff(0x106)]['expiresIn'])});}async[a34_0x50a5b7(0x118)](_0x1ea5cc){const _0x23efae=a34_0x50a5b7,{username:_0x859242,password:_0x126186}=_0x1ea5cc;if(_0x859242===config_1[_0x23efae(0x112)][_0x23efae(0x11a)][_0x23efae(0x109)]){const _0x1460a3=await bcryptjs_1[_0x23efae(0x11c)][_0x23efae(0x11e)](_0x126186,config_1[_0x23efae(0x112)][_0x23efae(0x11a)][_0x23efae(0x119)]);if(_0x1460a3){const _0x173ef1=this[_0x23efae(0x11d)]({'id':'admin','username':config_1[_0x23efae(0x112)][_0x23efae(0x11a)][_0x23efae(0x109)],'role':_0x23efae(0x11a)});return{'access_token':_0x173ef1,'role':'admin'};}}const _0x27af06=await database_1[_0x23efae(0x11c)][_0x23efae(0x10e)][_0x23efae(0x100)]({'where':{'username':_0x859242},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x27af06)throw new Error(_0x23efae(0x110));if(_0x27af06['status']!==_0x23efae(0x114))throw new Error('Account\x20is\x20not\x20active');const _0x4fc515=await bcryptjs_1[_0x23efae(0x11c)][_0x23efae(0x11e)](_0x126186,_0x27af06[_0x23efae(0x101)]);if(!_0x4fc515)throw new Error('Invalid\x20credentials');const _0x1783c2=this[_0x23efae(0x11d)]({'id':_0x27af06['id'],'username':_0x27af06[_0x23efae(0x109)],'role':_0x23efae(0x10e)});return{'access_token':_0x1783c2,'role':_0x23efae(0x10e),'user':{'id':_0x27af06['id'],'name':_0x27af06['name'],'username':_0x27af06['username']}};}async[a34_0x50a5b7(0x10b)](_0x118e24){const _0x5aa691=a34_0x50a5b7;try{const _0x5f0ee2=jsonwebtoken_1[_0x5aa691(0x11c)][_0x5aa691(0x102)](_0x118e24,config_1[_0x5aa691(0x112)][_0x5aa691(0x106)][_0x5aa691(0x103)]);return _0x5f0ee2;}catch(_0x8b3c34){throw new Error(_0x5aa691(0x111));}}}exports['AuthService']=AuthService;