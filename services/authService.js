'use strict';const a34_0x2f51b1=a34_0x319c;(function(_0x468302,_0x5055cb){const _0x55cce3=a34_0x319c,_0x533fbe=_0x468302();while(!![]){try{const _0x5c9c6a=-parseInt(_0x55cce3(0x103))/0x1+-parseInt(_0x55cce3(0xf6))/0x2+-parseInt(_0x55cce3(0x109))/0x3+-parseInt(_0x55cce3(0xfa))/0x4*(parseInt(_0x55cce3(0x10e))/0x5)+parseInt(_0x55cce3(0x100))/0x6+parseInt(_0x55cce3(0x114))/0x7*(-parseInt(_0x55cce3(0x10f))/0x8)+-parseInt(_0x55cce3(0xf3))/0x9*(-parseInt(_0x55cce3(0xf2))/0xa);if(_0x5c9c6a===_0x5055cb)break;else _0x533fbe['push'](_0x533fbe['shift']());}catch(_0x3cb4cb){_0x533fbe['push'](_0x533fbe['shift']());}}}(a34_0x2b47,0x60949));function a34_0x2b47(){const _0x368825=['../config/config','Invalid\x20credentials','282617sGgdXC','ACTIVE','passwordHash','default','__importDefault','expiresIn','883689leOYSk','defineProperty','shop','generateToken','login','1802270VupJCC','3447312JApZgL','verifyToken','verify','../config/database','name','7PRsoAz','Account\x20is\x20not\x20active','secret','7820DelUTK','15012bvDtPP','compare','Invalid\x20token','42366QCATTQ','jsonwebtoken','AuthService','jwt','4eTJRXd','config','admin','username','password','__esModule','2885688uZnjFq'];a34_0x2b47=function(){return _0x368825;};return a34_0x2b47();}var __importDefault=this&&this[a34_0x2f51b1(0x107)]||function(_0x2987e7){const _0x310a45=a34_0x2f51b1;return _0x2987e7&&_0x2987e7[_0x310a45(0xff)]?_0x2987e7:{'default':_0x2987e7};};Object[a34_0x2f51b1(0x10a)](exports,'__esModule',{'value':!![]}),exports['AuthService']=void 0x0;function a34_0x319c(_0x139ff6,_0x8da843){const _0x2b475a=a34_0x2b47();return a34_0x319c=function(_0x319ca6,_0x2ba0f4){_0x319ca6=_0x319ca6-0xf0;let _0x19d09d=_0x2b475a[_0x319ca6];return _0x19d09d;},a34_0x319c(_0x139ff6,_0x8da843);}const bcryptjs_1=__importDefault(require('bcryptjs')),jsonwebtoken_1=__importDefault(require(a34_0x2f51b1(0xf7))),database_1=__importDefault(require(a34_0x2f51b1(0x112))),config_1=require(a34_0x2f51b1(0x101));class AuthService{[a34_0x2f51b1(0x10c)](_0x34c543){const _0x4a63e9=a34_0x2f51b1;return jsonwebtoken_1[_0x4a63e9(0x106)]['sign'](_0x34c543,config_1[_0x4a63e9(0xfb)][_0x4a63e9(0xf9)][_0x4a63e9(0xf1)],{'expiresIn':String(config_1[_0x4a63e9(0xfb)]['jwt'][_0x4a63e9(0x108)])});}async[a34_0x2f51b1(0x10d)](_0x3da898){const _0x1bfdde=a34_0x2f51b1,{username:_0x230731,password:_0x2425ce}=_0x3da898;if(_0x230731===config_1[_0x1bfdde(0xfb)][_0x1bfdde(0xfc)]['username']){const _0x40c6f8=await bcryptjs_1[_0x1bfdde(0x106)][_0x1bfdde(0xf4)](_0x2425ce,config_1[_0x1bfdde(0xfb)][_0x1bfdde(0xfc)][_0x1bfdde(0x105)]);if(_0x40c6f8){const _0x253fe1=this[_0x1bfdde(0x10c)]({'id':_0x1bfdde(0xfc),'username':config_1[_0x1bfdde(0xfb)][_0x1bfdde(0xfc)]['username'],'role':'admin'});return{'access_token':_0x253fe1,'role':_0x1bfdde(0xfc)};}}const _0x1247c3=await database_1['default'][_0x1bfdde(0x10b)]['findUnique']({'where':{'username':_0x230731},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x1247c3)throw new Error(_0x1bfdde(0x102));if(_0x1247c3['status']!==_0x1bfdde(0x104))throw new Error(_0x1bfdde(0xf0));const _0x57cfa7=await bcryptjs_1[_0x1bfdde(0x106)]['compare'](_0x2425ce,_0x1247c3[_0x1bfdde(0xfe)]);if(!_0x57cfa7)throw new Error('Invalid\x20credentials');const _0x509bb8=this['generateToken']({'id':_0x1247c3['id'],'username':_0x1247c3[_0x1bfdde(0xfd)],'role':_0x1bfdde(0x10b)});return{'access_token':_0x509bb8,'role':_0x1bfdde(0x10b),'user':{'id':_0x1247c3['id'],'name':_0x1247c3[_0x1bfdde(0x113)],'username':_0x1247c3['username']}};}async[a34_0x2f51b1(0x110)](_0x5642ab){const _0x4fd05c=a34_0x2f51b1;try{const _0x29924e=jsonwebtoken_1['default'][_0x4fd05c(0x111)](_0x5642ab,config_1[_0x4fd05c(0xfb)]['jwt']['secret']);return _0x29924e;}catch(_0x318d97){throw new Error(_0x4fd05c(0xf5));}}}exports[a34_0x2f51b1(0xf8)]=AuthService;