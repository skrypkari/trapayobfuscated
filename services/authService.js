'use strict';const a37_0x21828c=a37_0x211e;(function(_0xfa4505,_0x10b540){const _0x849d07=a37_0x211e,_0x19081e=_0xfa4505();while(!![]){try{const _0x2a15bc=parseInt(_0x849d07(0x1a2))/0x1*(-parseInt(_0x849d07(0x1b1))/0x2)+-parseInt(_0x849d07(0x1aa))/0x3*(parseInt(_0x849d07(0x1b5))/0x4)+parseInt(_0x849d07(0x1ac))/0x5*(parseInt(_0x849d07(0x1a7))/0x6)+-parseInt(_0x849d07(0x1bb))/0x7*(parseInt(_0x849d07(0x1b6))/0x8)+parseInt(_0x849d07(0x1a3))/0x9*(-parseInt(_0x849d07(0x1b9))/0xa)+-parseInt(_0x849d07(0x1a8))/0xb*(parseInt(_0x849d07(0x1b4))/0xc)+parseInt(_0x849d07(0x1ba))/0xd;if(_0x2a15bc===_0x10b540)break;else _0x19081e['push'](_0x19081e['shift']());}catch(_0x5ae60c){_0x19081e['push'](_0x19081e['shift']());}}}(a37_0x1102,0xd77f0));var __importDefault=this&&this['__importDefault']||function(_0x30ff75){const _0x370536=a37_0x211e;return _0x30ff75&&_0x30ff75[_0x370536(0x1b0)]?_0x30ff75:{'default':_0x30ff75};};Object[a37_0x21828c(0x1af)](exports,a37_0x21828c(0x1b0),{'value':!![]}),exports[a37_0x21828c(0x1bd)]=void 0x0;const bcryptjs_1=__importDefault(require(a37_0x21828c(0x1c4))),jsonwebtoken_1=__importDefault(require('jsonwebtoken')),database_1=__importDefault(require(a37_0x21828c(0x1a0))),config_1=require(a37_0x21828c(0x1bf));function a37_0x211e(_0xcd5592,_0x4d2366){const _0x1102f8=a37_0x1102();return a37_0x211e=function(_0x211e29,_0x4ce6b6){_0x211e29=_0x211e29-0x19f;let _0x4b7fda=_0x1102f8[_0x211e29];return _0x4b7fda;},a37_0x211e(_0xcd5592,_0x4d2366);}function a37_0x1102(){const _0x15dabe=['10pRGxAB','43216290pYYrJx','232757PfvPoO','verify','AuthService','username','../config/config','Invalid\x20token','secret','Invalid\x20credentials','shop','bcryptjs','config','../config/database','jwt','219WXOgaQ','2617641SfaUFi','default','password','generateToken','1262016oHxnnf','498201jphZtn','verifyToken','1169559TFVufI','sign','40HnXIIN','Account\x20is\x20not\x20active','status','defineProperty','__esModule','7988loqBJs','compare','ACTIVE','60FkXCmE','12XbIXYA','376QTclMW','passwordHash','admin'];a37_0x1102=function(){return _0x15dabe;};return a37_0x1102();}class AuthService{['generateToken'](_0x2c243d){const _0x55ecf6=a37_0x21828c;return jsonwebtoken_1[_0x55ecf6(0x1a4)][_0x55ecf6(0x1ab)](_0x2c243d,config_1[_0x55ecf6(0x19f)][_0x55ecf6(0x1a1)][_0x55ecf6(0x1c1)],{'expiresIn':String(config_1[_0x55ecf6(0x19f)][_0x55ecf6(0x1a1)]['expiresIn'])});}async['login'](_0x44f8ee){const _0x4d4d65=a37_0x21828c,{username:_0x29cd96,password:_0x5b0fbd}=_0x44f8ee;if(_0x29cd96===config_1[_0x4d4d65(0x19f)]['admin'][_0x4d4d65(0x1be)]){const _0x2007d7=await bcryptjs_1['default'][_0x4d4d65(0x1b2)](_0x5b0fbd,config_1[_0x4d4d65(0x19f)]['admin'][_0x4d4d65(0x1b7)]);if(_0x2007d7){const _0x84ff5b=this['generateToken']({'id':_0x4d4d65(0x1b8),'username':config_1['config'][_0x4d4d65(0x1b8)][_0x4d4d65(0x1be)],'role':'admin'});return{'access_token':_0x84ff5b,'role':'admin'};}}const _0x536d85=await database_1[_0x4d4d65(0x1a4)]['shop']['findUnique']({'where':{'username':_0x29cd96},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x536d85)throw new Error('Invalid\x20credentials');if(_0x536d85[_0x4d4d65(0x1ae)]!==_0x4d4d65(0x1b3))throw new Error(_0x4d4d65(0x1ad));const _0x16b22f=await bcryptjs_1[_0x4d4d65(0x1a4)][_0x4d4d65(0x1b2)](_0x5b0fbd,_0x536d85[_0x4d4d65(0x1a5)]);if(!_0x16b22f)throw new Error(_0x4d4d65(0x1c2));const _0x31e734=this[_0x4d4d65(0x1a6)]({'id':_0x536d85['id'],'username':_0x536d85[_0x4d4d65(0x1be)],'role':_0x4d4d65(0x1c3)});return{'access_token':_0x31e734,'role':_0x4d4d65(0x1c3),'user':{'id':_0x536d85['id'],'name':_0x536d85['name'],'username':_0x536d85[_0x4d4d65(0x1be)]}};}async[a37_0x21828c(0x1a9)](_0x3a9a12){const _0x2e9404=a37_0x21828c;try{const _0x5d26fc=jsonwebtoken_1[_0x2e9404(0x1a4)][_0x2e9404(0x1bc)](_0x3a9a12,config_1[_0x2e9404(0x19f)][_0x2e9404(0x1a1)]['secret']);return _0x5d26fc;}catch(_0x2bdab0){throw new Error(_0x2e9404(0x1c0));}}}exports[a37_0x21828c(0x1bd)]=AuthService;