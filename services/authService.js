'use strict';const a36_0x4285ff=a36_0x4256;(function(_0x3465c6,_0x531e5d){const _0x621c08=a36_0x4256,_0x2358c3=_0x3465c6();while(!![]){try{const _0x14a444=parseInt(_0x621c08(0x1e5))/0x1+parseInt(_0x621c08(0x1e3))/0x2+parseInt(_0x621c08(0x1f9))/0x3+parseInt(_0x621c08(0x1eb))/0x4+parseInt(_0x621c08(0x1fd))/0x5+-parseInt(_0x621c08(0x1fa))/0x6+parseInt(_0x621c08(0x1e7))/0x7*(-parseInt(_0x621c08(0x1e8))/0x8);if(_0x14a444===_0x531e5d)break;else _0x2358c3['push'](_0x2358c3['shift']());}catch(_0x3712a7){_0x2358c3['push'](_0x2358c3['shift']());}}}(a36_0xb381,0x913f3));var __importDefault=this&&this[a36_0x4285ff(0x1fb)]||function(_0x1f5835){const _0x349094=a36_0x4285ff;return _0x1f5835&&_0x1f5835[_0x349094(0x1ef)]?_0x1f5835:{'default':_0x1f5835};};Object[a36_0x4285ff(0x1e4)](exports,a36_0x4285ff(0x1ef),{'value':!![]}),exports[a36_0x4285ff(0x203)]=void 0x0;function a36_0xb381(){const _0x11022a=['password','compare','Account\x20is\x20not\x20active','username','Invalid\x20token','config','bcryptjs','3280737fATTsl','489108LEjVDY','__importDefault','ACTIVE','1278660pwdrbx','shop','generateToken','default','status','jwt','AuthService','admin','1704240cSfZxt','defineProperty','996425NECdnZ','secret','24059KmtYqz','8504HtXdPt','login','expiresIn','4528496zlJvqr','name','passwordHash','sign','__esModule','../config/config','Invalid\x20credentials'];a36_0xb381=function(){return _0x11022a;};return a36_0xb381();}const bcryptjs_1=__importDefault(require(a36_0x4285ff(0x1f8))),jsonwebtoken_1=__importDefault(require('jsonwebtoken')),database_1=__importDefault(require('../config/database')),config_1=require(a36_0x4285ff(0x1f0));function a36_0x4256(_0x2b5ff8,_0x31a5b3){const _0xb381cd=a36_0xb381();return a36_0x4256=function(_0x4256bf,_0x55225d){_0x4256bf=_0x4256bf-0x1e2;let _0x5a284f=_0xb381cd[_0x4256bf];return _0x5a284f;},a36_0x4256(_0x2b5ff8,_0x31a5b3);}class AuthService{[a36_0x4285ff(0x1ff)](_0x4ff879){const _0x102c40=a36_0x4285ff;return jsonwebtoken_1[_0x102c40(0x200)][_0x102c40(0x1ee)](_0x4ff879,config_1[_0x102c40(0x1f7)][_0x102c40(0x202)][_0x102c40(0x1e6)],{'expiresIn':String(config_1[_0x102c40(0x1f7)][_0x102c40(0x202)][_0x102c40(0x1ea)])});}async[a36_0x4285ff(0x1e9)](_0x1b9501){const _0x6bf5a8=a36_0x4285ff,{username:_0x13bf17,password:_0x374adb}=_0x1b9501;if(_0x13bf17===config_1[_0x6bf5a8(0x1f7)][_0x6bf5a8(0x1e2)][_0x6bf5a8(0x1f5)]){const _0x1f1fba=await bcryptjs_1[_0x6bf5a8(0x200)][_0x6bf5a8(0x1f3)](_0x374adb,config_1[_0x6bf5a8(0x1f7)][_0x6bf5a8(0x1e2)][_0x6bf5a8(0x1ed)]);if(_0x1f1fba){const _0x8be98=this[_0x6bf5a8(0x1ff)]({'id':_0x6bf5a8(0x1e2),'username':config_1[_0x6bf5a8(0x1f7)][_0x6bf5a8(0x1e2)][_0x6bf5a8(0x1f5)],'role':_0x6bf5a8(0x1e2)});return{'access_token':_0x8be98,'role':_0x6bf5a8(0x1e2)};}}const _0x4cf59f=await database_1['default'][_0x6bf5a8(0x1fe)]['findUnique']({'where':{'username':_0x13bf17},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x4cf59f)throw new Error(_0x6bf5a8(0x1f1));if(_0x4cf59f[_0x6bf5a8(0x201)]!==_0x6bf5a8(0x1fc))throw new Error(_0x6bf5a8(0x1f4));const _0x45f18b=await bcryptjs_1[_0x6bf5a8(0x200)]['compare'](_0x374adb,_0x4cf59f[_0x6bf5a8(0x1f2)]);if(!_0x45f18b)throw new Error(_0x6bf5a8(0x1f1));const _0x2df7ae=this[_0x6bf5a8(0x1ff)]({'id':_0x4cf59f['id'],'username':_0x4cf59f[_0x6bf5a8(0x1f5)],'role':_0x6bf5a8(0x1fe)});return{'access_token':_0x2df7ae,'role':_0x6bf5a8(0x1fe),'user':{'id':_0x4cf59f['id'],'name':_0x4cf59f[_0x6bf5a8(0x1ec)],'username':_0x4cf59f[_0x6bf5a8(0x1f5)]}};}async['verifyToken'](_0x1709aa){const _0x5ca37a=a36_0x4285ff;try{const _0x2c7ca9=jsonwebtoken_1[_0x5ca37a(0x200)]['verify'](_0x1709aa,config_1['config'][_0x5ca37a(0x202)][_0x5ca37a(0x1e6)]);return _0x2c7ca9;}catch(_0x188015){throw new Error(_0x5ca37a(0x1f6));}}}exports['AuthService']=AuthService;