'use strict';function a49_0x1a0c(_0x1a4139,_0x231b6a){_0x1a4139=_0x1a4139-0xd4;const _0x45110b=a49_0x4511();let _0x1a0cc2=_0x45110b[_0x1a4139];return _0x1a0cc2;}const a49_0xbdc358=a49_0x1a0c;(function(_0x4eac01,_0x53328e){const _0xc8a64f=a49_0x1a0c,_0xb4a8eb=_0x4eac01();while(!![]){try{const _0x4d38e6=-parseInt(_0xc8a64f(0xe3))/0x1+-parseInt(_0xc8a64f(0xf9))/0x2*(-parseInt(_0xc8a64f(0xd8))/0x3)+parseInt(_0xc8a64f(0xf2))/0x4*(-parseInt(_0xc8a64f(0xe7))/0x5)+parseInt(_0xc8a64f(0xe8))/0x6*(-parseInt(_0xc8a64f(0xdf))/0x7)+-parseInt(_0xc8a64f(0xd6))/0x8+parseInt(_0xc8a64f(0xd7))/0x9*(-parseInt(_0xc8a64f(0xdc))/0xa)+parseInt(_0xc8a64f(0xe5))/0xb;if(_0x4d38e6===_0x53328e)break;else _0xb4a8eb['push'](_0xb4a8eb['shift']());}catch(_0x4a3f57){_0xb4a8eb['push'](_0xb4a8eb['shift']());}}}(a49_0x4511,0xb732a));var __importDefault=this&&this['__importDefault']||function(_0xb70191){const _0x1af587=a49_0x1a0c;return _0xb70191&&_0xb70191[_0x1af587(0xd5)]?_0xb70191:{'default':_0xb70191};};function a49_0x4511(){const _0x38efdd=['157962ydLwfc','sign','verifyToken','status','config','jsonwebtoken','defineProperty','generateToken','../config/database','secret','344qwjiSg','name','shop','verify','AuthService','Account\x20is\x20not\x20active','../config/config','10yqyqqA','findUnique','password','__esModule','7178512QUtZvh','2956122DZmkGF','815730EmqcBz','jwt','bcryptjs','passwordHash','10DGRfbq','Invalid\x20credentials','admin','49RYikiw','default','expiresIn','Invalid\x20token','1389465oevoqK','ACTIVE','27449356GsCKeS','username','17735PjUlzT'];a49_0x4511=function(){return _0x38efdd;};return a49_0x4511();}Object[a49_0xbdc358(0xee)](exports,'__esModule',{'value':!![]}),exports[a49_0xbdc358(0xf6)]=void 0x0;const bcryptjs_1=__importDefault(require(a49_0xbdc358(0xda))),jsonwebtoken_1=__importDefault(require(a49_0xbdc358(0xed))),database_1=__importDefault(require(a49_0xbdc358(0xf0))),config_1=require(a49_0xbdc358(0xf8));class AuthService{['generateToken'](_0x1336b6){const _0x1ac9cf=a49_0xbdc358;return jsonwebtoken_1['default'][_0x1ac9cf(0xe9)](_0x1336b6,config_1[_0x1ac9cf(0xec)][_0x1ac9cf(0xd9)]['secret'],{'expiresIn':String(config_1[_0x1ac9cf(0xec)][_0x1ac9cf(0xd9)][_0x1ac9cf(0xe1)])});}async['login'](_0x338ff3){const _0x3d4717=a49_0xbdc358,{username:_0x4349ce,password:_0x3a116e}=_0x338ff3;if(_0x4349ce===config_1[_0x3d4717(0xec)][_0x3d4717(0xde)]['username']){const _0x1694c9=await bcryptjs_1[_0x3d4717(0xe0)]['compare'](_0x3a116e,config_1[_0x3d4717(0xec)][_0x3d4717(0xde)][_0x3d4717(0xdb)]);if(_0x1694c9){const _0x354281=this[_0x3d4717(0xef)]({'id':_0x3d4717(0xde),'username':config_1['config'][_0x3d4717(0xde)]['username'],'role':_0x3d4717(0xde)});return{'access_token':_0x354281,'role':_0x3d4717(0xde)};}}const _0x1ac503=await database_1['default'][_0x3d4717(0xf4)][_0x3d4717(0xfa)]({'where':{'username':_0x4349ce},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x1ac503)throw new Error(_0x3d4717(0xdd));if(_0x1ac503[_0x3d4717(0xeb)]!==_0x3d4717(0xe4))throw new Error(_0x3d4717(0xf7));const _0x59556e=await bcryptjs_1[_0x3d4717(0xe0)]['compare'](_0x3a116e,_0x1ac503[_0x3d4717(0xd4)]);if(!_0x59556e)throw new Error(_0x3d4717(0xdd));const _0x5b13b8=this[_0x3d4717(0xef)]({'id':_0x1ac503['id'],'username':_0x1ac503[_0x3d4717(0xe6)],'role':'shop'});return{'access_token':_0x5b13b8,'role':'shop','user':{'id':_0x1ac503['id'],'name':_0x1ac503[_0x3d4717(0xf3)],'username':_0x1ac503[_0x3d4717(0xe6)]}};}async[a49_0xbdc358(0xea)](_0x117860){const _0xb1a6c9=a49_0xbdc358;try{const _0x32a50c=jsonwebtoken_1['default'][_0xb1a6c9(0xf5)](_0x117860,config_1[_0xb1a6c9(0xec)][_0xb1a6c9(0xd9)][_0xb1a6c9(0xf1)]);return _0x32a50c;}catch(_0x548874){throw new Error(_0xb1a6c9(0xe2));}}}exports[a49_0xbdc358(0xf6)]=AuthService;