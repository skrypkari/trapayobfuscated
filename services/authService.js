'use strict';const a49_0x196ed9=a49_0x3555;function a49_0x3555(_0x1078d9,_0x15ef08){_0x1078d9=_0x1078d9-0x1d5;const _0x5bf541=a49_0x5bf5();let _0x35557c=_0x5bf541[_0x1078d9];return _0x35557c;}function a49_0x5bf5(){const _0x4d5a00=['1069618nrMedd','28ffywjF','Account\x20is\x20not\x20active','jwt','default','admin','Invalid\x20token','shop','AuthService','888VyyyBQ','16890894IusGcy','passwordHash','bcryptjs','secret','generateToken','password','compare','defineProperty','__esModule','login','../config/database','username','2812302UkCLyM','202551hijeBO','expiresIn','jsonwebtoken','Invalid\x20credentials','__importDefault','sign','name','verify','findUnique','31437boNfOg','2485325SigTxA','config','status','112107iQeJKD'];a49_0x5bf5=function(){return _0x4d5a00;};return a49_0x5bf5();}(function(_0x4be92e,_0x1e863f){const _0x5375b6=a49_0x3555,_0x47b110=_0x4be92e();while(!![]){try{const _0xb1efad=-parseInt(_0x5375b6(0x1de))/0x1+-parseInt(_0x5375b6(0x1ec))/0x2+-parseInt(_0x5375b6(0x1eb))/0x3*(parseInt(_0x5375b6(0x1ed))/0x4)+-parseInt(_0x5375b6(0x1e8))/0x5+-parseInt(_0x5375b6(0x1dd))/0x6+parseInt(_0x5375b6(0x1e7))/0x7*(parseInt(_0x5375b6(0x1f5))/0x8)+parseInt(_0x5375b6(0x1f6))/0x9;if(_0xb1efad===_0x1e863f)break;else _0x47b110['push'](_0x47b110['shift']());}catch(_0x4d3018){_0x47b110['push'](_0x47b110['shift']());}}}(a49_0x5bf5,0x643ae));var __importDefault=this&&this[a49_0x196ed9(0x1e2)]||function(_0x2e1f83){const _0x408eda=a49_0x196ed9;return _0x2e1f83&&_0x2e1f83[_0x408eda(0x1d9)]?_0x2e1f83:{'default':_0x2e1f83};};Object[a49_0x196ed9(0x1d8)](exports,a49_0x196ed9(0x1d9),{'value':!![]}),exports['AuthService']=void 0x0;const bcryptjs_1=__importDefault(require(a49_0x196ed9(0x1f8))),jsonwebtoken_1=__importDefault(require(a49_0x196ed9(0x1e0))),database_1=__importDefault(require(a49_0x196ed9(0x1db))),config_1=require('../config/config');class AuthService{[a49_0x196ed9(0x1d5)](_0x3e3b2b){const _0x1a0cca=a49_0x196ed9;return jsonwebtoken_1['default'][_0x1a0cca(0x1e3)](_0x3e3b2b,config_1[_0x1a0cca(0x1e9)][_0x1a0cca(0x1ef)][_0x1a0cca(0x1f9)],{'expiresIn':String(config_1[_0x1a0cca(0x1e9)][_0x1a0cca(0x1ef)][_0x1a0cca(0x1df)])});}async[a49_0x196ed9(0x1da)](_0x327a51){const _0x46a998=a49_0x196ed9,{username:_0x3e7619,password:_0x20b2b2}=_0x327a51;if(_0x3e7619===config_1['config'][_0x46a998(0x1f1)]['username']){const _0x2081c1=await bcryptjs_1[_0x46a998(0x1f0)][_0x46a998(0x1d7)](_0x20b2b2,config_1[_0x46a998(0x1e9)][_0x46a998(0x1f1)][_0x46a998(0x1f7)]);if(_0x2081c1){const _0x365fd6=this['generateToken']({'id':_0x46a998(0x1f1),'username':config_1[_0x46a998(0x1e9)][_0x46a998(0x1f1)][_0x46a998(0x1dc)],'role':_0x46a998(0x1f1)});return{'access_token':_0x365fd6,'role':'admin'};}}const _0x439687=await database_1['default']['shop'][_0x46a998(0x1e6)]({'where':{'username':_0x3e7619},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x439687)throw new Error('Invalid\x20credentials');if(_0x439687[_0x46a998(0x1ea)]!=='ACTIVE')throw new Error(_0x46a998(0x1ee));const _0x4ab05a=await bcryptjs_1[_0x46a998(0x1f0)]['compare'](_0x20b2b2,_0x439687[_0x46a998(0x1d6)]);if(!_0x4ab05a)throw new Error(_0x46a998(0x1e1));const _0x5c82e7=this[_0x46a998(0x1d5)]({'id':_0x439687['id'],'username':_0x439687[_0x46a998(0x1dc)],'role':_0x46a998(0x1f3)});return{'access_token':_0x5c82e7,'role':'shop','user':{'id':_0x439687['id'],'name':_0x439687[_0x46a998(0x1e4)],'username':_0x439687['username']}};}async['verifyToken'](_0x51437a){const _0x19c57e=a49_0x196ed9;try{const _0x3e6d1c=jsonwebtoken_1[_0x19c57e(0x1f0)][_0x19c57e(0x1e5)](_0x51437a,config_1[_0x19c57e(0x1e9)][_0x19c57e(0x1ef)][_0x19c57e(0x1f9)]);return _0x3e6d1c;}catch(_0x3ad10f){throw new Error(_0x19c57e(0x1f2));}}}exports[a49_0x196ed9(0x1f4)]=AuthService;