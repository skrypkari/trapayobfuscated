'use strict';const a41_0x4fa6ab=a41_0x10d4;(function(_0x4a71cf,_0x57a242){const _0x5d34bc=a41_0x10d4,_0x20275=_0x4a71cf();while(!![]){try{const _0x3737b5=parseInt(_0x5d34bc(0x1e6))/0x1+-parseInt(_0x5d34bc(0x1d0))/0x2+-parseInt(_0x5d34bc(0x1cb))/0x3*(parseInt(_0x5d34bc(0x1e3))/0x4)+parseInt(_0x5d34bc(0x1e8))/0x5*(parseInt(_0x5d34bc(0x1ea))/0x6)+-parseInt(_0x5d34bc(0x1df))/0x7*(-parseInt(_0x5d34bc(0x1cf))/0x8)+parseInt(_0x5d34bc(0x1d4))/0x9+-parseInt(_0x5d34bc(0x1ca))/0xa;if(_0x3737b5===_0x57a242)break;else _0x20275['push'](_0x20275['shift']());}catch(_0x5ac50d){_0x20275['push'](_0x20275['shift']());}}}(a41_0x267c,0x922c3));function a41_0x10d4(_0x60eff9,_0x277a7a){const _0x267c43=a41_0x267c();return a41_0x10d4=function(_0x10d488,_0x3514f0){_0x10d488=_0x10d488-0x1c9;let _0x62fc5c=_0x267c43[_0x10d488];return _0x62fc5c;},a41_0x10d4(_0x60eff9,_0x277a7a);}var __importDefault=this&&this[a41_0x4fa6ab(0x1dd)]||function(_0x330008){const _0x7dd21a=a41_0x4fa6ab;return _0x330008&&_0x330008[_0x7dd21a(0x1d1)]?_0x330008:{'default':_0x330008};};Object[a41_0x4fa6ab(0x1c9)](exports,a41_0x4fa6ab(0x1d1),{'value':!![]}),exports['AuthService']=void 0x0;function a41_0x267c(){const _0x5eb544=['AuthService','passwordHash','admin','10584tOGAhc','2324380KkpzFr','__esModule','compare','username','10523232rOcWeL','../config/config','status','default','shop','verifyToken','Invalid\x20credentials','verify','bcryptjs','__importDefault','findUnique','1939xUJbYp','config','login','secret','2716136NvOotW','generateToken','Invalid\x20token','841887OPejsv','name','14665FwvYow','jwt','1506qqEilk','defineProperty','6738420fvgUmC','3jUnHlW'];a41_0x267c=function(){return _0x5eb544;};return a41_0x267c();}const bcryptjs_1=__importDefault(require(a41_0x4fa6ab(0x1dc))),jsonwebtoken_1=__importDefault(require('jsonwebtoken')),database_1=__importDefault(require('../config/database')),config_1=require(a41_0x4fa6ab(0x1d5));class AuthService{['generateToken'](_0x8b2652){const _0x597869=a41_0x4fa6ab;return jsonwebtoken_1[_0x597869(0x1d7)]['sign'](_0x8b2652,config_1['config'][_0x597869(0x1e9)][_0x597869(0x1e2)],{'expiresIn':String(config_1[_0x597869(0x1e0)][_0x597869(0x1e9)]['expiresIn'])});}async[a41_0x4fa6ab(0x1e1)](_0x273353){const _0x534439=a41_0x4fa6ab,{username:_0x4ea06c,password:_0x30c2b7}=_0x273353;if(_0x4ea06c===config_1[_0x534439(0x1e0)][_0x534439(0x1ce)][_0x534439(0x1d3)]){const _0x2e7504=await bcryptjs_1['default']['compare'](_0x30c2b7,config_1[_0x534439(0x1e0)]['admin'][_0x534439(0x1cd)]);if(_0x2e7504){const _0x5b34fc=this['generateToken']({'id':'admin','username':config_1[_0x534439(0x1e0)][_0x534439(0x1ce)]['username'],'role':_0x534439(0x1ce)});return{'access_token':_0x5b34fc,'role':_0x534439(0x1ce)};}}const _0x127559=await database_1[_0x534439(0x1d7)]['shop'][_0x534439(0x1de)]({'where':{'username':_0x4ea06c},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x127559)throw new Error(_0x534439(0x1da));if(_0x127559[_0x534439(0x1d6)]!=='ACTIVE')throw new Error('Account\x20is\x20not\x20active');const _0x1ad6b6=await bcryptjs_1[_0x534439(0x1d7)][_0x534439(0x1d2)](_0x30c2b7,_0x127559['password']);if(!_0x1ad6b6)throw new Error('Invalid\x20credentials');const _0xa6ba1b=this[_0x534439(0x1e4)]({'id':_0x127559['id'],'username':_0x127559[_0x534439(0x1d3)],'role':_0x534439(0x1d8)});return{'access_token':_0xa6ba1b,'role':'shop','user':{'id':_0x127559['id'],'name':_0x127559[_0x534439(0x1e7)],'username':_0x127559['username']}};}async[a41_0x4fa6ab(0x1d9)](_0xc990ad){const _0x149b56=a41_0x4fa6ab;try{const _0x24eb5f=jsonwebtoken_1[_0x149b56(0x1d7)][_0x149b56(0x1db)](_0xc990ad,config_1[_0x149b56(0x1e0)][_0x149b56(0x1e9)][_0x149b56(0x1e2)]);return _0x24eb5f;}catch(_0x34f001){throw new Error(_0x149b56(0x1e5));}}}exports[a41_0x4fa6ab(0x1cc)]=AuthService;