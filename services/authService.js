'use strict';const a36_0x32c950=a36_0x1e40;(function(_0x157a5e,_0x159123){const _0x153370=a36_0x1e40,_0x75beed=_0x157a5e();while(!![]){try{const _0x4be9db=parseInt(_0x153370(0x10c))/0x1*(parseInt(_0x153370(0x12b))/0x2)+-parseInt(_0x153370(0x12d))/0x3+-parseInt(_0x153370(0x117))/0x4*(-parseInt(_0x153370(0x111))/0x5)+-parseInt(_0x153370(0x11f))/0x6*(-parseInt(_0x153370(0x113))/0x7)+-parseInt(_0x153370(0x121))/0x8+parseInt(_0x153370(0x12a))/0x9*(-parseInt(_0x153370(0x116))/0xa)+-parseInt(_0x153370(0x10a))/0xb;if(_0x4be9db===_0x159123)break;else _0x75beed['push'](_0x75beed['shift']());}catch(_0x25fee4){_0x75beed['push'](_0x75beed['shift']());}}}(a36_0x4cfb,0x64d19));var __importDefault=this&&this['__importDefault']||function(_0x4f0522){const _0xa4ab19=a36_0x1e40;return _0x4f0522&&_0x4f0522[_0xa4ab19(0x12f)]?_0x4f0522:{'default':_0x4f0522};};Object[a36_0x32c950(0x12e)](exports,a36_0x32c950(0x12f),{'value':!![]}),exports['AuthService']=void 0x0;const bcryptjs_1=__importDefault(require(a36_0x32c950(0x11b))),jsonwebtoken_1=__importDefault(require(a36_0x32c950(0x129))),database_1=__importDefault(require(a36_0x32c950(0x109))),config_1=require(a36_0x32c950(0x11e));class AuthService{[a36_0x32c950(0x115)](_0x4f8852){const _0x19c9dc=a36_0x32c950;return jsonwebtoken_1[_0x19c9dc(0x130)][_0x19c9dc(0x10e)](_0x4f8852,config_1[_0x19c9dc(0x10f)][_0x19c9dc(0x10b)]['secret'],{'expiresIn':String(config_1[_0x19c9dc(0x10f)][_0x19c9dc(0x10b)][_0x19c9dc(0x11a)])});}async[a36_0x32c950(0x114)](_0x5613d4){const _0x3b24f0=a36_0x32c950,{username:_0x96c7d,password:_0x22c3cb}=_0x5613d4;if(_0x96c7d===config_1[_0x3b24f0(0x10f)][_0x3b24f0(0x125)][_0x3b24f0(0x12c)]){const _0x2141d1=await bcryptjs_1['default']['compare'](_0x22c3cb,config_1['config'][_0x3b24f0(0x125)][_0x3b24f0(0x119)]);if(_0x2141d1){const _0x5537f1=this[_0x3b24f0(0x115)]({'id':_0x3b24f0(0x125),'username':config_1[_0x3b24f0(0x10f)]['admin']['username'],'role':'admin'});return{'access_token':_0x5537f1,'role':'admin'};}}const _0x5cbc66=await database_1[_0x3b24f0(0x130)]['shop'][_0x3b24f0(0x110)]({'where':{'username':_0x96c7d},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x5cbc66)throw new Error(_0x3b24f0(0x120));if(_0x5cbc66[_0x3b24f0(0x10d)]!=='ACTIVE')throw new Error(_0x3b24f0(0x127));const _0x337f75=await bcryptjs_1[_0x3b24f0(0x130)][_0x3b24f0(0x128)](_0x22c3cb,_0x5cbc66[_0x3b24f0(0x126)]);if(!_0x337f75)throw new Error(_0x3b24f0(0x120));const _0x3e82f8=this['generateToken']({'id':_0x5cbc66['id'],'username':_0x5cbc66[_0x3b24f0(0x12c)],'role':_0x3b24f0(0x11c)});return{'access_token':_0x3e82f8,'role':_0x3b24f0(0x11c),'user':{'id':_0x5cbc66['id'],'name':_0x5cbc66[_0x3b24f0(0x118)],'username':_0x5cbc66[_0x3b24f0(0x12c)]}};}async[a36_0x32c950(0x124)](_0x1adc34){const _0x469176=a36_0x32c950;try{const _0x2d1369=jsonwebtoken_1[_0x469176(0x130)][_0x469176(0x11d)](_0x1adc34,config_1[_0x469176(0x10f)]['jwt'][_0x469176(0x112)]);return _0x2d1369;}catch(_0x1aafdb){throw new Error(_0x469176(0x122));}}}function a36_0x1e40(_0x28274c,_0x3c7619){const _0x4cfb1f=a36_0x4cfb();return a36_0x1e40=function(_0x1e40a3,_0x1ab042){_0x1e40a3=_0x1e40a3-0x109;let _0x2af36d=_0x4cfb1f[_0x1e40a3];return _0x2af36d;},a36_0x1e40(_0x28274c,_0x3c7619);}function a36_0x4cfb(){const _0x5db439=['jsonwebtoken','713367gjNqYR','174nuDeaZ','username','414rItwYA','defineProperty','__esModule','default','../config/database','1201827gsAdXh','jwt','2386KXBuPZ','status','sign','config','findUnique','890EPeqsQ','secret','163289uMiZQx','login','generateToken','70qSQXxP','11240MsuwnF','name','passwordHash','expiresIn','bcryptjs','shop','verify','../config/config','102OZWlKQ','Invalid\x20credentials','217056MjWbuL','Invalid\x20token','AuthService','verifyToken','admin','password','Account\x20is\x20not\x20active','compare'];a36_0x4cfb=function(){return _0x5db439;};return a36_0x4cfb();}exports[a36_0x32c950(0x123)]=AuthService;