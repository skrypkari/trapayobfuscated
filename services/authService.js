'use strict';const a36_0x2a17a7=a36_0x5463;function a36_0x41b3(){const _0x4d1b80=['Account\x20is\x20not\x20active','Invalid\x20credentials','status','default','Invalid\x20token','46StCdix','4951305DZitzX','verifyToken','config','75376yJmgdF','sign','__esModule','expiresIn','passwordHash','206169WpVmEF','6756DkkQiB','name','679IFPMOY','verify','jsonwebtoken','2965CaGfld','generateToken','admin','secret','ACTIVE','compare','20vhoIQN','jwt','597391flXbQZ','815397MXPsRO','username','password','shop','bcryptjs','login','6058840qKbxJo','180UYrccZ','../config/database','defineProperty'];a36_0x41b3=function(){return _0x4d1b80;};return a36_0x41b3();}(function(_0x29d116,_0x22455c){const _0x25143e=a36_0x5463,_0x30b03e=_0x29d116();while(!![]){try{const _0x239a4d=parseInt(_0x25143e(0x1a6))/0x1+parseInt(_0x25143e(0x18f))/0x2*(parseInt(_0x25143e(0x198))/0x3)+-parseInt(_0x25143e(0x186))/0x4+parseInt(_0x25143e(0x19e))/0x5*(-parseInt(_0x25143e(0x199))/0x6)+-parseInt(_0x25143e(0x19b))/0x7*(-parseInt(_0x25143e(0x193))/0x8)+-parseInt(_0x25143e(0x190))/0x9*(parseInt(_0x25143e(0x1a4))/0xa)+-parseInt(_0x25143e(0x1a7))/0xb*(-parseInt(_0x25143e(0x187))/0xc);if(_0x239a4d===_0x22455c)break;else _0x30b03e['push'](_0x30b03e['shift']());}catch(_0x4b7f08){_0x30b03e['push'](_0x30b03e['shift']());}}}(a36_0x41b3,0xe0e35));var __importDefault=this&&this['__importDefault']||function(_0x41a2ad){const _0x41aba4=a36_0x5463;return _0x41a2ad&&_0x41a2ad[_0x41aba4(0x195)]?_0x41a2ad:{'default':_0x41a2ad};};Object[a36_0x2a17a7(0x189)](exports,a36_0x2a17a7(0x195),{'value':!![]}),exports['AuthService']=void 0x0;function a36_0x5463(_0xfe821c,_0x52fad2){const _0x41b3da=a36_0x41b3();return a36_0x5463=function(_0x54631f,_0x453917){_0x54631f=_0x54631f-0x186;let _0x4fd8d4=_0x41b3da[_0x54631f];return _0x4fd8d4;},a36_0x5463(_0xfe821c,_0x52fad2);}const bcryptjs_1=__importDefault(require(a36_0x2a17a7(0x1ab))),jsonwebtoken_1=__importDefault(require(a36_0x2a17a7(0x19d))),database_1=__importDefault(require(a36_0x2a17a7(0x188))),config_1=require('../config/config');class AuthService{[a36_0x2a17a7(0x19f)](_0xb412f6){const _0x406199=a36_0x2a17a7;return jsonwebtoken_1[_0x406199(0x18d)][_0x406199(0x194)](_0xb412f6,config_1[_0x406199(0x192)]['jwt']['secret'],{'expiresIn':String(config_1[_0x406199(0x192)][_0x406199(0x1a5)][_0x406199(0x196)])});}async[a36_0x2a17a7(0x1ac)](_0x2febf6){const _0x5de59b=a36_0x2a17a7,{username:_0x5b50b5,password:_0x4ca44d}=_0x2febf6;if(_0x5b50b5===config_1['config'][_0x5de59b(0x1a0)][_0x5de59b(0x1a8)]){const _0x2507fb=await bcryptjs_1['default'][_0x5de59b(0x1a3)](_0x4ca44d,config_1[_0x5de59b(0x192)][_0x5de59b(0x1a0)][_0x5de59b(0x197)]);if(_0x2507fb){const _0x4b38a5=this[_0x5de59b(0x19f)]({'id':_0x5de59b(0x1a0),'username':config_1[_0x5de59b(0x192)]['admin'][_0x5de59b(0x1a8)],'role':_0x5de59b(0x1a0)});return{'access_token':_0x4b38a5,'role':_0x5de59b(0x1a0)};}}const _0x154fca=await database_1[_0x5de59b(0x18d)][_0x5de59b(0x1aa)]['findUnique']({'where':{'username':_0x5b50b5},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x154fca)throw new Error('Invalid\x20credentials');if(_0x154fca[_0x5de59b(0x18c)]!==_0x5de59b(0x1a2))throw new Error(_0x5de59b(0x18a));const _0x4d1965=await bcryptjs_1[_0x5de59b(0x18d)]['compare'](_0x4ca44d,_0x154fca[_0x5de59b(0x1a9)]);if(!_0x4d1965)throw new Error(_0x5de59b(0x18b));const _0x1daee4=this['generateToken']({'id':_0x154fca['id'],'username':_0x154fca['username'],'role':'shop'});return{'access_token':_0x1daee4,'role':_0x5de59b(0x1aa),'user':{'id':_0x154fca['id'],'name':_0x154fca[_0x5de59b(0x19a)],'username':_0x154fca[_0x5de59b(0x1a8)]}};}async[a36_0x2a17a7(0x191)](_0x1b4c4e){const _0x51d283=a36_0x2a17a7;try{const _0x5e52c8=jsonwebtoken_1['default'][_0x51d283(0x19c)](_0x1b4c4e,config_1[_0x51d283(0x192)]['jwt'][_0x51d283(0x1a1)]);return _0x5e52c8;}catch(_0x17d8d5){throw new Error(_0x51d283(0x18e));}}}exports['AuthService']=AuthService;