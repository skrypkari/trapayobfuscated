'use strict';const a36_0x3ba2dc=a36_0x4ad8;(function(_0x4076e4,_0x3f29c7){const _0x12712c=a36_0x4ad8,_0x4b7d29=_0x4076e4();while(!![]){try{const _0x5ad9ae=parseInt(_0x12712c(0x17b))/0x1+-parseInt(_0x12712c(0x182))/0x2+parseInt(_0x12712c(0x183))/0x3*(-parseInt(_0x12712c(0x193))/0x4)+-parseInt(_0x12712c(0x186))/0x5+-parseInt(_0x12712c(0x17f))/0x6+parseInt(_0x12712c(0x17e))/0x7+parseInt(_0x12712c(0x18f))/0x8*(parseInt(_0x12712c(0x176))/0x9);if(_0x5ad9ae===_0x3f29c7)break;else _0x4b7d29['push'](_0x4b7d29['shift']());}catch(_0x40adb9){_0x4b7d29['push'](_0x4b7d29['shift']());}}}(a36_0x284b,0x7bdaa));function a36_0x284b(){const _0x1010b9=['81hcdmxI','../config/database','Invalid\x20credentials','jwt','compare','238869IQryfa','jsonwebtoken','bcryptjs','5802818qfgYtT','1110660aRsopN','passwordHash','secret','2019398rUKoth','25743lTwxrg','verifyToken','config','2338720tkKLLB','username','name','findUnique','shop','login','sign','Account\x20is\x20not\x20active','verify','1421968FAaUWM','AuthService','default','__esModule','232CJBmfo','defineProperty','__importDefault','../config/config','admin','generateToken'];a36_0x284b=function(){return _0x1010b9;};return a36_0x284b();}var __importDefault=this&&this[a36_0x3ba2dc(0x195)]||function(_0x30da1e){const _0x3b1c24=a36_0x3ba2dc;return _0x30da1e&&_0x30da1e[_0x3b1c24(0x192)]?_0x30da1e:{'default':_0x30da1e};};Object[a36_0x3ba2dc(0x194)](exports,a36_0x3ba2dc(0x192),{'value':!![]}),exports[a36_0x3ba2dc(0x190)]=void 0x0;const bcryptjs_1=__importDefault(require(a36_0x3ba2dc(0x17d))),jsonwebtoken_1=__importDefault(require(a36_0x3ba2dc(0x17c))),database_1=__importDefault(require(a36_0x3ba2dc(0x177))),config_1=require(a36_0x3ba2dc(0x196));function a36_0x4ad8(_0x13fb4d,_0x431c43){const _0x284b04=a36_0x284b();return a36_0x4ad8=function(_0x4ad823,_0x5539ae){_0x4ad823=_0x4ad823-0x176;let _0x344db9=_0x284b04[_0x4ad823];return _0x344db9;},a36_0x4ad8(_0x13fb4d,_0x431c43);}class AuthService{[a36_0x3ba2dc(0x198)](_0x382938){const _0x3039c0=a36_0x3ba2dc;return jsonwebtoken_1[_0x3039c0(0x191)][_0x3039c0(0x18c)](_0x382938,config_1[_0x3039c0(0x185)][_0x3039c0(0x179)][_0x3039c0(0x181)],{'expiresIn':String(config_1[_0x3039c0(0x185)][_0x3039c0(0x179)]['expiresIn'])});}async[a36_0x3ba2dc(0x18b)](_0x5254d2){const _0x51c6c5=a36_0x3ba2dc,{username:_0x575d02,password:_0x3e16e5}=_0x5254d2;if(_0x575d02===config_1[_0x51c6c5(0x185)][_0x51c6c5(0x197)][_0x51c6c5(0x187)]){const _0x142a1c=await bcryptjs_1[_0x51c6c5(0x191)][_0x51c6c5(0x17a)](_0x3e16e5,config_1['config'][_0x51c6c5(0x197)][_0x51c6c5(0x180)]);if(_0x142a1c){const _0x383bba=this[_0x51c6c5(0x198)]({'id':_0x51c6c5(0x197),'username':config_1[_0x51c6c5(0x185)][_0x51c6c5(0x197)][_0x51c6c5(0x187)],'role':'admin'});return{'access_token':_0x383bba,'role':_0x51c6c5(0x197)};}}const _0x30cd4d=await database_1[_0x51c6c5(0x191)][_0x51c6c5(0x18a)][_0x51c6c5(0x189)]({'where':{'username':_0x575d02},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x30cd4d)throw new Error(_0x51c6c5(0x178));if(_0x30cd4d['status']!=='ACTIVE')throw new Error(_0x51c6c5(0x18d));const _0xf77e6d=await bcryptjs_1['default']['compare'](_0x3e16e5,_0x30cd4d['password']);if(!_0xf77e6d)throw new Error(_0x51c6c5(0x178));const _0x4e2d1f=this[_0x51c6c5(0x198)]({'id':_0x30cd4d['id'],'username':_0x30cd4d[_0x51c6c5(0x187)],'role':_0x51c6c5(0x18a)});return{'access_token':_0x4e2d1f,'role':_0x51c6c5(0x18a),'user':{'id':_0x30cd4d['id'],'name':_0x30cd4d[_0x51c6c5(0x188)],'username':_0x30cd4d['username']}};}async[a36_0x3ba2dc(0x184)](_0x52f403){const _0x22af96=a36_0x3ba2dc;try{const _0x7c0964=jsonwebtoken_1[_0x22af96(0x191)][_0x22af96(0x18e)](_0x52f403,config_1[_0x22af96(0x185)][_0x22af96(0x179)][_0x22af96(0x181)]);return _0x7c0964;}catch(_0x41750b){throw new Error('Invalid\x20token');}}}exports[a36_0x3ba2dc(0x190)]=AuthService;