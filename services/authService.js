'use strict';function a39_0x33b8(_0x36b6ba,_0x3696c5){const _0x14a89f=a39_0x14a8();return a39_0x33b8=function(_0x33b815,_0x122a4b){_0x33b815=_0x33b815-0x134;let _0x41b131=_0x14a89f[_0x33b815];return _0x41b131;},a39_0x33b8(_0x36b6ba,_0x3696c5);}const a39_0x32bb69=a39_0x33b8;(function(_0x5cbd10,_0x227f83){const _0x4d1c74=a39_0x33b8,_0x446da4=_0x5cbd10();while(!![]){try{const _0x29b981=-parseInt(_0x4d1c74(0x146))/0x1*(-parseInt(_0x4d1c74(0x14e))/0x2)+parseInt(_0x4d1c74(0x13a))/0x3+parseInt(_0x4d1c74(0x147))/0x4*(-parseInt(_0x4d1c74(0x151))/0x5)+-parseInt(_0x4d1c74(0x13f))/0x6+-parseInt(_0x4d1c74(0x153))/0x7+parseInt(_0x4d1c74(0x150))/0x8*(-parseInt(_0x4d1c74(0x157))/0x9)+parseInt(_0x4d1c74(0x154))/0xa;if(_0x29b981===_0x227f83)break;else _0x446da4['push'](_0x446da4['shift']());}catch(_0x3bd7ee){_0x446da4['push'](_0x446da4['shift']());}}}(a39_0x14a8,0x8f7d9));function a39_0x14a8(){const _0x48688b=['status','sign','686KxDSrF','admin','3522616YHduCD','5517245RmDajv','jsonwebtoken','3137974TNJyGZ','16374060bKZDoP','__esModule','password','9DaVtbT','name','bcryptjs','Invalid\x20token','verifyToken','../config/database','expiresIn','1896375cbcKQX','Account\x20is\x20not\x20active','compare','findUnique','defineProperty','4676682wQKJtQ','secret','username','../config/config','shop','login','config','3177Ukxgny','4oHVGBN','verify','jwt','default','generateToken'];a39_0x14a8=function(){return _0x48688b;};return a39_0x14a8();}var __importDefault=this&&this['__importDefault']||function(_0x550d73){const _0x8a0f4c=a39_0x33b8;return _0x550d73&&_0x550d73[_0x8a0f4c(0x155)]?_0x550d73:{'default':_0x550d73};};Object[a39_0x32bb69(0x13e)](exports,a39_0x32bb69(0x155),{'value':!![]}),exports['AuthService']=void 0x0;const bcryptjs_1=__importDefault(require(a39_0x32bb69(0x135))),jsonwebtoken_1=__importDefault(require(a39_0x32bb69(0x152))),database_1=__importDefault(require(a39_0x32bb69(0x138))),config_1=require(a39_0x32bb69(0x142));class AuthService{['generateToken'](_0xc4e4fa){const _0x313107=a39_0x32bb69;return jsonwebtoken_1[_0x313107(0x14a)][_0x313107(0x14d)](_0xc4e4fa,config_1['config'][_0x313107(0x149)][_0x313107(0x140)],{'expiresIn':String(config_1['config'][_0x313107(0x149)][_0x313107(0x139)])});}async[a39_0x32bb69(0x144)](_0x463ec6){const _0x11f7df=a39_0x32bb69,{username:_0x170458,password:_0x78ecdb}=_0x463ec6;if(_0x170458===config_1[_0x11f7df(0x145)][_0x11f7df(0x14f)][_0x11f7df(0x141)]){const _0x530633=await bcryptjs_1[_0x11f7df(0x14a)][_0x11f7df(0x13c)](_0x78ecdb,config_1[_0x11f7df(0x145)][_0x11f7df(0x14f)]['passwordHash']);if(_0x530633){const _0x54bbca=this[_0x11f7df(0x14b)]({'id':'admin','username':config_1[_0x11f7df(0x145)][_0x11f7df(0x14f)][_0x11f7df(0x141)],'role':'admin'});return{'access_token':_0x54bbca,'role':'admin'};}}const _0x99f087=await database_1[_0x11f7df(0x14a)]['shop'][_0x11f7df(0x13d)]({'where':{'username':_0x170458},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x99f087)throw new Error('Invalid\x20credentials');if(_0x99f087[_0x11f7df(0x14c)]!=='ACTIVE')throw new Error(_0x11f7df(0x13b));const _0x203298=await bcryptjs_1['default']['compare'](_0x78ecdb,_0x99f087[_0x11f7df(0x156)]);if(!_0x203298)throw new Error('Invalid\x20credentials');const _0x44a835=this['generateToken']({'id':_0x99f087['id'],'username':_0x99f087[_0x11f7df(0x141)],'role':_0x11f7df(0x143)});return{'access_token':_0x44a835,'role':_0x11f7df(0x143),'user':{'id':_0x99f087['id'],'name':_0x99f087[_0x11f7df(0x134)],'username':_0x99f087[_0x11f7df(0x141)]}};}async[a39_0x32bb69(0x137)](_0x1b8738){const _0x5610c6=a39_0x32bb69;try{const _0x462cda=jsonwebtoken_1[_0x5610c6(0x14a)][_0x5610c6(0x148)](_0x1b8738,config_1[_0x5610c6(0x145)]['jwt'][_0x5610c6(0x140)]);return _0x462cda;}catch(_0x34b0b7){throw new Error(_0x5610c6(0x136));}}}exports['AuthService']=AuthService;