'use strict';const a36_0x5e620d=a36_0x1f28;(function(_0x4e24ef,_0x5c6dc4){const _0x4c913b=a36_0x1f28,_0x3c128c=_0x4e24ef();while(!![]){try{const _0x56c5e4=parseInt(_0x4c913b(0x1de))/0x1+parseInt(_0x4c913b(0x1e3))/0x2+-parseInt(_0x4c913b(0x1cc))/0x3+-parseInt(_0x4c913b(0x1e7))/0x4*(-parseInt(_0x4c913b(0x1dd))/0x5)+parseInt(_0x4c913b(0x1e2))/0x6*(-parseInt(_0x4c913b(0x1d1))/0x7)+parseInt(_0x4c913b(0x1d9))/0x8*(parseInt(_0x4c913b(0x1cf))/0x9)+-parseInt(_0x4c913b(0x1df))/0xa*(parseInt(_0x4c913b(0x1e5))/0xb);if(_0x56c5e4===_0x5c6dc4)break;else _0x3c128c['push'](_0x3c128c['shift']());}catch(_0x97b706){_0x3c128c['push'](_0x3c128c['shift']());}}}(a36_0x46ed,0xe6aa4));function a36_0x46ed(){const _0x5d8313=['status','default','secret','1925277AaFJcR','__importDefault','verifyToken','45KfDlEG','Invalid\x20credentials','14cpLPXX','ACTIVE','shop','verify','../config/database','defineProperty','name','findUnique','1448736NykwDc','config','passwordHash','jwt','5xvAiBR','1116198iVTAhs','1280KCXoqk','__esModule','compare','386190yPVyhp','3270476UhMPXB','password','320859ynfiXN','login','7168116TxcYcq','admin','../config/config','sign','AuthService','generateToken'];a36_0x46ed=function(){return _0x5d8313;};return a36_0x46ed();}var __importDefault=this&&this[a36_0x5e620d(0x1cd)]||function(_0x83989e){const _0x30bfcf=a36_0x5e620d;return _0x83989e&&_0x83989e[_0x30bfcf(0x1e0)]?_0x83989e:{'default':_0x83989e};};Object[a36_0x5e620d(0x1d6)](exports,a36_0x5e620d(0x1e0),{'value':!![]}),exports[a36_0x5e620d(0x1eb)]=void 0x0;function a36_0x1f28(_0x1a9d7b,_0x184262){const _0x46edd3=a36_0x46ed();return a36_0x1f28=function(_0x1f287c,_0x559468){_0x1f287c=_0x1f287c-0x1c9;let _0x3d9e87=_0x46edd3[_0x1f287c];return _0x3d9e87;},a36_0x1f28(_0x1a9d7b,_0x184262);}const bcryptjs_1=__importDefault(require('bcryptjs')),jsonwebtoken_1=__importDefault(require('jsonwebtoken')),database_1=__importDefault(require(a36_0x5e620d(0x1d5))),config_1=require(a36_0x5e620d(0x1e9));class AuthService{['generateToken'](_0x5c3b07){const _0xee5435=a36_0x5e620d;return jsonwebtoken_1[_0xee5435(0x1ca)][_0xee5435(0x1ea)](_0x5c3b07,config_1[_0xee5435(0x1da)][_0xee5435(0x1dc)][_0xee5435(0x1cb)],{'expiresIn':String(config_1['config']['jwt']['expiresIn'])});}async[a36_0x5e620d(0x1e6)](_0x318bf4){const _0x78c3a0=a36_0x5e620d,{username:_0x320a4f,password:_0x39f5aa}=_0x318bf4;if(_0x320a4f===config_1[_0x78c3a0(0x1da)]['admin']['username']){const _0x3d1a65=await bcryptjs_1[_0x78c3a0(0x1ca)][_0x78c3a0(0x1e1)](_0x39f5aa,config_1[_0x78c3a0(0x1da)][_0x78c3a0(0x1e8)][_0x78c3a0(0x1db)]);if(_0x3d1a65){const _0x413b21=this['generateToken']({'id':_0x78c3a0(0x1e8),'username':config_1[_0x78c3a0(0x1da)][_0x78c3a0(0x1e8)]['username'],'role':_0x78c3a0(0x1e8)});return{'access_token':_0x413b21,'role':_0x78c3a0(0x1e8)};}}const _0x2b7168=await database_1[_0x78c3a0(0x1ca)][_0x78c3a0(0x1d3)][_0x78c3a0(0x1d8)]({'where':{'username':_0x320a4f},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x2b7168)throw new Error(_0x78c3a0(0x1d0));if(_0x2b7168[_0x78c3a0(0x1c9)]!==_0x78c3a0(0x1d2))throw new Error('Account\x20is\x20not\x20active');const _0x290abe=await bcryptjs_1[_0x78c3a0(0x1ca)]['compare'](_0x39f5aa,_0x2b7168[_0x78c3a0(0x1e4)]);if(!_0x290abe)throw new Error(_0x78c3a0(0x1d0));const _0x3584f2=this[_0x78c3a0(0x1ec)]({'id':_0x2b7168['id'],'username':_0x2b7168['username'],'role':_0x78c3a0(0x1d3)});return{'access_token':_0x3584f2,'role':_0x78c3a0(0x1d3),'user':{'id':_0x2b7168['id'],'name':_0x2b7168[_0x78c3a0(0x1d7)],'username':_0x2b7168['username']}};}async[a36_0x5e620d(0x1ce)](_0x4f227b){const _0x37679d=a36_0x5e620d;try{const _0x439a0e=jsonwebtoken_1[_0x37679d(0x1ca)][_0x37679d(0x1d4)](_0x4f227b,config_1['config'][_0x37679d(0x1dc)][_0x37679d(0x1cb)]);return _0x439a0e;}catch(_0x4cbcdf){throw new Error('Invalid\x20token');}}}exports[a36_0x5e620d(0x1eb)]=AuthService;