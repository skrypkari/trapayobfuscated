'use strict';const a34_0x315470=a34_0x2e08;(function(_0x45417d,_0x5e52de){const _0x943c96=a34_0x2e08,_0x7e66da=_0x45417d();while(!![]){try{const _0x5b7408=parseInt(_0x943c96(0xff))/0x1*(parseInt(_0x943c96(0xf2))/0x2)+parseInt(_0x943c96(0x106))/0x3+parseInt(_0x943c96(0x101))/0x4+-parseInt(_0x943c96(0x10b))/0x5*(-parseInt(_0x943c96(0xfe))/0x6)+parseInt(_0x943c96(0x102))/0x7*(-parseInt(_0x943c96(0x10a))/0x8)+-parseInt(_0x943c96(0xf6))/0x9+-parseInt(_0x943c96(0xf9))/0xa*(parseInt(_0x943c96(0x104))/0xb);if(_0x5b7408===_0x5e52de)break;else _0x7e66da['push'](_0x7e66da['shift']());}catch(_0x3b9f87){_0x7e66da['push'](_0x7e66da['shift']());}}}(a34_0x2f6e,0x59213));function a34_0x2e08(_0x35622b,_0x5612e0){const _0x2f6ef7=a34_0x2f6e();return a34_0x2e08=function(_0x2e08e8,_0x21639c){_0x2e08e8=_0x2e08e8-0xee;let _0x543afc=_0x2f6ef7[_0x2e08e8];return _0x543afc;},a34_0x2e08(_0x35622b,_0x5612e0);}var __importDefault=this&&this[a34_0x315470(0x10f)]||function(_0x42f282){const _0x292b79=a34_0x315470;return _0x42f282&&_0x42f282[_0x292b79(0xfd)]?_0x42f282:{'default':_0x42f282};};Object[a34_0x315470(0x107)](exports,a34_0x315470(0xfd),{'value':!![]}),exports[a34_0x315470(0xee)]=void 0x0;const bcryptjs_1=__importDefault(require(a34_0x315470(0x105))),jsonwebtoken_1=__importDefault(require('jsonwebtoken')),database_1=__importDefault(require('../config/database')),config_1=require(a34_0x315470(0xf0));class AuthService{[a34_0x315470(0xf7)](_0x163b23){const _0x36e3d3=a34_0x315470;return jsonwebtoken_1[_0x36e3d3(0xf5)][_0x36e3d3(0x100)](_0x163b23,config_1[_0x36e3d3(0x109)][_0x36e3d3(0xf4)][_0x36e3d3(0xf8)],{'expiresIn':String(config_1[_0x36e3d3(0x109)][_0x36e3d3(0xf4)][_0x36e3d3(0x108)])});}async[a34_0x315470(0xfc)](_0x3a14e2){const _0x481c6b=a34_0x315470,{username:_0x1e4a82,password:_0x10bce6}=_0x3a14e2;if(_0x1e4a82===config_1['config'][_0x481c6b(0xfb)][_0x481c6b(0xf3)]){const _0x43d59b=await bcryptjs_1[_0x481c6b(0xf5)][_0x481c6b(0xfa)](_0x10bce6,config_1['config'][_0x481c6b(0xfb)][_0x481c6b(0x10e)]);if(_0x43d59b){const _0x27ae4f=this[_0x481c6b(0xf7)]({'id':'admin','username':config_1[_0x481c6b(0x109)][_0x481c6b(0xfb)][_0x481c6b(0xf3)],'role':_0x481c6b(0xfb)});return{'access_token':_0x27ae4f,'role':_0x481c6b(0xfb)};}}const _0x5a8e4f=await database_1[_0x481c6b(0xf5)][_0x481c6b(0x110)][_0x481c6b(0xef)]({'where':{'username':_0x1e4a82},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x5a8e4f)throw new Error('Invalid\x20credentials');if(_0x5a8e4f['status']!==_0x481c6b(0x10c))throw new Error('Account\x20is\x20not\x20active');const _0x56d954=await bcryptjs_1[_0x481c6b(0xf5)][_0x481c6b(0xfa)](_0x10bce6,_0x5a8e4f['password']);if(!_0x56d954)throw new Error(_0x481c6b(0xf1));const _0x1bd17c=this['generateToken']({'id':_0x5a8e4f['id'],'username':_0x5a8e4f[_0x481c6b(0xf3)],'role':'shop'});return{'access_token':_0x1bd17c,'role':_0x481c6b(0x110),'user':{'id':_0x5a8e4f['id'],'name':_0x5a8e4f[_0x481c6b(0x10d)],'username':_0x5a8e4f[_0x481c6b(0xf3)]}};}async[a34_0x315470(0x103)](_0x4aa92c){const _0x32aa89=a34_0x315470;try{const _0x495203=jsonwebtoken_1[_0x32aa89(0xf5)]['verify'](_0x4aa92c,config_1[_0x32aa89(0x109)][_0x32aa89(0xf4)][_0x32aa89(0xf8)]);return _0x495203;}catch(_0x1282a8){throw new Error('Invalid\x20token');}}}function a34_0x2f6e(){const _0x5cc19b=['findUnique','../config/config','Invalid\x20credentials','710482MSBpRo','username','jwt','default','54198brzAdG','generateToken','secret','4473980olJWYL','compare','admin','login','__esModule','24jetaVO','1rZARfT','sign','1164356BslPgs','10297PyEKNh','verifyToken','33RByvSq','bcryptjs','1906425ayqkvQ','defineProperty','expiresIn','config','1552HApcLr','896075pAYIux','ACTIVE','name','passwordHash','__importDefault','shop','AuthService'];a34_0x2f6e=function(){return _0x5cc19b;};return a34_0x2f6e();}exports[a34_0x315470(0xee)]=AuthService;