'use strict';const a37_0x5f426b=a37_0x796b;(function(_0x1005de,_0x5b3004){const _0x114502=a37_0x796b,_0xee378c=_0x1005de();while(!![]){try{const _0x7e15d0=parseInt(_0x114502(0x14d))/0x1+parseInt(_0x114502(0x15a))/0x2*(-parseInt(_0x114502(0x151))/0x3)+-parseInt(_0x114502(0x154))/0x4*(parseInt(_0x114502(0x14e))/0x5)+-parseInt(_0x114502(0x155))/0x6*(-parseInt(_0x114502(0x153))/0x7)+parseInt(_0x114502(0x148))/0x8+-parseInt(_0x114502(0x157))/0x9+parseInt(_0x114502(0x158))/0xa;if(_0x7e15d0===_0x5b3004)break;else _0xee378c['push'](_0xee378c['shift']());}catch(_0x1be6fc){_0xee378c['push'](_0xee378c['shift']());}}}(a37_0x21cf,0x399ba));var __importDefault=this&&this[a37_0x5f426b(0x15e)]||function(_0x274ded){const _0x1ce702=a37_0x5f426b;return _0x274ded&&_0x274ded[_0x1ce702(0x162)]?_0x274ded:{'default':_0x274ded};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports['AuthService']=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),jsonwebtoken_1=__importDefault(require(a37_0x5f426b(0x160))),database_1=__importDefault(require(a37_0x5f426b(0x15c))),config_1=require('../config/config');class AuthService{['generateToken'](_0x30e0f4){const _0x39b31f=a37_0x5f426b;return jsonwebtoken_1[_0x39b31f(0x156)]['sign'](_0x30e0f4,config_1[_0x39b31f(0x145)][_0x39b31f(0x163)][_0x39b31f(0x15f)],{'expiresIn':String(config_1[_0x39b31f(0x145)][_0x39b31f(0x163)]['expiresIn'])});}async[a37_0x5f426b(0x143)](_0x1a263c){const _0x5dcbdc=a37_0x5f426b,{username:_0x16ffa2,password:_0x2f8230}=_0x1a263c;if(_0x16ffa2===config_1[_0x5dcbdc(0x145)]['admin']['username']){const _0x41b0a5=await bcryptjs_1[_0x5dcbdc(0x156)]['compare'](_0x2f8230,config_1['config'][_0x5dcbdc(0x161)][_0x5dcbdc(0x14a)]);if(_0x41b0a5){const _0xefa92a=this[_0x5dcbdc(0x15d)]({'id':_0x5dcbdc(0x161),'username':config_1[_0x5dcbdc(0x145)][_0x5dcbdc(0x161)][_0x5dcbdc(0x144)],'role':'admin'});return{'access_token':_0xefa92a,'role':_0x5dcbdc(0x161)};}}const _0x409a3a=await database_1[_0x5dcbdc(0x156)][_0x5dcbdc(0x159)][_0x5dcbdc(0x15b)]({'where':{'username':_0x16ffa2},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x409a3a)throw new Error('Invalid\x20credentials');if(_0x409a3a[_0x5dcbdc(0x147)]!==_0x5dcbdc(0x14c))throw new Error(_0x5dcbdc(0x149));const _0x39ec87=await bcryptjs_1[_0x5dcbdc(0x156)][_0x5dcbdc(0x152)](_0x2f8230,_0x409a3a[_0x5dcbdc(0x150)]);if(!_0x39ec87)throw new Error(_0x5dcbdc(0x146));const _0x456163=this[_0x5dcbdc(0x15d)]({'id':_0x409a3a['id'],'username':_0x409a3a[_0x5dcbdc(0x144)],'role':_0x5dcbdc(0x159)});return{'access_token':_0x456163,'role':'shop','user':{'id':_0x409a3a['id'],'name':_0x409a3a['name'],'username':_0x409a3a[_0x5dcbdc(0x144)]}};}async[a37_0x5f426b(0x14b)](_0x5f41e1){const _0x27a542=a37_0x5f426b;try{const _0x5bd30a=jsonwebtoken_1[_0x27a542(0x156)][_0x27a542(0x14f)](_0x5f41e1,config_1['config'][_0x27a542(0x163)]['secret']);return _0x5bd30a;}catch(_0x33b197){throw new Error('Invalid\x20token');}}}exports['AuthService']=AuthService;function a37_0x796b(_0x59150b,_0x140fde){const _0x21cfb3=a37_0x21cf();return a37_0x796b=function(_0x796be6,_0x10d6f4){_0x796be6=_0x796be6-0x143;let _0x55e422=_0x21cfb3[_0x796be6];return _0x55e422;},a37_0x796b(_0x59150b,_0x140fde);}function a37_0x21cf(){const _0x351901=['51ybmIGH','compare','7pFHkGi','583036cixaqF','2369454UOrJwF','default','2261205UJapsm','253920QfNvfs','shop','53626fAPYRW','findUnique','../config/database','generateToken','__importDefault','secret','jsonwebtoken','admin','__esModule','jwt','login','username','config','Invalid\x20credentials','status','2588680dtCaNx','Account\x20is\x20not\x20active','passwordHash','verifyToken','ACTIVE','344901KZPGsz','5ioafpY','verify','password'];a37_0x21cf=function(){return _0x351901;};return a37_0x21cf();}