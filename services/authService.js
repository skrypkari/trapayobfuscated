'use strict';const a36_0x354da0=a36_0x25a9;(function(_0x8954de,_0x4309d1){const _0x3afac5=a36_0x25a9,_0x2b7df3=_0x8954de();while(!![]){try{const _0xe3b6b6=parseInt(_0x3afac5(0xb4))/0x1*(parseInt(_0x3afac5(0x99))/0x2)+parseInt(_0x3afac5(0xa3))/0x3*(parseInt(_0x3afac5(0xa0))/0x4)+-parseInt(_0x3afac5(0x96))/0x5*(parseInt(_0x3afac5(0x9c))/0x6)+parseInt(_0x3afac5(0xab))/0x7*(-parseInt(_0x3afac5(0xba))/0x8)+-parseInt(_0x3afac5(0xb2))/0x9*(parseInt(_0x3afac5(0x97))/0xa)+-parseInt(_0x3afac5(0x9a))/0xb*(-parseInt(_0x3afac5(0xa4))/0xc)+-parseInt(_0x3afac5(0xb5))/0xd;if(_0xe3b6b6===_0x4309d1)break;else _0x2b7df3['push'](_0x2b7df3['shift']());}catch(_0x3aca4a){_0x2b7df3['push'](_0x2b7df3['shift']());}}}(a36_0x44d9,0x9d2ce));function a36_0x25a9(_0x149de0,_0x1b9cbc){const _0x44d918=a36_0x44d9();return a36_0x25a9=function(_0x25a9e4,_0x382e32){_0x25a9e4=_0x25a9e4-0x96;let _0x3d4476=_0x44d918[_0x25a9e4];return _0x3d4476;},a36_0x25a9(_0x149de0,_0x1b9cbc);}var __importDefault=this&&this[a36_0x354da0(0xb1)]||function(_0x2722c9){const _0x555183=a36_0x354da0;return _0x2722c9&&_0x2722c9[_0x555183(0xae)]?_0x2722c9:{'default':_0x2722c9};};function a36_0x44d9(){const _0x2e4c85=['__importDefault','36xHzapk','secret','1RupLtB','6064006RxXzHK','jwt','generateToken','sign','compare','24KVZloK','356435OcRmvh','437990BLtOKE','Invalid\x20credentials','1478294uAcrlp','11eOhgmP','Account\x20is\x20not\x20active','66XhSkEE','verify','defineProperty','verifyToken','596fDbtzM','admin','default','7023xckhGC','14041668WoFqfI','findUnique','config','username','../config/config','ACTIVE','login','439810PnuQOX','shop','password','__esModule','status','../config/database'];a36_0x44d9=function(){return _0x2e4c85;};return a36_0x44d9();}Object[a36_0x354da0(0x9e)](exports,'__esModule',{'value':!![]}),exports['AuthService']=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),jsonwebtoken_1=__importDefault(require('jsonwebtoken')),database_1=__importDefault(require(a36_0x354da0(0xb0))),config_1=require(a36_0x354da0(0xa8));class AuthService{[a36_0x354da0(0xb7)](_0x4abf0b){const _0x273327=a36_0x354da0;return jsonwebtoken_1[_0x273327(0xa2)][_0x273327(0xb8)](_0x4abf0b,config_1[_0x273327(0xa6)]['jwt'][_0x273327(0xb3)],{'expiresIn':String(config_1[_0x273327(0xa6)][_0x273327(0xb6)]['expiresIn'])});}async[a36_0x354da0(0xaa)](_0x3fbdf2){const _0x229615=a36_0x354da0,{username:_0x4049fa,password:_0x41fb6d}=_0x3fbdf2;if(_0x4049fa===config_1['config'][_0x229615(0xa1)]['username']){const _0x28feb4=await bcryptjs_1[_0x229615(0xa2)]['compare'](_0x41fb6d,config_1[_0x229615(0xa6)][_0x229615(0xa1)]['passwordHash']);if(_0x28feb4){const _0x490dfc=this[_0x229615(0xb7)]({'id':'admin','username':config_1[_0x229615(0xa6)][_0x229615(0xa1)]['username'],'role':_0x229615(0xa1)});return{'access_token':_0x490dfc,'role':_0x229615(0xa1)};}}const _0x415b0a=await database_1['default']['shop'][_0x229615(0xa5)]({'where':{'username':_0x4049fa},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x415b0a)throw new Error(_0x229615(0x98));if(_0x415b0a[_0x229615(0xaf)]!==_0x229615(0xa9))throw new Error(_0x229615(0x9b));const _0x1b4ed8=await bcryptjs_1[_0x229615(0xa2)][_0x229615(0xb9)](_0x41fb6d,_0x415b0a[_0x229615(0xad)]);if(!_0x1b4ed8)throw new Error('Invalid\x20credentials');const _0x4c8551=this[_0x229615(0xb7)]({'id':_0x415b0a['id'],'username':_0x415b0a[_0x229615(0xa7)],'role':_0x229615(0xac)});return{'access_token':_0x4c8551,'role':_0x229615(0xac),'user':{'id':_0x415b0a['id'],'name':_0x415b0a['name'],'username':_0x415b0a[_0x229615(0xa7)]}};}async[a36_0x354da0(0x9f)](_0x2bba60){const _0x39ca8a=a36_0x354da0;try{const _0x155c10=jsonwebtoken_1['default'][_0x39ca8a(0x9d)](_0x2bba60,config_1[_0x39ca8a(0xa6)][_0x39ca8a(0xb6)][_0x39ca8a(0xb3)]);return _0x155c10;}catch(_0x24de51){throw new Error('Invalid\x20token');}}}exports['AuthService']=AuthService;