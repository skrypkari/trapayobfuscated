'use strict';const a36_0x2aa660=a36_0x5b6b;function a36_0x1edc(){const _0x59b40f=['1188ntBrZV','__importDefault','default','generateToken','9697216hfOSck','1187118FBkPLo','verify','passwordHash','Invalid\x20credentials','761830CgVJNC','admin','../config/config','9121mAoDri','compare','Invalid\x20token','verifyToken','bcryptjs','jwt','Account\x20is\x20not\x20active','__esModule','jsonwebtoken','569230caJUNC','config','shop','AuthService','secret','sign','643856DNHEYv','20514tzKCEM','username'];a36_0x1edc=function(){return _0x59b40f;};return a36_0x1edc();}(function(_0x1f9b7b,_0xf0c2f8){const _0x274e01=a36_0x5b6b,_0x29fca1=_0x1f9b7b();while(!![]){try{const _0x20b5aa=-parseInt(_0x274e01(0xb0))/0x1+-parseInt(_0x274e01(0x9d))/0x2+-parseInt(_0x274e01(0x99))/0x3+parseInt(_0x274e01(0xaf))/0x4+-parseInt(_0x274e01(0xa9))/0x5+parseInt(_0x274e01(0xb2))/0x6*(-parseInt(_0x274e01(0xa0))/0x7)+parseInt(_0x274e01(0x98))/0x8;if(_0x20b5aa===_0xf0c2f8)break;else _0x29fca1['push'](_0x29fca1['shift']());}catch(_0x3c2017){_0x29fca1['push'](_0x29fca1['shift']());}}}(a36_0x1edc,0x31d6d));var __importDefault=this&&this[a36_0x2aa660(0x95)]||function(_0x409b7a){return _0x409b7a&&_0x409b7a['__esModule']?_0x409b7a:{'default':_0x409b7a};};Object['defineProperty'](exports,a36_0x2aa660(0xa7),{'value':!![]}),exports[a36_0x2aa660(0xac)]=void 0x0;const bcryptjs_1=__importDefault(require(a36_0x2aa660(0xa4))),jsonwebtoken_1=__importDefault(require(a36_0x2aa660(0xa8))),database_1=__importDefault(require('../config/database')),config_1=require(a36_0x2aa660(0x9f));class AuthService{[a36_0x2aa660(0x97)](_0x58dacc){const _0x567b9e=a36_0x2aa660;return jsonwebtoken_1[_0x567b9e(0x96)][_0x567b9e(0xae)](_0x58dacc,config_1[_0x567b9e(0xaa)][_0x567b9e(0xa5)][_0x567b9e(0xad)],{'expiresIn':String(config_1[_0x567b9e(0xaa)]['jwt']['expiresIn'])});}async['login'](_0x3494ef){const _0x17e3c3=a36_0x2aa660,{username:_0x6e888f,password:_0x4ec9bf}=_0x3494ef;if(_0x6e888f===config_1[_0x17e3c3(0xaa)][_0x17e3c3(0x9e)][_0x17e3c3(0xb1)]){const _0x593ac2=await bcryptjs_1[_0x17e3c3(0x96)][_0x17e3c3(0xa1)](_0x4ec9bf,config_1['config'][_0x17e3c3(0x9e)][_0x17e3c3(0x9b)]);if(_0x593ac2){const _0x2259ce=this[_0x17e3c3(0x97)]({'id':_0x17e3c3(0x9e),'username':config_1[_0x17e3c3(0xaa)][_0x17e3c3(0x9e)][_0x17e3c3(0xb1)],'role':'admin'});return{'access_token':_0x2259ce,'role':_0x17e3c3(0x9e)};}}const _0x51325a=await database_1[_0x17e3c3(0x96)]['shop']['findUnique']({'where':{'username':_0x6e888f},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x51325a)throw new Error(_0x17e3c3(0x9c));if(_0x51325a['status']!=='ACTIVE')throw new Error(_0x17e3c3(0xa6));const _0x5bb546=await bcryptjs_1[_0x17e3c3(0x96)][_0x17e3c3(0xa1)](_0x4ec9bf,_0x51325a['password']);if(!_0x5bb546)throw new Error('Invalid\x20credentials');const _0x324d6d=this['generateToken']({'id':_0x51325a['id'],'username':_0x51325a[_0x17e3c3(0xb1)],'role':'shop'});return{'access_token':_0x324d6d,'role':_0x17e3c3(0xab),'user':{'id':_0x51325a['id'],'name':_0x51325a['name'],'username':_0x51325a[_0x17e3c3(0xb1)]}};}async[a36_0x2aa660(0xa3)](_0x5742fa){const _0x47ff28=a36_0x2aa660;try{const _0x24715a=jsonwebtoken_1[_0x47ff28(0x96)][_0x47ff28(0x9a)](_0x5742fa,config_1[_0x47ff28(0xaa)]['jwt'][_0x47ff28(0xad)]);return _0x24715a;}catch(_0x5f3f1e){throw new Error(_0x47ff28(0xa2));}}}function a36_0x5b6b(_0x377f08,_0x3baebd){const _0x1edcdc=a36_0x1edc();return a36_0x5b6b=function(_0x5b6b99,_0x388b2a){_0x5b6b99=_0x5b6b99-0x95;let _0x2e7bdd=_0x1edcdc[_0x5b6b99];return _0x2e7bdd;},a36_0x5b6b(_0x377f08,_0x3baebd);}exports[a36_0x2aa660(0xac)]=AuthService;