'use strict';const a37_0x2076d3=a37_0x4f3f;function a37_0x1fab(){const _0x12b592=['2599173GFdoLI','admin','8662qdUyfu','bcryptjs','findUnique','63ifExEg','2912322LiaDZW','141RwYbkU','shop','4137385XgGkiZ','login','../config/config','secret','default','2834484REoIMi','verifyToken','Invalid\x20token','defineProperty','name','AuthService','compare','__esModule','__importDefault','1256688ZcOXOj','verify','393110KIpois','sign','config','Invalid\x20credentials','expiresIn','jwt','username','ACTIVE','Account\x20is\x20not\x20active','generateToken'];a37_0x1fab=function(){return _0x12b592;};return a37_0x1fab();}(function(_0x134837,_0x26f166){const _0x54c7ec=a37_0x4f3f,_0x3ddc4e=_0x134837();while(!![]){try{const _0x5d3d0f=parseInt(_0x54c7ec(0x166))/0x1*(-parseInt(_0x54c7ec(0x161))/0x2)+parseInt(_0x54c7ec(0x15f))/0x3+-parseInt(_0x54c7ec(0x14a))/0x4+-parseInt(_0x54c7ec(0x155))/0x5+-parseInt(_0x54c7ec(0x165))/0x6+parseInt(_0x54c7ec(0x168))/0x7+parseInt(_0x54c7ec(0x153))/0x8*(parseInt(_0x54c7ec(0x164))/0x9);if(_0x5d3d0f===_0x26f166)break;else _0x3ddc4e['push'](_0x3ddc4e['shift']());}catch(_0x528562){_0x3ddc4e['push'](_0x3ddc4e['shift']());}}}(a37_0x1fab,0xa47d3));function a37_0x4f3f(_0x764961,_0x1a13bd){const _0x1fab77=a37_0x1fab();return a37_0x4f3f=function(_0x4f3f45,_0x29a0ec){_0x4f3f45=_0x4f3f45-0x149;let _0x599740=_0x1fab77[_0x4f3f45];return _0x599740;},a37_0x4f3f(_0x764961,_0x1a13bd);}var __importDefault=this&&this[a37_0x2076d3(0x152)]||function(_0x19f115){return _0x19f115&&_0x19f115['__esModule']?_0x19f115:{'default':_0x19f115};};Object[a37_0x2076d3(0x14d)](exports,a37_0x2076d3(0x151),{'value':!![]}),exports[a37_0x2076d3(0x14f)]=void 0x0;const bcryptjs_1=__importDefault(require(a37_0x2076d3(0x162))),jsonwebtoken_1=__importDefault(require('jsonwebtoken')),database_1=__importDefault(require('../config/database')),config_1=require(a37_0x2076d3(0x16a));class AuthService{[a37_0x2076d3(0x15e)](_0x5428d5){const _0x5de2cc=a37_0x2076d3;return jsonwebtoken_1['default'][_0x5de2cc(0x156)](_0x5428d5,config_1['config'][_0x5de2cc(0x15a)]['secret'],{'expiresIn':String(config_1[_0x5de2cc(0x157)]['jwt'][_0x5de2cc(0x159)])});}async[a37_0x2076d3(0x169)](_0x269a0d){const _0x101602=a37_0x2076d3,{username:_0x348b8b,password:_0x54a571}=_0x269a0d;if(_0x348b8b===config_1[_0x101602(0x157)][_0x101602(0x160)]['username']){const _0x4a0423=await bcryptjs_1[_0x101602(0x149)][_0x101602(0x150)](_0x54a571,config_1[_0x101602(0x157)][_0x101602(0x160)]['passwordHash']);if(_0x4a0423){const _0x57df04=this['generateToken']({'id':'admin','username':config_1[_0x101602(0x157)][_0x101602(0x160)][_0x101602(0x15b)],'role':_0x101602(0x160)});return{'access_token':_0x57df04,'role':_0x101602(0x160)};}}const _0xbe67ef=await database_1[_0x101602(0x149)][_0x101602(0x167)][_0x101602(0x163)]({'where':{'username':_0x348b8b},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0xbe67ef)throw new Error(_0x101602(0x158));if(_0xbe67ef['status']!==_0x101602(0x15c))throw new Error(_0x101602(0x15d));const _0x50fc41=await bcryptjs_1[_0x101602(0x149)][_0x101602(0x150)](_0x54a571,_0xbe67ef['password']);if(!_0x50fc41)throw new Error(_0x101602(0x158));const _0x2f46f6=this['generateToken']({'id':_0xbe67ef['id'],'username':_0xbe67ef[_0x101602(0x15b)],'role':_0x101602(0x167)});return{'access_token':_0x2f46f6,'role':_0x101602(0x167),'user':{'id':_0xbe67ef['id'],'name':_0xbe67ef[_0x101602(0x14e)],'username':_0xbe67ef['username']}};}async[a37_0x2076d3(0x14b)](_0x553649){const _0x2c5043=a37_0x2076d3;try{const _0x2a3173=jsonwebtoken_1[_0x2c5043(0x149)][_0x2c5043(0x154)](_0x553649,config_1[_0x2c5043(0x157)][_0x2c5043(0x15a)][_0x2c5043(0x16b)]);return _0x2a3173;}catch(_0x339c48){throw new Error(_0x2c5043(0x14c));}}}exports[a37_0x2076d3(0x14f)]=AuthService;