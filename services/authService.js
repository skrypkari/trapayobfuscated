'use strict';const a34_0x945c3a=a34_0x8588;(function(_0x550ddf,_0x51eb30){const _0x53e1f5=a34_0x8588,_0x3edf69=_0x550ddf();while(!![]){try{const _0x32e52f=parseInt(_0x53e1f5(0x14a))/0x1+parseInt(_0x53e1f5(0x148))/0x2+parseInt(_0x53e1f5(0x160))/0x3+parseInt(_0x53e1f5(0x155))/0x4*(parseInt(_0x53e1f5(0x13f))/0x5)+-parseInt(_0x53e1f5(0x144))/0x6+-parseInt(_0x53e1f5(0x14f))/0x7+-parseInt(_0x53e1f5(0x14b))/0x8*(-parseInt(_0x53e1f5(0x152))/0x9);if(_0x32e52f===_0x51eb30)break;else _0x3edf69['push'](_0x3edf69['shift']());}catch(_0x72cd05){_0x3edf69['push'](_0x3edf69['shift']());}}}(a34_0x4b04,0x4168f));function a34_0x4b04(){const _0x2bf74d=['findUnique','__esModule','844122JHerNk','password','86455HQzUsh','expiresIn','Invalid\x20token','secret','name','2115114FSoAqC','config','jwt','username','24202pSVMgD','sign','357263uPuyZa','8KvNIsn','verify','shop','status','471751GcvBrv','default','../config/config','178218tDTpyg','Account\x20is\x20not\x20active','admin','4FgnCDH','compare','AuthService','__importDefault','Invalid\x20credentials','ACTIVE','login','../config/database','generateToken'];a34_0x4b04=function(){return _0x2bf74d;};return a34_0x4b04();}var __importDefault=this&&this[a34_0x945c3a(0x158)]||function(_0x288107){return _0x288107&&_0x288107['__esModule']?_0x288107:{'default':_0x288107};};Object['defineProperty'](exports,a34_0x945c3a(0x15f),{'value':!![]}),exports[a34_0x945c3a(0x157)]=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),jsonwebtoken_1=__importDefault(require('jsonwebtoken')),database_1=__importDefault(require(a34_0x945c3a(0x15c))),config_1=require(a34_0x945c3a(0x151));function a34_0x8588(_0x497972,_0x22a733){const _0x4b041b=a34_0x4b04();return a34_0x8588=function(_0x85881b,_0x3a6c76){_0x85881b=_0x85881b-0x13e;let _0x4d2501=_0x4b041b[_0x85881b];return _0x4d2501;},a34_0x8588(_0x497972,_0x22a733);}class AuthService{[a34_0x945c3a(0x15d)](_0x175aa6){const _0x47a905=a34_0x945c3a;return jsonwebtoken_1[_0x47a905(0x150)][_0x47a905(0x149)](_0x175aa6,config_1[_0x47a905(0x145)][_0x47a905(0x146)][_0x47a905(0x142)],{'expiresIn':String(config_1[_0x47a905(0x145)][_0x47a905(0x146)][_0x47a905(0x140)])});}async[a34_0x945c3a(0x15b)](_0x558d3b){const _0x2d9fdb=a34_0x945c3a,{username:_0x50edf2,password:_0x161a4d}=_0x558d3b;if(_0x50edf2===config_1[_0x2d9fdb(0x145)][_0x2d9fdb(0x154)][_0x2d9fdb(0x147)]){const _0x49504c=await bcryptjs_1[_0x2d9fdb(0x150)][_0x2d9fdb(0x156)](_0x161a4d,config_1['config'][_0x2d9fdb(0x154)]['passwordHash']);if(_0x49504c){const _0x20a35e=this['generateToken']({'id':'admin','username':config_1[_0x2d9fdb(0x145)][_0x2d9fdb(0x154)][_0x2d9fdb(0x147)],'role':_0x2d9fdb(0x154)});return{'access_token':_0x20a35e,'role':_0x2d9fdb(0x154)};}}const _0x10c1b1=await database_1[_0x2d9fdb(0x150)][_0x2d9fdb(0x14d)][_0x2d9fdb(0x15e)]({'where':{'username':_0x50edf2},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x10c1b1)throw new Error('Invalid\x20credentials');if(_0x10c1b1[_0x2d9fdb(0x14e)]!==_0x2d9fdb(0x15a))throw new Error(_0x2d9fdb(0x153));const _0x331b03=await bcryptjs_1[_0x2d9fdb(0x150)][_0x2d9fdb(0x156)](_0x161a4d,_0x10c1b1[_0x2d9fdb(0x13e)]);if(!_0x331b03)throw new Error(_0x2d9fdb(0x159));const _0x2b62ed=this[_0x2d9fdb(0x15d)]({'id':_0x10c1b1['id'],'username':_0x10c1b1[_0x2d9fdb(0x147)],'role':_0x2d9fdb(0x14d)});return{'access_token':_0x2b62ed,'role':_0x2d9fdb(0x14d),'user':{'id':_0x10c1b1['id'],'name':_0x10c1b1[_0x2d9fdb(0x143)],'username':_0x10c1b1[_0x2d9fdb(0x147)]}};}async['verifyToken'](_0xed3698){const _0x18c350=a34_0x945c3a;try{const _0x282379=jsonwebtoken_1[_0x18c350(0x150)][_0x18c350(0x14c)](_0xed3698,config_1[_0x18c350(0x145)]['jwt'][_0x18c350(0x142)]);return _0x282379;}catch(_0x41ac6c){throw new Error(_0x18c350(0x141));}}}exports[a34_0x945c3a(0x157)]=AuthService;