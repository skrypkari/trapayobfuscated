'use strict';const a36_0x1d60a5=a36_0x5917;(function(_0xea2bb9,_0x4eb988){const _0x8ce46d=a36_0x5917,_0x52460a=_0xea2bb9();while(!![]){try{const _0x142322=parseInt(_0x8ce46d(0x93))/0x1+-parseInt(_0x8ce46d(0x9b))/0x2*(parseInt(_0x8ce46d(0x91))/0x3)+-parseInt(_0x8ce46d(0x9f))/0x4+-parseInt(_0x8ce46d(0x8d))/0x5+parseInt(_0x8ce46d(0x8c))/0x6+-parseInt(_0x8ce46d(0x8f))/0x7+parseInt(_0x8ce46d(0xaa))/0x8;if(_0x142322===_0x4eb988)break;else _0x52460a['push'](_0x52460a['shift']());}catch(_0x5378d2){_0x52460a['push'](_0x52460a['shift']());}}}(a36_0x4c1c,0x697d0));var __importDefault=this&&this[a36_0x1d60a5(0xa3)]||function(_0x825733){const _0x1b7b9d=a36_0x1d60a5;return _0x825733&&_0x825733[_0x1b7b9d(0xa0)]?_0x825733:{'default':_0x825733};};function a36_0x5917(_0x3f31ce,_0x5f0aeb){const _0x4c1cee=a36_0x4c1c();return a36_0x5917=function(_0x59176a,_0x4b3e82){_0x59176a=_0x59176a-0x8b;let _0xe72e4b=_0x4c1cee[_0x59176a];return _0xe72e4b;},a36_0x5917(_0x3f31ce,_0x5f0aeb);}Object[a36_0x1d60a5(0xac)](exports,'__esModule',{'value':!![]}),exports['AuthService']=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),jsonwebtoken_1=__importDefault(require(a36_0x1d60a5(0x9c))),database_1=__importDefault(require('../config/database')),config_1=require(a36_0x1d60a5(0x99));function a36_0x4c1c(){const _0x31bda3=['password','Invalid\x20token','3587082wkSEtN','3752700NrhLxm','sign','3812312LAVbDu','status','1050129EFnodh','passwordHash','520212cjcwIo','secret','default','AuthService','verify','findUnique','../config/config','verifyToken','4BNRRrY','jsonwebtoken','generateToken','login','3103084XWsAeG','__esModule','jwt','shop','__importDefault','ACTIVE','expiresIn','username','config','Account\x20is\x20not\x20active','admin','16680272LjwuMV','compare','defineProperty'];a36_0x4c1c=function(){return _0x31bda3;};return a36_0x4c1c();}class AuthService{[a36_0x1d60a5(0x9d)](_0x2a0b38){const _0x7177ed=a36_0x1d60a5;return jsonwebtoken_1['default'][_0x7177ed(0x8e)](_0x2a0b38,config_1[_0x7177ed(0xa7)][_0x7177ed(0xa1)][_0x7177ed(0x94)],{'expiresIn':String(config_1['config'][_0x7177ed(0xa1)][_0x7177ed(0xa5)])});}async[a36_0x1d60a5(0x9e)](_0x18896f){const _0x16d6d6=a36_0x1d60a5,{username:_0x39c7d1,password:_0x347bf8}=_0x18896f;if(_0x39c7d1===config_1[_0x16d6d6(0xa7)]['admin'][_0x16d6d6(0xa6)]){const _0x3da986=await bcryptjs_1[_0x16d6d6(0x95)][_0x16d6d6(0xab)](_0x347bf8,config_1[_0x16d6d6(0xa7)]['admin'][_0x16d6d6(0x92)]);if(_0x3da986){const _0x38e2ad=this[_0x16d6d6(0x9d)]({'id':'admin','username':config_1[_0x16d6d6(0xa7)][_0x16d6d6(0xa9)]['username'],'role':_0x16d6d6(0xa9)});return{'access_token':_0x38e2ad,'role':_0x16d6d6(0xa9)};}}const _0x3e641e=await database_1[_0x16d6d6(0x95)][_0x16d6d6(0xa2)][_0x16d6d6(0x98)]({'where':{'username':_0x39c7d1},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x3e641e)throw new Error('Invalid\x20credentials');if(_0x3e641e[_0x16d6d6(0x90)]!==_0x16d6d6(0xa4))throw new Error(_0x16d6d6(0xa8));const _0x132678=await bcryptjs_1[_0x16d6d6(0x95)][_0x16d6d6(0xab)](_0x347bf8,_0x3e641e[_0x16d6d6(0xad)]);if(!_0x132678)throw new Error('Invalid\x20credentials');const _0x2a4a03=this['generateToken']({'id':_0x3e641e['id'],'username':_0x3e641e[_0x16d6d6(0xa6)],'role':_0x16d6d6(0xa2)});return{'access_token':_0x2a4a03,'role':_0x16d6d6(0xa2),'user':{'id':_0x3e641e['id'],'name':_0x3e641e['name'],'username':_0x3e641e['username']}};}async[a36_0x1d60a5(0x9a)](_0x5d1e4d){const _0x3095ab=a36_0x1d60a5;try{const _0x3e5d8f=jsonwebtoken_1[_0x3095ab(0x95)][_0x3095ab(0x97)](_0x5d1e4d,config_1[_0x3095ab(0xa7)]['jwt']['secret']);return _0x3e5d8f;}catch(_0xb60269){throw new Error(_0x3095ab(0x8b));}}}exports[a36_0x1d60a5(0x96)]=AuthService;