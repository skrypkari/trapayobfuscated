'use strict';const a34_0x1ff6ae=a34_0x3b0f;(function(_0x4737d6,_0x38ead6){const _0x5e3071=a34_0x3b0f,_0x5d6567=_0x4737d6();while(!![]){try{const _0x3aaf6e=parseInt(_0x5e3071(0x1e5))/0x1+-parseInt(_0x5e3071(0x1f1))/0x2*(parseInt(_0x5e3071(0x1e1))/0x3)+-parseInt(_0x5e3071(0x1e7))/0x4+parseInt(_0x5e3071(0x1eb))/0x5+parseInt(_0x5e3071(0x1fe))/0x6+parseInt(_0x5e3071(0x1f9))/0x7+-parseInt(_0x5e3071(0x1ef))/0x8;if(_0x3aaf6e===_0x38ead6)break;else _0x5d6567['push'](_0x5d6567['shift']());}catch(_0x156f03){_0x5d6567['push'](_0x5d6567['shift']());}}}(a34_0x2c3a,0xd92ed));var __importDefault=this&&this[a34_0x1ff6ae(0x1f6)]||function(_0x3ae4bc){const _0x563774=a34_0x1ff6ae;return _0x3ae4bc&&_0x3ae4bc[_0x563774(0x1f0)]?_0x3ae4bc:{'default':_0x3ae4bc};};function a34_0x3b0f(_0x35b706,_0x20ca88){const _0x2c3a28=a34_0x2c3a();return a34_0x3b0f=function(_0x3b0f0c,_0x1d0c5e){_0x3b0f0c=_0x3b0f0c-0x1df;let _0x405b83=_0x2c3a28[_0x3b0f0c];return _0x405b83;},a34_0x3b0f(_0x35b706,_0x20ca88);}Object[a34_0x1ff6ae(0x1ed)](exports,a34_0x1ff6ae(0x1f0),{'value':!![]}),exports[a34_0x1ff6ae(0x1fb)]=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),jsonwebtoken_1=__importDefault(require('jsonwebtoken')),database_1=__importDefault(require(a34_0x1ff6ae(0x1e4))),config_1=require(a34_0x1ff6ae(0x1f8));class AuthService{['generateToken'](_0x5a0a9e){const _0x16b9b9=a34_0x1ff6ae;return jsonwebtoken_1[_0x16b9b9(0x1fd)][_0x16b9b9(0x1df)](_0x5a0a9e,config_1[_0x16b9b9(0x1f7)][_0x16b9b9(0x1e9)][_0x16b9b9(0x1e0)],{'expiresIn':String(config_1['config']['jwt'][_0x16b9b9(0x1fa)])});}async[a34_0x1ff6ae(0x1e2)](_0x714772){const _0x1fdc83=a34_0x1ff6ae,{username:_0x4374eb,password:_0x4c1d8d}=_0x714772;if(_0x4374eb===config_1[_0x1fdc83(0x1f7)][_0x1fdc83(0x1ec)][_0x1fdc83(0x1ea)]){const _0x3db492=await bcryptjs_1[_0x1fdc83(0x1fd)][_0x1fdc83(0x1f4)](_0x4c1d8d,config_1[_0x1fdc83(0x1f7)][_0x1fdc83(0x1ec)][_0x1fdc83(0x1e8)]);if(_0x3db492){const _0x3cc220=this['generateToken']({'id':_0x1fdc83(0x1ec),'username':config_1[_0x1fdc83(0x1f7)][_0x1fdc83(0x1ec)][_0x1fdc83(0x1ea)],'role':_0x1fdc83(0x1ec)});return{'access_token':_0x3cc220,'role':_0x1fdc83(0x1ec)};}}const _0x15c624=await database_1[_0x1fdc83(0x1fd)]['shop']['findUnique']({'where':{'username':_0x4374eb},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x15c624)throw new Error(_0x1fdc83(0x1ee));if(_0x15c624[_0x1fdc83(0x1e3)]!==_0x1fdc83(0x1fc))throw new Error(_0x1fdc83(0x1e6));const _0x5c8877=await bcryptjs_1[_0x1fdc83(0x1fd)]['compare'](_0x4c1d8d,_0x15c624[_0x1fdc83(0x1ff)]);if(!_0x5c8877)throw new Error('Invalid\x20credentials');const _0x1c9210=this['generateToken']({'id':_0x15c624['id'],'username':_0x15c624[_0x1fdc83(0x1ea)],'role':_0x1fdc83(0x1f3)});return{'access_token':_0x1c9210,'role':_0x1fdc83(0x1f3),'user':{'id':_0x15c624['id'],'name':_0x15c624[_0x1fdc83(0x1f2)],'username':_0x15c624[_0x1fdc83(0x1ea)]}};}async[a34_0x1ff6ae(0x1f5)](_0x44d57c){const _0x2218b6=a34_0x1ff6ae;try{const _0xdc51f4=jsonwebtoken_1['default']['verify'](_0x44d57c,config_1[_0x2218b6(0x1f7)]['jwt'][_0x2218b6(0x1e0)]);return _0xdc51f4;}catch(_0x2538a3){throw new Error('Invalid\x20token');}}}exports['AuthService']=AuthService;function a34_0x2c3a(){const _0xd832d=['expiresIn','AuthService','ACTIVE','default','8627352gupiGe','password','sign','secret','27RpUdQF','login','status','../config/database','640461FfdyHb','Account\x20is\x20not\x20active','530116wUCJTG','passwordHash','jwt','username','3818225ERptlq','admin','defineProperty','Invalid\x20credentials','12103472wnwgUE','__esModule','102086pFjTjE','name','shop','compare','verifyToken','__importDefault','config','../config/config','1067031zDKBUe'];a34_0x2c3a=function(){return _0xd832d;};return a34_0x2c3a();}