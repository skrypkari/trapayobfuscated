'use strict';function a36_0x4723(_0x553f93,_0x589871){const _0x3ffa2e=a36_0x3ffa();return a36_0x4723=function(_0x4723c7,_0x522aff){_0x4723c7=_0x4723c7-0xec;let _0x56dd19=_0x3ffa2e[_0x4723c7];return _0x56dd19;},a36_0x4723(_0x553f93,_0x589871);}const a36_0x515594=a36_0x4723;(function(_0x4d2c38,_0x56b136){const _0x32590b=a36_0x4723,_0x4face4=_0x4d2c38();while(!![]){try{const _0x568304=parseInt(_0x32590b(0xfa))/0x1+-parseInt(_0x32590b(0x104))/0x2*(-parseInt(_0x32590b(0x111))/0x3)+parseInt(_0x32590b(0x108))/0x4+-parseInt(_0x32590b(0x106))/0x5*(-parseInt(_0x32590b(0xf9))/0x6)+-parseInt(_0x32590b(0xf3))/0x7+-parseInt(_0x32590b(0x10b))/0x8*(parseInt(_0x32590b(0x109))/0x9)+-parseInt(_0x32590b(0xf2))/0xa;if(_0x568304===_0x56b136)break;else _0x4face4['push'](_0x4face4['shift']());}catch(_0x943fb5){_0x4face4['push'](_0x4face4['shift']());}}}(a36_0x3ffa,0xc7b2c));var __importDefault=this&&this[a36_0x515594(0xf4)]||function(_0x1238a0){return _0x1238a0&&_0x1238a0['__esModule']?_0x1238a0:{'default':_0x1238a0};};Object['defineProperty'](exports,a36_0x515594(0x101),{'value':!![]}),exports[a36_0x515594(0x105)]=void 0x0;function a36_0x3ffa(){const _0x51c845=['compare','2379040bKdjzO','9GBSgdD','password','2341032vteMhQ','jwt','default','config','status','passwordHash','297vUMoUn','name','admin','jsonwebtoken','username','findUnique','shop','5609450wsDNFN','7791728xbyQal','__importDefault','sign','Account\x20is\x20not\x20active','login','secret','7854KbAaxv','798448dbnefR','verify','bcryptjs','verifyToken','Invalid\x20credentials','generateToken','../config/database','__esModule','ACTIVE','expiresIn','16342TdMXak','AuthService','2225mshmip'];a36_0x3ffa=function(){return _0x51c845;};return a36_0x3ffa();}const bcryptjs_1=__importDefault(require(a36_0x515594(0xfc))),jsonwebtoken_1=__importDefault(require(a36_0x515594(0xee))),database_1=__importDefault(require(a36_0x515594(0x100))),config_1=require('../config/config');class AuthService{[a36_0x515594(0xff)](_0x2baa92){const _0x1633b8=a36_0x515594;return jsonwebtoken_1[_0x1633b8(0x10d)][_0x1633b8(0xf5)](_0x2baa92,config_1[_0x1633b8(0x10e)][_0x1633b8(0x10c)]['secret'],{'expiresIn':String(config_1['config'][_0x1633b8(0x10c)][_0x1633b8(0x103)])});}async[a36_0x515594(0xf7)](_0x3c8432){const _0x145367=a36_0x515594,{username:_0xe0c6a8,password:_0x152866}=_0x3c8432;if(_0xe0c6a8===config_1[_0x145367(0x10e)][_0x145367(0xed)][_0x145367(0xef)]){const _0x5a2b1f=await bcryptjs_1['default'][_0x145367(0x107)](_0x152866,config_1['config'][_0x145367(0xed)][_0x145367(0x110)]);if(_0x5a2b1f){const _0x40b07b=this['generateToken']({'id':'admin','username':config_1[_0x145367(0x10e)][_0x145367(0xed)][_0x145367(0xef)],'role':_0x145367(0xed)});return{'access_token':_0x40b07b,'role':_0x145367(0xed)};}}const _0x3b6eff=await database_1['default'][_0x145367(0xf1)][_0x145367(0xf0)]({'where':{'username':_0xe0c6a8},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x3b6eff)throw new Error(_0x145367(0xfe));if(_0x3b6eff[_0x145367(0x10f)]!==_0x145367(0x102))throw new Error(_0x145367(0xf6));const _0x16b237=await bcryptjs_1[_0x145367(0x10d)]['compare'](_0x152866,_0x3b6eff[_0x145367(0x10a)]);if(!_0x16b237)throw new Error(_0x145367(0xfe));const _0x33638e=this[_0x145367(0xff)]({'id':_0x3b6eff['id'],'username':_0x3b6eff[_0x145367(0xef)],'role':_0x145367(0xf1)});return{'access_token':_0x33638e,'role':_0x145367(0xf1),'user':{'id':_0x3b6eff['id'],'name':_0x3b6eff[_0x145367(0xec)],'username':_0x3b6eff[_0x145367(0xef)]}};}async[a36_0x515594(0xfd)](_0x1792cd){const _0x1cdc16=a36_0x515594;try{const _0xb3b0e0=jsonwebtoken_1[_0x1cdc16(0x10d)][_0x1cdc16(0xfb)](_0x1792cd,config_1[_0x1cdc16(0x10e)][_0x1cdc16(0x10c)][_0x1cdc16(0xf8)]);return _0xb3b0e0;}catch(_0x27d83a){throw new Error('Invalid\x20token');}}}exports[a36_0x515594(0x105)]=AuthService;