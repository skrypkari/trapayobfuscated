'use strict';const a41_0x1452a5=a41_0x1faa;(function(_0x2aded5,_0x3be050){const _0x584677=a41_0x1faa,_0x1e4188=_0x2aded5();while(!![]){try{const _0x5db046=-parseInt(_0x584677(0x115))/0x1+parseInt(_0x584677(0x11a))/0x2*(parseInt(_0x584677(0x126))/0x3)+parseInt(_0x584677(0x11d))/0x4+-parseInt(_0x584677(0x11f))/0x5+-parseInt(_0x584677(0x12f))/0x6+parseInt(_0x584677(0x127))/0x7+-parseInt(_0x584677(0x110))/0x8*(-parseInt(_0x584677(0x130))/0x9);if(_0x5db046===_0x3be050)break;else _0x1e4188['push'](_0x1e4188['shift']());}catch(_0x44f75b){_0x1e4188['push'](_0x1e4188['shift']());}}}(a41_0xbb98,0xece63));var __importDefault=this&&this['__importDefault']||function(_0x53fc3e){const _0x1096c0=a41_0x1faa;return _0x53fc3e&&_0x53fc3e[_0x1096c0(0x121)]?_0x53fc3e:{'default':_0x53fc3e};};function a41_0x1faa(_0x204de1,_0x55f9e3){const _0xbb9868=a41_0xbb98();return a41_0x1faa=function(_0x1faa2a,_0x3a04da){_0x1faa2a=_0x1faa2a-0x10f;let _0x511b48=_0xbb9868[_0x1faa2a];return _0x511b48;},a41_0x1faa(_0x204de1,_0x55f9e3);}Object[a41_0x1452a5(0x113)](exports,a41_0x1452a5(0x121),{'value':!![]}),exports[a41_0x1452a5(0x123)]=void 0x0;const bcryptjs_1=__importDefault(require(a41_0x1452a5(0x125))),jsonwebtoken_1=__importDefault(require('jsonwebtoken')),database_1=__importDefault(require(a41_0x1452a5(0x12c))),config_1=require(a41_0x1452a5(0x128));class AuthService{[a41_0x1452a5(0x11c)](_0x3de0b1){const _0x22948a=a41_0x1452a5;return jsonwebtoken_1[_0x22948a(0x116)][_0x22948a(0x122)](_0x3de0b1,config_1[_0x22948a(0x114)]['jwt'][_0x22948a(0x10f)],{'expiresIn':String(config_1[_0x22948a(0x114)][_0x22948a(0x12d)]['expiresIn'])});}async[a41_0x1452a5(0x119)](_0x1cd4bd){const _0x48ceed=a41_0x1452a5,{username:_0x455e18,password:_0x547748}=_0x1cd4bd;if(_0x455e18===config_1[_0x48ceed(0x114)][_0x48ceed(0x124)][_0x48ceed(0x117)]){const _0x391c47=await bcryptjs_1['default'][_0x48ceed(0x12e)](_0x547748,config_1[_0x48ceed(0x114)][_0x48ceed(0x124)][_0x48ceed(0x120)]);if(_0x391c47){const _0x52b6b4=this[_0x48ceed(0x11c)]({'id':_0x48ceed(0x124),'username':config_1[_0x48ceed(0x114)][_0x48ceed(0x124)][_0x48ceed(0x117)],'role':_0x48ceed(0x124)});return{'access_token':_0x52b6b4,'role':'admin'};}}const _0x467664=await database_1[_0x48ceed(0x116)][_0x48ceed(0x11b)]['findUnique']({'where':{'username':_0x455e18},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x467664)throw new Error(_0x48ceed(0x112));if(_0x467664[_0x48ceed(0x11e)]!=='ACTIVE')throw new Error('Account\x20is\x20not\x20active');const _0x179fe4=await bcryptjs_1['default'][_0x48ceed(0x12e)](_0x547748,_0x467664[_0x48ceed(0x118)]);if(!_0x179fe4)throw new Error(_0x48ceed(0x112));const _0x58b0f9=this[_0x48ceed(0x11c)]({'id':_0x467664['id'],'username':_0x467664['username'],'role':'shop'});return{'access_token':_0x58b0f9,'role':_0x48ceed(0x11b),'user':{'id':_0x467664['id'],'name':_0x467664[_0x48ceed(0x129)],'username':_0x467664[_0x48ceed(0x117)]}};}async[a41_0x1452a5(0x12b)](_0xf6dc03){const _0x171133=a41_0x1452a5;try{const _0x51f669=jsonwebtoken_1[_0x171133(0x116)][_0x171133(0x12a)](_0xf6dc03,config_1[_0x171133(0x114)][_0x171133(0x12d)][_0x171133(0x10f)]);return _0x51f669;}catch(_0x376471){throw new Error(_0x171133(0x111));}}}exports[a41_0x1452a5(0x123)]=AuthService;function a41_0xbb98(){const _0x33d87b=['AuthService','admin','bcryptjs','5850DnGsOm','10925117DPrbkc','../config/config','name','verify','verifyToken','../config/database','jwt','compare','3298740oyjBoP','27XusEGi','secret','3231832SQXviT','Invalid\x20token','Invalid\x20credentials','defineProperty','config','1729302wjjHOk','default','username','password','login','1006PHfahI','shop','generateToken','5357520IzXttK','status','9217335hUNbEj','passwordHash','__esModule','sign'];a41_0xbb98=function(){return _0x33d87b;};return a41_0xbb98();}