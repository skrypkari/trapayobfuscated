'use strict';const a47_0x4c8705=a47_0x554c;function a47_0x1f01(){const _0x545540=['default','7712YyuCjc','267196PTOlHB','findUnique','2439nkQzjc','bcryptjs','jsonwebtoken','../config/config','ACTIVE','10006238vNvQDd','96666vqOwCI','verifyToken','35LRWhPA','defineProperty','sign','4lndBbr','1pMTNfp','2899130XHHkDm','../config/database','generateToken','Invalid\x20token','status','name','password','config','passwordHash','Invalid\x20credentials','compare','369570nVxeCq','admin','jwt','__importDefault','2207470FqdiyZ','username','__esModule','shop','login','AuthService','secret'];a47_0x1f01=function(){return _0x545540;};return a47_0x1f01();}(function(_0x264e59,_0x3e70de){const _0x10486e=a47_0x554c,_0x446873=_0x264e59();while(!![]){try{const _0x5027d6=parseInt(_0x10486e(0x1e1))/0x1*(parseInt(_0x10486e(0x1d3))/0x2)+parseInt(_0x10486e(0x1ed))/0x3+-parseInt(_0x10486e(0x1e0))/0x4*(parseInt(_0x10486e(0x1f1))/0x5)+parseInt(_0x10486e(0x1db))/0x6*(parseInt(_0x10486e(0x1dd))/0x7)+-parseInt(_0x10486e(0x1d2))/0x8*(parseInt(_0x10486e(0x1d5))/0x9)+-parseInt(_0x10486e(0x1e2))/0xa+parseInt(_0x10486e(0x1da))/0xb;if(_0x5027d6===_0x3e70de)break;else _0x446873['push'](_0x446873['shift']());}catch(_0x54b33e){_0x446873['push'](_0x446873['shift']());}}}(a47_0x1f01,0x3e18e));var __importDefault=this&&this[a47_0x4c8705(0x1f0)]||function(_0x175a6a){const _0x4e6632=a47_0x4c8705;return _0x175a6a&&_0x175a6a[_0x4e6632(0x1f3)]?_0x175a6a:{'default':_0x175a6a};};Object[a47_0x4c8705(0x1de)](exports,'__esModule',{'value':!![]}),exports[a47_0x4c8705(0x1f6)]=void 0x0;function a47_0x554c(_0x53dbe1,_0x48c800){_0x53dbe1=_0x53dbe1-0x1d2;const _0x1f01b2=a47_0x1f01();let _0x554c90=_0x1f01b2[_0x53dbe1];return _0x554c90;}const bcryptjs_1=__importDefault(require(a47_0x4c8705(0x1d6))),jsonwebtoken_1=__importDefault(require(a47_0x4c8705(0x1d7))),database_1=__importDefault(require(a47_0x4c8705(0x1e3))),config_1=require(a47_0x4c8705(0x1d8));class AuthService{[a47_0x4c8705(0x1e4)](_0xc0ce3b){const _0x4792c9=a47_0x4c8705;return jsonwebtoken_1[_0x4792c9(0x1f8)][_0x4792c9(0x1df)](_0xc0ce3b,config_1[_0x4792c9(0x1e9)][_0x4792c9(0x1ef)][_0x4792c9(0x1f7)],{'expiresIn':String(config_1[_0x4792c9(0x1e9)][_0x4792c9(0x1ef)]['expiresIn'])});}async[a47_0x4c8705(0x1f5)](_0x11a16a){const _0x6a2804=a47_0x4c8705,{username:_0x17c17e,password:_0x1f339a}=_0x11a16a;if(_0x17c17e===config_1[_0x6a2804(0x1e9)][_0x6a2804(0x1ee)][_0x6a2804(0x1f2)]){const _0x10ecba=await bcryptjs_1['default']['compare'](_0x1f339a,config_1[_0x6a2804(0x1e9)][_0x6a2804(0x1ee)][_0x6a2804(0x1ea)]);if(_0x10ecba){const _0x446ece=this[_0x6a2804(0x1e4)]({'id':'admin','username':config_1[_0x6a2804(0x1e9)][_0x6a2804(0x1ee)]['username'],'role':_0x6a2804(0x1ee)});return{'access_token':_0x446ece,'role':'admin'};}}const _0x45fc0a=await database_1['default'][_0x6a2804(0x1f4)][_0x6a2804(0x1d4)]({'where':{'username':_0x17c17e},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x45fc0a)throw new Error(_0x6a2804(0x1eb));if(_0x45fc0a[_0x6a2804(0x1e6)]!==_0x6a2804(0x1d9))throw new Error('Account\x20is\x20not\x20active');const _0x1a3b51=await bcryptjs_1[_0x6a2804(0x1f8)][_0x6a2804(0x1ec)](_0x1f339a,_0x45fc0a[_0x6a2804(0x1e8)]);if(!_0x1a3b51)throw new Error(_0x6a2804(0x1eb));const _0x3fb971=this['generateToken']({'id':_0x45fc0a['id'],'username':_0x45fc0a[_0x6a2804(0x1f2)],'role':_0x6a2804(0x1f4)});return{'access_token':_0x3fb971,'role':_0x6a2804(0x1f4),'user':{'id':_0x45fc0a['id'],'name':_0x45fc0a[_0x6a2804(0x1e7)],'username':_0x45fc0a[_0x6a2804(0x1f2)]}};}async[a47_0x4c8705(0x1dc)](_0x160fc6){const _0x453ccb=a47_0x4c8705;try{const _0x3b8008=jsonwebtoken_1[_0x453ccb(0x1f8)]['verify'](_0x160fc6,config_1[_0x453ccb(0x1e9)][_0x453ccb(0x1ef)][_0x453ccb(0x1f7)]);return _0x3b8008;}catch(_0x247fe5){throw new Error(_0x453ccb(0x1e5));}}}exports[a47_0x4c8705(0x1f6)]=AuthService;