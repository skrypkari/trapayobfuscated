'use strict';const a36_0x282edd=a36_0x7927;(function(_0x2eb597,_0x41bd3e){const _0x16662f=a36_0x7927,_0x3ab5d8=_0x2eb597();while(!![]){try{const _0x216a34=parseInt(_0x16662f(0x196))/0x1+-parseInt(_0x16662f(0x19c))/0x2+-parseInt(_0x16662f(0x19b))/0x3+-parseInt(_0x16662f(0x17f))/0x4+parseInt(_0x16662f(0x197))/0x5*(parseInt(_0x16662f(0x180))/0x6)+parseInt(_0x16662f(0x19e))/0x7+-parseInt(_0x16662f(0x19d))/0x8;if(_0x216a34===_0x41bd3e)break;else _0x3ab5d8['push'](_0x3ab5d8['shift']());}catch(_0x48b5c5){_0x3ab5d8['push'](_0x3ab5d8['shift']());}}}(a36_0x427e,0x418e3));function a36_0x7927(_0x18bf6c,_0x70ebc5){const _0x427e55=a36_0x427e();return a36_0x7927=function(_0x79273e,_0x1891f3){_0x79273e=_0x79273e-0x17f;let _0x1f7788=_0x427e55[_0x79273e];return _0x1f7788;},a36_0x7927(_0x18bf6c,_0x70ebc5);}var __importDefault=this&&this[a36_0x282edd(0x1a0)]||function(_0x26d9a1){const _0x264124=a36_0x282edd;return _0x26d9a1&&_0x26d9a1[_0x264124(0x182)]?_0x26d9a1:{'default':_0x26d9a1};};Object[a36_0x282edd(0x1a1)](exports,a36_0x282edd(0x182),{'value':!![]}),exports[a36_0x282edd(0x18e)]=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),jsonwebtoken_1=__importDefault(require(a36_0x282edd(0x198))),database_1=__importDefault(require(a36_0x282edd(0x195))),config_1=require('../config/config');class AuthService{[a36_0x282edd(0x19f)](_0x52d21e){const _0xf00b1c=a36_0x282edd;return jsonwebtoken_1[_0xf00b1c(0x188)][_0xf00b1c(0x192)](_0x52d21e,config_1[_0xf00b1c(0x185)][_0xf00b1c(0x189)][_0xf00b1c(0x18f)],{'expiresIn':String(config_1[_0xf00b1c(0x185)][_0xf00b1c(0x189)][_0xf00b1c(0x190)])});}async[a36_0x282edd(0x19a)](_0x32631c){const _0x378c61=a36_0x282edd,{username:_0x2b47a8,password:_0x1ecae9}=_0x32631c;if(_0x2b47a8===config_1['config']['admin']['username']){const _0x2d90ba=await bcryptjs_1[_0x378c61(0x188)][_0x378c61(0x1a2)](_0x1ecae9,config_1[_0x378c61(0x185)][_0x378c61(0x194)]['passwordHash']);if(_0x2d90ba){const _0x1f32d2=this['generateToken']({'id':'admin','username':config_1['config'][_0x378c61(0x194)]['username'],'role':'admin'});return{'access_token':_0x1f32d2,'role':_0x378c61(0x194)};}}const _0x2fb729=await database_1['default'][_0x378c61(0x186)][_0x378c61(0x18a)]({'where':{'username':_0x2b47a8},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x2fb729)throw new Error(_0x378c61(0x193));if(_0x2fb729[_0x378c61(0x187)]!==_0x378c61(0x18b))throw new Error(_0x378c61(0x181));const _0x2da432=await bcryptjs_1[_0x378c61(0x188)]['compare'](_0x1ecae9,_0x2fb729[_0x378c61(0x18d)]);if(!_0x2da432)throw new Error('Invalid\x20credentials');const _0x325e84=this['generateToken']({'id':_0x2fb729['id'],'username':_0x2fb729['username'],'role':'shop'});return{'access_token':_0x325e84,'role':_0x378c61(0x186),'user':{'id':_0x2fb729['id'],'name':_0x2fb729[_0x378c61(0x191)],'username':_0x2fb729[_0x378c61(0x199)]}};}async[a36_0x282edd(0x18c)](_0x511236){const _0x1f9eb3=a36_0x282edd;try{const _0x308636=jsonwebtoken_1[_0x1f9eb3(0x188)][_0x1f9eb3(0x184)](_0x511236,config_1[_0x1f9eb3(0x185)][_0x1f9eb3(0x189)][_0x1f9eb3(0x18f)]);return _0x308636;}catch(_0x50be78){throw new Error(_0x1f9eb3(0x183));}}}function a36_0x427e(){const _0x2fb170=['default','jwt','findUnique','ACTIVE','verifyToken','password','AuthService','secret','expiresIn','name','sign','Invalid\x20credentials','admin','../config/database','459869nckEBS','5JoMLBT','jsonwebtoken','username','login','1446996LcxXVk','195780ztadhe','993672GuoimL','2859647pMxwSr','generateToken','__importDefault','defineProperty','compare','1533852spRMoa','2928114JzEDak','Account\x20is\x20not\x20active','__esModule','Invalid\x20token','verify','config','shop','status'];a36_0x427e=function(){return _0x2fb170;};return a36_0x427e();}exports[a36_0x282edd(0x18e)]=AuthService;