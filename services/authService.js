'use strict';function a34_0x1892(_0x5bd024,_0x4debfb){const _0x3c17a5=a34_0x3c17();return a34_0x1892=function(_0x189217,_0x263807){_0x189217=_0x189217-0x1a2;let _0xacb8c1=_0x3c17a5[_0x189217];return _0xacb8c1;},a34_0x1892(_0x5bd024,_0x4debfb);}const a34_0x2a1ae8=a34_0x1892;(function(_0x4b0da,_0x23ff0c){const _0x2709a3=a34_0x1892,_0x2d5606=_0x4b0da();while(!![]){try{const _0x2e68e7=-parseInt(_0x2709a3(0x1b1))/0x1+-parseInt(_0x2709a3(0x1c5))/0x2+parseInt(_0x2709a3(0x1a2))/0x3+parseInt(_0x2709a3(0x1a5))/0x4+parseInt(_0x2709a3(0x1ab))/0x5+-parseInt(_0x2709a3(0x1be))/0x6*(parseInt(_0x2709a3(0x1a6))/0x7)+parseInt(_0x2709a3(0x1a9))/0x8*(-parseInt(_0x2709a3(0x1c3))/0x9);if(_0x2e68e7===_0x23ff0c)break;else _0x2d5606['push'](_0x2d5606['shift']());}catch(_0x2f6c25){_0x2d5606['push'](_0x2d5606['shift']());}}}(a34_0x3c17,0x4b6a8));var __importDefault=this&&this[a34_0x2a1ae8(0x1ad)]||function(_0x3bab69){const _0x4f164d=a34_0x2a1ae8;return _0x3bab69&&_0x3bab69[_0x4f164d(0x1c0)]?_0x3bab69:{'default':_0x3bab69};};Object[a34_0x2a1ae8(0x1bc)](exports,a34_0x2a1ae8(0x1c0),{'value':!![]}),exports[a34_0x2a1ae8(0x1a3)]=void 0x0;const bcryptjs_1=__importDefault(require(a34_0x2a1ae8(0x1ba))),jsonwebtoken_1=__importDefault(require(a34_0x2a1ae8(0x1b0))),database_1=__importDefault(require(a34_0x2a1ae8(0x1c1))),config_1=require(a34_0x2a1ae8(0x1a8));class AuthService{[a34_0x2a1ae8(0x1bb)](_0x397f12){const _0x41724e=a34_0x2a1ae8;return jsonwebtoken_1['default'][_0x41724e(0x1aa)](_0x397f12,config_1[_0x41724e(0x1b6)][_0x41724e(0x1b7)][_0x41724e(0x1ae)],{'expiresIn':String(config_1['config'][_0x41724e(0x1b7)][_0x41724e(0x1b3)])});}async[a34_0x2a1ae8(0x1ac)](_0x48679f){const _0x16f5c3=a34_0x2a1ae8,{username:_0x574085,password:_0xec6385}=_0x48679f;if(_0x574085===config_1[_0x16f5c3(0x1b6)]['admin'][_0x16f5c3(0x1b2)]){const _0x3cee2a=await bcryptjs_1['default'][_0x16f5c3(0x1b8)](_0xec6385,config_1[_0x16f5c3(0x1b6)]['admin'][_0x16f5c3(0x1a4)]);if(_0x3cee2a){const _0x184f8c=this[_0x16f5c3(0x1bb)]({'id':_0x16f5c3(0x1b5),'username':config_1[_0x16f5c3(0x1b6)][_0x16f5c3(0x1b5)]['username'],'role':'admin'});return{'access_token':_0x184f8c,'role':'admin'};}}const _0x46be0a=await database_1[_0x16f5c3(0x1b9)][_0x16f5c3(0x1c4)]['findUnique']({'where':{'username':_0x574085},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x46be0a)throw new Error(_0x16f5c3(0x1a7));if(_0x46be0a['status']!==_0x16f5c3(0x1bf))throw new Error(_0x16f5c3(0x1af));const _0x14cb70=await bcryptjs_1[_0x16f5c3(0x1b9)][_0x16f5c3(0x1b8)](_0xec6385,_0x46be0a[_0x16f5c3(0x1b4)]);if(!_0x14cb70)throw new Error('Invalid\x20credentials');const _0x754165=this[_0x16f5c3(0x1bb)]({'id':_0x46be0a['id'],'username':_0x46be0a[_0x16f5c3(0x1b2)],'role':_0x16f5c3(0x1c4)});return{'access_token':_0x754165,'role':_0x16f5c3(0x1c4),'user':{'id':_0x46be0a['id'],'name':_0x46be0a['name'],'username':_0x46be0a[_0x16f5c3(0x1b2)]}};}async[a34_0x2a1ae8(0x1bd)](_0x386a86){const _0x59163c=a34_0x2a1ae8;try{const _0xf4d561=jsonwebtoken_1[_0x59163c(0x1b9)][_0x59163c(0x1c2)](_0x386a86,config_1[_0x59163c(0x1b6)][_0x59163c(0x1b7)]['secret']);return _0xf4d561;}catch(_0x52465c){throw new Error('Invalid\x20token');}}}exports[a34_0x2a1ae8(0x1a3)]=AuthService;function a34_0x3c17(){const _0x436578=['ACTIVE','__esModule','../config/database','verify','4743cxEyLs','shop','438754ArOpBe','600309xItAYv','AuthService','passwordHash','1252040tyZiwu','7rVstlZ','Invalid\x20credentials','../config/config','2096gQVdtS','sign','2811945ftHcyo','login','__importDefault','secret','Account\x20is\x20not\x20active','jsonwebtoken','17780nOjXAh','username','expiresIn','password','admin','config','jwt','compare','default','bcryptjs','generateToken','defineProperty','verifyToken','2348202LqIqRJ'];a34_0x3c17=function(){return _0x436578;};return a34_0x3c17();}