'use strict';const a41_0x422ad5=a41_0x5647;(function(_0x21dedc,_0x102f3c){const _0x439ad9=a41_0x5647,_0x4cd415=_0x21dedc();while(!![]){try{const _0x4f7fe3=-parseInt(_0x439ad9(0x107))/0x1*(-parseInt(_0x439ad9(0x121))/0x2)+parseInt(_0x439ad9(0x112))/0x3+parseInt(_0x439ad9(0x110))/0x4+-parseInt(_0x439ad9(0x10c))/0x5+-parseInt(_0x439ad9(0x125))/0x6+-parseInt(_0x439ad9(0x108))/0x7*(parseInt(_0x439ad9(0x106))/0x8)+parseInt(_0x439ad9(0x10a))/0x9*(-parseInt(_0x439ad9(0x117))/0xa);if(_0x4f7fe3===_0x102f3c)break;else _0x4cd415['push'](_0x4cd415['shift']());}catch(_0x4e8147){_0x4cd415['push'](_0x4cd415['shift']());}}}(a41_0x4b23,0x69f34));function a41_0x4b23(){const _0x174917=['AuthService','Invalid\x20credentials','1069776ClQVyC','admin','1651917cTCMcb','ACTIVE','Invalid\x20token','jwt','verify','10TkabGB','__esModule','compare','config','findUnique','Account\x20is\x20not\x20active','name','default','defineProperty','shop','1438EpeZvK','secret','sign','passwordHash','1799706wBwuMM','generateToken','login','13032IyvxKO','929ntbdrL','2625thUpsS','expiresIn','483696FyfufS','username','437460xRrThX','password'];a41_0x4b23=function(){return _0x174917;};return a41_0x4b23();}var __importDefault=this&&this['__importDefault']||function(_0x4c78d4){return _0x4c78d4&&_0x4c78d4['__esModule']?_0x4c78d4:{'default':_0x4c78d4};};function a41_0x5647(_0x16c90d,_0x2ab8cc){const _0x4b2381=a41_0x4b23();return a41_0x5647=function(_0x5647d1,_0x4895e1){_0x5647d1=_0x5647d1-0x106;let _0x5745a8=_0x4b2381[_0x5647d1];return _0x5745a8;},a41_0x5647(_0x16c90d,_0x2ab8cc);}Object[a41_0x422ad5(0x11f)](exports,a41_0x422ad5(0x118),{'value':!![]}),exports['AuthService']=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),jsonwebtoken_1=__importDefault(require('jsonwebtoken')),database_1=__importDefault(require('../config/database')),config_1=require('../config/config');class AuthService{[a41_0x422ad5(0x126)](_0x102e21){const _0x427aad=a41_0x422ad5;return jsonwebtoken_1[_0x427aad(0x11e)][_0x427aad(0x123)](_0x102e21,config_1[_0x427aad(0x11a)]['jwt']['secret'],{'expiresIn':String(config_1['config']['jwt'][_0x427aad(0x109)])});}async[a41_0x422ad5(0x127)](_0x48f6da){const _0x38d5de=a41_0x422ad5,{username:_0x383090,password:_0x353d56}=_0x48f6da;if(_0x383090===config_1[_0x38d5de(0x11a)][_0x38d5de(0x111)][_0x38d5de(0x10b)]){const _0x5c67e7=await bcryptjs_1[_0x38d5de(0x11e)][_0x38d5de(0x119)](_0x353d56,config_1[_0x38d5de(0x11a)][_0x38d5de(0x111)][_0x38d5de(0x124)]);if(_0x5c67e7){const _0x5bfe08=this[_0x38d5de(0x126)]({'id':_0x38d5de(0x111),'username':config_1['config'][_0x38d5de(0x111)]['username'],'role':_0x38d5de(0x111)});return{'access_token':_0x5bfe08,'role':'admin'};}}const _0x5905cb=await database_1[_0x38d5de(0x11e)][_0x38d5de(0x120)][_0x38d5de(0x11b)]({'where':{'username':_0x383090},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x5905cb)throw new Error(_0x38d5de(0x10f));if(_0x5905cb['status']!==_0x38d5de(0x113))throw new Error(_0x38d5de(0x11c));const _0x403e9e=await bcryptjs_1[_0x38d5de(0x11e)][_0x38d5de(0x119)](_0x353d56,_0x5905cb[_0x38d5de(0x10d)]);if(!_0x403e9e)throw new Error(_0x38d5de(0x10f));const _0x3bc2a6=this[_0x38d5de(0x126)]({'id':_0x5905cb['id'],'username':_0x5905cb['username'],'role':_0x38d5de(0x120)});return{'access_token':_0x3bc2a6,'role':_0x38d5de(0x120),'user':{'id':_0x5905cb['id'],'name':_0x5905cb[_0x38d5de(0x11d)],'username':_0x5905cb['username']}};}async['verifyToken'](_0x5c7fa2){const _0x13aca2=a41_0x422ad5;try{const _0x4a5190=jsonwebtoken_1[_0x13aca2(0x11e)][_0x13aca2(0x116)](_0x5c7fa2,config_1['config'][_0x13aca2(0x115)][_0x13aca2(0x122)]);return _0x4a5190;}catch(_0x4f9cac){throw new Error(_0x13aca2(0x114));}}}exports[a41_0x422ad5(0x10e)]=AuthService;