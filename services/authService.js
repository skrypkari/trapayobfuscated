'use strict';const a36_0x32c215=a36_0x120d;function a36_0x120d(_0x4f4038,_0x13bd0d){const _0x4c3d9d=a36_0x4c3d();return a36_0x120d=function(_0x120d56,_0x496cd1){_0x120d56=_0x120d56-0xdd;let _0x79a59f=_0x4c3d9d[_0x120d56];return _0x79a59f;},a36_0x120d(_0x4f4038,_0x13bd0d);}(function(_0x57e975,_0x43184e){const _0x12654e=a36_0x120d,_0xdcd9eb=_0x57e975();while(!![]){try{const _0x141025=parseInt(_0x12654e(0xf4))/0x1*(-parseInt(_0x12654e(0xf5))/0x2)+-parseInt(_0x12654e(0xeb))/0x3+-parseInt(_0x12654e(0xe2))/0x4*(-parseInt(_0x12654e(0xf0))/0x5)+parseInt(_0x12654e(0x100))/0x6+parseInt(_0x12654e(0xfa))/0x7+-parseInt(_0x12654e(0xdd))/0x8*(-parseInt(_0x12654e(0xfc))/0x9)+-parseInt(_0x12654e(0xf8))/0xa;if(_0x141025===_0x43184e)break;else _0xdcd9eb['push'](_0xdcd9eb['shift']());}catch(_0x29d43e){_0xdcd9eb['push'](_0xdcd9eb['shift']());}}}(a36_0x4c3d,0xa7b63));var __importDefault=this&&this['__importDefault']||function(_0xa5d544){const _0x17c510=a36_0x120d;return _0xa5d544&&_0xa5d544[_0x17c510(0xfd)]?_0xa5d544:{'default':_0xa5d544};};function a36_0x4c3d(){const _0x54084f=['__esModule','jwt','verifyToken','7107438zGkuka','sign','21336zcYVgW','generateToken','Invalid\x20token','defineProperty','jsonwebtoken','8zAmcBM','secret','compare','findUnique','admin','shop','AuthService','username','login','3188793kozzIx','bcryptjs','name','password','Account\x20is\x20not\x20active','1831895nsHSdG','verify','ACTIVE','config','1ZBEykf','1898674zzPkpp','default','../config/database','4018020IpwOLM','Invalid\x20credentials','6960303guBFME','status','639xdNEnG'];a36_0x4c3d=function(){return _0x54084f;};return a36_0x4c3d();}Object[a36_0x32c215(0xe0)](exports,a36_0x32c215(0xfd),{'value':!![]}),exports[a36_0x32c215(0xe8)]=void 0x0;const bcryptjs_1=__importDefault(require(a36_0x32c215(0xec))),jsonwebtoken_1=__importDefault(require(a36_0x32c215(0xe1))),database_1=__importDefault(require(a36_0x32c215(0xf7))),config_1=require('../config/config');class AuthService{[a36_0x32c215(0xde)](_0x2b2d95){const _0x2e47f5=a36_0x32c215;return jsonwebtoken_1[_0x2e47f5(0xf6)][_0x2e47f5(0x101)](_0x2b2d95,config_1[_0x2e47f5(0xf3)][_0x2e47f5(0xfe)][_0x2e47f5(0xe3)],{'expiresIn':String(config_1[_0x2e47f5(0xf3)][_0x2e47f5(0xfe)]['expiresIn'])});}async[a36_0x32c215(0xea)](_0x1247e7){const _0x1d581c=a36_0x32c215,{username:_0x2195f2,password:_0x2c3f6b}=_0x1247e7;if(_0x2195f2===config_1[_0x1d581c(0xf3)][_0x1d581c(0xe6)][_0x1d581c(0xe9)]){const _0x1ac4f1=await bcryptjs_1['default'][_0x1d581c(0xe4)](_0x2c3f6b,config_1[_0x1d581c(0xf3)]['admin']['passwordHash']);if(_0x1ac4f1){const _0x5b3a3c=this[_0x1d581c(0xde)]({'id':_0x1d581c(0xe6),'username':config_1['config'][_0x1d581c(0xe6)][_0x1d581c(0xe9)],'role':_0x1d581c(0xe6)});return{'access_token':_0x5b3a3c,'role':'admin'};}}const _0x5e0d91=await database_1[_0x1d581c(0xf6)][_0x1d581c(0xe7)][_0x1d581c(0xe5)]({'where':{'username':_0x2195f2},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x5e0d91)throw new Error(_0x1d581c(0xf9));if(_0x5e0d91[_0x1d581c(0xfb)]!==_0x1d581c(0xf2))throw new Error(_0x1d581c(0xef));const _0x40d4b8=await bcryptjs_1[_0x1d581c(0xf6)][_0x1d581c(0xe4)](_0x2c3f6b,_0x5e0d91[_0x1d581c(0xee)]);if(!_0x40d4b8)throw new Error(_0x1d581c(0xf9));const _0x3e5d5c=this[_0x1d581c(0xde)]({'id':_0x5e0d91['id'],'username':_0x5e0d91[_0x1d581c(0xe9)],'role':_0x1d581c(0xe7)});return{'access_token':_0x3e5d5c,'role':_0x1d581c(0xe7),'user':{'id':_0x5e0d91['id'],'name':_0x5e0d91[_0x1d581c(0xed)],'username':_0x5e0d91[_0x1d581c(0xe9)]}};}async[a36_0x32c215(0xff)](_0x1eec2e){const _0x51e240=a36_0x32c215;try{const _0x3efc4a=jsonwebtoken_1['default'][_0x51e240(0xf1)](_0x1eec2e,config_1[_0x51e240(0xf3)]['jwt'][_0x51e240(0xe3)]);return _0x3efc4a;}catch(_0x410759){throw new Error(_0x51e240(0xdf));}}}exports[a36_0x32c215(0xe8)]=AuthService;