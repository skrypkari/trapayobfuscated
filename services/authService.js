'use strict';const a34_0x1a580b=a34_0x2e35;(function(_0x4a4f2b,_0x260127){const _0x16f5b6=a34_0x2e35,_0x164e64=_0x4a4f2b();while(!![]){try{const _0x23acda=parseInt(_0x16f5b6(0x1ab))/0x1+parseInt(_0x16f5b6(0x1a5))/0x2+parseInt(_0x16f5b6(0x1aa))/0x3+parseInt(_0x16f5b6(0x1a6))/0x4+-parseInt(_0x16f5b6(0x19b))/0x5*(parseInt(_0x16f5b6(0x192))/0x6)+parseInt(_0x16f5b6(0x1a3))/0x7+parseInt(_0x16f5b6(0x1a2))/0x8*(-parseInt(_0x16f5b6(0x1b2))/0x9);if(_0x23acda===_0x260127)break;else _0x164e64['push'](_0x164e64['shift']());}catch(_0x3b5dfc){_0x164e64['push'](_0x164e64['shift']());}}}(a34_0x2644,0x7256f));function a34_0x2e35(_0x2ebc51,_0x36b9b5){const _0x264454=a34_0x2644();return a34_0x2e35=function(_0x2e3536,_0x2e709c){_0x2e3536=_0x2e3536-0x192;let _0x39e321=_0x264454[_0x2e3536];return _0x39e321;},a34_0x2e35(_0x2ebc51,_0x36b9b5);}var __importDefault=this&&this[a34_0x1a580b(0x1b0)]||function(_0x48ad03){const _0x41e183=a34_0x1a580b;return _0x48ad03&&_0x48ad03[_0x41e183(0x1b4)]?_0x48ad03:{'default':_0x48ad03};};Object['defineProperty'](exports,a34_0x1a580b(0x1b4),{'value':!![]}),exports[a34_0x1a580b(0x195)]=void 0x0;function a34_0x2644(){const _0xfc267c=['generateToken','15723tsaxvT','secret','__esModule','shop','519438gWnrLM','config','../config/database','AuthService','expiresIn','jsonwebtoken','jwt','default','compare','5Iyblld','name','Invalid\x20token','verify','username','Account\x20is\x20not\x20active','sign','9688dgLItf','5469863UxErot','Invalid\x20credentials','1585662rWpHwE','2544UEJuRF','passwordHash','findUnique','status','2317293wUpJdk','323218hyuPJc','../config/config','admin','password','login','__importDefault'];a34_0x2644=function(){return _0xfc267c;};return a34_0x2644();}const bcryptjs_1=__importDefault(require('bcryptjs')),jsonwebtoken_1=__importDefault(require(a34_0x1a580b(0x197))),database_1=__importDefault(require(a34_0x1a580b(0x194))),config_1=require(a34_0x1a580b(0x1ac));class AuthService{[a34_0x1a580b(0x1b1)](_0x2f2c0c){const _0x9f3492=a34_0x1a580b;return jsonwebtoken_1['default'][_0x9f3492(0x1a1)](_0x2f2c0c,config_1['config'][_0x9f3492(0x198)][_0x9f3492(0x1b3)],{'expiresIn':String(config_1['config'][_0x9f3492(0x198)][_0x9f3492(0x196)])});}async[a34_0x1a580b(0x1af)](_0x3bbe28){const _0x27f0b8=a34_0x1a580b,{username:_0x42347b,password:_0x3ae0e0}=_0x3bbe28;if(_0x42347b===config_1[_0x27f0b8(0x193)]['admin']['username']){const _0x68e6f6=await bcryptjs_1[_0x27f0b8(0x199)][_0x27f0b8(0x19a)](_0x3ae0e0,config_1[_0x27f0b8(0x193)][_0x27f0b8(0x1ad)][_0x27f0b8(0x1a7)]);if(_0x68e6f6){const _0xe4e52f=this[_0x27f0b8(0x1b1)]({'id':_0x27f0b8(0x1ad),'username':config_1[_0x27f0b8(0x193)][_0x27f0b8(0x1ad)][_0x27f0b8(0x19f)],'role':_0x27f0b8(0x1ad)});return{'access_token':_0xe4e52f,'role':_0x27f0b8(0x1ad)};}}const _0x229f9f=await database_1['default'][_0x27f0b8(0x1b5)][_0x27f0b8(0x1a8)]({'where':{'username':_0x42347b},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x229f9f)throw new Error(_0x27f0b8(0x1a4));if(_0x229f9f[_0x27f0b8(0x1a9)]!=='ACTIVE')throw new Error(_0x27f0b8(0x1a0));const _0x591579=await bcryptjs_1[_0x27f0b8(0x199)][_0x27f0b8(0x19a)](_0x3ae0e0,_0x229f9f[_0x27f0b8(0x1ae)]);if(!_0x591579)throw new Error(_0x27f0b8(0x1a4));const _0x50be80=this['generateToken']({'id':_0x229f9f['id'],'username':_0x229f9f[_0x27f0b8(0x19f)],'role':_0x27f0b8(0x1b5)});return{'access_token':_0x50be80,'role':'shop','user':{'id':_0x229f9f['id'],'name':_0x229f9f[_0x27f0b8(0x19c)],'username':_0x229f9f[_0x27f0b8(0x19f)]}};}async['verifyToken'](_0x127146){const _0x5cf930=a34_0x1a580b;try{const _0x2af4b3=jsonwebtoken_1[_0x5cf930(0x199)][_0x5cf930(0x19e)](_0x127146,config_1['config'][_0x5cf930(0x198)][_0x5cf930(0x1b3)]);return _0x2af4b3;}catch(_0x25fe0a){throw new Error(_0x5cf930(0x19d));}}}exports[a34_0x1a580b(0x195)]=AuthService;