'use strict';const a36_0x2507aa=a36_0x47d1;(function(_0x32728f,_0x28a8ab){const _0x5dd82f=a36_0x47d1,_0x1dd227=_0x32728f();while(!![]){try{const _0x591933=-parseInt(_0x5dd82f(0x104))/0x1*(-parseInt(_0x5dd82f(0x109))/0x2)+-parseInt(_0x5dd82f(0x103))/0x3+parseInt(_0x5dd82f(0x111))/0x4+-parseInt(_0x5dd82f(0x10b))/0x5*(parseInt(_0x5dd82f(0xfe))/0x6)+parseInt(_0x5dd82f(0x107))/0x7+-parseInt(_0x5dd82f(0x10f))/0x8*(parseInt(_0x5dd82f(0x11f))/0x9)+-parseInt(_0x5dd82f(0x101))/0xa*(parseInt(_0x5dd82f(0x108))/0xb);if(_0x591933===_0x28a8ab)break;else _0x1dd227['push'](_0x1dd227['shift']());}catch(_0x3babda){_0x1dd227['push'](_0x1dd227['shift']());}}}(a36_0xc1b2,0x1d994));var __importDefault=this&&this[a36_0x2507aa(0xfb)]||function(_0x16156f){return _0x16156f&&_0x16156f['__esModule']?_0x16156f:{'default':_0x16156f};};Object[a36_0x2507aa(0x10a)](exports,'__esModule',{'value':!![]}),exports[a36_0x2507aa(0x10d)]=void 0x0;const bcryptjs_1=__importDefault(require(a36_0x2507aa(0x115))),jsonwebtoken_1=__importDefault(require(a36_0x2507aa(0x106))),database_1=__importDefault(require(a36_0x2507aa(0x113))),config_1=require(a36_0x2507aa(0xfd));class AuthService{[a36_0x2507aa(0x11e)](_0x523fff){const _0x114dfc=a36_0x2507aa;return jsonwebtoken_1[_0x114dfc(0xf9)][_0x114dfc(0x114)](_0x523fff,config_1[_0x114dfc(0x112)][_0x114dfc(0x110)][_0x114dfc(0x119)],{'expiresIn':String(config_1[_0x114dfc(0x112)][_0x114dfc(0x110)]['expiresIn'])});}async[a36_0x2507aa(0xff)](_0x469d4a){const _0x2b0f49=a36_0x2507aa,{username:_0x308b93,password:_0x58592b}=_0x469d4a;if(_0x308b93===config_1[_0x2b0f49(0x112)][_0x2b0f49(0xfc)][_0x2b0f49(0x116)]){const _0xf7bd46=await bcryptjs_1[_0x2b0f49(0xf9)][_0x2b0f49(0x11b)](_0x58592b,config_1[_0x2b0f49(0x112)][_0x2b0f49(0xfc)][_0x2b0f49(0x10c)]);if(_0xf7bd46){const _0x356b9d=this[_0x2b0f49(0x11e)]({'id':'admin','username':config_1[_0x2b0f49(0x112)][_0x2b0f49(0xfc)][_0x2b0f49(0x116)],'role':_0x2b0f49(0xfc)});return{'access_token':_0x356b9d,'role':_0x2b0f49(0xfc)};}}const _0x1b7982=await database_1['default'][_0x2b0f49(0x11a)][_0x2b0f49(0x105)]({'where':{'username':_0x308b93},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x1b7982)throw new Error(_0x2b0f49(0x102));if(_0x1b7982[_0x2b0f49(0x11d)]!==_0x2b0f49(0x117))throw new Error('Account\x20is\x20not\x20active');const _0x5eeab1=await bcryptjs_1['default']['compare'](_0x58592b,_0x1b7982[_0x2b0f49(0x10e)]);if(!_0x5eeab1)throw new Error('Invalid\x20credentials');const _0x584c38=this[_0x2b0f49(0x11e)]({'id':_0x1b7982['id'],'username':_0x1b7982['username'],'role':_0x2b0f49(0x11a)});return{'access_token':_0x584c38,'role':_0x2b0f49(0x11a),'user':{'id':_0x1b7982['id'],'name':_0x1b7982[_0x2b0f49(0x118)],'username':_0x1b7982['username']}};}async[a36_0x2507aa(0x100)](_0x4d0617){const _0x4b74d1=a36_0x2507aa;try{const _0x496cac=jsonwebtoken_1[_0x4b74d1(0xf9)][_0x4b74d1(0xfa)](_0x4d0617,config_1['config'][_0x4b74d1(0x110)][_0x4b74d1(0x119)]);return _0x496cac;}catch(_0x1de7a1){throw new Error(_0x4b74d1(0x11c));}}}function a36_0xc1b2(){const _0x51740d=['status','generateToken','849951LhLukG','default','verify','__importDefault','admin','../config/config','210xZZlGm','login','verifyToken','170vHeeFX','Invalid\x20credentials','202590XJdVCT','378FDJahM','findUnique','jsonwebtoken','785505jmiYpd','5709FALaAI','132DUWfBr','defineProperty','340wbjMqI','passwordHash','AuthService','password','8RgBCoX','jwt','628980hCURMx','config','../config/database','sign','bcryptjs','username','ACTIVE','name','secret','shop','compare','Invalid\x20token'];a36_0xc1b2=function(){return _0x51740d;};return a36_0xc1b2();}function a36_0x47d1(_0x2987b6,_0x15d617){const _0xc1b255=a36_0xc1b2();return a36_0x47d1=function(_0x47d1ae,_0x19e206){_0x47d1ae=_0x47d1ae-0xf9;let _0x40085f=_0xc1b255[_0x47d1ae];return _0x40085f;},a36_0x47d1(_0x2987b6,_0x15d617);}exports[a36_0x2507aa(0x10d)]=AuthService;