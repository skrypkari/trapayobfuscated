'use strict';const a49_0x19a945=a49_0x46f6;(function(_0x4859ae,_0xd1aa8c){const _0x594e66=a49_0x46f6,_0x4f83d5=_0x4859ae();while(!![]){try{const _0x4d0aec=parseInt(_0x594e66(0x1cf))/0x1+parseInt(_0x594e66(0x1bf))/0x2+parseInt(_0x594e66(0x1c1))/0x3*(-parseInt(_0x594e66(0x1b2))/0x4)+parseInt(_0x594e66(0x1cb))/0x5+parseInt(_0x594e66(0x1b5))/0x6+-parseInt(_0x594e66(0x1c9))/0x7*(parseInt(_0x594e66(0x1b4))/0x8)+parseInt(_0x594e66(0x1cc))/0x9;if(_0x4d0aec===_0xd1aa8c)break;else _0x4f83d5['push'](_0x4f83d5['shift']());}catch(_0x542e49){_0x4f83d5['push'](_0x4f83d5['shift']());}}}(a49_0x2f4a,0x1a814));function a49_0x2f4a(){const _0x4a9cb8=['914598UTHaJg','../config/config','ACTIVE','Account\x20is\x20not\x20active','passwordHash','__esModule','../config/database','jsonwebtoken','config','username','100492nvJKWi','generateToken','366kIUMAQ','login','default','admin','bcryptjs','jwt','secret','Invalid\x20token','1303862AVBwjS','Invalid\x20credentials','202630EZfRLw','1782333MOeMnj','verifyToken','status','19142pakGhV','name','compare','shop','5428eOZUJW','expiresIn','8Cgmsaw'];a49_0x2f4a=function(){return _0x4a9cb8;};return a49_0x2f4a();}var __importDefault=this&&this['__importDefault']||function(_0x34d1d3){return _0x34d1d3&&_0x34d1d3['__esModule']?_0x34d1d3:{'default':_0x34d1d3};};function a49_0x46f6(_0x5bd205,_0x55a826){_0x5bd205=_0x5bd205-0x1b2;const _0x2f4ab6=a49_0x2f4a();let _0x46f60b=_0x2f4ab6[_0x5bd205];return _0x46f60b;}Object['defineProperty'](exports,a49_0x19a945(0x1ba),{'value':!![]}),exports['AuthService']=void 0x0;const bcryptjs_1=__importDefault(require(a49_0x19a945(0x1c5))),jsonwebtoken_1=__importDefault(require(a49_0x19a945(0x1bc))),database_1=__importDefault(require(a49_0x19a945(0x1bb))),config_1=require(a49_0x19a945(0x1b6));class AuthService{[a49_0x19a945(0x1c0)](_0x58251a){const _0x240fe1=a49_0x19a945;return jsonwebtoken_1['default']['sign'](_0x58251a,config_1[_0x240fe1(0x1bd)][_0x240fe1(0x1c6)][_0x240fe1(0x1c7)],{'expiresIn':String(config_1[_0x240fe1(0x1bd)][_0x240fe1(0x1c6)][_0x240fe1(0x1b3)])});}async[a49_0x19a945(0x1c2)](_0x4e2efd){const _0x43dc5c=a49_0x19a945,{username:_0x51efac,password:_0x45e474}=_0x4e2efd;if(_0x51efac===config_1[_0x43dc5c(0x1bd)][_0x43dc5c(0x1c4)][_0x43dc5c(0x1be)]){const _0xf677b0=await bcryptjs_1['default'][_0x43dc5c(0x1d1)](_0x45e474,config_1[_0x43dc5c(0x1bd)][_0x43dc5c(0x1c4)][_0x43dc5c(0x1b9)]);if(_0xf677b0){const _0x3b5117=this[_0x43dc5c(0x1c0)]({'id':_0x43dc5c(0x1c4),'username':config_1[_0x43dc5c(0x1bd)][_0x43dc5c(0x1c4)]['username'],'role':'admin'});return{'access_token':_0x3b5117,'role':'admin'};}}const _0x5c23aa=await database_1[_0x43dc5c(0x1c3)][_0x43dc5c(0x1d2)]['findUnique']({'where':{'username':_0x51efac},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x5c23aa)throw new Error(_0x43dc5c(0x1ca));if(_0x5c23aa[_0x43dc5c(0x1ce)]!==_0x43dc5c(0x1b7))throw new Error(_0x43dc5c(0x1b8));const _0x505d57=await bcryptjs_1[_0x43dc5c(0x1c3)][_0x43dc5c(0x1d1)](_0x45e474,_0x5c23aa['password']);if(!_0x505d57)throw new Error(_0x43dc5c(0x1ca));const _0x4bf4b2=this['generateToken']({'id':_0x5c23aa['id'],'username':_0x5c23aa[_0x43dc5c(0x1be)],'role':_0x43dc5c(0x1d2)});return{'access_token':_0x4bf4b2,'role':_0x43dc5c(0x1d2),'user':{'id':_0x5c23aa['id'],'name':_0x5c23aa[_0x43dc5c(0x1d0)],'username':_0x5c23aa[_0x43dc5c(0x1be)]}};}async[a49_0x19a945(0x1cd)](_0x57b633){const _0x4fb632=a49_0x19a945;try{const _0x443f42=jsonwebtoken_1[_0x4fb632(0x1c3)]['verify'](_0x57b633,config_1[_0x4fb632(0x1bd)][_0x4fb632(0x1c6)][_0x4fb632(0x1c7)]);return _0x443f42;}catch(_0x515d5c){throw new Error(_0x4fb632(0x1c8));}}}exports['AuthService']=AuthService;