'use strict';function a36_0x5cbb(_0x30be0f,_0x484fa9){const _0xf6b574=a36_0xf6b5();return a36_0x5cbb=function(_0x5cbbbd,_0x5f3575){_0x5cbbbd=_0x5cbbbd-0x18d;let _0x207282=_0xf6b574[_0x5cbbbd];return _0x207282;},a36_0x5cbb(_0x30be0f,_0x484fa9);}function a36_0xf6b5(){const _0x20b2c7=['551768xjhEOU','sign','804104bjAEVB','../config/database','verify','Invalid\x20token','30ieQDMB','verifyToken','compare','jwt','jsonwebtoken','login','default','password','AuthService','70vZTose','bcryptjs','name','__esModule','status','27bATKvM','55441VOamRz','admin','742854vzzmiE','secret','shop','passwordHash','16jdRJiQ','ACTIVE','username','config','31432dWYLyp','5653170dyrLwS','11jghvVE','generateToken','8417316RYCBAR'];a36_0xf6b5=function(){return _0x20b2c7;};return a36_0xf6b5();}const a36_0x3cc706=a36_0x5cbb;(function(_0x5476fa,_0x8c394b){const _0x4259f6=a36_0x5cbb,_0x19212f=_0x5476fa();while(!![]){try{const _0x8b2c22=-parseInt(_0x4259f6(0x1a3))/0x1*(parseInt(_0x4259f6(0x1a9))/0x2)+parseInt(_0x4259f6(0x1a5))/0x3+-parseInt(_0x4259f6(0x1ad))/0x4*(parseInt(_0x4259f6(0x19d))/0x5)+-parseInt(_0x4259f6(0x194))/0x6*(-parseInt(_0x4259f6(0x190))/0x7)+-parseInt(_0x4259f6(0x18e))/0x8*(-parseInt(_0x4259f6(0x1a2))/0x9)+parseInt(_0x4259f6(0x1ae))/0xa+parseInt(_0x4259f6(0x1af))/0xb*(-parseInt(_0x4259f6(0x18d))/0xc);if(_0x8b2c22===_0x8c394b)break;else _0x19212f['push'](_0x19212f['shift']());}catch(_0x4f4139){_0x19212f['push'](_0x19212f['shift']());}}}(a36_0xf6b5,0x52d19));var __importDefault=this&&this['__importDefault']||function(_0x57fe74){const _0x4c7db2=a36_0x5cbb;return _0x57fe74&&_0x57fe74[_0x4c7db2(0x1a0)]?_0x57fe74:{'default':_0x57fe74};};Object['defineProperty'](exports,a36_0x3cc706(0x1a0),{'value':!![]}),exports[a36_0x3cc706(0x19c)]=void 0x0;const bcryptjs_1=__importDefault(require(a36_0x3cc706(0x19e))),jsonwebtoken_1=__importDefault(require(a36_0x3cc706(0x198))),database_1=__importDefault(require(a36_0x3cc706(0x191))),config_1=require('../config/config');class AuthService{[a36_0x3cc706(0x1b0)](_0x357d52){const _0x598035=a36_0x3cc706;return jsonwebtoken_1['default'][_0x598035(0x18f)](_0x357d52,config_1[_0x598035(0x1ac)]['jwt'][_0x598035(0x1a6)],{'expiresIn':String(config_1[_0x598035(0x1ac)][_0x598035(0x197)]['expiresIn'])});}async[a36_0x3cc706(0x199)](_0x5708aa){const _0x144b52=a36_0x3cc706,{username:_0x1ccbba,password:_0x394d9c}=_0x5708aa;if(_0x1ccbba===config_1[_0x144b52(0x1ac)][_0x144b52(0x1a4)][_0x144b52(0x1ab)]){const _0x207dbc=await bcryptjs_1['default'][_0x144b52(0x196)](_0x394d9c,config_1[_0x144b52(0x1ac)][_0x144b52(0x1a4)][_0x144b52(0x1a8)]);if(_0x207dbc){const _0x1bcab2=this[_0x144b52(0x1b0)]({'id':_0x144b52(0x1a4),'username':config_1['config'][_0x144b52(0x1a4)][_0x144b52(0x1ab)],'role':_0x144b52(0x1a4)});return{'access_token':_0x1bcab2,'role':_0x144b52(0x1a4)};}}const _0x231e5b=await database_1[_0x144b52(0x19a)]['shop']['findUnique']({'where':{'username':_0x1ccbba},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x231e5b)throw new Error('Invalid\x20credentials');if(_0x231e5b[_0x144b52(0x1a1)]!==_0x144b52(0x1aa))throw new Error('Account\x20is\x20not\x20active');const _0x3cfa0f=await bcryptjs_1['default'][_0x144b52(0x196)](_0x394d9c,_0x231e5b[_0x144b52(0x19b)]);if(!_0x3cfa0f)throw new Error('Invalid\x20credentials');const _0x4f9f73=this[_0x144b52(0x1b0)]({'id':_0x231e5b['id'],'username':_0x231e5b[_0x144b52(0x1ab)],'role':_0x144b52(0x1a7)});return{'access_token':_0x4f9f73,'role':_0x144b52(0x1a7),'user':{'id':_0x231e5b['id'],'name':_0x231e5b[_0x144b52(0x19f)],'username':_0x231e5b['username']}};}async[a36_0x3cc706(0x195)](_0x2f8701){const _0x2d19ee=a36_0x3cc706;try{const _0x1ded6a=jsonwebtoken_1['default'][_0x2d19ee(0x192)](_0x2f8701,config_1[_0x2d19ee(0x1ac)][_0x2d19ee(0x197)]['secret']);return _0x1ded6a;}catch(_0x28852e){throw new Error(_0x2d19ee(0x193));}}}exports['AuthService']=AuthService;