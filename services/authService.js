'use strict';const a47_0x405388=a47_0x3490;function a47_0x3dbd(){const _0x21c29e=['1372104yfitXQ','config','secret','__esModule','shop','generateToken','name','__importDefault','588972Rshwpw','AuthService','login','2240060QuWxhP','78912vepoID','admin','3484092qnDoAg','compare','ACTIVE','sign','username','40zujnUx','defineProperty','Invalid\x20token','6573322eFUhns','Account\x20is\x20not\x20active','../config/database','verifyToken','22418624YmBBzV','default','../config/config','Invalid\x20credentials','jwt'];a47_0x3dbd=function(){return _0x21c29e;};return a47_0x3dbd();}(function(_0x301a53,_0x52a33a){const _0x4cf56e=a47_0x3490,_0x1d989c=_0x301a53();while(!![]){try{const _0x139e4c=-parseInt(_0x4cf56e(0x7d))/0x1+parseInt(_0x4cf56e(0x7c))/0x2+-parseInt(_0x4cf56e(0x7f))/0x3+-parseInt(_0x4cf56e(0x71))/0x4+-parseInt(_0x4cf56e(0x84))/0x5*(parseInt(_0x4cf56e(0x79))/0x6)+-parseInt(_0x4cf56e(0x68))/0x7+parseInt(_0x4cf56e(0x6c))/0x8;if(_0x139e4c===_0x52a33a)break;else _0x1d989c['push'](_0x1d989c['shift']());}catch(_0x3bfbe6){_0x1d989c['push'](_0x1d989c['shift']());}}}(a47_0x3dbd,0x9613a));function a47_0x3490(_0x4a4eb3,_0x340ef4){_0x4a4eb3=_0x4a4eb3-0x67;const _0x3dbd53=a47_0x3dbd();let _0x3490dc=_0x3dbd53[_0x4a4eb3];return _0x3490dc;}var __importDefault=this&&this[a47_0x405388(0x78)]||function(_0x28d4eb){const _0x2644a0=a47_0x405388;return _0x28d4eb&&_0x28d4eb[_0x2644a0(0x74)]?_0x28d4eb:{'default':_0x28d4eb};};Object[a47_0x405388(0x85)](exports,a47_0x405388(0x74),{'value':!![]}),exports['AuthService']=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),jsonwebtoken_1=__importDefault(require('jsonwebtoken')),database_1=__importDefault(require(a47_0x405388(0x6a))),config_1=require(a47_0x405388(0x6e));class AuthService{[a47_0x405388(0x76)](_0xbc1812){const _0x46d92a=a47_0x405388;return jsonwebtoken_1[_0x46d92a(0x6d)][_0x46d92a(0x82)](_0xbc1812,config_1[_0x46d92a(0x72)][_0x46d92a(0x70)][_0x46d92a(0x73)],{'expiresIn':String(config_1['config']['jwt']['expiresIn'])});}async[a47_0x405388(0x7b)](_0x5b60f8){const _0x3b7df5=a47_0x405388,{username:_0x31cc7b,password:_0x563f9c}=_0x5b60f8;if(_0x31cc7b===config_1[_0x3b7df5(0x72)]['admin'][_0x3b7df5(0x83)]){const _0xdf248f=await bcryptjs_1[_0x3b7df5(0x6d)]['compare'](_0x563f9c,config_1[_0x3b7df5(0x72)][_0x3b7df5(0x7e)]['passwordHash']);if(_0xdf248f){const _0x321fd7=this[_0x3b7df5(0x76)]({'id':'admin','username':config_1[_0x3b7df5(0x72)][_0x3b7df5(0x7e)][_0x3b7df5(0x83)],'role':_0x3b7df5(0x7e)});return{'access_token':_0x321fd7,'role':_0x3b7df5(0x7e)};}}const _0x452e3f=await database_1['default'][_0x3b7df5(0x75)]['findUnique']({'where':{'username':_0x31cc7b},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x452e3f)throw new Error(_0x3b7df5(0x6f));if(_0x452e3f['status']!==_0x3b7df5(0x81))throw new Error(_0x3b7df5(0x69));const _0x35ed10=await bcryptjs_1['default'][_0x3b7df5(0x80)](_0x563f9c,_0x452e3f['password']);if(!_0x35ed10)throw new Error(_0x3b7df5(0x6f));const _0x3dd94f=this[_0x3b7df5(0x76)]({'id':_0x452e3f['id'],'username':_0x452e3f['username'],'role':_0x3b7df5(0x75)});return{'access_token':_0x3dd94f,'role':_0x3b7df5(0x75),'user':{'id':_0x452e3f['id'],'name':_0x452e3f[_0x3b7df5(0x77)],'username':_0x452e3f[_0x3b7df5(0x83)]}};}async[a47_0x405388(0x6b)](_0x50db7d){const _0x421bf8=a47_0x405388;try{const _0x13edbb=jsonwebtoken_1[_0x421bf8(0x6d)]['verify'](_0x50db7d,config_1[_0x421bf8(0x72)][_0x421bf8(0x70)][_0x421bf8(0x73)]);return _0x13edbb;}catch(_0x4ac7eb){throw new Error(_0x421bf8(0x67));}}}exports[a47_0x405388(0x7a)]=AuthService;