'use strict';function a36_0x25fc(_0x39d0b4,_0x3805b8){const _0x6483e3=a36_0x6483();return a36_0x25fc=function(_0x25fcc3,_0x26ec91){_0x25fcc3=_0x25fcc3-0x1d5;let _0x52aa00=_0x6483e3[_0x25fcc3];return _0x52aa00;},a36_0x25fc(_0x39d0b4,_0x3805b8);}const a36_0x50d3de=a36_0x25fc;(function(_0xe9ebe2,_0x5dbb10){const _0x440867=a36_0x25fc,_0x531768=_0xe9ebe2();while(!![]){try{const _0x105929=parseInt(_0x440867(0x1e3))/0x1*(parseInt(_0x440867(0x1f6))/0x2)+-parseInt(_0x440867(0x1e8))/0x3+-parseInt(_0x440867(0x1f3))/0x4+-parseInt(_0x440867(0x1e9))/0x5+-parseInt(_0x440867(0x1e5))/0x6+parseInt(_0x440867(0x1ed))/0x7*(-parseInt(_0x440867(0x1e4))/0x8)+parseInt(_0x440867(0x1f7))/0x9;if(_0x105929===_0x5dbb10)break;else _0x531768['push'](_0x531768['shift']());}catch(_0x35f185){_0x531768['push'](_0x531768['shift']());}}}(a36_0x6483,0x6bb8e));var __importDefault=this&&this[a36_0x50d3de(0x1f4)]||function(_0x56973a){const _0x4e6e71=a36_0x50d3de;return _0x56973a&&_0x56973a[_0x4e6e71(0x1e1)]?_0x56973a:{'default':_0x56973a};};function a36_0x6483(){const _0x1b59e9=['name','shop','../config/config','password','username','admin','secret','__esModule','expiresIn','1nOBXsd','5400968qOufuW','3298326VNmgXK','login','AuthService','2087295epWQlf','2048295okDezC','jwt','Account\x20is\x20not\x20active','jsonwebtoken','7TrNPvo','Invalid\x20credentials','passwordHash','config','status','generateToken','870280rYrgtx','__importDefault','default','1106506SxAGXy','21922317rrRosv','sign','Invalid\x20token','../config/database','ACTIVE','verify'];a36_0x6483=function(){return _0x1b59e9;};return a36_0x6483();}Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a36_0x50d3de(0x1e7)]=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),jsonwebtoken_1=__importDefault(require(a36_0x50d3de(0x1ec))),database_1=__importDefault(require(a36_0x50d3de(0x1d7))),config_1=require(a36_0x50d3de(0x1dc));class AuthService{[a36_0x50d3de(0x1f2)](_0x28c079){const _0x57e149=a36_0x50d3de;return jsonwebtoken_1[_0x57e149(0x1f5)][_0x57e149(0x1d5)](_0x28c079,config_1[_0x57e149(0x1f0)][_0x57e149(0x1ea)][_0x57e149(0x1e0)],{'expiresIn':String(config_1[_0x57e149(0x1f0)][_0x57e149(0x1ea)][_0x57e149(0x1e2)])});}async[a36_0x50d3de(0x1e6)](_0x254016){const _0x35a885=a36_0x50d3de,{username:_0xfbe8c0,password:_0x440679}=_0x254016;if(_0xfbe8c0===config_1[_0x35a885(0x1f0)][_0x35a885(0x1df)][_0x35a885(0x1de)]){const _0xc2ca6b=await bcryptjs_1[_0x35a885(0x1f5)]['compare'](_0x440679,config_1[_0x35a885(0x1f0)][_0x35a885(0x1df)][_0x35a885(0x1ef)]);if(_0xc2ca6b){const _0x449c30=this[_0x35a885(0x1f2)]({'id':_0x35a885(0x1df),'username':config_1[_0x35a885(0x1f0)][_0x35a885(0x1df)][_0x35a885(0x1de)],'role':_0x35a885(0x1df)});return{'access_token':_0x449c30,'role':_0x35a885(0x1df)};}}const _0x1640f0=await database_1[_0x35a885(0x1f5)][_0x35a885(0x1db)]['findUnique']({'where':{'username':_0xfbe8c0},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x1640f0)throw new Error(_0x35a885(0x1ee));if(_0x1640f0[_0x35a885(0x1f1)]!==_0x35a885(0x1d8))throw new Error(_0x35a885(0x1eb));const _0x215f2a=await bcryptjs_1[_0x35a885(0x1f5)]['compare'](_0x440679,_0x1640f0[_0x35a885(0x1dd)]);if(!_0x215f2a)throw new Error('Invalid\x20credentials');const _0x29d7aa=this[_0x35a885(0x1f2)]({'id':_0x1640f0['id'],'username':_0x1640f0['username'],'role':_0x35a885(0x1db)});return{'access_token':_0x29d7aa,'role':'shop','user':{'id':_0x1640f0['id'],'name':_0x1640f0[_0x35a885(0x1da)],'username':_0x1640f0['username']}};}async['verifyToken'](_0x30ab8a){const _0x4c43ab=a36_0x50d3de;try{const _0x1d1aea=jsonwebtoken_1[_0x4c43ab(0x1f5)][_0x4c43ab(0x1d9)](_0x30ab8a,config_1[_0x4c43ab(0x1f0)][_0x4c43ab(0x1ea)][_0x4c43ab(0x1e0)]);return _0x1d1aea;}catch(_0x41f3b7){throw new Error(_0x4c43ab(0x1d6));}}}exports['AuthService']=AuthService;