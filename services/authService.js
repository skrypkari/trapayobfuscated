'use strict';const a36_0x254f53=a36_0x46e0;function a36_0x46e0(_0xfdf66a,_0x4ed540){const _0x4d292c=a36_0x4d29();return a36_0x46e0=function(_0x46e0ec,_0x4fad77){_0x46e0ec=_0x46e0ec-0x94;let _0x148358=_0x4d292c[_0x46e0ec];return _0x148358;},a36_0x46e0(_0xfdf66a,_0x4ed540);}(function(_0x542781,_0x3f9c29){const _0x1680ff=a36_0x46e0,_0x20db1c=_0x542781();while(!![]){try{const _0x91a7fd=parseInt(_0x1680ff(0xa0))/0x1+parseInt(_0x1680ff(0xa9))/0x2*(-parseInt(_0x1680ff(0x9b))/0x3)+-parseInt(_0x1680ff(0xb3))/0x4+-parseInt(_0x1680ff(0xb1))/0x5*(parseInt(_0x1680ff(0xb0))/0x6)+-parseInt(_0x1680ff(0xb2))/0x7+-parseInt(_0x1680ff(0xa7))/0x8*(-parseInt(_0x1680ff(0x9a))/0x9)+-parseInt(_0x1680ff(0xa2))/0xa*(-parseInt(_0x1680ff(0xac))/0xb);if(_0x91a7fd===_0x3f9c29)break;else _0x20db1c['push'](_0x20db1c['shift']());}catch(_0x67ffea){_0x20db1c['push'](_0x20db1c['shift']());}}}(a36_0x4d29,0xb262c));var __importDefault=this&&this['__importDefault']||function(_0x4b699e){const _0x38bd13=a36_0x46e0;return _0x4b699e&&_0x4b699e[_0x38bd13(0xaa)]?_0x4b699e:{'default':_0x4b699e};};Object[a36_0x254f53(0xab)](exports,a36_0x254f53(0xaa),{'value':!![]}),exports[a36_0x254f53(0xae)]=void 0x0;function a36_0x4d29(){const _0x13bb06=['AuthService','sign','6FNqavs','4982535APLoqf','2356557toREsQ','5187348KiakYp','login','shop','name','verifyToken','ACTIVE','Account\x20is\x20not\x20active','admin','expiresIn','passwordHash','471186iyrVah','1308543xZyWVO','Invalid\x20credentials','compare','findUnique','Invalid\x20token','1279591cHiThC','../config/database','6122170boQztt','default','jwt','username','secret','104fTaeRp','status','2HjDZLW','__esModule','defineProperty','33mCEOdl','config'];a36_0x4d29=function(){return _0x13bb06;};return a36_0x4d29();}const bcryptjs_1=__importDefault(require('bcryptjs')),jsonwebtoken_1=__importDefault(require('jsonwebtoken')),database_1=__importDefault(require(a36_0x254f53(0xa1))),config_1=require('../config/config');class AuthService{['generateToken'](_0x2a874c){const _0x5a37c2=a36_0x254f53;return jsonwebtoken_1[_0x5a37c2(0xa3)][_0x5a37c2(0xaf)](_0x2a874c,config_1[_0x5a37c2(0xad)]['jwt'][_0x5a37c2(0xa6)],{'expiresIn':String(config_1['config'][_0x5a37c2(0xa4)][_0x5a37c2(0x98)])});}async[a36_0x254f53(0xb4)](_0x4fc233){const _0x21f664=a36_0x254f53,{username:_0x89bb81,password:_0x54f007}=_0x4fc233;if(_0x89bb81===config_1[_0x21f664(0xad)][_0x21f664(0x97)][_0x21f664(0xa5)]){const _0x46ae5d=await bcryptjs_1[_0x21f664(0xa3)]['compare'](_0x54f007,config_1[_0x21f664(0xad)][_0x21f664(0x97)][_0x21f664(0x99)]);if(_0x46ae5d){const _0x446aec=this['generateToken']({'id':_0x21f664(0x97),'username':config_1[_0x21f664(0xad)][_0x21f664(0x97)][_0x21f664(0xa5)],'role':'admin'});return{'access_token':_0x446aec,'role':'admin'};}}const _0x1fed15=await database_1[_0x21f664(0xa3)][_0x21f664(0xb5)][_0x21f664(0x9e)]({'where':{'username':_0x89bb81},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x1fed15)throw new Error('Invalid\x20credentials');if(_0x1fed15[_0x21f664(0xa8)]!==_0x21f664(0x95))throw new Error(_0x21f664(0x96));const _0x68a672=await bcryptjs_1[_0x21f664(0xa3)][_0x21f664(0x9d)](_0x54f007,_0x1fed15['password']);if(!_0x68a672)throw new Error(_0x21f664(0x9c));const _0x235356=this['generateToken']({'id':_0x1fed15['id'],'username':_0x1fed15[_0x21f664(0xa5)],'role':_0x21f664(0xb5)});return{'access_token':_0x235356,'role':_0x21f664(0xb5),'user':{'id':_0x1fed15['id'],'name':_0x1fed15[_0x21f664(0xb6)],'username':_0x1fed15[_0x21f664(0xa5)]}};}async[a36_0x254f53(0x94)](_0x26b0d3){const _0x34a721=a36_0x254f53;try{const _0x33c048=jsonwebtoken_1[_0x34a721(0xa3)]['verify'](_0x26b0d3,config_1[_0x34a721(0xad)][_0x34a721(0xa4)]['secret']);return _0x33c048;}catch(_0x27e779){throw new Error(_0x34a721(0x9f));}}}exports['AuthService']=AuthService;