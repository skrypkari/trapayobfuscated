'use strict';const a37_0x15dc77=a37_0x2a04;(function(_0x31959e,_0x3db988){const _0x8453b0=a37_0x2a04,_0x45984=_0x31959e();while(!![]){try{const _0x1d1ee4=-parseInt(_0x8453b0(0x1ba))/0x1+parseInt(_0x8453b0(0x1a8))/0x2*(-parseInt(_0x8453b0(0x1bc))/0x3)+parseInt(_0x8453b0(0x1a5))/0x4*(parseInt(_0x8453b0(0x1bf))/0x5)+-parseInt(_0x8453b0(0x1c0))/0x6+-parseInt(_0x8453b0(0x1b1))/0x7+-parseInt(_0x8453b0(0x1af))/0x8+parseInt(_0x8453b0(0x1c3))/0x9*(parseInt(_0x8453b0(0x1ac))/0xa);if(_0x1d1ee4===_0x3db988)break;else _0x45984['push'](_0x45984['shift']());}catch(_0x118066){_0x45984['push'](_0x45984['shift']());}}}(a37_0x52af,0x7a383));function a37_0x52af(){const _0x11dd9f=['default','12qljInf','secret','admin','20635cwpOPz','5061378NgZmqs','AuthService','../config/config','486utXHAP','verify','status','sign','816JQFmaK','bcryptjs','config','87946KuSQvU','shop','login','compare','191740gtElXI','password','expiresIn','2027280HHjzaj','username','384552UbMXCI','../config/database','Invalid\x20token','jwt','jsonwebtoken','__esModule','name','Invalid\x20credentials','generateToken','48892BvRrgc'];a37_0x52af=function(){return _0x11dd9f;};return a37_0x52af();}var __importDefault=this&&this['__importDefault']||function(_0xdd9067){const _0x182f35=a37_0x2a04;return _0xdd9067&&_0xdd9067[_0x182f35(0x1b6)]?_0xdd9067:{'default':_0xdd9067};};Object['defineProperty'](exports,a37_0x15dc77(0x1b6),{'value':!![]}),exports[a37_0x15dc77(0x1c1)]=void 0x0;const bcryptjs_1=__importDefault(require(a37_0x15dc77(0x1a6))),jsonwebtoken_1=__importDefault(require(a37_0x15dc77(0x1b5))),database_1=__importDefault(require(a37_0x15dc77(0x1b2))),config_1=require(a37_0x15dc77(0x1c2));function a37_0x2a04(_0xe7ea9a,_0x1431f6){const _0x52afcf=a37_0x52af();return a37_0x2a04=function(_0x2a0405,_0x4005bd){_0x2a0405=_0x2a0405-0x1a2;let _0x2bc161=_0x52afcf[_0x2a0405];return _0x2bc161;},a37_0x2a04(_0xe7ea9a,_0x1431f6);}class AuthService{[a37_0x15dc77(0x1b9)](_0x30e21d){const _0x4533dd=a37_0x15dc77;return jsonwebtoken_1[_0x4533dd(0x1bb)][_0x4533dd(0x1a4)](_0x30e21d,config_1['config'][_0x4533dd(0x1b4)]['secret'],{'expiresIn':String(config_1[_0x4533dd(0x1a7)][_0x4533dd(0x1b4)][_0x4533dd(0x1ae)])});}async[a37_0x15dc77(0x1aa)](_0x39f1d5){const _0xf5e284=a37_0x15dc77,{username:_0xead9a5,password:_0x22d776}=_0x39f1d5;if(_0xead9a5===config_1['config'][_0xf5e284(0x1be)]['username']){const _0x378694=await bcryptjs_1['default'][_0xf5e284(0x1ab)](_0x22d776,config_1[_0xf5e284(0x1a7)][_0xf5e284(0x1be)]['passwordHash']);if(_0x378694){const _0x1bdab0=this['generateToken']({'id':'admin','username':config_1[_0xf5e284(0x1a7)]['admin'][_0xf5e284(0x1b0)],'role':'admin'});return{'access_token':_0x1bdab0,'role':_0xf5e284(0x1be)};}}const _0x3e8067=await database_1[_0xf5e284(0x1bb)][_0xf5e284(0x1a9)]['findUnique']({'where':{'username':_0xead9a5},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x3e8067)throw new Error(_0xf5e284(0x1b8));if(_0x3e8067[_0xf5e284(0x1a3)]!=='ACTIVE')throw new Error('Account\x20is\x20not\x20active');const _0x4a7663=await bcryptjs_1[_0xf5e284(0x1bb)][_0xf5e284(0x1ab)](_0x22d776,_0x3e8067[_0xf5e284(0x1ad)]);if(!_0x4a7663)throw new Error(_0xf5e284(0x1b8));const _0x47388d=this[_0xf5e284(0x1b9)]({'id':_0x3e8067['id'],'username':_0x3e8067[_0xf5e284(0x1b0)],'role':_0xf5e284(0x1a9)});return{'access_token':_0x47388d,'role':_0xf5e284(0x1a9),'user':{'id':_0x3e8067['id'],'name':_0x3e8067[_0xf5e284(0x1b7)],'username':_0x3e8067[_0xf5e284(0x1b0)]}};}async['verifyToken'](_0x533584){const _0x2ec3d7=a37_0x15dc77;try{const _0x1e88d5=jsonwebtoken_1['default'][_0x2ec3d7(0x1a2)](_0x533584,config_1[_0x2ec3d7(0x1a7)]['jwt'][_0x2ec3d7(0x1bd)]);return _0x1e88d5;}catch(_0x2405dc){throw new Error(_0x2ec3d7(0x1b3));}}}exports[a37_0x15dc77(0x1c1)]=AuthService;