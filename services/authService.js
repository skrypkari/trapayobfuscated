'use strict';function a41_0x4edd(_0x51ddb7,_0x3d5387){const _0x3d4b29=a41_0x3d4b();return a41_0x4edd=function(_0x4edd40,_0x29ddf2){_0x4edd40=_0x4edd40-0xd1;let _0x248775=_0x3d4b29[_0x4edd40];return _0x248775;},a41_0x4edd(_0x51ddb7,_0x3d5387);}const a41_0x130a58=a41_0x4edd;function a41_0x3d4b(){const _0x53f0aa=['shop','ACTIVE','expiresIn','username','Account\x20is\x20not\x20active','10944280teHuQV','AuthService','7789552vqXxeD','70387heSqtw','__esModule','verify','1528282HxVWSb','secret','705006QZFtmA','84VQbWns','9NMABQD','passwordHash','name','status','Invalid\x20credentials','222815snqMtM','5778246TUHAcz','defineProperty','config','verifyToken','../config/database','42nQVTHH','generateToken','findUnique','__importDefault','default','bcryptjs','jwt','jsonwebtoken','../config/config','compare','admin'];a41_0x3d4b=function(){return _0x53f0aa;};return a41_0x3d4b();}(function(_0x5902a7,_0x1cd478){const _0x1e8b2c=a41_0x4edd,_0x513454=_0x5902a7();while(!![]){try{const _0x228cb9=-parseInt(_0x1e8b2c(0xdf))/0x1*(parseInt(_0x1e8b2c(0xf1))/0x2)+parseInt(_0x1e8b2c(0xe4))/0x3+-parseInt(_0x1e8b2c(0xe5))/0x4*(-parseInt(_0x1e8b2c(0xeb))/0x5)+parseInt(_0x1e8b2c(0xec))/0x6+parseInt(_0x1e8b2c(0xe2))/0x7+parseInt(_0x1e8b2c(0xde))/0x8+parseInt(_0x1e8b2c(0xe6))/0x9*(-parseInt(_0x1e8b2c(0xdc))/0xa);if(_0x228cb9===_0x1cd478)break;else _0x513454['push'](_0x513454['shift']());}catch(_0x4770f4){_0x513454['push'](_0x513454['shift']());}}}(a41_0x3d4b,0xb7eb3));var __importDefault=this&&this[a41_0x130a58(0xf4)]||function(_0x456b9b){return _0x456b9b&&_0x456b9b['__esModule']?_0x456b9b:{'default':_0x456b9b};};Object[a41_0x130a58(0xed)](exports,a41_0x130a58(0xe0),{'value':!![]}),exports[a41_0x130a58(0xdd)]=void 0x0;const bcryptjs_1=__importDefault(require(a41_0x130a58(0xd1))),jsonwebtoken_1=__importDefault(require(a41_0x130a58(0xd3))),database_1=__importDefault(require(a41_0x130a58(0xf0))),config_1=require(a41_0x130a58(0xd4));class AuthService{[a41_0x130a58(0xf2)](_0x3e7aa5){const _0x215d09=a41_0x130a58;return jsonwebtoken_1[_0x215d09(0xf5)]['sign'](_0x3e7aa5,config_1[_0x215d09(0xee)][_0x215d09(0xd2)][_0x215d09(0xe3)],{'expiresIn':String(config_1[_0x215d09(0xee)][_0x215d09(0xd2)][_0x215d09(0xd9)])});}async['login'](_0x3d3b86){const _0x15d922=a41_0x130a58,{username:_0x23f778,password:_0x48db70}=_0x3d3b86;if(_0x23f778===config_1[_0x15d922(0xee)][_0x15d922(0xd6)][_0x15d922(0xda)]){const _0x289b6c=await bcryptjs_1[_0x15d922(0xf5)][_0x15d922(0xd5)](_0x48db70,config_1[_0x15d922(0xee)][_0x15d922(0xd6)][_0x15d922(0xe7)]);if(_0x289b6c){const _0x4448a2=this[_0x15d922(0xf2)]({'id':_0x15d922(0xd6),'username':config_1[_0x15d922(0xee)][_0x15d922(0xd6)]['username'],'role':_0x15d922(0xd6)});return{'access_token':_0x4448a2,'role':_0x15d922(0xd6)};}}const _0x13a576=await database_1[_0x15d922(0xf5)][_0x15d922(0xd7)][_0x15d922(0xf3)]({'where':{'username':_0x23f778},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x13a576)throw new Error(_0x15d922(0xea));if(_0x13a576[_0x15d922(0xe9)]!==_0x15d922(0xd8))throw new Error(_0x15d922(0xdb));const _0x3451ed=await bcryptjs_1['default'][_0x15d922(0xd5)](_0x48db70,_0x13a576['password']);if(!_0x3451ed)throw new Error(_0x15d922(0xea));const _0x2bb729=this[_0x15d922(0xf2)]({'id':_0x13a576['id'],'username':_0x13a576[_0x15d922(0xda)],'role':_0x15d922(0xd7)});return{'access_token':_0x2bb729,'role':_0x15d922(0xd7),'user':{'id':_0x13a576['id'],'name':_0x13a576[_0x15d922(0xe8)],'username':_0x13a576[_0x15d922(0xda)]}};}async[a41_0x130a58(0xef)](_0x1ae03e){const _0x44a317=a41_0x130a58;try{const _0x4e65c2=jsonwebtoken_1[_0x44a317(0xf5)][_0x44a317(0xe1)](_0x1ae03e,config_1[_0x44a317(0xee)][_0x44a317(0xd2)][_0x44a317(0xe3)]);return _0x4e65c2;}catch(_0x1b72b6){throw new Error('Invalid\x20token');}}}exports[a41_0x130a58(0xdd)]=AuthService;