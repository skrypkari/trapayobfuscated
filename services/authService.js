'use strict';const a39_0x27d78d=a39_0x8589;(function(_0x11ac18,_0x1883c5){const _0x27820=a39_0x8589,_0x22338b=_0x11ac18();while(!![]){try{const _0x24264b=-parseInt(_0x27820(0x118))/0x1+parseInt(_0x27820(0x11b))/0x2+parseInt(_0x27820(0x11f))/0x3*(parseInt(_0x27820(0x124))/0x4)+parseInt(_0x27820(0x114))/0x5+parseInt(_0x27820(0x119))/0x6*(-parseInt(_0x27820(0x120))/0x7)+parseInt(_0x27820(0x121))/0x8+parseInt(_0x27820(0x11a))/0x9*(-parseInt(_0x27820(0x11c))/0xa);if(_0x24264b===_0x1883c5)break;else _0x22338b['push'](_0x22338b['shift']());}catch(_0x56bf29){_0x22338b['push'](_0x22338b['shift']());}}}(a39_0x4667,0x4472b));var __importDefault=this&&this[a39_0x27d78d(0x123)]||function(_0x1f0cd4){const _0x41c02b=a39_0x27d78d;return _0x1f0cd4&&_0x1f0cd4[_0x41c02b(0x113)]?_0x1f0cd4:{'default':_0x1f0cd4};};Object[a39_0x27d78d(0x10c)](exports,a39_0x27d78d(0x113),{'value':!![]}),exports[a39_0x27d78d(0x128)]=void 0x0;function a39_0x8589(_0x411577,_0x10e680){const _0x466746=a39_0x4667();return a39_0x8589=function(_0x85891a,_0x3e2f17){_0x85891a=_0x85891a-0x10a;let _0x16ce8f=_0x466746[_0x85891a];return _0x16ce8f;},a39_0x8589(_0x411577,_0x10e680);}const bcryptjs_1=__importDefault(require(a39_0x27d78d(0x129))),jsonwebtoken_1=__importDefault(require('jsonwebtoken')),database_1=__importDefault(require(a39_0x27d78d(0x115))),config_1=require(a39_0x27d78d(0x110));function a39_0x4667(){const _0x58e753=['4nfnXNG','config','shop','password','AuthService','bcryptjs','jwt','default','defineProperty','Invalid\x20token','Invalid\x20credentials','login','../config/config','username','findUnique','__esModule','2237640SZriaA','../config/database','generateToken','Account\x20is\x20not\x20active','356213rUPFAJ','6nUjcyf','1503XuSqls','894098xJQpVX','55310ejDmby','secret','admin','601254RJLUSW','28847dWNEck','3755032LjAvaB','name','__importDefault'];a39_0x4667=function(){return _0x58e753;};return a39_0x4667();}class AuthService{[a39_0x27d78d(0x116)](_0x3790b6){const _0x15caaa=a39_0x27d78d;return jsonwebtoken_1[_0x15caaa(0x10b)]['sign'](_0x3790b6,config_1[_0x15caaa(0x125)]['jwt'][_0x15caaa(0x11d)],{'expiresIn':String(config_1[_0x15caaa(0x125)][_0x15caaa(0x10a)]['expiresIn'])});}async[a39_0x27d78d(0x10f)](_0x3ac097){const _0x136e39=a39_0x27d78d,{username:_0x2e6cbb,password:_0x220415}=_0x3ac097;if(_0x2e6cbb===config_1[_0x136e39(0x125)]['admin'][_0x136e39(0x111)]){const _0xbabd66=await bcryptjs_1[_0x136e39(0x10b)]['compare'](_0x220415,config_1[_0x136e39(0x125)][_0x136e39(0x11e)]['passwordHash']);if(_0xbabd66){const _0x5e856b=this[_0x136e39(0x116)]({'id':_0x136e39(0x11e),'username':config_1[_0x136e39(0x125)][_0x136e39(0x11e)]['username'],'role':_0x136e39(0x11e)});return{'access_token':_0x5e856b,'role':_0x136e39(0x11e)};}}const _0x14d276=await database_1[_0x136e39(0x10b)][_0x136e39(0x126)][_0x136e39(0x112)]({'where':{'username':_0x2e6cbb},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x14d276)throw new Error(_0x136e39(0x10e));if(_0x14d276['status']!=='ACTIVE')throw new Error(_0x136e39(0x117));const _0x4f64e5=await bcryptjs_1[_0x136e39(0x10b)]['compare'](_0x220415,_0x14d276[_0x136e39(0x127)]);if(!_0x4f64e5)throw new Error(_0x136e39(0x10e));const _0x5452da=this[_0x136e39(0x116)]({'id':_0x14d276['id'],'username':_0x14d276[_0x136e39(0x111)],'role':'shop'});return{'access_token':_0x5452da,'role':_0x136e39(0x126),'user':{'id':_0x14d276['id'],'name':_0x14d276[_0x136e39(0x122)],'username':_0x14d276[_0x136e39(0x111)]}};}async['verifyToken'](_0x40a73f){const _0x152c2c=a39_0x27d78d;try{const _0x29265d=jsonwebtoken_1[_0x152c2c(0x10b)]['verify'](_0x40a73f,config_1['config'][_0x152c2c(0x10a)][_0x152c2c(0x11d)]);return _0x29265d;}catch(_0x5d58ec){throw new Error(_0x152c2c(0x10d));}}}exports[a39_0x27d78d(0x128)]=AuthService;