'use strict';const a37_0xa82711=a37_0x131d;(function(_0xa4c4a6,_0x404a2f){const _0x201c48=a37_0x131d,_0x2e56bc=_0xa4c4a6();while(!![]){try{const _0x4aa7af=-parseInt(_0x201c48(0x206))/0x1*(parseInt(_0x201c48(0x1f8))/0x2)+parseInt(_0x201c48(0x20c))/0x3+-parseInt(_0x201c48(0x1fc))/0x4+parseInt(_0x201c48(0x1ec))/0x5*(-parseInt(_0x201c48(0x1f7))/0x6)+-parseInt(_0x201c48(0x208))/0x7*(parseInt(_0x201c48(0x1f6))/0x8)+-parseInt(_0x201c48(0x1e9))/0x9*(parseInt(_0x201c48(0x204))/0xa)+-parseInt(_0x201c48(0x20f))/0xb*(-parseInt(_0x201c48(0x1ff))/0xc);if(_0x4aa7af===_0x404a2f)break;else _0x2e56bc['push'](_0x2e56bc['shift']());}catch(_0x2923e5){_0x2e56bc['push'](_0x2e56bc['shift']());}}}(a37_0x2b77,0xbd6e2));var __importDefault=this&&this[a37_0xa82711(0x1f9)]||function(_0x1703b7){return _0x1703b7&&_0x1703b7['__esModule']?_0x1703b7:{'default':_0x1703b7};};Object[a37_0xa82711(0x1f5)](exports,a37_0xa82711(0x205),{'value':!![]}),exports[a37_0xa82711(0x209)]=void 0x0;const bcryptjs_1=__importDefault(require(a37_0xa82711(0x1fa))),jsonwebtoken_1=__importDefault(require(a37_0xa82711(0x1fd))),database_1=__importDefault(require(a37_0xa82711(0x1f3))),config_1=require(a37_0xa82711(0x200));class AuthService{[a37_0xa82711(0x1ea)](_0x415741){const _0xa0665a=a37_0xa82711;return jsonwebtoken_1[_0xa0665a(0x1ee)][_0xa0665a(0x207)](_0x415741,config_1['config'][_0xa0665a(0x1f2)]['secret'],{'expiresIn':String(config_1['config']['jwt']['expiresIn'])});}async['login'](_0x31bb40){const _0xb9b5b0=a37_0xa82711,{username:_0x23f345,password:_0x47ecc6}=_0x31bb40;if(_0x23f345===config_1['config'][_0xb9b5b0(0x203)]['username']){const _0xbf2818=await bcryptjs_1[_0xb9b5b0(0x1ee)][_0xb9b5b0(0x202)](_0x47ecc6,config_1['config'][_0xb9b5b0(0x203)][_0xb9b5b0(0x20a)]);if(_0xbf2818){const _0x447222=this['generateToken']({'id':_0xb9b5b0(0x203),'username':config_1[_0xb9b5b0(0x1ef)][_0xb9b5b0(0x203)][_0xb9b5b0(0x20d)],'role':_0xb9b5b0(0x203)});return{'access_token':_0x447222,'role':_0xb9b5b0(0x203)};}}const _0x1cf87a=await database_1[_0xb9b5b0(0x1ee)][_0xb9b5b0(0x20e)][_0xb9b5b0(0x201)]({'where':{'username':_0x23f345},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x1cf87a)throw new Error(_0xb9b5b0(0x1fe));if(_0x1cf87a[_0xb9b5b0(0x1eb)]!==_0xb9b5b0(0x1f4))throw new Error(_0xb9b5b0(0x1f0));const _0x4fea18=await bcryptjs_1['default']['compare'](_0x47ecc6,_0x1cf87a['password']);if(!_0x4fea18)throw new Error(_0xb9b5b0(0x1fe));const _0x424bbd=this[_0xb9b5b0(0x1ea)]({'id':_0x1cf87a['id'],'username':_0x1cf87a[_0xb9b5b0(0x20d)],'role':_0xb9b5b0(0x20e)});return{'access_token':_0x424bbd,'role':_0xb9b5b0(0x20e),'user':{'id':_0x1cf87a['id'],'name':_0x1cf87a[_0xb9b5b0(0x1e8)],'username':_0x1cf87a[_0xb9b5b0(0x20d)]}};}async[a37_0xa82711(0x1f1)](_0x2bbef8){const _0x5d7f20=a37_0xa82711;try{const _0xe640da=jsonwebtoken_1[_0x5d7f20(0x1ee)][_0x5d7f20(0x1ed)](_0x2bbef8,config_1[_0x5d7f20(0x1ef)]['jwt'][_0x5d7f20(0x20b)]);return _0xe640da;}catch(_0x3f2934){throw new Error(_0x5d7f20(0x1fb));}}}function a37_0x2b77(){const _0x17828c=['jsonwebtoken','Invalid\x20credentials','36bDkHXZ','../config/config','findUnique','compare','admin','170uhdBbq','__esModule','49UpEswh','sign','6671CRWaAc','AuthService','passwordHash','secret','703116AzvoKT','username','shop','15434529NSspSA','name','260271zItLkw','generateToken','status','5hVRJUc','verify','default','config','Account\x20is\x20not\x20active','verifyToken','jwt','../config/database','ACTIVE','defineProperty','10424ZpCrTN','5754114bvfOMx','12466qoLgyh','__importDefault','bcryptjs','Invalid\x20token','2680260OgWjcw'];a37_0x2b77=function(){return _0x17828c;};return a37_0x2b77();}function a37_0x131d(_0x4b4a77,_0x2583e8){const _0x2b7738=a37_0x2b77();return a37_0x131d=function(_0x131d04,_0x2eeebc){_0x131d04=_0x131d04-0x1e8;let _0x2500cc=_0x2b7738[_0x131d04];return _0x2500cc;},a37_0x131d(_0x4b4a77,_0x2583e8);}exports[a37_0xa82711(0x209)]=AuthService;