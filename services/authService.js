'use strict';const a36_0x126905=a36_0x443e;(function(_0x3f4912,_0x2acaec){const _0x318344=a36_0x443e,_0x764ed7=_0x3f4912();while(!![]){try{const _0xd3b98f=parseInt(_0x318344(0x14a))/0x1+parseInt(_0x318344(0x146))/0x2*(parseInt(_0x318344(0x15c))/0x3)+-parseInt(_0x318344(0x14c))/0x4+-parseInt(_0x318344(0x15a))/0x5+-parseInt(_0x318344(0x15f))/0x6*(-parseInt(_0x318344(0x166))/0x7)+-parseInt(_0x318344(0x169))/0x8+parseInt(_0x318344(0x14e))/0x9*(parseInt(_0x318344(0x155))/0xa);if(_0xd3b98f===_0x2acaec)break;else _0x764ed7['push'](_0x764ed7['shift']());}catch(_0x495f66){_0x764ed7['push'](_0x764ed7['shift']());}}}(a36_0x5a79,0xac36d));var __importDefault=this&&this['__importDefault']||function(_0x59e47d){const _0x139ed2=a36_0x443e;return _0x59e47d&&_0x59e47d[_0x139ed2(0x161)]?_0x59e47d:{'default':_0x59e47d};};function a36_0x443e(_0x5c37aa,_0x57a980){const _0x5a7967=a36_0x5a79();return a36_0x443e=function(_0x443e23,_0x158f44){_0x443e23=_0x443e23-0x146;let _0x3a079e=_0x5a7967[_0x443e23];return _0x3a079e;},a36_0x443e(_0x5c37aa,_0x57a980);}Object['defineProperty'](exports,a36_0x126905(0x161),{'value':!![]}),exports[a36_0x126905(0x156)]=void 0x0;function a36_0x5a79(){const _0x28f267=['admin','__esModule','passwordHash','default','name','findUnique','7cJacxA','username','generateToken','1475488msFMev','385674VOWoNY','jsonwebtoken','../config/database','ACTIVE','17023QYinVW','verifyToken','586548LXvpmT','status','9rakzAs','verify','Invalid\x20token','sign','Invalid\x20credentials','secret','shop','15941580quvend','AuthService','config','compare','login','5939110eyaSSm','password','6xMPhTc','jwt','../config/config','1364574dpWxYy'];a36_0x5a79=function(){return _0x28f267;};return a36_0x5a79();}const bcryptjs_1=__importDefault(require('bcryptjs')),jsonwebtoken_1=__importDefault(require(a36_0x126905(0x147))),database_1=__importDefault(require(a36_0x126905(0x148))),config_1=require(a36_0x126905(0x15e));class AuthService{[a36_0x126905(0x168)](_0x56e620){const _0x30d8ff=a36_0x126905;return jsonwebtoken_1[_0x30d8ff(0x163)][_0x30d8ff(0x151)](_0x56e620,config_1[_0x30d8ff(0x157)][_0x30d8ff(0x15d)][_0x30d8ff(0x153)],{'expiresIn':String(config_1[_0x30d8ff(0x157)]['jwt']['expiresIn'])});}async[a36_0x126905(0x159)](_0x2db917){const _0x3cc9a8=a36_0x126905,{username:_0xcc4286,password:_0x44ddfc}=_0x2db917;if(_0xcc4286===config_1[_0x3cc9a8(0x157)][_0x3cc9a8(0x160)][_0x3cc9a8(0x167)]){const _0x2b7c0d=await bcryptjs_1[_0x3cc9a8(0x163)][_0x3cc9a8(0x158)](_0x44ddfc,config_1[_0x3cc9a8(0x157)][_0x3cc9a8(0x160)][_0x3cc9a8(0x162)]);if(_0x2b7c0d){const _0x3fbea9=this[_0x3cc9a8(0x168)]({'id':_0x3cc9a8(0x160),'username':config_1[_0x3cc9a8(0x157)]['admin'][_0x3cc9a8(0x167)],'role':'admin'});return{'access_token':_0x3fbea9,'role':'admin'};}}const _0x4ca670=await database_1[_0x3cc9a8(0x163)][_0x3cc9a8(0x154)][_0x3cc9a8(0x165)]({'where':{'username':_0xcc4286},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x4ca670)throw new Error('Invalid\x20credentials');if(_0x4ca670[_0x3cc9a8(0x14d)]!==_0x3cc9a8(0x149))throw new Error('Account\x20is\x20not\x20active');const _0x5ef075=await bcryptjs_1['default'][_0x3cc9a8(0x158)](_0x44ddfc,_0x4ca670[_0x3cc9a8(0x15b)]);if(!_0x5ef075)throw new Error(_0x3cc9a8(0x152));const _0x4d8566=this['generateToken']({'id':_0x4ca670['id'],'username':_0x4ca670[_0x3cc9a8(0x167)],'role':_0x3cc9a8(0x154)});return{'access_token':_0x4d8566,'role':_0x3cc9a8(0x154),'user':{'id':_0x4ca670['id'],'name':_0x4ca670[_0x3cc9a8(0x164)],'username':_0x4ca670['username']}};}async[a36_0x126905(0x14b)](_0x9a2998){const _0x26e0c4=a36_0x126905;try{const _0x28d2e1=jsonwebtoken_1['default'][_0x26e0c4(0x14f)](_0x9a2998,config_1[_0x26e0c4(0x157)][_0x26e0c4(0x15d)]['secret']);return _0x28d2e1;}catch(_0x56ea5f){throw new Error(_0x26e0c4(0x150));}}}exports[a36_0x126905(0x156)]=AuthService;