'use strict';const a36_0x3f029c=a36_0x4a6e;(function(_0x1854eb,_0x56ad0c){const _0x4ed4fa=a36_0x4a6e,_0x58c570=_0x1854eb();while(!![]){try{const _0x466544=-parseInt(_0x4ed4fa(0x105))/0x1+parseInt(_0x4ed4fa(0xf0))/0x2+parseInt(_0x4ed4fa(0xe9))/0x3*(-parseInt(_0x4ed4fa(0xea))/0x4)+-parseInt(_0x4ed4fa(0xf3))/0x5+parseInt(_0x4ed4fa(0x104))/0x6*(parseInt(_0x4ed4fa(0xf1))/0x7)+parseInt(_0x4ed4fa(0xee))/0x8*(parseInt(_0x4ed4fa(0xfa))/0x9)+parseInt(_0x4ed4fa(0xf7))/0xa;if(_0x466544===_0x56ad0c)break;else _0x58c570['push'](_0x58c570['shift']());}catch(_0x2671c3){_0x58c570['push'](_0x58c570['shift']());}}}(a36_0x5272,0xec937));function a36_0x5272(){const _0x2b593a=['generateToken','defineProperty','verifyToken','__esModule','Invalid\x20credentials','30807UtUBwb','404SYMrfy','jwt','password','verify','15944UKKYAv','admin','259740UpoPkL','675094oMOsfG','default','4307750BcauDq','__importDefault','username','AuthService','3613060DRvigO','secret','Invalid\x20token','7749NbCzPU','../config/database','sign','jsonwebtoken','../config/config','config','shop','compare','Account\x20is\x20not\x20active','bcryptjs','54OnTXeu','207393KzrzjR','status','name'];a36_0x5272=function(){return _0x2b593a;};return a36_0x5272();}var __importDefault=this&&this[a36_0x3f029c(0xf4)]||function(_0x455e2f){const _0x2df968=a36_0x3f029c;return _0x455e2f&&_0x455e2f[_0x2df968(0xe7)]?_0x455e2f:{'default':_0x455e2f};};Object[a36_0x3f029c(0x109)](exports,a36_0x3f029c(0xe7),{'value':!![]}),exports[a36_0x3f029c(0xf6)]=void 0x0;const bcryptjs_1=__importDefault(require(a36_0x3f029c(0x103))),jsonwebtoken_1=__importDefault(require(a36_0x3f029c(0xfd))),database_1=__importDefault(require(a36_0x3f029c(0xfb))),config_1=require(a36_0x3f029c(0xfe));function a36_0x4a6e(_0x1b1686,_0x11c689){const _0x527243=a36_0x5272();return a36_0x4a6e=function(_0x4a6ea9,_0x37c316){_0x4a6ea9=_0x4a6ea9-0xe7;let _0x3b80ba=_0x527243[_0x4a6ea9];return _0x3b80ba;},a36_0x4a6e(_0x1b1686,_0x11c689);}class AuthService{[a36_0x3f029c(0x108)](_0x224021){const _0x3fa557=a36_0x3f029c;return jsonwebtoken_1[_0x3fa557(0xf2)][_0x3fa557(0xfc)](_0x224021,config_1[_0x3fa557(0xff)][_0x3fa557(0xeb)][_0x3fa557(0xf8)],{'expiresIn':String(config_1['config'][_0x3fa557(0xeb)]['expiresIn'])});}async['login'](_0x346810){const _0x6dc169=a36_0x3f029c,{username:_0x3fcd58,password:_0x9dcea7}=_0x346810;if(_0x3fcd58===config_1['config']['admin'][_0x6dc169(0xf5)]){const _0xa9d9f9=await bcryptjs_1['default'][_0x6dc169(0x101)](_0x9dcea7,config_1[_0x6dc169(0xff)][_0x6dc169(0xef)]['passwordHash']);if(_0xa9d9f9){const _0x499e23=this[_0x6dc169(0x108)]({'id':_0x6dc169(0xef),'username':config_1[_0x6dc169(0xff)][_0x6dc169(0xef)][_0x6dc169(0xf5)],'role':_0x6dc169(0xef)});return{'access_token':_0x499e23,'role':'admin'};}}const _0x21e0f4=await database_1[_0x6dc169(0xf2)]['shop']['findUnique']({'where':{'username':_0x3fcd58},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x21e0f4)throw new Error(_0x6dc169(0xe8));if(_0x21e0f4[_0x6dc169(0x106)]!=='ACTIVE')throw new Error(_0x6dc169(0x102));const _0x57a16e=await bcryptjs_1['default'][_0x6dc169(0x101)](_0x9dcea7,_0x21e0f4[_0x6dc169(0xec)]);if(!_0x57a16e)throw new Error(_0x6dc169(0xe8));const _0x4d05be=this[_0x6dc169(0x108)]({'id':_0x21e0f4['id'],'username':_0x21e0f4['username'],'role':_0x6dc169(0x100)});return{'access_token':_0x4d05be,'role':_0x6dc169(0x100),'user':{'id':_0x21e0f4['id'],'name':_0x21e0f4[_0x6dc169(0x107)],'username':_0x21e0f4['username']}};}async[a36_0x3f029c(0x10a)](_0xdfd6b3){const _0x31e0a9=a36_0x3f029c;try{const _0x375eb5=jsonwebtoken_1[_0x31e0a9(0xf2)][_0x31e0a9(0xed)](_0xdfd6b3,config_1['config'][_0x31e0a9(0xeb)]['secret']);return _0x375eb5;}catch(_0x4b44ae){throw new Error(_0x31e0a9(0xf9));}}}exports[a36_0x3f029c(0xf6)]=AuthService;