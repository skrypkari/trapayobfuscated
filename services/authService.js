'use strict';const a36_0x43edd7=a36_0x2105;(function(_0x390fe2,_0x1c7a7f){const _0x1ae4df=a36_0x2105,_0x19ef5d=_0x390fe2();while(!![]){try{const _0x9349aa=parseInt(_0x1ae4df(0x1d8))/0x1*(-parseInt(_0x1ae4df(0x1e5))/0x2)+-parseInt(_0x1ae4df(0x1d3))/0x3*(parseInt(_0x1ae4df(0x1cb))/0x4)+-parseInt(_0x1ae4df(0x1e0))/0x5*(-parseInt(_0x1ae4df(0x1df))/0x6)+-parseInt(_0x1ae4df(0x1e8))/0x7*(parseInt(_0x1ae4df(0x1ca))/0x8)+-parseInt(_0x1ae4df(0x1d9))/0x9+-parseInt(_0x1ae4df(0x1da))/0xa*(-parseInt(_0x1ae4df(0x1ea))/0xb)+parseInt(_0x1ae4df(0x1c8))/0xc;if(_0x9349aa===_0x1c7a7f)break;else _0x19ef5d['push'](_0x19ef5d['shift']());}catch(_0x3ca20c){_0x19ef5d['push'](_0x19ef5d['shift']());}}}(a36_0x318c,0x8d8a7));function a36_0x318c(){const _0x551974=['19689600OBRQUA','ACTIVE','5068696EAlVNb','4ZHSfrs','Invalid\x20token','findUnique','verifyToken','generateToken','__esModule','username','defineProperty','775035yqkgsp','compare','../config/database','Invalid\x20credentials','secret','225241gkdBfq','4670379pprWkP','4164870xoygCr','password','Account\x20is\x20not\x20active','admin','__importDefault','150MoUJJT','121810rOALrK','jwt','bcryptjs','../config/config','AuthService','6OYxsmF','default','config','7xJZQzq','shop','11RBPMjr'];a36_0x318c=function(){return _0x551974;};return a36_0x318c();}function a36_0x2105(_0x216ec7,_0xf2d8f8){const _0x318ccb=a36_0x318c();return a36_0x2105=function(_0x2105ef,_0x42110a){_0x2105ef=_0x2105ef-0x1c8;let _0x59541f=_0x318ccb[_0x2105ef];return _0x59541f;},a36_0x2105(_0x216ec7,_0xf2d8f8);}var __importDefault=this&&this[a36_0x43edd7(0x1de)]||function(_0x5a6ea8){const _0x5f4665=a36_0x43edd7;return _0x5a6ea8&&_0x5a6ea8[_0x5f4665(0x1d0)]?_0x5a6ea8:{'default':_0x5a6ea8};};Object[a36_0x43edd7(0x1d2)](exports,a36_0x43edd7(0x1d0),{'value':!![]}),exports[a36_0x43edd7(0x1e4)]=void 0x0;const bcryptjs_1=__importDefault(require(a36_0x43edd7(0x1e2))),jsonwebtoken_1=__importDefault(require('jsonwebtoken')),database_1=__importDefault(require(a36_0x43edd7(0x1d5))),config_1=require(a36_0x43edd7(0x1e3));class AuthService{[a36_0x43edd7(0x1cf)](_0x26eb54){const _0x5eb0d4=a36_0x43edd7;return jsonwebtoken_1[_0x5eb0d4(0x1e6)]['sign'](_0x26eb54,config_1[_0x5eb0d4(0x1e7)][_0x5eb0d4(0x1e1)][_0x5eb0d4(0x1d7)],{'expiresIn':String(config_1[_0x5eb0d4(0x1e7)][_0x5eb0d4(0x1e1)]['expiresIn'])});}async['login'](_0x4e2ea0){const _0x1ecf6f=a36_0x43edd7,{username:_0x3f3cff,password:_0x37aff1}=_0x4e2ea0;if(_0x3f3cff===config_1[_0x1ecf6f(0x1e7)][_0x1ecf6f(0x1dd)][_0x1ecf6f(0x1d1)]){const _0x4e07d5=await bcryptjs_1[_0x1ecf6f(0x1e6)]['compare'](_0x37aff1,config_1[_0x1ecf6f(0x1e7)][_0x1ecf6f(0x1dd)]['passwordHash']);if(_0x4e07d5){const _0x23944b=this[_0x1ecf6f(0x1cf)]({'id':_0x1ecf6f(0x1dd),'username':config_1[_0x1ecf6f(0x1e7)][_0x1ecf6f(0x1dd)]['username'],'role':_0x1ecf6f(0x1dd)});return{'access_token':_0x23944b,'role':_0x1ecf6f(0x1dd)};}}const _0x411519=await database_1[_0x1ecf6f(0x1e6)][_0x1ecf6f(0x1e9)][_0x1ecf6f(0x1cd)]({'where':{'username':_0x3f3cff},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x411519)throw new Error(_0x1ecf6f(0x1d6));if(_0x411519['status']!==_0x1ecf6f(0x1c9))throw new Error(_0x1ecf6f(0x1dc));const _0x125197=await bcryptjs_1[_0x1ecf6f(0x1e6)][_0x1ecf6f(0x1d4)](_0x37aff1,_0x411519[_0x1ecf6f(0x1db)]);if(!_0x125197)throw new Error(_0x1ecf6f(0x1d6));const _0x40751e=this[_0x1ecf6f(0x1cf)]({'id':_0x411519['id'],'username':_0x411519['username'],'role':_0x1ecf6f(0x1e9)});return{'access_token':_0x40751e,'role':_0x1ecf6f(0x1e9),'user':{'id':_0x411519['id'],'name':_0x411519['name'],'username':_0x411519[_0x1ecf6f(0x1d1)]}};}async[a36_0x43edd7(0x1ce)](_0x22d863){const _0x568ea5=a36_0x43edd7;try{const _0x478151=jsonwebtoken_1[_0x568ea5(0x1e6)]['verify'](_0x22d863,config_1[_0x568ea5(0x1e7)][_0x568ea5(0x1e1)]['secret']);return _0x478151;}catch(_0x847ef7){throw new Error(_0x568ea5(0x1cc));}}}exports[a36_0x43edd7(0x1e4)]=AuthService;