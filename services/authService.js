'use strict';function a34_0x1e18(){const _0x24cd28=['__importDefault','verifyToken','Invalid\x20credentials','login','passwordHash','findUnique','7305900hQDcpa','2909856pHZacr','2782336ufPOzd','generateToken','secret','AuthService','config','../config/config','__esModule','compare','shop','620254JgvLCN','bcryptjs','defineProperty','jwt','username','default','sign','name','2988204hXKbTI','ACTIVE','1384812GvwtUq','status','4889409TvgGJE','Invalid\x20token','jsonwebtoken','Account\x20is\x20not\x20active','admin'];a34_0x1e18=function(){return _0x24cd28;};return a34_0x1e18();}const a34_0x3ca113=a34_0x57e1;(function(_0x5445d5,_0x1517be){const _0x5b8795=a34_0x57e1,_0x311029=_0x5445d5();while(!![]){try{const _0x36e7f3=-parseInt(_0x5b8795(0x93))/0x1+parseInt(_0x5b8795(0x8a))/0x2+-parseInt(_0x5b8795(0x9d))/0x3+parseInt(_0x5b8795(0x89))/0x4+-parseInt(_0x5b8795(0x88))/0x5+parseInt(_0x5b8795(0x9b))/0x6+parseInt(_0x5b8795(0x9f))/0x7;if(_0x36e7f3===_0x1517be)break;else _0x311029['push'](_0x311029['shift']());}catch(_0x989fec){_0x311029['push'](_0x311029['shift']());}}}(a34_0x1e18,0xbc813));var __importDefault=this&&this[a34_0x3ca113(0x82)]||function(_0x3879a7){const _0x508811=a34_0x3ca113;return _0x3879a7&&_0x3879a7[_0x508811(0x90)]?_0x3879a7:{'default':_0x3879a7};};Object[a34_0x3ca113(0x95)](exports,a34_0x3ca113(0x90),{'value':!![]}),exports[a34_0x3ca113(0x8d)]=void 0x0;const bcryptjs_1=__importDefault(require(a34_0x3ca113(0x94))),jsonwebtoken_1=__importDefault(require(a34_0x3ca113(0xa1))),database_1=__importDefault(require('../config/database')),config_1=require(a34_0x3ca113(0x8f));function a34_0x57e1(_0x4e2dd9,_0x3e527d){const _0x1e18a2=a34_0x1e18();return a34_0x57e1=function(_0x57e1af,_0x4260df){_0x57e1af=_0x57e1af-0x82;let _0x1c1c3a=_0x1e18a2[_0x57e1af];return _0x1c1c3a;},a34_0x57e1(_0x4e2dd9,_0x3e527d);}class AuthService{[a34_0x3ca113(0x8b)](_0x4e1e5e){const _0x8f5335=a34_0x3ca113;return jsonwebtoken_1[_0x8f5335(0x98)][_0x8f5335(0x99)](_0x4e1e5e,config_1['config']['jwt']['secret'],{'expiresIn':String(config_1['config'][_0x8f5335(0x96)]['expiresIn'])});}async[a34_0x3ca113(0x85)](_0x157215){const _0x506ca6=a34_0x3ca113,{username:_0x3d87e1,password:_0x4944b1}=_0x157215;if(_0x3d87e1===config_1['config'][_0x506ca6(0xa3)][_0x506ca6(0x97)]){const _0x4a6ab6=await bcryptjs_1[_0x506ca6(0x98)][_0x506ca6(0x91)](_0x4944b1,config_1['config'][_0x506ca6(0xa3)][_0x506ca6(0x86)]);if(_0x4a6ab6){const _0xab6870=this['generateToken']({'id':_0x506ca6(0xa3),'username':config_1['config']['admin'][_0x506ca6(0x97)],'role':'admin'});return{'access_token':_0xab6870,'role':_0x506ca6(0xa3)};}}const _0x12daf8=await database_1[_0x506ca6(0x98)][_0x506ca6(0x92)][_0x506ca6(0x87)]({'where':{'username':_0x3d87e1},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x12daf8)throw new Error(_0x506ca6(0x84));if(_0x12daf8[_0x506ca6(0x9e)]!==_0x506ca6(0x9c))throw new Error(_0x506ca6(0xa2));const _0x3eb96b=await bcryptjs_1[_0x506ca6(0x98)]['compare'](_0x4944b1,_0x12daf8['password']);if(!_0x3eb96b)throw new Error(_0x506ca6(0x84));const _0x52da6e=this['generateToken']({'id':_0x12daf8['id'],'username':_0x12daf8[_0x506ca6(0x97)],'role':'shop'});return{'access_token':_0x52da6e,'role':_0x506ca6(0x92),'user':{'id':_0x12daf8['id'],'name':_0x12daf8[_0x506ca6(0x9a)],'username':_0x12daf8[_0x506ca6(0x97)]}};}async[a34_0x3ca113(0x83)](_0x3525db){const _0x191f09=a34_0x3ca113;try{const _0x257949=jsonwebtoken_1[_0x191f09(0x98)]['verify'](_0x3525db,config_1[_0x191f09(0x8e)][_0x191f09(0x96)][_0x191f09(0x8c)]);return _0x257949;}catch(_0x5b6f8b){throw new Error(_0x191f09(0xa0));}}}exports[a34_0x3ca113(0x8d)]=AuthService;