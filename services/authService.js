'use strict';function a36_0x1146(_0x512ac5,_0x4db7ee){const _0x5370ba=a36_0x5370();return a36_0x1146=function(_0x1146e8,_0x2ab31c){_0x1146e8=_0x1146e8-0x1b9;let _0xee7a3f=_0x5370ba[_0x1146e8];return _0xee7a3f;},a36_0x1146(_0x512ac5,_0x4db7ee);}const a36_0x48af37=a36_0x1146;(function(_0x723abb,_0x43fe39){const _0x428128=a36_0x1146,_0x31e504=_0x723abb();while(!![]){try{const _0x1be103=parseInt(_0x428128(0x1ca))/0x1+-parseInt(_0x428128(0x1cb))/0x2*(parseInt(_0x428128(0x1c9))/0x3)+parseInt(_0x428128(0x1bf))/0x4+-parseInt(_0x428128(0x1d5))/0x5+-parseInt(_0x428128(0x1c5))/0x6+parseInt(_0x428128(0x1c6))/0x7+parseInt(_0x428128(0x1c4))/0x8;if(_0x1be103===_0x43fe39)break;else _0x31e504['push'](_0x31e504['shift']());}catch(_0x4d45e0){_0x31e504['push'](_0x31e504['shift']());}}}(a36_0x5370,0x465fb));var __importDefault=this&&this[a36_0x48af37(0x1ce)]||function(_0x4a1880){const _0x501fca=a36_0x48af37;return _0x4a1880&&_0x4a1880[_0x501fca(0x1bc)]?_0x4a1880:{'default':_0x4a1880};};Object[a36_0x48af37(0x1d2)](exports,a36_0x48af37(0x1bc),{'value':!![]}),exports[a36_0x48af37(0x1d8)]=void 0x0;const bcryptjs_1=__importDefault(require(a36_0x48af37(0x1c8))),jsonwebtoken_1=__importDefault(require('jsonwebtoken')),database_1=__importDefault(require(a36_0x48af37(0x1be))),config_1=require(a36_0x48af37(0x1d7));class AuthService{[a36_0x48af37(0x1d1)](_0x3427c9){const _0x157b4c=a36_0x48af37;return jsonwebtoken_1[_0x157b4c(0x1d0)][_0x157b4c(0x1db)](_0x3427c9,config_1[_0x157b4c(0x1c7)][_0x157b4c(0x1cc)]['secret'],{'expiresIn':String(config_1[_0x157b4c(0x1c7)][_0x157b4c(0x1cc)][_0x157b4c(0x1cf)])});}async[a36_0x48af37(0x1d9)](_0x99f8be){const _0x25f402=a36_0x48af37,{username:_0x3918c4,password:_0x25dcff}=_0x99f8be;if(_0x3918c4===config_1[_0x25f402(0x1c7)][_0x25f402(0x1b9)][_0x25f402(0x1d3)]){const _0xe0b296=await bcryptjs_1[_0x25f402(0x1d0)]['compare'](_0x25dcff,config_1[_0x25f402(0x1c7)][_0x25f402(0x1b9)][_0x25f402(0x1ba)]);if(_0xe0b296){const _0xbc5789=this[_0x25f402(0x1d1)]({'id':_0x25f402(0x1b9),'username':config_1[_0x25f402(0x1c7)][_0x25f402(0x1b9)]['username'],'role':_0x25f402(0x1b9)});return{'access_token':_0xbc5789,'role':_0x25f402(0x1b9)};}}const _0x4c5cea=await database_1[_0x25f402(0x1d0)]['shop'][_0x25f402(0x1dc)]({'where':{'username':_0x3918c4},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x4c5cea)throw new Error(_0x25f402(0x1d4));if(_0x4c5cea[_0x25f402(0x1da)]!==_0x25f402(0x1bd))throw new Error(_0x25f402(0x1c3));const _0x1d15d3=await bcryptjs_1[_0x25f402(0x1d0)][_0x25f402(0x1c0)](_0x25dcff,_0x4c5cea[_0x25f402(0x1d6)]);if(!_0x1d15d3)throw new Error(_0x25f402(0x1d4));const _0x1f209e=this[_0x25f402(0x1d1)]({'id':_0x4c5cea['id'],'username':_0x4c5cea[_0x25f402(0x1d3)],'role':_0x25f402(0x1bb)});return{'access_token':_0x1f209e,'role':_0x25f402(0x1bb),'user':{'id':_0x4c5cea['id'],'name':_0x4c5cea['name'],'username':_0x4c5cea['username']}};}async['verifyToken'](_0x5df1f5){const _0x19f676=a36_0x48af37;try{const _0x49a734=jsonwebtoken_1[_0x19f676(0x1d0)][_0x19f676(0x1c1)](_0x5df1f5,config_1[_0x19f676(0x1c7)]['jwt'][_0x19f676(0x1c2)]);return _0x49a734;}catch(_0x3ae28f){throw new Error(_0x19f676(0x1cd));}}}function a36_0x5370(){const _0x34dcb5=['shop','__esModule','ACTIVE','../config/database','975388USLHhy','compare','verify','secret','Account\x20is\x20not\x20active','1654896peFaUG','1349178QHSynP','1999949GRExvH','config','bcryptjs','146778dbnpcH','168632yscypR','2zrqsoN','jwt','Invalid\x20token','__importDefault','expiresIn','default','generateToken','defineProperty','username','Invalid\x20credentials','1715040iPfEKe','password','../config/config','AuthService','login','status','sign','findUnique','admin','passwordHash'];a36_0x5370=function(){return _0x34dcb5;};return a36_0x5370();}exports['AuthService']=AuthService;