'use strict';const a41_0x3322c9=a41_0x5a7d;(function(_0x33ee37,_0x835b5d){const _0x44d348=a41_0x5a7d,_0x1ca571=_0x33ee37();while(!![]){try{const _0x2cbc30=-parseInt(_0x44d348(0x14a))/0x1*(-parseInt(_0x44d348(0x15c))/0x2)+-parseInt(_0x44d348(0x151))/0x3+-parseInt(_0x44d348(0x14c))/0x4+-parseInt(_0x44d348(0x14b))/0x5+-parseInt(_0x44d348(0x159))/0x6+parseInt(_0x44d348(0x146))/0x7+parseInt(_0x44d348(0x15b))/0x8;if(_0x2cbc30===_0x835b5d)break;else _0x1ca571['push'](_0x1ca571['shift']());}catch(_0x2c0fcf){_0x1ca571['push'](_0x1ca571['shift']());}}}(a41_0x2bc4,0xcf8df));function a41_0x2bc4(){const _0x333654=['345220HajnYl','compare','admin','defineProperty','default','4463028WoWKnr','Account\x20is\x20not\x20active','expiresIn','Invalid\x20credentials','__importDefault','shop','AuthService','jwt','1008480Mjsivk','__esModule','20739952NLltgl','792906xdGMln','sign','secret','ACTIVE','bcryptjs','login','generateToken','status','verifyToken','config','passwordHash','8735307VTSrQr','password','jsonwebtoken','username','1LNQSZe','8223220nxDnLg'];a41_0x2bc4=function(){return _0x333654;};return a41_0x2bc4();}function a41_0x5a7d(_0xd46569,_0x36ec91){const _0x2bc4e4=a41_0x2bc4();return a41_0x5a7d=function(_0x5a7d08,_0x5bd10b){_0x5a7d08=_0x5a7d08-0x13d;let _0x164fbf=_0x2bc4e4[_0x5a7d08];return _0x164fbf;},a41_0x5a7d(_0xd46569,_0x36ec91);}var __importDefault=this&&this[a41_0x3322c9(0x155)]||function(_0x1a85e8){const _0x297247=a41_0x3322c9;return _0x1a85e8&&_0x1a85e8[_0x297247(0x15a)]?_0x1a85e8:{'default':_0x1a85e8};};Object[a41_0x3322c9(0x14f)](exports,'__esModule',{'value':!![]}),exports[a41_0x3322c9(0x157)]=void 0x0;const bcryptjs_1=__importDefault(require(a41_0x3322c9(0x13f))),jsonwebtoken_1=__importDefault(require(a41_0x3322c9(0x148))),database_1=__importDefault(require('../config/database')),config_1=require('../config/config');class AuthService{[a41_0x3322c9(0x141)](_0x38c299){const _0x26be26=a41_0x3322c9;return jsonwebtoken_1[_0x26be26(0x150)][_0x26be26(0x15d)](_0x38c299,config_1['config'][_0x26be26(0x158)][_0x26be26(0x13d)],{'expiresIn':String(config_1['config']['jwt'][_0x26be26(0x153)])});}async[a41_0x3322c9(0x140)](_0x2a10a9){const _0x5d0fec=a41_0x3322c9,{username:_0x185c2f,password:_0x469aee}=_0x2a10a9;if(_0x185c2f===config_1[_0x5d0fec(0x144)][_0x5d0fec(0x14e)]['username']){const _0x51a05c=await bcryptjs_1['default'][_0x5d0fec(0x14d)](_0x469aee,config_1['config'][_0x5d0fec(0x14e)][_0x5d0fec(0x145)]);if(_0x51a05c){const _0x5527d1=this['generateToken']({'id':'admin','username':config_1[_0x5d0fec(0x144)]['admin'][_0x5d0fec(0x149)],'role':_0x5d0fec(0x14e)});return{'access_token':_0x5527d1,'role':_0x5d0fec(0x14e)};}}const _0x18fcd3=await database_1['default']['shop']['findUnique']({'where':{'username':_0x185c2f},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x18fcd3)throw new Error(_0x5d0fec(0x154));if(_0x18fcd3[_0x5d0fec(0x142)]!==_0x5d0fec(0x13e))throw new Error(_0x5d0fec(0x152));const _0x114b80=await bcryptjs_1[_0x5d0fec(0x150)][_0x5d0fec(0x14d)](_0x469aee,_0x18fcd3[_0x5d0fec(0x147)]);if(!_0x114b80)throw new Error(_0x5d0fec(0x154));const _0xa0f737=this['generateToken']({'id':_0x18fcd3['id'],'username':_0x18fcd3['username'],'role':'shop'});return{'access_token':_0xa0f737,'role':_0x5d0fec(0x156),'user':{'id':_0x18fcd3['id'],'name':_0x18fcd3['name'],'username':_0x18fcd3[_0x5d0fec(0x149)]}};}async[a41_0x3322c9(0x143)](_0x3ad386){const _0x2fc973=a41_0x3322c9;try{const _0x1da5b0=jsonwebtoken_1[_0x2fc973(0x150)]['verify'](_0x3ad386,config_1['config'][_0x2fc973(0x158)][_0x2fc973(0x13d)]);return _0x1da5b0;}catch(_0x273247){throw new Error('Invalid\x20token');}}}exports['AuthService']=AuthService;