'use strict';function a36_0x4a1c(_0x3a1019,_0x2ca103){const _0x585147=a36_0x5851();return a36_0x4a1c=function(_0x4a1ce2,_0x318d71){_0x4a1ce2=_0x4a1ce2-0x9f;let _0xcec785=_0x585147[_0x4a1ce2];return _0xcec785;},a36_0x4a1c(_0x3a1019,_0x2ca103);}function a36_0x5851(){const _0x11224d=['180028VevnXk','admin','bcryptjs','12tFmwVa','default','jwt','11361861sKHHYk','566488WsADIO','shop','name','status','1450484pjdsRr','expiresIn','../config/config','8yuXNgu','41599420WZnOoe','4307786zqoWaq','__esModule','config','jsonwebtoken','defineProperty','verify','username','generateToken','compare','password','Invalid\x20token','passwordHash','secret','6sbKWHU','__importDefault','../config/database','3679450NqeItW','ACTIVE','Invalid\x20credentials','findUnique'];a36_0x5851=function(){return _0x11224d;};return a36_0x5851();}const a36_0x116edc=a36_0x4a1c;(function(_0x2f8306,_0x37dd93){const _0x3e09f0=a36_0x4a1c,_0xc5912f=_0x2f8306();while(!![]){try{const _0x1edd8e=parseInt(_0x3e09f0(0xc0))/0x1+-parseInt(_0x3e09f0(0xb9))/0x2*(parseInt(_0x3e09f0(0xb2))/0x3)+-parseInt(_0x3e09f0(0xa0))/0x4+parseInt(_0x3e09f0(0xb5))/0x5*(-parseInt(_0x3e09f0(0xbc))/0x6)+-parseInt(_0x3e09f0(0xa5))/0x7+parseInt(_0x3e09f0(0xa3))/0x8*(-parseInt(_0x3e09f0(0xbf))/0x9)+parseInt(_0x3e09f0(0xa4))/0xa;if(_0x1edd8e===_0x37dd93)break;else _0xc5912f['push'](_0xc5912f['shift']());}catch(_0x5f50bd){_0xc5912f['push'](_0xc5912f['shift']());}}}(a36_0x5851,0xcba7e));var __importDefault=this&&this[a36_0x116edc(0xb3)]||function(_0x34c774){const _0x21debc=a36_0x116edc;return _0x34c774&&_0x34c774[_0x21debc(0xa6)]?_0x34c774:{'default':_0x34c774};};Object[a36_0x116edc(0xa9)](exports,'__esModule',{'value':!![]}),exports['AuthService']=void 0x0;const bcryptjs_1=__importDefault(require(a36_0x116edc(0xbb))),jsonwebtoken_1=__importDefault(require(a36_0x116edc(0xa8))),database_1=__importDefault(require(a36_0x116edc(0xb4))),config_1=require(a36_0x116edc(0xa2));class AuthService{[a36_0x116edc(0xac)](_0x25ad74){const _0x5eb922=a36_0x116edc;return jsonwebtoken_1['default']['sign'](_0x25ad74,config_1[_0x5eb922(0xa7)][_0x5eb922(0xbe)][_0x5eb922(0xb1)],{'expiresIn':String(config_1['config'][_0x5eb922(0xbe)][_0x5eb922(0xa1)])});}async['login'](_0x1c2318){const _0x36e26c=a36_0x116edc,{username:_0x3d6bf5,password:_0x3997e8}=_0x1c2318;if(_0x3d6bf5===config_1[_0x36e26c(0xa7)][_0x36e26c(0xba)][_0x36e26c(0xab)]){const _0x4192c0=await bcryptjs_1[_0x36e26c(0xbd)][_0x36e26c(0xad)](_0x3997e8,config_1[_0x36e26c(0xa7)][_0x36e26c(0xba)][_0x36e26c(0xb0)]);if(_0x4192c0){const _0x123b2c=this[_0x36e26c(0xac)]({'id':_0x36e26c(0xba),'username':config_1[_0x36e26c(0xa7)][_0x36e26c(0xba)][_0x36e26c(0xab)],'role':_0x36e26c(0xba)});return{'access_token':_0x123b2c,'role':'admin'};}}const _0xf24e92=await database_1[_0x36e26c(0xbd)][_0x36e26c(0xc1)][_0x36e26c(0xb8)]({'where':{'username':_0x3d6bf5},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0xf24e92)throw new Error(_0x36e26c(0xb7));if(_0xf24e92[_0x36e26c(0x9f)]!==_0x36e26c(0xb6))throw new Error('Account\x20is\x20not\x20active');const _0x1831ae=await bcryptjs_1[_0x36e26c(0xbd)][_0x36e26c(0xad)](_0x3997e8,_0xf24e92[_0x36e26c(0xae)]);if(!_0x1831ae)throw new Error('Invalid\x20credentials');const _0x543080=this[_0x36e26c(0xac)]({'id':_0xf24e92['id'],'username':_0xf24e92['username'],'role':_0x36e26c(0xc1)});return{'access_token':_0x543080,'role':'shop','user':{'id':_0xf24e92['id'],'name':_0xf24e92[_0x36e26c(0xc2)],'username':_0xf24e92[_0x36e26c(0xab)]}};}async['verifyToken'](_0x52adc5){const _0x48b490=a36_0x116edc;try{const _0x9435c5=jsonwebtoken_1[_0x48b490(0xbd)][_0x48b490(0xaa)](_0x52adc5,config_1[_0x48b490(0xa7)]['jwt'][_0x48b490(0xb1)]);return _0x9435c5;}catch(_0x25ff3e){throw new Error(_0x48b490(0xaf));}}}exports['AuthService']=AuthService;