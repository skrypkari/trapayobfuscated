'use strict';const a47_0x27a5e0=a47_0x1e2c;(function(_0x1820b2,_0x266eb8){const _0x29b1db=a47_0x1e2c,_0x18c7c9=_0x1820b2();while(!![]){try{const _0x2f9455=parseInt(_0x29b1db(0xb4))/0x1*(parseInt(_0x29b1db(0xc4))/0x2)+-parseInt(_0x29b1db(0xc2))/0x3*(-parseInt(_0x29b1db(0xb9))/0x4)+-parseInt(_0x29b1db(0xbb))/0x5+-parseInt(_0x29b1db(0xba))/0x6+parseInt(_0x29b1db(0xb1))/0x7+-parseInt(_0x29b1db(0xab))/0x8+-parseInt(_0x29b1db(0xbf))/0x9*(parseInt(_0x29b1db(0xbe))/0xa);if(_0x2f9455===_0x266eb8)break;else _0x18c7c9['push'](_0x18c7c9['shift']());}catch(_0x4282c0){_0x18c7c9['push'](_0x18c7c9['shift']());}}}(a47_0x93c5,0x39cc2));var __importDefault=this&&this[a47_0x27a5e0(0xbd)]||function(_0x101277){const _0x37ed6a=a47_0x27a5e0;return _0x101277&&_0x101277[_0x37ed6a(0xc3)]?_0x101277:{'default':_0x101277};};Object[a47_0x27a5e0(0xbc)](exports,a47_0x27a5e0(0xc3),{'value':!![]}),exports[a47_0x27a5e0(0xad)]=void 0x0;const bcryptjs_1=__importDefault(require(a47_0x27a5e0(0xa4))),jsonwebtoken_1=__importDefault(require(a47_0x27a5e0(0xb5))),database_1=__importDefault(require(a47_0x27a5e0(0xa9))),config_1=require(a47_0x27a5e0(0xc0));class AuthService{[a47_0x27a5e0(0xb2)](_0x1a6b15){const _0x42f03d=a47_0x27a5e0;return jsonwebtoken_1[_0x42f03d(0xb8)]['sign'](_0x1a6b15,config_1[_0x42f03d(0xae)][_0x42f03d(0xb6)][_0x42f03d(0xaa)],{'expiresIn':String(config_1[_0x42f03d(0xae)][_0x42f03d(0xb6)][_0x42f03d(0xa7)])});}async[a47_0x27a5e0(0xc1)](_0x3e8332){const _0xdc44ae=a47_0x27a5e0,{username:_0x291ebb,password:_0x13cf77}=_0x3e8332;if(_0x291ebb===config_1[_0xdc44ae(0xae)][_0xdc44ae(0xac)][_0xdc44ae(0xa8)]){const _0x311340=await bcryptjs_1[_0xdc44ae(0xb8)][_0xdc44ae(0xa3)](_0x13cf77,config_1[_0xdc44ae(0xae)][_0xdc44ae(0xac)][_0xdc44ae(0xaf)]);if(_0x311340){const _0x4e987c=this[_0xdc44ae(0xb2)]({'id':_0xdc44ae(0xac),'username':config_1['config'][_0xdc44ae(0xac)][_0xdc44ae(0xa8)],'role':_0xdc44ae(0xac)});return{'access_token':_0x4e987c,'role':_0xdc44ae(0xac)};}}const _0x828c9d=await database_1['default'][_0xdc44ae(0xa6)][_0xdc44ae(0xb7)]({'where':{'username':_0x291ebb},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x828c9d)throw new Error(_0xdc44ae(0xb0));if(_0x828c9d[_0xdc44ae(0xa5)]!=='ACTIVE')throw new Error(_0xdc44ae(0xa2));const _0x4fdafc=await bcryptjs_1[_0xdc44ae(0xb8)][_0xdc44ae(0xa3)](_0x13cf77,_0x828c9d[_0xdc44ae(0xb3)]);if(!_0x4fdafc)throw new Error('Invalid\x20credentials');const _0x2e2b6d=this[_0xdc44ae(0xb2)]({'id':_0x828c9d['id'],'username':_0x828c9d[_0xdc44ae(0xa8)],'role':_0xdc44ae(0xa6)});return{'access_token':_0x2e2b6d,'role':'shop','user':{'id':_0x828c9d['id'],'name':_0x828c9d['name'],'username':_0x828c9d[_0xdc44ae(0xa8)]}};}async['verifyToken'](_0x523df7){const _0x97e523=a47_0x27a5e0;try{const _0x328a3e=jsonwebtoken_1[_0x97e523(0xb8)]['verify'](_0x523df7,config_1[_0x97e523(0xae)][_0x97e523(0xb6)][_0x97e523(0xaa)]);return _0x328a3e;}catch(_0x514f78){throw new Error('Invalid\x20token');}}}function a47_0x93c5(){const _0x4d9410=['passwordHash','Invalid\x20credentials','2886219SjjLPO','generateToken','password','1XmSrPz','jsonwebtoken','jwt','findUnique','default','8JMRPYL','1769322UrjXDy','1343770uNZGXM','defineProperty','__importDefault','9740XQjVks','1233MTYOMY','../config/config','login','479559PyeZcq','__esModule','543506wyqckU','Account\x20is\x20not\x20active','compare','bcryptjs','status','shop','expiresIn','username','../config/database','secret','559672bzCjvD','admin','AuthService','config'];a47_0x93c5=function(){return _0x4d9410;};return a47_0x93c5();}function a47_0x1e2c(_0x1a6be0,_0x21521d){_0x1a6be0=_0x1a6be0-0xa2;const _0x93c5fd=a47_0x93c5();let _0x1e2cda=_0x93c5fd[_0x1a6be0];return _0x1e2cda;}exports[a47_0x27a5e0(0xad)]=AuthService;