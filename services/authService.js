'use strict';const a36_0x366071=a36_0x4ebc;function a36_0x2e1c(){const _0x157020=['default','secret','expiresIn','password','passwordHash','config','shop','__importDefault','ACTIVE','111576cRJJev','../config/config','verify','4088856aNMKAq','../config/database','493085JxGeBe','36086CBWPDU','AuthService','558mPUFeX','Account\x20is\x20not\x20active','Invalid\x20token','verifyToken','findUnique','jsonwebtoken','__esModule','compare','admin','112vLboEm','308514vAPuHA','7870440spxETS','name','login','generateToken','58yPBoFg','jwt','username','Invalid\x20credentials','5520672SoGcJm'];a36_0x2e1c=function(){return _0x157020;};return a36_0x2e1c();}(function(_0x5de692,_0x1116da){const _0x39f4b6=a36_0x4ebc,_0x4c7514=_0x5de692();while(!![]){try{const _0x27ffb1=parseInt(_0x39f4b6(0x95))/0x1*(-parseInt(_0x39f4b6(0x81))/0x2)+parseInt(_0x39f4b6(0x85))/0x3+parseInt(_0x39f4b6(0x92))/0x4+-parseInt(_0x39f4b6(0x94))/0x5+-parseInt(_0x39f4b6(0x7c))/0x6*(parseInt(_0x39f4b6(0x7b))/0x7)+-parseInt(_0x39f4b6(0x8f))/0x8*(-parseInt(_0x39f4b6(0x97))/0x9)+-parseInt(_0x39f4b6(0x7d))/0xa;if(_0x27ffb1===_0x1116da)break;else _0x4c7514['push'](_0x4c7514['shift']());}catch(_0x839230){_0x4c7514['push'](_0x4c7514['shift']());}}}(a36_0x2e1c,0xed605));var __importDefault=this&&this[a36_0x366071(0x8d)]||function(_0x3c086b){const _0x4238c3=a36_0x366071;return _0x3c086b&&_0x3c086b[_0x4238c3(0x9d)]?_0x3c086b:{'default':_0x3c086b};};Object['defineProperty'](exports,a36_0x366071(0x9d),{'value':!![]}),exports[a36_0x366071(0x96)]=void 0x0;function a36_0x4ebc(_0x43e4e3,_0x1a43f0){const _0x2e1c9c=a36_0x2e1c();return a36_0x4ebc=function(_0x4ebcd6,_0x5793bc){_0x4ebcd6=_0x4ebcd6-0x7b;let _0x2635f6=_0x2e1c9c[_0x4ebcd6];return _0x2635f6;},a36_0x4ebc(_0x43e4e3,_0x1a43f0);}const bcryptjs_1=__importDefault(require('bcryptjs')),jsonwebtoken_1=__importDefault(require(a36_0x366071(0x9c))),database_1=__importDefault(require(a36_0x366071(0x93))),config_1=require(a36_0x366071(0x90));class AuthService{['generateToken'](_0x3e51f8){const _0x58d0f0=a36_0x366071;return jsonwebtoken_1[_0x58d0f0(0x86)]['sign'](_0x3e51f8,config_1[_0x58d0f0(0x8b)][_0x58d0f0(0x82)][_0x58d0f0(0x87)],{'expiresIn':String(config_1[_0x58d0f0(0x8b)]['jwt'][_0x58d0f0(0x88)])});}async[a36_0x366071(0x7f)](_0x4edf29){const _0x16b591=a36_0x366071,{username:_0x5058ec,password:_0x2f301b}=_0x4edf29;if(_0x5058ec===config_1[_0x16b591(0x8b)][_0x16b591(0x9f)][_0x16b591(0x83)]){const _0x390668=await bcryptjs_1['default']['compare'](_0x2f301b,config_1[_0x16b591(0x8b)][_0x16b591(0x9f)][_0x16b591(0x8a)]);if(_0x390668){const _0x22219d=this[_0x16b591(0x80)]({'id':_0x16b591(0x9f),'username':config_1['config'][_0x16b591(0x9f)][_0x16b591(0x83)],'role':_0x16b591(0x9f)});return{'access_token':_0x22219d,'role':_0x16b591(0x9f)};}}const _0x3e4ecd=await database_1['default'][_0x16b591(0x8c)][_0x16b591(0x9b)]({'where':{'username':_0x5058ec},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x3e4ecd)throw new Error(_0x16b591(0x84));if(_0x3e4ecd['status']!==_0x16b591(0x8e))throw new Error(_0x16b591(0x98));const _0x5eaf58=await bcryptjs_1[_0x16b591(0x86)][_0x16b591(0x9e)](_0x2f301b,_0x3e4ecd[_0x16b591(0x89)]);if(!_0x5eaf58)throw new Error(_0x16b591(0x84));const _0x4abd2a=this[_0x16b591(0x80)]({'id':_0x3e4ecd['id'],'username':_0x3e4ecd['username'],'role':_0x16b591(0x8c)});return{'access_token':_0x4abd2a,'role':_0x16b591(0x8c),'user':{'id':_0x3e4ecd['id'],'name':_0x3e4ecd[_0x16b591(0x7e)],'username':_0x3e4ecd[_0x16b591(0x83)]}};}async[a36_0x366071(0x9a)](_0x146f37){const _0x685180=a36_0x366071;try{const _0x31be2a=jsonwebtoken_1['default'][_0x685180(0x91)](_0x146f37,config_1[_0x685180(0x8b)][_0x685180(0x82)][_0x685180(0x87)]);return _0x31be2a;}catch(_0x1b46d7){throw new Error(_0x685180(0x99));}}}exports[a36_0x366071(0x96)]=AuthService;