'use strict';const a37_0x4191b4=a37_0x377e;(function(_0x2e72fc,_0x3d3e9c){const _0x3ec799=a37_0x377e,_0x111907=_0x2e72fc();while(!![]){try{const _0x18bcff=-parseInt(_0x3ec799(0xae))/0x1*(parseInt(_0x3ec799(0x98))/0x2)+-parseInt(_0x3ec799(0x8c))/0x3+parseInt(_0x3ec799(0x99))/0x4+parseInt(_0x3ec799(0x95))/0x5*(parseInt(_0x3ec799(0x92))/0x6)+-parseInt(_0x3ec799(0x9d))/0x7*(-parseInt(_0x3ec799(0xa4))/0x8)+parseInt(_0x3ec799(0x9c))/0x9+-parseInt(_0x3ec799(0xaa))/0xa*(parseInt(_0x3ec799(0xab))/0xb);if(_0x18bcff===_0x3d3e9c)break;else _0x111907['push'](_0x111907['shift']());}catch(_0x55af13){_0x111907['push'](_0x111907['shift']());}}}(a37_0x2b65,0x9afcb));function a37_0x377e(_0x4324f0,_0x7bde43){const _0x2b6512=a37_0x2b65();return a37_0x377e=function(_0x377e7e,_0x2d1786){_0x377e7e=_0x377e7e-0x8b;let _0x5a20fe=_0x2b6512[_0x377e7e];return _0x5a20fe;},a37_0x377e(_0x4324f0,_0x7bde43);}var __importDefault=this&&this[a37_0x4191b4(0x9f)]||function(_0x2ba788){const _0x1fe87c=a37_0x4191b4;return _0x2ba788&&_0x2ba788[_0x1fe87c(0x8e)]?_0x2ba788:{'default':_0x2ba788};};Object[a37_0x4191b4(0x96)](exports,a37_0x4191b4(0x8e),{'value':!![]}),exports[a37_0x4191b4(0x8d)]=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),jsonwebtoken_1=__importDefault(require(a37_0x4191b4(0xb0))),database_1=__importDefault(require(a37_0x4191b4(0x9e))),config_1=require('../config/config');class AuthService{[a37_0x4191b4(0xa5)](_0x15d853){const _0x3dab67=a37_0x4191b4;return jsonwebtoken_1[_0x3dab67(0x8f)]['sign'](_0x15d853,config_1[_0x3dab67(0xa1)][_0x3dab67(0xaf)]['secret'],{'expiresIn':String(config_1['config'][_0x3dab67(0xaf)][_0x3dab67(0xa7)])});}async['login'](_0x1a33a5){const _0x57b59b=a37_0x4191b4,{username:_0x3f32b3,password:_0x2106cb}=_0x1a33a5;if(_0x3f32b3===config_1['config'][_0x57b59b(0x9a)][_0x57b59b(0xad)]){const _0x51b738=await bcryptjs_1[_0x57b59b(0x8f)][_0x57b59b(0x97)](_0x2106cb,config_1[_0x57b59b(0xa1)][_0x57b59b(0x9a)][_0x57b59b(0xa3)]);if(_0x51b738){const _0x359aaf=this[_0x57b59b(0xa5)]({'id':_0x57b59b(0x9a),'username':config_1['config'][_0x57b59b(0x9a)][_0x57b59b(0xad)],'role':_0x57b59b(0x9a)});return{'access_token':_0x359aaf,'role':_0x57b59b(0x9a)};}}const _0x474093=await database_1[_0x57b59b(0x8f)][_0x57b59b(0xa0)][_0x57b59b(0x93)]({'where':{'username':_0x3f32b3},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x474093)throw new Error(_0x57b59b(0x90));if(_0x474093[_0x57b59b(0xac)]!==_0x57b59b(0x94))throw new Error(_0x57b59b(0x8b));const _0x2e43cf=await bcryptjs_1[_0x57b59b(0x8f)][_0x57b59b(0x97)](_0x2106cb,_0x474093[_0x57b59b(0xa8)]);if(!_0x2e43cf)throw new Error(_0x57b59b(0x90));const _0x92bc68=this[_0x57b59b(0xa5)]({'id':_0x474093['id'],'username':_0x474093[_0x57b59b(0xad)],'role':_0x57b59b(0xa0)});return{'access_token':_0x92bc68,'role':'shop','user':{'id':_0x474093['id'],'name':_0x474093[_0x57b59b(0xa6)],'username':_0x474093[_0x57b59b(0xad)]}};}async[a37_0x4191b4(0x91)](_0x189537){const _0x1d6e31=a37_0x4191b4;try{const _0x2b6eb1=jsonwebtoken_1['default'][_0x1d6e31(0xa2)](_0x189537,config_1[_0x1d6e31(0xa1)][_0x1d6e31(0xaf)][_0x1d6e31(0xa9)]);return _0x2b6eb1;}catch(_0x627354){throw new Error(_0x1d6e31(0x9b));}}}function a37_0x2b65(){const _0x557521=['default','Invalid\x20credentials','verifyToken','1205124pmfzxt','findUnique','ACTIVE','5yFeWFj','defineProperty','compare','2286wzGiXk','4197692mNcSug','admin','Invalid\x20token','7912170zIhSFj','134449DVfZcP','../config/database','__importDefault','shop','config','verify','passwordHash','472fTgtKl','generateToken','name','expiresIn','password','secret','20cBXJus','7132917jeyZxN','status','username','107yyFyOK','jwt','jsonwebtoken','Account\x20is\x20not\x20active','3625794oNNDGK','AuthService','__esModule'];a37_0x2b65=function(){return _0x557521;};return a37_0x2b65();}exports[a37_0x4191b4(0x8d)]=AuthService;