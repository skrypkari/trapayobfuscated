'use strict';function a37_0x400c(){const _0x2cbfa7=['secret','879447RbqzrC','config','Account\x20is\x20not\x20active','default','2OXtQbj','expiresIn','13794715WpwbYn','verifyToken','1964889OZwoSv','Invalid\x20token','password','2718642wGgXne','generateToken','shop','76120tpoWee','../config/database','compare','5ShBxnY','323672NkENup','../config/config','AuthService','1233ANkyKP','jsonwebtoken','passwordHash','77GNUZFQ','sign','status','username','Invalid\x20credentials','verify','601100CsiVFU','login','__esModule','12jFVpkz','admin','__importDefault','name','defineProperty','findUnique'];a37_0x400c=function(){return _0x2cbfa7;};return a37_0x400c();}const a37_0x23864e=a37_0x399c;function a37_0x399c(_0x476541,_0x56c1c3){const _0x400ccb=a37_0x400c();return a37_0x399c=function(_0x399cbd,_0x15fcde){_0x399cbd=_0x399cbd-0xd7;let _0x2215f3=_0x400ccb[_0x399cbd];return _0x2215f3;},a37_0x399c(_0x476541,_0x56c1c3);}(function(_0x344f87,_0x556ea4){const _0x40883b=a37_0x399c,_0x57cc11=_0x344f87();while(!![]){try{const _0x21a779=parseInt(_0x40883b(0xdf))/0x1+parseInt(_0x40883b(0xe3))/0x2*(-parseInt(_0x40883b(0xe7))/0x3)+parseInt(_0x40883b(0xfd))/0x4*(parseInt(_0x40883b(0xf0))/0x5)+-parseInt(_0x40883b(0xea))/0x6+-parseInt(_0x40883b(0xf7))/0x7*(-parseInt(_0x40883b(0xf1))/0x8)+parseInt(_0x40883b(0xf4))/0x9*(-parseInt(_0x40883b(0xed))/0xa)+parseInt(_0x40883b(0xe5))/0xb*(parseInt(_0x40883b(0xd8))/0xc);if(_0x21a779===_0x556ea4)break;else _0x57cc11['push'](_0x57cc11['shift']());}catch(_0x4fe8b9){_0x57cc11['push'](_0x57cc11['shift']());}}}(a37_0x400c,0x8d182));var __importDefault=this&&this[a37_0x23864e(0xda)]||function(_0x3750f6){return _0x3750f6&&_0x3750f6['__esModule']?_0x3750f6:{'default':_0x3750f6};};Object[a37_0x23864e(0xdc)](exports,a37_0x23864e(0xd7),{'value':!![]}),exports[a37_0x23864e(0xf3)]=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),jsonwebtoken_1=__importDefault(require(a37_0x23864e(0xf5))),database_1=__importDefault(require(a37_0x23864e(0xee))),config_1=require(a37_0x23864e(0xf2));class AuthService{[a37_0x23864e(0xeb)](_0x109f62){const _0x3940e8=a37_0x23864e;return jsonwebtoken_1['default'][_0x3940e8(0xf8)](_0x109f62,config_1[_0x3940e8(0xe0)]['jwt'][_0x3940e8(0xde)],{'expiresIn':String(config_1['config']['jwt'][_0x3940e8(0xe4)])});}async[a37_0x23864e(0xfe)](_0x11a563){const _0x453c1b=a37_0x23864e,{username:_0x424635,password:_0x4594a8}=_0x11a563;if(_0x424635===config_1['config'][_0x453c1b(0xd9)][_0x453c1b(0xfa)]){const _0x3af381=await bcryptjs_1[_0x453c1b(0xe2)][_0x453c1b(0xef)](_0x4594a8,config_1[_0x453c1b(0xe0)]['admin'][_0x453c1b(0xf6)]);if(_0x3af381){const _0x5979ea=this[_0x453c1b(0xeb)]({'id':'admin','username':config_1[_0x453c1b(0xe0)][_0x453c1b(0xd9)][_0x453c1b(0xfa)],'role':'admin'});return{'access_token':_0x5979ea,'role':_0x453c1b(0xd9)};}}const _0x121619=await database_1[_0x453c1b(0xe2)][_0x453c1b(0xec)][_0x453c1b(0xdd)]({'where':{'username':_0x424635},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x121619)throw new Error(_0x453c1b(0xfb));if(_0x121619[_0x453c1b(0xf9)]!=='ACTIVE')throw new Error(_0x453c1b(0xe1));const _0x3e4777=await bcryptjs_1[_0x453c1b(0xe2)][_0x453c1b(0xef)](_0x4594a8,_0x121619[_0x453c1b(0xe9)]);if(!_0x3e4777)throw new Error(_0x453c1b(0xfb));const _0x53d6a4=this[_0x453c1b(0xeb)]({'id':_0x121619['id'],'username':_0x121619[_0x453c1b(0xfa)],'role':'shop'});return{'access_token':_0x53d6a4,'role':_0x453c1b(0xec),'user':{'id':_0x121619['id'],'name':_0x121619[_0x453c1b(0xdb)],'username':_0x121619[_0x453c1b(0xfa)]}};}async[a37_0x23864e(0xe6)](_0x4f9ed2){const _0x371a00=a37_0x23864e;try{const _0xd7349c=jsonwebtoken_1['default'][_0x371a00(0xfc)](_0x4f9ed2,config_1['config']['jwt']['secret']);return _0xd7349c;}catch(_0x39fb5a){throw new Error(_0x371a00(0xe8));}}}exports[a37_0x23864e(0xf3)]=AuthService;