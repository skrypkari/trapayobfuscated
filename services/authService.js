'use strict';const a39_0x214c30=a39_0x4623;(function(_0x4ca82a,_0x2fdab4){const _0x142b5e=a39_0x4623,_0x58eb94=_0x4ca82a();while(!![]){try{const _0x3fc091=parseInt(_0x142b5e(0x1be))/0x1*(parseInt(_0x142b5e(0x1c7))/0x2)+parseInt(_0x142b5e(0x1d4))/0x3+-parseInt(_0x142b5e(0x1c8))/0x4*(-parseInt(_0x142b5e(0x1bf))/0x5)+-parseInt(_0x142b5e(0x1d1))/0x6+-parseInt(_0x142b5e(0x1cf))/0x7+-parseInt(_0x142b5e(0x1da))/0x8*(-parseInt(_0x142b5e(0x1d8))/0x9)+-parseInt(_0x142b5e(0x1e3))/0xa;if(_0x3fc091===_0x2fdab4)break;else _0x58eb94['push'](_0x58eb94['shift']());}catch(_0x346ad){_0x58eb94['push'](_0x58eb94['shift']());}}}(a39_0xbca1,0x4d7f7));function a39_0x4623(_0x2200c4,_0xd184b3){const _0xbca1e8=a39_0xbca1();return a39_0x4623=function(_0x4623b4,_0x327b26){_0x4623b4=_0x4623b4-0x1bc;let _0x47d9=_0xbca1e8[_0x4623b4];return _0x47d9;},a39_0x4623(_0x2200c4,_0xd184b3);}var __importDefault=this&&this[a39_0x214c30(0x1c6)]||function(_0x4b3127){return _0x4b3127&&_0x4b3127['__esModule']?_0x4b3127:{'default':_0x4b3127};};Object[a39_0x214c30(0x1cb)](exports,a39_0x214c30(0x1e2),{'value':!![]}),exports[a39_0x214c30(0x1c5)]=void 0x0;const bcryptjs_1=__importDefault(require(a39_0x214c30(0x1de))),jsonwebtoken_1=__importDefault(require(a39_0x214c30(0x1cd))),database_1=__importDefault(require('../config/database')),config_1=require(a39_0x214c30(0x1d3));class AuthService{[a39_0x214c30(0x1d5)](_0x280f38){const _0x978df7=a39_0x214c30;return jsonwebtoken_1[_0x978df7(0x1d2)][_0x978df7(0x1c4)](_0x280f38,config_1[_0x978df7(0x1c0)][_0x978df7(0x1d6)][_0x978df7(0x1dd)],{'expiresIn':String(config_1['config'][_0x978df7(0x1d6)][_0x978df7(0x1ca)])});}async[a39_0x214c30(0x1dc)](_0x7c2507){const _0x4be3f6=a39_0x214c30,{username:_0x3e9b31,password:_0x4cfa1a}=_0x7c2507;if(_0x3e9b31===config_1['config']['admin'][_0x4be3f6(0x1bd)]){const _0x38d750=await bcryptjs_1['default'][_0x4be3f6(0x1c9)](_0x4cfa1a,config_1['config'][_0x4be3f6(0x1bc)][_0x4be3f6(0x1c3)]);if(_0x38d750){const _0x2f6a44=this[_0x4be3f6(0x1d5)]({'id':_0x4be3f6(0x1bc),'username':config_1[_0x4be3f6(0x1c0)]['admin'][_0x4be3f6(0x1bd)],'role':_0x4be3f6(0x1bc)});return{'access_token':_0x2f6a44,'role':_0x4be3f6(0x1bc)};}}const _0x93ab25=await database_1[_0x4be3f6(0x1d2)][_0x4be3f6(0x1db)][_0x4be3f6(0x1e1)]({'where':{'username':_0x3e9b31},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x93ab25)throw new Error('Invalid\x20credentials');if(_0x93ab25[_0x4be3f6(0x1d0)]!==_0x4be3f6(0x1e0))throw new Error(_0x4be3f6(0x1c2));const _0x465f0e=await bcryptjs_1[_0x4be3f6(0x1d2)]['compare'](_0x4cfa1a,_0x93ab25[_0x4be3f6(0x1ce)]);if(!_0x465f0e)throw new Error(_0x4be3f6(0x1df));const _0x205fbc=this['generateToken']({'id':_0x93ab25['id'],'username':_0x93ab25['username'],'role':_0x4be3f6(0x1db)});return{'access_token':_0x205fbc,'role':_0x4be3f6(0x1db),'user':{'id':_0x93ab25['id'],'name':_0x93ab25[_0x4be3f6(0x1c1)],'username':_0x93ab25[_0x4be3f6(0x1bd)]}};}async[a39_0x214c30(0x1d7)](_0x34602c){const _0x5ee590=a39_0x214c30;try{const _0x4424b6=jsonwebtoken_1[_0x5ee590(0x1d2)][_0x5ee590(0x1cc)](_0x34602c,config_1[_0x5ee590(0x1c0)][_0x5ee590(0x1d6)]['secret']);return _0x4424b6;}catch(_0x4e8aef){throw new Error(_0x5ee590(0x1d9));}}}function a39_0xbca1(){const _0x29092e=['13159310frFpMY','admin','username','109iOzSzL','27185mPnOcF','config','name','Account\x20is\x20not\x20active','passwordHash','sign','AuthService','__importDefault','11584JdDCRt','232jQlysy','compare','expiresIn','defineProperty','verify','jsonwebtoken','password','153678QZtnGe','status','1274532CUBjSG','default','../config/config','1008243aBSBYM','generateToken','jwt','verifyToken','5264847gxeBYv','Invalid\x20token','8ZDKfsJ','shop','login','secret','bcryptjs','Invalid\x20credentials','ACTIVE','findUnique','__esModule'];a39_0xbca1=function(){return _0x29092e;};return a39_0xbca1();}exports[a39_0x214c30(0x1c5)]=AuthService;