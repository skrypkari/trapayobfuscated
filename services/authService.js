'use strict';const a34_0x169ddb=a34_0x5b8a;(function(_0x573dc8,_0x1d2132){const _0x3f6880=a34_0x5b8a,_0x45a248=_0x573dc8();while(!![]){try{const _0x5c98c1=parseInt(_0x3f6880(0xd1))/0x1+-parseInt(_0x3f6880(0xbf))/0x2*(-parseInt(_0x3f6880(0xce))/0x3)+-parseInt(_0x3f6880(0xdc))/0x4+parseInt(_0x3f6880(0xd4))/0x5+parseInt(_0x3f6880(0xdb))/0x6*(parseInt(_0x3f6880(0xdd))/0x7)+parseInt(_0x3f6880(0xc9))/0x8+-parseInt(_0x3f6880(0xbe))/0x9;if(_0x5c98c1===_0x1d2132)break;else _0x45a248['push'](_0x45a248['shift']());}catch(_0xae2699){_0x45a248['push'](_0x45a248['shift']());}}}(a34_0x583d,0x9819f));function a34_0x5b8a(_0x10997b,_0x3867eb){const _0x583d77=a34_0x583d();return a34_0x5b8a=function(_0x5b8ab2,_0x590cad){_0x5b8ab2=_0x5b8ab2-0xbe;let _0x2d7b3b=_0x583d77[_0x5b8ab2];return _0x2d7b3b;},a34_0x5b8a(_0x10997b,_0x3867eb);}var __importDefault=this&&this['__importDefault']||function(_0x2ef174){const _0x524c45=a34_0x5b8a;return _0x2ef174&&_0x2ef174[_0x524c45(0xda)]?_0x2ef174:{'default':_0x2ef174};};function a34_0x583d(){const _0x300433=['admin','generateToken','default','status','username','__esModule','6AuQpbV','3414572uPiDlm','7708638BPuOtq','secret','verifyToken','sign','jwt','28853712IyXbiQ','9298nyMKgB','ACTIVE','expiresIn','shop','AuthService','config','../config/database','Invalid\x20token','jsonwebtoken','login','9841064dVyvXi','bcryptjs','Account\x20is\x20not\x20active','compare','../config/config','747HJqCav','defineProperty','password','765514KNwigN','findUnique','Invalid\x20credentials','2140680QyhZAh'];a34_0x583d=function(){return _0x300433;};return a34_0x583d();}Object[a34_0x169ddb(0xcf)](exports,a34_0x169ddb(0xda),{'value':!![]}),exports['AuthService']=void 0x0;const bcryptjs_1=__importDefault(require(a34_0x169ddb(0xca))),jsonwebtoken_1=__importDefault(require(a34_0x169ddb(0xc7))),database_1=__importDefault(require(a34_0x169ddb(0xc5))),config_1=require(a34_0x169ddb(0xcd));class AuthService{[a34_0x169ddb(0xd6)](_0x277996){const _0xd54570=a34_0x169ddb;return jsonwebtoken_1[_0xd54570(0xd7)][_0xd54570(0xe0)](_0x277996,config_1[_0xd54570(0xc4)][_0xd54570(0xe1)]['secret'],{'expiresIn':String(config_1['config'][_0xd54570(0xe1)][_0xd54570(0xc1)])});}async[a34_0x169ddb(0xc8)](_0x145204){const _0x3dac14=a34_0x169ddb,{username:_0x2893e4,password:_0x1e8edf}=_0x145204;if(_0x2893e4===config_1[_0x3dac14(0xc4)]['admin'][_0x3dac14(0xd9)]){const _0x790bdf=await bcryptjs_1['default']['compare'](_0x1e8edf,config_1[_0x3dac14(0xc4)][_0x3dac14(0xd5)]['passwordHash']);if(_0x790bdf){const _0x3db25c=this[_0x3dac14(0xd6)]({'id':_0x3dac14(0xd5),'username':config_1[_0x3dac14(0xc4)]['admin']['username'],'role':_0x3dac14(0xd5)});return{'access_token':_0x3db25c,'role':_0x3dac14(0xd5)};}}const _0x4abe2c=await database_1[_0x3dac14(0xd7)][_0x3dac14(0xc2)][_0x3dac14(0xd2)]({'where':{'username':_0x2893e4},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x4abe2c)throw new Error(_0x3dac14(0xd3));if(_0x4abe2c[_0x3dac14(0xd8)]!==_0x3dac14(0xc0))throw new Error(_0x3dac14(0xcb));const _0xbd8bbc=await bcryptjs_1[_0x3dac14(0xd7)][_0x3dac14(0xcc)](_0x1e8edf,_0x4abe2c[_0x3dac14(0xd0)]);if(!_0xbd8bbc)throw new Error('Invalid\x20credentials');const _0x4816e0=this[_0x3dac14(0xd6)]({'id':_0x4abe2c['id'],'username':_0x4abe2c[_0x3dac14(0xd9)],'role':'shop'});return{'access_token':_0x4816e0,'role':_0x3dac14(0xc2),'user':{'id':_0x4abe2c['id'],'name':_0x4abe2c['name'],'username':_0x4abe2c[_0x3dac14(0xd9)]}};}async[a34_0x169ddb(0xdf)](_0x443086){const _0x49939f=a34_0x169ddb;try{const _0x37996e=jsonwebtoken_1[_0x49939f(0xd7)]['verify'](_0x443086,config_1[_0x49939f(0xc4)][_0x49939f(0xe1)][_0x49939f(0xde)]);return _0x37996e;}catch(_0x1ac7ff){throw new Error(_0x49939f(0xc6));}}}exports[a34_0x169ddb(0xc3)]=AuthService;