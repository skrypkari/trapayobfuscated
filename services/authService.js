'use strict';const a36_0x148f6c=a36_0xe3da;function a36_0xe3da(_0xa6006b,_0x4918de){const _0x360776=a36_0x3607();return a36_0xe3da=function(_0xe3dafe,_0x5988fa){_0xe3dafe=_0xe3dafe-0xb0;let _0x2eb203=_0x360776[_0xe3dafe];return _0x2eb203;},a36_0xe3da(_0xa6006b,_0x4918de);}(function(_0xd40231,_0x491437){const _0x4a9ca7=a36_0xe3da,_0x4c062b=_0xd40231();while(!![]){try{const _0x184630=-parseInt(_0x4a9ca7(0xd2))/0x1+-parseInt(_0x4a9ca7(0xbc))/0x2+parseInt(_0x4a9ca7(0xd3))/0x3+-parseInt(_0x4a9ca7(0xc0))/0x4*(parseInt(_0x4a9ca7(0xc5))/0x5)+parseInt(_0x4a9ca7(0xbb))/0x6*(-parseInt(_0x4a9ca7(0xb6))/0x7)+parseInt(_0x4a9ca7(0xba))/0x8+parseInt(_0x4a9ca7(0xc1))/0x9;if(_0x184630===_0x491437)break;else _0x4c062b['push'](_0x4c062b['shift']());}catch(_0xb4444c){_0x4c062b['push'](_0x4c062b['shift']());}}}(a36_0x3607,0x219b4));var __importDefault=this&&this[a36_0x148f6c(0xb0)]||function(_0x23c61b){const _0x312d83=a36_0x148f6c;return _0x23c61b&&_0x23c61b[_0x312d83(0xb4)]?_0x23c61b:{'default':_0x23c61b};};Object[a36_0x148f6c(0xcb)](exports,a36_0x148f6c(0xb4),{'value':!![]}),exports[a36_0x148f6c(0xc7)]=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),jsonwebtoken_1=__importDefault(require(a36_0x148f6c(0xb7))),database_1=__importDefault(require(a36_0x148f6c(0xb3))),config_1=require(a36_0x148f6c(0xc2));function a36_0x3607(){const _0x511127=['name','AuthService','login','expiresIn','config','defineProperty','passwordHash','sign','ACTIVE','compare','admin','generateToken','178287VJzbYO','11712bUNqft','__importDefault','jwt','Invalid\x20token','../config/database','__esModule','verify','35ODoUzG','jsonwebtoken','username','findUnique','1669608ilMVfk','32142JICznY','14264myjrqf','shop','secret','default','87756ZyFvIZ','1827612IffoAQ','../config/config','password','Account\x20is\x20not\x20active','15NAOxDB'];a36_0x3607=function(){return _0x511127;};return a36_0x3607();}class AuthService{['generateToken'](_0x3d3491){const _0x37981f=a36_0x148f6c;return jsonwebtoken_1[_0x37981f(0xbf)][_0x37981f(0xcd)](_0x3d3491,config_1[_0x37981f(0xca)][_0x37981f(0xb1)][_0x37981f(0xbe)],{'expiresIn':String(config_1[_0x37981f(0xca)][_0x37981f(0xb1)][_0x37981f(0xc9)])});}async[a36_0x148f6c(0xc8)](_0x3f6f88){const _0xfc667f=a36_0x148f6c,{username:_0x4d6541,password:_0x115bc1}=_0x3f6f88;if(_0x4d6541===config_1[_0xfc667f(0xca)][_0xfc667f(0xd0)][_0xfc667f(0xb8)]){const _0x36f175=await bcryptjs_1['default'][_0xfc667f(0xcf)](_0x115bc1,config_1[_0xfc667f(0xca)]['admin'][_0xfc667f(0xcc)]);if(_0x36f175){const _0x3806df=this[_0xfc667f(0xd1)]({'id':_0xfc667f(0xd0),'username':config_1[_0xfc667f(0xca)][_0xfc667f(0xd0)][_0xfc667f(0xb8)],'role':_0xfc667f(0xd0)});return{'access_token':_0x3806df,'role':_0xfc667f(0xd0)};}}const _0x37d690=await database_1[_0xfc667f(0xbf)][_0xfc667f(0xbd)][_0xfc667f(0xb9)]({'where':{'username':_0x4d6541},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x37d690)throw new Error('Invalid\x20credentials');if(_0x37d690['status']!==_0xfc667f(0xce))throw new Error(_0xfc667f(0xc4));const _0x26e78a=await bcryptjs_1[_0xfc667f(0xbf)][_0xfc667f(0xcf)](_0x115bc1,_0x37d690[_0xfc667f(0xc3)]);if(!_0x26e78a)throw new Error('Invalid\x20credentials');const _0x193e75=this[_0xfc667f(0xd1)]({'id':_0x37d690['id'],'username':_0x37d690[_0xfc667f(0xb8)],'role':_0xfc667f(0xbd)});return{'access_token':_0x193e75,'role':_0xfc667f(0xbd),'user':{'id':_0x37d690['id'],'name':_0x37d690[_0xfc667f(0xc6)],'username':_0x37d690[_0xfc667f(0xb8)]}};}async['verifyToken'](_0x1e22b4){const _0x3d5c89=a36_0x148f6c;try{const _0x130f75=jsonwebtoken_1['default'][_0x3d5c89(0xb5)](_0x1e22b4,config_1['config'][_0x3d5c89(0xb1)][_0x3d5c89(0xbe)]);return _0x130f75;}catch(_0x3d0623){throw new Error(_0x3d5c89(0xb2));}}}exports[a36_0x148f6c(0xc7)]=AuthService;