'use strict';function a36_0xbd05(){const _0x112373=['ACTIVE','admin','25763814HHJHEY','7309506PITevi','14480rCwdSK','compare','jwt','defineProperty','findUnique','5159740CjuVbn','672YxiJTH','passwordHash','4vWkHqd','Account\x20is\x20not\x20active','4926489FqvQch','login','default','bcryptjs','Invalid\x20token','status','321928DktPna','../config/database','10bNWUVn','expiresIn','verifyToken','username','3206405MevIcm','secret','generateToken','sign','config','shop','Invalid\x20credentials','AuthService','__esModule','password','name','__importDefault'];a36_0xbd05=function(){return _0x112373;};return a36_0xbd05();}const a36_0x310948=a36_0x4184;function a36_0x4184(_0x3795fd,_0x42bbd1){const _0xbd0599=a36_0xbd05();return a36_0x4184=function(_0x4184be,_0x56e1aa){_0x4184be=_0x4184be-0xee;let _0x370e62=_0xbd0599[_0x4184be];return _0x370e62;},a36_0x4184(_0x3795fd,_0x42bbd1);}(function(_0x401254,_0x2ec910){const _0x10a1cd=a36_0x4184,_0x1254d8=_0x401254();while(!![]){try{const _0x453dc8=parseInt(_0x10a1cd(0x101))/0x1*(parseInt(_0x10a1cd(0xf9))/0x2)+-parseInt(_0x10a1cd(0xfb))/0x3+-parseInt(_0x10a1cd(0xf6))/0x4+-parseInt(_0x10a1cd(0x107))/0x5+parseInt(_0x10a1cd(0xf0))/0x6+-parseInt(_0x10a1cd(0xf7))/0x7*(parseInt(_0x10a1cd(0xf1))/0x8)+parseInt(_0x10a1cd(0xef))/0x9*(parseInt(_0x10a1cd(0x103))/0xa);if(_0x453dc8===_0x2ec910)break;else _0x1254d8['push'](_0x1254d8['shift']());}catch(_0x1464f5){_0x1254d8['push'](_0x1254d8['shift']());}}}(a36_0xbd05,0xeeace));var __importDefault=this&&this[a36_0x310948(0x112)]||function(_0x4dbbbb){const _0x5302f0=a36_0x310948;return _0x4dbbbb&&_0x4dbbbb[_0x5302f0(0x10f)]?_0x4dbbbb:{'default':_0x4dbbbb};};Object[a36_0x310948(0xf4)](exports,a36_0x310948(0x10f),{'value':!![]}),exports[a36_0x310948(0x10e)]=void 0x0;const bcryptjs_1=__importDefault(require(a36_0x310948(0xfe))),jsonwebtoken_1=__importDefault(require('jsonwebtoken')),database_1=__importDefault(require(a36_0x310948(0x102))),config_1=require('../config/config');class AuthService{[a36_0x310948(0x109)](_0xf8da33){const _0x3de4fe=a36_0x310948;return jsonwebtoken_1['default'][_0x3de4fe(0x10a)](_0xf8da33,config_1['config'][_0x3de4fe(0xf3)][_0x3de4fe(0x108)],{'expiresIn':String(config_1[_0x3de4fe(0x10b)][_0x3de4fe(0xf3)][_0x3de4fe(0x104)])});}async[a36_0x310948(0xfc)](_0x46f430){const _0x4387e5=a36_0x310948,{username:_0x343c7e,password:_0x45275e}=_0x46f430;if(_0x343c7e===config_1[_0x4387e5(0x10b)][_0x4387e5(0xee)]['username']){const _0x428ee8=await bcryptjs_1[_0x4387e5(0xfd)][_0x4387e5(0xf2)](_0x45275e,config_1[_0x4387e5(0x10b)][_0x4387e5(0xee)][_0x4387e5(0xf8)]);if(_0x428ee8){const _0x4bfb77=this[_0x4387e5(0x109)]({'id':_0x4387e5(0xee),'username':config_1[_0x4387e5(0x10b)]['admin'][_0x4387e5(0x106)],'role':_0x4387e5(0xee)});return{'access_token':_0x4bfb77,'role':_0x4387e5(0xee)};}}const _0x1cb3a7=await database_1[_0x4387e5(0xfd)][_0x4387e5(0x10c)][_0x4387e5(0xf5)]({'where':{'username':_0x343c7e},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x1cb3a7)throw new Error('Invalid\x20credentials');if(_0x1cb3a7[_0x4387e5(0x100)]!==_0x4387e5(0x113))throw new Error(_0x4387e5(0xfa));const _0xac8b58=await bcryptjs_1[_0x4387e5(0xfd)][_0x4387e5(0xf2)](_0x45275e,_0x1cb3a7[_0x4387e5(0x110)]);if(!_0xac8b58)throw new Error(_0x4387e5(0x10d));const _0x2d8c7f=this[_0x4387e5(0x109)]({'id':_0x1cb3a7['id'],'username':_0x1cb3a7[_0x4387e5(0x106)],'role':_0x4387e5(0x10c)});return{'access_token':_0x2d8c7f,'role':'shop','user':{'id':_0x1cb3a7['id'],'name':_0x1cb3a7[_0x4387e5(0x111)],'username':_0x1cb3a7[_0x4387e5(0x106)]}};}async[a36_0x310948(0x105)](_0x4a1566){const _0x47a8d1=a36_0x310948;try{const _0x98b27=jsonwebtoken_1['default']['verify'](_0x4a1566,config_1[_0x47a8d1(0x10b)][_0x47a8d1(0xf3)]['secret']);return _0x98b27;}catch(_0x16ac1a){throw new Error(_0x47a8d1(0xff));}}}exports['AuthService']=AuthService;