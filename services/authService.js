'use strict';const a36_0x577988=a36_0x6a35;function a36_0x187a(){const _0x5d8d8f=['secret','passwordHash','Invalid\x20credentials','compare','jsonwebtoken','verify','113931huPvmO','5304UIncaD','findUnique','../config/config','1623924HdGSVg','jwt','config','admin','default','1113515zUVkBL','ACTIVE','1026485hKpOHl','__importDefault','20556063tAPtck','2UctmQr','6545mCOkBL','status','Account\x20is\x20not\x20active','shop','__esModule','9zwiwEF','generateToken','password','148ccUncy','expiresIn','AuthService','3680770eltZRF','username','name','Invalid\x20token'];a36_0x187a=function(){return _0x5d8d8f;};return a36_0x187a();}(function(_0xfa469,_0x4db1dd){const _0x243af1=a36_0x6a35,_0x545064=_0xfa469();while(!![]){try{const _0x39b04b=-parseInt(_0x243af1(0x1ae))/0x1*(-parseInt(_0x243af1(0x1b1))/0x2)+-parseInt(_0x243af1(0x1c7))/0x3*(parseInt(_0x243af1(0x1ba))/0x4)+-parseInt(_0x243af1(0x1d0))/0x5+-parseInt(_0x243af1(0x1cb))/0x6+-parseInt(_0x243af1(0x1b2))/0x7*(parseInt(_0x243af1(0x1c8))/0x8)+parseInt(_0x243af1(0x1b7))/0x9*(parseInt(_0x243af1(0x1bd))/0xa)+parseInt(_0x243af1(0x1b0))/0xb;if(_0x39b04b===_0x4db1dd)break;else _0x545064['push'](_0x545064['shift']());}catch(_0x3229b3){_0x545064['push'](_0x545064['shift']());}}}(a36_0x187a,0xb5db4));var __importDefault=this&&this[a36_0x577988(0x1af)]||function(_0x4e3ed0){const _0x592f10=a36_0x577988;return _0x4e3ed0&&_0x4e3ed0[_0x592f10(0x1b6)]?_0x4e3ed0:{'default':_0x4e3ed0};};Object['defineProperty'](exports,a36_0x577988(0x1b6),{'value':!![]}),exports[a36_0x577988(0x1bc)]=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),jsonwebtoken_1=__importDefault(require(a36_0x577988(0x1c5))),database_1=__importDefault(require('../config/database')),config_1=require(a36_0x577988(0x1ca));function a36_0x6a35(_0x1edb8c,_0x20d3e2){const _0x187ae5=a36_0x187a();return a36_0x6a35=function(_0x6a356f,_0x4c638f){_0x6a356f=_0x6a356f-0x1ae;let _0x5e9962=_0x187ae5[_0x6a356f];return _0x5e9962;},a36_0x6a35(_0x1edb8c,_0x20d3e2);}class AuthService{['generateToken'](_0x4224ce){const _0x57561b=a36_0x577988;return jsonwebtoken_1[_0x57561b(0x1cf)]['sign'](_0x4224ce,config_1['config']['jwt'][_0x57561b(0x1c1)],{'expiresIn':String(config_1[_0x57561b(0x1cd)][_0x57561b(0x1cc)][_0x57561b(0x1bb)])});}async['login'](_0x249f0a){const _0x35e196=a36_0x577988,{username:_0x3ecb7f,password:_0x568d77}=_0x249f0a;if(_0x3ecb7f===config_1[_0x35e196(0x1cd)][_0x35e196(0x1ce)][_0x35e196(0x1be)]){const _0x12e669=await bcryptjs_1[_0x35e196(0x1cf)][_0x35e196(0x1c4)](_0x568d77,config_1[_0x35e196(0x1cd)][_0x35e196(0x1ce)][_0x35e196(0x1c2)]);if(_0x12e669){const _0x16ef5c=this[_0x35e196(0x1b8)]({'id':_0x35e196(0x1ce),'username':config_1[_0x35e196(0x1cd)]['admin']['username'],'role':_0x35e196(0x1ce)});return{'access_token':_0x16ef5c,'role':'admin'};}}const _0x17eb92=await database_1['default'][_0x35e196(0x1b5)][_0x35e196(0x1c9)]({'where':{'username':_0x3ecb7f},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x17eb92)throw new Error(_0x35e196(0x1c3));if(_0x17eb92[_0x35e196(0x1b3)]!==_0x35e196(0x1d1))throw new Error(_0x35e196(0x1b4));const _0x5e7969=await bcryptjs_1[_0x35e196(0x1cf)]['compare'](_0x568d77,_0x17eb92[_0x35e196(0x1b9)]);if(!_0x5e7969)throw new Error(_0x35e196(0x1c3));const _0x286099=this[_0x35e196(0x1b8)]({'id':_0x17eb92['id'],'username':_0x17eb92['username'],'role':'shop'});return{'access_token':_0x286099,'role':_0x35e196(0x1b5),'user':{'id':_0x17eb92['id'],'name':_0x17eb92[_0x35e196(0x1bf)],'username':_0x17eb92[_0x35e196(0x1be)]}};}async['verifyToken'](_0x6ab3c){const _0xf75aee=a36_0x577988;try{const _0x32f123=jsonwebtoken_1[_0xf75aee(0x1cf)][_0xf75aee(0x1c6)](_0x6ab3c,config_1['config'][_0xf75aee(0x1cc)][_0xf75aee(0x1c1)]);return _0x32f123;}catch(_0x1cf728){throw new Error(_0xf75aee(0x1c0));}}}exports[a36_0x577988(0x1bc)]=AuthService;