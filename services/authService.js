'use strict';const a39_0xe0caa4=a39_0x50ee;function a39_0x50ee(_0x380066,_0x1061ad){const _0x5b655c=a39_0x5b65();return a39_0x50ee=function(_0x50eea7,_0x59c76d){_0x50eea7=_0x50eea7-0x16a;let _0x3f30b2=_0x5b655c[_0x50eea7];return _0x3f30b2;},a39_0x50ee(_0x380066,_0x1061ad);}(function(_0x2d6200,_0x368abc){const _0x572485=a39_0x50ee,_0x2e0952=_0x2d6200();while(!![]){try{const _0x2e1cdb=parseInt(_0x572485(0x192))/0x1*(-parseInt(_0x572485(0x17f))/0x2)+-parseInt(_0x572485(0x17a))/0x3+-parseInt(_0x572485(0x171))/0x4*(parseInt(_0x572485(0x191))/0x5)+parseInt(_0x572485(0x173))/0x6*(-parseInt(_0x572485(0x17c))/0x7)+-parseInt(_0x572485(0x18c))/0x8+-parseInt(_0x572485(0x16f))/0x9+parseInt(_0x572485(0x16c))/0xa*(parseInt(_0x572485(0x172))/0xb);if(_0x2e1cdb===_0x368abc)break;else _0x2e0952['push'](_0x2e0952['shift']());}catch(_0x3db70a){_0x2e0952['push'](_0x2e0952['shift']());}}}(a39_0x5b65,0xdf998));var __importDefault=this&&this[a39_0xe0caa4(0x17e)]||function(_0x382101){const _0x2e656f=a39_0xe0caa4;return _0x382101&&_0x382101[_0x2e656f(0x16d)]?_0x382101:{'default':_0x382101};};function a39_0x5b65(){const _0x589fbb=['../config/database','AuthService','701076ShZijD','passwordHash','1085tlfuyR','secret','__importDefault','146ehaVVg','verify','defineProperty','findUnique','compare','login','ACTIVE','config','../config/config','username','jsonwebtoken','Invalid\x20credentials','expiresIn','5457256DxEfui','jwt','sign','status','bcryptjs','940mcuxre','6053ZWVvfl','default','Account\x20is\x20not\x20active','519130KjfnOc','__esModule','Invalid\x20token','816561jIAHYu','shop','23812dihJwU','990UsPnLy','46014ICIajy','password','generateToken','admin','name'];a39_0x5b65=function(){return _0x589fbb;};return a39_0x5b65();}Object[a39_0xe0caa4(0x181)](exports,a39_0xe0caa4(0x16d),{'value':!![]}),exports[a39_0xe0caa4(0x179)]=void 0x0;const bcryptjs_1=__importDefault(require(a39_0xe0caa4(0x190))),jsonwebtoken_1=__importDefault(require(a39_0xe0caa4(0x189))),database_1=__importDefault(require(a39_0xe0caa4(0x178))),config_1=require(a39_0xe0caa4(0x187));class AuthService{[a39_0xe0caa4(0x175)](_0x14a2b5){const _0x1cd306=a39_0xe0caa4;return jsonwebtoken_1[_0x1cd306(0x16a)][_0x1cd306(0x18e)](_0x14a2b5,config_1['config'][_0x1cd306(0x18d)]['secret'],{'expiresIn':String(config_1[_0x1cd306(0x186)][_0x1cd306(0x18d)][_0x1cd306(0x18b)])});}async[a39_0xe0caa4(0x184)](_0x205dfe){const _0x5c5acd=a39_0xe0caa4,{username:_0x8b49a6,password:_0x35e2f1}=_0x205dfe;if(_0x8b49a6===config_1['config'][_0x5c5acd(0x176)][_0x5c5acd(0x188)]){const _0x324f50=await bcryptjs_1['default'][_0x5c5acd(0x183)](_0x35e2f1,config_1['config'][_0x5c5acd(0x176)][_0x5c5acd(0x17b)]);if(_0x324f50){const _0x3d12fd=this[_0x5c5acd(0x175)]({'id':'admin','username':config_1['config'][_0x5c5acd(0x176)][_0x5c5acd(0x188)],'role':'admin'});return{'access_token':_0x3d12fd,'role':_0x5c5acd(0x176)};}}const _0x429f87=await database_1[_0x5c5acd(0x16a)][_0x5c5acd(0x170)][_0x5c5acd(0x182)]({'where':{'username':_0x8b49a6},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x429f87)throw new Error(_0x5c5acd(0x18a));if(_0x429f87[_0x5c5acd(0x18f)]!==_0x5c5acd(0x185))throw new Error(_0x5c5acd(0x16b));const _0x46db79=await bcryptjs_1[_0x5c5acd(0x16a)][_0x5c5acd(0x183)](_0x35e2f1,_0x429f87[_0x5c5acd(0x174)]);if(!_0x46db79)throw new Error(_0x5c5acd(0x18a));const _0x17b5bd=this[_0x5c5acd(0x175)]({'id':_0x429f87['id'],'username':_0x429f87[_0x5c5acd(0x188)],'role':_0x5c5acd(0x170)});return{'access_token':_0x17b5bd,'role':_0x5c5acd(0x170),'user':{'id':_0x429f87['id'],'name':_0x429f87[_0x5c5acd(0x177)],'username':_0x429f87[_0x5c5acd(0x188)]}};}async['verifyToken'](_0x415626){const _0x102269=a39_0xe0caa4;try{const _0x7344d0=jsonwebtoken_1[_0x102269(0x16a)][_0x102269(0x180)](_0x415626,config_1[_0x102269(0x186)][_0x102269(0x18d)][_0x102269(0x17d)]);return _0x7344d0;}catch(_0x14a612){throw new Error(_0x102269(0x16e));}}}exports[a39_0xe0caa4(0x179)]=AuthService;