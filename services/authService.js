'use strict';function a36_0x5027(){const _0x6674a4=['11nWIsIu','9716IPxShD','generateToken','AuthService','admin','1439844PlghSD','__esModule','8wSJxjF','ACTIVE','10855DsBSAd','password','6PJamsk','Invalid\x20token','username','8184936hBjizp','4273385SvCppF','21SqGJWM','default','bcryptjs','verify','../config/database','secret','compare','shop','sign','jsonwebtoken','Invalid\x20credentials','1985362yHRZiv','verifyToken','3624975kAHIBr','findUnique','1SwpFiw','config','login','1787384XEfzZU','Account\x20is\x20not\x20active','status','10exlRJJ','name'];a36_0x5027=function(){return _0x6674a4;};return a36_0x5027();}const a36_0x1d1619=a36_0x5cf8;(function(_0x3dbdf7,_0x4f7698){const _0x5c5f39=a36_0x5cf8,_0x5dddad=_0x3dbdf7();while(!![]){try{const _0xccf975=parseInt(_0x5c5f39(0x108))/0x1*(parseInt(_0x5c5f39(0x104))/0x2)+-parseInt(_0x5c5f39(0x115))/0x3*(parseInt(_0x5c5f39(0x117))/0x4)+-parseInt(_0x5c5f39(0x11f))/0x5*(parseInt(_0x5c5f39(0x11b))/0x6)+-parseInt(_0x5c5f39(0x120))/0x7*(-parseInt(_0x5c5f39(0x10b))/0x8)+parseInt(_0x5c5f39(0x106))/0x9*(-parseInt(_0x5c5f39(0x10e))/0xa)+-parseInt(_0x5c5f39(0x110))/0xb*(-parseInt(_0x5c5f39(0x11e))/0xc)+-parseInt(_0x5c5f39(0x119))/0xd*(-parseInt(_0x5c5f39(0x111))/0xe);if(_0xccf975===_0x4f7698)break;else _0x5dddad['push'](_0x5dddad['shift']());}catch(_0x509fe9){_0x5dddad['push'](_0x5dddad['shift']());}}}(a36_0x5027,0xaca62));var __importDefault=this&&this['__importDefault']||function(_0x1e39e4){const _0x4f64e2=a36_0x5cf8;return _0x1e39e4&&_0x1e39e4[_0x4f64e2(0x116)]?_0x1e39e4:{'default':_0x1e39e4};};Object['defineProperty'](exports,a36_0x1d1619(0x116),{'value':!![]}),exports[a36_0x1d1619(0x113)]=void 0x0;const bcryptjs_1=__importDefault(require(a36_0x1d1619(0x122))),jsonwebtoken_1=__importDefault(require(a36_0x1d1619(0x102))),database_1=__importDefault(require(a36_0x1d1619(0xfd))),config_1=require('../config/config');function a36_0x5cf8(_0x3771d4,_0x54ede0){const _0x5027e3=a36_0x5027();return a36_0x5cf8=function(_0x5cf860,_0x27d6bc){_0x5cf860=_0x5cf860-0xfd;let _0x2579c0=_0x5027e3[_0x5cf860];return _0x2579c0;},a36_0x5cf8(_0x3771d4,_0x54ede0);}class AuthService{[a36_0x1d1619(0x112)](_0x5f1b75){const _0x325acf=a36_0x1d1619;return jsonwebtoken_1[_0x325acf(0x121)][_0x325acf(0x101)](_0x5f1b75,config_1['config']['jwt'][_0x325acf(0xfe)],{'expiresIn':String(config_1[_0x325acf(0x109)]['jwt']['expiresIn'])});}async[a36_0x1d1619(0x10a)](_0x44b444){const _0x3008b7=a36_0x1d1619,{username:_0x52eb4b,password:_0x45f43a}=_0x44b444;if(_0x52eb4b===config_1['config']['admin'][_0x3008b7(0x11d)]){const _0x3aa873=await bcryptjs_1['default'][_0x3008b7(0xff)](_0x45f43a,config_1[_0x3008b7(0x109)][_0x3008b7(0x114)]['passwordHash']);if(_0x3aa873){const _0x393e98=this['generateToken']({'id':_0x3008b7(0x114),'username':config_1['config'][_0x3008b7(0x114)][_0x3008b7(0x11d)],'role':_0x3008b7(0x114)});return{'access_token':_0x393e98,'role':_0x3008b7(0x114)};}}const _0x516f6b=await database_1[_0x3008b7(0x121)][_0x3008b7(0x100)][_0x3008b7(0x107)]({'where':{'username':_0x52eb4b},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x516f6b)throw new Error(_0x3008b7(0x103));if(_0x516f6b[_0x3008b7(0x10d)]!==_0x3008b7(0x118))throw new Error(_0x3008b7(0x10c));const _0x1c07af=await bcryptjs_1[_0x3008b7(0x121)]['compare'](_0x45f43a,_0x516f6b[_0x3008b7(0x11a)]);if(!_0x1c07af)throw new Error(_0x3008b7(0x103));const _0x17f21c=this[_0x3008b7(0x112)]({'id':_0x516f6b['id'],'username':_0x516f6b[_0x3008b7(0x11d)],'role':_0x3008b7(0x100)});return{'access_token':_0x17f21c,'role':_0x3008b7(0x100),'user':{'id':_0x516f6b['id'],'name':_0x516f6b[_0x3008b7(0x10f)],'username':_0x516f6b[_0x3008b7(0x11d)]}};}async[a36_0x1d1619(0x105)](_0x19194a){const _0x569985=a36_0x1d1619;try{const _0x31f2d9=jsonwebtoken_1[_0x569985(0x121)][_0x569985(0x123)](_0x19194a,config_1[_0x569985(0x109)]['jwt']['secret']);return _0x31f2d9;}catch(_0x3c25d2){throw new Error(_0x569985(0x11c));}}}exports[a36_0x1d1619(0x113)]=AuthService;