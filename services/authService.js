'use strict';const a36_0x142660=a36_0x1838;function a36_0x4ad6(){const _0x284430=['4211544NcXkPW','compare','status','jwt','Account\x20is\x20not\x20active','secret','jsonwebtoken','password','Invalid\x20token','3128406gtlaSe','8035263gthnxj','Invalid\x20credentials','__esModule','default','761033AeNDrj','username','1054499MWVwgp','login','generateToken','verifyToken','991280vHYExv','__importDefault','8eNjvAc','bcryptjs','785kIkQOv','../config/database','admin','25156wupnsp','config','sign','AuthService','shop','ACTIVE'];a36_0x4ad6=function(){return _0x284430;};return a36_0x4ad6();}(function(_0x1ca113,_0x305a91){const _0x22ed9e=a36_0x1838,_0x5700f9=_0x1ca113();while(!![]){try{const _0x3af020=parseInt(_0x22ed9e(0xb5))/0x1+-parseInt(_0x22ed9e(0xb9))/0x2+-parseInt(_0x22ed9e(0xae))/0x3+-parseInt(_0x22ed9e(0xc0))/0x4*(-parseInt(_0x22ed9e(0xbd))/0x5)+-parseInt(_0x22ed9e(0xc6))/0x6+parseInt(_0x22ed9e(0xb3))/0x7+-parseInt(_0x22ed9e(0xbb))/0x8*(-parseInt(_0x22ed9e(0xaf))/0x9);if(_0x3af020===_0x305a91)break;else _0x5700f9['push'](_0x5700f9['shift']());}catch(_0x3b67c2){_0x5700f9['push'](_0x5700f9['shift']());}}}(a36_0x4ad6,0xc40d8));var __importDefault=this&&this[a36_0x142660(0xba)]||function(_0x2eecb2){const _0x2c1acd=a36_0x142660;return _0x2eecb2&&_0x2eecb2[_0x2c1acd(0xb1)]?_0x2eecb2:{'default':_0x2eecb2};};function a36_0x1838(_0x700936,_0x282f48){const _0x4ad642=a36_0x4ad6();return a36_0x1838=function(_0x18389a,_0x34a3a1){_0x18389a=_0x18389a-0xa6;let _0x557b2f=_0x4ad642[_0x18389a];return _0x557b2f;},a36_0x1838(_0x700936,_0x282f48);}Object['defineProperty'](exports,a36_0x142660(0xb1),{'value':!![]}),exports[a36_0x142660(0xc3)]=void 0x0;const bcryptjs_1=__importDefault(require(a36_0x142660(0xbc))),jsonwebtoken_1=__importDefault(require(a36_0x142660(0xab))),database_1=__importDefault(require(a36_0x142660(0xbe))),config_1=require('../config/config');class AuthService{['generateToken'](_0x21f118){const _0x6d84b5=a36_0x142660;return jsonwebtoken_1['default'][_0x6d84b5(0xc2)](_0x21f118,config_1[_0x6d84b5(0xc1)][_0x6d84b5(0xa8)][_0x6d84b5(0xaa)],{'expiresIn':String(config_1['config'][_0x6d84b5(0xa8)]['expiresIn'])});}async[a36_0x142660(0xb6)](_0x2bfa89){const _0x2dcf5d=a36_0x142660,{username:_0x1a7733,password:_0x346f54}=_0x2bfa89;if(_0x1a7733===config_1[_0x2dcf5d(0xc1)][_0x2dcf5d(0xbf)][_0x2dcf5d(0xb4)]){const _0xa7b74=await bcryptjs_1[_0x2dcf5d(0xb2)]['compare'](_0x346f54,config_1['config'][_0x2dcf5d(0xbf)]['passwordHash']);if(_0xa7b74){const _0x361335=this[_0x2dcf5d(0xb7)]({'id':_0x2dcf5d(0xbf),'username':config_1['config'][_0x2dcf5d(0xbf)][_0x2dcf5d(0xb4)],'role':_0x2dcf5d(0xbf)});return{'access_token':_0x361335,'role':_0x2dcf5d(0xbf)};}}const _0x5beaa8=await database_1['default'][_0x2dcf5d(0xc4)]['findUnique']({'where':{'username':_0x1a7733},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x5beaa8)throw new Error('Invalid\x20credentials');if(_0x5beaa8[_0x2dcf5d(0xa7)]!==_0x2dcf5d(0xc5))throw new Error(_0x2dcf5d(0xa9));const _0x3f52cf=await bcryptjs_1['default'][_0x2dcf5d(0xa6)](_0x346f54,_0x5beaa8[_0x2dcf5d(0xac)]);if(!_0x3f52cf)throw new Error(_0x2dcf5d(0xb0));const _0x56c11c=this['generateToken']({'id':_0x5beaa8['id'],'username':_0x5beaa8[_0x2dcf5d(0xb4)],'role':_0x2dcf5d(0xc4)});return{'access_token':_0x56c11c,'role':'shop','user':{'id':_0x5beaa8['id'],'name':_0x5beaa8['name'],'username':_0x5beaa8[_0x2dcf5d(0xb4)]}};}async[a36_0x142660(0xb8)](_0x3d8a0c){const _0x5b4719=a36_0x142660;try{const _0x3a6f7b=jsonwebtoken_1[_0x5b4719(0xb2)]['verify'](_0x3d8a0c,config_1[_0x5b4719(0xc1)][_0x5b4719(0xa8)][_0x5b4719(0xaa)]);return _0x3a6f7b;}catch(_0x4a94df){throw new Error(_0x5b4719(0xad));}}}exports[a36_0x142660(0xc3)]=AuthService;