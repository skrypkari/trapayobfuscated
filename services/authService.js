'use strict';const a36_0x5ea8fc=a36_0xa0f8;function a36_0xa0f8(_0xaececa,_0x51a963){const _0x231d9c=a36_0x231d();return a36_0xa0f8=function(_0xa0f8e9,_0x9e8932){_0xa0f8e9=_0xa0f8e9-0xcb;let _0x1db20a=_0x231d9c[_0xa0f8e9];return _0x1db20a;},a36_0xa0f8(_0xaececa,_0x51a963);}(function(_0x5c87a1,_0x4df556){const _0xb931ea=a36_0xa0f8,_0x3400fd=_0x5c87a1();while(!![]){try{const _0x56b613=parseInt(_0xb931ea(0xdc))/0x1+parseInt(_0xb931ea(0xd0))/0x2*(parseInt(_0xb931ea(0xd8))/0x3)+parseInt(_0xb931ea(0xd5))/0x4+-parseInt(_0xb931ea(0xd9))/0x5+-parseInt(_0xb931ea(0xcd))/0x6+parseInt(_0xb931ea(0xe4))/0x7+-parseInt(_0xb931ea(0xd6))/0x8;if(_0x56b613===_0x4df556)break;else _0x3400fd['push'](_0x3400fd['shift']());}catch(_0x33318d){_0x3400fd['push'](_0x3400fd['shift']());}}}(a36_0x231d,0x25612));var __importDefault=this&&this['__importDefault']||function(_0x5d6415){return _0x5d6415&&_0x5d6415['__esModule']?_0x5d6415:{'default':_0x5d6415};};Object['defineProperty'](exports,a36_0x5ea8fc(0xe2),{'value':!![]}),exports[a36_0x5ea8fc(0xec)]=void 0x0;const bcryptjs_1=__importDefault(require(a36_0x5ea8fc(0xcf))),jsonwebtoken_1=__importDefault(require('jsonwebtoken')),database_1=__importDefault(require(a36_0x5ea8fc(0xea))),config_1=require(a36_0x5ea8fc(0xd1));class AuthService{['generateToken'](_0x517831){const _0x4d8af5=a36_0x5ea8fc;return jsonwebtoken_1[_0x4d8af5(0xce)][_0x4d8af5(0xde)](_0x517831,config_1[_0x4d8af5(0xe6)]['jwt']['secret'],{'expiresIn':String(config_1[_0x4d8af5(0xe6)][_0x4d8af5(0xe0)][_0x4d8af5(0xe7)])});}async[a36_0x5ea8fc(0xd7)](_0x1817d0){const _0x376963=a36_0x5ea8fc,{username:_0x47eb7d,password:_0x27396f}=_0x1817d0;if(_0x47eb7d===config_1[_0x376963(0xe6)]['admin'][_0x376963(0xcc)]){const _0xc95390=await bcryptjs_1[_0x376963(0xce)][_0x376963(0xeb)](_0x27396f,config_1[_0x376963(0xe6)][_0x376963(0xcb)][_0x376963(0xe3)]);if(_0xc95390){const _0x45b042=this['generateToken']({'id':_0x376963(0xcb),'username':config_1[_0x376963(0xe6)][_0x376963(0xcb)]['username'],'role':_0x376963(0xcb)});return{'access_token':_0x45b042,'role':_0x376963(0xcb)};}}const _0x4214aa=await database_1[_0x376963(0xce)][_0x376963(0xe8)]['findUnique']({'where':{'username':_0x47eb7d},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x4214aa)throw new Error(_0x376963(0xe9));if(_0x4214aa[_0x376963(0xda)]!==_0x376963(0xd3))throw new Error('Account\x20is\x20not\x20active');const _0x57c52e=await bcryptjs_1[_0x376963(0xce)][_0x376963(0xeb)](_0x27396f,_0x4214aa[_0x376963(0xd2)]);if(!_0x57c52e)throw new Error(_0x376963(0xe9));const _0x2f3d0a=this[_0x376963(0xdf)]({'id':_0x4214aa['id'],'username':_0x4214aa['username'],'role':_0x376963(0xe8)});return{'access_token':_0x2f3d0a,'role':_0x376963(0xe8),'user':{'id':_0x4214aa['id'],'name':_0x4214aa[_0x376963(0xe1)],'username':_0x4214aa[_0x376963(0xcc)]}};}async[a36_0x5ea8fc(0xdd)](_0x31d384){const _0x49edef=a36_0x5ea8fc;try{const _0x1c86c2=jsonwebtoken_1[_0x49edef(0xce)][_0x49edef(0xd4)](_0x31d384,config_1[_0x49edef(0xe6)][_0x49edef(0xe0)][_0x49edef(0xdb)]);return _0x1c86c2;}catch(_0x1487f1){throw new Error(_0x49edef(0xe5));}}}function a36_0x231d(){const _0x5c731b=['../config/config','password','ACTIVE','verify','911060cVWOdr','565056RUbtTK','login','3093XlZCle','1454255LPvFYU','status','secret','210509QsSgZZ','verifyToken','sign','generateToken','jwt','name','__esModule','passwordHash','168364xTlUma','Invalid\x20token','config','expiresIn','shop','Invalid\x20credentials','../config/database','compare','AuthService','admin','username','1424688NtbyHU','default','bcryptjs','562PDNTad'];a36_0x231d=function(){return _0x5c731b;};return a36_0x231d();}exports['AuthService']=AuthService;