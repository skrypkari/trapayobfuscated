'use strict';function a36_0x1341(_0x134ff5,_0x4dbffc){const _0x41db39=a36_0x41db();return a36_0x1341=function(_0x1341fb,_0x108861){_0x1341fb=_0x1341fb-0x18e;let _0x297602=_0x41db39[_0x1341fb];return _0x297602;},a36_0x1341(_0x134ff5,_0x4dbffc);}const a36_0x1d8527=a36_0x1341;(function(_0x5b4e92,_0x36efba){const _0x1daccb=a36_0x1341,_0x25c86e=_0x5b4e92();while(!![]){try{const _0x57490e=-parseInt(_0x1daccb(0x195))/0x1*(-parseInt(_0x1daccb(0x197))/0x2)+-parseInt(_0x1daccb(0x19f))/0x3*(parseInt(_0x1daccb(0x194))/0x4)+parseInt(_0x1daccb(0x1aa))/0x5*(-parseInt(_0x1daccb(0x1af))/0x6)+parseInt(_0x1daccb(0x190))/0x7+parseInt(_0x1daccb(0x18e))/0x8+parseInt(_0x1daccb(0x1b3))/0x9+-parseInt(_0x1daccb(0x1ac))/0xa*(-parseInt(_0x1daccb(0x1a4))/0xb);if(_0x57490e===_0x36efba)break;else _0x25c86e['push'](_0x25c86e['shift']());}catch(_0x5a0790){_0x25c86e['push'](_0x25c86e['shift']());}}}(a36_0x41db,0x80281));var __importDefault=this&&this[a36_0x1d8527(0x1a1)]||function(_0x2a9f8f){return _0x2a9f8f&&_0x2a9f8f['__esModule']?_0x2a9f8f:{'default':_0x2a9f8f};};Object[a36_0x1d8527(0x1a9)](exports,a36_0x1d8527(0x1a0),{'value':!![]}),exports[a36_0x1d8527(0x19d)]=void 0x0;function a36_0x41db(){const _0x16f797=['passwordHash','shop','4cKzpoZ','4phAbhQ','findUnique','130534rPmWUz','name','sign','default','../config/database','status','AuthService','username','2402733BgWkgB','__esModule','__importDefault','bcryptjs','admin','11iuVaVV','../config/config','Account\x20is\x20not\x20active','jsonwebtoken','secret','defineProperty','10zEEIEo','login','10231760qwyCcX','password','jwt','2015754VKenad','config','compare','generateToken','185184opzwto','75016auKESz','ACTIVE','4784927TErwxE','verifyToken'];a36_0x41db=function(){return _0x16f797;};return a36_0x41db();}const bcryptjs_1=__importDefault(require(a36_0x1d8527(0x1a2))),jsonwebtoken_1=__importDefault(require(a36_0x1d8527(0x1a7))),database_1=__importDefault(require(a36_0x1d8527(0x19b))),config_1=require(a36_0x1d8527(0x1a5));class AuthService{['generateToken'](_0x7cbea2){const _0x5102d1=a36_0x1d8527;return jsonwebtoken_1[_0x5102d1(0x19a)][_0x5102d1(0x199)](_0x7cbea2,config_1[_0x5102d1(0x1b0)]['jwt'][_0x5102d1(0x1a8)],{'expiresIn':String(config_1[_0x5102d1(0x1b0)][_0x5102d1(0x1ae)]['expiresIn'])});}async[a36_0x1d8527(0x1ab)](_0xce935d){const _0x321158=a36_0x1d8527,{username:_0x3f6776,password:_0x121d9b}=_0xce935d;if(_0x3f6776===config_1[_0x321158(0x1b0)]['admin'][_0x321158(0x19e)]){const _0x1b1267=await bcryptjs_1[_0x321158(0x19a)]['compare'](_0x121d9b,config_1[_0x321158(0x1b0)][_0x321158(0x1a3)][_0x321158(0x192)]);if(_0x1b1267){const _0x2873ba=this['generateToken']({'id':'admin','username':config_1[_0x321158(0x1b0)][_0x321158(0x1a3)]['username'],'role':_0x321158(0x1a3)});return{'access_token':_0x2873ba,'role':_0x321158(0x1a3)};}}const _0x2dbf51=await database_1[_0x321158(0x19a)]['shop'][_0x321158(0x196)]({'where':{'username':_0x3f6776},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x2dbf51)throw new Error('Invalid\x20credentials');if(_0x2dbf51[_0x321158(0x19c)]!==_0x321158(0x18f))throw new Error(_0x321158(0x1a6));const _0x3f7207=await bcryptjs_1[_0x321158(0x19a)][_0x321158(0x1b1)](_0x121d9b,_0x2dbf51[_0x321158(0x1ad)]);if(!_0x3f7207)throw new Error('Invalid\x20credentials');const _0x4a7bd1=this[_0x321158(0x1b2)]({'id':_0x2dbf51['id'],'username':_0x2dbf51[_0x321158(0x19e)],'role':'shop'});return{'access_token':_0x4a7bd1,'role':_0x321158(0x193),'user':{'id':_0x2dbf51['id'],'name':_0x2dbf51[_0x321158(0x198)],'username':_0x2dbf51[_0x321158(0x19e)]}};}async[a36_0x1d8527(0x191)](_0x5f48dc){const _0x1396ea=a36_0x1d8527;try{const _0x5e130c=jsonwebtoken_1[_0x1396ea(0x19a)]['verify'](_0x5f48dc,config_1[_0x1396ea(0x1b0)]['jwt'][_0x1396ea(0x1a8)]);return _0x5e130c;}catch(_0x12b114){throw new Error('Invalid\x20token');}}}exports['AuthService']=AuthService;