'use strict';const a34_0x44b4bc=a34_0xf022;(function(_0xb64ba,_0xad685){const _0x1895b1=a34_0xf022,_0xad6d5d=_0xb64ba();while(!![]){try{const _0x204600=-parseInt(_0x1895b1(0xda))/0x1+parseInt(_0x1895b1(0xd9))/0x2*(parseInt(_0x1895b1(0xd4))/0x3)+-parseInt(_0x1895b1(0xec))/0x4+-parseInt(_0x1895b1(0xe7))/0x5*(-parseInt(_0x1895b1(0xe1))/0x6)+-parseInt(_0x1895b1(0xe6))/0x7+parseInt(_0x1895b1(0xd2))/0x8+parseInt(_0x1895b1(0xf6))/0x9*(-parseInt(_0x1895b1(0xe5))/0xa);if(_0x204600===_0xad685)break;else _0xad6d5d['push'](_0xad6d5d['shift']());}catch(_0x49d1b6){_0xad6d5d['push'](_0xad6d5d['shift']());}}}(a34_0x28d2,0xd1634));function a34_0xf022(_0x2b138e,_0x2f520f){const _0x28d2bc=a34_0x28d2();return a34_0xf022=function(_0xf02255,_0xe9ef0a){_0xf02255=_0xf02255-0xcf;let _0x46ee38=_0x28d2bc[_0xf02255];return _0x46ee38;},a34_0xf022(_0x2b138e,_0x2f520f);}var __importDefault=this&&this[a34_0x44b4bc(0xcf)]||function(_0xdd07f6){const _0x3ff0a7=a34_0x44b4bc;return _0xdd07f6&&_0xdd07f6[_0x3ff0a7(0xf5)]?_0xdd07f6:{'default':_0xdd07f6};};function a34_0x28d2(){const _0xfdfe8c=['3338044iXHJux','481756IlABUx','compare','jwt','password','config','jsonwebtoken','admin','12324BxeaZE','defineProperty','default','passwordHash','180qHGNoJ','9008580rmxhZB','3930MGkcxj','ACTIVE','bcryptjs','../config/config','status','2550560HCYbVl','sign','verify','findUnique','verifyToken','Invalid\x20credentials','shop','username','AuthService','__esModule','190872IjimFb','__importDefault','name','expiresIn','2898128osJrdZ','secret','3VCkAAp','generateToken','Account\x20is\x20not\x20active','../config/database','login'];a34_0x28d2=function(){return _0xfdfe8c;};return a34_0x28d2();}Object[a34_0x44b4bc(0xe2)](exports,a34_0x44b4bc(0xf5),{'value':!![]}),exports['AuthService']=void 0x0;const bcryptjs_1=__importDefault(require(a34_0x44b4bc(0xe9))),jsonwebtoken_1=__importDefault(require(a34_0x44b4bc(0xdf))),database_1=__importDefault(require(a34_0x44b4bc(0xd7))),config_1=require(a34_0x44b4bc(0xea));class AuthService{[a34_0x44b4bc(0xd5)](_0x431ca3){const _0x386f24=a34_0x44b4bc;return jsonwebtoken_1['default'][_0x386f24(0xed)](_0x431ca3,config_1[_0x386f24(0xde)][_0x386f24(0xdc)][_0x386f24(0xd3)],{'expiresIn':String(config_1[_0x386f24(0xde)][_0x386f24(0xdc)][_0x386f24(0xd1)])});}async[a34_0x44b4bc(0xd8)](_0x31d0bc){const _0x7efac0=a34_0x44b4bc,{username:_0x5f4950,password:_0x32216e}=_0x31d0bc;if(_0x5f4950===config_1[_0x7efac0(0xde)][_0x7efac0(0xe0)][_0x7efac0(0xf3)]){const _0x1d7317=await bcryptjs_1['default'][_0x7efac0(0xdb)](_0x32216e,config_1['config'][_0x7efac0(0xe0)][_0x7efac0(0xe4)]);if(_0x1d7317){const _0x3d6aa1=this[_0x7efac0(0xd5)]({'id':_0x7efac0(0xe0),'username':config_1[_0x7efac0(0xde)]['admin'][_0x7efac0(0xf3)],'role':'admin'});return{'access_token':_0x3d6aa1,'role':_0x7efac0(0xe0)};}}const _0x326bd4=await database_1[_0x7efac0(0xe3)][_0x7efac0(0xf2)][_0x7efac0(0xef)]({'where':{'username':_0x5f4950},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x326bd4)throw new Error(_0x7efac0(0xf1));if(_0x326bd4[_0x7efac0(0xeb)]!==_0x7efac0(0xe8))throw new Error(_0x7efac0(0xd6));const _0xcfd210=await bcryptjs_1['default']['compare'](_0x32216e,_0x326bd4[_0x7efac0(0xdd)]);if(!_0xcfd210)throw new Error(_0x7efac0(0xf1));const _0x783cd8=this[_0x7efac0(0xd5)]({'id':_0x326bd4['id'],'username':_0x326bd4[_0x7efac0(0xf3)],'role':_0x7efac0(0xf2)});return{'access_token':_0x783cd8,'role':'shop','user':{'id':_0x326bd4['id'],'name':_0x326bd4[_0x7efac0(0xd0)],'username':_0x326bd4[_0x7efac0(0xf3)]}};}async[a34_0x44b4bc(0xf0)](_0x2159f8){const _0x499f12=a34_0x44b4bc;try{const _0x1bf00a=jsonwebtoken_1[_0x499f12(0xe3)][_0x499f12(0xee)](_0x2159f8,config_1[_0x499f12(0xde)][_0x499f12(0xdc)][_0x499f12(0xd3)]);return _0x1bf00a;}catch(_0x24668e){throw new Error('Invalid\x20token');}}}exports[a34_0x44b4bc(0xf4)]=AuthService;