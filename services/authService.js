'use strict';const a36_0x566958=a36_0x1b6c;function a36_0x4dbc(){const _0x2b5bd5=['expiresIn','default','jsonwebtoken','__importDefault','config','generateToken','../config/database','Account\x20is\x20not\x20active','shop','2975724ihGbUW','username','389284aUnrXk','name','127085blgaCn','AuthService','secret','505740ZUgfTp','2yjoHjT','11616UrrlbG','../config/config','15131JuRLRs','1650000qOdSur','defineProperty','Invalid\x20token','170QSspwh','passwordHash','findUnique','compare','admin','sign','password','jwt','verify'];a36_0x4dbc=function(){return _0x2b5bd5;};return a36_0x4dbc();}function a36_0x1b6c(_0x1b85e2,_0x2b8a84){const _0x4dbc97=a36_0x4dbc();return a36_0x1b6c=function(_0x1b6c38,_0x10809d){_0x1b6c38=_0x1b6c38-0x12d;let _0x4d68fd=_0x4dbc97[_0x1b6c38];return _0x4d68fd;},a36_0x1b6c(_0x1b85e2,_0x2b8a84);}(function(_0x464418,_0x535e85){const _0x19ad2b=a36_0x1b6c,_0x5779ac=_0x464418();while(!![]){try{const _0x2aa0c9=parseInt(_0x19ad2b(0x141))/0x1*(parseInt(_0x19ad2b(0x13e))/0x2)+parseInt(_0x19ad2b(0x13d))/0x3+-parseInt(_0x19ad2b(0x138))/0x4+parseInt(_0x19ad2b(0x145))/0x5*(-parseInt(_0x19ad2b(0x13f))/0x6)+parseInt(_0x19ad2b(0x13a))/0x7+-parseInt(_0x19ad2b(0x142))/0x8+parseInt(_0x19ad2b(0x136))/0x9;if(_0x2aa0c9===_0x535e85)break;else _0x5779ac['push'](_0x5779ac['shift']());}catch(_0x2ac28a){_0x5779ac['push'](_0x5779ac['shift']());}}}(a36_0x4dbc,0x27d23));var __importDefault=this&&this[a36_0x566958(0x130)]||function(_0x2d19ba){return _0x2d19ba&&_0x2d19ba['__esModule']?_0x2d19ba:{'default':_0x2d19ba};};Object[a36_0x566958(0x143)](exports,'__esModule',{'value':!![]}),exports[a36_0x566958(0x13b)]=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),jsonwebtoken_1=__importDefault(require(a36_0x566958(0x12f))),database_1=__importDefault(require(a36_0x566958(0x133))),config_1=require(a36_0x566958(0x140));class AuthService{['generateToken'](_0x49999a){const _0x4ce0e1=a36_0x566958;return jsonwebtoken_1[_0x4ce0e1(0x12e)][_0x4ce0e1(0x14a)](_0x49999a,config_1[_0x4ce0e1(0x131)]['jwt']['secret'],{'expiresIn':String(config_1[_0x4ce0e1(0x131)][_0x4ce0e1(0x14c)][_0x4ce0e1(0x12d)])});}async['login'](_0x20c6fc){const _0x4ccbb8=a36_0x566958,{username:_0x3105b7,password:_0x482987}=_0x20c6fc;if(_0x3105b7===config_1['config']['admin'][_0x4ccbb8(0x137)]){const _0x2c6157=await bcryptjs_1[_0x4ccbb8(0x12e)][_0x4ccbb8(0x148)](_0x482987,config_1[_0x4ccbb8(0x131)]['admin'][_0x4ccbb8(0x146)]);if(_0x2c6157){const _0x90a3ef=this[_0x4ccbb8(0x132)]({'id':_0x4ccbb8(0x149),'username':config_1['config'][_0x4ccbb8(0x149)][_0x4ccbb8(0x137)],'role':_0x4ccbb8(0x149)});return{'access_token':_0x90a3ef,'role':'admin'};}}const _0xcf2300=await database_1['default'][_0x4ccbb8(0x135)][_0x4ccbb8(0x147)]({'where':{'username':_0x3105b7},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0xcf2300)throw new Error('Invalid\x20credentials');if(_0xcf2300['status']!=='ACTIVE')throw new Error(_0x4ccbb8(0x134));const _0x49b173=await bcryptjs_1['default'][_0x4ccbb8(0x148)](_0x482987,_0xcf2300[_0x4ccbb8(0x14b)]);if(!_0x49b173)throw new Error('Invalid\x20credentials');const _0xc4ec3d=this[_0x4ccbb8(0x132)]({'id':_0xcf2300['id'],'username':_0xcf2300['username'],'role':_0x4ccbb8(0x135)});return{'access_token':_0xc4ec3d,'role':_0x4ccbb8(0x135),'user':{'id':_0xcf2300['id'],'name':_0xcf2300[_0x4ccbb8(0x139)],'username':_0xcf2300[_0x4ccbb8(0x137)]}};}async['verifyToken'](_0x5925a1){const _0xa769a2=a36_0x566958;try{const _0xdb847e=jsonwebtoken_1[_0xa769a2(0x12e)][_0xa769a2(0x14d)](_0x5925a1,config_1[_0xa769a2(0x131)][_0xa769a2(0x14c)][_0xa769a2(0x13c)]);return _0xdb847e;}catch(_0x59fed8){throw new Error(_0xa769a2(0x144));}}}exports['AuthService']=AuthService;