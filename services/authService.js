'use strict';function a36_0x867f(){const _0x2dee9f=['username','17229DDzCfd','2290776pUDvfv','sign','Invalid\x20token','77721wkFweh','generateToken','admin','__importDefault','../config/config','289848AwIhWo','3ToBzcU','2852220WxKzAb','password','secret','verify','200jbzHHD','status','default','passwordHash','shop','name','jwt','ACTIVE','9EXuCWk','config','expiresIn','defineProperty','Invalid\x20credentials','bcryptjs','5322810NGITmk','AuthService','__esModule','6413944ofjgnP','Account\x20is\x20not\x20active','compare'];a36_0x867f=function(){return _0x2dee9f;};return a36_0x867f();}function a36_0x4c63(_0x138e65,_0xaace84){const _0x867fdd=a36_0x867f();return a36_0x4c63=function(_0x4c637d,_0x3400eb){_0x4c637d=_0x4c637d-0x166;let _0xdfd07b=_0x867fdd[_0x4c637d];return _0xdfd07b;},a36_0x4c63(_0x138e65,_0xaace84);}const a36_0x5a951c=a36_0x4c63;(function(_0x71ffa4,_0x42b0f7){const _0x439188=a36_0x4c63,_0x190fab=_0x71ffa4();while(!![]){try{const _0x553930=-parseInt(_0x439188(0x168))/0x1*(-parseInt(_0x439188(0x167))/0x2)+-parseInt(_0x439188(0x182))/0x3*(parseInt(_0x439188(0x16d))/0x4)+parseInt(_0x439188(0x169))/0x5+-parseInt(_0x439188(0x183))/0x6+-parseInt(_0x439188(0x186))/0x7+parseInt(_0x439188(0x17e))/0x8+parseInt(_0x439188(0x175))/0x9*(-parseInt(_0x439188(0x17b))/0xa);if(_0x553930===_0x42b0f7)break;else _0x190fab['push'](_0x190fab['shift']());}catch(_0x960547){_0x190fab['push'](_0x190fab['shift']());}}}(a36_0x867f,0x912c5));var __importDefault=this&&this[a36_0x5a951c(0x189)]||function(_0x120973){const _0x754ed1=a36_0x5a951c;return _0x120973&&_0x120973[_0x754ed1(0x17d)]?_0x120973:{'default':_0x120973};};Object[a36_0x5a951c(0x178)](exports,a36_0x5a951c(0x17d),{'value':!![]}),exports['AuthService']=void 0x0;const bcryptjs_1=__importDefault(require(a36_0x5a951c(0x17a))),jsonwebtoken_1=__importDefault(require('jsonwebtoken')),database_1=__importDefault(require('../config/database')),config_1=require(a36_0x5a951c(0x166));class AuthService{[a36_0x5a951c(0x187)](_0x204ce4){const _0x113327=a36_0x5a951c;return jsonwebtoken_1[_0x113327(0x16f)][_0x113327(0x184)](_0x204ce4,config_1[_0x113327(0x176)][_0x113327(0x173)][_0x113327(0x16b)],{'expiresIn':String(config_1[_0x113327(0x176)][_0x113327(0x173)][_0x113327(0x177)])});}async['login'](_0x38ecb2){const _0x3ce2b1=a36_0x5a951c,{username:_0x30301d,password:_0x12703b}=_0x38ecb2;if(_0x30301d===config_1[_0x3ce2b1(0x176)][_0x3ce2b1(0x188)][_0x3ce2b1(0x181)]){const _0x32d4eb=await bcryptjs_1[_0x3ce2b1(0x16f)][_0x3ce2b1(0x180)](_0x12703b,config_1[_0x3ce2b1(0x176)]['admin'][_0x3ce2b1(0x170)]);if(_0x32d4eb){const _0x47c10a=this[_0x3ce2b1(0x187)]({'id':_0x3ce2b1(0x188),'username':config_1[_0x3ce2b1(0x176)]['admin']['username'],'role':_0x3ce2b1(0x188)});return{'access_token':_0x47c10a,'role':_0x3ce2b1(0x188)};}}const _0xd93719=await database_1[_0x3ce2b1(0x16f)]['shop']['findUnique']({'where':{'username':_0x30301d},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0xd93719)throw new Error(_0x3ce2b1(0x179));if(_0xd93719[_0x3ce2b1(0x16e)]!==_0x3ce2b1(0x174))throw new Error(_0x3ce2b1(0x17f));const _0x53df8a=await bcryptjs_1[_0x3ce2b1(0x16f)][_0x3ce2b1(0x180)](_0x12703b,_0xd93719[_0x3ce2b1(0x16a)]);if(!_0x53df8a)throw new Error(_0x3ce2b1(0x179));const _0x3d709d=this[_0x3ce2b1(0x187)]({'id':_0xd93719['id'],'username':_0xd93719['username'],'role':'shop'});return{'access_token':_0x3d709d,'role':_0x3ce2b1(0x171),'user':{'id':_0xd93719['id'],'name':_0xd93719[_0x3ce2b1(0x172)],'username':_0xd93719['username']}};}async['verifyToken'](_0x5ce82a){const _0x3c5c35=a36_0x5a951c;try{const _0x53b858=jsonwebtoken_1['default'][_0x3c5c35(0x16c)](_0x5ce82a,config_1[_0x3c5c35(0x176)][_0x3c5c35(0x173)][_0x3c5c35(0x16b)]);return _0x53b858;}catch(_0x28026e){throw new Error(_0x3c5c35(0x185));}}}exports[a36_0x5a951c(0x17c)]=AuthService;