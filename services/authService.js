'use strict';function a37_0x4e69(_0x24b654,_0x7b38d8){const _0x59bc50=a37_0x59bc();return a37_0x4e69=function(_0x4e6986,_0x4a3156){_0x4e6986=_0x4e6986-0xe5;let _0x56403b=_0x59bc50[_0x4e6986];return _0x56403b;},a37_0x4e69(_0x24b654,_0x7b38d8);}const a37_0x5c19df=a37_0x4e69;(function(_0x3ce8c0,_0x5f0542){const _0x197dc8=a37_0x4e69,_0x176579=_0x3ce8c0();while(!![]){try{const _0x400df9=-parseInt(_0x197dc8(0x100))/0x1+-parseInt(_0x197dc8(0xfa))/0x2+parseInt(_0x197dc8(0x106))/0x3+-parseInt(_0x197dc8(0x107))/0x4+parseInt(_0x197dc8(0xf4))/0x5*(parseInt(_0x197dc8(0xe9))/0x6)+parseInt(_0x197dc8(0xec))/0x7+parseInt(_0x197dc8(0xe7))/0x8*(parseInt(_0x197dc8(0xfc))/0x9);if(_0x400df9===_0x5f0542)break;else _0x176579['push'](_0x176579['shift']());}catch(_0x16077b){_0x176579['push'](_0x176579['shift']());}}}(a37_0x59bc,0xe5752));var __importDefault=this&&this[a37_0x5c19df(0xf0)]||function(_0x22e792){const _0x465386=a37_0x5c19df;return _0x22e792&&_0x22e792[_0x465386(0xff)]?_0x22e792:{'default':_0x22e792};};Object[a37_0x5c19df(0xf9)](exports,'__esModule',{'value':!![]}),exports[a37_0x5c19df(0xfb)]=void 0x0;const bcryptjs_1=__importDefault(require(a37_0x5c19df(0xf1))),jsonwebtoken_1=__importDefault(require(a37_0x5c19df(0xf5))),database_1=__importDefault(require(a37_0x5c19df(0xed))),config_1=require(a37_0x5c19df(0x105));function a37_0x59bc(){const _0x4ad4e2=['sign','../config/config','561648jfndcI','5531612RCdoWO','default','admin','1110808DFhmSr','verifyToken','12dRWzPI','config','password','50554hXLVTo','../config/database','Invalid\x20credentials','verify','__importDefault','bcryptjs','generateToken','status','232555KDBraA','jsonwebtoken','jwt','expiresIn','Account\x20is\x20not\x20active','defineProperty','1064286ponXcW','AuthService','243EaBAdg','findUnique','username','__esModule','1181533ldXjOQ','secret','shop','compare'];a37_0x59bc=function(){return _0x4ad4e2;};return a37_0x59bc();}class AuthService{[a37_0x5c19df(0xf2)](_0x2dca6c){const _0xb1c682=a37_0x5c19df;return jsonwebtoken_1['default'][_0xb1c682(0x104)](_0x2dca6c,config_1[_0xb1c682(0xea)][_0xb1c682(0xf6)][_0xb1c682(0x101)],{'expiresIn':String(config_1[_0xb1c682(0xea)][_0xb1c682(0xf6)][_0xb1c682(0xf7)])});}async['login'](_0x42cbed){const _0x25b1dc=a37_0x5c19df,{username:_0x30c5e7,password:_0x42b860}=_0x42cbed;if(_0x30c5e7===config_1['config'][_0x25b1dc(0xe6)][_0x25b1dc(0xfe)]){const _0x306c32=await bcryptjs_1[_0x25b1dc(0xe5)][_0x25b1dc(0x103)](_0x42b860,config_1[_0x25b1dc(0xea)]['admin']['passwordHash']);if(_0x306c32){const _0x2cc861=this['generateToken']({'id':_0x25b1dc(0xe6),'username':config_1[_0x25b1dc(0xea)]['admin'][_0x25b1dc(0xfe)],'role':_0x25b1dc(0xe6)});return{'access_token':_0x2cc861,'role':_0x25b1dc(0xe6)};}}const _0xa290ee=await database_1['default']['shop'][_0x25b1dc(0xfd)]({'where':{'username':_0x30c5e7},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0xa290ee)throw new Error(_0x25b1dc(0xee));if(_0xa290ee[_0x25b1dc(0xf3)]!=='ACTIVE')throw new Error(_0x25b1dc(0xf8));const _0xdaf456=await bcryptjs_1[_0x25b1dc(0xe5)][_0x25b1dc(0x103)](_0x42b860,_0xa290ee[_0x25b1dc(0xeb)]);if(!_0xdaf456)throw new Error(_0x25b1dc(0xee));const _0x384a70=this['generateToken']({'id':_0xa290ee['id'],'username':_0xa290ee[_0x25b1dc(0xfe)],'role':_0x25b1dc(0x102)});return{'access_token':_0x384a70,'role':'shop','user':{'id':_0xa290ee['id'],'name':_0xa290ee['name'],'username':_0xa290ee[_0x25b1dc(0xfe)]}};}async[a37_0x5c19df(0xe8)](_0xf9bd2d){const _0x55ca09=a37_0x5c19df;try{const _0x34dbf2=jsonwebtoken_1['default'][_0x55ca09(0xef)](_0xf9bd2d,config_1[_0x55ca09(0xea)][_0x55ca09(0xf6)]['secret']);return _0x34dbf2;}catch(_0x5a2127){throw new Error('Invalid\x20token');}}}exports[a37_0x5c19df(0xfb)]=AuthService;