'use strict';function a34_0x4200(_0x105421,_0x2b2bb6){const _0x1f1d3b=a34_0x1f1d();return a34_0x4200=function(_0x4200de,_0x550d18){_0x4200de=_0x4200de-0x1bd;let _0x5a2ab1=_0x1f1d3b[_0x4200de];return _0x5a2ab1;},a34_0x4200(_0x105421,_0x2b2bb6);}const a34_0x351507=a34_0x4200;(function(_0x305757,_0x283931){const _0x2756f1=a34_0x4200,_0x130774=_0x305757();while(!![]){try{const _0x270722=-parseInt(_0x2756f1(0x1d9))/0x1+parseInt(_0x2756f1(0x1c5))/0x2*(-parseInt(_0x2756f1(0x1d7))/0x3)+-parseInt(_0x2756f1(0x1c8))/0x4+-parseInt(_0x2756f1(0x1da))/0x5+parseInt(_0x2756f1(0x1be))/0x6+-parseInt(_0x2756f1(0x1d5))/0x7*(-parseInt(_0x2756f1(0x1d4))/0x8)+-parseInt(_0x2756f1(0x1d3))/0x9*(-parseInt(_0x2756f1(0x1db))/0xa);if(_0x270722===_0x283931)break;else _0x130774['push'](_0x130774['shift']());}catch(_0x47a4bb){_0x130774['push'](_0x130774['shift']());}}}(a34_0x1f1d,0x2f606));var __importDefault=this&&this[a34_0x351507(0x1dd)]||function(_0x3d1ab7){return _0x3d1ab7&&_0x3d1ab7['__esModule']?_0x3d1ab7:{'default':_0x3d1ab7};};function a34_0x1f1d(){const _0x31d609=['Account\x20is\x20not\x20active','524SwtVlb','jwt','__esModule','1117192Abzfnk','name','secret','Invalid\x20token','findUnique','username','admin','status','ACTIVE','config','default','252duvjDT','16GgbRCs','125601tpOigI','password','273TuCAUR','jsonwebtoken','87428VXITLq','1419695WqJmiz','279060Wmqkqp','AuthService','__importDefault','passwordHash','generateToken','../config/config','307842kjPnfN','defineProperty','sign','Invalid\x20credentials','verifyToken','shop'];a34_0x1f1d=function(){return _0x31d609;};return a34_0x1f1d();}Object[a34_0x351507(0x1bf)](exports,a34_0x351507(0x1c7),{'value':!![]}),exports[a34_0x351507(0x1dc)]=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),jsonwebtoken_1=__importDefault(require(a34_0x351507(0x1d8))),database_1=__importDefault(require('../config/database')),config_1=require(a34_0x351507(0x1bd));class AuthService{[a34_0x351507(0x1df)](_0x1af723){const _0x2ddcde=a34_0x351507;return jsonwebtoken_1[_0x2ddcde(0x1d2)][_0x2ddcde(0x1c0)](_0x1af723,config_1[_0x2ddcde(0x1d1)][_0x2ddcde(0x1c6)][_0x2ddcde(0x1ca)],{'expiresIn':String(config_1[_0x2ddcde(0x1d1)][_0x2ddcde(0x1c6)]['expiresIn'])});}async['login'](_0x3bd7ab){const _0x31a964=a34_0x351507,{username:_0x2f7498,password:_0x32f0e1}=_0x3bd7ab;if(_0x2f7498===config_1[_0x31a964(0x1d1)][_0x31a964(0x1ce)]['username']){const _0x3915f0=await bcryptjs_1[_0x31a964(0x1d2)]['compare'](_0x32f0e1,config_1[_0x31a964(0x1d1)]['admin'][_0x31a964(0x1de)]);if(_0x3915f0){const _0x167e66=this[_0x31a964(0x1df)]({'id':_0x31a964(0x1ce),'username':config_1[_0x31a964(0x1d1)]['admin'][_0x31a964(0x1cd)],'role':'admin'});return{'access_token':_0x167e66,'role':_0x31a964(0x1ce)};}}const _0x5c9a6d=await database_1[_0x31a964(0x1d2)]['shop'][_0x31a964(0x1cc)]({'where':{'username':_0x2f7498},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x5c9a6d)throw new Error('Invalid\x20credentials');if(_0x5c9a6d[_0x31a964(0x1cf)]!==_0x31a964(0x1d0))throw new Error(_0x31a964(0x1c4));const _0x8ef462=await bcryptjs_1[_0x31a964(0x1d2)]['compare'](_0x32f0e1,_0x5c9a6d[_0x31a964(0x1d6)]);if(!_0x8ef462)throw new Error(_0x31a964(0x1c1));const _0x399767=this[_0x31a964(0x1df)]({'id':_0x5c9a6d['id'],'username':_0x5c9a6d[_0x31a964(0x1cd)],'role':'shop'});return{'access_token':_0x399767,'role':_0x31a964(0x1c3),'user':{'id':_0x5c9a6d['id'],'name':_0x5c9a6d[_0x31a964(0x1c9)],'username':_0x5c9a6d['username']}};}async[a34_0x351507(0x1c2)](_0xba1779){const _0x5d4fb7=a34_0x351507;try{const _0x4c094d=jsonwebtoken_1[_0x5d4fb7(0x1d2)]['verify'](_0xba1779,config_1[_0x5d4fb7(0x1d1)][_0x5d4fb7(0x1c6)][_0x5d4fb7(0x1ca)]);return _0x4c094d;}catch(_0x547bd0){throw new Error(_0x5d4fb7(0x1cb));}}}exports[a34_0x351507(0x1dc)]=AuthService;