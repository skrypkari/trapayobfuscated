'use strict';const a36_0x5d39e4=a36_0x3032;(function(_0x50502a,_0x2294b9){const _0x13679e=a36_0x3032,_0x3baf08=_0x50502a();while(!![]){try{const _0x5f387d=-parseInt(_0x13679e(0x163))/0x1*(parseInt(_0x13679e(0x171))/0x2)+parseInt(_0x13679e(0x165))/0x3+-parseInt(_0x13679e(0x183))/0x4*(parseInt(_0x13679e(0x185))/0x5)+parseInt(_0x13679e(0x170))/0x6+-parseInt(_0x13679e(0x175))/0x7*(-parseInt(_0x13679e(0x16a))/0x8)+parseInt(_0x13679e(0x182))/0x9*(-parseInt(_0x13679e(0x173))/0xa)+parseInt(_0x13679e(0x174))/0xb;if(_0x5f387d===_0x2294b9)break;else _0x3baf08['push'](_0x3baf08['shift']());}catch(_0x791b58){_0x3baf08['push'](_0x3baf08['shift']());}}}(a36_0xfa8c,0xee7eb));function a36_0xfa8c(){const _0x1bcd5e=['secret','bcryptjs','admin','Invalid\x20credentials','defineProperty','../config/database','15894MwCRmd','3670028zOAeNp','Invalid\x20token','10XEzfCs','jsonwebtoken','1451633jgPDFn','Account\x20is\x20not\x20active','2529246ePUnjy','login','../config/config','passwordHash','username','53616bfaEpS','password','name','default','shop','config','9432840qQIUyc','2zoQKUq','findUnique','5530qrjjib','29673160IRVvZQ','133taeLcL','__esModule','sign','compare','AuthService','status','verify'];a36_0xfa8c=function(){return _0x1bcd5e;};return a36_0xfa8c();}var __importDefault=this&&this['__importDefault']||function(_0x15ae81){const _0x36794d=a36_0x3032;return _0x15ae81&&_0x15ae81[_0x36794d(0x176)]?_0x15ae81:{'default':_0x15ae81};};Object[a36_0x5d39e4(0x180)](exports,a36_0x5d39e4(0x176),{'value':!![]}),exports[a36_0x5d39e4(0x179)]=void 0x0;function a36_0x3032(_0x5afd67,_0x5ee330){const _0xfa8c61=a36_0xfa8c();return a36_0x3032=function(_0x3032b1,_0x53dbc4){_0x3032b1=_0x3032b1-0x162;let _0x1141b3=_0xfa8c61[_0x3032b1];return _0x1141b3;},a36_0x3032(_0x5afd67,_0x5ee330);}const bcryptjs_1=__importDefault(require(a36_0x5d39e4(0x17d))),jsonwebtoken_1=__importDefault(require(a36_0x5d39e4(0x162))),database_1=__importDefault(require(a36_0x5d39e4(0x181))),config_1=require(a36_0x5d39e4(0x167));class AuthService{['generateToken'](_0x4119e0){const _0x36f003=a36_0x5d39e4;return jsonwebtoken_1[_0x36f003(0x16d)][_0x36f003(0x177)](_0x4119e0,config_1[_0x36f003(0x16f)]['jwt'][_0x36f003(0x17c)],{'expiresIn':String(config_1[_0x36f003(0x16f)]['jwt']['expiresIn'])});}async[a36_0x5d39e4(0x166)](_0x79c70a){const _0x3144b9=a36_0x5d39e4,{username:_0x36ce63,password:_0x7d864a}=_0x79c70a;if(_0x36ce63===config_1['config'][_0x3144b9(0x17e)]['username']){const _0x38bb06=await bcryptjs_1[_0x3144b9(0x16d)][_0x3144b9(0x178)](_0x7d864a,config_1['config'][_0x3144b9(0x17e)][_0x3144b9(0x168)]);if(_0x38bb06){const _0xfd106=this['generateToken']({'id':_0x3144b9(0x17e),'username':config_1[_0x3144b9(0x16f)]['admin'][_0x3144b9(0x169)],'role':'admin'});return{'access_token':_0xfd106,'role':_0x3144b9(0x17e)};}}const _0x518935=await database_1[_0x3144b9(0x16d)]['shop'][_0x3144b9(0x172)]({'where':{'username':_0x36ce63},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x518935)throw new Error(_0x3144b9(0x17f));if(_0x518935[_0x3144b9(0x17a)]!=='ACTIVE')throw new Error(_0x3144b9(0x164));const _0x5aece8=await bcryptjs_1['default']['compare'](_0x7d864a,_0x518935[_0x3144b9(0x16b)]);if(!_0x5aece8)throw new Error(_0x3144b9(0x17f));const _0x42dfa8=this['generateToken']({'id':_0x518935['id'],'username':_0x518935[_0x3144b9(0x169)],'role':_0x3144b9(0x16e)});return{'access_token':_0x42dfa8,'role':_0x3144b9(0x16e),'user':{'id':_0x518935['id'],'name':_0x518935[_0x3144b9(0x16c)],'username':_0x518935['username']}};}async['verifyToken'](_0x473c7c){const _0x3c809f=a36_0x5d39e4;try{const _0x5bae17=jsonwebtoken_1[_0x3c809f(0x16d)][_0x3c809f(0x17b)](_0x473c7c,config_1[_0x3c809f(0x16f)]['jwt']['secret']);return _0x5bae17;}catch(_0x126df9){throw new Error(_0x3c809f(0x184));}}}exports['AuthService']=AuthService;