'use strict';const a36_0xeebb71=a36_0x3827;(function(_0x5f2320,_0x13afc8){const _0x2e92e5=a36_0x3827,_0x3071b6=_0x5f2320();while(!![]){try{const _0x53cec2=parseInt(_0x2e92e5(0x9d))/0x1+parseInt(_0x2e92e5(0xa9))/0x2+parseInt(_0x2e92e5(0xa5))/0x3*(-parseInt(_0x2e92e5(0xb8))/0x4)+parseInt(_0x2e92e5(0xb7))/0x5*(parseInt(_0x2e92e5(0xa7))/0x6)+-parseInt(_0x2e92e5(0xa1))/0x7+-parseInt(_0x2e92e5(0xbc))/0x8*(-parseInt(_0x2e92e5(0xba))/0x9)+-parseInt(_0x2e92e5(0xa0))/0xa*(-parseInt(_0x2e92e5(0xb0))/0xb);if(_0x53cec2===_0x13afc8)break;else _0x3071b6['push'](_0x3071b6['shift']());}catch(_0x2311e7){_0x3071b6['push'](_0x3071b6['shift']());}}}(a36_0x1168,0x4e161));var __importDefault=this&&this[a36_0xeebb71(0xbd)]||function(_0x1ee1d7){return _0x1ee1d7&&_0x1ee1d7['__esModule']?_0x1ee1d7:{'default':_0x1ee1d7};};function a36_0x1168(){const _0x4245ed=['881815gfCKpM','secret','jwt','generateToken','name','config','ACTIVE','3141065lDBLxX','16980cVPNtO','default','171VzAFgB','Account\x20is\x20not\x20active','41616RtyFkH','__importDefault','admin','__esModule','password','bcryptjs','expiresIn','status','47417RoUfMr','login','../config/config','10TjSgbS','3134698jTWenb','defineProperty','AuthService','findUnique','219RPbXfB','Invalid\x20credentials','6bOItET','username','445814uCwjMG','compare','verifyToken','jsonwebtoken','shop','passwordHash','../config/database'];a36_0x1168=function(){return _0x4245ed;};return a36_0x1168();}Object[a36_0xeebb71(0xa2)](exports,a36_0xeebb71(0xbf),{'value':!![]}),exports[a36_0xeebb71(0xa3)]=void 0x0;const bcryptjs_1=__importDefault(require(a36_0xeebb71(0xc1))),jsonwebtoken_1=__importDefault(require(a36_0xeebb71(0xac))),database_1=__importDefault(require(a36_0xeebb71(0xaf))),config_1=require(a36_0xeebb71(0x9f));function a36_0x3827(_0x2f9805,_0x5cbf7c){const _0x116880=a36_0x1168();return a36_0x3827=function(_0x382784,_0x48d988){_0x382784=_0x382784-0x9c;let _0x50f1af=_0x116880[_0x382784];return _0x50f1af;},a36_0x3827(_0x2f9805,_0x5cbf7c);}class AuthService{[a36_0xeebb71(0xb3)](_0x3ddf54){const _0x576d19=a36_0xeebb71;return jsonwebtoken_1[_0x576d19(0xb9)]['sign'](_0x3ddf54,config_1[_0x576d19(0xb5)]['jwt'][_0x576d19(0xb1)],{'expiresIn':String(config_1[_0x576d19(0xb5)][_0x576d19(0xb2)][_0x576d19(0xc2)])});}async[a36_0xeebb71(0x9e)](_0x11265f){const _0x2d3246=a36_0xeebb71,{username:_0x35b11d,password:_0xdee7c8}=_0x11265f;if(_0x35b11d===config_1['config'][_0x2d3246(0xbe)][_0x2d3246(0xa8)]){const _0x5839ac=await bcryptjs_1['default'][_0x2d3246(0xaa)](_0xdee7c8,config_1[_0x2d3246(0xb5)]['admin'][_0x2d3246(0xae)]);if(_0x5839ac){const _0x15452d=this[_0x2d3246(0xb3)]({'id':'admin','username':config_1[_0x2d3246(0xb5)][_0x2d3246(0xbe)][_0x2d3246(0xa8)],'role':_0x2d3246(0xbe)});return{'access_token':_0x15452d,'role':_0x2d3246(0xbe)};}}const _0x28c0ad=await database_1[_0x2d3246(0xb9)]['shop'][_0x2d3246(0xa4)]({'where':{'username':_0x35b11d},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x28c0ad)throw new Error(_0x2d3246(0xa6));if(_0x28c0ad[_0x2d3246(0x9c)]!==_0x2d3246(0xb6))throw new Error(_0x2d3246(0xbb));const _0x348370=await bcryptjs_1[_0x2d3246(0xb9)][_0x2d3246(0xaa)](_0xdee7c8,_0x28c0ad[_0x2d3246(0xc0)]);if(!_0x348370)throw new Error(_0x2d3246(0xa6));const _0xcd27c=this['generateToken']({'id':_0x28c0ad['id'],'username':_0x28c0ad[_0x2d3246(0xa8)],'role':_0x2d3246(0xad)});return{'access_token':_0xcd27c,'role':'shop','user':{'id':_0x28c0ad['id'],'name':_0x28c0ad[_0x2d3246(0xb4)],'username':_0x28c0ad[_0x2d3246(0xa8)]}};}async[a36_0xeebb71(0xab)](_0x25faee){const _0x24c10a=a36_0xeebb71;try{const _0x187d18=jsonwebtoken_1[_0x24c10a(0xb9)]['verify'](_0x25faee,config_1['config'][_0x24c10a(0xb2)]['secret']);return _0x187d18;}catch(_0x11a559){throw new Error('Invalid\x20token');}}}exports[a36_0xeebb71(0xa3)]=AuthService;