'use strict';const a49_0x2f45e6=a49_0x36ff;(function(_0x7344e0,_0x5e7f1b){const _0x5d862e=a49_0x36ff,_0x5c6c0f=_0x7344e0();while(!![]){try{const _0x14d1da=-parseInt(_0x5d862e(0xa2))/0x1+parseInt(_0x5d862e(0xaa))/0x2*(-parseInt(_0x5d862e(0xa0))/0x3)+-parseInt(_0x5d862e(0x94))/0x4+parseInt(_0x5d862e(0xa1))/0x5*(parseInt(_0x5d862e(0x8c))/0x6)+parseInt(_0x5d862e(0x9a))/0x7*(parseInt(_0x5d862e(0x95))/0x8)+parseInt(_0x5d862e(0x92))/0x9+parseInt(_0x5d862e(0x90))/0xa*(parseInt(_0x5d862e(0x97))/0xb);if(_0x14d1da===_0x5e7f1b)break;else _0x5c6c0f['push'](_0x5c6c0f['shift']());}catch(_0x527ce1){_0x5c6c0f['push'](_0x5c6c0f['shift']());}}}(a49_0x22a9,0x6868d));var __importDefault=this&&this[a49_0x2f45e6(0x8d)]||function(_0x34eabc){return _0x34eabc&&_0x34eabc['__esModule']?_0x34eabc:{'default':_0x34eabc};};Object[a49_0x2f45e6(0xa7)](exports,a49_0x2f45e6(0x8f),{'value':!![]}),exports[a49_0x2f45e6(0x93)]=void 0x0;function a49_0x22a9(){const _0x4ffd2d=['secret','281116DlmiEG','admin','findUnique','56YnhKKU','password','config','passwordHash','login','ACTIVE','4815gNYNZI','1567205KCRWWc','52571QfcpDY','../config/config','Invalid\x20token','expiresIn','jwt','defineProperty','status','default','618orYXBM','compare','shop','Invalid\x20credentials','username','bcryptjs','12YgCdPK','__importDefault','../config/database','__esModule','110VABCoa','generateToken','6765570mRfvTD','AuthService','2906972ddGaKa','43192JjQxFT'];a49_0x22a9=function(){return _0x4ffd2d;};return a49_0x22a9();}const bcryptjs_1=__importDefault(require(a49_0x2f45e6(0x8b))),jsonwebtoken_1=__importDefault(require('jsonwebtoken')),database_1=__importDefault(require(a49_0x2f45e6(0x8e))),config_1=require(a49_0x2f45e6(0xa3));class AuthService{['generateToken'](_0x519e32){const _0x383bc1=a49_0x2f45e6;return jsonwebtoken_1[_0x383bc1(0xa9)]['sign'](_0x519e32,config_1[_0x383bc1(0x9c)][_0x383bc1(0xa6)]['secret'],{'expiresIn':String(config_1['config'][_0x383bc1(0xa6)][_0x383bc1(0xa5)])});}async[a49_0x2f45e6(0x9e)](_0x4e7b55){const _0x5540db=a49_0x2f45e6,{username:_0x77a5c8,password:_0x1c065c}=_0x4e7b55;if(_0x77a5c8===config_1[_0x5540db(0x9c)][_0x5540db(0x98)]['username']){const _0x1f408c=await bcryptjs_1[_0x5540db(0xa9)][_0x5540db(0xab)](_0x1c065c,config_1[_0x5540db(0x9c)][_0x5540db(0x98)][_0x5540db(0x9d)]);if(_0x1f408c){const _0x4b4796=this[_0x5540db(0x91)]({'id':_0x5540db(0x98),'username':config_1[_0x5540db(0x9c)]['admin'][_0x5540db(0xae)],'role':'admin'});return{'access_token':_0x4b4796,'role':_0x5540db(0x98)};}}const _0x3dc40e=await database_1['default'][_0x5540db(0xac)][_0x5540db(0x99)]({'where':{'username':_0x77a5c8},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x3dc40e)throw new Error(_0x5540db(0xad));if(_0x3dc40e[_0x5540db(0xa8)]!==_0x5540db(0x9f))throw new Error('Account\x20is\x20not\x20active');const _0x2b9dfd=await bcryptjs_1[_0x5540db(0xa9)][_0x5540db(0xab)](_0x1c065c,_0x3dc40e[_0x5540db(0x9b)]);if(!_0x2b9dfd)throw new Error(_0x5540db(0xad));const _0x47bab1=this[_0x5540db(0x91)]({'id':_0x3dc40e['id'],'username':_0x3dc40e['username'],'role':_0x5540db(0xac)});return{'access_token':_0x47bab1,'role':_0x5540db(0xac),'user':{'id':_0x3dc40e['id'],'name':_0x3dc40e['name'],'username':_0x3dc40e['username']}};}async['verifyToken'](_0x36a33c){const _0x59ae36=a49_0x2f45e6;try{const _0x5812e5=jsonwebtoken_1[_0x59ae36(0xa9)]['verify'](_0x36a33c,config_1[_0x59ae36(0x9c)][_0x59ae36(0xa6)][_0x59ae36(0x96)]);return _0x5812e5;}catch(_0x4e1736){throw new Error(_0x59ae36(0xa4));}}}function a49_0x36ff(_0x510691,_0x474ba0){_0x510691=_0x510691-0x8b;const _0x22a99b=a49_0x22a9();let _0x36ff8a=_0x22a99b[_0x510691];return _0x36ff8a;}exports[a49_0x2f45e6(0x93)]=AuthService;