'use strict';function a37_0x2b71(){const _0x4e3c0f=['username','__esModule','bcryptjs','default','passwordHash','verifyToken','login','admin','Invalid\x20credentials','config','Account\x20is\x20not\x20active','7NkqqpW','jwt','verify','604647UFxpCD','Invalid\x20token','1507216DoeLLW','generateToken','ACTIVE','defineProperty','../config/database','AuthService','233390dAmDek','password','secret','status','16OEeptD','compare','2773071hKEekk','386440ZWBMfI','419486BkObAI','262950wOMuHg','expiresIn','name','shop','1XQNmwh','165ULiaJg'];a37_0x2b71=function(){return _0x4e3c0f;};return a37_0x2b71();}const a37_0x74da1b=a37_0x3b68;(function(_0x263104,_0x5bdcac){const _0x8f850b=a37_0x3b68,_0x12fd5f=_0x263104();while(!![]){try{const _0x5d487a=-parseInt(_0x8f850b(0xbe))/0x1*(parseInt(_0x8f850b(0xb9))/0x2)+parseInt(_0x8f850b(0xa9))/0x3+parseInt(_0x8f850b(0xb5))/0x4*(-parseInt(_0x8f850b(0xb1))/0x5)+parseInt(_0x8f850b(0xba))/0x6*(-parseInt(_0x8f850b(0xa6))/0x7)+parseInt(_0x8f850b(0xab))/0x8+-parseInt(_0x8f850b(0xb7))/0x9+parseInt(_0x8f850b(0xb8))/0xa*(parseInt(_0x8f850b(0xbf))/0xb);if(_0x5d487a===_0x5bdcac)break;else _0x12fd5f['push'](_0x12fd5f['shift']());}catch(_0x4c4c87){_0x12fd5f['push'](_0x12fd5f['shift']());}}}(a37_0x2b71,0x3601c));var __importDefault=this&&this['__importDefault']||function(_0x38a39e){const _0xbf38a0=a37_0x3b68;return _0x38a39e&&_0x38a39e[_0xbf38a0(0xc1)]?_0x38a39e:{'default':_0x38a39e};};function a37_0x3b68(_0x11bccf,_0x21357d){const _0x2b713f=a37_0x2b71();return a37_0x3b68=function(_0x3b68ab,_0x29ee04){_0x3b68ab=_0x3b68ab-0xa2;let _0x341c48=_0x2b713f[_0x3b68ab];return _0x341c48;},a37_0x3b68(_0x11bccf,_0x21357d);}Object[a37_0x74da1b(0xae)](exports,'__esModule',{'value':!![]}),exports[a37_0x74da1b(0xb0)]=void 0x0;const bcryptjs_1=__importDefault(require(a37_0x74da1b(0xc2))),jsonwebtoken_1=__importDefault(require('jsonwebtoken')),database_1=__importDefault(require(a37_0x74da1b(0xaf))),config_1=require('../config/config');class AuthService{[a37_0x74da1b(0xac)](_0x1d7f21){const _0xacfc58=a37_0x74da1b;return jsonwebtoken_1[_0xacfc58(0xc3)]['sign'](_0x1d7f21,config_1['config'][_0xacfc58(0xa7)][_0xacfc58(0xb3)],{'expiresIn':String(config_1[_0xacfc58(0xa4)][_0xacfc58(0xa7)][_0xacfc58(0xbb)])});}async[a37_0x74da1b(0xc6)](_0x49f9df){const _0x591778=a37_0x74da1b,{username:_0x4c7b03,password:_0x1c2a4c}=_0x49f9df;if(_0x4c7b03===config_1[_0x591778(0xa4)]['admin']['username']){const _0x5c3224=await bcryptjs_1['default'][_0x591778(0xb6)](_0x1c2a4c,config_1[_0x591778(0xa4)]['admin'][_0x591778(0xc4)]);if(_0x5c3224){const _0x3c1652=this[_0x591778(0xac)]({'id':'admin','username':config_1[_0x591778(0xa4)][_0x591778(0xa2)]['username'],'role':_0x591778(0xa2)});return{'access_token':_0x3c1652,'role':_0x591778(0xa2)};}}const _0x2ff287=await database_1[_0x591778(0xc3)][_0x591778(0xbd)]['findUnique']({'where':{'username':_0x4c7b03},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x2ff287)throw new Error(_0x591778(0xa3));if(_0x2ff287[_0x591778(0xb4)]!==_0x591778(0xad))throw new Error(_0x591778(0xa5));const _0x3e6883=await bcryptjs_1[_0x591778(0xc3)][_0x591778(0xb6)](_0x1c2a4c,_0x2ff287[_0x591778(0xb2)]);if(!_0x3e6883)throw new Error(_0x591778(0xa3));const _0x1d1dc4=this['generateToken']({'id':_0x2ff287['id'],'username':_0x2ff287[_0x591778(0xc0)],'role':_0x591778(0xbd)});return{'access_token':_0x1d1dc4,'role':_0x591778(0xbd),'user':{'id':_0x2ff287['id'],'name':_0x2ff287[_0x591778(0xbc)],'username':_0x2ff287['username']}};}async[a37_0x74da1b(0xc5)](_0x3468a8){const _0x1f9195=a37_0x74da1b;try{const _0x35da4b=jsonwebtoken_1[_0x1f9195(0xc3)][_0x1f9195(0xa8)](_0x3468a8,config_1[_0x1f9195(0xa4)][_0x1f9195(0xa7)][_0x1f9195(0xb3)]);return _0x35da4b;}catch(_0x50c754){throw new Error(_0x1f9195(0xaa));}}}exports['AuthService']=AuthService;