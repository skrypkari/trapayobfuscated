'use strict';const a36_0x1ccd8d=a36_0x1059;(function(_0x385256,_0x7db953){const _0xdc0848=a36_0x1059,_0x484efa=_0x385256();while(!![]){try{const _0x48ed98=parseInt(_0xdc0848(0x86))/0x1+parseInt(_0xdc0848(0x7e))/0x2+-parseInt(_0xdc0848(0x83))/0x3+-parseInt(_0xdc0848(0x85))/0x4*(-parseInt(_0xdc0848(0x8f))/0x5)+parseInt(_0xdc0848(0x7d))/0x6+parseInt(_0xdc0848(0x7c))/0x7*(parseInt(_0xdc0848(0x87))/0x8)+parseInt(_0xdc0848(0x95))/0x9*(-parseInt(_0xdc0848(0x82))/0xa);if(_0x48ed98===_0x7db953)break;else _0x484efa['push'](_0x484efa['shift']());}catch(_0x5c8f3a){_0x484efa['push'](_0x484efa['shift']());}}}(a36_0x4e7a,0x36a48));function a36_0x1059(_0x10678e,_0x1cbe63){const _0x4e7a6a=a36_0x4e7a();return a36_0x1059=function(_0x105912,_0x1dda74){_0x105912=_0x105912-0x7a;let _0x1e567d=_0x4e7a6a[_0x105912];return _0x1e567d;},a36_0x1059(_0x10678e,_0x1cbe63);}var __importDefault=this&&this[a36_0x1ccd8d(0x8d)]||function(_0x6a57e5){const _0x3a3b11=a36_0x1ccd8d;return _0x6a57e5&&_0x6a57e5[_0x3a3b11(0x8e)]?_0x6a57e5:{'default':_0x6a57e5};};Object[a36_0x1ccd8d(0x96)](exports,'__esModule',{'value':!![]}),exports[a36_0x1ccd8d(0x9b)]=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),jsonwebtoken_1=__importDefault(require(a36_0x1ccd8d(0x93))),database_1=__importDefault(require(a36_0x1ccd8d(0x89))),config_1=require(a36_0x1ccd8d(0x81));class AuthService{[a36_0x1ccd8d(0x8b)](_0x319bbe){const _0xbe4a1c=a36_0x1ccd8d;return jsonwebtoken_1[_0xbe4a1c(0x9d)][_0xbe4a1c(0x9c)](_0x319bbe,config_1[_0xbe4a1c(0x91)][_0xbe4a1c(0x92)]['secret'],{'expiresIn':String(config_1[_0xbe4a1c(0x91)][_0xbe4a1c(0x92)][_0xbe4a1c(0x9a)])});}async['login'](_0x4735a5){const _0x15c805=a36_0x1ccd8d,{username:_0xad53b6,password:_0x557ec0}=_0x4735a5;if(_0xad53b6===config_1['config']['admin'][_0x15c805(0x90)]){const _0x1989c8=await bcryptjs_1[_0x15c805(0x9d)][_0x15c805(0x7b)](_0x557ec0,config_1[_0x15c805(0x91)]['admin'][_0x15c805(0x8c)]);if(_0x1989c8){const _0xbcaae=this[_0x15c805(0x8b)]({'id':_0x15c805(0x7f),'username':config_1[_0x15c805(0x91)][_0x15c805(0x7f)]['username'],'role':_0x15c805(0x7f)});return{'access_token':_0xbcaae,'role':_0x15c805(0x7f)};}}const _0x1adb82=await database_1[_0x15c805(0x9d)][_0x15c805(0x8a)][_0x15c805(0x98)]({'where':{'username':_0xad53b6},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x1adb82)throw new Error('Invalid\x20credentials');if(_0x1adb82[_0x15c805(0x97)]!==_0x15c805(0x94))throw new Error(_0x15c805(0x88));const _0x321304=await bcryptjs_1[_0x15c805(0x9d)][_0x15c805(0x7b)](_0x557ec0,_0x1adb82['password']);if(!_0x321304)throw new Error(_0x15c805(0x7a));const _0x1254ce=this[_0x15c805(0x8b)]({'id':_0x1adb82['id'],'username':_0x1adb82[_0x15c805(0x90)],'role':'shop'});return{'access_token':_0x1254ce,'role':_0x15c805(0x8a),'user':{'id':_0x1adb82['id'],'name':_0x1adb82['name'],'username':_0x1adb82[_0x15c805(0x90)]}};}async[a36_0x1ccd8d(0x80)](_0xc0acc){const _0x5ea89d=a36_0x1ccd8d;try{const _0x32eae5=jsonwebtoken_1[_0x5ea89d(0x9d)][_0x5ea89d(0x99)](_0xc0acc,config_1[_0x5ea89d(0x91)]['jwt'][_0x5ea89d(0x84)]);return _0x32eae5;}catch(_0x47062c){throw new Error('Invalid\x20token');}}}exports[a36_0x1ccd8d(0x9b)]=AuthService;function a36_0x4e7a(){const _0x5cf9f5=['username','config','jwt','jsonwebtoken','ACTIVE','144KqfAbh','defineProperty','status','findUnique','verify','expiresIn','AuthService','sign','default','Invalid\x20credentials','compare','133tjxssX','765138BFjrgj','111972aVHSjU','admin','verifyToken','../config/config','143740jcqEbI','948975zebFFB','secret','176JKXnOO','192713gRkADp','17032vDVxVh','Account\x20is\x20not\x20active','../config/database','shop','generateToken','passwordHash','__importDefault','__esModule','40165JatVCx'];a36_0x4e7a=function(){return _0x5cf9f5;};return a36_0x4e7a();}