'use strict';const a36_0x1658d8=a36_0x428d;(function(_0x26a848,_0x8e5d88){const _0x43dd6f=a36_0x428d,_0x2f6e1e=_0x26a848();while(!![]){try{const _0x457d9b=-parseInt(_0x43dd6f(0xf6))/0x1+parseInt(_0x43dd6f(0x111))/0x2+-parseInt(_0x43dd6f(0x104))/0x3*(parseInt(_0x43dd6f(0xfc))/0x4)+-parseInt(_0x43dd6f(0x10d))/0x5+-parseInt(_0x43dd6f(0x116))/0x6*(-parseInt(_0x43dd6f(0x105))/0x7)+-parseInt(_0x43dd6f(0xfd))/0x8+parseInt(_0x43dd6f(0xfa))/0x9;if(_0x457d9b===_0x8e5d88)break;else _0x2f6e1e['push'](_0x2f6e1e['shift']());}catch(_0x525ed3){_0x2f6e1e['push'](_0x2f6e1e['shift']());}}}(a36_0x5798,0xa47ad));var __importDefault=this&&this['__importDefault']||function(_0x346c68){const _0x33e7b2=a36_0x428d;return _0x346c68&&_0x346c68[_0x33e7b2(0x101)]?_0x346c68:{'default':_0x346c68};};Object[a36_0x1658d8(0x119)](exports,a36_0x1658d8(0x101),{'value':!![]}),exports[a36_0x1658d8(0xf7)]=void 0x0;const bcryptjs_1=__importDefault(require(a36_0x1658d8(0x103))),jsonwebtoken_1=__importDefault(require(a36_0x1658d8(0x117))),database_1=__importDefault(require(a36_0x1658d8(0x112))),config_1=require(a36_0x1658d8(0x118));function a36_0x428d(_0x874dc2,_0x15c2c5){const _0x5798db=a36_0x5798();return a36_0x428d=function(_0x428d68,_0x327f53){_0x428d68=_0x428d68-0xf5;let _0x325497=_0x5798db[_0x428d68];return _0x325497;},a36_0x428d(_0x874dc2,_0x15c2c5);}class AuthService{[a36_0x1658d8(0xfe)](_0x327b89){const _0x525132=a36_0x1658d8;return jsonwebtoken_1[_0x525132(0x102)][_0x525132(0x106)](_0x327b89,config_1[_0x525132(0xf5)][_0x525132(0xff)]['secret'],{'expiresIn':String(config_1[_0x525132(0xf5)]['jwt'][_0x525132(0xf8)])});}async[a36_0x1658d8(0x107)](_0xcf5e39){const _0x4975c8=a36_0x1658d8,{username:_0x5adfba,password:_0x279047}=_0xcf5e39;if(_0x5adfba===config_1[_0x4975c8(0xf5)][_0x4975c8(0xf9)][_0x4975c8(0x110)]){const _0x39c6ac=await bcryptjs_1[_0x4975c8(0x102)]['compare'](_0x279047,config_1[_0x4975c8(0xf5)][_0x4975c8(0xf9)][_0x4975c8(0x10a)]);if(_0x39c6ac){const _0x520072=this[_0x4975c8(0xfe)]({'id':_0x4975c8(0xf9),'username':config_1[_0x4975c8(0xf5)][_0x4975c8(0xf9)][_0x4975c8(0x110)],'role':_0x4975c8(0xf9)});return{'access_token':_0x520072,'role':_0x4975c8(0xf9)};}}const _0x44e5d9=await database_1['default'][_0x4975c8(0x113)][_0x4975c8(0x10e)]({'where':{'username':_0x5adfba},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x44e5d9)throw new Error(_0x4975c8(0x10c));if(_0x44e5d9[_0x4975c8(0x11a)]!==_0x4975c8(0xfb))throw new Error(_0x4975c8(0x108));const _0x4ee659=await bcryptjs_1[_0x4975c8(0x102)][_0x4975c8(0x115)](_0x279047,_0x44e5d9[_0x4975c8(0x100)]);if(!_0x4ee659)throw new Error(_0x4975c8(0x10c));const _0x49fc6c=this[_0x4975c8(0xfe)]({'id':_0x44e5d9['id'],'username':_0x44e5d9[_0x4975c8(0x110)],'role':_0x4975c8(0x113)});return{'access_token':_0x49fc6c,'role':_0x4975c8(0x113),'user':{'id':_0x44e5d9['id'],'name':_0x44e5d9[_0x4975c8(0x10b)],'username':_0x44e5d9[_0x4975c8(0x110)]}};}async['verifyToken'](_0x26a2ef){const _0x264100=a36_0x1658d8;try{const _0x5c7f4f=jsonwebtoken_1[_0x264100(0x102)][_0x264100(0x10f)](_0x26a2ef,config_1[_0x264100(0xf5)]['jwt'][_0x264100(0x109)]);return _0x5c7f4f;}catch(_0x26a193){throw new Error(_0x264100(0x114));}}}function a36_0x5798(){const _0x28aec2=['Invalid\x20token','compare','1124328jkBuIf','jsonwebtoken','../config/config','defineProperty','status','config','549375MaYHvl','AuthService','expiresIn','admin','20515527ovOgmm','ACTIVE','139928PUtPsl','10506096EXZTCF','generateToken','jwt','password','__esModule','default','bcryptjs','3arGJOW','35BkAYLZ','sign','login','Account\x20is\x20not\x20active','secret','passwordHash','name','Invalid\x20credentials','6293885fMuscH','findUnique','verify','username','1227324ExOgmk','../config/database','shop'];a36_0x5798=function(){return _0x28aec2;};return a36_0x5798();}exports['AuthService']=AuthService;