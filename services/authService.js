'use strict';const a36_0x1e78ba=a36_0x3126;(function(_0x4dc5a3,_0xb1b0){const _0x131f24=a36_0x3126,_0x41b4af=_0x4dc5a3();while(!![]){try{const _0x398799=parseInt(_0x131f24(0x17c))/0x1*(parseInt(_0x131f24(0x174))/0x2)+-parseInt(_0x131f24(0x15c))/0x3+-parseInt(_0x131f24(0x160))/0x4*(-parseInt(_0x131f24(0x16d))/0x5)+-parseInt(_0x131f24(0x163))/0x6+-parseInt(_0x131f24(0x16a))/0x7+-parseInt(_0x131f24(0x15a))/0x8+parseInt(_0x131f24(0x16b))/0x9;if(_0x398799===_0xb1b0)break;else _0x41b4af['push'](_0x41b4af['shift']());}catch(_0xe107ef){_0x41b4af['push'](_0x41b4af['shift']());}}}(a36_0x263d,0x2c035));var __importDefault=this&&this['__importDefault']||function(_0x4b5455){const _0x135791=a36_0x3126;return _0x4b5455&&_0x4b5455[_0x135791(0x159)]?_0x4b5455:{'default':_0x4b5455};};Object[a36_0x1e78ba(0x176)](exports,a36_0x1e78ba(0x159),{'value':!![]}),exports[a36_0x1e78ba(0x161)]=void 0x0;function a36_0x263d(){const _0x394f80=['../config/config','1546986bowPhI','bcryptjs','config','default','admin','passwordHash','verify','180670wSYfVS','5873058WASwIg','secret','389085rdgsbu','generateToken','Invalid\x20credentials','Invalid\x20token','../config/database','ACTIVE','jsonwebtoken','1742lWXQbh','name','defineProperty','compare','expiresIn','jwt','status','verifyToken','233tfyrLk','username','__esModule','2066136AigXYY','login','866862ZrHuRB','sign','shop','Account\x20is\x20not\x20active','8ixSqwa','AuthService'];a36_0x263d=function(){return _0x394f80;};return a36_0x263d();}const bcryptjs_1=__importDefault(require(a36_0x1e78ba(0x164))),jsonwebtoken_1=__importDefault(require(a36_0x1e78ba(0x173))),database_1=__importDefault(require(a36_0x1e78ba(0x171))),config_1=require(a36_0x1e78ba(0x162));function a36_0x3126(_0x5ad9e7,_0x30a6c4){const _0x263dd2=a36_0x263d();return a36_0x3126=function(_0x312642,_0x3c1eda){_0x312642=_0x312642-0x159;let _0x166f8a=_0x263dd2[_0x312642];return _0x166f8a;},a36_0x3126(_0x5ad9e7,_0x30a6c4);}class AuthService{['generateToken'](_0x370c46){const _0x2444c7=a36_0x1e78ba;return jsonwebtoken_1[_0x2444c7(0x166)][_0x2444c7(0x15d)](_0x370c46,config_1[_0x2444c7(0x165)]['jwt']['secret'],{'expiresIn':String(config_1[_0x2444c7(0x165)][_0x2444c7(0x179)][_0x2444c7(0x178)])});}async[a36_0x1e78ba(0x15b)](_0x5c44cc){const _0x5743f1=a36_0x1e78ba,{username:_0x2975df,password:_0x9f975e}=_0x5c44cc;if(_0x2975df===config_1[_0x5743f1(0x165)][_0x5743f1(0x167)]['username']){const _0x4cfac7=await bcryptjs_1['default']['compare'](_0x9f975e,config_1[_0x5743f1(0x165)][_0x5743f1(0x167)][_0x5743f1(0x168)]);if(_0x4cfac7){const _0x3bf939=this[_0x5743f1(0x16e)]({'id':_0x5743f1(0x167),'username':config_1['config'][_0x5743f1(0x167)]['username'],'role':'admin'});return{'access_token':_0x3bf939,'role':_0x5743f1(0x167)};}}const _0x1bfd99=await database_1[_0x5743f1(0x166)]['shop']['findUnique']({'where':{'username':_0x2975df},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x1bfd99)throw new Error('Invalid\x20credentials');if(_0x1bfd99[_0x5743f1(0x17a)]!==_0x5743f1(0x172))throw new Error(_0x5743f1(0x15f));const _0x2a7432=await bcryptjs_1[_0x5743f1(0x166)][_0x5743f1(0x177)](_0x9f975e,_0x1bfd99['password']);if(!_0x2a7432)throw new Error(_0x5743f1(0x16f));const _0x531024=this[_0x5743f1(0x16e)]({'id':_0x1bfd99['id'],'username':_0x1bfd99['username'],'role':'shop'});return{'access_token':_0x531024,'role':_0x5743f1(0x15e),'user':{'id':_0x1bfd99['id'],'name':_0x1bfd99[_0x5743f1(0x175)],'username':_0x1bfd99[_0x5743f1(0x17d)]}};}async[a36_0x1e78ba(0x17b)](_0x33380f){const _0x2f02a4=a36_0x1e78ba;try{const _0x408069=jsonwebtoken_1[_0x2f02a4(0x166)][_0x2f02a4(0x169)](_0x33380f,config_1[_0x2f02a4(0x165)][_0x2f02a4(0x179)][_0x2f02a4(0x16c)]);return _0x408069;}catch(_0x502920){throw new Error(_0x2f02a4(0x170));}}}exports[a36_0x1e78ba(0x161)]=AuthService;