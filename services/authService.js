'use strict';function a36_0x2901(){const _0x1427df=['21866YjyCgJ','54230oilgsO','expiresIn','login','name','572985LigRcH','generateToken','config','Invalid\x20token','username','200xhGtwn','1724569FFFLRs','9dujqly','340644LCfmPj','compare','admin','../config/database','../config/config','1636120EBCIRA','defineProperty','jwt','shop','sign','219078cymesx','secret','status','__importDefault','AuthService','Invalid\x20credentials','__esModule','default','verifyToken','8awCbHW','ACTIVE','passwordHash','bcryptjs','25WMmrxq'];a36_0x2901=function(){return _0x1427df;};return a36_0x2901();}function a36_0x3a06(_0x52250d,_0x54cf39){const _0x290179=a36_0x2901();return a36_0x3a06=function(_0x3a067c,_0x48e2aa){_0x3a067c=_0x3a067c-0xba;let _0x40ff08=_0x290179[_0x3a067c];return _0x40ff08;},a36_0x3a06(_0x52250d,_0x54cf39);}const a36_0x4f7b5c=a36_0x3a06;(function(_0x3a8e22,_0x254dad){const _0xc120d6=a36_0x3a06,_0x1f4e81=_0x3a8e22();while(!![]){try{const _0x23b13a=parseInt(_0xc120d6(0xda))/0x1*(parseInt(_0xc120d6(0xd5))/0x2)+-parseInt(_0xc120d6(0xc1))/0x3*(parseInt(_0xc120d6(0xc2))/0x4)+-parseInt(_0xc120d6(0xd9))/0x5*(-parseInt(_0xc120d6(0xcc))/0x6)+-parseInt(_0xc120d6(0xc0))/0x7+parseInt(_0xc120d6(0xc7))/0x8+parseInt(_0xc120d6(0xba))/0x9+-parseInt(_0xc120d6(0xbf))/0xa*(-parseInt(_0xc120d6(0xdb))/0xb);if(_0x23b13a===_0x254dad)break;else _0x1f4e81['push'](_0x1f4e81['shift']());}catch(_0x16db01){_0x1f4e81['push'](_0x1f4e81['shift']());}}}(a36_0x2901,0x20f2f));var __importDefault=this&&this[a36_0x4f7b5c(0xcf)]||function(_0x261325){const _0x21455e=a36_0x4f7b5c;return _0x261325&&_0x261325[_0x21455e(0xd2)]?_0x261325:{'default':_0x261325};};Object[a36_0x4f7b5c(0xc8)](exports,'__esModule',{'value':!![]}),exports[a36_0x4f7b5c(0xd0)]=void 0x0;const bcryptjs_1=__importDefault(require(a36_0x4f7b5c(0xd8))),jsonwebtoken_1=__importDefault(require('jsonwebtoken')),database_1=__importDefault(require(a36_0x4f7b5c(0xc5))),config_1=require(a36_0x4f7b5c(0xc6));class AuthService{[a36_0x4f7b5c(0xbb)](_0x3c724e){const _0x49fb25=a36_0x4f7b5c;return jsonwebtoken_1[_0x49fb25(0xd3)][_0x49fb25(0xcb)](_0x3c724e,config_1[_0x49fb25(0xbc)]['jwt'][_0x49fb25(0xcd)],{'expiresIn':String(config_1[_0x49fb25(0xbc)][_0x49fb25(0xc9)][_0x49fb25(0xdc)])});}async[a36_0x4f7b5c(0xdd)](_0x40eee9){const _0x3f3ae2=a36_0x4f7b5c,{username:_0x4e5022,password:_0x3ffb41}=_0x40eee9;if(_0x4e5022===config_1[_0x3f3ae2(0xbc)]['admin']['username']){const _0x44540c=await bcryptjs_1['default']['compare'](_0x3ffb41,config_1[_0x3f3ae2(0xbc)][_0x3f3ae2(0xc4)][_0x3f3ae2(0xd7)]);if(_0x44540c){const _0x395748=this[_0x3f3ae2(0xbb)]({'id':'admin','username':config_1[_0x3f3ae2(0xbc)][_0x3f3ae2(0xc4)][_0x3f3ae2(0xbe)],'role':_0x3f3ae2(0xc4)});return{'access_token':_0x395748,'role':_0x3f3ae2(0xc4)};}}const _0x1b5aeb=await database_1['default'][_0x3f3ae2(0xca)]['findUnique']({'where':{'username':_0x4e5022},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x1b5aeb)throw new Error(_0x3f3ae2(0xd1));if(_0x1b5aeb[_0x3f3ae2(0xce)]!==_0x3f3ae2(0xd6))throw new Error('Account\x20is\x20not\x20active');const _0x539456=await bcryptjs_1[_0x3f3ae2(0xd3)][_0x3f3ae2(0xc3)](_0x3ffb41,_0x1b5aeb['password']);if(!_0x539456)throw new Error(_0x3f3ae2(0xd1));const _0x5d7be5=this[_0x3f3ae2(0xbb)]({'id':_0x1b5aeb['id'],'username':_0x1b5aeb[_0x3f3ae2(0xbe)],'role':_0x3f3ae2(0xca)});return{'access_token':_0x5d7be5,'role':'shop','user':{'id':_0x1b5aeb['id'],'name':_0x1b5aeb[_0x3f3ae2(0xde)],'username':_0x1b5aeb['username']}};}async[a36_0x4f7b5c(0xd4)](_0x11f9d3){const _0x18d9a8=a36_0x4f7b5c;try{const _0x539f0c=jsonwebtoken_1[_0x18d9a8(0xd3)]['verify'](_0x11f9d3,config_1[_0x18d9a8(0xbc)]['jwt'][_0x18d9a8(0xcd)]);return _0x539f0c;}catch(_0xdf5e7d){throw new Error(_0x18d9a8(0xbd));}}}exports[a36_0x4f7b5c(0xd0)]=AuthService;