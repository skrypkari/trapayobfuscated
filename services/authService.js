'use strict';const a47_0x3544d7=a47_0x4d3d;(function(_0x57b626,_0x35d0ac){const _0x2786dd=a47_0x4d3d,_0x17bc37=_0x57b626();while(!![]){try{const _0x335b3a=parseInt(_0x2786dd(0x1f7))/0x1*(-parseInt(_0x2786dd(0x215))/0x2)+-parseInt(_0x2786dd(0x20a))/0x3*(parseInt(_0x2786dd(0x217))/0x4)+parseInt(_0x2786dd(0x1fa))/0x5+parseInt(_0x2786dd(0x21a))/0x6*(-parseInt(_0x2786dd(0x208))/0x7)+parseInt(_0x2786dd(0x1ff))/0x8+parseInt(_0x2786dd(0x201))/0x9*(parseInt(_0x2786dd(0x206))/0xa)+-parseInt(_0x2786dd(0x1f4))/0xb*(parseInt(_0x2786dd(0x1f6))/0xc);if(_0x335b3a===_0x35d0ac)break;else _0x17bc37['push'](_0x17bc37['shift']());}catch(_0x500bb7){_0x17bc37['push'](_0x17bc37['shift']());}}}(a47_0x666c,0x3c419));function a47_0x666c(){const _0x1602a2=['AuthService','verifyToken','login','Account\x20is\x20not\x20active','passwordHash','generateToken','__esModule','174854WoJBpa','shop','874404yPEjMj','config','username','60nUMUlQ','71621EkDxpH','jsonwebtoken','300lsozQt','1OtXbMJ','password','../config/database','2030645zjVOKp','sign','status','admin','ACTIVE','2370264cWdiXL','defineProperty','9fhKoVp','expiresIn','../config/config','default','jwt','4515700xFNmyi','Invalid\x20credentials','306859ivOgYk','compare','3SbgLQH','verify','secret','findUnique'];a47_0x666c=function(){return _0x1602a2;};return a47_0x666c();}var __importDefault=this&&this['__importDefault']||function(_0x565745){const _0xde16b7=a47_0x4d3d;return _0x565745&&_0x565745[_0xde16b7(0x214)]?_0x565745:{'default':_0x565745};};Object[a47_0x3544d7(0x200)](exports,a47_0x3544d7(0x214),{'value':!![]}),exports[a47_0x3544d7(0x20e)]=void 0x0;function a47_0x4d3d(_0x346ba0,_0x373dcf){_0x346ba0=_0x346ba0-0x1f4;const _0x666ce6=a47_0x666c();let _0x4d3d5f=_0x666ce6[_0x346ba0];return _0x4d3d5f;}const bcryptjs_1=__importDefault(require('bcryptjs')),jsonwebtoken_1=__importDefault(require(a47_0x3544d7(0x1f5))),database_1=__importDefault(require(a47_0x3544d7(0x1f9))),config_1=require(a47_0x3544d7(0x203));class AuthService{['generateToken'](_0x43785e){const _0x20b1a9=a47_0x3544d7;return jsonwebtoken_1[_0x20b1a9(0x204)][_0x20b1a9(0x1fb)](_0x43785e,config_1[_0x20b1a9(0x218)][_0x20b1a9(0x205)]['secret'],{'expiresIn':String(config_1[_0x20b1a9(0x218)][_0x20b1a9(0x205)][_0x20b1a9(0x202)])});}async[a47_0x3544d7(0x210)](_0x512a6a){const _0x1bf99b=a47_0x3544d7,{username:_0x4091bf,password:_0x5a5797}=_0x512a6a;if(_0x4091bf===config_1[_0x1bf99b(0x218)][_0x1bf99b(0x1fd)][_0x1bf99b(0x219)]){const _0x556b1e=await bcryptjs_1['default'][_0x1bf99b(0x209)](_0x5a5797,config_1['config'][_0x1bf99b(0x1fd)][_0x1bf99b(0x212)]);if(_0x556b1e){const _0x12d762=this[_0x1bf99b(0x213)]({'id':_0x1bf99b(0x1fd),'username':config_1['config'][_0x1bf99b(0x1fd)][_0x1bf99b(0x219)],'role':_0x1bf99b(0x1fd)});return{'access_token':_0x12d762,'role':_0x1bf99b(0x1fd)};}}const _0x4f1522=await database_1[_0x1bf99b(0x204)]['shop'][_0x1bf99b(0x20d)]({'where':{'username':_0x4091bf},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x4f1522)throw new Error(_0x1bf99b(0x207));if(_0x4f1522[_0x1bf99b(0x1fc)]!==_0x1bf99b(0x1fe))throw new Error(_0x1bf99b(0x211));const _0x4061e3=await bcryptjs_1[_0x1bf99b(0x204)]['compare'](_0x5a5797,_0x4f1522[_0x1bf99b(0x1f8)]);if(!_0x4061e3)throw new Error(_0x1bf99b(0x207));const _0x164da6=this['generateToken']({'id':_0x4f1522['id'],'username':_0x4f1522[_0x1bf99b(0x219)],'role':'shop'});return{'access_token':_0x164da6,'role':_0x1bf99b(0x216),'user':{'id':_0x4f1522['id'],'name':_0x4f1522['name'],'username':_0x4f1522[_0x1bf99b(0x219)]}};}async[a47_0x3544d7(0x20f)](_0x413bba){const _0x261c2e=a47_0x3544d7;try{const _0x311cb2=jsonwebtoken_1['default'][_0x261c2e(0x20b)](_0x413bba,config_1['config'][_0x261c2e(0x205)][_0x261c2e(0x20c)]);return _0x311cb2;}catch(_0x34c4a5){throw new Error('Invalid\x20token');}}}exports['AuthService']=AuthService;