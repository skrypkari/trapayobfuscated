'use strict';const a34_0x2171c9=a34_0xe4ab;(function(_0x2ff557,_0x345d71){const _0x54b529=a34_0xe4ab,_0x790020=_0x2ff557();while(!![]){try{const _0x3088bb=parseInt(_0x54b529(0x177))/0x1*(-parseInt(_0x54b529(0x180))/0x2)+-parseInt(_0x54b529(0x17f))/0x3*(-parseInt(_0x54b529(0x15d))/0x4)+-parseInt(_0x54b529(0x16d))/0x5*(-parseInt(_0x54b529(0x176))/0x6)+parseInt(_0x54b529(0x160))/0x7+-parseInt(_0x54b529(0x166))/0x8*(parseInt(_0x54b529(0x17c))/0x9)+parseInt(_0x54b529(0x16f))/0xa+-parseInt(_0x54b529(0x15e))/0xb;if(_0x3088bb===_0x345d71)break;else _0x790020['push'](_0x790020['shift']());}catch(_0x5dc0d1){_0x790020['push'](_0x790020['shift']());}}}(a34_0x271d,0x79915));function a34_0x271d(){const _0x4221ea=['passwordHash','Account\x20is\x20not\x20active','generateToken','defineProperty','admin','config','26502AuHsWe','7uzCdAO','verify','jwt','jsonwebtoken','secret','34659JXYAyq','../config/database','findUnique','9iDllBE','75954lEXCag','ACTIVE','118072Pabyps','3606339SCvAFe','status','5021541nahxgr','sign','compare','Invalid\x20credentials','shop','AuthService','1816GGNbMT','default','__importDefault','../config/config','username','__esModule','expiresIn','905OyPdaq','bcryptjs','3604120LChSkR'];a34_0x271d=function(){return _0x4221ea;};return a34_0x271d();}function a34_0xe4ab(_0x362ddc,_0x39b038){const _0x271d03=a34_0x271d();return a34_0xe4ab=function(_0xe4abce,_0x341d02){_0xe4abce=_0xe4abce-0x15d;let _0x29b1a0=_0x271d03[_0xe4abce];return _0x29b1a0;},a34_0xe4ab(_0x362ddc,_0x39b038);}var __importDefault=this&&this[a34_0x2171c9(0x168)]||function(_0x2fdb9f){const _0x1aa879=a34_0x2171c9;return _0x2fdb9f&&_0x2fdb9f[_0x1aa879(0x16b)]?_0x2fdb9f:{'default':_0x2fdb9f};};Object[a34_0x2171c9(0x173)](exports,a34_0x2171c9(0x16b),{'value':!![]}),exports['AuthService']=void 0x0;const bcryptjs_1=__importDefault(require(a34_0x2171c9(0x16e))),jsonwebtoken_1=__importDefault(require(a34_0x2171c9(0x17a))),database_1=__importDefault(require(a34_0x2171c9(0x17d))),config_1=require(a34_0x2171c9(0x169));class AuthService{[a34_0x2171c9(0x172)](_0xba9b3b){const _0x157787=a34_0x2171c9;return jsonwebtoken_1[_0x157787(0x167)][_0x157787(0x161)](_0xba9b3b,config_1[_0x157787(0x175)]['jwt'][_0x157787(0x17b)],{'expiresIn':String(config_1['config'][_0x157787(0x179)][_0x157787(0x16c)])});}async['login'](_0x355b9c){const _0x59cd68=a34_0x2171c9,{username:_0x4c7afb,password:_0x185d28}=_0x355b9c;if(_0x4c7afb===config_1['config'][_0x59cd68(0x174)][_0x59cd68(0x16a)]){const _0x4171bb=await bcryptjs_1[_0x59cd68(0x167)][_0x59cd68(0x162)](_0x185d28,config_1[_0x59cd68(0x175)]['admin'][_0x59cd68(0x170)]);if(_0x4171bb){const _0xbc8bfe=this[_0x59cd68(0x172)]({'id':_0x59cd68(0x174),'username':config_1[_0x59cd68(0x175)][_0x59cd68(0x174)][_0x59cd68(0x16a)],'role':_0x59cd68(0x174)});return{'access_token':_0xbc8bfe,'role':_0x59cd68(0x174)};}}const _0x294f0c=await database_1[_0x59cd68(0x167)][_0x59cd68(0x164)][_0x59cd68(0x17e)]({'where':{'username':_0x4c7afb},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x294f0c)throw new Error('Invalid\x20credentials');if(_0x294f0c[_0x59cd68(0x15f)]!==_0x59cd68(0x181))throw new Error(_0x59cd68(0x171));const _0x521fb5=await bcryptjs_1[_0x59cd68(0x167)][_0x59cd68(0x162)](_0x185d28,_0x294f0c['password']);if(!_0x521fb5)throw new Error(_0x59cd68(0x163));const _0x4f2eea=this[_0x59cd68(0x172)]({'id':_0x294f0c['id'],'username':_0x294f0c[_0x59cd68(0x16a)],'role':_0x59cd68(0x164)});return{'access_token':_0x4f2eea,'role':_0x59cd68(0x164),'user':{'id':_0x294f0c['id'],'name':_0x294f0c['name'],'username':_0x294f0c[_0x59cd68(0x16a)]}};}async['verifyToken'](_0x1f2e3c){const _0x164b54=a34_0x2171c9;try{const _0xacc43=jsonwebtoken_1[_0x164b54(0x167)][_0x164b54(0x178)](_0x1f2e3c,config_1['config'][_0x164b54(0x179)][_0x164b54(0x17b)]);return _0xacc43;}catch(_0x37a42f){throw new Error('Invalid\x20token');}}}exports[a34_0x2171c9(0x165)]=AuthService;