'use strict';const a37_0x49f212=a37_0x2100;(function(_0x3ceec9,_0x2c736a){const _0x3d5e16=a37_0x2100,_0x3058de=_0x3ceec9();while(!![]){try{const _0x1202de=parseInt(_0x3d5e16(0xac))/0x1+-parseInt(_0x3d5e16(0xae))/0x2*(parseInt(_0x3d5e16(0xaf))/0x3)+-parseInt(_0x3d5e16(0x9c))/0x4*(parseInt(_0x3d5e16(0xb3))/0x5)+parseInt(_0x3d5e16(0xb2))/0x6+-parseInt(_0x3d5e16(0xa8))/0x7*(parseInt(_0x3d5e16(0xa6))/0x8)+-parseInt(_0x3d5e16(0xa9))/0x9*(parseInt(_0x3d5e16(0xab))/0xa)+-parseInt(_0x3d5e16(0xb5))/0xb*(-parseInt(_0x3d5e16(0xad))/0xc);if(_0x1202de===_0x2c736a)break;else _0x3058de['push'](_0x3058de['shift']());}catch(_0x2dfc2e){_0x3058de['push'](_0x3058de['shift']());}}}(a37_0x2f86,0x2b448));var __importDefault=this&&this[a37_0x49f212(0xa0)]||function(_0x4e06ab){return _0x4e06ab&&_0x4e06ab['__esModule']?_0x4e06ab:{'default':_0x4e06ab};};Object[a37_0x49f212(0xb6)](exports,'__esModule',{'value':!![]}),exports['AuthService']=void 0x0;const bcryptjs_1=__importDefault(require(a37_0x49f212(0xb7))),jsonwebtoken_1=__importDefault(require(a37_0x49f212(0xb0))),database_1=__importDefault(require(a37_0x49f212(0x97))),config_1=require(a37_0x49f212(0x92));function a37_0x2f86(){const _0x3da60f=['admin','2888sGZVJQ','status','2779SOKxfB','9aGcxby','name','426320EsrBWo','272368WClZcT','131460gUpDPU','552098zcPwoU','3hMkbEs','jsonwebtoken','expiresIn','1255956ZSLyAh','7715CUwgCf','default','451JufFbu','defineProperty','bcryptjs','verify','../config/config','config','Invalid\x20credentials','Invalid\x20token','login','../config/database','verifyToken','secret','username','generateToken','756apEcpk','ACTIVE','jwt','findUnique','__importDefault','Account\x20is\x20not\x20active','passwordHash','shop','password'];a37_0x2f86=function(){return _0x3da60f;};return a37_0x2f86();}class AuthService{[a37_0x49f212(0x9b)](_0x49b7f3){const _0x347408=a37_0x49f212;return jsonwebtoken_1[_0x347408(0xb4)]['sign'](_0x49b7f3,config_1[_0x347408(0x93)][_0x347408(0x9e)][_0x347408(0x99)],{'expiresIn':String(config_1[_0x347408(0x93)][_0x347408(0x9e)][_0x347408(0xb1)])});}async[a37_0x49f212(0x96)](_0x138dbf){const _0x44b0df=a37_0x49f212,{username:_0x11a3f3,password:_0x51be1a}=_0x138dbf;if(_0x11a3f3===config_1[_0x44b0df(0x93)][_0x44b0df(0xa5)][_0x44b0df(0x9a)]){const _0x40f10f=await bcryptjs_1[_0x44b0df(0xb4)]['compare'](_0x51be1a,config_1['config']['admin'][_0x44b0df(0xa2)]);if(_0x40f10f){const _0x606957=this[_0x44b0df(0x9b)]({'id':_0x44b0df(0xa5),'username':config_1[_0x44b0df(0x93)][_0x44b0df(0xa5)][_0x44b0df(0x9a)],'role':'admin'});return{'access_token':_0x606957,'role':'admin'};}}const _0x434ac5=await database_1[_0x44b0df(0xb4)]['shop'][_0x44b0df(0x9f)]({'where':{'username':_0x11a3f3},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x434ac5)throw new Error(_0x44b0df(0x94));if(_0x434ac5[_0x44b0df(0xa7)]!==_0x44b0df(0x9d))throw new Error(_0x44b0df(0xa1));const _0x3a4fa4=await bcryptjs_1[_0x44b0df(0xb4)]['compare'](_0x51be1a,_0x434ac5[_0x44b0df(0xa4)]);if(!_0x3a4fa4)throw new Error('Invalid\x20credentials');const _0x40995b=this[_0x44b0df(0x9b)]({'id':_0x434ac5['id'],'username':_0x434ac5['username'],'role':'shop'});return{'access_token':_0x40995b,'role':_0x44b0df(0xa3),'user':{'id':_0x434ac5['id'],'name':_0x434ac5[_0x44b0df(0xaa)],'username':_0x434ac5[_0x44b0df(0x9a)]}};}async[a37_0x49f212(0x98)](_0x5063a2){const _0x6537c0=a37_0x49f212;try{const _0x5a2355=jsonwebtoken_1[_0x6537c0(0xb4)][_0x6537c0(0x91)](_0x5063a2,config_1['config'][_0x6537c0(0x9e)][_0x6537c0(0x99)]);return _0x5a2355;}catch(_0xb50e97){throw new Error(_0x6537c0(0x95));}}}function a37_0x2100(_0x412805,_0x1ed94b){const _0x2f86e1=a37_0x2f86();return a37_0x2100=function(_0x2100fc,_0x18c2e8){_0x2100fc=_0x2100fc-0x91;let _0x4f44ed=_0x2f86e1[_0x2100fc];return _0x4f44ed;},a37_0x2100(_0x412805,_0x1ed94b);}exports['AuthService']=AuthService;