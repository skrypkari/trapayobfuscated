'use strict';const a41_0x34722b=a41_0x22bf;(function(_0x2eadae,_0xb8900e){const _0x52ff77=a41_0x22bf,_0x5a306a=_0x2eadae();while(!![]){try{const _0x578a98=parseInt(_0x52ff77(0x1fc))/0x1+-parseInt(_0x52ff77(0x1ea))/0x2*(-parseInt(_0x52ff77(0x201))/0x3)+-parseInt(_0x52ff77(0x1f2))/0x4*(parseInt(_0x52ff77(0x1ee))/0x5)+parseInt(_0x52ff77(0x1f7))/0x6+parseInt(_0x52ff77(0x1ff))/0x7*(parseInt(_0x52ff77(0x1f3))/0x8)+parseInt(_0x52ff77(0x1f9))/0x9*(parseInt(_0x52ff77(0x207))/0xa)+-parseInt(_0x52ff77(0x210))/0xb;if(_0x578a98===_0xb8900e)break;else _0x5a306a['push'](_0x5a306a['shift']());}catch(_0x1a3feb){_0x5a306a['push'](_0x5a306a['shift']());}}}(a41_0x405d,0x9e36e));function a41_0x405d(){const _0x22fce4=['784137ONsEOv','bcryptjs','AuthService','518231nhUPBo','../config/config','1469997JxiWjs','expiresIn','jsonwebtoken','default','generateToken','name','80svaTmc','config','Invalid\x20token','Invalid\x20credentials','username','verify','__esModule','shop','admin','27108587jGHOnW','../config/database','2JVJPIf','jwt','findUnique','ACTIVE','5945rJEgti','verifyToken','defineProperty','sign','88AxtAVk','16QTliCH','login','compare','Account\x20is\x20not\x20active','2854818Noacfi','password','1395693UhkMtl','secret','passwordHash'];a41_0x405d=function(){return _0x22fce4;};return a41_0x405d();}var __importDefault=this&&this['__importDefault']||function(_0x18da98){const _0x316ebd=a41_0x22bf;return _0x18da98&&_0x18da98[_0x316ebd(0x20d)]?_0x18da98:{'default':_0x18da98};};Object[a41_0x34722b(0x1f0)](exports,a41_0x34722b(0x20d),{'value':!![]}),exports[a41_0x34722b(0x1fe)]=void 0x0;function a41_0x22bf(_0xc24a58,_0x5088bf){const _0x405d00=a41_0x405d();return a41_0x22bf=function(_0x22bf25,_0x68c152){_0x22bf25=_0x22bf25-0x1e9;let _0x2071ad=_0x405d00[_0x22bf25];return _0x2071ad;},a41_0x22bf(_0xc24a58,_0x5088bf);}const bcryptjs_1=__importDefault(require(a41_0x34722b(0x1fd))),jsonwebtoken_1=__importDefault(require(a41_0x34722b(0x203))),database_1=__importDefault(require(a41_0x34722b(0x1e9))),config_1=require(a41_0x34722b(0x200));class AuthService{['generateToken'](_0x503188){const _0x3d4eab=a41_0x34722b;return jsonwebtoken_1[_0x3d4eab(0x204)][_0x3d4eab(0x1f1)](_0x503188,config_1[_0x3d4eab(0x208)][_0x3d4eab(0x1eb)][_0x3d4eab(0x1fa)],{'expiresIn':String(config_1[_0x3d4eab(0x208)]['jwt'][_0x3d4eab(0x202)])});}async[a41_0x34722b(0x1f4)](_0x191c70){const _0x5ddaff=a41_0x34722b,{username:_0x4dab8d,password:_0x4a615b}=_0x191c70;if(_0x4dab8d===config_1[_0x5ddaff(0x208)][_0x5ddaff(0x20f)][_0x5ddaff(0x20b)]){const _0x240f02=await bcryptjs_1['default'][_0x5ddaff(0x1f5)](_0x4a615b,config_1['config']['admin'][_0x5ddaff(0x1fb)]);if(_0x240f02){const _0x3825cb=this[_0x5ddaff(0x205)]({'id':'admin','username':config_1['config']['admin'][_0x5ddaff(0x20b)],'role':_0x5ddaff(0x20f)});return{'access_token':_0x3825cb,'role':_0x5ddaff(0x20f)};}}const _0x257707=await database_1[_0x5ddaff(0x204)]['shop'][_0x5ddaff(0x1ec)]({'where':{'username':_0x4dab8d},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x257707)throw new Error(_0x5ddaff(0x20a));if(_0x257707['status']!==_0x5ddaff(0x1ed))throw new Error(_0x5ddaff(0x1f6));const _0x37cdd3=await bcryptjs_1[_0x5ddaff(0x204)][_0x5ddaff(0x1f5)](_0x4a615b,_0x257707[_0x5ddaff(0x1f8)]);if(!_0x37cdd3)throw new Error('Invalid\x20credentials');const _0x4d4a75=this['generateToken']({'id':_0x257707['id'],'username':_0x257707[_0x5ddaff(0x20b)],'role':'shop'});return{'access_token':_0x4d4a75,'role':_0x5ddaff(0x20e),'user':{'id':_0x257707['id'],'name':_0x257707[_0x5ddaff(0x206)],'username':_0x257707[_0x5ddaff(0x20b)]}};}async[a41_0x34722b(0x1ef)](_0x4d6d0d){const _0x24d573=a41_0x34722b;try{const _0x29ccc3=jsonwebtoken_1[_0x24d573(0x204)][_0x24d573(0x20c)](_0x4d6d0d,config_1[_0x24d573(0x208)][_0x24d573(0x1eb)]['secret']);return _0x29ccc3;}catch(_0x46d9e9){throw new Error(_0x24d573(0x209));}}}exports['AuthService']=AuthService;