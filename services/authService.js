'use strict';const a37_0x382375=a37_0x4e5c;(function(_0x568449,_0x2220bb){const _0x49c5d3=a37_0x4e5c,_0x51a997=_0x568449();while(!![]){try{const _0x2d0713=-parseInt(_0x49c5d3(0xc3))/0x1+parseInt(_0x49c5d3(0xb6))/0x2*(parseInt(_0x49c5d3(0xac))/0x3)+parseInt(_0x49c5d3(0xb0))/0x4*(-parseInt(_0x49c5d3(0xb8))/0x5)+-parseInt(_0x49c5d3(0xb4))/0x6+parseInt(_0x49c5d3(0xcc))/0x7*(parseInt(_0x49c5d3(0xcd))/0x8)+-parseInt(_0x49c5d3(0xbb))/0x9*(parseInt(_0x49c5d3(0xae))/0xa)+-parseInt(_0x49c5d3(0xcb))/0xb*(-parseInt(_0x49c5d3(0xc5))/0xc);if(_0x2d0713===_0x2220bb)break;else _0x51a997['push'](_0x51a997['shift']());}catch(_0x5aed76){_0x51a997['push'](_0x51a997['shift']());}}}(a37_0x534c,0x4252b));var __importDefault=this&&this[a37_0x382375(0xb1)]||function(_0x357462){return _0x357462&&_0x357462['__esModule']?_0x357462:{'default':_0x357462};};function a37_0x534c(){const _0x5ac225=['config','passwordHash','admin','4066249IimwfM','259021sTBFLK','32enZVZr','username','3xiJASn','verify','10ZAYgJb','verifyToken','35048zerDlD','__importDefault','default','Invalid\x20token','304998WKRrXf','bcryptjs','865492qxTQHO','expiresIn','15mWdQsG','sign','Account\x20is\x20not\x20active','4216257rMExkZ','jwt','ACTIVE','shop','status','secret','Invalid\x20credentials','AuthService','502825RUtUVb','defineProperty','24mgRaUe','generateToken','../config/config'];a37_0x534c=function(){return _0x5ac225;};return a37_0x534c();}Object[a37_0x382375(0xc4)](exports,'__esModule',{'value':!![]}),exports[a37_0x382375(0xc2)]=void 0x0;const bcryptjs_1=__importDefault(require(a37_0x382375(0xb5))),jsonwebtoken_1=__importDefault(require('jsonwebtoken')),database_1=__importDefault(require('../config/database')),config_1=require(a37_0x382375(0xc7));class AuthService{[a37_0x382375(0xc6)](_0x177896){const _0x297279=a37_0x382375;return jsonwebtoken_1[_0x297279(0xb2)][_0x297279(0xb9)](_0x177896,config_1['config'][_0x297279(0xbc)][_0x297279(0xc0)],{'expiresIn':String(config_1['config'][_0x297279(0xbc)][_0x297279(0xb7)])});}async['login'](_0x4e2ad2){const _0x375e14=a37_0x382375,{username:_0x2db167,password:_0x29f95b}=_0x4e2ad2;if(_0x2db167===config_1[_0x375e14(0xc8)][_0x375e14(0xca)][_0x375e14(0xab)]){const _0x50c92b=await bcryptjs_1[_0x375e14(0xb2)]['compare'](_0x29f95b,config_1[_0x375e14(0xc8)][_0x375e14(0xca)][_0x375e14(0xc9)]);if(_0x50c92b){const _0x49bac9=this['generateToken']({'id':_0x375e14(0xca),'username':config_1[_0x375e14(0xc8)]['admin'][_0x375e14(0xab)],'role':_0x375e14(0xca)});return{'access_token':_0x49bac9,'role':_0x375e14(0xca)};}}const _0xa5a9=await database_1[_0x375e14(0xb2)][_0x375e14(0xbe)]['findUnique']({'where':{'username':_0x2db167},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0xa5a9)throw new Error(_0x375e14(0xc1));if(_0xa5a9[_0x375e14(0xbf)]!==_0x375e14(0xbd))throw new Error(_0x375e14(0xba));const _0x1d3588=await bcryptjs_1[_0x375e14(0xb2)]['compare'](_0x29f95b,_0xa5a9['password']);if(!_0x1d3588)throw new Error(_0x375e14(0xc1));const _0x465e85=this[_0x375e14(0xc6)]({'id':_0xa5a9['id'],'username':_0xa5a9['username'],'role':_0x375e14(0xbe)});return{'access_token':_0x465e85,'role':_0x375e14(0xbe),'user':{'id':_0xa5a9['id'],'name':_0xa5a9['name'],'username':_0xa5a9[_0x375e14(0xab)]}};}async[a37_0x382375(0xaf)](_0x3e5b78){const _0x39da0d=a37_0x382375;try{const _0x518ff5=jsonwebtoken_1[_0x39da0d(0xb2)][_0x39da0d(0xad)](_0x3e5b78,config_1[_0x39da0d(0xc8)][_0x39da0d(0xbc)][_0x39da0d(0xc0)]);return _0x518ff5;}catch(_0xc142b6){throw new Error(_0x39da0d(0xb3));}}}function a37_0x4e5c(_0x1b6d27,_0x294ae9){const _0x534c56=a37_0x534c();return a37_0x4e5c=function(_0x4e5c52,_0x56f693){_0x4e5c52=_0x4e5c52-0xab;let _0xdf3efd=_0x534c56[_0x4e5c52];return _0xdf3efd;},a37_0x4e5c(_0x1b6d27,_0x294ae9);}exports[a37_0x382375(0xc2)]=AuthService;