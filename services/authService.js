'use strict';const a36_0x31248c=a36_0x4919;(function(_0x2e8edc,_0x200a6a){const _0x46218d=a36_0x4919,_0x23569f=_0x2e8edc();while(!![]){try{const _0x39f5f8=parseInt(_0x46218d(0xad))/0x1*(parseInt(_0x46218d(0xb4))/0x2)+parseInt(_0x46218d(0xc0))/0x3*(-parseInt(_0x46218d(0xbd))/0x4)+parseInt(_0x46218d(0xb5))/0x5+-parseInt(_0x46218d(0xce))/0x6*(parseInt(_0x46218d(0xc2))/0x7)+parseInt(_0x46218d(0xc6))/0x8+parseInt(_0x46218d(0xcd))/0x9+-parseInt(_0x46218d(0xbf))/0xa*(parseInt(_0x46218d(0xbb))/0xb);if(_0x39f5f8===_0x200a6a)break;else _0x23569f['push'](_0x23569f['shift']());}catch(_0x5d3779){_0x23569f['push'](_0x23569f['shift']());}}}(a36_0x3c04,0x594d8));var __importDefault=this&&this[a36_0x31248c(0xbc)]||function(_0x24986d){const _0x2f6f87=a36_0x31248c;return _0x24986d&&_0x24986d[_0x2f6f87(0xaf)]?_0x24986d:{'default':_0x24986d};};Object[a36_0x31248c(0xcf)](exports,a36_0x31248c(0xaf),{'value':!![]}),exports[a36_0x31248c(0xca)]=void 0x0;const bcryptjs_1=__importDefault(require(a36_0x31248c(0xb8))),jsonwebtoken_1=__importDefault(require(a36_0x31248c(0xb3))),database_1=__importDefault(require('../config/database')),config_1=require(a36_0x31248c(0xcc));class AuthService{[a36_0x31248c(0xb9)](_0xff37bc){const _0x47ba3b=a36_0x31248c;return jsonwebtoken_1[_0x47ba3b(0xac)][_0x47ba3b(0xba)](_0xff37bc,config_1[_0x47ba3b(0xc3)][_0x47ba3b(0xc5)][_0x47ba3b(0xb2)],{'expiresIn':String(config_1[_0x47ba3b(0xc3)][_0x47ba3b(0xc5)][_0x47ba3b(0xc9)])});}async['login'](_0x4b0511){const _0x378f7d=a36_0x31248c,{username:_0x45ee01,password:_0x5dc77c}=_0x4b0511;if(_0x45ee01===config_1[_0x378f7d(0xc3)][_0x378f7d(0xc1)][_0x378f7d(0xc7)]){const _0x248e27=await bcryptjs_1['default'][_0x378f7d(0xc4)](_0x5dc77c,config_1[_0x378f7d(0xc3)][_0x378f7d(0xc1)]['passwordHash']);if(_0x248e27){const _0x579323=this[_0x378f7d(0xb9)]({'id':_0x378f7d(0xc1),'username':config_1[_0x378f7d(0xc3)][_0x378f7d(0xc1)]['username'],'role':_0x378f7d(0xc1)});return{'access_token':_0x579323,'role':'admin'};}}const _0x10a934=await database_1['default'][_0x378f7d(0xb1)][_0x378f7d(0xb7)]({'where':{'username':_0x45ee01},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x10a934)throw new Error(_0x378f7d(0xbe));if(_0x10a934[_0x378f7d(0xb0)]!==_0x378f7d(0xb6))throw new Error(_0x378f7d(0xd0));const _0x446b60=await bcryptjs_1[_0x378f7d(0xac)]['compare'](_0x5dc77c,_0x10a934[_0x378f7d(0xcb)]);if(!_0x446b60)throw new Error(_0x378f7d(0xbe));const _0x141296=this['generateToken']({'id':_0x10a934['id'],'username':_0x10a934[_0x378f7d(0xc7)],'role':_0x378f7d(0xb1)});return{'access_token':_0x141296,'role':'shop','user':{'id':_0x10a934['id'],'name':_0x10a934['name'],'username':_0x10a934[_0x378f7d(0xc7)]}};}async[a36_0x31248c(0xae)](_0x1eb635){const _0x1a03ef=a36_0x31248c;try{const _0x304f34=jsonwebtoken_1[_0x1a03ef(0xac)][_0x1a03ef(0xc8)](_0x1eb635,config_1[_0x1a03ef(0xc3)]['jwt'][_0x1a03ef(0xb2)]);return _0x304f34;}catch(_0x57210a){throw new Error('Invalid\x20token');}}}exports[a36_0x31248c(0xca)]=AuthService;function a36_0x4919(_0x388d72,_0x2009de){const _0x3c04ee=a36_0x3c04();return a36_0x4919=function(_0x491911,_0x236392){_0x491911=_0x491911-0xac;let _0x204ebd=_0x3c04ee[_0x491911];return _0x204ebd;},a36_0x4919(_0x388d72,_0x2009de);}function a36_0x3c04(){const _0x253469=['findUnique','bcryptjs','generateToken','sign','27665nCTOUh','__importDefault','424bbUxIT','Invalid\x20credentials','3830yrwkmc','6471ZMgzpR','admin','7fkWVXH','config','compare','jwt','5253944efadhy','username','verify','expiresIn','AuthService','password','../config/config','6510528xdQssI','3156018oTLtrK','defineProperty','Account\x20is\x20not\x20active','default','353019fiqMnE','verifyToken','__esModule','status','shop','secret','jsonwebtoken','2xDcijC','1752600PiKilZ','ACTIVE'];a36_0x3c04=function(){return _0x253469;};return a36_0x3c04();}