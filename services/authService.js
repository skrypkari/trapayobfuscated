'use strict';const a36_0x232922=a36_0x5c0f;function a36_0x5c0f(_0x1b8d9f,_0x5702b0){const _0x195cd6=a36_0x195c();return a36_0x5c0f=function(_0x5c0fea,_0x174dbf){_0x5c0fea=_0x5c0fea-0xfc;let _0x136388=_0x195cd6[_0x5c0fea];return _0x136388;},a36_0x5c0f(_0x1b8d9f,_0x5702b0);}(function(_0xd594e1,_0xf67801){const _0x260d6d=a36_0x5c0f,_0x4810ec=_0xd594e1();while(!![]){try{const _0x22fce7=-parseInt(_0x260d6d(0x119))/0x1*(parseInt(_0x260d6d(0x10c))/0x2)+-parseInt(_0x260d6d(0x104))/0x3+parseInt(_0x260d6d(0x103))/0x4*(-parseInt(_0x260d6d(0xfc))/0x5)+-parseInt(_0x260d6d(0x10d))/0x6*(-parseInt(_0x260d6d(0x101))/0x7)+-parseInt(_0x260d6d(0xfd))/0x8*(-parseInt(_0x260d6d(0x11d))/0x9)+-parseInt(_0x260d6d(0x118))/0xa+parseInt(_0x260d6d(0x115))/0xb;if(_0x22fce7===_0xf67801)break;else _0x4810ec['push'](_0x4810ec['shift']());}catch(_0x6c9d91){_0x4810ec['push'](_0x4810ec['shift']());}}}(a36_0x195c,0x860b1));var __importDefault=this&&this[a36_0x232922(0x111)]||function(_0x4f0583){const _0x51e3c2=a36_0x232922;return _0x4f0583&&_0x4f0583[_0x51e3c2(0x110)]?_0x4f0583:{'default':_0x4f0583};};Object[a36_0x232922(0x102)](exports,a36_0x232922(0x110),{'value':!![]}),exports['AuthService']=void 0x0;function a36_0x195c(){const _0x8451e1=['shop','admin','18ltjjNP','jwt','password','expiresIn','../config/database','46795dvhUZD','1696080sbnzpm','name','login','verify','119xxrRcd','defineProperty','68bCIYft','329262RoAWHQ','Invalid\x20credentials','Invalid\x20token','generateToken','compare','username','default','../config/config','64006SMrMvg','75618azHsSC','passwordHash','sign','__esModule','__importDefault','config','verifyToken','secret','11068024FzUiIp','AuthService','findUnique','3465120BfGFiF','15imKkNS','status'];a36_0x195c=function(){return _0x8451e1;};return a36_0x195c();}const bcryptjs_1=__importDefault(require('bcryptjs')),jsonwebtoken_1=__importDefault(require('jsonwebtoken')),database_1=__importDefault(require(a36_0x232922(0x121))),config_1=require(a36_0x232922(0x10b));class AuthService{[a36_0x232922(0x107)](_0x1aa0ce){const _0x2cab5c=a36_0x232922;return jsonwebtoken_1['default'][_0x2cab5c(0x10f)](_0x1aa0ce,config_1[_0x2cab5c(0x112)][_0x2cab5c(0x11e)][_0x2cab5c(0x114)],{'expiresIn':String(config_1[_0x2cab5c(0x112)][_0x2cab5c(0x11e)][_0x2cab5c(0x120)])});}async[a36_0x232922(0xff)](_0x19c346){const _0x21f3e9=a36_0x232922,{username:_0x4dcec9,password:_0x181f6a}=_0x19c346;if(_0x4dcec9===config_1[_0x21f3e9(0x112)]['admin']['username']){const _0x3cf1b1=await bcryptjs_1[_0x21f3e9(0x10a)][_0x21f3e9(0x108)](_0x181f6a,config_1[_0x21f3e9(0x112)][_0x21f3e9(0x11c)][_0x21f3e9(0x10e)]);if(_0x3cf1b1){const _0x11259d=this['generateToken']({'id':_0x21f3e9(0x11c),'username':config_1[_0x21f3e9(0x112)][_0x21f3e9(0x11c)][_0x21f3e9(0x109)],'role':_0x21f3e9(0x11c)});return{'access_token':_0x11259d,'role':_0x21f3e9(0x11c)};}}const _0xe891a3=await database_1['default']['shop'][_0x21f3e9(0x117)]({'where':{'username':_0x4dcec9},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0xe891a3)throw new Error(_0x21f3e9(0x105));if(_0xe891a3[_0x21f3e9(0x11a)]!=='ACTIVE')throw new Error('Account\x20is\x20not\x20active');const _0x405cc1=await bcryptjs_1[_0x21f3e9(0x10a)][_0x21f3e9(0x108)](_0x181f6a,_0xe891a3[_0x21f3e9(0x11f)]);if(!_0x405cc1)throw new Error(_0x21f3e9(0x105));const _0x458591=this[_0x21f3e9(0x107)]({'id':_0xe891a3['id'],'username':_0xe891a3['username'],'role':_0x21f3e9(0x11b)});return{'access_token':_0x458591,'role':_0x21f3e9(0x11b),'user':{'id':_0xe891a3['id'],'name':_0xe891a3[_0x21f3e9(0xfe)],'username':_0xe891a3[_0x21f3e9(0x109)]}};}async[a36_0x232922(0x113)](_0x16d3c7){const _0x234e2a=a36_0x232922;try{const _0x4f1704=jsonwebtoken_1[_0x234e2a(0x10a)][_0x234e2a(0x100)](_0x16d3c7,config_1[_0x234e2a(0x112)][_0x234e2a(0x11e)]['secret']);return _0x4f1704;}catch(_0x3fccb6){throw new Error(_0x234e2a(0x106));}}}exports[a36_0x232922(0x116)]=AuthService;