'use strict';const a49_0x3da76b=a49_0x20b3;(function(_0x22e45e,_0xa10bed){const _0xd1ae1f=a49_0x20b3,_0x19af0f=_0x22e45e();while(!![]){try{const _0x58e510=-parseInt(_0xd1ae1f(0x194))/0x1*(-parseInt(_0xd1ae1f(0x17f))/0x2)+parseInt(_0xd1ae1f(0x191))/0x3+-parseInt(_0xd1ae1f(0x183))/0x4+parseInt(_0xd1ae1f(0x182))/0x5+parseInt(_0xd1ae1f(0x190))/0x6*(parseInt(_0xd1ae1f(0x192))/0x7)+parseInt(_0xd1ae1f(0x178))/0x8+-parseInt(_0xd1ae1f(0x180))/0x9*(parseInt(_0xd1ae1f(0x195))/0xa);if(_0x58e510===_0xa10bed)break;else _0x19af0f['push'](_0x19af0f['shift']());}catch(_0x4abb94){_0x19af0f['push'](_0x19af0f['shift']());}}}(a49_0x2a66,0x96fd1));var __importDefault=this&&this[a49_0x3da76b(0x186)]||function(_0x17ae75){return _0x17ae75&&_0x17ae75['__esModule']?_0x17ae75:{'default':_0x17ae75};};function a49_0x20b3(_0x5d5116,_0x44eedc){_0x5d5116=_0x5d5116-0x173;const _0x2a664e=a49_0x2a66();let _0x20b372=_0x2a664e[_0x5d5116];return _0x20b372;}Object['defineProperty'](exports,a49_0x3da76b(0x173),{'value':!![]}),exports[a49_0x3da76b(0x18c)]=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),jsonwebtoken_1=__importDefault(require(a49_0x3da76b(0x18f))),database_1=__importDefault(require(a49_0x3da76b(0x174))),config_1=require(a49_0x3da76b(0x17a));class AuthService{['generateToken'](_0x3739f7){const _0x41d72f=a49_0x3da76b;return jsonwebtoken_1[_0x41d72f(0x181)][_0x41d72f(0x17e)](_0x3739f7,config_1[_0x41d72f(0x18a)][_0x41d72f(0x179)]['secret'],{'expiresIn':String(config_1[_0x41d72f(0x18a)][_0x41d72f(0x179)]['expiresIn'])});}async[a49_0x3da76b(0x18e)](_0x5f4f52){const _0x7e7471=a49_0x3da76b,{username:_0x226a30,password:_0x43c053}=_0x5f4f52;if(_0x226a30===config_1[_0x7e7471(0x18a)]['admin'][_0x7e7471(0x193)]){const _0xf5b890=await bcryptjs_1[_0x7e7471(0x181)][_0x7e7471(0x189)](_0x43c053,config_1[_0x7e7471(0x18a)][_0x7e7471(0x17d)][_0x7e7471(0x196)]);if(_0xf5b890){const _0x116620=this['generateToken']({'id':'admin','username':config_1[_0x7e7471(0x18a)][_0x7e7471(0x17d)][_0x7e7471(0x193)],'role':_0x7e7471(0x17d)});return{'access_token':_0x116620,'role':_0x7e7471(0x17d)};}}const _0x579c6b=await database_1[_0x7e7471(0x181)][_0x7e7471(0x18b)][_0x7e7471(0x17b)]({'where':{'username':_0x226a30},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x579c6b)throw new Error(_0x7e7471(0x184));if(_0x579c6b[_0x7e7471(0x18d)]!==_0x7e7471(0x177))throw new Error(_0x7e7471(0x176));const _0x1445ba=await bcryptjs_1[_0x7e7471(0x181)]['compare'](_0x43c053,_0x579c6b[_0x7e7471(0x197)]);if(!_0x1445ba)throw new Error(_0x7e7471(0x184));const _0x1b73f3=this[_0x7e7471(0x17c)]({'id':_0x579c6b['id'],'username':_0x579c6b[_0x7e7471(0x193)],'role':_0x7e7471(0x18b)});return{'access_token':_0x1b73f3,'role':'shop','user':{'id':_0x579c6b['id'],'name':_0x579c6b[_0x7e7471(0x188)],'username':_0x579c6b[_0x7e7471(0x193)]}};}async[a49_0x3da76b(0x198)](_0x2faf06){const _0xe7bee1=a49_0x3da76b;try{const _0x3a111f=jsonwebtoken_1['default'][_0xe7bee1(0x187)](_0x2faf06,config_1[_0xe7bee1(0x18a)][_0xe7bee1(0x179)][_0xe7bee1(0x185)]);return _0x3a111f;}catch(_0x504ef9){throw new Error(_0xe7bee1(0x175));}}}exports['AuthService']=AuthService;function a49_0x2a66(){const _0x17a032=['username','2nAGVBG','9070xCrRrc','passwordHash','password','verifyToken','__esModule','../config/database','Invalid\x20token','Account\x20is\x20not\x20active','ACTIVE','4989680ILArvr','jwt','../config/config','findUnique','generateToken','admin','sign','323526TJmsPg','24777POLdYx','default','4746050lDmqWf','1275068bbrEUh','Invalid\x20credentials','secret','__importDefault','verify','name','compare','config','shop','AuthService','status','login','jsonwebtoken','41970TSQpFk','1801233GeEOhH','938hmBIkf'];a49_0x2a66=function(){return _0x17a032;};return a49_0x2a66();}