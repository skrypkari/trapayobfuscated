'use strict';function a41_0x1798(){const _0x3fab87=['secret','25861905WhMauQ','847Nxmapg','username','../config/database','login','Invalid\x20token','Account\x20is\x20not\x20active','4360RSndfF','shop','49768uwnKIe','1347235EhBZDH','789210pkNNvQ','compare','sign','3668oXzNxU','status','bcryptjs','password','admin','__importDefault','config','3229953HHAohx','1981358proBmN','AuthService','generateToken','passwordHash','default','verifyToken','__esModule','Invalid\x20credentials','jwt','name'];a41_0x1798=function(){return _0x3fab87;};return a41_0x1798();}const a41_0x56d267=a41_0x4675;function a41_0x4675(_0x46250e,_0x7b30c9){const _0x17982b=a41_0x1798();return a41_0x4675=function(_0x467506,_0x328e2e){_0x467506=_0x467506-0x1a7;let _0x1d7f19=_0x17982b[_0x467506];return _0x1d7f19;},a41_0x4675(_0x46250e,_0x7b30c9);}(function(_0x3a471d,_0x400373){const _0x328eae=a41_0x4675,_0x597be2=_0x3a471d();while(!![]){try{const _0x39913f=parseInt(_0x328eae(0x1bc))/0x1+-parseInt(_0x328eae(0x1a7))/0x2+-parseInt(_0x328eae(0x1c7))/0x3+-parseInt(_0x328eae(0x1c0))/0x4*(parseInt(_0x328eae(0x1b9))/0x5)+parseInt(_0x328eae(0x1bd))/0x6+-parseInt(_0x328eae(0x1b3))/0x7*(parseInt(_0x328eae(0x1bb))/0x8)+parseInt(_0x328eae(0x1b2))/0x9;if(_0x39913f===_0x400373)break;else _0x597be2['push'](_0x597be2['shift']());}catch(_0x25331f){_0x597be2['push'](_0x597be2['shift']());}}}(a41_0x1798,0xb2dcc));var __importDefault=this&&this[a41_0x56d267(0x1c5)]||function(_0x2e2251){const _0x26f520=a41_0x56d267;return _0x2e2251&&_0x2e2251[_0x26f520(0x1ad)]?_0x2e2251:{'default':_0x2e2251};};Object['defineProperty'](exports,a41_0x56d267(0x1ad),{'value':!![]}),exports['AuthService']=void 0x0;const bcryptjs_1=__importDefault(require(a41_0x56d267(0x1c2))),jsonwebtoken_1=__importDefault(require('jsonwebtoken')),database_1=__importDefault(require(a41_0x56d267(0x1b5))),config_1=require('../config/config');class AuthService{[a41_0x56d267(0x1a9)](_0x28ec53){const _0x28ee1b=a41_0x56d267;return jsonwebtoken_1[_0x28ee1b(0x1ab)][_0x28ee1b(0x1bf)](_0x28ec53,config_1['config'][_0x28ee1b(0x1af)]['secret'],{'expiresIn':String(config_1[_0x28ee1b(0x1c6)][_0x28ee1b(0x1af)]['expiresIn'])});}async[a41_0x56d267(0x1b6)](_0x30d1ca){const _0x5ce0d2=a41_0x56d267,{username:_0x44525c,password:_0x14aeea}=_0x30d1ca;if(_0x44525c===config_1[_0x5ce0d2(0x1c6)][_0x5ce0d2(0x1c4)][_0x5ce0d2(0x1b4)]){const _0x1ef5f0=await bcryptjs_1[_0x5ce0d2(0x1ab)][_0x5ce0d2(0x1be)](_0x14aeea,config_1[_0x5ce0d2(0x1c6)][_0x5ce0d2(0x1c4)][_0x5ce0d2(0x1aa)]);if(_0x1ef5f0){const _0x46d6d0=this['generateToken']({'id':'admin','username':config_1[_0x5ce0d2(0x1c6)][_0x5ce0d2(0x1c4)][_0x5ce0d2(0x1b4)],'role':'admin'});return{'access_token':_0x46d6d0,'role':_0x5ce0d2(0x1c4)};}}const _0x2c0116=await database_1[_0x5ce0d2(0x1ab)][_0x5ce0d2(0x1ba)]['findUnique']({'where':{'username':_0x44525c},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x2c0116)throw new Error(_0x5ce0d2(0x1ae));if(_0x2c0116[_0x5ce0d2(0x1c1)]!=='ACTIVE')throw new Error(_0x5ce0d2(0x1b8));const _0x4fe238=await bcryptjs_1[_0x5ce0d2(0x1ab)][_0x5ce0d2(0x1be)](_0x14aeea,_0x2c0116[_0x5ce0d2(0x1c3)]);if(!_0x4fe238)throw new Error(_0x5ce0d2(0x1ae));const _0x16301b=this['generateToken']({'id':_0x2c0116['id'],'username':_0x2c0116['username'],'role':'shop'});return{'access_token':_0x16301b,'role':'shop','user':{'id':_0x2c0116['id'],'name':_0x2c0116[_0x5ce0d2(0x1b0)],'username':_0x2c0116[_0x5ce0d2(0x1b4)]}};}async[a41_0x56d267(0x1ac)](_0x48d6e6){const _0x40046c=a41_0x56d267;try{const _0x383a42=jsonwebtoken_1[_0x40046c(0x1ab)]['verify'](_0x48d6e6,config_1[_0x40046c(0x1c6)]['jwt'][_0x40046c(0x1b1)]);return _0x383a42;}catch(_0x52c3fb){throw new Error(_0x40046c(0x1b7));}}}exports[a41_0x56d267(0x1a8)]=AuthService;