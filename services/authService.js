'use strict';const a37_0x59e399=a37_0x2db7;(function(_0xbbf7fb,_0x2b8508){const _0xf92690=a37_0x2db7,_0x2fb3c5=_0xbbf7fb();while(!![]){try{const _0x1e7836=-parseInt(_0xf92690(0xe8))/0x1+-parseInt(_0xf92690(0xe4))/0x2+-parseInt(_0xf92690(0xeb))/0x3*(-parseInt(_0xf92690(0xdb))/0x4)+parseInt(_0xf92690(0xdc))/0x5+-parseInt(_0xf92690(0xe3))/0x6*(parseInt(_0xf92690(0xdf))/0x7)+parseInt(_0xf92690(0xf7))/0x8*(-parseInt(_0xf92690(0xe7))/0x9)+parseInt(_0xf92690(0xf2))/0xa;if(_0x1e7836===_0x2b8508)break;else _0x2fb3c5['push'](_0x2fb3c5['shift']());}catch(_0x5549d7){_0x2fb3c5['push'](_0x2fb3c5['shift']());}}}(a37_0x37fb,0x6b28e));var __importDefault=this&&this[a37_0x59e399(0xf0)]||function(_0x58ed0e){const _0x49330c=a37_0x59e399;return _0x58ed0e&&_0x58ed0e[_0x49330c(0xde)]?_0x58ed0e:{'default':_0x58ed0e};};Object['defineProperty'](exports,a37_0x59e399(0xde),{'value':!![]}),exports[a37_0x59e399(0xfc)]=void 0x0;const bcryptjs_1=__importDefault(require(a37_0x59e399(0xda))),jsonwebtoken_1=__importDefault(require('jsonwebtoken')),database_1=__importDefault(require('../config/database')),config_1=require(a37_0x59e399(0xf5));function a37_0x37fb(){const _0x4da689=['10369PBPoNT','expiresIn','name','9pzvzDR','shop','secret','username','Invalid\x20token','__importDefault','config','11895890szkbuq','generateToken','status','../config/config','jwt','2749728IckzTr','Invalid\x20credentials','verify','Account\x20is\x20not\x20active','sign','AuthService','bcryptjs','75948KJkvfN','630810BRjOMX','default','__esModule','250355nQgXGi','login','verifyToken','compare','42kJyjZZ','658692vcBiYP','admin','findUnique','9rgESIm'];a37_0x37fb=function(){return _0x4da689;};return a37_0x37fb();}function a37_0x2db7(_0x26ac70,_0x51ebe6){const _0x37fb32=a37_0x37fb();return a37_0x2db7=function(_0x2db7be,_0x347766){_0x2db7be=_0x2db7be-0xda;let _0x444b26=_0x37fb32[_0x2db7be];return _0x444b26;},a37_0x2db7(_0x26ac70,_0x51ebe6);}class AuthService{[a37_0x59e399(0xf3)](_0x5eca71){const _0x3d53b9=a37_0x59e399;return jsonwebtoken_1[_0x3d53b9(0xdd)][_0x3d53b9(0xfb)](_0x5eca71,config_1[_0x3d53b9(0xf1)][_0x3d53b9(0xf6)][_0x3d53b9(0xed)],{'expiresIn':String(config_1['config'][_0x3d53b9(0xf6)][_0x3d53b9(0xe9)])});}async[a37_0x59e399(0xe0)](_0x4c2d4a){const _0x37695a=a37_0x59e399,{username:_0x46cb9a,password:_0x5f225b}=_0x4c2d4a;if(_0x46cb9a===config_1[_0x37695a(0xf1)][_0x37695a(0xe5)][_0x37695a(0xee)]){const _0x36a907=await bcryptjs_1[_0x37695a(0xdd)]['compare'](_0x5f225b,config_1[_0x37695a(0xf1)]['admin']['passwordHash']);if(_0x36a907){const _0x231e09=this['generateToken']({'id':_0x37695a(0xe5),'username':config_1['config'][_0x37695a(0xe5)][_0x37695a(0xee)],'role':_0x37695a(0xe5)});return{'access_token':_0x231e09,'role':_0x37695a(0xe5)};}}const _0x1760fb=await database_1[_0x37695a(0xdd)][_0x37695a(0xec)][_0x37695a(0xe6)]({'where':{'username':_0x46cb9a},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x1760fb)throw new Error(_0x37695a(0xf8));if(_0x1760fb[_0x37695a(0xf4)]!=='ACTIVE')throw new Error(_0x37695a(0xfa));const _0x5981e8=await bcryptjs_1[_0x37695a(0xdd)][_0x37695a(0xe2)](_0x5f225b,_0x1760fb['password']);if(!_0x5981e8)throw new Error('Invalid\x20credentials');const _0x4d9ec2=this['generateToken']({'id':_0x1760fb['id'],'username':_0x1760fb[_0x37695a(0xee)],'role':'shop'});return{'access_token':_0x4d9ec2,'role':_0x37695a(0xec),'user':{'id':_0x1760fb['id'],'name':_0x1760fb[_0x37695a(0xea)],'username':_0x1760fb[_0x37695a(0xee)]}};}async[a37_0x59e399(0xe1)](_0x1c938e){const _0x30dd37=a37_0x59e399;try{const _0x4dfc6d=jsonwebtoken_1['default'][_0x30dd37(0xf9)](_0x1c938e,config_1[_0x30dd37(0xf1)][_0x30dd37(0xf6)][_0x30dd37(0xed)]);return _0x4dfc6d;}catch(_0x55ad79){throw new Error(_0x30dd37(0xef));}}}exports[a37_0x59e399(0xfc)]=AuthService;