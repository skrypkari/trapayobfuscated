'use strict';const a34_0x2d263c=a34_0x2eea;(function(_0x4da32e,_0x5c6720){const _0x4ff17d=a34_0x2eea,_0x2b5df2=_0x4da32e();while(!![]){try{const _0x237259=parseInt(_0x4ff17d(0x146))/0x1+-parseInt(_0x4ff17d(0x145))/0x2+-parseInt(_0x4ff17d(0x161))/0x3+-parseInt(_0x4ff17d(0x164))/0x4+-parseInt(_0x4ff17d(0x154))/0x5*(parseInt(_0x4ff17d(0x14d))/0x6)+-parseInt(_0x4ff17d(0x15c))/0x7+parseInt(_0x4ff17d(0x163))/0x8;if(_0x237259===_0x5c6720)break;else _0x2b5df2['push'](_0x2b5df2['shift']());}catch(_0x4de3fc){_0x2b5df2['push'](_0x2b5df2['shift']());}}}(a34_0x27ad,0xc2241));var __importDefault=this&&this[a34_0x2d263c(0x159)]||function(_0x2aa245){const _0x41af0b=a34_0x2d263c;return _0x2aa245&&_0x2aa245[_0x41af0b(0x15e)]?_0x2aa245:{'default':_0x2aa245};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a34_0x2d263c(0x158)]=void 0x0;function a34_0x2eea(_0x3c9395,_0x314782){const _0x27ad85=a34_0x27ad();return a34_0x2eea=function(_0x2eea26,_0x1fae64){_0x2eea26=_0x2eea26-0x142;let _0xf35fd7=_0x27ad85[_0x2eea26];return _0xf35fd7;},a34_0x2eea(_0x3c9395,_0x314782);}const bcryptjs_1=__importDefault(require(a34_0x2d263c(0x15f))),jsonwebtoken_1=__importDefault(require(a34_0x2d263c(0x15b))),database_1=__importDefault(require(a34_0x2d263c(0x152))),config_1=require('../config/config');class AuthService{[a34_0x2d263c(0x160)](_0x1a3320){const _0x44acd5=a34_0x2d263c;return jsonwebtoken_1[_0x44acd5(0x148)][_0x44acd5(0x15d)](_0x1a3320,config_1['config'][_0x44acd5(0x147)]['secret'],{'expiresIn':String(config_1['config']['jwt'][_0x44acd5(0x143)])});}async[a34_0x2d263c(0x14a)](_0x220edf){const _0x2f649f=a34_0x2d263c,{username:_0x3f7c0b,password:_0x58e185}=_0x220edf;if(_0x3f7c0b===config_1['config'][_0x2f649f(0x153)][_0x2f649f(0x155)]){const _0x5eac76=await bcryptjs_1[_0x2f649f(0x148)][_0x2f649f(0x14f)](_0x58e185,config_1[_0x2f649f(0x15a)][_0x2f649f(0x153)][_0x2f649f(0x14e)]);if(_0x5eac76){const _0x42c2ef=this['generateToken']({'id':_0x2f649f(0x153),'username':config_1[_0x2f649f(0x15a)][_0x2f649f(0x153)]['username'],'role':'admin'});return{'access_token':_0x42c2ef,'role':_0x2f649f(0x153)};}}const _0x53dfd4=await database_1['default'][_0x2f649f(0x150)][_0x2f649f(0x151)]({'where':{'username':_0x3f7c0b},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x53dfd4)throw new Error(_0x2f649f(0x162));if(_0x53dfd4[_0x2f649f(0x14c)]!==_0x2f649f(0x156))throw new Error(_0x2f649f(0x142));const _0x4c36c8=await bcryptjs_1[_0x2f649f(0x148)][_0x2f649f(0x14f)](_0x58e185,_0x53dfd4[_0x2f649f(0x144)]);if(!_0x4c36c8)throw new Error(_0x2f649f(0x162));const _0x5850e2=this[_0x2f649f(0x160)]({'id':_0x53dfd4['id'],'username':_0x53dfd4[_0x2f649f(0x155)],'role':_0x2f649f(0x150)});return{'access_token':_0x5850e2,'role':_0x2f649f(0x150),'user':{'id':_0x53dfd4['id'],'name':_0x53dfd4[_0x2f649f(0x157)],'username':_0x53dfd4[_0x2f649f(0x155)]}};}async['verifyToken'](_0xde615f){const _0x4551f8=a34_0x2d263c;try{const _0x325b01=jsonwebtoken_1[_0x4551f8(0x148)]['verify'](_0xde615f,config_1[_0x4551f8(0x15a)][_0x4551f8(0x147)][_0x4551f8(0x14b)]);return _0x325b01;}catch(_0x51e5b3){throw new Error(_0x4551f8(0x149));}}}exports[a34_0x2d263c(0x158)]=AuthService;function a34_0x27ad(){const _0xae6dbd=['1093744ImcGwm','jwt','default','Invalid\x20token','login','secret','status','9001116JikZkg','passwordHash','compare','shop','findUnique','../config/database','admin','5caUNOr','username','ACTIVE','name','AuthService','__importDefault','config','jsonwebtoken','355453rxDbab','sign','__esModule','bcryptjs','generateToken','4689528WRIMFE','Invalid\x20credentials','37035664ZzENEL','2642252SilcgB','Account\x20is\x20not\x20active','expiresIn','password','2306594SAeWKd'];a34_0x27ad=function(){return _0xae6dbd;};return a34_0x27ad();}