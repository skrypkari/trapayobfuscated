'use strict';const a36_0x27936b=a36_0x512b;(function(_0x5cc873,_0xf8fdd8){const _0x44edca=a36_0x512b,_0x5b2cf8=_0x5cc873();while(!![]){try{const _0x471a42=-parseInt(_0x44edca(0x19e))/0x1*(-parseInt(_0x44edca(0x19c))/0x2)+-parseInt(_0x44edca(0x19a))/0x3+parseInt(_0x44edca(0x18b))/0x4+-parseInt(_0x44edca(0x1a8))/0x5*(-parseInt(_0x44edca(0x1a6))/0x6)+-parseInt(_0x44edca(0x1a0))/0x7*(-parseInt(_0x44edca(0x1a4))/0x8)+parseInt(_0x44edca(0x18f))/0x9+-parseInt(_0x44edca(0x19d))/0xa;if(_0x471a42===_0xf8fdd8)break;else _0x5b2cf8['push'](_0x5b2cf8['shift']());}catch(_0x30b3da){_0x5b2cf8['push'](_0x5b2cf8['shift']());}}}(a36_0x25b1,0x7c778));var __importDefault=this&&this[a36_0x27936b(0x193)]||function(_0x2c8255){return _0x2c8255&&_0x2c8255['__esModule']?_0x2c8255:{'default':_0x2c8255};};function a36_0x512b(_0x25dc21,_0x4ac178){const _0x25b12b=a36_0x25b1();return a36_0x512b=function(_0x512b87,_0x16f8a2){_0x512b87=_0x512b87-0x184;let _0x29f715=_0x25b12b[_0x512b87];return _0x29f715;},a36_0x512b(_0x25dc21,_0x4ac178);}Object[a36_0x27936b(0x184)](exports,a36_0x27936b(0x189),{'value':!![]}),exports[a36_0x27936b(0x186)]=void 0x0;const bcryptjs_1=__importDefault(require(a36_0x27936b(0x185))),jsonwebtoken_1=__importDefault(require(a36_0x27936b(0x1a3))),database_1=__importDefault(require('../config/database')),config_1=require(a36_0x27936b(0x195));class AuthService{['generateToken'](_0x17466a){const _0x4d3430=a36_0x27936b;return jsonwebtoken_1[_0x4d3430(0x1a7)]['sign'](_0x17466a,config_1['config'][_0x4d3430(0x191)][_0x4d3430(0x19b)],{'expiresIn':String(config_1[_0x4d3430(0x18a)][_0x4d3430(0x191)][_0x4d3430(0x194)])});}async[a36_0x27936b(0x192)](_0x4c2549){const _0x2cd47b=a36_0x27936b,{username:_0x1ed4d1,password:_0x102590}=_0x4c2549;if(_0x1ed4d1===config_1[_0x2cd47b(0x18a)]['admin'][_0x2cd47b(0x1a2)]){const _0x1873ff=await bcryptjs_1[_0x2cd47b(0x1a7)][_0x2cd47b(0x187)](_0x102590,config_1[_0x2cd47b(0x18a)]['admin'][_0x2cd47b(0x18c)]);if(_0x1873ff){const _0x5c0fdd=this['generateToken']({'id':'admin','username':config_1['config']['admin'][_0x2cd47b(0x1a2)],'role':_0x2cd47b(0x18d)});return{'access_token':_0x5c0fdd,'role':_0x2cd47b(0x18d)};}}const _0x8304b8=await database_1[_0x2cd47b(0x1a7)][_0x2cd47b(0x19f)][_0x2cd47b(0x18e)]({'where':{'username':_0x1ed4d1},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x8304b8)throw new Error(_0x2cd47b(0x198));if(_0x8304b8[_0x2cd47b(0x1a5)]!=='ACTIVE')throw new Error(_0x2cd47b(0x190));const _0x29b0a1=await bcryptjs_1[_0x2cd47b(0x1a7)][_0x2cd47b(0x187)](_0x102590,_0x8304b8[_0x2cd47b(0x196)]);if(!_0x29b0a1)throw new Error(_0x2cd47b(0x198));const _0x55c66a=this[_0x2cd47b(0x199)]({'id':_0x8304b8['id'],'username':_0x8304b8['username'],'role':_0x2cd47b(0x19f)});return{'access_token':_0x55c66a,'role':_0x2cd47b(0x19f),'user':{'id':_0x8304b8['id'],'name':_0x8304b8[_0x2cd47b(0x1a1)],'username':_0x8304b8[_0x2cd47b(0x1a2)]}};}async['verifyToken'](_0x28ed9d){const _0x23ba3d=a36_0x27936b;try{const _0xf81872=jsonwebtoken_1[_0x23ba3d(0x1a7)][_0x23ba3d(0x197)](_0x28ed9d,config_1[_0x23ba3d(0x18a)][_0x23ba3d(0x191)][_0x23ba3d(0x19b)]);return _0xf81872;}catch(_0xdfcce7){throw new Error(_0x23ba3d(0x188));}}}exports[a36_0x27936b(0x186)]=AuthService;function a36_0x25b1(){const _0x1f32d5=['8QPlXgs','status','66tbYLCp','default','65115vgxBBa','defineProperty','bcryptjs','AuthService','compare','Invalid\x20token','__esModule','config','1854776ImKEeT','passwordHash','admin','findUnique','5014647CpdmcF','Account\x20is\x20not\x20active','jwt','login','__importDefault','expiresIn','../config/config','password','verify','Invalid\x20credentials','generateToken','1049400JiamZR','secret','198LkKEGU','15597090RvjbaG','5531EbOxkk','shop','4953382eNGxWc','name','username','jsonwebtoken'];a36_0x25b1=function(){return _0x1f32d5;};return a36_0x25b1();}