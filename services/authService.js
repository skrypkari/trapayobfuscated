'use strict';const a37_0xdd2877=a37_0x4b43;function a37_0x4b43(_0x2dce66,_0x36c6eb){const _0x549a5b=a37_0x549a();return a37_0x4b43=function(_0x4b43d3,_0x59d84f){_0x4b43d3=_0x4b43d3-0x85;let _0x4f0c1d=_0x549a5b[_0x4b43d3];return _0x4f0c1d;},a37_0x4b43(_0x2dce66,_0x36c6eb);}(function(_0x137b81,_0x528288){const _0x322286=a37_0x4b43,_0x186996=_0x137b81();while(!![]){try{const _0x515806=-parseInt(_0x322286(0xa3))/0x1+-parseInt(_0x322286(0xa8))/0x2*(-parseInt(_0x322286(0xa5))/0x3)+parseInt(_0x322286(0x94))/0x4+parseInt(_0x322286(0x93))/0x5+-parseInt(_0x322286(0x8c))/0x6+parseInt(_0x322286(0x91))/0x7+-parseInt(_0x322286(0xa1))/0x8;if(_0x515806===_0x528288)break;else _0x186996['push'](_0x186996['shift']());}catch(_0x1dbda1){_0x186996['push'](_0x186996['shift']());}}}(a37_0x549a,0xdb3c8));var __importDefault=this&&this[a37_0xdd2877(0x8b)]||function(_0x490bfc){const _0x4e1a44=a37_0xdd2877;return _0x490bfc&&_0x490bfc[_0x4e1a44(0x92)]?_0x490bfc:{'default':_0x490bfc};};Object[a37_0xdd2877(0x85)](exports,'__esModule',{'value':!![]}),exports[a37_0xdd2877(0xa9)]=void 0x0;function a37_0x549a(){const _0x3f6725=['login','expiresIn','../config/config','8159207gctkxk','__esModule','4486270olbgOb','5273496igwjIQ','password','username','jsonwebtoken','name','../config/database','compare','Invalid\x20credentials','status','verifyToken','shop','secret','Account\x20is\x20not\x20active','15090536xvRubx','default','135401advBsn','admin','49332FWFLMB','findUnique','generateToken','120MlTEQL','AuthService','defineProperty','bcryptjs','config','verify','ACTIVE','passwordHash','__importDefault','8688954xUpWfE','jwt'];a37_0x549a=function(){return _0x3f6725;};return a37_0x549a();}const bcryptjs_1=__importDefault(require(a37_0xdd2877(0x86))),jsonwebtoken_1=__importDefault(require(a37_0xdd2877(0x97))),database_1=__importDefault(require(a37_0xdd2877(0x99))),config_1=require(a37_0xdd2877(0x90));class AuthService{[a37_0xdd2877(0xa7)](_0x38d921){const _0x180930=a37_0xdd2877;return jsonwebtoken_1[_0x180930(0xa2)]['sign'](_0x38d921,config_1['config'][_0x180930(0x8d)]['secret'],{'expiresIn':String(config_1['config'][_0x180930(0x8d)][_0x180930(0x8f)])});}async[a37_0xdd2877(0x8e)](_0x20b016){const _0x24949a=a37_0xdd2877,{username:_0x295fa4,password:_0x235e0f}=_0x20b016;if(_0x295fa4===config_1['config'][_0x24949a(0xa4)]['username']){const _0x48c0d6=await bcryptjs_1[_0x24949a(0xa2)][_0x24949a(0x9a)](_0x235e0f,config_1[_0x24949a(0x87)][_0x24949a(0xa4)][_0x24949a(0x8a)]);if(_0x48c0d6){const _0x336429=this[_0x24949a(0xa7)]({'id':_0x24949a(0xa4),'username':config_1[_0x24949a(0x87)][_0x24949a(0xa4)][_0x24949a(0x96)],'role':_0x24949a(0xa4)});return{'access_token':_0x336429,'role':_0x24949a(0xa4)};}}const _0x11e41e=await database_1['default'][_0x24949a(0x9e)][_0x24949a(0xa6)]({'where':{'username':_0x295fa4},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x11e41e)throw new Error(_0x24949a(0x9b));if(_0x11e41e[_0x24949a(0x9c)]!==_0x24949a(0x89))throw new Error(_0x24949a(0xa0));const _0x284ca0=await bcryptjs_1[_0x24949a(0xa2)][_0x24949a(0x9a)](_0x235e0f,_0x11e41e[_0x24949a(0x95)]);if(!_0x284ca0)throw new Error('Invalid\x20credentials');const _0x32bec6=this[_0x24949a(0xa7)]({'id':_0x11e41e['id'],'username':_0x11e41e['username'],'role':_0x24949a(0x9e)});return{'access_token':_0x32bec6,'role':_0x24949a(0x9e),'user':{'id':_0x11e41e['id'],'name':_0x11e41e[_0x24949a(0x98)],'username':_0x11e41e['username']}};}async[a37_0xdd2877(0x9d)](_0x21c56a){const _0x53264c=a37_0xdd2877;try{const _0x4d2d87=jsonwebtoken_1[_0x53264c(0xa2)][_0x53264c(0x88)](_0x21c56a,config_1['config']['jwt'][_0x53264c(0x9f)]);return _0x4d2d87;}catch(_0x492a3f){throw new Error('Invalid\x20token');}}}exports[a37_0xdd2877(0xa9)]=AuthService;