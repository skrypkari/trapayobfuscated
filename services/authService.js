'use strict';const a36_0x4adc12=a36_0x1b58;(function(_0x4b84cb,_0x321c7a){const _0x445c52=a36_0x1b58,_0x3ba997=_0x4b84cb();while(!![]){try{const _0x4e0b0c=-parseInt(_0x445c52(0xfd))/0x1*(-parseInt(_0x445c52(0x10b))/0x2)+-parseInt(_0x445c52(0x111))/0x3*(-parseInt(_0x445c52(0x104))/0x4)+-parseInt(_0x445c52(0x109))/0x5*(-parseInt(_0x445c52(0x116))/0x6)+parseInt(_0x445c52(0x103))/0x7*(parseInt(_0x445c52(0x10e))/0x8)+-parseInt(_0x445c52(0x117))/0x9*(-parseInt(_0x445c52(0xfb))/0xa)+-parseInt(_0x445c52(0x107))/0xb+-parseInt(_0x445c52(0x11d))/0xc;if(_0x4e0b0c===_0x321c7a)break;else _0x3ba997['push'](_0x3ba997['shift']());}catch(_0x31ffd7){_0x3ba997['push'](_0x3ba997['shift']());}}}(a36_0x2bcb,0x42473));function a36_0x2bcb(){const _0xea00f9=['1852455VIyQhV','generateToken','5ZtkxCG','password','4406zOQQlk','status','__esModule','976OqHVGC','username','sign','15vlqQam','__importDefault','verify','login','name','435102SkDFvF','95067nKVbVH','compare','Invalid\x20credentials','secret','config','Invalid\x20token','4110084EfbWyN','../config/config','verifyToken','50sHeTHo','jwt','139YqKfvT','admin','shop','AuthService','jsonwebtoken','../config/database','7483AGUuWr','176336lJxTEr','defineProperty','default'];a36_0x2bcb=function(){return _0xea00f9;};return a36_0x2bcb();}function a36_0x1b58(_0x379c9a,_0x1d9d52){const _0x2bcba6=a36_0x2bcb();return a36_0x1b58=function(_0x1b58c4,_0x4f4a90){_0x1b58c4=_0x1b58c4-0xfa;let _0x1652ff=_0x2bcba6[_0x1b58c4];return _0x1652ff;},a36_0x1b58(_0x379c9a,_0x1d9d52);}var __importDefault=this&&this[a36_0x4adc12(0x112)]||function(_0x160bcf){const _0x131bb8=a36_0x4adc12;return _0x160bcf&&_0x160bcf[_0x131bb8(0x10d)]?_0x160bcf:{'default':_0x160bcf};};Object[a36_0x4adc12(0x105)](exports,'__esModule',{'value':!![]}),exports['AuthService']=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),jsonwebtoken_1=__importDefault(require(a36_0x4adc12(0x101))),database_1=__importDefault(require(a36_0x4adc12(0x102))),config_1=require(a36_0x4adc12(0x11e));class AuthService{[a36_0x4adc12(0x108)](_0x2f5a5a){const _0x325328=a36_0x4adc12;return jsonwebtoken_1[_0x325328(0x106)][_0x325328(0x110)](_0x2f5a5a,config_1['config'][_0x325328(0xfc)][_0x325328(0x11a)],{'expiresIn':String(config_1[_0x325328(0x11b)][_0x325328(0xfc)]['expiresIn'])});}async[a36_0x4adc12(0x114)](_0x3d8ef0){const _0x5ef6bd=a36_0x4adc12,{username:_0x2912ad,password:_0x38c318}=_0x3d8ef0;if(_0x2912ad===config_1[_0x5ef6bd(0x11b)][_0x5ef6bd(0xfe)][_0x5ef6bd(0x10f)]){const _0x1bc5a6=await bcryptjs_1[_0x5ef6bd(0x106)]['compare'](_0x38c318,config_1[_0x5ef6bd(0x11b)][_0x5ef6bd(0xfe)]['passwordHash']);if(_0x1bc5a6){const _0x2df555=this[_0x5ef6bd(0x108)]({'id':_0x5ef6bd(0xfe),'username':config_1[_0x5ef6bd(0x11b)][_0x5ef6bd(0xfe)][_0x5ef6bd(0x10f)],'role':_0x5ef6bd(0xfe)});return{'access_token':_0x2df555,'role':_0x5ef6bd(0xfe)};}}const _0x3f21ec=await database_1[_0x5ef6bd(0x106)][_0x5ef6bd(0xff)]['findUnique']({'where':{'username':_0x2912ad},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x3f21ec)throw new Error(_0x5ef6bd(0x119));if(_0x3f21ec[_0x5ef6bd(0x10c)]!=='ACTIVE')throw new Error('Account\x20is\x20not\x20active');const _0x4f7e88=await bcryptjs_1['default'][_0x5ef6bd(0x118)](_0x38c318,_0x3f21ec[_0x5ef6bd(0x10a)]);if(!_0x4f7e88)throw new Error(_0x5ef6bd(0x119));const _0x3d6c1a=this[_0x5ef6bd(0x108)]({'id':_0x3f21ec['id'],'username':_0x3f21ec[_0x5ef6bd(0x10f)],'role':'shop'});return{'access_token':_0x3d6c1a,'role':'shop','user':{'id':_0x3f21ec['id'],'name':_0x3f21ec[_0x5ef6bd(0x115)],'username':_0x3f21ec[_0x5ef6bd(0x10f)]}};}async[a36_0x4adc12(0xfa)](_0x232e7b){const _0x5591d4=a36_0x4adc12;try{const _0x24c87=jsonwebtoken_1[_0x5591d4(0x106)][_0x5591d4(0x113)](_0x232e7b,config_1[_0x5591d4(0x11b)][_0x5591d4(0xfc)][_0x5591d4(0x11a)]);return _0x24c87;}catch(_0x1b7496){throw new Error(_0x5591d4(0x11c));}}}exports[a36_0x4adc12(0x100)]=AuthService;