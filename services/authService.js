'use strict';const a34_0x48814a=a34_0xfbe9;(function(_0xe26086,_0x4920d5){const _0x2412cc=a34_0xfbe9,_0x5cd97e=_0xe26086();while(!![]){try{const _0x345a5c=-parseInt(_0x2412cc(0x191))/0x1*(parseInt(_0x2412cc(0x19a))/0x2)+-parseInt(_0x2412cc(0x19f))/0x3+-parseInt(_0x2412cc(0x18d))/0x4*(-parseInt(_0x2412cc(0x1aa))/0x5)+-parseInt(_0x2412cc(0x18f))/0x6+-parseInt(_0x2412cc(0x1a8))/0x7+parseInt(_0x2412cc(0x19c))/0x8+parseInt(_0x2412cc(0x194))/0x9*(parseInt(_0x2412cc(0x1ab))/0xa);if(_0x345a5c===_0x4920d5)break;else _0x5cd97e['push'](_0x5cd97e['shift']());}catch(_0x188dca){_0x5cd97e['push'](_0x5cd97e['shift']());}}}(a34_0xb990,0x41e8d));function a34_0xfbe9(_0x27216d,_0x5ca3e4){const _0xb990b1=a34_0xb990();return a34_0xfbe9=function(_0xfbe98d,_0x3800d2){_0xfbe98d=_0xfbe98d-0x18d;let _0xaf91f5=_0xb990b1[_0xfbe98d];return _0xaf91f5;},a34_0xfbe9(_0x27216d,_0x5ca3e4);}var __importDefault=this&&this[a34_0x48814a(0x196)]||function(_0x4188f2){const _0x1cef44=a34_0x48814a;return _0x4188f2&&_0x4188f2[_0x1cef44(0x18e)]?_0x4188f2:{'default':_0x4188f2};};Object['defineProperty'](exports,a34_0x48814a(0x18e),{'value':!![]}),exports['AuthService']=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),jsonwebtoken_1=__importDefault(require('jsonwebtoken')),database_1=__importDefault(require('../config/database')),config_1=require(a34_0x48814a(0x1ad));class AuthService{[a34_0x48814a(0x193)](_0x3320d1){const _0x2819f6=a34_0x48814a;return jsonwebtoken_1[_0x2819f6(0x1a6)]['sign'](_0x3320d1,config_1[_0x2819f6(0x1a2)][_0x2819f6(0x190)]['secret'],{'expiresIn':String(config_1[_0x2819f6(0x1a2)]['jwt']['expiresIn'])});}async[a34_0x48814a(0x1a1)](_0x5cf27b){const _0x57ccab=a34_0x48814a,{username:_0x375c63,password:_0x2e204c}=_0x5cf27b;if(_0x375c63===config_1[_0x57ccab(0x1a2)][_0x57ccab(0x198)]['username']){const _0x231f80=await bcryptjs_1[_0x57ccab(0x1a6)][_0x57ccab(0x1a3)](_0x2e204c,config_1['config']['admin'][_0x57ccab(0x195)]);if(_0x231f80){const _0x59be23=this[_0x57ccab(0x193)]({'id':_0x57ccab(0x198),'username':config_1[_0x57ccab(0x1a2)][_0x57ccab(0x198)][_0x57ccab(0x1a4)],'role':'admin'});return{'access_token':_0x59be23,'role':_0x57ccab(0x198)};}}const _0x1252fa=await database_1['default'][_0x57ccab(0x192)][_0x57ccab(0x1a0)]({'where':{'username':_0x375c63},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x1252fa)throw new Error(_0x57ccab(0x1a5));if(_0x1252fa[_0x57ccab(0x19d)]!=='ACTIVE')throw new Error(_0x57ccab(0x197));const _0x1b0685=await bcryptjs_1['default']['compare'](_0x2e204c,_0x1252fa['password']);if(!_0x1b0685)throw new Error(_0x57ccab(0x1a5));const _0x508db5=this[_0x57ccab(0x193)]({'id':_0x1252fa['id'],'username':_0x1252fa[_0x57ccab(0x1a4)],'role':_0x57ccab(0x192)});return{'access_token':_0x508db5,'role':_0x57ccab(0x192),'user':{'id':_0x1252fa['id'],'name':_0x1252fa[_0x57ccab(0x1ac)],'username':_0x1252fa['username']}};}async[a34_0x48814a(0x1a7)](_0x210541){const _0x5844c1=a34_0x48814a;try{const _0x5c02c3=jsonwebtoken_1['default'][_0x5844c1(0x1a9)](_0x210541,config_1[_0x5844c1(0x1a2)][_0x5844c1(0x190)][_0x5844c1(0x19b)]);return _0x5c02c3;}catch(_0x2ea6c6){throw new Error(_0x5844c1(0x19e));}}}function a34_0xb990(){const _0x42dd13=['10sdbKnR','name','../config/config','101068NLfVaW','__esModule','2242074uodhnJ','jwt','45FZhvdF','shop','generateToken','5862258AumZcN','passwordHash','__importDefault','Account\x20is\x20not\x20active','admin','AuthService','18508SDmeTt','secret','3045368aPdeIN','status','Invalid\x20token','703305GamNUz','findUnique','login','config','compare','username','Invalid\x20credentials','default','verifyToken','1169441JZlEdp','verify','85UpLcni'];a34_0xb990=function(){return _0x42dd13;};return a34_0xb990();}exports[a34_0x48814a(0x199)]=AuthService;