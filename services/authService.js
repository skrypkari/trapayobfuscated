'use strict';const a36_0x1ded2d=a36_0x9635;(function(_0x28587d,_0x16e20c){const _0x3b968d=a36_0x9635,_0x13808c=_0x28587d();while(!![]){try{const _0x327a4b=parseInt(_0x3b968d(0x171))/0x1+-parseInt(_0x3b968d(0x17a))/0x2*(parseInt(_0x3b968d(0x17c))/0x3)+parseInt(_0x3b968d(0x183))/0x4+parseInt(_0x3b968d(0x182))/0x5*(-parseInt(_0x3b968d(0x180))/0x6)+-parseInt(_0x3b968d(0x162))/0x7+parseInt(_0x3b968d(0x16f))/0x8+parseInt(_0x3b968d(0x179))/0x9;if(_0x327a4b===_0x16e20c)break;else _0x13808c['push'](_0x13808c['shift']());}catch(_0x544105){_0x13808c['push'](_0x13808c['shift']());}}}(a36_0x2dff,0xa5ecb));function a36_0x9635(_0x327219,_0x347b9e){const _0x2dff59=a36_0x2dff();return a36_0x9635=function(_0x9635d8,_0x2a8575){_0x9635d8=_0x9635d8-0x161;let _0x9998f0=_0x2dff59[_0x9635d8];return _0x9998f0;},a36_0x9635(_0x327219,_0x347b9e);}var __importDefault=this&&this['__importDefault']||function(_0x38caa4){const _0x4fb258=a36_0x9635;return _0x38caa4&&_0x38caa4[_0x4fb258(0x172)]?_0x38caa4:{'default':_0x38caa4};};Object[a36_0x1ded2d(0x168)](exports,'__esModule',{'value':!![]}),exports[a36_0x1ded2d(0x167)]=void 0x0;const bcryptjs_1=__importDefault(require(a36_0x1ded2d(0x16d))),jsonwebtoken_1=__importDefault(require(a36_0x1ded2d(0x173))),database_1=__importDefault(require(a36_0x1ded2d(0x170))),config_1=require(a36_0x1ded2d(0x17e));class AuthService{[a36_0x1ded2d(0x169)](_0x2a5c18){const _0x241261=a36_0x1ded2d;return jsonwebtoken_1['default']['sign'](_0x2a5c18,config_1['config'][_0x241261(0x164)][_0x241261(0x177)],{'expiresIn':String(config_1[_0x241261(0x176)][_0x241261(0x164)][_0x241261(0x16c)])});}async[a36_0x1ded2d(0x17b)](_0x199886){const _0x240e44=a36_0x1ded2d,{username:_0x138a32,password:_0xb9ddff}=_0x199886;if(_0x138a32===config_1[_0x240e44(0x176)][_0x240e44(0x17f)][_0x240e44(0x161)]){const _0x2f4ac6=await bcryptjs_1['default']['compare'](_0xb9ddff,config_1['config'][_0x240e44(0x17f)][_0x240e44(0x175)]);if(_0x2f4ac6){const _0xc84d4a=this[_0x240e44(0x169)]({'id':_0x240e44(0x17f),'username':config_1[_0x240e44(0x176)][_0x240e44(0x17f)][_0x240e44(0x161)],'role':_0x240e44(0x17f)});return{'access_token':_0xc84d4a,'role':_0x240e44(0x17f)};}}const _0x44321e=await database_1[_0x240e44(0x16a)]['shop']['findUnique']({'where':{'username':_0x138a32},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x44321e)throw new Error(_0x240e44(0x165));if(_0x44321e[_0x240e44(0x166)]===_0x240e44(0x17d))throw new Error('Account\x20is\x20not\x20active');const _0x4659be=await bcryptjs_1[_0x240e44(0x16a)][_0x240e44(0x163)](_0xb9ddff,_0x44321e[_0x240e44(0x181)]);if(!_0x4659be)throw new Error('Invalid\x20credentials');const _0x328bea=this[_0x240e44(0x169)]({'id':_0x44321e['id'],'username':_0x44321e[_0x240e44(0x161)],'role':_0x240e44(0x16b)});return{'access_token':_0x328bea,'role':_0x240e44(0x16b),'user':{'id':_0x44321e['id'],'name':_0x44321e['name'],'username':_0x44321e[_0x240e44(0x161)],'status':_0x44321e[_0x240e44(0x166)]},'suspended':_0x44321e[_0x240e44(0x166)]===_0x240e44(0x16e)};}async['verifyToken'](_0x159ba0){const _0x43f07d=a36_0x1ded2d;try{const _0x3ea77e=jsonwebtoken_1[_0x43f07d(0x16a)][_0x43f07d(0x178)](_0x159ba0,config_1['config'][_0x43f07d(0x164)]['secret']);return _0x3ea77e;}catch(_0x566c78){throw new Error(_0x43f07d(0x174));}}}exports[a36_0x1ded2d(0x167)]=AuthService;function a36_0x2dff(){const _0x12242f=['1167918NcfvmJ','INACTIVE','../config/config','admin','534MtVYDP','password','15325fwadhp','4343448vgCuCw','username','782481wCaAHO','compare','jwt','Invalid\x20credentials','status','AuthService','defineProperty','generateToken','default','shop','expiresIn','bcryptjs','SUSPENDED','3922040NOKvwR','../config/database','263248EBoOct','__esModule','jsonwebtoken','Invalid\x20token','passwordHash','config','secret','verify','3534732SbYxdb','6xOJsiX','login'];a36_0x2dff=function(){return _0x12242f;};return a36_0x2dff();}