'use strict';const a41_0xdf12bf=a41_0x4c8c;(function(_0x4ab475,_0x587450){const _0xb7f334=a41_0x4c8c,_0x135e10=_0x4ab475();while(!![]){try{const _0x3a8f6d=parseInt(_0xb7f334(0xc3))/0x1+-parseInt(_0xb7f334(0xca))/0x2+parseInt(_0xb7f334(0xc2))/0x3*(parseInt(_0xb7f334(0xbf))/0x4)+parseInt(_0xb7f334(0xd8))/0x5*(parseInt(_0xb7f334(0xe1))/0x6)+parseInt(_0xb7f334(0xc5))/0x7*(-parseInt(_0xb7f334(0xd6))/0x8)+parseInt(_0xb7f334(0xd4))/0x9*(parseInt(_0xb7f334(0xd9))/0xa)+-parseInt(_0xb7f334(0xde))/0xb*(parseInt(_0xb7f334(0xdb))/0xc);if(_0x3a8f6d===_0x587450)break;else _0x135e10['push'](_0x135e10['shift']());}catch(_0x21bd80){_0x135e10['push'](_0x135e10['shift']());}}}(a41_0x41dd,0x38a99));function a41_0x4c8c(_0xd5ba10,_0x57cb37){const _0x41dde6=a41_0x41dd();return a41_0x4c8c=function(_0x4c8cd2,_0xfb4b55){_0x4c8cd2=_0x4c8cd2-0xbf;let _0x162d16=_0x41dde6[_0x4c8cd2];return _0x162d16;},a41_0x4c8c(_0xd5ba10,_0x57cb37);}function a41_0x41dd(){const _0x2538f6=['admin','../config/database','55IArpoU','Account\x20is\x20not\x20active','name','36CEadwL','636AOEIty','compare','verify','843xckRQN','438040brREPK','shop','21mYWHlA','findUnique','verifyToken','__esModule','Invalid\x20credentials','1902IhrSRt','username','bcryptjs','AuthService','password','ACTIVE','jwt','default','secret','__importDefault','747nwieuE','generateToken','41608IRmeRC','config','12465ytGkiQ','420vgjzjm','sign','606048arbaAU'];a41_0x41dd=function(){return _0x2538f6;};return a41_0x41dd();}var __importDefault=this&&this[a41_0xdf12bf(0xd3)]||function(_0x2f4133){const _0x235d2e=a41_0xdf12bf;return _0x2f4133&&_0x2f4133[_0x235d2e(0xc8)]?_0x2f4133:{'default':_0x2f4133};};Object['defineProperty'](exports,a41_0xdf12bf(0xc8),{'value':!![]}),exports[a41_0xdf12bf(0xcd)]=void 0x0;const bcryptjs_1=__importDefault(require(a41_0xdf12bf(0xcc))),jsonwebtoken_1=__importDefault(require('jsonwebtoken')),database_1=__importDefault(require(a41_0xdf12bf(0xdd))),config_1=require('../config/config');class AuthService{[a41_0xdf12bf(0xd5)](_0x15651d){const _0x1e222d=a41_0xdf12bf;return jsonwebtoken_1[_0x1e222d(0xd1)][_0x1e222d(0xda)](_0x15651d,config_1[_0x1e222d(0xd7)][_0x1e222d(0xd0)][_0x1e222d(0xd2)],{'expiresIn':String(config_1[_0x1e222d(0xd7)][_0x1e222d(0xd0)]['expiresIn'])});}async['login'](_0x77b3fd){const _0x157814=a41_0xdf12bf,{username:_0x9ed087,password:_0x1a99de}=_0x77b3fd;if(_0x9ed087===config_1[_0x157814(0xd7)][_0x157814(0xdc)]['username']){const _0x22b501=await bcryptjs_1['default'][_0x157814(0xc0)](_0x1a99de,config_1[_0x157814(0xd7)][_0x157814(0xdc)]['passwordHash']);if(_0x22b501){const _0x123d1b=this[_0x157814(0xd5)]({'id':'admin','username':config_1[_0x157814(0xd7)]['admin'][_0x157814(0xcb)],'role':_0x157814(0xdc)});return{'access_token':_0x123d1b,'role':_0x157814(0xdc)};}}const _0x3154a3=await database_1['default'][_0x157814(0xc4)][_0x157814(0xc6)]({'where':{'username':_0x9ed087},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x3154a3)throw new Error(_0x157814(0xc9));if(_0x3154a3['status']!==_0x157814(0xcf))throw new Error(_0x157814(0xdf));const _0x493522=await bcryptjs_1[_0x157814(0xd1)][_0x157814(0xc0)](_0x1a99de,_0x3154a3[_0x157814(0xce)]);if(!_0x493522)throw new Error(_0x157814(0xc9));const _0x19f2cb=this[_0x157814(0xd5)]({'id':_0x3154a3['id'],'username':_0x3154a3[_0x157814(0xcb)],'role':_0x157814(0xc4)});return{'access_token':_0x19f2cb,'role':_0x157814(0xc4),'user':{'id':_0x3154a3['id'],'name':_0x3154a3[_0x157814(0xe0)],'username':_0x3154a3['username']}};}async[a41_0xdf12bf(0xc7)](_0x4b7a){const _0x333438=a41_0xdf12bf;try{const _0xa7910c=jsonwebtoken_1[_0x333438(0xd1)][_0x333438(0xc1)](_0x4b7a,config_1[_0x333438(0xd7)][_0x333438(0xd0)][_0x333438(0xd2)]);return _0xa7910c;}catch(_0x2bcfec){throw new Error('Invalid\x20token');}}}exports[a41_0xdf12bf(0xcd)]=AuthService;