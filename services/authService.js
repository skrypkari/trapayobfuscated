'use strict';const a41_0x1964d1=a41_0x1186;(function(_0xd175b0,_0x47ca30){const _0x5732e3=a41_0x1186,_0x5894b2=_0xd175b0();while(!![]){try{const _0x1d0dd6=parseInt(_0x5732e3(0x202))/0x1+parseInt(_0x5732e3(0x1f9))/0x2*(parseInt(_0x5732e3(0x201))/0x3)+parseInt(_0x5732e3(0x1f4))/0x4+-parseInt(_0x5732e3(0x1f7))/0x5+-parseInt(_0x5732e3(0x209))/0x6*(parseInt(_0x5732e3(0x20c))/0x7)+parseInt(_0x5732e3(0x210))/0x8+-parseInt(_0x5732e3(0x20d))/0x9;if(_0x1d0dd6===_0x47ca30)break;else _0x5894b2['push'](_0x5894b2['shift']());}catch(_0x14c241){_0x5894b2['push'](_0x5894b2['shift']());}}}(a41_0x41f6,0x23e17));var __importDefault=this&&this[a41_0x1964d1(0x206)]||function(_0x542026){const _0x528590=a41_0x1964d1;return _0x542026&&_0x542026[_0x528590(0x1f3)]?_0x542026:{'default':_0x542026};};Object[a41_0x1964d1(0x1fa)](exports,a41_0x1964d1(0x1f3),{'value':!![]}),exports[a41_0x1964d1(0x20b)]=void 0x0;const bcryptjs_1=__importDefault(require(a41_0x1964d1(0x1fe))),jsonwebtoken_1=__importDefault(require(a41_0x1964d1(0x1f8))),database_1=__importDefault(require(a41_0x1964d1(0x213))),config_1=require('../config/config');function a41_0x41f6(){const _0x3ce643=['secret','bcryptjs','sign','passwordHash','19083uPuccr','181517ijPsox','shop','compare','login','__importDefault','admin','jwt','210jdlhng','generateToken','AuthService','23016PGCAVZ','463410hzGuwO','Invalid\x20credentials','username','2295304EblZJy','ACTIVE','verifyToken','../config/database','name','__esModule','386704bpMmIi','status','Invalid\x20token','1321455KNUvHV','jsonwebtoken','4fuITtC','defineProperty','default','config'];a41_0x41f6=function(){return _0x3ce643;};return a41_0x41f6();}class AuthService{[a41_0x1964d1(0x20a)](_0x57d18c){const _0x4bcb17=a41_0x1964d1;return jsonwebtoken_1[_0x4bcb17(0x1fb)][_0x4bcb17(0x1ff)](_0x57d18c,config_1[_0x4bcb17(0x1fc)][_0x4bcb17(0x208)][_0x4bcb17(0x1fd)],{'expiresIn':String(config_1[_0x4bcb17(0x1fc)][_0x4bcb17(0x208)]['expiresIn'])});}async[a41_0x1964d1(0x205)](_0x1435df){const _0x4aa71d=a41_0x1964d1,{username:_0x640808,password:_0x30840f}=_0x1435df;if(_0x640808===config_1[_0x4aa71d(0x1fc)][_0x4aa71d(0x207)][_0x4aa71d(0x20f)]){const _0x2415fa=await bcryptjs_1[_0x4aa71d(0x1fb)][_0x4aa71d(0x204)](_0x30840f,config_1[_0x4aa71d(0x1fc)][_0x4aa71d(0x207)][_0x4aa71d(0x200)]);if(_0x2415fa){const _0x1dc662=this[_0x4aa71d(0x20a)]({'id':_0x4aa71d(0x207),'username':config_1['config']['admin'][_0x4aa71d(0x20f)],'role':_0x4aa71d(0x207)});return{'access_token':_0x1dc662,'role':_0x4aa71d(0x207)};}}const _0x5c3835=await database_1[_0x4aa71d(0x1fb)][_0x4aa71d(0x203)]['findUnique']({'where':{'username':_0x640808},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x5c3835)throw new Error('Invalid\x20credentials');if(_0x5c3835[_0x4aa71d(0x1f5)]!==_0x4aa71d(0x211))throw new Error('Account\x20is\x20not\x20active');const _0x20db7f=await bcryptjs_1[_0x4aa71d(0x1fb)]['compare'](_0x30840f,_0x5c3835['password']);if(!_0x20db7f)throw new Error(_0x4aa71d(0x20e));const _0x4f611d=this[_0x4aa71d(0x20a)]({'id':_0x5c3835['id'],'username':_0x5c3835[_0x4aa71d(0x20f)],'role':_0x4aa71d(0x203)});return{'access_token':_0x4f611d,'role':_0x4aa71d(0x203),'user':{'id':_0x5c3835['id'],'name':_0x5c3835[_0x4aa71d(0x214)],'username':_0x5c3835[_0x4aa71d(0x20f)]}};}async[a41_0x1964d1(0x212)](_0x4011a6){const _0x14c854=a41_0x1964d1;try{const _0x2d0764=jsonwebtoken_1[_0x14c854(0x1fb)]['verify'](_0x4011a6,config_1['config'][_0x14c854(0x208)][_0x14c854(0x1fd)]);return _0x2d0764;}catch(_0x152f43){throw new Error(_0x14c854(0x1f6));}}}function a41_0x1186(_0x2ae44f,_0x287425){const _0x41f6a8=a41_0x41f6();return a41_0x1186=function(_0x1186b2,_0x354251){_0x1186b2=_0x1186b2-0x1f3;let _0x3437e6=_0x41f6a8[_0x1186b2];return _0x3437e6;},a41_0x1186(_0x2ae44f,_0x287425);}exports[a41_0x1964d1(0x20b)]=AuthService;