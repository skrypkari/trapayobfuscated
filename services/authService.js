'use strict';const a36_0x49ad38=a36_0x247d;function a36_0x3f53(){const _0x5221fd=['passwordHash','../config/config','Invalid\x20credentials','admin','../config/database','compare','280nVejAW','2301496QkKwgY','4363011beqLTd','25278OmfHgY','generateToken','415coYvFq','368103EVQrmZ','jsonwebtoken','shop','991470erFBIM','ACTIVE','status','config','defineProperty','verifyToken','username','findUnique','4bzGHfu','Invalid\x20token','expiresIn','sign','jwt','AuthService','4075820bbNdni','1250aDhvzc','password','name','default','secret','login','__esModule','verify'];a36_0x3f53=function(){return _0x5221fd;};return a36_0x3f53();}(function(_0x25c7ba,_0x427d3b){const _0x37937d=a36_0x247d,_0x252b00=_0x25c7ba();while(!![]){try{const _0x4f4fe6=parseInt(_0x37937d(0x105))/0x1*(parseInt(_0x37937d(0xf2))/0x2)+parseInt(_0x37937d(0x106))/0x3+parseInt(_0x37937d(0x111))/0x4*(parseInt(_0x37937d(0xf1))/0x5)+parseInt(_0x37937d(0x103))/0x6*(parseInt(_0x37937d(0x100))/0x7)+-parseInt(_0x37937d(0x101))/0x8+-parseInt(_0x37937d(0x102))/0x9+-parseInt(_0x37937d(0x109))/0xa;if(_0x4f4fe6===_0x427d3b)break;else _0x252b00['push'](_0x252b00['shift']());}catch(_0xc35b7d){_0x252b00['push'](_0x252b00['shift']());}}}(a36_0x3f53,0x78a43));var __importDefault=this&&this['__importDefault']||function(_0x3c10a3){const _0x43123b=a36_0x247d;return _0x3c10a3&&_0x3c10a3[_0x43123b(0xf8)]?_0x3c10a3:{'default':_0x3c10a3};};Object[a36_0x49ad38(0x10d)](exports,a36_0x49ad38(0xf8),{'value':!![]}),exports['AuthService']=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),jsonwebtoken_1=__importDefault(require(a36_0x49ad38(0x107))),database_1=__importDefault(require(a36_0x49ad38(0xfe))),config_1=require(a36_0x49ad38(0xfb));function a36_0x247d(_0x450621,_0x4fc740){const _0x3f53f4=a36_0x3f53();return a36_0x247d=function(_0x247d4c,_0x47814e){_0x247d4c=_0x247d4c-0xee;let _0x334c38=_0x3f53f4[_0x247d4c];return _0x334c38;},a36_0x247d(_0x450621,_0x4fc740);}class AuthService{['generateToken'](_0x48a629){const _0x15acec=a36_0x49ad38;return jsonwebtoken_1[_0x15acec(0xf5)][_0x15acec(0xee)](_0x48a629,config_1[_0x15acec(0x10c)][_0x15acec(0xef)][_0x15acec(0xf6)],{'expiresIn':String(config_1[_0x15acec(0x10c)][_0x15acec(0xef)][_0x15acec(0x113)])});}async[a36_0x49ad38(0xf7)](_0x360b01){const _0x4590c4=a36_0x49ad38,{username:_0x228d6a,password:_0x5c8fea}=_0x360b01;if(_0x228d6a===config_1[_0x4590c4(0x10c)][_0x4590c4(0xfd)][_0x4590c4(0x10f)]){const _0x11f215=await bcryptjs_1[_0x4590c4(0xf5)][_0x4590c4(0xff)](_0x5c8fea,config_1[_0x4590c4(0x10c)][_0x4590c4(0xfd)][_0x4590c4(0xfa)]);if(_0x11f215){const _0x598a75=this[_0x4590c4(0x104)]({'id':_0x4590c4(0xfd),'username':config_1[_0x4590c4(0x10c)][_0x4590c4(0xfd)][_0x4590c4(0x10f)],'role':_0x4590c4(0xfd)});return{'access_token':_0x598a75,'role':_0x4590c4(0xfd)};}}const _0x4337ae=await database_1['default'][_0x4590c4(0x108)][_0x4590c4(0x110)]({'where':{'username':_0x228d6a},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x4337ae)throw new Error(_0x4590c4(0xfc));if(_0x4337ae[_0x4590c4(0x10b)]!==_0x4590c4(0x10a))throw new Error('Account\x20is\x20not\x20active');const _0x1d8806=await bcryptjs_1['default'][_0x4590c4(0xff)](_0x5c8fea,_0x4337ae[_0x4590c4(0xf3)]);if(!_0x1d8806)throw new Error(_0x4590c4(0xfc));const _0x4384d1=this['generateToken']({'id':_0x4337ae['id'],'username':_0x4337ae[_0x4590c4(0x10f)],'role':'shop'});return{'access_token':_0x4384d1,'role':'shop','user':{'id':_0x4337ae['id'],'name':_0x4337ae[_0x4590c4(0xf4)],'username':_0x4337ae['username']}};}async[a36_0x49ad38(0x10e)](_0x57acb3){const _0x47bb28=a36_0x49ad38;try{const _0x4c8a2e=jsonwebtoken_1[_0x47bb28(0xf5)][_0x47bb28(0xf9)](_0x57acb3,config_1[_0x47bb28(0x10c)][_0x47bb28(0xef)][_0x47bb28(0xf6)]);return _0x4c8a2e;}catch(_0x14dff7){throw new Error(_0x47bb28(0x112));}}}exports[a36_0x49ad38(0xf0)]=AuthService;