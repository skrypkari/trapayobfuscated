'use strict';const a34_0x2995a3=a34_0x3dfd;(function(_0x2d098f,_0x3cd4ce){const _0x2fc8dd=a34_0x3dfd,_0x491ec0=_0x2d098f();while(!![]){try{const _0x11c69d=-parseInt(_0x2fc8dd(0x175))/0x1*(parseInt(_0x2fc8dd(0x156))/0x2)+parseInt(_0x2fc8dd(0x159))/0x3+parseInt(_0x2fc8dd(0x162))/0x4+-parseInt(_0x2fc8dd(0x16d))/0x5+parseInt(_0x2fc8dd(0x157))/0x6*(parseInt(_0x2fc8dd(0x16e))/0x7)+-parseInt(_0x2fc8dd(0x163))/0x8*(-parseInt(_0x2fc8dd(0x169))/0x9)+parseInt(_0x2fc8dd(0x17b))/0xa;if(_0x11c69d===_0x3cd4ce)break;else _0x491ec0['push'](_0x491ec0['shift']());}catch(_0xdb787e){_0x491ec0['push'](_0x491ec0['shift']());}}}(a34_0x2604,0x6f6b4));function a34_0x3dfd(_0x29b65c,_0x4c5cc6){const _0x26047d=a34_0x2604();return a34_0x3dfd=function(_0x3dfda0,_0x4adea5){_0x3dfda0=_0x3dfda0-0x156;let _0x3d4913=_0x26047d[_0x3dfda0];return _0x3d4913;},a34_0x3dfd(_0x29b65c,_0x4c5cc6);}var __importDefault=this&&this[a34_0x2995a3(0x15c)]||function(_0x8c80dd){const _0x382ae8=a34_0x2995a3;return _0x8c80dd&&_0x8c80dd[_0x382ae8(0x17a)]?_0x8c80dd:{'default':_0x8c80dd};};Object[a34_0x2995a3(0x161)](exports,'__esModule',{'value':!![]}),exports[a34_0x2995a3(0x15a)]=void 0x0;const bcryptjs_1=__importDefault(require(a34_0x2995a3(0x179))),jsonwebtoken_1=__importDefault(require(a34_0x2995a3(0x160))),database_1=__importDefault(require(a34_0x2995a3(0x176))),config_1=require('../config/config');class AuthService{[a34_0x2995a3(0x15b)](_0x25297e){const _0x5b8638=a34_0x2995a3;return jsonwebtoken_1[_0x5b8638(0x15d)][_0x5b8638(0x165)](_0x25297e,config_1[_0x5b8638(0x15f)][_0x5b8638(0x16f)][_0x5b8638(0x15e)],{'expiresIn':String(config_1['config'][_0x5b8638(0x16f)]['expiresIn'])});}async[a34_0x2995a3(0x172)](_0x3ea68d){const _0x16ba9b=a34_0x2995a3,{username:_0x39e5cc,password:_0x54f343}=_0x3ea68d;if(_0x39e5cc===config_1['config']['admin']['username']){const _0x11dabe=await bcryptjs_1[_0x16ba9b(0x15d)][_0x16ba9b(0x164)](_0x54f343,config_1[_0x16ba9b(0x15f)][_0x16ba9b(0x16b)][_0x16ba9b(0x170)]);if(_0x11dabe){const _0xcc960=this['generateToken']({'id':_0x16ba9b(0x16b),'username':config_1[_0x16ba9b(0x15f)][_0x16ba9b(0x16b)]['username'],'role':_0x16ba9b(0x16b)});return{'access_token':_0xcc960,'role':_0x16ba9b(0x16b)};}}const _0x4c6fd3=await database_1[_0x16ba9b(0x15d)][_0x16ba9b(0x17c)][_0x16ba9b(0x168)]({'where':{'username':_0x39e5cc},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x4c6fd3)throw new Error(_0x16ba9b(0x171));if(_0x4c6fd3[_0x16ba9b(0x16c)]!==_0x16ba9b(0x173))throw new Error(_0x16ba9b(0x178));const _0x37f083=await bcryptjs_1[_0x16ba9b(0x15d)]['compare'](_0x54f343,_0x4c6fd3[_0x16ba9b(0x166)]);if(!_0x37f083)throw new Error(_0x16ba9b(0x171));const _0x398260=this[_0x16ba9b(0x15b)]({'id':_0x4c6fd3['id'],'username':_0x4c6fd3[_0x16ba9b(0x177)],'role':_0x16ba9b(0x17c)});return{'access_token':_0x398260,'role':_0x16ba9b(0x17c),'user':{'id':_0x4c6fd3['id'],'name':_0x4c6fd3[_0x16ba9b(0x16a)],'username':_0x4c6fd3[_0x16ba9b(0x177)]}};}async[a34_0x2995a3(0x158)](_0x5648ee){const _0x43f4eb=a34_0x2995a3;try{const _0x207b2b=jsonwebtoken_1[_0x43f4eb(0x15d)][_0x43f4eb(0x174)](_0x5648ee,config_1[_0x43f4eb(0x15f)][_0x43f4eb(0x16f)][_0x43f4eb(0x15e)]);return _0x207b2b;}catch(_0x36c699){throw new Error(_0x43f4eb(0x167));}}}exports[a34_0x2995a3(0x15a)]=AuthService;function a34_0x2604(){const _0x401137=['247900XEYSUH','876281CwgXRY','jwt','passwordHash','Invalid\x20credentials','login','ACTIVE','verify','187DUzGHM','../config/database','username','Account\x20is\x20not\x20active','bcryptjs','__esModule','203630gWXSjC','shop','2240FEzZtZ','6yfpWSY','verifyToken','251139lxuAHX','AuthService','generateToken','__importDefault','default','secret','config','jsonwebtoken','defineProperty','1769592wmHqpF','40xeGawa','compare','sign','password','Invalid\x20token','findUnique','78723qmvAJf','name','admin','status'];a34_0x2604=function(){return _0x401137;};return a34_0x2604();}