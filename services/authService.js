'use strict';function a34_0x12bc(_0x359e9b,_0x3da9ec){const _0x3ffb73=a34_0x3ffb();return a34_0x12bc=function(_0x12bc90,_0x1ad7b2){_0x12bc90=_0x12bc90-0xf3;let _0x282e08=_0x3ffb73[_0x12bc90];return _0x282e08;},a34_0x12bc(_0x359e9b,_0x3da9ec);}function a34_0x3ffb(){const _0x1d772a=['Account\x20is\x20not\x20active','sign','expiresIn','../config/config','jwt','12PbynfM','shop','1591375jDzxum','ACTIVE','admin','compare','verifyToken','passwordHash','21ErBUnv','config','login','generateToken','status','secret','default','findUnique','AuthService','1331632FALeBC','12GMQMWI','28242Qmcwaq','username','bcryptjs','9382302NFVCut','20628520HbWJFP','9172xMjOgi','name','defineProperty','jsonwebtoken','__importDefault','__esModule','2725954vLySpN','../config/database'];a34_0x3ffb=function(){return _0x1d772a;};return a34_0x3ffb();}const a34_0x23acb7=a34_0x12bc;(function(_0x48357d,_0x3e9dd2){const _0x2009ff=a34_0x12bc,_0x41baef=_0x48357d();while(!![]){try{const _0x3c0d87=-parseInt(_0x2009ff(0x108))/0x1*(parseInt(_0x2009ff(0xf5))/0x2)+-parseInt(_0x2009ff(0xfd))/0x3*(parseInt(_0x2009ff(0x10d))/0x4)+parseInt(_0x2009ff(0xf7))/0x5+-parseInt(_0x2009ff(0x107))/0x6*(parseInt(_0x2009ff(0x113))/0x7)+parseInt(_0x2009ff(0x106))/0x8+-parseInt(_0x2009ff(0x10b))/0x9+parseInt(_0x2009ff(0x10c))/0xa;if(_0x3c0d87===_0x3e9dd2)break;else _0x41baef['push'](_0x41baef['shift']());}catch(_0x29e3ef){_0x41baef['push'](_0x41baef['shift']());}}}(a34_0x3ffb,0x84054));var __importDefault=this&&this[a34_0x23acb7(0x111)]||function(_0x24754a){return _0x24754a&&_0x24754a['__esModule']?_0x24754a:{'default':_0x24754a};};Object[a34_0x23acb7(0x10f)](exports,a34_0x23acb7(0x112),{'value':!![]}),exports[a34_0x23acb7(0x105)]=void 0x0;const bcryptjs_1=__importDefault(require(a34_0x23acb7(0x10a))),jsonwebtoken_1=__importDefault(require(a34_0x23acb7(0x110))),database_1=__importDefault(require(a34_0x23acb7(0x114))),config_1=require(a34_0x23acb7(0xf3));class AuthService{[a34_0x23acb7(0x100)](_0x462e4){const _0x480bae=a34_0x23acb7;return jsonwebtoken_1[_0x480bae(0x103)][_0x480bae(0x116)](_0x462e4,config_1[_0x480bae(0xfe)][_0x480bae(0xf4)][_0x480bae(0x102)],{'expiresIn':String(config_1[_0x480bae(0xfe)][_0x480bae(0xf4)][_0x480bae(0x117)])});}async[a34_0x23acb7(0xff)](_0x1837e0){const _0x4e3141=a34_0x23acb7,{username:_0x5143f9,password:_0x3016a4}=_0x1837e0;if(_0x5143f9===config_1[_0x4e3141(0xfe)][_0x4e3141(0xf9)]['username']){const _0xda8b66=await bcryptjs_1['default'][_0x4e3141(0xfa)](_0x3016a4,config_1[_0x4e3141(0xfe)][_0x4e3141(0xf9)][_0x4e3141(0xfc)]);if(_0xda8b66){const _0x30a460=this[_0x4e3141(0x100)]({'id':_0x4e3141(0xf9),'username':config_1['config'][_0x4e3141(0xf9)][_0x4e3141(0x109)],'role':_0x4e3141(0xf9)});return{'access_token':_0x30a460,'role':_0x4e3141(0xf9)};}}const _0x4cb875=await database_1[_0x4e3141(0x103)][_0x4e3141(0xf6)][_0x4e3141(0x104)]({'where':{'username':_0x5143f9},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x4cb875)throw new Error('Invalid\x20credentials');if(_0x4cb875[_0x4e3141(0x101)]!==_0x4e3141(0xf8))throw new Error(_0x4e3141(0x115));const _0x582f5a=await bcryptjs_1[_0x4e3141(0x103)][_0x4e3141(0xfa)](_0x3016a4,_0x4cb875['password']);if(!_0x582f5a)throw new Error('Invalid\x20credentials');const _0x2fba65=this[_0x4e3141(0x100)]({'id':_0x4cb875['id'],'username':_0x4cb875[_0x4e3141(0x109)],'role':_0x4e3141(0xf6)});return{'access_token':_0x2fba65,'role':'shop','user':{'id':_0x4cb875['id'],'name':_0x4cb875[_0x4e3141(0x10e)],'username':_0x4cb875['username']}};}async[a34_0x23acb7(0xfb)](_0x48a262){const _0x3b4c1d=a34_0x23acb7;try{const _0x389868=jsonwebtoken_1['default']['verify'](_0x48a262,config_1['config'][_0x3b4c1d(0xf4)][_0x3b4c1d(0x102)]);return _0x389868;}catch(_0x5a9490){throw new Error('Invalid\x20token');}}}exports['AuthService']=AuthService;