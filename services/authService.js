'use strict';const a36_0x41a4b8=a36_0x5122;(function(_0x293812,_0x3b2e4a){const _0x5bac03=a36_0x5122,_0x48df2c=_0x293812();while(!![]){try{const _0x20adb6=-parseInt(_0x5bac03(0x13f))/0x1+parseInt(_0x5bac03(0x12d))/0x2*(-parseInt(_0x5bac03(0x131))/0x3)+parseInt(_0x5bac03(0x130))/0x4*(parseInt(_0x5bac03(0x12c))/0x5)+-parseInt(_0x5bac03(0x142))/0x6+parseInt(_0x5bac03(0x12e))/0x7*(-parseInt(_0x5bac03(0x14d))/0x8)+-parseInt(_0x5bac03(0x12f))/0x9+-parseInt(_0x5bac03(0x14b))/0xa*(-parseInt(_0x5bac03(0x133))/0xb);if(_0x20adb6===_0x3b2e4a)break;else _0x48df2c['push'](_0x48df2c['shift']());}catch(_0x190607){_0x48df2c['push'](_0x48df2c['shift']());}}}(a36_0x37ef,0x865ba));var __importDefault=this&&this[a36_0x41a4b8(0x132)]||function(_0x3e636c){const _0x4d4812=a36_0x41a4b8;return _0x3e636c&&_0x3e636c[_0x4d4812(0x13e)]?_0x3e636c:{'default':_0x3e636c};};function a36_0x5122(_0x21b2be,_0x366443){const _0x37efdc=a36_0x37ef();return a36_0x5122=function(_0x5122d3,_0x2a0292){_0x5122d3=_0x5122d3-0x12c;let _0x3839e8=_0x37efdc[_0x5122d3];return _0x3839e8;},a36_0x5122(_0x21b2be,_0x366443);}Object[a36_0x41a4b8(0x13c)](exports,a36_0x41a4b8(0x13e),{'value':!![]}),exports[a36_0x41a4b8(0x149)]=void 0x0;const bcryptjs_1=__importDefault(require(a36_0x41a4b8(0x134))),jsonwebtoken_1=__importDefault(require(a36_0x41a4b8(0x135))),database_1=__importDefault(require(a36_0x41a4b8(0x140))),config_1=require(a36_0x41a4b8(0x13d));class AuthService{[a36_0x41a4b8(0x150)](_0x2dcf9d){const _0x22e0aa=a36_0x41a4b8;return jsonwebtoken_1['default'][_0x22e0aa(0x14c)](_0x2dcf9d,config_1[_0x22e0aa(0x146)][_0x22e0aa(0x139)][_0x22e0aa(0x143)],{'expiresIn':String(config_1[_0x22e0aa(0x146)][_0x22e0aa(0x139)][_0x22e0aa(0x151)])});}async['login'](_0xa2cf4f){const _0x318861=a36_0x41a4b8,{username:_0x13534e,password:_0x4a5b4e}=_0xa2cf4f;if(_0x13534e===config_1[_0x318861(0x146)][_0x318861(0x147)][_0x318861(0x13b)]){const _0x5f0ad8=await bcryptjs_1[_0x318861(0x144)][_0x318861(0x148)](_0x4a5b4e,config_1[_0x318861(0x146)][_0x318861(0x147)]['passwordHash']);if(_0x5f0ad8){const _0x1d81ef=this[_0x318861(0x150)]({'id':_0x318861(0x147),'username':config_1[_0x318861(0x146)]['admin'][_0x318861(0x13b)],'role':'admin'});return{'access_token':_0x1d81ef,'role':_0x318861(0x147)};}}const _0x1ce48f=await database_1['default'][_0x318861(0x14e)][_0x318861(0x14a)]({'where':{'username':_0x13534e},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x1ce48f)throw new Error(_0x318861(0x136));if(_0x1ce48f[_0x318861(0x14f)]!==_0x318861(0x145))throw new Error(_0x318861(0x138));const _0xf277f8=await bcryptjs_1[_0x318861(0x144)]['compare'](_0x4a5b4e,_0x1ce48f[_0x318861(0x13a)]);if(!_0xf277f8)throw new Error(_0x318861(0x136));const _0x3c40f2=this[_0x318861(0x150)]({'id':_0x1ce48f['id'],'username':_0x1ce48f['username'],'role':_0x318861(0x14e)});return{'access_token':_0x3c40f2,'role':_0x318861(0x14e),'user':{'id':_0x1ce48f['id'],'name':_0x1ce48f['name'],'username':_0x1ce48f['username']}};}async[a36_0x41a4b8(0x141)](_0x519f93){const _0x2c3004=a36_0x41a4b8;try{const _0x21f84b=jsonwebtoken_1['default']['verify'](_0x519f93,config_1[_0x2c3004(0x146)][_0x2c3004(0x139)][_0x2c3004(0x143)]);return _0x21f84b;}catch(_0x2c3845){throw new Error(_0x2c3004(0x137));}}}function a36_0x37ef(){const _0x4ddab5=['default','ACTIVE','config','admin','compare','AuthService','findUnique','1661150zvzZhn','sign','2216pcdrUq','shop','status','generateToken','expiresIn','3230845TMQYsV','14286TUuEMS','8981dpqwoB','6946560rLCdqC','4hqwhyC','291orSVfZ','__importDefault','209KCdyUU','bcryptjs','jsonwebtoken','Invalid\x20credentials','Invalid\x20token','Account\x20is\x20not\x20active','jwt','password','username','defineProperty','../config/config','__esModule','507444LYoGTk','../config/database','verifyToken','5546868kNAKhj','secret'];a36_0x37ef=function(){return _0x4ddab5;};return a36_0x37ef();}exports[a36_0x41a4b8(0x149)]=AuthService;