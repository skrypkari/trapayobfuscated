'use strict';function a36_0x2a7b(_0x3e0cb4,_0x132094){const _0x2ef020=a36_0x2ef0();return a36_0x2a7b=function(_0x2a7b63,_0xce9d68){_0x2a7b63=_0x2a7b63-0x127;let _0x42863d=_0x2ef020[_0x2a7b63];return _0x42863d;},a36_0x2a7b(_0x3e0cb4,_0x132094);}const a36_0x181842=a36_0x2a7b;function a36_0x2ef0(){const _0x256f65=['verify','23499850KxsVFB','username','Invalid\x20token','default','sign','Account\x20is\x20not\x20active','jwt','login','990uERWhb','expiresIn','__esModule','12HAviLc','verifyToken','Invalid\x20credentials','292620TZmWfu','compare','48yFQRpB','defineProperty','../config/config','secret','__importDefault','ACTIVE','admin','passwordHash','config','17736ohQcAE','shop','3357389UToQNJ','generateToken','191182dIQdEH','433099moLkwX','1888944eMmjDj','../config/database','name'];a36_0x2ef0=function(){return _0x256f65;};return a36_0x2ef0();}(function(_0x1afd29,_0x42d484){const _0x3f2c18=a36_0x2a7b,_0x5ae2df=_0x1afd29();while(!![]){try{const _0x9d67be=-parseInt(_0x3f2c18(0x145))/0x1+parseInt(_0x3f2c18(0x144))/0x2*(-parseInt(_0x3f2c18(0x132))/0x3)+-parseInt(_0x3f2c18(0x146))/0x4+parseInt(_0x3f2c18(0x135))/0x5*(-parseInt(_0x3f2c18(0x137))/0x6)+-parseInt(_0x3f2c18(0x142))/0x7+-parseInt(_0x3f2c18(0x140))/0x8*(-parseInt(_0x3f2c18(0x12f))/0x9)+parseInt(_0x3f2c18(0x127))/0xa;if(_0x9d67be===_0x42d484)break;else _0x5ae2df['push'](_0x5ae2df['shift']());}catch(_0x2b9746){_0x5ae2df['push'](_0x5ae2df['shift']());}}}(a36_0x2ef0,0x577c1));var __importDefault=this&&this[a36_0x181842(0x13b)]||function(_0x1314ff){const _0x40bed2=a36_0x181842;return _0x1314ff&&_0x1314ff[_0x40bed2(0x131)]?_0x1314ff:{'default':_0x1314ff};};Object[a36_0x181842(0x138)](exports,a36_0x181842(0x131),{'value':!![]}),exports['AuthService']=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),jsonwebtoken_1=__importDefault(require('jsonwebtoken')),database_1=__importDefault(require(a36_0x181842(0x147))),config_1=require(a36_0x181842(0x139));class AuthService{[a36_0x181842(0x143)](_0x2bc740){const _0x4ab061=a36_0x181842;return jsonwebtoken_1[_0x4ab061(0x12a)][_0x4ab061(0x12b)](_0x2bc740,config_1[_0x4ab061(0x13f)][_0x4ab061(0x12d)][_0x4ab061(0x13a)],{'expiresIn':String(config_1['config'][_0x4ab061(0x12d)][_0x4ab061(0x130)])});}async[a36_0x181842(0x12e)](_0x11e0c5){const _0x1a78d2=a36_0x181842,{username:_0x8502a6,password:_0x2f59b2}=_0x11e0c5;if(_0x8502a6===config_1[_0x1a78d2(0x13f)][_0x1a78d2(0x13d)][_0x1a78d2(0x128)]){const _0x3973bb=await bcryptjs_1[_0x1a78d2(0x12a)][_0x1a78d2(0x136)](_0x2f59b2,config_1['config'][_0x1a78d2(0x13d)][_0x1a78d2(0x13e)]);if(_0x3973bb){const _0x473331=this[_0x1a78d2(0x143)]({'id':_0x1a78d2(0x13d),'username':config_1[_0x1a78d2(0x13f)][_0x1a78d2(0x13d)][_0x1a78d2(0x128)],'role':_0x1a78d2(0x13d)});return{'access_token':_0x473331,'role':_0x1a78d2(0x13d)};}}const _0x2e2de9=await database_1[_0x1a78d2(0x12a)]['shop']['findUnique']({'where':{'username':_0x8502a6},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x2e2de9)throw new Error(_0x1a78d2(0x134));if(_0x2e2de9['status']!==_0x1a78d2(0x13c))throw new Error(_0x1a78d2(0x12c));const _0x4538d4=await bcryptjs_1[_0x1a78d2(0x12a)]['compare'](_0x2f59b2,_0x2e2de9['password']);if(!_0x4538d4)throw new Error(_0x1a78d2(0x134));const _0x1d9fe0=this['generateToken']({'id':_0x2e2de9['id'],'username':_0x2e2de9['username'],'role':_0x1a78d2(0x141)});return{'access_token':_0x1d9fe0,'role':_0x1a78d2(0x141),'user':{'id':_0x2e2de9['id'],'name':_0x2e2de9[_0x1a78d2(0x148)],'username':_0x2e2de9[_0x1a78d2(0x128)]}};}async[a36_0x181842(0x133)](_0x3df772){const _0xf83280=a36_0x181842;try{const _0x4bc89e=jsonwebtoken_1[_0xf83280(0x12a)][_0xf83280(0x149)](_0x3df772,config_1['config']['jwt'][_0xf83280(0x13a)]);return _0x4bc89e;}catch(_0x99cf5e){throw new Error(_0xf83280(0x129));}}}exports['AuthService']=AuthService;