'use strict';const a49_0x2b6be7=a49_0x4976;(function(_0x27f1d3,_0x5bf697){const _0x2aa4c8=a49_0x4976,_0x1037ea=_0x27f1d3();while(!![]){try{const _0x26d7e1=-parseInt(_0x2aa4c8(0x1c8))/0x1+-parseInt(_0x2aa4c8(0x1c6))/0x2*(parseInt(_0x2aa4c8(0x1bc))/0x3)+parseInt(_0x2aa4c8(0x1b6))/0x4+parseInt(_0x2aa4c8(0x1d1))/0x5+-parseInt(_0x2aa4c8(0x1ba))/0x6*(-parseInt(_0x2aa4c8(0x1ca))/0x7)+parseInt(_0x2aa4c8(0x1b9))/0x8*(-parseInt(_0x2aa4c8(0x1be))/0x9)+parseInt(_0x2aa4c8(0x1bb))/0xa;if(_0x26d7e1===_0x5bf697)break;else _0x1037ea['push'](_0x1037ea['shift']());}catch(_0x4412ae){_0x1037ea['push'](_0x1037ea['shift']());}}}(a49_0x4f66,0x6e9fd));var __importDefault=this&&this[a49_0x2b6be7(0x1bd)]||function(_0x153524){const _0xf1156f=a49_0x2b6be7;return _0x153524&&_0x153524[_0xf1156f(0x1bf)]?_0x153524:{'default':_0x153524};};function a49_0x4f66(){const _0x32a9da=['438YqKAul','11614660NmvTtN','6NfHQVB','__importDefault','3699AbumUN','__esModule','verify','generateToken','secret','shop','ACTIVE','Invalid\x20credentials','296756XpBhgN','jwt','497572rSdmFU','username','26621IlYZXs','default','verifyToken','sign','AuthService','compare','findUnique','1102915yFpyeC','config','defineProperty','admin','../config/database','login','expiresIn','bcryptjs','Invalid\x20token','759568OruOEb','Account\x20is\x20not\x20active','status','11720hdrrdV'];a49_0x4f66=function(){return _0x32a9da;};return a49_0x4f66();}Object[a49_0x2b6be7(0x1d3)](exports,'__esModule',{'value':!![]}),exports[a49_0x2b6be7(0x1ce)]=void 0x0;const bcryptjs_1=__importDefault(require(a49_0x2b6be7(0x1b4))),jsonwebtoken_1=__importDefault(require('jsonwebtoken')),database_1=__importDefault(require(a49_0x2b6be7(0x1d5))),config_1=require('../config/config');function a49_0x4976(_0x5a70fd,_0x2415b0){_0x5a70fd=_0x5a70fd-0x1b4;const _0x4f66dc=a49_0x4f66();let _0x497674=_0x4f66dc[_0x5a70fd];return _0x497674;}class AuthService{[a49_0x2b6be7(0x1c1)](_0x435957){const _0x4e1439=a49_0x2b6be7;return jsonwebtoken_1[_0x4e1439(0x1cb)][_0x4e1439(0x1cd)](_0x435957,config_1[_0x4e1439(0x1d2)]['jwt'][_0x4e1439(0x1c2)],{'expiresIn':String(config_1[_0x4e1439(0x1d2)][_0x4e1439(0x1c7)][_0x4e1439(0x1d7)])});}async[a49_0x2b6be7(0x1d6)](_0x419616){const _0x4bd62e=a49_0x2b6be7,{username:_0x11049d,password:_0x2efcbd}=_0x419616;if(_0x11049d===config_1[_0x4bd62e(0x1d2)][_0x4bd62e(0x1d4)]['username']){const _0x1a4f72=await bcryptjs_1[_0x4bd62e(0x1cb)]['compare'](_0x2efcbd,config_1['config']['admin']['passwordHash']);if(_0x1a4f72){const _0x2bb899=this[_0x4bd62e(0x1c1)]({'id':_0x4bd62e(0x1d4),'username':config_1['config'][_0x4bd62e(0x1d4)][_0x4bd62e(0x1c9)],'role':'admin'});return{'access_token':_0x2bb899,'role':_0x4bd62e(0x1d4)};}}const _0x357f05=await database_1[_0x4bd62e(0x1cb)][_0x4bd62e(0x1c3)][_0x4bd62e(0x1d0)]({'where':{'username':_0x11049d},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x357f05)throw new Error(_0x4bd62e(0x1c5));if(_0x357f05[_0x4bd62e(0x1b8)]!==_0x4bd62e(0x1c4))throw new Error(_0x4bd62e(0x1b7));const _0x2ca618=await bcryptjs_1[_0x4bd62e(0x1cb)][_0x4bd62e(0x1cf)](_0x2efcbd,_0x357f05['password']);if(!_0x2ca618)throw new Error(_0x4bd62e(0x1c5));const _0x582d0f=this[_0x4bd62e(0x1c1)]({'id':_0x357f05['id'],'username':_0x357f05[_0x4bd62e(0x1c9)],'role':_0x4bd62e(0x1c3)});return{'access_token':_0x582d0f,'role':_0x4bd62e(0x1c3),'user':{'id':_0x357f05['id'],'name':_0x357f05['name'],'username':_0x357f05[_0x4bd62e(0x1c9)]}};}async[a49_0x2b6be7(0x1cc)](_0x1afa97){const _0x2c1a5b=a49_0x2b6be7;try{const _0x4ba43e=jsonwebtoken_1[_0x2c1a5b(0x1cb)][_0x2c1a5b(0x1c0)](_0x1afa97,config_1['config'][_0x2c1a5b(0x1c7)][_0x2c1a5b(0x1c2)]);return _0x4ba43e;}catch(_0x5ec000){throw new Error(_0x2c1a5b(0x1b5));}}}exports[a49_0x2b6be7(0x1ce)]=AuthService;