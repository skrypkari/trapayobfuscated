'use strict';const a49_0x1a72e7=a49_0x2905;(function(_0x32b466,_0x44a95c){const _0x2a26ea=a49_0x2905,_0x1d4c7e=_0x32b466();while(!![]){try{const _0x19f25c=-parseInt(_0x2a26ea(0x101))/0x1*(parseInt(_0x2a26ea(0xfb))/0x2)+-parseInt(_0x2a26ea(0xe6))/0x3*(-parseInt(_0x2a26ea(0xdf))/0x4)+-parseInt(_0x2a26ea(0xe2))/0x5+parseInt(_0x2a26ea(0xf3))/0x6*(parseInt(_0x2a26ea(0x100))/0x7)+parseInt(_0x2a26ea(0xfc))/0x8*(-parseInt(_0x2a26ea(0xe1))/0x9)+parseInt(_0x2a26ea(0xf1))/0xa*(-parseInt(_0x2a26ea(0xfd))/0xb)+parseInt(_0x2a26ea(0xe5))/0xc;if(_0x19f25c===_0x44a95c)break;else _0x1d4c7e['push'](_0x1d4c7e['shift']());}catch(_0x511b39){_0x1d4c7e['push'](_0x1d4c7e['shift']());}}}(a49_0x28c1,0xe67f9));var __importDefault=this&&this[a49_0x1a72e7(0xf7)]||function(_0x2da2ca){return _0x2da2ca&&_0x2da2ca['__esModule']?_0x2da2ca:{'default':_0x2da2ca};};function a49_0x2905(_0x547616,_0x1b1015){_0x547616=_0x547616-0xdd;const _0x28c134=a49_0x28c1();let _0x290595=_0x28c134[_0x547616];return _0x290595;}Object[a49_0x1a72e7(0xed)](exports,a49_0x1a72e7(0xfe),{'value':!![]}),exports[a49_0x1a72e7(0xe0)]=void 0x0;const bcryptjs_1=__importDefault(require(a49_0x1a72e7(0xde))),jsonwebtoken_1=__importDefault(require(a49_0x1a72e7(0xea))),database_1=__importDefault(require(a49_0x1a72e7(0xec))),config_1=require('../config/config');class AuthService{[a49_0x1a72e7(0xdd)](_0x48c63a){const _0x30f15f=a49_0x1a72e7;return jsonwebtoken_1[_0x30f15f(0xf9)][_0x30f15f(0xe7)](_0x48c63a,config_1[_0x30f15f(0xff)][_0x30f15f(0xe8)][_0x30f15f(0xe3)],{'expiresIn':String(config_1['config'][_0x30f15f(0xe8)]['expiresIn'])});}async[a49_0x1a72e7(0xf5)](_0x8fbe25){const _0x27b2b8=a49_0x1a72e7,{username:_0x2d1eae,password:_0xe92c22}=_0x8fbe25;if(_0x2d1eae===config_1[_0x27b2b8(0xff)][_0x27b2b8(0xef)][_0x27b2b8(0xe9)]){const _0x563969=await bcryptjs_1[_0x27b2b8(0xf9)][_0x27b2b8(0xf6)](_0xe92c22,config_1[_0x27b2b8(0xff)]['admin'][_0x27b2b8(0xeb)]);if(_0x563969){const _0x355641=this[_0x27b2b8(0xdd)]({'id':'admin','username':config_1[_0x27b2b8(0xff)]['admin']['username'],'role':'admin'});return{'access_token':_0x355641,'role':'admin'};}}const _0x4d3e6f=await database_1[_0x27b2b8(0xf9)][_0x27b2b8(0xf0)]['findUnique']({'where':{'username':_0x2d1eae},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x4d3e6f)throw new Error(_0x27b2b8(0xee));if(_0x4d3e6f['status']!=='ACTIVE')throw new Error(_0x27b2b8(0xf2));const _0x429cec=await bcryptjs_1[_0x27b2b8(0xf9)][_0x27b2b8(0xf6)](_0xe92c22,_0x4d3e6f[_0x27b2b8(0xf4)]);if(!_0x429cec)throw new Error(_0x27b2b8(0xee));const _0x20cfd3=this['generateToken']({'id':_0x4d3e6f['id'],'username':_0x4d3e6f['username'],'role':_0x27b2b8(0xf0)});return{'access_token':_0x20cfd3,'role':_0x27b2b8(0xf0),'user':{'id':_0x4d3e6f['id'],'name':_0x4d3e6f[_0x27b2b8(0xfa)],'username':_0x4d3e6f[_0x27b2b8(0xe9)]}};}async[a49_0x1a72e7(0xe4)](_0x693bbc){const _0x188972=a49_0x1a72e7;try{const _0x5e9e7d=jsonwebtoken_1[_0x188972(0xf9)][_0x188972(0xf8)](_0x693bbc,config_1[_0x188972(0xff)][_0x188972(0xe8)]['secret']);return _0x5e9e7d;}catch(_0x2c18f4){throw new Error('Invalid\x20token');}}}exports[a49_0x1a72e7(0xe0)]=AuthService;function a49_0x28c1(){const _0x3d60fd=['__esModule','config','7gauMrN','251JZiwul','generateToken','bcryptjs','4815304nwyoKn','AuthService','1449qAySrd','4121310PpWKWE','secret','verifyToken','26968080kfjVgu','3digfhs','sign','jwt','username','jsonwebtoken','passwordHash','../config/database','defineProperty','Invalid\x20credentials','admin','shop','130lVNKLk','Account\x20is\x20not\x20active','10726356oXfJZz','password','login','compare','__importDefault','verify','default','name','5494IPjYWs','72280DExIbR','1122319LkGYCD'];a49_0x28c1=function(){return _0x3d60fd;};return a49_0x28c1();}