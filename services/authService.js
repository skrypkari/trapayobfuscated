'use strict';const a36_0x5b8d09=a36_0x2cb5;(function(_0x1c5def,_0x1f9a95){const _0x4c6b66=a36_0x2cb5,_0x691fde=_0x1c5def();while(!![]){try{const _0x5187ac=parseInt(_0x4c6b66(0xf4))/0x1+parseInt(_0x4c6b66(0xe6))/0x2+-parseInt(_0x4c6b66(0xf3))/0x3*(-parseInt(_0x4c6b66(0xee))/0x4)+parseInt(_0x4c6b66(0x104))/0x5*(-parseInt(_0x4c6b66(0xf7))/0x6)+parseInt(_0x4c6b66(0xf9))/0x7*(-parseInt(_0x4c6b66(0x105))/0x8)+parseInt(_0x4c6b66(0xe9))/0x9*(-parseInt(_0x4c6b66(0xec))/0xa)+parseInt(_0x4c6b66(0xe4))/0xb;if(_0x5187ac===_0x1f9a95)break;else _0x691fde['push'](_0x691fde['shift']());}catch(_0x339c26){_0x691fde['push'](_0x691fde['shift']());}}}(a36_0x3713,0x2dbaa));var __importDefault=this&&this['__importDefault']||function(_0x56b357){const _0x547397=a36_0x2cb5;return _0x56b357&&_0x56b357[_0x547397(0xe7)]?_0x56b357:{'default':_0x56b357};};Object[a36_0x5b8d09(0xe3)](exports,a36_0x5b8d09(0xe7),{'value':!![]}),exports[a36_0x5b8d09(0xed)]=void 0x0;const bcryptjs_1=__importDefault(require(a36_0x5b8d09(0xf5))),jsonwebtoken_1=__importDefault(require(a36_0x5b8d09(0x100))),database_1=__importDefault(require('../config/database')),config_1=require(a36_0x5b8d09(0xf8));function a36_0x2cb5(_0x3a36e8,_0x3fd6b2){const _0x371313=a36_0x3713();return a36_0x2cb5=function(_0x2cb55e,_0x4bc775){_0x2cb55e=_0x2cb55e-0xe3;let _0x50bf5e=_0x371313[_0x2cb55e];return _0x50bf5e;},a36_0x2cb5(_0x3a36e8,_0x3fd6b2);}class AuthService{[a36_0x5b8d09(0x103)](_0x47136c){const _0x23f943=a36_0x5b8d09;return jsonwebtoken_1[_0x23f943(0xf2)]['sign'](_0x47136c,config_1[_0x23f943(0x102)]['jwt'][_0x23f943(0x101)],{'expiresIn':String(config_1[_0x23f943(0x102)][_0x23f943(0xfd)][_0x23f943(0xfc)])});}async[a36_0x5b8d09(0xf1)](_0x1ce849){const _0x4f6e85=a36_0x5b8d09,{username:_0x5abd33,password:_0x14652b}=_0x1ce849;if(_0x5abd33===config_1['config']['admin'][_0x4f6e85(0xfb)]){const _0x27e6e7=await bcryptjs_1[_0x4f6e85(0xf2)][_0x4f6e85(0xf0)](_0x14652b,config_1[_0x4f6e85(0x102)][_0x4f6e85(0xef)][_0x4f6e85(0xf6)]);if(_0x27e6e7){const _0x3f69e3=this['generateToken']({'id':_0x4f6e85(0xef),'username':config_1['config'][_0x4f6e85(0xef)][_0x4f6e85(0xfb)],'role':'admin'});return{'access_token':_0x3f69e3,'role':_0x4f6e85(0xef)};}}const _0x19b762=await database_1['default']['shop']['findUnique']({'where':{'username':_0x5abd33},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x19b762)throw new Error(_0x4f6e85(0xfa));if(_0x19b762['status']!==_0x4f6e85(0xea))throw new Error(_0x4f6e85(0xff));const _0x55399b=await bcryptjs_1[_0x4f6e85(0xf2)]['compare'](_0x14652b,_0x19b762[_0x4f6e85(0xeb)]);if(!_0x55399b)throw new Error(_0x4f6e85(0xfa));const _0x1c9a5c=this[_0x4f6e85(0x103)]({'id':_0x19b762['id'],'username':_0x19b762['username'],'role':'shop'});return{'access_token':_0x1c9a5c,'role':_0x4f6e85(0xe5),'user':{'id':_0x19b762['id'],'name':_0x19b762['name'],'username':_0x19b762['username']}};}async[a36_0x5b8d09(0xfe)](_0x4d49f8){const _0x3171d8=a36_0x5b8d09;try{const _0x1876c0=jsonwebtoken_1['default'][_0x3171d8(0xe8)](_0x4d49f8,config_1[_0x3171d8(0x102)][_0x3171d8(0xfd)][_0x3171d8(0x101)]);return _0x1876c0;}catch(_0x2e71cd){throw new Error('Invalid\x20token');}}}function a36_0x3713(){const _0x4e2ba6=['1518913kDaYOm','shop','637746EOXZKz','__esModule','verify','2511xKcXIC','ACTIVE','password','12730uLajvX','AuthService','797428eXcQWo','admin','compare','login','default','3ijUSzu','267564tTWqmv','bcryptjs','passwordHash','1683294wAQUzt','../config/config','30695fMRlPe','Invalid\x20credentials','username','expiresIn','jwt','verifyToken','Account\x20is\x20not\x20active','jsonwebtoken','secret','config','generateToken','5wlvqOJ','184ctcfnV','defineProperty'];a36_0x3713=function(){return _0x4e2ba6;};return a36_0x3713();}exports['AuthService']=AuthService;