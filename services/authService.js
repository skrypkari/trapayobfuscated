'use strict';const a41_0x33ad3c=a41_0x5d0f;(function(_0x3285e3,_0x121ec4){const _0x1ba090=a41_0x5d0f,_0xf22b83=_0x3285e3();while(!![]){try{const _0xac4eee=-parseInt(_0x1ba090(0x1d2))/0x1+parseInt(_0x1ba090(0x1db))/0x2+-parseInt(_0x1ba090(0x1c6))/0x3+-parseInt(_0x1ba090(0x1e6))/0x4*(parseInt(_0x1ba090(0x1ce))/0x5)+parseInt(_0x1ba090(0x1c5))/0x6*(-parseInt(_0x1ba090(0x1e7))/0x7)+-parseInt(_0x1ba090(0x1de))/0x8*(parseInt(_0x1ba090(0x1c9))/0x9)+parseInt(_0x1ba090(0x1d5))/0xa;if(_0xac4eee===_0x121ec4)break;else _0xf22b83['push'](_0xf22b83['shift']());}catch(_0x3149ac){_0xf22b83['push'](_0xf22b83['shift']());}}}(a41_0x2cb9,0x72140));function a41_0x5d0f(_0x13b276,_0x4a3814){const _0x2cb996=a41_0x2cb9();return a41_0x5d0f=function(_0x5d0f7e,_0x352de8){_0x5d0f7e=_0x5d0f7e-0x1c3;let _0x12f62a=_0x2cb996[_0x5d0f7e];return _0x12f62a;},a41_0x5d0f(_0x13b276,_0x4a3814);}var __importDefault=this&&this[a41_0x33ad3c(0x1c7)]||function(_0xa48b75){const _0x55d78c=a41_0x33ad3c;return _0xa48b75&&_0xa48b75[_0x55d78c(0x1d3)]?_0xa48b75:{'default':_0xa48b75};};Object[a41_0x33ad3c(0x1e1)](exports,'__esModule',{'value':!![]}),exports[a41_0x33ad3c(0x1d0)]=void 0x0;function a41_0x2cb9(){const _0x57d90d=['secret','default','../config/config','findUnique','6360DaaKnO','2327475IJgGEd','__importDefault','Account\x20is\x20not\x20active','9oGtuPI','status','verifyToken','jsonwebtoken','jwt','140615MRpHPB','generateToken','AuthService','username','919889dZcNud','__esModule','login','35885700aHwMal','admin','passwordHash','bcryptjs','shop','../config/database','1670778ygYMIw','password','config','3676384aIXKtN','expiresIn','ACTIVE','defineProperty','compare','Invalid\x20token','sign','Invalid\x20credentials','124GZhCyt','6139KGmrLY'];a41_0x2cb9=function(){return _0x57d90d;};return a41_0x2cb9();}const bcryptjs_1=__importDefault(require(a41_0x33ad3c(0x1d8))),jsonwebtoken_1=__importDefault(require(a41_0x33ad3c(0x1cc))),database_1=__importDefault(require(a41_0x33ad3c(0x1da))),config_1=require(a41_0x33ad3c(0x1c3));class AuthService{[a41_0x33ad3c(0x1cf)](_0x4a7254){const _0x86442b=a41_0x33ad3c;return jsonwebtoken_1[_0x86442b(0x1e9)][_0x86442b(0x1e4)](_0x4a7254,config_1[_0x86442b(0x1dd)][_0x86442b(0x1cd)][_0x86442b(0x1e8)],{'expiresIn':String(config_1[_0x86442b(0x1dd)][_0x86442b(0x1cd)][_0x86442b(0x1df)])});}async[a41_0x33ad3c(0x1d4)](_0x4f8cb1){const _0x4c87d2=a41_0x33ad3c,{username:_0x1eb5e7,password:_0x68a7e4}=_0x4f8cb1;if(_0x1eb5e7===config_1[_0x4c87d2(0x1dd)][_0x4c87d2(0x1d6)][_0x4c87d2(0x1d1)]){const _0x360ff9=await bcryptjs_1['default'][_0x4c87d2(0x1e2)](_0x68a7e4,config_1[_0x4c87d2(0x1dd)][_0x4c87d2(0x1d6)][_0x4c87d2(0x1d7)]);if(_0x360ff9){const _0x213b40=this['generateToken']({'id':_0x4c87d2(0x1d6),'username':config_1['config'][_0x4c87d2(0x1d6)][_0x4c87d2(0x1d1)],'role':_0x4c87d2(0x1d6)});return{'access_token':_0x213b40,'role':'admin'};}}const _0x2551f1=await database_1[_0x4c87d2(0x1e9)][_0x4c87d2(0x1d9)][_0x4c87d2(0x1c4)]({'where':{'username':_0x1eb5e7},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x2551f1)throw new Error(_0x4c87d2(0x1e5));if(_0x2551f1[_0x4c87d2(0x1ca)]!==_0x4c87d2(0x1e0))throw new Error(_0x4c87d2(0x1c8));const _0x3d1b45=await bcryptjs_1[_0x4c87d2(0x1e9)][_0x4c87d2(0x1e2)](_0x68a7e4,_0x2551f1[_0x4c87d2(0x1dc)]);if(!_0x3d1b45)throw new Error('Invalid\x20credentials');const _0x7960f2=this[_0x4c87d2(0x1cf)]({'id':_0x2551f1['id'],'username':_0x2551f1[_0x4c87d2(0x1d1)],'role':_0x4c87d2(0x1d9)});return{'access_token':_0x7960f2,'role':_0x4c87d2(0x1d9),'user':{'id':_0x2551f1['id'],'name':_0x2551f1['name'],'username':_0x2551f1[_0x4c87d2(0x1d1)]}};}async[a41_0x33ad3c(0x1cb)](_0x1ee656){const _0x103ded=a41_0x33ad3c;try{const _0x55eda7=jsonwebtoken_1[_0x103ded(0x1e9)]['verify'](_0x1ee656,config_1['config'][_0x103ded(0x1cd)][_0x103ded(0x1e8)]);return _0x55eda7;}catch(_0x2afd0c){throw new Error(_0x103ded(0x1e3));}}}exports[a41_0x33ad3c(0x1d0)]=AuthService;