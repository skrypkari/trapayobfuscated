'use strict';const a34_0x4a95b0=a34_0x44f5;(function(_0x1f856a,_0x50b29a){const _0x431550=a34_0x44f5,_0x5200bc=_0x1f856a();while(!![]){try{const _0x57c20c=parseInt(_0x431550(0x109))/0x1*(parseInt(_0x431550(0x129))/0x2)+-parseInt(_0x431550(0x119))/0x3+-parseInt(_0x431550(0x115))/0x4*(-parseInt(_0x431550(0x123))/0x5)+parseInt(_0x431550(0x10d))/0x6*(-parseInt(_0x431550(0x118))/0x7)+parseInt(_0x431550(0x126))/0x8*(parseInt(_0x431550(0x12a))/0x9)+-parseInt(_0x431550(0x11e))/0xa*(parseInt(_0x431550(0x12c))/0xb)+parseInt(_0x431550(0x121))/0xc;if(_0x57c20c===_0x50b29a)break;else _0x5200bc['push'](_0x5200bc['shift']());}catch(_0x26ccf9){_0x5200bc['push'](_0x5200bc['shift']());}}}(a34_0x164a,0x2e7f3));function a34_0x164a(){const _0x902ff=['81stmOQv','expiresIn','11ErCLDn','shop','1MIxskT','status','config','password','1868844XDWetS','defineProperty','admin','Invalid\x20credentials','generateToken','jsonwebtoken','../config/config','secret','7864vqLodC','AuthService','default','7iyCmJi','1025220HGXOVM','name','bcryptjs','compare','ACTIVE','182540wuGfdq','findUnique','sign','6578304aqJvkE','Account\x20is\x20not\x20active','695pDmzIy','jwt','__esModule','26744iXsXjR','username','__importDefault','20732xBiWPv'];a34_0x164a=function(){return _0x902ff;};return a34_0x164a();}function a34_0x44f5(_0x2c95a2,_0x42f03f){const _0x164afa=a34_0x164a();return a34_0x44f5=function(_0x44f594,_0x4b110f){_0x44f594=_0x44f594-0x109;let _0x2ecdaf=_0x164afa[_0x44f594];return _0x2ecdaf;},a34_0x44f5(_0x2c95a2,_0x42f03f);}var __importDefault=this&&this[a34_0x4a95b0(0x128)]||function(_0x5e4afa){const _0x15f1e9=a34_0x4a95b0;return _0x5e4afa&&_0x5e4afa[_0x15f1e9(0x125)]?_0x5e4afa:{'default':_0x5e4afa};};Object[a34_0x4a95b0(0x10e)](exports,a34_0x4a95b0(0x125),{'value':!![]}),exports[a34_0x4a95b0(0x116)]=void 0x0;const bcryptjs_1=__importDefault(require(a34_0x4a95b0(0x11b))),jsonwebtoken_1=__importDefault(require(a34_0x4a95b0(0x112))),database_1=__importDefault(require('../config/database')),config_1=require(a34_0x4a95b0(0x113));class AuthService{['generateToken'](_0x2d4dff){const _0x5a7b2a=a34_0x4a95b0;return jsonwebtoken_1[_0x5a7b2a(0x117)][_0x5a7b2a(0x120)](_0x2d4dff,config_1[_0x5a7b2a(0x10b)][_0x5a7b2a(0x124)][_0x5a7b2a(0x114)],{'expiresIn':String(config_1[_0x5a7b2a(0x10b)]['jwt'][_0x5a7b2a(0x12b)])});}async['login'](_0x12e8db){const _0x55d541=a34_0x4a95b0,{username:_0x3f5a05,password:_0x4cfcbc}=_0x12e8db;if(_0x3f5a05===config_1[_0x55d541(0x10b)]['admin'][_0x55d541(0x127)]){const _0x38d52f=await bcryptjs_1['default'][_0x55d541(0x11c)](_0x4cfcbc,config_1['config'][_0x55d541(0x10f)]['passwordHash']);if(_0x38d52f){const _0x3ac56d=this[_0x55d541(0x111)]({'id':'admin','username':config_1[_0x55d541(0x10b)][_0x55d541(0x10f)]['username'],'role':_0x55d541(0x10f)});return{'access_token':_0x3ac56d,'role':_0x55d541(0x10f)};}}const _0x3b9243=await database_1['default']['shop'][_0x55d541(0x11f)]({'where':{'username':_0x3f5a05},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x3b9243)throw new Error(_0x55d541(0x110));if(_0x3b9243[_0x55d541(0x10a)]!==_0x55d541(0x11d))throw new Error(_0x55d541(0x122));const _0x460d3d=await bcryptjs_1[_0x55d541(0x117)][_0x55d541(0x11c)](_0x4cfcbc,_0x3b9243[_0x55d541(0x10c)]);if(!_0x460d3d)throw new Error('Invalid\x20credentials');const _0x52d91f=this[_0x55d541(0x111)]({'id':_0x3b9243['id'],'username':_0x3b9243[_0x55d541(0x127)],'role':_0x55d541(0x12d)});return{'access_token':_0x52d91f,'role':_0x55d541(0x12d),'user':{'id':_0x3b9243['id'],'name':_0x3b9243[_0x55d541(0x11a)],'username':_0x3b9243[_0x55d541(0x127)]}};}async['verifyToken'](_0x4d489a){const _0x15d6e7=a34_0x4a95b0;try{const _0x136ebf=jsonwebtoken_1[_0x15d6e7(0x117)]['verify'](_0x4d489a,config_1[_0x15d6e7(0x10b)]['jwt'][_0x15d6e7(0x114)]);return _0x136ebf;}catch(_0x3eee72){throw new Error('Invalid\x20token');}}}exports['AuthService']=AuthService;