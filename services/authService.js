'use strict';const a36_0x1084ca=a36_0x1c91;(function(_0x2a2421,_0x1fbd39){const _0x467b27=a36_0x1c91,_0x48e6e1=_0x2a2421();while(!![]){try{const _0x4cb6cf=parseInt(_0x467b27(0x108))/0x1*(parseInt(_0x467b27(0xf3))/0x2)+parseInt(_0x467b27(0xeb))/0x3+parseInt(_0x467b27(0x105))/0x4+-parseInt(_0x467b27(0x10b))/0x5+parseInt(_0x467b27(0xee))/0x6+parseInt(_0x467b27(0xfe))/0x7*(parseInt(_0x467b27(0xf5))/0x8)+-parseInt(_0x467b27(0x107))/0x9*(parseInt(_0x467b27(0xfc))/0xa);if(_0x4cb6cf===_0x1fbd39)break;else _0x48e6e1['push'](_0x48e6e1['shift']());}catch(_0x495664){_0x48e6e1['push'](_0x48e6e1['shift']());}}}(a36_0x1978,0xdec20));var __importDefault=this&&this['__importDefault']||function(_0x55fcad){const _0x4f5d49=a36_0x1c91;return _0x55fcad&&_0x55fcad[_0x4f5d49(0x10a)]?_0x55fcad:{'default':_0x55fcad};};Object[a36_0x1084ca(0x109)](exports,a36_0x1084ca(0x10a),{'value':!![]}),exports['AuthService']=void 0x0;function a36_0x1c91(_0x4359b3,_0x582afa){const _0x197848=a36_0x1978();return a36_0x1c91=function(_0x1c912a,_0x3e6185){_0x1c912a=_0x1c912a-0xe9;let _0x1fe79a=_0x197848[_0x1c912a];return _0x1fe79a;},a36_0x1c91(_0x4359b3,_0x582afa);}const bcryptjs_1=__importDefault(require(a36_0x1084ca(0xef))),jsonwebtoken_1=__importDefault(require(a36_0x1084ca(0x102))),database_1=__importDefault(require(a36_0x1084ca(0x103))),config_1=require('../config/config');function a36_0x1978(){const _0x5b9196=['verify','9WClkrE','3TAfxfo','defineProperty','__esModule','4002965PKwdCy','default','Invalid\x20token','findUnique','1458813JEbjun','compare','AuthService','3435972pKULiY','bcryptjs','admin','password','Account\x20is\x20not\x20active','465908aFobzg','expiresIn','1616kmtOzP','secret','generateToken','shop','passwordHash','Invalid\x20credentials','name','19407330UjtPXW','sign','32123cRJSrh','jwt','username','login','jsonwebtoken','../config/database','config','3875876PnpEcF'];a36_0x1978=function(){return _0x5b9196;};return a36_0x1978();}class AuthService{[a36_0x1084ca(0xf7)](_0x5bab00){const _0xc19476=a36_0x1084ca;return jsonwebtoken_1[_0xc19476(0x10c)][_0xc19476(0xfd)](_0x5bab00,config_1[_0xc19476(0x104)][_0xc19476(0xff)][_0xc19476(0xf6)],{'expiresIn':String(config_1['config'][_0xc19476(0xff)][_0xc19476(0xf4)])});}async[a36_0x1084ca(0x101)](_0x49e561){const _0x4e4d16=a36_0x1084ca,{username:_0x2d508f,password:_0x298281}=_0x49e561;if(_0x2d508f===config_1[_0x4e4d16(0x104)]['admin']['username']){const _0x6d00e1=await bcryptjs_1['default'][_0x4e4d16(0xec)](_0x298281,config_1['config']['admin'][_0x4e4d16(0xf9)]);if(_0x6d00e1){const _0x2d4bd0=this['generateToken']({'id':_0x4e4d16(0xf0),'username':config_1['config'][_0x4e4d16(0xf0)][_0x4e4d16(0x100)],'role':'admin'});return{'access_token':_0x2d4bd0,'role':_0x4e4d16(0xf0)};}}const _0x199143=await database_1[_0x4e4d16(0x10c)][_0x4e4d16(0xf8)][_0x4e4d16(0xea)]({'where':{'username':_0x2d508f},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x199143)throw new Error(_0x4e4d16(0xfa));if(_0x199143['status']!=='ACTIVE')throw new Error(_0x4e4d16(0xf2));const _0x39c43b=await bcryptjs_1[_0x4e4d16(0x10c)][_0x4e4d16(0xec)](_0x298281,_0x199143[_0x4e4d16(0xf1)]);if(!_0x39c43b)throw new Error(_0x4e4d16(0xfa));const _0x2c763b=this[_0x4e4d16(0xf7)]({'id':_0x199143['id'],'username':_0x199143['username'],'role':_0x4e4d16(0xf8)});return{'access_token':_0x2c763b,'role':_0x4e4d16(0xf8),'user':{'id':_0x199143['id'],'name':_0x199143[_0x4e4d16(0xfb)],'username':_0x199143[_0x4e4d16(0x100)]}};}async['verifyToken'](_0x258d00){const _0x59fcde=a36_0x1084ca;try{const _0x54eecb=jsonwebtoken_1['default'][_0x59fcde(0x106)](_0x258d00,config_1['config'][_0x59fcde(0xff)][_0x59fcde(0xf6)]);return _0x54eecb;}catch(_0x281e60){throw new Error(_0x59fcde(0xe9));}}}exports[a36_0x1084ca(0xed)]=AuthService;