'use strict';const a34_0x4dfc1d=a34_0x18a8;(function(_0x56702d,_0x255e46){const _0x1ef78f=a34_0x18a8,_0x4a12e0=_0x56702d();while(!![]){try{const _0x1a4ae4=parseInt(_0x1ef78f(0x91))/0x1*(parseInt(_0x1ef78f(0xa7))/0x2)+parseInt(_0x1ef78f(0xa5))/0x3*(-parseInt(_0x1ef78f(0x96))/0x4)+-parseInt(_0x1ef78f(0x8f))/0x5+parseInt(_0x1ef78f(0x98))/0x6*(parseInt(_0x1ef78f(0x92))/0x7)+parseInt(_0x1ef78f(0xac))/0x8+-parseInt(_0x1ef78f(0x99))/0x9+-parseInt(_0x1ef78f(0xad))/0xa*(parseInt(_0x1ef78f(0x97))/0xb);if(_0x1a4ae4===_0x255e46)break;else _0x4a12e0['push'](_0x4a12e0['shift']());}catch(_0x5aa966){_0x4a12e0['push'](_0x4a12e0['shift']());}}}(a34_0x4cd0,0x217e0));var __importDefault=this&&this['__importDefault']||function(_0x26f38b){return _0x26f38b&&_0x26f38b['__esModule']?_0x26f38b:{'default':_0x26f38b};};Object[a34_0x4dfc1d(0xa1)](exports,a34_0x4dfc1d(0x95),{'value':!![]}),exports[a34_0x4dfc1d(0x9b)]=void 0x0;const bcryptjs_1=__importDefault(require(a34_0x4dfc1d(0xa9))),jsonwebtoken_1=__importDefault(require(a34_0x4dfc1d(0x88))),database_1=__importDefault(require(a34_0x4dfc1d(0x8c))),config_1=require(a34_0x4dfc1d(0xa4));function a34_0x4cd0(){const _0x2c0aba=['username','AuthService','compare','Account\x20is\x20not\x20active','ACTIVE','name','login','defineProperty','status','jwt','../config/config','510auDXmE','passwordHash','2rGQtVB','sign','bcryptjs','default','verify','2154984TNsblI','12370FDwXaj','jsonwebtoken','findUnique','verifyToken','generateToken','../config/database','config','shop','57865oqedoS','Invalid\x20credentials','96703MeIcRh','58940KpBiEj','secret','admin','__esModule','3044wOqvHG','649ikGOQM','60bZFOhW','892494tXKSjg'];a34_0x4cd0=function(){return _0x2c0aba;};return a34_0x4cd0();}class AuthService{['generateToken'](_0x48884f){const _0x5d688f=a34_0x4dfc1d;return jsonwebtoken_1[_0x5d688f(0xaa)][_0x5d688f(0xa8)](_0x48884f,config_1[_0x5d688f(0x8d)][_0x5d688f(0xa3)][_0x5d688f(0x93)],{'expiresIn':String(config_1[_0x5d688f(0x8d)][_0x5d688f(0xa3)]['expiresIn'])});}async[a34_0x4dfc1d(0xa0)](_0x527f2e){const _0x5e992d=a34_0x4dfc1d,{username:_0x5cceeb,password:_0x576fae}=_0x527f2e;if(_0x5cceeb===config_1[_0x5e992d(0x8d)][_0x5e992d(0x94)][_0x5e992d(0x9a)]){const _0x1474bb=await bcryptjs_1[_0x5e992d(0xaa)][_0x5e992d(0x9c)](_0x576fae,config_1['config'][_0x5e992d(0x94)][_0x5e992d(0xa6)]);if(_0x1474bb){const _0x501398=this[_0x5e992d(0x8b)]({'id':_0x5e992d(0x94),'username':config_1[_0x5e992d(0x8d)][_0x5e992d(0x94)][_0x5e992d(0x9a)],'role':_0x5e992d(0x94)});return{'access_token':_0x501398,'role':_0x5e992d(0x94)};}}const _0x2b11cc=await database_1[_0x5e992d(0xaa)][_0x5e992d(0x8e)][_0x5e992d(0x89)]({'where':{'username':_0x5cceeb},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x2b11cc)throw new Error(_0x5e992d(0x90));if(_0x2b11cc[_0x5e992d(0xa2)]!==_0x5e992d(0x9e))throw new Error(_0x5e992d(0x9d));const _0x1761db=await bcryptjs_1['default'][_0x5e992d(0x9c)](_0x576fae,_0x2b11cc['password']);if(!_0x1761db)throw new Error(_0x5e992d(0x90));const _0x3dad9c=this[_0x5e992d(0x8b)]({'id':_0x2b11cc['id'],'username':_0x2b11cc['username'],'role':'shop'});return{'access_token':_0x3dad9c,'role':_0x5e992d(0x8e),'user':{'id':_0x2b11cc['id'],'name':_0x2b11cc[_0x5e992d(0x9f)],'username':_0x2b11cc[_0x5e992d(0x9a)]}};}async[a34_0x4dfc1d(0x8a)](_0x47f713){const _0x3162bb=a34_0x4dfc1d;try{const _0x274a92=jsonwebtoken_1[_0x3162bb(0xaa)][_0x3162bb(0xab)](_0x47f713,config_1[_0x3162bb(0x8d)]['jwt'][_0x3162bb(0x93)]);return _0x274a92;}catch(_0x229fb5){throw new Error('Invalid\x20token');}}}function a34_0x18a8(_0x2fb2ed,_0x2b42bb){const _0x4cd053=a34_0x4cd0();return a34_0x18a8=function(_0x18a8b1,_0x7b7a53){_0x18a8b1=_0x18a8b1-0x88;let _0x2b52a6=_0x4cd053[_0x18a8b1];return _0x2b52a6;},a34_0x18a8(_0x2fb2ed,_0x2b42bb);}exports[a34_0x4dfc1d(0x9b)]=AuthService;