'use strict';const a39_0x2a4a4a=a39_0x261d;(function(_0x41614b,_0x36ec5c){const _0x543433=a39_0x261d,_0x2617ae=_0x41614b();while(!![]){try{const _0x530fc3=parseInt(_0x543433(0xd9))/0x1+-parseInt(_0x543433(0xc3))/0x2+-parseInt(_0x543433(0xd2))/0x3*(-parseInt(_0x543433(0xcb))/0x4)+-parseInt(_0x543433(0xb5))/0x5*(parseInt(_0x543433(0xc9))/0x6)+parseInt(_0x543433(0xb9))/0x7+parseInt(_0x543433(0xd3))/0x8*(-parseInt(_0x543433(0xcd))/0x9)+parseInt(_0x543433(0xb7))/0xa*(parseInt(_0x543433(0xd7))/0xb);if(_0x530fc3===_0x36ec5c)break;else _0x2617ae['push'](_0x2617ae['shift']());}catch(_0x20445f){_0x2617ae['push'](_0x2617ae['shift']());}}}(a39_0x1bb0,0x837b2));function a39_0x261d(_0x545da4,_0x300897){const _0x1bb017=a39_0x1bb0();return a39_0x261d=function(_0x261d13,_0x331c81){_0x261d13=_0x261d13-0xb5;let _0xb27df3=_0x1bb017[_0x261d13];return _0xb27df3;},a39_0x261d(_0x545da4,_0x300897);}function a39_0x1bb0(){const _0x978a3e=['6827107XtpXvJ','passwordHash','verifyToken','shop','defineProperty','jsonwebtoken','ACTIVE','jwt','status','default','1548420NkIumc','__importDefault','Invalid\x20credentials','config','../config/database','../config/config','288MtRZsn','password','24sowTnr','username','306wWZaCv','secret','findUnique','generateToken','admin','106272nqecPi','185224TMhrLp','bcryptjs','__esModule','login','11eiTryc','AuthService','965644PJjqwk','compare','27155vviwAT','expiresIn','2071570AtjKns','name'];a39_0x1bb0=function(){return _0x978a3e;};return a39_0x1bb0();}var __importDefault=this&&this[a39_0x2a4a4a(0xc4)]||function(_0x17eb17){const _0x3ec6f3=a39_0x2a4a4a;return _0x17eb17&&_0x17eb17[_0x3ec6f3(0xd5)]?_0x17eb17:{'default':_0x17eb17};};Object[a39_0x2a4a4a(0xbd)](exports,a39_0x2a4a4a(0xd5),{'value':!![]}),exports[a39_0x2a4a4a(0xd8)]=void 0x0;const bcryptjs_1=__importDefault(require(a39_0x2a4a4a(0xd4))),jsonwebtoken_1=__importDefault(require(a39_0x2a4a4a(0xbe))),database_1=__importDefault(require(a39_0x2a4a4a(0xc7))),config_1=require(a39_0x2a4a4a(0xc8));class AuthService{[a39_0x2a4a4a(0xd0)](_0x458067){const _0x2ce224=a39_0x2a4a4a;return jsonwebtoken_1[_0x2ce224(0xc2)]['sign'](_0x458067,config_1[_0x2ce224(0xc6)]['jwt'][_0x2ce224(0xce)],{'expiresIn':String(config_1[_0x2ce224(0xc6)][_0x2ce224(0xc0)][_0x2ce224(0xb6)])});}async[a39_0x2a4a4a(0xd6)](_0x1f6a79){const _0x45570a=a39_0x2a4a4a,{username:_0x3422c1,password:_0x42dbb8}=_0x1f6a79;if(_0x3422c1===config_1[_0x45570a(0xc6)][_0x45570a(0xd1)]['username']){const _0x41be61=await bcryptjs_1[_0x45570a(0xc2)][_0x45570a(0xda)](_0x42dbb8,config_1['config'][_0x45570a(0xd1)][_0x45570a(0xba)]);if(_0x41be61){const _0x1a971d=this[_0x45570a(0xd0)]({'id':_0x45570a(0xd1),'username':config_1['config'][_0x45570a(0xd1)]['username'],'role':_0x45570a(0xd1)});return{'access_token':_0x1a971d,'role':_0x45570a(0xd1)};}}const _0x1a840c=await database_1[_0x45570a(0xc2)][_0x45570a(0xbc)][_0x45570a(0xcf)]({'where':{'username':_0x3422c1},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x1a840c)throw new Error(_0x45570a(0xc5));if(_0x1a840c[_0x45570a(0xc1)]!==_0x45570a(0xbf))throw new Error('Account\x20is\x20not\x20active');const _0x140b71=await bcryptjs_1[_0x45570a(0xc2)][_0x45570a(0xda)](_0x42dbb8,_0x1a840c[_0x45570a(0xca)]);if(!_0x140b71)throw new Error(_0x45570a(0xc5));const _0x12583f=this['generateToken']({'id':_0x1a840c['id'],'username':_0x1a840c[_0x45570a(0xcc)],'role':_0x45570a(0xbc)});return{'access_token':_0x12583f,'role':_0x45570a(0xbc),'user':{'id':_0x1a840c['id'],'name':_0x1a840c[_0x45570a(0xb8)],'username':_0x1a840c['username']}};}async[a39_0x2a4a4a(0xbb)](_0x1170a2){const _0x46a227=a39_0x2a4a4a;try{const _0xabd74e=jsonwebtoken_1['default']['verify'](_0x1170a2,config_1[_0x46a227(0xc6)][_0x46a227(0xc0)][_0x46a227(0xce)]);return _0xabd74e;}catch(_0x305761){throw new Error('Invalid\x20token');}}}exports[a39_0x2a4a4a(0xd8)]=AuthService;