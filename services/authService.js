'use strict';const a47_0x523ecc=a47_0x32c5;(function(_0x2019e2,_0x4028b7){const _0x188edf=a47_0x32c5,_0xc97473=_0x2019e2();while(!![]){try{const _0x2b23f3=parseInt(_0x188edf(0xff))/0x1*(parseInt(_0x188edf(0xfc))/0x2)+parseInt(_0x188edf(0x106))/0x3+-parseInt(_0x188edf(0x10d))/0x4*(-parseInt(_0x188edf(0x119))/0x5)+-parseInt(_0x188edf(0xfd))/0x6+-parseInt(_0x188edf(0x10a))/0x7*(-parseInt(_0x188edf(0x11a))/0x8)+-parseInt(_0x188edf(0x101))/0x9*(parseInt(_0x188edf(0x112))/0xa)+parseInt(_0x188edf(0x102))/0xb;if(_0x2b23f3===_0x4028b7)break;else _0xc97473['push'](_0xc97473['shift']());}catch(_0x5e0443){_0xc97473['push'](_0xc97473['shift']());}}}(a47_0x50b4,0x98f7b));var __importDefault=this&&this[a47_0x523ecc(0x120)]||function(_0x3b62e7){const _0xb65cfa=a47_0x523ecc;return _0x3b62e7&&_0x3b62e7[_0xb65cfa(0x10c)]?_0x3b62e7:{'default':_0x3b62e7};};Object[a47_0x523ecc(0x11c)](exports,a47_0x523ecc(0x10c),{'value':!![]}),exports['AuthService']=void 0x0;function a47_0x50b4(){const _0xd34dfc=['Invalid\x20credentials','generateToken','99350ktZrNV','name','shop','AuthService','ACTIVE','admin','secret','565UJUQsp','1640ROsxjv','username','defineProperty','verify','config','sign','__importDefault','../config/database','82596bFVcIh','6163854QGrVMe','verifyToken','1lyRHmT','login','1089lgMVNc','13526304VusRbX','passwordHash','findUnique','default','2179932vybZBP','jwt','expiresIn','../config/config','26992UduKQG','Account\x20is\x20not\x20active','__esModule','2404uGHTZk','status','compare'];a47_0x50b4=function(){return _0xd34dfc;};return a47_0x50b4();}function a47_0x32c5(_0x1fc3e6,_0x37d3e0){_0x1fc3e6=_0x1fc3e6-0xfc;const _0x50b4a4=a47_0x50b4();let _0x32c520=_0x50b4a4[_0x1fc3e6];return _0x32c520;}const bcryptjs_1=__importDefault(require('bcryptjs')),jsonwebtoken_1=__importDefault(require('jsonwebtoken')),database_1=__importDefault(require(a47_0x523ecc(0x121))),config_1=require(a47_0x523ecc(0x109));class AuthService{[a47_0x523ecc(0x111)](_0x312590){const _0x44b7a7=a47_0x523ecc;return jsonwebtoken_1[_0x44b7a7(0x105)][_0x44b7a7(0x11f)](_0x312590,config_1[_0x44b7a7(0x11e)]['jwt'][_0x44b7a7(0x118)],{'expiresIn':String(config_1[_0x44b7a7(0x11e)]['jwt'][_0x44b7a7(0x108)])});}async[a47_0x523ecc(0x100)](_0x2b8ace){const _0x33e694=a47_0x523ecc,{username:_0x1a6170,password:_0x479988}=_0x2b8ace;if(_0x1a6170===config_1[_0x33e694(0x11e)]['admin'][_0x33e694(0x11b)]){const _0x5d5ef5=await bcryptjs_1['default'][_0x33e694(0x10f)](_0x479988,config_1[_0x33e694(0x11e)][_0x33e694(0x117)][_0x33e694(0x103)]);if(_0x5d5ef5){const _0x39c111=this[_0x33e694(0x111)]({'id':_0x33e694(0x117),'username':config_1[_0x33e694(0x11e)]['admin'][_0x33e694(0x11b)],'role':'admin'});return{'access_token':_0x39c111,'role':_0x33e694(0x117)};}}const _0x32a2e4=await database_1[_0x33e694(0x105)]['shop'][_0x33e694(0x104)]({'where':{'username':_0x1a6170},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x32a2e4)throw new Error(_0x33e694(0x110));if(_0x32a2e4[_0x33e694(0x10e)]!==_0x33e694(0x116))throw new Error(_0x33e694(0x10b));const _0x2e9dd8=await bcryptjs_1['default'][_0x33e694(0x10f)](_0x479988,_0x32a2e4['password']);if(!_0x2e9dd8)throw new Error(_0x33e694(0x110));const _0x1e90ce=this[_0x33e694(0x111)]({'id':_0x32a2e4['id'],'username':_0x32a2e4['username'],'role':_0x33e694(0x114)});return{'access_token':_0x1e90ce,'role':_0x33e694(0x114),'user':{'id':_0x32a2e4['id'],'name':_0x32a2e4[_0x33e694(0x113)],'username':_0x32a2e4[_0x33e694(0x11b)]}};}async[a47_0x523ecc(0xfe)](_0x2223aa){const _0x3adcdf=a47_0x523ecc;try{const _0x4c7a0f=jsonwebtoken_1[_0x3adcdf(0x105)][_0x3adcdf(0x11d)](_0x2223aa,config_1[_0x3adcdf(0x11e)][_0x3adcdf(0x107)][_0x3adcdf(0x118)]);return _0x4c7a0f;}catch(_0x1913bc){throw new Error('Invalid\x20token');}}}exports[a47_0x523ecc(0x115)]=AuthService;