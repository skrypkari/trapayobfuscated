'use strict';const a41_0x2f1074=a41_0x424e;(function(_0x24c983,_0x49398e){const _0x245494=a41_0x424e,_0x513d39=_0x24c983();while(!![]){try{const _0x29ddc1=parseInt(_0x245494(0x15b))/0x1*(-parseInt(_0x245494(0x14d))/0x2)+parseInt(_0x245494(0x15f))/0x3*(-parseInt(_0x245494(0x150))/0x4)+parseInt(_0x245494(0x156))/0x5+parseInt(_0x245494(0x13d))/0x6+parseInt(_0x245494(0x13a))/0x7*(parseInt(_0x245494(0x14b))/0x8)+parseInt(_0x245494(0x152))/0x9*(-parseInt(_0x245494(0x159))/0xa)+-parseInt(_0x245494(0x14c))/0xb;if(_0x29ddc1===_0x49398e)break;else _0x513d39['push'](_0x513d39['shift']());}catch(_0x358ed2){_0x513d39['push'](_0x513d39['shift']());}}}(a41_0x4348,0xe2768));function a41_0x424e(_0x2500ce,_0x92e205){const _0x4348ff=a41_0x4348();return a41_0x424e=function(_0x424ee8,_0x1d925b){_0x424ee8=_0x424ee8-0x13a;let _0x2df911=_0x4348ff[_0x424ee8];return _0x2df911;},a41_0x424e(_0x2500ce,_0x92e205);}function a41_0x4348(){const _0x5be5fa=['ACTIVE','5840030sfSqQh','config','default','130mZshbM','__esModule','911cSukjz','verifyToken','Invalid\x20credentials','username','60bijaJb','generateToken','77BMADlf','AuthService','verify','1013466PYnZUc','secret','compare','__importDefault','expiresIn','name','defineProperty','jwt','admin','login','Account\x20is\x20not\x20active','../config/config','bcryptjs','passwordHash','1260488dKxQGP','3842366jsPJct','142wvmyIc','status','sign','121444EPyQeB','findUnique','776277kADDyY','shop','Invalid\x20token'];a41_0x4348=function(){return _0x5be5fa;};return a41_0x4348();}var __importDefault=this&&this[a41_0x2f1074(0x140)]||function(_0x43d0db){const _0x2a72af=a41_0x2f1074;return _0x43d0db&&_0x43d0db[_0x2a72af(0x15a)]?_0x43d0db:{'default':_0x43d0db};};Object[a41_0x2f1074(0x143)](exports,a41_0x2f1074(0x15a),{'value':!![]}),exports[a41_0x2f1074(0x13b)]=void 0x0;const bcryptjs_1=__importDefault(require(a41_0x2f1074(0x149))),jsonwebtoken_1=__importDefault(require('jsonwebtoken')),database_1=__importDefault(require('../config/database')),config_1=require(a41_0x2f1074(0x148));class AuthService{[a41_0x2f1074(0x160)](_0x598de1){const _0x52e94c=a41_0x2f1074;return jsonwebtoken_1[_0x52e94c(0x158)][_0x52e94c(0x14f)](_0x598de1,config_1[_0x52e94c(0x157)][_0x52e94c(0x144)][_0x52e94c(0x13e)],{'expiresIn':String(config_1['config'][_0x52e94c(0x144)][_0x52e94c(0x141)])});}async[a41_0x2f1074(0x146)](_0x7e7d3a){const _0x59cac1=a41_0x2f1074,{username:_0x16dfc7,password:_0x491fe2}=_0x7e7d3a;if(_0x16dfc7===config_1['config']['admin'][_0x59cac1(0x15e)]){const _0x4e4a1f=await bcryptjs_1[_0x59cac1(0x158)][_0x59cac1(0x13f)](_0x491fe2,config_1[_0x59cac1(0x157)][_0x59cac1(0x145)][_0x59cac1(0x14a)]);if(_0x4e4a1f){const _0x19deab=this[_0x59cac1(0x160)]({'id':_0x59cac1(0x145),'username':config_1[_0x59cac1(0x157)][_0x59cac1(0x145)][_0x59cac1(0x15e)],'role':'admin'});return{'access_token':_0x19deab,'role':_0x59cac1(0x145)};}}const _0x1d498a=await database_1[_0x59cac1(0x158)][_0x59cac1(0x153)][_0x59cac1(0x151)]({'where':{'username':_0x16dfc7},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x1d498a)throw new Error('Invalid\x20credentials');if(_0x1d498a[_0x59cac1(0x14e)]!==_0x59cac1(0x155))throw new Error(_0x59cac1(0x147));const _0x503e81=await bcryptjs_1[_0x59cac1(0x158)][_0x59cac1(0x13f)](_0x491fe2,_0x1d498a['password']);if(!_0x503e81)throw new Error(_0x59cac1(0x15d));const _0x153938=this[_0x59cac1(0x160)]({'id':_0x1d498a['id'],'username':_0x1d498a[_0x59cac1(0x15e)],'role':'shop'});return{'access_token':_0x153938,'role':'shop','user':{'id':_0x1d498a['id'],'name':_0x1d498a[_0x59cac1(0x142)],'username':_0x1d498a['username']}};}async[a41_0x2f1074(0x15c)](_0x3327a1){const _0x303dda=a41_0x2f1074;try{const _0x4df36f=jsonwebtoken_1[_0x303dda(0x158)][_0x303dda(0x13c)](_0x3327a1,config_1[_0x303dda(0x157)][_0x303dda(0x144)][_0x303dda(0x13e)]);return _0x4df36f;}catch(_0x2106ae){throw new Error(_0x303dda(0x154));}}}exports['AuthService']=AuthService;