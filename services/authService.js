'use strict';function a39_0x5c39(_0x30c997,_0x287315){const _0x49a459=a39_0x49a4();return a39_0x5c39=function(_0x5c3936,_0x540150){_0x5c3936=_0x5c3936-0x68;let _0x44998a=_0x49a459[_0x5c3936];return _0x44998a;},a39_0x5c39(_0x30c997,_0x287315);}const a39_0x13e6ba=a39_0x5c39;(function(_0x4d11fb,_0x544833){const _0x2c0ea2=a39_0x5c39,_0x2b1320=_0x4d11fb();while(!![]){try{const _0x2252c1=-parseInt(_0x2c0ea2(0x7b))/0x1+-parseInt(_0x2c0ea2(0x72))/0x2*(-parseInt(_0x2c0ea2(0x7a))/0x3)+-parseInt(_0x2c0ea2(0x68))/0x4*(parseInt(_0x2c0ea2(0x88))/0x5)+parseInt(_0x2c0ea2(0x6d))/0x6*(-parseInt(_0x2c0ea2(0x8a))/0x7)+parseInt(_0x2c0ea2(0x7d))/0x8*(parseInt(_0x2c0ea2(0x8b))/0x9)+parseInt(_0x2c0ea2(0x6b))/0xa+parseInt(_0x2c0ea2(0x71))/0xb;if(_0x2252c1===_0x544833)break;else _0x2b1320['push'](_0x2b1320['shift']());}catch(_0x558a43){_0x2b1320['push'](_0x2b1320['shift']());}}}(a39_0x49a4,0xa9dab));var __importDefault=this&&this[a39_0x13e6ba(0x83)]||function(_0x1c1091){return _0x1c1091&&_0x1c1091['__esModule']?_0x1c1091:{'default':_0x1c1091};};Object[a39_0x13e6ba(0x81)](exports,a39_0x13e6ba(0x77),{'value':!![]}),exports[a39_0x13e6ba(0x6c)]=void 0x0;const bcryptjs_1=__importDefault(require(a39_0x13e6ba(0x89))),jsonwebtoken_1=__importDefault(require('jsonwebtoken')),database_1=__importDefault(require(a39_0x13e6ba(0x86))),config_1=require(a39_0x13e6ba(0x74));class AuthService{[a39_0x13e6ba(0x87)](_0xe9bc3a){const _0x52d422=a39_0x13e6ba;return jsonwebtoken_1[_0x52d422(0x85)][_0x52d422(0x7f)](_0xe9bc3a,config_1[_0x52d422(0x84)]['jwt'][_0x52d422(0x73)],{'expiresIn':String(config_1[_0x52d422(0x84)][_0x52d422(0x6e)][_0x52d422(0x79)])});}async[a39_0x13e6ba(0x78)](_0x45c3d2){const _0x45301b=a39_0x13e6ba,{username:_0x3ea934,password:_0x280fe8}=_0x45c3d2;if(_0x3ea934===config_1[_0x45301b(0x84)][_0x45301b(0x6a)][_0x45301b(0x80)]){const _0x299709=await bcryptjs_1[_0x45301b(0x85)][_0x45301b(0x70)](_0x280fe8,config_1[_0x45301b(0x84)]['admin']['passwordHash']);if(_0x299709){const _0x39bd24=this[_0x45301b(0x87)]({'id':_0x45301b(0x6a),'username':config_1[_0x45301b(0x84)]['admin'][_0x45301b(0x80)],'role':_0x45301b(0x6a)});return{'access_token':_0x39bd24,'role':'admin'};}}const _0x3af316=await database_1[_0x45301b(0x85)]['shop'][_0x45301b(0x76)]({'where':{'username':_0x3ea934},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x3af316)throw new Error(_0x45301b(0x69));if(_0x3af316['status']!==_0x45301b(0x7e))throw new Error(_0x45301b(0x6f));const _0x3fe59e=await bcryptjs_1[_0x45301b(0x85)][_0x45301b(0x70)](_0x280fe8,_0x3af316[_0x45301b(0x75)]);if(!_0x3fe59e)throw new Error('Invalid\x20credentials');const _0x354081=this[_0x45301b(0x87)]({'id':_0x3af316['id'],'username':_0x3af316[_0x45301b(0x80)],'role':_0x45301b(0x7c)});return{'access_token':_0x354081,'role':_0x45301b(0x7c),'user':{'id':_0x3af316['id'],'name':_0x3af316['name'],'username':_0x3af316['username']}};}async['verifyToken'](_0xad77b6){const _0x16723d=a39_0x13e6ba;try{const _0x41a2ba=jsonwebtoken_1['default']['verify'](_0xad77b6,config_1[_0x16723d(0x84)][_0x16723d(0x6e)][_0x16723d(0x73)]);return _0x41a2ba;}catch(_0x330c3e){throw new Error(_0x16723d(0x82));}}}exports[a39_0x13e6ba(0x6c)]=AuthService;function a39_0x49a4(){const _0x273070=['Account\x20is\x20not\x20active','compare','6212635YHpXnk','103550DqKTEP','secret','../config/config','password','findUnique','__esModule','login','expiresIn','72uKpXNX','1168759uYHKLj','shop','2074648gqInPU','ACTIVE','sign','username','defineProperty','Invalid\x20token','__importDefault','config','default','../config/database','generateToken','1120HTBdHF','bcryptjs','4176774hJPKhm','18LVJIZt','7052MwVNbs','Invalid\x20credentials','admin','5300290NezNSg','AuthService','6grGDWr','jwt'];a39_0x49a4=function(){return _0x273070;};return a39_0x49a4();}