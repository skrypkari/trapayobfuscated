'use strict';function a37_0x4216(){const _0x3dba46=['admin','expiresIn','verifyToken','jsonwebtoken','131354mkQQyO','secret','password','282006hvKuic','shop','2968911FatNJJ','../config/config','compare','22326UdXIUI','username','generateToken','118140uzOYKF','config','findUnique','passwordHash','5UPBgwn','__esModule','bcryptjs','status','default','Invalid\x20credentials','Invalid\x20token','1413080uGtqjH','verify','__importDefault','10KnczzE','sign','Account\x20is\x20not\x20active','7RqEHvO','74236JiqhVJ','AuthService','jwt','../config/database'];a37_0x4216=function(){return _0x3dba46;};return a37_0x4216();}const a37_0x4bd9c6=a37_0x579b;function a37_0x579b(_0x181502,_0x6d6dd3){const _0x421630=a37_0x4216();return a37_0x579b=function(_0x579bed,_0x8e02c0){_0x579bed=_0x579bed-0xfc;let _0x133ed9=_0x421630[_0x579bed];return _0x133ed9;},a37_0x579b(_0x181502,_0x6d6dd3);}(function(_0x39705d,_0x172675){const _0x346483=a37_0x579b,_0x6b69bf=_0x39705d();while(!![]){try{const _0x286525=parseInt(_0x346483(0x10f))/0x1+-parseInt(_0x346483(0x112))/0x2+-parseInt(_0x346483(0x11a))/0x3+parseInt(_0x346483(0x107))/0x4+parseInt(_0x346483(0x11e))/0x5*(-parseInt(_0x346483(0x117))/0x6)+-parseInt(_0x346483(0x106))/0x7*(parseInt(_0x346483(0x100))/0x8)+parseInt(_0x346483(0x114))/0x9*(parseInt(_0x346483(0x103))/0xa);if(_0x286525===_0x172675)break;else _0x6b69bf['push'](_0x6b69bf['shift']());}catch(_0x45a612){_0x6b69bf['push'](_0x6b69bf['shift']());}}}(a37_0x4216,0x1d10d));var __importDefault=this&&this[a37_0x4bd9c6(0x102)]||function(_0x4d269c){const _0x13e1ae=a37_0x4bd9c6;return _0x4d269c&&_0x4d269c[_0x13e1ae(0x11f)]?_0x4d269c:{'default':_0x4d269c};};Object['defineProperty'](exports,a37_0x4bd9c6(0x11f),{'value':!![]}),exports['AuthService']=void 0x0;const bcryptjs_1=__importDefault(require(a37_0x4bd9c6(0x120))),jsonwebtoken_1=__importDefault(require(a37_0x4bd9c6(0x10e))),database_1=__importDefault(require(a37_0x4bd9c6(0x10a))),config_1=require(a37_0x4bd9c6(0x115));class AuthService{['generateToken'](_0x3e828c){const _0x52df24=a37_0x4bd9c6;return jsonwebtoken_1[_0x52df24(0xfd)][_0x52df24(0x104)](_0x3e828c,config_1[_0x52df24(0x11b)][_0x52df24(0x109)][_0x52df24(0x110)],{'expiresIn':String(config_1['config']['jwt'][_0x52df24(0x10c)])});}async['login'](_0xd03df5){const _0x3abc3a=a37_0x4bd9c6,{username:_0x1b9904,password:_0x5cda2f}=_0xd03df5;if(_0x1b9904===config_1[_0x3abc3a(0x11b)]['admin'][_0x3abc3a(0x118)]){const _0x5ca432=await bcryptjs_1[_0x3abc3a(0xfd)][_0x3abc3a(0x116)](_0x5cda2f,config_1[_0x3abc3a(0x11b)][_0x3abc3a(0x10b)][_0x3abc3a(0x11d)]);if(_0x5ca432){const _0x3491a0=this[_0x3abc3a(0x119)]({'id':_0x3abc3a(0x10b),'username':config_1['config'][_0x3abc3a(0x10b)][_0x3abc3a(0x118)],'role':'admin'});return{'access_token':_0x3491a0,'role':_0x3abc3a(0x10b)};}}const _0x8a72a7=await database_1[_0x3abc3a(0xfd)]['shop'][_0x3abc3a(0x11c)]({'where':{'username':_0x1b9904},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x8a72a7)throw new Error(_0x3abc3a(0xfe));if(_0x8a72a7[_0x3abc3a(0xfc)]!=='ACTIVE')throw new Error(_0x3abc3a(0x105));const _0x2fa962=await bcryptjs_1[_0x3abc3a(0xfd)][_0x3abc3a(0x116)](_0x5cda2f,_0x8a72a7[_0x3abc3a(0x111)]);if(!_0x2fa962)throw new Error('Invalid\x20credentials');const _0x520075=this[_0x3abc3a(0x119)]({'id':_0x8a72a7['id'],'username':_0x8a72a7[_0x3abc3a(0x118)],'role':_0x3abc3a(0x113)});return{'access_token':_0x520075,'role':_0x3abc3a(0x113),'user':{'id':_0x8a72a7['id'],'name':_0x8a72a7['name'],'username':_0x8a72a7[_0x3abc3a(0x118)]}};}async[a37_0x4bd9c6(0x10d)](_0x2737d5){const _0x4f25cf=a37_0x4bd9c6;try{const _0x505b19=jsonwebtoken_1[_0x4f25cf(0xfd)][_0x4f25cf(0x101)](_0x2737d5,config_1[_0x4f25cf(0x11b)][_0x4f25cf(0x109)][_0x4f25cf(0x110)]);return _0x505b19;}catch(_0x581ab1){throw new Error(_0x4f25cf(0xff));}}}exports[a37_0x4bd9c6(0x108)]=AuthService;