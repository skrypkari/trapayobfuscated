'use strict';const a37_0x487723=a37_0x36eb;(function(_0x5d69fe,_0x54d795){const _0x513e8d=a37_0x36eb,_0x441894=_0x5d69fe();while(!![]){try{const _0x186a02=-parseInt(_0x513e8d(0x1a9))/0x1+parseInt(_0x513e8d(0x196))/0x2+-parseInt(_0x513e8d(0x195))/0x3+-parseInt(_0x513e8d(0x1a7))/0x4+parseInt(_0x513e8d(0x18d))/0x5*(-parseInt(_0x513e8d(0x1ab))/0x6)+parseInt(_0x513e8d(0x18f))/0x7+parseInt(_0x513e8d(0x1aa))/0x8;if(_0x186a02===_0x54d795)break;else _0x441894['push'](_0x441894['shift']());}catch(_0x3e40ec){_0x441894['push'](_0x441894['shift']());}}}(a37_0x2e4a,0x75094));function a37_0x36eb(_0x5adf8c,_0x3fe80e){const _0x2e4a8f=a37_0x2e4a();return a37_0x36eb=function(_0x36ebc8,_0x1bce99){_0x36ebc8=_0x36ebc8-0x189;let _0x4c4197=_0x2e4a8f[_0x36ebc8];return _0x4c4197;},a37_0x36eb(_0x5adf8c,_0x3fe80e);}var __importDefault=this&&this[a37_0x487723(0x1a3)]||function(_0x23a4ca){const _0x3a124b=a37_0x487723;return _0x23a4ca&&_0x23a4ca[_0x3a124b(0x1a6)]?_0x23a4ca:{'default':_0x23a4ca};};Object[a37_0x487723(0x199)](exports,a37_0x487723(0x1a6),{'value':!![]}),exports[a37_0x487723(0x19b)]=void 0x0;const bcryptjs_1=__importDefault(require(a37_0x487723(0x19d))),jsonwebtoken_1=__importDefault(require(a37_0x487723(0x19c))),database_1=__importDefault(require('../config/database')),config_1=require(a37_0x487723(0x18e));class AuthService{[a37_0x487723(0x1a1)](_0x4d393a){const _0x528e01=a37_0x487723;return jsonwebtoken_1[_0x528e01(0x19f)][_0x528e01(0x191)](_0x4d393a,config_1[_0x528e01(0x1a0)]['jwt']['secret'],{'expiresIn':String(config_1[_0x528e01(0x1a0)]['jwt'][_0x528e01(0x192)])});}async[a37_0x487723(0x19e)](_0x10764f){const _0x3a494e=a37_0x487723,{username:_0x38cead,password:_0x305761}=_0x10764f;if(_0x38cead===config_1['config'][_0x3a494e(0x1a5)][_0x3a494e(0x1a4)]){const _0x3155b2=await bcryptjs_1[_0x3a494e(0x19f)]['compare'](_0x305761,config_1['config'][_0x3a494e(0x1a5)][_0x3a494e(0x189)]);if(_0x3155b2){const _0x329b83=this[_0x3a494e(0x1a1)]({'id':_0x3a494e(0x1a5),'username':config_1[_0x3a494e(0x1a0)]['admin']['username'],'role':'admin'});return{'access_token':_0x329b83,'role':_0x3a494e(0x1a5)};}}const _0x5e0256=await database_1[_0x3a494e(0x19f)][_0x3a494e(0x18a)][_0x3a494e(0x18b)]({'where':{'username':_0x38cead},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x5e0256)throw new Error('Invalid\x20credentials');if(_0x5e0256[_0x3a494e(0x194)]!==_0x3a494e(0x198))throw new Error(_0x3a494e(0x190));const _0x1261b7=await bcryptjs_1[_0x3a494e(0x19f)][_0x3a494e(0x197)](_0x305761,_0x5e0256[_0x3a494e(0x19a)]);if(!_0x1261b7)throw new Error(_0x3a494e(0x18c));const _0x16a335=this['generateToken']({'id':_0x5e0256['id'],'username':_0x5e0256[_0x3a494e(0x1a4)],'role':_0x3a494e(0x18a)});return{'access_token':_0x16a335,'role':_0x3a494e(0x18a),'user':{'id':_0x5e0256['id'],'name':_0x5e0256['name'],'username':_0x5e0256[_0x3a494e(0x1a4)]}};}async[a37_0x487723(0x193)](_0x1f95a8){const _0x152ef8=a37_0x487723;try{const _0x4489fb=jsonwebtoken_1[_0x152ef8(0x19f)][_0x152ef8(0x1a2)](_0x1f95a8,config_1[_0x152ef8(0x1a0)]['jwt'][_0x152ef8(0x1a8)]);return _0x4489fb;}catch(_0x570c40){throw new Error('Invalid\x20token');}}}exports[a37_0x487723(0x19b)]=AuthService;function a37_0x2e4a(){const _0x22809b=['634194ZWXHqx','17796968PIcvQk','904746AEuzsr','passwordHash','shop','findUnique','Invalid\x20credentials','25UFJLOd','../config/config','6556809fAKWxS','Account\x20is\x20not\x20active','sign','expiresIn','verifyToken','status','2493276LlYGrV','585488LYpZdh','compare','ACTIVE','defineProperty','password','AuthService','jsonwebtoken','bcryptjs','login','default','config','generateToken','verify','__importDefault','username','admin','__esModule','3021724tkTxpR','secret'];a37_0x2e4a=function(){return _0x22809b;};return a37_0x2e4a();}