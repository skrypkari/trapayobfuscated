'use strict';function a36_0x2bf0(_0x31e393,_0x12b7da){const _0x45b6ad=a36_0x45b6();return a36_0x2bf0=function(_0x2bf080,_0xa55238){_0x2bf080=_0x2bf080-0x1df;let _0x3ebe8c=_0x45b6ad[_0x2bf080];return _0x3ebe8c;},a36_0x2bf0(_0x31e393,_0x12b7da);}const a36_0x373bca=a36_0x2bf0;(function(_0x2b8c2c,_0x31b1ec){const _0x134f86=a36_0x2bf0,_0xf21471=_0x2b8c2c();while(!![]){try{const _0x17d645=-parseInt(_0x134f86(0x1ef))/0x1*(parseInt(_0x134f86(0x201))/0x2)+parseInt(_0x134f86(0x1fd))/0x3+-parseInt(_0x134f86(0x1f3))/0x4+parseInt(_0x134f86(0x1fc))/0x5+parseInt(_0x134f86(0x1ee))/0x6*(-parseInt(_0x134f86(0x1f9))/0x7)+parseInt(_0x134f86(0x1e4))/0x8+parseInt(_0x134f86(0x1f0))/0x9;if(_0x17d645===_0x31b1ec)break;else _0xf21471['push'](_0xf21471['shift']());}catch(_0x57c73c){_0xf21471['push'](_0xf21471['shift']());}}}(a36_0x45b6,0xe895f));var __importDefault=this&&this[a36_0x373bca(0x1ec)]||function(_0x39646d){const _0x588322=a36_0x373bca;return _0x39646d&&_0x39646d[_0x588322(0x1f5)]?_0x39646d:{'default':_0x39646d};};function a36_0x45b6(){const _0x5a3163=['605716xBMCFv','6543288hFrMga','verify','bcryptjs','669796ARUWxP','expiresIn','__esModule','password','admin','defineProperty','3199ZLOwIr','jsonwebtoken','username','1782525nLTJkP','2499048brXkmz','default','Invalid\x20credentials','secret','4RMKGgN','../config/config','ACTIVE','../config/database','jwt','Invalid\x20token','13714000bofZeS','login','compare','generateToken','sign','Account\x20is\x20not\x20active','shop','config','__importDefault','AuthService','17058nBMRCv'];a36_0x45b6=function(){return _0x5a3163;};return a36_0x45b6();}Object[a36_0x373bca(0x1f8)](exports,a36_0x373bca(0x1f5),{'value':!![]}),exports[a36_0x373bca(0x1ed)]=void 0x0;const bcryptjs_1=__importDefault(require(a36_0x373bca(0x1f2))),jsonwebtoken_1=__importDefault(require(a36_0x373bca(0x1fa))),database_1=__importDefault(require(a36_0x373bca(0x1e1))),config_1=require(a36_0x373bca(0x1df));class AuthService{[a36_0x373bca(0x1e7)](_0x57c09f){const _0x20b496=a36_0x373bca;return jsonwebtoken_1['default'][_0x20b496(0x1e8)](_0x57c09f,config_1[_0x20b496(0x1eb)][_0x20b496(0x1e2)][_0x20b496(0x200)],{'expiresIn':String(config_1[_0x20b496(0x1eb)][_0x20b496(0x1e2)][_0x20b496(0x1f4)])});}async[a36_0x373bca(0x1e5)](_0x1c50cc){const _0x3464de=a36_0x373bca,{username:_0x1d9284,password:_0x31b902}=_0x1c50cc;if(_0x1d9284===config_1['config'][_0x3464de(0x1f7)]['username']){const _0x1d6dc3=await bcryptjs_1[_0x3464de(0x1fe)][_0x3464de(0x1e6)](_0x31b902,config_1[_0x3464de(0x1eb)][_0x3464de(0x1f7)]['passwordHash']);if(_0x1d6dc3){const _0x529a0c=this[_0x3464de(0x1e7)]({'id':_0x3464de(0x1f7),'username':config_1[_0x3464de(0x1eb)][_0x3464de(0x1f7)]['username'],'role':'admin'});return{'access_token':_0x529a0c,'role':_0x3464de(0x1f7)};}}const _0x2c1e21=await database_1[_0x3464de(0x1fe)][_0x3464de(0x1ea)]['findUnique']({'where':{'username':_0x1d9284},'select':{'id':!![],'name':!![],'username':!![],'password':!![],'status':!![]}});if(!_0x2c1e21)throw new Error('Invalid\x20credentials');if(_0x2c1e21['status']!==_0x3464de(0x1e0))throw new Error(_0x3464de(0x1e9));const _0x5e5319=await bcryptjs_1[_0x3464de(0x1fe)][_0x3464de(0x1e6)](_0x31b902,_0x2c1e21[_0x3464de(0x1f6)]);if(!_0x5e5319)throw new Error(_0x3464de(0x1ff));const _0xe1f384=this[_0x3464de(0x1e7)]({'id':_0x2c1e21['id'],'username':_0x2c1e21[_0x3464de(0x1fb)],'role':_0x3464de(0x1ea)});return{'access_token':_0xe1f384,'role':_0x3464de(0x1ea),'user':{'id':_0x2c1e21['id'],'name':_0x2c1e21['name'],'username':_0x2c1e21[_0x3464de(0x1fb)]}};}async['verifyToken'](_0x38d300){const _0x37a12c=a36_0x373bca;try{const _0x4c2a65=jsonwebtoken_1[_0x37a12c(0x1fe)][_0x37a12c(0x1f1)](_0x38d300,config_1[_0x37a12c(0x1eb)]['jwt'][_0x37a12c(0x200)]);return _0x4c2a65;}catch(_0x5471a9){throw new Error(_0x37a12c(0x1e3));}}}exports[a36_0x373bca(0x1ed)]=AuthService;