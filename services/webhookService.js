'use strict';const a69_0x488c27=a69_0x5b07;(function(_0x50dac4,_0x1ab1e2){const _0x4f96c5=a69_0x5b07,_0x1cd615=_0x50dac4();while(!![]){try{const _0x6661fd=parseInt(_0x4f96c5(0x2ae))/0x1*(parseInt(_0x4f96c5(0x21b))/0x2)+parseInt(_0x4f96c5(0x1e5))/0x3*(parseInt(_0x4f96c5(0x2ad))/0x4)+-parseInt(_0x4f96c5(0x1f3))/0x5*(-parseInt(_0x4f96c5(0x1bb))/0x6)+-parseInt(_0x4f96c5(0x219))/0x7+parseInt(_0x4f96c5(0x1d1))/0x8+-parseInt(_0x4f96c5(0x282))/0x9+parseInt(_0x4f96c5(0x1a8))/0xa*(parseInt(_0x4f96c5(0x264))/0xb);if(_0x6661fd===_0x1ab1e2)break;else _0x1cd615['push'](_0x1cd615['shift']());}catch(_0x42a0b8){_0x1cd615['push'](_0x1cd615['shift']());}}}(a69_0x29d1,0xd0390));function a69_0x5b07(_0x3003ed,_0x313167){const _0x29d1bb=a69_0x29d1();return a69_0x5b07=function(_0x5b071,_0x5e5d4e){_0x5b071=_0x5b071-0x17e;let _0xc73ee7=_0x29d1bb[_0x5b071];return _0xc73ee7;},a69_0x5b07(_0x3003ed,_0x313167);}var __importDefault=this&&this[a69_0x488c27(0x2b9)]||function(_0x380119){const _0x5ef145=a69_0x488c27;return _0x380119&&_0x380119[_0x5ef145(0x213)]?_0x380119:{'default':_0x380119};};Object[a69_0x488c27(0x20a)](exports,a69_0x488c27(0x213),{'value':!![]}),exports[a69_0x488c27(0x18e)]=void 0x0;const database_1=__importDefault(require('../config/database')),plisioService_1=require('./gateways/plisioService'),rapydService_1=require(a69_0x488c27(0x249)),nodaService_1=require(a69_0x488c27(0x23b)),coinToPayService_1=require(a69_0x488c27(0x231)),coinToPay2Service_1=require(a69_0x488c27(0x27b)),klymeService_1=require(a69_0x488c27(0x292)),mastercardService_1=require('./gateways/mastercardService'),amerService_1=require('./gateways/amerService'),ampayService_1=require(a69_0x488c27(0x1ff)),ampayTRYService_1=require('./gateways/ampayTRYService'),telegramBotService_1=require('./telegramBotService'),currencyService_1=require(a69_0x488c27(0x28b)),loggerService_1=require('./loggerService');class WebhookService{constructor(){const _0x4ea257=a69_0x488c27;this[_0x4ea257(0x251)]=new plisioService_1[(_0x4ea257(0x2a7))](),this[_0x4ea257(0x29a)]=new rapydService_1[(_0x4ea257(0x1c0))](),this[_0x4ea257(0x1d6)]=new nodaService_1[(_0x4ea257(0x28d))](),this[_0x4ea257(0x1d8)]=new coinToPayService_1['CoinToPayService'](),this['coinToPay2Service']=new coinToPay2Service_1[(_0x4ea257(0x25e))](),this[_0x4ea257(0x24c)]=new klymeService_1[(_0x4ea257(0x20f))](),this[_0x4ea257(0x1cc)]=new mastercardService_1['VisaMasterCardService'](),this[_0x4ea257(0x184)]=new amerService_1[(_0x4ea257(0x295))](),this[_0x4ea257(0x1a1)]=new ampayService_1['AmPayService'](),this[_0x4ea257(0x194)]=new ampayTRYService_1['AmPayTRYService']();}async[a69_0x488c27(0x238)](_0x283a13,_0x57d4e0,_0x4f0c4e){const _0x2d7472=a69_0x488c27;console['log'](_0x2d7472(0x1e6)+_0x283a13+',\x20newStatus='+_0x57d4e0),console[_0x2d7472(0x2bf)](_0x2d7472(0x221),_0x4f0c4e),await database_1[_0x2d7472(0x2b5)]['$transaction'](async _0x314aff=>{const _0x2fbf56=_0x2d7472,_0x54fdf9=await _0x314aff[_0x2fbf56(0x193)][_0x2fbf56(0x1bf)]({'where':{'id':_0x283a13},'include':{'shop':{'select':{'id':!![],'name':!![],'username':!![],'balance':!![],'totalPaidOut':!![],'settings':{'select':{'webhookUrl':!![],'webhookEvents':!![]}}}}}});if(!_0x54fdf9)throw new Error(_0x2fbf56(0x18f)+_0x283a13+_0x2fbf56(0x27d));const _0x39c94d=_0x54fdf9[_0x2fbf56(0x271)],_0x513874=_0x54fdf9['shop'];console[_0x2fbf56(0x2bf)]('üí∞\x20Payment\x20'+_0x283a13+':\x20'+_0x39c94d+_0x2fbf56(0x1d7)+_0x57d4e0),console[_0x2fbf56(0x2bf)](_0x2fbf56(0x29b)+_0x513874['username']+_0x2fbf56(0x2a9)+_0x513874[_0x2fbf56(0x1b4)]+_0x2fbf56(0x1f5));const _0x38783c={'status':_0x57d4e0['toUpperCase'](),'updatedAt':new Date(),'statusChangedBy':_0x2fbf56(0x2bb),'statusChangedAt':new Date()};_0x4f0c4e?.[_0x2fbf56(0x1ee)]&&(_0x38783c['failureMessage']=_0x4f0c4e[_0x2fbf56(0x1ee)]);_0x4f0c4e?.[_0x2fbf56(0x27a)]&&(_0x38783c[_0x2fbf56(0x27a)]=JSON['stringify'](_0x4f0c4e[_0x2fbf56(0x27a)]));_0x4f0c4e?.[_0x2fbf56(0x187)]&&(_0x38783c[_0x2fbf56(0x187)]=_0x4f0c4e['cardLast4']);_0x4f0c4e?.['paymentMethod']&&(_0x38783c[_0x2fbf56(0x1b8)]=_0x4f0c4e[_0x2fbf56(0x1b8)]);_0x4f0c4e?.[_0x2fbf56(0x26e)]&&(_0x38783c[_0x2fbf56(0x26e)]=_0x4f0c4e[_0x2fbf56(0x26e)]);_0x4f0c4e?.[_0x2fbf56(0x204)]&&(_0x38783c[_0x2fbf56(0x204)]=_0x4f0c4e[_0x2fbf56(0x204)]);_0x4f0c4e?.['remitterName']&&(_0x38783c[_0x2fbf56(0x25f)]=_0x4f0c4e['remitterName']);let _0x5912c4=_0x513874[_0x2fbf56(0x1b4)],_0x5036e6='';if(_0x57d4e0[_0x2fbf56(0x1ac)]()===_0x2fbf56(0x258)&&_0x39c94d!==_0x2fbf56(0x258)){const _0x477a39=await currencyService_1[_0x2fbf56(0x182)]['convertToUSDT'](_0x54fdf9[_0x2fbf56(0x192)],_0x54fdf9['currency']),_0x5345bd=await this[_0x2fbf56(0x259)](_0x513874['id'],_0x54fdf9[_0x2fbf56(0x20c)]),_0x1e4754=_0x477a39*(0x1-_0x5345bd/0x64);_0x5912c4+=_0x1e4754,_0x5036e6='+'+_0x1e4754[_0x2fbf56(0x1f4)](0x6)+_0x2fbf56(0x212)+_0x5345bd+_0x2fbf56(0x261),_0x38783c[_0x2fbf56(0x1f1)]=_0x477a39,_0x38783c[_0x2fbf56(0x1c6)]=_0x1e4754,_0x38783c[_0x2fbf56(0x266)]=_0x5345bd,_0x38783c['paidAt']=new Date(),console[_0x2fbf56(0x2bf)]('üí∞\x20Converting\x20'+_0x54fdf9[_0x2fbf56(0x192)]+'\x20'+_0x54fdf9['currency']+'\x20->\x20'+_0x477a39['toFixed'](0x6)+_0x2fbf56(0x1f5)),console['log'](_0x2fbf56(0x188)+_0x54fdf9[_0x2fbf56(0x20c)]+_0x2fbf56(0x248)+_0x5345bd+'%'),console[_0x2fbf56(0x2bf)](_0x2fbf56(0x2ac)+_0x1e4754[_0x2fbf56(0x1f4)](0x6)+'\x20USDT'),console['log'](_0x2fbf56(0x23a)+_0x513874[_0x2fbf56(0x1b4)]+_0x2fbf56(0x216)+_0x1e4754[_0x2fbf56(0x1f4)](0x6)+_0x2fbf56(0x28e)+_0x5912c4['toFixed'](0x6)+_0x2fbf56(0x1f5));}else{if(_0x39c94d==='PAID'&&_0x57d4e0[_0x2fbf56(0x1ac)]()!=='PAID'&&_0x57d4e0[_0x2fbf56(0x1ac)]()!=='CHARGEBACK'){let _0x38d0f6;if(_0x54fdf9[_0x2fbf56(0x1c6)])_0x38d0f6=_0x54fdf9[_0x2fbf56(0x1c6)];else{if(_0x54fdf9[_0x2fbf56(0x1f1)]){const _0x2386e8=await this[_0x2fbf56(0x259)](_0x513874['id'],_0x54fdf9[_0x2fbf56(0x20c)]);_0x38d0f6=_0x54fdf9[_0x2fbf56(0x1f1)]*(0x1-_0x2386e8/0x64);}else console['log'](_0x2fbf56(0x272)),_0x38d0f6=0x0;}_0x38d0f6>0x0&&(_0x5912c4-=_0x38d0f6,_0x5036e6='-'+_0x38d0f6[_0x2fbf56(0x1f4)](0x6)+_0x2fbf56(0x283),_0x38783c['paidAt']=null,console[_0x2fbf56(0x2bf)](_0x2fbf56(0x2b1)+_0x513874[_0x2fbf56(0x1b4)]+'\x20-\x20'+_0x38d0f6[_0x2fbf56(0x1f4)](0x6)+'\x20=\x20'+_0x5912c4[_0x2fbf56(0x1f4)](0x6)+'\x20USDT'));}}if(_0x57d4e0['toUpperCase']()==='CHARGEBACK'){const _0x32eca1=_0x4f0c4e?.[_0x2fbf56(0x225)]||0x0;console[_0x2fbf56(0x2bf)](_0x2fbf56(0x1b5)),_0x32eca1>0x0?(_0x5912c4-=_0x32eca1,_0x5036e6='-'+_0x32eca1[_0x2fbf56(0x1f4)](0x6)+'\x20USDT\x20(chargeback\x20penalty\x20ONLY)',_0x38783c['chargebackAmount']=_0x32eca1,console[_0x2fbf56(0x2bf)](_0x2fbf56(0x237)+_0x32eca1[_0x2fbf56(0x1f4)](0x6)+_0x2fbf56(0x1f5)),console[_0x2fbf56(0x2bf)](_0x2fbf56(0x1d0)),console[_0x2fbf56(0x2bf)](_0x2fbf56(0x262)+_0x5912c4[_0x2fbf56(0x1f4)](0x6)+_0x2fbf56(0x1f5))):(console[_0x2fbf56(0x2bf)](_0x2fbf56(0x26c)),_0x5036e6=_0x2fbf56(0x267));}const _0x304efb=await _0x314aff[_0x2fbf56(0x193)]['update']({'where':{'id':_0x283a13},'data':_0x38783c});_0x5912c4!==_0x513874[_0x2fbf56(0x1b4)]&&(await _0x314aff['shop'][_0x2fbf56(0x2b3)]({'where':{'id':_0x513874['id']},'data':{'balance':_0x5912c4}}),console[_0x2fbf56(0x2bf)](_0x2fbf56(0x218)+_0x513874[_0x2fbf56(0x186)]+'\x20balance\x20updated:\x20'+_0x513874[_0x2fbf56(0x1b4)]['toFixed'](0x6)+_0x2fbf56(0x1d7)+_0x5912c4[_0x2fbf56(0x1f4)](0x6)+_0x2fbf56(0x1f5)),console[_0x2fbf56(0x2bf)]('üìù\x20Reason:\x20'+_0x5036e6));await _0x314aff['webhookLog'][_0x2fbf56(0x215)]({'data':{'paymentId':_0x283a13,'shopId':_0x513874['id'],'event':_0x2fbf56(0x2c0)+_0x57d4e0[_0x2fbf56(0x1cd)](),'statusCode':0xc8,'responseBody':JSON['stringify']({'oldStatus':_0x39c94d,'newStatus':_0x57d4e0[_0x2fbf56(0x1ac)](),'balanceChange':_0x5036e6||_0x2fbf56(0x1f6),'oldBalance':_0x513874[_0x2fbf56(0x1b4)],'newBalance':_0x5912c4,'amountUSDT':_0x38783c['amountUSDT'],'additionalData':_0x4f0c4e,'timestamp':new Date()[_0x2fbf56(0x2a6)]()})}}),await this['sendShopWebhook']({..._0x54fdf9,..._0x304efb,'shop':_0x513874},_0x57d4e0[_0x2fbf56(0x1ac)]()),await this[_0x2fbf56(0x2a5)]({..._0x54fdf9,..._0x304efb},_0x57d4e0['toUpperCase']());if(_0x39c94d!==_0x2fbf56(0x258)&&_0x57d4e0[_0x2fbf56(0x1ac)]()===_0x2fbf56(0x258)){console[_0x2fbf56(0x2bf)](_0x2fbf56(0x276)+_0x283a13+_0x2fbf56(0x25c)),console['log']('üìà\x20Payment\x20details:\x20oldStatus=\x22'+_0x39c94d+'\x22,\x20newStatus=\x22'+_0x57d4e0[_0x2fbf56(0x1ac)]()+_0x2fbf56(0x1d9)+_0x54fdf9[_0x2fbf56(0x243)]+'\x22');if(_0x54fdf9[_0x2fbf56(0x243)])try{const _0x2c3a3a=await _0x314aff['paymentLink']['findUnique']({'where':{'id':_0x54fdf9['paymentLinkId']},'select':{'id':!![],'type':!![],'currentPayments':!![],'status':!![]}});if(_0x2c3a3a){console[_0x2fbf56(0x2bf)](_0x2fbf56(0x226)+_0x2c3a3a['id']+_0x2fbf56(0x26d)+_0x2c3a3a[_0x2fbf56(0x217)]+_0x2fbf56(0x270)+_0x2c3a3a['currentPayments']+_0x2fbf56(0x1fd)+_0x2c3a3a[_0x2fbf56(0x271)]);const _0x47d376=_0x2c3a3a[_0x2fbf56(0x19e)]+0x1,_0x5e01db=_0x2c3a3a[_0x2fbf56(0x217)]===_0x2fbf56(0x1bd)?_0x2fbf56(0x2ba):_0x2c3a3a[_0x2fbf56(0x271)];await _0x314aff[_0x2fbf56(0x1cb)]['update']({'where':{'id':_0x54fdf9[_0x2fbf56(0x243)]},'data':{'currentPayments':_0x47d376,'status':_0x5e01db,'updatedAt':new Date()}}),console[_0x2fbf56(0x2bf)](_0x2fbf56(0x1b7)+_0x2c3a3a['id']+'\x20updated:\x20currentPayments='+_0x2c3a3a[_0x2fbf56(0x19e)]+'\x20->\x20'+_0x47d376+_0x2fbf56(0x1fd)+_0x2c3a3a[_0x2fbf56(0x271)]+_0x2fbf56(0x1d7)+_0x5e01db);}else console[_0x2fbf56(0x2bf)]('‚ùå\x20Payment\x20link\x20'+_0x54fdf9[_0x2fbf56(0x243)]+_0x2fbf56(0x27d));}catch(_0x39a800){console[_0x2fbf56(0x29d)](_0x2fbf56(0x1c3),_0x39a800);}else console[_0x2fbf56(0x2bf)](_0x2fbf56(0x276)+_0x283a13+_0x2fbf56(0x1db));}else console['log'](_0x2fbf56(0x276)+_0x283a13+'\x20status\x20change\x20does\x20not\x20trigger\x20payment\x20link\x20counter\x20update:\x20'+_0x39c94d+_0x2fbf56(0x1d7)+_0x57d4e0[_0x2fbf56(0x1ac)]());});}async[a69_0x488c27(0x214)](_0x2b3cd6){const _0x10569e=a69_0x488c27;console[_0x10569e(0x2bf)](_0x10569e(0x1af),_0x2b3cd6);try{const _0x45f0ef=await this[_0x10569e(0x251)][_0x10569e(0x191)](_0x2b3cd6);if(!_0x45f0ef[_0x10569e(0x280)])throw new Error('No\x20payment\x20ID\x20in\x20Plisio\x20webhook');const _0x46f55e=await database_1[_0x10569e(0x2b5)][_0x10569e(0x193)][_0x10569e(0x18d)]({'where':{'gatewayOrderId':_0x45f0ef['paymentId']}});if(!_0x46f55e){console[_0x10569e(0x29d)](_0x10569e(0x1a0)+_0x45f0ef['paymentId']);return;}console[_0x10569e(0x2bf)](_0x10569e(0x2b2)+_0x46f55e['id']+_0x10569e(0x27e)+_0x45f0ef[_0x10569e(0x271)]),await this[_0x10569e(0x238)](_0x46f55e['id'],_0x45f0ef['status'],{'txUrls':_0x45f0ef[_0x10569e(0x27a)]}),loggerService_1[_0x10569e(0x274)][_0x10569e(0x1ad)](_0x10569e(0x299),_0x46f55e['id'],_0x46f55e[_0x10569e(0x271)],_0x45f0ef[_0x10569e(0x271)],_0x2b3cd6);}catch(_0x4b8e9b){console[_0x10569e(0x29d)]('Error\x20processing\x20Plisio\x20webhook:',_0x4b8e9b),loggerService_1[_0x10569e(0x274)]['logWebhookError'](_0x10569e(0x299),_0x4b8e9b,_0x2b3cd6);throw _0x4b8e9b;}}async[a69_0x488c27(0x256)](_0x4f6f95){const _0x3f5afa=a69_0x488c27;console[_0x3f5afa(0x2bf)](_0x3f5afa(0x227),_0x4f6f95);try{const _0x4d7d85=await this[_0x3f5afa(0x251)][_0x3f5afa(0x191)](_0x4f6f95);if(!_0x4d7d85[_0x3f5afa(0x280)])throw new Error('No\x20payment\x20ID\x20in\x20Plisio\x20Gateway\x20webhook');const _0x4d3517=await database_1[_0x3f5afa(0x2b5)][_0x3f5afa(0x193)][_0x3f5afa(0x18d)]({'where':{'gatewayOrderId':_0x4d7d85[_0x3f5afa(0x280)]}});if(!_0x4d3517){console[_0x3f5afa(0x29d)](_0x3f5afa(0x24d)+_0x4d7d85['paymentId']);return;}console[_0x3f5afa(0x2bf)](_0x3f5afa(0x254)+_0x4d3517['id']+_0x3f5afa(0x27e)+_0x4d7d85[_0x3f5afa(0x271)]),await this['updatePaymentStatus'](_0x4d3517['id'],_0x4d7d85[_0x3f5afa(0x271)],{'txUrls':_0x4d7d85[_0x3f5afa(0x27a)]}),loggerService_1['loggerService'][_0x3f5afa(0x1ad)]('plisio_gateway',_0x4d3517['id'],_0x4d3517[_0x3f5afa(0x271)],_0x4d7d85[_0x3f5afa(0x271)],_0x4f6f95);}catch(_0x46a5da){console[_0x3f5afa(0x29d)](_0x3f5afa(0x189),_0x46a5da),loggerService_1['loggerService'][_0x3f5afa(0x1dc)](_0x3f5afa(0x1eb),_0x46a5da,_0x4f6f95);throw _0x46a5da;}}async[a69_0x488c27(0x27f)](_0x36c61c){const _0x16650f=a69_0x488c27;console[_0x16650f(0x2bf)](_0x16650f(0x23e),_0x36c61c);try{const _0x5d516e=await this[_0x16650f(0x29a)][_0x16650f(0x191)](_0x36c61c);if(!_0x5d516e[_0x16650f(0x280)])throw new Error('No\x20payment\x20ID\x20in\x20Rapyd\x20webhook');const _0x207c7c=await database_1['default'][_0x16650f(0x193)][_0x16650f(0x18d)]({'where':{'gatewayOrderId':_0x5d516e[_0x16650f(0x280)]}});if(!_0x207c7c){console[_0x16650f(0x29d)]('Payment\x20not\x20found\x20for\x20Rapyd\x20webhook:\x20'+_0x5d516e[_0x16650f(0x280)]);return;}console[_0x16650f(0x2bf)]('üìä\x20Rapyd\x20webhook:\x20Payment\x20'+_0x207c7c['id']+_0x16650f(0x27e)+_0x5d516e[_0x16650f(0x271)]),await this[_0x16650f(0x238)](_0x207c7c['id'],_0x5d516e['status'],{'failureMessage':_0x5d516e['failureMessage'],'cardLast4':_0x5d516e[_0x16650f(0x275)]?.['cardLast4'],'paymentMethod':_0x5d516e[_0x16650f(0x275)]?.[_0x16650f(0x1b8)]}),loggerService_1[_0x16650f(0x274)][_0x16650f(0x1ad)](_0x16650f(0x1e3),_0x207c7c['id'],_0x207c7c['status'],_0x5d516e[_0x16650f(0x271)],_0x36c61c);}catch(_0xb8484b){console['error'](_0x16650f(0x220),_0xb8484b),loggerService_1[_0x16650f(0x274)]['logWebhookError'](_0x16650f(0x1e3),_0xb8484b,_0x36c61c);throw _0xb8484b;}}async[a69_0x488c27(0x190)](_0x1e5314){const _0xaeb76d=a69_0x488c27;console[_0xaeb76d(0x2bf)]('üîÑ\x20Processing\x20Noda\x20webhook:',_0x1e5314);try{const _0x5685ca=await this[_0xaeb76d(0x1d6)]['processWebhook'](_0x1e5314);if(!_0x5685ca[_0xaeb76d(0x280)])throw new Error(_0xaeb76d(0x269));const _0x526f73=await database_1[_0xaeb76d(0x2b5)][_0xaeb76d(0x193)][_0xaeb76d(0x18d)]({'where':{'gatewayOrderId':_0x5685ca[_0xaeb76d(0x280)]}});if(!_0x526f73){console[_0xaeb76d(0x29d)](_0xaeb76d(0x17f)+_0x5685ca[_0xaeb76d(0x280)]);return;}console[_0xaeb76d(0x2bf)](_0xaeb76d(0x240)+_0x526f73['id']+_0xaeb76d(0x27e)+_0x5685ca[_0xaeb76d(0x271)]),await this['updatePaymentStatus'](_0x526f73['id'],_0x5685ca[_0xaeb76d(0x271)],{'bankId':_0x5685ca[_0xaeb76d(0x275)]?.['bankId'],'remitterIban':_0x5685ca['additionalInfo']?.['remitterIban'],'remitterName':_0x5685ca[_0xaeb76d(0x275)]?.['remitterName']}),loggerService_1[_0xaeb76d(0x274)][_0xaeb76d(0x1ad)](_0xaeb76d(0x208),_0x526f73['id'],_0x526f73[_0xaeb76d(0x271)],_0x5685ca[_0xaeb76d(0x271)],_0x1e5314);}catch(_0x2d9f7a){console[_0xaeb76d(0x29d)]('Error\x20processing\x20Noda\x20webhook:',_0x2d9f7a),loggerService_1[_0xaeb76d(0x274)][_0xaeb76d(0x1dc)](_0xaeb76d(0x208),_0x2d9f7a,_0x1e5314);throw _0x2d9f7a;}}async[a69_0x488c27(0x239)](_0xd50fc8){const _0x55d999=a69_0x488c27;console[_0x55d999(0x2bf)](_0x55d999(0x206),_0xd50fc8);try{const _0x1f72c1=await this[_0x55d999(0x1d8)][_0x55d999(0x191)](_0xd50fc8);if(!_0x1f72c1[_0x55d999(0x280)])throw new Error('No\x20payment\x20ID\x20in\x20CoinToPay\x20webhook');const _0x52af86=await database_1['default'][_0x55d999(0x193)][_0x55d999(0x18d)]({'where':{'gatewayOrderId':_0x1f72c1[_0x55d999(0x280)]}});if(!_0x52af86){console[_0x55d999(0x29d)]('Payment\x20not\x20found\x20for\x20CoinToPay\x20webhook:\x20'+_0x1f72c1[_0x55d999(0x280)]);return;}console[_0x55d999(0x2bf)](_0x55d999(0x19f)+_0x52af86['id']+_0x55d999(0x27e)+_0x1f72c1['status']),await this[_0x55d999(0x238)](_0x52af86['id'],_0x1f72c1[_0x55d999(0x271)]),loggerService_1[_0x55d999(0x274)]['logWebhookProcessed']('cointopay',_0x52af86['id'],_0x52af86[_0x55d999(0x271)],_0x1f72c1['status'],_0xd50fc8);}catch(_0xcce9f1){console['error']('Error\x20processing\x20CoinToPay\x20webhook:',_0xcce9f1),loggerService_1[_0x55d999(0x274)]['logWebhookError'](_0x55d999(0x1b6),_0xcce9f1,_0xd50fc8);throw _0xcce9f1;}}async[a69_0x488c27(0x1b2)](_0x4b57e3){const _0x1beb02=a69_0x488c27;console[_0x1beb02(0x2bf)](_0x1beb02(0x22f),_0x4b57e3);try{const _0x2a2b2a=await this['coinToPay2Service'][_0x1beb02(0x191)](_0x4b57e3);if(!_0x2a2b2a[_0x1beb02(0x280)])throw new Error(_0x1beb02(0x229));const _0x476eee=await database_1[_0x1beb02(0x2b5)]['payment']['findFirst']({'where':{'gatewayOrderId':_0x2a2b2a[_0x1beb02(0x280)]}});if(!_0x476eee){console[_0x1beb02(0x29d)](_0x1beb02(0x255)+_0x2a2b2a[_0x1beb02(0x280)]);return;}console[_0x1beb02(0x2bf)](_0x1beb02(0x241)+_0x476eee['id']+_0x1beb02(0x27e)+_0x2a2b2a[_0x1beb02(0x271)]),await this[_0x1beb02(0x238)](_0x476eee['id'],_0x2a2b2a[_0x1beb02(0x271)]),loggerService_1[_0x1beb02(0x274)]['logWebhookProcessed']('cointopay2',_0x476eee['id'],_0x476eee[_0x1beb02(0x271)],_0x2a2b2a[_0x1beb02(0x271)],_0x4b57e3);}catch(_0xa7bede){console[_0x1beb02(0x29d)]('Error\x20processing\x20CoinToPay2\x20webhook:',_0xa7bede),loggerService_1[_0x1beb02(0x274)][_0x1beb02(0x1dc)]('cointopay2',_0xa7bede,_0x4b57e3);throw _0xa7bede;}}async[a69_0x488c27(0x1c5)](_0x3f3891){const _0xae3a33=a69_0x488c27;console[_0xae3a33(0x2bf)]('üîÑ\x20Processing\x20KLYME\x20webhook:',_0x3f3891);try{const _0x1121cb=await this[_0xae3a33(0x24c)][_0xae3a33(0x191)](_0x3f3891);if(!_0x1121cb[_0xae3a33(0x280)])throw new Error(_0xae3a33(0x224));const _0x12f895=await database_1[_0xae3a33(0x2b5)][_0xae3a33(0x193)][_0xae3a33(0x18d)]({'where':{'gatewayOrderId':_0x1121cb[_0xae3a33(0x280)]}});if(!_0x12f895){console[_0xae3a33(0x29d)](_0xae3a33(0x1a5)+_0x1121cb[_0xae3a33(0x280)]);return;}console['log'](_0xae3a33(0x245)+_0x12f895['id']+'\x20status\x20'+_0x1121cb[_0xae3a33(0x271)]),await this[_0xae3a33(0x238)](_0x12f895['id'],_0x1121cb['status'],{'paymentMethod':_0x1121cb[_0xae3a33(0x275)]?.[_0xae3a33(0x1c7)]}),loggerService_1['loggerService'][_0xae3a33(0x1ad)]('klyme',_0x12f895['id'],_0x12f895[_0xae3a33(0x271)],_0x1121cb[_0xae3a33(0x271)],_0x3f3891);}catch(_0x5ac63f){console[_0xae3a33(0x29d)](_0xae3a33(0x291),_0x5ac63f),loggerService_1[_0xae3a33(0x274)][_0xae3a33(0x1dc)](_0xae3a33(0x2be),_0x5ac63f,_0x3f3891);throw _0x5ac63f;}}async[a69_0x488c27(0x1ba)](_0x549a71){const _0x544ac4=a69_0x488c27;console[_0x544ac4(0x2bf)](_0x544ac4(0x1d3),JSON[_0x544ac4(0x22a)](_0x549a71,null,0x2));try{const _0x2ee294=await this['visaMasterCardService'][_0x544ac4(0x191)](_0x549a71,'VISA');console['log'](_0x544ac4(0x22c),_0x2ee294);if(!_0x2ee294['paymentId']){console[_0x544ac4(0x29d)](_0x544ac4(0x2b7)),console[_0x544ac4(0x29d)](_0x544ac4(0x203),Object[_0x544ac4(0x1fb)](_0x549a71));throw new Error(_0x544ac4(0x294));}let _0x51a1ab=null;console[_0x544ac4(0x2bf)](_0x544ac4(0x2af)+_0x2ee294[_0x544ac4(0x280)]);if(_0x2ee294[_0x544ac4(0x280)]){console[_0x544ac4(0x2bf)](_0x544ac4(0x260)),console['log'](_0x544ac4(0x198)),console[_0x544ac4(0x2bf)](_0x544ac4(0x1e7)),console[_0x544ac4(0x2bf)](_0x544ac4(0x1f8)+_0x2ee294[_0x544ac4(0x280)]),console['log'](_0x544ac4(0x1a4)),_0x51a1ab=await database_1[_0x544ac4(0x2b5)][_0x544ac4(0x193)][_0x544ac4(0x18d)]({'where':{'AND':[{'OR':[{'gateway':_0x544ac4(0x223)},{'gateway':_0x544ac4(0x296)}]},{'OR':[{'gatewayPaymentId':_0x2ee294[_0x544ac4(0x280)]},{'gatewayOrderId':_0x2ee294['paymentId']},{'id':_0x2ee294['paymentId']},{'orderId':_0x2ee294[_0x544ac4(0x280)]}]}]},'include':{'shop':{'include':{'settings':!![]}}}}),console[_0x544ac4(0x2bf)](_0x544ac4(0x232));if(_0x51a1ab)console['log'](_0x544ac4(0x2b4)+_0x51a1ab['id']+_0x544ac4(0x1e1)+_0x51a1ab[_0x544ac4(0x29c)]+_0x544ac4(0x2a1)+_0x51a1ab[_0x544ac4(0x287)]);else{console[_0x544ac4(0x2bf)]('‚ùå\x20No\x20payment\x20found,\x20checking\x20all\x20payments\x20for\x20debugging...');const _0x57d9a5=await database_1[_0x544ac4(0x2b5)]['payment']['findMany']({'where':{'gateway':'visa/mastercard'},'select':{'id':!![],'gatewayOrderId':!![],'gatewayPaymentId':!![],'orderId':!![],'cardLast4':!![],'status':!![]},'take':0xa,'orderBy':{'createdAt':'desc'}});console[_0x544ac4(0x2bf)](_0x544ac4(0x235),_0x57d9a5[_0x544ac4(0x1e8)](_0x1f55a1=>_0x1f55a1['id']+_0x544ac4(0x1e0)+_0x1f55a1[_0x544ac4(0x1b9)]+_0x544ac4(0x25d)+_0x1f55a1[_0x544ac4(0x29c)]+_0x544ac4(0x27c)+_0x1f55a1[_0x544ac4(0x287)]+',\x20card:\x20****'+_0x1f55a1['cardLast4']+')'));}console[_0x544ac4(0x2bf)](_0x544ac4(0x183)+(_0x51a1ab?_0x544ac4(0x29f):_0x544ac4(0x196))),_0x51a1ab&&console[_0x544ac4(0x2bf)](_0x544ac4(0x21f)+_0x51a1ab['id']+_0x544ac4(0x209)+_0x51a1ab[_0x544ac4(0x20c)]+_0x544ac4(0x2a0)+_0x51a1ab[_0x544ac4(0x271)]+',\x20Card=****'+_0x51a1ab[_0x544ac4(0x187)]);}if(!_0x51a1ab){console[_0x544ac4(0x29d)](_0x544ac4(0x1da)+_0x2ee294[_0x544ac4(0x280)]),loggerService_1[_0x544ac4(0x274)][_0x544ac4(0x1dc)](_0x544ac4(0x2aa),new Error('Payment\x20not\x20found:\x20'+_0x2ee294['paymentId']),_0x549a71);throw new Error(_0x544ac4(0x195)+_0x2ee294[_0x544ac4(0x280)]);}console[_0x544ac4(0x2bf)](_0x544ac4(0x1c4)+_0x51a1ab['id']+_0x544ac4(0x1de)+_0x51a1ab[_0x544ac4(0x271)]+_0x544ac4(0x1ed)+_0x2ee294[_0x544ac4(0x271)]+')');const _0x311fe5={};_0x2ee294['amount']&&await database_1[_0x544ac4(0x2b5)][_0x544ac4(0x193)][_0x544ac4(0x2b3)]({'where':{'id':_0x51a1ab['id']},'data':{'amount':_0x2ee294['amount'],'updatedAt':new Date()}}),_0x2ee294[_0x544ac4(0x1e4)]&&await database_1['default'][_0x544ac4(0x193)][_0x544ac4(0x2b3)]({'where':{'id':_0x51a1ab['id']},'data':{'currency':_0x2ee294[_0x544ac4(0x1e4)],'updatedAt':new Date()}}),_0x2ee294[_0x544ac4(0x271)]==='FAILED'&&_0x2ee294['errorMessage']&&(_0x311fe5[_0x544ac4(0x1ee)]=_0x2ee294['errorMessage'],console[_0x544ac4(0x2bf)](_0x544ac4(0x1a3)+_0x2ee294[_0x544ac4(0x298)])),_0x311fe5['paymentMethod']=_0x544ac4(0x2aa),await this['updatePaymentStatus'](_0x51a1ab['id'],_0x2ee294['status'],_0x311fe5),await database_1['default'][_0x544ac4(0x1d2)][_0x544ac4(0x215)]({'data':{'paymentId':_0x51a1ab['id'],'shopId':_0x51a1ab[_0x544ac4(0x273)],'event':'visa_'+_0x2ee294[_0x544ac4(0x271)][_0x544ac4(0x1cd)](),'statusCode':0xc8,'responseBody':JSON[_0x544ac4(0x22a)](_0x2ee294)}}),await this[_0x544ac4(0x2a5)](_0x51a1ab,_0x2ee294[_0x544ac4(0x271)]['toUpperCase']()),console['log'](_0x544ac4(0x17e)+_0x51a1ab['id']);}catch(_0x2cf242){console[_0x544ac4(0x29d)](_0x544ac4(0x202),_0x2cf242),loggerService_1[_0x544ac4(0x274)]['logWebhookError'](_0x544ac4(0x2aa),_0x2cf242,_0x549a71);throw _0x2cf242;}}async[a69_0x488c27(0x2b6)](_0x9a3a55){const _0x13c719=a69_0x488c27;console['log'](_0x13c719(0x18b),JSON[_0x13c719(0x22a)](_0x9a3a55,null,0x2));try{const _0x5af82e=await this[_0x13c719(0x1cc)][_0x13c719(0x191)](_0x9a3a55,_0x13c719(0x2b0));console['log']('üìä\x20MasterCard\x20webhook\x20result:',_0x5af82e);if(!_0x5af82e[_0x13c719(0x280)]){console[_0x13c719(0x29d)](_0x13c719(0x29e)),console[_0x13c719(0x29d)](_0x13c719(0x203),Object[_0x13c719(0x1fb)](_0x9a3a55));throw new Error(_0x13c719(0x1ca));}let _0x18701b=null;console[_0x13c719(0x2bf)]('üîç\x20MasterCard\x20webhook:\x20Searching\x20for\x20payment\x20with\x20ID:\x20'+_0x5af82e[_0x13c719(0x280)]);_0x5af82e[_0x13c719(0x280)]&&(console[_0x13c719(0x2bf)](_0x13c719(0x1be)),_0x18701b=await database_1[_0x13c719(0x2b5)][_0x13c719(0x193)][_0x13c719(0x18d)]({'where':{'AND':[{'OR':[{'gateway':'visa_mastercard'},{'gateway':'mastercard'},{'gateway':'visa/mastercard'}]},{'OR':[{'gatewayPaymentId':_0x5af82e[_0x13c719(0x280)]},{'gatewayOrderId':_0x5af82e[_0x13c719(0x280)]},{'id':_0x5af82e[_0x13c719(0x280)]},{'orderId':_0x5af82e['paymentId']}]}]}}),console[_0x13c719(0x2bf)]('üîç\x20Search\x20result:\x20'+(_0x18701b?_0x13c719(0x236)+_0x18701b['id']:_0x13c719(0x24a))));if(!_0x18701b){console[_0x13c719(0x29d)](_0x13c719(0x2a8)+_0x5af82e[_0x13c719(0x280)]),console[_0x13c719(0x29d)](_0x13c719(0x26b)+_0x5af82e['paymentId']+_0x13c719(0x1a2)+_0x5af82e['paymentId']+_0x13c719(0x24e)+_0x5af82e[_0x13c719(0x280)]+'\x22');const _0xfecb11=await database_1[_0x13c719(0x2b5)][_0x13c719(0x193)][_0x13c719(0x286)]({'where':{'OR':[{'gateway':_0x13c719(0x296)},{'gateway':_0x13c719(0x28f)},{'gateway':_0x13c719(0x223)}]},'select':{'id':!![],'gateway':!![],'gatewayOrderId':!![],'gatewayPaymentId':!![],'orderId':!![],'status':!![]},'orderBy':{'id':'desc'},'take':0xf});console[_0x13c719(0x2bf)]('üîç\x20Available\x20VISA/MasterCard\x20payments\x20for\x20debugging:',_0xfecb11),loggerService_1[_0x13c719(0x274)][_0x13c719(0x1dc)](_0x13c719(0x296),new Error(_0x13c719(0x2a4)+_0x5af82e[_0x13c719(0x280)]),_0x9a3a55);throw new Error(_0x13c719(0x290)+_0x5af82e[_0x13c719(0x280)]);}console['log'](_0x13c719(0x21c)+_0x18701b['id']+'\x20for\x20MasterCard\x20webhook,\x20updating\x20status\x20from\x20'+_0x18701b['status']+_0x13c719(0x1ea)+_0x5af82e[_0x13c719(0x271)]);const _0x183bef={};_0x5af82e[_0x13c719(0x192)]&&await database_1['default']['payment']['update']({'where':{'id':_0x18701b['id']},'data':{'amount':_0x5af82e[_0x13c719(0x192)],'updatedAt':new Date()}}),_0x5af82e['currency']&&await database_1[_0x13c719(0x2b5)]['payment'][_0x13c719(0x2b3)]({'where':{'id':_0x18701b['id']},'data':{'currency':_0x5af82e[_0x13c719(0x1e4)],'updatedAt':new Date()}}),_0x5af82e[_0x13c719(0x271)]===_0x13c719(0x185)&&_0x5af82e['errorMessage']&&(_0x183bef['failureMessage']=_0x5af82e[_0x13c719(0x298)],console[_0x13c719(0x2bf)](_0x13c719(0x210)+_0x5af82e[_0x13c719(0x298)])),_0x183bef[_0x13c719(0x1b8)]=_0x13c719(0x296),await this['updatePaymentStatus'](_0x18701b['id'],_0x5af82e[_0x13c719(0x271)],_0x183bef),loggerService_1[_0x13c719(0x274)][_0x13c719(0x1ad)](_0x13c719(0x296),_0x18701b['id'],_0x18701b[_0x13c719(0x271)],_0x5af82e[_0x13c719(0x271)],_0x9a3a55);}catch(_0x1e4bd1){console['error'](_0x13c719(0x22b),_0x1e4bd1),loggerService_1[_0x13c719(0x274)][_0x13c719(0x1dc)](_0x13c719(0x296),_0x1e4bd1,_0x9a3a55);throw _0x1e4bd1;}}async[a69_0x488c27(0x265)](_0x50c1a1){const _0x1def25=a69_0x488c27;console[_0x1def25(0x2bf)](_0x1def25(0x201),JSON[_0x1def25(0x22a)](_0x50c1a1,null,0x2));try{const _0x29f594=await this[_0x1def25(0x184)][_0x1def25(0x191)](_0x50c1a1);console[_0x1def25(0x2bf)](_0x1def25(0x22d),_0x29f594);if(!_0x29f594['paymentId']){console[_0x1def25(0x29d)](_0x1def25(0x2ab)),console[_0x1def25(0x29d)]('‚ùå\x20Available\x20webhook\x20fields:',Object[_0x1def25(0x1fb)](_0x50c1a1));throw new Error('No\x20payment\x20ID\x20in\x20Amer\x20webhook');}let _0x3ce2e9=null;console[_0x1def25(0x2bf)](_0x1def25(0x1b3)+_0x29f594['paymentId']),_0x3ce2e9=await database_1[_0x1def25(0x2b5)][_0x1def25(0x193)][_0x1def25(0x18d)]({'where':{'AND':[{'gateway':_0x1def25(0x293)},{'OR':[{'gatewayPaymentId':_0x29f594[_0x1def25(0x280)]},{'gatewayOrderId':_0x29f594[_0x1def25(0x280)]},{'id':_0x29f594[_0x1def25(0x280)]},{'orderId':_0x29f594['paymentId']}]}]}}),console[_0x1def25(0x2bf)](_0x1def25(0x20b)+(_0x3ce2e9?_0x1def25(0x236)+_0x3ce2e9['id']:'Payment\x20not\x20found'));if(!_0x3ce2e9){console['error'](_0x1def25(0x1b0)+_0x29f594[_0x1def25(0x280)]);return;}console[_0x1def25(0x2bf)]('üìä\x20Amer\x20webhook:\x20Payment\x20'+_0x3ce2e9['id']+'\x20status\x20'+_0x29f594['status']),await this[_0x1def25(0x238)](_0x3ce2e9['id'],_0x29f594[_0x1def25(0x271)],{'cardLast4':_0x29f594[_0x1def25(0x275)]?.[_0x1def25(0x187)],'paymentMethod':_0x29f594['additionalInfo']?.[_0x1def25(0x1b8)]});}catch(_0x736d2d){console[_0x1def25(0x29d)]('‚ùå\x20Error\x20processing\x20Amer\x20webhook:',_0x736d2d),loggerService_1[_0x1def25(0x274)][_0x1def25(0x1dc)]('amer',_0x736d2d,_0x50c1a1);throw _0x736d2d;}}async[a69_0x488c27(0x18a)](_0x558980){const _0x3d964f=a69_0x488c27;console[_0x3d964f(0x2bf)](_0x3d964f(0x242),JSON[_0x3d964f(0x22a)](_0x558980,null,0x2));try{const _0x1b1cfd=_0x558980['status'],_0x260be6=_0x558980[_0x3d964f(0x20e)],_0xc92bf3=_0x558980['system_id'],_0x1eeb95=_0x558980[_0x3d964f(0x1c7)],_0x4f74d1=_0x558980[_0x3d964f(0x192)],_0x495933=_0x558980[_0x3d964f(0x1e4)],_0x56eb15=_0x558980[_0x3d964f(0x2a2)],_0x4d0e98=_0x558980[_0x3d964f(0x23c)];if(!_0x260be6){console[_0x3d964f(0x29d)](_0x3d964f(0x1c1));throw new Error(_0x3d964f(0x277));}console[_0x3d964f(0x2bf)](_0x3d964f(0x24b),{'status':_0x1b1cfd,'clientTransactionId':_0x260be6,'systemId':_0xc92bf3,'paymentMethod':_0x1eeb95,'amount':_0x4f74d1,'currency':_0x495933,'commission':_0x56eb15,'statusAdditionInfo':_0x4d0e98});const _0x4b3e18=await database_1[_0x3d964f(0x2b5)][_0x3d964f(0x193)][_0x3d964f(0x18d)]({'where':{'OR':[{'gatewayOrderId':_0x260be6},{'orderId':_0x260be6},{'id':_0x260be6},{'gatewayPaymentId':_0x260be6}]},'include':{'shop':{'include':{'settings':!![]}}}});if(!_0x4b3e18){console[_0x3d964f(0x29d)]('‚ùå\x20Payment\x20not\x20found\x20for\x20AmPay\x20client_transaction_id:\x20'+_0x260be6);throw new Error(_0x3d964f(0x2a4)+_0x260be6);}console[_0x3d964f(0x2bf)](_0x3d964f(0x21c)+_0x4b3e18['id']+'\x20for\x20AmPay\x20webhook'),console[_0x3d964f(0x2bf)](_0x3d964f(0x1e2)+_0x4b3e18[_0x3d964f(0x271)]+'\x20‚Üí\x20'+_0x1b1cfd),_0x1b1cfd===_0x3d964f(0x1f0)?(console[_0x3d964f(0x2bf)](_0x3d964f(0x1c2)),await this[_0x3d964f(0x238)](_0x4b3e18['id'],_0x3d964f(0x185)),console[_0x3d964f(0x2bf)](_0x3d964f(0x1fe)+_0x4b3e18['id']+_0x3d964f(0x26a)),console['log'](_0x3d964f(0x199)+(_0x4d0e98||_0x3d964f(0x1bc)))):console[_0x3d964f(0x2bf)](_0x3d964f(0x284)+_0x1b1cfd+_0x3d964f(0x1e9)),await database_1[_0x3d964f(0x2b5)][_0x3d964f(0x1d2)][_0x3d964f(0x215)]({'data':{'paymentId':_0x4b3e18['id'],'shopId':_0x4b3e18['shopId'],'event':_0x3d964f(0x180)+(_0x1b1cfd?.[_0x3d964f(0x1cd)]()||_0x3d964f(0x228)),'statusCode':0xc8,'responseBody':JSON['stringify'](_0x558980)}}),loggerService_1[_0x3d964f(0x274)]['logWebhookProcessed'](_0x3d964f(0x1ce),_0x4b3e18['id'],_0x4b3e18[_0x3d964f(0x271)],_0x1b1cfd==='DECLINED'?_0x3d964f(0x185):_0x1b1cfd,_0x558980);}catch(_0x4f2426){console['error'](_0x3d964f(0x1d5),_0x4f2426),loggerService_1[_0x3d964f(0x274)]['logWebhookError'](_0x3d964f(0x1ce),_0x4f2426,_0x558980);throw _0x4f2426;}}async[a69_0x488c27(0x246)](_0x38114b){const _0x252518=a69_0x488c27;console['log']('üîÑ\x20Processing\x20AmPay\x20TRY\x20webhook:',JSON['stringify'](_0x38114b,null,0x2));try{const _0x1744c2=_0x38114b[_0x252518(0x271)],_0x2d7b53=_0x38114b[_0x252518(0x20e)],_0x2a0ade=_0x38114b[_0x252518(0x1fa)],_0x5e1c72=_0x38114b[_0x252518(0x1c7)],_0x1fe060=_0x38114b[_0x252518(0x192)],_0x393bbf=_0x38114b[_0x252518(0x1e4)],_0x44c0fa=_0x38114b[_0x252518(0x2a2)],_0x3c7353=_0x38114b[_0x252518(0x23c)];if(!_0x2d7b53){console[_0x252518(0x29d)](_0x252518(0x1c8));throw new Error(_0x252518(0x1a9));}console['log'](_0x252518(0x1a7),{'status':_0x1744c2,'clientTransactionId':_0x2d7b53,'systemId':_0x2a0ade,'paymentMethod':_0x5e1c72,'amount':_0x1fe060,'currency':_0x393bbf,'commission':_0x44c0fa,'statusAdditionInfo':_0x3c7353});const _0x2a80ec=await database_1[_0x252518(0x2b5)][_0x252518(0x193)]['findFirst']({'where':{'OR':[{'gatewayOrderId':_0x2d7b53},{'orderId':_0x2d7b53},{'id':_0x2d7b53},{'gatewayPaymentId':_0x2d7b53}]},'include':{'shop':{'include':{'settings':!![]}}}});if(!_0x2a80ec){console[_0x252518(0x29d)](_0x252518(0x22e)+_0x2d7b53);throw new Error(_0x252518(0x2a4)+_0x2d7b53);}console['log']('‚úÖ\x20Found\x20payment\x20'+_0x2a80ec['id']+'\x20for\x20AmPay\x20TRY\x20webhook'),console[_0x252518(0x2bf)](_0x252518(0x1e2)+_0x2a80ec[_0x252518(0x271)]+_0x252518(0x1ed)+_0x1744c2),_0x1744c2===_0x252518(0x1f0)?(console['log']('üîÑ\x20AmPay\x20TRY\x20status\x20DECLINED\x20mapped\x20to\x20FAILED'),await this[_0x252518(0x238)](_0x2a80ec['id'],_0x252518(0x185)),console['log'](_0x252518(0x18c)+_0x2a80ec['id']+_0x252518(0x26a)),console['log']('‚ÑπÔ∏è\x20Decline\x20reason:\x20'+(_0x3c7353||'No\x20additional\x20info'))):console['log'](_0x252518(0x24f)+_0x1744c2+_0x252518(0x1e9)),await database_1[_0x252518(0x2b5)][_0x252518(0x1d2)][_0x252518(0x215)]({'data':{'paymentId':_0x2a80ec['id'],'shopId':_0x2a80ec[_0x252518(0x273)],'event':_0x252518(0x289)+(_0x1744c2?.[_0x252518(0x1cd)]()||_0x252518(0x228)),'statusCode':0xc8,'responseBody':JSON[_0x252518(0x22a)](_0x38114b)}}),loggerService_1[_0x252518(0x274)][_0x252518(0x1ad)](_0x252518(0x279),_0x2a80ec['id'],_0x2a80ec[_0x252518(0x271)],_0x1744c2===_0x252518(0x1f0)?'FAILED':_0x1744c2,_0x38114b);}catch(_0x2940d3){console['error'](_0x252518(0x26f),_0x2940d3),loggerService_1['loggerService'][_0x252518(0x1dc)](_0x252518(0x279),_0x2940d3,_0x38114b);throw _0x2940d3;}}async['sendShopWebhook'](_0x6edd50,_0x44a2d1){const _0x58c020=a69_0x488c27,_0x2acdea=Date[_0x58c020(0x297)]();try{const _0x3ad5e3=_0x6edd50[_0x58c020(0x21e)],_0x57a280=_0x3ad5e3['settings'];if(!_0x57a280?.[_0x58c020(0x23d)]){console[_0x58c020(0x2bf)](_0x58c020(0x250)+_0x3ad5e3['id']);return;}const _0x4fd3dc=_0x44a2d1==='PAID'?_0x58c020(0x222):_0x44a2d1==='FAILED'?_0x58c020(0x234):_0x44a2d1===_0x58c020(0x1d4)?_0x58c020(0x234):_0x44a2d1===_0x58c020(0x281)?_0x58c020(0x234):_0x44a2d1===_0x58c020(0x19b)?_0x58c020(0x234):_0x58c020(0x211);let _0x4d85f8=[];if(_0x57a280['webhookEvents'])try{_0x4d85f8=Array[_0x58c020(0x253)](_0x57a280[_0x58c020(0x1ef)])?_0x57a280['webhookEvents']:JSON[_0x58c020(0x205)](_0x57a280[_0x58c020(0x1ef)]);}catch(_0x4a69f8){console[_0x58c020(0x29d)]('Error\x20parsing\x20webhook\x20events:',_0x4a69f8),_0x4d85f8=[];}if(!_0x4d85f8[_0x58c020(0x252)](_0x4fd3dc)){console[_0x58c020(0x2bf)](_0x58c020(0x207)+_0x4fd3dc+_0x58c020(0x247)+_0x3ad5e3['id']);return;}const _0x23fe6d={'event':_0x4fd3dc,'payment':{'id':_0x6edd50['id'],'order_id':_0x6edd50[_0x58c020(0x1b9)],'gateway_order_id':_0x6edd50[_0x58c020(0x29c)],'gateway':_0x6edd50[_0x58c020(0x20c)],'amount':_0x6edd50[_0x58c020(0x192)],'currency':_0x6edd50[_0x58c020(0x1e4)],'status':_0x44a2d1[_0x58c020(0x1cd)](),'customer_email':_0x6edd50['customerEmail'],'customer_name':_0x6edd50[_0x58c020(0x181)],'failure_message':_0x6edd50[_0x58c020(0x1ee)],'tx_urls':_0x6edd50[_0x58c020(0x27a)]?JSON[_0x58c020(0x205)](_0x6edd50[_0x58c020(0x27a)]):null,'created_at':_0x6edd50[_0x58c020(0x230)],'updated_at':_0x6edd50['updatedAt']}},_0x2872e7=await fetch(_0x57a280[_0x58c020(0x23d)],{'method':_0x58c020(0x1aa),'headers':{'Content-Type':_0x58c020(0x197),'User-Agent':'Payment\x20System/1.0'},'body':JSON[_0x58c020(0x22a)](_0x23fe6d)}),_0x45adf2=Date['now']()-_0x2acdea,_0x2b12f9=_0x2872e7['ok']?_0x58c020(0x1df):await _0x2872e7[_0x58c020(0x1dd)]();loggerService_1[_0x58c020(0x274)]['logShopWebhookSent'](_0x6edd50[_0x58c020(0x273)],_0x57a280[_0x58c020(0x23d)],_0x4fd3dc,_0x2872e7[_0x58c020(0x271)],_0x45adf2,_0x23fe6d),console[_0x58c020(0x2bf)]('üì§\x20Shop\x20webhook\x20sent\x20to\x20'+_0x57a280['webhookUrl']+'\x20with\x20status\x20'+_0x2872e7[_0x58c020(0x271)]+'\x20('+_0x45adf2+_0x58c020(0x25b));}catch(_0x2475cd){console[_0x58c020(0x29d)]('Failed\x20to\x20send\x20shop\x20webhook:',_0x2475cd),loggerService_1['loggerService'][_0x58c020(0x288)](_0x6edd50['shopId'],_0x6edd50[_0x58c020(0x21e)]?.[_0x58c020(0x278)]?.[_0x58c020(0x23d)]||_0x58c020(0x228),_0x58c020(0x21a),_0x2475cd,{});}}async[a69_0x488c27(0x2a5)](_0x280da5,_0x1bbb3c){const _0x4d3244=a69_0x488c27;try{const _0x544cca={'PENDING':_0x4d3244(0x2b8),'PROCESSING':'processing','PAID':_0x4d3244(0x1ae),'FAILED':_0x4d3244(0x19c),'EXPIRED':_0x4d3244(0x1fc),'REFUND':'refund','CHARGEBACK':_0x4d3244(0x1ab)},_0x41c015=_0x544cca[_0x1bbb3c];if(!_0x41c015||_0x41c015==='created')return;await telegramBotService_1[_0x4d3244(0x21d)][_0x4d3244(0x1ec)](_0x280da5[_0x4d3244(0x273)],_0x280da5,_0x41c015);}catch(_0x2d4382){console[_0x4d3244(0x29d)](_0x4d3244(0x2bc),_0x2d4382);}}async[a69_0x488c27(0x259)](_0x2f0831,_0x4834e4){const _0x5e6014=a69_0x488c27;try{const _0x5ed086=await database_1[_0x5e6014(0x2b5)][_0x5e6014(0x21e)][_0x5e6014(0x1bf)]({'where':{'id':_0x2f0831},'select':{'gatewaySettings':!![]}});if(!_0x5ed086?.['gatewaySettings'])return console['log'](_0x5e6014(0x200)+_0x2f0831+',\x20using\x20default\x20commission\x2010%'),0xa;const _0x2fd524=JSON['parse'](_0x5ed086[_0x5e6014(0x23f)]);for(const [_0x279c97,_0x30cf41]of Object[_0x5e6014(0x19d)](_0x2fd524)){if(_0x279c97[_0x5e6014(0x1cd)]()===_0x4834e4[_0x5e6014(0x1cd)]()){const _0x2edef0=_0x30cf41[_0x5e6014(0x2a2)]||0xa;return console['log']('Gateway\x20'+_0x4834e4+_0x5e6014(0x1f2)+_0x2f0831+':\x20'+_0x2edef0+'%'),_0x2edef0;}}return console['log'](_0x5e6014(0x28c)+_0x4834e4+_0x5e6014(0x1b1)+_0x2f0831+_0x5e6014(0x257)),0xa;}catch(_0x36d8bc){return console[_0x5e6014(0x29d)]('Error\x20getting\x20gateway\x20commission\x20for\x20shop\x20'+_0x2f0831+_0x5e6014(0x2bd)+_0x4834e4+':',_0x36d8bc),0xa;}}async[a69_0x488c27(0x19a)](_0x30b8ec,_0x4b97c3){const _0xf56c81=a69_0x488c27;console[_0xf56c81(0x2bf)](_0xf56c81(0x233)),console[_0xf56c81(0x2bf)]('Query\x20params:',JSON[_0xf56c81(0x22a)](_0x30b8ec,null,0x2)),console[_0xf56c81(0x2bf)](_0xf56c81(0x1f9),JSON[_0xf56c81(0x22a)](_0x4b97c3,null,0x2));try{const _0x5c9e8b=_0x30b8ec['customerOrderId']||_0x4b97c3[_0xf56c81(0x285)],_0x3551f4=_0x30b8ec[_0xf56c81(0x271)]||_0x4b97c3[_0xf56c81(0x271)],_0x4aff61=_0x30b8ec['amount']||_0x4b97c3[_0xf56c81(0x192)],_0x1eef35=_0x30b8ec['currency']||_0x4b97c3['currency'],_0x12c5c0=_0x30b8ec[_0xf56c81(0x1cf)]||_0x4b97c3[_0xf56c81(0x1cf)];if(!_0x5c9e8b){console[_0xf56c81(0x29d)](_0xf56c81(0x1c9));throw new Error(_0xf56c81(0x268));}console[_0xf56c81(0x2bf)](_0xf56c81(0x20d),{'customerOrderId':_0x5c9e8b,'status':_0x3551f4,'amount':_0x4aff61,'currency':_0x1eef35,'dateTime':_0x12c5c0});const _0x3f955e=await database_1[_0xf56c81(0x2b5)][_0xf56c81(0x193)]['findFirst']({'where':{'OR':[{'gatewayOrderId':_0x5c9e8b},{'orderId':_0x5c9e8b},{'id':_0x5c9e8b},{'gatewayPaymentId':_0x5c9e8b}]},'include':{'shop':{'include':{'settings':!![]}}}});if(!_0x3f955e){console[_0xf56c81(0x29d)](_0xf56c81(0x2a3)+_0x5c9e8b);throw new Error(_0xf56c81(0x2a4)+_0x5c9e8b);}console[_0xf56c81(0x2bf)](_0xf56c81(0x21c)+_0x3f955e['id']+'\x20for\x20MyXSpend\x20webhook'),console[_0xf56c81(0x2bf)](_0xf56c81(0x1e2)+_0x3f955e[_0xf56c81(0x271)]+_0xf56c81(0x1ed)+_0x3551f4);let _0x58c3c1=_0x3551f4?.[_0xf56c81(0x1ac)]();_0x3551f4==='FAILED'||_0x3551f4===_0xf56c81(0x1d4)?(_0x58c3c1=_0xf56c81(0x185),console[_0xf56c81(0x2bf)]('üîÑ\x20MyXSpend\x20status\x20'+_0x3551f4+'\x20mapped\x20to\x20FAILED'),await this[_0xf56c81(0x238)](_0x3f955e['id'],_0x58c3c1),console[_0xf56c81(0x2bf)](_0xf56c81(0x25a)+_0x3f955e['id']+_0xf56c81(0x26a))):console[_0xf56c81(0x2bf)](_0xf56c81(0x1f7)+_0x3551f4+_0xf56c81(0x263)),await database_1[_0xf56c81(0x2b5)][_0xf56c81(0x1d2)][_0xf56c81(0x215)]({'data':{'paymentId':_0x3f955e['id'],'shopId':_0x3f955e[_0xf56c81(0x273)],'event':_0xf56c81(0x28a)+(_0x3551f4?.[_0xf56c81(0x1cd)]()||'unknown'),'statusCode':0xc8,'responseBody':JSON['stringify']({'queryParams':_0x30b8ec,'bodyData':_0x4b97c3})}}),loggerService_1['loggerService']['logWebhookProcessed'](_0xf56c81(0x1a6),_0x3f955e['id'],_0x3f955e[_0xf56c81(0x271)],_0x58c3c1||_0x3551f4,{'queryParams':_0x30b8ec,'bodyData':_0x4b97c3});}catch(_0x24a1e4){console[_0xf56c81(0x29d)](_0xf56c81(0x244),_0x24a1e4),loggerService_1[_0xf56c81(0x274)][_0xf56c81(0x1dc)](_0xf56c81(0x1a6),_0x24a1e4,{'queryParams':_0x30b8ec,'bodyData':_0x4b97c3});throw _0x24a1e4;}}}function a69_0x29d1(){const _0x107ac4=['findUnique','RapydService','‚ùå\x20No\x20client_transaction_id\x20found\x20in\x20AmPay\x20webhook','üîÑ\x20AmPay\x20status\x20DECLINED\x20mapped\x20to\x20FAILED','‚ùå\x20Failed\x20to\x20update\x20payment\x20link\x20counter:','üìä\x20VISA\x20payment\x20found:\x20','processKlymeWebhook','amountAfterGatewayCommissionUSDT','payment_method','‚ùå\x20No\x20client_transaction_id\x20found\x20in\x20AmPay\x20TRY\x20webhook','‚ùå\x20No\x20customerOrderId\x20found\x20in\x20MyXSpend\x20webhook','No\x20payment\x20ID\x20in\x20MasterCard\x20webhook','paymentLink','visaMasterCardService','toLowerCase','ampay','dateTime','üí∞\x20Payment\x20amount\x20is\x20NOT\x20deducted\x20(chargeback\x20penalty\x20only)','7257464bYSfbC','webhookLog','üîÑ\x20Processing\x20VISA\x20webhook:','EXPIRED','‚ùå\x20Error\x20processing\x20AmPay\x20webhook:','nodaService','\x20->\x20','coinToPayService','\x22,\x20paymentLinkId=\x22','‚ùå\x20VISA\x20payment\x20not\x20found\x20for\x20ID:\x20','\x20is\x20not\x20linked\x20to\x20a\x20payment\x20link','logWebhookError','text','\x20(Status:\x20','Success','\x20(orderId:\x20',',\x20GatewayOrderId=','üìä\x20Payment\x20status:\x20','rapyd','currency','1100247REqEgZ','üîÑ\x20updatePaymentStatus\x20called:\x20paymentId=','\x20\x20\x20-\x20Gateway:\x20visa/mastercard\x20or\x20mastercard','map','\x20-\x20no\x20action\x20taken\x20(only\x20DECLINED\x20is\x20processed)','\x20to\x20','plisio_gateway','sendPaymentNotification','\x20‚Üí\x20','failureMessage','webhookEvents','DECLINED','amountUSDT','\x20commission\x20for\x20shop\x20','5348445JLpbuT','toFixed','\x20USDT','no\x20balance\x20change','‚ÑπÔ∏è\x20MyXSpend\x20status\x20','\x20\x20\x20-\x20Payment\x20ID\x20to\x20match:\x20','Body\x20data:','system_id','keys','expired',',\x20status=','‚úÖ\x20AmPay\x20webhook\x20processed:\x20Payment\x20','./gateways/ampayService','No\x20gateway\x20settings\x20found\x20for\x20shop\x20','üîÑ\x20Processing\x20Amer\x20webhook:','‚ùå\x20VISA\x20webhook\x20processing\x20failed:','‚ùå\x20Available\x20webhook\x20fields:','remitterIban','parse','üîÑ\x20Processing\x20CoinToPay\x20webhook:','Webhook\x20event\x20','noda',',\x20Gateway=','defineProperty','üîç\x20Search\x20result:\x20','gateway','üìä\x20MyXSpend\x20webhook\x20data:','client_transaction_id','KlymeService','‚ùå\x20MasterCard\x20payment\x20failed\x20with\x20message:\x20','payment.pending','\x20USDT\x20(payment\x20became\x20PAID,\x20after\x20','__esModule','processPlisioWebhook','create','\x20+\x20','type','‚úÖ\x20Shop\x20','10151526FVsWIw','webhook_send','46uyYGoM','‚úÖ\x20Found\x20payment\x20','telegramBotService','shop','üîç\x20Found\x20VISA\x20payment:\x20ID=','Error\x20processing\x20Rapyd\x20webhook:','üîÑ\x20Additional\x20data:','payment.success','visa/mastercard','No\x20payment\x20ID\x20in\x20KLYME\x20webhook','chargebackAmount','üìà\x20Found\x20payment\x20link\x20','üîÑ\x20Processing\x20Plisio\x20Gateway\x20webhook:','unknown','No\x20payment\x20ID\x20in\x20CoinToPay2\x20webhook','stringify','‚ùå\x20Error\x20processing\x20MasterCard\x20webhook:','üìä\x20VISA\x20webhook\x20result:','üìä\x20Amer\x20webhook\x20result:','‚ùå\x20Payment\x20not\x20found\x20for\x20AmPay\x20TRY\x20client_transaction_id:\x20','üîÑ\x20Processing\x20CoinToPay2\x20webhook:','createdAt','./gateways/coinToPayService','üîç\x20VISA\x20payment\x20search\x20executed','üîÑ\x20Processing\x20MyXSpend\x20webhook:','payment.failed','üîç\x20Recent\x20visa/mastercard\x20payments\x20for\x20debugging:','Found\x20payment\x20','üí∏\x20CHARGEBACK\x20penalty\x20ONLY:\x20-','updatePaymentStatus','processCoinToPayWebhook','üí∞\x20Adding\x20to\x20balance:\x20','./gateways/nodaService','status_addition_info','webhookUrl','üîÑ\x20Processing\x20Rapyd\x20webhook:','gatewaySettings','üìä\x20Noda\x20webhook:\x20Payment\x20','üìä\x20CoinToPay2\x20webhook:\x20Payment\x20','üîÑ\x20Processing\x20AmPay\x20webhook:','paymentLinkId','‚ùå\x20Error\x20processing\x20MyXSpend\x20webhook:','üìä\x20KLYME\x20webhook:\x20Payment\x20','processAmPayTRYWebhook','\x20not\x20enabled\x20for\x20shop\x20','\x20commission:\x20','./gateways/rapydService','Payment\x20not\x20found','üìä\x20AmPay\x20webhook\x20data:','klymeService','Payment\x20not\x20found\x20for\x20Plisio\x20Gateway\x20webhook:\x20','\x22,\x20orderId=\x22','‚ÑπÔ∏è\x20AmPay\x20TRY\x20status\x20','No\x20webhook\x20URL\x20configured\x20for\x20shop\x20','plisioService','includes','isArray','üìä\x20Plisio\x20Gateway\x20webhook:\x20Payment\x20','Payment\x20not\x20found\x20for\x20CoinToPay2\x20webhook:\x20','processPlisioGatewayWebhook',',\x20using\x20default\x2010%','PAID','getGatewayCommission','‚úÖ\x20MyXSpend\x20webhook\x20processed:\x20Payment\x20','ms)','\x20became\x20PAID\x20via\x20webhook,\x20updating\x20payment\x20link\x20counter',',\x20gatewayOrderId:\x20','CoinToPay2Service','remitterName','üîç\x20Trying\x20to\x20find\x20VISA\x20payment\x20by\x20various\x20fields...','%\x20gateway\x20commission)','üí∞\x20Final\x20balance\x20after\x20chargeback:\x20','\x20-\x20no\x20action\x20taken\x20(only\x20FAILED/EXPIRED\x20are\x20processed)','1089JhCZjU','processAmerWebhook','gatewayCommissionRate','Payment\x20marked\x20as\x20CHARGEBACK\x20(no\x20penalty\x20specified)','Missing\x20customerOrderId\x20in\x20MyXSpend\x20webhook','No\x20payment\x20ID\x20in\x20Noda\x20webhook','\x20status\x20updated\x20to\x20FAILED','üîç\x20Searched\x20by:\x20gatewayOrderId=\x22','‚ö†Ô∏è\x20CHARGEBACK\x20without\x20penalty\x20amount\x20-\x20no\x20balance\x20change',':\x20type=','bankId','‚ùå\x20Error\x20processing\x20AmPay\x20TRY\x20webhook:',',\x20currentPayments=','status','No\x20amountUSDT\x20found\x20for\x20payment,\x20nothing\x20to\x20remove\x20from\x20balance','shopId','loggerService','additionalInfo','üìà\x20Payment\x20','Missing\x20client_transaction_id\x20in\x20AmPay\x20webhook','settings','ampay_try','txUrls','./gateways/coinToPay2Service',',\x20gatewayPaymentId:\x20','\x20not\x20found','\x20status\x20','processRapydWebhook','paymentId','CHARGEBACK','7081326pQxGMY','\x20USDT\x20(payment\x20no\x20longer\x20PAID)','‚ÑπÔ∏è\x20AmPay\x20status\x20','customerOrderId','findMany','gatewayPaymentId','logShopWebhookError','ampay_try_','myxspend_','./currencyService','No\x20specific\x20commission\x20found\x20for\x20gateway\x20','NodaService','\x20=\x20','visa_mastercard','MasterCard\x20payment\x20not\x20found:\x20','Error\x20processing\x20KLYME\x20webhook:','./gateways/klymeService','amer','No\x20payment\x20ID\x20in\x20VISA\x20webhook','AmerService','mastercard','now','errorMessage','plisio','rapydService','üè™\x20Shop\x20','gatewayOrderId','error','‚ùå\x20No\x20payment\x20ID\x20extracted\x20from\x20MasterCard\x20webhook\x20data','Found',',\x20Status=',',\x20GatewayPaymentId=','commission','‚ùå\x20Payment\x20not\x20found\x20for\x20MyXSpend\x20customerOrderId:\x20','Payment\x20not\x20found:\x20','sendPaymentStatusNotification','toISOString','PlisioService','‚ùå\x20Payment\x20not\x20found\x20for\x20MasterCard\x20webhook\x20with\x20ID:\x20','\x20current\x20balance:\x20','visa','‚ùå\x20No\x20payment\x20ID\x20extracted\x20from\x20Amer\x20webhook\x20data','üí∞\x20Amount\x20after\x20gateway\x20commission:\x20','4sHuWFO','24790MaSfYr','üîç\x20VISA\x20webhook:\x20Searching\x20for\x20payment\x20with\x20ID:\x20','MASTERCARD','üí∞\x20Removing\x20from\x20balance:\x20','üìä\x20Plisio\x20webhook:\x20Payment\x20','update','‚úÖ\x20Found\x20payment:\x20ID=','default','processMasterCardWebhook','‚ùå\x20No\x20payment\x20ID\x20extracted\x20from\x20VISA\x20webhook\x20data','created','__importDefault','COMPLETED','system','Failed\x20to\x20send\x20Telegram\x20payment\x20notification:',',\x20gateway\x20','klyme','log','webhook_status_change_','‚úÖ\x20VISA\x20webhook\x20processed\x20successfully\x20for\x20payment\x20','Payment\x20not\x20found\x20for\x20Noda\x20webhook:\x20','ampay_','customerName','currencyService','üîç\x20VISA\x20payment\x20search\x20result:\x20','amerService','FAILED','username','cardLast4','üí∞\x20Gateway\x20','Error\x20processing\x20Plisio\x20Gateway\x20webhook:','processAmPayWebhook','üîÑ\x20Processing\x20MasterCard\x20webhook:','‚úÖ\x20AmPay\x20TRY\x20webhook\x20processed:\x20Payment\x20','findFirst','WebhookService','Payment\x20','processNodaWebhook','processWebhook','amount','payment','ampayTRYService','VISA\x20payment\x20not\x20found:\x20','Not\x20found','application/json','üîç\x20Searching\x20for\x20VISA\x20payment\x20with\x20the\x20following\x20criteria:','‚ÑπÔ∏è\x20Decline\x20reason:\x20','processMyXSpendWebhook','REFUND','failed','entries','currentPayments','üìä\x20CoinToPay\x20webhook:\x20Payment\x20','Payment\x20not\x20found\x20for\x20Plisio\x20webhook:\x20','ampayService','\x22,\x20id=\x22','‚ùå\x20VISA\x20payment\x20failed\x20with\x20message:\x20','\x20\x20\x20-\x20Will\x20search\x20in:\x20gatewayPaymentId,\x20gatewayOrderId,\x20id,\x20orderId','Payment\x20not\x20found\x20for\x20KLYME\x20webhook:\x20','myxspend','üìä\x20AmPay\x20TRY\x20webhook\x20data:','17790oJWKIl','Missing\x20client_transaction_id\x20in\x20AmPay\x20TRY\x20webhook','POST','chargeback','toUpperCase','logWebhookProcessed','paid','üîÑ\x20Processing\x20Plisio\x20webhook:','‚ùå\x20Payment\x20not\x20found\x20for\x20Amer\x20webhook\x20with\x20ID:\x20','\x20in\x20shop\x20','processCoinToPay2Webhook','üîç\x20Amer\x20webhook:\x20Searching\x20for\x20payment\x20with\x20ID:\x20','balance','üí∏\x20CHARGEBACK:\x20Processing\x20penalty-only\x20deduction','cointopay','‚úÖ\x20Payment\x20link\x20','paymentMethod','orderId','processVisaWebhook','6bolnPQ','No\x20additional\x20info','SINGLE','üîç\x20Trying\x20to\x20find\x20MasterCard\x20payment\x20by\x20various\x20fields...'];a69_0x29d1=function(){return _0x107ac4;};return a69_0x29d1();}exports[a69_0x488c27(0x18e)]=WebhookService;