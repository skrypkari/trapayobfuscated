'use strict';const a82_0xb04252=a82_0x81c9;(function(_0x22a81b,_0x4f63ff){const _0x4ae5c2=a82_0x81c9,_0x4e583f=_0x22a81b();while(!![]){try{const _0x30a0c4=-parseInt(_0x4ae5c2(0x177))/0x1+-parseInt(_0x4ae5c2(0x175))/0x2+parseInt(_0x4ae5c2(0x188))/0x3+parseInt(_0x4ae5c2(0x172))/0x4*(parseInt(_0x4ae5c2(0x17a))/0x5)+-parseInt(_0x4ae5c2(0x18e))/0x6+parseInt(_0x4ae5c2(0x185))/0x7+parseInt(_0x4ae5c2(0x176))/0x8;if(_0x30a0c4===_0x4f63ff)break;else _0x4e583f['push'](_0x4e583f['shift']());}catch(_0x2f0a48){_0x4e583f['push'](_0x4e583f['shift']());}}}(a82_0x566d,0xa0b45));function a82_0x566d(){const _0xcea542=['merchantUrl','usdtErcWallet','2286990xVJIhT','toString','hash','update','create','Username\x20already\x20exists','4268100aMMruq','randomBytes','desc','username','usdtTrcWallet','__esModule','findMany','UserService','getUserById','shop','ACTIVE','name','deleteUser','createdAt','gateways','status','__importDefault','default','findUnique','delete','telegram','generateApiKeys','hex','stringify','telegramId','../config/database','updateUser','defineProperty','shopUrl','12256uxbVDn','Telegram\x20username\x20already\x20exists','bcryptjs','272418YEGhVa','2143112xKrvcK','571579UskWDz','gatewaySettings','usdtPolygonWallet','890WpDpEA','wallets','crypto','pk_','usdcPolygonWallet','fullName','publicKey','getAllUsers','parse','paymentGateways','password','3512404GNLjKM'];a82_0x566d=function(){return _0xcea542;};return a82_0x566d();}var __importDefault=this&&this[a82_0xb04252(0x19e)]||function(_0x24e430){const _0x3dc6c7=a82_0xb04252;return _0x24e430&&_0x24e430[_0x3dc6c7(0x193)]?_0x24e430:{'default':_0x24e430};};function a82_0x81c9(_0x4b2211,_0x2452ab){_0x4b2211=_0x4b2211-0x171;const _0x566d5f=a82_0x566d();let _0x81c925=_0x566d5f[_0x4b2211];return _0x81c925;}Object[a82_0xb04252(0x1a9)](exports,a82_0xb04252(0x193),{'value':!![]}),exports[a82_0xb04252(0x195)]=void 0x0;const bcryptjs_1=__importDefault(require(a82_0xb04252(0x174))),crypto_1=__importDefault(require(a82_0xb04252(0x17c))),database_1=__importDefault(require(a82_0xb04252(0x1a7)));class UserService{[a82_0xb04252(0x1a3)](){const _0x2dade7=a82_0xb04252,_0x306454=_0x2dade7(0x17d)+crypto_1[_0x2dade7(0x19f)][_0x2dade7(0x18f)](0x20)[_0x2dade7(0x189)](_0x2dade7(0x1a4)),_0x21815f='sk_'+crypto_1[_0x2dade7(0x19f)][_0x2dade7(0x18f)](0x20)[_0x2dade7(0x189)](_0x2dade7(0x1a4));return{'publicKey':_0x306454,'secretKey':_0x21815f};}async['createUser'](_0x27a713){const _0x5b567a=a82_0xb04252,{fullName:_0xa8d11c,username:_0x10fcd8,password:_0x3212e2,telegramId:_0xdb4a27,merchantUrl:_0x3e0113,gateways:_0x48cac2,gatewaySettings:_0x369839,wallets:_0xac9813}=_0x27a713,_0x167c7c=await database_1[_0x5b567a(0x19f)]['shop']['findUnique']({'where':{'username':_0x10fcd8}});if(_0x167c7c)throw new Error(_0x5b567a(0x18d));if(_0xdb4a27){const _0x2f9857=await database_1[_0x5b567a(0x19f)][_0x5b567a(0x197)][_0x5b567a(0x1a0)]({'where':{'telegram':_0xdb4a27}});if(_0x2f9857)throw new Error(_0x5b567a(0x173));}const _0xfa89ff=await bcryptjs_1['default'][_0x5b567a(0x18a)](_0x3212e2,0xc),{publicKey:_0x28fa15,secretKey:_0x5a04d8}=this['generateApiKeys'](),_0x51817f=await database_1[_0x5b567a(0x19f)][_0x5b567a(0x197)][_0x5b567a(0x18c)]({'data':{'name':_0xa8d11c,'username':_0x10fcd8,'password':_0xfa89ff,'telegram':_0xdb4a27,'shopUrl':_0x3e0113,'paymentGateways':_0x48cac2?JSON[_0x5b567a(0x1a5)](_0x48cac2):null,'gatewaySettings':_0x369839?JSON[_0x5b567a(0x1a5)](_0x369839):null,'usdtPolygonWallet':_0xac9813?.[_0x5b567a(0x179)]||null,'usdtTrcWallet':_0xac9813?.[_0x5b567a(0x192)]||null,'usdtErcWallet':_0xac9813?.['usdtErcWallet']||null,'usdcPolygonWallet':_0xac9813?.[_0x5b567a(0x17e)]||null,'publicKey':_0x28fa15,'secretKey':_0x5a04d8,'status':_0x5b567a(0x198)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x51817f['id'],'fullName':_0x51817f[_0x5b567a(0x199)],'username':_0x51817f['username'],'telegramId':_0x51817f[_0x5b567a(0x1a2)],'merchantUrl':_0x51817f['shopUrl'],'gateways':_0x51817f[_0x5b567a(0x183)]?JSON[_0x5b567a(0x182)](_0x51817f['paymentGateways']):null,'gatewaySettings':_0x51817f[_0x5b567a(0x178)]?JSON[_0x5b567a(0x182)](_0x51817f[_0x5b567a(0x178)]):null,'publicKey':_0x51817f[_0x5b567a(0x180)],'wallets':{'usdtPolygonWallet':_0x51817f['usdtPolygonWallet'],'usdtTrcWallet':_0x51817f[_0x5b567a(0x192)],'usdtErcWallet':_0x51817f['usdtErcWallet'],'usdcPolygonWallet':_0x51817f[_0x5b567a(0x17e)]},'status':_0x51817f[_0x5b567a(0x19d)],'createdAt':_0x51817f[_0x5b567a(0x19b)]};}async[a82_0xb04252(0x181)](){const _0x26d645=a82_0xb04252,_0x5e24c1=await database_1[_0x26d645(0x19f)][_0x26d645(0x197)][_0x26d645(0x194)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x26d645(0x190)}});return _0x5e24c1['map'](_0x26c8e3=>({'id':_0x26c8e3['id'],'fullName':_0x26c8e3[_0x26d645(0x199)],'username':_0x26c8e3[_0x26d645(0x191)],'telegramId':_0x26c8e3[_0x26d645(0x1a2)],'merchantUrl':_0x26c8e3[_0x26d645(0x171)],'gateways':_0x26c8e3[_0x26d645(0x183)]?JSON[_0x26d645(0x182)](_0x26c8e3[_0x26d645(0x183)]):null,'gatewaySettings':_0x26c8e3[_0x26d645(0x178)]?JSON['parse'](_0x26c8e3[_0x26d645(0x178)]):null,'publicKey':_0x26c8e3[_0x26d645(0x180)],'wallets':{'usdtPolygonWallet':_0x26c8e3['usdtPolygonWallet'],'usdtTrcWallet':_0x26c8e3[_0x26d645(0x192)],'usdtErcWallet':_0x26c8e3['usdtErcWallet'],'usdcPolygonWallet':_0x26c8e3[_0x26d645(0x17e)]},'status':_0x26c8e3[_0x26d645(0x19d)],'createdAt':_0x26c8e3[_0x26d645(0x19b)]}));}async[a82_0xb04252(0x196)](_0x518384){const _0x10e030=a82_0xb04252,_0x48a8d0=await database_1[_0x10e030(0x19f)]['shop']['findUnique']({'where':{'id':_0x518384},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x48a8d0)return null;return{'id':_0x48a8d0['id'],'fullName':_0x48a8d0['name'],'username':_0x48a8d0['username'],'telegramId':_0x48a8d0[_0x10e030(0x1a2)],'merchantUrl':_0x48a8d0[_0x10e030(0x171)],'gateways':_0x48a8d0['paymentGateways']?JSON[_0x10e030(0x182)](_0x48a8d0[_0x10e030(0x183)]):null,'gatewaySettings':_0x48a8d0[_0x10e030(0x178)]?JSON[_0x10e030(0x182)](_0x48a8d0[_0x10e030(0x178)]):null,'publicKey':_0x48a8d0['publicKey'],'wallets':{'usdtPolygonWallet':_0x48a8d0[_0x10e030(0x179)],'usdtTrcWallet':_0x48a8d0[_0x10e030(0x192)],'usdtErcWallet':_0x48a8d0[_0x10e030(0x187)],'usdcPolygonWallet':_0x48a8d0[_0x10e030(0x17e)]},'status':_0x48a8d0[_0x10e030(0x19d)],'createdAt':_0x48a8d0[_0x10e030(0x19b)]};}async[a82_0xb04252(0x1a8)](_0x303a6e,_0x56a556){const _0x4a3326=a82_0xb04252,_0x1ef7e6={..._0x56a556};_0x56a556[_0x4a3326(0x184)]&&(_0x1ef7e6[_0x4a3326(0x184)]=await bcryptjs_1[_0x4a3326(0x19f)][_0x4a3326(0x18a)](_0x56a556['password'],0xc));_0x56a556[_0x4a3326(0x17f)]&&(_0x1ef7e6[_0x4a3326(0x199)]=_0x56a556[_0x4a3326(0x17f)],delete _0x1ef7e6[_0x4a3326(0x17f)]);_0x56a556[_0x4a3326(0x1a6)]&&(_0x1ef7e6[_0x4a3326(0x1a2)]=_0x56a556[_0x4a3326(0x1a6)],delete _0x1ef7e6[_0x4a3326(0x1a6)]);_0x56a556[_0x4a3326(0x186)]&&(_0x1ef7e6[_0x4a3326(0x171)]=_0x56a556['merchantUrl'],delete _0x1ef7e6[_0x4a3326(0x186)]);_0x56a556['gateways']&&(_0x1ef7e6['paymentGateways']=JSON[_0x4a3326(0x1a5)](_0x56a556['gateways']),delete _0x1ef7e6[_0x4a3326(0x19c)]);_0x56a556[_0x4a3326(0x178)]&&(_0x1ef7e6[_0x4a3326(0x178)]=JSON[_0x4a3326(0x1a5)](_0x56a556[_0x4a3326(0x178)]),delete _0x1ef7e6[_0x4a3326(0x178)]);_0x56a556[_0x4a3326(0x17b)]&&(_0x56a556[_0x4a3326(0x17b)][_0x4a3326(0x179)]!==undefined&&(_0x1ef7e6['usdtPolygonWallet']=_0x56a556['wallets']['usdtPolygonWallet']||null),_0x56a556[_0x4a3326(0x17b)][_0x4a3326(0x192)]!==undefined&&(_0x1ef7e6[_0x4a3326(0x192)]=_0x56a556[_0x4a3326(0x17b)]['usdtTrcWallet']||null),_0x56a556['wallets'][_0x4a3326(0x187)]!==undefined&&(_0x1ef7e6[_0x4a3326(0x187)]=_0x56a556[_0x4a3326(0x17b)][_0x4a3326(0x187)]||null),_0x56a556['wallets'][_0x4a3326(0x17e)]!==undefined&&(_0x1ef7e6[_0x4a3326(0x17e)]=_0x56a556[_0x4a3326(0x17b)][_0x4a3326(0x17e)]||null),delete _0x1ef7e6[_0x4a3326(0x17b)]);const _0x58f7b1=await database_1[_0x4a3326(0x19f)][_0x4a3326(0x197)][_0x4a3326(0x18b)]({'where':{'id':_0x303a6e},'data':_0x1ef7e6,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x58f7b1['id'],'fullName':_0x58f7b1[_0x4a3326(0x199)],'username':_0x58f7b1[_0x4a3326(0x191)],'telegramId':_0x58f7b1['telegram'],'merchantUrl':_0x58f7b1[_0x4a3326(0x171)],'gateways':_0x58f7b1['paymentGateways']?JSON[_0x4a3326(0x182)](_0x58f7b1[_0x4a3326(0x183)]):null,'gatewaySettings':_0x58f7b1[_0x4a3326(0x178)]?JSON[_0x4a3326(0x182)](_0x58f7b1['gatewaySettings']):null,'publicKey':_0x58f7b1['publicKey'],'wallets':{'usdtPolygonWallet':_0x58f7b1[_0x4a3326(0x179)],'usdtTrcWallet':_0x58f7b1['usdtTrcWallet'],'usdtErcWallet':_0x58f7b1[_0x4a3326(0x187)],'usdcPolygonWallet':_0x58f7b1['usdcPolygonWallet']},'status':_0x58f7b1[_0x4a3326(0x19d)],'createdAt':_0x58f7b1['createdAt']};}async[a82_0xb04252(0x19a)](_0x1004e3){const _0x45346b=a82_0xb04252;await database_1[_0x45346b(0x19f)][_0x45346b(0x197)][_0x45346b(0x1a1)]({'where':{'id':_0x1004e3}});}}exports['UserService']=UserService;