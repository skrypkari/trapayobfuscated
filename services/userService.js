'use strict';function a57_0x46ac(){const _0x5d9ddf=['sk_','gatewaySettings','create','fullName','telegram','update','usdtErcWallet','../config/database','wallets','5DOCQfO','findUnique','usdtTrcWallet','stringify','9939321KlaFKe','toString','deleteUser','3325794MYnaDD','status','bcryptjs','delete','shopUrl','map','hex','createdAt','hash','Telegram\x20username\x20already\x20exists','4286454hlPeiM','getUserById','crypto','publicKey','__importDefault','parse','paymentGateways','shop','2906712bPOPQL','createUser','usdtPolygonWallet','defineProperty','default','telegramId','updateUser','usdcPolygonWallet','username','randomBytes','11470824tBfUDy','findMany','password','2435664GmeIXZ','UserService','generateApiKeys','182262LuTQcC','desc','gateways','name','getAllUsers','merchantUrl','__esModule'];a57_0x46ac=function(){return _0x5d9ddf;};return a57_0x46ac();}function a57_0x3f07(_0x33a317,_0x2745a7){const _0x46acde=a57_0x46ac();return a57_0x3f07=function(_0x3f0758,_0x5c524f){_0x3f0758=_0x3f0758-0x1a8;let _0x5ed43f=_0x46acde[_0x3f0758];return _0x5ed43f;},a57_0x3f07(_0x33a317,_0x2745a7);}const a57_0x46732f=a57_0x3f07;(function(_0x3d73d2,_0x4b7201){const _0x280950=a57_0x3f07,_0x3f54c8=_0x3d73d2();while(!![]){try{const _0x4525d2=-parseInt(_0x280950(0x1d0))/0x1+parseInt(_0x280950(0x1cd))/0x2+parseInt(_0x280950(0x1ae))/0x3+parseInt(_0x280950(0x1c0))/0x4+parseInt(_0x280950(0x1e0))/0x5*(parseInt(_0x280950(0x1b8))/0x6)+-parseInt(_0x280950(0x1ab))/0x7+-parseInt(_0x280950(0x1ca))/0x8;if(_0x4525d2===_0x4b7201)break;else _0x3f54c8['push'](_0x3f54c8['shift']());}catch(_0x425d04){_0x3f54c8['push'](_0x3f54c8['shift']());}}}(a57_0x46ac,0xb296b));var __importDefault=this&&this[a57_0x46732f(0x1bc)]||function(_0xcc6eb0){const _0x2ba071=a57_0x46732f;return _0xcc6eb0&&_0xcc6eb0[_0x2ba071(0x1d6)]?_0xcc6eb0:{'default':_0xcc6eb0};};Object[a57_0x46732f(0x1c3)](exports,a57_0x46732f(0x1d6),{'value':!![]}),exports[a57_0x46732f(0x1ce)]=void 0x0;const bcryptjs_1=__importDefault(require(a57_0x46732f(0x1b0))),crypto_1=__importDefault(require(a57_0x46732f(0x1ba))),database_1=__importDefault(require(a57_0x46732f(0x1de)));class UserService{[a57_0x46732f(0x1cf)](){const _0x59a5a7=a57_0x46732f,_0x574e8a='pk_'+crypto_1[_0x59a5a7(0x1c4)][_0x59a5a7(0x1c9)](0x20)[_0x59a5a7(0x1ac)](_0x59a5a7(0x1b4)),_0x431575=_0x59a5a7(0x1d7)+crypto_1[_0x59a5a7(0x1c4)][_0x59a5a7(0x1c9)](0x20)[_0x59a5a7(0x1ac)](_0x59a5a7(0x1b4));return{'publicKey':_0x574e8a,'secretKey':_0x431575};}async[a57_0x46732f(0x1c1)](_0x59e1f8){const _0x19f65f=a57_0x46732f,{fullName:_0x21b3de,username:_0x54ea11,password:_0xebf5c0,telegramId:_0x32e62e,merchantUrl:_0x3e0562,gateways:_0x19bbba,gatewaySettings:_0x914974,wallets:_0x9be7b8}=_0x59e1f8,_0x13478e=await database_1[_0x19f65f(0x1c4)][_0x19f65f(0x1bf)]['findUnique']({'where':{'username':_0x54ea11}});if(_0x13478e)throw new Error('Username\x20already\x20exists');if(_0x32e62e){const _0x492e53=await database_1[_0x19f65f(0x1c4)]['shop'][_0x19f65f(0x1a8)]({'where':{'telegram':_0x32e62e}});if(_0x492e53)throw new Error(_0x19f65f(0x1b7));}const _0x1d2986=await bcryptjs_1['default'][_0x19f65f(0x1b6)](_0xebf5c0,0xc),{publicKey:_0x1f2882,secretKey:_0x559255}=this[_0x19f65f(0x1cf)](),_0x16e3c5=await database_1[_0x19f65f(0x1c4)][_0x19f65f(0x1bf)][_0x19f65f(0x1d9)]({'data':{'name':_0x21b3de,'username':_0x54ea11,'password':_0x1d2986,'telegram':_0x32e62e,'shopUrl':_0x3e0562,'paymentGateways':_0x19bbba?JSON['stringify'](_0x19bbba):null,'gatewaySettings':_0x914974?JSON[_0x19f65f(0x1aa)](_0x914974):null,'usdtPolygonWallet':_0x9be7b8?.[_0x19f65f(0x1c2)]||null,'usdtTrcWallet':_0x9be7b8?.['usdtTrcWallet']||null,'usdtErcWallet':_0x9be7b8?.[_0x19f65f(0x1dd)]||null,'usdcPolygonWallet':_0x9be7b8?.[_0x19f65f(0x1c7)]||null,'publicKey':_0x1f2882,'secretKey':_0x559255,'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x16e3c5['id'],'fullName':_0x16e3c5[_0x19f65f(0x1d3)],'username':_0x16e3c5[_0x19f65f(0x1c8)],'telegramId':_0x16e3c5[_0x19f65f(0x1db)],'merchantUrl':_0x16e3c5[_0x19f65f(0x1b2)],'gateways':_0x16e3c5['paymentGateways']?JSON[_0x19f65f(0x1bd)](_0x16e3c5['paymentGateways']):null,'gatewaySettings':_0x16e3c5[_0x19f65f(0x1d8)]?JSON[_0x19f65f(0x1bd)](_0x16e3c5['gatewaySettings']):null,'publicKey':_0x16e3c5[_0x19f65f(0x1bb)],'wallets':{'usdtPolygonWallet':_0x16e3c5['usdtPolygonWallet'],'usdtTrcWallet':_0x16e3c5[_0x19f65f(0x1a9)],'usdtErcWallet':_0x16e3c5[_0x19f65f(0x1dd)],'usdcPolygonWallet':_0x16e3c5[_0x19f65f(0x1c7)]},'status':_0x16e3c5[_0x19f65f(0x1af)],'createdAt':_0x16e3c5[_0x19f65f(0x1b5)]};}async[a57_0x46732f(0x1d4)](){const _0x694949=a57_0x46732f,_0x2b7bf0=await database_1[_0x694949(0x1c4)]['shop'][_0x694949(0x1cb)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x694949(0x1d1)}});return _0x2b7bf0[_0x694949(0x1b3)](_0x344d4e=>({'id':_0x344d4e['id'],'fullName':_0x344d4e['name'],'username':_0x344d4e[_0x694949(0x1c8)],'telegramId':_0x344d4e[_0x694949(0x1db)],'merchantUrl':_0x344d4e[_0x694949(0x1b2)],'gateways':_0x344d4e['paymentGateways']?JSON[_0x694949(0x1bd)](_0x344d4e[_0x694949(0x1be)]):null,'gatewaySettings':_0x344d4e['gatewaySettings']?JSON[_0x694949(0x1bd)](_0x344d4e[_0x694949(0x1d8)]):null,'publicKey':_0x344d4e['publicKey'],'wallets':{'usdtPolygonWallet':_0x344d4e['usdtPolygonWallet'],'usdtTrcWallet':_0x344d4e[_0x694949(0x1a9)],'usdtErcWallet':_0x344d4e[_0x694949(0x1dd)],'usdcPolygonWallet':_0x344d4e[_0x694949(0x1c7)]},'status':_0x344d4e[_0x694949(0x1af)],'createdAt':_0x344d4e[_0x694949(0x1b5)]}));}async[a57_0x46732f(0x1b9)](_0x41ee34){const _0x241cb7=a57_0x46732f,_0x327863=await database_1[_0x241cb7(0x1c4)][_0x241cb7(0x1bf)][_0x241cb7(0x1a8)]({'where':{'id':_0x41ee34},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x327863)return null;return{'id':_0x327863['id'],'fullName':_0x327863['name'],'username':_0x327863[_0x241cb7(0x1c8)],'telegramId':_0x327863[_0x241cb7(0x1db)],'merchantUrl':_0x327863[_0x241cb7(0x1b2)],'gateways':_0x327863[_0x241cb7(0x1be)]?JSON[_0x241cb7(0x1bd)](_0x327863[_0x241cb7(0x1be)]):null,'gatewaySettings':_0x327863[_0x241cb7(0x1d8)]?JSON[_0x241cb7(0x1bd)](_0x327863[_0x241cb7(0x1d8)]):null,'publicKey':_0x327863[_0x241cb7(0x1bb)],'wallets':{'usdtPolygonWallet':_0x327863['usdtPolygonWallet'],'usdtTrcWallet':_0x327863[_0x241cb7(0x1a9)],'usdtErcWallet':_0x327863[_0x241cb7(0x1dd)],'usdcPolygonWallet':_0x327863[_0x241cb7(0x1c7)]},'status':_0x327863['status'],'createdAt':_0x327863[_0x241cb7(0x1b5)]};}async[a57_0x46732f(0x1c6)](_0x429335,_0x48d660){const _0x328aa6=a57_0x46732f,_0x1023b7={..._0x48d660};_0x48d660[_0x328aa6(0x1cc)]&&(_0x1023b7[_0x328aa6(0x1cc)]=await bcryptjs_1['default'][_0x328aa6(0x1b6)](_0x48d660['password'],0xc));_0x48d660[_0x328aa6(0x1da)]&&(_0x1023b7[_0x328aa6(0x1d3)]=_0x48d660['fullName'],delete _0x1023b7['fullName']);_0x48d660[_0x328aa6(0x1c5)]&&(_0x1023b7[_0x328aa6(0x1db)]=_0x48d660[_0x328aa6(0x1c5)],delete _0x1023b7['telegramId']);_0x48d660[_0x328aa6(0x1d5)]&&(_0x1023b7[_0x328aa6(0x1b2)]=_0x48d660[_0x328aa6(0x1d5)],delete _0x1023b7[_0x328aa6(0x1d5)]);_0x48d660[_0x328aa6(0x1d2)]&&(_0x1023b7['paymentGateways']=JSON[_0x328aa6(0x1aa)](_0x48d660[_0x328aa6(0x1d2)]),delete _0x1023b7[_0x328aa6(0x1d2)]);_0x48d660['gatewaySettings']&&(_0x1023b7[_0x328aa6(0x1d8)]=JSON[_0x328aa6(0x1aa)](_0x48d660[_0x328aa6(0x1d8)]),delete _0x1023b7['gatewaySettings']);_0x48d660[_0x328aa6(0x1df)]&&(_0x48d660[_0x328aa6(0x1df)][_0x328aa6(0x1c2)]!==undefined&&(_0x1023b7['usdtPolygonWallet']=_0x48d660[_0x328aa6(0x1df)][_0x328aa6(0x1c2)]||null),_0x48d660['wallets'][_0x328aa6(0x1a9)]!==undefined&&(_0x1023b7['usdtTrcWallet']=_0x48d660['wallets'][_0x328aa6(0x1a9)]||null),_0x48d660['wallets']['usdtErcWallet']!==undefined&&(_0x1023b7[_0x328aa6(0x1dd)]=_0x48d660[_0x328aa6(0x1df)][_0x328aa6(0x1dd)]||null),_0x48d660[_0x328aa6(0x1df)][_0x328aa6(0x1c7)]!==undefined&&(_0x1023b7[_0x328aa6(0x1c7)]=_0x48d660['wallets'][_0x328aa6(0x1c7)]||null),delete _0x1023b7[_0x328aa6(0x1df)]);const _0x3909c9=await database_1[_0x328aa6(0x1c4)][_0x328aa6(0x1bf)][_0x328aa6(0x1dc)]({'where':{'id':_0x429335},'data':_0x1023b7,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x3909c9['id'],'fullName':_0x3909c9[_0x328aa6(0x1d3)],'username':_0x3909c9[_0x328aa6(0x1c8)],'telegramId':_0x3909c9['telegram'],'merchantUrl':_0x3909c9[_0x328aa6(0x1b2)],'gateways':_0x3909c9[_0x328aa6(0x1be)]?JSON[_0x328aa6(0x1bd)](_0x3909c9['paymentGateways']):null,'gatewaySettings':_0x3909c9[_0x328aa6(0x1d8)]?JSON[_0x328aa6(0x1bd)](_0x3909c9[_0x328aa6(0x1d8)]):null,'publicKey':_0x3909c9['publicKey'],'wallets':{'usdtPolygonWallet':_0x3909c9[_0x328aa6(0x1c2)],'usdtTrcWallet':_0x3909c9[_0x328aa6(0x1a9)],'usdtErcWallet':_0x3909c9[_0x328aa6(0x1dd)],'usdcPolygonWallet':_0x3909c9[_0x328aa6(0x1c7)]},'status':_0x3909c9[_0x328aa6(0x1af)],'createdAt':_0x3909c9['createdAt']};}async[a57_0x46732f(0x1ad)](_0xbdfed5){const _0x2eef2b=a57_0x46732f;await database_1[_0x2eef2b(0x1c4)][_0x2eef2b(0x1bf)][_0x2eef2b(0x1b1)]({'where':{'id':_0xbdfed5}});}}exports[a57_0x46732f(0x1ce)]=UserService;