'use strict';function a51_0x4d22(_0x2e0d1c,_0x2c2ce8){const _0x12dc08=a51_0x12dc();return a51_0x4d22=function(_0x4d22b2,_0x2fb6c5){_0x4d22b2=_0x4d22b2-0x146;let _0x115d87=_0x12dc08[_0x4d22b2];return _0x115d87;},a51_0x4d22(_0x2e0d1c,_0x2c2ce8);}function a51_0x12dc(){const _0xf1d9ec=['shopUrl','hex','toString','Telegram\x20username\x20already\x20exists','default','gatewaySettings','usdtPolygonWallet','2164184STDgsn','UserService','deleteUser','stringify','telegramId','187722xrNDgs','1064468eymEHH','password','usdtTrcWallet','paymentGateways','__esModule','1qkEUuk','14Mtfnxe','delete','parse','ACTIVE','3697260AKAxXP','usdcPolygonWallet','status','wallets','__importDefault','usdtErcWallet','2198247MovGif','name','generateApiKeys','publicKey','pk_','hash','../config/database','findUnique','findMany','update','createdAt','randomBytes','merchantUrl','115TUAEmT','desc','80322IBPquQ','crypto','8970808qKvtDM','shop','createUser','gateways','getAllUsers','400PvViYi','username','telegram','bcryptjs','fullName'];a51_0x12dc=function(){return _0xf1d9ec;};return a51_0x12dc();}const a51_0x2f66ba=a51_0x4d22;(function(_0x2fecff,_0x2113a4){const _0x462972=a51_0x4d22,_0x1c7049=_0x2fecff();while(!![]){try{const _0xe8118d=-parseInt(_0x462972(0x168))/0x1*(-parseInt(_0x462972(0x163))/0x2)+parseInt(_0x462972(0x173))/0x3+-parseInt(_0x462972(0x16d))/0x4+parseInt(_0x462972(0x148))/0x5*(-parseInt(_0x462972(0x14a))/0x6)+-parseInt(_0x462972(0x169))/0x7*(-parseInt(_0x462972(0x15d))/0x8)+-parseInt(_0x462972(0x162))/0x9*(parseInt(_0x462972(0x151))/0xa)+parseInt(_0x462972(0x14c))/0xb;if(_0xe8118d===_0x2113a4)break;else _0x1c7049['push'](_0x1c7049['shift']());}catch(_0x1c5e43){_0x1c7049['push'](_0x1c7049['shift']());}}}(a51_0x12dc,0x8780d));var __importDefault=this&&this[a51_0x2f66ba(0x171)]||function(_0x146543){const _0x30485f=a51_0x2f66ba;return _0x146543&&_0x146543[_0x30485f(0x167)]?_0x146543:{'default':_0x146543};};Object['defineProperty'](exports,a51_0x2f66ba(0x167),{'value':!![]}),exports[a51_0x2f66ba(0x15e)]=void 0x0;const bcryptjs_1=__importDefault(require(a51_0x2f66ba(0x154))),crypto_1=__importDefault(require(a51_0x2f66ba(0x14b))),database_1=__importDefault(require(a51_0x2f66ba(0x179)));class UserService{[a51_0x2f66ba(0x175)](){const _0x40502b=a51_0x2f66ba,_0x47831a=_0x40502b(0x177)+crypto_1[_0x40502b(0x15a)]['randomBytes'](0x20)[_0x40502b(0x158)](_0x40502b(0x157)),_0x55638e='sk_'+crypto_1[_0x40502b(0x15a)][_0x40502b(0x146)](0x20)[_0x40502b(0x158)]('hex');return{'publicKey':_0x47831a,'secretKey':_0x55638e};}async[a51_0x2f66ba(0x14e)](_0x3df360){const _0x214fb4=a51_0x2f66ba,{fullName:_0x4cc0f4,username:_0x527461,password:_0x1c6053,telegramId:_0x4b5d2f,merchantUrl:_0x103861,gateways:_0xb4a811,gatewaySettings:_0x38e531,wallets:_0x5804b6}=_0x3df360,_0xeb1d71=await database_1[_0x214fb4(0x15a)][_0x214fb4(0x14d)][_0x214fb4(0x17a)]({'where':{'username':_0x527461}});if(_0xeb1d71)throw new Error('Username\x20already\x20exists');if(_0x4b5d2f){const _0x1e4240=await database_1[_0x214fb4(0x15a)]['shop'][_0x214fb4(0x17a)]({'where':{'telegram':_0x4b5d2f}});if(_0x1e4240)throw new Error(_0x214fb4(0x159));}const _0x2433ae=await bcryptjs_1[_0x214fb4(0x15a)][_0x214fb4(0x178)](_0x1c6053,0xc),{publicKey:_0x4ca999,secretKey:_0x5e499a}=this[_0x214fb4(0x175)](),_0x66b2bc=await database_1[_0x214fb4(0x15a)][_0x214fb4(0x14d)]['create']({'data':{'name':_0x4cc0f4,'username':_0x527461,'password':_0x2433ae,'telegram':_0x4b5d2f,'shopUrl':_0x103861,'paymentGateways':_0xb4a811?JSON[_0x214fb4(0x160)](_0xb4a811):null,'gatewaySettings':_0x38e531?JSON[_0x214fb4(0x160)](_0x38e531):null,'usdtPolygonWallet':_0x5804b6?.[_0x214fb4(0x15c)]||null,'usdtTrcWallet':_0x5804b6?.[_0x214fb4(0x165)]||null,'usdtErcWallet':_0x5804b6?.[_0x214fb4(0x172)]||null,'usdcPolygonWallet':_0x5804b6?.[_0x214fb4(0x16e)]||null,'publicKey':_0x4ca999,'secretKey':_0x5e499a,'status':_0x214fb4(0x16c)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x66b2bc['id'],'fullName':_0x66b2bc['name'],'username':_0x66b2bc['username'],'telegramId':_0x66b2bc[_0x214fb4(0x153)],'merchantUrl':_0x66b2bc[_0x214fb4(0x156)],'gateways':_0x66b2bc[_0x214fb4(0x166)]?JSON[_0x214fb4(0x16b)](_0x66b2bc['paymentGateways']):null,'gatewaySettings':_0x66b2bc[_0x214fb4(0x15b)]?JSON[_0x214fb4(0x16b)](_0x66b2bc[_0x214fb4(0x15b)]):null,'publicKey':_0x66b2bc[_0x214fb4(0x176)],'wallets':{'usdtPolygonWallet':_0x66b2bc['usdtPolygonWallet'],'usdtTrcWallet':_0x66b2bc['usdtTrcWallet'],'usdtErcWallet':_0x66b2bc[_0x214fb4(0x172)],'usdcPolygonWallet':_0x66b2bc[_0x214fb4(0x16e)]},'status':_0x66b2bc[_0x214fb4(0x16f)],'createdAt':_0x66b2bc['createdAt']};}async[a51_0x2f66ba(0x150)](){const _0x4dde94=a51_0x2f66ba,_0x1645fd=await database_1[_0x4dde94(0x15a)][_0x4dde94(0x14d)][_0x4dde94(0x17b)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x4dde94(0x149)}});return _0x1645fd['map'](_0x1356ac=>({'id':_0x1356ac['id'],'fullName':_0x1356ac[_0x4dde94(0x174)],'username':_0x1356ac[_0x4dde94(0x152)],'telegramId':_0x1356ac['telegram'],'merchantUrl':_0x1356ac['shopUrl'],'gateways':_0x1356ac[_0x4dde94(0x166)]?JSON[_0x4dde94(0x16b)](_0x1356ac[_0x4dde94(0x166)]):null,'gatewaySettings':_0x1356ac[_0x4dde94(0x15b)]?JSON[_0x4dde94(0x16b)](_0x1356ac[_0x4dde94(0x15b)]):null,'publicKey':_0x1356ac[_0x4dde94(0x176)],'wallets':{'usdtPolygonWallet':_0x1356ac[_0x4dde94(0x15c)],'usdtTrcWallet':_0x1356ac['usdtTrcWallet'],'usdtErcWallet':_0x1356ac[_0x4dde94(0x172)],'usdcPolygonWallet':_0x1356ac['usdcPolygonWallet']},'status':_0x1356ac['status'],'createdAt':_0x1356ac[_0x4dde94(0x17d)]}));}async['getUserById'](_0xc91319){const _0x124a3b=a51_0x2f66ba,_0x876024=await database_1[_0x124a3b(0x15a)][_0x124a3b(0x14d)][_0x124a3b(0x17a)]({'where':{'id':_0xc91319},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x876024)return null;return{'id':_0x876024['id'],'fullName':_0x876024['name'],'username':_0x876024[_0x124a3b(0x152)],'telegramId':_0x876024['telegram'],'merchantUrl':_0x876024['shopUrl'],'gateways':_0x876024[_0x124a3b(0x166)]?JSON[_0x124a3b(0x16b)](_0x876024[_0x124a3b(0x166)]):null,'gatewaySettings':_0x876024['gatewaySettings']?JSON[_0x124a3b(0x16b)](_0x876024['gatewaySettings']):null,'publicKey':_0x876024[_0x124a3b(0x176)],'wallets':{'usdtPolygonWallet':_0x876024[_0x124a3b(0x15c)],'usdtTrcWallet':_0x876024[_0x124a3b(0x165)],'usdtErcWallet':_0x876024[_0x124a3b(0x172)],'usdcPolygonWallet':_0x876024['usdcPolygonWallet']},'status':_0x876024[_0x124a3b(0x16f)],'createdAt':_0x876024[_0x124a3b(0x17d)]};}async['updateUser'](_0x200dcf,_0x5dadb4){const _0x45dc1=a51_0x2f66ba,_0x12ace2={..._0x5dadb4};_0x5dadb4['password']&&(_0x12ace2[_0x45dc1(0x164)]=await bcryptjs_1[_0x45dc1(0x15a)][_0x45dc1(0x178)](_0x5dadb4[_0x45dc1(0x164)],0xc));_0x5dadb4[_0x45dc1(0x155)]&&(_0x12ace2[_0x45dc1(0x174)]=_0x5dadb4[_0x45dc1(0x155)],delete _0x12ace2[_0x45dc1(0x155)]);_0x5dadb4[_0x45dc1(0x161)]&&(_0x12ace2[_0x45dc1(0x153)]=_0x5dadb4[_0x45dc1(0x161)],delete _0x12ace2[_0x45dc1(0x161)]);_0x5dadb4[_0x45dc1(0x147)]&&(_0x12ace2[_0x45dc1(0x156)]=_0x5dadb4[_0x45dc1(0x147)],delete _0x12ace2[_0x45dc1(0x147)]);_0x5dadb4['gateways']&&(_0x12ace2['paymentGateways']=JSON['stringify'](_0x5dadb4[_0x45dc1(0x14f)]),delete _0x12ace2[_0x45dc1(0x14f)]);_0x5dadb4['gatewaySettings']&&(_0x12ace2['gatewaySettings']=JSON[_0x45dc1(0x160)](_0x5dadb4[_0x45dc1(0x15b)]),delete _0x12ace2[_0x45dc1(0x15b)]);_0x5dadb4['wallets']&&(_0x5dadb4['wallets']['usdtPolygonWallet']!==undefined&&(_0x12ace2[_0x45dc1(0x15c)]=_0x5dadb4['wallets'][_0x45dc1(0x15c)]||null),_0x5dadb4[_0x45dc1(0x170)][_0x45dc1(0x165)]!==undefined&&(_0x12ace2[_0x45dc1(0x165)]=_0x5dadb4[_0x45dc1(0x170)][_0x45dc1(0x165)]||null),_0x5dadb4[_0x45dc1(0x170)]['usdtErcWallet']!==undefined&&(_0x12ace2[_0x45dc1(0x172)]=_0x5dadb4[_0x45dc1(0x170)][_0x45dc1(0x172)]||null),_0x5dadb4['wallets'][_0x45dc1(0x16e)]!==undefined&&(_0x12ace2['usdcPolygonWallet']=_0x5dadb4[_0x45dc1(0x170)][_0x45dc1(0x16e)]||null),delete _0x12ace2['wallets']);const _0x2ed2d4=await database_1[_0x45dc1(0x15a)][_0x45dc1(0x14d)][_0x45dc1(0x17c)]({'where':{'id':_0x200dcf},'data':_0x12ace2,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x2ed2d4['id'],'fullName':_0x2ed2d4[_0x45dc1(0x174)],'username':_0x2ed2d4[_0x45dc1(0x152)],'telegramId':_0x2ed2d4['telegram'],'merchantUrl':_0x2ed2d4[_0x45dc1(0x156)],'gateways':_0x2ed2d4[_0x45dc1(0x166)]?JSON[_0x45dc1(0x16b)](_0x2ed2d4[_0x45dc1(0x166)]):null,'gatewaySettings':_0x2ed2d4[_0x45dc1(0x15b)]?JSON[_0x45dc1(0x16b)](_0x2ed2d4[_0x45dc1(0x15b)]):null,'publicKey':_0x2ed2d4[_0x45dc1(0x176)],'wallets':{'usdtPolygonWallet':_0x2ed2d4[_0x45dc1(0x15c)],'usdtTrcWallet':_0x2ed2d4[_0x45dc1(0x165)],'usdtErcWallet':_0x2ed2d4[_0x45dc1(0x172)],'usdcPolygonWallet':_0x2ed2d4[_0x45dc1(0x16e)]},'status':_0x2ed2d4[_0x45dc1(0x16f)],'createdAt':_0x2ed2d4[_0x45dc1(0x17d)]};}async[a51_0x2f66ba(0x15f)](_0x4ae72c){const _0x4693f=a51_0x2f66ba;await database_1[_0x4693f(0x15a)][_0x4693f(0x14d)][_0x4693f(0x16a)]({'where':{'id':_0x4ae72c}});}}exports[a51_0x2f66ba(0x15e)]=UserService;