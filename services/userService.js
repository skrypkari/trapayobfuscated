'use strict';const a51_0x332cc0=a51_0x655f;(function(_0xa321b5,_0x431a52){const _0x5de3fe=a51_0x655f,_0x5bd8da=_0xa321b5();while(!![]){try{const _0x5d125e=-parseInt(_0x5de3fe(0xb7))/0x1+-parseInt(_0x5de3fe(0xa0))/0x2+parseInt(_0x5de3fe(0x9a))/0x3+-parseInt(_0x5de3fe(0xb8))/0x4+parseInt(_0x5de3fe(0x95))/0x5+-parseInt(_0x5de3fe(0xc2))/0x6+parseInt(_0x5de3fe(0xb5))/0x7;if(_0x5d125e===_0x431a52)break;else _0x5bd8da['push'](_0x5bd8da['shift']());}catch(_0x595dba){_0x5bd8da['push'](_0x5bd8da['shift']());}}}(a51_0x3fc3,0xbd74f));var __importDefault=this&&this[a51_0x332cc0(0xab)]||function(_0xa80dd0){const _0x40ac25=a51_0x332cc0;return _0xa80dd0&&_0xa80dd0[_0x40ac25(0xae)]?_0xa80dd0:{'default':_0xa80dd0};};function a51_0x3fc3(){const _0x773522=['merchantUrl','4267650upGJzP','map','generateApiKeys','pk_','telegramId','shopUrl','1441354hhujWx','paymentGateways','bcryptjs','delete','getAllUsers','ACTIVE','default','fullName','telegram','create','name','__importDefault','publicKey','status','__esModule','usdcPolygonWallet','password','../config/database','createdAt','defineProperty','UserService','13970852MPXJfC','sk_','817617guKKUq','1962880OBUWyp','createUser','parse','username','gatewaySettings','hash','stringify','Telegram\x20username\x20already\x20exists','findUnique','crypto','5701074tkHxOC','shop','usdtPolygonWallet','desc','updateUser','usdtTrcWallet','toString','hex','gateways','wallets','1684110YMuBQr','Username\x20already\x20exists','deleteUser','usdtErcWallet'];a51_0x3fc3=function(){return _0x773522;};return a51_0x3fc3();}Object[a51_0x332cc0(0xb3)](exports,a51_0x332cc0(0xae),{'value':!![]}),exports[a51_0x332cc0(0xb4)]=void 0x0;const bcryptjs_1=__importDefault(require(a51_0x332cc0(0xa2))),crypto_1=__importDefault(require(a51_0x332cc0(0xc1))),database_1=__importDefault(require(a51_0x332cc0(0xb1)));function a51_0x655f(_0x497941,_0x532228){const _0x3fc3f6=a51_0x3fc3();return a51_0x655f=function(_0x655f93,_0x3c3fd5){_0x655f93=_0x655f93-0x8c;let _0x15248b=_0x3fc3f6[_0x655f93];return _0x15248b;},a51_0x655f(_0x497941,_0x532228);}class UserService{[a51_0x332cc0(0x9c)](){const _0x39f8ed=a51_0x332cc0,_0x94e29d=_0x39f8ed(0x9d)+crypto_1[_0x39f8ed(0xa6)]['randomBytes'](0x20)[_0x39f8ed(0x91)]('hex'),_0x38ab44=_0x39f8ed(0xb6)+crypto_1[_0x39f8ed(0xa6)]['randomBytes'](0x20)[_0x39f8ed(0x91)](_0x39f8ed(0x92));return{'publicKey':_0x94e29d,'secretKey':_0x38ab44};}async[a51_0x332cc0(0xb9)](_0x56ca6e){const _0x448654=a51_0x332cc0,{fullName:_0x4c846b,username:_0x481221,password:_0x1f8732,telegramId:_0x301619,merchantUrl:_0xb5379d,gateways:_0x4d0399,gatewaySettings:_0x539d7c,wallets:_0x82e07c}=_0x56ca6e,_0x56d883=await database_1[_0x448654(0xa6)][_0x448654(0x8c)][_0x448654(0xc0)]({'where':{'username':_0x481221}});if(_0x56d883)throw new Error(_0x448654(0x96));if(_0x301619){const _0x231f49=await database_1[_0x448654(0xa6)][_0x448654(0x8c)][_0x448654(0xc0)]({'where':{'telegram':_0x301619}});if(_0x231f49)throw new Error(_0x448654(0xbf));}const _0x1d119f=await bcryptjs_1['default'][_0x448654(0xbd)](_0x1f8732,0xc),{publicKey:_0x5741d0,secretKey:_0x109bc7}=this[_0x448654(0x9c)](),_0x10c927=await database_1[_0x448654(0xa6)][_0x448654(0x8c)][_0x448654(0xa9)]({'data':{'name':_0x4c846b,'username':_0x481221,'password':_0x1d119f,'telegram':_0x301619,'shopUrl':_0xb5379d,'paymentGateways':_0x4d0399?JSON['stringify'](_0x4d0399):null,'gatewaySettings':_0x539d7c?JSON[_0x448654(0xbe)](_0x539d7c):null,'usdtPolygonWallet':_0x82e07c?.[_0x448654(0x8d)]||null,'usdtTrcWallet':_0x82e07c?.[_0x448654(0x90)]||null,'usdtErcWallet':_0x82e07c?.['usdtErcWallet']||null,'usdcPolygonWallet':_0x82e07c?.[_0x448654(0xaf)]||null,'publicKey':_0x5741d0,'secretKey':_0x109bc7,'status':_0x448654(0xa5)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x10c927['id'],'fullName':_0x10c927[_0x448654(0xaa)],'username':_0x10c927[_0x448654(0xbb)],'telegramId':_0x10c927[_0x448654(0xa8)],'merchantUrl':_0x10c927[_0x448654(0x9f)],'gateways':_0x10c927['paymentGateways']?JSON[_0x448654(0xba)](_0x10c927[_0x448654(0xa1)]):null,'gatewaySettings':_0x10c927['gatewaySettings']?JSON['parse'](_0x10c927[_0x448654(0xbc)]):null,'publicKey':_0x10c927['publicKey'],'wallets':{'usdtPolygonWallet':_0x10c927['usdtPolygonWallet'],'usdtTrcWallet':_0x10c927[_0x448654(0x90)],'usdtErcWallet':_0x10c927[_0x448654(0x98)],'usdcPolygonWallet':_0x10c927['usdcPolygonWallet']},'status':_0x10c927['status'],'createdAt':_0x10c927[_0x448654(0xb2)]};}async[a51_0x332cc0(0xa4)](){const _0x2ab849=a51_0x332cc0,_0x21dcf4=await database_1['default'][_0x2ab849(0x8c)]['findMany']({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x2ab849(0x8e)}});return _0x21dcf4[_0x2ab849(0x9b)](_0x442f26=>({'id':_0x442f26['id'],'fullName':_0x442f26[_0x2ab849(0xaa)],'username':_0x442f26['username'],'telegramId':_0x442f26['telegram'],'merchantUrl':_0x442f26[_0x2ab849(0x9f)],'gateways':_0x442f26[_0x2ab849(0xa1)]?JSON[_0x2ab849(0xba)](_0x442f26['paymentGateways']):null,'gatewaySettings':_0x442f26[_0x2ab849(0xbc)]?JSON[_0x2ab849(0xba)](_0x442f26[_0x2ab849(0xbc)]):null,'publicKey':_0x442f26[_0x2ab849(0xac)],'wallets':{'usdtPolygonWallet':_0x442f26[_0x2ab849(0x8d)],'usdtTrcWallet':_0x442f26['usdtTrcWallet'],'usdtErcWallet':_0x442f26[_0x2ab849(0x98)],'usdcPolygonWallet':_0x442f26[_0x2ab849(0xaf)]},'status':_0x442f26[_0x2ab849(0xad)],'createdAt':_0x442f26[_0x2ab849(0xb2)]}));}async['getUserById'](_0x2a233a){const _0x3a72a3=a51_0x332cc0,_0x4fba6c=await database_1[_0x3a72a3(0xa6)]['shop'][_0x3a72a3(0xc0)]({'where':{'id':_0x2a233a},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x4fba6c)return null;return{'id':_0x4fba6c['id'],'fullName':_0x4fba6c[_0x3a72a3(0xaa)],'username':_0x4fba6c[_0x3a72a3(0xbb)],'telegramId':_0x4fba6c[_0x3a72a3(0xa8)],'merchantUrl':_0x4fba6c[_0x3a72a3(0x9f)],'gateways':_0x4fba6c[_0x3a72a3(0xa1)]?JSON[_0x3a72a3(0xba)](_0x4fba6c[_0x3a72a3(0xa1)]):null,'gatewaySettings':_0x4fba6c[_0x3a72a3(0xbc)]?JSON[_0x3a72a3(0xba)](_0x4fba6c['gatewaySettings']):null,'publicKey':_0x4fba6c[_0x3a72a3(0xac)],'wallets':{'usdtPolygonWallet':_0x4fba6c[_0x3a72a3(0x8d)],'usdtTrcWallet':_0x4fba6c[_0x3a72a3(0x90)],'usdtErcWallet':_0x4fba6c[_0x3a72a3(0x98)],'usdcPolygonWallet':_0x4fba6c['usdcPolygonWallet']},'status':_0x4fba6c[_0x3a72a3(0xad)],'createdAt':_0x4fba6c['createdAt']};}async[a51_0x332cc0(0x8f)](_0x5b2e8b,_0x33f618){const _0x5b2b37=a51_0x332cc0,_0x270648={..._0x33f618};_0x33f618[_0x5b2b37(0xb0)]&&(_0x270648[_0x5b2b37(0xb0)]=await bcryptjs_1[_0x5b2b37(0xa6)][_0x5b2b37(0xbd)](_0x33f618[_0x5b2b37(0xb0)],0xc));_0x33f618[_0x5b2b37(0xa7)]&&(_0x270648[_0x5b2b37(0xaa)]=_0x33f618[_0x5b2b37(0xa7)],delete _0x270648[_0x5b2b37(0xa7)]);_0x33f618[_0x5b2b37(0x9e)]&&(_0x270648[_0x5b2b37(0xa8)]=_0x33f618[_0x5b2b37(0x9e)],delete _0x270648[_0x5b2b37(0x9e)]);_0x33f618['merchantUrl']&&(_0x270648[_0x5b2b37(0x9f)]=_0x33f618[_0x5b2b37(0x99)],delete _0x270648[_0x5b2b37(0x99)]);_0x33f618[_0x5b2b37(0x93)]&&(_0x270648[_0x5b2b37(0xa1)]=JSON[_0x5b2b37(0xbe)](_0x33f618[_0x5b2b37(0x93)]),delete _0x270648[_0x5b2b37(0x93)]);_0x33f618[_0x5b2b37(0xbc)]&&(_0x270648[_0x5b2b37(0xbc)]=JSON[_0x5b2b37(0xbe)](_0x33f618[_0x5b2b37(0xbc)]),delete _0x270648[_0x5b2b37(0xbc)]);_0x33f618['wallets']&&(_0x33f618[_0x5b2b37(0x94)]['usdtPolygonWallet']!==undefined&&(_0x270648['usdtPolygonWallet']=_0x33f618[_0x5b2b37(0x94)][_0x5b2b37(0x8d)]||null),_0x33f618['wallets'][_0x5b2b37(0x90)]!==undefined&&(_0x270648[_0x5b2b37(0x90)]=_0x33f618[_0x5b2b37(0x94)][_0x5b2b37(0x90)]||null),_0x33f618['wallets'][_0x5b2b37(0x98)]!==undefined&&(_0x270648[_0x5b2b37(0x98)]=_0x33f618[_0x5b2b37(0x94)]['usdtErcWallet']||null),_0x33f618[_0x5b2b37(0x94)][_0x5b2b37(0xaf)]!==undefined&&(_0x270648[_0x5b2b37(0xaf)]=_0x33f618['wallets'][_0x5b2b37(0xaf)]||null),delete _0x270648['wallets']);const _0x33f07c=await database_1[_0x5b2b37(0xa6)][_0x5b2b37(0x8c)]['update']({'where':{'id':_0x5b2e8b},'data':_0x270648,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x33f07c['id'],'fullName':_0x33f07c['name'],'username':_0x33f07c['username'],'telegramId':_0x33f07c['telegram'],'merchantUrl':_0x33f07c['shopUrl'],'gateways':_0x33f07c['paymentGateways']?JSON[_0x5b2b37(0xba)](_0x33f07c[_0x5b2b37(0xa1)]):null,'gatewaySettings':_0x33f07c[_0x5b2b37(0xbc)]?JSON[_0x5b2b37(0xba)](_0x33f07c['gatewaySettings']):null,'publicKey':_0x33f07c[_0x5b2b37(0xac)],'wallets':{'usdtPolygonWallet':_0x33f07c[_0x5b2b37(0x8d)],'usdtTrcWallet':_0x33f07c['usdtTrcWallet'],'usdtErcWallet':_0x33f07c[_0x5b2b37(0x98)],'usdcPolygonWallet':_0x33f07c[_0x5b2b37(0xaf)]},'status':_0x33f07c[_0x5b2b37(0xad)],'createdAt':_0x33f07c[_0x5b2b37(0xb2)]};}async[a51_0x332cc0(0x97)](_0x489e05){const _0x55f249=a51_0x332cc0;await database_1[_0x55f249(0xa6)][_0x55f249(0x8c)][_0x55f249(0xa3)]({'where':{'id':_0x489e05}});}}exports[a51_0x332cc0(0xb4)]=UserService;