'use strict';const a54_0x223830=a54_0x3e87;(function(_0x2904ef,_0x36c9f7){const _0x443adc=a54_0x3e87,_0x489497=_0x2904ef();while(!![]){try{const _0x480d4f=parseInt(_0x443adc(0x1bb))/0x1+parseInt(_0x443adc(0x1a0))/0x2+parseInt(_0x443adc(0x1a1))/0x3+-parseInt(_0x443adc(0x19c))/0x4+-parseInt(_0x443adc(0x1b3))/0x5+parseInt(_0x443adc(0x1aa))/0x6+-parseInt(_0x443adc(0x1b4))/0x7;if(_0x480d4f===_0x36c9f7)break;else _0x489497['push'](_0x489497['shift']());}catch(_0x32d0fe){_0x489497['push'](_0x489497['shift']());}}}(a54_0x1cff,0x76bcf));var __importDefault=this&&this['__importDefault']||function(_0x396816){return _0x396816&&_0x396816['__esModule']?_0x396816:{'default':_0x396816};};Object[a54_0x223830(0x18f)](exports,a54_0x223830(0x1b1),{'value':!![]}),exports[a54_0x223830(0x1a5)]=void 0x0;function a54_0x3e87(_0x5c2d66,_0x4599f6){const _0x1cff06=a54_0x1cff();return a54_0x3e87=function(_0x3e878e,_0x37036b){_0x3e878e=_0x3e878e-0x18e;let _0x1cc4e0=_0x1cff06[_0x3e878e];return _0x1cc4e0;},a54_0x3e87(_0x5c2d66,_0x4599f6);}const bcryptjs_1=__importDefault(require('bcryptjs')),crypto_1=__importDefault(require(a54_0x223830(0x1a3))),database_1=__importDefault(require('../config/database'));class UserService{[a54_0x223830(0x197)](){const _0x508f87=a54_0x223830,_0x2ddf85=_0x508f87(0x1bc)+crypto_1[_0x508f87(0x1a2)][_0x508f87(0x1bd)](0x20)[_0x508f87(0x1b6)]('hex'),_0x458381=_0x508f87(0x1b0)+crypto_1['default']['randomBytes'](0x20)[_0x508f87(0x1b6)]('hex');return{'publicKey':_0x2ddf85,'secretKey':_0x458381};}async[a54_0x223830(0x1b5)](_0x2340b4){const _0x3d6852=a54_0x223830,{fullName:_0x402661,username:_0x8ec09f,password:_0x44f452,telegramId:_0x20109d,merchantUrl:_0x5aac0b,gateways:_0x526afc,gatewaySettings:_0x384f4f,wallets:_0x2aac08}=_0x2340b4,_0x1cf2b3=await database_1[_0x3d6852(0x1a2)]['shop'][_0x3d6852(0x1ab)]({'where':{'username':_0x8ec09f}});if(_0x1cf2b3)throw new Error(_0x3d6852(0x190));if(_0x20109d){const _0x263f67=await database_1['default']['shop'][_0x3d6852(0x1ab)]({'where':{'telegram':_0x20109d}});if(_0x263f67)throw new Error(_0x3d6852(0x1ba));}const _0x3be8ef=await bcryptjs_1[_0x3d6852(0x1a2)][_0x3d6852(0x1c1)](_0x44f452,0xc),{publicKey:_0x2d912d,secretKey:_0x152044}=this[_0x3d6852(0x197)](),_0x10f38c=await database_1['default']['shop'][_0x3d6852(0x1a4)]({'data':{'name':_0x402661,'username':_0x8ec09f,'password':_0x3be8ef,'telegram':_0x20109d,'shopUrl':_0x5aac0b,'paymentGateways':_0x526afc?JSON[_0x3d6852(0x1b2)](_0x526afc):null,'gatewaySettings':_0x384f4f?JSON[_0x3d6852(0x1b2)](_0x384f4f):null,'usdtPolygonWallet':_0x2aac08?.[_0x3d6852(0x195)]||null,'usdtTrcWallet':_0x2aac08?.['usdtTrcWallet']||null,'usdtErcWallet':_0x2aac08?.[_0x3d6852(0x1ac)]||null,'usdcPolygonWallet':_0x2aac08?.[_0x3d6852(0x1a9)]||null,'publicKey':_0x2d912d,'secretKey':_0x152044,'status':_0x3d6852(0x1a8)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x10f38c['id'],'fullName':_0x10f38c[_0x3d6852(0x19d)],'username':_0x10f38c['username'],'telegramId':_0x10f38c['telegram'],'merchantUrl':_0x10f38c[_0x3d6852(0x1af)],'gateways':_0x10f38c[_0x3d6852(0x199)]?JSON[_0x3d6852(0x1ad)](_0x10f38c[_0x3d6852(0x199)]):null,'gatewaySettings':_0x10f38c[_0x3d6852(0x191)]?JSON[_0x3d6852(0x1ad)](_0x10f38c[_0x3d6852(0x191)]):null,'publicKey':_0x10f38c[_0x3d6852(0x1be)],'wallets':{'usdtPolygonWallet':_0x10f38c[_0x3d6852(0x195)],'usdtTrcWallet':_0x10f38c['usdtTrcWallet'],'usdtErcWallet':_0x10f38c[_0x3d6852(0x1ac)],'usdcPolygonWallet':_0x10f38c[_0x3d6852(0x1a9)]},'status':_0x10f38c[_0x3d6852(0x194)],'createdAt':_0x10f38c[_0x3d6852(0x1a7)]};}async['getAllUsers'](){const _0x459ea9=a54_0x223830,_0x283e36=await database_1[_0x459ea9(0x1a2)]['shop'][_0x459ea9(0x1a6)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x459ea9(0x1ae)}});return _0x283e36[_0x459ea9(0x196)](_0x60a70e=>({'id':_0x60a70e['id'],'fullName':_0x60a70e[_0x459ea9(0x19d)],'username':_0x60a70e[_0x459ea9(0x18e)],'telegramId':_0x60a70e[_0x459ea9(0x19b)],'merchantUrl':_0x60a70e[_0x459ea9(0x1af)],'gateways':_0x60a70e[_0x459ea9(0x199)]?JSON[_0x459ea9(0x1ad)](_0x60a70e[_0x459ea9(0x199)]):null,'gatewaySettings':_0x60a70e[_0x459ea9(0x191)]?JSON[_0x459ea9(0x1ad)](_0x60a70e[_0x459ea9(0x191)]):null,'publicKey':_0x60a70e[_0x459ea9(0x1be)],'wallets':{'usdtPolygonWallet':_0x60a70e[_0x459ea9(0x195)],'usdtTrcWallet':_0x60a70e[_0x459ea9(0x1c0)],'usdtErcWallet':_0x60a70e[_0x459ea9(0x1ac)],'usdcPolygonWallet':_0x60a70e[_0x459ea9(0x1a9)]},'status':_0x60a70e['status'],'createdAt':_0x60a70e[_0x459ea9(0x1a7)]}));}async[a54_0x223830(0x1bf)](_0x4848de){const _0x33656f=a54_0x223830,_0x475c13=await database_1[_0x33656f(0x1a2)]['shop'][_0x33656f(0x1ab)]({'where':{'id':_0x4848de},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x475c13)return null;return{'id':_0x475c13['id'],'fullName':_0x475c13[_0x33656f(0x19d)],'username':_0x475c13['username'],'telegramId':_0x475c13[_0x33656f(0x19b)],'merchantUrl':_0x475c13['shopUrl'],'gateways':_0x475c13[_0x33656f(0x199)]?JSON[_0x33656f(0x1ad)](_0x475c13[_0x33656f(0x199)]):null,'gatewaySettings':_0x475c13[_0x33656f(0x191)]?JSON[_0x33656f(0x1ad)](_0x475c13[_0x33656f(0x191)]):null,'publicKey':_0x475c13[_0x33656f(0x1be)],'wallets':{'usdtPolygonWallet':_0x475c13[_0x33656f(0x195)],'usdtTrcWallet':_0x475c13[_0x33656f(0x1c0)],'usdtErcWallet':_0x475c13[_0x33656f(0x1ac)],'usdcPolygonWallet':_0x475c13['usdcPolygonWallet']},'status':_0x475c13[_0x33656f(0x194)],'createdAt':_0x475c13['createdAt']};}async[a54_0x223830(0x193)](_0x12981f,_0x2dcb73){const _0x345bd7=a54_0x223830,_0x3ee46d={..._0x2dcb73};_0x2dcb73[_0x345bd7(0x198)]&&(_0x3ee46d[_0x345bd7(0x198)]=await bcryptjs_1['default'][_0x345bd7(0x1c1)](_0x2dcb73[_0x345bd7(0x198)],0xc));_0x2dcb73['fullName']&&(_0x3ee46d[_0x345bd7(0x19d)]=_0x2dcb73['fullName'],delete _0x3ee46d[_0x345bd7(0x19e)]);_0x2dcb73['telegramId']&&(_0x3ee46d[_0x345bd7(0x19b)]=_0x2dcb73[_0x345bd7(0x1b9)],delete _0x3ee46d['telegramId']);_0x2dcb73[_0x345bd7(0x19f)]&&(_0x3ee46d['shopUrl']=_0x2dcb73[_0x345bd7(0x19f)],delete _0x3ee46d[_0x345bd7(0x19f)]);_0x2dcb73[_0x345bd7(0x1b7)]&&(_0x3ee46d[_0x345bd7(0x199)]=JSON[_0x345bd7(0x1b2)](_0x2dcb73[_0x345bd7(0x1b7)]),delete _0x3ee46d[_0x345bd7(0x1b7)]);_0x2dcb73[_0x345bd7(0x191)]&&(_0x3ee46d[_0x345bd7(0x191)]=JSON['stringify'](_0x2dcb73['gatewaySettings']),delete _0x3ee46d['gatewaySettings']);_0x2dcb73[_0x345bd7(0x1b8)]&&(_0x2dcb73['wallets'][_0x345bd7(0x195)]!==undefined&&(_0x3ee46d[_0x345bd7(0x195)]=_0x2dcb73[_0x345bd7(0x1b8)][_0x345bd7(0x195)]||null),_0x2dcb73['wallets'][_0x345bd7(0x1c0)]!==undefined&&(_0x3ee46d['usdtTrcWallet']=_0x2dcb73['wallets'][_0x345bd7(0x1c0)]||null),_0x2dcb73[_0x345bd7(0x1b8)][_0x345bd7(0x1ac)]!==undefined&&(_0x3ee46d['usdtErcWallet']=_0x2dcb73[_0x345bd7(0x1b8)][_0x345bd7(0x1ac)]||null),_0x2dcb73[_0x345bd7(0x1b8)][_0x345bd7(0x1a9)]!==undefined&&(_0x3ee46d[_0x345bd7(0x1a9)]=_0x2dcb73['wallets'][_0x345bd7(0x1a9)]||null),delete _0x3ee46d['wallets']);const _0x576508=await database_1[_0x345bd7(0x1a2)][_0x345bd7(0x192)]['update']({'where':{'id':_0x12981f},'data':_0x3ee46d,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x576508['id'],'fullName':_0x576508[_0x345bd7(0x19d)],'username':_0x576508[_0x345bd7(0x18e)],'telegramId':_0x576508['telegram'],'merchantUrl':_0x576508['shopUrl'],'gateways':_0x576508[_0x345bd7(0x199)]?JSON[_0x345bd7(0x1ad)](_0x576508['paymentGateways']):null,'gatewaySettings':_0x576508[_0x345bd7(0x191)]?JSON['parse'](_0x576508[_0x345bd7(0x191)]):null,'publicKey':_0x576508['publicKey'],'wallets':{'usdtPolygonWallet':_0x576508[_0x345bd7(0x195)],'usdtTrcWallet':_0x576508['usdtTrcWallet'],'usdtErcWallet':_0x576508[_0x345bd7(0x1ac)],'usdcPolygonWallet':_0x576508[_0x345bd7(0x1a9)]},'status':_0x576508[_0x345bd7(0x194)],'createdAt':_0x576508[_0x345bd7(0x1a7)]};}async['deleteUser'](_0x5d9687){const _0x5637d2=a54_0x223830;await database_1[_0x5637d2(0x1a2)][_0x5637d2(0x192)][_0x5637d2(0x19a)]({'where':{'id':_0x5d9687}});}}function a54_0x1cff(){const _0x5f4452=['UserService','findMany','createdAt','ACTIVE','usdcPolygonWallet','4138026SKTCaZ','findUnique','usdtErcWallet','parse','desc','shopUrl','sk_','__esModule','stringify','565660whzbtc','4855326EnKdyR','createUser','toString','gateways','wallets','telegramId','Telegram\x20username\x20already\x20exists','851664DybdtJ','pk_','randomBytes','publicKey','getUserById','usdtTrcWallet','hash','username','defineProperty','Username\x20already\x20exists','gatewaySettings','shop','updateUser','status','usdtPolygonWallet','map','generateApiKeys','password','paymentGateways','delete','telegram','2582724xjohmb','name','fullName','merchantUrl','281194vTKslm','770550hfBoAI','default','crypto','create'];a54_0x1cff=function(){return _0x5f4452;};return a54_0x1cff();}exports[a54_0x223830(0x1a5)]=UserService;