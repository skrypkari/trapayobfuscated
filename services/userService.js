'use strict';const a56_0x11d0d8=a56_0x3e8d;function a56_0x3613(){const _0x381322=['stringify','16661745Sahsav','7fJjzie','__esModule','parse','telegram','Telegram\x20username\x20already\x20exists','toString','2268681lnZfpj','publicKey','shopUrl','shop','gatewaySettings','update','sk_','42819304bzikeM','hex','password','wallets','gateways','pk_','../config/database','Username\x20already\x20exists','findUnique','updateUser','usdtErcWallet','usdcPolygonWallet','hash','status','createUser','17689560WoBoTb','getUserById','crypto','318JEelCU','name','1128817IRMIRH','63435uROqqT','UserService','paymentGateways','create','usdtPolygonWallet','bcryptjs','getAllUsers','default','createdAt','2HPGLyG','randomBytes','findMany','2584216vrSLCf','4yohMis','fullName','usdtTrcWallet','telegramId','merchantUrl','username','deleteUser','ACTIVE'];a56_0x3613=function(){return _0x381322;};return a56_0x3613();}function a56_0x3e8d(_0x26973e,_0x1451b0){const _0x361320=a56_0x3613();return a56_0x3e8d=function(_0x3e8d21,_0x1e4185){_0x3e8d21=_0x3e8d21-0xb1;let _0x58a543=_0x361320[_0x3e8d21];return _0x58a543;},a56_0x3e8d(_0x26973e,_0x1451b0);}(function(_0x30ada4,_0x21151e){const _0x5ca0c4=a56_0x3e8d,_0x44cc07=_0x30ada4();while(!![]){try{const _0x43029e=parseInt(_0x5ca0c4(0xb4))/0x1*(parseInt(_0x5ca0c4(0xbe))/0x2)+-parseInt(_0x5ca0c4(0xd2))/0x3*(parseInt(_0x5ca0c4(0xc2))/0x4)+-parseInt(_0x5ca0c4(0xb5))/0x5*(-parseInt(_0x5ca0c4(0xb2))/0x6)+parseInt(_0x5ca0c4(0xcc))/0x7*(-parseInt(_0x5ca0c4(0xc1))/0x8)+-parseInt(_0x5ca0c4(0xcb))/0x9+-parseInt(_0x5ca0c4(0xe8))/0xa+parseInt(_0x5ca0c4(0xd9))/0xb;if(_0x43029e===_0x21151e)break;else _0x44cc07['push'](_0x44cc07['shift']());}catch(_0x355228){_0x44cc07['push'](_0x44cc07['shift']());}}}(a56_0x3613,0xf2c49));var __importDefault=this&&this['__importDefault']||function(_0x1eb13b){const _0x40856d=a56_0x3e8d;return _0x1eb13b&&_0x1eb13b[_0x40856d(0xcd)]?_0x1eb13b:{'default':_0x1eb13b};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a56_0x11d0d8(0xb6)]=void 0x0;const bcryptjs_1=__importDefault(require(a56_0x11d0d8(0xba))),crypto_1=__importDefault(require(a56_0x11d0d8(0xb1))),database_1=__importDefault(require(a56_0x11d0d8(0xdf)));class UserService{['generateApiKeys'](){const _0x10cde8=a56_0x11d0d8,_0x30636f=_0x10cde8(0xde)+crypto_1[_0x10cde8(0xbc)]['randomBytes'](0x20)[_0x10cde8(0xd1)](_0x10cde8(0xda)),_0x48dc65=_0x10cde8(0xd8)+crypto_1['default'][_0x10cde8(0xbf)](0x20)[_0x10cde8(0xd1)](_0x10cde8(0xda));return{'publicKey':_0x30636f,'secretKey':_0x48dc65};}async[a56_0x11d0d8(0xe7)](_0x5292b6){const _0x5e1f21=a56_0x11d0d8,{fullName:_0x15f315,username:_0x11378d,password:_0x583574,telegramId:_0x45f309,merchantUrl:_0x291c51,gateways:_0x2e1ebd,gatewaySettings:_0x585b35,wallets:_0x29f550}=_0x5292b6,_0x15372a=await database_1[_0x5e1f21(0xbc)][_0x5e1f21(0xd5)][_0x5e1f21(0xe1)]({'where':{'username':_0x11378d}});if(_0x15372a)throw new Error(_0x5e1f21(0xe0));if(_0x45f309){const _0x1d2c4d=await database_1['default'][_0x5e1f21(0xd5)]['findUnique']({'where':{'telegram':_0x45f309}});if(_0x1d2c4d)throw new Error(_0x5e1f21(0xd0));}const _0x5d7d8f=await bcryptjs_1[_0x5e1f21(0xbc)][_0x5e1f21(0xe5)](_0x583574,0xc),{publicKey:_0x280c7d,secretKey:_0x3e7a04}=this['generateApiKeys'](),_0x26512c=await database_1[_0x5e1f21(0xbc)][_0x5e1f21(0xd5)][_0x5e1f21(0xb8)]({'data':{'name':_0x15f315,'username':_0x11378d,'password':_0x5d7d8f,'telegram':_0x45f309,'shopUrl':_0x291c51,'paymentGateways':_0x2e1ebd?JSON[_0x5e1f21(0xca)](_0x2e1ebd):null,'gatewaySettings':_0x585b35?JSON[_0x5e1f21(0xca)](_0x585b35):null,'usdtPolygonWallet':_0x29f550?.['usdtPolygonWallet']||null,'usdtTrcWallet':_0x29f550?.[_0x5e1f21(0xc4)]||null,'usdtErcWallet':_0x29f550?.[_0x5e1f21(0xe3)]||null,'usdcPolygonWallet':_0x29f550?.[_0x5e1f21(0xe4)]||null,'publicKey':_0x280c7d,'secretKey':_0x3e7a04,'status':_0x5e1f21(0xc9)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x26512c['id'],'fullName':_0x26512c[_0x5e1f21(0xb3)],'username':_0x26512c[_0x5e1f21(0xc7)],'telegramId':_0x26512c[_0x5e1f21(0xcf)],'merchantUrl':_0x26512c[_0x5e1f21(0xd4)],'gateways':_0x26512c['paymentGateways']?JSON['parse'](_0x26512c[_0x5e1f21(0xb7)]):null,'gatewaySettings':_0x26512c[_0x5e1f21(0xd6)]?JSON[_0x5e1f21(0xce)](_0x26512c[_0x5e1f21(0xd6)]):null,'publicKey':_0x26512c[_0x5e1f21(0xd3)],'wallets':{'usdtPolygonWallet':_0x26512c['usdtPolygonWallet'],'usdtTrcWallet':_0x26512c[_0x5e1f21(0xc4)],'usdtErcWallet':_0x26512c[_0x5e1f21(0xe3)],'usdcPolygonWallet':_0x26512c[_0x5e1f21(0xe4)]},'status':_0x26512c['status'],'createdAt':_0x26512c['createdAt']};}async[a56_0x11d0d8(0xbb)](){const _0x3408bb=a56_0x11d0d8,_0x3b0394=await database_1[_0x3408bb(0xbc)][_0x3408bb(0xd5)][_0x3408bb(0xc0)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':'desc'}});return _0x3b0394['map'](_0x3fa112=>({'id':_0x3fa112['id'],'fullName':_0x3fa112[_0x3408bb(0xb3)],'username':_0x3fa112[_0x3408bb(0xc7)],'telegramId':_0x3fa112[_0x3408bb(0xcf)],'merchantUrl':_0x3fa112[_0x3408bb(0xd4)],'gateways':_0x3fa112[_0x3408bb(0xb7)]?JSON[_0x3408bb(0xce)](_0x3fa112['paymentGateways']):null,'gatewaySettings':_0x3fa112[_0x3408bb(0xd6)]?JSON[_0x3408bb(0xce)](_0x3fa112['gatewaySettings']):null,'publicKey':_0x3fa112[_0x3408bb(0xd3)],'wallets':{'usdtPolygonWallet':_0x3fa112[_0x3408bb(0xb9)],'usdtTrcWallet':_0x3fa112['usdtTrcWallet'],'usdtErcWallet':_0x3fa112['usdtErcWallet'],'usdcPolygonWallet':_0x3fa112['usdcPolygonWallet']},'status':_0x3fa112[_0x3408bb(0xe6)],'createdAt':_0x3fa112['createdAt']}));}async[a56_0x11d0d8(0xe9)](_0x1b853){const _0x4cab29=a56_0x11d0d8,_0x4af319=await database_1['default'][_0x4cab29(0xd5)][_0x4cab29(0xe1)]({'where':{'id':_0x1b853},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x4af319)return null;return{'id':_0x4af319['id'],'fullName':_0x4af319[_0x4cab29(0xb3)],'username':_0x4af319[_0x4cab29(0xc7)],'telegramId':_0x4af319[_0x4cab29(0xcf)],'merchantUrl':_0x4af319[_0x4cab29(0xd4)],'gateways':_0x4af319[_0x4cab29(0xb7)]?JSON[_0x4cab29(0xce)](_0x4af319[_0x4cab29(0xb7)]):null,'gatewaySettings':_0x4af319[_0x4cab29(0xd6)]?JSON[_0x4cab29(0xce)](_0x4af319[_0x4cab29(0xd6)]):null,'publicKey':_0x4af319[_0x4cab29(0xd3)],'wallets':{'usdtPolygonWallet':_0x4af319[_0x4cab29(0xb9)],'usdtTrcWallet':_0x4af319[_0x4cab29(0xc4)],'usdtErcWallet':_0x4af319['usdtErcWallet'],'usdcPolygonWallet':_0x4af319['usdcPolygonWallet']},'status':_0x4af319[_0x4cab29(0xe6)],'createdAt':_0x4af319['createdAt']};}async[a56_0x11d0d8(0xe2)](_0xdb7e9,_0x3444bb){const _0x268409=a56_0x11d0d8,_0x193cdf={..._0x3444bb};_0x3444bb[_0x268409(0xdb)]&&(_0x193cdf['password']=await bcryptjs_1['default']['hash'](_0x3444bb['password'],0xc));_0x3444bb['fullName']&&(_0x193cdf['name']=_0x3444bb[_0x268409(0xc3)],delete _0x193cdf[_0x268409(0xc3)]);_0x3444bb['telegramId']&&(_0x193cdf['telegram']=_0x3444bb[_0x268409(0xc5)],delete _0x193cdf[_0x268409(0xc5)]);_0x3444bb[_0x268409(0xc6)]&&(_0x193cdf['shopUrl']=_0x3444bb[_0x268409(0xc6)],delete _0x193cdf[_0x268409(0xc6)]);_0x3444bb[_0x268409(0xdd)]&&(_0x193cdf[_0x268409(0xb7)]=JSON['stringify'](_0x3444bb[_0x268409(0xdd)]),delete _0x193cdf['gateways']);_0x3444bb[_0x268409(0xd6)]&&(_0x193cdf[_0x268409(0xd6)]=JSON['stringify'](_0x3444bb[_0x268409(0xd6)]),delete _0x193cdf[_0x268409(0xd6)]);_0x3444bb[_0x268409(0xdc)]&&(_0x3444bb[_0x268409(0xdc)][_0x268409(0xb9)]!==undefined&&(_0x193cdf[_0x268409(0xb9)]=_0x3444bb[_0x268409(0xdc)]['usdtPolygonWallet']||null),_0x3444bb[_0x268409(0xdc)][_0x268409(0xc4)]!==undefined&&(_0x193cdf[_0x268409(0xc4)]=_0x3444bb['wallets'][_0x268409(0xc4)]||null),_0x3444bb['wallets'][_0x268409(0xe3)]!==undefined&&(_0x193cdf[_0x268409(0xe3)]=_0x3444bb['wallets'][_0x268409(0xe3)]||null),_0x3444bb['wallets'][_0x268409(0xe4)]!==undefined&&(_0x193cdf[_0x268409(0xe4)]=_0x3444bb['wallets'][_0x268409(0xe4)]||null),delete _0x193cdf[_0x268409(0xdc)]);const _0x44bb29=await database_1[_0x268409(0xbc)][_0x268409(0xd5)][_0x268409(0xd7)]({'where':{'id':_0xdb7e9},'data':_0x193cdf,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x44bb29['id'],'fullName':_0x44bb29['name'],'username':_0x44bb29[_0x268409(0xc7)],'telegramId':_0x44bb29[_0x268409(0xcf)],'merchantUrl':_0x44bb29['shopUrl'],'gateways':_0x44bb29[_0x268409(0xb7)]?JSON[_0x268409(0xce)](_0x44bb29[_0x268409(0xb7)]):null,'gatewaySettings':_0x44bb29[_0x268409(0xd6)]?JSON['parse'](_0x44bb29[_0x268409(0xd6)]):null,'publicKey':_0x44bb29['publicKey'],'wallets':{'usdtPolygonWallet':_0x44bb29[_0x268409(0xb9)],'usdtTrcWallet':_0x44bb29[_0x268409(0xc4)],'usdtErcWallet':_0x44bb29[_0x268409(0xe3)],'usdcPolygonWallet':_0x44bb29[_0x268409(0xe4)]},'status':_0x44bb29['status'],'createdAt':_0x44bb29[_0x268409(0xbd)]};}async[a56_0x11d0d8(0xc8)](_0x18f5c0){const _0x1317a4=a56_0x11d0d8;await database_1[_0x1317a4(0xbc)][_0x1317a4(0xd5)]['delete']({'where':{'id':_0x18f5c0}});}}exports[a56_0x11d0d8(0xb6)]=UserService;