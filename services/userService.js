'use strict';const a56_0x516b05=a56_0x4315;function a56_0x4315(_0x2d3f98,_0x1ccd26){const _0x1204d7=a56_0x1204();return a56_0x4315=function(_0x431594,_0x5ab33f){_0x431594=_0x431594-0x1ca;let _0x45029f=_0x1204d7[_0x431594];return _0x45029f;},a56_0x4315(_0x2d3f98,_0x1ccd26);}function a56_0x1204(){const _0xb7ae92=['updateUser','1bzGegU','usdtPolygonWallet','__importDefault','hash','default','bcryptjs','fullName','map','parse','create','delete','24gSkYJq','5698wSoMeI','3515620mkRBNI','publicKey','getUserById','paymentGateways','createdAt','2408212pQyhZb','generateApiKeys','status','28370kCtYOS','Telegram\x20username\x20already\x20exists','createUser','hex','__esModule','usdtErcWallet','username','UserService','getAllUsers','../config/database','stringify','toString','shopUrl','randomBytes','shop','telegramId','2753527XzTfHp','sk_','name','wallets','findMany','gateways','findUnique','usdtTrcWallet','telegram','merchantUrl','ACTIVE','desc','839907JAwnTr','password','defineProperty','usdcPolygonWallet','gatewaySettings','crypto','8SALiWz','3019203PGnENH','1042445qtIMgo'];a56_0x1204=function(){return _0xb7ae92;};return a56_0x1204();}(function(_0x449fa7,_0x52f009){const _0x5e75f7=a56_0x4315,_0x23d12a=_0x449fa7();while(!![]){try{const _0x258180=-parseInt(_0x5e75f7(0x1ea))/0x1*(parseInt(_0x5e75f7(0x1fc))/0x2)+-parseInt(_0x5e75f7(0x1e0))/0x3+-parseInt(_0x5e75f7(0x1f7))/0x4+parseInt(_0x5e75f7(0x1e8))/0x5*(parseInt(_0x5e75f7(0x1f5))/0x6)+parseInt(_0x5e75f7(0x1d4))/0x7*(parseInt(_0x5e75f7(0x1e6))/0x8)+parseInt(_0x5e75f7(0x1e7))/0x9+-parseInt(_0x5e75f7(0x1ff))/0xa*(-parseInt(_0x5e75f7(0x1f6))/0xb);if(_0x258180===_0x52f009)break;else _0x23d12a['push'](_0x23d12a['shift']());}catch(_0x2a40aa){_0x23d12a['push'](_0x23d12a['shift']());}}}(a56_0x1204,0xa36ba));var __importDefault=this&&this[a56_0x516b05(0x1ec)]||function(_0x4070db){return _0x4070db&&_0x4070db['__esModule']?_0x4070db:{'default':_0x4070db};};Object[a56_0x516b05(0x1e2)](exports,a56_0x516b05(0x203),{'value':!![]}),exports[a56_0x516b05(0x1cb)]=void 0x0;const bcryptjs_1=__importDefault(require(a56_0x516b05(0x1ef))),crypto_1=__importDefault(require(a56_0x516b05(0x1e5))),database_1=__importDefault(require(a56_0x516b05(0x1cd)));class UserService{['generateApiKeys'](){const _0x2291db=a56_0x516b05,_0x110491='pk_'+crypto_1[_0x2291db(0x1ee)][_0x2291db(0x1d1)](0x20)[_0x2291db(0x1cf)](_0x2291db(0x202)),_0x522419=_0x2291db(0x1d5)+crypto_1[_0x2291db(0x1ee)]['randomBytes'](0x20)[_0x2291db(0x1cf)]('hex');return{'publicKey':_0x110491,'secretKey':_0x522419};}async[a56_0x516b05(0x201)](_0x52cb22){const _0x57cf83=a56_0x516b05,{fullName:_0x2cae34,username:_0x513a19,password:_0x19a4ae,telegramId:_0x59a685,merchantUrl:_0x54c7b5,gateways:_0x3f6061,gatewaySettings:_0x42a171,wallets:_0x381a6d}=_0x52cb22,_0x4be3d6=await database_1[_0x57cf83(0x1ee)][_0x57cf83(0x1d2)][_0x57cf83(0x1da)]({'where':{'username':_0x513a19}});if(_0x4be3d6)throw new Error('Username\x20already\x20exists');if(_0x59a685){const _0x48d4aa=await database_1[_0x57cf83(0x1ee)][_0x57cf83(0x1d2)][_0x57cf83(0x1da)]({'where':{'telegram':_0x59a685}});if(_0x48d4aa)throw new Error(_0x57cf83(0x200));}const _0x35ab02=await bcryptjs_1[_0x57cf83(0x1ee)][_0x57cf83(0x1ed)](_0x19a4ae,0xc),{publicKey:_0x3f63d7,secretKey:_0x31f175}=this[_0x57cf83(0x1fd)](),_0x2b2979=await database_1[_0x57cf83(0x1ee)][_0x57cf83(0x1d2)][_0x57cf83(0x1f3)]({'data':{'name':_0x2cae34,'username':_0x513a19,'password':_0x35ab02,'telegram':_0x59a685,'shopUrl':_0x54c7b5,'paymentGateways':_0x3f6061?JSON[_0x57cf83(0x1ce)](_0x3f6061):null,'gatewaySettings':_0x42a171?JSON[_0x57cf83(0x1ce)](_0x42a171):null,'usdtPolygonWallet':_0x381a6d?.['usdtPolygonWallet']||null,'usdtTrcWallet':_0x381a6d?.[_0x57cf83(0x1db)]||null,'usdtErcWallet':_0x381a6d?.[_0x57cf83(0x204)]||null,'usdcPolygonWallet':_0x381a6d?.[_0x57cf83(0x1e3)]||null,'publicKey':_0x3f63d7,'secretKey':_0x31f175,'status':_0x57cf83(0x1de)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x2b2979['id'],'fullName':_0x2b2979[_0x57cf83(0x1d6)],'username':_0x2b2979[_0x57cf83(0x1ca)],'telegramId':_0x2b2979['telegram'],'merchantUrl':_0x2b2979[_0x57cf83(0x1d0)],'gateways':_0x2b2979['paymentGateways']?JSON['parse'](_0x2b2979[_0x57cf83(0x1fa)]):null,'gatewaySettings':_0x2b2979[_0x57cf83(0x1e4)]?JSON['parse'](_0x2b2979[_0x57cf83(0x1e4)]):null,'publicKey':_0x2b2979['publicKey'],'wallets':{'usdtPolygonWallet':_0x2b2979[_0x57cf83(0x1eb)],'usdtTrcWallet':_0x2b2979[_0x57cf83(0x1db)],'usdtErcWallet':_0x2b2979['usdtErcWallet'],'usdcPolygonWallet':_0x2b2979[_0x57cf83(0x1e3)]},'status':_0x2b2979[_0x57cf83(0x1fe)],'createdAt':_0x2b2979['createdAt']};}async[a56_0x516b05(0x1cc)](){const _0x436bb5=a56_0x516b05,_0x3f308e=await database_1[_0x436bb5(0x1ee)][_0x436bb5(0x1d2)][_0x436bb5(0x1d8)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x436bb5(0x1df)}});return _0x3f308e[_0x436bb5(0x1f1)](_0x314bdf=>({'id':_0x314bdf['id'],'fullName':_0x314bdf[_0x436bb5(0x1d6)],'username':_0x314bdf[_0x436bb5(0x1ca)],'telegramId':_0x314bdf[_0x436bb5(0x1dc)],'merchantUrl':_0x314bdf[_0x436bb5(0x1d0)],'gateways':_0x314bdf['paymentGateways']?JSON['parse'](_0x314bdf[_0x436bb5(0x1fa)]):null,'gatewaySettings':_0x314bdf['gatewaySettings']?JSON[_0x436bb5(0x1f2)](_0x314bdf[_0x436bb5(0x1e4)]):null,'publicKey':_0x314bdf[_0x436bb5(0x1f8)],'wallets':{'usdtPolygonWallet':_0x314bdf['usdtPolygonWallet'],'usdtTrcWallet':_0x314bdf['usdtTrcWallet'],'usdtErcWallet':_0x314bdf[_0x436bb5(0x204)],'usdcPolygonWallet':_0x314bdf['usdcPolygonWallet']},'status':_0x314bdf[_0x436bb5(0x1fe)],'createdAt':_0x314bdf[_0x436bb5(0x1fb)]}));}async[a56_0x516b05(0x1f9)](_0x542921){const _0x3ab95d=a56_0x516b05,_0x35c5b8=await database_1[_0x3ab95d(0x1ee)]['shop'][_0x3ab95d(0x1da)]({'where':{'id':_0x542921},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x35c5b8)return null;return{'id':_0x35c5b8['id'],'fullName':_0x35c5b8['name'],'username':_0x35c5b8[_0x3ab95d(0x1ca)],'telegramId':_0x35c5b8[_0x3ab95d(0x1dc)],'merchantUrl':_0x35c5b8[_0x3ab95d(0x1d0)],'gateways':_0x35c5b8[_0x3ab95d(0x1fa)]?JSON[_0x3ab95d(0x1f2)](_0x35c5b8[_0x3ab95d(0x1fa)]):null,'gatewaySettings':_0x35c5b8[_0x3ab95d(0x1e4)]?JSON[_0x3ab95d(0x1f2)](_0x35c5b8[_0x3ab95d(0x1e4)]):null,'publicKey':_0x35c5b8[_0x3ab95d(0x1f8)],'wallets':{'usdtPolygonWallet':_0x35c5b8[_0x3ab95d(0x1eb)],'usdtTrcWallet':_0x35c5b8[_0x3ab95d(0x1db)],'usdtErcWallet':_0x35c5b8[_0x3ab95d(0x204)],'usdcPolygonWallet':_0x35c5b8['usdcPolygonWallet']},'status':_0x35c5b8['status'],'createdAt':_0x35c5b8[_0x3ab95d(0x1fb)]};}async[a56_0x516b05(0x1e9)](_0x1af68e,_0x5532ac){const _0x963da=a56_0x516b05,_0x592620={..._0x5532ac};_0x5532ac[_0x963da(0x1e1)]&&(_0x592620[_0x963da(0x1e1)]=await bcryptjs_1[_0x963da(0x1ee)]['hash'](_0x5532ac[_0x963da(0x1e1)],0xc));_0x5532ac[_0x963da(0x1f0)]&&(_0x592620[_0x963da(0x1d6)]=_0x5532ac[_0x963da(0x1f0)],delete _0x592620[_0x963da(0x1f0)]);_0x5532ac['telegramId']&&(_0x592620[_0x963da(0x1dc)]=_0x5532ac[_0x963da(0x1d3)],delete _0x592620['telegramId']);_0x5532ac['merchantUrl']&&(_0x592620[_0x963da(0x1d0)]=_0x5532ac[_0x963da(0x1dd)],delete _0x592620['merchantUrl']);_0x5532ac[_0x963da(0x1d9)]&&(_0x592620['paymentGateways']=JSON[_0x963da(0x1ce)](_0x5532ac[_0x963da(0x1d9)]),delete _0x592620[_0x963da(0x1d9)]);_0x5532ac[_0x963da(0x1e4)]&&(_0x592620['gatewaySettings']=JSON[_0x963da(0x1ce)](_0x5532ac[_0x963da(0x1e4)]),delete _0x592620[_0x963da(0x1e4)]);_0x5532ac[_0x963da(0x1d7)]&&(_0x5532ac[_0x963da(0x1d7)]['usdtPolygonWallet']!==undefined&&(_0x592620['usdtPolygonWallet']=_0x5532ac[_0x963da(0x1d7)][_0x963da(0x1eb)]||null),_0x5532ac[_0x963da(0x1d7)]['usdtTrcWallet']!==undefined&&(_0x592620[_0x963da(0x1db)]=_0x5532ac['wallets'][_0x963da(0x1db)]||null),_0x5532ac[_0x963da(0x1d7)][_0x963da(0x204)]!==undefined&&(_0x592620[_0x963da(0x204)]=_0x5532ac[_0x963da(0x1d7)][_0x963da(0x204)]||null),_0x5532ac[_0x963da(0x1d7)][_0x963da(0x1e3)]!==undefined&&(_0x592620[_0x963da(0x1e3)]=_0x5532ac[_0x963da(0x1d7)][_0x963da(0x1e3)]||null),delete _0x592620[_0x963da(0x1d7)]);const _0x4dfddb=await database_1[_0x963da(0x1ee)][_0x963da(0x1d2)]['update']({'where':{'id':_0x1af68e},'data':_0x592620,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x4dfddb['id'],'fullName':_0x4dfddb['name'],'username':_0x4dfddb['username'],'telegramId':_0x4dfddb[_0x963da(0x1dc)],'merchantUrl':_0x4dfddb[_0x963da(0x1d0)],'gateways':_0x4dfddb[_0x963da(0x1fa)]?JSON[_0x963da(0x1f2)](_0x4dfddb['paymentGateways']):null,'gatewaySettings':_0x4dfddb[_0x963da(0x1e4)]?JSON['parse'](_0x4dfddb[_0x963da(0x1e4)]):null,'publicKey':_0x4dfddb[_0x963da(0x1f8)],'wallets':{'usdtPolygonWallet':_0x4dfddb[_0x963da(0x1eb)],'usdtTrcWallet':_0x4dfddb[_0x963da(0x1db)],'usdtErcWallet':_0x4dfddb[_0x963da(0x204)],'usdcPolygonWallet':_0x4dfddb[_0x963da(0x1e3)]},'status':_0x4dfddb[_0x963da(0x1fe)],'createdAt':_0x4dfddb[_0x963da(0x1fb)]};}async['deleteUser'](_0x4e2fd1){const _0x2ddaa0=a56_0x516b05;await database_1[_0x2ddaa0(0x1ee)][_0x2ddaa0(0x1d2)][_0x2ddaa0(0x1f4)]({'where':{'id':_0x4e2fd1}});}}exports[a56_0x516b05(0x1cb)]=UserService;