'use strict';const a89_0xb60efa=a89_0x2030;(function(_0x39d81a,_0x4a4426){const _0x4069af=a89_0x2030,_0x1e60b7=_0x39d81a();while(!![]){try{const _0x23c96b=-parseInt(_0x4069af(0x180))/0x1*(-parseInt(_0x4069af(0x18e))/0x2)+-parseInt(_0x4069af(0x17e))/0x3+-parseInt(_0x4069af(0x187))/0x4+parseInt(_0x4069af(0x18b))/0x5+parseInt(_0x4069af(0x168))/0x6+-parseInt(_0x4069af(0x16b))/0x7*(-parseInt(_0x4069af(0x186))/0x8)+-parseInt(_0x4069af(0x171))/0x9*(-parseInt(_0x4069af(0x175))/0xa);if(_0x23c96b===_0x4a4426)break;else _0x1e60b7['push'](_0x1e60b7['shift']());}catch(_0x19c5bb){_0x1e60b7['push'](_0x1e60b7['shift']());}}}(a89_0x4e34,0xb5114));function a89_0x4e34(){const _0x42652d=['create','shop','usdtTrcWallet','hash','usdtPolygonWallet','Telegram\x20username\x20already\x20exists','default','createUser','pk_','stringify','1973040IzEHCV','parse','ACTIVE','186207NKxyvM','gatewaySettings','fullName','name','usdcPolygonWallet','usdtErcWallet','9cfjmOd','findMany','password','gateways','4483630MVjgmL','__importDefault','sk_','__esModule','merchantUrl','telegram','bcryptjs','getAllUsers','getUserById','3803562JlKTFC','telegramId','365zSpKJX','randomBytes','desc','toString','createdAt','username','8rjxech','4408256jOKcxG','wallets','updateUser','generateApiKeys','6492705nLJPcK','update','map','5530OMOtST','defineProperty','paymentGateways','status','publicKey','shopUrl','hex','../config/database','findUnique'];a89_0x4e34=function(){return _0x42652d;};return a89_0x4e34();}var __importDefault=this&&this[a89_0xb60efa(0x176)]||function(_0x37e476){const _0x292119=a89_0xb60efa;return _0x37e476&&_0x37e476[_0x292119(0x178)]?_0x37e476:{'default':_0x37e476};};function a89_0x2030(_0x39f87c,_0x8bd104){_0x39f87c=_0x39f87c-0x166;const _0x4e34c8=a89_0x4e34();let _0x2030c3=_0x4e34c8[_0x39f87c];return _0x2030c3;}Object[a89_0xb60efa(0x18f)](exports,a89_0xb60efa(0x178),{'value':!![]}),exports['UserService']=void 0x0;const bcryptjs_1=__importDefault(require(a89_0xb60efa(0x17b))),crypto_1=__importDefault(require('crypto')),database_1=__importDefault(require(a89_0xb60efa(0x195)));class UserService{[a89_0xb60efa(0x18a)](){const _0x30924b=a89_0xb60efa,_0x3edcf4=_0x30924b(0x166)+crypto_1[_0x30924b(0x19d)][_0x30924b(0x181)](0x20)[_0x30924b(0x183)](_0x30924b(0x194)),_0x4388b8=_0x30924b(0x177)+crypto_1[_0x30924b(0x19d)][_0x30924b(0x181)](0x20)['toString']('hex');return{'publicKey':_0x3edcf4,'secretKey':_0x4388b8};}async[a89_0xb60efa(0x19e)](_0x2790d1){const _0x5d89f0=a89_0xb60efa,{fullName:_0x2eb948,username:_0x46575c,password:_0x554b68,telegramId:_0x163669,merchantUrl:_0x16e76b,gateways:_0x3f217c,gatewaySettings:_0x35b98a,wallets:_0x30954e}=_0x2790d1,_0x48f439=await database_1['default'][_0x5d89f0(0x198)]['findUnique']({'where':{'username':_0x46575c}});if(_0x48f439)throw new Error('Username\x20already\x20exists');if(_0x163669){const _0x257388=await database_1['default'][_0x5d89f0(0x198)][_0x5d89f0(0x196)]({'where':{'telegram':_0x163669}});if(_0x257388)throw new Error(_0x5d89f0(0x19c));}const _0x5b0758=await bcryptjs_1[_0x5d89f0(0x19d)]['hash'](_0x554b68,0xc),{publicKey:_0x46735d,secretKey:_0x48cd66}=this['generateApiKeys'](),_0x20c48c=await database_1['default']['shop'][_0x5d89f0(0x197)]({'data':{'name':_0x2eb948,'username':_0x46575c,'password':_0x5b0758,'telegram':_0x163669,'shopUrl':_0x16e76b,'paymentGateways':_0x3f217c?JSON['stringify'](_0x3f217c):null,'gatewaySettings':_0x35b98a?JSON[_0x5d89f0(0x167)](_0x35b98a):null,'usdtPolygonWallet':_0x30954e?.[_0x5d89f0(0x19b)]||null,'usdtTrcWallet':_0x30954e?.['usdtTrcWallet']||null,'usdtErcWallet':_0x30954e?.[_0x5d89f0(0x170)]||null,'usdcPolygonWallet':_0x30954e?.[_0x5d89f0(0x16f)]||null,'publicKey':_0x46735d,'secretKey':_0x48cd66,'status':_0x5d89f0(0x16a)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x20c48c['id'],'fullName':_0x20c48c[_0x5d89f0(0x16e)],'username':_0x20c48c[_0x5d89f0(0x185)],'telegramId':_0x20c48c[_0x5d89f0(0x17a)],'merchantUrl':_0x20c48c[_0x5d89f0(0x193)],'gateways':_0x20c48c[_0x5d89f0(0x190)]?JSON['parse'](_0x20c48c[_0x5d89f0(0x190)]):null,'gatewaySettings':_0x20c48c['gatewaySettings']?JSON['parse'](_0x20c48c[_0x5d89f0(0x16c)]):null,'publicKey':_0x20c48c[_0x5d89f0(0x192)],'wallets':{'usdtPolygonWallet':_0x20c48c[_0x5d89f0(0x19b)],'usdtTrcWallet':_0x20c48c[_0x5d89f0(0x199)],'usdtErcWallet':_0x20c48c[_0x5d89f0(0x170)],'usdcPolygonWallet':_0x20c48c[_0x5d89f0(0x16f)]},'status':_0x20c48c[_0x5d89f0(0x191)],'createdAt':_0x20c48c[_0x5d89f0(0x184)]};}async[a89_0xb60efa(0x17c)](){const _0x5a2e41=a89_0xb60efa,_0x5c6f22=await database_1[_0x5a2e41(0x19d)][_0x5a2e41(0x198)][_0x5a2e41(0x172)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x5a2e41(0x182)}});return _0x5c6f22[_0x5a2e41(0x18d)](_0x146b84=>({'id':_0x146b84['id'],'fullName':_0x146b84[_0x5a2e41(0x16e)],'username':_0x146b84[_0x5a2e41(0x185)],'telegramId':_0x146b84[_0x5a2e41(0x17a)],'merchantUrl':_0x146b84[_0x5a2e41(0x193)],'gateways':_0x146b84[_0x5a2e41(0x190)]?JSON['parse'](_0x146b84[_0x5a2e41(0x190)]):null,'gatewaySettings':_0x146b84[_0x5a2e41(0x16c)]?JSON[_0x5a2e41(0x169)](_0x146b84[_0x5a2e41(0x16c)]):null,'publicKey':_0x146b84[_0x5a2e41(0x192)],'wallets':{'usdtPolygonWallet':_0x146b84['usdtPolygonWallet'],'usdtTrcWallet':_0x146b84['usdtTrcWallet'],'usdtErcWallet':_0x146b84[_0x5a2e41(0x170)],'usdcPolygonWallet':_0x146b84[_0x5a2e41(0x16f)]},'status':_0x146b84[_0x5a2e41(0x191)],'createdAt':_0x146b84[_0x5a2e41(0x184)]}));}async[a89_0xb60efa(0x17d)](_0x5a2efb){const _0x5bed12=a89_0xb60efa,_0x3d9994=await database_1[_0x5bed12(0x19d)][_0x5bed12(0x198)][_0x5bed12(0x196)]({'where':{'id':_0x5a2efb},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x3d9994)return null;return{'id':_0x3d9994['id'],'fullName':_0x3d9994[_0x5bed12(0x16e)],'username':_0x3d9994[_0x5bed12(0x185)],'telegramId':_0x3d9994[_0x5bed12(0x17a)],'merchantUrl':_0x3d9994[_0x5bed12(0x193)],'gateways':_0x3d9994[_0x5bed12(0x190)]?JSON[_0x5bed12(0x169)](_0x3d9994['paymentGateways']):null,'gatewaySettings':_0x3d9994[_0x5bed12(0x16c)]?JSON[_0x5bed12(0x169)](_0x3d9994[_0x5bed12(0x16c)]):null,'publicKey':_0x3d9994[_0x5bed12(0x192)],'wallets':{'usdtPolygonWallet':_0x3d9994['usdtPolygonWallet'],'usdtTrcWallet':_0x3d9994[_0x5bed12(0x199)],'usdtErcWallet':_0x3d9994[_0x5bed12(0x170)],'usdcPolygonWallet':_0x3d9994[_0x5bed12(0x16f)]},'status':_0x3d9994[_0x5bed12(0x191)],'createdAt':_0x3d9994[_0x5bed12(0x184)]};}async[a89_0xb60efa(0x189)](_0x3c52e5,_0x519456){const _0x23ebfe=a89_0xb60efa,_0x42a0f={..._0x519456};_0x519456[_0x23ebfe(0x173)]&&(_0x42a0f[_0x23ebfe(0x173)]=await bcryptjs_1['default'][_0x23ebfe(0x19a)](_0x519456[_0x23ebfe(0x173)],0xc));_0x519456[_0x23ebfe(0x16d)]&&(_0x42a0f[_0x23ebfe(0x16e)]=_0x519456[_0x23ebfe(0x16d)],delete _0x42a0f['fullName']);_0x519456[_0x23ebfe(0x17f)]&&(_0x42a0f[_0x23ebfe(0x17a)]=_0x519456[_0x23ebfe(0x17f)],delete _0x42a0f['telegramId']);_0x519456['merchantUrl']&&(_0x42a0f['shopUrl']=_0x519456[_0x23ebfe(0x179)],delete _0x42a0f[_0x23ebfe(0x179)]);_0x519456['gateways']&&(_0x42a0f[_0x23ebfe(0x190)]=JSON[_0x23ebfe(0x167)](_0x519456[_0x23ebfe(0x174)]),delete _0x42a0f[_0x23ebfe(0x174)]);_0x519456[_0x23ebfe(0x16c)]&&(_0x42a0f[_0x23ebfe(0x16c)]=JSON[_0x23ebfe(0x167)](_0x519456['gatewaySettings']),delete _0x42a0f[_0x23ebfe(0x16c)]);_0x519456['wallets']&&(_0x519456[_0x23ebfe(0x188)][_0x23ebfe(0x19b)]!==undefined&&(_0x42a0f['usdtPolygonWallet']=_0x519456[_0x23ebfe(0x188)]['usdtPolygonWallet']||null),_0x519456[_0x23ebfe(0x188)][_0x23ebfe(0x199)]!==undefined&&(_0x42a0f[_0x23ebfe(0x199)]=_0x519456[_0x23ebfe(0x188)]['usdtTrcWallet']||null),_0x519456['wallets'][_0x23ebfe(0x170)]!==undefined&&(_0x42a0f[_0x23ebfe(0x170)]=_0x519456['wallets'][_0x23ebfe(0x170)]||null),_0x519456[_0x23ebfe(0x188)][_0x23ebfe(0x16f)]!==undefined&&(_0x42a0f[_0x23ebfe(0x16f)]=_0x519456[_0x23ebfe(0x188)][_0x23ebfe(0x16f)]||null),delete _0x42a0f[_0x23ebfe(0x188)]);const _0x414bad=await database_1[_0x23ebfe(0x19d)][_0x23ebfe(0x198)][_0x23ebfe(0x18c)]({'where':{'id':_0x3c52e5},'data':_0x42a0f,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x414bad['id'],'fullName':_0x414bad[_0x23ebfe(0x16e)],'username':_0x414bad[_0x23ebfe(0x185)],'telegramId':_0x414bad[_0x23ebfe(0x17a)],'merchantUrl':_0x414bad[_0x23ebfe(0x193)],'gateways':_0x414bad['paymentGateways']?JSON['parse'](_0x414bad['paymentGateways']):null,'gatewaySettings':_0x414bad['gatewaySettings']?JSON[_0x23ebfe(0x169)](_0x414bad[_0x23ebfe(0x16c)]):null,'publicKey':_0x414bad[_0x23ebfe(0x192)],'wallets':{'usdtPolygonWallet':_0x414bad['usdtPolygonWallet'],'usdtTrcWallet':_0x414bad[_0x23ebfe(0x199)],'usdtErcWallet':_0x414bad[_0x23ebfe(0x170)],'usdcPolygonWallet':_0x414bad[_0x23ebfe(0x16f)]},'status':_0x414bad['status'],'createdAt':_0x414bad[_0x23ebfe(0x184)]};}async['deleteUser'](_0x4eeb63){const _0x549363=a89_0xb60efa;await database_1[_0x549363(0x19d)][_0x549363(0x198)]['delete']({'where':{'id':_0x4eeb63}});}}exports['UserService']=UserService;