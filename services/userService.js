'use strict';const a57_0x18a75e=a57_0x59b5;(function(_0x5621ec,_0x423d2a){const _0x28f5ec=a57_0x59b5,_0x4b34b5=_0x5621ec();while(!![]){try{const _0x1c383f=parseInt(_0x28f5ec(0x201))/0x1*(-parseInt(_0x28f5ec(0x1ee))/0x2)+-parseInt(_0x28f5ec(0x1ef))/0x3+parseInt(_0x28f5ec(0x1ec))/0x4*(-parseInt(_0x28f5ec(0x219))/0x5)+parseInt(_0x28f5ec(0x1e9))/0x6*(parseInt(_0x28f5ec(0x1f7))/0x7)+parseInt(_0x28f5ec(0x200))/0x8+-parseInt(_0x28f5ec(0x209))/0x9*(parseInt(_0x28f5ec(0x1f0))/0xa)+parseInt(_0x28f5ec(0x214))/0xb;if(_0x1c383f===_0x423d2a)break;else _0x4b34b5['push'](_0x4b34b5['shift']());}catch(_0x55e03e){_0x4b34b5['push'](_0x4b34b5['shift']());}}}(a57_0x2b14,0xc4a11));function a57_0x2b14(){const _0x5e9e42=['8451abyoRj','publicKey','usdtTrcWallet','parse','__importDefault','name','default','username','paymentGateways','usdtErcWallet','getUserById','43697610SIQffO','password','desc','crypto','fullName','480xcMtno','generateApiKeys','createUser','gateways','18NWsYeO','UserService','merchantUrl','45488TNJsVs','ACTIVE','4muUPqM','3317343pjDuDv','10740yqikCF','create','wallets','getAllUsers','findUnique','pk_','stringify','1169231WIlweB','usdcPolygonWallet','hash','map','__esModule','shopUrl','gatewaySettings','randomBytes','../config/database','7541512bcqwzL','702463IHXljN','usdtPolygonWallet','createdAt','toString','shop','update','telegram','status'];a57_0x2b14=function(){return _0x5e9e42;};return a57_0x2b14();}var __importDefault=this&&this[a57_0x18a75e(0x20d)]||function(_0x5d3f80){const _0x23ba92=a57_0x18a75e;return _0x5d3f80&&_0x5d3f80[_0x23ba92(0x1fb)]?_0x5d3f80:{'default':_0x5d3f80};};Object['defineProperty'](exports,a57_0x18a75e(0x1fb),{'value':!![]}),exports[a57_0x18a75e(0x1ea)]=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),crypto_1=__importDefault(require(a57_0x18a75e(0x217))),database_1=__importDefault(require(a57_0x18a75e(0x1ff)));class UserService{['generateApiKeys'](){const _0x2adf6c=a57_0x18a75e,_0x2e494d=_0x2adf6c(0x1f5)+crypto_1['default'][_0x2adf6c(0x1fe)](0x20)[_0x2adf6c(0x204)]('hex'),_0x111361='sk_'+crypto_1[_0x2adf6c(0x20f)]['randomBytes'](0x20)[_0x2adf6c(0x204)]('hex');return{'publicKey':_0x2e494d,'secretKey':_0x111361};}async[a57_0x18a75e(0x21b)](_0x1ab291){const _0x2bc689=a57_0x18a75e,{fullName:_0x3e97ac,username:_0x7f23f1,password:_0x1246f1,telegramId:_0x33d4f0,merchantUrl:_0x583251,gateways:_0x1547c4,gatewaySettings:_0x260ada,wallets:_0x17627f}=_0x1ab291,_0x2b9735=await database_1[_0x2bc689(0x20f)][_0x2bc689(0x205)][_0x2bc689(0x1f4)]({'where':{'username':_0x7f23f1}});if(_0x2b9735)throw new Error('Username\x20already\x20exists');if(_0x33d4f0){const _0x425464=await database_1['default']['shop'][_0x2bc689(0x1f4)]({'where':{'telegram':_0x33d4f0}});if(_0x425464)throw new Error('Telegram\x20username\x20already\x20exists');}const _0x72d430=await bcryptjs_1[_0x2bc689(0x20f)][_0x2bc689(0x1f9)](_0x1246f1,0xc),{publicKey:_0x5a977a,secretKey:_0x423d9a}=this[_0x2bc689(0x21a)](),_0x3ec7a0=await database_1[_0x2bc689(0x20f)][_0x2bc689(0x205)][_0x2bc689(0x1f1)]({'data':{'name':_0x3e97ac,'username':_0x7f23f1,'password':_0x72d430,'telegram':_0x33d4f0,'shopUrl':_0x583251,'paymentGateways':_0x1547c4?JSON[_0x2bc689(0x1f6)](_0x1547c4):null,'gatewaySettings':_0x260ada?JSON['stringify'](_0x260ada):null,'usdtPolygonWallet':_0x17627f?.[_0x2bc689(0x202)]||null,'usdtTrcWallet':_0x17627f?.['usdtTrcWallet']||null,'usdtErcWallet':_0x17627f?.[_0x2bc689(0x212)]||null,'usdcPolygonWallet':_0x17627f?.[_0x2bc689(0x1f8)]||null,'publicKey':_0x5a977a,'secretKey':_0x423d9a,'status':_0x2bc689(0x1ed)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x3ec7a0['id'],'fullName':_0x3ec7a0[_0x2bc689(0x20e)],'username':_0x3ec7a0[_0x2bc689(0x210)],'telegramId':_0x3ec7a0[_0x2bc689(0x207)],'merchantUrl':_0x3ec7a0[_0x2bc689(0x1fc)],'gateways':_0x3ec7a0[_0x2bc689(0x211)]?JSON[_0x2bc689(0x20c)](_0x3ec7a0[_0x2bc689(0x211)]):null,'gatewaySettings':_0x3ec7a0[_0x2bc689(0x1fd)]?JSON['parse'](_0x3ec7a0[_0x2bc689(0x1fd)]):null,'publicKey':_0x3ec7a0[_0x2bc689(0x20a)],'wallets':{'usdtPolygonWallet':_0x3ec7a0[_0x2bc689(0x202)],'usdtTrcWallet':_0x3ec7a0['usdtTrcWallet'],'usdtErcWallet':_0x3ec7a0[_0x2bc689(0x212)],'usdcPolygonWallet':_0x3ec7a0[_0x2bc689(0x1f8)]},'status':_0x3ec7a0[_0x2bc689(0x208)],'createdAt':_0x3ec7a0[_0x2bc689(0x203)]};}async[a57_0x18a75e(0x1f3)](){const _0x2d22c5=a57_0x18a75e,_0x3c7ff7=await database_1['default'][_0x2d22c5(0x205)]['findMany']({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x2d22c5(0x216)}});return _0x3c7ff7[_0x2d22c5(0x1fa)](_0x46dc85=>({'id':_0x46dc85['id'],'fullName':_0x46dc85['name'],'username':_0x46dc85[_0x2d22c5(0x210)],'telegramId':_0x46dc85[_0x2d22c5(0x207)],'merchantUrl':_0x46dc85[_0x2d22c5(0x1fc)],'gateways':_0x46dc85[_0x2d22c5(0x211)]?JSON[_0x2d22c5(0x20c)](_0x46dc85[_0x2d22c5(0x211)]):null,'gatewaySettings':_0x46dc85[_0x2d22c5(0x1fd)]?JSON[_0x2d22c5(0x20c)](_0x46dc85['gatewaySettings']):null,'publicKey':_0x46dc85[_0x2d22c5(0x20a)],'wallets':{'usdtPolygonWallet':_0x46dc85['usdtPolygonWallet'],'usdtTrcWallet':_0x46dc85['usdtTrcWallet'],'usdtErcWallet':_0x46dc85[_0x2d22c5(0x212)],'usdcPolygonWallet':_0x46dc85[_0x2d22c5(0x1f8)]},'status':_0x46dc85['status'],'createdAt':_0x46dc85[_0x2d22c5(0x203)]}));}async[a57_0x18a75e(0x213)](_0x438b2e){const _0x2989a0=a57_0x18a75e,_0x5bb64=await database_1[_0x2989a0(0x20f)][_0x2989a0(0x205)][_0x2989a0(0x1f4)]({'where':{'id':_0x438b2e},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x5bb64)return null;return{'id':_0x5bb64['id'],'fullName':_0x5bb64[_0x2989a0(0x20e)],'username':_0x5bb64['username'],'telegramId':_0x5bb64['telegram'],'merchantUrl':_0x5bb64[_0x2989a0(0x1fc)],'gateways':_0x5bb64['paymentGateways']?JSON[_0x2989a0(0x20c)](_0x5bb64[_0x2989a0(0x211)]):null,'gatewaySettings':_0x5bb64[_0x2989a0(0x1fd)]?JSON[_0x2989a0(0x20c)](_0x5bb64[_0x2989a0(0x1fd)]):null,'publicKey':_0x5bb64['publicKey'],'wallets':{'usdtPolygonWallet':_0x5bb64[_0x2989a0(0x202)],'usdtTrcWallet':_0x5bb64[_0x2989a0(0x20b)],'usdtErcWallet':_0x5bb64[_0x2989a0(0x212)],'usdcPolygonWallet':_0x5bb64[_0x2989a0(0x1f8)]},'status':_0x5bb64[_0x2989a0(0x208)],'createdAt':_0x5bb64['createdAt']};}async['updateUser'](_0x297c5c,_0xc96eec){const _0x57c1e9=a57_0x18a75e,_0x141bb0={..._0xc96eec};_0xc96eec[_0x57c1e9(0x215)]&&(_0x141bb0[_0x57c1e9(0x215)]=await bcryptjs_1[_0x57c1e9(0x20f)]['hash'](_0xc96eec['password'],0xc));_0xc96eec[_0x57c1e9(0x218)]&&(_0x141bb0[_0x57c1e9(0x20e)]=_0xc96eec['fullName'],delete _0x141bb0[_0x57c1e9(0x218)]);_0xc96eec['telegramId']&&(_0x141bb0[_0x57c1e9(0x207)]=_0xc96eec['telegramId'],delete _0x141bb0['telegramId']);_0xc96eec[_0x57c1e9(0x1eb)]&&(_0x141bb0[_0x57c1e9(0x1fc)]=_0xc96eec[_0x57c1e9(0x1eb)],delete _0x141bb0[_0x57c1e9(0x1eb)]);_0xc96eec[_0x57c1e9(0x1e8)]&&(_0x141bb0[_0x57c1e9(0x211)]=JSON[_0x57c1e9(0x1f6)](_0xc96eec[_0x57c1e9(0x1e8)]),delete _0x141bb0[_0x57c1e9(0x1e8)]);_0xc96eec[_0x57c1e9(0x1fd)]&&(_0x141bb0['gatewaySettings']=JSON[_0x57c1e9(0x1f6)](_0xc96eec['gatewaySettings']),delete _0x141bb0[_0x57c1e9(0x1fd)]);_0xc96eec['wallets']&&(_0xc96eec[_0x57c1e9(0x1f2)][_0x57c1e9(0x202)]!==undefined&&(_0x141bb0[_0x57c1e9(0x202)]=_0xc96eec[_0x57c1e9(0x1f2)][_0x57c1e9(0x202)]||null),_0xc96eec['wallets']['usdtTrcWallet']!==undefined&&(_0x141bb0[_0x57c1e9(0x20b)]=_0xc96eec['wallets'][_0x57c1e9(0x20b)]||null),_0xc96eec[_0x57c1e9(0x1f2)][_0x57c1e9(0x212)]!==undefined&&(_0x141bb0[_0x57c1e9(0x212)]=_0xc96eec[_0x57c1e9(0x1f2)][_0x57c1e9(0x212)]||null),_0xc96eec['wallets'][_0x57c1e9(0x1f8)]!==undefined&&(_0x141bb0[_0x57c1e9(0x1f8)]=_0xc96eec[_0x57c1e9(0x1f2)]['usdcPolygonWallet']||null),delete _0x141bb0[_0x57c1e9(0x1f2)]);const _0xc6453c=await database_1[_0x57c1e9(0x20f)][_0x57c1e9(0x205)][_0x57c1e9(0x206)]({'where':{'id':_0x297c5c},'data':_0x141bb0,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0xc6453c['id'],'fullName':_0xc6453c[_0x57c1e9(0x20e)],'username':_0xc6453c[_0x57c1e9(0x210)],'telegramId':_0xc6453c[_0x57c1e9(0x207)],'merchantUrl':_0xc6453c['shopUrl'],'gateways':_0xc6453c[_0x57c1e9(0x211)]?JSON[_0x57c1e9(0x20c)](_0xc6453c[_0x57c1e9(0x211)]):null,'gatewaySettings':_0xc6453c[_0x57c1e9(0x1fd)]?JSON[_0x57c1e9(0x20c)](_0xc6453c[_0x57c1e9(0x1fd)]):null,'publicKey':_0xc6453c[_0x57c1e9(0x20a)],'wallets':{'usdtPolygonWallet':_0xc6453c[_0x57c1e9(0x202)],'usdtTrcWallet':_0xc6453c['usdtTrcWallet'],'usdtErcWallet':_0xc6453c['usdtErcWallet'],'usdcPolygonWallet':_0xc6453c['usdcPolygonWallet']},'status':_0xc6453c[_0x57c1e9(0x208)],'createdAt':_0xc6453c[_0x57c1e9(0x203)]};}async['deleteUser'](_0x48bfc3){await database_1['default']['shop']['delete']({'where':{'id':_0x48bfc3}});}}function a57_0x59b5(_0x50cae2,_0x17d106){const _0x2b14b5=a57_0x2b14();return a57_0x59b5=function(_0x59b570,_0x5c1f66){_0x59b570=_0x59b570-0x1e8;let _0x31a9f1=_0x2b14b5[_0x59b570];return _0x31a9f1;},a57_0x59b5(_0x50cae2,_0x17d106);}exports[a57_0x18a75e(0x1ea)]=UserService;