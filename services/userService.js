'use strict';const a65_0x434dcf=a65_0x483c;(function(_0x1e6d37,_0x4c2799){const _0x4d381a=a65_0x483c,_0xbf56a4=_0x1e6d37();while(!![]){try{const _0x3e45a4=-parseInt(_0x4d381a(0xfd))/0x1+-parseInt(_0x4d381a(0xea))/0x2+parseInt(_0x4d381a(0xf5))/0x3*(parseInt(_0x4d381a(0xe2))/0x4)+-parseInt(_0x4d381a(0xe5))/0x5+-parseInt(_0x4d381a(0x104))/0x6*(-parseInt(_0x4d381a(0x10a))/0x7)+parseInt(_0x4d381a(0xf7))/0x8+-parseInt(_0x4d381a(0x105))/0x9*(-parseInt(_0x4d381a(0x103))/0xa);if(_0x3e45a4===_0x4c2799)break;else _0xbf56a4['push'](_0xbf56a4['shift']());}catch(_0x3bce69){_0xbf56a4['push'](_0xbf56a4['shift']());}}}(a65_0x439f,0xcadd6));var __importDefault=this&&this[a65_0x434dcf(0x10c)]||function(_0x208a00){return _0x208a00&&_0x208a00['__esModule']?_0x208a00:{'default':_0x208a00};};Object[a65_0x434dcf(0x10b)](exports,'__esModule',{'value':!![]}),exports[a65_0x434dcf(0xf1)]=void 0x0;function a65_0x439f(){const _0x4133f5=['createdAt','UserService','hash','parse','bcryptjs','6756nbnvCR','crypto','8416056cKiBbw','pk_','getUserById','toString','publicKey','update','542463ugaBha','findUnique','updateUser','shop','wallets','name','1297840DqMMKm','28824zSfdmc','162lnTkjJ','password','stringify','status','findMany','84jkslgy','defineProperty','__importDefault','create','merchantUrl','ACTIVE','usdcPolygonWallet','createUser','usdtTrcWallet','shopUrl','generateApiKeys','hex','default','usdtErcWallet','Telegram\x20username\x20already\x20exists','usdtPolygonWallet','856oPNFfO','gateways','map','5819795yyodXR','telegramId','randomBytes','fullName','gatewaySettings','2780678tqxbyd','telegram','username','deleteUser','Username\x20already\x20exists','paymentGateways'];a65_0x439f=function(){return _0x4133f5;};return a65_0x439f();}function a65_0x483c(_0x382dda,_0xb9aa7f){const _0x439fc=a65_0x439f();return a65_0x483c=function(_0x483cd1,_0x2bd8d3){_0x483cd1=_0x483cd1-0xe1;let _0x11dee6=_0x439fc[_0x483cd1];return _0x11dee6;},a65_0x483c(_0x382dda,_0xb9aa7f);}const bcryptjs_1=__importDefault(require(a65_0x434dcf(0xf4))),crypto_1=__importDefault(require(a65_0x434dcf(0xf6))),database_1=__importDefault(require('../config/database'));class UserService{[a65_0x434dcf(0x114)](){const _0x4d7706=a65_0x434dcf,_0x2be61b=_0x4d7706(0xf8)+crypto_1[_0x4d7706(0x116)][_0x4d7706(0xe7)](0x20)[_0x4d7706(0xfa)](_0x4d7706(0x115)),_0x5540f5='sk_'+crypto_1['default'][_0x4d7706(0xe7)](0x20)[_0x4d7706(0xfa)](_0x4d7706(0x115));return{'publicKey':_0x2be61b,'secretKey':_0x5540f5};}async[a65_0x434dcf(0x111)](_0x5e1a16){const _0x237b35=a65_0x434dcf,{fullName:_0x1be46d,username:_0x163cec,password:_0x468ff5,telegramId:_0x47309a,merchantUrl:_0x2beea8,gateways:_0x3a5932,gatewaySettings:_0x539e3f,wallets:_0x50a53d}=_0x5e1a16,_0x5b159a=await database_1['default'][_0x237b35(0x100)]['findUnique']({'where':{'username':_0x163cec}});if(_0x5b159a)throw new Error(_0x237b35(0xee));if(_0x47309a){const _0x1f225e=await database_1[_0x237b35(0x116)][_0x237b35(0x100)][_0x237b35(0xfe)]({'where':{'telegram':_0x47309a}});if(_0x1f225e)throw new Error(_0x237b35(0x118));}const _0xe82d5a=await bcryptjs_1['default'][_0x237b35(0xf2)](_0x468ff5,0xc),{publicKey:_0x1a03f0,secretKey:_0xfabd41}=this[_0x237b35(0x114)](),_0x8d492b=await database_1[_0x237b35(0x116)][_0x237b35(0x100)][_0x237b35(0x10d)]({'data':{'name':_0x1be46d,'username':_0x163cec,'password':_0xe82d5a,'telegram':_0x47309a,'shopUrl':_0x2beea8,'paymentGateways':_0x3a5932?JSON[_0x237b35(0x107)](_0x3a5932):null,'gatewaySettings':_0x539e3f?JSON['stringify'](_0x539e3f):null,'usdtPolygonWallet':_0x50a53d?.[_0x237b35(0xe1)]||null,'usdtTrcWallet':_0x50a53d?.['usdtTrcWallet']||null,'usdtErcWallet':_0x50a53d?.['usdtErcWallet']||null,'usdcPolygonWallet':_0x50a53d?.['usdcPolygonWallet']||null,'publicKey':_0x1a03f0,'secretKey':_0xfabd41,'status':_0x237b35(0x10f)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x8d492b['id'],'fullName':_0x8d492b['name'],'username':_0x8d492b[_0x237b35(0xec)],'telegramId':_0x8d492b['telegram'],'merchantUrl':_0x8d492b['shopUrl'],'gateways':_0x8d492b['paymentGateways']?JSON[_0x237b35(0xf3)](_0x8d492b[_0x237b35(0xef)]):null,'gatewaySettings':_0x8d492b[_0x237b35(0xe9)]?JSON[_0x237b35(0xf3)](_0x8d492b[_0x237b35(0xe9)]):null,'publicKey':_0x8d492b[_0x237b35(0xfb)],'wallets':{'usdtPolygonWallet':_0x8d492b[_0x237b35(0xe1)],'usdtTrcWallet':_0x8d492b[_0x237b35(0x112)],'usdtErcWallet':_0x8d492b[_0x237b35(0x117)],'usdcPolygonWallet':_0x8d492b['usdcPolygonWallet']},'status':_0x8d492b['status'],'createdAt':_0x8d492b['createdAt']};}async['getAllUsers'](){const _0xc66ed1=a65_0x434dcf,_0x257454=await database_1[_0xc66ed1(0x116)][_0xc66ed1(0x100)][_0xc66ed1(0x109)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':'desc'}});return _0x257454[_0xc66ed1(0xe4)](_0x110165=>({'id':_0x110165['id'],'fullName':_0x110165[_0xc66ed1(0x102)],'username':_0x110165[_0xc66ed1(0xec)],'telegramId':_0x110165[_0xc66ed1(0xeb)],'merchantUrl':_0x110165['shopUrl'],'gateways':_0x110165['paymentGateways']?JSON['parse'](_0x110165['paymentGateways']):null,'gatewaySettings':_0x110165[_0xc66ed1(0xe9)]?JSON[_0xc66ed1(0xf3)](_0x110165[_0xc66ed1(0xe9)]):null,'publicKey':_0x110165[_0xc66ed1(0xfb)],'wallets':{'usdtPolygonWallet':_0x110165['usdtPolygonWallet'],'usdtTrcWallet':_0x110165['usdtTrcWallet'],'usdtErcWallet':_0x110165[_0xc66ed1(0x117)],'usdcPolygonWallet':_0x110165[_0xc66ed1(0x110)]},'status':_0x110165[_0xc66ed1(0x108)],'createdAt':_0x110165['createdAt']}));}async[a65_0x434dcf(0xf9)](_0x3eb91e){const _0x360c47=a65_0x434dcf,_0x1c51c4=await database_1[_0x360c47(0x116)][_0x360c47(0x100)][_0x360c47(0xfe)]({'where':{'id':_0x3eb91e},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x1c51c4)return null;return{'id':_0x1c51c4['id'],'fullName':_0x1c51c4[_0x360c47(0x102)],'username':_0x1c51c4['username'],'telegramId':_0x1c51c4[_0x360c47(0xeb)],'merchantUrl':_0x1c51c4[_0x360c47(0x113)],'gateways':_0x1c51c4[_0x360c47(0xef)]?JSON[_0x360c47(0xf3)](_0x1c51c4[_0x360c47(0xef)]):null,'gatewaySettings':_0x1c51c4[_0x360c47(0xe9)]?JSON['parse'](_0x1c51c4[_0x360c47(0xe9)]):null,'publicKey':_0x1c51c4['publicKey'],'wallets':{'usdtPolygonWallet':_0x1c51c4[_0x360c47(0xe1)],'usdtTrcWallet':_0x1c51c4[_0x360c47(0x112)],'usdtErcWallet':_0x1c51c4[_0x360c47(0x117)],'usdcPolygonWallet':_0x1c51c4[_0x360c47(0x110)]},'status':_0x1c51c4[_0x360c47(0x108)],'createdAt':_0x1c51c4[_0x360c47(0xf0)]};}async[a65_0x434dcf(0xff)](_0x359db8,_0x552d7d){const _0x22ad47=a65_0x434dcf,_0x50e207={..._0x552d7d};_0x552d7d[_0x22ad47(0x106)]&&(_0x50e207[_0x22ad47(0x106)]=await bcryptjs_1[_0x22ad47(0x116)][_0x22ad47(0xf2)](_0x552d7d[_0x22ad47(0x106)],0xc));_0x552d7d[_0x22ad47(0xe8)]&&(_0x50e207['name']=_0x552d7d[_0x22ad47(0xe8)],delete _0x50e207['fullName']);_0x552d7d[_0x22ad47(0xe6)]&&(_0x50e207[_0x22ad47(0xeb)]=_0x552d7d[_0x22ad47(0xe6)],delete _0x50e207[_0x22ad47(0xe6)]);_0x552d7d[_0x22ad47(0x10e)]&&(_0x50e207['shopUrl']=_0x552d7d[_0x22ad47(0x10e)],delete _0x50e207[_0x22ad47(0x10e)]);_0x552d7d[_0x22ad47(0xe3)]&&(_0x50e207['paymentGateways']=JSON[_0x22ad47(0x107)](_0x552d7d[_0x22ad47(0xe3)]),delete _0x50e207['gateways']);_0x552d7d[_0x22ad47(0xe9)]&&(_0x50e207[_0x22ad47(0xe9)]=JSON[_0x22ad47(0x107)](_0x552d7d['gatewaySettings']),delete _0x50e207['gatewaySettings']);_0x552d7d[_0x22ad47(0x101)]&&(_0x552d7d['wallets'][_0x22ad47(0xe1)]!==undefined&&(_0x50e207[_0x22ad47(0xe1)]=_0x552d7d[_0x22ad47(0x101)][_0x22ad47(0xe1)]||null),_0x552d7d[_0x22ad47(0x101)][_0x22ad47(0x112)]!==undefined&&(_0x50e207['usdtTrcWallet']=_0x552d7d[_0x22ad47(0x101)]['usdtTrcWallet']||null),_0x552d7d['wallets'][_0x22ad47(0x117)]!==undefined&&(_0x50e207['usdtErcWallet']=_0x552d7d[_0x22ad47(0x101)][_0x22ad47(0x117)]||null),_0x552d7d[_0x22ad47(0x101)][_0x22ad47(0x110)]!==undefined&&(_0x50e207[_0x22ad47(0x110)]=_0x552d7d[_0x22ad47(0x101)]['usdcPolygonWallet']||null),delete _0x50e207['wallets']);const _0x1b1e66=await database_1[_0x22ad47(0x116)][_0x22ad47(0x100)][_0x22ad47(0xfc)]({'where':{'id':_0x359db8},'data':_0x50e207,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x1b1e66['id'],'fullName':_0x1b1e66[_0x22ad47(0x102)],'username':_0x1b1e66[_0x22ad47(0xec)],'telegramId':_0x1b1e66[_0x22ad47(0xeb)],'merchantUrl':_0x1b1e66[_0x22ad47(0x113)],'gateways':_0x1b1e66[_0x22ad47(0xef)]?JSON['parse'](_0x1b1e66['paymentGateways']):null,'gatewaySettings':_0x1b1e66[_0x22ad47(0xe9)]?JSON[_0x22ad47(0xf3)](_0x1b1e66['gatewaySettings']):null,'publicKey':_0x1b1e66[_0x22ad47(0xfb)],'wallets':{'usdtPolygonWallet':_0x1b1e66[_0x22ad47(0xe1)],'usdtTrcWallet':_0x1b1e66[_0x22ad47(0x112)],'usdtErcWallet':_0x1b1e66['usdtErcWallet'],'usdcPolygonWallet':_0x1b1e66['usdcPolygonWallet']},'status':_0x1b1e66[_0x22ad47(0x108)],'createdAt':_0x1b1e66[_0x22ad47(0xf0)]};}async[a65_0x434dcf(0xed)](_0x5adb99){const _0x3dbea7=a65_0x434dcf;await database_1[_0x3dbea7(0x116)]['shop']['delete']({'where':{'id':_0x5adb99}});}}exports[a65_0x434dcf(0xf1)]=UserService;