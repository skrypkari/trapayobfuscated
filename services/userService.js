'use strict';const a56_0x37487a=a56_0x5e3c;function a56_0x5e3c(_0x3fab05,_0x240df4){const _0x563275=a56_0x5632();return a56_0x5e3c=function(_0x5e3ccc,_0xef715d){_0x5e3ccc=_0x5e3ccc-0x1c7;let _0x2536d8=_0x563275[_0x5e3ccc];return _0x2536d8;},a56_0x5e3c(_0x3fab05,_0x240df4);}(function(_0x361fdd,_0x5ed620){const _0x2e9254=a56_0x5e3c,_0x5a1d3e=_0x361fdd();while(!![]){try{const _0x6a0400=parseInt(_0x2e9254(0x1fb))/0x1+parseInt(_0x2e9254(0x1e8))/0x2+-parseInt(_0x2e9254(0x1cd))/0x3+-parseInt(_0x2e9254(0x1f2))/0x4*(-parseInt(_0x2e9254(0x1d9))/0x5)+-parseInt(_0x2e9254(0x1c8))/0x6+parseInt(_0x2e9254(0x1f9))/0x7*(parseInt(_0x2e9254(0x1ee))/0x8)+-parseInt(_0x2e9254(0x1d1))/0x9*(parseInt(_0x2e9254(0x1d4))/0xa);if(_0x6a0400===_0x5ed620)break;else _0x5a1d3e['push'](_0x5a1d3e['shift']());}catch(_0x5dae69){_0x5a1d3e['push'](_0x5a1d3e['shift']());}}}(a56_0x5632,0x69d30));var __importDefault=this&&this[a56_0x37487a(0x1f3)]||function(_0x19680b){const _0x236c7a=a56_0x37487a;return _0x19680b&&_0x19680b[_0x236c7a(0x1f1)]?_0x19680b:{'default':_0x19680b};};function a56_0x5632(){const _0x204ffa=['usdcPolygonWallet','generateApiKeys','findMany','hex','getAllUsers','username','usdtPolygonWallet','updateUser','crypto','wallets','gatewaySettings','gateways','1534374MAjXCb','desc','paymentGateways','hash','usdtErcWallet','UserService','8znMqDx','update','createdAt','__esModule','2180ELvbbt','__importDefault','deleteUser','usdtTrcWallet','findUnique','bcryptjs','toString','3734521YtFQqP','Username\x20already\x20exists','425600btOAoA','fullName','name','password','4826202oJnhPM','createUser','merchantUrl','telegram','shop','457623yJCAep','shopUrl','publicKey','randomBytes','9169299tvrjyO','status','../config/database','10QASQqs','map','telegramId','Telegram\x20username\x20already\x20exists','default','6265BouakM','stringify','parse'];a56_0x5632=function(){return _0x204ffa;};return a56_0x5632();}Object['defineProperty'](exports,a56_0x37487a(0x1f1),{'value':!![]}),exports[a56_0x37487a(0x1ed)]=void 0x0;const bcryptjs_1=__importDefault(require(a56_0x37487a(0x1f7))),crypto_1=__importDefault(require(a56_0x37487a(0x1e4))),database_1=__importDefault(require(a56_0x37487a(0x1d3)));class UserService{[a56_0x37487a(0x1dd)](){const _0x122f38=a56_0x37487a,_0x4cbd35='pk_'+crypto_1['default']['randomBytes'](0x20)['toString'](_0x122f38(0x1df)),_0x59ff29='sk_'+crypto_1[_0x122f38(0x1d8)][_0x122f38(0x1d0)](0x20)[_0x122f38(0x1f8)]('hex');return{'publicKey':_0x4cbd35,'secretKey':_0x59ff29};}async[a56_0x37487a(0x1c9)](_0x5f01d9){const _0x397cd8=a56_0x37487a,{fullName:_0x467d5f,username:_0x518520,password:_0x2e67de,telegramId:_0x463e52,merchantUrl:_0xfc2fb,gateways:_0x13db94,gatewaySettings:_0x171ec9,wallets:_0x4794ed}=_0x5f01d9,_0x3a8354=await database_1['default'][_0x397cd8(0x1cc)][_0x397cd8(0x1f6)]({'where':{'username':_0x518520}});if(_0x3a8354)throw new Error(_0x397cd8(0x1fa));if(_0x463e52){const _0x120e3e=await database_1[_0x397cd8(0x1d8)][_0x397cd8(0x1cc)]['findUnique']({'where':{'telegram':_0x463e52}});if(_0x120e3e)throw new Error(_0x397cd8(0x1d7));}const _0x480a7b=await bcryptjs_1['default'][_0x397cd8(0x1eb)](_0x2e67de,0xc),{publicKey:_0x52e83c,secretKey:_0x3b5a9c}=this[_0x397cd8(0x1dd)](),_0x67f4f0=await database_1['default'][_0x397cd8(0x1cc)]['create']({'data':{'name':_0x467d5f,'username':_0x518520,'password':_0x480a7b,'telegram':_0x463e52,'shopUrl':_0xfc2fb,'paymentGateways':_0x13db94?JSON[_0x397cd8(0x1da)](_0x13db94):null,'gatewaySettings':_0x171ec9?JSON[_0x397cd8(0x1da)](_0x171ec9):null,'usdtPolygonWallet':_0x4794ed?.[_0x397cd8(0x1e2)]||null,'usdtTrcWallet':_0x4794ed?.[_0x397cd8(0x1f5)]||null,'usdtErcWallet':_0x4794ed?.[_0x397cd8(0x1ec)]||null,'usdcPolygonWallet':_0x4794ed?.[_0x397cd8(0x1dc)]||null,'publicKey':_0x52e83c,'secretKey':_0x3b5a9c,'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x67f4f0['id'],'fullName':_0x67f4f0[_0x397cd8(0x1fd)],'username':_0x67f4f0[_0x397cd8(0x1e1)],'telegramId':_0x67f4f0[_0x397cd8(0x1cb)],'merchantUrl':_0x67f4f0[_0x397cd8(0x1ce)],'gateways':_0x67f4f0['paymentGateways']?JSON['parse'](_0x67f4f0['paymentGateways']):null,'gatewaySettings':_0x67f4f0['gatewaySettings']?JSON['parse'](_0x67f4f0[_0x397cd8(0x1e6)]):null,'publicKey':_0x67f4f0['publicKey'],'wallets':{'usdtPolygonWallet':_0x67f4f0['usdtPolygonWallet'],'usdtTrcWallet':_0x67f4f0[_0x397cd8(0x1f5)],'usdtErcWallet':_0x67f4f0[_0x397cd8(0x1ec)],'usdcPolygonWallet':_0x67f4f0[_0x397cd8(0x1dc)]},'status':_0x67f4f0['status'],'createdAt':_0x67f4f0[_0x397cd8(0x1f0)]};}async[a56_0x37487a(0x1e0)](){const _0x288dc9=a56_0x37487a,_0x1e67ba=await database_1[_0x288dc9(0x1d8)][_0x288dc9(0x1cc)][_0x288dc9(0x1de)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x288dc9(0x1e9)}});return _0x1e67ba[_0x288dc9(0x1d5)](_0x23f5a7=>({'id':_0x23f5a7['id'],'fullName':_0x23f5a7[_0x288dc9(0x1fd)],'username':_0x23f5a7['username'],'telegramId':_0x23f5a7[_0x288dc9(0x1cb)],'merchantUrl':_0x23f5a7[_0x288dc9(0x1ce)],'gateways':_0x23f5a7[_0x288dc9(0x1ea)]?JSON[_0x288dc9(0x1db)](_0x23f5a7['paymentGateways']):null,'gatewaySettings':_0x23f5a7[_0x288dc9(0x1e6)]?JSON[_0x288dc9(0x1db)](_0x23f5a7[_0x288dc9(0x1e6)]):null,'publicKey':_0x23f5a7['publicKey'],'wallets':{'usdtPolygonWallet':_0x23f5a7[_0x288dc9(0x1e2)],'usdtTrcWallet':_0x23f5a7['usdtTrcWallet'],'usdtErcWallet':_0x23f5a7[_0x288dc9(0x1ec)],'usdcPolygonWallet':_0x23f5a7[_0x288dc9(0x1dc)]},'status':_0x23f5a7[_0x288dc9(0x1d2)],'createdAt':_0x23f5a7[_0x288dc9(0x1f0)]}));}async['getUserById'](_0x420b90){const _0x3d2b17=a56_0x37487a,_0x1c0eb3=await database_1[_0x3d2b17(0x1d8)][_0x3d2b17(0x1cc)][_0x3d2b17(0x1f6)]({'where':{'id':_0x420b90},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x1c0eb3)return null;return{'id':_0x1c0eb3['id'],'fullName':_0x1c0eb3[_0x3d2b17(0x1fd)],'username':_0x1c0eb3[_0x3d2b17(0x1e1)],'telegramId':_0x1c0eb3[_0x3d2b17(0x1cb)],'merchantUrl':_0x1c0eb3['shopUrl'],'gateways':_0x1c0eb3['paymentGateways']?JSON[_0x3d2b17(0x1db)](_0x1c0eb3[_0x3d2b17(0x1ea)]):null,'gatewaySettings':_0x1c0eb3['gatewaySettings']?JSON[_0x3d2b17(0x1db)](_0x1c0eb3[_0x3d2b17(0x1e6)]):null,'publicKey':_0x1c0eb3[_0x3d2b17(0x1cf)],'wallets':{'usdtPolygonWallet':_0x1c0eb3['usdtPolygonWallet'],'usdtTrcWallet':_0x1c0eb3[_0x3d2b17(0x1f5)],'usdtErcWallet':_0x1c0eb3[_0x3d2b17(0x1ec)],'usdcPolygonWallet':_0x1c0eb3['usdcPolygonWallet']},'status':_0x1c0eb3['status'],'createdAt':_0x1c0eb3[_0x3d2b17(0x1f0)]};}async[a56_0x37487a(0x1e3)](_0x26f102,_0x3fe8e0){const _0x35cfaa=a56_0x37487a,_0x19fcb6={..._0x3fe8e0};_0x3fe8e0[_0x35cfaa(0x1c7)]&&(_0x19fcb6['password']=await bcryptjs_1[_0x35cfaa(0x1d8)][_0x35cfaa(0x1eb)](_0x3fe8e0[_0x35cfaa(0x1c7)],0xc));_0x3fe8e0['fullName']&&(_0x19fcb6[_0x35cfaa(0x1fd)]=_0x3fe8e0[_0x35cfaa(0x1fc)],delete _0x19fcb6[_0x35cfaa(0x1fc)]);_0x3fe8e0[_0x35cfaa(0x1d6)]&&(_0x19fcb6[_0x35cfaa(0x1cb)]=_0x3fe8e0[_0x35cfaa(0x1d6)],delete _0x19fcb6[_0x35cfaa(0x1d6)]);_0x3fe8e0[_0x35cfaa(0x1ca)]&&(_0x19fcb6[_0x35cfaa(0x1ce)]=_0x3fe8e0[_0x35cfaa(0x1ca)],delete _0x19fcb6['merchantUrl']);_0x3fe8e0[_0x35cfaa(0x1e7)]&&(_0x19fcb6[_0x35cfaa(0x1ea)]=JSON[_0x35cfaa(0x1da)](_0x3fe8e0['gateways']),delete _0x19fcb6[_0x35cfaa(0x1e7)]);_0x3fe8e0[_0x35cfaa(0x1e6)]&&(_0x19fcb6[_0x35cfaa(0x1e6)]=JSON[_0x35cfaa(0x1da)](_0x3fe8e0[_0x35cfaa(0x1e6)]),delete _0x19fcb6['gatewaySettings']);_0x3fe8e0['wallets']&&(_0x3fe8e0[_0x35cfaa(0x1e5)][_0x35cfaa(0x1e2)]!==undefined&&(_0x19fcb6[_0x35cfaa(0x1e2)]=_0x3fe8e0[_0x35cfaa(0x1e5)][_0x35cfaa(0x1e2)]||null),_0x3fe8e0[_0x35cfaa(0x1e5)][_0x35cfaa(0x1f5)]!==undefined&&(_0x19fcb6[_0x35cfaa(0x1f5)]=_0x3fe8e0['wallets'][_0x35cfaa(0x1f5)]||null),_0x3fe8e0['wallets']['usdtErcWallet']!==undefined&&(_0x19fcb6[_0x35cfaa(0x1ec)]=_0x3fe8e0['wallets'][_0x35cfaa(0x1ec)]||null),_0x3fe8e0[_0x35cfaa(0x1e5)][_0x35cfaa(0x1dc)]!==undefined&&(_0x19fcb6[_0x35cfaa(0x1dc)]=_0x3fe8e0[_0x35cfaa(0x1e5)][_0x35cfaa(0x1dc)]||null),delete _0x19fcb6[_0x35cfaa(0x1e5)]);const _0x28e9a4=await database_1[_0x35cfaa(0x1d8)][_0x35cfaa(0x1cc)][_0x35cfaa(0x1ef)]({'where':{'id':_0x26f102},'data':_0x19fcb6,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x28e9a4['id'],'fullName':_0x28e9a4[_0x35cfaa(0x1fd)],'username':_0x28e9a4[_0x35cfaa(0x1e1)],'telegramId':_0x28e9a4[_0x35cfaa(0x1cb)],'merchantUrl':_0x28e9a4['shopUrl'],'gateways':_0x28e9a4[_0x35cfaa(0x1ea)]?JSON[_0x35cfaa(0x1db)](_0x28e9a4[_0x35cfaa(0x1ea)]):null,'gatewaySettings':_0x28e9a4[_0x35cfaa(0x1e6)]?JSON[_0x35cfaa(0x1db)](_0x28e9a4['gatewaySettings']):null,'publicKey':_0x28e9a4[_0x35cfaa(0x1cf)],'wallets':{'usdtPolygonWallet':_0x28e9a4[_0x35cfaa(0x1e2)],'usdtTrcWallet':_0x28e9a4['usdtTrcWallet'],'usdtErcWallet':_0x28e9a4[_0x35cfaa(0x1ec)],'usdcPolygonWallet':_0x28e9a4[_0x35cfaa(0x1dc)]},'status':_0x28e9a4['status'],'createdAt':_0x28e9a4[_0x35cfaa(0x1f0)]};}async[a56_0x37487a(0x1f4)](_0x4b6bf9){const _0x2f23ab=a56_0x37487a;await database_1['default'][_0x2f23ab(0x1cc)]['delete']({'where':{'id':_0x4b6bf9}});}}exports['UserService']=UserService;