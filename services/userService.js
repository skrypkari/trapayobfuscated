'use strict';function a61_0x3ef9(){const _0x2815b0=['12396420ooLGJj','bcryptjs','pk_','telegramId','randomBytes','update','5sHbuPP','name','Username\x20already\x20exists','status','toString','shopUrl','26628ntKsKY','usdtErcWallet','hex','paymentGateways','970440xBSwNC','shop','generateApiKeys','UserService','3XLkstU','default','fullName','17592qLfqCN','createdAt','usdcPolygonWallet','20350nWaKGx','publicKey','__esModule','../config/database','username','parse','crypto','117615tnFdaN','861138CvckTh','usdtTrcWallet','deleteUser','findUnique','delete','merchantUrl','stringify','sk_','gatewaySettings','getUserById','updateUser','defineProperty','findMany','wallets','usdtPolygonWallet','telegram','password','hash','gateways','getAllUsers','10sVCiOc','3942040axoDYU','1435iEBxxY'];a61_0x3ef9=function(){return _0x2815b0;};return a61_0x3ef9();}const a61_0x3dddff=a61_0x20cf;(function(_0x55d90b,_0x304810){const _0x18947c=a61_0x20cf,_0x544053=_0x55d90b();while(!![]){try{const _0x1cc139=-parseInt(_0x18947c(0xe2))/0x1*(parseInt(_0x18947c(0xbe))/0x2)+parseInt(_0x18947c(0xd5))/0x3*(-parseInt(_0x18947c(0xbf))/0x4)+-parseInt(_0x18947c(0xc7))/0x5*(parseInt(_0x18947c(0xd1))/0x6)+-parseInt(_0x18947c(0xc0))/0x7*(parseInt(_0x18947c(0xd8))/0x8)+parseInt(_0x18947c(0xe3))/0x9+-parseInt(_0x18947c(0xc1))/0xa+parseInt(_0x18947c(0xdb))/0xb*(parseInt(_0x18947c(0xcd))/0xc);if(_0x1cc139===_0x304810)break;else _0x544053['push'](_0x544053['shift']());}catch(_0x5b6703){_0x544053['push'](_0x544053['shift']());}}}(a61_0x3ef9,0xbd39e));function a61_0x20cf(_0x270e34,_0x1264a1){const _0x3ef958=a61_0x3ef9();return a61_0x20cf=function(_0x20cf5e,_0x1d04b4){_0x20cf5e=_0x20cf5e-0xb7;let _0x4710b5=_0x3ef958[_0x20cf5e];return _0x4710b5;},a61_0x20cf(_0x270e34,_0x1264a1);}var __importDefault=this&&this['__importDefault']||function(_0x3bf9ac){const _0x1abbcf=a61_0x20cf;return _0x3bf9ac&&_0x3bf9ac[_0x1abbcf(0xdd)]?_0x3bf9ac:{'default':_0x3bf9ac};};Object[a61_0x3dddff(0xee)](exports,'__esModule',{'value':!![]}),exports[a61_0x3dddff(0xd4)]=void 0x0;const bcryptjs_1=__importDefault(require(a61_0x3dddff(0xc2))),crypto_1=__importDefault(require(a61_0x3dddff(0xe1))),database_1=__importDefault(require(a61_0x3dddff(0xde)));class UserService{['generateApiKeys'](){const _0x5f60a=a61_0x3dddff,_0x295011=_0x5f60a(0xc3)+crypto_1['default'][_0x5f60a(0xc5)](0x20)[_0x5f60a(0xcb)](_0x5f60a(0xcf)),_0x6d8414=_0x5f60a(0xea)+crypto_1[_0x5f60a(0xd6)]['randomBytes'](0x20)[_0x5f60a(0xcb)](_0x5f60a(0xcf));return{'publicKey':_0x295011,'secretKey':_0x6d8414};}async['createUser'](_0x23d507){const _0x3c9f23=a61_0x3dddff,{fullName:_0x59332c,username:_0x35f3ff,password:_0x3eedd8,telegramId:_0x3a7449,merchantUrl:_0x19720c,gateways:_0x349faf,gatewaySettings:_0x5a8b30,wallets:_0x5a264a}=_0x23d507,_0x4b55d2=await database_1[_0x3c9f23(0xd6)][_0x3c9f23(0xd2)][_0x3c9f23(0xe6)]({'where':{'username':_0x35f3ff}});if(_0x4b55d2)throw new Error(_0x3c9f23(0xc9));if(_0x3a7449){const _0x44f8bf=await database_1['default']['shop'][_0x3c9f23(0xe6)]({'where':{'telegram':_0x3a7449}});if(_0x44f8bf)throw new Error('Telegram\x20username\x20already\x20exists');}const _0x2bd369=await bcryptjs_1[_0x3c9f23(0xd6)][_0x3c9f23(0xbb)](_0x3eedd8,0xc),{publicKey:_0x2a4612,secretKey:_0x336670}=this[_0x3c9f23(0xd3)](),_0x8fac50=await database_1['default']['shop']['create']({'data':{'name':_0x59332c,'username':_0x35f3ff,'password':_0x2bd369,'telegram':_0x3a7449,'shopUrl':_0x19720c,'paymentGateways':_0x349faf?JSON[_0x3c9f23(0xe9)](_0x349faf):null,'gatewaySettings':_0x5a8b30?JSON[_0x3c9f23(0xe9)](_0x5a8b30):null,'usdtPolygonWallet':_0x5a264a?.[_0x3c9f23(0xb8)]||null,'usdtTrcWallet':_0x5a264a?.['usdtTrcWallet']||null,'usdtErcWallet':_0x5a264a?.[_0x3c9f23(0xce)]||null,'usdcPolygonWallet':_0x5a264a?.[_0x3c9f23(0xda)]||null,'publicKey':_0x2a4612,'secretKey':_0x336670,'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x8fac50['id'],'fullName':_0x8fac50[_0x3c9f23(0xc8)],'username':_0x8fac50[_0x3c9f23(0xdf)],'telegramId':_0x8fac50['telegram'],'merchantUrl':_0x8fac50[_0x3c9f23(0xcc)],'gateways':_0x8fac50[_0x3c9f23(0xd0)]?JSON[_0x3c9f23(0xe0)](_0x8fac50['paymentGateways']):null,'gatewaySettings':_0x8fac50[_0x3c9f23(0xeb)]?JSON['parse'](_0x8fac50[_0x3c9f23(0xeb)]):null,'publicKey':_0x8fac50['publicKey'],'wallets':{'usdtPolygonWallet':_0x8fac50[_0x3c9f23(0xb8)],'usdtTrcWallet':_0x8fac50[_0x3c9f23(0xe4)],'usdtErcWallet':_0x8fac50['usdtErcWallet'],'usdcPolygonWallet':_0x8fac50[_0x3c9f23(0xda)]},'status':_0x8fac50[_0x3c9f23(0xca)],'createdAt':_0x8fac50[_0x3c9f23(0xd9)]};}async[a61_0x3dddff(0xbd)](){const _0x3dfe27=a61_0x3dddff,_0x463758=await database_1['default'][_0x3dfe27(0xd2)][_0x3dfe27(0xef)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':'desc'}});return _0x463758['map'](_0x1e1530=>({'id':_0x1e1530['id'],'fullName':_0x1e1530[_0x3dfe27(0xc8)],'username':_0x1e1530[_0x3dfe27(0xdf)],'telegramId':_0x1e1530[_0x3dfe27(0xb9)],'merchantUrl':_0x1e1530[_0x3dfe27(0xcc)],'gateways':_0x1e1530[_0x3dfe27(0xd0)]?JSON[_0x3dfe27(0xe0)](_0x1e1530[_0x3dfe27(0xd0)]):null,'gatewaySettings':_0x1e1530['gatewaySettings']?JSON[_0x3dfe27(0xe0)](_0x1e1530['gatewaySettings']):null,'publicKey':_0x1e1530['publicKey'],'wallets':{'usdtPolygonWallet':_0x1e1530[_0x3dfe27(0xb8)],'usdtTrcWallet':_0x1e1530['usdtTrcWallet'],'usdtErcWallet':_0x1e1530['usdtErcWallet'],'usdcPolygonWallet':_0x1e1530[_0x3dfe27(0xda)]},'status':_0x1e1530['status'],'createdAt':_0x1e1530['createdAt']}));}async[a61_0x3dddff(0xec)](_0x1308f2){const _0xbde86d=a61_0x3dddff,_0x1bc755=await database_1['default'][_0xbde86d(0xd2)][_0xbde86d(0xe6)]({'where':{'id':_0x1308f2},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x1bc755)return null;return{'id':_0x1bc755['id'],'fullName':_0x1bc755[_0xbde86d(0xc8)],'username':_0x1bc755[_0xbde86d(0xdf)],'telegramId':_0x1bc755[_0xbde86d(0xb9)],'merchantUrl':_0x1bc755[_0xbde86d(0xcc)],'gateways':_0x1bc755[_0xbde86d(0xd0)]?JSON[_0xbde86d(0xe0)](_0x1bc755[_0xbde86d(0xd0)]):null,'gatewaySettings':_0x1bc755[_0xbde86d(0xeb)]?JSON[_0xbde86d(0xe0)](_0x1bc755['gatewaySettings']):null,'publicKey':_0x1bc755[_0xbde86d(0xdc)],'wallets':{'usdtPolygonWallet':_0x1bc755[_0xbde86d(0xb8)],'usdtTrcWallet':_0x1bc755[_0xbde86d(0xe4)],'usdtErcWallet':_0x1bc755[_0xbde86d(0xce)],'usdcPolygonWallet':_0x1bc755[_0xbde86d(0xda)]},'status':_0x1bc755[_0xbde86d(0xca)],'createdAt':_0x1bc755[_0xbde86d(0xd9)]};}async[a61_0x3dddff(0xed)](_0x498dc2,_0x40e091){const _0x38a600=a61_0x3dddff,_0x217b91={..._0x40e091};_0x40e091[_0x38a600(0xba)]&&(_0x217b91[_0x38a600(0xba)]=await bcryptjs_1['default'][_0x38a600(0xbb)](_0x40e091[_0x38a600(0xba)],0xc));_0x40e091[_0x38a600(0xd7)]&&(_0x217b91[_0x38a600(0xc8)]=_0x40e091[_0x38a600(0xd7)],delete _0x217b91[_0x38a600(0xd7)]);_0x40e091[_0x38a600(0xc4)]&&(_0x217b91['telegram']=_0x40e091[_0x38a600(0xc4)],delete _0x217b91[_0x38a600(0xc4)]);_0x40e091[_0x38a600(0xe8)]&&(_0x217b91[_0x38a600(0xcc)]=_0x40e091[_0x38a600(0xe8)],delete _0x217b91['merchantUrl']);_0x40e091[_0x38a600(0xbc)]&&(_0x217b91[_0x38a600(0xd0)]=JSON[_0x38a600(0xe9)](_0x40e091[_0x38a600(0xbc)]),delete _0x217b91[_0x38a600(0xbc)]);_0x40e091[_0x38a600(0xeb)]&&(_0x217b91[_0x38a600(0xeb)]=JSON[_0x38a600(0xe9)](_0x40e091[_0x38a600(0xeb)]),delete _0x217b91[_0x38a600(0xeb)]);_0x40e091['wallets']&&(_0x40e091['wallets'][_0x38a600(0xb8)]!==undefined&&(_0x217b91[_0x38a600(0xb8)]=_0x40e091[_0x38a600(0xb7)]['usdtPolygonWallet']||null),_0x40e091[_0x38a600(0xb7)][_0x38a600(0xe4)]!==undefined&&(_0x217b91[_0x38a600(0xe4)]=_0x40e091[_0x38a600(0xb7)][_0x38a600(0xe4)]||null),_0x40e091[_0x38a600(0xb7)][_0x38a600(0xce)]!==undefined&&(_0x217b91['usdtErcWallet']=_0x40e091['wallets'][_0x38a600(0xce)]||null),_0x40e091[_0x38a600(0xb7)]['usdcPolygonWallet']!==undefined&&(_0x217b91['usdcPolygonWallet']=_0x40e091[_0x38a600(0xb7)][_0x38a600(0xda)]||null),delete _0x217b91[_0x38a600(0xb7)]);const _0x5a52e2=await database_1[_0x38a600(0xd6)]['shop'][_0x38a600(0xc6)]({'where':{'id':_0x498dc2},'data':_0x217b91,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x5a52e2['id'],'fullName':_0x5a52e2[_0x38a600(0xc8)],'username':_0x5a52e2['username'],'telegramId':_0x5a52e2[_0x38a600(0xb9)],'merchantUrl':_0x5a52e2[_0x38a600(0xcc)],'gateways':_0x5a52e2['paymentGateways']?JSON[_0x38a600(0xe0)](_0x5a52e2[_0x38a600(0xd0)]):null,'gatewaySettings':_0x5a52e2['gatewaySettings']?JSON['parse'](_0x5a52e2['gatewaySettings']):null,'publicKey':_0x5a52e2[_0x38a600(0xdc)],'wallets':{'usdtPolygonWallet':_0x5a52e2[_0x38a600(0xb8)],'usdtTrcWallet':_0x5a52e2[_0x38a600(0xe4)],'usdtErcWallet':_0x5a52e2[_0x38a600(0xce)],'usdcPolygonWallet':_0x5a52e2['usdcPolygonWallet']},'status':_0x5a52e2[_0x38a600(0xca)],'createdAt':_0x5a52e2[_0x38a600(0xd9)]};}async[a61_0x3dddff(0xe5)](_0x45a571){const _0x178199=a61_0x3dddff;await database_1[_0x178199(0xd6)][_0x178199(0xd2)][_0x178199(0xe7)]({'where':{'id':_0x45a571}});}}exports[a61_0x3dddff(0xd4)]=UserService;