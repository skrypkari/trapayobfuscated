'use strict';function a89_0x2d0b(_0x5cb3ea,_0x12b9d4){_0x5cb3ea=_0x5cb3ea-0x73;const _0x550724=a89_0x5507();let _0x2d0ba4=_0x550724[_0x5cb3ea];return _0x2d0ba4;}const a89_0x45a09d=a89_0x2d0b;(function(_0x2d35ec,_0x25f671){const _0x461717=a89_0x2d0b,_0x3cafbc=_0x2d35ec();while(!![]){try{const _0x52828a=parseInt(_0x461717(0xa2))/0x1+parseInt(_0x461717(0x9e))/0x2*(parseInt(_0x461717(0x96))/0x3)+-parseInt(_0x461717(0x7d))/0x4*(-parseInt(_0x461717(0x91))/0x5)+-parseInt(_0x461717(0xaa))/0x6+parseInt(_0x461717(0xa3))/0x7+-parseInt(_0x461717(0x77))/0x8+-parseInt(_0x461717(0x82))/0x9;if(_0x52828a===_0x25f671)break;else _0x3cafbc['push'](_0x3cafbc['shift']());}catch(_0x21e74c){_0x3cafbc['push'](_0x3cafbc['shift']());}}}(a89_0x5507,0x19a5f));var __importDefault=this&&this[a89_0x45a09d(0xa4)]||function(_0x37b594){const _0x31bb83=a89_0x45a09d;return _0x37b594&&_0x37b594[_0x31bb83(0x87)]?_0x37b594:{'default':_0x37b594};};Object[a89_0x45a09d(0x7a)](exports,a89_0x45a09d(0x87),{'value':!![]}),exports[a89_0x45a09d(0x79)]=void 0x0;function a89_0x5507(){const _0x17b312=['188192KzZGXX','gateways','UserService','defineProperty','pk_','password','4cDemUD','wallets','bcryptjs','../config/database','telegram','2733804hICptO','map','usdtErcWallet','hash','publicKey','__esModule','merchantUrl','stringify','default','parse','delete','updateUser','username','generateApiKeys','update','53465gKKTVD','shop','findMany','status','createUser','173673fUzjex','toString','randomBytes','paymentGateways','ACTIVE','fullName','createdAt','shopUrl','6nEZyMC','crypto','hex','telegramId','81382KGcHQL','1220254gObgZH','__importDefault','desc','name','getAllUsers','gatewaySettings','usdtTrcWallet','46410pzoEVT','usdcPolygonWallet','findUnique','usdtPolygonWallet','getUserById'];a89_0x5507=function(){return _0x17b312;};return a89_0x5507();}const bcryptjs_1=__importDefault(require(a89_0x45a09d(0x7f))),crypto_1=__importDefault(require(a89_0x45a09d(0x9f))),database_1=__importDefault(require(a89_0x45a09d(0x80)));class UserService{[a89_0x45a09d(0x8f)](){const _0x4e7b9c=a89_0x45a09d,_0x4ad3d2=_0x4e7b9c(0x7b)+crypto_1['default'][_0x4e7b9c(0x98)](0x20)[_0x4e7b9c(0x97)](_0x4e7b9c(0xa0)),_0x55d6ed='sk_'+crypto_1[_0x4e7b9c(0x8a)][_0x4e7b9c(0x98)](0x20)[_0x4e7b9c(0x97)](_0x4e7b9c(0xa0));return{'publicKey':_0x4ad3d2,'secretKey':_0x55d6ed};}async[a89_0x45a09d(0x95)](_0x3a069a){const _0x167c33=a89_0x45a09d,{fullName:_0x2d59c6,username:_0x2e7bbe,password:_0x59519f,telegramId:_0x339f4a,merchantUrl:_0x14d98b,gateways:_0x141424,gatewaySettings:_0x10f7c7,wallets:_0x524481}=_0x3a069a,_0x2c61c6=await database_1['default'][_0x167c33(0x92)]['findUnique']({'where':{'username':_0x2e7bbe}});if(_0x2c61c6)throw new Error('Username\x20already\x20exists');if(_0x339f4a){const _0xa595f=await database_1[_0x167c33(0x8a)]['shop'][_0x167c33(0x74)]({'where':{'telegram':_0x339f4a}});if(_0xa595f)throw new Error('Telegram\x20username\x20already\x20exists');}const _0x45318d=await bcryptjs_1[_0x167c33(0x8a)][_0x167c33(0x85)](_0x59519f,0xc),{publicKey:_0x3c18d6,secretKey:_0x579ecd}=this['generateApiKeys'](),_0x31363d=await database_1['default']['shop']['create']({'data':{'name':_0x2d59c6,'username':_0x2e7bbe,'password':_0x45318d,'telegram':_0x339f4a,'shopUrl':_0x14d98b,'paymentGateways':_0x141424?JSON['stringify'](_0x141424):null,'gatewaySettings':_0x10f7c7?JSON[_0x167c33(0x89)](_0x10f7c7):null,'usdtPolygonWallet':_0x524481?.[_0x167c33(0x75)]||null,'usdtTrcWallet':_0x524481?.[_0x167c33(0xa9)]||null,'usdtErcWallet':_0x524481?.['usdtErcWallet']||null,'usdcPolygonWallet':_0x524481?.[_0x167c33(0x73)]||null,'publicKey':_0x3c18d6,'secretKey':_0x579ecd,'status':_0x167c33(0x9a)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x31363d['id'],'fullName':_0x31363d[_0x167c33(0xa6)],'username':_0x31363d[_0x167c33(0x8e)],'telegramId':_0x31363d['telegram'],'merchantUrl':_0x31363d[_0x167c33(0x9d)],'gateways':_0x31363d[_0x167c33(0x99)]?JSON[_0x167c33(0x8b)](_0x31363d[_0x167c33(0x99)]):null,'gatewaySettings':_0x31363d[_0x167c33(0xa8)]?JSON[_0x167c33(0x8b)](_0x31363d[_0x167c33(0xa8)]):null,'publicKey':_0x31363d['publicKey'],'wallets':{'usdtPolygonWallet':_0x31363d[_0x167c33(0x75)],'usdtTrcWallet':_0x31363d[_0x167c33(0xa9)],'usdtErcWallet':_0x31363d[_0x167c33(0x84)],'usdcPolygonWallet':_0x31363d[_0x167c33(0x73)]},'status':_0x31363d[_0x167c33(0x94)],'createdAt':_0x31363d['createdAt']};}async[a89_0x45a09d(0xa7)](){const _0x21c54f=a89_0x45a09d,_0x36abf4=await database_1[_0x21c54f(0x8a)][_0x21c54f(0x92)][_0x21c54f(0x93)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x21c54f(0xa5)}});return _0x36abf4[_0x21c54f(0x83)](_0xcf695e=>({'id':_0xcf695e['id'],'fullName':_0xcf695e['name'],'username':_0xcf695e['username'],'telegramId':_0xcf695e[_0x21c54f(0x81)],'merchantUrl':_0xcf695e[_0x21c54f(0x9d)],'gateways':_0xcf695e[_0x21c54f(0x99)]?JSON['parse'](_0xcf695e[_0x21c54f(0x99)]):null,'gatewaySettings':_0xcf695e[_0x21c54f(0xa8)]?JSON[_0x21c54f(0x8b)](_0xcf695e[_0x21c54f(0xa8)]):null,'publicKey':_0xcf695e['publicKey'],'wallets':{'usdtPolygonWallet':_0xcf695e['usdtPolygonWallet'],'usdtTrcWallet':_0xcf695e[_0x21c54f(0xa9)],'usdtErcWallet':_0xcf695e['usdtErcWallet'],'usdcPolygonWallet':_0xcf695e[_0x21c54f(0x73)]},'status':_0xcf695e[_0x21c54f(0x94)],'createdAt':_0xcf695e['createdAt']}));}async[a89_0x45a09d(0x76)](_0x1d37fb){const _0x1a1d6e=a89_0x45a09d,_0x10773a=await database_1[_0x1a1d6e(0x8a)][_0x1a1d6e(0x92)][_0x1a1d6e(0x74)]({'where':{'id':_0x1d37fb},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x10773a)return null;return{'id':_0x10773a['id'],'fullName':_0x10773a[_0x1a1d6e(0xa6)],'username':_0x10773a[_0x1a1d6e(0x8e)],'telegramId':_0x10773a[_0x1a1d6e(0x81)],'merchantUrl':_0x10773a['shopUrl'],'gateways':_0x10773a[_0x1a1d6e(0x99)]?JSON[_0x1a1d6e(0x8b)](_0x10773a['paymentGateways']):null,'gatewaySettings':_0x10773a[_0x1a1d6e(0xa8)]?JSON[_0x1a1d6e(0x8b)](_0x10773a[_0x1a1d6e(0xa8)]):null,'publicKey':_0x10773a[_0x1a1d6e(0x86)],'wallets':{'usdtPolygonWallet':_0x10773a[_0x1a1d6e(0x75)],'usdtTrcWallet':_0x10773a[_0x1a1d6e(0xa9)],'usdtErcWallet':_0x10773a[_0x1a1d6e(0x84)],'usdcPolygonWallet':_0x10773a[_0x1a1d6e(0x73)]},'status':_0x10773a['status'],'createdAt':_0x10773a[_0x1a1d6e(0x9c)]};}async[a89_0x45a09d(0x8d)](_0x8b99b,_0x4efe80){const _0x425455=a89_0x45a09d,_0x272348={..._0x4efe80};_0x4efe80[_0x425455(0x7c)]&&(_0x272348[_0x425455(0x7c)]=await bcryptjs_1[_0x425455(0x8a)][_0x425455(0x85)](_0x4efe80[_0x425455(0x7c)],0xc));_0x4efe80['fullName']&&(_0x272348['name']=_0x4efe80[_0x425455(0x9b)],delete _0x272348['fullName']);_0x4efe80['telegramId']&&(_0x272348[_0x425455(0x81)]=_0x4efe80[_0x425455(0xa1)],delete _0x272348['telegramId']);_0x4efe80['merchantUrl']&&(_0x272348[_0x425455(0x9d)]=_0x4efe80['merchantUrl'],delete _0x272348[_0x425455(0x88)]);_0x4efe80[_0x425455(0x78)]&&(_0x272348[_0x425455(0x99)]=JSON[_0x425455(0x89)](_0x4efe80[_0x425455(0x78)]),delete _0x272348[_0x425455(0x78)]);_0x4efe80['gatewaySettings']&&(_0x272348[_0x425455(0xa8)]=JSON[_0x425455(0x89)](_0x4efe80[_0x425455(0xa8)]),delete _0x272348[_0x425455(0xa8)]);_0x4efe80[_0x425455(0x7e)]&&(_0x4efe80[_0x425455(0x7e)][_0x425455(0x75)]!==undefined&&(_0x272348[_0x425455(0x75)]=_0x4efe80[_0x425455(0x7e)][_0x425455(0x75)]||null),_0x4efe80[_0x425455(0x7e)][_0x425455(0xa9)]!==undefined&&(_0x272348[_0x425455(0xa9)]=_0x4efe80['wallets']['usdtTrcWallet']||null),_0x4efe80[_0x425455(0x7e)]['usdtErcWallet']!==undefined&&(_0x272348['usdtErcWallet']=_0x4efe80[_0x425455(0x7e)][_0x425455(0x84)]||null),_0x4efe80[_0x425455(0x7e)]['usdcPolygonWallet']!==undefined&&(_0x272348[_0x425455(0x73)]=_0x4efe80['wallets']['usdcPolygonWallet']||null),delete _0x272348[_0x425455(0x7e)]);const _0x36da7a=await database_1[_0x425455(0x8a)][_0x425455(0x92)][_0x425455(0x90)]({'where':{'id':_0x8b99b},'data':_0x272348,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x36da7a['id'],'fullName':_0x36da7a['name'],'username':_0x36da7a['username'],'telegramId':_0x36da7a[_0x425455(0x81)],'merchantUrl':_0x36da7a[_0x425455(0x9d)],'gateways':_0x36da7a[_0x425455(0x99)]?JSON[_0x425455(0x8b)](_0x36da7a['paymentGateways']):null,'gatewaySettings':_0x36da7a[_0x425455(0xa8)]?JSON[_0x425455(0x8b)](_0x36da7a[_0x425455(0xa8)]):null,'publicKey':_0x36da7a[_0x425455(0x86)],'wallets':{'usdtPolygonWallet':_0x36da7a[_0x425455(0x75)],'usdtTrcWallet':_0x36da7a[_0x425455(0xa9)],'usdtErcWallet':_0x36da7a['usdtErcWallet'],'usdcPolygonWallet':_0x36da7a[_0x425455(0x73)]},'status':_0x36da7a[_0x425455(0x94)],'createdAt':_0x36da7a[_0x425455(0x9c)]};}async['deleteUser'](_0x417cc2){const _0x4cb46f=a89_0x45a09d;await database_1[_0x4cb46f(0x8a)][_0x4cb46f(0x92)][_0x4cb46f(0x8c)]({'where':{'id':_0x417cc2}});}}exports['UserService']=UserService;