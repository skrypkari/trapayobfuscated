'use strict';function a51_0x3df8(){const _0x19d3b3=['publicKey','__esModule','merchantUrl','shopUrl','1596654ffRMdi','findMany','1634118jJJuzE','gateways','../config/database','updateUser','ACTIVE','status','delete','7217mfxOCy','paymentGateways','shop','crypto','password','hex','generateApiKeys','Telegram\x20username\x20already\x20exists','desc','toString','findUnique','Username\x20already\x20exists','createdAt','pk_','usdcPolygonWallet','4758TINgYK','username','getUserById','randomBytes','stringify','fullName','UserService','16OdhfMY','736563DbNQQh','gatewaySettings','856311LzkPgv','deleteUser','telegram','__importDefault','name','1875250rRzImk','bcryptjs','8jUxYXg','default','parse','hash','update','8263260CisiHd','usdtErcWallet','defineProperty','usdtTrcWallet','usdtPolygonWallet','map','telegramId','wallets'];a51_0x3df8=function(){return _0x19d3b3;};return a51_0x3df8();}const a51_0x173b25=a51_0xe732;(function(_0x249333,_0xdbea50){const _0x21341e=a51_0xe732,_0x16151d=_0x249333();while(!![]){try{const _0x484caf=-parseInt(_0x21341e(0x19b))/0x1+parseInt(_0x21341e(0x17b))/0x2+-parseInt(_0x21341e(0x199))/0x3*(-parseInt(_0x21341e(0x1a2))/0x4)+-parseInt(_0x21341e(0x1a0))/0x5+parseInt(_0x21341e(0x191))/0x6*(-parseInt(_0x21341e(0x182))/0x7)+parseInt(_0x21341e(0x198))/0x8*(parseInt(_0x21341e(0x1b3))/0x9)+parseInt(_0x21341e(0x1a7))/0xa;if(_0x484caf===_0xdbea50)break;else _0x16151d['push'](_0x16151d['shift']());}catch(_0x5e7e2b){_0x16151d['push'](_0x16151d['shift']());}}}(a51_0x3df8,0x6b7e7));var __importDefault=this&&this[a51_0x173b25(0x19e)]||function(_0x3aad51){const _0x79f295=a51_0x173b25;return _0x3aad51&&_0x3aad51[_0x79f295(0x1b0)]?_0x3aad51:{'default':_0x3aad51};};Object[a51_0x173b25(0x1a9)](exports,a51_0x173b25(0x1b0),{'value':!![]}),exports['UserService']=void 0x0;const bcryptjs_1=__importDefault(require(a51_0x173b25(0x1a1))),crypto_1=__importDefault(require(a51_0x173b25(0x185))),database_1=__importDefault(require(a51_0x173b25(0x17d)));function a51_0xe732(_0x241579,_0x3f0437){const _0x3df800=a51_0x3df8();return a51_0xe732=function(_0xe73272,_0x6d7a9e){_0xe73272=_0xe73272-0x17a;let _0x157eab=_0x3df800[_0xe73272];return _0x157eab;},a51_0xe732(_0x241579,_0x3f0437);}class UserService{[a51_0x173b25(0x188)](){const _0x488c74=a51_0x173b25,_0x47097c=_0x488c74(0x18f)+crypto_1[_0x488c74(0x1a3)][_0x488c74(0x194)](0x20)['toString'](_0x488c74(0x187)),_0x33be74='sk_'+crypto_1[_0x488c74(0x1a3)][_0x488c74(0x194)](0x20)[_0x488c74(0x18b)](_0x488c74(0x187));return{'publicKey':_0x47097c,'secretKey':_0x33be74};}async['createUser'](_0x267ed4){const _0x32c979=a51_0x173b25,{fullName:_0x542139,username:_0x12d3f2,password:_0x38b0d2,telegramId:_0x2a7042,merchantUrl:_0xe72999,gateways:_0x4a44b9,gatewaySettings:_0x5ef13a,wallets:_0x2fd2db}=_0x267ed4,_0x362828=await database_1[_0x32c979(0x1a3)][_0x32c979(0x184)]['findUnique']({'where':{'username':_0x12d3f2}});if(_0x362828)throw new Error(_0x32c979(0x18d));if(_0x2a7042){const _0x2979c2=await database_1[_0x32c979(0x1a3)]['shop'][_0x32c979(0x18c)]({'where':{'telegram':_0x2a7042}});if(_0x2979c2)throw new Error(_0x32c979(0x189));}const _0x42fbd2=await bcryptjs_1[_0x32c979(0x1a3)]['hash'](_0x38b0d2,0xc),{publicKey:_0x2a7390,secretKey:_0x49c2e9}=this[_0x32c979(0x188)](),_0x299af5=await database_1[_0x32c979(0x1a3)][_0x32c979(0x184)]['create']({'data':{'name':_0x542139,'username':_0x12d3f2,'password':_0x42fbd2,'telegram':_0x2a7042,'shopUrl':_0xe72999,'paymentGateways':_0x4a44b9?JSON[_0x32c979(0x195)](_0x4a44b9):null,'gatewaySettings':_0x5ef13a?JSON[_0x32c979(0x195)](_0x5ef13a):null,'usdtPolygonWallet':_0x2fd2db?.[_0x32c979(0x1ab)]||null,'usdtTrcWallet':_0x2fd2db?.[_0x32c979(0x1aa)]||null,'usdtErcWallet':_0x2fd2db?.[_0x32c979(0x1a8)]||null,'usdcPolygonWallet':_0x2fd2db?.['usdcPolygonWallet']||null,'publicKey':_0x2a7390,'secretKey':_0x49c2e9,'status':_0x32c979(0x17f)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x299af5['id'],'fullName':_0x299af5[_0x32c979(0x19f)],'username':_0x299af5[_0x32c979(0x192)],'telegramId':_0x299af5[_0x32c979(0x19d)],'merchantUrl':_0x299af5[_0x32c979(0x1b2)],'gateways':_0x299af5['paymentGateways']?JSON['parse'](_0x299af5[_0x32c979(0x183)]):null,'gatewaySettings':_0x299af5[_0x32c979(0x19a)]?JSON[_0x32c979(0x1a4)](_0x299af5['gatewaySettings']):null,'publicKey':_0x299af5[_0x32c979(0x1af)],'wallets':{'usdtPolygonWallet':_0x299af5[_0x32c979(0x1ab)],'usdtTrcWallet':_0x299af5[_0x32c979(0x1aa)],'usdtErcWallet':_0x299af5[_0x32c979(0x1a8)],'usdcPolygonWallet':_0x299af5[_0x32c979(0x190)]},'status':_0x299af5[_0x32c979(0x180)],'createdAt':_0x299af5[_0x32c979(0x18e)]};}async['getAllUsers'](){const _0x27b7d9=a51_0x173b25,_0x44aa96=await database_1[_0x27b7d9(0x1a3)][_0x27b7d9(0x184)][_0x27b7d9(0x17a)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x27b7d9(0x18a)}});return _0x44aa96[_0x27b7d9(0x1ac)](_0x28a4c2=>({'id':_0x28a4c2['id'],'fullName':_0x28a4c2[_0x27b7d9(0x19f)],'username':_0x28a4c2[_0x27b7d9(0x192)],'telegramId':_0x28a4c2[_0x27b7d9(0x19d)],'merchantUrl':_0x28a4c2[_0x27b7d9(0x1b2)],'gateways':_0x28a4c2['paymentGateways']?JSON[_0x27b7d9(0x1a4)](_0x28a4c2[_0x27b7d9(0x183)]):null,'gatewaySettings':_0x28a4c2[_0x27b7d9(0x19a)]?JSON[_0x27b7d9(0x1a4)](_0x28a4c2[_0x27b7d9(0x19a)]):null,'publicKey':_0x28a4c2[_0x27b7d9(0x1af)],'wallets':{'usdtPolygonWallet':_0x28a4c2['usdtPolygonWallet'],'usdtTrcWallet':_0x28a4c2['usdtTrcWallet'],'usdtErcWallet':_0x28a4c2[_0x27b7d9(0x1a8)],'usdcPolygonWallet':_0x28a4c2[_0x27b7d9(0x190)]},'status':_0x28a4c2[_0x27b7d9(0x180)],'createdAt':_0x28a4c2[_0x27b7d9(0x18e)]}));}async[a51_0x173b25(0x193)](_0x3a92fe){const _0x23283e=a51_0x173b25,_0x306ab4=await database_1[_0x23283e(0x1a3)]['shop'][_0x23283e(0x18c)]({'where':{'id':_0x3a92fe},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x306ab4)return null;return{'id':_0x306ab4['id'],'fullName':_0x306ab4['name'],'username':_0x306ab4['username'],'telegramId':_0x306ab4[_0x23283e(0x19d)],'merchantUrl':_0x306ab4[_0x23283e(0x1b2)],'gateways':_0x306ab4[_0x23283e(0x183)]?JSON[_0x23283e(0x1a4)](_0x306ab4[_0x23283e(0x183)]):null,'gatewaySettings':_0x306ab4['gatewaySettings']?JSON['parse'](_0x306ab4[_0x23283e(0x19a)]):null,'publicKey':_0x306ab4[_0x23283e(0x1af)],'wallets':{'usdtPolygonWallet':_0x306ab4[_0x23283e(0x1ab)],'usdtTrcWallet':_0x306ab4['usdtTrcWallet'],'usdtErcWallet':_0x306ab4[_0x23283e(0x1a8)],'usdcPolygonWallet':_0x306ab4[_0x23283e(0x190)]},'status':_0x306ab4['status'],'createdAt':_0x306ab4['createdAt']};}async[a51_0x173b25(0x17e)](_0x3459e3,_0x4937a8){const _0x285eee=a51_0x173b25,_0x1e32bb={..._0x4937a8};_0x4937a8[_0x285eee(0x186)]&&(_0x1e32bb[_0x285eee(0x186)]=await bcryptjs_1[_0x285eee(0x1a3)][_0x285eee(0x1a5)](_0x4937a8[_0x285eee(0x186)],0xc));_0x4937a8[_0x285eee(0x196)]&&(_0x1e32bb[_0x285eee(0x19f)]=_0x4937a8[_0x285eee(0x196)],delete _0x1e32bb[_0x285eee(0x196)]);_0x4937a8[_0x285eee(0x1ad)]&&(_0x1e32bb[_0x285eee(0x19d)]=_0x4937a8['telegramId'],delete _0x1e32bb[_0x285eee(0x1ad)]);_0x4937a8['merchantUrl']&&(_0x1e32bb[_0x285eee(0x1b2)]=_0x4937a8[_0x285eee(0x1b1)],delete _0x1e32bb[_0x285eee(0x1b1)]);_0x4937a8[_0x285eee(0x17c)]&&(_0x1e32bb[_0x285eee(0x183)]=JSON['stringify'](_0x4937a8[_0x285eee(0x17c)]),delete _0x1e32bb['gateways']);_0x4937a8[_0x285eee(0x19a)]&&(_0x1e32bb[_0x285eee(0x19a)]=JSON[_0x285eee(0x195)](_0x4937a8['gatewaySettings']),delete _0x1e32bb[_0x285eee(0x19a)]);_0x4937a8[_0x285eee(0x1ae)]&&(_0x4937a8[_0x285eee(0x1ae)][_0x285eee(0x1ab)]!==undefined&&(_0x1e32bb[_0x285eee(0x1ab)]=_0x4937a8[_0x285eee(0x1ae)]['usdtPolygonWallet']||null),_0x4937a8['wallets'][_0x285eee(0x1aa)]!==undefined&&(_0x1e32bb['usdtTrcWallet']=_0x4937a8[_0x285eee(0x1ae)]['usdtTrcWallet']||null),_0x4937a8[_0x285eee(0x1ae)][_0x285eee(0x1a8)]!==undefined&&(_0x1e32bb['usdtErcWallet']=_0x4937a8[_0x285eee(0x1ae)][_0x285eee(0x1a8)]||null),_0x4937a8[_0x285eee(0x1ae)][_0x285eee(0x190)]!==undefined&&(_0x1e32bb[_0x285eee(0x190)]=_0x4937a8[_0x285eee(0x1ae)][_0x285eee(0x190)]||null),delete _0x1e32bb[_0x285eee(0x1ae)]);const _0x50077b=await database_1['default'][_0x285eee(0x184)][_0x285eee(0x1a6)]({'where':{'id':_0x3459e3},'data':_0x1e32bb,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x50077b['id'],'fullName':_0x50077b[_0x285eee(0x19f)],'username':_0x50077b[_0x285eee(0x192)],'telegramId':_0x50077b[_0x285eee(0x19d)],'merchantUrl':_0x50077b[_0x285eee(0x1b2)],'gateways':_0x50077b[_0x285eee(0x183)]?JSON['parse'](_0x50077b[_0x285eee(0x183)]):null,'gatewaySettings':_0x50077b['gatewaySettings']?JSON[_0x285eee(0x1a4)](_0x50077b[_0x285eee(0x19a)]):null,'publicKey':_0x50077b[_0x285eee(0x1af)],'wallets':{'usdtPolygonWallet':_0x50077b['usdtPolygonWallet'],'usdtTrcWallet':_0x50077b[_0x285eee(0x1aa)],'usdtErcWallet':_0x50077b['usdtErcWallet'],'usdcPolygonWallet':_0x50077b[_0x285eee(0x190)]},'status':_0x50077b[_0x285eee(0x180)],'createdAt':_0x50077b[_0x285eee(0x18e)]};}async[a51_0x173b25(0x19c)](_0xb302a1){const _0x584a65=a51_0x173b25;await database_1[_0x584a65(0x1a3)][_0x584a65(0x184)][_0x584a65(0x181)]({'where':{'id':_0xb302a1}});}}exports[a51_0x173b25(0x197)]=UserService;