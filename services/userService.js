'use strict';const a68_0x3a358b=a68_0x3058;function a68_0x214b(){const _0x296037=['name','delete','paymentGateways','telegramId','gateways','ACTIVE','usdtPolygonWallet','186244dFYtTT','hash','shop','desc','merchantUrl','76771xpuOOT','1196326fftxkP','872637sljoLU','2102748rZSvSd','../config/database','10SsERbf','generateApiKeys','shopUrl','7ZLLjOH','Username\x20already\x20exists','publicKey','randomBytes','wallets','parse','pk_','Telegram\x20username\x20already\x20exists','usdcPolygonWallet','password','bcryptjs','fullName','toString','585ymKMWT','usdtTrcWallet','create','UserService','username','130450DttMMZ','__importDefault','deleteUser','findMany','findUnique','default','getUserById','telegram','gatewaySettings','crypto','createdAt','update','status','stringify','usdtErcWallet','hex','createUser','4215112qRZfgn'];a68_0x214b=function(){return _0x296037;};return a68_0x214b();}(function(_0x50d532,_0x2981e8){const _0x490b6c=a68_0x3058,_0x49a7fc=_0x50d532();while(!![]){try{const _0x46d237=parseInt(_0x490b6c(0x1ec))/0x1+-parseInt(_0x490b6c(0x1ed))/0x2+-parseInt(_0x490b6c(0x1ee))/0x3+parseInt(_0x490b6c(0x1e7))/0x4*(parseInt(_0x490b6c(0x1f1))/0x5)+parseInt(_0x490b6c(0x1ef))/0x6*(-parseInt(_0x490b6c(0x1bc))/0x7)+parseInt(_0x490b6c(0x1df))/0x8+parseInt(_0x490b6c(0x1c9))/0x9*(parseInt(_0x490b6c(0x1ce))/0xa);if(_0x46d237===_0x2981e8)break;else _0x49a7fc['push'](_0x49a7fc['shift']());}catch(_0x45cc82){_0x49a7fc['push'](_0x49a7fc['shift']());}}}(a68_0x214b,0x4a837));var __importDefault=this&&this[a68_0x3a358b(0x1cf)]||function(_0x458c9d){return _0x458c9d&&_0x458c9d['__esModule']?_0x458c9d:{'default':_0x458c9d};};function a68_0x3058(_0x488783,_0x398a21){const _0x214bfb=a68_0x214b();return a68_0x3058=function(_0x30589c,_0x20e3dc){_0x30589c=_0x30589c-0x1bb;let _0x27c3fe=_0x214bfb[_0x30589c];return _0x27c3fe;},a68_0x3058(_0x488783,_0x398a21);}Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a68_0x3a358b(0x1cc)]=void 0x0;const bcryptjs_1=__importDefault(require(a68_0x3a358b(0x1c6))),crypto_1=__importDefault(require(a68_0x3a358b(0x1d7))),database_1=__importDefault(require(a68_0x3a358b(0x1f0)));class UserService{[a68_0x3a358b(0x1f2)](){const _0x2aff07=a68_0x3a358b,_0x2de020=_0x2aff07(0x1c2)+crypto_1[_0x2aff07(0x1d3)][_0x2aff07(0x1bf)](0x20)[_0x2aff07(0x1c8)](_0x2aff07(0x1dd)),_0x5d9516='sk_'+crypto_1[_0x2aff07(0x1d3)][_0x2aff07(0x1bf)](0x20)['toString'](_0x2aff07(0x1dd));return{'publicKey':_0x2de020,'secretKey':_0x5d9516};}async[a68_0x3a358b(0x1de)](_0xe1ddc0){const _0x5c26bb=a68_0x3a358b,{fullName:_0x4f0011,username:_0x89874c,password:_0x59de25,telegramId:_0x186efe,merchantUrl:_0xcd494b,gateways:_0x295597,gatewaySettings:_0x5617d6,wallets:_0x588f2f}=_0xe1ddc0,_0x5f1c5e=await database_1['default'][_0x5c26bb(0x1e9)][_0x5c26bb(0x1d2)]({'where':{'username':_0x89874c}});if(_0x5f1c5e)throw new Error(_0x5c26bb(0x1bd));if(_0x186efe){const _0x1bca13=await database_1[_0x5c26bb(0x1d3)]['shop']['findUnique']({'where':{'telegram':_0x186efe}});if(_0x1bca13)throw new Error(_0x5c26bb(0x1c3));}const _0x4e05e7=await bcryptjs_1[_0x5c26bb(0x1d3)]['hash'](_0x59de25,0xc),{publicKey:_0x23bfee,secretKey:_0x3b90f1}=this[_0x5c26bb(0x1f2)](),_0x4c87ff=await database_1[_0x5c26bb(0x1d3)][_0x5c26bb(0x1e9)][_0x5c26bb(0x1cb)]({'data':{'name':_0x4f0011,'username':_0x89874c,'password':_0x4e05e7,'telegram':_0x186efe,'shopUrl':_0xcd494b,'paymentGateways':_0x295597?JSON[_0x5c26bb(0x1db)](_0x295597):null,'gatewaySettings':_0x5617d6?JSON['stringify'](_0x5617d6):null,'usdtPolygonWallet':_0x588f2f?.['usdtPolygonWallet']||null,'usdtTrcWallet':_0x588f2f?.[_0x5c26bb(0x1ca)]||null,'usdtErcWallet':_0x588f2f?.[_0x5c26bb(0x1dc)]||null,'usdcPolygonWallet':_0x588f2f?.[_0x5c26bb(0x1c4)]||null,'publicKey':_0x23bfee,'secretKey':_0x3b90f1,'status':_0x5c26bb(0x1e5)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x4c87ff['id'],'fullName':_0x4c87ff[_0x5c26bb(0x1e0)],'username':_0x4c87ff['username'],'telegramId':_0x4c87ff['telegram'],'merchantUrl':_0x4c87ff['shopUrl'],'gateways':_0x4c87ff[_0x5c26bb(0x1e2)]?JSON[_0x5c26bb(0x1c1)](_0x4c87ff[_0x5c26bb(0x1e2)]):null,'gatewaySettings':_0x4c87ff[_0x5c26bb(0x1d6)]?JSON['parse'](_0x4c87ff[_0x5c26bb(0x1d6)]):null,'publicKey':_0x4c87ff[_0x5c26bb(0x1be)],'wallets':{'usdtPolygonWallet':_0x4c87ff[_0x5c26bb(0x1e6)],'usdtTrcWallet':_0x4c87ff[_0x5c26bb(0x1ca)],'usdtErcWallet':_0x4c87ff[_0x5c26bb(0x1dc)],'usdcPolygonWallet':_0x4c87ff['usdcPolygonWallet']},'status':_0x4c87ff['status'],'createdAt':_0x4c87ff[_0x5c26bb(0x1d8)]};}async['getAllUsers'](){const _0x128eb2=a68_0x3a358b,_0x3a6b2e=await database_1[_0x128eb2(0x1d3)][_0x128eb2(0x1e9)][_0x128eb2(0x1d1)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x128eb2(0x1ea)}});return _0x3a6b2e['map'](_0x48c643=>({'id':_0x48c643['id'],'fullName':_0x48c643[_0x128eb2(0x1e0)],'username':_0x48c643[_0x128eb2(0x1cd)],'telegramId':_0x48c643['telegram'],'merchantUrl':_0x48c643[_0x128eb2(0x1bb)],'gateways':_0x48c643[_0x128eb2(0x1e2)]?JSON['parse'](_0x48c643[_0x128eb2(0x1e2)]):null,'gatewaySettings':_0x48c643[_0x128eb2(0x1d6)]?JSON['parse'](_0x48c643[_0x128eb2(0x1d6)]):null,'publicKey':_0x48c643[_0x128eb2(0x1be)],'wallets':{'usdtPolygonWallet':_0x48c643[_0x128eb2(0x1e6)],'usdtTrcWallet':_0x48c643['usdtTrcWallet'],'usdtErcWallet':_0x48c643[_0x128eb2(0x1dc)],'usdcPolygonWallet':_0x48c643[_0x128eb2(0x1c4)]},'status':_0x48c643[_0x128eb2(0x1da)],'createdAt':_0x48c643['createdAt']}));}async[a68_0x3a358b(0x1d4)](_0x575498){const _0x4ee144=a68_0x3a358b,_0x171f8b=await database_1[_0x4ee144(0x1d3)][_0x4ee144(0x1e9)][_0x4ee144(0x1d2)]({'where':{'id':_0x575498},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x171f8b)return null;return{'id':_0x171f8b['id'],'fullName':_0x171f8b[_0x4ee144(0x1e0)],'username':_0x171f8b[_0x4ee144(0x1cd)],'telegramId':_0x171f8b[_0x4ee144(0x1d5)],'merchantUrl':_0x171f8b[_0x4ee144(0x1bb)],'gateways':_0x171f8b[_0x4ee144(0x1e2)]?JSON['parse'](_0x171f8b[_0x4ee144(0x1e2)]):null,'gatewaySettings':_0x171f8b[_0x4ee144(0x1d6)]?JSON[_0x4ee144(0x1c1)](_0x171f8b[_0x4ee144(0x1d6)]):null,'publicKey':_0x171f8b['publicKey'],'wallets':{'usdtPolygonWallet':_0x171f8b[_0x4ee144(0x1e6)],'usdtTrcWallet':_0x171f8b[_0x4ee144(0x1ca)],'usdtErcWallet':_0x171f8b['usdtErcWallet'],'usdcPolygonWallet':_0x171f8b[_0x4ee144(0x1c4)]},'status':_0x171f8b['status'],'createdAt':_0x171f8b[_0x4ee144(0x1d8)]};}async['updateUser'](_0x2ea746,_0x30b057){const _0x4a55fb=a68_0x3a358b,_0x5603e9={..._0x30b057};_0x30b057[_0x4a55fb(0x1c5)]&&(_0x5603e9[_0x4a55fb(0x1c5)]=await bcryptjs_1[_0x4a55fb(0x1d3)][_0x4a55fb(0x1e8)](_0x30b057[_0x4a55fb(0x1c5)],0xc));_0x30b057[_0x4a55fb(0x1c7)]&&(_0x5603e9[_0x4a55fb(0x1e0)]=_0x30b057[_0x4a55fb(0x1c7)],delete _0x5603e9['fullName']);_0x30b057[_0x4a55fb(0x1e3)]&&(_0x5603e9[_0x4a55fb(0x1d5)]=_0x30b057[_0x4a55fb(0x1e3)],delete _0x5603e9[_0x4a55fb(0x1e3)]);_0x30b057[_0x4a55fb(0x1eb)]&&(_0x5603e9[_0x4a55fb(0x1bb)]=_0x30b057['merchantUrl'],delete _0x5603e9[_0x4a55fb(0x1eb)]);_0x30b057[_0x4a55fb(0x1e4)]&&(_0x5603e9[_0x4a55fb(0x1e2)]=JSON[_0x4a55fb(0x1db)](_0x30b057[_0x4a55fb(0x1e4)]),delete _0x5603e9['gateways']);_0x30b057['gatewaySettings']&&(_0x5603e9[_0x4a55fb(0x1d6)]=JSON[_0x4a55fb(0x1db)](_0x30b057[_0x4a55fb(0x1d6)]),delete _0x5603e9[_0x4a55fb(0x1d6)]);_0x30b057[_0x4a55fb(0x1c0)]&&(_0x30b057[_0x4a55fb(0x1c0)]['usdtPolygonWallet']!==undefined&&(_0x5603e9[_0x4a55fb(0x1e6)]=_0x30b057[_0x4a55fb(0x1c0)][_0x4a55fb(0x1e6)]||null),_0x30b057[_0x4a55fb(0x1c0)][_0x4a55fb(0x1ca)]!==undefined&&(_0x5603e9[_0x4a55fb(0x1ca)]=_0x30b057[_0x4a55fb(0x1c0)][_0x4a55fb(0x1ca)]||null),_0x30b057[_0x4a55fb(0x1c0)]['usdtErcWallet']!==undefined&&(_0x5603e9[_0x4a55fb(0x1dc)]=_0x30b057[_0x4a55fb(0x1c0)][_0x4a55fb(0x1dc)]||null),_0x30b057['wallets'][_0x4a55fb(0x1c4)]!==undefined&&(_0x5603e9['usdcPolygonWallet']=_0x30b057['wallets'][_0x4a55fb(0x1c4)]||null),delete _0x5603e9[_0x4a55fb(0x1c0)]);const _0x125846=await database_1[_0x4a55fb(0x1d3)][_0x4a55fb(0x1e9)][_0x4a55fb(0x1d9)]({'where':{'id':_0x2ea746},'data':_0x5603e9,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x125846['id'],'fullName':_0x125846[_0x4a55fb(0x1e0)],'username':_0x125846['username'],'telegramId':_0x125846[_0x4a55fb(0x1d5)],'merchantUrl':_0x125846[_0x4a55fb(0x1bb)],'gateways':_0x125846[_0x4a55fb(0x1e2)]?JSON['parse'](_0x125846['paymentGateways']):null,'gatewaySettings':_0x125846[_0x4a55fb(0x1d6)]?JSON['parse'](_0x125846[_0x4a55fb(0x1d6)]):null,'publicKey':_0x125846[_0x4a55fb(0x1be)],'wallets':{'usdtPolygonWallet':_0x125846[_0x4a55fb(0x1e6)],'usdtTrcWallet':_0x125846['usdtTrcWallet'],'usdtErcWallet':_0x125846[_0x4a55fb(0x1dc)],'usdcPolygonWallet':_0x125846[_0x4a55fb(0x1c4)]},'status':_0x125846['status'],'createdAt':_0x125846['createdAt']};}async[a68_0x3a358b(0x1d0)](_0x47e7d4){const _0x594d0d=a68_0x3a358b;await database_1['default'][_0x594d0d(0x1e9)][_0x594d0d(0x1e1)]({'where':{'id':_0x47e7d4}});}}exports[a68_0x3a358b(0x1cc)]=UserService;