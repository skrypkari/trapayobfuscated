'use strict';const a63_0x2a98a6=a63_0x9cea;(function(_0x490f00,_0x3bc378){const _0x2b7a24=a63_0x9cea,_0x31c5e9=_0x490f00();while(!![]){try{const _0x16412a=-parseInt(_0x2b7a24(0x124))/0x1+parseInt(_0x2b7a24(0x120))/0x2*(-parseInt(_0x2b7a24(0x131))/0x3)+-parseInt(_0x2b7a24(0x111))/0x4+parseInt(_0x2b7a24(0xfa))/0x5+-parseInt(_0x2b7a24(0x10b))/0x6*(parseInt(_0x2b7a24(0x12c))/0x7)+-parseInt(_0x2b7a24(0xf9))/0x8+-parseInt(_0x2b7a24(0xf8))/0x9*(-parseInt(_0x2b7a24(0x126))/0xa);if(_0x16412a===_0x3bc378)break;else _0x31c5e9['push'](_0x31c5e9['shift']());}catch(_0x25d327){_0x31c5e9['push'](_0x31c5e9['shift']());}}}(a63_0x1f7b,0xf342e));function a63_0x9cea(_0x303b42,_0x4faf95){const _0x1f7b5a=a63_0x1f7b();return a63_0x9cea=function(_0x9cea9c,_0x3b22d8){_0x9cea9c=_0x9cea9c-0xf8;let _0x4a1cd1=_0x1f7b5a[_0x9cea9c];return _0x4a1cd1;},a63_0x9cea(_0x303b42,_0x4faf95);}var __importDefault=this&&this[a63_0x2a98a6(0x128)]||function(_0x5c513f){return _0x5c513f&&_0x5c513f['__esModule']?_0x5c513f:{'default':_0x5c513f};};Object[a63_0x2a98a6(0x12f)](exports,'__esModule',{'value':!![]}),exports[a63_0x2a98a6(0xfd)]=void 0x0;const bcryptjs_1=__importDefault(require(a63_0x2a98a6(0x119))),crypto_1=__importDefault(require(a63_0x2a98a6(0xfb))),database_1=__importDefault(require('../config/database'));class UserService{['generateApiKeys'](){const _0x2a6a73=a63_0x2a98a6,_0x3390c7=_0x2a6a73(0x12e)+crypto_1[_0x2a6a73(0x129)][_0x2a6a73(0x115)](0x20)[_0x2a6a73(0x10f)]('hex'),_0x3b7fae=_0x2a6a73(0x125)+crypto_1[_0x2a6a73(0x129)]['randomBytes'](0x20)[_0x2a6a73(0x10f)](_0x2a6a73(0x11f));return{'publicKey':_0x3390c7,'secretKey':_0x3b7fae};}async[a63_0x2a98a6(0xfe)](_0x53a00c){const _0xd02a35=a63_0x2a98a6,{fullName:_0x4f10b9,username:_0x5b8e02,password:_0xe3b00d,telegramId:_0x45a9f5,merchantUrl:_0x365839,gateways:_0x3b53c9,gatewaySettings:_0x50f79a,wallets:_0x1d2f50}=_0x53a00c,_0x39f324=await database_1[_0xd02a35(0x129)]['shop']['findUnique']({'where':{'username':_0x5b8e02}});if(_0x39f324)throw new Error('Username\x20already\x20exists');if(_0x45a9f5){const _0x10a62c=await database_1['default'][_0xd02a35(0x10e)]['findUnique']({'where':{'telegram':_0x45a9f5}});if(_0x10a62c)throw new Error(_0xd02a35(0x11a));}const _0x556aaf=await bcryptjs_1[_0xd02a35(0x129)][_0xd02a35(0x114)](_0xe3b00d,0xc),{publicKey:_0x1175f7,secretKey:_0x183b2b}=this[_0xd02a35(0xff)](),_0x56bbcd=await database_1['default'][_0xd02a35(0x10e)]['create']({'data':{'name':_0x4f10b9,'username':_0x5b8e02,'password':_0x556aaf,'telegram':_0x45a9f5,'shopUrl':_0x365839,'paymentGateways':_0x3b53c9?JSON[_0xd02a35(0x100)](_0x3b53c9):null,'gatewaySettings':_0x50f79a?JSON[_0xd02a35(0x100)](_0x50f79a):null,'usdtPolygonWallet':_0x1d2f50?.[_0xd02a35(0x104)]||null,'usdtTrcWallet':_0x1d2f50?.['usdtTrcWallet']||null,'usdtErcWallet':_0x1d2f50?.[_0xd02a35(0x106)]||null,'usdcPolygonWallet':_0x1d2f50?.['usdcPolygonWallet']||null,'publicKey':_0x1175f7,'secretKey':_0x183b2b,'status':_0xd02a35(0x107)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x56bbcd['id'],'fullName':_0x56bbcd[_0xd02a35(0x103)],'username':_0x56bbcd[_0xd02a35(0x10a)],'telegramId':_0x56bbcd[_0xd02a35(0x10d)],'merchantUrl':_0x56bbcd[_0xd02a35(0xfc)],'gateways':_0x56bbcd[_0xd02a35(0x127)]?JSON[_0xd02a35(0x105)](_0x56bbcd[_0xd02a35(0x127)]):null,'gatewaySettings':_0x56bbcd['gatewaySettings']?JSON[_0xd02a35(0x105)](_0x56bbcd[_0xd02a35(0x102)]):null,'publicKey':_0x56bbcd['publicKey'],'wallets':{'usdtPolygonWallet':_0x56bbcd['usdtPolygonWallet'],'usdtTrcWallet':_0x56bbcd[_0xd02a35(0x122)],'usdtErcWallet':_0x56bbcd[_0xd02a35(0x106)],'usdcPolygonWallet':_0x56bbcd[_0xd02a35(0x11b)]},'status':_0x56bbcd[_0xd02a35(0x11d)],'createdAt':_0x56bbcd[_0xd02a35(0x123)]};}async[a63_0x2a98a6(0x112)](){const _0xf97ffc=a63_0x2a98a6,_0x511c7a=await database_1[_0xf97ffc(0x129)][_0xf97ffc(0x10e)][_0xf97ffc(0x118)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0xf97ffc(0x110)}});return _0x511c7a[_0xf97ffc(0x11e)](_0x3a52cd=>({'id':_0x3a52cd['id'],'fullName':_0x3a52cd['name'],'username':_0x3a52cd[_0xf97ffc(0x10a)],'telegramId':_0x3a52cd[_0xf97ffc(0x10d)],'merchantUrl':_0x3a52cd[_0xf97ffc(0xfc)],'gateways':_0x3a52cd['paymentGateways']?JSON['parse'](_0x3a52cd[_0xf97ffc(0x127)]):null,'gatewaySettings':_0x3a52cd['gatewaySettings']?JSON[_0xf97ffc(0x105)](_0x3a52cd[_0xf97ffc(0x102)]):null,'publicKey':_0x3a52cd['publicKey'],'wallets':{'usdtPolygonWallet':_0x3a52cd[_0xf97ffc(0x104)],'usdtTrcWallet':_0x3a52cd['usdtTrcWallet'],'usdtErcWallet':_0x3a52cd[_0xf97ffc(0x106)],'usdcPolygonWallet':_0x3a52cd['usdcPolygonWallet']},'status':_0x3a52cd[_0xf97ffc(0x11d)],'createdAt':_0x3a52cd[_0xf97ffc(0x123)]}));}async[a63_0x2a98a6(0x121)](_0x5f24ce){const _0x3558a9=a63_0x2a98a6,_0x1ec495=await database_1[_0x3558a9(0x129)]['shop'][_0x3558a9(0x12a)]({'where':{'id':_0x5f24ce},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x1ec495)return null;return{'id':_0x1ec495['id'],'fullName':_0x1ec495[_0x3558a9(0x103)],'username':_0x1ec495[_0x3558a9(0x10a)],'telegramId':_0x1ec495[_0x3558a9(0x10d)],'merchantUrl':_0x1ec495[_0x3558a9(0xfc)],'gateways':_0x1ec495[_0x3558a9(0x127)]?JSON['parse'](_0x1ec495[_0x3558a9(0x127)]):null,'gatewaySettings':_0x1ec495[_0x3558a9(0x102)]?JSON[_0x3558a9(0x105)](_0x1ec495['gatewaySettings']):null,'publicKey':_0x1ec495[_0x3558a9(0x10c)],'wallets':{'usdtPolygonWallet':_0x1ec495[_0x3558a9(0x104)],'usdtTrcWallet':_0x1ec495['usdtTrcWallet'],'usdtErcWallet':_0x1ec495[_0x3558a9(0x106)],'usdcPolygonWallet':_0x1ec495[_0x3558a9(0x11b)]},'status':_0x1ec495[_0x3558a9(0x11d)],'createdAt':_0x1ec495[_0x3558a9(0x123)]};}async[a63_0x2a98a6(0x117)](_0x2390c6,_0x23dda9){const _0x42ca2d=a63_0x2a98a6,_0x418593={..._0x23dda9};_0x23dda9[_0x42ca2d(0x108)]&&(_0x418593[_0x42ca2d(0x108)]=await bcryptjs_1[_0x42ca2d(0x129)][_0x42ca2d(0x114)](_0x23dda9[_0x42ca2d(0x108)],0xc));_0x23dda9[_0x42ca2d(0x12b)]&&(_0x418593['name']=_0x23dda9[_0x42ca2d(0x12b)],delete _0x418593[_0x42ca2d(0x12b)]);_0x23dda9[_0x42ca2d(0x109)]&&(_0x418593[_0x42ca2d(0x10d)]=_0x23dda9[_0x42ca2d(0x109)],delete _0x418593[_0x42ca2d(0x109)]);_0x23dda9[_0x42ca2d(0x11c)]&&(_0x418593[_0x42ca2d(0xfc)]=_0x23dda9[_0x42ca2d(0x11c)],delete _0x418593[_0x42ca2d(0x11c)]);_0x23dda9[_0x42ca2d(0x101)]&&(_0x418593['paymentGateways']=JSON['stringify'](_0x23dda9[_0x42ca2d(0x101)]),delete _0x418593['gateways']);_0x23dda9['gatewaySettings']&&(_0x418593['gatewaySettings']=JSON[_0x42ca2d(0x100)](_0x23dda9[_0x42ca2d(0x102)]),delete _0x418593['gatewaySettings']);_0x23dda9[_0x42ca2d(0x130)]&&(_0x23dda9['wallets'][_0x42ca2d(0x104)]!==undefined&&(_0x418593['usdtPolygonWallet']=_0x23dda9[_0x42ca2d(0x130)][_0x42ca2d(0x104)]||null),_0x23dda9[_0x42ca2d(0x130)][_0x42ca2d(0x122)]!==undefined&&(_0x418593[_0x42ca2d(0x122)]=_0x23dda9[_0x42ca2d(0x130)][_0x42ca2d(0x122)]||null),_0x23dda9[_0x42ca2d(0x130)][_0x42ca2d(0x106)]!==undefined&&(_0x418593[_0x42ca2d(0x106)]=_0x23dda9['wallets']['usdtErcWallet']||null),_0x23dda9[_0x42ca2d(0x130)][_0x42ca2d(0x11b)]!==undefined&&(_0x418593[_0x42ca2d(0x11b)]=_0x23dda9[_0x42ca2d(0x130)][_0x42ca2d(0x11b)]||null),delete _0x418593[_0x42ca2d(0x130)]);const _0x590b46=await database_1[_0x42ca2d(0x129)]['shop'][_0x42ca2d(0x12d)]({'where':{'id':_0x2390c6},'data':_0x418593,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x590b46['id'],'fullName':_0x590b46[_0x42ca2d(0x103)],'username':_0x590b46['username'],'telegramId':_0x590b46[_0x42ca2d(0x10d)],'merchantUrl':_0x590b46['shopUrl'],'gateways':_0x590b46[_0x42ca2d(0x127)]?JSON[_0x42ca2d(0x105)](_0x590b46[_0x42ca2d(0x127)]):null,'gatewaySettings':_0x590b46[_0x42ca2d(0x102)]?JSON[_0x42ca2d(0x105)](_0x590b46[_0x42ca2d(0x102)]):null,'publicKey':_0x590b46[_0x42ca2d(0x10c)],'wallets':{'usdtPolygonWallet':_0x590b46[_0x42ca2d(0x104)],'usdtTrcWallet':_0x590b46[_0x42ca2d(0x122)],'usdtErcWallet':_0x590b46['usdtErcWallet'],'usdcPolygonWallet':_0x590b46[_0x42ca2d(0x11b)]},'status':_0x590b46['status'],'createdAt':_0x590b46['createdAt']};}async[a63_0x2a98a6(0x113)](_0xa73a6c){const _0x4d2ec1=a63_0x2a98a6;await database_1['default'][_0x4d2ec1(0x10e)][_0x4d2ec1(0x116)]({'where':{'id':_0xa73a6c}});}}function a63_0x1f7b(){const _0x3cfc15=['hash','randomBytes','delete','updateUser','findMany','bcryptjs','Telegram\x20username\x20already\x20exists','usdcPolygonWallet','merchantUrl','status','map','hex','2970542jtKryd','getUserById','usdtTrcWallet','createdAt','1512994hvkmSC','sk_','30YRJQxK','paymentGateways','__importDefault','default','findUnique','fullName','14znSund','update','pk_','defineProperty','wallets','3zDtTrb','19680345HqzzeX','10731816NDIcaH','7735665gcojIe','crypto','shopUrl','UserService','createUser','generateApiKeys','stringify','gateways','gatewaySettings','name','usdtPolygonWallet','parse','usdtErcWallet','ACTIVE','password','telegramId','username','5789208XAjzbo','publicKey','telegram','shop','toString','desc','3365488vpfXDL','getAllUsers','deleteUser'];a63_0x1f7b=function(){return _0x3cfc15;};return a63_0x1f7b();}exports[a63_0x2a98a6(0xfd)]=UserService;