'use strict';function a51_0x3556(){const _0x12327d=['hash','status','generateApiKeys','telegram','__esModule','hex','36hHtgIu','gateways','usdtPolygonWallet','531zXacSc','getUserById','name','updateUser','crypto','usdtErcWallet','findMany','shopUrl','ACTIVE','2176bkVcwK','5850xPxrbp','10SZHtlF','update','default','delete','sk_','4862ZCgOMI','UserService','pk_','usdtTrcWallet','username','password','findUnique','defineProperty','createdAt','deleteUser','create','2898930gBrmgP','telegramId','85430dqYbFC','merchantUrl','desc','bcryptjs','gatewaySettings','usdcPolygonWallet','fullName','../config/database','324776fmnsRR','publicKey','133uDqBBz','paymentGateways','parse','stringify','shop','35652kyDDpV','createUser','wallets','randomBytes','175976BifdPH'];a51_0x3556=function(){return _0x12327d;};return a51_0x3556();}const a51_0x5f2d5b=a51_0x32cc;(function(_0x382c2d,_0x23a9e5){const _0x526219=a51_0x32cc,_0x1fa303=_0x382c2d();while(!![]){try{const _0x10ddc0=-parseInt(_0x526219(0x1c1))/0x1+-parseInt(_0x526219(0x1c2))/0x2*(-parseInt(_0x526219(0x1b8))/0x3)+parseInt(_0x526219(0x1dd))/0x4*(parseInt(_0x526219(0x1c3))/0x5)+parseInt(_0x526219(0x1d3))/0x6+parseInt(_0x526219(0x1df))/0x7*(parseInt(_0x526219(0x1ae))/0x8)+-parseInt(_0x526219(0x1b5))/0x9*(-parseInt(_0x526219(0x1d5))/0xa)+parseInt(_0x526219(0x1c8))/0xb*(-parseInt(_0x526219(0x1e4))/0xc);if(_0x10ddc0===_0x23a9e5)break;else _0x1fa303['push'](_0x1fa303['shift']());}catch(_0x3535a3){_0x1fa303['push'](_0x1fa303['shift']());}}}(a51_0x3556,0x493f9));var __importDefault=this&&this['__importDefault']||function(_0x4b04e2){const _0x125447=a51_0x32cc;return _0x4b04e2&&_0x4b04e2[_0x125447(0x1b3)]?_0x4b04e2:{'default':_0x4b04e2};};function a51_0x32cc(_0x3c783d,_0x432874){const _0x35568a=a51_0x3556();return a51_0x32cc=function(_0x32ccc1,_0x3b2712){_0x32ccc1=_0x32ccc1-0x1ab;let _0x5eb643=_0x35568a[_0x32ccc1];return _0x5eb643;},a51_0x32cc(_0x3c783d,_0x432874);}Object[a51_0x5f2d5b(0x1cf)](exports,'__esModule',{'value':!![]}),exports[a51_0x5f2d5b(0x1c9)]=void 0x0;const bcryptjs_1=__importDefault(require(a51_0x5f2d5b(0x1d8))),crypto_1=__importDefault(require(a51_0x5f2d5b(0x1bc))),database_1=__importDefault(require(a51_0x5f2d5b(0x1dc)));class UserService{[a51_0x5f2d5b(0x1b1)](){const _0xddd9a9=a51_0x5f2d5b,_0x1c7e37=_0xddd9a9(0x1ca)+crypto_1[_0xddd9a9(0x1c5)][_0xddd9a9(0x1ad)](0x20)['toString']('hex'),_0xbb780a=_0xddd9a9(0x1c7)+crypto_1['default'][_0xddd9a9(0x1ad)](0x20)['toString'](_0xddd9a9(0x1b4));return{'publicKey':_0x1c7e37,'secretKey':_0xbb780a};}async[a51_0x5f2d5b(0x1ab)](_0x448853){const _0x44efad=a51_0x5f2d5b,{fullName:_0x4ca1f5,username:_0x352b20,password:_0x403d07,telegramId:_0x15eea9,merchantUrl:_0x31c72d,gateways:_0x366cf2,gatewaySettings:_0x5b13ac,wallets:_0x3cefe4}=_0x448853,_0x1f2f45=await database_1['default'][_0x44efad(0x1e3)][_0x44efad(0x1ce)]({'where':{'username':_0x352b20}});if(_0x1f2f45)throw new Error('Username\x20already\x20exists');if(_0x15eea9){const _0x272821=await database_1[_0x44efad(0x1c5)][_0x44efad(0x1e3)]['findUnique']({'where':{'telegram':_0x15eea9}});if(_0x272821)throw new Error('Telegram\x20username\x20already\x20exists');}const _0x4cb1fb=await bcryptjs_1[_0x44efad(0x1c5)][_0x44efad(0x1af)](_0x403d07,0xc),{publicKey:_0x12a406,secretKey:_0x2b726b}=this[_0x44efad(0x1b1)](),_0x5328a7=await database_1['default']['shop'][_0x44efad(0x1d2)]({'data':{'name':_0x4ca1f5,'username':_0x352b20,'password':_0x4cb1fb,'telegram':_0x15eea9,'shopUrl':_0x31c72d,'paymentGateways':_0x366cf2?JSON[_0x44efad(0x1e2)](_0x366cf2):null,'gatewaySettings':_0x5b13ac?JSON[_0x44efad(0x1e2)](_0x5b13ac):null,'usdtPolygonWallet':_0x3cefe4?.[_0x44efad(0x1b7)]||null,'usdtTrcWallet':_0x3cefe4?.['usdtTrcWallet']||null,'usdtErcWallet':_0x3cefe4?.[_0x44efad(0x1bd)]||null,'usdcPolygonWallet':_0x3cefe4?.[_0x44efad(0x1da)]||null,'publicKey':_0x12a406,'secretKey':_0x2b726b,'status':_0x44efad(0x1c0)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x5328a7['id'],'fullName':_0x5328a7[_0x44efad(0x1ba)],'username':_0x5328a7['username'],'telegramId':_0x5328a7['telegram'],'merchantUrl':_0x5328a7[_0x44efad(0x1bf)],'gateways':_0x5328a7[_0x44efad(0x1e0)]?JSON[_0x44efad(0x1e1)](_0x5328a7[_0x44efad(0x1e0)]):null,'gatewaySettings':_0x5328a7[_0x44efad(0x1d9)]?JSON[_0x44efad(0x1e1)](_0x5328a7[_0x44efad(0x1d9)]):null,'publicKey':_0x5328a7['publicKey'],'wallets':{'usdtPolygonWallet':_0x5328a7[_0x44efad(0x1b7)],'usdtTrcWallet':_0x5328a7[_0x44efad(0x1cb)],'usdtErcWallet':_0x5328a7['usdtErcWallet'],'usdcPolygonWallet':_0x5328a7['usdcPolygonWallet']},'status':_0x5328a7[_0x44efad(0x1b0)],'createdAt':_0x5328a7[_0x44efad(0x1d0)]};}async['getAllUsers'](){const _0x540ccf=a51_0x5f2d5b,_0x2b6e67=await database_1[_0x540ccf(0x1c5)][_0x540ccf(0x1e3)][_0x540ccf(0x1be)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x540ccf(0x1d7)}});return _0x2b6e67['map'](_0x180a3f=>({'id':_0x180a3f['id'],'fullName':_0x180a3f[_0x540ccf(0x1ba)],'username':_0x180a3f[_0x540ccf(0x1cc)],'telegramId':_0x180a3f[_0x540ccf(0x1b2)],'merchantUrl':_0x180a3f[_0x540ccf(0x1bf)],'gateways':_0x180a3f[_0x540ccf(0x1e0)]?JSON[_0x540ccf(0x1e1)](_0x180a3f[_0x540ccf(0x1e0)]):null,'gatewaySettings':_0x180a3f['gatewaySettings']?JSON[_0x540ccf(0x1e1)](_0x180a3f[_0x540ccf(0x1d9)]):null,'publicKey':_0x180a3f[_0x540ccf(0x1de)],'wallets':{'usdtPolygonWallet':_0x180a3f[_0x540ccf(0x1b7)],'usdtTrcWallet':_0x180a3f[_0x540ccf(0x1cb)],'usdtErcWallet':_0x180a3f[_0x540ccf(0x1bd)],'usdcPolygonWallet':_0x180a3f['usdcPolygonWallet']},'status':_0x180a3f[_0x540ccf(0x1b0)],'createdAt':_0x180a3f[_0x540ccf(0x1d0)]}));}async[a51_0x5f2d5b(0x1b9)](_0x20432c){const _0x266e49=a51_0x5f2d5b,_0xade236=await database_1[_0x266e49(0x1c5)][_0x266e49(0x1e3)][_0x266e49(0x1ce)]({'where':{'id':_0x20432c},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0xade236)return null;return{'id':_0xade236['id'],'fullName':_0xade236[_0x266e49(0x1ba)],'username':_0xade236[_0x266e49(0x1cc)],'telegramId':_0xade236[_0x266e49(0x1b2)],'merchantUrl':_0xade236[_0x266e49(0x1bf)],'gateways':_0xade236[_0x266e49(0x1e0)]?JSON[_0x266e49(0x1e1)](_0xade236[_0x266e49(0x1e0)]):null,'gatewaySettings':_0xade236[_0x266e49(0x1d9)]?JSON[_0x266e49(0x1e1)](_0xade236[_0x266e49(0x1d9)]):null,'publicKey':_0xade236['publicKey'],'wallets':{'usdtPolygonWallet':_0xade236[_0x266e49(0x1b7)],'usdtTrcWallet':_0xade236[_0x266e49(0x1cb)],'usdtErcWallet':_0xade236[_0x266e49(0x1bd)],'usdcPolygonWallet':_0xade236['usdcPolygonWallet']},'status':_0xade236[_0x266e49(0x1b0)],'createdAt':_0xade236[_0x266e49(0x1d0)]};}async[a51_0x5f2d5b(0x1bb)](_0x115e64,_0x3d85e5){const _0x114186=a51_0x5f2d5b,_0x39000e={..._0x3d85e5};_0x3d85e5[_0x114186(0x1cd)]&&(_0x39000e[_0x114186(0x1cd)]=await bcryptjs_1['default'][_0x114186(0x1af)](_0x3d85e5['password'],0xc));_0x3d85e5['fullName']&&(_0x39000e['name']=_0x3d85e5['fullName'],delete _0x39000e[_0x114186(0x1db)]);_0x3d85e5[_0x114186(0x1d4)]&&(_0x39000e[_0x114186(0x1b2)]=_0x3d85e5[_0x114186(0x1d4)],delete _0x39000e[_0x114186(0x1d4)]);_0x3d85e5[_0x114186(0x1d6)]&&(_0x39000e['shopUrl']=_0x3d85e5[_0x114186(0x1d6)],delete _0x39000e[_0x114186(0x1d6)]);_0x3d85e5[_0x114186(0x1b6)]&&(_0x39000e[_0x114186(0x1e0)]=JSON[_0x114186(0x1e2)](_0x3d85e5['gateways']),delete _0x39000e[_0x114186(0x1b6)]);_0x3d85e5[_0x114186(0x1d9)]&&(_0x39000e[_0x114186(0x1d9)]=JSON[_0x114186(0x1e2)](_0x3d85e5[_0x114186(0x1d9)]),delete _0x39000e[_0x114186(0x1d9)]);_0x3d85e5[_0x114186(0x1ac)]&&(_0x3d85e5[_0x114186(0x1ac)]['usdtPolygonWallet']!==undefined&&(_0x39000e[_0x114186(0x1b7)]=_0x3d85e5[_0x114186(0x1ac)]['usdtPolygonWallet']||null),_0x3d85e5[_0x114186(0x1ac)]['usdtTrcWallet']!==undefined&&(_0x39000e[_0x114186(0x1cb)]=_0x3d85e5[_0x114186(0x1ac)][_0x114186(0x1cb)]||null),_0x3d85e5['wallets'][_0x114186(0x1bd)]!==undefined&&(_0x39000e[_0x114186(0x1bd)]=_0x3d85e5[_0x114186(0x1ac)][_0x114186(0x1bd)]||null),_0x3d85e5[_0x114186(0x1ac)][_0x114186(0x1da)]!==undefined&&(_0x39000e[_0x114186(0x1da)]=_0x3d85e5[_0x114186(0x1ac)][_0x114186(0x1da)]||null),delete _0x39000e[_0x114186(0x1ac)]);const _0x1ac42b=await database_1[_0x114186(0x1c5)][_0x114186(0x1e3)][_0x114186(0x1c4)]({'where':{'id':_0x115e64},'data':_0x39000e,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x1ac42b['id'],'fullName':_0x1ac42b[_0x114186(0x1ba)],'username':_0x1ac42b['username'],'telegramId':_0x1ac42b[_0x114186(0x1b2)],'merchantUrl':_0x1ac42b[_0x114186(0x1bf)],'gateways':_0x1ac42b[_0x114186(0x1e0)]?JSON[_0x114186(0x1e1)](_0x1ac42b[_0x114186(0x1e0)]):null,'gatewaySettings':_0x1ac42b['gatewaySettings']?JSON[_0x114186(0x1e1)](_0x1ac42b[_0x114186(0x1d9)]):null,'publicKey':_0x1ac42b[_0x114186(0x1de)],'wallets':{'usdtPolygonWallet':_0x1ac42b[_0x114186(0x1b7)],'usdtTrcWallet':_0x1ac42b[_0x114186(0x1cb)],'usdtErcWallet':_0x1ac42b[_0x114186(0x1bd)],'usdcPolygonWallet':_0x1ac42b['usdcPolygonWallet']},'status':_0x1ac42b['status'],'createdAt':_0x1ac42b[_0x114186(0x1d0)]};}async[a51_0x5f2d5b(0x1d1)](_0x333e03){const _0x53f443=a51_0x5f2d5b;await database_1[_0x53f443(0x1c5)][_0x53f443(0x1e3)][_0x53f443(0x1c6)]({'where':{'id':_0x333e03}});}}exports['UserService']=UserService;