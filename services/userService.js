'use strict';const a56_0x5dcdee=a56_0xe4f9;(function(_0x361129,_0x243eff){const _0xffe4ff=a56_0xe4f9,_0x87573e=_0x361129();while(!![]){try{const _0x2f4548=parseInt(_0xffe4ff(0x1a0))/0x1*(-parseInt(_0xffe4ff(0x1b6))/0x2)+parseInt(_0xffe4ff(0x1ba))/0x3+parseInt(_0xffe4ff(0x193))/0x4+-parseInt(_0xffe4ff(0x1a3))/0x5+parseInt(_0xffe4ff(0x1bf))/0x6+-parseInt(_0xffe4ff(0x199))/0x7*(parseInt(_0xffe4ff(0x1b4))/0x8)+parseInt(_0xffe4ff(0x18f))/0x9*(parseInt(_0xffe4ff(0x196))/0xa);if(_0x2f4548===_0x243eff)break;else _0x87573e['push'](_0x87573e['shift']());}catch(_0x251192){_0x87573e['push'](_0x87573e['shift']());}}}(a56_0x48a1,0x88674));function a56_0xe4f9(_0x38daa1,_0x188d8f){const _0x48a1f3=a56_0x48a1();return a56_0xe4f9=function(_0xe4f945,_0x56b692){_0xe4f945=_0xe4f945-0x18e;let _0x4e2485=_0x48a1f3[_0xe4f945];return _0x4e2485;},a56_0xe4f9(_0x38daa1,_0x188d8f);}var __importDefault=this&&this['__importDefault']||function(_0x3845f2){const _0x57e6fa=a56_0xe4f9;return _0x3845f2&&_0x3845f2[_0x57e6fa(0x1bb)]?_0x3845f2:{'default':_0x3845f2};};function a56_0x48a1(){const _0x323769=['2471028LplDTm','hash','UserService','telegram','hex','generateApiKeys','publicKey','3UzyBGe','usdtPolygonWallet','delete','4405695bMXNud','parse','pk_','bcryptjs','defineProperty','createdAt','deleteUser','usdcPolygonWallet','gatewaySettings','merchantUrl','shop','ACTIVE','getAllUsers','password','telegramId','findUnique','toString','8UwWWfn','username','9434IZVlRQ','name','usdtTrcWallet','stringify','142767SUgFxf','__esModule','desc','shopUrl','wallets','5993490clRcZN','usdtErcWallet','status','paymentGateways','randomBytes','2871VkPuJN','default','update','create','2964156mDyOIc','map','fullName','610bUSTJk','gateways','findMany'];a56_0x48a1=function(){return _0x323769;};return a56_0x48a1();}Object[a56_0x5dcdee(0x1a7)](exports,a56_0x5dcdee(0x1bb),{'value':!![]}),exports[a56_0x5dcdee(0x19b)]=void 0x0;const bcryptjs_1=__importDefault(require(a56_0x5dcdee(0x1a6))),crypto_1=__importDefault(require('crypto')),database_1=__importDefault(require('../config/database'));class UserService{['generateApiKeys'](){const _0x38378a=a56_0x5dcdee,_0x378de0=_0x38378a(0x1a5)+crypto_1[_0x38378a(0x190)][_0x38378a(0x18e)](0x20)[_0x38378a(0x1b3)](_0x38378a(0x19d)),_0x198c3c='sk_'+crypto_1[_0x38378a(0x190)][_0x38378a(0x18e)](0x20)[_0x38378a(0x1b3)](_0x38378a(0x19d));return{'publicKey':_0x378de0,'secretKey':_0x198c3c};}async['createUser'](_0x5316c0){const _0x41733d=a56_0x5dcdee,{fullName:_0x5a6af0,username:_0x4ebc86,password:_0x31b703,telegramId:_0x255d4e,merchantUrl:_0x44f268,gateways:_0x44bdcb,gatewaySettings:_0x2f2efa,wallets:_0x2488c5}=_0x5316c0,_0x564257=await database_1[_0x41733d(0x190)][_0x41733d(0x1ad)][_0x41733d(0x1b2)]({'where':{'username':_0x4ebc86}});if(_0x564257)throw new Error('Username\x20already\x20exists');if(_0x255d4e){const _0x5727f0=await database_1[_0x41733d(0x190)][_0x41733d(0x1ad)][_0x41733d(0x1b2)]({'where':{'telegram':_0x255d4e}});if(_0x5727f0)throw new Error('Telegram\x20username\x20already\x20exists');}const _0x3adda8=await bcryptjs_1[_0x41733d(0x190)][_0x41733d(0x19a)](_0x31b703,0xc),{publicKey:_0x5db99c,secretKey:_0x17162b}=this[_0x41733d(0x19e)](),_0x5dc48d=await database_1[_0x41733d(0x190)]['shop'][_0x41733d(0x192)]({'data':{'name':_0x5a6af0,'username':_0x4ebc86,'password':_0x3adda8,'telegram':_0x255d4e,'shopUrl':_0x44f268,'paymentGateways':_0x44bdcb?JSON[_0x41733d(0x1b9)](_0x44bdcb):null,'gatewaySettings':_0x2f2efa?JSON[_0x41733d(0x1b9)](_0x2f2efa):null,'usdtPolygonWallet':_0x2488c5?.['usdtPolygonWallet']||null,'usdtTrcWallet':_0x2488c5?.[_0x41733d(0x1b8)]||null,'usdtErcWallet':_0x2488c5?.[_0x41733d(0x1c0)]||null,'usdcPolygonWallet':_0x2488c5?.[_0x41733d(0x1aa)]||null,'publicKey':_0x5db99c,'secretKey':_0x17162b,'status':_0x41733d(0x1ae)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x5dc48d['id'],'fullName':_0x5dc48d[_0x41733d(0x1b7)],'username':_0x5dc48d[_0x41733d(0x1b5)],'telegramId':_0x5dc48d[_0x41733d(0x19c)],'merchantUrl':_0x5dc48d[_0x41733d(0x1bd)],'gateways':_0x5dc48d['paymentGateways']?JSON['parse'](_0x5dc48d[_0x41733d(0x1c2)]):null,'gatewaySettings':_0x5dc48d[_0x41733d(0x1ab)]?JSON[_0x41733d(0x1a4)](_0x5dc48d['gatewaySettings']):null,'publicKey':_0x5dc48d[_0x41733d(0x19f)],'wallets':{'usdtPolygonWallet':_0x5dc48d[_0x41733d(0x1a1)],'usdtTrcWallet':_0x5dc48d[_0x41733d(0x1b8)],'usdtErcWallet':_0x5dc48d[_0x41733d(0x1c0)],'usdcPolygonWallet':_0x5dc48d[_0x41733d(0x1aa)]},'status':_0x5dc48d[_0x41733d(0x1c1)],'createdAt':_0x5dc48d[_0x41733d(0x1a8)]};}async[a56_0x5dcdee(0x1af)](){const _0x5c8d95=a56_0x5dcdee,_0x5ee1cc=await database_1[_0x5c8d95(0x190)][_0x5c8d95(0x1ad)][_0x5c8d95(0x198)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x5c8d95(0x1bc)}});return _0x5ee1cc[_0x5c8d95(0x194)](_0x39839d=>({'id':_0x39839d['id'],'fullName':_0x39839d['name'],'username':_0x39839d[_0x5c8d95(0x1b5)],'telegramId':_0x39839d[_0x5c8d95(0x19c)],'merchantUrl':_0x39839d['shopUrl'],'gateways':_0x39839d[_0x5c8d95(0x1c2)]?JSON[_0x5c8d95(0x1a4)](_0x39839d[_0x5c8d95(0x1c2)]):null,'gatewaySettings':_0x39839d[_0x5c8d95(0x1ab)]?JSON['parse'](_0x39839d[_0x5c8d95(0x1ab)]):null,'publicKey':_0x39839d['publicKey'],'wallets':{'usdtPolygonWallet':_0x39839d[_0x5c8d95(0x1a1)],'usdtTrcWallet':_0x39839d['usdtTrcWallet'],'usdtErcWallet':_0x39839d[_0x5c8d95(0x1c0)],'usdcPolygonWallet':_0x39839d[_0x5c8d95(0x1aa)]},'status':_0x39839d['status'],'createdAt':_0x39839d[_0x5c8d95(0x1a8)]}));}async['getUserById'](_0x4f1c92){const _0x41240e=a56_0x5dcdee,_0x1cb6f8=await database_1[_0x41240e(0x190)][_0x41240e(0x1ad)][_0x41240e(0x1b2)]({'where':{'id':_0x4f1c92},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x1cb6f8)return null;return{'id':_0x1cb6f8['id'],'fullName':_0x1cb6f8[_0x41240e(0x1b7)],'username':_0x1cb6f8[_0x41240e(0x1b5)],'telegramId':_0x1cb6f8['telegram'],'merchantUrl':_0x1cb6f8[_0x41240e(0x1bd)],'gateways':_0x1cb6f8[_0x41240e(0x1c2)]?JSON[_0x41240e(0x1a4)](_0x1cb6f8[_0x41240e(0x1c2)]):null,'gatewaySettings':_0x1cb6f8[_0x41240e(0x1ab)]?JSON['parse'](_0x1cb6f8[_0x41240e(0x1ab)]):null,'publicKey':_0x1cb6f8[_0x41240e(0x19f)],'wallets':{'usdtPolygonWallet':_0x1cb6f8[_0x41240e(0x1a1)],'usdtTrcWallet':_0x1cb6f8[_0x41240e(0x1b8)],'usdtErcWallet':_0x1cb6f8[_0x41240e(0x1c0)],'usdcPolygonWallet':_0x1cb6f8[_0x41240e(0x1aa)]},'status':_0x1cb6f8[_0x41240e(0x1c1)],'createdAt':_0x1cb6f8[_0x41240e(0x1a8)]};}async['updateUser'](_0x3329ed,_0xd78679){const _0x29c44f=a56_0x5dcdee,_0x500bf5={..._0xd78679};_0xd78679[_0x29c44f(0x1b0)]&&(_0x500bf5[_0x29c44f(0x1b0)]=await bcryptjs_1[_0x29c44f(0x190)]['hash'](_0xd78679[_0x29c44f(0x1b0)],0xc));_0xd78679['fullName']&&(_0x500bf5[_0x29c44f(0x1b7)]=_0xd78679[_0x29c44f(0x195)],delete _0x500bf5[_0x29c44f(0x195)]);_0xd78679[_0x29c44f(0x1b1)]&&(_0x500bf5['telegram']=_0xd78679[_0x29c44f(0x1b1)],delete _0x500bf5[_0x29c44f(0x1b1)]);_0xd78679[_0x29c44f(0x1ac)]&&(_0x500bf5[_0x29c44f(0x1bd)]=_0xd78679['merchantUrl'],delete _0x500bf5[_0x29c44f(0x1ac)]);_0xd78679['gateways']&&(_0x500bf5[_0x29c44f(0x1c2)]=JSON[_0x29c44f(0x1b9)](_0xd78679[_0x29c44f(0x197)]),delete _0x500bf5[_0x29c44f(0x197)]);_0xd78679[_0x29c44f(0x1ab)]&&(_0x500bf5[_0x29c44f(0x1ab)]=JSON[_0x29c44f(0x1b9)](_0xd78679[_0x29c44f(0x1ab)]),delete _0x500bf5['gatewaySettings']);_0xd78679[_0x29c44f(0x1be)]&&(_0xd78679[_0x29c44f(0x1be)]['usdtPolygonWallet']!==undefined&&(_0x500bf5[_0x29c44f(0x1a1)]=_0xd78679[_0x29c44f(0x1be)][_0x29c44f(0x1a1)]||null),_0xd78679[_0x29c44f(0x1be)][_0x29c44f(0x1b8)]!==undefined&&(_0x500bf5['usdtTrcWallet']=_0xd78679[_0x29c44f(0x1be)]['usdtTrcWallet']||null),_0xd78679['wallets'][_0x29c44f(0x1c0)]!==undefined&&(_0x500bf5[_0x29c44f(0x1c0)]=_0xd78679[_0x29c44f(0x1be)][_0x29c44f(0x1c0)]||null),_0xd78679['wallets'][_0x29c44f(0x1aa)]!==undefined&&(_0x500bf5[_0x29c44f(0x1aa)]=_0xd78679['wallets']['usdcPolygonWallet']||null),delete _0x500bf5[_0x29c44f(0x1be)]);const _0x270737=await database_1[_0x29c44f(0x190)][_0x29c44f(0x1ad)][_0x29c44f(0x191)]({'where':{'id':_0x3329ed},'data':_0x500bf5,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x270737['id'],'fullName':_0x270737[_0x29c44f(0x1b7)],'username':_0x270737[_0x29c44f(0x1b5)],'telegramId':_0x270737['telegram'],'merchantUrl':_0x270737[_0x29c44f(0x1bd)],'gateways':_0x270737[_0x29c44f(0x1c2)]?JSON[_0x29c44f(0x1a4)](_0x270737[_0x29c44f(0x1c2)]):null,'gatewaySettings':_0x270737[_0x29c44f(0x1ab)]?JSON[_0x29c44f(0x1a4)](_0x270737[_0x29c44f(0x1ab)]):null,'publicKey':_0x270737[_0x29c44f(0x19f)],'wallets':{'usdtPolygonWallet':_0x270737[_0x29c44f(0x1a1)],'usdtTrcWallet':_0x270737[_0x29c44f(0x1b8)],'usdtErcWallet':_0x270737[_0x29c44f(0x1c0)],'usdcPolygonWallet':_0x270737[_0x29c44f(0x1aa)]},'status':_0x270737[_0x29c44f(0x1c1)],'createdAt':_0x270737[_0x29c44f(0x1a8)]};}async[a56_0x5dcdee(0x1a9)](_0x4d5011){const _0x13a5eb=a56_0x5dcdee;await database_1[_0x13a5eb(0x190)][_0x13a5eb(0x1ad)][_0x13a5eb(0x1a2)]({'where':{'id':_0x4d5011}});}}exports['UserService']=UserService;