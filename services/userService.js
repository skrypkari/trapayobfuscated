'use strict';const a57_0x4ee6dd=a57_0x5864;(function(_0x476e41,_0x28852c){const _0x59e88d=a57_0x5864,_0x143b0a=_0x476e41();while(!![]){try{const _0x39118d=-parseInt(_0x59e88d(0xcf))/0x1*(-parseInt(_0x59e88d(0xb1))/0x2)+parseInt(_0x59e88d(0xa8))/0x3+-parseInt(_0x59e88d(0xb0))/0x4*(-parseInt(_0x59e88d(0xc1))/0x5)+parseInt(_0x59e88d(0xbb))/0x6*(-parseInt(_0x59e88d(0xb3))/0x7)+parseInt(_0x59e88d(0xc0))/0x8*(parseInt(_0x59e88d(0x9f))/0x9)+parseInt(_0x59e88d(0xb6))/0xa+-parseInt(_0x59e88d(0xa9))/0xb;if(_0x39118d===_0x28852c)break;else _0x143b0a['push'](_0x143b0a['shift']());}catch(_0xaeb336){_0x143b0a['push'](_0x143b0a['shift']());}}}(a57_0x2c27,0x3f5ee));function a57_0x2c27(){const _0x4a8485=['map','publicKey','createUser','39936XoVwFa','7962471ssiuWf','__esModule','telegram','stringify','findMany','username','gateways','733804PYuuXo','952618fVCEzm','name','175YVkmpM','password','sk_','650470aBNjxJ','bcryptjs','hex','UserService','fullName','18066fBwgJl','shop','usdtErcWallet','update','toString','854888HDFQJt','5QlVIdL','generateApiKeys','crypto','gatewaySettings','getAllUsers','usdtTrcWallet','paymentGateways','merchantUrl','default','Username\x20already\x20exists','shopUrl','hash','Telegram\x20username\x20already\x20exists','__importDefault','1dOAtXo','desc','randomBytes','wallets','telegramId','../config/database','findUnique','status','27EzLpBd','usdcPolygonWallet','usdtPolygonWallet','parse','createdAt','updateUser'];a57_0x2c27=function(){return _0x4a8485;};return a57_0x2c27();}var __importDefault=this&&this[a57_0x4ee6dd(0xce)]||function(_0xf64102){const _0x43fbbd=a57_0x4ee6dd;return _0xf64102&&_0xf64102[_0x43fbbd(0xaa)]?_0xf64102:{'default':_0xf64102};};function a57_0x5864(_0x12de65,_0x1b3347){const _0x2c272f=a57_0x2c27();return a57_0x5864=function(_0x5864fc,_0x4cf47e){_0x5864fc=_0x5864fc-0x9f;let _0x47b134=_0x2c272f[_0x5864fc];return _0x47b134;},a57_0x5864(_0x12de65,_0x1b3347);}Object['defineProperty'](exports,a57_0x4ee6dd(0xaa),{'value':!![]}),exports['UserService']=void 0x0;const bcryptjs_1=__importDefault(require(a57_0x4ee6dd(0xb7))),crypto_1=__importDefault(require(a57_0x4ee6dd(0xc3))),database_1=__importDefault(require(a57_0x4ee6dd(0xd4)));class UserService{[a57_0x4ee6dd(0xc2)](){const _0x33a235=a57_0x4ee6dd,_0x4a9b11='pk_'+crypto_1[_0x33a235(0xc9)][_0x33a235(0xd1)](0x20)[_0x33a235(0xbf)]('hex'),_0x41a850=_0x33a235(0xb5)+crypto_1[_0x33a235(0xc9)][_0x33a235(0xd1)](0x20)['toString'](_0x33a235(0xb8));return{'publicKey':_0x4a9b11,'secretKey':_0x41a850};}async[a57_0x4ee6dd(0xa7)](_0x874570){const _0x1b7a0f=a57_0x4ee6dd,{fullName:_0x123c67,username:_0x2be5c0,password:_0x37ff82,telegramId:_0x3f20b3,merchantUrl:_0x144db3,gateways:_0x5d820b,gatewaySettings:_0xdaf5a5,wallets:_0x4d61b1}=_0x874570,_0x339bb8=await database_1[_0x1b7a0f(0xc9)][_0x1b7a0f(0xbc)][_0x1b7a0f(0xd5)]({'where':{'username':_0x2be5c0}});if(_0x339bb8)throw new Error(_0x1b7a0f(0xca));if(_0x3f20b3){const _0x446412=await database_1[_0x1b7a0f(0xc9)][_0x1b7a0f(0xbc)][_0x1b7a0f(0xd5)]({'where':{'telegram':_0x3f20b3}});if(_0x446412)throw new Error(_0x1b7a0f(0xcd));}const _0x337ca5=await bcryptjs_1[_0x1b7a0f(0xc9)][_0x1b7a0f(0xcc)](_0x37ff82,0xc),{publicKey:_0x5882d0,secretKey:_0x4c856d}=this[_0x1b7a0f(0xc2)](),_0x75a6a6=await database_1[_0x1b7a0f(0xc9)][_0x1b7a0f(0xbc)]['create']({'data':{'name':_0x123c67,'username':_0x2be5c0,'password':_0x337ca5,'telegram':_0x3f20b3,'shopUrl':_0x144db3,'paymentGateways':_0x5d820b?JSON[_0x1b7a0f(0xac)](_0x5d820b):null,'gatewaySettings':_0xdaf5a5?JSON['stringify'](_0xdaf5a5):null,'usdtPolygonWallet':_0x4d61b1?.['usdtPolygonWallet']||null,'usdtTrcWallet':_0x4d61b1?.[_0x1b7a0f(0xc6)]||null,'usdtErcWallet':_0x4d61b1?.[_0x1b7a0f(0xbd)]||null,'usdcPolygonWallet':_0x4d61b1?.[_0x1b7a0f(0xa0)]||null,'publicKey':_0x5882d0,'secretKey':_0x4c856d,'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x75a6a6['id'],'fullName':_0x75a6a6[_0x1b7a0f(0xb2)],'username':_0x75a6a6[_0x1b7a0f(0xae)],'telegramId':_0x75a6a6[_0x1b7a0f(0xab)],'merchantUrl':_0x75a6a6[_0x1b7a0f(0xcb)],'gateways':_0x75a6a6[_0x1b7a0f(0xc7)]?JSON[_0x1b7a0f(0xa2)](_0x75a6a6[_0x1b7a0f(0xc7)]):null,'gatewaySettings':_0x75a6a6[_0x1b7a0f(0xc4)]?JSON['parse'](_0x75a6a6[_0x1b7a0f(0xc4)]):null,'publicKey':_0x75a6a6[_0x1b7a0f(0xa6)],'wallets':{'usdtPolygonWallet':_0x75a6a6['usdtPolygonWallet'],'usdtTrcWallet':_0x75a6a6[_0x1b7a0f(0xc6)],'usdtErcWallet':_0x75a6a6[_0x1b7a0f(0xbd)],'usdcPolygonWallet':_0x75a6a6['usdcPolygonWallet']},'status':_0x75a6a6['status'],'createdAt':_0x75a6a6[_0x1b7a0f(0xa3)]};}async[a57_0x4ee6dd(0xc5)](){const _0x45ea23=a57_0x4ee6dd,_0x246f32=await database_1[_0x45ea23(0xc9)][_0x45ea23(0xbc)][_0x45ea23(0xad)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x45ea23(0xd0)}});return _0x246f32[_0x45ea23(0xa5)](_0x5b00e7=>({'id':_0x5b00e7['id'],'fullName':_0x5b00e7['name'],'username':_0x5b00e7[_0x45ea23(0xae)],'telegramId':_0x5b00e7['telegram'],'merchantUrl':_0x5b00e7[_0x45ea23(0xcb)],'gateways':_0x5b00e7[_0x45ea23(0xc7)]?JSON[_0x45ea23(0xa2)](_0x5b00e7[_0x45ea23(0xc7)]):null,'gatewaySettings':_0x5b00e7[_0x45ea23(0xc4)]?JSON['parse'](_0x5b00e7['gatewaySettings']):null,'publicKey':_0x5b00e7['publicKey'],'wallets':{'usdtPolygonWallet':_0x5b00e7['usdtPolygonWallet'],'usdtTrcWallet':_0x5b00e7[_0x45ea23(0xc6)],'usdtErcWallet':_0x5b00e7[_0x45ea23(0xbd)],'usdcPolygonWallet':_0x5b00e7['usdcPolygonWallet']},'status':_0x5b00e7[_0x45ea23(0xd6)],'createdAt':_0x5b00e7[_0x45ea23(0xa3)]}));}async['getUserById'](_0x451a7c){const _0x5a5825=a57_0x4ee6dd,_0x44b5e3=await database_1[_0x5a5825(0xc9)]['shop'][_0x5a5825(0xd5)]({'where':{'id':_0x451a7c},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x44b5e3)return null;return{'id':_0x44b5e3['id'],'fullName':_0x44b5e3[_0x5a5825(0xb2)],'username':_0x44b5e3[_0x5a5825(0xae)],'telegramId':_0x44b5e3[_0x5a5825(0xab)],'merchantUrl':_0x44b5e3[_0x5a5825(0xcb)],'gateways':_0x44b5e3['paymentGateways']?JSON[_0x5a5825(0xa2)](_0x44b5e3[_0x5a5825(0xc7)]):null,'gatewaySettings':_0x44b5e3[_0x5a5825(0xc4)]?JSON['parse'](_0x44b5e3[_0x5a5825(0xc4)]):null,'publicKey':_0x44b5e3[_0x5a5825(0xa6)],'wallets':{'usdtPolygonWallet':_0x44b5e3[_0x5a5825(0xa1)],'usdtTrcWallet':_0x44b5e3[_0x5a5825(0xc6)],'usdtErcWallet':_0x44b5e3[_0x5a5825(0xbd)],'usdcPolygonWallet':_0x44b5e3[_0x5a5825(0xa0)]},'status':_0x44b5e3[_0x5a5825(0xd6)],'createdAt':_0x44b5e3[_0x5a5825(0xa3)]};}async[a57_0x4ee6dd(0xa4)](_0x523118,_0x157917){const _0x5339f4=a57_0x4ee6dd,_0xa1a000={..._0x157917};_0x157917[_0x5339f4(0xb4)]&&(_0xa1a000['password']=await bcryptjs_1[_0x5339f4(0xc9)][_0x5339f4(0xcc)](_0x157917[_0x5339f4(0xb4)],0xc));_0x157917[_0x5339f4(0xba)]&&(_0xa1a000['name']=_0x157917[_0x5339f4(0xba)],delete _0xa1a000[_0x5339f4(0xba)]);_0x157917[_0x5339f4(0xd3)]&&(_0xa1a000[_0x5339f4(0xab)]=_0x157917[_0x5339f4(0xd3)],delete _0xa1a000['telegramId']);_0x157917[_0x5339f4(0xc8)]&&(_0xa1a000[_0x5339f4(0xcb)]=_0x157917[_0x5339f4(0xc8)],delete _0xa1a000[_0x5339f4(0xc8)]);_0x157917['gateways']&&(_0xa1a000[_0x5339f4(0xc7)]=JSON['stringify'](_0x157917[_0x5339f4(0xaf)]),delete _0xa1a000[_0x5339f4(0xaf)]);_0x157917[_0x5339f4(0xc4)]&&(_0xa1a000[_0x5339f4(0xc4)]=JSON[_0x5339f4(0xac)](_0x157917[_0x5339f4(0xc4)]),delete _0xa1a000[_0x5339f4(0xc4)]);_0x157917[_0x5339f4(0xd2)]&&(_0x157917[_0x5339f4(0xd2)][_0x5339f4(0xa1)]!==undefined&&(_0xa1a000[_0x5339f4(0xa1)]=_0x157917[_0x5339f4(0xd2)][_0x5339f4(0xa1)]||null),_0x157917['wallets'][_0x5339f4(0xc6)]!==undefined&&(_0xa1a000[_0x5339f4(0xc6)]=_0x157917[_0x5339f4(0xd2)][_0x5339f4(0xc6)]||null),_0x157917[_0x5339f4(0xd2)][_0x5339f4(0xbd)]!==undefined&&(_0xa1a000['usdtErcWallet']=_0x157917[_0x5339f4(0xd2)][_0x5339f4(0xbd)]||null),_0x157917[_0x5339f4(0xd2)][_0x5339f4(0xa0)]!==undefined&&(_0xa1a000['usdcPolygonWallet']=_0x157917[_0x5339f4(0xd2)]['usdcPolygonWallet']||null),delete _0xa1a000['wallets']);const _0x37b354=await database_1[_0x5339f4(0xc9)][_0x5339f4(0xbc)][_0x5339f4(0xbe)]({'where':{'id':_0x523118},'data':_0xa1a000,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x37b354['id'],'fullName':_0x37b354['name'],'username':_0x37b354['username'],'telegramId':_0x37b354['telegram'],'merchantUrl':_0x37b354[_0x5339f4(0xcb)],'gateways':_0x37b354[_0x5339f4(0xc7)]?JSON[_0x5339f4(0xa2)](_0x37b354[_0x5339f4(0xc7)]):null,'gatewaySettings':_0x37b354[_0x5339f4(0xc4)]?JSON[_0x5339f4(0xa2)](_0x37b354[_0x5339f4(0xc4)]):null,'publicKey':_0x37b354[_0x5339f4(0xa6)],'wallets':{'usdtPolygonWallet':_0x37b354[_0x5339f4(0xa1)],'usdtTrcWallet':_0x37b354[_0x5339f4(0xc6)],'usdtErcWallet':_0x37b354[_0x5339f4(0xbd)],'usdcPolygonWallet':_0x37b354[_0x5339f4(0xa0)]},'status':_0x37b354[_0x5339f4(0xd6)],'createdAt':_0x37b354[_0x5339f4(0xa3)]};}async['deleteUser'](_0x436df1){const _0x30d300=a57_0x4ee6dd;await database_1['default'][_0x30d300(0xbc)]['delete']({'where':{'id':_0x436df1}});}}exports[a57_0x4ee6dd(0xb9)]=UserService;