'use strict';const a51_0x6226a2=a51_0x1ed3;function a51_0x1ed3(_0x1c67b9,_0x4c6155){const _0x3ae422=a51_0x3ae4();return a51_0x1ed3=function(_0x1ed3b1,_0x14b11f){_0x1ed3b1=_0x1ed3b1-0x87;let _0x4d1701=_0x3ae422[_0x1ed3b1];return _0x4d1701;},a51_0x1ed3(_0x1c67b9,_0x4c6155);}function a51_0x3ae4(){const _0xd5cb8a=['shop','../config/database','hex','merchantUrl','hash','desc','bcryptjs','generateApiKeys','delete','Telegram\x20username\x20already\x20exists','5682FFKqkI','usdtErcWallet','319599SJNQDg','parse','publicKey','4Kpoadg','paymentGateways','1415982rVyeOh','telegram','status','crypto','__esModule','telegramId','toString','121685FUXYjS','update','UserService','username','600649WAXHvK','__importDefault','usdtPolygonWallet','findMany','usdcPolygonWallet','pk_','5207160FIuEVW','wallets','shopUrl','fullName','randomBytes','gateways','1039596BZMJfh','create','gatewaySettings','Username\x20already\x20exists','sk_','stringify','ACTIVE','password','default','defineProperty','2810OwbXrw','name','usdtTrcWallet','findUnique','updateUser','createdAt','40BqdJUm','map'];a51_0x3ae4=function(){return _0xd5cb8a;};return a51_0x3ae4();}(function(_0x2aa221,_0x1e84c5){const _0x29143c=a51_0x1ed3,_0x2c64ba=_0x2aa221();while(!![]){try{const _0x51b9b3=parseInt(_0x29143c(0x9d))/0x1+parseInt(_0x29143c(0xad))/0x2+-parseInt(_0x29143c(0x96))/0x3*(-parseInt(_0x29143c(0x94))/0x4)+-parseInt(_0x29143c(0xb7))/0x5*(parseInt(_0x29143c(0x8f))/0x6)+parseInt(_0x29143c(0xa1))/0x7+parseInt(_0x29143c(0xbd))/0x8*(parseInt(_0x29143c(0x91))/0x9)+-parseInt(_0x29143c(0xa7))/0xa;if(_0x51b9b3===_0x1e84c5)break;else _0x2c64ba['push'](_0x2c64ba['shift']());}catch(_0x4b2929){_0x2c64ba['push'](_0x2c64ba['shift']());}}}(a51_0x3ae4,0x4f145));var __importDefault=this&&this[a51_0x6226a2(0xa2)]||function(_0x239e0f){const _0x46bcb9=a51_0x6226a2;return _0x239e0f&&_0x239e0f[_0x46bcb9(0x9a)]?_0x239e0f:{'default':_0x239e0f};};Object[a51_0x6226a2(0xb6)](exports,a51_0x6226a2(0x9a),{'value':!![]}),exports[a51_0x6226a2(0x9f)]=void 0x0;const bcryptjs_1=__importDefault(require(a51_0x6226a2(0x8b))),crypto_1=__importDefault(require(a51_0x6226a2(0x99))),database_1=__importDefault(require(a51_0x6226a2(0xc0)));class UserService{[a51_0x6226a2(0x8c)](){const _0x21da03=a51_0x6226a2,_0x5ba852=_0x21da03(0xa6)+crypto_1[_0x21da03(0xb5)][_0x21da03(0xab)](0x20)['toString'](_0x21da03(0x87)),_0x438e1b=_0x21da03(0xb1)+crypto_1['default']['randomBytes'](0x20)[_0x21da03(0x9c)](_0x21da03(0x87));return{'publicKey':_0x5ba852,'secretKey':_0x438e1b};}async['createUser'](_0x5a0055){const _0x40d74b=a51_0x6226a2,{fullName:_0x42eb2e,username:_0x5b5aee,password:_0x3f6412,telegramId:_0x258361,merchantUrl:_0x4fcfd1,gateways:_0x589a84,gatewaySettings:_0x6fd436,wallets:_0x41f35c}=_0x5a0055,_0x482c8c=await database_1[_0x40d74b(0xb5)][_0x40d74b(0xbf)][_0x40d74b(0xba)]({'where':{'username':_0x5b5aee}});if(_0x482c8c)throw new Error(_0x40d74b(0xb0));if(_0x258361){const _0x4e6da2=await database_1[_0x40d74b(0xb5)]['shop'][_0x40d74b(0xba)]({'where':{'telegram':_0x258361}});if(_0x4e6da2)throw new Error(_0x40d74b(0x8e));}const _0x3e28b2=await bcryptjs_1[_0x40d74b(0xb5)][_0x40d74b(0x89)](_0x3f6412,0xc),{publicKey:_0x2c8d45,secretKey:_0x58ef16}=this['generateApiKeys'](),_0x327785=await database_1[_0x40d74b(0xb5)]['shop'][_0x40d74b(0xae)]({'data':{'name':_0x42eb2e,'username':_0x5b5aee,'password':_0x3e28b2,'telegram':_0x258361,'shopUrl':_0x4fcfd1,'paymentGateways':_0x589a84?JSON[_0x40d74b(0xb2)](_0x589a84):null,'gatewaySettings':_0x6fd436?JSON[_0x40d74b(0xb2)](_0x6fd436):null,'usdtPolygonWallet':_0x41f35c?.['usdtPolygonWallet']||null,'usdtTrcWallet':_0x41f35c?.[_0x40d74b(0xb9)]||null,'usdtErcWallet':_0x41f35c?.[_0x40d74b(0x90)]||null,'usdcPolygonWallet':_0x41f35c?.[_0x40d74b(0xa5)]||null,'publicKey':_0x2c8d45,'secretKey':_0x58ef16,'status':_0x40d74b(0xb3)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x327785['id'],'fullName':_0x327785['name'],'username':_0x327785[_0x40d74b(0xa0)],'telegramId':_0x327785[_0x40d74b(0x97)],'merchantUrl':_0x327785['shopUrl'],'gateways':_0x327785[_0x40d74b(0x95)]?JSON[_0x40d74b(0x92)](_0x327785[_0x40d74b(0x95)]):null,'gatewaySettings':_0x327785[_0x40d74b(0xaf)]?JSON[_0x40d74b(0x92)](_0x327785[_0x40d74b(0xaf)]):null,'publicKey':_0x327785[_0x40d74b(0x93)],'wallets':{'usdtPolygonWallet':_0x327785[_0x40d74b(0xa3)],'usdtTrcWallet':_0x327785[_0x40d74b(0xb9)],'usdtErcWallet':_0x327785[_0x40d74b(0x90)],'usdcPolygonWallet':_0x327785[_0x40d74b(0xa5)]},'status':_0x327785[_0x40d74b(0x98)],'createdAt':_0x327785[_0x40d74b(0xbc)]};}async['getAllUsers'](){const _0x4463d9=a51_0x6226a2,_0x53c6b8=await database_1[_0x4463d9(0xb5)][_0x4463d9(0xbf)][_0x4463d9(0xa4)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x4463d9(0x8a)}});return _0x53c6b8[_0x4463d9(0xbe)](_0x16dc27=>({'id':_0x16dc27['id'],'fullName':_0x16dc27['name'],'username':_0x16dc27[_0x4463d9(0xa0)],'telegramId':_0x16dc27[_0x4463d9(0x97)],'merchantUrl':_0x16dc27[_0x4463d9(0xa9)],'gateways':_0x16dc27['paymentGateways']?JSON[_0x4463d9(0x92)](_0x16dc27[_0x4463d9(0x95)]):null,'gatewaySettings':_0x16dc27['gatewaySettings']?JSON[_0x4463d9(0x92)](_0x16dc27[_0x4463d9(0xaf)]):null,'publicKey':_0x16dc27['publicKey'],'wallets':{'usdtPolygonWallet':_0x16dc27['usdtPolygonWallet'],'usdtTrcWallet':_0x16dc27[_0x4463d9(0xb9)],'usdtErcWallet':_0x16dc27[_0x4463d9(0x90)],'usdcPolygonWallet':_0x16dc27[_0x4463d9(0xa5)]},'status':_0x16dc27[_0x4463d9(0x98)],'createdAt':_0x16dc27[_0x4463d9(0xbc)]}));}async['getUserById'](_0x29c8e3){const _0x15d9fb=a51_0x6226a2,_0x19fa39=await database_1[_0x15d9fb(0xb5)][_0x15d9fb(0xbf)][_0x15d9fb(0xba)]({'where':{'id':_0x29c8e3},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x19fa39)return null;return{'id':_0x19fa39['id'],'fullName':_0x19fa39[_0x15d9fb(0xb8)],'username':_0x19fa39[_0x15d9fb(0xa0)],'telegramId':_0x19fa39[_0x15d9fb(0x97)],'merchantUrl':_0x19fa39['shopUrl'],'gateways':_0x19fa39['paymentGateways']?JSON[_0x15d9fb(0x92)](_0x19fa39[_0x15d9fb(0x95)]):null,'gatewaySettings':_0x19fa39['gatewaySettings']?JSON[_0x15d9fb(0x92)](_0x19fa39[_0x15d9fb(0xaf)]):null,'publicKey':_0x19fa39[_0x15d9fb(0x93)],'wallets':{'usdtPolygonWallet':_0x19fa39[_0x15d9fb(0xa3)],'usdtTrcWallet':_0x19fa39['usdtTrcWallet'],'usdtErcWallet':_0x19fa39[_0x15d9fb(0x90)],'usdcPolygonWallet':_0x19fa39[_0x15d9fb(0xa5)]},'status':_0x19fa39[_0x15d9fb(0x98)],'createdAt':_0x19fa39[_0x15d9fb(0xbc)]};}async[a51_0x6226a2(0xbb)](_0x55d334,_0x310cf4){const _0x52da0c=a51_0x6226a2,_0x1f39c5={..._0x310cf4};_0x310cf4['password']&&(_0x1f39c5[_0x52da0c(0xb4)]=await bcryptjs_1[_0x52da0c(0xb5)]['hash'](_0x310cf4['password'],0xc));_0x310cf4[_0x52da0c(0xaa)]&&(_0x1f39c5['name']=_0x310cf4[_0x52da0c(0xaa)],delete _0x1f39c5[_0x52da0c(0xaa)]);_0x310cf4[_0x52da0c(0x9b)]&&(_0x1f39c5[_0x52da0c(0x97)]=_0x310cf4[_0x52da0c(0x9b)],delete _0x1f39c5[_0x52da0c(0x9b)]);_0x310cf4[_0x52da0c(0x88)]&&(_0x1f39c5[_0x52da0c(0xa9)]=_0x310cf4[_0x52da0c(0x88)],delete _0x1f39c5[_0x52da0c(0x88)]);_0x310cf4['gateways']&&(_0x1f39c5['paymentGateways']=JSON[_0x52da0c(0xb2)](_0x310cf4[_0x52da0c(0xac)]),delete _0x1f39c5['gateways']);_0x310cf4[_0x52da0c(0xaf)]&&(_0x1f39c5[_0x52da0c(0xaf)]=JSON['stringify'](_0x310cf4[_0x52da0c(0xaf)]),delete _0x1f39c5['gatewaySettings']);_0x310cf4[_0x52da0c(0xa8)]&&(_0x310cf4[_0x52da0c(0xa8)][_0x52da0c(0xa3)]!==undefined&&(_0x1f39c5[_0x52da0c(0xa3)]=_0x310cf4[_0x52da0c(0xa8)][_0x52da0c(0xa3)]||null),_0x310cf4['wallets'][_0x52da0c(0xb9)]!==undefined&&(_0x1f39c5[_0x52da0c(0xb9)]=_0x310cf4[_0x52da0c(0xa8)]['usdtTrcWallet']||null),_0x310cf4[_0x52da0c(0xa8)][_0x52da0c(0x90)]!==undefined&&(_0x1f39c5[_0x52da0c(0x90)]=_0x310cf4['wallets'][_0x52da0c(0x90)]||null),_0x310cf4['wallets']['usdcPolygonWallet']!==undefined&&(_0x1f39c5['usdcPolygonWallet']=_0x310cf4[_0x52da0c(0xa8)]['usdcPolygonWallet']||null),delete _0x1f39c5['wallets']);const _0x12c7a3=await database_1[_0x52da0c(0xb5)][_0x52da0c(0xbf)][_0x52da0c(0x9e)]({'where':{'id':_0x55d334},'data':_0x1f39c5,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x12c7a3['id'],'fullName':_0x12c7a3[_0x52da0c(0xb8)],'username':_0x12c7a3[_0x52da0c(0xa0)],'telegramId':_0x12c7a3['telegram'],'merchantUrl':_0x12c7a3[_0x52da0c(0xa9)],'gateways':_0x12c7a3[_0x52da0c(0x95)]?JSON[_0x52da0c(0x92)](_0x12c7a3['paymentGateways']):null,'gatewaySettings':_0x12c7a3[_0x52da0c(0xaf)]?JSON[_0x52da0c(0x92)](_0x12c7a3[_0x52da0c(0xaf)]):null,'publicKey':_0x12c7a3['publicKey'],'wallets':{'usdtPolygonWallet':_0x12c7a3[_0x52da0c(0xa3)],'usdtTrcWallet':_0x12c7a3['usdtTrcWallet'],'usdtErcWallet':_0x12c7a3[_0x52da0c(0x90)],'usdcPolygonWallet':_0x12c7a3[_0x52da0c(0xa5)]},'status':_0x12c7a3[_0x52da0c(0x98)],'createdAt':_0x12c7a3[_0x52da0c(0xbc)]};}async['deleteUser'](_0x42401f){const _0x788548=a51_0x6226a2;await database_1[_0x788548(0xb5)][_0x788548(0xbf)][_0x788548(0x8d)]({'where':{'id':_0x42401f}});}}exports[a51_0x6226a2(0x9f)]=UserService;