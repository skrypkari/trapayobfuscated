'use strict';const a64_0x18b0a0=a64_0xa89f;(function(_0x1f00bb,_0x1f51b8){const _0x262805=a64_0xa89f,_0x4a70ba=_0x1f00bb();while(!![]){try{const _0x3d0261=parseInt(_0x262805(0x12f))/0x1+-parseInt(_0x262805(0x142))/0x2+parseInt(_0x262805(0x13a))/0x3*(parseInt(_0x262805(0x131))/0x4)+parseInt(_0x262805(0x145))/0x5*(-parseInt(_0x262805(0x154))/0x6)+parseInt(_0x262805(0x136))/0x7*(parseInt(_0x262805(0x147))/0x8)+parseInt(_0x262805(0x13e))/0x9*(-parseInt(_0x262805(0x14b))/0xa)+parseInt(_0x262805(0x13c))/0xb;if(_0x3d0261===_0x1f51b8)break;else _0x4a70ba['push'](_0x4a70ba['shift']());}catch(_0x25dac6){_0x4a70ba['push'](_0x4a70ba['shift']());}}}(a64_0x5499,0xca2ad));var __importDefault=this&&this[a64_0x18b0a0(0x146)]||function(_0x891ab){const _0x5dbcb0=a64_0x18b0a0;return _0x891ab&&_0x891ab[_0x5dbcb0(0x129)]?_0x891ab:{'default':_0x891ab};};function a64_0x5499(){const _0x2d2dd5=['Username\x20already\x20exists','13639887nJbLDa','password','findMany','createUser','882204xQctuI','pk_','wallets','5684435cnVBCy','__importDefault','4305224EcCrkQ','parse','telegram','hash','10sqfGWr','UserService','defineProperty','map','findUnique','crypto','username','ACTIVE','name','6bRUanr','update','getUserById','updateUser','create','../config/database','getAllUsers','telegramId','gateways','usdtPolygonWallet','Telegram\x20username\x20already\x20exists','publicKey','fullName','usdcPolygonWallet','gatewaySettings','stringify','hex','toString','__esModule','createdAt','generateApiKeys','default','merchantUrl','paymentGateways','484209hAGsiG','sk_','930384aqvJqm','randomBytes','usdtErcWallet','status','deleteUser','7UTlGIo','shopUrl','usdtTrcWallet','bcryptjs','15UVOzbm','shop','19098937HhKvuk'];a64_0x5499=function(){return _0x2d2dd5;};return a64_0x5499();}function a64_0xa89f(_0x4c4416,_0x5b1b9b){const _0x54997a=a64_0x5499();return a64_0xa89f=function(_0xa89fd6,_0x3c3f57){_0xa89fd6=_0xa89fd6-0x11e;let _0x59687a=_0x54997a[_0xa89fd6];return _0x59687a;},a64_0xa89f(_0x4c4416,_0x5b1b9b);}Object[a64_0x18b0a0(0x14d)](exports,a64_0x18b0a0(0x129),{'value':!![]}),exports[a64_0x18b0a0(0x14c)]=void 0x0;const bcryptjs_1=__importDefault(require(a64_0x18b0a0(0x139))),crypto_1=__importDefault(require(a64_0x18b0a0(0x150))),database_1=__importDefault(require(a64_0x18b0a0(0x159)));class UserService{[a64_0x18b0a0(0x12b)](){const _0x558595=a64_0x18b0a0,_0x527738=_0x558595(0x143)+crypto_1['default']['randomBytes'](0x20)['toString'](_0x558595(0x127)),_0x410853=_0x558595(0x130)+crypto_1[_0x558595(0x12c)][_0x558595(0x132)](0x20)[_0x558595(0x128)](_0x558595(0x127));return{'publicKey':_0x527738,'secretKey':_0x410853};}async[a64_0x18b0a0(0x141)](_0x37f0ad){const _0x2e8daf=a64_0x18b0a0,{fullName:_0x391fb3,username:_0x593361,password:_0x17f795,telegramId:_0x351ba4,merchantUrl:_0x34ba61,gateways:_0x27bf09,gatewaySettings:_0x40c694,wallets:_0x44506e}=_0x37f0ad,_0x47cd8e=await database_1[_0x2e8daf(0x12c)][_0x2e8daf(0x13b)]['findUnique']({'where':{'username':_0x593361}});if(_0x47cd8e)throw new Error(_0x2e8daf(0x13d));if(_0x351ba4){const _0x4e4a11=await database_1[_0x2e8daf(0x12c)][_0x2e8daf(0x13b)][_0x2e8daf(0x14f)]({'where':{'telegram':_0x351ba4}});if(_0x4e4a11)throw new Error(_0x2e8daf(0x121));}const _0x371909=await bcryptjs_1['default'][_0x2e8daf(0x14a)](_0x17f795,0xc),{publicKey:_0x2e87f3,secretKey:_0xa354ca}=this[_0x2e8daf(0x12b)](),_0x34753b=await database_1['default'][_0x2e8daf(0x13b)][_0x2e8daf(0x158)]({'data':{'name':_0x391fb3,'username':_0x593361,'password':_0x371909,'telegram':_0x351ba4,'shopUrl':_0x34ba61,'paymentGateways':_0x27bf09?JSON[_0x2e8daf(0x126)](_0x27bf09):null,'gatewaySettings':_0x40c694?JSON[_0x2e8daf(0x126)](_0x40c694):null,'usdtPolygonWallet':_0x44506e?.[_0x2e8daf(0x120)]||null,'usdtTrcWallet':_0x44506e?.[_0x2e8daf(0x138)]||null,'usdtErcWallet':_0x44506e?.[_0x2e8daf(0x133)]||null,'usdcPolygonWallet':_0x44506e?.[_0x2e8daf(0x124)]||null,'publicKey':_0x2e87f3,'secretKey':_0xa354ca,'status':_0x2e8daf(0x152)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x34753b['id'],'fullName':_0x34753b[_0x2e8daf(0x153)],'username':_0x34753b[_0x2e8daf(0x151)],'telegramId':_0x34753b['telegram'],'merchantUrl':_0x34753b[_0x2e8daf(0x137)],'gateways':_0x34753b['paymentGateways']?JSON[_0x2e8daf(0x148)](_0x34753b[_0x2e8daf(0x12e)]):null,'gatewaySettings':_0x34753b[_0x2e8daf(0x125)]?JSON[_0x2e8daf(0x148)](_0x34753b[_0x2e8daf(0x125)]):null,'publicKey':_0x34753b[_0x2e8daf(0x122)],'wallets':{'usdtPolygonWallet':_0x34753b['usdtPolygonWallet'],'usdtTrcWallet':_0x34753b['usdtTrcWallet'],'usdtErcWallet':_0x34753b[_0x2e8daf(0x133)],'usdcPolygonWallet':_0x34753b[_0x2e8daf(0x124)]},'status':_0x34753b[_0x2e8daf(0x134)],'createdAt':_0x34753b['createdAt']};}async[a64_0x18b0a0(0x15a)](){const _0x34231f=a64_0x18b0a0,_0x5b5443=await database_1['default']['shop'][_0x34231f(0x140)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':'desc'}});return _0x5b5443[_0x34231f(0x14e)](_0x1175a7=>({'id':_0x1175a7['id'],'fullName':_0x1175a7[_0x34231f(0x153)],'username':_0x1175a7['username'],'telegramId':_0x1175a7[_0x34231f(0x149)],'merchantUrl':_0x1175a7[_0x34231f(0x137)],'gateways':_0x1175a7['paymentGateways']?JSON[_0x34231f(0x148)](_0x1175a7[_0x34231f(0x12e)]):null,'gatewaySettings':_0x1175a7[_0x34231f(0x125)]?JSON[_0x34231f(0x148)](_0x1175a7[_0x34231f(0x125)]):null,'publicKey':_0x1175a7[_0x34231f(0x122)],'wallets':{'usdtPolygonWallet':_0x1175a7[_0x34231f(0x120)],'usdtTrcWallet':_0x1175a7[_0x34231f(0x138)],'usdtErcWallet':_0x1175a7[_0x34231f(0x133)],'usdcPolygonWallet':_0x1175a7[_0x34231f(0x124)]},'status':_0x1175a7[_0x34231f(0x134)],'createdAt':_0x1175a7['createdAt']}));}async[a64_0x18b0a0(0x156)](_0x391fcc){const _0x4e073f=a64_0x18b0a0,_0x4d4ffb=await database_1[_0x4e073f(0x12c)]['shop']['findUnique']({'where':{'id':_0x391fcc},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x4d4ffb)return null;return{'id':_0x4d4ffb['id'],'fullName':_0x4d4ffb[_0x4e073f(0x153)],'username':_0x4d4ffb[_0x4e073f(0x151)],'telegramId':_0x4d4ffb[_0x4e073f(0x149)],'merchantUrl':_0x4d4ffb[_0x4e073f(0x137)],'gateways':_0x4d4ffb[_0x4e073f(0x12e)]?JSON[_0x4e073f(0x148)](_0x4d4ffb[_0x4e073f(0x12e)]):null,'gatewaySettings':_0x4d4ffb[_0x4e073f(0x125)]?JSON[_0x4e073f(0x148)](_0x4d4ffb[_0x4e073f(0x125)]):null,'publicKey':_0x4d4ffb[_0x4e073f(0x122)],'wallets':{'usdtPolygonWallet':_0x4d4ffb[_0x4e073f(0x120)],'usdtTrcWallet':_0x4d4ffb[_0x4e073f(0x138)],'usdtErcWallet':_0x4d4ffb[_0x4e073f(0x133)],'usdcPolygonWallet':_0x4d4ffb[_0x4e073f(0x124)]},'status':_0x4d4ffb[_0x4e073f(0x134)],'createdAt':_0x4d4ffb[_0x4e073f(0x12a)]};}async[a64_0x18b0a0(0x157)](_0x21f62d,_0x443198){const _0x131316=a64_0x18b0a0,_0x34ffec={..._0x443198};_0x443198[_0x131316(0x13f)]&&(_0x34ffec[_0x131316(0x13f)]=await bcryptjs_1['default'][_0x131316(0x14a)](_0x443198[_0x131316(0x13f)],0xc));_0x443198['fullName']&&(_0x34ffec[_0x131316(0x153)]=_0x443198['fullName'],delete _0x34ffec[_0x131316(0x123)]);_0x443198[_0x131316(0x11e)]&&(_0x34ffec[_0x131316(0x149)]=_0x443198[_0x131316(0x11e)],delete _0x34ffec[_0x131316(0x11e)]);_0x443198[_0x131316(0x12d)]&&(_0x34ffec[_0x131316(0x137)]=_0x443198[_0x131316(0x12d)],delete _0x34ffec['merchantUrl']);_0x443198['gateways']&&(_0x34ffec[_0x131316(0x12e)]=JSON[_0x131316(0x126)](_0x443198[_0x131316(0x11f)]),delete _0x34ffec[_0x131316(0x11f)]);_0x443198[_0x131316(0x125)]&&(_0x34ffec[_0x131316(0x125)]=JSON[_0x131316(0x126)](_0x443198[_0x131316(0x125)]),delete _0x34ffec[_0x131316(0x125)]);_0x443198[_0x131316(0x144)]&&(_0x443198[_0x131316(0x144)][_0x131316(0x120)]!==undefined&&(_0x34ffec[_0x131316(0x120)]=_0x443198[_0x131316(0x144)][_0x131316(0x120)]||null),_0x443198[_0x131316(0x144)]['usdtTrcWallet']!==undefined&&(_0x34ffec[_0x131316(0x138)]=_0x443198[_0x131316(0x144)][_0x131316(0x138)]||null),_0x443198[_0x131316(0x144)]['usdtErcWallet']!==undefined&&(_0x34ffec[_0x131316(0x133)]=_0x443198[_0x131316(0x144)]['usdtErcWallet']||null),_0x443198[_0x131316(0x144)][_0x131316(0x124)]!==undefined&&(_0x34ffec[_0x131316(0x124)]=_0x443198['wallets'][_0x131316(0x124)]||null),delete _0x34ffec[_0x131316(0x144)]);const _0x3f1edd=await database_1['default'][_0x131316(0x13b)][_0x131316(0x155)]({'where':{'id':_0x21f62d},'data':_0x34ffec,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x3f1edd['id'],'fullName':_0x3f1edd[_0x131316(0x153)],'username':_0x3f1edd[_0x131316(0x151)],'telegramId':_0x3f1edd[_0x131316(0x149)],'merchantUrl':_0x3f1edd[_0x131316(0x137)],'gateways':_0x3f1edd[_0x131316(0x12e)]?JSON[_0x131316(0x148)](_0x3f1edd[_0x131316(0x12e)]):null,'gatewaySettings':_0x3f1edd['gatewaySettings']?JSON[_0x131316(0x148)](_0x3f1edd[_0x131316(0x125)]):null,'publicKey':_0x3f1edd[_0x131316(0x122)],'wallets':{'usdtPolygonWallet':_0x3f1edd[_0x131316(0x120)],'usdtTrcWallet':_0x3f1edd['usdtTrcWallet'],'usdtErcWallet':_0x3f1edd[_0x131316(0x133)],'usdcPolygonWallet':_0x3f1edd[_0x131316(0x124)]},'status':_0x3f1edd[_0x131316(0x134)],'createdAt':_0x3f1edd[_0x131316(0x12a)]};}async[a64_0x18b0a0(0x135)](_0x2d6461){const _0x181876=a64_0x18b0a0;await database_1[_0x181876(0x12c)][_0x181876(0x13b)]['delete']({'where':{'id':_0x2d6461}});}}exports[a64_0x18b0a0(0x14c)]=UserService;