'use strict';const a57_0x289471=a57_0x2f57;(function(_0x2b8254,_0x4d2a1a){const _0x13791f=a57_0x2f57,_0x5316af=_0x2b8254();while(!![]){try{const _0xb991b3=-parseInt(_0x13791f(0xbf))/0x1*(parseInt(_0x13791f(0xe5))/0x2)+-parseInt(_0x13791f(0xb9))/0x3*(parseInt(_0x13791f(0xbb))/0x4)+-parseInt(_0x13791f(0xe8))/0x5*(parseInt(_0x13791f(0xb6))/0x6)+parseInt(_0x13791f(0xd9))/0x7+-parseInt(_0x13791f(0xe3))/0x8*(-parseInt(_0x13791f(0xe6))/0x9)+-parseInt(_0x13791f(0xea))/0xa+parseInt(_0x13791f(0xd2))/0xb;if(_0xb991b3===_0x4d2a1a)break;else _0x5316af['push'](_0x5316af['shift']());}catch(_0x2649f8){_0x5316af['push'](_0x5316af['shift']());}}}(a57_0x570d,0x4d2cb));function a57_0x2f57(_0x58846a,_0x549edc){const _0x570dba=a57_0x570d();return a57_0x2f57=function(_0x2f5728,_0x411de3){_0x2f5728=_0x2f5728-0xb3;let _0x2ddf91=_0x570dba[_0x2f5728];return _0x2ddf91;},a57_0x2f57(_0x58846a,_0x549edc);}var __importDefault=this&&this[a57_0x289471(0xd3)]||function(_0xf0d165){const _0x29cfdb=a57_0x289471;return _0xf0d165&&_0xf0d165[_0x29cfdb(0xe7)]?_0xf0d165:{'default':_0xf0d165};};Object[a57_0x289471(0xcc)](exports,a57_0x289471(0xe7),{'value':!![]}),exports['UserService']=void 0x0;const bcryptjs_1=__importDefault(require(a57_0x289471(0xc4))),crypto_1=__importDefault(require(a57_0x289471(0xd8))),database_1=__importDefault(require(a57_0x289471(0xba)));class UserService{[a57_0x289471(0xcb)](){const _0x984a00=a57_0x289471,_0x2bfde6=_0x984a00(0xc7)+crypto_1[_0x984a00(0xe2)]['randomBytes'](0x20)['toString'](_0x984a00(0xd4)),_0x4600cf='sk_'+crypto_1['default'][_0x984a00(0xb4)](0x20)['toString'](_0x984a00(0xd4));return{'publicKey':_0x2bfde6,'secretKey':_0x4600cf};}async[a57_0x289471(0xe9)](_0xaf456b){const _0x4b44c8=a57_0x289471,{fullName:_0x383d62,username:_0x8e046,password:_0x267c3d,telegramId:_0x4d404e,merchantUrl:_0x2725af,gateways:_0x3ed188,gatewaySettings:_0x2f4fe8,wallets:_0x320767}=_0xaf456b,_0x4ba3f0=await database_1['default'][_0x4b44c8(0xb3)]['findUnique']({'where':{'username':_0x8e046}});if(_0x4ba3f0)throw new Error('Username\x20already\x20exists');if(_0x4d404e){const _0x215dbf=await database_1[_0x4b44c8(0xe2)]['shop'][_0x4b44c8(0xdd)]({'where':{'telegram':_0x4d404e}});if(_0x215dbf)throw new Error('Telegram\x20username\x20already\x20exists');}const _0x5230b5=await bcryptjs_1[_0x4b44c8(0xe2)][_0x4b44c8(0xe4)](_0x267c3d,0xc),{publicKey:_0x22c238,secretKey:_0x22494f}=this[_0x4b44c8(0xcb)](),_0x59c49b=await database_1['default'][_0x4b44c8(0xb3)][_0x4b44c8(0xc1)]({'data':{'name':_0x383d62,'username':_0x8e046,'password':_0x5230b5,'telegram':_0x4d404e,'shopUrl':_0x2725af,'paymentGateways':_0x3ed188?JSON[_0x4b44c8(0xb7)](_0x3ed188):null,'gatewaySettings':_0x2f4fe8?JSON[_0x4b44c8(0xb7)](_0x2f4fe8):null,'usdtPolygonWallet':_0x320767?.[_0x4b44c8(0xc3)]||null,'usdtTrcWallet':_0x320767?.['usdtTrcWallet']||null,'usdtErcWallet':_0x320767?.[_0x4b44c8(0xdc)]||null,'usdcPolygonWallet':_0x320767?.[_0x4b44c8(0xd0)]||null,'publicKey':_0x22c238,'secretKey':_0x22494f,'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x59c49b['id'],'fullName':_0x59c49b[_0x4b44c8(0xdf)],'username':_0x59c49b['username'],'telegramId':_0x59c49b[_0x4b44c8(0xc9)],'merchantUrl':_0x59c49b['shopUrl'],'gateways':_0x59c49b[_0x4b44c8(0xcd)]?JSON[_0x4b44c8(0xd5)](_0x59c49b[_0x4b44c8(0xcd)]):null,'gatewaySettings':_0x59c49b[_0x4b44c8(0xb8)]?JSON[_0x4b44c8(0xd5)](_0x59c49b[_0x4b44c8(0xb8)]):null,'publicKey':_0x59c49b[_0x4b44c8(0xe0)],'wallets':{'usdtPolygonWallet':_0x59c49b[_0x4b44c8(0xc3)],'usdtTrcWallet':_0x59c49b['usdtTrcWallet'],'usdtErcWallet':_0x59c49b['usdtErcWallet'],'usdcPolygonWallet':_0x59c49b[_0x4b44c8(0xd0)]},'status':_0x59c49b[_0x4b44c8(0xc5)],'createdAt':_0x59c49b[_0x4b44c8(0xca)]};}async['getAllUsers'](){const _0xb364b=a57_0x289471,_0x1a0ff4=await database_1[_0xb364b(0xe2)][_0xb364b(0xb3)]['findMany']({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0xb364b(0xc2)}});return _0x1a0ff4[_0xb364b(0xbc)](_0x4ca6b4=>({'id':_0x4ca6b4['id'],'fullName':_0x4ca6b4['name'],'username':_0x4ca6b4[_0xb364b(0xbe)],'telegramId':_0x4ca6b4['telegram'],'merchantUrl':_0x4ca6b4[_0xb364b(0xe1)],'gateways':_0x4ca6b4[_0xb364b(0xcd)]?JSON[_0xb364b(0xd5)](_0x4ca6b4[_0xb364b(0xcd)]):null,'gatewaySettings':_0x4ca6b4[_0xb364b(0xb8)]?JSON[_0xb364b(0xd5)](_0x4ca6b4[_0xb364b(0xb8)]):null,'publicKey':_0x4ca6b4[_0xb364b(0xe0)],'wallets':{'usdtPolygonWallet':_0x4ca6b4[_0xb364b(0xc3)],'usdtTrcWallet':_0x4ca6b4[_0xb364b(0xcf)],'usdtErcWallet':_0x4ca6b4[_0xb364b(0xdc)],'usdcPolygonWallet':_0x4ca6b4[_0xb364b(0xd0)]},'status':_0x4ca6b4['status'],'createdAt':_0x4ca6b4[_0xb364b(0xca)]}));}async[a57_0x289471(0xdb)](_0x436e0f){const _0x2219e4=a57_0x289471,_0x185b0c=await database_1['default'][_0x2219e4(0xb3)][_0x2219e4(0xdd)]({'where':{'id':_0x436e0f},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x185b0c)return null;return{'id':_0x185b0c['id'],'fullName':_0x185b0c[_0x2219e4(0xdf)],'username':_0x185b0c['username'],'telegramId':_0x185b0c[_0x2219e4(0xc9)],'merchantUrl':_0x185b0c[_0x2219e4(0xe1)],'gateways':_0x185b0c['paymentGateways']?JSON[_0x2219e4(0xd5)](_0x185b0c['paymentGateways']):null,'gatewaySettings':_0x185b0c[_0x2219e4(0xb8)]?JSON['parse'](_0x185b0c[_0x2219e4(0xb8)]):null,'publicKey':_0x185b0c[_0x2219e4(0xe0)],'wallets':{'usdtPolygonWallet':_0x185b0c[_0x2219e4(0xc3)],'usdtTrcWallet':_0x185b0c[_0x2219e4(0xcf)],'usdtErcWallet':_0x185b0c[_0x2219e4(0xdc)],'usdcPolygonWallet':_0x185b0c[_0x2219e4(0xd0)]},'status':_0x185b0c['status'],'createdAt':_0x185b0c['createdAt']};}async[a57_0x289471(0xd6)](_0xb8d2f,_0x3d07b5){const _0x34f270=a57_0x289471,_0x3c1dd6={..._0x3d07b5};_0x3d07b5[_0x34f270(0xb5)]&&(_0x3c1dd6[_0x34f270(0xb5)]=await bcryptjs_1[_0x34f270(0xe2)]['hash'](_0x3d07b5['password'],0xc));_0x3d07b5['fullName']&&(_0x3c1dd6['name']=_0x3d07b5[_0x34f270(0xbd)],delete _0x3c1dd6[_0x34f270(0xbd)]);_0x3d07b5[_0x34f270(0xda)]&&(_0x3c1dd6[_0x34f270(0xc9)]=_0x3d07b5[_0x34f270(0xda)],delete _0x3c1dd6[_0x34f270(0xda)]);_0x3d07b5[_0x34f270(0xd1)]&&(_0x3c1dd6[_0x34f270(0xe1)]=_0x3d07b5['merchantUrl'],delete _0x3c1dd6[_0x34f270(0xd1)]);_0x3d07b5['gateways']&&(_0x3c1dd6[_0x34f270(0xcd)]=JSON[_0x34f270(0xb7)](_0x3d07b5[_0x34f270(0xd7)]),delete _0x3c1dd6[_0x34f270(0xd7)]);_0x3d07b5[_0x34f270(0xb8)]&&(_0x3c1dd6[_0x34f270(0xb8)]=JSON[_0x34f270(0xb7)](_0x3d07b5['gatewaySettings']),delete _0x3c1dd6[_0x34f270(0xb8)]);_0x3d07b5[_0x34f270(0xde)]&&(_0x3d07b5[_0x34f270(0xde)][_0x34f270(0xc3)]!==undefined&&(_0x3c1dd6['usdtPolygonWallet']=_0x3d07b5['wallets'][_0x34f270(0xc3)]||null),_0x3d07b5[_0x34f270(0xde)][_0x34f270(0xcf)]!==undefined&&(_0x3c1dd6['usdtTrcWallet']=_0x3d07b5[_0x34f270(0xde)]['usdtTrcWallet']||null),_0x3d07b5[_0x34f270(0xde)][_0x34f270(0xdc)]!==undefined&&(_0x3c1dd6['usdtErcWallet']=_0x3d07b5[_0x34f270(0xde)]['usdtErcWallet']||null),_0x3d07b5[_0x34f270(0xde)][_0x34f270(0xd0)]!==undefined&&(_0x3c1dd6['usdcPolygonWallet']=_0x3d07b5[_0x34f270(0xde)][_0x34f270(0xd0)]||null),delete _0x3c1dd6[_0x34f270(0xde)]);const _0x4ddd9e=await database_1['default'][_0x34f270(0xb3)][_0x34f270(0xc0)]({'where':{'id':_0xb8d2f},'data':_0x3c1dd6,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x4ddd9e['id'],'fullName':_0x4ddd9e[_0x34f270(0xdf)],'username':_0x4ddd9e[_0x34f270(0xbe)],'telegramId':_0x4ddd9e[_0x34f270(0xc9)],'merchantUrl':_0x4ddd9e['shopUrl'],'gateways':_0x4ddd9e[_0x34f270(0xcd)]?JSON['parse'](_0x4ddd9e['paymentGateways']):null,'gatewaySettings':_0x4ddd9e[_0x34f270(0xb8)]?JSON[_0x34f270(0xd5)](_0x4ddd9e[_0x34f270(0xb8)]):null,'publicKey':_0x4ddd9e['publicKey'],'wallets':{'usdtPolygonWallet':_0x4ddd9e[_0x34f270(0xc3)],'usdtTrcWallet':_0x4ddd9e[_0x34f270(0xcf)],'usdtErcWallet':_0x4ddd9e[_0x34f270(0xdc)],'usdcPolygonWallet':_0x4ddd9e[_0x34f270(0xd0)]},'status':_0x4ddd9e[_0x34f270(0xc5)],'createdAt':_0x4ddd9e[_0x34f270(0xca)]};}async[a57_0x289471(0xc6)](_0x2dfb17){const _0x4cffa1=a57_0x289471;await database_1[_0x4cffa1(0xe2)]['shop'][_0x4cffa1(0xc8)]({'where':{'id':_0x2dfb17}});}}function a57_0x570d(){const _0x455647=['shopUrl','default','848ZpMDAu','hash','634xAdPnk','8406buFdYy','__esModule','235715FZPjIk','createUser','3601050GzKKxx','shop','randomBytes','password','66ySbOCE','stringify','gatewaySettings','3JjdGfS','../config/database','913624iONdMQ','map','fullName','username','279oprWXq','update','create','desc','usdtPolygonWallet','bcryptjs','status','deleteUser','pk_','delete','telegram','createdAt','generateApiKeys','defineProperty','paymentGateways','UserService','usdtTrcWallet','usdcPolygonWallet','merchantUrl','10978187fKBJZo','__importDefault','hex','parse','updateUser','gateways','crypto','2902291uNyNLA','telegramId','getUserById','usdtErcWallet','findUnique','wallets','name','publicKey'];a57_0x570d=function(){return _0x455647;};return a57_0x570d();}exports[a57_0x289471(0xce)]=UserService;