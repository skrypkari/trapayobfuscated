'use strict';const a51_0x52fa40=a51_0x3d45;function a51_0x3a13(){const _0xb5f668=['fullName','ACTIVE','desc','create','shopUrl','usdtErcWallet','Telegram\x20username\x20already\x20exists','deleteUser','hex','usdtPolygonWallet','UserService','publicKey','default','updateUser','map','gatewaySettings','__importDefault','merchantUrl','6yQnkeq','generateApiKeys','2565138EEQCZj','paymentGateways','shop','33GgJTre','defineProperty','getUserById','parse','bcryptjs','telegram','892210MNOlck','telegramId','41066Pxugmb','5ZwfEJD','usdtTrcWallet','stringify','gateways','9054522vBcyvv','createdAt','findUnique','3230255mPhors','wallets','__esModule','getAllUsers','hash','password','toString','usdcPolygonWallet','pk_','4659137VwKvfO','delete','2921564wNdNMa','name','username','randomBytes','8oAmoTH','status','Username\x20already\x20exists','sk_'];a51_0x3a13=function(){return _0xb5f668;};return a51_0x3a13();}(function(_0x5650da,_0x427a20){const _0x4e3eae=a51_0x3d45,_0x1099de=_0x5650da();while(!![]){try{const _0x20e74e=parseInt(_0x4e3eae(0x20e))/0x1*(parseInt(_0x4e3eae(0x20d))/0x2)+parseInt(_0x4e3eae(0x200))/0x3*(-parseInt(_0x4e3eae(0x1e6))/0x4)+parseInt(_0x4e3eae(0x215))/0x5+-parseInt(_0x4e3eae(0x202))/0x6+parseInt(_0x4e3eae(0x1e4))/0x7*(parseInt(_0x4e3eae(0x1ea))/0x8)+parseInt(_0x4e3eae(0x212))/0x9+parseInt(_0x4e3eae(0x20b))/0xa*(parseInt(_0x4e3eae(0x205))/0xb);if(_0x20e74e===_0x427a20)break;else _0x1099de['push'](_0x1099de['shift']());}catch(_0xb2c1d6){_0x1099de['push'](_0x1099de['shift']());}}}(a51_0x3a13,0xc33eb));var __importDefault=this&&this[a51_0x52fa40(0x1fe)]||function(_0x532c86){const _0x2d2c42=a51_0x52fa40;return _0x532c86&&_0x532c86[_0x2d2c42(0x217)]?_0x532c86:{'default':_0x532c86};};Object[a51_0x52fa40(0x206)](exports,a51_0x52fa40(0x217),{'value':!![]}),exports['UserService']=void 0x0;const bcryptjs_1=__importDefault(require(a51_0x52fa40(0x209))),crypto_1=__importDefault(require('crypto')),database_1=__importDefault(require('../config/database'));function a51_0x3d45(_0x1d2f54,_0x1772c0){const _0x3a1382=a51_0x3a13();return a51_0x3d45=function(_0x3d4549,_0x5c5513){_0x3d4549=_0x3d4549-0x1e2;let _0x494ae7=_0x3a1382[_0x3d4549];return _0x494ae7;},a51_0x3d45(_0x1d2f54,_0x1772c0);}class UserService{[a51_0x52fa40(0x201)](){const _0x5dbf29=a51_0x52fa40,_0x451866=_0x5dbf29(0x1e3)+crypto_1[_0x5dbf29(0x1fa)][_0x5dbf29(0x1e9)](0x20)[_0x5dbf29(0x21b)](_0x5dbf29(0x1f6)),_0x3b5e23=_0x5dbf29(0x1ed)+crypto_1[_0x5dbf29(0x1fa)][_0x5dbf29(0x1e9)](0x20)[_0x5dbf29(0x21b)]('hex');return{'publicKey':_0x451866,'secretKey':_0x3b5e23};}async['createUser'](_0x1728d4){const _0x5e4ec6=a51_0x52fa40,{fullName:_0x55d001,username:_0x1eb744,password:_0x1a06d1,telegramId:_0x1f2028,merchantUrl:_0x52ad94,gateways:_0x2d8e94,gatewaySettings:_0x2c67bc,wallets:_0x1a275e}=_0x1728d4,_0xade013=await database_1[_0x5e4ec6(0x1fa)][_0x5e4ec6(0x204)]['findUnique']({'where':{'username':_0x1eb744}});if(_0xade013)throw new Error(_0x5e4ec6(0x1ec));if(_0x1f2028){const _0x299089=await database_1[_0x5e4ec6(0x1fa)]['shop']['findUnique']({'where':{'telegram':_0x1f2028}});if(_0x299089)throw new Error(_0x5e4ec6(0x1f4));}const _0x11d24b=await bcryptjs_1[_0x5e4ec6(0x1fa)][_0x5e4ec6(0x219)](_0x1a06d1,0xc),{publicKey:_0x3dbc78,secretKey:_0x812d20}=this[_0x5e4ec6(0x201)](),_0x57b33a=await database_1[_0x5e4ec6(0x1fa)][_0x5e4ec6(0x204)][_0x5e4ec6(0x1f1)]({'data':{'name':_0x55d001,'username':_0x1eb744,'password':_0x11d24b,'telegram':_0x1f2028,'shopUrl':_0x52ad94,'paymentGateways':_0x2d8e94?JSON[_0x5e4ec6(0x210)](_0x2d8e94):null,'gatewaySettings':_0x2c67bc?JSON[_0x5e4ec6(0x210)](_0x2c67bc):null,'usdtPolygonWallet':_0x1a275e?.[_0x5e4ec6(0x1f7)]||null,'usdtTrcWallet':_0x1a275e?.[_0x5e4ec6(0x20f)]||null,'usdtErcWallet':_0x1a275e?.['usdtErcWallet']||null,'usdcPolygonWallet':_0x1a275e?.[_0x5e4ec6(0x1e2)]||null,'publicKey':_0x3dbc78,'secretKey':_0x812d20,'status':_0x5e4ec6(0x1ef)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x57b33a['id'],'fullName':_0x57b33a[_0x5e4ec6(0x1e7)],'username':_0x57b33a[_0x5e4ec6(0x1e8)],'telegramId':_0x57b33a[_0x5e4ec6(0x20a)],'merchantUrl':_0x57b33a[_0x5e4ec6(0x1f2)],'gateways':_0x57b33a['paymentGateways']?JSON[_0x5e4ec6(0x208)](_0x57b33a[_0x5e4ec6(0x203)]):null,'gatewaySettings':_0x57b33a[_0x5e4ec6(0x1fd)]?JSON[_0x5e4ec6(0x208)](_0x57b33a['gatewaySettings']):null,'publicKey':_0x57b33a[_0x5e4ec6(0x1f9)],'wallets':{'usdtPolygonWallet':_0x57b33a[_0x5e4ec6(0x1f7)],'usdtTrcWallet':_0x57b33a[_0x5e4ec6(0x20f)],'usdtErcWallet':_0x57b33a[_0x5e4ec6(0x1f3)],'usdcPolygonWallet':_0x57b33a[_0x5e4ec6(0x1e2)]},'status':_0x57b33a[_0x5e4ec6(0x1eb)],'createdAt':_0x57b33a[_0x5e4ec6(0x213)]};}async[a51_0x52fa40(0x218)](){const _0x336d5a=a51_0x52fa40,_0x24c668=await database_1[_0x336d5a(0x1fa)][_0x336d5a(0x204)]['findMany']({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x336d5a(0x1f0)}});return _0x24c668[_0x336d5a(0x1fc)](_0x4a7297=>({'id':_0x4a7297['id'],'fullName':_0x4a7297['name'],'username':_0x4a7297[_0x336d5a(0x1e8)],'telegramId':_0x4a7297[_0x336d5a(0x20a)],'merchantUrl':_0x4a7297['shopUrl'],'gateways':_0x4a7297[_0x336d5a(0x203)]?JSON['parse'](_0x4a7297[_0x336d5a(0x203)]):null,'gatewaySettings':_0x4a7297['gatewaySettings']?JSON['parse'](_0x4a7297[_0x336d5a(0x1fd)]):null,'publicKey':_0x4a7297[_0x336d5a(0x1f9)],'wallets':{'usdtPolygonWallet':_0x4a7297[_0x336d5a(0x1f7)],'usdtTrcWallet':_0x4a7297[_0x336d5a(0x20f)],'usdtErcWallet':_0x4a7297[_0x336d5a(0x1f3)],'usdcPolygonWallet':_0x4a7297[_0x336d5a(0x1e2)]},'status':_0x4a7297[_0x336d5a(0x1eb)],'createdAt':_0x4a7297['createdAt']}));}async[a51_0x52fa40(0x207)](_0xd24ce){const _0x4e16dc=a51_0x52fa40,_0x4aba29=await database_1[_0x4e16dc(0x1fa)]['shop'][_0x4e16dc(0x214)]({'where':{'id':_0xd24ce},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x4aba29)return null;return{'id':_0x4aba29['id'],'fullName':_0x4aba29[_0x4e16dc(0x1e7)],'username':_0x4aba29[_0x4e16dc(0x1e8)],'telegramId':_0x4aba29[_0x4e16dc(0x20a)],'merchantUrl':_0x4aba29['shopUrl'],'gateways':_0x4aba29[_0x4e16dc(0x203)]?JSON['parse'](_0x4aba29[_0x4e16dc(0x203)]):null,'gatewaySettings':_0x4aba29[_0x4e16dc(0x1fd)]?JSON[_0x4e16dc(0x208)](_0x4aba29['gatewaySettings']):null,'publicKey':_0x4aba29[_0x4e16dc(0x1f9)],'wallets':{'usdtPolygonWallet':_0x4aba29[_0x4e16dc(0x1f7)],'usdtTrcWallet':_0x4aba29['usdtTrcWallet'],'usdtErcWallet':_0x4aba29[_0x4e16dc(0x1f3)],'usdcPolygonWallet':_0x4aba29[_0x4e16dc(0x1e2)]},'status':_0x4aba29[_0x4e16dc(0x1eb)],'createdAt':_0x4aba29['createdAt']};}async[a51_0x52fa40(0x1fb)](_0x2ddeaa,_0x31f52d){const _0x1154f2=a51_0x52fa40,_0x441409={..._0x31f52d};_0x31f52d[_0x1154f2(0x21a)]&&(_0x441409[_0x1154f2(0x21a)]=await bcryptjs_1['default']['hash'](_0x31f52d[_0x1154f2(0x21a)],0xc));_0x31f52d['fullName']&&(_0x441409['name']=_0x31f52d['fullName'],delete _0x441409[_0x1154f2(0x1ee)]);_0x31f52d[_0x1154f2(0x20c)]&&(_0x441409['telegram']=_0x31f52d[_0x1154f2(0x20c)],delete _0x441409['telegramId']);_0x31f52d[_0x1154f2(0x1ff)]&&(_0x441409[_0x1154f2(0x1f2)]=_0x31f52d[_0x1154f2(0x1ff)],delete _0x441409['merchantUrl']);_0x31f52d[_0x1154f2(0x211)]&&(_0x441409[_0x1154f2(0x203)]=JSON[_0x1154f2(0x210)](_0x31f52d[_0x1154f2(0x211)]),delete _0x441409['gateways']);_0x31f52d[_0x1154f2(0x1fd)]&&(_0x441409[_0x1154f2(0x1fd)]=JSON[_0x1154f2(0x210)](_0x31f52d['gatewaySettings']),delete _0x441409[_0x1154f2(0x1fd)]);_0x31f52d[_0x1154f2(0x216)]&&(_0x31f52d[_0x1154f2(0x216)]['usdtPolygonWallet']!==undefined&&(_0x441409[_0x1154f2(0x1f7)]=_0x31f52d[_0x1154f2(0x216)]['usdtPolygonWallet']||null),_0x31f52d[_0x1154f2(0x216)][_0x1154f2(0x20f)]!==undefined&&(_0x441409[_0x1154f2(0x20f)]=_0x31f52d[_0x1154f2(0x216)][_0x1154f2(0x20f)]||null),_0x31f52d['wallets'][_0x1154f2(0x1f3)]!==undefined&&(_0x441409[_0x1154f2(0x1f3)]=_0x31f52d[_0x1154f2(0x216)]['usdtErcWallet']||null),_0x31f52d[_0x1154f2(0x216)][_0x1154f2(0x1e2)]!==undefined&&(_0x441409[_0x1154f2(0x1e2)]=_0x31f52d[_0x1154f2(0x216)]['usdcPolygonWallet']||null),delete _0x441409[_0x1154f2(0x216)]);const _0x3b13e4=await database_1[_0x1154f2(0x1fa)][_0x1154f2(0x204)]['update']({'where':{'id':_0x2ddeaa},'data':_0x441409,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x3b13e4['id'],'fullName':_0x3b13e4['name'],'username':_0x3b13e4[_0x1154f2(0x1e8)],'telegramId':_0x3b13e4[_0x1154f2(0x20a)],'merchantUrl':_0x3b13e4[_0x1154f2(0x1f2)],'gateways':_0x3b13e4[_0x1154f2(0x203)]?JSON['parse'](_0x3b13e4[_0x1154f2(0x203)]):null,'gatewaySettings':_0x3b13e4[_0x1154f2(0x1fd)]?JSON[_0x1154f2(0x208)](_0x3b13e4[_0x1154f2(0x1fd)]):null,'publicKey':_0x3b13e4[_0x1154f2(0x1f9)],'wallets':{'usdtPolygonWallet':_0x3b13e4[_0x1154f2(0x1f7)],'usdtTrcWallet':_0x3b13e4[_0x1154f2(0x20f)],'usdtErcWallet':_0x3b13e4[_0x1154f2(0x1f3)],'usdcPolygonWallet':_0x3b13e4['usdcPolygonWallet']},'status':_0x3b13e4[_0x1154f2(0x1eb)],'createdAt':_0x3b13e4[_0x1154f2(0x213)]};}async[a51_0x52fa40(0x1f5)](_0xb1d028){const _0x1e05b5=a51_0x52fa40;await database_1['default'][_0x1e05b5(0x204)][_0x1e05b5(0x1e5)]({'where':{'id':_0xb1d028}});}}exports[a51_0x52fa40(0x1f8)]=UserService;