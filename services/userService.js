'use strict';const a57_0xcd3712=a57_0xc01d;(function(_0x19c18a,_0x1cffca){const _0x2d1e47=a57_0xc01d,_0x3895d8=_0x19c18a();while(!![]){try{const _0x3fda1d=parseInt(_0x2d1e47(0x1bd))/0x1*(parseInt(_0x2d1e47(0x198))/0x2)+-parseInt(_0x2d1e47(0x1be))/0x3+parseInt(_0x2d1e47(0x197))/0x4*(parseInt(_0x2d1e47(0x19d))/0x5)+parseInt(_0x2d1e47(0x1b5))/0x6+parseInt(_0x2d1e47(0x1b1))/0x7+-parseInt(_0x2d1e47(0x19f))/0x8+-parseInt(_0x2d1e47(0x1ac))/0x9*(parseInt(_0x2d1e47(0x18d))/0xa);if(_0x3fda1d===_0x1cffca)break;else _0x3895d8['push'](_0x3895d8['shift']());}catch(_0x56f223){_0x3895d8['push'](_0x3895d8['shift']());}}}(a57_0x174d,0x3f0a0));var __importDefault=this&&this[a57_0xcd3712(0x1a3)]||function(_0x29f978){return _0x29f978&&_0x29f978['__esModule']?_0x29f978:{'default':_0x29f978};};Object[a57_0xcd3712(0x1b9)](exports,a57_0xcd3712(0x18e),{'value':!![]}),exports[a57_0xcd3712(0x18b)]=void 0x0;const bcryptjs_1=__importDefault(require(a57_0xcd3712(0x1b6))),crypto_1=__importDefault(require(a57_0xcd3712(0x1bc))),database_1=__importDefault(require(a57_0xcd3712(0x1b7)));class UserService{[a57_0xcd3712(0x189)](){const _0x533580=a57_0xcd3712,_0x5ac4a3=_0x533580(0x195)+crypto_1[_0x533580(0x1b3)][_0x533580(0x1ba)](0x20)['toString'](_0x533580(0x19c)),_0x260d4c=_0x533580(0x1b4)+crypto_1[_0x533580(0x1b3)][_0x533580(0x1ba)](0x20)[_0x533580(0x1a2)](_0x533580(0x19c));return{'publicKey':_0x5ac4a3,'secretKey':_0x260d4c};}async[a57_0xcd3712(0x1a5)](_0x2a647f){const _0x45c7d7=a57_0xcd3712,{fullName:_0x12de69,username:_0x5173e6,password:_0x3ecc0f,telegramId:_0x1b0047,merchantUrl:_0x4ca053,gateways:_0x5b8b36,gatewaySettings:_0x3c8d26,wallets:_0x6c0668}=_0x2a647f,_0x2d6963=await database_1['default'][_0x45c7d7(0x1a1)][_0x45c7d7(0x1a0)]({'where':{'username':_0x5173e6}});if(_0x2d6963)throw new Error('Username\x20already\x20exists');if(_0x1b0047){const _0x386ef4=await database_1[_0x45c7d7(0x1b3)][_0x45c7d7(0x1a1)][_0x45c7d7(0x1a0)]({'where':{'telegram':_0x1b0047}});if(_0x386ef4)throw new Error(_0x45c7d7(0x1aa));}const _0x52fe18=await bcryptjs_1[_0x45c7d7(0x1b3)]['hash'](_0x3ecc0f,0xc),{publicKey:_0x4c825f,secretKey:_0x1fffd1}=this[_0x45c7d7(0x189)](),_0x5299c8=await database_1[_0x45c7d7(0x1b3)]['shop'][_0x45c7d7(0x18c)]({'data':{'name':_0x12de69,'username':_0x5173e6,'password':_0x52fe18,'telegram':_0x1b0047,'shopUrl':_0x4ca053,'paymentGateways':_0x5b8b36?JSON[_0x45c7d7(0x1ae)](_0x5b8b36):null,'gatewaySettings':_0x3c8d26?JSON[_0x45c7d7(0x1ae)](_0x3c8d26):null,'usdtPolygonWallet':_0x6c0668?.[_0x45c7d7(0x18a)]||null,'usdtTrcWallet':_0x6c0668?.[_0x45c7d7(0x1bb)]||null,'usdtErcWallet':_0x6c0668?.['usdtErcWallet']||null,'usdcPolygonWallet':_0x6c0668?.[_0x45c7d7(0x18f)]||null,'publicKey':_0x4c825f,'secretKey':_0x1fffd1,'status':_0x45c7d7(0x1bf)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x5299c8['id'],'fullName':_0x5299c8[_0x45c7d7(0x1ab)],'username':_0x5299c8[_0x45c7d7(0x194)],'telegramId':_0x5299c8['telegram'],'merchantUrl':_0x5299c8[_0x45c7d7(0x1ad)],'gateways':_0x5299c8[_0x45c7d7(0x1c0)]?JSON[_0x45c7d7(0x1b8)](_0x5299c8[_0x45c7d7(0x1c0)]):null,'gatewaySettings':_0x5299c8['gatewaySettings']?JSON['parse'](_0x5299c8[_0x45c7d7(0x19b)]):null,'publicKey':_0x5299c8[_0x45c7d7(0x1a9)],'wallets':{'usdtPolygonWallet':_0x5299c8['usdtPolygonWallet'],'usdtTrcWallet':_0x5299c8[_0x45c7d7(0x1bb)],'usdtErcWallet':_0x5299c8[_0x45c7d7(0x19a)],'usdcPolygonWallet':_0x5299c8[_0x45c7d7(0x18f)]},'status':_0x5299c8['status'],'createdAt':_0x5299c8['createdAt']};}async[a57_0xcd3712(0x192)](){const _0x3ed63c=a57_0xcd3712,_0x46f798=await database_1['default']['shop'][_0x3ed63c(0x191)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':'desc'}});return _0x46f798[_0x3ed63c(0x19e)](_0x38e61d=>({'id':_0x38e61d['id'],'fullName':_0x38e61d[_0x3ed63c(0x1ab)],'username':_0x38e61d['username'],'telegramId':_0x38e61d[_0x3ed63c(0x1b2)],'merchantUrl':_0x38e61d[_0x3ed63c(0x1ad)],'gateways':_0x38e61d['paymentGateways']?JSON[_0x3ed63c(0x1b8)](_0x38e61d[_0x3ed63c(0x1c0)]):null,'gatewaySettings':_0x38e61d['gatewaySettings']?JSON[_0x3ed63c(0x1b8)](_0x38e61d[_0x3ed63c(0x19b)]):null,'publicKey':_0x38e61d[_0x3ed63c(0x1a9)],'wallets':{'usdtPolygonWallet':_0x38e61d[_0x3ed63c(0x18a)],'usdtTrcWallet':_0x38e61d[_0x3ed63c(0x1bb)],'usdtErcWallet':_0x38e61d[_0x3ed63c(0x19a)],'usdcPolygonWallet':_0x38e61d['usdcPolygonWallet']},'status':_0x38e61d['status'],'createdAt':_0x38e61d[_0x3ed63c(0x1af)]}));}async['getUserById'](_0x34125d){const _0x1af2a8=a57_0xcd3712,_0x1a8047=await database_1[_0x1af2a8(0x1b3)][_0x1af2a8(0x1a1)][_0x1af2a8(0x1a0)]({'where':{'id':_0x34125d},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x1a8047)return null;return{'id':_0x1a8047['id'],'fullName':_0x1a8047[_0x1af2a8(0x1ab)],'username':_0x1a8047[_0x1af2a8(0x194)],'telegramId':_0x1a8047['telegram'],'merchantUrl':_0x1a8047[_0x1af2a8(0x1ad)],'gateways':_0x1a8047[_0x1af2a8(0x1c0)]?JSON[_0x1af2a8(0x1b8)](_0x1a8047[_0x1af2a8(0x1c0)]):null,'gatewaySettings':_0x1a8047[_0x1af2a8(0x19b)]?JSON[_0x1af2a8(0x1b8)](_0x1a8047[_0x1af2a8(0x19b)]):null,'publicKey':_0x1a8047[_0x1af2a8(0x1a9)],'wallets':{'usdtPolygonWallet':_0x1a8047['usdtPolygonWallet'],'usdtTrcWallet':_0x1a8047[_0x1af2a8(0x1bb)],'usdtErcWallet':_0x1a8047['usdtErcWallet'],'usdcPolygonWallet':_0x1a8047[_0x1af2a8(0x18f)]},'status':_0x1a8047[_0x1af2a8(0x193)],'createdAt':_0x1a8047[_0x1af2a8(0x1af)]};}async['updateUser'](_0x289e8d,_0x504aac){const _0x5840c2=a57_0xcd3712,_0x2d4ef2={..._0x504aac};_0x504aac['password']&&(_0x2d4ef2[_0x5840c2(0x190)]=await bcryptjs_1['default'][_0x5840c2(0x199)](_0x504aac[_0x5840c2(0x190)],0xc));_0x504aac[_0x5840c2(0x196)]&&(_0x2d4ef2['name']=_0x504aac[_0x5840c2(0x196)],delete _0x2d4ef2[_0x5840c2(0x196)]);_0x504aac[_0x5840c2(0x1a4)]&&(_0x2d4ef2[_0x5840c2(0x1b2)]=_0x504aac['telegramId'],delete _0x2d4ef2[_0x5840c2(0x1a4)]);_0x504aac['merchantUrl']&&(_0x2d4ef2[_0x5840c2(0x1ad)]=_0x504aac['merchantUrl'],delete _0x2d4ef2[_0x5840c2(0x1a8)]);_0x504aac[_0x5840c2(0x1b0)]&&(_0x2d4ef2[_0x5840c2(0x1c0)]=JSON[_0x5840c2(0x1ae)](_0x504aac[_0x5840c2(0x1b0)]),delete _0x2d4ef2['gateways']);_0x504aac[_0x5840c2(0x19b)]&&(_0x2d4ef2['gatewaySettings']=JSON[_0x5840c2(0x1ae)](_0x504aac[_0x5840c2(0x19b)]),delete _0x2d4ef2[_0x5840c2(0x19b)]);_0x504aac[_0x5840c2(0x1a7)]&&(_0x504aac['wallets']['usdtPolygonWallet']!==undefined&&(_0x2d4ef2[_0x5840c2(0x18a)]=_0x504aac[_0x5840c2(0x1a7)][_0x5840c2(0x18a)]||null),_0x504aac[_0x5840c2(0x1a7)][_0x5840c2(0x1bb)]!==undefined&&(_0x2d4ef2[_0x5840c2(0x1bb)]=_0x504aac[_0x5840c2(0x1a7)][_0x5840c2(0x1bb)]||null),_0x504aac[_0x5840c2(0x1a7)][_0x5840c2(0x19a)]!==undefined&&(_0x2d4ef2[_0x5840c2(0x19a)]=_0x504aac[_0x5840c2(0x1a7)][_0x5840c2(0x19a)]||null),_0x504aac['wallets'][_0x5840c2(0x18f)]!==undefined&&(_0x2d4ef2[_0x5840c2(0x18f)]=_0x504aac[_0x5840c2(0x1a7)][_0x5840c2(0x18f)]||null),delete _0x2d4ef2[_0x5840c2(0x1a7)]);const _0xa3b223=await database_1['default']['shop']['update']({'where':{'id':_0x289e8d},'data':_0x2d4ef2,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0xa3b223['id'],'fullName':_0xa3b223[_0x5840c2(0x1ab)],'username':_0xa3b223[_0x5840c2(0x194)],'telegramId':_0xa3b223[_0x5840c2(0x1b2)],'merchantUrl':_0xa3b223[_0x5840c2(0x1ad)],'gateways':_0xa3b223[_0x5840c2(0x1c0)]?JSON[_0x5840c2(0x1b8)](_0xa3b223[_0x5840c2(0x1c0)]):null,'gatewaySettings':_0xa3b223[_0x5840c2(0x19b)]?JSON['parse'](_0xa3b223[_0x5840c2(0x19b)]):null,'publicKey':_0xa3b223['publicKey'],'wallets':{'usdtPolygonWallet':_0xa3b223[_0x5840c2(0x18a)],'usdtTrcWallet':_0xa3b223[_0x5840c2(0x1bb)],'usdtErcWallet':_0xa3b223['usdtErcWallet'],'usdcPolygonWallet':_0xa3b223[_0x5840c2(0x18f)]},'status':_0xa3b223[_0x5840c2(0x193)],'createdAt':_0xa3b223[_0x5840c2(0x1af)]};}async[a57_0xcd3712(0x1a6)](_0x5eafc1){const _0x56db88=a57_0xcd3712;await database_1[_0x56db88(0x1b3)]['shop']['delete']({'where':{'id':_0x5eafc1}});}}function a57_0xc01d(_0x1a9eae,_0xe66073){const _0x174d8e=a57_0x174d();return a57_0xc01d=function(_0xc01d67,_0x8b76e7){_0xc01d67=_0xc01d67-0x189;let _0x575f39=_0x174d8e[_0xc01d67];return _0x575f39;},a57_0xc01d(_0x1a9eae,_0xe66073);}function a57_0x174d(){const _0x583121=['generateApiKeys','usdtPolygonWallet','UserService','create','352310WLGxgA','__esModule','usdcPolygonWallet','password','findMany','getAllUsers','status','username','pk_','fullName','76yuuzGg','166618diWzBb','hash','usdtErcWallet','gatewaySettings','hex','114270DsNdlb','map','3488040kHjGpK','findUnique','shop','toString','__importDefault','telegramId','createUser','deleteUser','wallets','merchantUrl','publicKey','Telegram\x20username\x20already\x20exists','name','63hfLpih','shopUrl','stringify','createdAt','gateways','2906715OjZWmw','telegram','default','sk_','429090vyzQrk','bcryptjs','../config/database','parse','defineProperty','randomBytes','usdtTrcWallet','crypto','3vwCaHQ','690249Dlkcxc','ACTIVE','paymentGateways'];a57_0x174d=function(){return _0x583121;};return a57_0x174d();}exports[a57_0xcd3712(0x18b)]=UserService;