'use strict';function a68_0x3fea(_0x1a014f,_0x5caef5){const _0x57a95f=a68_0x57a9();return a68_0x3fea=function(_0x3fea56,_0x215622){_0x3fea56=_0x3fea56-0x191;let _0x3607cd=_0x57a95f[_0x3fea56];return _0x3607cd;},a68_0x3fea(_0x1a014f,_0x5caef5);}const a68_0x13a777=a68_0x3fea;(function(_0xe071ff,_0x256dd4){const _0x4a276b=a68_0x3fea,_0x4076e1=_0xe071ff();while(!![]){try{const _0xe1542=-parseInt(_0x4a276b(0x1b2))/0x1+-parseInt(_0x4a276b(0x1a4))/0x2+-parseInt(_0x4a276b(0x1a9))/0x3+parseInt(_0x4a276b(0x1c6))/0x4+-parseInt(_0x4a276b(0x1ae))/0x5*(-parseInt(_0x4a276b(0x1a2))/0x6)+-parseInt(_0x4a276b(0x1c5))/0x7+parseInt(_0x4a276b(0x1a3))/0x8*(parseInt(_0x4a276b(0x1b0))/0x9);if(_0xe1542===_0x256dd4)break;else _0x4076e1['push'](_0x4076e1['shift']());}catch(_0x230229){_0x4076e1['push'](_0x4076e1['shift']());}}}(a68_0x57a9,0x2f229));function a68_0x57a9(){const _0x25d598=['merchantUrl','UserService','findUnique','ACTIVE','1214913EzJxot','1527392byaDql','shop','fullName','status','telegramId','createdAt','gatewaySettings','getAllUsers','parse','Telegram\x20username\x20already\x20exists','pk_','usdtTrcWallet','hex','randomBytes','desc','deleteUser','username','hash','38604ZsBiqr','4722008JIwSKg','698760uALcQX','Username\x20already\x20exists','publicKey','usdcPolygonWallet','password','822063iWTHin','delete','default','telegram','update','80JMvRXu','usdtErcWallet','9AmMYUw','usdtPolygonWallet','85018yrdAAc','generateApiKeys','__esModule','toString','stringify','create','sk_','__importDefault','shopUrl','paymentGateways','name','defineProperty','getUserById','gateways','wallets'];a68_0x57a9=function(){return _0x25d598;};return a68_0x57a9();}var __importDefault=this&&this[a68_0x13a777(0x1b9)]||function(_0x35dbba){const _0x2deb3f=a68_0x13a777;return _0x35dbba&&_0x35dbba[_0x2deb3f(0x1b4)]?_0x35dbba:{'default':_0x35dbba};};Object[a68_0x13a777(0x1bd)](exports,'__esModule',{'value':!![]}),exports[a68_0x13a777(0x1c2)]=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),crypto_1=__importDefault(require('crypto')),database_1=__importDefault(require('../config/database'));class UserService{['generateApiKeys'](){const _0x220d5f=a68_0x13a777,_0xf939b2=_0x220d5f(0x19a)+crypto_1[_0x220d5f(0x1ab)][_0x220d5f(0x19d)](0x20)['toString'](_0x220d5f(0x19c)),_0x150577=_0x220d5f(0x1b8)+crypto_1[_0x220d5f(0x1ab)]['randomBytes'](0x20)[_0x220d5f(0x1b5)](_0x220d5f(0x19c));return{'publicKey':_0xf939b2,'secretKey':_0x150577};}async['createUser'](_0x581e14){const _0x3d8d6e=a68_0x13a777,{fullName:_0x45fcb0,username:_0x4dd248,password:_0xe0589a,telegramId:_0x471f01,merchantUrl:_0x1f6fe5,gateways:_0x37866e,gatewaySettings:_0x272fbf,wallets:_0x509279}=_0x581e14,_0x4d2a80=await database_1[_0x3d8d6e(0x1ab)][_0x3d8d6e(0x191)]['findUnique']({'where':{'username':_0x4dd248}});if(_0x4d2a80)throw new Error(_0x3d8d6e(0x1a5));if(_0x471f01){const _0x37641f=await database_1[_0x3d8d6e(0x1ab)][_0x3d8d6e(0x191)][_0x3d8d6e(0x1c3)]({'where':{'telegram':_0x471f01}});if(_0x37641f)throw new Error(_0x3d8d6e(0x199));}const _0x55ac5c=await bcryptjs_1[_0x3d8d6e(0x1ab)]['hash'](_0xe0589a,0xc),{publicKey:_0x4c4deb,secretKey:_0x355312}=this[_0x3d8d6e(0x1b3)](),_0x5c24c6=await database_1[_0x3d8d6e(0x1ab)][_0x3d8d6e(0x191)][_0x3d8d6e(0x1b7)]({'data':{'name':_0x45fcb0,'username':_0x4dd248,'password':_0x55ac5c,'telegram':_0x471f01,'shopUrl':_0x1f6fe5,'paymentGateways':_0x37866e?JSON[_0x3d8d6e(0x1b6)](_0x37866e):null,'gatewaySettings':_0x272fbf?JSON[_0x3d8d6e(0x1b6)](_0x272fbf):null,'usdtPolygonWallet':_0x509279?.[_0x3d8d6e(0x1b1)]||null,'usdtTrcWallet':_0x509279?.[_0x3d8d6e(0x19b)]||null,'usdtErcWallet':_0x509279?.[_0x3d8d6e(0x1af)]||null,'usdcPolygonWallet':_0x509279?.[_0x3d8d6e(0x1a7)]||null,'publicKey':_0x4c4deb,'secretKey':_0x355312,'status':_0x3d8d6e(0x1c4)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x5c24c6['id'],'fullName':_0x5c24c6['name'],'username':_0x5c24c6[_0x3d8d6e(0x1a0)],'telegramId':_0x5c24c6[_0x3d8d6e(0x1ac)],'merchantUrl':_0x5c24c6['shopUrl'],'gateways':_0x5c24c6[_0x3d8d6e(0x1bb)]?JSON[_0x3d8d6e(0x198)](_0x5c24c6[_0x3d8d6e(0x1bb)]):null,'gatewaySettings':_0x5c24c6[_0x3d8d6e(0x196)]?JSON[_0x3d8d6e(0x198)](_0x5c24c6[_0x3d8d6e(0x196)]):null,'publicKey':_0x5c24c6[_0x3d8d6e(0x1a6)],'wallets':{'usdtPolygonWallet':_0x5c24c6[_0x3d8d6e(0x1b1)],'usdtTrcWallet':_0x5c24c6[_0x3d8d6e(0x19b)],'usdtErcWallet':_0x5c24c6[_0x3d8d6e(0x1af)],'usdcPolygonWallet':_0x5c24c6['usdcPolygonWallet']},'status':_0x5c24c6[_0x3d8d6e(0x193)],'createdAt':_0x5c24c6[_0x3d8d6e(0x195)]};}async[a68_0x13a777(0x197)](){const _0x2f8038=a68_0x13a777,_0x3ba127=await database_1[_0x2f8038(0x1ab)]['shop']['findMany']({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x2f8038(0x19e)}});return _0x3ba127['map'](_0x12ba69=>({'id':_0x12ba69['id'],'fullName':_0x12ba69['name'],'username':_0x12ba69[_0x2f8038(0x1a0)],'telegramId':_0x12ba69['telegram'],'merchantUrl':_0x12ba69[_0x2f8038(0x1ba)],'gateways':_0x12ba69['paymentGateways']?JSON[_0x2f8038(0x198)](_0x12ba69[_0x2f8038(0x1bb)]):null,'gatewaySettings':_0x12ba69[_0x2f8038(0x196)]?JSON['parse'](_0x12ba69[_0x2f8038(0x196)]):null,'publicKey':_0x12ba69[_0x2f8038(0x1a6)],'wallets':{'usdtPolygonWallet':_0x12ba69[_0x2f8038(0x1b1)],'usdtTrcWallet':_0x12ba69[_0x2f8038(0x19b)],'usdtErcWallet':_0x12ba69[_0x2f8038(0x1af)],'usdcPolygonWallet':_0x12ba69[_0x2f8038(0x1a7)]},'status':_0x12ba69[_0x2f8038(0x193)],'createdAt':_0x12ba69['createdAt']}));}async[a68_0x13a777(0x1be)](_0x1e37ec){const _0x1cf00e=a68_0x13a777,_0x1e6eed=await database_1['default'][_0x1cf00e(0x191)][_0x1cf00e(0x1c3)]({'where':{'id':_0x1e37ec},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x1e6eed)return null;return{'id':_0x1e6eed['id'],'fullName':_0x1e6eed['name'],'username':_0x1e6eed['username'],'telegramId':_0x1e6eed['telegram'],'merchantUrl':_0x1e6eed['shopUrl'],'gateways':_0x1e6eed[_0x1cf00e(0x1bb)]?JSON['parse'](_0x1e6eed[_0x1cf00e(0x1bb)]):null,'gatewaySettings':_0x1e6eed[_0x1cf00e(0x196)]?JSON['parse'](_0x1e6eed[_0x1cf00e(0x196)]):null,'publicKey':_0x1e6eed[_0x1cf00e(0x1a6)],'wallets':{'usdtPolygonWallet':_0x1e6eed[_0x1cf00e(0x1b1)],'usdtTrcWallet':_0x1e6eed[_0x1cf00e(0x19b)],'usdtErcWallet':_0x1e6eed['usdtErcWallet'],'usdcPolygonWallet':_0x1e6eed['usdcPolygonWallet']},'status':_0x1e6eed[_0x1cf00e(0x193)],'createdAt':_0x1e6eed[_0x1cf00e(0x195)]};}async['updateUser'](_0x424dda,_0x537703){const _0x438bc4=a68_0x13a777,_0x580c89={..._0x537703};_0x537703[_0x438bc4(0x1a8)]&&(_0x580c89[_0x438bc4(0x1a8)]=await bcryptjs_1['default'][_0x438bc4(0x1a1)](_0x537703[_0x438bc4(0x1a8)],0xc));_0x537703[_0x438bc4(0x192)]&&(_0x580c89[_0x438bc4(0x1bc)]=_0x537703['fullName'],delete _0x580c89[_0x438bc4(0x192)]);_0x537703[_0x438bc4(0x194)]&&(_0x580c89[_0x438bc4(0x1ac)]=_0x537703[_0x438bc4(0x194)],delete _0x580c89[_0x438bc4(0x194)]);_0x537703[_0x438bc4(0x1c1)]&&(_0x580c89[_0x438bc4(0x1ba)]=_0x537703['merchantUrl'],delete _0x580c89[_0x438bc4(0x1c1)]);_0x537703[_0x438bc4(0x1bf)]&&(_0x580c89[_0x438bc4(0x1bb)]=JSON[_0x438bc4(0x1b6)](_0x537703[_0x438bc4(0x1bf)]),delete _0x580c89[_0x438bc4(0x1bf)]);_0x537703[_0x438bc4(0x196)]&&(_0x580c89['gatewaySettings']=JSON[_0x438bc4(0x1b6)](_0x537703[_0x438bc4(0x196)]),delete _0x580c89[_0x438bc4(0x196)]);_0x537703['wallets']&&(_0x537703[_0x438bc4(0x1c0)][_0x438bc4(0x1b1)]!==undefined&&(_0x580c89[_0x438bc4(0x1b1)]=_0x537703[_0x438bc4(0x1c0)][_0x438bc4(0x1b1)]||null),_0x537703[_0x438bc4(0x1c0)][_0x438bc4(0x19b)]!==undefined&&(_0x580c89[_0x438bc4(0x19b)]=_0x537703[_0x438bc4(0x1c0)][_0x438bc4(0x19b)]||null),_0x537703['wallets'][_0x438bc4(0x1af)]!==undefined&&(_0x580c89[_0x438bc4(0x1af)]=_0x537703[_0x438bc4(0x1c0)][_0x438bc4(0x1af)]||null),_0x537703[_0x438bc4(0x1c0)][_0x438bc4(0x1a7)]!==undefined&&(_0x580c89[_0x438bc4(0x1a7)]=_0x537703[_0x438bc4(0x1c0)]['usdcPolygonWallet']||null),delete _0x580c89['wallets']);const _0x51c612=await database_1[_0x438bc4(0x1ab)][_0x438bc4(0x191)][_0x438bc4(0x1ad)]({'where':{'id':_0x424dda},'data':_0x580c89,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x51c612['id'],'fullName':_0x51c612[_0x438bc4(0x1bc)],'username':_0x51c612['username'],'telegramId':_0x51c612[_0x438bc4(0x1ac)],'merchantUrl':_0x51c612[_0x438bc4(0x1ba)],'gateways':_0x51c612[_0x438bc4(0x1bb)]?JSON['parse'](_0x51c612[_0x438bc4(0x1bb)]):null,'gatewaySettings':_0x51c612['gatewaySettings']?JSON['parse'](_0x51c612['gatewaySettings']):null,'publicKey':_0x51c612['publicKey'],'wallets':{'usdtPolygonWallet':_0x51c612['usdtPolygonWallet'],'usdtTrcWallet':_0x51c612['usdtTrcWallet'],'usdtErcWallet':_0x51c612[_0x438bc4(0x1af)],'usdcPolygonWallet':_0x51c612[_0x438bc4(0x1a7)]},'status':_0x51c612[_0x438bc4(0x193)],'createdAt':_0x51c612[_0x438bc4(0x195)]};}async[a68_0x13a777(0x19f)](_0x5bddbf){const _0x2b804b=a68_0x13a777;await database_1[_0x2b804b(0x1ab)][_0x2b804b(0x191)][_0x2b804b(0x1aa)]({'where':{'id':_0x5bddbf}});}}exports[a68_0x13a777(0x1c2)]=UserService;