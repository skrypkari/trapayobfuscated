'use strict';const a51_0x36aa6d=a51_0x5a73;(function(_0x11fd48,_0x29d2d4){const _0x380a23=a51_0x5a73,_0x142893=_0x11fd48();while(!![]){try{const _0x9b4566=-parseInt(_0x380a23(0xee))/0x1+-parseInt(_0x380a23(0xda))/0x2*(parseInt(_0x380a23(0xd5))/0x3)+parseInt(_0x380a23(0xe2))/0x4+-parseInt(_0x380a23(0xc3))/0x5+parseInt(_0x380a23(0xd1))/0x6*(parseInt(_0x380a23(0xde))/0x7)+parseInt(_0x380a23(0xd8))/0x8*(parseInt(_0x380a23(0xef))/0x9)+parseInt(_0x380a23(0xdb))/0xa;if(_0x9b4566===_0x29d2d4)break;else _0x142893['push'](_0x142893['shift']());}catch(_0xa398fa){_0x142893['push'](_0x142893['shift']());}}}(a51_0x1316,0x80525));var __importDefault=this&&this[a51_0x36aa6d(0xd3)]||function(_0x287405){return _0x287405&&_0x287405['__esModule']?_0x287405:{'default':_0x287405};};function a51_0x1316(){const _0x56bbd8=['330RwyYYc','getUserById','__importDefault','gatewaySettings','4797zTlVYV','usdtErcWallet','delete','80AzNigd','randomBytes','168iHQlWN','2320250OWtqEg','hex','Telegram\x20username\x20already\x20exists','56371sShItn','usdcPolygonWallet','username','deleteUser','229924AQeKRo','usdtTrcWallet','bcryptjs','default','usdtPolygonWallet','telegramId','update','generateApiKeys','__esModule','map','getAllUsers','merchantUrl','403711vWHkeU','860697ywNKDy','stringify','../config/database','findUnique','shop','fullName','password','hash','paymentGateways','telegram','crypto','3125595LfBKJV','createdAt','name','parse','shopUrl','Username\x20already\x20exists','create','defineProperty','wallets','UserService','desc','publicKey','status','gateways'];a51_0x1316=function(){return _0x56bbd8;};return a51_0x1316();}function a51_0x5a73(_0x35bf0f,_0x1842d2){const _0x1316fc=a51_0x1316();return a51_0x5a73=function(_0x5a73ad,_0x166b1a){_0x5a73ad=_0x5a73ad-0xbc;let _0x3948bc=_0x1316fc[_0x5a73ad];return _0x3948bc;},a51_0x5a73(_0x35bf0f,_0x1842d2);}Object[a51_0x36aa6d(0xca)](exports,a51_0x36aa6d(0xea),{'value':!![]}),exports[a51_0x36aa6d(0xcc)]=void 0x0;const bcryptjs_1=__importDefault(require(a51_0x36aa6d(0xe4))),crypto_1=__importDefault(require(a51_0x36aa6d(0xc2))),database_1=__importDefault(require(a51_0x36aa6d(0xf1)));class UserService{[a51_0x36aa6d(0xe9)](){const _0x10bb24=a51_0x36aa6d,_0x480ecc='pk_'+crypto_1[_0x10bb24(0xe5)][_0x10bb24(0xd9)](0x20)['toString'](_0x10bb24(0xdc)),_0x1315d0='sk_'+crypto_1[_0x10bb24(0xe5)][_0x10bb24(0xd9)](0x20)['toString'](_0x10bb24(0xdc));return{'publicKey':_0x480ecc,'secretKey':_0x1315d0};}async['createUser'](_0x3a5c23){const _0x25b768=a51_0x36aa6d,{fullName:_0x1d1b13,username:_0xb547d9,password:_0x233798,telegramId:_0x3d61ec,merchantUrl:_0x162ed2,gateways:_0x8524ce,gatewaySettings:_0xf74991,wallets:_0x4b6919}=_0x3a5c23,_0x25776d=await database_1[_0x25b768(0xe5)][_0x25b768(0xbc)][_0x25b768(0xf2)]({'where':{'username':_0xb547d9}});if(_0x25776d)throw new Error(_0x25b768(0xc8));if(_0x3d61ec){const _0xf7b340=await database_1[_0x25b768(0xe5)][_0x25b768(0xbc)][_0x25b768(0xf2)]({'where':{'telegram':_0x3d61ec}});if(_0xf7b340)throw new Error(_0x25b768(0xdd));}const _0x4c7b45=await bcryptjs_1[_0x25b768(0xe5)][_0x25b768(0xbf)](_0x233798,0xc),{publicKey:_0x190cb9,secretKey:_0x3b0dea}=this[_0x25b768(0xe9)](),_0x19b452=await database_1['default']['shop'][_0x25b768(0xc9)]({'data':{'name':_0x1d1b13,'username':_0xb547d9,'password':_0x4c7b45,'telegram':_0x3d61ec,'shopUrl':_0x162ed2,'paymentGateways':_0x8524ce?JSON[_0x25b768(0xf0)](_0x8524ce):null,'gatewaySettings':_0xf74991?JSON[_0x25b768(0xf0)](_0xf74991):null,'usdtPolygonWallet':_0x4b6919?.[_0x25b768(0xe6)]||null,'usdtTrcWallet':_0x4b6919?.[_0x25b768(0xe3)]||null,'usdtErcWallet':_0x4b6919?.['usdtErcWallet']||null,'usdcPolygonWallet':_0x4b6919?.[_0x25b768(0xdf)]||null,'publicKey':_0x190cb9,'secretKey':_0x3b0dea,'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x19b452['id'],'fullName':_0x19b452['name'],'username':_0x19b452[_0x25b768(0xe0)],'telegramId':_0x19b452[_0x25b768(0xc1)],'merchantUrl':_0x19b452['shopUrl'],'gateways':_0x19b452[_0x25b768(0xc0)]?JSON[_0x25b768(0xc6)](_0x19b452['paymentGateways']):null,'gatewaySettings':_0x19b452[_0x25b768(0xd4)]?JSON[_0x25b768(0xc6)](_0x19b452[_0x25b768(0xd4)]):null,'publicKey':_0x19b452[_0x25b768(0xce)],'wallets':{'usdtPolygonWallet':_0x19b452['usdtPolygonWallet'],'usdtTrcWallet':_0x19b452['usdtTrcWallet'],'usdtErcWallet':_0x19b452[_0x25b768(0xd6)],'usdcPolygonWallet':_0x19b452['usdcPolygonWallet']},'status':_0x19b452['status'],'createdAt':_0x19b452['createdAt']};}async[a51_0x36aa6d(0xec)](){const _0x30ed7d=a51_0x36aa6d,_0x177d1d=await database_1[_0x30ed7d(0xe5)][_0x30ed7d(0xbc)]['findMany']({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x30ed7d(0xcd)}});return _0x177d1d[_0x30ed7d(0xeb)](_0x350d5a=>({'id':_0x350d5a['id'],'fullName':_0x350d5a[_0x30ed7d(0xc5)],'username':_0x350d5a[_0x30ed7d(0xe0)],'telegramId':_0x350d5a[_0x30ed7d(0xc1)],'merchantUrl':_0x350d5a['shopUrl'],'gateways':_0x350d5a['paymentGateways']?JSON[_0x30ed7d(0xc6)](_0x350d5a[_0x30ed7d(0xc0)]):null,'gatewaySettings':_0x350d5a[_0x30ed7d(0xd4)]?JSON[_0x30ed7d(0xc6)](_0x350d5a[_0x30ed7d(0xd4)]):null,'publicKey':_0x350d5a[_0x30ed7d(0xce)],'wallets':{'usdtPolygonWallet':_0x350d5a[_0x30ed7d(0xe6)],'usdtTrcWallet':_0x350d5a[_0x30ed7d(0xe3)],'usdtErcWallet':_0x350d5a[_0x30ed7d(0xd6)],'usdcPolygonWallet':_0x350d5a[_0x30ed7d(0xdf)]},'status':_0x350d5a['status'],'createdAt':_0x350d5a['createdAt']}));}async[a51_0x36aa6d(0xd2)](_0x790daf){const _0x142fec=a51_0x36aa6d,_0x193cbf=await database_1['default']['shop']['findUnique']({'where':{'id':_0x790daf},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x193cbf)return null;return{'id':_0x193cbf['id'],'fullName':_0x193cbf[_0x142fec(0xc5)],'username':_0x193cbf[_0x142fec(0xe0)],'telegramId':_0x193cbf[_0x142fec(0xc1)],'merchantUrl':_0x193cbf[_0x142fec(0xc7)],'gateways':_0x193cbf['paymentGateways']?JSON[_0x142fec(0xc6)](_0x193cbf[_0x142fec(0xc0)]):null,'gatewaySettings':_0x193cbf[_0x142fec(0xd4)]?JSON[_0x142fec(0xc6)](_0x193cbf[_0x142fec(0xd4)]):null,'publicKey':_0x193cbf['publicKey'],'wallets':{'usdtPolygonWallet':_0x193cbf[_0x142fec(0xe6)],'usdtTrcWallet':_0x193cbf[_0x142fec(0xe3)],'usdtErcWallet':_0x193cbf[_0x142fec(0xd6)],'usdcPolygonWallet':_0x193cbf[_0x142fec(0xdf)]},'status':_0x193cbf[_0x142fec(0xcf)],'createdAt':_0x193cbf[_0x142fec(0xc4)]};}async['updateUser'](_0x5e7c48,_0x481e19){const _0x288481=a51_0x36aa6d,_0x41a6de={..._0x481e19};_0x481e19[_0x288481(0xbe)]&&(_0x41a6de[_0x288481(0xbe)]=await bcryptjs_1[_0x288481(0xe5)][_0x288481(0xbf)](_0x481e19['password'],0xc));_0x481e19['fullName']&&(_0x41a6de['name']=_0x481e19[_0x288481(0xbd)],delete _0x41a6de[_0x288481(0xbd)]);_0x481e19[_0x288481(0xe7)]&&(_0x41a6de['telegram']=_0x481e19[_0x288481(0xe7)],delete _0x41a6de[_0x288481(0xe7)]);_0x481e19['merchantUrl']&&(_0x41a6de[_0x288481(0xc7)]=_0x481e19[_0x288481(0xed)],delete _0x41a6de[_0x288481(0xed)]);_0x481e19[_0x288481(0xd0)]&&(_0x41a6de['paymentGateways']=JSON[_0x288481(0xf0)](_0x481e19['gateways']),delete _0x41a6de[_0x288481(0xd0)]);_0x481e19[_0x288481(0xd4)]&&(_0x41a6de['gatewaySettings']=JSON[_0x288481(0xf0)](_0x481e19[_0x288481(0xd4)]),delete _0x41a6de[_0x288481(0xd4)]);_0x481e19['wallets']&&(_0x481e19[_0x288481(0xcb)][_0x288481(0xe6)]!==undefined&&(_0x41a6de['usdtPolygonWallet']=_0x481e19['wallets'][_0x288481(0xe6)]||null),_0x481e19[_0x288481(0xcb)][_0x288481(0xe3)]!==undefined&&(_0x41a6de['usdtTrcWallet']=_0x481e19['wallets'][_0x288481(0xe3)]||null),_0x481e19[_0x288481(0xcb)][_0x288481(0xd6)]!==undefined&&(_0x41a6de[_0x288481(0xd6)]=_0x481e19[_0x288481(0xcb)][_0x288481(0xd6)]||null),_0x481e19[_0x288481(0xcb)][_0x288481(0xdf)]!==undefined&&(_0x41a6de[_0x288481(0xdf)]=_0x481e19[_0x288481(0xcb)][_0x288481(0xdf)]||null),delete _0x41a6de[_0x288481(0xcb)]);const _0x581c8a=await database_1[_0x288481(0xe5)][_0x288481(0xbc)][_0x288481(0xe8)]({'where':{'id':_0x5e7c48},'data':_0x41a6de,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x581c8a['id'],'fullName':_0x581c8a[_0x288481(0xc5)],'username':_0x581c8a[_0x288481(0xe0)],'telegramId':_0x581c8a[_0x288481(0xc1)],'merchantUrl':_0x581c8a[_0x288481(0xc7)],'gateways':_0x581c8a[_0x288481(0xc0)]?JSON[_0x288481(0xc6)](_0x581c8a[_0x288481(0xc0)]):null,'gatewaySettings':_0x581c8a[_0x288481(0xd4)]?JSON[_0x288481(0xc6)](_0x581c8a['gatewaySettings']):null,'publicKey':_0x581c8a[_0x288481(0xce)],'wallets':{'usdtPolygonWallet':_0x581c8a[_0x288481(0xe6)],'usdtTrcWallet':_0x581c8a['usdtTrcWallet'],'usdtErcWallet':_0x581c8a[_0x288481(0xd6)],'usdcPolygonWallet':_0x581c8a[_0x288481(0xdf)]},'status':_0x581c8a[_0x288481(0xcf)],'createdAt':_0x581c8a['createdAt']};}async[a51_0x36aa6d(0xe1)](_0x369753){const _0x2cdb6c=a51_0x36aa6d;await database_1[_0x2cdb6c(0xe5)]['shop'][_0x2cdb6c(0xd7)]({'where':{'id':_0x369753}});}}exports[a51_0x36aa6d(0xcc)]=UserService;