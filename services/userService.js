'use strict';function a68_0x5e1f(_0x512967,_0xdfe3b4){const _0x421a71=a68_0x421a();return a68_0x5e1f=function(_0x5e1fbd,_0x480f33){_0x5e1fbd=_0x5e1fbd-0x1ca;let _0x12ca60=_0x421a71[_0x5e1fbd];return _0x12ca60;},a68_0x5e1f(_0x512967,_0xdfe3b4);}const a68_0x510810=a68_0x5e1f;function a68_0x421a(){const _0x5377c6=['findUnique','username','merchantUrl','updateUser','5726670iTwSkS','name','6PULsJG','getAllUsers','95069JklLuC','createUser','Username\x20already\x20exists','randomBytes','__esModule','getUserById','pk_','11zQHKje','telegramId','1275390VkvByu','usdtTrcWallet','status','shopUrl','ACTIVE','stringify','telegram','delete','gatewaySettings','23988SOZRpg','../config/database','findMany','create','usdtPolygonWallet','usdcPolygonWallet','toString','__importDefault','hex','hash','publicKey','gateways','1928656oZtUqE','createdAt','password','21qPdWfo','fullName','usdtErcWallet','crypto','1313874jwkHVw','paymentGateways','623490kWRMKd','Telegram\x20username\x20already\x20exists','defineProperty','generateApiKeys','default','wallets','parse','bcryptjs','deleteUser','shop','UserService','4JIIepr'];a68_0x421a=function(){return _0x5377c6;};return a68_0x421a();}(function(_0xa156bc,_0x51837c){const _0xcbc3c3=a68_0x5e1f,_0x234f15=_0xa156bc();while(!![]){try{const _0x18aa31=parseInt(_0xcbc3c3(0x1ca))/0x1+-parseInt(_0xcbc3c3(0x203))/0x2*(parseInt(_0xcbc3c3(0x1dc))/0x3)+parseInt(_0xcbc3c3(0x1fc))/0x4*(parseInt(_0xcbc3c3(0x1d3))/0x5)+-parseInt(_0xcbc3c3(0x1f1))/0x6*(-parseInt(_0xcbc3c3(0x1eb))/0x7)+parseInt(_0xcbc3c3(0x1e8))/0x8+-parseInt(_0xcbc3c3(0x1ef))/0x9+parseInt(_0xcbc3c3(0x201))/0xa*(-parseInt(_0xcbc3c3(0x1d1))/0xb);if(_0x18aa31===_0x51837c)break;else _0x234f15['push'](_0x234f15['shift']());}catch(_0x32bbcd){_0x234f15['push'](_0x234f15['shift']());}}}(a68_0x421a,0x2724d));var __importDefault=this&&this[a68_0x510810(0x1e3)]||function(_0x22bde6){const _0x399b2e=a68_0x510810;return _0x22bde6&&_0x22bde6[_0x399b2e(0x1ce)]?_0x22bde6:{'default':_0x22bde6};};Object[a68_0x510810(0x1f3)](exports,'__esModule',{'value':!![]}),exports[a68_0x510810(0x1fb)]=void 0x0;const bcryptjs_1=__importDefault(require(a68_0x510810(0x1f8))),crypto_1=__importDefault(require(a68_0x510810(0x1ee))),database_1=__importDefault(require(a68_0x510810(0x1dd)));class UserService{[a68_0x510810(0x1f4)](){const _0x25c62c=a68_0x510810,_0x131eb0=_0x25c62c(0x1d0)+crypto_1[_0x25c62c(0x1f5)][_0x25c62c(0x1cd)](0x20)['toString'](_0x25c62c(0x1e4)),_0x2a4b7a='sk_'+crypto_1[_0x25c62c(0x1f5)][_0x25c62c(0x1cd)](0x20)[_0x25c62c(0x1e2)]('hex');return{'publicKey':_0x131eb0,'secretKey':_0x2a4b7a};}async[a68_0x510810(0x1cb)](_0xe3b6a9){const _0x2930aa=a68_0x510810,{fullName:_0x39cb5e,username:_0x5703f3,password:_0x384606,telegramId:_0x4354bb,merchantUrl:_0x43be16,gateways:_0x410877,gatewaySettings:_0x2255c6,wallets:_0x2c8c43}=_0xe3b6a9,_0x5992ee=await database_1[_0x2930aa(0x1f5)]['shop']['findUnique']({'where':{'username':_0x5703f3}});if(_0x5992ee)throw new Error(_0x2930aa(0x1cc));if(_0x4354bb){const _0x17a774=await database_1[_0x2930aa(0x1f5)][_0x2930aa(0x1fa)]['findUnique']({'where':{'telegram':_0x4354bb}});if(_0x17a774)throw new Error(_0x2930aa(0x1f2));}const _0x51c0f9=await bcryptjs_1[_0x2930aa(0x1f5)][_0x2930aa(0x1e5)](_0x384606,0xc),{publicKey:_0x45e801,secretKey:_0x2cd994}=this[_0x2930aa(0x1f4)](),_0xf2bd96=await database_1[_0x2930aa(0x1f5)][_0x2930aa(0x1fa)][_0x2930aa(0x1df)]({'data':{'name':_0x39cb5e,'username':_0x5703f3,'password':_0x51c0f9,'telegram':_0x4354bb,'shopUrl':_0x43be16,'paymentGateways':_0x410877?JSON['stringify'](_0x410877):null,'gatewaySettings':_0x2255c6?JSON[_0x2930aa(0x1d8)](_0x2255c6):null,'usdtPolygonWallet':_0x2c8c43?.[_0x2930aa(0x1e0)]||null,'usdtTrcWallet':_0x2c8c43?.['usdtTrcWallet']||null,'usdtErcWallet':_0x2c8c43?.[_0x2930aa(0x1ed)]||null,'usdcPolygonWallet':_0x2c8c43?.[_0x2930aa(0x1e1)]||null,'publicKey':_0x45e801,'secretKey':_0x2cd994,'status':_0x2930aa(0x1d7)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0xf2bd96['id'],'fullName':_0xf2bd96['name'],'username':_0xf2bd96['username'],'telegramId':_0xf2bd96[_0x2930aa(0x1d9)],'merchantUrl':_0xf2bd96[_0x2930aa(0x1d6)],'gateways':_0xf2bd96['paymentGateways']?JSON[_0x2930aa(0x1f7)](_0xf2bd96[_0x2930aa(0x1f0)]):null,'gatewaySettings':_0xf2bd96[_0x2930aa(0x1db)]?JSON[_0x2930aa(0x1f7)](_0xf2bd96[_0x2930aa(0x1db)]):null,'publicKey':_0xf2bd96[_0x2930aa(0x1e6)],'wallets':{'usdtPolygonWallet':_0xf2bd96['usdtPolygonWallet'],'usdtTrcWallet':_0xf2bd96['usdtTrcWallet'],'usdtErcWallet':_0xf2bd96['usdtErcWallet'],'usdcPolygonWallet':_0xf2bd96[_0x2930aa(0x1e1)]},'status':_0xf2bd96[_0x2930aa(0x1d5)],'createdAt':_0xf2bd96[_0x2930aa(0x1e9)]};}async[a68_0x510810(0x204)](){const _0x14de75=a68_0x510810,_0x2029f1=await database_1[_0x14de75(0x1f5)]['shop'][_0x14de75(0x1de)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':'desc'}});return _0x2029f1['map'](_0x5f0eb0=>({'id':_0x5f0eb0['id'],'fullName':_0x5f0eb0['name'],'username':_0x5f0eb0[_0x14de75(0x1fe)],'telegramId':_0x5f0eb0[_0x14de75(0x1d9)],'merchantUrl':_0x5f0eb0[_0x14de75(0x1d6)],'gateways':_0x5f0eb0[_0x14de75(0x1f0)]?JSON['parse'](_0x5f0eb0[_0x14de75(0x1f0)]):null,'gatewaySettings':_0x5f0eb0[_0x14de75(0x1db)]?JSON[_0x14de75(0x1f7)](_0x5f0eb0[_0x14de75(0x1db)]):null,'publicKey':_0x5f0eb0['publicKey'],'wallets':{'usdtPolygonWallet':_0x5f0eb0[_0x14de75(0x1e0)],'usdtTrcWallet':_0x5f0eb0[_0x14de75(0x1d4)],'usdtErcWallet':_0x5f0eb0[_0x14de75(0x1ed)],'usdcPolygonWallet':_0x5f0eb0['usdcPolygonWallet']},'status':_0x5f0eb0['status'],'createdAt':_0x5f0eb0['createdAt']}));}async[a68_0x510810(0x1cf)](_0x2cc3c5){const _0x3a9bd3=a68_0x510810,_0x1ba860=await database_1['default'][_0x3a9bd3(0x1fa)][_0x3a9bd3(0x1fd)]({'where':{'id':_0x2cc3c5},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x1ba860)return null;return{'id':_0x1ba860['id'],'fullName':_0x1ba860[_0x3a9bd3(0x202)],'username':_0x1ba860[_0x3a9bd3(0x1fe)],'telegramId':_0x1ba860['telegram'],'merchantUrl':_0x1ba860[_0x3a9bd3(0x1d6)],'gateways':_0x1ba860[_0x3a9bd3(0x1f0)]?JSON['parse'](_0x1ba860[_0x3a9bd3(0x1f0)]):null,'gatewaySettings':_0x1ba860[_0x3a9bd3(0x1db)]?JSON['parse'](_0x1ba860[_0x3a9bd3(0x1db)]):null,'publicKey':_0x1ba860[_0x3a9bd3(0x1e6)],'wallets':{'usdtPolygonWallet':_0x1ba860[_0x3a9bd3(0x1e0)],'usdtTrcWallet':_0x1ba860[_0x3a9bd3(0x1d4)],'usdtErcWallet':_0x1ba860[_0x3a9bd3(0x1ed)],'usdcPolygonWallet':_0x1ba860[_0x3a9bd3(0x1e1)]},'status':_0x1ba860[_0x3a9bd3(0x1d5)],'createdAt':_0x1ba860['createdAt']};}async[a68_0x510810(0x200)](_0xd37aed,_0x184acb){const _0x2967fb=a68_0x510810,_0x57cd62={..._0x184acb};_0x184acb['password']&&(_0x57cd62[_0x2967fb(0x1ea)]=await bcryptjs_1['default'][_0x2967fb(0x1e5)](_0x184acb[_0x2967fb(0x1ea)],0xc));_0x184acb[_0x2967fb(0x1ec)]&&(_0x57cd62[_0x2967fb(0x202)]=_0x184acb[_0x2967fb(0x1ec)],delete _0x57cd62[_0x2967fb(0x1ec)]);_0x184acb[_0x2967fb(0x1d2)]&&(_0x57cd62['telegram']=_0x184acb[_0x2967fb(0x1d2)],delete _0x57cd62[_0x2967fb(0x1d2)]);_0x184acb[_0x2967fb(0x1ff)]&&(_0x57cd62[_0x2967fb(0x1d6)]=_0x184acb[_0x2967fb(0x1ff)],delete _0x57cd62[_0x2967fb(0x1ff)]);_0x184acb[_0x2967fb(0x1e7)]&&(_0x57cd62[_0x2967fb(0x1f0)]=JSON[_0x2967fb(0x1d8)](_0x184acb[_0x2967fb(0x1e7)]),delete _0x57cd62[_0x2967fb(0x1e7)]);_0x184acb[_0x2967fb(0x1db)]&&(_0x57cd62['gatewaySettings']=JSON[_0x2967fb(0x1d8)](_0x184acb[_0x2967fb(0x1db)]),delete _0x57cd62[_0x2967fb(0x1db)]);_0x184acb['wallets']&&(_0x184acb[_0x2967fb(0x1f6)][_0x2967fb(0x1e0)]!==undefined&&(_0x57cd62[_0x2967fb(0x1e0)]=_0x184acb['wallets']['usdtPolygonWallet']||null),_0x184acb[_0x2967fb(0x1f6)][_0x2967fb(0x1d4)]!==undefined&&(_0x57cd62[_0x2967fb(0x1d4)]=_0x184acb[_0x2967fb(0x1f6)][_0x2967fb(0x1d4)]||null),_0x184acb[_0x2967fb(0x1f6)][_0x2967fb(0x1ed)]!==undefined&&(_0x57cd62['usdtErcWallet']=_0x184acb[_0x2967fb(0x1f6)][_0x2967fb(0x1ed)]||null),_0x184acb['wallets']['usdcPolygonWallet']!==undefined&&(_0x57cd62[_0x2967fb(0x1e1)]=_0x184acb['wallets'][_0x2967fb(0x1e1)]||null),delete _0x57cd62[_0x2967fb(0x1f6)]);const _0x56c3a9=await database_1[_0x2967fb(0x1f5)][_0x2967fb(0x1fa)]['update']({'where':{'id':_0xd37aed},'data':_0x57cd62,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x56c3a9['id'],'fullName':_0x56c3a9[_0x2967fb(0x202)],'username':_0x56c3a9[_0x2967fb(0x1fe)],'telegramId':_0x56c3a9['telegram'],'merchantUrl':_0x56c3a9['shopUrl'],'gateways':_0x56c3a9[_0x2967fb(0x1f0)]?JSON[_0x2967fb(0x1f7)](_0x56c3a9[_0x2967fb(0x1f0)]):null,'gatewaySettings':_0x56c3a9[_0x2967fb(0x1db)]?JSON[_0x2967fb(0x1f7)](_0x56c3a9[_0x2967fb(0x1db)]):null,'publicKey':_0x56c3a9[_0x2967fb(0x1e6)],'wallets':{'usdtPolygonWallet':_0x56c3a9[_0x2967fb(0x1e0)],'usdtTrcWallet':_0x56c3a9['usdtTrcWallet'],'usdtErcWallet':_0x56c3a9[_0x2967fb(0x1ed)],'usdcPolygonWallet':_0x56c3a9[_0x2967fb(0x1e1)]},'status':_0x56c3a9[_0x2967fb(0x1d5)],'createdAt':_0x56c3a9['createdAt']};}async[a68_0x510810(0x1f9)](_0x57c253){const _0x2fd6ec=a68_0x510810;await database_1['default'][_0x2fd6ec(0x1fa)][_0x2fd6ec(0x1da)]({'where':{'id':_0x57c253}});}}exports[a68_0x510810(0x1fb)]=UserService;