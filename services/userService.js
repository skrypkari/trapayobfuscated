'use strict';const a68_0x53297f=a68_0x106b;(function(_0xdb430e,_0x126cd2){const _0x4687b0=a68_0x106b,_0x598d2b=_0xdb430e();while(!![]){try{const _0x4d286a=parseInt(_0x4687b0(0x1b4))/0x1+-parseInt(_0x4687b0(0x1c2))/0x2+parseInt(_0x4687b0(0x1a2))/0x3+-parseInt(_0x4687b0(0x1c0))/0x4*(-parseInt(_0x4687b0(0x1af))/0x5)+parseInt(_0x4687b0(0x1b7))/0x6*(parseInt(_0x4687b0(0x1a9))/0x7)+-parseInt(_0x4687b0(0x1a3))/0x8+-parseInt(_0x4687b0(0x196))/0x9;if(_0x4d286a===_0x126cd2)break;else _0x598d2b['push'](_0x598d2b['shift']());}catch(_0x2421fd){_0x598d2b['push'](_0x598d2b['shift']());}}}(a68_0x6b4f,0x8a3bf));function a68_0x106b(_0x3bbdd5,_0x5c42bb){const _0x6b4f93=a68_0x6b4f();return a68_0x106b=function(_0x106b67,_0x7761a5){_0x106b67=_0x106b67-0x191;let _0x2169f9=_0x6b4f93[_0x106b67];return _0x2169f9;},a68_0x106b(_0x3bbdd5,_0x5c42bb);}var __importDefault=this&&this[a68_0x53297f(0x19f)]||function(_0x3b9dc1){const _0xc70587=a68_0x53297f;return _0x3b9dc1&&_0x3b9dc1[_0xc70587(0x1c4)]?_0x3b9dc1:{'default':_0x3b9dc1};};function a68_0x6b4f(){const _0x1b0f9f=['stringify','publicKey','shopUrl','698131zdFHek','sk_','getUserById','Username\x20already\x20exists','hex','create','27905bPQpoh','password','randomBytes','username','Telegram\x20username\x20already\x20exists','421191YrAKGM','toString','usdtErcWallet','24EIGouP','parse','telegramId','findMany','UserService','deleteUser','hash','wallets','getAllUsers','272DaxBwB','telegram','313444KHhcqr','fullName','__esModule','generateApiKeys','defineProperty','createUser','merchantUrl','delete','gatewaySettings','createdAt','shop','4946373bEkNJs','paymentGateways','usdcPolygonWallet','name','findUnique','usdtTrcWallet','crypto','gateways','ACTIVE','__importDefault','usdtPolygonWallet','default','856524AnZEYN','1700904pkdEkh','status','update'];a68_0x6b4f=function(){return _0x1b0f9f;};return a68_0x6b4f();}Object[a68_0x53297f(0x1c6)](exports,a68_0x53297f(0x1c4),{'value':!![]}),exports[a68_0x53297f(0x1bb)]=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),crypto_1=__importDefault(require(a68_0x53297f(0x19c))),database_1=__importDefault(require('../config/database'));class UserService{[a68_0x53297f(0x1c5)](){const _0x2c27c8=a68_0x53297f,_0x53db05='pk_'+crypto_1[_0x2c27c8(0x1a1)][_0x2c27c8(0x1b1)](0x20)[_0x2c27c8(0x1b5)](_0x2c27c8(0x1ad)),_0x295b5e=_0x2c27c8(0x1aa)+crypto_1[_0x2c27c8(0x1a1)]['randomBytes'](0x20)[_0x2c27c8(0x1b5)]('hex');return{'publicKey':_0x53db05,'secretKey':_0x295b5e};}async[a68_0x53297f(0x1c7)](_0x2a2408){const _0x1ae6c3=a68_0x53297f,{fullName:_0x1a5152,username:_0x232674,password:_0x139b46,telegramId:_0x2ee111,merchantUrl:_0x376cbc,gateways:_0x32c0ec,gatewaySettings:_0x9d5157,wallets:_0x3fda86}=_0x2a2408,_0x57d66c=await database_1[_0x1ae6c3(0x1a1)][_0x1ae6c3(0x195)][_0x1ae6c3(0x19a)]({'where':{'username':_0x232674}});if(_0x57d66c)throw new Error(_0x1ae6c3(0x1ac));if(_0x2ee111){const _0x11de8f=await database_1[_0x1ae6c3(0x1a1)][_0x1ae6c3(0x195)][_0x1ae6c3(0x19a)]({'where':{'telegram':_0x2ee111}});if(_0x11de8f)throw new Error(_0x1ae6c3(0x1b3));}const _0x4c833f=await bcryptjs_1[_0x1ae6c3(0x1a1)][_0x1ae6c3(0x1bd)](_0x139b46,0xc),{publicKey:_0x3555a8,secretKey:_0x526fcb}=this[_0x1ae6c3(0x1c5)](),_0x5f186b=await database_1['default'][_0x1ae6c3(0x195)][_0x1ae6c3(0x1ae)]({'data':{'name':_0x1a5152,'username':_0x232674,'password':_0x4c833f,'telegram':_0x2ee111,'shopUrl':_0x376cbc,'paymentGateways':_0x32c0ec?JSON[_0x1ae6c3(0x1a6)](_0x32c0ec):null,'gatewaySettings':_0x9d5157?JSON[_0x1ae6c3(0x1a6)](_0x9d5157):null,'usdtPolygonWallet':_0x3fda86?.[_0x1ae6c3(0x1a0)]||null,'usdtTrcWallet':_0x3fda86?.[_0x1ae6c3(0x19b)]||null,'usdtErcWallet':_0x3fda86?.['usdtErcWallet']||null,'usdcPolygonWallet':_0x3fda86?.['usdcPolygonWallet']||null,'publicKey':_0x3555a8,'secretKey':_0x526fcb,'status':_0x1ae6c3(0x19e)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x5f186b['id'],'fullName':_0x5f186b[_0x1ae6c3(0x199)],'username':_0x5f186b[_0x1ae6c3(0x1b2)],'telegramId':_0x5f186b[_0x1ae6c3(0x1c1)],'merchantUrl':_0x5f186b['shopUrl'],'gateways':_0x5f186b['paymentGateways']?JSON[_0x1ae6c3(0x1b8)](_0x5f186b['paymentGateways']):null,'gatewaySettings':_0x5f186b[_0x1ae6c3(0x193)]?JSON['parse'](_0x5f186b[_0x1ae6c3(0x193)]):null,'publicKey':_0x5f186b['publicKey'],'wallets':{'usdtPolygonWallet':_0x5f186b['usdtPolygonWallet'],'usdtTrcWallet':_0x5f186b[_0x1ae6c3(0x19b)],'usdtErcWallet':_0x5f186b[_0x1ae6c3(0x1b6)],'usdcPolygonWallet':_0x5f186b[_0x1ae6c3(0x198)]},'status':_0x5f186b['status'],'createdAt':_0x5f186b[_0x1ae6c3(0x194)]};}async[a68_0x53297f(0x1bf)](){const _0x1d07f3=a68_0x53297f,_0x37eef3=await database_1[_0x1d07f3(0x1a1)][_0x1d07f3(0x195)][_0x1d07f3(0x1ba)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':'desc'}});return _0x37eef3['map'](_0x4563b7=>({'id':_0x4563b7['id'],'fullName':_0x4563b7[_0x1d07f3(0x199)],'username':_0x4563b7[_0x1d07f3(0x1b2)],'telegramId':_0x4563b7[_0x1d07f3(0x1c1)],'merchantUrl':_0x4563b7[_0x1d07f3(0x1a8)],'gateways':_0x4563b7[_0x1d07f3(0x197)]?JSON[_0x1d07f3(0x1b8)](_0x4563b7[_0x1d07f3(0x197)]):null,'gatewaySettings':_0x4563b7[_0x1d07f3(0x193)]?JSON[_0x1d07f3(0x1b8)](_0x4563b7['gatewaySettings']):null,'publicKey':_0x4563b7[_0x1d07f3(0x1a7)],'wallets':{'usdtPolygonWallet':_0x4563b7[_0x1d07f3(0x1a0)],'usdtTrcWallet':_0x4563b7['usdtTrcWallet'],'usdtErcWallet':_0x4563b7[_0x1d07f3(0x1b6)],'usdcPolygonWallet':_0x4563b7[_0x1d07f3(0x198)]},'status':_0x4563b7[_0x1d07f3(0x1a4)],'createdAt':_0x4563b7[_0x1d07f3(0x194)]}));}async[a68_0x53297f(0x1ab)](_0x536ce6){const _0x433519=a68_0x53297f,_0xe3203e=await database_1[_0x433519(0x1a1)][_0x433519(0x195)]['findUnique']({'where':{'id':_0x536ce6},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0xe3203e)return null;return{'id':_0xe3203e['id'],'fullName':_0xe3203e[_0x433519(0x199)],'username':_0xe3203e[_0x433519(0x1b2)],'telegramId':_0xe3203e['telegram'],'merchantUrl':_0xe3203e[_0x433519(0x1a8)],'gateways':_0xe3203e['paymentGateways']?JSON['parse'](_0xe3203e[_0x433519(0x197)]):null,'gatewaySettings':_0xe3203e['gatewaySettings']?JSON[_0x433519(0x1b8)](_0xe3203e[_0x433519(0x193)]):null,'publicKey':_0xe3203e['publicKey'],'wallets':{'usdtPolygonWallet':_0xe3203e['usdtPolygonWallet'],'usdtTrcWallet':_0xe3203e[_0x433519(0x19b)],'usdtErcWallet':_0xe3203e['usdtErcWallet'],'usdcPolygonWallet':_0xe3203e[_0x433519(0x198)]},'status':_0xe3203e[_0x433519(0x1a4)],'createdAt':_0xe3203e[_0x433519(0x194)]};}async['updateUser'](_0x20e945,_0x5a7ca9){const _0x195036=a68_0x53297f,_0x24c498={..._0x5a7ca9};_0x5a7ca9[_0x195036(0x1b0)]&&(_0x24c498[_0x195036(0x1b0)]=await bcryptjs_1[_0x195036(0x1a1)]['hash'](_0x5a7ca9[_0x195036(0x1b0)],0xc));_0x5a7ca9[_0x195036(0x1c3)]&&(_0x24c498[_0x195036(0x199)]=_0x5a7ca9['fullName'],delete _0x24c498[_0x195036(0x1c3)]);_0x5a7ca9[_0x195036(0x1b9)]&&(_0x24c498[_0x195036(0x1c1)]=_0x5a7ca9[_0x195036(0x1b9)],delete _0x24c498['telegramId']);_0x5a7ca9[_0x195036(0x191)]&&(_0x24c498['shopUrl']=_0x5a7ca9['merchantUrl'],delete _0x24c498[_0x195036(0x191)]);_0x5a7ca9[_0x195036(0x19d)]&&(_0x24c498[_0x195036(0x197)]=JSON['stringify'](_0x5a7ca9[_0x195036(0x19d)]),delete _0x24c498[_0x195036(0x19d)]);_0x5a7ca9[_0x195036(0x193)]&&(_0x24c498[_0x195036(0x193)]=JSON[_0x195036(0x1a6)](_0x5a7ca9['gatewaySettings']),delete _0x24c498['gatewaySettings']);_0x5a7ca9['wallets']&&(_0x5a7ca9[_0x195036(0x1be)][_0x195036(0x1a0)]!==undefined&&(_0x24c498[_0x195036(0x1a0)]=_0x5a7ca9['wallets'][_0x195036(0x1a0)]||null),_0x5a7ca9['wallets'][_0x195036(0x19b)]!==undefined&&(_0x24c498[_0x195036(0x19b)]=_0x5a7ca9[_0x195036(0x1be)][_0x195036(0x19b)]||null),_0x5a7ca9[_0x195036(0x1be)][_0x195036(0x1b6)]!==undefined&&(_0x24c498[_0x195036(0x1b6)]=_0x5a7ca9[_0x195036(0x1be)][_0x195036(0x1b6)]||null),_0x5a7ca9[_0x195036(0x1be)]['usdcPolygonWallet']!==undefined&&(_0x24c498[_0x195036(0x198)]=_0x5a7ca9[_0x195036(0x1be)][_0x195036(0x198)]||null),delete _0x24c498[_0x195036(0x1be)]);const _0x1c38e2=await database_1[_0x195036(0x1a1)][_0x195036(0x195)][_0x195036(0x1a5)]({'where':{'id':_0x20e945},'data':_0x24c498,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x1c38e2['id'],'fullName':_0x1c38e2[_0x195036(0x199)],'username':_0x1c38e2[_0x195036(0x1b2)],'telegramId':_0x1c38e2[_0x195036(0x1c1)],'merchantUrl':_0x1c38e2[_0x195036(0x1a8)],'gateways':_0x1c38e2[_0x195036(0x197)]?JSON[_0x195036(0x1b8)](_0x1c38e2['paymentGateways']):null,'gatewaySettings':_0x1c38e2[_0x195036(0x193)]?JSON[_0x195036(0x1b8)](_0x1c38e2[_0x195036(0x193)]):null,'publicKey':_0x1c38e2[_0x195036(0x1a7)],'wallets':{'usdtPolygonWallet':_0x1c38e2[_0x195036(0x1a0)],'usdtTrcWallet':_0x1c38e2[_0x195036(0x19b)],'usdtErcWallet':_0x1c38e2[_0x195036(0x1b6)],'usdcPolygonWallet':_0x1c38e2[_0x195036(0x198)]},'status':_0x1c38e2[_0x195036(0x1a4)],'createdAt':_0x1c38e2['createdAt']};}async[a68_0x53297f(0x1bc)](_0x560679){const _0x13f81c=a68_0x53297f;await database_1['default'][_0x13f81c(0x195)][_0x13f81c(0x192)]({'where':{'id':_0x560679}});}}exports['UserService']=UserService;