'use strict';function a65_0x2969(_0x417afb,_0x38ae43){const _0x33825e=a65_0x3382();return a65_0x2969=function(_0x2969c6,_0x2ddb00){_0x2969c6=_0x2969c6-0x69;let _0x4ae243=_0x33825e[_0x2969c6];return _0x4ae243;},a65_0x2969(_0x417afb,_0x38ae43);}const a65_0x38511c=a65_0x2969;(function(_0x284bea,_0x32296c){const _0x408a0b=a65_0x2969,_0xb3593b=_0x284bea();while(!![]){try{const _0x5bdcba=parseInt(_0x408a0b(0x83))/0x1+-parseInt(_0x408a0b(0x8a))/0x2*(parseInt(_0x408a0b(0x9b))/0x3)+-parseInt(_0x408a0b(0x9c))/0x4*(parseInt(_0x408a0b(0x8f))/0x5)+parseInt(_0x408a0b(0x98))/0x6*(parseInt(_0x408a0b(0x7b))/0x7)+-parseInt(_0x408a0b(0x86))/0x8+parseInt(_0x408a0b(0x7d))/0x9+parseInt(_0x408a0b(0x78))/0xa;if(_0x5bdcba===_0x32296c)break;else _0xb3593b['push'](_0xb3593b['shift']());}catch(_0x383ae8){_0xb3593b['push'](_0xb3593b['shift']());}}}(a65_0x3382,0xc986f));var __importDefault=this&&this[a65_0x38511c(0x84)]||function(_0x4e56a2){const _0x510acd=a65_0x38511c;return _0x4e56a2&&_0x4e56a2[_0x510acd(0x6d)]?_0x4e56a2:{'default':_0x4e56a2};};Object[a65_0x38511c(0xa0)](exports,a65_0x38511c(0x6d),{'value':!![]}),exports[a65_0x38511c(0x90)]=void 0x0;const bcryptjs_1=__importDefault(require(a65_0x38511c(0x9a))),crypto_1=__importDefault(require(a65_0x38511c(0x6a))),database_1=__importDefault(require(a65_0x38511c(0x72)));function a65_0x3382(){const _0x5b4df6=['crypto','findMany','create','__esModule','gateways','usdcPolygonWallet','gatewaySettings','merchantUrl','../config/database','username','paymentGateways','status','usdtTrcWallet','telegram','32601510tHkiTr','findUnique','stringify','631239EFMekE','createdAt','1955277pyXlKN','publicKey','fullName','createUser','name','hash','436693YZkZow','__importDefault','telegramId','6424816zQSWIr','map','pk_','toString','2304474froLlJ','usdtErcWallet','default','password','updateUser','7019170pPYtDT','UserService','parse','wallets','generateApiKeys','Username\x20already\x20exists','sk_','usdtPolygonWallet','getUserById','18FlwXZb','ACTIVE','bcryptjs','3iNPGvN','4ZIvinC','shop','getAllUsers','hex','defineProperty','randomBytes','shopUrl'];a65_0x3382=function(){return _0x5b4df6;};return a65_0x3382();}class UserService{[a65_0x38511c(0x93)](){const _0x509607=a65_0x38511c,_0x556d24=_0x509607(0x88)+crypto_1[_0x509607(0x8c)]['randomBytes'](0x20)[_0x509607(0x89)](_0x509607(0x9f)),_0x3f4b20=_0x509607(0x95)+crypto_1['default'][_0x509607(0xa1)](0x20)[_0x509607(0x89)]('hex');return{'publicKey':_0x556d24,'secretKey':_0x3f4b20};}async[a65_0x38511c(0x80)](_0x3b448e){const _0x4ced8a=a65_0x38511c,{fullName:_0x52754c,username:_0x33922d,password:_0x1edf4e,telegramId:_0x1c7265,merchantUrl:_0x51c22f,gateways:_0x4cd34a,gatewaySettings:_0x3c98ec,wallets:_0x1d597b}=_0x3b448e,_0x52cd83=await database_1[_0x4ced8a(0x8c)][_0x4ced8a(0x9d)][_0x4ced8a(0x79)]({'where':{'username':_0x33922d}});if(_0x52cd83)throw new Error(_0x4ced8a(0x94));if(_0x1c7265){const _0x195281=await database_1[_0x4ced8a(0x8c)][_0x4ced8a(0x9d)]['findUnique']({'where':{'telegram':_0x1c7265}});if(_0x195281)throw new Error('Telegram\x20username\x20already\x20exists');}const _0x3d2296=await bcryptjs_1['default'][_0x4ced8a(0x82)](_0x1edf4e,0xc),{publicKey:_0x466e3b,secretKey:_0x10cccd}=this['generateApiKeys'](),_0x3971d5=await database_1[_0x4ced8a(0x8c)][_0x4ced8a(0x9d)][_0x4ced8a(0x6c)]({'data':{'name':_0x52754c,'username':_0x33922d,'password':_0x3d2296,'telegram':_0x1c7265,'shopUrl':_0x51c22f,'paymentGateways':_0x4cd34a?JSON['stringify'](_0x4cd34a):null,'gatewaySettings':_0x3c98ec?JSON[_0x4ced8a(0x7a)](_0x3c98ec):null,'usdtPolygonWallet':_0x1d597b?.['usdtPolygonWallet']||null,'usdtTrcWallet':_0x1d597b?.[_0x4ced8a(0x76)]||null,'usdtErcWallet':_0x1d597b?.[_0x4ced8a(0x8b)]||null,'usdcPolygonWallet':_0x1d597b?.[_0x4ced8a(0x6f)]||null,'publicKey':_0x466e3b,'secretKey':_0x10cccd,'status':_0x4ced8a(0x99)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x3971d5['id'],'fullName':_0x3971d5['name'],'username':_0x3971d5['username'],'telegramId':_0x3971d5[_0x4ced8a(0x77)],'merchantUrl':_0x3971d5['shopUrl'],'gateways':_0x3971d5[_0x4ced8a(0x74)]?JSON[_0x4ced8a(0x91)](_0x3971d5['paymentGateways']):null,'gatewaySettings':_0x3971d5[_0x4ced8a(0x70)]?JSON[_0x4ced8a(0x91)](_0x3971d5['gatewaySettings']):null,'publicKey':_0x3971d5[_0x4ced8a(0x7e)],'wallets':{'usdtPolygonWallet':_0x3971d5[_0x4ced8a(0x96)],'usdtTrcWallet':_0x3971d5[_0x4ced8a(0x76)],'usdtErcWallet':_0x3971d5[_0x4ced8a(0x8b)],'usdcPolygonWallet':_0x3971d5['usdcPolygonWallet']},'status':_0x3971d5[_0x4ced8a(0x75)],'createdAt':_0x3971d5['createdAt']};}async[a65_0x38511c(0x9e)](){const _0x1d29f1=a65_0x38511c,_0x8b9859=await database_1[_0x1d29f1(0x8c)]['shop'][_0x1d29f1(0x6b)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':'desc'}});return _0x8b9859[_0x1d29f1(0x87)](_0x2ac042=>({'id':_0x2ac042['id'],'fullName':_0x2ac042[_0x1d29f1(0x81)],'username':_0x2ac042[_0x1d29f1(0x73)],'telegramId':_0x2ac042[_0x1d29f1(0x77)],'merchantUrl':_0x2ac042[_0x1d29f1(0x69)],'gateways':_0x2ac042[_0x1d29f1(0x74)]?JSON[_0x1d29f1(0x91)](_0x2ac042['paymentGateways']):null,'gatewaySettings':_0x2ac042['gatewaySettings']?JSON[_0x1d29f1(0x91)](_0x2ac042[_0x1d29f1(0x70)]):null,'publicKey':_0x2ac042['publicKey'],'wallets':{'usdtPolygonWallet':_0x2ac042[_0x1d29f1(0x96)],'usdtTrcWallet':_0x2ac042[_0x1d29f1(0x76)],'usdtErcWallet':_0x2ac042['usdtErcWallet'],'usdcPolygonWallet':_0x2ac042['usdcPolygonWallet']},'status':_0x2ac042[_0x1d29f1(0x75)],'createdAt':_0x2ac042[_0x1d29f1(0x7c)]}));}async[a65_0x38511c(0x97)](_0xc63499){const _0x5c0dda=a65_0x38511c,_0x264844=await database_1[_0x5c0dda(0x8c)]['shop'][_0x5c0dda(0x79)]({'where':{'id':_0xc63499},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x264844)return null;return{'id':_0x264844['id'],'fullName':_0x264844[_0x5c0dda(0x81)],'username':_0x264844[_0x5c0dda(0x73)],'telegramId':_0x264844[_0x5c0dda(0x77)],'merchantUrl':_0x264844[_0x5c0dda(0x69)],'gateways':_0x264844['paymentGateways']?JSON['parse'](_0x264844[_0x5c0dda(0x74)]):null,'gatewaySettings':_0x264844[_0x5c0dda(0x70)]?JSON[_0x5c0dda(0x91)](_0x264844[_0x5c0dda(0x70)]):null,'publicKey':_0x264844[_0x5c0dda(0x7e)],'wallets':{'usdtPolygonWallet':_0x264844[_0x5c0dda(0x96)],'usdtTrcWallet':_0x264844[_0x5c0dda(0x76)],'usdtErcWallet':_0x264844[_0x5c0dda(0x8b)],'usdcPolygonWallet':_0x264844[_0x5c0dda(0x6f)]},'status':_0x264844[_0x5c0dda(0x75)],'createdAt':_0x264844[_0x5c0dda(0x7c)]};}async[a65_0x38511c(0x8e)](_0x4090af,_0x3db7d1){const _0x165632=a65_0x38511c,_0x3af957={..._0x3db7d1};_0x3db7d1[_0x165632(0x8d)]&&(_0x3af957[_0x165632(0x8d)]=await bcryptjs_1['default']['hash'](_0x3db7d1[_0x165632(0x8d)],0xc));_0x3db7d1[_0x165632(0x7f)]&&(_0x3af957[_0x165632(0x81)]=_0x3db7d1[_0x165632(0x7f)],delete _0x3af957[_0x165632(0x7f)]);_0x3db7d1[_0x165632(0x85)]&&(_0x3af957[_0x165632(0x77)]=_0x3db7d1['telegramId'],delete _0x3af957['telegramId']);_0x3db7d1['merchantUrl']&&(_0x3af957[_0x165632(0x69)]=_0x3db7d1[_0x165632(0x71)],delete _0x3af957[_0x165632(0x71)]);_0x3db7d1[_0x165632(0x6e)]&&(_0x3af957[_0x165632(0x74)]=JSON[_0x165632(0x7a)](_0x3db7d1['gateways']),delete _0x3af957['gateways']);_0x3db7d1['gatewaySettings']&&(_0x3af957[_0x165632(0x70)]=JSON['stringify'](_0x3db7d1[_0x165632(0x70)]),delete _0x3af957[_0x165632(0x70)]);_0x3db7d1[_0x165632(0x92)]&&(_0x3db7d1[_0x165632(0x92)][_0x165632(0x96)]!==undefined&&(_0x3af957[_0x165632(0x96)]=_0x3db7d1[_0x165632(0x92)][_0x165632(0x96)]||null),_0x3db7d1[_0x165632(0x92)][_0x165632(0x76)]!==undefined&&(_0x3af957[_0x165632(0x76)]=_0x3db7d1[_0x165632(0x92)][_0x165632(0x76)]||null),_0x3db7d1[_0x165632(0x92)][_0x165632(0x8b)]!==undefined&&(_0x3af957[_0x165632(0x8b)]=_0x3db7d1[_0x165632(0x92)]['usdtErcWallet']||null),_0x3db7d1[_0x165632(0x92)]['usdcPolygonWallet']!==undefined&&(_0x3af957[_0x165632(0x6f)]=_0x3db7d1[_0x165632(0x92)][_0x165632(0x6f)]||null),delete _0x3af957[_0x165632(0x92)]);const _0x58b1ac=await database_1[_0x165632(0x8c)]['shop']['update']({'where':{'id':_0x4090af},'data':_0x3af957,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x58b1ac['id'],'fullName':_0x58b1ac[_0x165632(0x81)],'username':_0x58b1ac[_0x165632(0x73)],'telegramId':_0x58b1ac[_0x165632(0x77)],'merchantUrl':_0x58b1ac['shopUrl'],'gateways':_0x58b1ac[_0x165632(0x74)]?JSON[_0x165632(0x91)](_0x58b1ac[_0x165632(0x74)]):null,'gatewaySettings':_0x58b1ac[_0x165632(0x70)]?JSON[_0x165632(0x91)](_0x58b1ac[_0x165632(0x70)]):null,'publicKey':_0x58b1ac['publicKey'],'wallets':{'usdtPolygonWallet':_0x58b1ac[_0x165632(0x96)],'usdtTrcWallet':_0x58b1ac[_0x165632(0x76)],'usdtErcWallet':_0x58b1ac['usdtErcWallet'],'usdcPolygonWallet':_0x58b1ac[_0x165632(0x6f)]},'status':_0x58b1ac['status'],'createdAt':_0x58b1ac['createdAt']};}async['deleteUser'](_0x3b378f){const _0x9677de=a65_0x38511c;await database_1[_0x9677de(0x8c)][_0x9677de(0x9d)]['delete']({'where':{'id':_0x3b378f}});}}exports[a65_0x38511c(0x90)]=UserService;