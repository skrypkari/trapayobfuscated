'use strict';const a79_0xecd0eb=a79_0x79b0;(function(_0x3cfbd0,_0x2326f4){const _0x203a3b=a79_0x79b0,_0x557b18=_0x3cfbd0();while(!![]){try{const _0x43fe1a=-parseInt(_0x203a3b(0x119))/0x1*(-parseInt(_0x203a3b(0x10c))/0x2)+-parseInt(_0x203a3b(0x11a))/0x3+-parseInt(_0x203a3b(0x117))/0x4+-parseInt(_0x203a3b(0xfc))/0x5+parseInt(_0x203a3b(0x113))/0x6*(-parseInt(_0x203a3b(0x106))/0x7)+-parseInt(_0x203a3b(0x115))/0x8*(-parseInt(_0x203a3b(0x122))/0x9)+parseInt(_0x203a3b(0x10b))/0xa;if(_0x43fe1a===_0x2326f4)break;else _0x557b18['push'](_0x557b18['shift']());}catch(_0x30421d){_0x557b18['push'](_0x557b18['shift']());}}}(a79_0xcc05,0xc036d));var __importDefault=this&&this[a79_0xecd0eb(0x126)]||function(_0x79bfe9){return _0x79bfe9&&_0x79bfe9['__esModule']?_0x79bfe9:{'default':_0x79bfe9};};function a79_0x79b0(_0x2158a6,_0x3e1a94){_0x2158a6=_0x2158a6-0xf7;const _0xcc052b=a79_0xcc05();let _0x79b0c6=_0xcc052b[_0x2158a6];return _0x79b0c6;}Object[a79_0xecd0eb(0x123)](exports,a79_0xecd0eb(0x11f),{'value':!![]}),exports[a79_0xecd0eb(0x125)]=void 0x0;const bcryptjs_1=__importDefault(require(a79_0xecd0eb(0x114))),crypto_1=__importDefault(require(a79_0xecd0eb(0x127))),database_1=__importDefault(require('../config/database'));class UserService{[a79_0xecd0eb(0x10d)](){const _0x45098a=a79_0xecd0eb,_0x21ff06='pk_'+crypto_1[_0x45098a(0x120)][_0x45098a(0x128)](0x20)[_0x45098a(0x111)](_0x45098a(0x116)),_0x2aa6e0='sk_'+crypto_1['default'][_0x45098a(0x128)](0x20)[_0x45098a(0x111)](_0x45098a(0x116));return{'publicKey':_0x21ff06,'secretKey':_0x2aa6e0};}async[a79_0xecd0eb(0x11d)](_0x4d76f1){const _0x3f33ea=a79_0xecd0eb,{fullName:_0x408a51,username:_0x48577e,password:_0x5ae987,telegramId:_0x26ec4f,merchantUrl:_0x5d1407,gateways:_0x281f10,gatewaySettings:_0xf55bc4,wallets:_0x390ddd}=_0x4d76f1,_0x99765e=await database_1[_0x3f33ea(0x120)][_0x3f33ea(0xf7)][_0x3f33ea(0xfb)]({'where':{'username':_0x48577e}});if(_0x99765e)throw new Error('Username\x20already\x20exists');if(_0x26ec4f){const _0xc29ea3=await database_1['default'][_0x3f33ea(0xf7)][_0x3f33ea(0xfb)]({'where':{'telegram':_0x26ec4f}});if(_0xc29ea3)throw new Error('Telegram\x20username\x20already\x20exists');}const _0x345816=await bcryptjs_1[_0x3f33ea(0x120)]['hash'](_0x5ae987,0xc),{publicKey:_0x5d99ce,secretKey:_0x5da375}=this[_0x3f33ea(0x10d)](),_0x52ee96=await database_1[_0x3f33ea(0x120)][_0x3f33ea(0xf7)][_0x3f33ea(0x101)]({'data':{'name':_0x408a51,'username':_0x48577e,'password':_0x345816,'telegram':_0x26ec4f,'shopUrl':_0x5d1407,'paymentGateways':_0x281f10?JSON[_0x3f33ea(0x107)](_0x281f10):null,'gatewaySettings':_0xf55bc4?JSON[_0x3f33ea(0x107)](_0xf55bc4):null,'usdtPolygonWallet':_0x390ddd?.[_0x3f33ea(0x105)]||null,'usdtTrcWallet':_0x390ddd?.[_0x3f33ea(0x124)]||null,'usdtErcWallet':_0x390ddd?.['usdtErcWallet']||null,'usdcPolygonWallet':_0x390ddd?.['usdcPolygonWallet']||null,'publicKey':_0x5d99ce,'secretKey':_0x5da375,'status':_0x3f33ea(0xf9)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x52ee96['id'],'fullName':_0x52ee96['name'],'username':_0x52ee96['username'],'telegramId':_0x52ee96[_0x3f33ea(0x100)],'merchantUrl':_0x52ee96['shopUrl'],'gateways':_0x52ee96[_0x3f33ea(0x102)]?JSON[_0x3f33ea(0x112)](_0x52ee96[_0x3f33ea(0x102)]):null,'gatewaySettings':_0x52ee96[_0x3f33ea(0x10a)]?JSON[_0x3f33ea(0x112)](_0x52ee96[_0x3f33ea(0x10a)]):null,'publicKey':_0x52ee96['publicKey'],'wallets':{'usdtPolygonWallet':_0x52ee96['usdtPolygonWallet'],'usdtTrcWallet':_0x52ee96[_0x3f33ea(0x124)],'usdtErcWallet':_0x52ee96[_0x3f33ea(0x11c)],'usdcPolygonWallet':_0x52ee96[_0x3f33ea(0xfa)]},'status':_0x52ee96[_0x3f33ea(0x118)],'createdAt':_0x52ee96[_0x3f33ea(0x110)]};}async['getAllUsers'](){const _0x406739=a79_0xecd0eb,_0x10f737=await database_1[_0x406739(0x120)][_0x406739(0xf7)][_0x406739(0x108)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x406739(0x10e)}});return _0x10f737['map'](_0x26e455=>({'id':_0x26e455['id'],'fullName':_0x26e455[_0x406739(0x11b)],'username':_0x26e455[_0x406739(0x10f)],'telegramId':_0x26e455[_0x406739(0x100)],'merchantUrl':_0x26e455[_0x406739(0xfe)],'gateways':_0x26e455[_0x406739(0x102)]?JSON['parse'](_0x26e455[_0x406739(0x102)]):null,'gatewaySettings':_0x26e455[_0x406739(0x10a)]?JSON[_0x406739(0x112)](_0x26e455[_0x406739(0x10a)]):null,'publicKey':_0x26e455['publicKey'],'wallets':{'usdtPolygonWallet':_0x26e455['usdtPolygonWallet'],'usdtTrcWallet':_0x26e455['usdtTrcWallet'],'usdtErcWallet':_0x26e455[_0x406739(0x11c)],'usdcPolygonWallet':_0x26e455[_0x406739(0xfa)]},'status':_0x26e455[_0x406739(0x118)],'createdAt':_0x26e455[_0x406739(0x110)]}));}async[a79_0xecd0eb(0x11e)](_0x5b4953){const _0x59b71f=a79_0xecd0eb,_0x240a8d=await database_1[_0x59b71f(0x120)]['shop'][_0x59b71f(0xfb)]({'where':{'id':_0x5b4953},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x240a8d)return null;return{'id':_0x240a8d['id'],'fullName':_0x240a8d[_0x59b71f(0x11b)],'username':_0x240a8d[_0x59b71f(0x10f)],'telegramId':_0x240a8d[_0x59b71f(0x100)],'merchantUrl':_0x240a8d[_0x59b71f(0xfe)],'gateways':_0x240a8d[_0x59b71f(0x102)]?JSON[_0x59b71f(0x112)](_0x240a8d[_0x59b71f(0x102)]):null,'gatewaySettings':_0x240a8d['gatewaySettings']?JSON[_0x59b71f(0x112)](_0x240a8d['gatewaySettings']):null,'publicKey':_0x240a8d[_0x59b71f(0xff)],'wallets':{'usdtPolygonWallet':_0x240a8d['usdtPolygonWallet'],'usdtTrcWallet':_0x240a8d[_0x59b71f(0x124)],'usdtErcWallet':_0x240a8d[_0x59b71f(0x11c)],'usdcPolygonWallet':_0x240a8d[_0x59b71f(0xfa)]},'status':_0x240a8d[_0x59b71f(0x118)],'createdAt':_0x240a8d[_0x59b71f(0x110)]};}async['updateUser'](_0x4fc6ed,_0x4c662a){const _0x2cc834=a79_0xecd0eb,_0x486e27={..._0x4c662a};_0x4c662a[_0x2cc834(0x109)]&&(_0x486e27['password']=await bcryptjs_1['default']['hash'](_0x4c662a['password'],0xc));_0x4c662a['fullName']&&(_0x486e27[_0x2cc834(0x11b)]=_0x4c662a[_0x2cc834(0xfd)],delete _0x486e27[_0x2cc834(0xfd)]);_0x4c662a[_0x2cc834(0xf8)]&&(_0x486e27[_0x2cc834(0x100)]=_0x4c662a[_0x2cc834(0xf8)],delete _0x486e27[_0x2cc834(0xf8)]);_0x4c662a['merchantUrl']&&(_0x486e27[_0x2cc834(0xfe)]=_0x4c662a[_0x2cc834(0x129)],delete _0x486e27[_0x2cc834(0x129)]);_0x4c662a[_0x2cc834(0x121)]&&(_0x486e27[_0x2cc834(0x102)]=JSON[_0x2cc834(0x107)](_0x4c662a['gateways']),delete _0x486e27[_0x2cc834(0x121)]);_0x4c662a['gatewaySettings']&&(_0x486e27[_0x2cc834(0x10a)]=JSON[_0x2cc834(0x107)](_0x4c662a['gatewaySettings']),delete _0x486e27[_0x2cc834(0x10a)]);_0x4c662a[_0x2cc834(0x103)]&&(_0x4c662a[_0x2cc834(0x103)]['usdtPolygonWallet']!==undefined&&(_0x486e27[_0x2cc834(0x105)]=_0x4c662a[_0x2cc834(0x103)][_0x2cc834(0x105)]||null),_0x4c662a[_0x2cc834(0x103)][_0x2cc834(0x124)]!==undefined&&(_0x486e27[_0x2cc834(0x124)]=_0x4c662a[_0x2cc834(0x103)]['usdtTrcWallet']||null),_0x4c662a[_0x2cc834(0x103)][_0x2cc834(0x11c)]!==undefined&&(_0x486e27[_0x2cc834(0x11c)]=_0x4c662a[_0x2cc834(0x103)]['usdtErcWallet']||null),_0x4c662a[_0x2cc834(0x103)][_0x2cc834(0xfa)]!==undefined&&(_0x486e27[_0x2cc834(0xfa)]=_0x4c662a[_0x2cc834(0x103)][_0x2cc834(0xfa)]||null),delete _0x486e27[_0x2cc834(0x103)]);const _0x30ac28=await database_1[_0x2cc834(0x120)]['shop']['update']({'where':{'id':_0x4fc6ed},'data':_0x486e27,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x30ac28['id'],'fullName':_0x30ac28[_0x2cc834(0x11b)],'username':_0x30ac28[_0x2cc834(0x10f)],'telegramId':_0x30ac28[_0x2cc834(0x100)],'merchantUrl':_0x30ac28[_0x2cc834(0xfe)],'gateways':_0x30ac28[_0x2cc834(0x102)]?JSON[_0x2cc834(0x112)](_0x30ac28[_0x2cc834(0x102)]):null,'gatewaySettings':_0x30ac28[_0x2cc834(0x10a)]?JSON[_0x2cc834(0x112)](_0x30ac28[_0x2cc834(0x10a)]):null,'publicKey':_0x30ac28['publicKey'],'wallets':{'usdtPolygonWallet':_0x30ac28[_0x2cc834(0x105)],'usdtTrcWallet':_0x30ac28[_0x2cc834(0x124)],'usdtErcWallet':_0x30ac28[_0x2cc834(0x11c)],'usdcPolygonWallet':_0x30ac28['usdcPolygonWallet']},'status':_0x30ac28[_0x2cc834(0x118)],'createdAt':_0x30ac28[_0x2cc834(0x110)]};}async[a79_0xecd0eb(0x104)](_0x373811){const _0x120f54=a79_0xecd0eb;await database_1['default'][_0x120f54(0xf7)]['delete']({'where':{'id':_0x373811}});}}function a79_0xcc05(){const _0x557d28=['usdtTrcWallet','UserService','__importDefault','crypto','randomBytes','merchantUrl','shop','telegramId','ACTIVE','usdcPolygonWallet','findUnique','719910kJKUbR','fullName','shopUrl','publicKey','telegram','create','paymentGateways','wallets','deleteUser','usdtPolygonWallet','511406viMAAa','stringify','findMany','password','gatewaySettings','24843660AbmVjw','2GwsIZv','generateApiKeys','desc','username','createdAt','toString','parse','12lLszZm','bcryptjs','5594216kEWmCX','hex','2755660qUeIVU','status','54877OTfeIp','4416594LSlern','name','usdtErcWallet','createUser','getUserById','__esModule','default','gateways','9qxggjI','defineProperty'];a79_0xcc05=function(){return _0x557d28;};return a79_0xcc05();}exports[a79_0xecd0eb(0x125)]=UserService;