'use strict';const a56_0x739215=a56_0x5181;(function(_0xfae5a2,_0x545769){const _0x4c4b67=a56_0x5181,_0x4867a4=_0xfae5a2();while(!![]){try{const _0x5c0d8c=parseInt(_0x4c4b67(0x178))/0x1*(parseInt(_0x4c4b67(0x188))/0x2)+parseInt(_0x4c4b67(0x17b))/0x3+parseInt(_0x4c4b67(0x184))/0x4+-parseInt(_0x4c4b67(0x18b))/0x5*(-parseInt(_0x4c4b67(0x182))/0x6)+parseInt(_0x4c4b67(0x164))/0x7*(parseInt(_0x4c4b67(0x160))/0x8)+-parseInt(_0x4c4b67(0x165))/0x9*(parseInt(_0x4c4b67(0x173))/0xa)+-parseInt(_0x4c4b67(0x185))/0xb*(parseInt(_0x4c4b67(0x18a))/0xc);if(_0x5c0d8c===_0x545769)break;else _0x4867a4['push'](_0x4867a4['shift']());}catch(_0x4f7a51){_0x4867a4['push'](_0x4867a4['shift']());}}}(a56_0x54c0,0x6d159));var __importDefault=this&&this[a56_0x739215(0x154)]||function(_0x1ad44d){return _0x1ad44d&&_0x1ad44d['__esModule']?_0x1ad44d:{'default':_0x1ad44d};};Object[a56_0x739215(0x15a)](exports,'__esModule',{'value':!![]}),exports['UserService']=void 0x0;const bcryptjs_1=__importDefault(require(a56_0x739215(0x179))),crypto_1=__importDefault(require(a56_0x739215(0x170))),database_1=__importDefault(require(a56_0x739215(0x181)));function a56_0x5181(_0x161898,_0x1b6153){const _0x54c0ad=a56_0x54c0();return a56_0x5181=function(_0x5181cb,_0x3f36bc){_0x5181cb=_0x5181cb-0x154;let _0x200afe=_0x54c0ad[_0x5181cb];return _0x200afe;},a56_0x5181(_0x161898,_0x1b6153);}function a56_0x54c0(){const _0x5d43d9=['bcryptjs','usdtPolygonWallet','2114436eNTFVW','desc','Username\x20already\x20exists','findUnique','password','telegramId','../config/database','6wKLFhZ','delete','3452184gglauR','11qQhFBD','ACTIVE','createdAt','454cGclSu','status','24912888Stdjrw','671205pkchvR','stringify','generateApiKeys','usdtErcWallet','getAllUsers','__importDefault','toString','shop','update','wallets','telegram','defineProperty','hex','findMany','username','Telegram\x20username\x20already\x20exists','fullName','8yvhPzW','hash','usdtTrcWallet','name','2311491ePPQdX','18PFgMNQ','usdcPolygonWallet','merchantUrl','updateUser','sk_','getUserById','shopUrl','parse','deleteUser','default','publicKey','crypto','pk_','create','1781830QZEEES','gateways','paymentGateways','map','gatewaySettings','3731DDTJzW'];a56_0x54c0=function(){return _0x5d43d9;};return a56_0x54c0();}class UserService{[a56_0x739215(0x18d)](){const _0x63ac6c=a56_0x739215,_0x16761d=_0x63ac6c(0x171)+crypto_1[_0x63ac6c(0x16e)]['randomBytes'](0x20)[_0x63ac6c(0x155)](_0x63ac6c(0x15b)),_0x1c44f4=_0x63ac6c(0x169)+crypto_1[_0x63ac6c(0x16e)]['randomBytes'](0x20)[_0x63ac6c(0x155)]('hex');return{'publicKey':_0x16761d,'secretKey':_0x1c44f4};}async['createUser'](_0x137efb){const _0x184ed9=a56_0x739215,{fullName:_0xd25db3,username:_0x16ba39,password:_0x387ca9,telegramId:_0x4a86c1,merchantUrl:_0x252669,gateways:_0x352dd5,gatewaySettings:_0x199685,wallets:_0x1049ee}=_0x137efb,_0x360cc0=await database_1['default']['shop'][_0x184ed9(0x17e)]({'where':{'username':_0x16ba39}});if(_0x360cc0)throw new Error(_0x184ed9(0x17d));if(_0x4a86c1){const _0x42db63=await database_1[_0x184ed9(0x16e)][_0x184ed9(0x156)][_0x184ed9(0x17e)]({'where':{'telegram':_0x4a86c1}});if(_0x42db63)throw new Error(_0x184ed9(0x15e));}const _0x298c65=await bcryptjs_1[_0x184ed9(0x16e)][_0x184ed9(0x161)](_0x387ca9,0xc),{publicKey:_0x51e5d7,secretKey:_0x5d0156}=this[_0x184ed9(0x18d)](),_0x3ec7f0=await database_1['default'][_0x184ed9(0x156)][_0x184ed9(0x172)]({'data':{'name':_0xd25db3,'username':_0x16ba39,'password':_0x298c65,'telegram':_0x4a86c1,'shopUrl':_0x252669,'paymentGateways':_0x352dd5?JSON['stringify'](_0x352dd5):null,'gatewaySettings':_0x199685?JSON[_0x184ed9(0x18c)](_0x199685):null,'usdtPolygonWallet':_0x1049ee?.[_0x184ed9(0x17a)]||null,'usdtTrcWallet':_0x1049ee?.[_0x184ed9(0x162)]||null,'usdtErcWallet':_0x1049ee?.[_0x184ed9(0x18e)]||null,'usdcPolygonWallet':_0x1049ee?.['usdcPolygonWallet']||null,'publicKey':_0x51e5d7,'secretKey':_0x5d0156,'status':_0x184ed9(0x186)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x3ec7f0['id'],'fullName':_0x3ec7f0[_0x184ed9(0x163)],'username':_0x3ec7f0['username'],'telegramId':_0x3ec7f0[_0x184ed9(0x159)],'merchantUrl':_0x3ec7f0['shopUrl'],'gateways':_0x3ec7f0[_0x184ed9(0x175)]?JSON['parse'](_0x3ec7f0[_0x184ed9(0x175)]):null,'gatewaySettings':_0x3ec7f0[_0x184ed9(0x177)]?JSON[_0x184ed9(0x16c)](_0x3ec7f0[_0x184ed9(0x177)]):null,'publicKey':_0x3ec7f0[_0x184ed9(0x16f)],'wallets':{'usdtPolygonWallet':_0x3ec7f0[_0x184ed9(0x17a)],'usdtTrcWallet':_0x3ec7f0['usdtTrcWallet'],'usdtErcWallet':_0x3ec7f0['usdtErcWallet'],'usdcPolygonWallet':_0x3ec7f0[_0x184ed9(0x166)]},'status':_0x3ec7f0['status'],'createdAt':_0x3ec7f0[_0x184ed9(0x187)]};}async[a56_0x739215(0x18f)](){const _0x27e983=a56_0x739215,_0x3353d6=await database_1[_0x27e983(0x16e)]['shop'][_0x27e983(0x15c)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x27e983(0x17c)}});return _0x3353d6[_0x27e983(0x176)](_0x5ba601=>({'id':_0x5ba601['id'],'fullName':_0x5ba601[_0x27e983(0x163)],'username':_0x5ba601[_0x27e983(0x15d)],'telegramId':_0x5ba601[_0x27e983(0x159)],'merchantUrl':_0x5ba601[_0x27e983(0x16b)],'gateways':_0x5ba601[_0x27e983(0x175)]?JSON['parse'](_0x5ba601[_0x27e983(0x175)]):null,'gatewaySettings':_0x5ba601[_0x27e983(0x177)]?JSON[_0x27e983(0x16c)](_0x5ba601[_0x27e983(0x177)]):null,'publicKey':_0x5ba601[_0x27e983(0x16f)],'wallets':{'usdtPolygonWallet':_0x5ba601[_0x27e983(0x17a)],'usdtTrcWallet':_0x5ba601[_0x27e983(0x162)],'usdtErcWallet':_0x5ba601[_0x27e983(0x18e)],'usdcPolygonWallet':_0x5ba601[_0x27e983(0x166)]},'status':_0x5ba601['status'],'createdAt':_0x5ba601[_0x27e983(0x187)]}));}async[a56_0x739215(0x16a)](_0x157f06){const _0x5ed7dc=a56_0x739215,_0x3f3de8=await database_1[_0x5ed7dc(0x16e)][_0x5ed7dc(0x156)][_0x5ed7dc(0x17e)]({'where':{'id':_0x157f06},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x3f3de8)return null;return{'id':_0x3f3de8['id'],'fullName':_0x3f3de8[_0x5ed7dc(0x163)],'username':_0x3f3de8[_0x5ed7dc(0x15d)],'telegramId':_0x3f3de8['telegram'],'merchantUrl':_0x3f3de8[_0x5ed7dc(0x16b)],'gateways':_0x3f3de8[_0x5ed7dc(0x175)]?JSON[_0x5ed7dc(0x16c)](_0x3f3de8['paymentGateways']):null,'gatewaySettings':_0x3f3de8[_0x5ed7dc(0x177)]?JSON[_0x5ed7dc(0x16c)](_0x3f3de8['gatewaySettings']):null,'publicKey':_0x3f3de8['publicKey'],'wallets':{'usdtPolygonWallet':_0x3f3de8[_0x5ed7dc(0x17a)],'usdtTrcWallet':_0x3f3de8['usdtTrcWallet'],'usdtErcWallet':_0x3f3de8[_0x5ed7dc(0x18e)],'usdcPolygonWallet':_0x3f3de8[_0x5ed7dc(0x166)]},'status':_0x3f3de8[_0x5ed7dc(0x189)],'createdAt':_0x3f3de8[_0x5ed7dc(0x187)]};}async[a56_0x739215(0x168)](_0x4a43a8,_0x53ce24){const _0x3f797c=a56_0x739215,_0x26c3a8={..._0x53ce24};_0x53ce24['password']&&(_0x26c3a8[_0x3f797c(0x17f)]=await bcryptjs_1['default'][_0x3f797c(0x161)](_0x53ce24[_0x3f797c(0x17f)],0xc));_0x53ce24[_0x3f797c(0x15f)]&&(_0x26c3a8['name']=_0x53ce24[_0x3f797c(0x15f)],delete _0x26c3a8['fullName']);_0x53ce24['telegramId']&&(_0x26c3a8[_0x3f797c(0x159)]=_0x53ce24[_0x3f797c(0x180)],delete _0x26c3a8[_0x3f797c(0x180)]);_0x53ce24[_0x3f797c(0x167)]&&(_0x26c3a8['shopUrl']=_0x53ce24[_0x3f797c(0x167)],delete _0x26c3a8['merchantUrl']);_0x53ce24['gateways']&&(_0x26c3a8[_0x3f797c(0x175)]=JSON[_0x3f797c(0x18c)](_0x53ce24[_0x3f797c(0x174)]),delete _0x26c3a8['gateways']);_0x53ce24[_0x3f797c(0x177)]&&(_0x26c3a8[_0x3f797c(0x177)]=JSON[_0x3f797c(0x18c)](_0x53ce24[_0x3f797c(0x177)]),delete _0x26c3a8[_0x3f797c(0x177)]);_0x53ce24['wallets']&&(_0x53ce24[_0x3f797c(0x158)][_0x3f797c(0x17a)]!==undefined&&(_0x26c3a8[_0x3f797c(0x17a)]=_0x53ce24[_0x3f797c(0x158)][_0x3f797c(0x17a)]||null),_0x53ce24[_0x3f797c(0x158)]['usdtTrcWallet']!==undefined&&(_0x26c3a8[_0x3f797c(0x162)]=_0x53ce24['wallets'][_0x3f797c(0x162)]||null),_0x53ce24[_0x3f797c(0x158)]['usdtErcWallet']!==undefined&&(_0x26c3a8[_0x3f797c(0x18e)]=_0x53ce24[_0x3f797c(0x158)][_0x3f797c(0x18e)]||null),_0x53ce24[_0x3f797c(0x158)][_0x3f797c(0x166)]!==undefined&&(_0x26c3a8[_0x3f797c(0x166)]=_0x53ce24[_0x3f797c(0x158)][_0x3f797c(0x166)]||null),delete _0x26c3a8['wallets']);const _0x45ee88=await database_1[_0x3f797c(0x16e)][_0x3f797c(0x156)][_0x3f797c(0x157)]({'where':{'id':_0x4a43a8},'data':_0x26c3a8,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x45ee88['id'],'fullName':_0x45ee88[_0x3f797c(0x163)],'username':_0x45ee88[_0x3f797c(0x15d)],'telegramId':_0x45ee88[_0x3f797c(0x159)],'merchantUrl':_0x45ee88['shopUrl'],'gateways':_0x45ee88['paymentGateways']?JSON['parse'](_0x45ee88['paymentGateways']):null,'gatewaySettings':_0x45ee88[_0x3f797c(0x177)]?JSON[_0x3f797c(0x16c)](_0x45ee88[_0x3f797c(0x177)]):null,'publicKey':_0x45ee88['publicKey'],'wallets':{'usdtPolygonWallet':_0x45ee88[_0x3f797c(0x17a)],'usdtTrcWallet':_0x45ee88[_0x3f797c(0x162)],'usdtErcWallet':_0x45ee88[_0x3f797c(0x18e)],'usdcPolygonWallet':_0x45ee88[_0x3f797c(0x166)]},'status':_0x45ee88[_0x3f797c(0x189)],'createdAt':_0x45ee88[_0x3f797c(0x187)]};}async[a56_0x739215(0x16d)](_0x115468){const _0x2a16d2=a56_0x739215;await database_1[_0x2a16d2(0x16e)][_0x2a16d2(0x156)][_0x2a16d2(0x183)]({'where':{'id':_0x115468}});}}exports['UserService']=UserService;