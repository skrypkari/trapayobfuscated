'use strict';function a51_0x44e5(_0x31bb74,_0x4ef696){const _0x13917d=a51_0x1391();return a51_0x44e5=function(_0x44e533,_0x121c9a){_0x44e533=_0x44e533-0x180;let _0x5da17a=_0x13917d[_0x44e533];return _0x5da17a;},a51_0x44e5(_0x31bb74,_0x4ef696);}const a51_0x101456=a51_0x44e5;(function(_0x45fa61,_0x4c1464){const _0x94dc17=a51_0x44e5,_0x3abf3e=_0x45fa61();while(!![]){try{const _0x4fd44c=-parseInt(_0x94dc17(0x183))/0x1+-parseInt(_0x94dc17(0x189))/0x2*(-parseInt(_0x94dc17(0x1b5))/0x3)+-parseInt(_0x94dc17(0x1a1))/0x4*(parseInt(_0x94dc17(0x194))/0x5)+parseInt(_0x94dc17(0x1b1))/0x6+parseInt(_0x94dc17(0x1b4))/0x7+parseInt(_0x94dc17(0x1b0))/0x8+parseInt(_0x94dc17(0x1a4))/0x9;if(_0x4fd44c===_0x4c1464)break;else _0x3abf3e['push'](_0x3abf3e['shift']());}catch(_0x2a474d){_0x3abf3e['push'](_0x3abf3e['shift']());}}}(a51_0x1391,0x35be3));function a51_0x1391(){const _0x40d0fd=['stringify','606582CDXToB','findMany','merchantUrl','UserService','usdtPolygonWallet','fullName','publicKey','createUser','defineProperty','pk_','paymentGateways','randomBytes','981632yLFOoK','649638ENTUGd','usdtTrcWallet','update','476504ZeBNnz','235059pPeBky','default','ACTIVE','../config/database','getAllUsers','gatewaySettings','__importDefault','421738FCXjVE','parse','sk_','telegram','getUserById','generateApiKeys','10PwQeME','username','hash','shopUrl','map','Telegram\x20username\x20already\x20exists','status','shop','delete','telegramId','usdtErcWallet','193905ghORVz','gateways','hex','usdcPolygonWallet','wallets','desc','Username\x20already\x20exists','deleteUser','toString','password','findUnique','crypto','createdAt','12WfSQmm','name'];a51_0x1391=function(){return _0x40d0fd;};return a51_0x1391();}var __importDefault=this&&this[a51_0x101456(0x182)]||function(_0x2de122){return _0x2de122&&_0x2de122['__esModule']?_0x2de122:{'default':_0x2de122};};Object[a51_0x101456(0x1ac)](exports,'__esModule',{'value':!![]}),exports[a51_0x101456(0x1a7)]=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),crypto_1=__importDefault(require(a51_0x101456(0x19f))),database_1=__importDefault(require(a51_0x101456(0x1b8)));class UserService{[a51_0x101456(0x188)](){const _0x790e4d=a51_0x101456,_0x2112f8=_0x790e4d(0x1ad)+crypto_1[_0x790e4d(0x1b6)]['randomBytes'](0x20)[_0x790e4d(0x19c)]('hex'),_0x518048=_0x790e4d(0x185)+crypto_1[_0x790e4d(0x1b6)][_0x790e4d(0x1af)](0x20)['toString'](_0x790e4d(0x196));return{'publicKey':_0x2112f8,'secretKey':_0x518048};}async[a51_0x101456(0x1ab)](_0x29777c){const _0x312d26=a51_0x101456,{fullName:_0x59d833,username:_0x119e9c,password:_0x111d39,telegramId:_0x2420e6,merchantUrl:_0x53d0fa,gateways:_0x4448dc,gatewaySettings:_0x3a24b4,wallets:_0x512a77}=_0x29777c,_0x4a4627=await database_1[_0x312d26(0x1b6)][_0x312d26(0x190)][_0x312d26(0x19e)]({'where':{'username':_0x119e9c}});if(_0x4a4627)throw new Error(_0x312d26(0x19a));if(_0x2420e6){const _0xe596c2=await database_1[_0x312d26(0x1b6)][_0x312d26(0x190)][_0x312d26(0x19e)]({'where':{'telegram':_0x2420e6}});if(_0xe596c2)throw new Error(_0x312d26(0x18e));}const _0x26f204=await bcryptjs_1[_0x312d26(0x1b6)][_0x312d26(0x18b)](_0x111d39,0xc),{publicKey:_0x54c3bd,secretKey:_0x21a5d4}=this[_0x312d26(0x188)](),_0x2607ad=await database_1[_0x312d26(0x1b6)][_0x312d26(0x190)]['create']({'data':{'name':_0x59d833,'username':_0x119e9c,'password':_0x26f204,'telegram':_0x2420e6,'shopUrl':_0x53d0fa,'paymentGateways':_0x4448dc?JSON['stringify'](_0x4448dc):null,'gatewaySettings':_0x3a24b4?JSON[_0x312d26(0x1a3)](_0x3a24b4):null,'usdtPolygonWallet':_0x512a77?.['usdtPolygonWallet']||null,'usdtTrcWallet':_0x512a77?.['usdtTrcWallet']||null,'usdtErcWallet':_0x512a77?.[_0x312d26(0x193)]||null,'usdcPolygonWallet':_0x512a77?.[_0x312d26(0x197)]||null,'publicKey':_0x54c3bd,'secretKey':_0x21a5d4,'status':_0x312d26(0x1b7)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x2607ad['id'],'fullName':_0x2607ad[_0x312d26(0x1a2)],'username':_0x2607ad[_0x312d26(0x18a)],'telegramId':_0x2607ad[_0x312d26(0x186)],'merchantUrl':_0x2607ad[_0x312d26(0x18c)],'gateways':_0x2607ad['paymentGateways']?JSON[_0x312d26(0x184)](_0x2607ad[_0x312d26(0x1ae)]):null,'gatewaySettings':_0x2607ad[_0x312d26(0x181)]?JSON[_0x312d26(0x184)](_0x2607ad[_0x312d26(0x181)]):null,'publicKey':_0x2607ad[_0x312d26(0x1aa)],'wallets':{'usdtPolygonWallet':_0x2607ad[_0x312d26(0x1a8)],'usdtTrcWallet':_0x2607ad[_0x312d26(0x1b2)],'usdtErcWallet':_0x2607ad[_0x312d26(0x193)],'usdcPolygonWallet':_0x2607ad[_0x312d26(0x197)]},'status':_0x2607ad[_0x312d26(0x18f)],'createdAt':_0x2607ad[_0x312d26(0x1a0)]};}async[a51_0x101456(0x180)](){const _0x55d845=a51_0x101456,_0xa4d903=await database_1['default'][_0x55d845(0x190)][_0x55d845(0x1a5)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x55d845(0x199)}});return _0xa4d903[_0x55d845(0x18d)](_0x39c8e2=>({'id':_0x39c8e2['id'],'fullName':_0x39c8e2[_0x55d845(0x1a2)],'username':_0x39c8e2[_0x55d845(0x18a)],'telegramId':_0x39c8e2[_0x55d845(0x186)],'merchantUrl':_0x39c8e2[_0x55d845(0x18c)],'gateways':_0x39c8e2[_0x55d845(0x1ae)]?JSON[_0x55d845(0x184)](_0x39c8e2[_0x55d845(0x1ae)]):null,'gatewaySettings':_0x39c8e2[_0x55d845(0x181)]?JSON[_0x55d845(0x184)](_0x39c8e2[_0x55d845(0x181)]):null,'publicKey':_0x39c8e2[_0x55d845(0x1aa)],'wallets':{'usdtPolygonWallet':_0x39c8e2['usdtPolygonWallet'],'usdtTrcWallet':_0x39c8e2['usdtTrcWallet'],'usdtErcWallet':_0x39c8e2['usdtErcWallet'],'usdcPolygonWallet':_0x39c8e2[_0x55d845(0x197)]},'status':_0x39c8e2['status'],'createdAt':_0x39c8e2[_0x55d845(0x1a0)]}));}async[a51_0x101456(0x187)](_0x2f02d2){const _0x1d789a=a51_0x101456,_0x2e8700=await database_1[_0x1d789a(0x1b6)][_0x1d789a(0x190)][_0x1d789a(0x19e)]({'where':{'id':_0x2f02d2},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x2e8700)return null;return{'id':_0x2e8700['id'],'fullName':_0x2e8700['name'],'username':_0x2e8700[_0x1d789a(0x18a)],'telegramId':_0x2e8700['telegram'],'merchantUrl':_0x2e8700['shopUrl'],'gateways':_0x2e8700['paymentGateways']?JSON[_0x1d789a(0x184)](_0x2e8700[_0x1d789a(0x1ae)]):null,'gatewaySettings':_0x2e8700['gatewaySettings']?JSON[_0x1d789a(0x184)](_0x2e8700[_0x1d789a(0x181)]):null,'publicKey':_0x2e8700[_0x1d789a(0x1aa)],'wallets':{'usdtPolygonWallet':_0x2e8700['usdtPolygonWallet'],'usdtTrcWallet':_0x2e8700[_0x1d789a(0x1b2)],'usdtErcWallet':_0x2e8700['usdtErcWallet'],'usdcPolygonWallet':_0x2e8700[_0x1d789a(0x197)]},'status':_0x2e8700[_0x1d789a(0x18f)],'createdAt':_0x2e8700[_0x1d789a(0x1a0)]};}async['updateUser'](_0x528b3a,_0x482ca1){const _0x209467=a51_0x101456,_0x1c5a20={..._0x482ca1};_0x482ca1[_0x209467(0x19d)]&&(_0x1c5a20['password']=await bcryptjs_1[_0x209467(0x1b6)][_0x209467(0x18b)](_0x482ca1[_0x209467(0x19d)],0xc));_0x482ca1[_0x209467(0x1a9)]&&(_0x1c5a20[_0x209467(0x1a2)]=_0x482ca1[_0x209467(0x1a9)],delete _0x1c5a20[_0x209467(0x1a9)]);_0x482ca1[_0x209467(0x192)]&&(_0x1c5a20['telegram']=_0x482ca1['telegramId'],delete _0x1c5a20[_0x209467(0x192)]);_0x482ca1[_0x209467(0x1a6)]&&(_0x1c5a20[_0x209467(0x18c)]=_0x482ca1[_0x209467(0x1a6)],delete _0x1c5a20['merchantUrl']);_0x482ca1[_0x209467(0x195)]&&(_0x1c5a20[_0x209467(0x1ae)]=JSON[_0x209467(0x1a3)](_0x482ca1['gateways']),delete _0x1c5a20[_0x209467(0x195)]);_0x482ca1['gatewaySettings']&&(_0x1c5a20[_0x209467(0x181)]=JSON['stringify'](_0x482ca1[_0x209467(0x181)]),delete _0x1c5a20[_0x209467(0x181)]);_0x482ca1[_0x209467(0x198)]&&(_0x482ca1[_0x209467(0x198)][_0x209467(0x1a8)]!==undefined&&(_0x1c5a20[_0x209467(0x1a8)]=_0x482ca1[_0x209467(0x198)]['usdtPolygonWallet']||null),_0x482ca1[_0x209467(0x198)]['usdtTrcWallet']!==undefined&&(_0x1c5a20[_0x209467(0x1b2)]=_0x482ca1[_0x209467(0x198)][_0x209467(0x1b2)]||null),_0x482ca1['wallets']['usdtErcWallet']!==undefined&&(_0x1c5a20[_0x209467(0x193)]=_0x482ca1[_0x209467(0x198)][_0x209467(0x193)]||null),_0x482ca1[_0x209467(0x198)][_0x209467(0x197)]!==undefined&&(_0x1c5a20[_0x209467(0x197)]=_0x482ca1[_0x209467(0x198)][_0x209467(0x197)]||null),delete _0x1c5a20[_0x209467(0x198)]);const _0x36e317=await database_1[_0x209467(0x1b6)]['shop'][_0x209467(0x1b3)]({'where':{'id':_0x528b3a},'data':_0x1c5a20,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x36e317['id'],'fullName':_0x36e317[_0x209467(0x1a2)],'username':_0x36e317[_0x209467(0x18a)],'telegramId':_0x36e317['telegram'],'merchantUrl':_0x36e317[_0x209467(0x18c)],'gateways':_0x36e317[_0x209467(0x1ae)]?JSON['parse'](_0x36e317[_0x209467(0x1ae)]):null,'gatewaySettings':_0x36e317[_0x209467(0x181)]?JSON[_0x209467(0x184)](_0x36e317[_0x209467(0x181)]):null,'publicKey':_0x36e317[_0x209467(0x1aa)],'wallets':{'usdtPolygonWallet':_0x36e317[_0x209467(0x1a8)],'usdtTrcWallet':_0x36e317[_0x209467(0x1b2)],'usdtErcWallet':_0x36e317['usdtErcWallet'],'usdcPolygonWallet':_0x36e317[_0x209467(0x197)]},'status':_0x36e317['status'],'createdAt':_0x36e317[_0x209467(0x1a0)]};}async[a51_0x101456(0x19b)](_0x1ac50d){const _0x206671=a51_0x101456;await database_1[_0x206671(0x1b6)][_0x206671(0x190)][_0x206671(0x191)]({'where':{'id':_0x1ac50d}});}}exports[a51_0x101456(0x1a7)]=UserService;