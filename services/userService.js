'use strict';const a56_0x494106=a56_0x1655;function a56_0x1655(_0x23ffc4,_0x1ae9b5){const _0x43ea07=a56_0x43ea();return a56_0x1655=function(_0x16550b,_0x446c02){_0x16550b=_0x16550b-0x118;let _0x26a2d5=_0x43ea07[_0x16550b];return _0x26a2d5;},a56_0x1655(_0x23ffc4,_0x1ae9b5);}(function(_0xacfc01,_0x56a6fc){const _0x1cae49=a56_0x1655,_0x59d138=_0xacfc01();while(!![]){try{const _0x3cd9d7=parseInt(_0x1cae49(0x13d))/0x1+-parseInt(_0x1cae49(0x144))/0x2+parseInt(_0x1cae49(0x140))/0x3*(parseInt(_0x1cae49(0x12d))/0x4)+parseInt(_0x1cae49(0x124))/0x5+parseInt(_0x1cae49(0x130))/0x6+-parseInt(_0x1cae49(0x147))/0x7+parseInt(_0x1cae49(0x119))/0x8*(-parseInt(_0x1cae49(0x126))/0x9);if(_0x3cd9d7===_0x56a6fc)break;else _0x59d138['push'](_0x59d138['shift']());}catch(_0x1d4c4a){_0x59d138['push'](_0x59d138['shift']());}}}(a56_0x43ea,0xcd479));var __importDefault=this&&this[a56_0x494106(0x139)]||function(_0x31bdc2){return _0x31bdc2&&_0x31bdc2['__esModule']?_0x31bdc2:{'default':_0x31bdc2};};Object[a56_0x494106(0x146)](exports,a56_0x494106(0x12a),{'value':!![]}),exports[a56_0x494106(0x132)]=void 0x0;function a56_0x43ea(){const _0x46e398=['username','getAllUsers','sk_','__esModule','paymentGateways','toString','172RnqcwK','Username\x20already\x20exists','deleteUser','3926598Fmwvjm','gateways','UserService','delete','name','usdcPolygonWallet','merchantUrl','telegramId','createdAt','__importDefault','gatewaySettings','map','createUser','606984mNwqXo','crypto','wallets','30567GedewV','fullName','shopUrl','../config/database','18028XDcQYf','usdtPolygonWallet','defineProperty','7909825jdcmET','ACTIVE','getUserById','usdtTrcWallet','create','findUnique','hash','update','generateApiKeys','shop','parse','stringify','8QXOFIY','hex','randomBytes','telegram','updateUser','status','password','publicKey','desc','Telegram\x20username\x20already\x20exists','default','7980220Qydppq','usdtErcWallet','11841966wiATll'];a56_0x43ea=function(){return _0x46e398;};return a56_0x43ea();}const bcryptjs_1=__importDefault(require('bcryptjs')),crypto_1=__importDefault(require(a56_0x494106(0x13e))),database_1=__importDefault(require(a56_0x494106(0x143)));class UserService{[a56_0x494106(0x14f)](){const _0x2bd993=a56_0x494106,_0x33a8a5='pk_'+crypto_1[_0x2bd993(0x123)][_0x2bd993(0x11b)](0x20)[_0x2bd993(0x12c)](_0x2bd993(0x11a)),_0x57cf81=_0x2bd993(0x129)+crypto_1[_0x2bd993(0x123)][_0x2bd993(0x11b)](0x20)['toString'](_0x2bd993(0x11a));return{'publicKey':_0x33a8a5,'secretKey':_0x57cf81};}async[a56_0x494106(0x13c)](_0x3a6da5){const _0x5d8086=a56_0x494106,{fullName:_0xb698f2,username:_0x476e38,password:_0x265522,telegramId:_0x31f5ac,merchantUrl:_0x5c39ac,gateways:_0x4ac3da,gatewaySettings:_0x5a22b8,wallets:_0x101154}=_0x3a6da5,_0x10dcfa=await database_1[_0x5d8086(0x123)]['shop']['findUnique']({'where':{'username':_0x476e38}});if(_0x10dcfa)throw new Error(_0x5d8086(0x12e));if(_0x31f5ac){const _0x4fb384=await database_1[_0x5d8086(0x123)][_0x5d8086(0x150)][_0x5d8086(0x14c)]({'where':{'telegram':_0x31f5ac}});if(_0x4fb384)throw new Error(_0x5d8086(0x122));}const _0x54ddf8=await bcryptjs_1[_0x5d8086(0x123)][_0x5d8086(0x14d)](_0x265522,0xc),{publicKey:_0x30395b,secretKey:_0x42ec5c}=this[_0x5d8086(0x14f)](),_0x110623=await database_1[_0x5d8086(0x123)]['shop'][_0x5d8086(0x14b)]({'data':{'name':_0xb698f2,'username':_0x476e38,'password':_0x54ddf8,'telegram':_0x31f5ac,'shopUrl':_0x5c39ac,'paymentGateways':_0x4ac3da?JSON[_0x5d8086(0x118)](_0x4ac3da):null,'gatewaySettings':_0x5a22b8?JSON[_0x5d8086(0x118)](_0x5a22b8):null,'usdtPolygonWallet':_0x101154?.[_0x5d8086(0x145)]||null,'usdtTrcWallet':_0x101154?.[_0x5d8086(0x14a)]||null,'usdtErcWallet':_0x101154?.[_0x5d8086(0x125)]||null,'usdcPolygonWallet':_0x101154?.['usdcPolygonWallet']||null,'publicKey':_0x30395b,'secretKey':_0x42ec5c,'status':_0x5d8086(0x148)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x110623['id'],'fullName':_0x110623[_0x5d8086(0x134)],'username':_0x110623[_0x5d8086(0x127)],'telegramId':_0x110623[_0x5d8086(0x11c)],'merchantUrl':_0x110623[_0x5d8086(0x142)],'gateways':_0x110623['paymentGateways']?JSON[_0x5d8086(0x151)](_0x110623[_0x5d8086(0x12b)]):null,'gatewaySettings':_0x110623[_0x5d8086(0x13a)]?JSON[_0x5d8086(0x151)](_0x110623[_0x5d8086(0x13a)]):null,'publicKey':_0x110623['publicKey'],'wallets':{'usdtPolygonWallet':_0x110623[_0x5d8086(0x145)],'usdtTrcWallet':_0x110623[_0x5d8086(0x14a)],'usdtErcWallet':_0x110623['usdtErcWallet'],'usdcPolygonWallet':_0x110623[_0x5d8086(0x135)]},'status':_0x110623[_0x5d8086(0x11e)],'createdAt':_0x110623[_0x5d8086(0x138)]};}async[a56_0x494106(0x128)](){const _0x1c76ef=a56_0x494106,_0x1e2406=await database_1[_0x1c76ef(0x123)]['shop']['findMany']({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x1c76ef(0x121)}});return _0x1e2406[_0x1c76ef(0x13b)](_0x5a0352=>({'id':_0x5a0352['id'],'fullName':_0x5a0352[_0x1c76ef(0x134)],'username':_0x5a0352[_0x1c76ef(0x127)],'telegramId':_0x5a0352[_0x1c76ef(0x11c)],'merchantUrl':_0x5a0352[_0x1c76ef(0x142)],'gateways':_0x5a0352[_0x1c76ef(0x12b)]?JSON[_0x1c76ef(0x151)](_0x5a0352[_0x1c76ef(0x12b)]):null,'gatewaySettings':_0x5a0352['gatewaySettings']?JSON[_0x1c76ef(0x151)](_0x5a0352[_0x1c76ef(0x13a)]):null,'publicKey':_0x5a0352[_0x1c76ef(0x120)],'wallets':{'usdtPolygonWallet':_0x5a0352[_0x1c76ef(0x145)],'usdtTrcWallet':_0x5a0352[_0x1c76ef(0x14a)],'usdtErcWallet':_0x5a0352[_0x1c76ef(0x125)],'usdcPolygonWallet':_0x5a0352[_0x1c76ef(0x135)]},'status':_0x5a0352[_0x1c76ef(0x11e)],'createdAt':_0x5a0352[_0x1c76ef(0x138)]}));}async[a56_0x494106(0x149)](_0xc27867){const _0x3ec99f=a56_0x494106,_0x33e3c6=await database_1[_0x3ec99f(0x123)][_0x3ec99f(0x150)]['findUnique']({'where':{'id':_0xc27867},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x33e3c6)return null;return{'id':_0x33e3c6['id'],'fullName':_0x33e3c6['name'],'username':_0x33e3c6[_0x3ec99f(0x127)],'telegramId':_0x33e3c6[_0x3ec99f(0x11c)],'merchantUrl':_0x33e3c6[_0x3ec99f(0x142)],'gateways':_0x33e3c6[_0x3ec99f(0x12b)]?JSON[_0x3ec99f(0x151)](_0x33e3c6['paymentGateways']):null,'gatewaySettings':_0x33e3c6[_0x3ec99f(0x13a)]?JSON[_0x3ec99f(0x151)](_0x33e3c6[_0x3ec99f(0x13a)]):null,'publicKey':_0x33e3c6['publicKey'],'wallets':{'usdtPolygonWallet':_0x33e3c6[_0x3ec99f(0x145)],'usdtTrcWallet':_0x33e3c6['usdtTrcWallet'],'usdtErcWallet':_0x33e3c6[_0x3ec99f(0x125)],'usdcPolygonWallet':_0x33e3c6[_0x3ec99f(0x135)]},'status':_0x33e3c6[_0x3ec99f(0x11e)],'createdAt':_0x33e3c6['createdAt']};}async[a56_0x494106(0x11d)](_0x1ab11a,_0x356ba2){const _0xe39959=a56_0x494106,_0x556da8={..._0x356ba2};_0x356ba2[_0xe39959(0x11f)]&&(_0x556da8[_0xe39959(0x11f)]=await bcryptjs_1['default'][_0xe39959(0x14d)](_0x356ba2[_0xe39959(0x11f)],0xc));_0x356ba2[_0xe39959(0x141)]&&(_0x556da8['name']=_0x356ba2[_0xe39959(0x141)],delete _0x556da8[_0xe39959(0x141)]);_0x356ba2[_0xe39959(0x137)]&&(_0x556da8['telegram']=_0x356ba2['telegramId'],delete _0x556da8[_0xe39959(0x137)]);_0x356ba2[_0xe39959(0x136)]&&(_0x556da8['shopUrl']=_0x356ba2[_0xe39959(0x136)],delete _0x556da8[_0xe39959(0x136)]);_0x356ba2[_0xe39959(0x131)]&&(_0x556da8['paymentGateways']=JSON[_0xe39959(0x118)](_0x356ba2[_0xe39959(0x131)]),delete _0x556da8[_0xe39959(0x131)]);_0x356ba2[_0xe39959(0x13a)]&&(_0x556da8['gatewaySettings']=JSON['stringify'](_0x356ba2['gatewaySettings']),delete _0x556da8['gatewaySettings']);_0x356ba2[_0xe39959(0x13f)]&&(_0x356ba2[_0xe39959(0x13f)]['usdtPolygonWallet']!==undefined&&(_0x556da8[_0xe39959(0x145)]=_0x356ba2[_0xe39959(0x13f)][_0xe39959(0x145)]||null),_0x356ba2[_0xe39959(0x13f)][_0xe39959(0x14a)]!==undefined&&(_0x556da8[_0xe39959(0x14a)]=_0x356ba2[_0xe39959(0x13f)][_0xe39959(0x14a)]||null),_0x356ba2[_0xe39959(0x13f)][_0xe39959(0x125)]!==undefined&&(_0x556da8[_0xe39959(0x125)]=_0x356ba2[_0xe39959(0x13f)][_0xe39959(0x125)]||null),_0x356ba2['wallets'][_0xe39959(0x135)]!==undefined&&(_0x556da8[_0xe39959(0x135)]=_0x356ba2['wallets']['usdcPolygonWallet']||null),delete _0x556da8['wallets']);const _0x4e48c6=await database_1[_0xe39959(0x123)][_0xe39959(0x150)][_0xe39959(0x14e)]({'where':{'id':_0x1ab11a},'data':_0x556da8,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x4e48c6['id'],'fullName':_0x4e48c6[_0xe39959(0x134)],'username':_0x4e48c6['username'],'telegramId':_0x4e48c6['telegram'],'merchantUrl':_0x4e48c6['shopUrl'],'gateways':_0x4e48c6[_0xe39959(0x12b)]?JSON[_0xe39959(0x151)](_0x4e48c6[_0xe39959(0x12b)]):null,'gatewaySettings':_0x4e48c6[_0xe39959(0x13a)]?JSON[_0xe39959(0x151)](_0x4e48c6['gatewaySettings']):null,'publicKey':_0x4e48c6[_0xe39959(0x120)],'wallets':{'usdtPolygonWallet':_0x4e48c6[_0xe39959(0x145)],'usdtTrcWallet':_0x4e48c6[_0xe39959(0x14a)],'usdtErcWallet':_0x4e48c6[_0xe39959(0x125)],'usdcPolygonWallet':_0x4e48c6[_0xe39959(0x135)]},'status':_0x4e48c6[_0xe39959(0x11e)],'createdAt':_0x4e48c6['createdAt']};}async[a56_0x494106(0x12f)](_0x1718b3){const _0x1a1ec6=a56_0x494106;await database_1['default'][_0x1a1ec6(0x150)][_0x1a1ec6(0x133)]({'where':{'id':_0x1718b3}});}}exports[a56_0x494106(0x132)]=UserService;