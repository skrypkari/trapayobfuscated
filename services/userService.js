'use strict';function a61_0x543a(){const _0x231290=['shopUrl','telegramId','usdtErcWallet','3800132wFCVUi','pk_','generateApiKeys','bcryptjs','stringify','shop','607331RTqPwn','../config/database','updateUser','password','UserService','name','crypto','createUser','282votNYK','560210sRQlAM','map','gateways','publicKey','username','696ydDlnv','defineProperty','randomBytes','telegram','fullName','sk_','getAllUsers','paymentGateways','toString','findMany','8871sicOXV','__esModule','status','134785gmYDhn','createdAt','usdcPolygonWallet','usdtTrcWallet','update','hash','wallets','default','findUnique','hex','usdtPolygonWallet','gatewaySettings','17488017wSEYGV','parse','5927648uomlXF','merchantUrl'];a61_0x543a=function(){return _0x231290;};return a61_0x543a();}const a61_0x2acdb3=a61_0x55be;function a61_0x55be(_0x1e312c,_0x5c4738){const _0x543a0d=a61_0x543a();return a61_0x55be=function(_0x55be51,_0x132cba){_0x55be51=_0x55be51-0x77;let _0x437608=_0x543a0d[_0x55be51];return _0x437608;},a61_0x55be(_0x1e312c,_0x5c4738);}(function(_0x8e5a77,_0x326852){const _0x331fe8=a61_0x55be,_0xe69034=_0x8e5a77();while(!![]){try{const _0x411151=parseInt(_0x331fe8(0xa8))/0x1+parseInt(_0x331fe8(0x82))/0x2*(-parseInt(_0x331fe8(0x8c))/0x3)+-parseInt(_0x331fe8(0xa2))/0x4+parseInt(_0x331fe8(0x7d))/0x5+parseInt(_0x331fe8(0x7c))/0x6*(-parseInt(_0x331fe8(0x8f))/0x7)+parseInt(_0x331fe8(0x9d))/0x8+parseInt(_0x331fe8(0x9b))/0x9;if(_0x411151===_0x326852)break;else _0xe69034['push'](_0xe69034['shift']());}catch(_0x336b67){_0xe69034['push'](_0xe69034['shift']());}}}(a61_0x543a,0x7ecdc));var __importDefault=this&&this['__importDefault']||function(_0x10928a){const _0x5dabb0=a61_0x55be;return _0x10928a&&_0x10928a[_0x5dabb0(0x8d)]?_0x10928a:{'default':_0x10928a};};Object[a61_0x2acdb3(0x83)](exports,a61_0x2acdb3(0x8d),{'value':!![]}),exports[a61_0x2acdb3(0x78)]=void 0x0;const bcryptjs_1=__importDefault(require(a61_0x2acdb3(0xa5))),crypto_1=__importDefault(require(a61_0x2acdb3(0x7a))),database_1=__importDefault(require(a61_0x2acdb3(0xa9)));class UserService{[a61_0x2acdb3(0xa4)](){const _0x2e9949=a61_0x2acdb3,_0x59e9e1=_0x2e9949(0xa3)+crypto_1['default']['randomBytes'](0x20)[_0x2e9949(0x8a)]('hex'),_0x53813d=_0x2e9949(0x87)+crypto_1[_0x2e9949(0x96)][_0x2e9949(0x84)](0x20)[_0x2e9949(0x8a)](_0x2e9949(0x98));return{'publicKey':_0x59e9e1,'secretKey':_0x53813d};}async[a61_0x2acdb3(0x7b)](_0x212003){const _0x127781=a61_0x2acdb3,{fullName:_0x518ef2,username:_0x45758a,password:_0x6dff96,telegramId:_0x28a7d2,merchantUrl:_0x23efb6,gateways:_0x1b6a2b,gatewaySettings:_0x13a7d1,wallets:_0xd3e96e}=_0x212003,_0x12cafa=await database_1[_0x127781(0x96)][_0x127781(0xa7)]['findUnique']({'where':{'username':_0x45758a}});if(_0x12cafa)throw new Error('Username\x20already\x20exists');if(_0x28a7d2){const _0x5b8f0c=await database_1[_0x127781(0x96)][_0x127781(0xa7)]['findUnique']({'where':{'telegram':_0x28a7d2}});if(_0x5b8f0c)throw new Error('Telegram\x20username\x20already\x20exists');}const _0x59b31f=await bcryptjs_1['default'][_0x127781(0x94)](_0x6dff96,0xc),{publicKey:_0x45c1b8,secretKey:_0x576a79}=this['generateApiKeys'](),_0x471876=await database_1[_0x127781(0x96)][_0x127781(0xa7)]['create']({'data':{'name':_0x518ef2,'username':_0x45758a,'password':_0x59b31f,'telegram':_0x28a7d2,'shopUrl':_0x23efb6,'paymentGateways':_0x1b6a2b?JSON['stringify'](_0x1b6a2b):null,'gatewaySettings':_0x13a7d1?JSON[_0x127781(0xa6)](_0x13a7d1):null,'usdtPolygonWallet':_0xd3e96e?.[_0x127781(0x99)]||null,'usdtTrcWallet':_0xd3e96e?.[_0x127781(0x92)]||null,'usdtErcWallet':_0xd3e96e?.[_0x127781(0xa1)]||null,'usdcPolygonWallet':_0xd3e96e?.[_0x127781(0x91)]||null,'publicKey':_0x45c1b8,'secretKey':_0x576a79,'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x471876['id'],'fullName':_0x471876[_0x127781(0x79)],'username':_0x471876['username'],'telegramId':_0x471876['telegram'],'merchantUrl':_0x471876[_0x127781(0x9f)],'gateways':_0x471876[_0x127781(0x89)]?JSON['parse'](_0x471876[_0x127781(0x89)]):null,'gatewaySettings':_0x471876[_0x127781(0x9a)]?JSON['parse'](_0x471876[_0x127781(0x9a)]):null,'publicKey':_0x471876[_0x127781(0x80)],'wallets':{'usdtPolygonWallet':_0x471876[_0x127781(0x99)],'usdtTrcWallet':_0x471876['usdtTrcWallet'],'usdtErcWallet':_0x471876['usdtErcWallet'],'usdcPolygonWallet':_0x471876[_0x127781(0x91)]},'status':_0x471876[_0x127781(0x8e)],'createdAt':_0x471876['createdAt']};}async[a61_0x2acdb3(0x88)](){const _0x125077=a61_0x2acdb3,_0x5a63fc=await database_1[_0x125077(0x96)]['shop'][_0x125077(0x8b)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':'desc'}});return _0x5a63fc[_0x125077(0x7e)](_0x34dba9=>({'id':_0x34dba9['id'],'fullName':_0x34dba9[_0x125077(0x79)],'username':_0x34dba9[_0x125077(0x81)],'telegramId':_0x34dba9['telegram'],'merchantUrl':_0x34dba9[_0x125077(0x9f)],'gateways':_0x34dba9[_0x125077(0x89)]?JSON['parse'](_0x34dba9[_0x125077(0x89)]):null,'gatewaySettings':_0x34dba9['gatewaySettings']?JSON[_0x125077(0x9c)](_0x34dba9['gatewaySettings']):null,'publicKey':_0x34dba9[_0x125077(0x80)],'wallets':{'usdtPolygonWallet':_0x34dba9[_0x125077(0x99)],'usdtTrcWallet':_0x34dba9['usdtTrcWallet'],'usdtErcWallet':_0x34dba9[_0x125077(0xa1)],'usdcPolygonWallet':_0x34dba9['usdcPolygonWallet']},'status':_0x34dba9[_0x125077(0x8e)],'createdAt':_0x34dba9[_0x125077(0x90)]}));}async['getUserById'](_0x172017){const _0x1dc7ac=a61_0x2acdb3,_0x5309b1=await database_1[_0x1dc7ac(0x96)][_0x1dc7ac(0xa7)][_0x1dc7ac(0x97)]({'where':{'id':_0x172017},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x5309b1)return null;return{'id':_0x5309b1['id'],'fullName':_0x5309b1[_0x1dc7ac(0x79)],'username':_0x5309b1[_0x1dc7ac(0x81)],'telegramId':_0x5309b1[_0x1dc7ac(0x85)],'merchantUrl':_0x5309b1[_0x1dc7ac(0x9f)],'gateways':_0x5309b1[_0x1dc7ac(0x89)]?JSON[_0x1dc7ac(0x9c)](_0x5309b1['paymentGateways']):null,'gatewaySettings':_0x5309b1['gatewaySettings']?JSON[_0x1dc7ac(0x9c)](_0x5309b1['gatewaySettings']):null,'publicKey':_0x5309b1[_0x1dc7ac(0x80)],'wallets':{'usdtPolygonWallet':_0x5309b1[_0x1dc7ac(0x99)],'usdtTrcWallet':_0x5309b1[_0x1dc7ac(0x92)],'usdtErcWallet':_0x5309b1[_0x1dc7ac(0xa1)],'usdcPolygonWallet':_0x5309b1[_0x1dc7ac(0x91)]},'status':_0x5309b1[_0x1dc7ac(0x8e)],'createdAt':_0x5309b1[_0x1dc7ac(0x90)]};}async[a61_0x2acdb3(0xaa)](_0x42ded5,_0x96df80){const _0x1b027d=a61_0x2acdb3,_0x4b65ab={..._0x96df80};_0x96df80[_0x1b027d(0x77)]&&(_0x4b65ab['password']=await bcryptjs_1['default'][_0x1b027d(0x94)](_0x96df80[_0x1b027d(0x77)],0xc));_0x96df80[_0x1b027d(0x86)]&&(_0x4b65ab[_0x1b027d(0x79)]=_0x96df80['fullName'],delete _0x4b65ab[_0x1b027d(0x86)]);_0x96df80[_0x1b027d(0xa0)]&&(_0x4b65ab['telegram']=_0x96df80[_0x1b027d(0xa0)],delete _0x4b65ab[_0x1b027d(0xa0)]);_0x96df80['merchantUrl']&&(_0x4b65ab[_0x1b027d(0x9f)]=_0x96df80[_0x1b027d(0x9e)],delete _0x4b65ab['merchantUrl']);_0x96df80[_0x1b027d(0x7f)]&&(_0x4b65ab[_0x1b027d(0x89)]=JSON[_0x1b027d(0xa6)](_0x96df80[_0x1b027d(0x7f)]),delete _0x4b65ab['gateways']);_0x96df80[_0x1b027d(0x9a)]&&(_0x4b65ab[_0x1b027d(0x9a)]=JSON['stringify'](_0x96df80[_0x1b027d(0x9a)]),delete _0x4b65ab[_0x1b027d(0x9a)]);_0x96df80[_0x1b027d(0x95)]&&(_0x96df80['wallets'][_0x1b027d(0x99)]!==undefined&&(_0x4b65ab[_0x1b027d(0x99)]=_0x96df80[_0x1b027d(0x95)][_0x1b027d(0x99)]||null),_0x96df80[_0x1b027d(0x95)][_0x1b027d(0x92)]!==undefined&&(_0x4b65ab[_0x1b027d(0x92)]=_0x96df80[_0x1b027d(0x95)][_0x1b027d(0x92)]||null),_0x96df80[_0x1b027d(0x95)][_0x1b027d(0xa1)]!==undefined&&(_0x4b65ab[_0x1b027d(0xa1)]=_0x96df80[_0x1b027d(0x95)]['usdtErcWallet']||null),_0x96df80[_0x1b027d(0x95)][_0x1b027d(0x91)]!==undefined&&(_0x4b65ab[_0x1b027d(0x91)]=_0x96df80['wallets'][_0x1b027d(0x91)]||null),delete _0x4b65ab[_0x1b027d(0x95)]);const _0x50f11e=await database_1[_0x1b027d(0x96)][_0x1b027d(0xa7)][_0x1b027d(0x93)]({'where':{'id':_0x42ded5},'data':_0x4b65ab,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x50f11e['id'],'fullName':_0x50f11e[_0x1b027d(0x79)],'username':_0x50f11e['username'],'telegramId':_0x50f11e[_0x1b027d(0x85)],'merchantUrl':_0x50f11e[_0x1b027d(0x9f)],'gateways':_0x50f11e[_0x1b027d(0x89)]?JSON[_0x1b027d(0x9c)](_0x50f11e[_0x1b027d(0x89)]):null,'gatewaySettings':_0x50f11e[_0x1b027d(0x9a)]?JSON['parse'](_0x50f11e['gatewaySettings']):null,'publicKey':_0x50f11e['publicKey'],'wallets':{'usdtPolygonWallet':_0x50f11e[_0x1b027d(0x99)],'usdtTrcWallet':_0x50f11e[_0x1b027d(0x92)],'usdtErcWallet':_0x50f11e[_0x1b027d(0xa1)],'usdcPolygonWallet':_0x50f11e[_0x1b027d(0x91)]},'status':_0x50f11e[_0x1b027d(0x8e)],'createdAt':_0x50f11e[_0x1b027d(0x90)]};}async['deleteUser'](_0x295f36){const _0x341db8=a61_0x2acdb3;await database_1[_0x341db8(0x96)][_0x341db8(0xa7)]['delete']({'where':{'id':_0x295f36}});}}exports[a61_0x2acdb3(0x78)]=UserService;