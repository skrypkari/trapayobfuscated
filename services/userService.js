'use strict';const a76_0x5c8b6a=a76_0x58b8;(function(_0x55c449,_0xc26ab9){const _0x120a61=a76_0x58b8,_0x102878=_0x55c449();while(!![]){try{const _0x53d0ad=parseInt(_0x120a61(0x178))/0x1*(parseInt(_0x120a61(0x1a9))/0x2)+-parseInt(_0x120a61(0x177))/0x3*(parseInt(_0x120a61(0x18d))/0x4)+parseInt(_0x120a61(0x175))/0x5*(parseInt(_0x120a61(0x193))/0x6)+-parseInt(_0x120a61(0x184))/0x7*(-parseInt(_0x120a61(0x19a))/0x8)+-parseInt(_0x120a61(0x176))/0x9*(parseInt(_0x120a61(0x183))/0xa)+-parseInt(_0x120a61(0x194))/0xb+parseInt(_0x120a61(0x180))/0xc;if(_0x53d0ad===_0xc26ab9)break;else _0x102878['push'](_0x102878['shift']());}catch(_0x3e1998){_0x102878['push'](_0x102878['shift']());}}}(a76_0x4a81,0x6244a));function a76_0x58b8(_0x32979a,_0x2a5454){_0x32979a=_0x32979a-0x174;const _0x4a814c=a76_0x4a81();let _0x58b8b7=_0x4a814c[_0x32979a];return _0x58b8b7;}var __importDefault=this&&this[a76_0x5c8b6a(0x17c)]||function(_0x3e2ed6){const _0x3c3e43=a76_0x5c8b6a;return _0x3e2ed6&&_0x3e2ed6[_0x3c3e43(0x17e)]?_0x3e2ed6:{'default':_0x3e2ed6};};Object[a76_0x5c8b6a(0x19c)](exports,a76_0x5c8b6a(0x17e),{'value':!![]}),exports['UserService']=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),crypto_1=__importDefault(require(a76_0x5c8b6a(0x18b))),database_1=__importDefault(require('../config/database'));function a76_0x4a81(){const _0x189400=['__importDefault','randomBytes','__esModule','create','8060580qeQocU','generateApiKeys','map','345270RLSwMd','13188oXNcDa','Username\x20already\x20exists','usdtTrcWallet','username','usdtErcWallet','getUserById','shopUrl','crypto','getAllUsers','4HJaPLP','desc','toString','delete','telegramId','gatewaySettings','24iTvZbl','3799455KRwcEa','updateUser','parse','gateways','update','default','3232mYdlrT','merchantUrl','defineProperty','createdAt','ACTIVE','wallets','findUnique','hex','UserService','stringify','usdcPolygonWallet','hash','paymentGateways','sk_','shop','1457732kpnwDY','findMany','password','pk_','publicKey','name','fullName','32355mvzOGT','171fKNTWh','2351031nvtPKr','1DOZwnY','telegram','usdtPolygonWallet','status'];a76_0x4a81=function(){return _0x189400;};return a76_0x4a81();}class UserService{[a76_0x5c8b6a(0x181)](){const _0x164c9c=a76_0x5c8b6a,_0x147bcd=_0x164c9c(0x1ac)+crypto_1[_0x164c9c(0x199)][_0x164c9c(0x17d)](0x20)[_0x164c9c(0x18f)](_0x164c9c(0x1a1)),_0x4e5599=_0x164c9c(0x1a7)+crypto_1['default'][_0x164c9c(0x17d)](0x20)[_0x164c9c(0x18f)](_0x164c9c(0x1a1));return{'publicKey':_0x147bcd,'secretKey':_0x4e5599};}async['createUser'](_0x58dfbe){const _0xc98a4e=a76_0x5c8b6a,{fullName:_0x58767a,username:_0x395648,password:_0x43b4ce,telegramId:_0x3c019c,merchantUrl:_0x5a7d7a,gateways:_0x277203,gatewaySettings:_0x540882,wallets:_0x1ea6ef}=_0x58dfbe,_0x10b949=await database_1['default'][_0xc98a4e(0x1a8)][_0xc98a4e(0x1a0)]({'where':{'username':_0x395648}});if(_0x10b949)throw new Error(_0xc98a4e(0x185));if(_0x3c019c){const _0x5bd425=await database_1[_0xc98a4e(0x199)][_0xc98a4e(0x1a8)][_0xc98a4e(0x1a0)]({'where':{'telegram':_0x3c019c}});if(_0x5bd425)throw new Error('Telegram\x20username\x20already\x20exists');}const _0x4fcba1=await bcryptjs_1['default'][_0xc98a4e(0x1a5)](_0x43b4ce,0xc),{publicKey:_0x2791b4,secretKey:_0x257ea2}=this[_0xc98a4e(0x181)](),_0x4eb02c=await database_1['default']['shop'][_0xc98a4e(0x17f)]({'data':{'name':_0x58767a,'username':_0x395648,'password':_0x4fcba1,'telegram':_0x3c019c,'shopUrl':_0x5a7d7a,'paymentGateways':_0x277203?JSON[_0xc98a4e(0x1a3)](_0x277203):null,'gatewaySettings':_0x540882?JSON['stringify'](_0x540882):null,'usdtPolygonWallet':_0x1ea6ef?.[_0xc98a4e(0x17a)]||null,'usdtTrcWallet':_0x1ea6ef?.[_0xc98a4e(0x186)]||null,'usdtErcWallet':_0x1ea6ef?.[_0xc98a4e(0x188)]||null,'usdcPolygonWallet':_0x1ea6ef?.[_0xc98a4e(0x1a4)]||null,'publicKey':_0x2791b4,'secretKey':_0x257ea2,'status':_0xc98a4e(0x19e)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x4eb02c['id'],'fullName':_0x4eb02c[_0xc98a4e(0x1ae)],'username':_0x4eb02c['username'],'telegramId':_0x4eb02c[_0xc98a4e(0x179)],'merchantUrl':_0x4eb02c[_0xc98a4e(0x18a)],'gateways':_0x4eb02c[_0xc98a4e(0x1a6)]?JSON[_0xc98a4e(0x196)](_0x4eb02c[_0xc98a4e(0x1a6)]):null,'gatewaySettings':_0x4eb02c[_0xc98a4e(0x192)]?JSON['parse'](_0x4eb02c[_0xc98a4e(0x192)]):null,'publicKey':_0x4eb02c[_0xc98a4e(0x1ad)],'wallets':{'usdtPolygonWallet':_0x4eb02c[_0xc98a4e(0x17a)],'usdtTrcWallet':_0x4eb02c['usdtTrcWallet'],'usdtErcWallet':_0x4eb02c['usdtErcWallet'],'usdcPolygonWallet':_0x4eb02c[_0xc98a4e(0x1a4)]},'status':_0x4eb02c[_0xc98a4e(0x17b)],'createdAt':_0x4eb02c[_0xc98a4e(0x19d)]};}async[a76_0x5c8b6a(0x18c)](){const _0x3cf737=a76_0x5c8b6a,_0x29acbd=await database_1[_0x3cf737(0x199)][_0x3cf737(0x1a8)][_0x3cf737(0x1aa)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x3cf737(0x18e)}});return _0x29acbd[_0x3cf737(0x182)](_0x5e2252=>({'id':_0x5e2252['id'],'fullName':_0x5e2252[_0x3cf737(0x1ae)],'username':_0x5e2252[_0x3cf737(0x187)],'telegramId':_0x5e2252['telegram'],'merchantUrl':_0x5e2252['shopUrl'],'gateways':_0x5e2252[_0x3cf737(0x1a6)]?JSON[_0x3cf737(0x196)](_0x5e2252[_0x3cf737(0x1a6)]):null,'gatewaySettings':_0x5e2252[_0x3cf737(0x192)]?JSON['parse'](_0x5e2252[_0x3cf737(0x192)]):null,'publicKey':_0x5e2252['publicKey'],'wallets':{'usdtPolygonWallet':_0x5e2252[_0x3cf737(0x17a)],'usdtTrcWallet':_0x5e2252[_0x3cf737(0x186)],'usdtErcWallet':_0x5e2252[_0x3cf737(0x188)],'usdcPolygonWallet':_0x5e2252[_0x3cf737(0x1a4)]},'status':_0x5e2252[_0x3cf737(0x17b)],'createdAt':_0x5e2252['createdAt']}));}async[a76_0x5c8b6a(0x189)](_0x5719be){const _0xa746df=a76_0x5c8b6a,_0x1aa78b=await database_1[_0xa746df(0x199)][_0xa746df(0x1a8)][_0xa746df(0x1a0)]({'where':{'id':_0x5719be},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x1aa78b)return null;return{'id':_0x1aa78b['id'],'fullName':_0x1aa78b[_0xa746df(0x1ae)],'username':_0x1aa78b[_0xa746df(0x187)],'telegramId':_0x1aa78b['telegram'],'merchantUrl':_0x1aa78b[_0xa746df(0x18a)],'gateways':_0x1aa78b[_0xa746df(0x1a6)]?JSON[_0xa746df(0x196)](_0x1aa78b['paymentGateways']):null,'gatewaySettings':_0x1aa78b[_0xa746df(0x192)]?JSON[_0xa746df(0x196)](_0x1aa78b[_0xa746df(0x192)]):null,'publicKey':_0x1aa78b[_0xa746df(0x1ad)],'wallets':{'usdtPolygonWallet':_0x1aa78b['usdtPolygonWallet'],'usdtTrcWallet':_0x1aa78b[_0xa746df(0x186)],'usdtErcWallet':_0x1aa78b[_0xa746df(0x188)],'usdcPolygonWallet':_0x1aa78b[_0xa746df(0x1a4)]},'status':_0x1aa78b[_0xa746df(0x17b)],'createdAt':_0x1aa78b['createdAt']};}async[a76_0x5c8b6a(0x195)](_0x307e76,_0x555605){const _0x1a6195=a76_0x5c8b6a,_0x26982a={..._0x555605};_0x555605[_0x1a6195(0x1ab)]&&(_0x26982a[_0x1a6195(0x1ab)]=await bcryptjs_1[_0x1a6195(0x199)]['hash'](_0x555605[_0x1a6195(0x1ab)],0xc));_0x555605[_0x1a6195(0x174)]&&(_0x26982a['name']=_0x555605['fullName'],delete _0x26982a['fullName']);_0x555605[_0x1a6195(0x191)]&&(_0x26982a[_0x1a6195(0x179)]=_0x555605['telegramId'],delete _0x26982a[_0x1a6195(0x191)]);_0x555605[_0x1a6195(0x19b)]&&(_0x26982a['shopUrl']=_0x555605[_0x1a6195(0x19b)],delete _0x26982a['merchantUrl']);_0x555605['gateways']&&(_0x26982a[_0x1a6195(0x1a6)]=JSON[_0x1a6195(0x1a3)](_0x555605['gateways']),delete _0x26982a[_0x1a6195(0x197)]);_0x555605['gatewaySettings']&&(_0x26982a['gatewaySettings']=JSON[_0x1a6195(0x1a3)](_0x555605[_0x1a6195(0x192)]),delete _0x26982a[_0x1a6195(0x192)]);_0x555605[_0x1a6195(0x19f)]&&(_0x555605[_0x1a6195(0x19f)]['usdtPolygonWallet']!==undefined&&(_0x26982a[_0x1a6195(0x17a)]=_0x555605[_0x1a6195(0x19f)][_0x1a6195(0x17a)]||null),_0x555605[_0x1a6195(0x19f)]['usdtTrcWallet']!==undefined&&(_0x26982a['usdtTrcWallet']=_0x555605[_0x1a6195(0x19f)][_0x1a6195(0x186)]||null),_0x555605[_0x1a6195(0x19f)]['usdtErcWallet']!==undefined&&(_0x26982a[_0x1a6195(0x188)]=_0x555605['wallets']['usdtErcWallet']||null),_0x555605[_0x1a6195(0x19f)]['usdcPolygonWallet']!==undefined&&(_0x26982a[_0x1a6195(0x1a4)]=_0x555605[_0x1a6195(0x19f)]['usdcPolygonWallet']||null),delete _0x26982a[_0x1a6195(0x19f)]);const _0x299bc5=await database_1[_0x1a6195(0x199)][_0x1a6195(0x1a8)][_0x1a6195(0x198)]({'where':{'id':_0x307e76},'data':_0x26982a,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x299bc5['id'],'fullName':_0x299bc5[_0x1a6195(0x1ae)],'username':_0x299bc5[_0x1a6195(0x187)],'telegramId':_0x299bc5[_0x1a6195(0x179)],'merchantUrl':_0x299bc5[_0x1a6195(0x18a)],'gateways':_0x299bc5[_0x1a6195(0x1a6)]?JSON['parse'](_0x299bc5[_0x1a6195(0x1a6)]):null,'gatewaySettings':_0x299bc5[_0x1a6195(0x192)]?JSON[_0x1a6195(0x196)](_0x299bc5[_0x1a6195(0x192)]):null,'publicKey':_0x299bc5['publicKey'],'wallets':{'usdtPolygonWallet':_0x299bc5[_0x1a6195(0x17a)],'usdtTrcWallet':_0x299bc5['usdtTrcWallet'],'usdtErcWallet':_0x299bc5[_0x1a6195(0x188)],'usdcPolygonWallet':_0x299bc5[_0x1a6195(0x1a4)]},'status':_0x299bc5[_0x1a6195(0x17b)],'createdAt':_0x299bc5[_0x1a6195(0x19d)]};}async['deleteUser'](_0x56e77d){const _0x52d58a=a76_0x5c8b6a;await database_1['default'][_0x52d58a(0x1a8)][_0x52d58a(0x190)]({'where':{'id':_0x56e77d}});}}exports[a76_0x5c8b6a(0x1a2)]=UserService;