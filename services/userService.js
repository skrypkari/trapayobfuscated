'use strict';const a89_0x5ed933=a89_0x9128;(function(_0x2404ec,_0x745bc6){const _0x372ee6=a89_0x9128,_0x3a5669=_0x2404ec();while(!![]){try{const _0x555df5=parseInt(_0x372ee6(0x1a6))/0x1*(parseInt(_0x372ee6(0x1cc))/0x2)+parseInt(_0x372ee6(0x1bc))/0x3*(parseInt(_0x372ee6(0x1b4))/0x4)+-parseInt(_0x372ee6(0x1ce))/0x5+parseInt(_0x372ee6(0x1d2))/0x6+parseInt(_0x372ee6(0x1b9))/0x7+parseInt(_0x372ee6(0x1c0))/0x8*(-parseInt(_0x372ee6(0x1d8))/0x9)+-parseInt(_0x372ee6(0x1b7))/0xa;if(_0x555df5===_0x745bc6)break;else _0x3a5669['push'](_0x3a5669['shift']());}catch(_0x12353e){_0x3a5669['push'](_0x3a5669['shift']());}}}(a89_0x7530,0xaa509));function a89_0x7530(){const _0x2ca092=['3105240PzHbmQ','gatewaySettings','66409vogYrs','telegramId','randomBytes','6rxjFoD','stringify','password','getUserById','900296glBJpP','../config/database','default','delete','usdtPolygonWallet','defineProperty','publicKey','usdtTrcWallet','toString','shopUrl','fullName','name','49826mJrjDy','findUnique','2224840FyaMQl','create','UserService','pk_','2281080NwsHOa','telegram','usdcPolygonWallet','merchantUrl','crypto','shop','9CYcgzF','Telegram\x20username\x20already\x20exists','sk_','getAllUsers','gateways','11PQqAvk','__esModule','updateUser','map','usdtErcWallet','ACTIVE','username','paymentGateways','createdAt','parse','bcryptjs','createUser','status','Username\x20already\x20exists','1803856UfSzxe','desc','wallets'];a89_0x7530=function(){return _0x2ca092;};return a89_0x7530();}var __importDefault=this&&this['__importDefault']||function(_0x3f1c4e){const _0x15f34a=a89_0x9128;return _0x3f1c4e&&_0x3f1c4e[_0x15f34a(0x1a7)]?_0x3f1c4e:{'default':_0x3f1c4e};};Object[a89_0x5ed933(0x1c5)](exports,a89_0x5ed933(0x1a7),{'value':!![]}),exports[a89_0x5ed933(0x1d0)]=void 0x0;function a89_0x9128(_0x34e21b,_0x42b795){_0x34e21b=_0x34e21b-0x1a6;const _0x7530fb=a89_0x7530();let _0x91288d=_0x7530fb[_0x34e21b];return _0x91288d;}const bcryptjs_1=__importDefault(require(a89_0x5ed933(0x1b0))),crypto_1=__importDefault(require(a89_0x5ed933(0x1d6))),database_1=__importDefault(require(a89_0x5ed933(0x1c1)));class UserService{['generateApiKeys'](){const _0x3e11ac=a89_0x5ed933,_0x2532e4=_0x3e11ac(0x1d1)+crypto_1['default'][_0x3e11ac(0x1bb)](0x20)[_0x3e11ac(0x1c8)]('hex'),_0x44a2c0=_0x3e11ac(0x1da)+crypto_1[_0x3e11ac(0x1c2)][_0x3e11ac(0x1bb)](0x20)[_0x3e11ac(0x1c8)]('hex');return{'publicKey':_0x2532e4,'secretKey':_0x44a2c0};}async[a89_0x5ed933(0x1b1)](_0x4769ca){const _0xb14b6=a89_0x5ed933,{fullName:_0x45159d,username:_0x2cef96,password:_0x205e33,telegramId:_0x5d194c,merchantUrl:_0x1f208a,gateways:_0x2f1108,gatewaySettings:_0x1fc71d,wallets:_0x10a56b}=_0x4769ca,_0x125753=await database_1['default']['shop']['findUnique']({'where':{'username':_0x2cef96}});if(_0x125753)throw new Error(_0xb14b6(0x1b3));if(_0x5d194c){const _0x32d870=await database_1[_0xb14b6(0x1c2)][_0xb14b6(0x1d7)][_0xb14b6(0x1cd)]({'where':{'telegram':_0x5d194c}});if(_0x32d870)throw new Error(_0xb14b6(0x1d9));}const _0x45eca5=await bcryptjs_1[_0xb14b6(0x1c2)]['hash'](_0x205e33,0xc),{publicKey:_0x3b4473,secretKey:_0x151efa}=this['generateApiKeys'](),_0x4919ee=await database_1[_0xb14b6(0x1c2)][_0xb14b6(0x1d7)][_0xb14b6(0x1cf)]({'data':{'name':_0x45159d,'username':_0x2cef96,'password':_0x45eca5,'telegram':_0x5d194c,'shopUrl':_0x1f208a,'paymentGateways':_0x2f1108?JSON[_0xb14b6(0x1bd)](_0x2f1108):null,'gatewaySettings':_0x1fc71d?JSON[_0xb14b6(0x1bd)](_0x1fc71d):null,'usdtPolygonWallet':_0x10a56b?.[_0xb14b6(0x1c4)]||null,'usdtTrcWallet':_0x10a56b?.[_0xb14b6(0x1c7)]||null,'usdtErcWallet':_0x10a56b?.[_0xb14b6(0x1aa)]||null,'usdcPolygonWallet':_0x10a56b?.['usdcPolygonWallet']||null,'publicKey':_0x3b4473,'secretKey':_0x151efa,'status':_0xb14b6(0x1ab)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x4919ee['id'],'fullName':_0x4919ee[_0xb14b6(0x1cb)],'username':_0x4919ee[_0xb14b6(0x1ac)],'telegramId':_0x4919ee['telegram'],'merchantUrl':_0x4919ee[_0xb14b6(0x1c9)],'gateways':_0x4919ee[_0xb14b6(0x1ad)]?JSON[_0xb14b6(0x1af)](_0x4919ee['paymentGateways']):null,'gatewaySettings':_0x4919ee[_0xb14b6(0x1b8)]?JSON[_0xb14b6(0x1af)](_0x4919ee[_0xb14b6(0x1b8)]):null,'publicKey':_0x4919ee['publicKey'],'wallets':{'usdtPolygonWallet':_0x4919ee[_0xb14b6(0x1c4)],'usdtTrcWallet':_0x4919ee[_0xb14b6(0x1c7)],'usdtErcWallet':_0x4919ee[_0xb14b6(0x1aa)],'usdcPolygonWallet':_0x4919ee['usdcPolygonWallet']},'status':_0x4919ee[_0xb14b6(0x1b2)],'createdAt':_0x4919ee[_0xb14b6(0x1ae)]};}async[a89_0x5ed933(0x1db)](){const _0x8dc00b=a89_0x5ed933,_0x496f9a=await database_1[_0x8dc00b(0x1c2)]['shop']['findMany']({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x8dc00b(0x1b5)}});return _0x496f9a[_0x8dc00b(0x1a9)](_0xd93bb5=>({'id':_0xd93bb5['id'],'fullName':_0xd93bb5[_0x8dc00b(0x1cb)],'username':_0xd93bb5[_0x8dc00b(0x1ac)],'telegramId':_0xd93bb5['telegram'],'merchantUrl':_0xd93bb5[_0x8dc00b(0x1c9)],'gateways':_0xd93bb5[_0x8dc00b(0x1ad)]?JSON[_0x8dc00b(0x1af)](_0xd93bb5['paymentGateways']):null,'gatewaySettings':_0xd93bb5[_0x8dc00b(0x1b8)]?JSON['parse'](_0xd93bb5['gatewaySettings']):null,'publicKey':_0xd93bb5[_0x8dc00b(0x1c6)],'wallets':{'usdtPolygonWallet':_0xd93bb5[_0x8dc00b(0x1c4)],'usdtTrcWallet':_0xd93bb5[_0x8dc00b(0x1c7)],'usdtErcWallet':_0xd93bb5[_0x8dc00b(0x1aa)],'usdcPolygonWallet':_0xd93bb5['usdcPolygonWallet']},'status':_0xd93bb5[_0x8dc00b(0x1b2)],'createdAt':_0xd93bb5['createdAt']}));}async[a89_0x5ed933(0x1bf)](_0x339794){const _0x32ebc6=a89_0x5ed933,_0x16a7d2=await database_1['default'][_0x32ebc6(0x1d7)]['findUnique']({'where':{'id':_0x339794},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x16a7d2)return null;return{'id':_0x16a7d2['id'],'fullName':_0x16a7d2['name'],'username':_0x16a7d2[_0x32ebc6(0x1ac)],'telegramId':_0x16a7d2[_0x32ebc6(0x1d3)],'merchantUrl':_0x16a7d2['shopUrl'],'gateways':_0x16a7d2[_0x32ebc6(0x1ad)]?JSON['parse'](_0x16a7d2[_0x32ebc6(0x1ad)]):null,'gatewaySettings':_0x16a7d2[_0x32ebc6(0x1b8)]?JSON[_0x32ebc6(0x1af)](_0x16a7d2[_0x32ebc6(0x1b8)]):null,'publicKey':_0x16a7d2['publicKey'],'wallets':{'usdtPolygonWallet':_0x16a7d2[_0x32ebc6(0x1c4)],'usdtTrcWallet':_0x16a7d2[_0x32ebc6(0x1c7)],'usdtErcWallet':_0x16a7d2[_0x32ebc6(0x1aa)],'usdcPolygonWallet':_0x16a7d2[_0x32ebc6(0x1d4)]},'status':_0x16a7d2[_0x32ebc6(0x1b2)],'createdAt':_0x16a7d2[_0x32ebc6(0x1ae)]};}async[a89_0x5ed933(0x1a8)](_0x51bc38,_0x55eadc){const _0x420460=a89_0x5ed933,_0xed460d={..._0x55eadc};_0x55eadc[_0x420460(0x1be)]&&(_0xed460d[_0x420460(0x1be)]=await bcryptjs_1[_0x420460(0x1c2)]['hash'](_0x55eadc[_0x420460(0x1be)],0xc));_0x55eadc[_0x420460(0x1ca)]&&(_0xed460d['name']=_0x55eadc[_0x420460(0x1ca)],delete _0xed460d[_0x420460(0x1ca)]);_0x55eadc[_0x420460(0x1ba)]&&(_0xed460d[_0x420460(0x1d3)]=_0x55eadc[_0x420460(0x1ba)],delete _0xed460d[_0x420460(0x1ba)]);_0x55eadc['merchantUrl']&&(_0xed460d[_0x420460(0x1c9)]=_0x55eadc[_0x420460(0x1d5)],delete _0xed460d[_0x420460(0x1d5)]);_0x55eadc[_0x420460(0x1dc)]&&(_0xed460d[_0x420460(0x1ad)]=JSON[_0x420460(0x1bd)](_0x55eadc['gateways']),delete _0xed460d[_0x420460(0x1dc)]);_0x55eadc['gatewaySettings']&&(_0xed460d['gatewaySettings']=JSON['stringify'](_0x55eadc['gatewaySettings']),delete _0xed460d[_0x420460(0x1b8)]);_0x55eadc[_0x420460(0x1b6)]&&(_0x55eadc['wallets']['usdtPolygonWallet']!==undefined&&(_0xed460d['usdtPolygonWallet']=_0x55eadc['wallets'][_0x420460(0x1c4)]||null),_0x55eadc['wallets']['usdtTrcWallet']!==undefined&&(_0xed460d['usdtTrcWallet']=_0x55eadc[_0x420460(0x1b6)]['usdtTrcWallet']||null),_0x55eadc[_0x420460(0x1b6)][_0x420460(0x1aa)]!==undefined&&(_0xed460d['usdtErcWallet']=_0x55eadc[_0x420460(0x1b6)]['usdtErcWallet']||null),_0x55eadc[_0x420460(0x1b6)][_0x420460(0x1d4)]!==undefined&&(_0xed460d['usdcPolygonWallet']=_0x55eadc['wallets'][_0x420460(0x1d4)]||null),delete _0xed460d[_0x420460(0x1b6)]);const _0x39ad9e=await database_1[_0x420460(0x1c2)][_0x420460(0x1d7)]['update']({'where':{'id':_0x51bc38},'data':_0xed460d,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x39ad9e['id'],'fullName':_0x39ad9e[_0x420460(0x1cb)],'username':_0x39ad9e[_0x420460(0x1ac)],'telegramId':_0x39ad9e['telegram'],'merchantUrl':_0x39ad9e['shopUrl'],'gateways':_0x39ad9e[_0x420460(0x1ad)]?JSON[_0x420460(0x1af)](_0x39ad9e['paymentGateways']):null,'gatewaySettings':_0x39ad9e['gatewaySettings']?JSON['parse'](_0x39ad9e['gatewaySettings']):null,'publicKey':_0x39ad9e[_0x420460(0x1c6)],'wallets':{'usdtPolygonWallet':_0x39ad9e[_0x420460(0x1c4)],'usdtTrcWallet':_0x39ad9e[_0x420460(0x1c7)],'usdtErcWallet':_0x39ad9e[_0x420460(0x1aa)],'usdcPolygonWallet':_0x39ad9e['usdcPolygonWallet']},'status':_0x39ad9e[_0x420460(0x1b2)],'createdAt':_0x39ad9e[_0x420460(0x1ae)]};}async['deleteUser'](_0x43a45b){const _0x568c19=a89_0x5ed933;await database_1[_0x568c19(0x1c2)][_0x568c19(0x1d7)][_0x568c19(0x1c3)]({'where':{'id':_0x43a45b}});}}exports[a89_0x5ed933(0x1d0)]=UserService;