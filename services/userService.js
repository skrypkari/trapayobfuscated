'use strict';const a56_0x271155=a56_0x1cf9;(function(_0x165c29,_0x2de31e){const _0x190634=a56_0x1cf9,_0x5916f8=_0x165c29();while(!![]){try{const _0x12bdb3=-parseInt(_0x190634(0xa9))/0x1+-parseInt(_0x190634(0xa5))/0x2+-parseInt(_0x190634(0xc9))/0x3+parseInt(_0x190634(0xa7))/0x4*(-parseInt(_0x190634(0xc4))/0x5)+parseInt(_0x190634(0xac))/0x6*(-parseInt(_0x190634(0xb3))/0x7)+parseInt(_0x190634(0xd3))/0x8*(parseInt(_0x190634(0xbb))/0x9)+parseInt(_0x190634(0xca))/0xa;if(_0x12bdb3===_0x2de31e)break;else _0x5916f8['push'](_0x5916f8['shift']());}catch(_0x2014ef){_0x5916f8['push'](_0x5916f8['shift']());}}}(a56_0x1a95,0x30d09));var __importDefault=this&&this['__importDefault']||function(_0x3b3594){const _0x287231=a56_0x1cf9;return _0x3b3594&&_0x3b3594[_0x287231(0xb8)]?_0x3b3594:{'default':_0x3b3594};};function a56_0x1a95(){const _0x28b2f6=['password','1233tLEuqU','parse','generateApiKeys','status','getUserById','findMany','randomBytes','usdtTrcWallet','bcryptjs','5dhEOUx','hash','telegramId','deleteUser','sk_','1096713phbCRC','17010280WLEigV','map','findUnique','username','merchantUrl','createUser','default','publicKey','createdAt','704OAMCgD','gatewaySettings','shopUrl','usdtPolygonWallet','paymentGateways','name','stringify','wallets','update','441794UZEyvv','updateUser','1100332ezKDOD','usdtErcWallet','347545iSHmeb','fullName','telegram','38814lXuECU','create','Telegram\x20username\x20already\x20exists','pk_','../config/database','delete','UserService','329FVHUFC','toString','usdcPolygonWallet','shop','Username\x20already\x20exists','__esModule','crypto'];a56_0x1a95=function(){return _0x28b2f6;};return a56_0x1a95();}Object['defineProperty'](exports,a56_0x271155(0xb8),{'value':!![]}),exports[a56_0x271155(0xb2)]=void 0x0;function a56_0x1cf9(_0x2e192c,_0x411f78){const _0x1a9510=a56_0x1a95();return a56_0x1cf9=function(_0x1cf9a6,_0x4216ef){_0x1cf9a6=_0x1cf9a6-0x9d;let _0x481d89=_0x1a9510[_0x1cf9a6];return _0x481d89;},a56_0x1cf9(_0x2e192c,_0x411f78);}const bcryptjs_1=__importDefault(require(a56_0x271155(0xc3))),crypto_1=__importDefault(require(a56_0x271155(0xb9))),database_1=__importDefault(require(a56_0x271155(0xb0)));class UserService{[a56_0x271155(0xbd)](){const _0x2e8b83=a56_0x271155,_0x589cb0=_0x2e8b83(0xaf)+crypto_1[_0x2e8b83(0xd0)][_0x2e8b83(0xc1)](0x20)[_0x2e8b83(0xb4)]('hex'),_0x1f0706=_0x2e8b83(0xc8)+crypto_1[_0x2e8b83(0xd0)][_0x2e8b83(0xc1)](0x20)[_0x2e8b83(0xb4)]('hex');return{'publicKey':_0x589cb0,'secretKey':_0x1f0706};}async[a56_0x271155(0xcf)](_0x45773d){const _0x4047e8=a56_0x271155,{fullName:_0x3fecdf,username:_0x27e800,password:_0x351147,telegramId:_0x3468f3,merchantUrl:_0x5ed1db,gateways:_0x5b603e,gatewaySettings:_0x3cc8f4,wallets:_0x5a95db}=_0x45773d,_0x5d9b29=await database_1['default']['shop'][_0x4047e8(0xcc)]({'where':{'username':_0x27e800}});if(_0x5d9b29)throw new Error(_0x4047e8(0xb7));if(_0x3468f3){const _0x1c7b70=await database_1['default'][_0x4047e8(0xb6)][_0x4047e8(0xcc)]({'where':{'telegram':_0x3468f3}});if(_0x1c7b70)throw new Error(_0x4047e8(0xae));}const _0x2df684=await bcryptjs_1[_0x4047e8(0xd0)]['hash'](_0x351147,0xc),{publicKey:_0x54f6fc,secretKey:_0x47e3b0}=this[_0x4047e8(0xbd)](),_0x2096e0=await database_1[_0x4047e8(0xd0)][_0x4047e8(0xb6)][_0x4047e8(0xad)]({'data':{'name':_0x3fecdf,'username':_0x27e800,'password':_0x2df684,'telegram':_0x3468f3,'shopUrl':_0x5ed1db,'paymentGateways':_0x5b603e?JSON['stringify'](_0x5b603e):null,'gatewaySettings':_0x3cc8f4?JSON['stringify'](_0x3cc8f4):null,'usdtPolygonWallet':_0x5a95db?.[_0x4047e8(0x9f)]||null,'usdtTrcWallet':_0x5a95db?.['usdtTrcWallet']||null,'usdtErcWallet':_0x5a95db?.[_0x4047e8(0xa8)]||null,'usdcPolygonWallet':_0x5a95db?.['usdcPolygonWallet']||null,'publicKey':_0x54f6fc,'secretKey':_0x47e3b0,'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x2096e0['id'],'fullName':_0x2096e0[_0x4047e8(0xa1)],'username':_0x2096e0[_0x4047e8(0xcd)],'telegramId':_0x2096e0[_0x4047e8(0xab)],'merchantUrl':_0x2096e0[_0x4047e8(0x9e)],'gateways':_0x2096e0[_0x4047e8(0xa0)]?JSON['parse'](_0x2096e0[_0x4047e8(0xa0)]):null,'gatewaySettings':_0x2096e0[_0x4047e8(0x9d)]?JSON[_0x4047e8(0xbc)](_0x2096e0['gatewaySettings']):null,'publicKey':_0x2096e0[_0x4047e8(0xd1)],'wallets':{'usdtPolygonWallet':_0x2096e0[_0x4047e8(0x9f)],'usdtTrcWallet':_0x2096e0['usdtTrcWallet'],'usdtErcWallet':_0x2096e0[_0x4047e8(0xa8)],'usdcPolygonWallet':_0x2096e0[_0x4047e8(0xb5)]},'status':_0x2096e0[_0x4047e8(0xbe)],'createdAt':_0x2096e0[_0x4047e8(0xd2)]};}async['getAllUsers'](){const _0x4b1a9b=a56_0x271155,_0x2768db=await database_1['default'][_0x4b1a9b(0xb6)][_0x4b1a9b(0xc0)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':'desc'}});return _0x2768db[_0x4b1a9b(0xcb)](_0x36dba6=>({'id':_0x36dba6['id'],'fullName':_0x36dba6[_0x4b1a9b(0xa1)],'username':_0x36dba6[_0x4b1a9b(0xcd)],'telegramId':_0x36dba6['telegram'],'merchantUrl':_0x36dba6[_0x4b1a9b(0x9e)],'gateways':_0x36dba6['paymentGateways']?JSON[_0x4b1a9b(0xbc)](_0x36dba6[_0x4b1a9b(0xa0)]):null,'gatewaySettings':_0x36dba6[_0x4b1a9b(0x9d)]?JSON[_0x4b1a9b(0xbc)](_0x36dba6[_0x4b1a9b(0x9d)]):null,'publicKey':_0x36dba6[_0x4b1a9b(0xd1)],'wallets':{'usdtPolygonWallet':_0x36dba6[_0x4b1a9b(0x9f)],'usdtTrcWallet':_0x36dba6[_0x4b1a9b(0xc2)],'usdtErcWallet':_0x36dba6[_0x4b1a9b(0xa8)],'usdcPolygonWallet':_0x36dba6[_0x4b1a9b(0xb5)]},'status':_0x36dba6[_0x4b1a9b(0xbe)],'createdAt':_0x36dba6[_0x4b1a9b(0xd2)]}));}async[a56_0x271155(0xbf)](_0x195b75){const _0x2abc06=a56_0x271155,_0x5a1385=await database_1['default']['shop'][_0x2abc06(0xcc)]({'where':{'id':_0x195b75},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x5a1385)return null;return{'id':_0x5a1385['id'],'fullName':_0x5a1385['name'],'username':_0x5a1385[_0x2abc06(0xcd)],'telegramId':_0x5a1385[_0x2abc06(0xab)],'merchantUrl':_0x5a1385[_0x2abc06(0x9e)],'gateways':_0x5a1385['paymentGateways']?JSON[_0x2abc06(0xbc)](_0x5a1385[_0x2abc06(0xa0)]):null,'gatewaySettings':_0x5a1385['gatewaySettings']?JSON[_0x2abc06(0xbc)](_0x5a1385['gatewaySettings']):null,'publicKey':_0x5a1385[_0x2abc06(0xd1)],'wallets':{'usdtPolygonWallet':_0x5a1385['usdtPolygonWallet'],'usdtTrcWallet':_0x5a1385[_0x2abc06(0xc2)],'usdtErcWallet':_0x5a1385[_0x2abc06(0xa8)],'usdcPolygonWallet':_0x5a1385[_0x2abc06(0xb5)]},'status':_0x5a1385[_0x2abc06(0xbe)],'createdAt':_0x5a1385[_0x2abc06(0xd2)]};}async[a56_0x271155(0xa6)](_0xd1c604,_0x1f3ee1){const _0x1b2fb6=a56_0x271155,_0xb1e192={..._0x1f3ee1};_0x1f3ee1[_0x1b2fb6(0xba)]&&(_0xb1e192['password']=await bcryptjs_1[_0x1b2fb6(0xd0)][_0x1b2fb6(0xc5)](_0x1f3ee1['password'],0xc));_0x1f3ee1['fullName']&&(_0xb1e192[_0x1b2fb6(0xa1)]=_0x1f3ee1[_0x1b2fb6(0xaa)],delete _0xb1e192[_0x1b2fb6(0xaa)]);_0x1f3ee1[_0x1b2fb6(0xc6)]&&(_0xb1e192[_0x1b2fb6(0xab)]=_0x1f3ee1['telegramId'],delete _0xb1e192[_0x1b2fb6(0xc6)]);_0x1f3ee1[_0x1b2fb6(0xce)]&&(_0xb1e192['shopUrl']=_0x1f3ee1[_0x1b2fb6(0xce)],delete _0xb1e192[_0x1b2fb6(0xce)]);_0x1f3ee1['gateways']&&(_0xb1e192[_0x1b2fb6(0xa0)]=JSON[_0x1b2fb6(0xa2)](_0x1f3ee1['gateways']),delete _0xb1e192['gateways']);_0x1f3ee1['gatewaySettings']&&(_0xb1e192['gatewaySettings']=JSON[_0x1b2fb6(0xa2)](_0x1f3ee1[_0x1b2fb6(0x9d)]),delete _0xb1e192['gatewaySettings']);_0x1f3ee1[_0x1b2fb6(0xa3)]&&(_0x1f3ee1['wallets'][_0x1b2fb6(0x9f)]!==undefined&&(_0xb1e192['usdtPolygonWallet']=_0x1f3ee1['wallets']['usdtPolygonWallet']||null),_0x1f3ee1[_0x1b2fb6(0xa3)][_0x1b2fb6(0xc2)]!==undefined&&(_0xb1e192[_0x1b2fb6(0xc2)]=_0x1f3ee1[_0x1b2fb6(0xa3)]['usdtTrcWallet']||null),_0x1f3ee1['wallets'][_0x1b2fb6(0xa8)]!==undefined&&(_0xb1e192[_0x1b2fb6(0xa8)]=_0x1f3ee1[_0x1b2fb6(0xa3)][_0x1b2fb6(0xa8)]||null),_0x1f3ee1['wallets'][_0x1b2fb6(0xb5)]!==undefined&&(_0xb1e192['usdcPolygonWallet']=_0x1f3ee1[_0x1b2fb6(0xa3)][_0x1b2fb6(0xb5)]||null),delete _0xb1e192[_0x1b2fb6(0xa3)]);const _0x25a664=await database_1[_0x1b2fb6(0xd0)][_0x1b2fb6(0xb6)][_0x1b2fb6(0xa4)]({'where':{'id':_0xd1c604},'data':_0xb1e192,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x25a664['id'],'fullName':_0x25a664['name'],'username':_0x25a664[_0x1b2fb6(0xcd)],'telegramId':_0x25a664[_0x1b2fb6(0xab)],'merchantUrl':_0x25a664['shopUrl'],'gateways':_0x25a664[_0x1b2fb6(0xa0)]?JSON['parse'](_0x25a664[_0x1b2fb6(0xa0)]):null,'gatewaySettings':_0x25a664['gatewaySettings']?JSON[_0x1b2fb6(0xbc)](_0x25a664[_0x1b2fb6(0x9d)]):null,'publicKey':_0x25a664['publicKey'],'wallets':{'usdtPolygonWallet':_0x25a664[_0x1b2fb6(0x9f)],'usdtTrcWallet':_0x25a664[_0x1b2fb6(0xc2)],'usdtErcWallet':_0x25a664[_0x1b2fb6(0xa8)],'usdcPolygonWallet':_0x25a664['usdcPolygonWallet']},'status':_0x25a664[_0x1b2fb6(0xbe)],'createdAt':_0x25a664[_0x1b2fb6(0xd2)]};}async[a56_0x271155(0xc7)](_0x50926d){const _0x1874ed=a56_0x271155;await database_1[_0x1874ed(0xd0)][_0x1874ed(0xb6)][_0x1874ed(0xb1)]({'where':{'id':_0x50926d}});}}exports[a56_0x271155(0xb2)]=UserService;