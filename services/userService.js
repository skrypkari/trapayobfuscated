'use strict';const a59_0x43682a=a59_0x3819;function a59_0x3819(_0xd31912,_0x4f0f74){const _0x2994dc=a59_0x2994();return a59_0x3819=function(_0x3819b2,_0x487a6f){_0x3819b2=_0x3819b2-0xfd;let _0x3617e5=_0x2994dc[_0x3819b2];return _0x3617e5;},a59_0x3819(_0xd31912,_0x4f0f74);}(function(_0x255177,_0x33c2ae){const _0x2c0f89=a59_0x3819,_0x3242ac=_0x255177();while(!![]){try{const _0x3eb14d=parseInt(_0x2c0f89(0x126))/0x1+-parseInt(_0x2c0f89(0x125))/0x2+parseInt(_0x2c0f89(0x105))/0x3+-parseInt(_0x2c0f89(0xfe))/0x4+-parseInt(_0x2c0f89(0x11e))/0x5*(-parseInt(_0x2c0f89(0x12e))/0x6)+parseInt(_0x2c0f89(0x11d))/0x7*(parseInt(_0x2c0f89(0x116))/0x8)+-parseInt(_0x2c0f89(0x11f))/0x9*(parseInt(_0x2c0f89(0x108))/0xa);if(_0x3eb14d===_0x33c2ae)break;else _0x3242ac['push'](_0x3242ac['shift']());}catch(_0x277b2f){_0x3242ac['push'](_0x3242ac['shift']());}}}(a59_0x2994,0x7f3a5));var __importDefault=this&&this[a59_0x43682a(0x10f)]||function(_0x4a90fd){const _0x4baaa8=a59_0x43682a;return _0x4a90fd&&_0x4a90fd[_0x4baaa8(0x117)]?_0x4a90fd:{'default':_0x4a90fd};};function a59_0x2994(){const _0x4fe345=['../config/database','crypto','__importDefault','merchantUrl','hash','create','Username\x20already\x20exists','createdAt','usdtErcWallet','56MNfHZI','__esModule','shop','shopUrl','telegramId','wallets','usdtPolygonWallet','398209PgsSAi','643315yrSkWn','1179DWIBXa','UserService','delete','deleteUser','password','findUnique','852926FWpvlU','483633AsaKej','username','paymentGateways','telegram','findMany','update','usdcPolygonWallet','default','36ZWNIGe','defineProperty','status','gateways','Telegram\x20username\x20already\x20exists','toString','ACTIVE','usdtTrcWallet','pk_','hex','bcryptjs','2442612TjwLRu','parse','randomBytes','gatewaySettings','generateApiKeys','desc','stringify','1040424rNvsGZ','sk_','updateUser','33770wnDjjW','map','publicKey','fullName','name'];a59_0x2994=function(){return _0x4fe345;};return a59_0x2994();}Object[a59_0x43682a(0x12f)](exports,'__esModule',{'value':!![]}),exports[a59_0x43682a(0x120)]=void 0x0;const bcryptjs_1=__importDefault(require(a59_0x43682a(0xfd))),crypto_1=__importDefault(require(a59_0x43682a(0x10e))),database_1=__importDefault(require(a59_0x43682a(0x10d)));class UserService{['generateApiKeys'](){const _0x156f47=a59_0x43682a,_0x22fa8c=_0x156f47(0x136)+crypto_1[_0x156f47(0x12d)][_0x156f47(0x100)](0x20)[_0x156f47(0x133)]('hex'),_0x5ec061=_0x156f47(0x106)+crypto_1['default']['randomBytes'](0x20)['toString'](_0x156f47(0x137));return{'publicKey':_0x22fa8c,'secretKey':_0x5ec061};}async['createUser'](_0x5d6d09){const _0x1424c0=a59_0x43682a,{fullName:_0x4bdb41,username:_0x51c065,password:_0x2cdbe3,telegramId:_0x3391eb,merchantUrl:_0x130383,gateways:_0x213616,gatewaySettings:_0x5ee66b,wallets:_0x1af309}=_0x5d6d09,_0x24b2ed=await database_1[_0x1424c0(0x12d)][_0x1424c0(0x118)][_0x1424c0(0x124)]({'where':{'username':_0x51c065}});if(_0x24b2ed)throw new Error(_0x1424c0(0x113));if(_0x3391eb){const _0x52e430=await database_1[_0x1424c0(0x12d)][_0x1424c0(0x118)][_0x1424c0(0x124)]({'where':{'telegram':_0x3391eb}});if(_0x52e430)throw new Error(_0x1424c0(0x132));}const _0x2dec27=await bcryptjs_1[_0x1424c0(0x12d)][_0x1424c0(0x111)](_0x2cdbe3,0xc),{publicKey:_0x19fc72,secretKey:_0x429211}=this[_0x1424c0(0x102)](),_0x310f7a=await database_1[_0x1424c0(0x12d)]['shop'][_0x1424c0(0x112)]({'data':{'name':_0x4bdb41,'username':_0x51c065,'password':_0x2dec27,'telegram':_0x3391eb,'shopUrl':_0x130383,'paymentGateways':_0x213616?JSON[_0x1424c0(0x104)](_0x213616):null,'gatewaySettings':_0x5ee66b?JSON[_0x1424c0(0x104)](_0x5ee66b):null,'usdtPolygonWallet':_0x1af309?.[_0x1424c0(0x11c)]||null,'usdtTrcWallet':_0x1af309?.[_0x1424c0(0x135)]||null,'usdtErcWallet':_0x1af309?.['usdtErcWallet']||null,'usdcPolygonWallet':_0x1af309?.[_0x1424c0(0x12c)]||null,'publicKey':_0x19fc72,'secretKey':_0x429211,'status':_0x1424c0(0x134)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x310f7a['id'],'fullName':_0x310f7a['name'],'username':_0x310f7a[_0x1424c0(0x127)],'telegramId':_0x310f7a['telegram'],'merchantUrl':_0x310f7a[_0x1424c0(0x119)],'gateways':_0x310f7a[_0x1424c0(0x128)]?JSON[_0x1424c0(0xff)](_0x310f7a[_0x1424c0(0x128)]):null,'gatewaySettings':_0x310f7a[_0x1424c0(0x101)]?JSON[_0x1424c0(0xff)](_0x310f7a[_0x1424c0(0x101)]):null,'publicKey':_0x310f7a[_0x1424c0(0x10a)],'wallets':{'usdtPolygonWallet':_0x310f7a[_0x1424c0(0x11c)],'usdtTrcWallet':_0x310f7a[_0x1424c0(0x135)],'usdtErcWallet':_0x310f7a[_0x1424c0(0x115)],'usdcPolygonWallet':_0x310f7a['usdcPolygonWallet']},'status':_0x310f7a['status'],'createdAt':_0x310f7a[_0x1424c0(0x114)]};}async['getAllUsers'](){const _0x43b68d=a59_0x43682a,_0x284950=await database_1[_0x43b68d(0x12d)]['shop'][_0x43b68d(0x12a)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x43b68d(0x103)}});return _0x284950[_0x43b68d(0x109)](_0x4fbdee=>({'id':_0x4fbdee['id'],'fullName':_0x4fbdee['name'],'username':_0x4fbdee[_0x43b68d(0x127)],'telegramId':_0x4fbdee[_0x43b68d(0x129)],'merchantUrl':_0x4fbdee[_0x43b68d(0x119)],'gateways':_0x4fbdee[_0x43b68d(0x128)]?JSON['parse'](_0x4fbdee[_0x43b68d(0x128)]):null,'gatewaySettings':_0x4fbdee[_0x43b68d(0x101)]?JSON[_0x43b68d(0xff)](_0x4fbdee[_0x43b68d(0x101)]):null,'publicKey':_0x4fbdee[_0x43b68d(0x10a)],'wallets':{'usdtPolygonWallet':_0x4fbdee[_0x43b68d(0x11c)],'usdtTrcWallet':_0x4fbdee[_0x43b68d(0x135)],'usdtErcWallet':_0x4fbdee[_0x43b68d(0x115)],'usdcPolygonWallet':_0x4fbdee[_0x43b68d(0x12c)]},'status':_0x4fbdee[_0x43b68d(0x130)],'createdAt':_0x4fbdee[_0x43b68d(0x114)]}));}async['getUserById'](_0x36b289){const _0xb21a87=a59_0x43682a,_0x5980f6=await database_1[_0xb21a87(0x12d)][_0xb21a87(0x118)][_0xb21a87(0x124)]({'where':{'id':_0x36b289},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x5980f6)return null;return{'id':_0x5980f6['id'],'fullName':_0x5980f6[_0xb21a87(0x10c)],'username':_0x5980f6['username'],'telegramId':_0x5980f6[_0xb21a87(0x129)],'merchantUrl':_0x5980f6[_0xb21a87(0x119)],'gateways':_0x5980f6[_0xb21a87(0x128)]?JSON[_0xb21a87(0xff)](_0x5980f6[_0xb21a87(0x128)]):null,'gatewaySettings':_0x5980f6[_0xb21a87(0x101)]?JSON[_0xb21a87(0xff)](_0x5980f6[_0xb21a87(0x101)]):null,'publicKey':_0x5980f6['publicKey'],'wallets':{'usdtPolygonWallet':_0x5980f6['usdtPolygonWallet'],'usdtTrcWallet':_0x5980f6[_0xb21a87(0x135)],'usdtErcWallet':_0x5980f6[_0xb21a87(0x115)],'usdcPolygonWallet':_0x5980f6[_0xb21a87(0x12c)]},'status':_0x5980f6[_0xb21a87(0x130)],'createdAt':_0x5980f6['createdAt']};}async[a59_0x43682a(0x107)](_0x21229d,_0x16d18f){const _0x37c373=a59_0x43682a,_0x2f69d8={..._0x16d18f};_0x16d18f[_0x37c373(0x123)]&&(_0x2f69d8[_0x37c373(0x123)]=await bcryptjs_1[_0x37c373(0x12d)]['hash'](_0x16d18f[_0x37c373(0x123)],0xc));_0x16d18f['fullName']&&(_0x2f69d8[_0x37c373(0x10c)]=_0x16d18f[_0x37c373(0x10b)],delete _0x2f69d8[_0x37c373(0x10b)]);_0x16d18f['telegramId']&&(_0x2f69d8[_0x37c373(0x129)]=_0x16d18f[_0x37c373(0x11a)],delete _0x2f69d8[_0x37c373(0x11a)]);_0x16d18f[_0x37c373(0x110)]&&(_0x2f69d8[_0x37c373(0x119)]=_0x16d18f[_0x37c373(0x110)],delete _0x2f69d8['merchantUrl']);_0x16d18f[_0x37c373(0x131)]&&(_0x2f69d8['paymentGateways']=JSON['stringify'](_0x16d18f[_0x37c373(0x131)]),delete _0x2f69d8[_0x37c373(0x131)]);_0x16d18f[_0x37c373(0x101)]&&(_0x2f69d8[_0x37c373(0x101)]=JSON[_0x37c373(0x104)](_0x16d18f[_0x37c373(0x101)]),delete _0x2f69d8['gatewaySettings']);_0x16d18f[_0x37c373(0x11b)]&&(_0x16d18f['wallets']['usdtPolygonWallet']!==undefined&&(_0x2f69d8[_0x37c373(0x11c)]=_0x16d18f[_0x37c373(0x11b)][_0x37c373(0x11c)]||null),_0x16d18f[_0x37c373(0x11b)][_0x37c373(0x135)]!==undefined&&(_0x2f69d8['usdtTrcWallet']=_0x16d18f[_0x37c373(0x11b)][_0x37c373(0x135)]||null),_0x16d18f[_0x37c373(0x11b)]['usdtErcWallet']!==undefined&&(_0x2f69d8[_0x37c373(0x115)]=_0x16d18f[_0x37c373(0x11b)][_0x37c373(0x115)]||null),_0x16d18f[_0x37c373(0x11b)][_0x37c373(0x12c)]!==undefined&&(_0x2f69d8[_0x37c373(0x12c)]=_0x16d18f[_0x37c373(0x11b)][_0x37c373(0x12c)]||null),delete _0x2f69d8[_0x37c373(0x11b)]);const _0x2cf8f8=await database_1[_0x37c373(0x12d)]['shop'][_0x37c373(0x12b)]({'where':{'id':_0x21229d},'data':_0x2f69d8,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x2cf8f8['id'],'fullName':_0x2cf8f8[_0x37c373(0x10c)],'username':_0x2cf8f8[_0x37c373(0x127)],'telegramId':_0x2cf8f8[_0x37c373(0x129)],'merchantUrl':_0x2cf8f8[_0x37c373(0x119)],'gateways':_0x2cf8f8[_0x37c373(0x128)]?JSON[_0x37c373(0xff)](_0x2cf8f8[_0x37c373(0x128)]):null,'gatewaySettings':_0x2cf8f8['gatewaySettings']?JSON['parse'](_0x2cf8f8[_0x37c373(0x101)]):null,'publicKey':_0x2cf8f8[_0x37c373(0x10a)],'wallets':{'usdtPolygonWallet':_0x2cf8f8[_0x37c373(0x11c)],'usdtTrcWallet':_0x2cf8f8[_0x37c373(0x135)],'usdtErcWallet':_0x2cf8f8[_0x37c373(0x115)],'usdcPolygonWallet':_0x2cf8f8[_0x37c373(0x12c)]},'status':_0x2cf8f8['status'],'createdAt':_0x2cf8f8[_0x37c373(0x114)]};}async[a59_0x43682a(0x122)](_0x5c1fe5){const _0x34b472=a59_0x43682a;await database_1[_0x34b472(0x12d)][_0x34b472(0x118)][_0x34b472(0x121)]({'where':{'id':_0x5c1fe5}});}}exports[a59_0x43682a(0x120)]=UserService;