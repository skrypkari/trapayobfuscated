'use strict';const a55_0x749be9=a55_0x1686;(function(_0x35b90a,_0x72d7c8){const _0x185919=a55_0x1686,_0x12c865=_0x35b90a();while(!![]){try{const _0x55a80d=-parseInt(_0x185919(0x11a))/0x1*(parseInt(_0x185919(0xe4))/0x2)+-parseInt(_0x185919(0x111))/0x3+parseInt(_0x185919(0xf9))/0x4*(parseInt(_0x185919(0xfe))/0x5)+parseInt(_0x185919(0xe3))/0x6*(-parseInt(_0x185919(0xfc))/0x7)+parseInt(_0x185919(0x118))/0x8*(parseInt(_0x185919(0xf8))/0x9)+-parseInt(_0x185919(0x115))/0xa+parseInt(_0x185919(0xea))/0xb*(parseInt(_0x185919(0xf5))/0xc);if(_0x55a80d===_0x72d7c8)break;else _0x12c865['push'](_0x12c865['shift']());}catch(_0x327af9){_0x12c865['push'](_0x12c865['shift']());}}}(a55_0x3218,0x774e3));var __importDefault=this&&this[a55_0x749be9(0x11c)]||function(_0xdcd8b4){const _0x550d0d=a55_0x749be9;return _0xdcd8b4&&_0xdcd8b4[_0x550d0d(0x10c)]?_0xdcd8b4:{'default':_0xdcd8b4};};function a55_0x1686(_0x35d264,_0x2939d5){const _0x3218d4=a55_0x3218();return a55_0x1686=function(_0x16861a,_0x31eaeb){_0x16861a=_0x16861a-0xe3;let _0x3cc568=_0x3218d4[_0x16861a];return _0x3cc568;},a55_0x1686(_0x35d264,_0x2939d5);}function a55_0x3218(){const _0x37ecd2=['Username\x20already\x20exists','shopUrl','gateways','toString','merchantUrl','status','username','updateUser','generateApiKeys','defineProperty','21406344KxvZYX','paymentGateways','createUser','1341018OJTmCs','244gdVfwE','password','create','10787wNloRn','ACTIVE','70975JzWPMt','createdAt','gatewaySettings','shop','randomBytes','bcryptjs','usdcPolygonWallet','findMany','telegramId','hash','deleteUser','UserService','crypto','map','__esModule','usdtPolygonWallet','fullName','usdtErcWallet','findUnique','1798068VZWCYv','usdtTrcWallet','name','parse','9750680QHgqyM','stringify','telegram','24AVhftu','hex','15131TSKcxq','getUserById','__importDefault','372pBxDrf','124IOtqeq','wallets','sk_','default','publicKey','../config/database','11SFnHbY'];a55_0x3218=function(){return _0x37ecd2;};return a55_0x3218();}Object[a55_0x749be9(0xf4)](exports,a55_0x749be9(0x10c),{'value':!![]}),exports[a55_0x749be9(0x109)]=void 0x0;const bcryptjs_1=__importDefault(require(a55_0x749be9(0x103))),crypto_1=__importDefault(require(a55_0x749be9(0x10a))),database_1=__importDefault(require(a55_0x749be9(0xe9)));class UserService{[a55_0x749be9(0xf3)](){const _0xf265ed=a55_0x749be9,_0x3df657='pk_'+crypto_1['default'][_0xf265ed(0x102)](0x20)['toString'](_0xf265ed(0x119)),_0x288add=_0xf265ed(0xe6)+crypto_1[_0xf265ed(0xe7)][_0xf265ed(0x102)](0x20)[_0xf265ed(0xee)](_0xf265ed(0x119));return{'publicKey':_0x3df657,'secretKey':_0x288add};}async[a55_0x749be9(0xf7)](_0x337b75){const _0x1a5507=a55_0x749be9,{fullName:_0x1a0503,username:_0x57a1fd,password:_0x3d0e60,telegramId:_0x21e4c9,merchantUrl:_0x147214,gateways:_0x5c815f,gatewaySettings:_0x5949e1,wallets:_0x94edd7}=_0x337b75,_0x221ade=await database_1[_0x1a5507(0xe7)][_0x1a5507(0x101)][_0x1a5507(0x110)]({'where':{'username':_0x57a1fd}});if(_0x221ade)throw new Error(_0x1a5507(0xeb));if(_0x21e4c9){const _0x59e7b3=await database_1[_0x1a5507(0xe7)][_0x1a5507(0x101)]['findUnique']({'where':{'telegram':_0x21e4c9}});if(_0x59e7b3)throw new Error('Telegram\x20username\x20already\x20exists');}const _0x474cbd=await bcryptjs_1['default'][_0x1a5507(0x107)](_0x3d0e60,0xc),{publicKey:_0x13e596,secretKey:_0x23c589}=this[_0x1a5507(0xf3)](),_0x2d8402=await database_1[_0x1a5507(0xe7)][_0x1a5507(0x101)][_0x1a5507(0xfb)]({'data':{'name':_0x1a0503,'username':_0x57a1fd,'password':_0x474cbd,'telegram':_0x21e4c9,'shopUrl':_0x147214,'paymentGateways':_0x5c815f?JSON[_0x1a5507(0x116)](_0x5c815f):null,'gatewaySettings':_0x5949e1?JSON['stringify'](_0x5949e1):null,'usdtPolygonWallet':_0x94edd7?.[_0x1a5507(0x10d)]||null,'usdtTrcWallet':_0x94edd7?.['usdtTrcWallet']||null,'usdtErcWallet':_0x94edd7?.[_0x1a5507(0x10f)]||null,'usdcPolygonWallet':_0x94edd7?.['usdcPolygonWallet']||null,'publicKey':_0x13e596,'secretKey':_0x23c589,'status':_0x1a5507(0xfd)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x2d8402['id'],'fullName':_0x2d8402[_0x1a5507(0x113)],'username':_0x2d8402[_0x1a5507(0xf1)],'telegramId':_0x2d8402['telegram'],'merchantUrl':_0x2d8402[_0x1a5507(0xec)],'gateways':_0x2d8402[_0x1a5507(0xf6)]?JSON['parse'](_0x2d8402[_0x1a5507(0xf6)]):null,'gatewaySettings':_0x2d8402[_0x1a5507(0x100)]?JSON['parse'](_0x2d8402[_0x1a5507(0x100)]):null,'publicKey':_0x2d8402[_0x1a5507(0xe8)],'wallets':{'usdtPolygonWallet':_0x2d8402[_0x1a5507(0x10d)],'usdtTrcWallet':_0x2d8402[_0x1a5507(0x112)],'usdtErcWallet':_0x2d8402[_0x1a5507(0x10f)],'usdcPolygonWallet':_0x2d8402['usdcPolygonWallet']},'status':_0x2d8402[_0x1a5507(0xf0)],'createdAt':_0x2d8402['createdAt']};}async['getAllUsers'](){const _0x4c4499=a55_0x749be9,_0x22c7bc=await database_1[_0x4c4499(0xe7)][_0x4c4499(0x101)][_0x4c4499(0x105)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':'desc'}});return _0x22c7bc[_0x4c4499(0x10b)](_0x37e820=>({'id':_0x37e820['id'],'fullName':_0x37e820[_0x4c4499(0x113)],'username':_0x37e820[_0x4c4499(0xf1)],'telegramId':_0x37e820[_0x4c4499(0x117)],'merchantUrl':_0x37e820['shopUrl'],'gateways':_0x37e820['paymentGateways']?JSON[_0x4c4499(0x114)](_0x37e820['paymentGateways']):null,'gatewaySettings':_0x37e820[_0x4c4499(0x100)]?JSON[_0x4c4499(0x114)](_0x37e820[_0x4c4499(0x100)]):null,'publicKey':_0x37e820[_0x4c4499(0xe8)],'wallets':{'usdtPolygonWallet':_0x37e820[_0x4c4499(0x10d)],'usdtTrcWallet':_0x37e820['usdtTrcWallet'],'usdtErcWallet':_0x37e820[_0x4c4499(0x10f)],'usdcPolygonWallet':_0x37e820['usdcPolygonWallet']},'status':_0x37e820[_0x4c4499(0xf0)],'createdAt':_0x37e820['createdAt']}));}async[a55_0x749be9(0x11b)](_0x9c2975){const _0x2effa5=a55_0x749be9,_0x5a5fdb=await database_1['default'][_0x2effa5(0x101)][_0x2effa5(0x110)]({'where':{'id':_0x9c2975},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x5a5fdb)return null;return{'id':_0x5a5fdb['id'],'fullName':_0x5a5fdb[_0x2effa5(0x113)],'username':_0x5a5fdb[_0x2effa5(0xf1)],'telegramId':_0x5a5fdb[_0x2effa5(0x117)],'merchantUrl':_0x5a5fdb[_0x2effa5(0xec)],'gateways':_0x5a5fdb[_0x2effa5(0xf6)]?JSON['parse'](_0x5a5fdb[_0x2effa5(0xf6)]):null,'gatewaySettings':_0x5a5fdb[_0x2effa5(0x100)]?JSON[_0x2effa5(0x114)](_0x5a5fdb[_0x2effa5(0x100)]):null,'publicKey':_0x5a5fdb[_0x2effa5(0xe8)],'wallets':{'usdtPolygonWallet':_0x5a5fdb[_0x2effa5(0x10d)],'usdtTrcWallet':_0x5a5fdb[_0x2effa5(0x112)],'usdtErcWallet':_0x5a5fdb[_0x2effa5(0x10f)],'usdcPolygonWallet':_0x5a5fdb[_0x2effa5(0x104)]},'status':_0x5a5fdb['status'],'createdAt':_0x5a5fdb[_0x2effa5(0xff)]};}async[a55_0x749be9(0xf2)](_0x569e5b,_0x4c5a14){const _0x2d0189=a55_0x749be9,_0x252b13={..._0x4c5a14};_0x4c5a14['password']&&(_0x252b13[_0x2d0189(0xfa)]=await bcryptjs_1[_0x2d0189(0xe7)]['hash'](_0x4c5a14[_0x2d0189(0xfa)],0xc));_0x4c5a14['fullName']&&(_0x252b13[_0x2d0189(0x113)]=_0x4c5a14[_0x2d0189(0x10e)],delete _0x252b13[_0x2d0189(0x10e)]);_0x4c5a14[_0x2d0189(0x106)]&&(_0x252b13[_0x2d0189(0x117)]=_0x4c5a14[_0x2d0189(0x106)],delete _0x252b13[_0x2d0189(0x106)]);_0x4c5a14[_0x2d0189(0xef)]&&(_0x252b13['shopUrl']=_0x4c5a14[_0x2d0189(0xef)],delete _0x252b13['merchantUrl']);_0x4c5a14[_0x2d0189(0xed)]&&(_0x252b13[_0x2d0189(0xf6)]=JSON[_0x2d0189(0x116)](_0x4c5a14['gateways']),delete _0x252b13[_0x2d0189(0xed)]);_0x4c5a14[_0x2d0189(0x100)]&&(_0x252b13['gatewaySettings']=JSON[_0x2d0189(0x116)](_0x4c5a14['gatewaySettings']),delete _0x252b13[_0x2d0189(0x100)]);_0x4c5a14[_0x2d0189(0xe5)]&&(_0x4c5a14['wallets'][_0x2d0189(0x10d)]!==undefined&&(_0x252b13['usdtPolygonWallet']=_0x4c5a14[_0x2d0189(0xe5)][_0x2d0189(0x10d)]||null),_0x4c5a14[_0x2d0189(0xe5)][_0x2d0189(0x112)]!==undefined&&(_0x252b13[_0x2d0189(0x112)]=_0x4c5a14[_0x2d0189(0xe5)][_0x2d0189(0x112)]||null),_0x4c5a14[_0x2d0189(0xe5)]['usdtErcWallet']!==undefined&&(_0x252b13[_0x2d0189(0x10f)]=_0x4c5a14[_0x2d0189(0xe5)][_0x2d0189(0x10f)]||null),_0x4c5a14[_0x2d0189(0xe5)]['usdcPolygonWallet']!==undefined&&(_0x252b13[_0x2d0189(0x104)]=_0x4c5a14[_0x2d0189(0xe5)]['usdcPolygonWallet']||null),delete _0x252b13[_0x2d0189(0xe5)]);const _0x49a1de=await database_1['default'][_0x2d0189(0x101)]['update']({'where':{'id':_0x569e5b},'data':_0x252b13,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x49a1de['id'],'fullName':_0x49a1de[_0x2d0189(0x113)],'username':_0x49a1de[_0x2d0189(0xf1)],'telegramId':_0x49a1de[_0x2d0189(0x117)],'merchantUrl':_0x49a1de[_0x2d0189(0xec)],'gateways':_0x49a1de[_0x2d0189(0xf6)]?JSON['parse'](_0x49a1de[_0x2d0189(0xf6)]):null,'gatewaySettings':_0x49a1de[_0x2d0189(0x100)]?JSON[_0x2d0189(0x114)](_0x49a1de[_0x2d0189(0x100)]):null,'publicKey':_0x49a1de[_0x2d0189(0xe8)],'wallets':{'usdtPolygonWallet':_0x49a1de['usdtPolygonWallet'],'usdtTrcWallet':_0x49a1de[_0x2d0189(0x112)],'usdtErcWallet':_0x49a1de[_0x2d0189(0x10f)],'usdcPolygonWallet':_0x49a1de[_0x2d0189(0x104)]},'status':_0x49a1de[_0x2d0189(0xf0)],'createdAt':_0x49a1de['createdAt']};}async[a55_0x749be9(0x108)](_0x40dd27){const _0x39074a=a55_0x749be9;await database_1[_0x39074a(0xe7)][_0x39074a(0x101)]['delete']({'where':{'id':_0x40dd27}});}}exports[a55_0x749be9(0x109)]=UserService;