'use strict';const a89_0x285454=a89_0x3358;function a89_0x3358(_0x4784d8,_0x19718b){_0x4784d8=_0x4784d8-0xf2;const _0x4646a8=a89_0x4646();let _0x33586a=_0x4646a8[_0x4784d8];return _0x33586a;}(function(_0x3a6180,_0x3b2d43){const _0x9fe6f4=a89_0x3358,_0x5aa170=_0x3a6180();while(!![]){try{const _0x316caf=parseInt(_0x9fe6f4(0xf7))/0x1+parseInt(_0x9fe6f4(0xfe))/0x2*(parseInt(_0x9fe6f4(0x107))/0x3)+parseInt(_0x9fe6f4(0x113))/0x4+parseInt(_0x9fe6f4(0x124))/0x5+-parseInt(_0x9fe6f4(0x11a))/0x6*(-parseInt(_0x9fe6f4(0x10b))/0x7)+-parseInt(_0x9fe6f4(0x12a))/0x8+-parseInt(_0x9fe6f4(0x122))/0x9*(parseInt(_0x9fe6f4(0x106))/0xa);if(_0x316caf===_0x3b2d43)break;else _0x5aa170['push'](_0x5aa170['shift']());}catch(_0x5ccd2c){_0x5aa170['push'](_0x5aa170['shift']());}}}(a89_0x4646,0xa71a6));var __importDefault=this&&this[a89_0x285454(0x11b)]||function(_0xb3e602){const _0x3e715c=a89_0x285454;return _0xb3e602&&_0xb3e602[_0x3e715c(0x104)]?_0xb3e602:{'default':_0xb3e602};};Object[a89_0x285454(0x11c)](exports,'__esModule',{'value':!![]}),exports['UserService']=void 0x0;const bcryptjs_1=__importDefault(require(a89_0x285454(0x119))),crypto_1=__importDefault(require(a89_0x285454(0xf5))),database_1=__importDefault(require(a89_0x285454(0xf8)));function a89_0x4646(){const _0x121dc3=['createdAt','telegram','getAllUsers','createUser','crypto','map','1286781yQzsRm','../config/database','merchantUrl','getUserById','status','parse','username','2346898neEzzh','Username\x20already\x20exists','merchantUrl2','usdtErcWallet','gateways','shopUrl2','__esModule','wallets','2670dJfYeR','3bruGcT','telegramId','pk_','findUnique','7246652UDAdwi','merchantUrl4','hash','shopUrl3','password','create','usdtPolygonWallet','publicKey','4828456VfJXcJ','generateApiKeys','usdtTrcWallet','gatewaySettings','stringify','update','bcryptjs','6ZEsJIi','__importDefault','defineProperty','fullName','findMany','ACTIVE','toString','UserService','120663tamsvm','merchantUrl3','1129155psTKUv','usdcPolygonWallet','hex','Telegram\x20username\x20already\x20exists','delete','paymentGateways','5314304EEjLiR','default','shopUrl4','shopUrl','randomBytes','shop','desc','name'];a89_0x4646=function(){return _0x121dc3;};return a89_0x4646();}class UserService{[a89_0x285454(0x114)](){const _0x11dfae=a89_0x285454,_0x5a6355=_0x11dfae(0x109)+crypto_1[_0x11dfae(0x12b)][_0x11dfae(0x12e)](0x20)[_0x11dfae(0x120)](_0x11dfae(0x126)),_0x47eaf1='sk_'+crypto_1[_0x11dfae(0x12b)][_0x11dfae(0x12e)](0x20)[_0x11dfae(0x120)](_0x11dfae(0x126));return{'publicKey':_0x5a6355,'secretKey':_0x47eaf1};}async[a89_0x285454(0xf4)](_0x34b8c1){const _0xb96f62=a89_0x285454,{fullName:_0x469aed,username:_0x5c7eac,password:_0x1715cb,telegramId:_0x1a5801,merchantUrl:_0x5781b6,gateways:_0x4ec2d9,gatewaySettings:_0x50c1fa,wallets:_0x3fe8c9}=_0x34b8c1,_0x17006c=await database_1[_0xb96f62(0x12b)]['shop'][_0xb96f62(0x10a)]({'where':{'username':_0x5c7eac}});if(_0x17006c)throw new Error(_0xb96f62(0xff));if(_0x1a5801){const _0x53684e=await database_1[_0xb96f62(0x12b)]['shop']['findUnique']({'where':{'telegram':_0x1a5801}});if(_0x53684e)throw new Error(_0xb96f62(0x127));}const _0x184ab8=await bcryptjs_1[_0xb96f62(0x12b)]['hash'](_0x1715cb,0xc),{publicKey:_0x5e485a,secretKey:_0x230051}=this['generateApiKeys'](),_0x41484d=await database_1[_0xb96f62(0x12b)][_0xb96f62(0x12f)][_0xb96f62(0x110)]({'data':{'name':_0x469aed,'username':_0x5c7eac,'password':_0x184ab8,'telegram':_0x1a5801,'shopUrl':_0x5781b6,'shopUrl2':_0x34b8c1[_0xb96f62(0x100)]||null,'shopUrl3':_0x34b8c1['merchantUrl3']||null,'shopUrl4':_0x34b8c1['merchantUrl4']||null,'paymentGateways':_0x4ec2d9?JSON[_0xb96f62(0x117)](_0x4ec2d9):null,'gatewaySettings':_0x50c1fa?JSON[_0xb96f62(0x117)](_0x50c1fa):null,'usdtPolygonWallet':_0x3fe8c9?.[_0xb96f62(0x111)]||null,'usdtTrcWallet':_0x3fe8c9?.[_0xb96f62(0x115)]||null,'usdtErcWallet':_0x3fe8c9?.['usdtErcWallet']||null,'usdcPolygonWallet':_0x3fe8c9?.['usdcPolygonWallet']||null,'publicKey':_0x5e485a,'secretKey':_0x230051,'status':_0xb96f62(0x11f)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'shopUrl2':!![],'shopUrl3':!![],'shopUrl4':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x41484d['id'],'fullName':_0x41484d[_0xb96f62(0x131)],'username':_0x41484d[_0xb96f62(0xfd)],'telegramId':_0x41484d[_0xb96f62(0xf2)],'merchantUrl':_0x41484d[_0xb96f62(0x12d)],'merchantUrl2':_0x41484d[_0xb96f62(0x103)],'merchantUrl3':_0x41484d[_0xb96f62(0x10e)],'merchantUrl4':_0x41484d[_0xb96f62(0x12c)],'gateways':_0x41484d['paymentGateways']?JSON[_0xb96f62(0xfc)](_0x41484d['paymentGateways']):null,'gatewaySettings':_0x41484d['gatewaySettings']?JSON[_0xb96f62(0xfc)](_0x41484d['gatewaySettings']):null,'publicKey':_0x41484d[_0xb96f62(0x112)],'wallets':{'usdtPolygonWallet':_0x41484d[_0xb96f62(0x111)],'usdtTrcWallet':_0x41484d[_0xb96f62(0x115)],'usdtErcWallet':_0x41484d[_0xb96f62(0x101)],'usdcPolygonWallet':_0x41484d[_0xb96f62(0x125)]},'status':_0x41484d[_0xb96f62(0xfb)],'createdAt':_0x41484d['createdAt']};}async[a89_0x285454(0xf3)](){const _0x45e3d9=a89_0x285454,_0x161564=await database_1[_0x45e3d9(0x12b)][_0x45e3d9(0x12f)][_0x45e3d9(0x11e)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'shopUrl2':!![],'shopUrl3':!![],'shopUrl4':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x45e3d9(0x130)}});return _0x161564[_0x45e3d9(0xf6)](_0x2365f7=>({'id':_0x2365f7['id'],'fullName':_0x2365f7[_0x45e3d9(0x131)],'username':_0x2365f7[_0x45e3d9(0xfd)],'telegramId':_0x2365f7[_0x45e3d9(0xf2)],'merchantUrl':_0x2365f7['shopUrl'],'merchantUrl2':_0x2365f7['shopUrl2'],'merchantUrl3':_0x2365f7['shopUrl3'],'merchantUrl4':_0x2365f7[_0x45e3d9(0x12c)],'gateways':_0x2365f7['paymentGateways']?JSON[_0x45e3d9(0xfc)](_0x2365f7[_0x45e3d9(0x129)]):null,'gatewaySettings':_0x2365f7[_0x45e3d9(0x116)]?JSON[_0x45e3d9(0xfc)](_0x2365f7[_0x45e3d9(0x116)]):null,'publicKey':_0x2365f7[_0x45e3d9(0x112)],'wallets':{'usdtPolygonWallet':_0x2365f7[_0x45e3d9(0x111)],'usdtTrcWallet':_0x2365f7[_0x45e3d9(0x115)],'usdtErcWallet':_0x2365f7['usdtErcWallet'],'usdcPolygonWallet':_0x2365f7[_0x45e3d9(0x125)]},'status':_0x2365f7[_0x45e3d9(0xfb)],'createdAt':_0x2365f7[_0x45e3d9(0x132)]}));}async[a89_0x285454(0xfa)](_0x1002de){const _0x117c2b=a89_0x285454,_0x356004=await database_1[_0x117c2b(0x12b)][_0x117c2b(0x12f)][_0x117c2b(0x10a)]({'where':{'id':_0x1002de},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'shopUrl2':!![],'shopUrl3':!![],'shopUrl4':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x356004)return null;return{'id':_0x356004['id'],'fullName':_0x356004[_0x117c2b(0x131)],'username':_0x356004[_0x117c2b(0xfd)],'telegramId':_0x356004[_0x117c2b(0xf2)],'merchantUrl':_0x356004[_0x117c2b(0x12d)],'merchantUrl2':_0x356004[_0x117c2b(0x103)],'merchantUrl3':_0x356004[_0x117c2b(0x10e)],'merchantUrl4':_0x356004['shopUrl4'],'gateways':_0x356004[_0x117c2b(0x129)]?JSON[_0x117c2b(0xfc)](_0x356004[_0x117c2b(0x129)]):null,'gatewaySettings':_0x356004[_0x117c2b(0x116)]?JSON['parse'](_0x356004[_0x117c2b(0x116)]):null,'publicKey':_0x356004[_0x117c2b(0x112)],'wallets':{'usdtPolygonWallet':_0x356004[_0x117c2b(0x111)],'usdtTrcWallet':_0x356004[_0x117c2b(0x115)],'usdtErcWallet':_0x356004['usdtErcWallet'],'usdcPolygonWallet':_0x356004[_0x117c2b(0x125)]},'status':_0x356004['status'],'createdAt':_0x356004[_0x117c2b(0x132)]};}async['updateUser'](_0x3b616e,_0x1c129e){const _0x2919ca=a89_0x285454,_0x47dcd1={..._0x1c129e};_0x1c129e[_0x2919ca(0x10f)]&&(_0x47dcd1['password']=await bcryptjs_1[_0x2919ca(0x12b)][_0x2919ca(0x10d)](_0x1c129e[_0x2919ca(0x10f)],0xc));_0x1c129e[_0x2919ca(0x11d)]&&(_0x47dcd1[_0x2919ca(0x131)]=_0x1c129e[_0x2919ca(0x11d)],delete _0x47dcd1['fullName']);_0x1c129e[_0x2919ca(0x108)]&&(_0x47dcd1['telegram']=_0x1c129e[_0x2919ca(0x108)],delete _0x47dcd1[_0x2919ca(0x108)]);_0x1c129e[_0x2919ca(0xf9)]&&(_0x47dcd1['shopUrl']=_0x1c129e['merchantUrl'],delete _0x47dcd1[_0x2919ca(0xf9)]);_0x1c129e[_0x2919ca(0x100)]!==undefined&&(_0x47dcd1['shopUrl2']=_0x1c129e[_0x2919ca(0x100)]||null,delete _0x47dcd1[_0x2919ca(0x100)]);_0x1c129e[_0x2919ca(0x123)]!==undefined&&(_0x47dcd1[_0x2919ca(0x10e)]=_0x1c129e[_0x2919ca(0x123)]||null,delete _0x47dcd1['merchantUrl3']);_0x1c129e['merchantUrl4']!==undefined&&(_0x47dcd1[_0x2919ca(0x12c)]=_0x1c129e[_0x2919ca(0x10c)]||null,delete _0x47dcd1[_0x2919ca(0x10c)]);_0x1c129e[_0x2919ca(0x102)]&&(_0x47dcd1[_0x2919ca(0x129)]=JSON[_0x2919ca(0x117)](_0x1c129e[_0x2919ca(0x102)]),delete _0x47dcd1['gateways']);_0x1c129e['gatewaySettings']&&(_0x47dcd1['gatewaySettings']=JSON[_0x2919ca(0x117)](_0x1c129e[_0x2919ca(0x116)]),delete _0x47dcd1['gatewaySettings']);_0x1c129e[_0x2919ca(0x105)]&&(_0x1c129e[_0x2919ca(0x105)]['usdtPolygonWallet']!==undefined&&(_0x47dcd1['usdtPolygonWallet']=_0x1c129e[_0x2919ca(0x105)][_0x2919ca(0x111)]||null),_0x1c129e[_0x2919ca(0x105)]['usdtTrcWallet']!==undefined&&(_0x47dcd1[_0x2919ca(0x115)]=_0x1c129e[_0x2919ca(0x105)][_0x2919ca(0x115)]||null),_0x1c129e[_0x2919ca(0x105)]['usdtErcWallet']!==undefined&&(_0x47dcd1['usdtErcWallet']=_0x1c129e[_0x2919ca(0x105)][_0x2919ca(0x101)]||null),_0x1c129e[_0x2919ca(0x105)][_0x2919ca(0x125)]!==undefined&&(_0x47dcd1[_0x2919ca(0x125)]=_0x1c129e[_0x2919ca(0x105)][_0x2919ca(0x125)]||null),delete _0x47dcd1[_0x2919ca(0x105)]);const _0x421725=await database_1[_0x2919ca(0x12b)][_0x2919ca(0x12f)][_0x2919ca(0x118)]({'where':{'id':_0x3b616e},'data':_0x47dcd1,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'shopUrl2':!![],'shopUrl3':!![],'shopUrl4':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x421725['id'],'fullName':_0x421725['name'],'username':_0x421725[_0x2919ca(0xfd)],'telegramId':_0x421725['telegram'],'merchantUrl':_0x421725[_0x2919ca(0x12d)],'merchantUrl2':_0x421725[_0x2919ca(0x103)],'merchantUrl3':_0x421725['shopUrl3'],'merchantUrl4':_0x421725[_0x2919ca(0x12c)],'gateways':_0x421725[_0x2919ca(0x129)]?JSON[_0x2919ca(0xfc)](_0x421725[_0x2919ca(0x129)]):null,'gatewaySettings':_0x421725['gatewaySettings']?JSON[_0x2919ca(0xfc)](_0x421725[_0x2919ca(0x116)]):null,'publicKey':_0x421725['publicKey'],'wallets':{'usdtPolygonWallet':_0x421725[_0x2919ca(0x111)],'usdtTrcWallet':_0x421725[_0x2919ca(0x115)],'usdtErcWallet':_0x421725[_0x2919ca(0x101)],'usdcPolygonWallet':_0x421725[_0x2919ca(0x125)]},'status':_0x421725[_0x2919ca(0xfb)],'createdAt':_0x421725[_0x2919ca(0x132)]};}async['deleteUser'](_0x261e48){const _0x72cdfc=a89_0x285454;await database_1[_0x72cdfc(0x12b)][_0x72cdfc(0x12f)][_0x72cdfc(0x128)]({'where':{'id':_0x261e48}});}}exports[a89_0x285454(0x121)]=UserService;