'use strict';const a51_0xa5caa9=a51_0x42b7;(function(_0x49bdd6,_0x71ddf7){const _0x4a4436=a51_0x42b7,_0x4ed6ea=_0x49bdd6();while(!![]){try{const _0x42bb17=parseInt(_0x4a4436(0x158))/0x1+-parseInt(_0x4a4436(0x160))/0x2+-parseInt(_0x4a4436(0x138))/0x3*(parseInt(_0x4a4436(0x142))/0x4)+-parseInt(_0x4a4436(0x143))/0x5+parseInt(_0x4a4436(0x144))/0x6+-parseInt(_0x4a4436(0x166))/0x7*(-parseInt(_0x4a4436(0x140))/0x8)+parseInt(_0x4a4436(0x14a))/0x9;if(_0x42bb17===_0x71ddf7)break;else _0x4ed6ea['push'](_0x4ed6ea['shift']());}catch(_0x12ab62){_0x4ed6ea['push'](_0x4ed6ea['shift']());}}}(a51_0x5c4b,0xd2f2f));var __importDefault=this&&this[a51_0xa5caa9(0x168)]||function(_0x5a19e8){const _0x3e3732=a51_0xa5caa9;return _0x5a19e8&&_0x5a19e8[_0x3e3732(0x14e)]?_0x5a19e8:{'default':_0x5a19e8};};function a51_0x5c4b(){const _0x553f0f=['defineProperty','hash','wallets','randomBytes','3107546VqWKIh','username','findUnique','crypto','fullName','default','1965817ZHdrtx','map','__importDefault','shopUrl','generateApiKeys','status','gateways','stringify','usdtErcWallet','toString','927660oUrVFB','bcryptjs','usdcPolygonWallet','hex','create','merchantUrl','delete','password','40eAtWKw','createdAt','4XDoRFA','6869450DDuaBH','4928880TATFAB','publicKey','paymentGateways','Telegram\x20username\x20already\x20exists','UserService','name','6849216thwSvi','update','parse','telegram','__esModule','getUserById','deleteUser','gatewaySettings','Username\x20already\x20exists','ACTIVE','pk_','sk_','usdtTrcWallet','usdtPolygonWallet','1114271ZbavpF','telegramId','getAllUsers','shop'];a51_0x5c4b=function(){return _0x553f0f;};return a51_0x5c4b();}Object[a51_0xa5caa9(0x15c)](exports,a51_0xa5caa9(0x14e),{'value':!![]}),exports[a51_0xa5caa9(0x148)]=void 0x0;const bcryptjs_1=__importDefault(require(a51_0xa5caa9(0x139))),crypto_1=__importDefault(require(a51_0xa5caa9(0x163))),database_1=__importDefault(require('../config/database'));function a51_0x42b7(_0x4b5cde,_0x53628a){const _0x5c4bbd=a51_0x5c4b();return a51_0x42b7=function(_0x42b777,_0x316d71){_0x42b777=_0x42b777-0x138;let _0x4bc62a=_0x5c4bbd[_0x42b777];return _0x4bc62a;},a51_0x42b7(_0x4b5cde,_0x53628a);}class UserService{[a51_0xa5caa9(0x16a)](){const _0x57f77b=a51_0xa5caa9,_0xf7cbed=_0x57f77b(0x154)+crypto_1[_0x57f77b(0x165)][_0x57f77b(0x15f)](0x20)[_0x57f77b(0x16f)]('hex'),_0x1b5ebe=_0x57f77b(0x155)+crypto_1['default'][_0x57f77b(0x15f)](0x20)['toString'](_0x57f77b(0x13b));return{'publicKey':_0xf7cbed,'secretKey':_0x1b5ebe};}async['createUser'](_0x26b4eb){const _0x339097=a51_0xa5caa9,{fullName:_0x11862a,username:_0x468beb,password:_0xe3a16d,telegramId:_0x3809b1,merchantUrl:_0x3b4778,gateways:_0xa1dafd,gatewaySettings:_0x59f8fa,wallets:_0x14b1a7}=_0x26b4eb,_0x3df7bc=await database_1[_0x339097(0x165)]['shop'][_0x339097(0x162)]({'where':{'username':_0x468beb}});if(_0x3df7bc)throw new Error(_0x339097(0x152));if(_0x3809b1){const _0x4c0459=await database_1[_0x339097(0x165)][_0x339097(0x15b)][_0x339097(0x162)]({'where':{'telegram':_0x3809b1}});if(_0x4c0459)throw new Error(_0x339097(0x147));}const _0x4c9314=await bcryptjs_1[_0x339097(0x165)]['hash'](_0xe3a16d,0xc),{publicKey:_0xca5689,secretKey:_0x2f6a4e}=this[_0x339097(0x16a)](),_0x33f824=await database_1[_0x339097(0x165)][_0x339097(0x15b)][_0x339097(0x13c)]({'data':{'name':_0x11862a,'username':_0x468beb,'password':_0x4c9314,'telegram':_0x3809b1,'shopUrl':_0x3b4778,'paymentGateways':_0xa1dafd?JSON[_0x339097(0x16d)](_0xa1dafd):null,'gatewaySettings':_0x59f8fa?JSON[_0x339097(0x16d)](_0x59f8fa):null,'usdtPolygonWallet':_0x14b1a7?.['usdtPolygonWallet']||null,'usdtTrcWallet':_0x14b1a7?.['usdtTrcWallet']||null,'usdtErcWallet':_0x14b1a7?.[_0x339097(0x16e)]||null,'usdcPolygonWallet':_0x14b1a7?.['usdcPolygonWallet']||null,'publicKey':_0xca5689,'secretKey':_0x2f6a4e,'status':_0x339097(0x153)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x33f824['id'],'fullName':_0x33f824[_0x339097(0x149)],'username':_0x33f824[_0x339097(0x161)],'telegramId':_0x33f824['telegram'],'merchantUrl':_0x33f824[_0x339097(0x169)],'gateways':_0x33f824[_0x339097(0x146)]?JSON[_0x339097(0x14c)](_0x33f824[_0x339097(0x146)]):null,'gatewaySettings':_0x33f824['gatewaySettings']?JSON[_0x339097(0x14c)](_0x33f824['gatewaySettings']):null,'publicKey':_0x33f824['publicKey'],'wallets':{'usdtPolygonWallet':_0x33f824[_0x339097(0x157)],'usdtTrcWallet':_0x33f824[_0x339097(0x156)],'usdtErcWallet':_0x33f824['usdtErcWallet'],'usdcPolygonWallet':_0x33f824[_0x339097(0x13a)]},'status':_0x33f824[_0x339097(0x16b)],'createdAt':_0x33f824[_0x339097(0x141)]};}async[a51_0xa5caa9(0x15a)](){const _0x14f32f=a51_0xa5caa9,_0x3e0f95=await database_1['default'][_0x14f32f(0x15b)]['findMany']({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':'desc'}});return _0x3e0f95[_0x14f32f(0x167)](_0x57d9f8=>({'id':_0x57d9f8['id'],'fullName':_0x57d9f8[_0x14f32f(0x149)],'username':_0x57d9f8[_0x14f32f(0x161)],'telegramId':_0x57d9f8[_0x14f32f(0x14d)],'merchantUrl':_0x57d9f8['shopUrl'],'gateways':_0x57d9f8[_0x14f32f(0x146)]?JSON[_0x14f32f(0x14c)](_0x57d9f8[_0x14f32f(0x146)]):null,'gatewaySettings':_0x57d9f8[_0x14f32f(0x151)]?JSON[_0x14f32f(0x14c)](_0x57d9f8[_0x14f32f(0x151)]):null,'publicKey':_0x57d9f8['publicKey'],'wallets':{'usdtPolygonWallet':_0x57d9f8['usdtPolygonWallet'],'usdtTrcWallet':_0x57d9f8[_0x14f32f(0x156)],'usdtErcWallet':_0x57d9f8[_0x14f32f(0x16e)],'usdcPolygonWallet':_0x57d9f8[_0x14f32f(0x13a)]},'status':_0x57d9f8[_0x14f32f(0x16b)],'createdAt':_0x57d9f8[_0x14f32f(0x141)]}));}async[a51_0xa5caa9(0x14f)](_0x5bfae3){const _0xd0b9d3=a51_0xa5caa9,_0x16cb22=await database_1['default'][_0xd0b9d3(0x15b)][_0xd0b9d3(0x162)]({'where':{'id':_0x5bfae3},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x16cb22)return null;return{'id':_0x16cb22['id'],'fullName':_0x16cb22['name'],'username':_0x16cb22['username'],'telegramId':_0x16cb22[_0xd0b9d3(0x14d)],'merchantUrl':_0x16cb22['shopUrl'],'gateways':_0x16cb22[_0xd0b9d3(0x146)]?JSON[_0xd0b9d3(0x14c)](_0x16cb22['paymentGateways']):null,'gatewaySettings':_0x16cb22[_0xd0b9d3(0x151)]?JSON[_0xd0b9d3(0x14c)](_0x16cb22[_0xd0b9d3(0x151)]):null,'publicKey':_0x16cb22[_0xd0b9d3(0x145)],'wallets':{'usdtPolygonWallet':_0x16cb22[_0xd0b9d3(0x157)],'usdtTrcWallet':_0x16cb22[_0xd0b9d3(0x156)],'usdtErcWallet':_0x16cb22[_0xd0b9d3(0x16e)],'usdcPolygonWallet':_0x16cb22[_0xd0b9d3(0x13a)]},'status':_0x16cb22[_0xd0b9d3(0x16b)],'createdAt':_0x16cb22[_0xd0b9d3(0x141)]};}async['updateUser'](_0x1e8245,_0x1bdc38){const _0x4338ec=a51_0xa5caa9,_0x550220={..._0x1bdc38};_0x1bdc38[_0x4338ec(0x13f)]&&(_0x550220[_0x4338ec(0x13f)]=await bcryptjs_1[_0x4338ec(0x165)][_0x4338ec(0x15d)](_0x1bdc38[_0x4338ec(0x13f)],0xc));_0x1bdc38[_0x4338ec(0x164)]&&(_0x550220['name']=_0x1bdc38[_0x4338ec(0x164)],delete _0x550220['fullName']);_0x1bdc38['telegramId']&&(_0x550220['telegram']=_0x1bdc38[_0x4338ec(0x159)],delete _0x550220['telegramId']);_0x1bdc38[_0x4338ec(0x13d)]&&(_0x550220[_0x4338ec(0x169)]=_0x1bdc38[_0x4338ec(0x13d)],delete _0x550220[_0x4338ec(0x13d)]);_0x1bdc38['gateways']&&(_0x550220[_0x4338ec(0x146)]=JSON[_0x4338ec(0x16d)](_0x1bdc38[_0x4338ec(0x16c)]),delete _0x550220[_0x4338ec(0x16c)]);_0x1bdc38['gatewaySettings']&&(_0x550220[_0x4338ec(0x151)]=JSON[_0x4338ec(0x16d)](_0x1bdc38[_0x4338ec(0x151)]),delete _0x550220[_0x4338ec(0x151)]);_0x1bdc38[_0x4338ec(0x15e)]&&(_0x1bdc38[_0x4338ec(0x15e)][_0x4338ec(0x157)]!==undefined&&(_0x550220['usdtPolygonWallet']=_0x1bdc38[_0x4338ec(0x15e)]['usdtPolygonWallet']||null),_0x1bdc38[_0x4338ec(0x15e)][_0x4338ec(0x156)]!==undefined&&(_0x550220['usdtTrcWallet']=_0x1bdc38[_0x4338ec(0x15e)]['usdtTrcWallet']||null),_0x1bdc38[_0x4338ec(0x15e)][_0x4338ec(0x16e)]!==undefined&&(_0x550220[_0x4338ec(0x16e)]=_0x1bdc38[_0x4338ec(0x15e)][_0x4338ec(0x16e)]||null),_0x1bdc38['wallets'][_0x4338ec(0x13a)]!==undefined&&(_0x550220['usdcPolygonWallet']=_0x1bdc38[_0x4338ec(0x15e)][_0x4338ec(0x13a)]||null),delete _0x550220['wallets']);const _0x36f1c0=await database_1[_0x4338ec(0x165)][_0x4338ec(0x15b)][_0x4338ec(0x14b)]({'where':{'id':_0x1e8245},'data':_0x550220,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x36f1c0['id'],'fullName':_0x36f1c0[_0x4338ec(0x149)],'username':_0x36f1c0[_0x4338ec(0x161)],'telegramId':_0x36f1c0['telegram'],'merchantUrl':_0x36f1c0['shopUrl'],'gateways':_0x36f1c0[_0x4338ec(0x146)]?JSON[_0x4338ec(0x14c)](_0x36f1c0['paymentGateways']):null,'gatewaySettings':_0x36f1c0['gatewaySettings']?JSON['parse'](_0x36f1c0[_0x4338ec(0x151)]):null,'publicKey':_0x36f1c0[_0x4338ec(0x145)],'wallets':{'usdtPolygonWallet':_0x36f1c0[_0x4338ec(0x157)],'usdtTrcWallet':_0x36f1c0[_0x4338ec(0x156)],'usdtErcWallet':_0x36f1c0['usdtErcWallet'],'usdcPolygonWallet':_0x36f1c0[_0x4338ec(0x13a)]},'status':_0x36f1c0['status'],'createdAt':_0x36f1c0[_0x4338ec(0x141)]};}async[a51_0xa5caa9(0x150)](_0x40c21f){const _0x264400=a51_0xa5caa9;await database_1[_0x264400(0x165)]['shop'][_0x264400(0x13e)]({'where':{'id':_0x40c21f}});}}exports[a51_0xa5caa9(0x148)]=UserService;