'use strict';const a56_0x24098d=a56_0x2248;(function(_0x45296f,_0x5a42ef){const _0x40fbeb=a56_0x2248,_0x24b307=_0x45296f();while(!![]){try{const _0x55703a=parseInt(_0x40fbeb(0x95))/0x1*(-parseInt(_0x40fbeb(0x82))/0x2)+parseInt(_0x40fbeb(0x85))/0x3+parseInt(_0x40fbeb(0x9e))/0x4*(parseInt(_0x40fbeb(0x70))/0x5)+-parseInt(_0x40fbeb(0x98))/0x6+-parseInt(_0x40fbeb(0xa1))/0x7*(parseInt(_0x40fbeb(0x75))/0x8)+-parseInt(_0x40fbeb(0x72))/0x9+parseInt(_0x40fbeb(0x8e))/0xa;if(_0x55703a===_0x5a42ef)break;else _0x24b307['push'](_0x24b307['shift']());}catch(_0x59a653){_0x24b307['push'](_0x24b307['shift']());}}}(a56_0x5943,0x38de7));var __importDefault=this&&this['__importDefault']||function(_0xe0b977){const _0xd5b2dc=a56_0x2248;return _0xe0b977&&_0xe0b977[_0xd5b2dc(0x6e)]?_0xe0b977:{'default':_0xe0b977};};Object['defineProperty'](exports,a56_0x24098d(0x6e),{'value':!![]}),exports[a56_0x24098d(0x81)]=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),crypto_1=__importDefault(require(a56_0x24098d(0x8d))),database_1=__importDefault(require(a56_0x24098d(0x7a)));function a56_0x5943(){const _0x462c10=['1444hmugnX','desc','usdtErcWallet','739416LcMXUX','telegramId','paymentGateways','map','createUser','default','893332PzRjGN','findUnique','username','24059gbQuOP','telegram','update','create','__esModule','randomBytes','5JUseLn','usdtPolygonWallet','3197619mXCQJn','findMany','hex','248rIlHWP','toString','usdtTrcWallet','gateways','generateApiKeys','../config/database','pk_','hash','wallets','ACTIVE','gatewaySettings','stringify','UserService','310HrIKQj','delete','shop','835089vkVuie','password','Telegram\x20username\x20already\x20exists','usdcPolygonWallet','deleteUser','getUserById','status','parse','crypto','5401330SKypgt','merchantUrl','publicKey','name','shopUrl','fullName','createdAt'];a56_0x5943=function(){return _0x462c10;};return a56_0x5943();}function a56_0x2248(_0x424b54,_0x5a1433){const _0x59434e=a56_0x5943();return a56_0x2248=function(_0x224839,_0x1389f9){_0x224839=_0x224839-0x6d;let _0x2ff99c=_0x59434e[_0x224839];return _0x2ff99c;},a56_0x2248(_0x424b54,_0x5a1433);}class UserService{[a56_0x24098d(0x79)](){const _0x338cfd=a56_0x24098d,_0x550aba=_0x338cfd(0x7b)+crypto_1['default'][_0x338cfd(0x6f)](0x20)[_0x338cfd(0x76)](_0x338cfd(0x74)),_0x4769ce='sk_'+crypto_1[_0x338cfd(0x9d)][_0x338cfd(0x6f)](0x20)[_0x338cfd(0x76)](_0x338cfd(0x74));return{'publicKey':_0x550aba,'secretKey':_0x4769ce};}async[a56_0x24098d(0x9c)](_0x2a5a31){const _0x1e2654=a56_0x24098d,{fullName:_0xc35a8e,username:_0x58c5ce,password:_0x4860fa,telegramId:_0x2bc433,merchantUrl:_0x4e0726,gateways:_0xb8b8d8,gatewaySettings:_0x34abcf,wallets:_0x4179c7}=_0x2a5a31,_0x5cc57c=await database_1['default'][_0x1e2654(0x84)][_0x1e2654(0x9f)]({'where':{'username':_0x58c5ce}});if(_0x5cc57c)throw new Error('Username\x20already\x20exists');if(_0x2bc433){const _0x2f14d2=await database_1[_0x1e2654(0x9d)][_0x1e2654(0x84)][_0x1e2654(0x9f)]({'where':{'telegram':_0x2bc433}});if(_0x2f14d2)throw new Error(_0x1e2654(0x87));}const _0x55e6d7=await bcryptjs_1['default'][_0x1e2654(0x7c)](_0x4860fa,0xc),{publicKey:_0x16ecae,secretKey:_0x484859}=this[_0x1e2654(0x79)](),_0x5ebdd1=await database_1[_0x1e2654(0x9d)][_0x1e2654(0x84)][_0x1e2654(0x6d)]({'data':{'name':_0xc35a8e,'username':_0x58c5ce,'password':_0x55e6d7,'telegram':_0x2bc433,'shopUrl':_0x4e0726,'paymentGateways':_0xb8b8d8?JSON[_0x1e2654(0x80)](_0xb8b8d8):null,'gatewaySettings':_0x34abcf?JSON[_0x1e2654(0x80)](_0x34abcf):null,'usdtPolygonWallet':_0x4179c7?.[_0x1e2654(0x71)]||null,'usdtTrcWallet':_0x4179c7?.[_0x1e2654(0x77)]||null,'usdtErcWallet':_0x4179c7?.['usdtErcWallet']||null,'usdcPolygonWallet':_0x4179c7?.[_0x1e2654(0x88)]||null,'publicKey':_0x16ecae,'secretKey':_0x484859,'status':_0x1e2654(0x7e)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x5ebdd1['id'],'fullName':_0x5ebdd1[_0x1e2654(0x91)],'username':_0x5ebdd1[_0x1e2654(0xa0)],'telegramId':_0x5ebdd1[_0x1e2654(0xa2)],'merchantUrl':_0x5ebdd1[_0x1e2654(0x92)],'gateways':_0x5ebdd1[_0x1e2654(0x9a)]?JSON[_0x1e2654(0x8c)](_0x5ebdd1[_0x1e2654(0x9a)]):null,'gatewaySettings':_0x5ebdd1[_0x1e2654(0x7f)]?JSON['parse'](_0x5ebdd1['gatewaySettings']):null,'publicKey':_0x5ebdd1['publicKey'],'wallets':{'usdtPolygonWallet':_0x5ebdd1[_0x1e2654(0x71)],'usdtTrcWallet':_0x5ebdd1[_0x1e2654(0x77)],'usdtErcWallet':_0x5ebdd1[_0x1e2654(0x97)],'usdcPolygonWallet':_0x5ebdd1[_0x1e2654(0x88)]},'status':_0x5ebdd1['status'],'createdAt':_0x5ebdd1[_0x1e2654(0x94)]};}async['getAllUsers'](){const _0x26791b=a56_0x24098d,_0x4a2ffc=await database_1[_0x26791b(0x9d)][_0x26791b(0x84)][_0x26791b(0x73)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x26791b(0x96)}});return _0x4a2ffc[_0x26791b(0x9b)](_0x3a4ceb=>({'id':_0x3a4ceb['id'],'fullName':_0x3a4ceb[_0x26791b(0x91)],'username':_0x3a4ceb[_0x26791b(0xa0)],'telegramId':_0x3a4ceb['telegram'],'merchantUrl':_0x3a4ceb[_0x26791b(0x92)],'gateways':_0x3a4ceb['paymentGateways']?JSON[_0x26791b(0x8c)](_0x3a4ceb[_0x26791b(0x9a)]):null,'gatewaySettings':_0x3a4ceb[_0x26791b(0x7f)]?JSON[_0x26791b(0x8c)](_0x3a4ceb['gatewaySettings']):null,'publicKey':_0x3a4ceb[_0x26791b(0x90)],'wallets':{'usdtPolygonWallet':_0x3a4ceb['usdtPolygonWallet'],'usdtTrcWallet':_0x3a4ceb[_0x26791b(0x77)],'usdtErcWallet':_0x3a4ceb[_0x26791b(0x97)],'usdcPolygonWallet':_0x3a4ceb[_0x26791b(0x88)]},'status':_0x3a4ceb[_0x26791b(0x8b)],'createdAt':_0x3a4ceb[_0x26791b(0x94)]}));}async[a56_0x24098d(0x8a)](_0x5b399b){const _0xb55272=a56_0x24098d,_0xfdd0e5=await database_1[_0xb55272(0x9d)][_0xb55272(0x84)]['findUnique']({'where':{'id':_0x5b399b},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0xfdd0e5)return null;return{'id':_0xfdd0e5['id'],'fullName':_0xfdd0e5[_0xb55272(0x91)],'username':_0xfdd0e5[_0xb55272(0xa0)],'telegramId':_0xfdd0e5[_0xb55272(0xa2)],'merchantUrl':_0xfdd0e5['shopUrl'],'gateways':_0xfdd0e5[_0xb55272(0x9a)]?JSON[_0xb55272(0x8c)](_0xfdd0e5[_0xb55272(0x9a)]):null,'gatewaySettings':_0xfdd0e5[_0xb55272(0x7f)]?JSON['parse'](_0xfdd0e5['gatewaySettings']):null,'publicKey':_0xfdd0e5['publicKey'],'wallets':{'usdtPolygonWallet':_0xfdd0e5[_0xb55272(0x71)],'usdtTrcWallet':_0xfdd0e5['usdtTrcWallet'],'usdtErcWallet':_0xfdd0e5[_0xb55272(0x97)],'usdcPolygonWallet':_0xfdd0e5['usdcPolygonWallet']},'status':_0xfdd0e5[_0xb55272(0x8b)],'createdAt':_0xfdd0e5[_0xb55272(0x94)]};}async['updateUser'](_0x7e6c7f,_0x51978e){const _0x55bf37=a56_0x24098d,_0x6460d1={..._0x51978e};_0x51978e[_0x55bf37(0x86)]&&(_0x6460d1[_0x55bf37(0x86)]=await bcryptjs_1['default'][_0x55bf37(0x7c)](_0x51978e[_0x55bf37(0x86)],0xc));_0x51978e[_0x55bf37(0x93)]&&(_0x6460d1['name']=_0x51978e[_0x55bf37(0x93)],delete _0x6460d1[_0x55bf37(0x93)]);_0x51978e['telegramId']&&(_0x6460d1[_0x55bf37(0xa2)]=_0x51978e[_0x55bf37(0x99)],delete _0x6460d1[_0x55bf37(0x99)]);_0x51978e[_0x55bf37(0x8f)]&&(_0x6460d1['shopUrl']=_0x51978e[_0x55bf37(0x8f)],delete _0x6460d1[_0x55bf37(0x8f)]);_0x51978e[_0x55bf37(0x78)]&&(_0x6460d1[_0x55bf37(0x9a)]=JSON[_0x55bf37(0x80)](_0x51978e['gateways']),delete _0x6460d1[_0x55bf37(0x78)]);_0x51978e[_0x55bf37(0x7f)]&&(_0x6460d1['gatewaySettings']=JSON[_0x55bf37(0x80)](_0x51978e[_0x55bf37(0x7f)]),delete _0x6460d1[_0x55bf37(0x7f)]);_0x51978e['wallets']&&(_0x51978e[_0x55bf37(0x7d)][_0x55bf37(0x71)]!==undefined&&(_0x6460d1[_0x55bf37(0x71)]=_0x51978e[_0x55bf37(0x7d)]['usdtPolygonWallet']||null),_0x51978e[_0x55bf37(0x7d)][_0x55bf37(0x77)]!==undefined&&(_0x6460d1[_0x55bf37(0x77)]=_0x51978e[_0x55bf37(0x7d)][_0x55bf37(0x77)]||null),_0x51978e[_0x55bf37(0x7d)][_0x55bf37(0x97)]!==undefined&&(_0x6460d1[_0x55bf37(0x97)]=_0x51978e[_0x55bf37(0x7d)]['usdtErcWallet']||null),_0x51978e['wallets']['usdcPolygonWallet']!==undefined&&(_0x6460d1['usdcPolygonWallet']=_0x51978e[_0x55bf37(0x7d)][_0x55bf37(0x88)]||null),delete _0x6460d1[_0x55bf37(0x7d)]);const _0x127694=await database_1['default'][_0x55bf37(0x84)][_0x55bf37(0xa3)]({'where':{'id':_0x7e6c7f},'data':_0x6460d1,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x127694['id'],'fullName':_0x127694[_0x55bf37(0x91)],'username':_0x127694[_0x55bf37(0xa0)],'telegramId':_0x127694[_0x55bf37(0xa2)],'merchantUrl':_0x127694[_0x55bf37(0x92)],'gateways':_0x127694[_0x55bf37(0x9a)]?JSON[_0x55bf37(0x8c)](_0x127694[_0x55bf37(0x9a)]):null,'gatewaySettings':_0x127694[_0x55bf37(0x7f)]?JSON[_0x55bf37(0x8c)](_0x127694[_0x55bf37(0x7f)]):null,'publicKey':_0x127694[_0x55bf37(0x90)],'wallets':{'usdtPolygonWallet':_0x127694[_0x55bf37(0x71)],'usdtTrcWallet':_0x127694['usdtTrcWallet'],'usdtErcWallet':_0x127694[_0x55bf37(0x97)],'usdcPolygonWallet':_0x127694['usdcPolygonWallet']},'status':_0x127694[_0x55bf37(0x8b)],'createdAt':_0x127694[_0x55bf37(0x94)]};}async[a56_0x24098d(0x89)](_0x177f84){const _0x3e6f81=a56_0x24098d;await database_1['default'][_0x3e6f81(0x84)][_0x3e6f81(0x83)]({'where':{'id':_0x177f84}});}}exports['UserService']=UserService;