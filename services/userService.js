'use strict';const a59_0x1bf3fc=a59_0x5bcf;(function(_0x4f8f80,_0x10da47){const _0x503a85=a59_0x5bcf,_0x4c8503=_0x4f8f80();while(!![]){try{const _0x249736=-parseInt(_0x503a85(0x1bd))/0x1*(-parseInt(_0x503a85(0x1b1))/0x2)+parseInt(_0x503a85(0x18e))/0x3+-parseInt(_0x503a85(0x1a6))/0x4+-parseInt(_0x503a85(0x193))/0x5*(-parseInt(_0x503a85(0x1c3))/0x6)+-parseInt(_0x503a85(0x1c2))/0x7*(parseInt(_0x503a85(0x1ab))/0x8)+-parseInt(_0x503a85(0x1af))/0x9+-parseInt(_0x503a85(0x1a7))/0xa;if(_0x249736===_0x10da47)break;else _0x4c8503['push'](_0x4c8503['shift']());}catch(_0x50ab35){_0x4c8503['push'](_0x4c8503['shift']());}}}(a59_0x53ea,0x7f321));var __importDefault=this&&this[a59_0x1bf3fc(0x19a)]||function(_0x490658){return _0x490658&&_0x490658['__esModule']?_0x490658:{'default':_0x490658};};Object[a59_0x1bf3fc(0x19f)](exports,a59_0x1bf3fc(0x194),{'value':!![]}),exports[a59_0x1bf3fc(0x1b6)]=void 0x0;const bcryptjs_1=__importDefault(require(a59_0x1bf3fc(0x1bc))),crypto_1=__importDefault(require(a59_0x1bf3fc(0x197))),database_1=__importDefault(require(a59_0x1bf3fc(0x1ad)));function a59_0x53ea(){const _0x47cf65=['824058SJEfxW','shop','name','findUnique','Username\x20already\x20exists','3240tAEvtH','__esModule','password','createdAt','crypto','merchantUrl','shopUrl','__importDefault','sk_','usdtTrcWallet','gateways','usdcPolygonWallet','defineProperty','getUserById','usdtPolygonWallet','createUser','gatewaySettings','paymentGateways','username','1216612LJleml','1916020lrrjQj','deleteUser','toString','fullName','31016bGoafC','ACTIVE','../config/database','desc','1462140hqqecc','update','103694QvUvTP','pk_','Telegram\x20username\x20already\x20exists','delete','telegramId','UserService','parse','map','default','telegram','status','bcryptjs','11txNJmr','hex','publicKey','create','findMany','721aoeRCC','6792Zlyiwx','wallets','usdtErcWallet','hash','stringify'];a59_0x53ea=function(){return _0x47cf65;};return a59_0x53ea();}class UserService{['generateApiKeys'](){const _0x545d35=a59_0x1bf3fc,_0x37c847=_0x545d35(0x1b2)+crypto_1[_0x545d35(0x1b9)]['randomBytes'](0x20)[_0x545d35(0x1a9)](_0x545d35(0x1be)),_0x56d4f6=_0x545d35(0x19b)+crypto_1[_0x545d35(0x1b9)]['randomBytes'](0x20)[_0x545d35(0x1a9)](_0x545d35(0x1be));return{'publicKey':_0x37c847,'secretKey':_0x56d4f6};}async[a59_0x1bf3fc(0x1a2)](_0x28fa94){const _0x1ac521=a59_0x1bf3fc,{fullName:_0xdc38b1,username:_0x566081,password:_0x171636,telegramId:_0x503503,merchantUrl:_0x489019,gateways:_0xc13d58,gatewaySettings:_0x36e47e,wallets:_0x570170}=_0x28fa94,_0x3def80=await database_1[_0x1ac521(0x1b9)][_0x1ac521(0x18f)]['findUnique']({'where':{'username':_0x566081}});if(_0x3def80)throw new Error(_0x1ac521(0x192));if(_0x503503){const _0x90bfb6=await database_1['default'][_0x1ac521(0x18f)]['findUnique']({'where':{'telegram':_0x503503}});if(_0x90bfb6)throw new Error(_0x1ac521(0x1b3));}const _0x5018f4=await bcryptjs_1[_0x1ac521(0x1b9)][_0x1ac521(0x1c6)](_0x171636,0xc),{publicKey:_0xa99ddb,secretKey:_0x49fda0}=this['generateApiKeys'](),_0x3cd0e9=await database_1[_0x1ac521(0x1b9)][_0x1ac521(0x18f)][_0x1ac521(0x1c0)]({'data':{'name':_0xdc38b1,'username':_0x566081,'password':_0x5018f4,'telegram':_0x503503,'shopUrl':_0x489019,'paymentGateways':_0xc13d58?JSON[_0x1ac521(0x1c7)](_0xc13d58):null,'gatewaySettings':_0x36e47e?JSON[_0x1ac521(0x1c7)](_0x36e47e):null,'usdtPolygonWallet':_0x570170?.['usdtPolygonWallet']||null,'usdtTrcWallet':_0x570170?.['usdtTrcWallet']||null,'usdtErcWallet':_0x570170?.[_0x1ac521(0x1c5)]||null,'usdcPolygonWallet':_0x570170?.[_0x1ac521(0x19e)]||null,'publicKey':_0xa99ddb,'secretKey':_0x49fda0,'status':_0x1ac521(0x1ac)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x3cd0e9['id'],'fullName':_0x3cd0e9['name'],'username':_0x3cd0e9['username'],'telegramId':_0x3cd0e9[_0x1ac521(0x1ba)],'merchantUrl':_0x3cd0e9[_0x1ac521(0x199)],'gateways':_0x3cd0e9[_0x1ac521(0x1a4)]?JSON[_0x1ac521(0x1b7)](_0x3cd0e9['paymentGateways']):null,'gatewaySettings':_0x3cd0e9['gatewaySettings']?JSON[_0x1ac521(0x1b7)](_0x3cd0e9[_0x1ac521(0x1a3)]):null,'publicKey':_0x3cd0e9[_0x1ac521(0x1bf)],'wallets':{'usdtPolygonWallet':_0x3cd0e9['usdtPolygonWallet'],'usdtTrcWallet':_0x3cd0e9[_0x1ac521(0x19c)],'usdtErcWallet':_0x3cd0e9[_0x1ac521(0x1c5)],'usdcPolygonWallet':_0x3cd0e9[_0x1ac521(0x19e)]},'status':_0x3cd0e9['status'],'createdAt':_0x3cd0e9[_0x1ac521(0x196)]};}async['getAllUsers'](){const _0x5373be=a59_0x1bf3fc,_0x3913f8=await database_1[_0x5373be(0x1b9)]['shop'][_0x5373be(0x1c1)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x5373be(0x1ae)}});return _0x3913f8[_0x5373be(0x1b8)](_0x19833e=>({'id':_0x19833e['id'],'fullName':_0x19833e[_0x5373be(0x190)],'username':_0x19833e[_0x5373be(0x1a5)],'telegramId':_0x19833e[_0x5373be(0x1ba)],'merchantUrl':_0x19833e['shopUrl'],'gateways':_0x19833e[_0x5373be(0x1a4)]?JSON[_0x5373be(0x1b7)](_0x19833e[_0x5373be(0x1a4)]):null,'gatewaySettings':_0x19833e[_0x5373be(0x1a3)]?JSON['parse'](_0x19833e[_0x5373be(0x1a3)]):null,'publicKey':_0x19833e[_0x5373be(0x1bf)],'wallets':{'usdtPolygonWallet':_0x19833e['usdtPolygonWallet'],'usdtTrcWallet':_0x19833e['usdtTrcWallet'],'usdtErcWallet':_0x19833e[_0x5373be(0x1c5)],'usdcPolygonWallet':_0x19833e[_0x5373be(0x19e)]},'status':_0x19833e[_0x5373be(0x1bb)],'createdAt':_0x19833e[_0x5373be(0x196)]}));}async[a59_0x1bf3fc(0x1a0)](_0x332ea7){const _0x53e07e=a59_0x1bf3fc,_0x42ea0d=await database_1['default']['shop'][_0x53e07e(0x191)]({'where':{'id':_0x332ea7},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x42ea0d)return null;return{'id':_0x42ea0d['id'],'fullName':_0x42ea0d[_0x53e07e(0x190)],'username':_0x42ea0d['username'],'telegramId':_0x42ea0d['telegram'],'merchantUrl':_0x42ea0d['shopUrl'],'gateways':_0x42ea0d['paymentGateways']?JSON[_0x53e07e(0x1b7)](_0x42ea0d[_0x53e07e(0x1a4)]):null,'gatewaySettings':_0x42ea0d['gatewaySettings']?JSON['parse'](_0x42ea0d[_0x53e07e(0x1a3)]):null,'publicKey':_0x42ea0d['publicKey'],'wallets':{'usdtPolygonWallet':_0x42ea0d[_0x53e07e(0x1a1)],'usdtTrcWallet':_0x42ea0d[_0x53e07e(0x19c)],'usdtErcWallet':_0x42ea0d[_0x53e07e(0x1c5)],'usdcPolygonWallet':_0x42ea0d[_0x53e07e(0x19e)]},'status':_0x42ea0d[_0x53e07e(0x1bb)],'createdAt':_0x42ea0d[_0x53e07e(0x196)]};}async['updateUser'](_0x306678,_0x2167ea){const _0x9501be=a59_0x1bf3fc,_0xe51c34={..._0x2167ea};_0x2167ea[_0x9501be(0x195)]&&(_0xe51c34[_0x9501be(0x195)]=await bcryptjs_1[_0x9501be(0x1b9)][_0x9501be(0x1c6)](_0x2167ea[_0x9501be(0x195)],0xc));_0x2167ea[_0x9501be(0x1aa)]&&(_0xe51c34[_0x9501be(0x190)]=_0x2167ea[_0x9501be(0x1aa)],delete _0xe51c34[_0x9501be(0x1aa)]);_0x2167ea[_0x9501be(0x1b5)]&&(_0xe51c34[_0x9501be(0x1ba)]=_0x2167ea[_0x9501be(0x1b5)],delete _0xe51c34['telegramId']);_0x2167ea[_0x9501be(0x198)]&&(_0xe51c34[_0x9501be(0x199)]=_0x2167ea[_0x9501be(0x198)],delete _0xe51c34[_0x9501be(0x198)]);_0x2167ea['gateways']&&(_0xe51c34['paymentGateways']=JSON['stringify'](_0x2167ea[_0x9501be(0x19d)]),delete _0xe51c34[_0x9501be(0x19d)]);_0x2167ea[_0x9501be(0x1a3)]&&(_0xe51c34[_0x9501be(0x1a3)]=JSON[_0x9501be(0x1c7)](_0x2167ea[_0x9501be(0x1a3)]),delete _0xe51c34[_0x9501be(0x1a3)]);_0x2167ea[_0x9501be(0x1c4)]&&(_0x2167ea[_0x9501be(0x1c4)][_0x9501be(0x1a1)]!==undefined&&(_0xe51c34[_0x9501be(0x1a1)]=_0x2167ea[_0x9501be(0x1c4)][_0x9501be(0x1a1)]||null),_0x2167ea[_0x9501be(0x1c4)][_0x9501be(0x19c)]!==undefined&&(_0xe51c34[_0x9501be(0x19c)]=_0x2167ea[_0x9501be(0x1c4)][_0x9501be(0x19c)]||null),_0x2167ea[_0x9501be(0x1c4)][_0x9501be(0x1c5)]!==undefined&&(_0xe51c34[_0x9501be(0x1c5)]=_0x2167ea['wallets'][_0x9501be(0x1c5)]||null),_0x2167ea[_0x9501be(0x1c4)]['usdcPolygonWallet']!==undefined&&(_0xe51c34[_0x9501be(0x19e)]=_0x2167ea[_0x9501be(0x1c4)][_0x9501be(0x19e)]||null),delete _0xe51c34[_0x9501be(0x1c4)]);const _0x370973=await database_1[_0x9501be(0x1b9)][_0x9501be(0x18f)][_0x9501be(0x1b0)]({'where':{'id':_0x306678},'data':_0xe51c34,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x370973['id'],'fullName':_0x370973[_0x9501be(0x190)],'username':_0x370973[_0x9501be(0x1a5)],'telegramId':_0x370973[_0x9501be(0x1ba)],'merchantUrl':_0x370973[_0x9501be(0x199)],'gateways':_0x370973[_0x9501be(0x1a4)]?JSON[_0x9501be(0x1b7)](_0x370973['paymentGateways']):null,'gatewaySettings':_0x370973['gatewaySettings']?JSON[_0x9501be(0x1b7)](_0x370973[_0x9501be(0x1a3)]):null,'publicKey':_0x370973['publicKey'],'wallets':{'usdtPolygonWallet':_0x370973[_0x9501be(0x1a1)],'usdtTrcWallet':_0x370973[_0x9501be(0x19c)],'usdtErcWallet':_0x370973['usdtErcWallet'],'usdcPolygonWallet':_0x370973[_0x9501be(0x19e)]},'status':_0x370973['status'],'createdAt':_0x370973[_0x9501be(0x196)]};}async[a59_0x1bf3fc(0x1a8)](_0x251d8b){const _0x36a442=a59_0x1bf3fc;await database_1[_0x36a442(0x1b9)]['shop'][_0x36a442(0x1b4)]({'where':{'id':_0x251d8b}});}}function a59_0x5bcf(_0x1ced25,_0x12caaf){const _0x53ea4d=a59_0x53ea();return a59_0x5bcf=function(_0x5bcf90,_0xc4797b){_0x5bcf90=_0x5bcf90-0x18e;let _0x2f993b=_0x53ea4d[_0x5bcf90];return _0x2f993b;},a59_0x5bcf(_0x1ced25,_0x12caaf);}exports[a59_0x1bf3fc(0x1b6)]=UserService;