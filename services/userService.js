'use strict';const a56_0x4fc759=a56_0x5e3d;(function(_0x1bb6cc,_0x59a8d7){const _0x39ea5c=a56_0x5e3d,_0x57060e=_0x1bb6cc();while(!![]){try{const _0x1a1aa6=parseInt(_0x39ea5c(0x144))/0x1+-parseInt(_0x39ea5c(0x156))/0x2+parseInt(_0x39ea5c(0x13c))/0x3*(-parseInt(_0x39ea5c(0x159))/0x4)+-parseInt(_0x39ea5c(0x138))/0x5*(parseInt(_0x39ea5c(0x15d))/0x6)+-parseInt(_0x39ea5c(0x161))/0x7*(-parseInt(_0x39ea5c(0x14d))/0x8)+-parseInt(_0x39ea5c(0x13f))/0x9*(parseInt(_0x39ea5c(0x13b))/0xa)+parseInt(_0x39ea5c(0x14f))/0xb*(parseInt(_0x39ea5c(0x140))/0xc);if(_0x1a1aa6===_0x59a8d7)break;else _0x57060e['push'](_0x57060e['shift']());}catch(_0x2f8344){_0x57060e['push'](_0x57060e['shift']());}}}(a56_0x4c67,0xbbe8b));var __importDefault=this&&this['__importDefault']||function(_0x1dae72){const _0x453265=a56_0x5e3d;return _0x1dae72&&_0x1dae72[_0x453265(0x139)]?_0x1dae72:{'default':_0x1dae72};};function a56_0x5e3d(_0x1d2530,_0x301645){const _0x4c6740=a56_0x4c67();return a56_0x5e3d=function(_0x5e3d18,_0x1ae29d){_0x5e3d18=_0x5e3d18-0x130;let _0x24a3f4=_0x4c6740[_0x5e3d18];return _0x24a3f4;},a56_0x5e3d(_0x1d2530,_0x301645);}Object[a56_0x4fc759(0x15e)](exports,'__esModule',{'value':!![]}),exports[a56_0x4fc759(0x163)]=void 0x0;const bcryptjs_1=__importDefault(require(a56_0x4fc759(0x167))),crypto_1=__importDefault(require(a56_0x4fc759(0x164))),database_1=__importDefault(require(a56_0x4fc759(0x14a)));function a56_0x4c67(){const _0x5a7957=['shop','gatewaySettings','ACTIVE','generateApiKeys','update','shopUrl','950384olScNF','merchantUrl','findUnique','128FXVRUA','telegramId','username','desc','12wdNNSQ','defineProperty','toString','Username\x20already\x20exists','148169MUXhWy','hash','UserService','crypto','wallets','stringify','bcryptjs','name','usdcPolygonWallet','getUserById','parse','sk_','getAllUsers','pk_','delete','gateways','create','hex','password','1411750lLAxCT','__esModule','telegram','70DRnAol','92208lHeBQr','paymentGateways','default','1230282uEBhHH','96XAScrb','fullName','status','publicKey','1107657aDAEaW','Telegram\x20username\x20already\x20exists','deleteUser','usdtErcWallet','findMany','usdtPolygonWallet','../config/database','usdtTrcWallet','createdAt','224ryaxar','randomBytes','2818299HbDHEA'];a56_0x4c67=function(){return _0x5a7957;};return a56_0x4c67();}class UserService{[a56_0x4fc759(0x153)](){const _0x317a9a=a56_0x4fc759,_0xbd8567=_0x317a9a(0x132)+crypto_1[_0x317a9a(0x13e)][_0x317a9a(0x14e)](0x20)[_0x317a9a(0x15f)](_0x317a9a(0x136)),_0xa91b5e=_0x317a9a(0x130)+crypto_1[_0x317a9a(0x13e)][_0x317a9a(0x14e)](0x20)[_0x317a9a(0x15f)]('hex');return{'publicKey':_0xbd8567,'secretKey':_0xa91b5e};}async['createUser'](_0x5725e4){const _0x4e96fc=a56_0x4fc759,{fullName:_0x6f2ea3,username:_0x4688da,password:_0x20cd48,telegramId:_0x469773,merchantUrl:_0x3c41ab,gateways:_0x56a83f,gatewaySettings:_0x236645,wallets:_0x4ea054}=_0x5725e4,_0x54b23b=await database_1[_0x4e96fc(0x13e)][_0x4e96fc(0x150)]['findUnique']({'where':{'username':_0x4688da}});if(_0x54b23b)throw new Error(_0x4e96fc(0x160));if(_0x469773){const _0x37d9b0=await database_1[_0x4e96fc(0x13e)][_0x4e96fc(0x150)][_0x4e96fc(0x158)]({'where':{'telegram':_0x469773}});if(_0x37d9b0)throw new Error(_0x4e96fc(0x145));}const _0x25ac99=await bcryptjs_1[_0x4e96fc(0x13e)][_0x4e96fc(0x162)](_0x20cd48,0xc),{publicKey:_0x1f940a,secretKey:_0x38ab09}=this['generateApiKeys'](),_0x5275b1=await database_1[_0x4e96fc(0x13e)][_0x4e96fc(0x150)][_0x4e96fc(0x135)]({'data':{'name':_0x6f2ea3,'username':_0x4688da,'password':_0x25ac99,'telegram':_0x469773,'shopUrl':_0x3c41ab,'paymentGateways':_0x56a83f?JSON['stringify'](_0x56a83f):null,'gatewaySettings':_0x236645?JSON[_0x4e96fc(0x166)](_0x236645):null,'usdtPolygonWallet':_0x4ea054?.[_0x4e96fc(0x149)]||null,'usdtTrcWallet':_0x4ea054?.[_0x4e96fc(0x14b)]||null,'usdtErcWallet':_0x4ea054?.[_0x4e96fc(0x147)]||null,'usdcPolygonWallet':_0x4ea054?.['usdcPolygonWallet']||null,'publicKey':_0x1f940a,'secretKey':_0x38ab09,'status':_0x4e96fc(0x152)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x5275b1['id'],'fullName':_0x5275b1[_0x4e96fc(0x168)],'username':_0x5275b1[_0x4e96fc(0x15b)],'telegramId':_0x5275b1[_0x4e96fc(0x13a)],'merchantUrl':_0x5275b1['shopUrl'],'gateways':_0x5275b1['paymentGateways']?JSON[_0x4e96fc(0x16b)](_0x5275b1['paymentGateways']):null,'gatewaySettings':_0x5275b1[_0x4e96fc(0x151)]?JSON[_0x4e96fc(0x16b)](_0x5275b1[_0x4e96fc(0x151)]):null,'publicKey':_0x5275b1[_0x4e96fc(0x143)],'wallets':{'usdtPolygonWallet':_0x5275b1['usdtPolygonWallet'],'usdtTrcWallet':_0x5275b1[_0x4e96fc(0x14b)],'usdtErcWallet':_0x5275b1[_0x4e96fc(0x147)],'usdcPolygonWallet':_0x5275b1[_0x4e96fc(0x169)]},'status':_0x5275b1[_0x4e96fc(0x142)],'createdAt':_0x5275b1[_0x4e96fc(0x14c)]};}async[a56_0x4fc759(0x131)](){const _0x28c4ee=a56_0x4fc759,_0x682fe1=await database_1[_0x28c4ee(0x13e)][_0x28c4ee(0x150)][_0x28c4ee(0x148)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x28c4ee(0x15c)}});return _0x682fe1['map'](_0x365ba3=>({'id':_0x365ba3['id'],'fullName':_0x365ba3[_0x28c4ee(0x168)],'username':_0x365ba3[_0x28c4ee(0x15b)],'telegramId':_0x365ba3[_0x28c4ee(0x13a)],'merchantUrl':_0x365ba3[_0x28c4ee(0x155)],'gateways':_0x365ba3['paymentGateways']?JSON[_0x28c4ee(0x16b)](_0x365ba3['paymentGateways']):null,'gatewaySettings':_0x365ba3[_0x28c4ee(0x151)]?JSON[_0x28c4ee(0x16b)](_0x365ba3[_0x28c4ee(0x151)]):null,'publicKey':_0x365ba3['publicKey'],'wallets':{'usdtPolygonWallet':_0x365ba3['usdtPolygonWallet'],'usdtTrcWallet':_0x365ba3[_0x28c4ee(0x14b)],'usdtErcWallet':_0x365ba3[_0x28c4ee(0x147)],'usdcPolygonWallet':_0x365ba3[_0x28c4ee(0x169)]},'status':_0x365ba3['status'],'createdAt':_0x365ba3['createdAt']}));}async[a56_0x4fc759(0x16a)](_0x110231){const _0x3550b3=a56_0x4fc759,_0x1fcc8d=await database_1[_0x3550b3(0x13e)][_0x3550b3(0x150)][_0x3550b3(0x158)]({'where':{'id':_0x110231},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x1fcc8d)return null;return{'id':_0x1fcc8d['id'],'fullName':_0x1fcc8d['name'],'username':_0x1fcc8d['username'],'telegramId':_0x1fcc8d['telegram'],'merchantUrl':_0x1fcc8d['shopUrl'],'gateways':_0x1fcc8d[_0x3550b3(0x13d)]?JSON[_0x3550b3(0x16b)](_0x1fcc8d[_0x3550b3(0x13d)]):null,'gatewaySettings':_0x1fcc8d[_0x3550b3(0x151)]?JSON[_0x3550b3(0x16b)](_0x1fcc8d[_0x3550b3(0x151)]):null,'publicKey':_0x1fcc8d[_0x3550b3(0x143)],'wallets':{'usdtPolygonWallet':_0x1fcc8d[_0x3550b3(0x149)],'usdtTrcWallet':_0x1fcc8d[_0x3550b3(0x14b)],'usdtErcWallet':_0x1fcc8d['usdtErcWallet'],'usdcPolygonWallet':_0x1fcc8d[_0x3550b3(0x169)]},'status':_0x1fcc8d[_0x3550b3(0x142)],'createdAt':_0x1fcc8d['createdAt']};}async['updateUser'](_0x3cddbd,_0x3a5fb5){const _0x127db6=a56_0x4fc759,_0x58cf7f={..._0x3a5fb5};_0x3a5fb5[_0x127db6(0x137)]&&(_0x58cf7f[_0x127db6(0x137)]=await bcryptjs_1[_0x127db6(0x13e)][_0x127db6(0x162)](_0x3a5fb5[_0x127db6(0x137)],0xc));_0x3a5fb5['fullName']&&(_0x58cf7f[_0x127db6(0x168)]=_0x3a5fb5[_0x127db6(0x141)],delete _0x58cf7f[_0x127db6(0x141)]);_0x3a5fb5['telegramId']&&(_0x58cf7f[_0x127db6(0x13a)]=_0x3a5fb5[_0x127db6(0x15a)],delete _0x58cf7f[_0x127db6(0x15a)]);_0x3a5fb5[_0x127db6(0x157)]&&(_0x58cf7f[_0x127db6(0x155)]=_0x3a5fb5[_0x127db6(0x157)],delete _0x58cf7f[_0x127db6(0x157)]);_0x3a5fb5[_0x127db6(0x134)]&&(_0x58cf7f[_0x127db6(0x13d)]=JSON[_0x127db6(0x166)](_0x3a5fb5[_0x127db6(0x134)]),delete _0x58cf7f['gateways']);_0x3a5fb5[_0x127db6(0x151)]&&(_0x58cf7f[_0x127db6(0x151)]=JSON[_0x127db6(0x166)](_0x3a5fb5[_0x127db6(0x151)]),delete _0x58cf7f[_0x127db6(0x151)]);_0x3a5fb5['wallets']&&(_0x3a5fb5[_0x127db6(0x165)][_0x127db6(0x149)]!==undefined&&(_0x58cf7f[_0x127db6(0x149)]=_0x3a5fb5[_0x127db6(0x165)][_0x127db6(0x149)]||null),_0x3a5fb5[_0x127db6(0x165)][_0x127db6(0x14b)]!==undefined&&(_0x58cf7f[_0x127db6(0x14b)]=_0x3a5fb5[_0x127db6(0x165)][_0x127db6(0x14b)]||null),_0x3a5fb5['wallets'][_0x127db6(0x147)]!==undefined&&(_0x58cf7f[_0x127db6(0x147)]=_0x3a5fb5[_0x127db6(0x165)]['usdtErcWallet']||null),_0x3a5fb5[_0x127db6(0x165)][_0x127db6(0x169)]!==undefined&&(_0x58cf7f[_0x127db6(0x169)]=_0x3a5fb5[_0x127db6(0x165)][_0x127db6(0x169)]||null),delete _0x58cf7f[_0x127db6(0x165)]);const _0x10fba9=await database_1[_0x127db6(0x13e)][_0x127db6(0x150)][_0x127db6(0x154)]({'where':{'id':_0x3cddbd},'data':_0x58cf7f,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x10fba9['id'],'fullName':_0x10fba9[_0x127db6(0x168)],'username':_0x10fba9['username'],'telegramId':_0x10fba9['telegram'],'merchantUrl':_0x10fba9['shopUrl'],'gateways':_0x10fba9[_0x127db6(0x13d)]?JSON['parse'](_0x10fba9[_0x127db6(0x13d)]):null,'gatewaySettings':_0x10fba9['gatewaySettings']?JSON[_0x127db6(0x16b)](_0x10fba9[_0x127db6(0x151)]):null,'publicKey':_0x10fba9['publicKey'],'wallets':{'usdtPolygonWallet':_0x10fba9[_0x127db6(0x149)],'usdtTrcWallet':_0x10fba9['usdtTrcWallet'],'usdtErcWallet':_0x10fba9[_0x127db6(0x147)],'usdcPolygonWallet':_0x10fba9[_0x127db6(0x169)]},'status':_0x10fba9[_0x127db6(0x142)],'createdAt':_0x10fba9[_0x127db6(0x14c)]};}async[a56_0x4fc759(0x146)](_0x11ebc9){const _0x24830b=a56_0x4fc759;await database_1['default']['shop'][_0x24830b(0x133)]({'where':{'id':_0x11ebc9}});}}exports[a56_0x4fc759(0x163)]=UserService;