'use strict';const a56_0x12236d=a56_0x19d0;function a56_0x19d0(_0x4af60a,_0x17b939){const _0x5458c1=a56_0x5458();return a56_0x19d0=function(_0x19d0a7,_0x5f235e){_0x19d0a7=_0x19d0a7-0x126;let _0x64dcbd=_0x5458c1[_0x19d0a7];return _0x64dcbd;},a56_0x19d0(_0x4af60a,_0x17b939);}function a56_0x5458(){const _0x5a6613=['2490eVWret','map','default','fullName','76546YKGkmG','usdcPolygonWallet','name','Telegram\x20username\x20already\x20exists','defineProperty','telegram','shop','publicKey','613920msIYPv','shopUrl','../config/database','randomBytes','104526lOJIgy','329292UQCiqN','merchantUrl','usdtTrcWallet','getUserById','toString','delete','695ekOVZi','usdtPolygonWallet','password','generateApiKeys','createdAt','deleteUser','create','ACTIVE','gateways','sk_','4572TeiYKZ','gatewaySettings','paymentGateways','status','parse','hex','desc','__esModule','username','398240uyuypO','UserService','telegramId','42qdHupw','findUnique','bcryptjs','5108pIYOio','stringify','usdtErcWallet','wallets','hash'];a56_0x5458=function(){return _0x5a6613;};return a56_0x5458();}(function(_0x37622d,_0x227e7b){const _0x22b618=a56_0x19d0,_0x3b2f10=_0x37622d();while(!![]){try{const _0x5a03e4=-parseInt(_0x22b618(0x12b))/0x1+parseInt(_0x22b618(0x151))/0x2+parseInt(_0x22b618(0x138))/0x3+parseInt(_0x22b618(0x157))/0x4*(parseInt(_0x22b618(0x13e))/0x5)+-parseInt(_0x22b618(0x137))/0x6*(parseInt(_0x22b618(0x154))/0x7)+-parseInt(_0x22b618(0x133))/0x8+-parseInt(_0x22b618(0x148))/0x9*(parseInt(_0x22b618(0x127))/0xa);if(_0x5a03e4===_0x227e7b)break;else _0x3b2f10['push'](_0x3b2f10['shift']());}catch(_0x440eb8){_0x3b2f10['push'](_0x3b2f10['shift']());}}}(a56_0x5458,0x18ec3));var __importDefault=this&&this['__importDefault']||function(_0x1b45df){const _0x2a82d1=a56_0x19d0;return _0x1b45df&&_0x1b45df[_0x2a82d1(0x14f)]?_0x1b45df:{'default':_0x1b45df};};Object[a56_0x12236d(0x12f)](exports,a56_0x12236d(0x14f),{'value':!![]}),exports[a56_0x12236d(0x152)]=void 0x0;const bcryptjs_1=__importDefault(require(a56_0x12236d(0x156))),crypto_1=__importDefault(require('crypto')),database_1=__importDefault(require(a56_0x12236d(0x135)));class UserService{[a56_0x12236d(0x141)](){const _0x1b6b7b=a56_0x12236d,_0x4e5b23='pk_'+crypto_1['default'][_0x1b6b7b(0x136)](0x20)[_0x1b6b7b(0x13c)](_0x1b6b7b(0x14d)),_0x337193=_0x1b6b7b(0x147)+crypto_1[_0x1b6b7b(0x129)][_0x1b6b7b(0x136)](0x20)[_0x1b6b7b(0x13c)]('hex');return{'publicKey':_0x4e5b23,'secretKey':_0x337193};}async['createUser'](_0x56e134){const _0x3df3df=a56_0x12236d,{fullName:_0x306d61,username:_0x1ea5e7,password:_0x5857c8,telegramId:_0x48b889,merchantUrl:_0x1d93fc,gateways:_0x516026,gatewaySettings:_0x5e7f48,wallets:_0x66b5ec}=_0x56e134,_0x130c5f=await database_1[_0x3df3df(0x129)][_0x3df3df(0x131)]['findUnique']({'where':{'username':_0x1ea5e7}});if(_0x130c5f)throw new Error('Username\x20already\x20exists');if(_0x48b889){const _0x4c908f=await database_1[_0x3df3df(0x129)][_0x3df3df(0x131)][_0x3df3df(0x155)]({'where':{'telegram':_0x48b889}});if(_0x4c908f)throw new Error(_0x3df3df(0x12e));}const _0x1d1b6e=await bcryptjs_1[_0x3df3df(0x129)][_0x3df3df(0x126)](_0x5857c8,0xc),{publicKey:_0xb5a715,secretKey:_0x56dc6b}=this[_0x3df3df(0x141)](),_0x6b0fb8=await database_1[_0x3df3df(0x129)][_0x3df3df(0x131)][_0x3df3df(0x144)]({'data':{'name':_0x306d61,'username':_0x1ea5e7,'password':_0x1d1b6e,'telegram':_0x48b889,'shopUrl':_0x1d93fc,'paymentGateways':_0x516026?JSON['stringify'](_0x516026):null,'gatewaySettings':_0x5e7f48?JSON[_0x3df3df(0x158)](_0x5e7f48):null,'usdtPolygonWallet':_0x66b5ec?.[_0x3df3df(0x13f)]||null,'usdtTrcWallet':_0x66b5ec?.[_0x3df3df(0x13a)]||null,'usdtErcWallet':_0x66b5ec?.[_0x3df3df(0x159)]||null,'usdcPolygonWallet':_0x66b5ec?.[_0x3df3df(0x12c)]||null,'publicKey':_0xb5a715,'secretKey':_0x56dc6b,'status':_0x3df3df(0x145)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x6b0fb8['id'],'fullName':_0x6b0fb8['name'],'username':_0x6b0fb8['username'],'telegramId':_0x6b0fb8[_0x3df3df(0x130)],'merchantUrl':_0x6b0fb8[_0x3df3df(0x134)],'gateways':_0x6b0fb8[_0x3df3df(0x14a)]?JSON['parse'](_0x6b0fb8[_0x3df3df(0x14a)]):null,'gatewaySettings':_0x6b0fb8[_0x3df3df(0x149)]?JSON[_0x3df3df(0x14c)](_0x6b0fb8['gatewaySettings']):null,'publicKey':_0x6b0fb8[_0x3df3df(0x132)],'wallets':{'usdtPolygonWallet':_0x6b0fb8[_0x3df3df(0x13f)],'usdtTrcWallet':_0x6b0fb8[_0x3df3df(0x13a)],'usdtErcWallet':_0x6b0fb8[_0x3df3df(0x159)],'usdcPolygonWallet':_0x6b0fb8['usdcPolygonWallet']},'status':_0x6b0fb8[_0x3df3df(0x14b)],'createdAt':_0x6b0fb8['createdAt']};}async['getAllUsers'](){const _0x33e0b3=a56_0x12236d,_0x2c5e22=await database_1[_0x33e0b3(0x129)][_0x33e0b3(0x131)]['findMany']({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x33e0b3(0x14e)}});return _0x2c5e22[_0x33e0b3(0x128)](_0x21b72d=>({'id':_0x21b72d['id'],'fullName':_0x21b72d['name'],'username':_0x21b72d[_0x33e0b3(0x150)],'telegramId':_0x21b72d[_0x33e0b3(0x130)],'merchantUrl':_0x21b72d[_0x33e0b3(0x134)],'gateways':_0x21b72d[_0x33e0b3(0x14a)]?JSON[_0x33e0b3(0x14c)](_0x21b72d['paymentGateways']):null,'gatewaySettings':_0x21b72d['gatewaySettings']?JSON[_0x33e0b3(0x14c)](_0x21b72d[_0x33e0b3(0x149)]):null,'publicKey':_0x21b72d[_0x33e0b3(0x132)],'wallets':{'usdtPolygonWallet':_0x21b72d[_0x33e0b3(0x13f)],'usdtTrcWallet':_0x21b72d['usdtTrcWallet'],'usdtErcWallet':_0x21b72d[_0x33e0b3(0x159)],'usdcPolygonWallet':_0x21b72d[_0x33e0b3(0x12c)]},'status':_0x21b72d[_0x33e0b3(0x14b)],'createdAt':_0x21b72d['createdAt']}));}async[a56_0x12236d(0x13b)](_0x2b89f7){const _0x5b9f88=a56_0x12236d,_0x6bf5fd=await database_1['default'][_0x5b9f88(0x131)][_0x5b9f88(0x155)]({'where':{'id':_0x2b89f7},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x6bf5fd)return null;return{'id':_0x6bf5fd['id'],'fullName':_0x6bf5fd[_0x5b9f88(0x12d)],'username':_0x6bf5fd[_0x5b9f88(0x150)],'telegramId':_0x6bf5fd['telegram'],'merchantUrl':_0x6bf5fd[_0x5b9f88(0x134)],'gateways':_0x6bf5fd[_0x5b9f88(0x14a)]?JSON[_0x5b9f88(0x14c)](_0x6bf5fd[_0x5b9f88(0x14a)]):null,'gatewaySettings':_0x6bf5fd[_0x5b9f88(0x149)]?JSON[_0x5b9f88(0x14c)](_0x6bf5fd[_0x5b9f88(0x149)]):null,'publicKey':_0x6bf5fd[_0x5b9f88(0x132)],'wallets':{'usdtPolygonWallet':_0x6bf5fd['usdtPolygonWallet'],'usdtTrcWallet':_0x6bf5fd[_0x5b9f88(0x13a)],'usdtErcWallet':_0x6bf5fd[_0x5b9f88(0x159)],'usdcPolygonWallet':_0x6bf5fd['usdcPolygonWallet']},'status':_0x6bf5fd[_0x5b9f88(0x14b)],'createdAt':_0x6bf5fd['createdAt']};}async['updateUser'](_0x49c06f,_0x5aab62){const _0x2b4397=a56_0x12236d,_0x2f4164={..._0x5aab62};_0x5aab62['password']&&(_0x2f4164[_0x2b4397(0x140)]=await bcryptjs_1[_0x2b4397(0x129)][_0x2b4397(0x126)](_0x5aab62['password'],0xc));_0x5aab62[_0x2b4397(0x12a)]&&(_0x2f4164[_0x2b4397(0x12d)]=_0x5aab62[_0x2b4397(0x12a)],delete _0x2f4164[_0x2b4397(0x12a)]);_0x5aab62[_0x2b4397(0x153)]&&(_0x2f4164[_0x2b4397(0x130)]=_0x5aab62[_0x2b4397(0x153)],delete _0x2f4164[_0x2b4397(0x153)]);_0x5aab62[_0x2b4397(0x139)]&&(_0x2f4164[_0x2b4397(0x134)]=_0x5aab62['merchantUrl'],delete _0x2f4164[_0x2b4397(0x139)]);_0x5aab62[_0x2b4397(0x146)]&&(_0x2f4164[_0x2b4397(0x14a)]=JSON[_0x2b4397(0x158)](_0x5aab62[_0x2b4397(0x146)]),delete _0x2f4164['gateways']);_0x5aab62[_0x2b4397(0x149)]&&(_0x2f4164['gatewaySettings']=JSON['stringify'](_0x5aab62['gatewaySettings']),delete _0x2f4164[_0x2b4397(0x149)]);_0x5aab62[_0x2b4397(0x15a)]&&(_0x5aab62[_0x2b4397(0x15a)][_0x2b4397(0x13f)]!==undefined&&(_0x2f4164[_0x2b4397(0x13f)]=_0x5aab62[_0x2b4397(0x15a)]['usdtPolygonWallet']||null),_0x5aab62[_0x2b4397(0x15a)][_0x2b4397(0x13a)]!==undefined&&(_0x2f4164[_0x2b4397(0x13a)]=_0x5aab62[_0x2b4397(0x15a)][_0x2b4397(0x13a)]||null),_0x5aab62['wallets'][_0x2b4397(0x159)]!==undefined&&(_0x2f4164[_0x2b4397(0x159)]=_0x5aab62['wallets']['usdtErcWallet']||null),_0x5aab62[_0x2b4397(0x15a)][_0x2b4397(0x12c)]!==undefined&&(_0x2f4164['usdcPolygonWallet']=_0x5aab62[_0x2b4397(0x15a)]['usdcPolygonWallet']||null),delete _0x2f4164[_0x2b4397(0x15a)]);const _0x26cf41=await database_1[_0x2b4397(0x129)]['shop']['update']({'where':{'id':_0x49c06f},'data':_0x2f4164,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x26cf41['id'],'fullName':_0x26cf41['name'],'username':_0x26cf41[_0x2b4397(0x150)],'telegramId':_0x26cf41[_0x2b4397(0x130)],'merchantUrl':_0x26cf41[_0x2b4397(0x134)],'gateways':_0x26cf41[_0x2b4397(0x14a)]?JSON['parse'](_0x26cf41[_0x2b4397(0x14a)]):null,'gatewaySettings':_0x26cf41[_0x2b4397(0x149)]?JSON[_0x2b4397(0x14c)](_0x26cf41[_0x2b4397(0x149)]):null,'publicKey':_0x26cf41[_0x2b4397(0x132)],'wallets':{'usdtPolygonWallet':_0x26cf41[_0x2b4397(0x13f)],'usdtTrcWallet':_0x26cf41[_0x2b4397(0x13a)],'usdtErcWallet':_0x26cf41['usdtErcWallet'],'usdcPolygonWallet':_0x26cf41[_0x2b4397(0x12c)]},'status':_0x26cf41[_0x2b4397(0x14b)],'createdAt':_0x26cf41[_0x2b4397(0x142)]};}async[a56_0x12236d(0x143)](_0x3f1948){const _0x45e5d2=a56_0x12236d;await database_1[_0x45e5d2(0x129)]['shop'][_0x45e5d2(0x13d)]({'where':{'id':_0x3f1948}});}}exports[a56_0x12236d(0x152)]=UserService;