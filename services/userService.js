'use strict';function a59_0x78dd(){const _0x126f61=['username','telegramId','defineProperty','stringify','deleteUser','__importDefault','hash','Username\x20already\x20exists','114325sdrxQv','telegram','Telegram\x20username\x20already\x20exists','gatewaySettings','password','__esModule','ACTIVE','../config/database','shop','10144323wgaEoc','randomBytes','sk_','4456660BtSLzW','getAllUsers','12849tBObaH','merchantUrl','createdAt','usdcPolygonWallet','map','bcryptjs','145FzelEi','fullName','parse','findMany','publicKey','crypto','UserService','toString','createUser','name','pk_','40672082hKIxHN','paymentGateways','findUnique','shopUrl','generateApiKeys','desc','status','wallets','updateUser','default','gateways','create','8eXmzIE','usdtPolygonWallet','255108shPYfE','22XmDbYx','usdtErcWallet','196ucmNsj','9571947aWXmfq','usdtTrcWallet'];a59_0x78dd=function(){return _0x126f61;};return a59_0x78dd();}const a59_0x152e87=a59_0x9d6a;(function(_0x3ac96c,_0x2cd684){const _0xe16c89=a59_0x9d6a,_0x4a1537=_0x3ac96c();while(!![]){try{const _0x30b741=parseInt(_0xe16c89(0x1bc))/0x1*(-parseInt(_0xe16c89(0x1ea))/0x2)+parseInt(_0xe16c89(0x1ca))/0x3*(-parseInt(_0xe16c89(0x1ec))/0x4)+parseInt(_0xe16c89(0x1d0))/0x5*(-parseInt(_0xe16c89(0x1e9))/0x6)+parseInt(_0xe16c89(0x1ed))/0x7+-parseInt(_0xe16c89(0x1e7))/0x8*(parseInt(_0xe16c89(0x1c5))/0x9)+-parseInt(_0xe16c89(0x1c8))/0xa+parseInt(_0xe16c89(0x1db))/0xb;if(_0x30b741===_0x2cd684)break;else _0x4a1537['push'](_0x4a1537['shift']());}catch(_0x3161f4){_0x4a1537['push'](_0x4a1537['shift']());}}}(a59_0x78dd,0xc1436));var __importDefault=this&&this[a59_0x152e87(0x1b9)]||function(_0x55b8e0){const _0x481209=a59_0x152e87;return _0x55b8e0&&_0x55b8e0[_0x481209(0x1c1)]?_0x55b8e0:{'default':_0x55b8e0};};function a59_0x9d6a(_0x4957cc,_0x297f66){const _0x78dd7f=a59_0x78dd();return a59_0x9d6a=function(_0x9d6a02,_0x2d9579){_0x9d6a02=_0x9d6a02-0x1b9;let _0x46861e=_0x78dd7f[_0x9d6a02];return _0x46861e;},a59_0x9d6a(_0x4957cc,_0x297f66);}Object[a59_0x152e87(0x1f1)](exports,'__esModule',{'value':!![]}),exports[a59_0x152e87(0x1d6)]=void 0x0;const bcryptjs_1=__importDefault(require(a59_0x152e87(0x1cf))),crypto_1=__importDefault(require(a59_0x152e87(0x1d5))),database_1=__importDefault(require(a59_0x152e87(0x1c3)));class UserService{[a59_0x152e87(0x1df)](){const _0x349964=a59_0x152e87,_0x7923f1=_0x349964(0x1da)+crypto_1[_0x349964(0x1e4)][_0x349964(0x1c6)](0x20)[_0x349964(0x1d7)]('hex'),_0x457e9c=_0x349964(0x1c7)+crypto_1[_0x349964(0x1e4)][_0x349964(0x1c6)](0x20)[_0x349964(0x1d7)]('hex');return{'publicKey':_0x7923f1,'secretKey':_0x457e9c};}async[a59_0x152e87(0x1d8)](_0x2abb5a){const _0x565434=a59_0x152e87,{fullName:_0x3ec117,username:_0x234dd0,password:_0x16e60f,telegramId:_0x3dcdc5,merchantUrl:_0x49554a,gateways:_0xe1668d,gatewaySettings:_0x1fcc18,wallets:_0x35845a}=_0x2abb5a,_0x1852ae=await database_1['default'][_0x565434(0x1c4)]['findUnique']({'where':{'username':_0x234dd0}});if(_0x1852ae)throw new Error(_0x565434(0x1bb));if(_0x3dcdc5){const _0x6902d4=await database_1[_0x565434(0x1e4)][_0x565434(0x1c4)]['findUnique']({'where':{'telegram':_0x3dcdc5}});if(_0x6902d4)throw new Error(_0x565434(0x1be));}const _0xc7caee=await bcryptjs_1[_0x565434(0x1e4)][_0x565434(0x1ba)](_0x16e60f,0xc),{publicKey:_0xf7bb27,secretKey:_0x487ab7}=this['generateApiKeys'](),_0x2e4453=await database_1[_0x565434(0x1e4)]['shop'][_0x565434(0x1e6)]({'data':{'name':_0x3ec117,'username':_0x234dd0,'password':_0xc7caee,'telegram':_0x3dcdc5,'shopUrl':_0x49554a,'paymentGateways':_0xe1668d?JSON[_0x565434(0x1f2)](_0xe1668d):null,'gatewaySettings':_0x1fcc18?JSON[_0x565434(0x1f2)](_0x1fcc18):null,'usdtPolygonWallet':_0x35845a?.['usdtPolygonWallet']||null,'usdtTrcWallet':_0x35845a?.[_0x565434(0x1ee)]||null,'usdtErcWallet':_0x35845a?.[_0x565434(0x1eb)]||null,'usdcPolygonWallet':_0x35845a?.[_0x565434(0x1cd)]||null,'publicKey':_0xf7bb27,'secretKey':_0x487ab7,'status':_0x565434(0x1c2)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x2e4453['id'],'fullName':_0x2e4453[_0x565434(0x1d9)],'username':_0x2e4453['username'],'telegramId':_0x2e4453[_0x565434(0x1bd)],'merchantUrl':_0x2e4453['shopUrl'],'gateways':_0x2e4453[_0x565434(0x1dc)]?JSON['parse'](_0x2e4453['paymentGateways']):null,'gatewaySettings':_0x2e4453['gatewaySettings']?JSON[_0x565434(0x1d2)](_0x2e4453[_0x565434(0x1bf)]):null,'publicKey':_0x2e4453[_0x565434(0x1d4)],'wallets':{'usdtPolygonWallet':_0x2e4453[_0x565434(0x1e8)],'usdtTrcWallet':_0x2e4453['usdtTrcWallet'],'usdtErcWallet':_0x2e4453[_0x565434(0x1eb)],'usdcPolygonWallet':_0x2e4453[_0x565434(0x1cd)]},'status':_0x2e4453[_0x565434(0x1e1)],'createdAt':_0x2e4453[_0x565434(0x1cc)]};}async[a59_0x152e87(0x1c9)](){const _0x215b1d=a59_0x152e87,_0x43689b=await database_1[_0x215b1d(0x1e4)][_0x215b1d(0x1c4)][_0x215b1d(0x1d3)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x215b1d(0x1e0)}});return _0x43689b[_0x215b1d(0x1ce)](_0x1b946a=>({'id':_0x1b946a['id'],'fullName':_0x1b946a[_0x215b1d(0x1d9)],'username':_0x1b946a[_0x215b1d(0x1ef)],'telegramId':_0x1b946a[_0x215b1d(0x1bd)],'merchantUrl':_0x1b946a[_0x215b1d(0x1de)],'gateways':_0x1b946a[_0x215b1d(0x1dc)]?JSON['parse'](_0x1b946a['paymentGateways']):null,'gatewaySettings':_0x1b946a[_0x215b1d(0x1bf)]?JSON[_0x215b1d(0x1d2)](_0x1b946a[_0x215b1d(0x1bf)]):null,'publicKey':_0x1b946a[_0x215b1d(0x1d4)],'wallets':{'usdtPolygonWallet':_0x1b946a[_0x215b1d(0x1e8)],'usdtTrcWallet':_0x1b946a[_0x215b1d(0x1ee)],'usdtErcWallet':_0x1b946a[_0x215b1d(0x1eb)],'usdcPolygonWallet':_0x1b946a[_0x215b1d(0x1cd)]},'status':_0x1b946a[_0x215b1d(0x1e1)],'createdAt':_0x1b946a[_0x215b1d(0x1cc)]}));}async['getUserById'](_0x197405){const _0x4fde3d=a59_0x152e87,_0x2ad501=await database_1[_0x4fde3d(0x1e4)][_0x4fde3d(0x1c4)][_0x4fde3d(0x1dd)]({'where':{'id':_0x197405},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x2ad501)return null;return{'id':_0x2ad501['id'],'fullName':_0x2ad501[_0x4fde3d(0x1d9)],'username':_0x2ad501[_0x4fde3d(0x1ef)],'telegramId':_0x2ad501[_0x4fde3d(0x1bd)],'merchantUrl':_0x2ad501['shopUrl'],'gateways':_0x2ad501[_0x4fde3d(0x1dc)]?JSON[_0x4fde3d(0x1d2)](_0x2ad501[_0x4fde3d(0x1dc)]):null,'gatewaySettings':_0x2ad501[_0x4fde3d(0x1bf)]?JSON['parse'](_0x2ad501[_0x4fde3d(0x1bf)]):null,'publicKey':_0x2ad501[_0x4fde3d(0x1d4)],'wallets':{'usdtPolygonWallet':_0x2ad501[_0x4fde3d(0x1e8)],'usdtTrcWallet':_0x2ad501['usdtTrcWallet'],'usdtErcWallet':_0x2ad501[_0x4fde3d(0x1eb)],'usdcPolygonWallet':_0x2ad501['usdcPolygonWallet']},'status':_0x2ad501[_0x4fde3d(0x1e1)],'createdAt':_0x2ad501[_0x4fde3d(0x1cc)]};}async[a59_0x152e87(0x1e3)](_0x506cdd,_0x52bd87){const _0x7c22af=a59_0x152e87,_0x48e9ce={..._0x52bd87};_0x52bd87[_0x7c22af(0x1c0)]&&(_0x48e9ce[_0x7c22af(0x1c0)]=await bcryptjs_1[_0x7c22af(0x1e4)][_0x7c22af(0x1ba)](_0x52bd87[_0x7c22af(0x1c0)],0xc));_0x52bd87['fullName']&&(_0x48e9ce[_0x7c22af(0x1d9)]=_0x52bd87[_0x7c22af(0x1d1)],delete _0x48e9ce['fullName']);_0x52bd87[_0x7c22af(0x1f0)]&&(_0x48e9ce[_0x7c22af(0x1bd)]=_0x52bd87['telegramId'],delete _0x48e9ce['telegramId']);_0x52bd87[_0x7c22af(0x1cb)]&&(_0x48e9ce[_0x7c22af(0x1de)]=_0x52bd87['merchantUrl'],delete _0x48e9ce[_0x7c22af(0x1cb)]);_0x52bd87[_0x7c22af(0x1e5)]&&(_0x48e9ce[_0x7c22af(0x1dc)]=JSON['stringify'](_0x52bd87[_0x7c22af(0x1e5)]),delete _0x48e9ce[_0x7c22af(0x1e5)]);_0x52bd87[_0x7c22af(0x1bf)]&&(_0x48e9ce[_0x7c22af(0x1bf)]=JSON[_0x7c22af(0x1f2)](_0x52bd87[_0x7c22af(0x1bf)]),delete _0x48e9ce[_0x7c22af(0x1bf)]);_0x52bd87['wallets']&&(_0x52bd87[_0x7c22af(0x1e2)][_0x7c22af(0x1e8)]!==undefined&&(_0x48e9ce['usdtPolygonWallet']=_0x52bd87[_0x7c22af(0x1e2)][_0x7c22af(0x1e8)]||null),_0x52bd87['wallets'][_0x7c22af(0x1ee)]!==undefined&&(_0x48e9ce[_0x7c22af(0x1ee)]=_0x52bd87[_0x7c22af(0x1e2)][_0x7c22af(0x1ee)]||null),_0x52bd87[_0x7c22af(0x1e2)][_0x7c22af(0x1eb)]!==undefined&&(_0x48e9ce[_0x7c22af(0x1eb)]=_0x52bd87['wallets'][_0x7c22af(0x1eb)]||null),_0x52bd87[_0x7c22af(0x1e2)][_0x7c22af(0x1cd)]!==undefined&&(_0x48e9ce[_0x7c22af(0x1cd)]=_0x52bd87[_0x7c22af(0x1e2)][_0x7c22af(0x1cd)]||null),delete _0x48e9ce[_0x7c22af(0x1e2)]);const _0x1a2901=await database_1[_0x7c22af(0x1e4)][_0x7c22af(0x1c4)]['update']({'where':{'id':_0x506cdd},'data':_0x48e9ce,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x1a2901['id'],'fullName':_0x1a2901[_0x7c22af(0x1d9)],'username':_0x1a2901[_0x7c22af(0x1ef)],'telegramId':_0x1a2901[_0x7c22af(0x1bd)],'merchantUrl':_0x1a2901[_0x7c22af(0x1de)],'gateways':_0x1a2901['paymentGateways']?JSON[_0x7c22af(0x1d2)](_0x1a2901[_0x7c22af(0x1dc)]):null,'gatewaySettings':_0x1a2901[_0x7c22af(0x1bf)]?JSON[_0x7c22af(0x1d2)](_0x1a2901[_0x7c22af(0x1bf)]):null,'publicKey':_0x1a2901[_0x7c22af(0x1d4)],'wallets':{'usdtPolygonWallet':_0x1a2901[_0x7c22af(0x1e8)],'usdtTrcWallet':_0x1a2901[_0x7c22af(0x1ee)],'usdtErcWallet':_0x1a2901[_0x7c22af(0x1eb)],'usdcPolygonWallet':_0x1a2901['usdcPolygonWallet']},'status':_0x1a2901[_0x7c22af(0x1e1)],'createdAt':_0x1a2901['createdAt']};}async[a59_0x152e87(0x1f3)](_0x51fd21){const _0x1ba8d2=a59_0x152e87;await database_1[_0x1ba8d2(0x1e4)][_0x1ba8d2(0x1c4)]['delete']({'where':{'id':_0x51fd21}});}}exports[a59_0x152e87(0x1d6)]=UserService;