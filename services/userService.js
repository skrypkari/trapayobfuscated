'use strict';const a57_0x28e5af=a57_0x307f;(function(_0x5151c2,_0x1f3c15){const _0x5dd4b8=a57_0x307f,_0x14526b=_0x5151c2();while(!![]){try{const _0x2617d0=-parseInt(_0x5dd4b8(0xf2))/0x1*(parseInt(_0x5dd4b8(0xfe))/0x2)+-parseInt(_0x5dd4b8(0xfa))/0x3*(parseInt(_0x5dd4b8(0x108))/0x4)+parseInt(_0x5dd4b8(0x101))/0x5*(-parseInt(_0x5dd4b8(0x10f))/0x6)+-parseInt(_0x5dd4b8(0x109))/0x7*(-parseInt(_0x5dd4b8(0x113))/0x8)+parseInt(_0x5dd4b8(0xff))/0x9+parseInt(_0x5dd4b8(0xef))/0xa+-parseInt(_0x5dd4b8(0x10c))/0xb*(-parseInt(_0x5dd4b8(0x122))/0xc);if(_0x2617d0===_0x1f3c15)break;else _0x14526b['push'](_0x14526b['shift']());}catch(_0x497dd1){_0x14526b['push'](_0x14526b['shift']());}}}(a57_0x3f86,0x72872));function a57_0x3f86(){const _0x3c15f5=['gateways','createUser','update','__esModule','desc','createdAt','Telegram\x20username\x20already\x20exists','stringify','UserService','username','generateApiKeys','gatewaySettings','merchantUrl','12AWekyA','hex','hash','usdcPolygonWallet','default','wallets','getAllUsers','password','usdtPolygonWallet','getUserById','randomBytes','8247910fAOLZN','map','findUnique','310754ODPYmm','shopUrl','fullName','toString','__importDefault','defineProperty','usdtErcWallet','publicKey','3dgyOnj','create','delete','parse','6CTTbkG','8338482plbOGT','updateUser','10ykdPdT','name','telegramId','crypto','shop','usdtTrcWallet','telegram','1664876GsJBqb','241073bMPhRO','ACTIVE','Username\x20already\x20exists','5038407xSQjOf','findMany','status','1278534CXDEsK','deleteUser','sk_','paymentGateways','8SqqOYv','pk_'];a57_0x3f86=function(){return _0x3c15f5;};return a57_0x3f86();}var __importDefault=this&&this[a57_0x28e5af(0xf6)]||function(_0x569985){const _0x20e375=a57_0x28e5af;return _0x569985&&_0x569985[_0x20e375(0x118)]?_0x569985:{'default':_0x569985};};Object[a57_0x28e5af(0xf7)](exports,a57_0x28e5af(0x118),{'value':!![]}),exports[a57_0x28e5af(0x11d)]=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),crypto_1=__importDefault(require(a57_0x28e5af(0x104))),database_1=__importDefault(require('../config/database'));function a57_0x307f(_0x228e9c,_0x47df3a){const _0x3f8655=a57_0x3f86();return a57_0x307f=function(_0x307faf,_0x3d54c1){_0x307faf=_0x307faf-0xed;let _0xdaa3c7=_0x3f8655[_0x307faf];return _0xdaa3c7;},a57_0x307f(_0x228e9c,_0x47df3a);}class UserService{[a57_0x28e5af(0x11f)](){const _0x5a0bc7=a57_0x28e5af,_0x4fd7e6=_0x5a0bc7(0x114)+crypto_1[_0x5a0bc7(0x126)][_0x5a0bc7(0xee)](0x20)[_0x5a0bc7(0xf5)]('hex'),_0x4bc681=_0x5a0bc7(0x111)+crypto_1['default'][_0x5a0bc7(0xee)](0x20)[_0x5a0bc7(0xf5)](_0x5a0bc7(0x123));return{'publicKey':_0x4fd7e6,'secretKey':_0x4bc681};}async[a57_0x28e5af(0x116)](_0x4940ad){const _0x14987f=a57_0x28e5af,{fullName:_0xbbcd21,username:_0x377030,password:_0x3f1e79,telegramId:_0x20d34c,merchantUrl:_0x31c1ad,gateways:_0xd595e2,gatewaySettings:_0x522558,wallets:_0x3caaca}=_0x4940ad,_0x372a82=await database_1[_0x14987f(0x126)][_0x14987f(0x105)]['findUnique']({'where':{'username':_0x377030}});if(_0x372a82)throw new Error(_0x14987f(0x10b));if(_0x20d34c){const _0x31309b=await database_1[_0x14987f(0x126)][_0x14987f(0x105)][_0x14987f(0xf1)]({'where':{'telegram':_0x20d34c}});if(_0x31309b)throw new Error(_0x14987f(0x11b));}const _0x5bd66f=await bcryptjs_1['default'][_0x14987f(0x124)](_0x3f1e79,0xc),{publicKey:_0x26cebc,secretKey:_0x250e17}=this[_0x14987f(0x11f)](),_0x39b701=await database_1[_0x14987f(0x126)][_0x14987f(0x105)][_0x14987f(0xfb)]({'data':{'name':_0xbbcd21,'username':_0x377030,'password':_0x5bd66f,'telegram':_0x20d34c,'shopUrl':_0x31c1ad,'paymentGateways':_0xd595e2?JSON[_0x14987f(0x11c)](_0xd595e2):null,'gatewaySettings':_0x522558?JSON[_0x14987f(0x11c)](_0x522558):null,'usdtPolygonWallet':_0x3caaca?.[_0x14987f(0x12a)]||null,'usdtTrcWallet':_0x3caaca?.[_0x14987f(0x106)]||null,'usdtErcWallet':_0x3caaca?.['usdtErcWallet']||null,'usdcPolygonWallet':_0x3caaca?.[_0x14987f(0x125)]||null,'publicKey':_0x26cebc,'secretKey':_0x250e17,'status':_0x14987f(0x10a)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x39b701['id'],'fullName':_0x39b701[_0x14987f(0x102)],'username':_0x39b701['username'],'telegramId':_0x39b701[_0x14987f(0x107)],'merchantUrl':_0x39b701[_0x14987f(0xf3)],'gateways':_0x39b701[_0x14987f(0x112)]?JSON['parse'](_0x39b701[_0x14987f(0x112)]):null,'gatewaySettings':_0x39b701[_0x14987f(0x120)]?JSON[_0x14987f(0xfd)](_0x39b701[_0x14987f(0x120)]):null,'publicKey':_0x39b701[_0x14987f(0xf9)],'wallets':{'usdtPolygonWallet':_0x39b701['usdtPolygonWallet'],'usdtTrcWallet':_0x39b701[_0x14987f(0x106)],'usdtErcWallet':_0x39b701[_0x14987f(0xf8)],'usdcPolygonWallet':_0x39b701[_0x14987f(0x125)]},'status':_0x39b701[_0x14987f(0x10e)],'createdAt':_0x39b701[_0x14987f(0x11a)]};}async[a57_0x28e5af(0x128)](){const _0x1cb2a8=a57_0x28e5af,_0x5c790d=await database_1['default'][_0x1cb2a8(0x105)][_0x1cb2a8(0x10d)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x1cb2a8(0x119)}});return _0x5c790d[_0x1cb2a8(0xf0)](_0x43717a=>({'id':_0x43717a['id'],'fullName':_0x43717a['name'],'username':_0x43717a['username'],'telegramId':_0x43717a['telegram'],'merchantUrl':_0x43717a[_0x1cb2a8(0xf3)],'gateways':_0x43717a[_0x1cb2a8(0x112)]?JSON[_0x1cb2a8(0xfd)](_0x43717a[_0x1cb2a8(0x112)]):null,'gatewaySettings':_0x43717a[_0x1cb2a8(0x120)]?JSON[_0x1cb2a8(0xfd)](_0x43717a[_0x1cb2a8(0x120)]):null,'publicKey':_0x43717a[_0x1cb2a8(0xf9)],'wallets':{'usdtPolygonWallet':_0x43717a[_0x1cb2a8(0x12a)],'usdtTrcWallet':_0x43717a[_0x1cb2a8(0x106)],'usdtErcWallet':_0x43717a[_0x1cb2a8(0xf8)],'usdcPolygonWallet':_0x43717a[_0x1cb2a8(0x125)]},'status':_0x43717a[_0x1cb2a8(0x10e)],'createdAt':_0x43717a[_0x1cb2a8(0x11a)]}));}async[a57_0x28e5af(0xed)](_0x4102a3){const _0x4adfa1=a57_0x28e5af,_0x497c3c=await database_1[_0x4adfa1(0x126)][_0x4adfa1(0x105)]['findUnique']({'where':{'id':_0x4102a3},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x497c3c)return null;return{'id':_0x497c3c['id'],'fullName':_0x497c3c[_0x4adfa1(0x102)],'username':_0x497c3c[_0x4adfa1(0x11e)],'telegramId':_0x497c3c[_0x4adfa1(0x107)],'merchantUrl':_0x497c3c['shopUrl'],'gateways':_0x497c3c[_0x4adfa1(0x112)]?JSON[_0x4adfa1(0xfd)](_0x497c3c[_0x4adfa1(0x112)]):null,'gatewaySettings':_0x497c3c[_0x4adfa1(0x120)]?JSON[_0x4adfa1(0xfd)](_0x497c3c['gatewaySettings']):null,'publicKey':_0x497c3c[_0x4adfa1(0xf9)],'wallets':{'usdtPolygonWallet':_0x497c3c['usdtPolygonWallet'],'usdtTrcWallet':_0x497c3c[_0x4adfa1(0x106)],'usdtErcWallet':_0x497c3c[_0x4adfa1(0xf8)],'usdcPolygonWallet':_0x497c3c[_0x4adfa1(0x125)]},'status':_0x497c3c[_0x4adfa1(0x10e)],'createdAt':_0x497c3c[_0x4adfa1(0x11a)]};}async[a57_0x28e5af(0x100)](_0x25c1cf,_0x1e0df1){const _0x230ed2=a57_0x28e5af,_0x20fcd2={..._0x1e0df1};_0x1e0df1[_0x230ed2(0x129)]&&(_0x20fcd2['password']=await bcryptjs_1[_0x230ed2(0x126)][_0x230ed2(0x124)](_0x1e0df1[_0x230ed2(0x129)],0xc));_0x1e0df1[_0x230ed2(0xf4)]&&(_0x20fcd2[_0x230ed2(0x102)]=_0x1e0df1[_0x230ed2(0xf4)],delete _0x20fcd2[_0x230ed2(0xf4)]);_0x1e0df1['telegramId']&&(_0x20fcd2['telegram']=_0x1e0df1[_0x230ed2(0x103)],delete _0x20fcd2[_0x230ed2(0x103)]);_0x1e0df1[_0x230ed2(0x121)]&&(_0x20fcd2[_0x230ed2(0xf3)]=_0x1e0df1[_0x230ed2(0x121)],delete _0x20fcd2['merchantUrl']);_0x1e0df1[_0x230ed2(0x115)]&&(_0x20fcd2[_0x230ed2(0x112)]=JSON['stringify'](_0x1e0df1['gateways']),delete _0x20fcd2[_0x230ed2(0x115)]);_0x1e0df1[_0x230ed2(0x120)]&&(_0x20fcd2['gatewaySettings']=JSON[_0x230ed2(0x11c)](_0x1e0df1[_0x230ed2(0x120)]),delete _0x20fcd2[_0x230ed2(0x120)]);_0x1e0df1[_0x230ed2(0x127)]&&(_0x1e0df1[_0x230ed2(0x127)][_0x230ed2(0x12a)]!==undefined&&(_0x20fcd2['usdtPolygonWallet']=_0x1e0df1[_0x230ed2(0x127)][_0x230ed2(0x12a)]||null),_0x1e0df1[_0x230ed2(0x127)][_0x230ed2(0x106)]!==undefined&&(_0x20fcd2[_0x230ed2(0x106)]=_0x1e0df1[_0x230ed2(0x127)][_0x230ed2(0x106)]||null),_0x1e0df1['wallets']['usdtErcWallet']!==undefined&&(_0x20fcd2['usdtErcWallet']=_0x1e0df1['wallets'][_0x230ed2(0xf8)]||null),_0x1e0df1[_0x230ed2(0x127)][_0x230ed2(0x125)]!==undefined&&(_0x20fcd2['usdcPolygonWallet']=_0x1e0df1['wallets'][_0x230ed2(0x125)]||null),delete _0x20fcd2['wallets']);const _0x2f871b=await database_1[_0x230ed2(0x126)][_0x230ed2(0x105)][_0x230ed2(0x117)]({'where':{'id':_0x25c1cf},'data':_0x20fcd2,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x2f871b['id'],'fullName':_0x2f871b[_0x230ed2(0x102)],'username':_0x2f871b['username'],'telegramId':_0x2f871b[_0x230ed2(0x107)],'merchantUrl':_0x2f871b[_0x230ed2(0xf3)],'gateways':_0x2f871b[_0x230ed2(0x112)]?JSON[_0x230ed2(0xfd)](_0x2f871b[_0x230ed2(0x112)]):null,'gatewaySettings':_0x2f871b[_0x230ed2(0x120)]?JSON[_0x230ed2(0xfd)](_0x2f871b[_0x230ed2(0x120)]):null,'publicKey':_0x2f871b[_0x230ed2(0xf9)],'wallets':{'usdtPolygonWallet':_0x2f871b['usdtPolygonWallet'],'usdtTrcWallet':_0x2f871b[_0x230ed2(0x106)],'usdtErcWallet':_0x2f871b[_0x230ed2(0xf8)],'usdcPolygonWallet':_0x2f871b[_0x230ed2(0x125)]},'status':_0x2f871b[_0x230ed2(0x10e)],'createdAt':_0x2f871b['createdAt']};}async[a57_0x28e5af(0x110)](_0x41d03c){const _0x1de91d=a57_0x28e5af;await database_1['default'][_0x1de91d(0x105)][_0x1de91d(0xfc)]({'where':{'id':_0x41d03c}});}}exports[a57_0x28e5af(0x11d)]=UserService;