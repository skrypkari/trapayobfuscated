'use strict';function a63_0x4022(_0x72a14b,_0x46278d){const _0x256115=a63_0x2561();return a63_0x4022=function(_0x402228,_0x4df5e8){_0x402228=_0x402228-0x151;let _0x478288=_0x256115[_0x402228];return _0x478288;},a63_0x4022(_0x72a14b,_0x46278d);}const a63_0x1a65a4=a63_0x4022;(function(_0x22fc0b,_0x296870){const _0x1cee32=a63_0x4022,_0x413500=_0x22fc0b();while(!![]){try{const _0x4da7de=parseInt(_0x1cee32(0x183))/0x1*(-parseInt(_0x1cee32(0x15b))/0x2)+-parseInt(_0x1cee32(0x151))/0x3+parseInt(_0x1cee32(0x187))/0x4+-parseInt(_0x1cee32(0x184))/0x5+-parseInt(_0x1cee32(0x182))/0x6+parseInt(_0x1cee32(0x17e))/0x7+parseInt(_0x1cee32(0x17f))/0x8;if(_0x4da7de===_0x296870)break;else _0x413500['push'](_0x413500['shift']());}catch(_0x34f354){_0x413500['push'](_0x413500['shift']());}}}(a63_0x2561,0x59983));var __importDefault=this&&this['__importDefault']||function(_0x4fdd62){return _0x4fdd62&&_0x4fdd62['__esModule']?_0x4fdd62:{'default':_0x4fdd62};};Object[a63_0x1a65a4(0x177)](exports,'__esModule',{'value':!![]}),exports[a63_0x1a65a4(0x181)]=void 0x0;const bcryptjs_1=__importDefault(require(a63_0x1a65a4(0x16d))),crypto_1=__importDefault(require(a63_0x1a65a4(0x157))),database_1=__importDefault(require(a63_0x1a65a4(0x168)));function a63_0x2561(){const _0x3826fa=['UserService','2277594fRzIbs','2105jMagMA','1682900UnvvjW','telegramId','createdAt','367356PngAAe','1145616GDepOK','shopUrl','wallets','createUser','merchantUrl','toString','crypto','findMany','usdcPolygonWallet','password','674lZNOdm','gatewaySettings','generateApiKeys','usdtPolygonWallet','deleteUser','findUnique','status','publicKey','usdtErcWallet','default','name','Username\x20already\x20exists','paymentGateways','../config/database','username','hex','updateUser','usdtTrcWallet','bcryptjs','create','gateways','parse','shop','getAllUsers','delete','getUserById','hash','telegram','defineProperty','ACTIVE','stringify','sk_','randomBytes','update','map','1521681HgKEQQ','14921544ifnWky','fullName'];a63_0x2561=function(){return _0x3826fa;};return a63_0x2561();}class UserService{[a63_0x1a65a4(0x15d)](){const _0x496869=a63_0x1a65a4,_0x3d509e='pk_'+crypto_1[_0x496869(0x164)][_0x496869(0x17b)](0x20)[_0x496869(0x156)](_0x496869(0x16a)),_0x3e73b5=_0x496869(0x17a)+crypto_1['default']['randomBytes'](0x20)['toString'](_0x496869(0x16a));return{'publicKey':_0x3d509e,'secretKey':_0x3e73b5};}async[a63_0x1a65a4(0x154)](_0x2e5930){const _0x37aee2=a63_0x1a65a4,{fullName:_0x5ed754,username:_0x37543b,password:_0x44ca81,telegramId:_0x22a77e,merchantUrl:_0x421c57,gateways:_0x1f28d5,gatewaySettings:_0x55af8a,wallets:_0x5026da}=_0x2e5930,_0xcf0cb1=await database_1[_0x37aee2(0x164)][_0x37aee2(0x171)][_0x37aee2(0x160)]({'where':{'username':_0x37543b}});if(_0xcf0cb1)throw new Error(_0x37aee2(0x166));if(_0x22a77e){const _0x1670a9=await database_1['default'][_0x37aee2(0x171)]['findUnique']({'where':{'telegram':_0x22a77e}});if(_0x1670a9)throw new Error('Telegram\x20username\x20already\x20exists');}const _0x39f1ba=await bcryptjs_1[_0x37aee2(0x164)][_0x37aee2(0x175)](_0x44ca81,0xc),{publicKey:_0x1d0870,secretKey:_0x5b17b2}=this[_0x37aee2(0x15d)](),_0x333fa7=await database_1[_0x37aee2(0x164)][_0x37aee2(0x171)][_0x37aee2(0x16e)]({'data':{'name':_0x5ed754,'username':_0x37543b,'password':_0x39f1ba,'telegram':_0x22a77e,'shopUrl':_0x421c57,'paymentGateways':_0x1f28d5?JSON['stringify'](_0x1f28d5):null,'gatewaySettings':_0x55af8a?JSON[_0x37aee2(0x179)](_0x55af8a):null,'usdtPolygonWallet':_0x5026da?.[_0x37aee2(0x15e)]||null,'usdtTrcWallet':_0x5026da?.['usdtTrcWallet']||null,'usdtErcWallet':_0x5026da?.[_0x37aee2(0x163)]||null,'usdcPolygonWallet':_0x5026da?.[_0x37aee2(0x159)]||null,'publicKey':_0x1d0870,'secretKey':_0x5b17b2,'status':_0x37aee2(0x178)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x333fa7['id'],'fullName':_0x333fa7[_0x37aee2(0x165)],'username':_0x333fa7[_0x37aee2(0x169)],'telegramId':_0x333fa7['telegram'],'merchantUrl':_0x333fa7[_0x37aee2(0x152)],'gateways':_0x333fa7['paymentGateways']?JSON[_0x37aee2(0x170)](_0x333fa7[_0x37aee2(0x167)]):null,'gatewaySettings':_0x333fa7[_0x37aee2(0x15c)]?JSON[_0x37aee2(0x170)](_0x333fa7[_0x37aee2(0x15c)]):null,'publicKey':_0x333fa7['publicKey'],'wallets':{'usdtPolygonWallet':_0x333fa7[_0x37aee2(0x15e)],'usdtTrcWallet':_0x333fa7['usdtTrcWallet'],'usdtErcWallet':_0x333fa7[_0x37aee2(0x163)],'usdcPolygonWallet':_0x333fa7[_0x37aee2(0x159)]},'status':_0x333fa7[_0x37aee2(0x161)],'createdAt':_0x333fa7[_0x37aee2(0x186)]};}async[a63_0x1a65a4(0x172)](){const _0xf3f529=a63_0x1a65a4,_0x1885dc=await database_1['default'][_0xf3f529(0x171)][_0xf3f529(0x158)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':'desc'}});return _0x1885dc[_0xf3f529(0x17d)](_0x71a154=>({'id':_0x71a154['id'],'fullName':_0x71a154['name'],'username':_0x71a154[_0xf3f529(0x169)],'telegramId':_0x71a154[_0xf3f529(0x176)],'merchantUrl':_0x71a154[_0xf3f529(0x152)],'gateways':_0x71a154['paymentGateways']?JSON[_0xf3f529(0x170)](_0x71a154[_0xf3f529(0x167)]):null,'gatewaySettings':_0x71a154[_0xf3f529(0x15c)]?JSON[_0xf3f529(0x170)](_0x71a154[_0xf3f529(0x15c)]):null,'publicKey':_0x71a154['publicKey'],'wallets':{'usdtPolygonWallet':_0x71a154['usdtPolygonWallet'],'usdtTrcWallet':_0x71a154['usdtTrcWallet'],'usdtErcWallet':_0x71a154[_0xf3f529(0x163)],'usdcPolygonWallet':_0x71a154[_0xf3f529(0x159)]},'status':_0x71a154[_0xf3f529(0x161)],'createdAt':_0x71a154[_0xf3f529(0x186)]}));}async[a63_0x1a65a4(0x174)](_0x3bb7a3){const _0x15029f=a63_0x1a65a4,_0x3e30ef=await database_1[_0x15029f(0x164)][_0x15029f(0x171)][_0x15029f(0x160)]({'where':{'id':_0x3bb7a3},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x3e30ef)return null;return{'id':_0x3e30ef['id'],'fullName':_0x3e30ef[_0x15029f(0x165)],'username':_0x3e30ef[_0x15029f(0x169)],'telegramId':_0x3e30ef[_0x15029f(0x176)],'merchantUrl':_0x3e30ef[_0x15029f(0x152)],'gateways':_0x3e30ef[_0x15029f(0x167)]?JSON[_0x15029f(0x170)](_0x3e30ef[_0x15029f(0x167)]):null,'gatewaySettings':_0x3e30ef[_0x15029f(0x15c)]?JSON[_0x15029f(0x170)](_0x3e30ef[_0x15029f(0x15c)]):null,'publicKey':_0x3e30ef[_0x15029f(0x162)],'wallets':{'usdtPolygonWallet':_0x3e30ef[_0x15029f(0x15e)],'usdtTrcWallet':_0x3e30ef[_0x15029f(0x16c)],'usdtErcWallet':_0x3e30ef['usdtErcWallet'],'usdcPolygonWallet':_0x3e30ef['usdcPolygonWallet']},'status':_0x3e30ef[_0x15029f(0x161)],'createdAt':_0x3e30ef[_0x15029f(0x186)]};}async[a63_0x1a65a4(0x16b)](_0x5f1aee,_0x198163){const _0x517e4b=a63_0x1a65a4,_0x20815a={..._0x198163};_0x198163[_0x517e4b(0x15a)]&&(_0x20815a['password']=await bcryptjs_1[_0x517e4b(0x164)][_0x517e4b(0x175)](_0x198163['password'],0xc));_0x198163[_0x517e4b(0x180)]&&(_0x20815a[_0x517e4b(0x165)]=_0x198163[_0x517e4b(0x180)],delete _0x20815a['fullName']);_0x198163[_0x517e4b(0x185)]&&(_0x20815a['telegram']=_0x198163[_0x517e4b(0x185)],delete _0x20815a[_0x517e4b(0x185)]);_0x198163[_0x517e4b(0x155)]&&(_0x20815a[_0x517e4b(0x152)]=_0x198163[_0x517e4b(0x155)],delete _0x20815a[_0x517e4b(0x155)]);_0x198163[_0x517e4b(0x16f)]&&(_0x20815a[_0x517e4b(0x167)]=JSON[_0x517e4b(0x179)](_0x198163['gateways']),delete _0x20815a[_0x517e4b(0x16f)]);_0x198163[_0x517e4b(0x15c)]&&(_0x20815a[_0x517e4b(0x15c)]=JSON['stringify'](_0x198163[_0x517e4b(0x15c)]),delete _0x20815a[_0x517e4b(0x15c)]);_0x198163[_0x517e4b(0x153)]&&(_0x198163[_0x517e4b(0x153)]['usdtPolygonWallet']!==undefined&&(_0x20815a[_0x517e4b(0x15e)]=_0x198163[_0x517e4b(0x153)][_0x517e4b(0x15e)]||null),_0x198163[_0x517e4b(0x153)][_0x517e4b(0x16c)]!==undefined&&(_0x20815a['usdtTrcWallet']=_0x198163['wallets'][_0x517e4b(0x16c)]||null),_0x198163[_0x517e4b(0x153)][_0x517e4b(0x163)]!==undefined&&(_0x20815a['usdtErcWallet']=_0x198163[_0x517e4b(0x153)][_0x517e4b(0x163)]||null),_0x198163[_0x517e4b(0x153)][_0x517e4b(0x159)]!==undefined&&(_0x20815a['usdcPolygonWallet']=_0x198163[_0x517e4b(0x153)][_0x517e4b(0x159)]||null),delete _0x20815a['wallets']);const _0x53ec9b=await database_1['default'][_0x517e4b(0x171)][_0x517e4b(0x17c)]({'where':{'id':_0x5f1aee},'data':_0x20815a,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x53ec9b['id'],'fullName':_0x53ec9b[_0x517e4b(0x165)],'username':_0x53ec9b['username'],'telegramId':_0x53ec9b[_0x517e4b(0x176)],'merchantUrl':_0x53ec9b[_0x517e4b(0x152)],'gateways':_0x53ec9b[_0x517e4b(0x167)]?JSON[_0x517e4b(0x170)](_0x53ec9b['paymentGateways']):null,'gatewaySettings':_0x53ec9b[_0x517e4b(0x15c)]?JSON[_0x517e4b(0x170)](_0x53ec9b[_0x517e4b(0x15c)]):null,'publicKey':_0x53ec9b[_0x517e4b(0x162)],'wallets':{'usdtPolygonWallet':_0x53ec9b['usdtPolygonWallet'],'usdtTrcWallet':_0x53ec9b['usdtTrcWallet'],'usdtErcWallet':_0x53ec9b[_0x517e4b(0x163)],'usdcPolygonWallet':_0x53ec9b[_0x517e4b(0x159)]},'status':_0x53ec9b[_0x517e4b(0x161)],'createdAt':_0x53ec9b[_0x517e4b(0x186)]};}async[a63_0x1a65a4(0x15f)](_0x268009){const _0x4830c6=a63_0x1a65a4;await database_1['default']['shop'][_0x4830c6(0x173)]({'where':{'id':_0x268009}});}}exports[a63_0x1a65a4(0x181)]=UserService;