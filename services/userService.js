'use strict';const a51_0x321d9e=a51_0x3cda;(function(_0x3ea3c3,_0x551934){const _0x10d4e6=a51_0x3cda,_0x48dc96=_0x3ea3c3();while(!![]){try{const _0x5afbf7=-parseInt(_0x10d4e6(0x98))/0x1+parseInt(_0x10d4e6(0x81))/0x2*(-parseInt(_0x10d4e6(0x8d))/0x3)+parseInt(_0x10d4e6(0x7d))/0x4*(-parseInt(_0x10d4e6(0xa2))/0x5)+-parseInt(_0x10d4e6(0x7c))/0x6*(parseInt(_0x10d4e6(0xa0))/0x7)+parseInt(_0x10d4e6(0xa9))/0x8*(parseInt(_0x10d4e6(0x9d))/0x9)+-parseInt(_0x10d4e6(0x85))/0xa*(-parseInt(_0x10d4e6(0x77))/0xb)+-parseInt(_0x10d4e6(0xa8))/0xc;if(_0x5afbf7===_0x551934)break;else _0x48dc96['push'](_0x48dc96['shift']());}catch(_0x37fb1d){_0x48dc96['push'](_0x48dc96['shift']());}}}(a51_0x349d,0x1d5a8));var __importDefault=this&&this['__importDefault']||function(_0x4a0416){const _0x5b76b9=a51_0x3cda;return _0x4a0416&&_0x4a0416[_0x5b76b9(0x94)]?_0x4a0416:{'default':_0x4a0416};};Object['defineProperty'](exports,a51_0x321d9e(0x94),{'value':!![]}),exports['UserService']=void 0x0;const bcryptjs_1=__importDefault(require(a51_0x321d9e(0x93))),crypto_1=__importDefault(require('crypto')),database_1=__importDefault(require('../config/database'));function a51_0x349d(){const _0x4e6245=['getUserById','parse','995067QKTpUf','username','toString','5285WwIjdM','UserService','5HEUFoH','Telegram\x20username\x20already\x20exists','password','usdtPolygonWallet','stringify','usdtErcWallet','441132PmUWqr','16zsKITU','shop','default','hex','deleteUser','create','wallets','11zLpQlg','updateUser','findMany','Username\x20already\x20exists','merchantUrl','48bpkQXO','706004OwBnYN','telegramId','name','gateways','526jOKPsT','paymentGateways','delete','update','2285090AjzUXa','pk_','createdAt','status','findUnique','usdcPolygonWallet','generateApiKeys','usdtTrcWallet','1173dsNQku','gatewaySettings','hash','map','shopUrl','telegram','bcryptjs','__esModule','getAllUsers','randomBytes','fullName','7268ZOLfup','desc','publicKey'];a51_0x349d=function(){return _0x4e6245;};return a51_0x349d();}class UserService{[a51_0x321d9e(0x8b)](){const _0x27eb6d=a51_0x321d9e,_0x46f6c8=_0x27eb6d(0x86)+crypto_1['default'][_0x27eb6d(0x96)](0x20)['toString'](_0x27eb6d(0x73)),_0x342437='sk_'+crypto_1[_0x27eb6d(0xab)][_0x27eb6d(0x96)](0x20)[_0x27eb6d(0x9f)]('hex');return{'publicKey':_0x46f6c8,'secretKey':_0x342437};}async['createUser'](_0xc8eebd){const _0x2ee1ee=a51_0x321d9e,{fullName:_0x2fb611,username:_0x4a354a,password:_0x41b9ae,telegramId:_0x5dd793,merchantUrl:_0x41dbba,gateways:_0x525bca,gatewaySettings:_0x588a41,wallets:_0x2b41e7}=_0xc8eebd,_0xab05e4=await database_1[_0x2ee1ee(0xab)][_0x2ee1ee(0xaa)]['findUnique']({'where':{'username':_0x4a354a}});if(_0xab05e4)throw new Error(_0x2ee1ee(0x7a));if(_0x5dd793){const _0x5f23ba=await database_1['default'][_0x2ee1ee(0xaa)]['findUnique']({'where':{'telegram':_0x5dd793}});if(_0x5f23ba)throw new Error(_0x2ee1ee(0xa3));}const _0x273711=await bcryptjs_1[_0x2ee1ee(0xab)]['hash'](_0x41b9ae,0xc),{publicKey:_0xd3713e,secretKey:_0x5657f0}=this['generateApiKeys'](),_0x5c56a8=await database_1[_0x2ee1ee(0xab)][_0x2ee1ee(0xaa)][_0x2ee1ee(0x75)]({'data':{'name':_0x2fb611,'username':_0x4a354a,'password':_0x273711,'telegram':_0x5dd793,'shopUrl':_0x41dbba,'paymentGateways':_0x525bca?JSON[_0x2ee1ee(0xa6)](_0x525bca):null,'gatewaySettings':_0x588a41?JSON['stringify'](_0x588a41):null,'usdtPolygonWallet':_0x2b41e7?.[_0x2ee1ee(0xa5)]||null,'usdtTrcWallet':_0x2b41e7?.[_0x2ee1ee(0x8c)]||null,'usdtErcWallet':_0x2b41e7?.['usdtErcWallet']||null,'usdcPolygonWallet':_0x2b41e7?.[_0x2ee1ee(0x8a)]||null,'publicKey':_0xd3713e,'secretKey':_0x5657f0,'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x5c56a8['id'],'fullName':_0x5c56a8[_0x2ee1ee(0x7f)],'username':_0x5c56a8[_0x2ee1ee(0x9e)],'telegramId':_0x5c56a8[_0x2ee1ee(0x92)],'merchantUrl':_0x5c56a8['shopUrl'],'gateways':_0x5c56a8['paymentGateways']?JSON[_0x2ee1ee(0x9c)](_0x5c56a8[_0x2ee1ee(0x82)]):null,'gatewaySettings':_0x5c56a8[_0x2ee1ee(0x8e)]?JSON[_0x2ee1ee(0x9c)](_0x5c56a8['gatewaySettings']):null,'publicKey':_0x5c56a8[_0x2ee1ee(0x9a)],'wallets':{'usdtPolygonWallet':_0x5c56a8[_0x2ee1ee(0xa5)],'usdtTrcWallet':_0x5c56a8['usdtTrcWallet'],'usdtErcWallet':_0x5c56a8[_0x2ee1ee(0xa7)],'usdcPolygonWallet':_0x5c56a8[_0x2ee1ee(0x8a)]},'status':_0x5c56a8[_0x2ee1ee(0x88)],'createdAt':_0x5c56a8[_0x2ee1ee(0x87)]};}async[a51_0x321d9e(0x95)](){const _0x3685ad=a51_0x321d9e,_0x41b327=await database_1[_0x3685ad(0xab)][_0x3685ad(0xaa)][_0x3685ad(0x79)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x3685ad(0x99)}});return _0x41b327[_0x3685ad(0x90)](_0x29c4a5=>({'id':_0x29c4a5['id'],'fullName':_0x29c4a5[_0x3685ad(0x7f)],'username':_0x29c4a5[_0x3685ad(0x9e)],'telegramId':_0x29c4a5[_0x3685ad(0x92)],'merchantUrl':_0x29c4a5[_0x3685ad(0x91)],'gateways':_0x29c4a5[_0x3685ad(0x82)]?JSON[_0x3685ad(0x9c)](_0x29c4a5[_0x3685ad(0x82)]):null,'gatewaySettings':_0x29c4a5['gatewaySettings']?JSON[_0x3685ad(0x9c)](_0x29c4a5['gatewaySettings']):null,'publicKey':_0x29c4a5['publicKey'],'wallets':{'usdtPolygonWallet':_0x29c4a5['usdtPolygonWallet'],'usdtTrcWallet':_0x29c4a5[_0x3685ad(0x8c)],'usdtErcWallet':_0x29c4a5[_0x3685ad(0xa7)],'usdcPolygonWallet':_0x29c4a5[_0x3685ad(0x8a)]},'status':_0x29c4a5[_0x3685ad(0x88)],'createdAt':_0x29c4a5['createdAt']}));}async[a51_0x321d9e(0x9b)](_0x547ce5){const _0x4c4a19=a51_0x321d9e,_0x576c7a=await database_1['default'][_0x4c4a19(0xaa)][_0x4c4a19(0x89)]({'where':{'id':_0x547ce5},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x576c7a)return null;return{'id':_0x576c7a['id'],'fullName':_0x576c7a[_0x4c4a19(0x7f)],'username':_0x576c7a[_0x4c4a19(0x9e)],'telegramId':_0x576c7a[_0x4c4a19(0x92)],'merchantUrl':_0x576c7a[_0x4c4a19(0x91)],'gateways':_0x576c7a['paymentGateways']?JSON[_0x4c4a19(0x9c)](_0x576c7a[_0x4c4a19(0x82)]):null,'gatewaySettings':_0x576c7a[_0x4c4a19(0x8e)]?JSON[_0x4c4a19(0x9c)](_0x576c7a['gatewaySettings']):null,'publicKey':_0x576c7a[_0x4c4a19(0x9a)],'wallets':{'usdtPolygonWallet':_0x576c7a[_0x4c4a19(0xa5)],'usdtTrcWallet':_0x576c7a[_0x4c4a19(0x8c)],'usdtErcWallet':_0x576c7a['usdtErcWallet'],'usdcPolygonWallet':_0x576c7a[_0x4c4a19(0x8a)]},'status':_0x576c7a[_0x4c4a19(0x88)],'createdAt':_0x576c7a['createdAt']};}async[a51_0x321d9e(0x78)](_0x1b94b7,_0x4a3623){const _0x53b4ca=a51_0x321d9e,_0x189c37={..._0x4a3623};_0x4a3623['password']&&(_0x189c37[_0x53b4ca(0xa4)]=await bcryptjs_1[_0x53b4ca(0xab)][_0x53b4ca(0x8f)](_0x4a3623[_0x53b4ca(0xa4)],0xc));_0x4a3623[_0x53b4ca(0x97)]&&(_0x189c37['name']=_0x4a3623[_0x53b4ca(0x97)],delete _0x189c37[_0x53b4ca(0x97)]);_0x4a3623[_0x53b4ca(0x7e)]&&(_0x189c37['telegram']=_0x4a3623[_0x53b4ca(0x7e)],delete _0x189c37['telegramId']);_0x4a3623[_0x53b4ca(0x7b)]&&(_0x189c37[_0x53b4ca(0x91)]=_0x4a3623[_0x53b4ca(0x7b)],delete _0x189c37[_0x53b4ca(0x7b)]);_0x4a3623['gateways']&&(_0x189c37[_0x53b4ca(0x82)]=JSON['stringify'](_0x4a3623[_0x53b4ca(0x80)]),delete _0x189c37[_0x53b4ca(0x80)]);_0x4a3623[_0x53b4ca(0x8e)]&&(_0x189c37[_0x53b4ca(0x8e)]=JSON[_0x53b4ca(0xa6)](_0x4a3623[_0x53b4ca(0x8e)]),delete _0x189c37[_0x53b4ca(0x8e)]);_0x4a3623[_0x53b4ca(0x76)]&&(_0x4a3623['wallets']['usdtPolygonWallet']!==undefined&&(_0x189c37[_0x53b4ca(0xa5)]=_0x4a3623[_0x53b4ca(0x76)][_0x53b4ca(0xa5)]||null),_0x4a3623[_0x53b4ca(0x76)][_0x53b4ca(0x8c)]!==undefined&&(_0x189c37[_0x53b4ca(0x8c)]=_0x4a3623[_0x53b4ca(0x76)][_0x53b4ca(0x8c)]||null),_0x4a3623[_0x53b4ca(0x76)][_0x53b4ca(0xa7)]!==undefined&&(_0x189c37[_0x53b4ca(0xa7)]=_0x4a3623['wallets']['usdtErcWallet']||null),_0x4a3623[_0x53b4ca(0x76)][_0x53b4ca(0x8a)]!==undefined&&(_0x189c37[_0x53b4ca(0x8a)]=_0x4a3623[_0x53b4ca(0x76)]['usdcPolygonWallet']||null),delete _0x189c37[_0x53b4ca(0x76)]);const _0xfdeb1=await database_1[_0x53b4ca(0xab)][_0x53b4ca(0xaa)][_0x53b4ca(0x84)]({'where':{'id':_0x1b94b7},'data':_0x189c37,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0xfdeb1['id'],'fullName':_0xfdeb1[_0x53b4ca(0x7f)],'username':_0xfdeb1[_0x53b4ca(0x9e)],'telegramId':_0xfdeb1[_0x53b4ca(0x92)],'merchantUrl':_0xfdeb1['shopUrl'],'gateways':_0xfdeb1['paymentGateways']?JSON['parse'](_0xfdeb1[_0x53b4ca(0x82)]):null,'gatewaySettings':_0xfdeb1[_0x53b4ca(0x8e)]?JSON[_0x53b4ca(0x9c)](_0xfdeb1[_0x53b4ca(0x8e)]):null,'publicKey':_0xfdeb1[_0x53b4ca(0x9a)],'wallets':{'usdtPolygonWallet':_0xfdeb1['usdtPolygonWallet'],'usdtTrcWallet':_0xfdeb1['usdtTrcWallet'],'usdtErcWallet':_0xfdeb1['usdtErcWallet'],'usdcPolygonWallet':_0xfdeb1[_0x53b4ca(0x8a)]},'status':_0xfdeb1[_0x53b4ca(0x88)],'createdAt':_0xfdeb1[_0x53b4ca(0x87)]};}async[a51_0x321d9e(0x74)](_0x456bdc){const _0xb7d0e0=a51_0x321d9e;await database_1[_0xb7d0e0(0xab)]['shop'][_0xb7d0e0(0x83)]({'where':{'id':_0x456bdc}});}}function a51_0x3cda(_0x319338,_0x49c905){const _0x349d93=a51_0x349d();return a51_0x3cda=function(_0x3cda3a,_0x5ba3d9){_0x3cda3a=_0x3cda3a-0x73;let _0x1ac601=_0x349d93[_0x3cda3a];return _0x1ac601;},a51_0x3cda(_0x319338,_0x49c905);}exports[a51_0x321d9e(0xa1)]=UserService;