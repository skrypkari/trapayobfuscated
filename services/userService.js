'use strict';const a55_0x1eb125=a55_0x1e67;function a55_0x1e67(_0x5800c0,_0x1812a8){const _0x17330e=a55_0x1733();return a55_0x1e67=function(_0x1e67eb,_0x2f0624){_0x1e67eb=_0x1e67eb-0x1e1;let _0xe5fc2=_0x17330e[_0x1e67eb];return _0xe5fc2;},a55_0x1e67(_0x5800c0,_0x1812a8);}(function(_0x105acc,_0x377122){const _0x40eb2c=a55_0x1e67,_0x2c3dd6=_0x105acc();while(!![]){try{const _0x539c47=-parseInt(_0x40eb2c(0x1e9))/0x1*(parseInt(_0x40eb2c(0x1e1))/0x2)+-parseInt(_0x40eb2c(0x1f1))/0x3+parseInt(_0x40eb2c(0x204))/0x4*(parseInt(_0x40eb2c(0x1ff))/0x5)+parseInt(_0x40eb2c(0x1ec))/0x6+parseInt(_0x40eb2c(0x1e4))/0x7+-parseInt(_0x40eb2c(0x1ef))/0x8*(-parseInt(_0x40eb2c(0x209))/0x9)+parseInt(_0x40eb2c(0x20b))/0xa*(-parseInt(_0x40eb2c(0x214))/0xb);if(_0x539c47===_0x377122)break;else _0x2c3dd6['push'](_0x2c3dd6['shift']());}catch(_0x2d0261){_0x2c3dd6['push'](_0x2c3dd6['shift']());}}}(a55_0x1733,0x2ea24));var __importDefault=this&&this[a55_0x1eb125(0x1ea)]||function(_0x595acb){const _0x39b7d0=a55_0x1eb125;return _0x595acb&&_0x595acb[_0x39b7d0(0x212)]?_0x595acb:{'default':_0x595acb};};function a55_0x1733(){const _0xaf55ad=['pk_','2664980rIEjEk','telegramId','UserService','findMany','shopUrl','usdtErcWallet','usdtTrcWallet','__esModule','publicKey','11FJedHy','toString','deleteUser','password','gatewaySettings','432920odBkfm','sk_','map','1422820cLGmzk','ACTIVE','findUnique','defineProperty','crypto','1DWciMX','__importDefault','usdcPolygonWallet','1080270pfsqED','createUser','paymentGateways','156560pyMjlF','default','872271vRrVwC','parse','shop','name','desc','hash','fullName','gateways','bcryptjs','generateApiKeys','merchantUrl','create','telegram','stringify','2380QZkakg','wallets','randomBytes','username','createdAt','2748GVqrxw','hex','usdtPolygonWallet','status','updateUser','117kWaCDe'];a55_0x1733=function(){return _0xaf55ad;};return a55_0x1733();}Object[a55_0x1eb125(0x1e7)](exports,a55_0x1eb125(0x212),{'value':!![]}),exports[a55_0x1eb125(0x20d)]=void 0x0;const bcryptjs_1=__importDefault(require(a55_0x1eb125(0x1f9))),crypto_1=__importDefault(require(a55_0x1eb125(0x1e8))),database_1=__importDefault(require('../config/database'));class UserService{[a55_0x1eb125(0x1fa)](){const _0x299713=a55_0x1eb125,_0x439259=_0x299713(0x20a)+crypto_1[_0x299713(0x1f0)][_0x299713(0x201)](0x20)[_0x299713(0x215)](_0x299713(0x205)),_0x1fd08f=_0x299713(0x1e2)+crypto_1[_0x299713(0x1f0)][_0x299713(0x201)](0x20)['toString'](_0x299713(0x205));return{'publicKey':_0x439259,'secretKey':_0x1fd08f};}async[a55_0x1eb125(0x1ed)](_0x2730b7){const _0x511edc=a55_0x1eb125,{fullName:_0x2db2ad,username:_0xe6de7b,password:_0x490ac3,telegramId:_0x4aebbb,merchantUrl:_0x3d4921,gateways:_0x12146b,gatewaySettings:_0x2753f2,wallets:_0xab9a56}=_0x2730b7,_0x31e349=await database_1[_0x511edc(0x1f0)][_0x511edc(0x1f3)][_0x511edc(0x1e6)]({'where':{'username':_0xe6de7b}});if(_0x31e349)throw new Error('Username\x20already\x20exists');if(_0x4aebbb){const _0x1fcb37=await database_1[_0x511edc(0x1f0)]['shop'][_0x511edc(0x1e6)]({'where':{'telegram':_0x4aebbb}});if(_0x1fcb37)throw new Error('Telegram\x20username\x20already\x20exists');}const _0x4571f4=await bcryptjs_1[_0x511edc(0x1f0)][_0x511edc(0x1f6)](_0x490ac3,0xc),{publicKey:_0x3b3e85,secretKey:_0x3d7438}=this[_0x511edc(0x1fa)](),_0x347f80=await database_1['default'][_0x511edc(0x1f3)][_0x511edc(0x1fc)]({'data':{'name':_0x2db2ad,'username':_0xe6de7b,'password':_0x4571f4,'telegram':_0x4aebbb,'shopUrl':_0x3d4921,'paymentGateways':_0x12146b?JSON['stringify'](_0x12146b):null,'gatewaySettings':_0x2753f2?JSON[_0x511edc(0x1fe)](_0x2753f2):null,'usdtPolygonWallet':_0xab9a56?.[_0x511edc(0x206)]||null,'usdtTrcWallet':_0xab9a56?.[_0x511edc(0x211)]||null,'usdtErcWallet':_0xab9a56?.[_0x511edc(0x210)]||null,'usdcPolygonWallet':_0xab9a56?.['usdcPolygonWallet']||null,'publicKey':_0x3b3e85,'secretKey':_0x3d7438,'status':_0x511edc(0x1e5)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x347f80['id'],'fullName':_0x347f80[_0x511edc(0x1f4)],'username':_0x347f80['username'],'telegramId':_0x347f80[_0x511edc(0x1fd)],'merchantUrl':_0x347f80[_0x511edc(0x20f)],'gateways':_0x347f80[_0x511edc(0x1ee)]?JSON['parse'](_0x347f80[_0x511edc(0x1ee)]):null,'gatewaySettings':_0x347f80[_0x511edc(0x218)]?JSON[_0x511edc(0x1f2)](_0x347f80[_0x511edc(0x218)]):null,'publicKey':_0x347f80[_0x511edc(0x213)],'wallets':{'usdtPolygonWallet':_0x347f80[_0x511edc(0x206)],'usdtTrcWallet':_0x347f80['usdtTrcWallet'],'usdtErcWallet':_0x347f80[_0x511edc(0x210)],'usdcPolygonWallet':_0x347f80[_0x511edc(0x1eb)]},'status':_0x347f80['status'],'createdAt':_0x347f80['createdAt']};}async['getAllUsers'](){const _0x312fd9=a55_0x1eb125,_0x3a5112=await database_1[_0x312fd9(0x1f0)]['shop'][_0x312fd9(0x20e)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x312fd9(0x1f5)}});return _0x3a5112[_0x312fd9(0x1e3)](_0x5cd955=>({'id':_0x5cd955['id'],'fullName':_0x5cd955[_0x312fd9(0x1f4)],'username':_0x5cd955['username'],'telegramId':_0x5cd955['telegram'],'merchantUrl':_0x5cd955[_0x312fd9(0x20f)],'gateways':_0x5cd955[_0x312fd9(0x1ee)]?JSON[_0x312fd9(0x1f2)](_0x5cd955['paymentGateways']):null,'gatewaySettings':_0x5cd955['gatewaySettings']?JSON[_0x312fd9(0x1f2)](_0x5cd955[_0x312fd9(0x218)]):null,'publicKey':_0x5cd955['publicKey'],'wallets':{'usdtPolygonWallet':_0x5cd955[_0x312fd9(0x206)],'usdtTrcWallet':_0x5cd955[_0x312fd9(0x211)],'usdtErcWallet':_0x5cd955['usdtErcWallet'],'usdcPolygonWallet':_0x5cd955['usdcPolygonWallet']},'status':_0x5cd955[_0x312fd9(0x207)],'createdAt':_0x5cd955[_0x312fd9(0x203)]}));}async['getUserById'](_0x2ef775){const _0x55ae09=a55_0x1eb125,_0x176606=await database_1[_0x55ae09(0x1f0)][_0x55ae09(0x1f3)][_0x55ae09(0x1e6)]({'where':{'id':_0x2ef775},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x176606)return null;return{'id':_0x176606['id'],'fullName':_0x176606[_0x55ae09(0x1f4)],'username':_0x176606[_0x55ae09(0x202)],'telegramId':_0x176606[_0x55ae09(0x1fd)],'merchantUrl':_0x176606[_0x55ae09(0x20f)],'gateways':_0x176606[_0x55ae09(0x1ee)]?JSON[_0x55ae09(0x1f2)](_0x176606[_0x55ae09(0x1ee)]):null,'gatewaySettings':_0x176606[_0x55ae09(0x218)]?JSON[_0x55ae09(0x1f2)](_0x176606['gatewaySettings']):null,'publicKey':_0x176606['publicKey'],'wallets':{'usdtPolygonWallet':_0x176606['usdtPolygonWallet'],'usdtTrcWallet':_0x176606[_0x55ae09(0x211)],'usdtErcWallet':_0x176606[_0x55ae09(0x210)],'usdcPolygonWallet':_0x176606['usdcPolygonWallet']},'status':_0x176606[_0x55ae09(0x207)],'createdAt':_0x176606[_0x55ae09(0x203)]};}async[a55_0x1eb125(0x208)](_0x2fec9f,_0x38e90b){const _0xab5b0c=a55_0x1eb125,_0x348dc8={..._0x38e90b};_0x38e90b[_0xab5b0c(0x217)]&&(_0x348dc8['password']=await bcryptjs_1['default'][_0xab5b0c(0x1f6)](_0x38e90b['password'],0xc));_0x38e90b['fullName']&&(_0x348dc8['name']=_0x38e90b[_0xab5b0c(0x1f7)],delete _0x348dc8[_0xab5b0c(0x1f7)]);_0x38e90b['telegramId']&&(_0x348dc8[_0xab5b0c(0x1fd)]=_0x38e90b[_0xab5b0c(0x20c)],delete _0x348dc8[_0xab5b0c(0x20c)]);_0x38e90b[_0xab5b0c(0x1fb)]&&(_0x348dc8[_0xab5b0c(0x20f)]=_0x38e90b['merchantUrl'],delete _0x348dc8[_0xab5b0c(0x1fb)]);_0x38e90b[_0xab5b0c(0x1f8)]&&(_0x348dc8[_0xab5b0c(0x1ee)]=JSON[_0xab5b0c(0x1fe)](_0x38e90b['gateways']),delete _0x348dc8[_0xab5b0c(0x1f8)]);_0x38e90b['gatewaySettings']&&(_0x348dc8[_0xab5b0c(0x218)]=JSON['stringify'](_0x38e90b[_0xab5b0c(0x218)]),delete _0x348dc8[_0xab5b0c(0x218)]);_0x38e90b[_0xab5b0c(0x200)]&&(_0x38e90b[_0xab5b0c(0x200)][_0xab5b0c(0x206)]!==undefined&&(_0x348dc8[_0xab5b0c(0x206)]=_0x38e90b['wallets'][_0xab5b0c(0x206)]||null),_0x38e90b['wallets'][_0xab5b0c(0x211)]!==undefined&&(_0x348dc8[_0xab5b0c(0x211)]=_0x38e90b['wallets'][_0xab5b0c(0x211)]||null),_0x38e90b['wallets'][_0xab5b0c(0x210)]!==undefined&&(_0x348dc8[_0xab5b0c(0x210)]=_0x38e90b[_0xab5b0c(0x200)]['usdtErcWallet']||null),_0x38e90b[_0xab5b0c(0x200)][_0xab5b0c(0x1eb)]!==undefined&&(_0x348dc8[_0xab5b0c(0x1eb)]=_0x38e90b[_0xab5b0c(0x200)]['usdcPolygonWallet']||null),delete _0x348dc8[_0xab5b0c(0x200)]);const _0x3f9873=await database_1['default']['shop']['update']({'where':{'id':_0x2fec9f},'data':_0x348dc8,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x3f9873['id'],'fullName':_0x3f9873[_0xab5b0c(0x1f4)],'username':_0x3f9873[_0xab5b0c(0x202)],'telegramId':_0x3f9873[_0xab5b0c(0x1fd)],'merchantUrl':_0x3f9873[_0xab5b0c(0x20f)],'gateways':_0x3f9873[_0xab5b0c(0x1ee)]?JSON['parse'](_0x3f9873[_0xab5b0c(0x1ee)]):null,'gatewaySettings':_0x3f9873[_0xab5b0c(0x218)]?JSON[_0xab5b0c(0x1f2)](_0x3f9873[_0xab5b0c(0x218)]):null,'publicKey':_0x3f9873[_0xab5b0c(0x213)],'wallets':{'usdtPolygonWallet':_0x3f9873['usdtPolygonWallet'],'usdtTrcWallet':_0x3f9873[_0xab5b0c(0x211)],'usdtErcWallet':_0x3f9873[_0xab5b0c(0x210)],'usdcPolygonWallet':_0x3f9873['usdcPolygonWallet']},'status':_0x3f9873[_0xab5b0c(0x207)],'createdAt':_0x3f9873['createdAt']};}async[a55_0x1eb125(0x216)](_0x4e6c09){const _0x4e6778=a55_0x1eb125;await database_1['default'][_0x4e6778(0x1f3)]['delete']({'where':{'id':_0x4e6c09}});}}exports[a55_0x1eb125(0x20d)]=UserService;