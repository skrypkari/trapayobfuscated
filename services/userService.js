'use strict';const a82_0xfe0c2e=a82_0x18a6;(function(_0x619531,_0x50eb7c){const _0x3b0505=a82_0x18a6,_0x2a8a07=_0x619531();while(!![]){try{const _0x3af411=-parseInt(_0x3b0505(0x1df))/0x1+parseInt(_0x3b0505(0x1f0))/0x2*(parseInt(_0x3b0505(0x1cc))/0x3)+parseInt(_0x3b0505(0x1e6))/0x4*(parseInt(_0x3b0505(0x1d3))/0x5)+-parseInt(_0x3b0505(0x1c7))/0x6*(-parseInt(_0x3b0505(0x1cb))/0x7)+-parseInt(_0x3b0505(0x1ea))/0x8*(parseInt(_0x3b0505(0x1e3))/0x9)+parseInt(_0x3b0505(0x1d2))/0xa*(-parseInt(_0x3b0505(0x1ca))/0xb)+-parseInt(_0x3b0505(0x1f3))/0xc;if(_0x3af411===_0x50eb7c)break;else _0x2a8a07['push'](_0x2a8a07['shift']());}catch(_0x6eded4){_0x2a8a07['push'](_0x2a8a07['shift']());}}}(a82_0x435d,0x86e95));function a82_0x18a6(_0xc70ed2,_0x5759db){_0xc70ed2=_0xc70ed2-0x1c2;const _0x435dbb=a82_0x435d();let _0x18a6dc=_0x435dbb[_0xc70ed2];return _0x18a6dc;}var __importDefault=this&&this[a82_0xfe0c2e(0x1c5)]||function(_0x530176){const _0x446536=a82_0xfe0c2e;return _0x530176&&_0x530176[_0x446536(0x1f5)]?_0x530176:{'default':_0x530176};};function a82_0x435d(){const _0x1425ec=['createdAt','hex','status','merchantUrl','getAllUsers','delete','UserService','__importDefault','bcryptjs','4086GviFme','default','usdcPolygonWallet','115148QfGhMV','7518qrIPhp','3302817DQKDqo','username','telegram','parse','name','usdtErcWallet','310gtPlfL','5jIuHkF','randomBytes','shopUrl','publicKey','findUnique','../config/database','Telegram\x20username\x20already\x20exists','telegramId','sk_','hash','password','toString','258194ZOGryt','shop','usdtTrcWallet','createUser','1244403LOHTqd','stringify','fullName','812904VaolYS','wallets','create','findMany','48aYkEyc','map','getUserById','ACTIVE','paymentGateways','gateways','2fhpnch','usdtPolygonWallet','gatewaySettings','847896zBfwcm','updateUser','__esModule'];a82_0x435d=function(){return _0x1425ec;};return a82_0x435d();}Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a82_0xfe0c2e(0x1c4)]=void 0x0;const bcryptjs_1=__importDefault(require(a82_0xfe0c2e(0x1c6))),crypto_1=__importDefault(require('crypto')),database_1=__importDefault(require(a82_0xfe0c2e(0x1d8)));class UserService{['generateApiKeys'](){const _0xb0c45d=a82_0xfe0c2e,_0x3a3547='pk_'+crypto_1[_0xb0c45d(0x1c8)][_0xb0c45d(0x1d4)](0x20)[_0xb0c45d(0x1de)](_0xb0c45d(0x1f7)),_0x8d9c16=_0xb0c45d(0x1db)+crypto_1['default'][_0xb0c45d(0x1d4)](0x20)[_0xb0c45d(0x1de)](_0xb0c45d(0x1f7));return{'publicKey':_0x3a3547,'secretKey':_0x8d9c16};}async[a82_0xfe0c2e(0x1e2)](_0x381531){const _0x164e75=a82_0xfe0c2e,{fullName:_0x3b4d94,username:_0x4de667,password:_0x17ee73,telegramId:_0x3aaac1,merchantUrl:_0x3007b1,gateways:_0x20d33e,gatewaySettings:_0x333435,wallets:_0x150d4d}=_0x381531,_0xbb7fbd=await database_1[_0x164e75(0x1c8)][_0x164e75(0x1e0)][_0x164e75(0x1d7)]({'where':{'username':_0x4de667}});if(_0xbb7fbd)throw new Error('Username\x20already\x20exists');if(_0x3aaac1){const _0x3c2baf=await database_1[_0x164e75(0x1c8)][_0x164e75(0x1e0)]['findUnique']({'where':{'telegram':_0x3aaac1}});if(_0x3c2baf)throw new Error(_0x164e75(0x1d9));}const _0x3235b4=await bcryptjs_1[_0x164e75(0x1c8)][_0x164e75(0x1dc)](_0x17ee73,0xc),{publicKey:_0xddca49,secretKey:_0x545c2b}=this['generateApiKeys'](),_0x5d1c5b=await database_1[_0x164e75(0x1c8)][_0x164e75(0x1e0)][_0x164e75(0x1e8)]({'data':{'name':_0x3b4d94,'username':_0x4de667,'password':_0x3235b4,'telegram':_0x3aaac1,'shopUrl':_0x3007b1,'paymentGateways':_0x20d33e?JSON[_0x164e75(0x1e4)](_0x20d33e):null,'gatewaySettings':_0x333435?JSON[_0x164e75(0x1e4)](_0x333435):null,'usdtPolygonWallet':_0x150d4d?.[_0x164e75(0x1f1)]||null,'usdtTrcWallet':_0x150d4d?.[_0x164e75(0x1e1)]||null,'usdtErcWallet':_0x150d4d?.['usdtErcWallet']||null,'usdcPolygonWallet':_0x150d4d?.['usdcPolygonWallet']||null,'publicKey':_0xddca49,'secretKey':_0x545c2b,'status':_0x164e75(0x1ed)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x5d1c5b['id'],'fullName':_0x5d1c5b['name'],'username':_0x5d1c5b[_0x164e75(0x1cd)],'telegramId':_0x5d1c5b['telegram'],'merchantUrl':_0x5d1c5b[_0x164e75(0x1d5)],'gateways':_0x5d1c5b[_0x164e75(0x1ee)]?JSON[_0x164e75(0x1cf)](_0x5d1c5b[_0x164e75(0x1ee)]):null,'gatewaySettings':_0x5d1c5b[_0x164e75(0x1f2)]?JSON['parse'](_0x5d1c5b[_0x164e75(0x1f2)]):null,'publicKey':_0x5d1c5b[_0x164e75(0x1d6)],'wallets':{'usdtPolygonWallet':_0x5d1c5b[_0x164e75(0x1f1)],'usdtTrcWallet':_0x5d1c5b[_0x164e75(0x1e1)],'usdtErcWallet':_0x5d1c5b[_0x164e75(0x1d1)],'usdcPolygonWallet':_0x5d1c5b['usdcPolygonWallet']},'status':_0x5d1c5b[_0x164e75(0x1f8)],'createdAt':_0x5d1c5b['createdAt']};}async[a82_0xfe0c2e(0x1c2)](){const _0x16a617=a82_0xfe0c2e,_0xb87d7b=await database_1[_0x16a617(0x1c8)][_0x16a617(0x1e0)][_0x16a617(0x1e9)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':'desc'}});return _0xb87d7b[_0x16a617(0x1eb)](_0x441fbb=>({'id':_0x441fbb['id'],'fullName':_0x441fbb[_0x16a617(0x1d0)],'username':_0x441fbb[_0x16a617(0x1cd)],'telegramId':_0x441fbb['telegram'],'merchantUrl':_0x441fbb[_0x16a617(0x1d5)],'gateways':_0x441fbb[_0x16a617(0x1ee)]?JSON[_0x16a617(0x1cf)](_0x441fbb[_0x16a617(0x1ee)]):null,'gatewaySettings':_0x441fbb['gatewaySettings']?JSON[_0x16a617(0x1cf)](_0x441fbb[_0x16a617(0x1f2)]):null,'publicKey':_0x441fbb[_0x16a617(0x1d6)],'wallets':{'usdtPolygonWallet':_0x441fbb[_0x16a617(0x1f1)],'usdtTrcWallet':_0x441fbb[_0x16a617(0x1e1)],'usdtErcWallet':_0x441fbb['usdtErcWallet'],'usdcPolygonWallet':_0x441fbb[_0x16a617(0x1c9)]},'status':_0x441fbb[_0x16a617(0x1f8)],'createdAt':_0x441fbb[_0x16a617(0x1f6)]}));}async[a82_0xfe0c2e(0x1ec)](_0x1d31bb){const _0x5a7bdd=a82_0xfe0c2e,_0x546670=await database_1[_0x5a7bdd(0x1c8)][_0x5a7bdd(0x1e0)][_0x5a7bdd(0x1d7)]({'where':{'id':_0x1d31bb},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x546670)return null;return{'id':_0x546670['id'],'fullName':_0x546670[_0x5a7bdd(0x1d0)],'username':_0x546670[_0x5a7bdd(0x1cd)],'telegramId':_0x546670[_0x5a7bdd(0x1ce)],'merchantUrl':_0x546670[_0x5a7bdd(0x1d5)],'gateways':_0x546670[_0x5a7bdd(0x1ee)]?JSON[_0x5a7bdd(0x1cf)](_0x546670[_0x5a7bdd(0x1ee)]):null,'gatewaySettings':_0x546670[_0x5a7bdd(0x1f2)]?JSON[_0x5a7bdd(0x1cf)](_0x546670[_0x5a7bdd(0x1f2)]):null,'publicKey':_0x546670[_0x5a7bdd(0x1d6)],'wallets':{'usdtPolygonWallet':_0x546670['usdtPolygonWallet'],'usdtTrcWallet':_0x546670[_0x5a7bdd(0x1e1)],'usdtErcWallet':_0x546670['usdtErcWallet'],'usdcPolygonWallet':_0x546670[_0x5a7bdd(0x1c9)]},'status':_0x546670[_0x5a7bdd(0x1f8)],'createdAt':_0x546670[_0x5a7bdd(0x1f6)]};}async[a82_0xfe0c2e(0x1f4)](_0x873842,_0x3fda9a){const _0x55c6e3=a82_0xfe0c2e,_0x437808={..._0x3fda9a};_0x3fda9a[_0x55c6e3(0x1dd)]&&(_0x437808[_0x55c6e3(0x1dd)]=await bcryptjs_1['default']['hash'](_0x3fda9a[_0x55c6e3(0x1dd)],0xc));_0x3fda9a[_0x55c6e3(0x1e5)]&&(_0x437808[_0x55c6e3(0x1d0)]=_0x3fda9a[_0x55c6e3(0x1e5)],delete _0x437808[_0x55c6e3(0x1e5)]);_0x3fda9a[_0x55c6e3(0x1da)]&&(_0x437808[_0x55c6e3(0x1ce)]=_0x3fda9a[_0x55c6e3(0x1da)],delete _0x437808[_0x55c6e3(0x1da)]);_0x3fda9a['merchantUrl']&&(_0x437808[_0x55c6e3(0x1d5)]=_0x3fda9a[_0x55c6e3(0x1f9)],delete _0x437808[_0x55c6e3(0x1f9)]);_0x3fda9a['gateways']&&(_0x437808['paymentGateways']=JSON[_0x55c6e3(0x1e4)](_0x3fda9a[_0x55c6e3(0x1ef)]),delete _0x437808[_0x55c6e3(0x1ef)]);_0x3fda9a[_0x55c6e3(0x1f2)]&&(_0x437808[_0x55c6e3(0x1f2)]=JSON[_0x55c6e3(0x1e4)](_0x3fda9a['gatewaySettings']),delete _0x437808[_0x55c6e3(0x1f2)]);_0x3fda9a[_0x55c6e3(0x1e7)]&&(_0x3fda9a[_0x55c6e3(0x1e7)]['usdtPolygonWallet']!==undefined&&(_0x437808[_0x55c6e3(0x1f1)]=_0x3fda9a['wallets'][_0x55c6e3(0x1f1)]||null),_0x3fda9a['wallets'][_0x55c6e3(0x1e1)]!==undefined&&(_0x437808[_0x55c6e3(0x1e1)]=_0x3fda9a[_0x55c6e3(0x1e7)][_0x55c6e3(0x1e1)]||null),_0x3fda9a[_0x55c6e3(0x1e7)][_0x55c6e3(0x1d1)]!==undefined&&(_0x437808[_0x55c6e3(0x1d1)]=_0x3fda9a['wallets'][_0x55c6e3(0x1d1)]||null),_0x3fda9a['wallets'][_0x55c6e3(0x1c9)]!==undefined&&(_0x437808[_0x55c6e3(0x1c9)]=_0x3fda9a['wallets'][_0x55c6e3(0x1c9)]||null),delete _0x437808['wallets']);const _0x2b7acb=await database_1[_0x55c6e3(0x1c8)][_0x55c6e3(0x1e0)]['update']({'where':{'id':_0x873842},'data':_0x437808,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x2b7acb['id'],'fullName':_0x2b7acb[_0x55c6e3(0x1d0)],'username':_0x2b7acb[_0x55c6e3(0x1cd)],'telegramId':_0x2b7acb[_0x55c6e3(0x1ce)],'merchantUrl':_0x2b7acb[_0x55c6e3(0x1d5)],'gateways':_0x2b7acb[_0x55c6e3(0x1ee)]?JSON[_0x55c6e3(0x1cf)](_0x2b7acb[_0x55c6e3(0x1ee)]):null,'gatewaySettings':_0x2b7acb[_0x55c6e3(0x1f2)]?JSON[_0x55c6e3(0x1cf)](_0x2b7acb[_0x55c6e3(0x1f2)]):null,'publicKey':_0x2b7acb[_0x55c6e3(0x1d6)],'wallets':{'usdtPolygonWallet':_0x2b7acb[_0x55c6e3(0x1f1)],'usdtTrcWallet':_0x2b7acb[_0x55c6e3(0x1e1)],'usdtErcWallet':_0x2b7acb[_0x55c6e3(0x1d1)],'usdcPolygonWallet':_0x2b7acb[_0x55c6e3(0x1c9)]},'status':_0x2b7acb[_0x55c6e3(0x1f8)],'createdAt':_0x2b7acb['createdAt']};}async['deleteUser'](_0x18145e){const _0x4bc9a0=a82_0xfe0c2e;await database_1[_0x4bc9a0(0x1c8)]['shop'][_0x4bc9a0(0x1c3)]({'where':{'id':_0x18145e}});}}exports[a82_0xfe0c2e(0x1c4)]=UserService;