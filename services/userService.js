'use strict';const a55_0x3cc027=a55_0xbae9;(function(_0x4523b7,_0x1f5ef4){const _0x5d99ce=a55_0xbae9,_0x59ba12=_0x4523b7();while(!![]){try{const _0x26292e=-parseInt(_0x5d99ce(0x161))/0x1+parseInt(_0x5d99ce(0x15c))/0x2+parseInt(_0x5d99ce(0x16f))/0x3*(parseInt(_0x5d99ce(0x151))/0x4)+parseInt(_0x5d99ce(0x15d))/0x5*(-parseInt(_0x5d99ce(0x16c))/0x6)+parseInt(_0x5d99ce(0x154))/0x7+-parseInt(_0x5d99ce(0x152))/0x8*(-parseInt(_0x5d99ce(0x144))/0x9)+parseInt(_0x5d99ce(0x149))/0xa;if(_0x26292e===_0x1f5ef4)break;else _0x59ba12['push'](_0x59ba12['shift']());}catch(_0xa00a4c){_0x59ba12['push'](_0x59ba12['shift']());}}}(a55_0x2759,0x48c96));function a55_0xbae9(_0x1efea2,_0x4f53cf){const _0x275943=a55_0x2759();return a55_0xbae9=function(_0xbae9fa,_0x55fff8){_0xbae9fa=_0xbae9fa-0x13a;let _0x84738a=_0x275943[_0xbae9fa];return _0x84738a;},a55_0xbae9(_0x1efea2,_0x4f53cf);}function a55_0x2759(){const _0x335073=['UserService','findUnique','paymentGateways','gateways','generateApiKeys','shopUrl','pk_','606744PVxMNU','5fsCJjW','toString','hash','hex','576773gxJWrd','fullName','usdtErcWallet','default','username','ACTIVE','Telegram\x20username\x20already\x20exists','usdcPolygonWallet','map','__esModule','parse','2874180ZOqDGq','desc','telegram','7647DwGgPC','createUser','randomBytes','gatewaySettings','publicKey','bcryptjs','shop','merchantUrl','__importDefault','crypto','../config/database','stringify','update','usdtTrcWallet','261XzTGSM','name','password','sk_','usdtPolygonWallet','4467250eWylxM','status','Username\x20already\x20exists','createdAt','wallets','telegramId','delete','defineProperty','332hxoFHG','25864mpjYrI','getAllUsers','2089612ixtLVM'];a55_0x2759=function(){return _0x335073;};return a55_0x2759();}var __importDefault=this&&this[a55_0x3cc027(0x13e)]||function(_0xfc4f19){const _0x15e660=a55_0x3cc027;return _0xfc4f19&&_0xfc4f19[_0x15e660(0x16a)]?_0xfc4f19:{'default':_0xfc4f19};};Object[a55_0x3cc027(0x150)](exports,a55_0x3cc027(0x16a),{'value':!![]}),exports[a55_0x3cc027(0x155)]=void 0x0;const bcryptjs_1=__importDefault(require(a55_0x3cc027(0x13b))),crypto_1=__importDefault(require(a55_0x3cc027(0x13f))),database_1=__importDefault(require(a55_0x3cc027(0x140)));class UserService{['generateApiKeys'](){const _0x27d65b=a55_0x3cc027,_0x2777b4=_0x27d65b(0x15b)+crypto_1[_0x27d65b(0x164)][_0x27d65b(0x171)](0x20)['toString'](_0x27d65b(0x160)),_0x2bf7c0=_0x27d65b(0x147)+crypto_1[_0x27d65b(0x164)]['randomBytes'](0x20)[_0x27d65b(0x15e)](_0x27d65b(0x160));return{'publicKey':_0x2777b4,'secretKey':_0x2bf7c0};}async[a55_0x3cc027(0x170)](_0x317ffd){const _0x384093=a55_0x3cc027,{fullName:_0x212d71,username:_0x1ac4f2,password:_0xcfea42,telegramId:_0x89cb8e,merchantUrl:_0x2a5b6e,gateways:_0x9407ce,gatewaySettings:_0x3f6e06,wallets:_0x333a60}=_0x317ffd,_0x2bafae=await database_1[_0x384093(0x164)][_0x384093(0x13c)][_0x384093(0x156)]({'where':{'username':_0x1ac4f2}});if(_0x2bafae)throw new Error(_0x384093(0x14b));if(_0x89cb8e){const _0x47a647=await database_1[_0x384093(0x164)][_0x384093(0x13c)][_0x384093(0x156)]({'where':{'telegram':_0x89cb8e}});if(_0x47a647)throw new Error(_0x384093(0x167));}const _0x1df9e8=await bcryptjs_1[_0x384093(0x164)][_0x384093(0x15f)](_0xcfea42,0xc),{publicKey:_0x30391b,secretKey:_0x35b830}=this[_0x384093(0x159)](),_0x274adb=await database_1['default']['shop']['create']({'data':{'name':_0x212d71,'username':_0x1ac4f2,'password':_0x1df9e8,'telegram':_0x89cb8e,'shopUrl':_0x2a5b6e,'paymentGateways':_0x9407ce?JSON[_0x384093(0x141)](_0x9407ce):null,'gatewaySettings':_0x3f6e06?JSON['stringify'](_0x3f6e06):null,'usdtPolygonWallet':_0x333a60?.['usdtPolygonWallet']||null,'usdtTrcWallet':_0x333a60?.[_0x384093(0x143)]||null,'usdtErcWallet':_0x333a60?.[_0x384093(0x163)]||null,'usdcPolygonWallet':_0x333a60?.[_0x384093(0x168)]||null,'publicKey':_0x30391b,'secretKey':_0x35b830,'status':_0x384093(0x166)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x274adb['id'],'fullName':_0x274adb[_0x384093(0x145)],'username':_0x274adb[_0x384093(0x165)],'telegramId':_0x274adb[_0x384093(0x16e)],'merchantUrl':_0x274adb[_0x384093(0x15a)],'gateways':_0x274adb['paymentGateways']?JSON[_0x384093(0x16b)](_0x274adb[_0x384093(0x157)]):null,'gatewaySettings':_0x274adb[_0x384093(0x172)]?JSON[_0x384093(0x16b)](_0x274adb[_0x384093(0x172)]):null,'publicKey':_0x274adb[_0x384093(0x13a)],'wallets':{'usdtPolygonWallet':_0x274adb[_0x384093(0x148)],'usdtTrcWallet':_0x274adb[_0x384093(0x143)],'usdtErcWallet':_0x274adb['usdtErcWallet'],'usdcPolygonWallet':_0x274adb[_0x384093(0x168)]},'status':_0x274adb[_0x384093(0x14a)],'createdAt':_0x274adb[_0x384093(0x14c)]};}async[a55_0x3cc027(0x153)](){const _0x219bfe=a55_0x3cc027,_0x26769b=await database_1[_0x219bfe(0x164)][_0x219bfe(0x13c)]['findMany']({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x219bfe(0x16d)}});return _0x26769b[_0x219bfe(0x169)](_0x43cdc4=>({'id':_0x43cdc4['id'],'fullName':_0x43cdc4[_0x219bfe(0x145)],'username':_0x43cdc4['username'],'telegramId':_0x43cdc4[_0x219bfe(0x16e)],'merchantUrl':_0x43cdc4['shopUrl'],'gateways':_0x43cdc4[_0x219bfe(0x157)]?JSON[_0x219bfe(0x16b)](_0x43cdc4[_0x219bfe(0x157)]):null,'gatewaySettings':_0x43cdc4['gatewaySettings']?JSON['parse'](_0x43cdc4[_0x219bfe(0x172)]):null,'publicKey':_0x43cdc4[_0x219bfe(0x13a)],'wallets':{'usdtPolygonWallet':_0x43cdc4[_0x219bfe(0x148)],'usdtTrcWallet':_0x43cdc4[_0x219bfe(0x143)],'usdtErcWallet':_0x43cdc4['usdtErcWallet'],'usdcPolygonWallet':_0x43cdc4[_0x219bfe(0x168)]},'status':_0x43cdc4[_0x219bfe(0x14a)],'createdAt':_0x43cdc4[_0x219bfe(0x14c)]}));}async['getUserById'](_0x394c61){const _0xb44436=a55_0x3cc027,_0x1ad379=await database_1[_0xb44436(0x164)][_0xb44436(0x13c)][_0xb44436(0x156)]({'where':{'id':_0x394c61},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x1ad379)return null;return{'id':_0x1ad379['id'],'fullName':_0x1ad379[_0xb44436(0x145)],'username':_0x1ad379['username'],'telegramId':_0x1ad379['telegram'],'merchantUrl':_0x1ad379[_0xb44436(0x15a)],'gateways':_0x1ad379[_0xb44436(0x157)]?JSON[_0xb44436(0x16b)](_0x1ad379[_0xb44436(0x157)]):null,'gatewaySettings':_0x1ad379[_0xb44436(0x172)]?JSON[_0xb44436(0x16b)](_0x1ad379[_0xb44436(0x172)]):null,'publicKey':_0x1ad379['publicKey'],'wallets':{'usdtPolygonWallet':_0x1ad379[_0xb44436(0x148)],'usdtTrcWallet':_0x1ad379[_0xb44436(0x143)],'usdtErcWallet':_0x1ad379['usdtErcWallet'],'usdcPolygonWallet':_0x1ad379[_0xb44436(0x168)]},'status':_0x1ad379[_0xb44436(0x14a)],'createdAt':_0x1ad379[_0xb44436(0x14c)]};}async['updateUser'](_0x4ffcec,_0x5a2dac){const _0x4c623e=a55_0x3cc027,_0x4e8eb2={..._0x5a2dac};_0x5a2dac[_0x4c623e(0x146)]&&(_0x4e8eb2['password']=await bcryptjs_1[_0x4c623e(0x164)][_0x4c623e(0x15f)](_0x5a2dac[_0x4c623e(0x146)],0xc));_0x5a2dac[_0x4c623e(0x162)]&&(_0x4e8eb2[_0x4c623e(0x145)]=_0x5a2dac['fullName'],delete _0x4e8eb2['fullName']);_0x5a2dac['telegramId']&&(_0x4e8eb2[_0x4c623e(0x16e)]=_0x5a2dac['telegramId'],delete _0x4e8eb2[_0x4c623e(0x14e)]);_0x5a2dac[_0x4c623e(0x13d)]&&(_0x4e8eb2[_0x4c623e(0x15a)]=_0x5a2dac[_0x4c623e(0x13d)],delete _0x4e8eb2[_0x4c623e(0x13d)]);_0x5a2dac['gateways']&&(_0x4e8eb2[_0x4c623e(0x157)]=JSON['stringify'](_0x5a2dac['gateways']),delete _0x4e8eb2[_0x4c623e(0x158)]);_0x5a2dac['gatewaySettings']&&(_0x4e8eb2[_0x4c623e(0x172)]=JSON[_0x4c623e(0x141)](_0x5a2dac[_0x4c623e(0x172)]),delete _0x4e8eb2[_0x4c623e(0x172)]);_0x5a2dac[_0x4c623e(0x14d)]&&(_0x5a2dac[_0x4c623e(0x14d)][_0x4c623e(0x148)]!==undefined&&(_0x4e8eb2[_0x4c623e(0x148)]=_0x5a2dac[_0x4c623e(0x14d)]['usdtPolygonWallet']||null),_0x5a2dac[_0x4c623e(0x14d)][_0x4c623e(0x143)]!==undefined&&(_0x4e8eb2['usdtTrcWallet']=_0x5a2dac[_0x4c623e(0x14d)][_0x4c623e(0x143)]||null),_0x5a2dac[_0x4c623e(0x14d)][_0x4c623e(0x163)]!==undefined&&(_0x4e8eb2['usdtErcWallet']=_0x5a2dac[_0x4c623e(0x14d)][_0x4c623e(0x163)]||null),_0x5a2dac[_0x4c623e(0x14d)]['usdcPolygonWallet']!==undefined&&(_0x4e8eb2['usdcPolygonWallet']=_0x5a2dac[_0x4c623e(0x14d)]['usdcPolygonWallet']||null),delete _0x4e8eb2[_0x4c623e(0x14d)]);const _0x5051f6=await database_1[_0x4c623e(0x164)][_0x4c623e(0x13c)][_0x4c623e(0x142)]({'where':{'id':_0x4ffcec},'data':_0x4e8eb2,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x5051f6['id'],'fullName':_0x5051f6[_0x4c623e(0x145)],'username':_0x5051f6[_0x4c623e(0x165)],'telegramId':_0x5051f6['telegram'],'merchantUrl':_0x5051f6[_0x4c623e(0x15a)],'gateways':_0x5051f6[_0x4c623e(0x157)]?JSON[_0x4c623e(0x16b)](_0x5051f6[_0x4c623e(0x157)]):null,'gatewaySettings':_0x5051f6['gatewaySettings']?JSON[_0x4c623e(0x16b)](_0x5051f6[_0x4c623e(0x172)]):null,'publicKey':_0x5051f6[_0x4c623e(0x13a)],'wallets':{'usdtPolygonWallet':_0x5051f6[_0x4c623e(0x148)],'usdtTrcWallet':_0x5051f6[_0x4c623e(0x143)],'usdtErcWallet':_0x5051f6[_0x4c623e(0x163)],'usdcPolygonWallet':_0x5051f6[_0x4c623e(0x168)]},'status':_0x5051f6[_0x4c623e(0x14a)],'createdAt':_0x5051f6[_0x4c623e(0x14c)]};}async['deleteUser'](_0x304266){const _0x3ae599=a55_0x3cc027;await database_1[_0x3ae599(0x164)][_0x3ae599(0x13c)][_0x3ae599(0x14f)]({'where':{'id':_0x304266}});}}exports[a55_0x3cc027(0x155)]=UserService;