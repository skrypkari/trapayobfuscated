'use strict';const a59_0x26c482=a59_0x1a5d;function a59_0x3964(){const _0x161348=['4528310cJCayu','parse','getAllUsers','publicKey','name','__importDefault','defineProperty','usdcPolygonWallet','shop','password','paymentGateways','status','getUserById','ACTIVE','merchantUrl','telegramId','create','UserService','11443256MASgOm','wallets','stringify','findMany','usdtErcWallet','Telegram\x20username\x20already\x20exists','createdAt','shopUrl','../config/database','bcryptjs','6TPmjaD','2071526ZxRCUt','findUnique','generateApiKeys','5515258nrtClA','usdtPolygonWallet','hash','126411sxqFmi','telegram','hex','updateUser','usdtTrcWallet','desc','username','gatewaySettings','map','createUser','default','randomBytes','fullName','__esModule','69425WHUqDd','3654044MVlWGb','gateways'];a59_0x3964=function(){return _0x161348;};return a59_0x3964();}(function(_0x539bcc,_0x247dbd){const _0x10fb08=a59_0x1a5d,_0x180e16=_0x539bcc();while(!![]){try{const _0xba9ca1=-parseInt(_0x10fb08(0x1d3))/0x1+parseInt(_0x10fb08(0x1bf))/0x2+-parseInt(_0x10fb08(0x1c5))/0x3+parseInt(_0x10fb08(0x1d4))/0x4+-parseInt(_0x10fb08(0x1d6))/0x5*(-parseInt(_0x10fb08(0x1be))/0x6)+-parseInt(_0x10fb08(0x1c2))/0x7+-parseInt(_0x10fb08(0x1b4))/0x8;if(_0xba9ca1===_0x247dbd)break;else _0x180e16['push'](_0x180e16['shift']());}catch(_0x397c8c){_0x180e16['push'](_0x180e16['shift']());}}}(a59_0x3964,0x80311));function a59_0x1a5d(_0x1dce76,_0x1f124d){const _0x39644a=a59_0x3964();return a59_0x1a5d=function(_0x1a5dcb,_0x37e9b4){_0x1a5dcb=_0x1a5dcb-0x1b4;let _0x51d88e=_0x39644a[_0x1a5dcb];return _0x51d88e;},a59_0x1a5d(_0x1dce76,_0x1f124d);}var __importDefault=this&&this[a59_0x26c482(0x1db)]||function(_0x25c928){const _0x36867d=a59_0x26c482;return _0x25c928&&_0x25c928[_0x36867d(0x1d2)]?_0x25c928:{'default':_0x25c928};};Object[a59_0x26c482(0x1dc)](exports,a59_0x26c482(0x1d2),{'value':!![]}),exports[a59_0x26c482(0x1e7)]=void 0x0;const bcryptjs_1=__importDefault(require(a59_0x26c482(0x1bd))),crypto_1=__importDefault(require('crypto')),database_1=__importDefault(require(a59_0x26c482(0x1bc)));class UserService{[a59_0x26c482(0x1c1)](){const _0x116de5=a59_0x26c482,_0x120096='pk_'+crypto_1[_0x116de5(0x1cf)][_0x116de5(0x1d0)](0x20)['toString'](_0x116de5(0x1c7)),_0x31c7c1='sk_'+crypto_1[_0x116de5(0x1cf)]['randomBytes'](0x20)['toString'](_0x116de5(0x1c7));return{'publicKey':_0x120096,'secretKey':_0x31c7c1};}async[a59_0x26c482(0x1ce)](_0x553dae){const _0xd7da79=a59_0x26c482,{fullName:_0x5b7f9a,username:_0x4d05fd,password:_0x1c7ea9,telegramId:_0x272345,merchantUrl:_0x2ce457,gateways:_0x21c58a,gatewaySettings:_0xc62cb1,wallets:_0x3365b8}=_0x553dae,_0x4e7ebb=await database_1[_0xd7da79(0x1cf)][_0xd7da79(0x1de)][_0xd7da79(0x1c0)]({'where':{'username':_0x4d05fd}});if(_0x4e7ebb)throw new Error('Username\x20already\x20exists');if(_0x272345){const _0x5e1a99=await database_1[_0xd7da79(0x1cf)][_0xd7da79(0x1de)][_0xd7da79(0x1c0)]({'where':{'telegram':_0x272345}});if(_0x5e1a99)throw new Error(_0xd7da79(0x1b9));}const _0x40caba=await bcryptjs_1[_0xd7da79(0x1cf)][_0xd7da79(0x1c4)](_0x1c7ea9,0xc),{publicKey:_0x19f88a,secretKey:_0x35c00d}=this[_0xd7da79(0x1c1)](),_0x553b84=await database_1[_0xd7da79(0x1cf)][_0xd7da79(0x1de)][_0xd7da79(0x1e6)]({'data':{'name':_0x5b7f9a,'username':_0x4d05fd,'password':_0x40caba,'telegram':_0x272345,'shopUrl':_0x2ce457,'paymentGateways':_0x21c58a?JSON[_0xd7da79(0x1b6)](_0x21c58a):null,'gatewaySettings':_0xc62cb1?JSON[_0xd7da79(0x1b6)](_0xc62cb1):null,'usdtPolygonWallet':_0x3365b8?.[_0xd7da79(0x1c3)]||null,'usdtTrcWallet':_0x3365b8?.[_0xd7da79(0x1c9)]||null,'usdtErcWallet':_0x3365b8?.[_0xd7da79(0x1b8)]||null,'usdcPolygonWallet':_0x3365b8?.[_0xd7da79(0x1dd)]||null,'publicKey':_0x19f88a,'secretKey':_0x35c00d,'status':_0xd7da79(0x1e3)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x553b84['id'],'fullName':_0x553b84[_0xd7da79(0x1da)],'username':_0x553b84[_0xd7da79(0x1cb)],'telegramId':_0x553b84[_0xd7da79(0x1c6)],'merchantUrl':_0x553b84[_0xd7da79(0x1bb)],'gateways':_0x553b84[_0xd7da79(0x1e0)]?JSON[_0xd7da79(0x1d7)](_0x553b84['paymentGateways']):null,'gatewaySettings':_0x553b84[_0xd7da79(0x1cc)]?JSON[_0xd7da79(0x1d7)](_0x553b84[_0xd7da79(0x1cc)]):null,'publicKey':_0x553b84[_0xd7da79(0x1d9)],'wallets':{'usdtPolygonWallet':_0x553b84[_0xd7da79(0x1c3)],'usdtTrcWallet':_0x553b84[_0xd7da79(0x1c9)],'usdtErcWallet':_0x553b84[_0xd7da79(0x1b8)],'usdcPolygonWallet':_0x553b84[_0xd7da79(0x1dd)]},'status':_0x553b84[_0xd7da79(0x1e1)],'createdAt':_0x553b84[_0xd7da79(0x1ba)]};}async[a59_0x26c482(0x1d8)](){const _0x1e8a9b=a59_0x26c482,_0x457e6b=await database_1[_0x1e8a9b(0x1cf)][_0x1e8a9b(0x1de)][_0x1e8a9b(0x1b7)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x1e8a9b(0x1ca)}});return _0x457e6b[_0x1e8a9b(0x1cd)](_0x3c6a51=>({'id':_0x3c6a51['id'],'fullName':_0x3c6a51[_0x1e8a9b(0x1da)],'username':_0x3c6a51[_0x1e8a9b(0x1cb)],'telegramId':_0x3c6a51[_0x1e8a9b(0x1c6)],'merchantUrl':_0x3c6a51[_0x1e8a9b(0x1bb)],'gateways':_0x3c6a51[_0x1e8a9b(0x1e0)]?JSON['parse'](_0x3c6a51['paymentGateways']):null,'gatewaySettings':_0x3c6a51[_0x1e8a9b(0x1cc)]?JSON[_0x1e8a9b(0x1d7)](_0x3c6a51[_0x1e8a9b(0x1cc)]):null,'publicKey':_0x3c6a51['publicKey'],'wallets':{'usdtPolygonWallet':_0x3c6a51['usdtPolygonWallet'],'usdtTrcWallet':_0x3c6a51['usdtTrcWallet'],'usdtErcWallet':_0x3c6a51[_0x1e8a9b(0x1b8)],'usdcPolygonWallet':_0x3c6a51[_0x1e8a9b(0x1dd)]},'status':_0x3c6a51[_0x1e8a9b(0x1e1)],'createdAt':_0x3c6a51[_0x1e8a9b(0x1ba)]}));}async[a59_0x26c482(0x1e2)](_0x388bc5){const _0x1fd77e=a59_0x26c482,_0x256c6b=await database_1[_0x1fd77e(0x1cf)]['shop']['findUnique']({'where':{'id':_0x388bc5},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x256c6b)return null;return{'id':_0x256c6b['id'],'fullName':_0x256c6b[_0x1fd77e(0x1da)],'username':_0x256c6b['username'],'telegramId':_0x256c6b[_0x1fd77e(0x1c6)],'merchantUrl':_0x256c6b[_0x1fd77e(0x1bb)],'gateways':_0x256c6b[_0x1fd77e(0x1e0)]?JSON[_0x1fd77e(0x1d7)](_0x256c6b[_0x1fd77e(0x1e0)]):null,'gatewaySettings':_0x256c6b['gatewaySettings']?JSON[_0x1fd77e(0x1d7)](_0x256c6b[_0x1fd77e(0x1cc)]):null,'publicKey':_0x256c6b['publicKey'],'wallets':{'usdtPolygonWallet':_0x256c6b[_0x1fd77e(0x1c3)],'usdtTrcWallet':_0x256c6b[_0x1fd77e(0x1c9)],'usdtErcWallet':_0x256c6b[_0x1fd77e(0x1b8)],'usdcPolygonWallet':_0x256c6b['usdcPolygonWallet']},'status':_0x256c6b[_0x1fd77e(0x1e1)],'createdAt':_0x256c6b[_0x1fd77e(0x1ba)]};}async[a59_0x26c482(0x1c8)](_0x5388a7,_0x1e98eb){const _0x112cdf=a59_0x26c482,_0x3f600a={..._0x1e98eb};_0x1e98eb[_0x112cdf(0x1df)]&&(_0x3f600a['password']=await bcryptjs_1[_0x112cdf(0x1cf)]['hash'](_0x1e98eb[_0x112cdf(0x1df)],0xc));_0x1e98eb[_0x112cdf(0x1d1)]&&(_0x3f600a[_0x112cdf(0x1da)]=_0x1e98eb[_0x112cdf(0x1d1)],delete _0x3f600a[_0x112cdf(0x1d1)]);_0x1e98eb[_0x112cdf(0x1e5)]&&(_0x3f600a[_0x112cdf(0x1c6)]=_0x1e98eb['telegramId'],delete _0x3f600a[_0x112cdf(0x1e5)]);_0x1e98eb[_0x112cdf(0x1e4)]&&(_0x3f600a['shopUrl']=_0x1e98eb['merchantUrl'],delete _0x3f600a['merchantUrl']);_0x1e98eb[_0x112cdf(0x1d5)]&&(_0x3f600a[_0x112cdf(0x1e0)]=JSON[_0x112cdf(0x1b6)](_0x1e98eb[_0x112cdf(0x1d5)]),delete _0x3f600a[_0x112cdf(0x1d5)]);_0x1e98eb[_0x112cdf(0x1cc)]&&(_0x3f600a[_0x112cdf(0x1cc)]=JSON[_0x112cdf(0x1b6)](_0x1e98eb[_0x112cdf(0x1cc)]),delete _0x3f600a[_0x112cdf(0x1cc)]);_0x1e98eb[_0x112cdf(0x1b5)]&&(_0x1e98eb[_0x112cdf(0x1b5)][_0x112cdf(0x1c3)]!==undefined&&(_0x3f600a[_0x112cdf(0x1c3)]=_0x1e98eb[_0x112cdf(0x1b5)]['usdtPolygonWallet']||null),_0x1e98eb[_0x112cdf(0x1b5)][_0x112cdf(0x1c9)]!==undefined&&(_0x3f600a['usdtTrcWallet']=_0x1e98eb[_0x112cdf(0x1b5)][_0x112cdf(0x1c9)]||null),_0x1e98eb[_0x112cdf(0x1b5)]['usdtErcWallet']!==undefined&&(_0x3f600a[_0x112cdf(0x1b8)]=_0x1e98eb[_0x112cdf(0x1b5)][_0x112cdf(0x1b8)]||null),_0x1e98eb[_0x112cdf(0x1b5)][_0x112cdf(0x1dd)]!==undefined&&(_0x3f600a['usdcPolygonWallet']=_0x1e98eb[_0x112cdf(0x1b5)]['usdcPolygonWallet']||null),delete _0x3f600a[_0x112cdf(0x1b5)]);const _0x4545a2=await database_1[_0x112cdf(0x1cf)][_0x112cdf(0x1de)]['update']({'where':{'id':_0x5388a7},'data':_0x3f600a,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x4545a2['id'],'fullName':_0x4545a2[_0x112cdf(0x1da)],'username':_0x4545a2[_0x112cdf(0x1cb)],'telegramId':_0x4545a2[_0x112cdf(0x1c6)],'merchantUrl':_0x4545a2['shopUrl'],'gateways':_0x4545a2['paymentGateways']?JSON[_0x112cdf(0x1d7)](_0x4545a2[_0x112cdf(0x1e0)]):null,'gatewaySettings':_0x4545a2[_0x112cdf(0x1cc)]?JSON[_0x112cdf(0x1d7)](_0x4545a2[_0x112cdf(0x1cc)]):null,'publicKey':_0x4545a2['publicKey'],'wallets':{'usdtPolygonWallet':_0x4545a2[_0x112cdf(0x1c3)],'usdtTrcWallet':_0x4545a2[_0x112cdf(0x1c9)],'usdtErcWallet':_0x4545a2['usdtErcWallet'],'usdcPolygonWallet':_0x4545a2[_0x112cdf(0x1dd)]},'status':_0x4545a2[_0x112cdf(0x1e1)],'createdAt':_0x4545a2[_0x112cdf(0x1ba)]};}async['deleteUser'](_0x194f4f){const _0x4a7d59=a59_0x26c482;await database_1[_0x4a7d59(0x1cf)][_0x4a7d59(0x1de)]['delete']({'where':{'id':_0x194f4f}});}}exports[a59_0x26c482(0x1e7)]=UserService;