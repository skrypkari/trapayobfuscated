'use strict';const a51_0x478edb=a51_0x44dd;(function(_0x451ff2,_0x18b72b){const _0x582905=a51_0x44dd,_0x166b4b=_0x451ff2();while(!![]){try{const _0x292765=-parseInt(_0x582905(0xc5))/0x1+-parseInt(_0x582905(0x9e))/0x2*(parseInt(_0x582905(0xb2))/0x3)+parseInt(_0x582905(0x99))/0x4*(-parseInt(_0x582905(0xa2))/0x5)+-parseInt(_0x582905(0xbe))/0x6*(-parseInt(_0x582905(0xb5))/0x7)+parseInt(_0x582905(0x9f))/0x8+parseInt(_0x582905(0xa5))/0x9+-parseInt(_0x582905(0xc1))/0xa*(parseInt(_0x582905(0xc4))/0xb);if(_0x292765===_0x18b72b)break;else _0x166b4b['push'](_0x166b4b['shift']());}catch(_0x1eb148){_0x166b4b['push'](_0x166b4b['shift']());}}}(a51_0x34e4,0xe4ca5));function a51_0x44dd(_0x4b11f8,_0x367c41){const _0x34e46d=a51_0x34e4();return a51_0x44dd=function(_0x44dd1f,_0x105bf6){_0x44dd1f=_0x44dd1f-0x98;let _0x1a04df=_0x34e46d[_0x44dd1f];return _0x1a04df;},a51_0x44dd(_0x4b11f8,_0x367c41);}var __importDefault=this&&this[a51_0x478edb(0xa4)]||function(_0x56f285){return _0x56f285&&_0x56f285['__esModule']?_0x56f285:{'default':_0x56f285};};Object[a51_0x478edb(0xcc)](exports,a51_0x478edb(0xac),{'value':!![]}),exports[a51_0x478edb(0xb7)]=void 0x0;function a51_0x34e4(){const _0x2b28ac=['8603106tHWPUF','deleteUser','wallets','842560UjFeQy','usdcPolygonWallet','update','11PYAvHx','1241443CMufIf','findUnique','createUser','shop','Username\x20already\x20exists','createdAt','publicKey','defineProperty','telegramId','status','updateUser','fullName','crypto','4SxNhgZ','parse','bcryptjs','stringify','sk_','31088WMrCmG','5841232CrsjiK','merchantUrl','name','417385BefHgd','shopUrl','__importDefault','2340144oNbqmi','pk_','gateways','hex','usdtTrcWallet','usdtErcWallet','ACTIVE','__esModule','gatewaySettings','paymentGateways','default','generateApiKeys','randomBytes','15ewNAyN','Telegram\x20username\x20already\x20exists','delete','7DWgZnt','telegram','UserService','hash','username','getUserById','usdtPolygonWallet','toString','password'];a51_0x34e4=function(){return _0x2b28ac;};return a51_0x34e4();}const bcryptjs_1=__importDefault(require(a51_0x478edb(0x9b))),crypto_1=__importDefault(require(a51_0x478edb(0x98))),database_1=__importDefault(require('../config/database'));class UserService{[a51_0x478edb(0xb0)](){const _0x39db05=a51_0x478edb,_0x5997d6=_0x39db05(0xa6)+crypto_1[_0x39db05(0xaf)]['randomBytes'](0x20)[_0x39db05(0xbc)]('hex'),_0x7c327f=_0x39db05(0x9d)+crypto_1[_0x39db05(0xaf)][_0x39db05(0xb1)](0x20)[_0x39db05(0xbc)](_0x39db05(0xa8));return{'publicKey':_0x5997d6,'secretKey':_0x7c327f};}async[a51_0x478edb(0xc7)](_0x2c02b9){const _0x5dddd9=a51_0x478edb,{fullName:_0x3c1d37,username:_0x361b10,password:_0xab91e3,telegramId:_0x265482,merchantUrl:_0x26b15d,gateways:_0x54e671,gatewaySettings:_0x2ff8f5,wallets:_0x3b600b}=_0x2c02b9,_0x3c20af=await database_1[_0x5dddd9(0xaf)][_0x5dddd9(0xc8)][_0x5dddd9(0xc6)]({'where':{'username':_0x361b10}});if(_0x3c20af)throw new Error(_0x5dddd9(0xc9));if(_0x265482){const _0x4c162f=await database_1[_0x5dddd9(0xaf)][_0x5dddd9(0xc8)][_0x5dddd9(0xc6)]({'where':{'telegram':_0x265482}});if(_0x4c162f)throw new Error(_0x5dddd9(0xb3));}const _0xb6166d=await bcryptjs_1[_0x5dddd9(0xaf)][_0x5dddd9(0xb8)](_0xab91e3,0xc),{publicKey:_0x269bb1,secretKey:_0x346a9b}=this['generateApiKeys'](),_0x2dbaad=await database_1['default'][_0x5dddd9(0xc8)]['create']({'data':{'name':_0x3c1d37,'username':_0x361b10,'password':_0xb6166d,'telegram':_0x265482,'shopUrl':_0x26b15d,'paymentGateways':_0x54e671?JSON['stringify'](_0x54e671):null,'gatewaySettings':_0x2ff8f5?JSON[_0x5dddd9(0x9c)](_0x2ff8f5):null,'usdtPolygonWallet':_0x3b600b?.[_0x5dddd9(0xbb)]||null,'usdtTrcWallet':_0x3b600b?.['usdtTrcWallet']||null,'usdtErcWallet':_0x3b600b?.[_0x5dddd9(0xaa)]||null,'usdcPolygonWallet':_0x3b600b?.['usdcPolygonWallet']||null,'publicKey':_0x269bb1,'secretKey':_0x346a9b,'status':_0x5dddd9(0xab)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x2dbaad['id'],'fullName':_0x2dbaad[_0x5dddd9(0xa1)],'username':_0x2dbaad[_0x5dddd9(0xb9)],'telegramId':_0x2dbaad[_0x5dddd9(0xb6)],'merchantUrl':_0x2dbaad[_0x5dddd9(0xa3)],'gateways':_0x2dbaad[_0x5dddd9(0xae)]?JSON[_0x5dddd9(0x9a)](_0x2dbaad[_0x5dddd9(0xae)]):null,'gatewaySettings':_0x2dbaad['gatewaySettings']?JSON[_0x5dddd9(0x9a)](_0x2dbaad[_0x5dddd9(0xad)]):null,'publicKey':_0x2dbaad['publicKey'],'wallets':{'usdtPolygonWallet':_0x2dbaad[_0x5dddd9(0xbb)],'usdtTrcWallet':_0x2dbaad['usdtTrcWallet'],'usdtErcWallet':_0x2dbaad[_0x5dddd9(0xaa)],'usdcPolygonWallet':_0x2dbaad[_0x5dddd9(0xc2)]},'status':_0x2dbaad[_0x5dddd9(0xce)],'createdAt':_0x2dbaad[_0x5dddd9(0xca)]};}async['getAllUsers'](){const _0x468c14=a51_0x478edb,_0x521e6e=await database_1['default']['shop']['findMany']({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':'desc'}});return _0x521e6e['map'](_0x23ff97=>({'id':_0x23ff97['id'],'fullName':_0x23ff97['name'],'username':_0x23ff97['username'],'telegramId':_0x23ff97[_0x468c14(0xb6)],'merchantUrl':_0x23ff97['shopUrl'],'gateways':_0x23ff97[_0x468c14(0xae)]?JSON[_0x468c14(0x9a)](_0x23ff97[_0x468c14(0xae)]):null,'gatewaySettings':_0x23ff97['gatewaySettings']?JSON[_0x468c14(0x9a)](_0x23ff97[_0x468c14(0xad)]):null,'publicKey':_0x23ff97[_0x468c14(0xcb)],'wallets':{'usdtPolygonWallet':_0x23ff97[_0x468c14(0xbb)],'usdtTrcWallet':_0x23ff97['usdtTrcWallet'],'usdtErcWallet':_0x23ff97[_0x468c14(0xaa)],'usdcPolygonWallet':_0x23ff97['usdcPolygonWallet']},'status':_0x23ff97['status'],'createdAt':_0x23ff97[_0x468c14(0xca)]}));}async[a51_0x478edb(0xba)](_0x4d60bd){const _0xb242ae=a51_0x478edb,_0x54244e=await database_1[_0xb242ae(0xaf)][_0xb242ae(0xc8)]['findUnique']({'where':{'id':_0x4d60bd},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x54244e)return null;return{'id':_0x54244e['id'],'fullName':_0x54244e[_0xb242ae(0xa1)],'username':_0x54244e['username'],'telegramId':_0x54244e[_0xb242ae(0xb6)],'merchantUrl':_0x54244e[_0xb242ae(0xa3)],'gateways':_0x54244e[_0xb242ae(0xae)]?JSON[_0xb242ae(0x9a)](_0x54244e[_0xb242ae(0xae)]):null,'gatewaySettings':_0x54244e[_0xb242ae(0xad)]?JSON[_0xb242ae(0x9a)](_0x54244e[_0xb242ae(0xad)]):null,'publicKey':_0x54244e[_0xb242ae(0xcb)],'wallets':{'usdtPolygonWallet':_0x54244e[_0xb242ae(0xbb)],'usdtTrcWallet':_0x54244e['usdtTrcWallet'],'usdtErcWallet':_0x54244e['usdtErcWallet'],'usdcPolygonWallet':_0x54244e[_0xb242ae(0xc2)]},'status':_0x54244e[_0xb242ae(0xce)],'createdAt':_0x54244e['createdAt']};}async[a51_0x478edb(0xcf)](_0x4a632b,_0x1e531f){const _0x2390c7=a51_0x478edb,_0xca9aa2={..._0x1e531f};_0x1e531f[_0x2390c7(0xbd)]&&(_0xca9aa2[_0x2390c7(0xbd)]=await bcryptjs_1[_0x2390c7(0xaf)][_0x2390c7(0xb8)](_0x1e531f[_0x2390c7(0xbd)],0xc));_0x1e531f[_0x2390c7(0xd0)]&&(_0xca9aa2[_0x2390c7(0xa1)]=_0x1e531f[_0x2390c7(0xd0)],delete _0xca9aa2['fullName']);_0x1e531f[_0x2390c7(0xcd)]&&(_0xca9aa2[_0x2390c7(0xb6)]=_0x1e531f[_0x2390c7(0xcd)],delete _0xca9aa2[_0x2390c7(0xcd)]);_0x1e531f[_0x2390c7(0xa0)]&&(_0xca9aa2[_0x2390c7(0xa3)]=_0x1e531f['merchantUrl'],delete _0xca9aa2['merchantUrl']);_0x1e531f['gateways']&&(_0xca9aa2[_0x2390c7(0xae)]=JSON['stringify'](_0x1e531f[_0x2390c7(0xa7)]),delete _0xca9aa2['gateways']);_0x1e531f[_0x2390c7(0xad)]&&(_0xca9aa2['gatewaySettings']=JSON[_0x2390c7(0x9c)](_0x1e531f[_0x2390c7(0xad)]),delete _0xca9aa2[_0x2390c7(0xad)]);_0x1e531f[_0x2390c7(0xc0)]&&(_0x1e531f[_0x2390c7(0xc0)]['usdtPolygonWallet']!==undefined&&(_0xca9aa2[_0x2390c7(0xbb)]=_0x1e531f[_0x2390c7(0xc0)][_0x2390c7(0xbb)]||null),_0x1e531f[_0x2390c7(0xc0)]['usdtTrcWallet']!==undefined&&(_0xca9aa2[_0x2390c7(0xa9)]=_0x1e531f[_0x2390c7(0xc0)][_0x2390c7(0xa9)]||null),_0x1e531f['wallets']['usdtErcWallet']!==undefined&&(_0xca9aa2['usdtErcWallet']=_0x1e531f['wallets']['usdtErcWallet']||null),_0x1e531f[_0x2390c7(0xc0)][_0x2390c7(0xc2)]!==undefined&&(_0xca9aa2['usdcPolygonWallet']=_0x1e531f[_0x2390c7(0xc0)][_0x2390c7(0xc2)]||null),delete _0xca9aa2['wallets']);const _0x3c1eef=await database_1['default'][_0x2390c7(0xc8)][_0x2390c7(0xc3)]({'where':{'id':_0x4a632b},'data':_0xca9aa2,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x3c1eef['id'],'fullName':_0x3c1eef[_0x2390c7(0xa1)],'username':_0x3c1eef['username'],'telegramId':_0x3c1eef[_0x2390c7(0xb6)],'merchantUrl':_0x3c1eef[_0x2390c7(0xa3)],'gateways':_0x3c1eef[_0x2390c7(0xae)]?JSON[_0x2390c7(0x9a)](_0x3c1eef[_0x2390c7(0xae)]):null,'gatewaySettings':_0x3c1eef[_0x2390c7(0xad)]?JSON['parse'](_0x3c1eef[_0x2390c7(0xad)]):null,'publicKey':_0x3c1eef[_0x2390c7(0xcb)],'wallets':{'usdtPolygonWallet':_0x3c1eef[_0x2390c7(0xbb)],'usdtTrcWallet':_0x3c1eef[_0x2390c7(0xa9)],'usdtErcWallet':_0x3c1eef[_0x2390c7(0xaa)],'usdcPolygonWallet':_0x3c1eef[_0x2390c7(0xc2)]},'status':_0x3c1eef[_0x2390c7(0xce)],'createdAt':_0x3c1eef[_0x2390c7(0xca)]};}async[a51_0x478edb(0xbf)](_0x2c24e1){const _0x2504b5=a51_0x478edb;await database_1[_0x2504b5(0xaf)][_0x2504b5(0xc8)][_0x2504b5(0xb4)]({'where':{'id':_0x2c24e1}});}}exports[a51_0x478edb(0xb7)]=UserService;