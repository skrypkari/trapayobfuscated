'use strict';const a55_0x928d3f=a55_0x5547;function a55_0x4ded(){const _0x22f151=['telegramId','wallets','usdtPolygonWallet','status','3312594XdBSrZ','telegram','../config/database','Username\x20already\x20exists','190798xnygGZ','gateways','getAllUsers','usdcPolygonWallet','3096352JWSrkm','3SNuEpf','stringify','pk_','usdtTrcWallet','defineProperty','findUnique','updateUser','generateApiKeys','createUser','create','paymentGateways','519060YFaWjj','toString','password','shop','default','shopUrl','createdAt','hash','3155976qjxeJE','delete','sk_','usdtErcWallet','UserService','update','365GTVCcq','publicKey','fullName','__esModule','username','3143622daXGPV','bcryptjs','map','merchantUrl','deleteUser','randomBytes','5164jBthgF','ACTIVE','desc','getUserById','name','parse','gatewaySettings','hex'];a55_0x4ded=function(){return _0x22f151;};return a55_0x4ded();}function a55_0x5547(_0x3be066,_0x1a4c1d){const _0x4dedc3=a55_0x4ded();return a55_0x5547=function(_0x5547cf,_0xa3f810){_0x5547cf=_0x5547cf-0x133;let _0x103389=_0x4dedc3[_0x5547cf];return _0x103389;},a55_0x5547(_0x3be066,_0x1a4c1d);}(function(_0x5b05ee,_0x291f33){const _0x25a45a=a55_0x5547,_0x2af4ee=_0x5b05ee();while(!![]){try{const _0x382c05=parseInt(_0x25a45a(0x14f))/0x1+-parseInt(_0x25a45a(0x13f))/0x2*(-parseInt(_0x25a45a(0x144))/0x3)+parseInt(_0x25a45a(0x168))/0x4*(parseInt(_0x25a45a(0x15d))/0x5)+-parseInt(_0x25a45a(0x162))/0x6+parseInt(_0x25a45a(0x143))/0x7+-parseInt(_0x25a45a(0x157))/0x8+parseInt(_0x25a45a(0x13b))/0x9;if(_0x382c05===_0x291f33)break;else _0x2af4ee['push'](_0x2af4ee['shift']());}catch(_0x12d906){_0x2af4ee['push'](_0x2af4ee['shift']());}}}(a55_0x4ded,0x92a5e));var __importDefault=this&&this['__importDefault']||function(_0x26c1ac){const _0x2a09d1=a55_0x5547;return _0x26c1ac&&_0x26c1ac[_0x2a09d1(0x160)]?_0x26c1ac:{'default':_0x26c1ac};};Object[a55_0x928d3f(0x148)](exports,a55_0x928d3f(0x160),{'value':!![]}),exports[a55_0x928d3f(0x15b)]=void 0x0;const bcryptjs_1=__importDefault(require(a55_0x928d3f(0x163))),crypto_1=__importDefault(require('crypto')),database_1=__importDefault(require(a55_0x928d3f(0x13d)));class UserService{[a55_0x928d3f(0x14b)](){const _0x11dcbb=a55_0x928d3f,_0x179f8d=_0x11dcbb(0x146)+crypto_1[_0x11dcbb(0x153)][_0x11dcbb(0x167)](0x20)['toString'](_0x11dcbb(0x136)),_0xadeb6=_0x11dcbb(0x159)+crypto_1['default'][_0x11dcbb(0x167)](0x20)[_0x11dcbb(0x150)](_0x11dcbb(0x136));return{'publicKey':_0x179f8d,'secretKey':_0xadeb6};}async[a55_0x928d3f(0x14c)](_0x282474){const _0x595d11=a55_0x928d3f,{fullName:_0x2ce772,username:_0x3a24ee,password:_0x3a49d3,telegramId:_0x524472,merchantUrl:_0x91b762,gateways:_0x55414f,gatewaySettings:_0x2b92f1,wallets:_0x1c3f41}=_0x282474,_0xc5fc2c=await database_1['default'][_0x595d11(0x152)][_0x595d11(0x149)]({'where':{'username':_0x3a24ee}});if(_0xc5fc2c)throw new Error(_0x595d11(0x13e));if(_0x524472){const _0x2198a3=await database_1[_0x595d11(0x153)]['shop'][_0x595d11(0x149)]({'where':{'telegram':_0x524472}});if(_0x2198a3)throw new Error('Telegram\x20username\x20already\x20exists');}const _0x234dc1=await bcryptjs_1['default'][_0x595d11(0x156)](_0x3a49d3,0xc),{publicKey:_0x237317,secretKey:_0x347f45}=this['generateApiKeys'](),_0x5cbca3=await database_1[_0x595d11(0x153)][_0x595d11(0x152)][_0x595d11(0x14d)]({'data':{'name':_0x2ce772,'username':_0x3a24ee,'password':_0x234dc1,'telegram':_0x524472,'shopUrl':_0x91b762,'paymentGateways':_0x55414f?JSON['stringify'](_0x55414f):null,'gatewaySettings':_0x2b92f1?JSON[_0x595d11(0x145)](_0x2b92f1):null,'usdtPolygonWallet':_0x1c3f41?.[_0x595d11(0x139)]||null,'usdtTrcWallet':_0x1c3f41?.[_0x595d11(0x147)]||null,'usdtErcWallet':_0x1c3f41?.[_0x595d11(0x15a)]||null,'usdcPolygonWallet':_0x1c3f41?.[_0x595d11(0x142)]||null,'publicKey':_0x237317,'secretKey':_0x347f45,'status':_0x595d11(0x169)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x5cbca3['id'],'fullName':_0x5cbca3[_0x595d11(0x133)],'username':_0x5cbca3[_0x595d11(0x161)],'telegramId':_0x5cbca3['telegram'],'merchantUrl':_0x5cbca3['shopUrl'],'gateways':_0x5cbca3[_0x595d11(0x14e)]?JSON[_0x595d11(0x134)](_0x5cbca3[_0x595d11(0x14e)]):null,'gatewaySettings':_0x5cbca3['gatewaySettings']?JSON[_0x595d11(0x134)](_0x5cbca3['gatewaySettings']):null,'publicKey':_0x5cbca3[_0x595d11(0x15e)],'wallets':{'usdtPolygonWallet':_0x5cbca3['usdtPolygonWallet'],'usdtTrcWallet':_0x5cbca3[_0x595d11(0x147)],'usdtErcWallet':_0x5cbca3[_0x595d11(0x15a)],'usdcPolygonWallet':_0x5cbca3['usdcPolygonWallet']},'status':_0x5cbca3[_0x595d11(0x13a)],'createdAt':_0x5cbca3[_0x595d11(0x155)]};}async[a55_0x928d3f(0x141)](){const _0x31ba51=a55_0x928d3f,_0x199758=await database_1[_0x31ba51(0x153)][_0x31ba51(0x152)]['findMany']({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x31ba51(0x16a)}});return _0x199758[_0x31ba51(0x164)](_0x323e7f=>({'id':_0x323e7f['id'],'fullName':_0x323e7f['name'],'username':_0x323e7f[_0x31ba51(0x161)],'telegramId':_0x323e7f['telegram'],'merchantUrl':_0x323e7f['shopUrl'],'gateways':_0x323e7f['paymentGateways']?JSON['parse'](_0x323e7f[_0x31ba51(0x14e)]):null,'gatewaySettings':_0x323e7f[_0x31ba51(0x135)]?JSON[_0x31ba51(0x134)](_0x323e7f[_0x31ba51(0x135)]):null,'publicKey':_0x323e7f['publicKey'],'wallets':{'usdtPolygonWallet':_0x323e7f[_0x31ba51(0x139)],'usdtTrcWallet':_0x323e7f['usdtTrcWallet'],'usdtErcWallet':_0x323e7f[_0x31ba51(0x15a)],'usdcPolygonWallet':_0x323e7f[_0x31ba51(0x142)]},'status':_0x323e7f['status'],'createdAt':_0x323e7f[_0x31ba51(0x155)]}));}async[a55_0x928d3f(0x16b)](_0x5ebf3d){const _0x400be1=a55_0x928d3f,_0x2223ff=await database_1[_0x400be1(0x153)][_0x400be1(0x152)]['findUnique']({'where':{'id':_0x5ebf3d},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x2223ff)return null;return{'id':_0x2223ff['id'],'fullName':_0x2223ff['name'],'username':_0x2223ff[_0x400be1(0x161)],'telegramId':_0x2223ff[_0x400be1(0x13c)],'merchantUrl':_0x2223ff[_0x400be1(0x154)],'gateways':_0x2223ff['paymentGateways']?JSON[_0x400be1(0x134)](_0x2223ff[_0x400be1(0x14e)]):null,'gatewaySettings':_0x2223ff['gatewaySettings']?JSON[_0x400be1(0x134)](_0x2223ff[_0x400be1(0x135)]):null,'publicKey':_0x2223ff[_0x400be1(0x15e)],'wallets':{'usdtPolygonWallet':_0x2223ff[_0x400be1(0x139)],'usdtTrcWallet':_0x2223ff[_0x400be1(0x147)],'usdtErcWallet':_0x2223ff['usdtErcWallet'],'usdcPolygonWallet':_0x2223ff[_0x400be1(0x142)]},'status':_0x2223ff[_0x400be1(0x13a)],'createdAt':_0x2223ff['createdAt']};}async[a55_0x928d3f(0x14a)](_0x53fc03,_0x181088){const _0x2a71a7=a55_0x928d3f,_0x6edf2b={..._0x181088};_0x181088[_0x2a71a7(0x151)]&&(_0x6edf2b['password']=await bcryptjs_1['default'][_0x2a71a7(0x156)](_0x181088[_0x2a71a7(0x151)],0xc));_0x181088[_0x2a71a7(0x15f)]&&(_0x6edf2b[_0x2a71a7(0x133)]=_0x181088[_0x2a71a7(0x15f)],delete _0x6edf2b[_0x2a71a7(0x15f)]);_0x181088[_0x2a71a7(0x137)]&&(_0x6edf2b[_0x2a71a7(0x13c)]=_0x181088[_0x2a71a7(0x137)],delete _0x6edf2b[_0x2a71a7(0x137)]);_0x181088[_0x2a71a7(0x165)]&&(_0x6edf2b[_0x2a71a7(0x154)]=_0x181088[_0x2a71a7(0x165)],delete _0x6edf2b[_0x2a71a7(0x165)]);_0x181088[_0x2a71a7(0x140)]&&(_0x6edf2b[_0x2a71a7(0x14e)]=JSON[_0x2a71a7(0x145)](_0x181088[_0x2a71a7(0x140)]),delete _0x6edf2b[_0x2a71a7(0x140)]);_0x181088[_0x2a71a7(0x135)]&&(_0x6edf2b[_0x2a71a7(0x135)]=JSON['stringify'](_0x181088[_0x2a71a7(0x135)]),delete _0x6edf2b[_0x2a71a7(0x135)]);_0x181088['wallets']&&(_0x181088[_0x2a71a7(0x138)][_0x2a71a7(0x139)]!==undefined&&(_0x6edf2b['usdtPolygonWallet']=_0x181088[_0x2a71a7(0x138)][_0x2a71a7(0x139)]||null),_0x181088[_0x2a71a7(0x138)][_0x2a71a7(0x147)]!==undefined&&(_0x6edf2b[_0x2a71a7(0x147)]=_0x181088[_0x2a71a7(0x138)][_0x2a71a7(0x147)]||null),_0x181088['wallets'][_0x2a71a7(0x15a)]!==undefined&&(_0x6edf2b[_0x2a71a7(0x15a)]=_0x181088[_0x2a71a7(0x138)]['usdtErcWallet']||null),_0x181088[_0x2a71a7(0x138)][_0x2a71a7(0x142)]!==undefined&&(_0x6edf2b[_0x2a71a7(0x142)]=_0x181088[_0x2a71a7(0x138)][_0x2a71a7(0x142)]||null),delete _0x6edf2b[_0x2a71a7(0x138)]);const _0x56e5f5=await database_1[_0x2a71a7(0x153)][_0x2a71a7(0x152)][_0x2a71a7(0x15c)]({'where':{'id':_0x53fc03},'data':_0x6edf2b,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x56e5f5['id'],'fullName':_0x56e5f5['name'],'username':_0x56e5f5['username'],'telegramId':_0x56e5f5[_0x2a71a7(0x13c)],'merchantUrl':_0x56e5f5[_0x2a71a7(0x154)],'gateways':_0x56e5f5[_0x2a71a7(0x14e)]?JSON[_0x2a71a7(0x134)](_0x56e5f5[_0x2a71a7(0x14e)]):null,'gatewaySettings':_0x56e5f5[_0x2a71a7(0x135)]?JSON[_0x2a71a7(0x134)](_0x56e5f5[_0x2a71a7(0x135)]):null,'publicKey':_0x56e5f5[_0x2a71a7(0x15e)],'wallets':{'usdtPolygonWallet':_0x56e5f5[_0x2a71a7(0x139)],'usdtTrcWallet':_0x56e5f5['usdtTrcWallet'],'usdtErcWallet':_0x56e5f5[_0x2a71a7(0x15a)],'usdcPolygonWallet':_0x56e5f5[_0x2a71a7(0x142)]},'status':_0x56e5f5[_0x2a71a7(0x13a)],'createdAt':_0x56e5f5[_0x2a71a7(0x155)]};}async[a55_0x928d3f(0x166)](_0x5b4506){const _0x26766d=a55_0x928d3f;await database_1[_0x26766d(0x153)][_0x26766d(0x152)][_0x26766d(0x158)]({'where':{'id':_0x5b4506}});}}exports['UserService']=UserService;