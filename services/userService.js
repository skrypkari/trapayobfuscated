'use strict';const a51_0x569bff=a51_0x5d46;(function(_0x7ae14c,_0x12f41d){const _0x526378=a51_0x5d46,_0x179619=_0x7ae14c();while(!![]){try{const _0xbb2c4b=-parseInt(_0x526378(0x196))/0x1+parseInt(_0x526378(0x1b2))/0x2+parseInt(_0x526378(0x1a0))/0x3+parseInt(_0x526378(0x1ae))/0x4+parseInt(_0x526378(0x18a))/0x5+parseInt(_0x526378(0x195))/0x6*(parseInt(_0x526378(0x18e))/0x7)+-parseInt(_0x526378(0x183))/0x8*(parseInt(_0x526378(0x189))/0x9);if(_0xbb2c4b===_0x12f41d)break;else _0x179619['push'](_0x179619['shift']());}catch(_0x2bdbca){_0x179619['push'](_0x179619['shift']());}}}(a51_0x50ce,0x8fb10));var __importDefault=this&&this['__importDefault']||function(_0x3f267e){const _0x12905e=a51_0x5d46;return _0x3f267e&&_0x3f267e[_0x12905e(0x1b4)]?_0x3f267e:{'default':_0x3f267e};};function a51_0x5d46(_0x237835,_0x6a902f){const _0x50ce0e=a51_0x50ce();return a51_0x5d46=function(_0x5d469d,_0x288f69){_0x5d469d=_0x5d469d-0x183;let _0xf8a32=_0x50ce0e[_0x5d469d];return _0xf8a32;},a51_0x5d46(_0x237835,_0x6a902f);}Object[a51_0x569bff(0x197)](exports,a51_0x569bff(0x1b4),{'value':!![]}),exports[a51_0x569bff(0x1b5)]=void 0x0;function a51_0x50ce(){const _0x3f92b9=['toString','709552niiUFk','name','__esModule','UserService','updateUser','map','parse','hex','fullName','default','19608PUvmyI','desc','hash','usdtErcWallet','delete','generateApiKeys','3438xkeeXg','3842245XRiuci','findUnique','usdtPolygonWallet','bcryptjs','158557FMWkNG','findMany','publicKey','stringify','pk_','password','crypto','24BqTyYx','648448bzFLKA','defineProperty','shop','deleteUser','usdcPolygonWallet','paymentGateways','getUserById','Username\x20already\x20exists','username','Telegram\x20username\x20already\x20exists','191079IXfIfS','../config/database','update','usdtTrcWallet','createdAt','telegramId','randomBytes','merchantUrl','gatewaySettings','createUser','wallets','status','create','telegram','3583072vqKknD','gateways','shopUrl'];a51_0x50ce=function(){return _0x3f92b9;};return a51_0x50ce();}const bcryptjs_1=__importDefault(require(a51_0x569bff(0x18d))),crypto_1=__importDefault(require(a51_0x569bff(0x194))),database_1=__importDefault(require(a51_0x569bff(0x1a1)));class UserService{['generateApiKeys'](){const _0x541d85=a51_0x569bff,_0x1e4f75=_0x541d85(0x192)+crypto_1[_0x541d85(0x1bb)][_0x541d85(0x1a6)](0x20)[_0x541d85(0x1b1)](_0x541d85(0x1b9)),_0x1f2f2e='sk_'+crypto_1[_0x541d85(0x1bb)]['randomBytes'](0x20)[_0x541d85(0x1b1)](_0x541d85(0x1b9));return{'publicKey':_0x1e4f75,'secretKey':_0x1f2f2e};}async[a51_0x569bff(0x1a9)](_0x113f20){const _0x11b416=a51_0x569bff,{fullName:_0x5d4e00,username:_0x574949,password:_0x39de57,telegramId:_0x51862a,merchantUrl:_0x505cac,gateways:_0x4e9c48,gatewaySettings:_0x453497,wallets:_0x82c1f}=_0x113f20,_0xeb4053=await database_1[_0x11b416(0x1bb)][_0x11b416(0x198)][_0x11b416(0x18b)]({'where':{'username':_0x574949}});if(_0xeb4053)throw new Error(_0x11b416(0x19d));if(_0x51862a){const _0x3852f1=await database_1[_0x11b416(0x1bb)][_0x11b416(0x198)][_0x11b416(0x18b)]({'where':{'telegram':_0x51862a}});if(_0x3852f1)throw new Error(_0x11b416(0x19f));}const _0xf225c3=await bcryptjs_1['default'][_0x11b416(0x185)](_0x39de57,0xc),{publicKey:_0x5c4a27,secretKey:_0x9e5a2c}=this[_0x11b416(0x188)](),_0x3e8191=await database_1[_0x11b416(0x1bb)]['shop'][_0x11b416(0x1ac)]({'data':{'name':_0x5d4e00,'username':_0x574949,'password':_0xf225c3,'telegram':_0x51862a,'shopUrl':_0x505cac,'paymentGateways':_0x4e9c48?JSON[_0x11b416(0x191)](_0x4e9c48):null,'gatewaySettings':_0x453497?JSON['stringify'](_0x453497):null,'usdtPolygonWallet':_0x82c1f?.['usdtPolygonWallet']||null,'usdtTrcWallet':_0x82c1f?.[_0x11b416(0x1a3)]||null,'usdtErcWallet':_0x82c1f?.[_0x11b416(0x186)]||null,'usdcPolygonWallet':_0x82c1f?.[_0x11b416(0x19a)]||null,'publicKey':_0x5c4a27,'secretKey':_0x9e5a2c,'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x3e8191['id'],'fullName':_0x3e8191[_0x11b416(0x1b3)],'username':_0x3e8191[_0x11b416(0x19e)],'telegramId':_0x3e8191[_0x11b416(0x1ad)],'merchantUrl':_0x3e8191['shopUrl'],'gateways':_0x3e8191[_0x11b416(0x19b)]?JSON[_0x11b416(0x1b8)](_0x3e8191['paymentGateways']):null,'gatewaySettings':_0x3e8191[_0x11b416(0x1a8)]?JSON[_0x11b416(0x1b8)](_0x3e8191[_0x11b416(0x1a8)]):null,'publicKey':_0x3e8191[_0x11b416(0x190)],'wallets':{'usdtPolygonWallet':_0x3e8191[_0x11b416(0x18c)],'usdtTrcWallet':_0x3e8191['usdtTrcWallet'],'usdtErcWallet':_0x3e8191['usdtErcWallet'],'usdcPolygonWallet':_0x3e8191[_0x11b416(0x19a)]},'status':_0x3e8191[_0x11b416(0x1ab)],'createdAt':_0x3e8191[_0x11b416(0x1a4)]};}async['getAllUsers'](){const _0x3f8599=a51_0x569bff,_0x14f80e=await database_1[_0x3f8599(0x1bb)][_0x3f8599(0x198)][_0x3f8599(0x18f)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x3f8599(0x184)}});return _0x14f80e[_0x3f8599(0x1b7)](_0x7e9e50=>({'id':_0x7e9e50['id'],'fullName':_0x7e9e50[_0x3f8599(0x1b3)],'username':_0x7e9e50['username'],'telegramId':_0x7e9e50[_0x3f8599(0x1ad)],'merchantUrl':_0x7e9e50[_0x3f8599(0x1b0)],'gateways':_0x7e9e50[_0x3f8599(0x19b)]?JSON[_0x3f8599(0x1b8)](_0x7e9e50['paymentGateways']):null,'gatewaySettings':_0x7e9e50['gatewaySettings']?JSON[_0x3f8599(0x1b8)](_0x7e9e50[_0x3f8599(0x1a8)]):null,'publicKey':_0x7e9e50[_0x3f8599(0x190)],'wallets':{'usdtPolygonWallet':_0x7e9e50[_0x3f8599(0x18c)],'usdtTrcWallet':_0x7e9e50[_0x3f8599(0x1a3)],'usdtErcWallet':_0x7e9e50['usdtErcWallet'],'usdcPolygonWallet':_0x7e9e50[_0x3f8599(0x19a)]},'status':_0x7e9e50[_0x3f8599(0x1ab)],'createdAt':_0x7e9e50[_0x3f8599(0x1a4)]}));}async[a51_0x569bff(0x19c)](_0x5f00bd){const _0x5126cf=a51_0x569bff,_0xb6b3c0=await database_1[_0x5126cf(0x1bb)][_0x5126cf(0x198)]['findUnique']({'where':{'id':_0x5f00bd},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0xb6b3c0)return null;return{'id':_0xb6b3c0['id'],'fullName':_0xb6b3c0['name'],'username':_0xb6b3c0['username'],'telegramId':_0xb6b3c0['telegram'],'merchantUrl':_0xb6b3c0['shopUrl'],'gateways':_0xb6b3c0[_0x5126cf(0x19b)]?JSON[_0x5126cf(0x1b8)](_0xb6b3c0[_0x5126cf(0x19b)]):null,'gatewaySettings':_0xb6b3c0[_0x5126cf(0x1a8)]?JSON['parse'](_0xb6b3c0[_0x5126cf(0x1a8)]):null,'publicKey':_0xb6b3c0[_0x5126cf(0x190)],'wallets':{'usdtPolygonWallet':_0xb6b3c0[_0x5126cf(0x18c)],'usdtTrcWallet':_0xb6b3c0[_0x5126cf(0x1a3)],'usdtErcWallet':_0xb6b3c0[_0x5126cf(0x186)],'usdcPolygonWallet':_0xb6b3c0[_0x5126cf(0x19a)]},'status':_0xb6b3c0[_0x5126cf(0x1ab)],'createdAt':_0xb6b3c0[_0x5126cf(0x1a4)]};}async[a51_0x569bff(0x1b6)](_0x17f637,_0x2687ca){const _0x501473=a51_0x569bff,_0x59a914={..._0x2687ca};_0x2687ca[_0x501473(0x193)]&&(_0x59a914['password']=await bcryptjs_1['default']['hash'](_0x2687ca['password'],0xc));_0x2687ca[_0x501473(0x1ba)]&&(_0x59a914['name']=_0x2687ca['fullName'],delete _0x59a914['fullName']);_0x2687ca['telegramId']&&(_0x59a914[_0x501473(0x1ad)]=_0x2687ca[_0x501473(0x1a5)],delete _0x59a914[_0x501473(0x1a5)]);_0x2687ca['merchantUrl']&&(_0x59a914[_0x501473(0x1b0)]=_0x2687ca['merchantUrl'],delete _0x59a914[_0x501473(0x1a7)]);_0x2687ca[_0x501473(0x1af)]&&(_0x59a914[_0x501473(0x19b)]=JSON['stringify'](_0x2687ca[_0x501473(0x1af)]),delete _0x59a914[_0x501473(0x1af)]);_0x2687ca[_0x501473(0x1a8)]&&(_0x59a914[_0x501473(0x1a8)]=JSON[_0x501473(0x191)](_0x2687ca[_0x501473(0x1a8)]),delete _0x59a914[_0x501473(0x1a8)]);_0x2687ca[_0x501473(0x1aa)]&&(_0x2687ca[_0x501473(0x1aa)][_0x501473(0x18c)]!==undefined&&(_0x59a914[_0x501473(0x18c)]=_0x2687ca[_0x501473(0x1aa)][_0x501473(0x18c)]||null),_0x2687ca[_0x501473(0x1aa)][_0x501473(0x1a3)]!==undefined&&(_0x59a914[_0x501473(0x1a3)]=_0x2687ca[_0x501473(0x1aa)][_0x501473(0x1a3)]||null),_0x2687ca[_0x501473(0x1aa)][_0x501473(0x186)]!==undefined&&(_0x59a914['usdtErcWallet']=_0x2687ca[_0x501473(0x1aa)][_0x501473(0x186)]||null),_0x2687ca[_0x501473(0x1aa)][_0x501473(0x19a)]!==undefined&&(_0x59a914[_0x501473(0x19a)]=_0x2687ca[_0x501473(0x1aa)][_0x501473(0x19a)]||null),delete _0x59a914[_0x501473(0x1aa)]);const _0x4975bb=await database_1[_0x501473(0x1bb)][_0x501473(0x198)][_0x501473(0x1a2)]({'where':{'id':_0x17f637},'data':_0x59a914,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x4975bb['id'],'fullName':_0x4975bb[_0x501473(0x1b3)],'username':_0x4975bb[_0x501473(0x19e)],'telegramId':_0x4975bb[_0x501473(0x1ad)],'merchantUrl':_0x4975bb['shopUrl'],'gateways':_0x4975bb[_0x501473(0x19b)]?JSON[_0x501473(0x1b8)](_0x4975bb['paymentGateways']):null,'gatewaySettings':_0x4975bb[_0x501473(0x1a8)]?JSON[_0x501473(0x1b8)](_0x4975bb['gatewaySettings']):null,'publicKey':_0x4975bb[_0x501473(0x190)],'wallets':{'usdtPolygonWallet':_0x4975bb[_0x501473(0x18c)],'usdtTrcWallet':_0x4975bb[_0x501473(0x1a3)],'usdtErcWallet':_0x4975bb[_0x501473(0x186)],'usdcPolygonWallet':_0x4975bb[_0x501473(0x19a)]},'status':_0x4975bb['status'],'createdAt':_0x4975bb[_0x501473(0x1a4)]};}async[a51_0x569bff(0x199)](_0x190a63){const _0x5b4c08=a51_0x569bff;await database_1['default']['shop'][_0x5b4c08(0x187)]({'where':{'id':_0x190a63}});}}exports[a51_0x569bff(0x1b5)]=UserService;