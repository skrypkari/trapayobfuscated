'use strict';const a80_0x320ae5=a80_0x34b1;(function(_0x386a1c,_0x7a4d91){const _0x234224=a80_0x34b1,_0x49bf56=_0x386a1c();while(!![]){try{const _0x286427=parseInt(_0x234224(0x18a))/0x1*(parseInt(_0x234224(0x192))/0x2)+-parseInt(_0x234224(0x19a))/0x3*(parseInt(_0x234224(0x18f))/0x4)+-parseInt(_0x234224(0x196))/0x5+parseInt(_0x234224(0x189))/0x6+parseInt(_0x234224(0x174))/0x7+-parseInt(_0x234224(0x177))/0x8+-parseInt(_0x234224(0x19e))/0x9*(-parseInt(_0x234224(0x18b))/0xa);if(_0x286427===_0x7a4d91)break;else _0x49bf56['push'](_0x49bf56['shift']());}catch(_0x4b8e4f){_0x49bf56['push'](_0x49bf56['shift']());}}}(a80_0x323e,0x59812));var __importDefault=this&&this[a80_0x320ae5(0x19d)]||function(_0x567bcc){const _0x37ce48=a80_0x320ae5;return _0x567bcc&&_0x567bcc[_0x37ce48(0x1a6)]?_0x567bcc:{'default':_0x567bcc};};Object['defineProperty'](exports,a80_0x320ae5(0x1a6),{'value':!![]}),exports['UserService']=void 0x0;function a80_0x34b1(_0x4fa78a,_0x40da66){_0x4fa78a=_0x4fa78a-0x16d;const _0x323efa=a80_0x323e();let _0x34b18b=_0x323efa[_0x4fa78a];return _0x34b18b;}const bcryptjs_1=__importDefault(require(a80_0x320ae5(0x187))),crypto_1=__importDefault(require(a80_0x320ae5(0x199))),database_1=__importDefault(require(a80_0x320ae5(0x1a7)));class UserService{['generateApiKeys'](){const _0x3fc3cb=a80_0x320ae5,_0x2fd23f=_0x3fc3cb(0x16e)+crypto_1[_0x3fc3cb(0x17d)]['randomBytes'](0x20)[_0x3fc3cb(0x170)](_0x3fc3cb(0x171)),_0x4513b3='sk_'+crypto_1[_0x3fc3cb(0x17d)][_0x3fc3cb(0x17a)](0x20)[_0x3fc3cb(0x170)](_0x3fc3cb(0x171));return{'publicKey':_0x2fd23f,'secretKey':_0x4513b3};}async[a80_0x320ae5(0x185)](_0x487e9c){const _0x14ab41=a80_0x320ae5,{fullName:_0x312f70,username:_0x2202af,password:_0x203d0d,telegramId:_0x237c66,merchantUrl:_0x1b2bbd,gateways:_0x48b410,gatewaySettings:_0x903c82,wallets:_0x582704}=_0x487e9c,_0x4a94b3=await database_1['default'][_0x14ab41(0x179)][_0x14ab41(0x188)]({'where':{'username':_0x2202af}});if(_0x4a94b3)throw new Error(_0x14ab41(0x183));if(_0x237c66){const _0x3a71db=await database_1[_0x14ab41(0x17d)]['shop'][_0x14ab41(0x188)]({'where':{'telegram':_0x237c66}});if(_0x3a71db)throw new Error(_0x14ab41(0x195));}const _0x512d7d=await bcryptjs_1[_0x14ab41(0x17d)][_0x14ab41(0x181)](_0x203d0d,0xc),{publicKey:_0xdedb28,secretKey:_0xa33190}=this[_0x14ab41(0x193)](),_0x2db898=await database_1[_0x14ab41(0x17d)]['shop'][_0x14ab41(0x190)]({'data':{'name':_0x312f70,'username':_0x2202af,'password':_0x512d7d,'telegram':_0x237c66,'shopUrl':_0x1b2bbd,'paymentGateways':_0x48b410?JSON[_0x14ab41(0x1a0)](_0x48b410):null,'gatewaySettings':_0x903c82?JSON[_0x14ab41(0x1a0)](_0x903c82):null,'usdtPolygonWallet':_0x582704?.[_0x14ab41(0x18c)]||null,'usdtTrcWallet':_0x582704?.[_0x14ab41(0x17f)]||null,'usdtErcWallet':_0x582704?.[_0x14ab41(0x172)]||null,'usdcPolygonWallet':_0x582704?.[_0x14ab41(0x175)]||null,'publicKey':_0xdedb28,'secretKey':_0xa33190,'status':_0x14ab41(0x17e)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x2db898['id'],'fullName':_0x2db898[_0x14ab41(0x1a1)],'username':_0x2db898['username'],'telegramId':_0x2db898['telegram'],'merchantUrl':_0x2db898['shopUrl'],'gateways':_0x2db898[_0x14ab41(0x176)]?JSON['parse'](_0x2db898['paymentGateways']):null,'gatewaySettings':_0x2db898[_0x14ab41(0x16d)]?JSON[_0x14ab41(0x1a5)](_0x2db898[_0x14ab41(0x16d)]):null,'publicKey':_0x2db898[_0x14ab41(0x18d)],'wallets':{'usdtPolygonWallet':_0x2db898[_0x14ab41(0x18c)],'usdtTrcWallet':_0x2db898['usdtTrcWallet'],'usdtErcWallet':_0x2db898[_0x14ab41(0x172)],'usdcPolygonWallet':_0x2db898[_0x14ab41(0x175)]},'status':_0x2db898['status'],'createdAt':_0x2db898[_0x14ab41(0x173)]};}async[a80_0x320ae5(0x1a4)](){const _0x5ab2e5=a80_0x320ae5,_0x3ccb05=await database_1['default']['shop'][_0x5ab2e5(0x194)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x5ab2e5(0x19f)}});return _0x3ccb05['map'](_0x35b72f=>({'id':_0x35b72f['id'],'fullName':_0x35b72f[_0x5ab2e5(0x1a1)],'username':_0x35b72f[_0x5ab2e5(0x16f)],'telegramId':_0x35b72f[_0x5ab2e5(0x191)],'merchantUrl':_0x35b72f[_0x5ab2e5(0x1a2)],'gateways':_0x35b72f['paymentGateways']?JSON[_0x5ab2e5(0x1a5)](_0x35b72f[_0x5ab2e5(0x176)]):null,'gatewaySettings':_0x35b72f[_0x5ab2e5(0x16d)]?JSON[_0x5ab2e5(0x1a5)](_0x35b72f[_0x5ab2e5(0x16d)]):null,'publicKey':_0x35b72f[_0x5ab2e5(0x18d)],'wallets':{'usdtPolygonWallet':_0x35b72f[_0x5ab2e5(0x18c)],'usdtTrcWallet':_0x35b72f['usdtTrcWallet'],'usdtErcWallet':_0x35b72f[_0x5ab2e5(0x172)],'usdcPolygonWallet':_0x35b72f[_0x5ab2e5(0x175)]},'status':_0x35b72f['status'],'createdAt':_0x35b72f['createdAt']}));}async[a80_0x320ae5(0x198)](_0x3434c8){const _0x336ffe=a80_0x320ae5,_0x502a59=await database_1[_0x336ffe(0x17d)][_0x336ffe(0x179)][_0x336ffe(0x188)]({'where':{'id':_0x3434c8},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x502a59)return null;return{'id':_0x502a59['id'],'fullName':_0x502a59[_0x336ffe(0x1a1)],'username':_0x502a59[_0x336ffe(0x16f)],'telegramId':_0x502a59[_0x336ffe(0x191)],'merchantUrl':_0x502a59[_0x336ffe(0x1a2)],'gateways':_0x502a59['paymentGateways']?JSON[_0x336ffe(0x1a5)](_0x502a59[_0x336ffe(0x176)]):null,'gatewaySettings':_0x502a59[_0x336ffe(0x16d)]?JSON[_0x336ffe(0x1a5)](_0x502a59[_0x336ffe(0x16d)]):null,'publicKey':_0x502a59[_0x336ffe(0x18d)],'wallets':{'usdtPolygonWallet':_0x502a59[_0x336ffe(0x18c)],'usdtTrcWallet':_0x502a59[_0x336ffe(0x17f)],'usdtErcWallet':_0x502a59[_0x336ffe(0x172)],'usdcPolygonWallet':_0x502a59[_0x336ffe(0x175)]},'status':_0x502a59[_0x336ffe(0x184)],'createdAt':_0x502a59[_0x336ffe(0x173)]};}async[a80_0x320ae5(0x1a3)](_0x40e8b,_0x11344c){const _0x5c46a5=a80_0x320ae5,_0x67b3b2={..._0x11344c};_0x11344c[_0x5c46a5(0x178)]&&(_0x67b3b2[_0x5c46a5(0x178)]=await bcryptjs_1[_0x5c46a5(0x17d)][_0x5c46a5(0x181)](_0x11344c['password'],0xc));_0x11344c[_0x5c46a5(0x17b)]&&(_0x67b3b2[_0x5c46a5(0x1a1)]=_0x11344c[_0x5c46a5(0x17b)],delete _0x67b3b2['fullName']);_0x11344c[_0x5c46a5(0x19c)]&&(_0x67b3b2[_0x5c46a5(0x191)]=_0x11344c[_0x5c46a5(0x19c)],delete _0x67b3b2[_0x5c46a5(0x19c)]);_0x11344c[_0x5c46a5(0x186)]&&(_0x67b3b2[_0x5c46a5(0x1a2)]=_0x11344c[_0x5c46a5(0x186)],delete _0x67b3b2[_0x5c46a5(0x186)]);_0x11344c[_0x5c46a5(0x182)]&&(_0x67b3b2['paymentGateways']=JSON[_0x5c46a5(0x1a0)](_0x11344c[_0x5c46a5(0x182)]),delete _0x67b3b2[_0x5c46a5(0x182)]);_0x11344c['gatewaySettings']&&(_0x67b3b2[_0x5c46a5(0x16d)]=JSON[_0x5c46a5(0x1a0)](_0x11344c[_0x5c46a5(0x16d)]),delete _0x67b3b2[_0x5c46a5(0x16d)]);_0x11344c[_0x5c46a5(0x197)]&&(_0x11344c[_0x5c46a5(0x197)][_0x5c46a5(0x18c)]!==undefined&&(_0x67b3b2[_0x5c46a5(0x18c)]=_0x11344c['wallets']['usdtPolygonWallet']||null),_0x11344c[_0x5c46a5(0x197)][_0x5c46a5(0x17f)]!==undefined&&(_0x67b3b2[_0x5c46a5(0x17f)]=_0x11344c['wallets'][_0x5c46a5(0x17f)]||null),_0x11344c[_0x5c46a5(0x197)][_0x5c46a5(0x172)]!==undefined&&(_0x67b3b2[_0x5c46a5(0x172)]=_0x11344c[_0x5c46a5(0x197)][_0x5c46a5(0x172)]||null),_0x11344c[_0x5c46a5(0x197)]['usdcPolygonWallet']!==undefined&&(_0x67b3b2['usdcPolygonWallet']=_0x11344c[_0x5c46a5(0x197)][_0x5c46a5(0x175)]||null),delete _0x67b3b2[_0x5c46a5(0x197)]);const _0x4e30c0=await database_1[_0x5c46a5(0x17d)][_0x5c46a5(0x179)][_0x5c46a5(0x19b)]({'where':{'id':_0x40e8b},'data':_0x67b3b2,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x4e30c0['id'],'fullName':_0x4e30c0[_0x5c46a5(0x1a1)],'username':_0x4e30c0[_0x5c46a5(0x16f)],'telegramId':_0x4e30c0[_0x5c46a5(0x191)],'merchantUrl':_0x4e30c0[_0x5c46a5(0x1a2)],'gateways':_0x4e30c0[_0x5c46a5(0x176)]?JSON[_0x5c46a5(0x1a5)](_0x4e30c0['paymentGateways']):null,'gatewaySettings':_0x4e30c0['gatewaySettings']?JSON[_0x5c46a5(0x1a5)](_0x4e30c0[_0x5c46a5(0x16d)]):null,'publicKey':_0x4e30c0['publicKey'],'wallets':{'usdtPolygonWallet':_0x4e30c0[_0x5c46a5(0x18c)],'usdtTrcWallet':_0x4e30c0['usdtTrcWallet'],'usdtErcWallet':_0x4e30c0[_0x5c46a5(0x172)],'usdcPolygonWallet':_0x4e30c0[_0x5c46a5(0x175)]},'status':_0x4e30c0[_0x5c46a5(0x184)],'createdAt':_0x4e30c0['createdAt']};}async[a80_0x320ae5(0x17c)](_0x414e57){const _0xf46a4=a80_0x320ae5;await database_1[_0xf46a4(0x17d)][_0xf46a4(0x179)][_0xf46a4(0x180)]({'where':{'id':_0x414e57}});}}function a80_0x323e(){const _0x204ffe=['__importDefault','2399517fKNeXz','desc','stringify','name','shopUrl','updateUser','getAllUsers','parse','__esModule','../config/database','gatewaySettings','pk_','username','toString','hex','usdtErcWallet','createdAt','111580ivFoDo','usdcPolygonWallet','paymentGateways','1992768Shtany','password','shop','randomBytes','fullName','deleteUser','default','ACTIVE','usdtTrcWallet','delete','hash','gateways','Username\x20already\x20exists','status','createUser','merchantUrl','bcryptjs','findUnique','2533908efolef','186306kuzitL','10jUyVhk','usdtPolygonWallet','publicKey','UserService','96boYaRW','create','telegram','6rqPHBv','generateApiKeys','findMany','Telegram\x20username\x20already\x20exists','452695HxnhIv','wallets','getUserById','crypto','69693qJDlhu','update','telegramId'];a80_0x323e=function(){return _0x204ffe;};return a80_0x323e();}exports[a80_0x320ae5(0x18e)]=UserService;