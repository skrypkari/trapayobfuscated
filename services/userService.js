'use strict';const a55_0xe6a35a=a55_0xa324;(function(_0x392d7b,_0x4b7c87){const _0x1efd6a=a55_0xa324,_0x33cc5f=_0x392d7b();while(!![]){try{const _0x3ec1c5=-parseInt(_0x1efd6a(0x157))/0x1*(-parseInt(_0x1efd6a(0x159))/0x2)+-parseInt(_0x1efd6a(0x15c))/0x3*(-parseInt(_0x1efd6a(0x175))/0x4)+parseInt(_0x1efd6a(0x154))/0x5*(parseInt(_0x1efd6a(0x15a))/0x6)+-parseInt(_0x1efd6a(0x180))/0x7+parseInt(_0x1efd6a(0x16b))/0x8+-parseInt(_0x1efd6a(0x15d))/0x9+parseInt(_0x1efd6a(0x17a))/0xa;if(_0x3ec1c5===_0x4b7c87)break;else _0x33cc5f['push'](_0x33cc5f['shift']());}catch(_0x50d1ab){_0x33cc5f['push'](_0x33cc5f['shift']());}}}(a55_0xa1b3,0x835c8));function a55_0xa1b3(){const _0x3036d3=['ACTIVE','create','7hKdhkf','password','10196AVQzYB','78VoDVtf','usdcPolygonWallet','33924iHlcof','8501274CzsSjD','delete','createdAt','Username\x20already\x20exists','bcryptjs','telegram','shopUrl','generateApiKeys','findUnique','status','merchantUrl','__esModule','telegramId','findMany','2038504jaZQyl','desc','gatewaySettings','update','deleteUser','username','parse','UserService','getAllUsers','default','8navLOS','__importDefault','randomBytes','name','../config/database','9577570sOZnjM','usdtTrcWallet','usdtPolygonWallet','stringify','paymentGateways','publicKey','2252796zGlwLV','updateUser','createUser','shop','toString','usdtErcWallet','wallets','defineProperty','hex','hash','fullName','205230qlfxze'];a55_0xa1b3=function(){return _0x3036d3;};return a55_0xa1b3();}var __importDefault=this&&this[a55_0xe6a35a(0x176)]||function(_0x248b64){const _0x5494fc=a55_0xe6a35a;return _0x248b64&&_0x248b64[_0x5494fc(0x168)]?_0x248b64:{'default':_0x248b64};};Object[a55_0xe6a35a(0x150)](exports,a55_0xe6a35a(0x168),{'value':!![]}),exports[a55_0xe6a35a(0x172)]=void 0x0;const bcryptjs_1=__importDefault(require(a55_0xe6a35a(0x161))),crypto_1=__importDefault(require('crypto')),database_1=__importDefault(require(a55_0xe6a35a(0x179)));function a55_0xa324(_0xb83cff,_0x52848c){const _0xa1b320=a55_0xa1b3();return a55_0xa324=function(_0xa324cf,_0x535940){_0xa324cf=_0xa324cf-0x14b;let _0x501816=_0xa1b320[_0xa324cf];return _0x501816;},a55_0xa324(_0xb83cff,_0x52848c);}class UserService{[a55_0xe6a35a(0x164)](){const _0x592989=a55_0xe6a35a,_0x57bc31='pk_'+crypto_1['default'][_0x592989(0x177)](0x20)[_0x592989(0x14d)](_0x592989(0x151)),_0x1a5775='sk_'+crypto_1[_0x592989(0x174)][_0x592989(0x177)](0x20)[_0x592989(0x14d)](_0x592989(0x151));return{'publicKey':_0x57bc31,'secretKey':_0x1a5775};}async[a55_0xe6a35a(0x14b)](_0xb0c38b){const _0x55b527=a55_0xe6a35a,{fullName:_0x1e4c29,username:_0x6bccf0,password:_0x2091ab,telegramId:_0x5674b2,merchantUrl:_0x20653b,gateways:_0xa42809,gatewaySettings:_0x2b20a4,wallets:_0x22904c}=_0xb0c38b,_0x1cd821=await database_1[_0x55b527(0x174)][_0x55b527(0x14c)][_0x55b527(0x165)]({'where':{'username':_0x6bccf0}});if(_0x1cd821)throw new Error(_0x55b527(0x160));if(_0x5674b2){const _0x68f110=await database_1[_0x55b527(0x174)]['shop'][_0x55b527(0x165)]({'where':{'telegram':_0x5674b2}});if(_0x68f110)throw new Error('Telegram\x20username\x20already\x20exists');}const _0x2fc9e4=await bcryptjs_1[_0x55b527(0x174)][_0x55b527(0x152)](_0x2091ab,0xc),{publicKey:_0x52fb79,secretKey:_0x4bf350}=this[_0x55b527(0x164)](),_0x1690e7=await database_1[_0x55b527(0x174)][_0x55b527(0x14c)][_0x55b527(0x156)]({'data':{'name':_0x1e4c29,'username':_0x6bccf0,'password':_0x2fc9e4,'telegram':_0x5674b2,'shopUrl':_0x20653b,'paymentGateways':_0xa42809?JSON[_0x55b527(0x17d)](_0xa42809):null,'gatewaySettings':_0x2b20a4?JSON[_0x55b527(0x17d)](_0x2b20a4):null,'usdtPolygonWallet':_0x22904c?.[_0x55b527(0x17c)]||null,'usdtTrcWallet':_0x22904c?.[_0x55b527(0x17b)]||null,'usdtErcWallet':_0x22904c?.[_0x55b527(0x14e)]||null,'usdcPolygonWallet':_0x22904c?.[_0x55b527(0x15b)]||null,'publicKey':_0x52fb79,'secretKey':_0x4bf350,'status':_0x55b527(0x155)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x1690e7['id'],'fullName':_0x1690e7['name'],'username':_0x1690e7[_0x55b527(0x170)],'telegramId':_0x1690e7[_0x55b527(0x162)],'merchantUrl':_0x1690e7[_0x55b527(0x163)],'gateways':_0x1690e7[_0x55b527(0x17e)]?JSON[_0x55b527(0x171)](_0x1690e7[_0x55b527(0x17e)]):null,'gatewaySettings':_0x1690e7['gatewaySettings']?JSON['parse'](_0x1690e7[_0x55b527(0x16d)]):null,'publicKey':_0x1690e7[_0x55b527(0x17f)],'wallets':{'usdtPolygonWallet':_0x1690e7[_0x55b527(0x17c)],'usdtTrcWallet':_0x1690e7['usdtTrcWallet'],'usdtErcWallet':_0x1690e7[_0x55b527(0x14e)],'usdcPolygonWallet':_0x1690e7[_0x55b527(0x15b)]},'status':_0x1690e7['status'],'createdAt':_0x1690e7['createdAt']};}async[a55_0xe6a35a(0x173)](){const _0x1f4e62=a55_0xe6a35a,_0x1190a1=await database_1[_0x1f4e62(0x174)][_0x1f4e62(0x14c)][_0x1f4e62(0x16a)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x1f4e62(0x16c)}});return _0x1190a1['map'](_0x1e3106=>({'id':_0x1e3106['id'],'fullName':_0x1e3106['name'],'username':_0x1e3106['username'],'telegramId':_0x1e3106[_0x1f4e62(0x162)],'merchantUrl':_0x1e3106['shopUrl'],'gateways':_0x1e3106['paymentGateways']?JSON[_0x1f4e62(0x171)](_0x1e3106['paymentGateways']):null,'gatewaySettings':_0x1e3106[_0x1f4e62(0x16d)]?JSON['parse'](_0x1e3106[_0x1f4e62(0x16d)]):null,'publicKey':_0x1e3106[_0x1f4e62(0x17f)],'wallets':{'usdtPolygonWallet':_0x1e3106[_0x1f4e62(0x17c)],'usdtTrcWallet':_0x1e3106['usdtTrcWallet'],'usdtErcWallet':_0x1e3106['usdtErcWallet'],'usdcPolygonWallet':_0x1e3106[_0x1f4e62(0x15b)]},'status':_0x1e3106[_0x1f4e62(0x166)],'createdAt':_0x1e3106[_0x1f4e62(0x15f)]}));}async['getUserById'](_0x3beb80){const _0x58b6a4=a55_0xe6a35a,_0x540ba7=await database_1['default'][_0x58b6a4(0x14c)][_0x58b6a4(0x165)]({'where':{'id':_0x3beb80},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x540ba7)return null;return{'id':_0x540ba7['id'],'fullName':_0x540ba7[_0x58b6a4(0x178)],'username':_0x540ba7['username'],'telegramId':_0x540ba7['telegram'],'merchantUrl':_0x540ba7[_0x58b6a4(0x163)],'gateways':_0x540ba7[_0x58b6a4(0x17e)]?JSON['parse'](_0x540ba7[_0x58b6a4(0x17e)]):null,'gatewaySettings':_0x540ba7['gatewaySettings']?JSON['parse'](_0x540ba7[_0x58b6a4(0x16d)]):null,'publicKey':_0x540ba7[_0x58b6a4(0x17f)],'wallets':{'usdtPolygonWallet':_0x540ba7['usdtPolygonWallet'],'usdtTrcWallet':_0x540ba7['usdtTrcWallet'],'usdtErcWallet':_0x540ba7['usdtErcWallet'],'usdcPolygonWallet':_0x540ba7[_0x58b6a4(0x15b)]},'status':_0x540ba7['status'],'createdAt':_0x540ba7['createdAt']};}async[a55_0xe6a35a(0x181)](_0x2c5a82,_0x5abd57){const _0x1e987c=a55_0xe6a35a,_0x1920a5={..._0x5abd57};_0x5abd57[_0x1e987c(0x158)]&&(_0x1920a5[_0x1e987c(0x158)]=await bcryptjs_1[_0x1e987c(0x174)][_0x1e987c(0x152)](_0x5abd57[_0x1e987c(0x158)],0xc));_0x5abd57[_0x1e987c(0x153)]&&(_0x1920a5['name']=_0x5abd57['fullName'],delete _0x1920a5[_0x1e987c(0x153)]);_0x5abd57[_0x1e987c(0x169)]&&(_0x1920a5[_0x1e987c(0x162)]=_0x5abd57[_0x1e987c(0x169)],delete _0x1920a5['telegramId']);_0x5abd57[_0x1e987c(0x167)]&&(_0x1920a5[_0x1e987c(0x163)]=_0x5abd57['merchantUrl'],delete _0x1920a5['merchantUrl']);_0x5abd57['gateways']&&(_0x1920a5[_0x1e987c(0x17e)]=JSON['stringify'](_0x5abd57['gateways']),delete _0x1920a5['gateways']);_0x5abd57['gatewaySettings']&&(_0x1920a5[_0x1e987c(0x16d)]=JSON['stringify'](_0x5abd57[_0x1e987c(0x16d)]),delete _0x1920a5[_0x1e987c(0x16d)]);_0x5abd57[_0x1e987c(0x14f)]&&(_0x5abd57[_0x1e987c(0x14f)][_0x1e987c(0x17c)]!==undefined&&(_0x1920a5[_0x1e987c(0x17c)]=_0x5abd57[_0x1e987c(0x14f)][_0x1e987c(0x17c)]||null),_0x5abd57['wallets'][_0x1e987c(0x17b)]!==undefined&&(_0x1920a5['usdtTrcWallet']=_0x5abd57[_0x1e987c(0x14f)][_0x1e987c(0x17b)]||null),_0x5abd57['wallets'][_0x1e987c(0x14e)]!==undefined&&(_0x1920a5[_0x1e987c(0x14e)]=_0x5abd57['wallets'][_0x1e987c(0x14e)]||null),_0x5abd57['wallets']['usdcPolygonWallet']!==undefined&&(_0x1920a5[_0x1e987c(0x15b)]=_0x5abd57[_0x1e987c(0x14f)]['usdcPolygonWallet']||null),delete _0x1920a5[_0x1e987c(0x14f)]);const _0x3e395c=await database_1[_0x1e987c(0x174)][_0x1e987c(0x14c)][_0x1e987c(0x16e)]({'where':{'id':_0x2c5a82},'data':_0x1920a5,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x3e395c['id'],'fullName':_0x3e395c[_0x1e987c(0x178)],'username':_0x3e395c['username'],'telegramId':_0x3e395c[_0x1e987c(0x162)],'merchantUrl':_0x3e395c[_0x1e987c(0x163)],'gateways':_0x3e395c[_0x1e987c(0x17e)]?JSON[_0x1e987c(0x171)](_0x3e395c[_0x1e987c(0x17e)]):null,'gatewaySettings':_0x3e395c[_0x1e987c(0x16d)]?JSON[_0x1e987c(0x171)](_0x3e395c[_0x1e987c(0x16d)]):null,'publicKey':_0x3e395c['publicKey'],'wallets':{'usdtPolygonWallet':_0x3e395c[_0x1e987c(0x17c)],'usdtTrcWallet':_0x3e395c[_0x1e987c(0x17b)],'usdtErcWallet':_0x3e395c[_0x1e987c(0x14e)],'usdcPolygonWallet':_0x3e395c[_0x1e987c(0x15b)]},'status':_0x3e395c[_0x1e987c(0x166)],'createdAt':_0x3e395c[_0x1e987c(0x15f)]};}async[a55_0xe6a35a(0x16f)](_0xbbc2d2){const _0x39201e=a55_0xe6a35a;await database_1[_0x39201e(0x174)]['shop'][_0x39201e(0x15e)]({'where':{'id':_0xbbc2d2}});}}exports[a55_0xe6a35a(0x172)]=UserService;