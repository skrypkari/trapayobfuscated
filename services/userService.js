'use strict';const a68_0x262b03=a68_0x22ca;function a68_0x52da(){const _0x508439=['create','__importDefault','findUnique','map','hash','UserService','findMany','wallets','createdAt','password','761410lrVtgA','sk_','paymentGateways','stringify','231EXQSRO','pk_','username','gatewaySettings','gateways','name','shopUrl','4pEjtnJ','usdcPolygonWallet','createUser','ACTIVE','usdtErcWallet','__esModule','getUserById','default','merchantUrl','parse','hex','8KtJgMI','status','28092fPpmdM','publicKey','randomBytes','3359457rDoeat','usdtPolygonWallet','usdtTrcWallet','11rmFbnL','shop','toString','deleteUser','97278cOdROV','576530zVvhPn','bcryptjs','crypto','defineProperty','fullName','14152470mqLJpR','generateApiKeys','telegram','1504536vHAoHE','telegramId'];a68_0x52da=function(){return _0x508439;};return a68_0x52da();}(function(_0x2c0f08,_0x1c521d){const _0x41e8d2=a68_0x22ca,_0x557547=_0x2c0f08();while(!![]){try{const _0x34e56f=parseInt(_0x41e8d2(0xa4))/0x1+-parseInt(_0x41e8d2(0xac))/0x2+parseInt(_0x41e8d2(0x99))/0x3*(parseInt(_0x41e8d2(0x8c))/0x4)+parseInt(_0x41e8d2(0x81))/0x5+-parseInt(_0x41e8d2(0xa3))/0x6*(parseInt(_0x41e8d2(0x85))/0x7)+-parseInt(_0x41e8d2(0x97))/0x8*(parseInt(_0x41e8d2(0x9c))/0x9)+parseInt(_0x41e8d2(0xa9))/0xa*(parseInt(_0x41e8d2(0x9f))/0xb);if(_0x34e56f===_0x1c521d)break;else _0x557547['push'](_0x557547['shift']());}catch(_0xf19425){_0x557547['push'](_0x557547['shift']());}}}(a68_0x52da,0x78535));var __importDefault=this&&this[a68_0x262b03(0xaf)]||function(_0x53e73){return _0x53e73&&_0x53e73['__esModule']?_0x53e73:{'default':_0x53e73};};Object[a68_0x262b03(0xa7)](exports,a68_0x262b03(0x91),{'value':!![]}),exports['UserService']=void 0x0;const bcryptjs_1=__importDefault(require(a68_0x262b03(0xa5))),crypto_1=__importDefault(require(a68_0x262b03(0xa6))),database_1=__importDefault(require('../config/database'));function a68_0x22ca(_0x45f558,_0x4a80b4){const _0x52da34=a68_0x52da();return a68_0x22ca=function(_0x22ca55,_0x9f410f){_0x22ca55=_0x22ca55-0x7d;let _0x4a80d8=_0x52da34[_0x22ca55];return _0x4a80d8;},a68_0x22ca(_0x45f558,_0x4a80b4);}class UserService{[a68_0x262b03(0xaa)](){const _0x32a6ed=a68_0x262b03,_0x3d8a82=_0x32a6ed(0x86)+crypto_1[_0x32a6ed(0x93)][_0x32a6ed(0x9b)](0x20)[_0x32a6ed(0xa1)](_0x32a6ed(0x96)),_0x18cac9=_0x32a6ed(0x82)+crypto_1['default'][_0x32a6ed(0x9b)](0x20)[_0x32a6ed(0xa1)](_0x32a6ed(0x96));return{'publicKey':_0x3d8a82,'secretKey':_0x18cac9};}async[a68_0x262b03(0x8e)](_0x650ab5){const _0x530191=a68_0x262b03,{fullName:_0x1b97b1,username:_0x5e6f22,password:_0x70d07f,telegramId:_0x299fc7,merchantUrl:_0x3b520e,gateways:_0x4d5e1d,gatewaySettings:_0x384e18,wallets:_0xa1d6ba}=_0x650ab5,_0x5a40bb=await database_1[_0x530191(0x93)][_0x530191(0xa0)][_0x530191(0xb0)]({'where':{'username':_0x5e6f22}});if(_0x5a40bb)throw new Error('Username\x20already\x20exists');if(_0x299fc7){const _0x114f4a=await database_1[_0x530191(0x93)][_0x530191(0xa0)][_0x530191(0xb0)]({'where':{'telegram':_0x299fc7}});if(_0x114f4a)throw new Error('Telegram\x20username\x20already\x20exists');}const _0x45a579=await bcryptjs_1['default'][_0x530191(0xb2)](_0x70d07f,0xc),{publicKey:_0x544af7,secretKey:_0xd1f8d9}=this[_0x530191(0xaa)](),_0x393a4e=await database_1['default'][_0x530191(0xa0)][_0x530191(0xae)]({'data':{'name':_0x1b97b1,'username':_0x5e6f22,'password':_0x45a579,'telegram':_0x299fc7,'shopUrl':_0x3b520e,'paymentGateways':_0x4d5e1d?JSON[_0x530191(0x84)](_0x4d5e1d):null,'gatewaySettings':_0x384e18?JSON[_0x530191(0x84)](_0x384e18):null,'usdtPolygonWallet':_0xa1d6ba?.[_0x530191(0x9d)]||null,'usdtTrcWallet':_0xa1d6ba?.['usdtTrcWallet']||null,'usdtErcWallet':_0xa1d6ba?.[_0x530191(0x90)]||null,'usdcPolygonWallet':_0xa1d6ba?.[_0x530191(0x8d)]||null,'publicKey':_0x544af7,'secretKey':_0xd1f8d9,'status':_0x530191(0x8f)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x393a4e['id'],'fullName':_0x393a4e[_0x530191(0x8a)],'username':_0x393a4e[_0x530191(0x87)],'telegramId':_0x393a4e['telegram'],'merchantUrl':_0x393a4e['shopUrl'],'gateways':_0x393a4e[_0x530191(0x83)]?JSON['parse'](_0x393a4e['paymentGateways']):null,'gatewaySettings':_0x393a4e[_0x530191(0x88)]?JSON[_0x530191(0x95)](_0x393a4e[_0x530191(0x88)]):null,'publicKey':_0x393a4e[_0x530191(0x9a)],'wallets':{'usdtPolygonWallet':_0x393a4e['usdtPolygonWallet'],'usdtTrcWallet':_0x393a4e[_0x530191(0x9e)],'usdtErcWallet':_0x393a4e[_0x530191(0x90)],'usdcPolygonWallet':_0x393a4e['usdcPolygonWallet']},'status':_0x393a4e['status'],'createdAt':_0x393a4e[_0x530191(0x7f)]};}async['getAllUsers'](){const _0x2d489f=a68_0x262b03,_0x3fd2f5=await database_1['default'][_0x2d489f(0xa0)][_0x2d489f(0x7d)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':'desc'}});return _0x3fd2f5[_0x2d489f(0xb1)](_0x46c0c6=>({'id':_0x46c0c6['id'],'fullName':_0x46c0c6[_0x2d489f(0x8a)],'username':_0x46c0c6[_0x2d489f(0x87)],'telegramId':_0x46c0c6[_0x2d489f(0xab)],'merchantUrl':_0x46c0c6[_0x2d489f(0x8b)],'gateways':_0x46c0c6[_0x2d489f(0x83)]?JSON[_0x2d489f(0x95)](_0x46c0c6[_0x2d489f(0x83)]):null,'gatewaySettings':_0x46c0c6[_0x2d489f(0x88)]?JSON['parse'](_0x46c0c6[_0x2d489f(0x88)]):null,'publicKey':_0x46c0c6[_0x2d489f(0x9a)],'wallets':{'usdtPolygonWallet':_0x46c0c6['usdtPolygonWallet'],'usdtTrcWallet':_0x46c0c6[_0x2d489f(0x9e)],'usdtErcWallet':_0x46c0c6['usdtErcWallet'],'usdcPolygonWallet':_0x46c0c6[_0x2d489f(0x8d)]},'status':_0x46c0c6['status'],'createdAt':_0x46c0c6[_0x2d489f(0x7f)]}));}async[a68_0x262b03(0x92)](_0x28dba5){const _0x117347=a68_0x262b03,_0x1cb0f5=await database_1[_0x117347(0x93)][_0x117347(0xa0)]['findUnique']({'where':{'id':_0x28dba5},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x1cb0f5)return null;return{'id':_0x1cb0f5['id'],'fullName':_0x1cb0f5[_0x117347(0x8a)],'username':_0x1cb0f5[_0x117347(0x87)],'telegramId':_0x1cb0f5['telegram'],'merchantUrl':_0x1cb0f5[_0x117347(0x8b)],'gateways':_0x1cb0f5[_0x117347(0x83)]?JSON[_0x117347(0x95)](_0x1cb0f5[_0x117347(0x83)]):null,'gatewaySettings':_0x1cb0f5[_0x117347(0x88)]?JSON[_0x117347(0x95)](_0x1cb0f5[_0x117347(0x88)]):null,'publicKey':_0x1cb0f5[_0x117347(0x9a)],'wallets':{'usdtPolygonWallet':_0x1cb0f5[_0x117347(0x9d)],'usdtTrcWallet':_0x1cb0f5['usdtTrcWallet'],'usdtErcWallet':_0x1cb0f5[_0x117347(0x90)],'usdcPolygonWallet':_0x1cb0f5['usdcPolygonWallet']},'status':_0x1cb0f5[_0x117347(0x98)],'createdAt':_0x1cb0f5[_0x117347(0x7f)]};}async['updateUser'](_0x844bfc,_0x1c930b){const _0x5dde40=a68_0x262b03,_0x44e28={..._0x1c930b};_0x1c930b[_0x5dde40(0x80)]&&(_0x44e28['password']=await bcryptjs_1[_0x5dde40(0x93)][_0x5dde40(0xb2)](_0x1c930b[_0x5dde40(0x80)],0xc));_0x1c930b[_0x5dde40(0xa8)]&&(_0x44e28['name']=_0x1c930b[_0x5dde40(0xa8)],delete _0x44e28[_0x5dde40(0xa8)]);_0x1c930b[_0x5dde40(0xad)]&&(_0x44e28['telegram']=_0x1c930b[_0x5dde40(0xad)],delete _0x44e28['telegramId']);_0x1c930b[_0x5dde40(0x94)]&&(_0x44e28['shopUrl']=_0x1c930b[_0x5dde40(0x94)],delete _0x44e28['merchantUrl']);_0x1c930b['gateways']&&(_0x44e28['paymentGateways']=JSON['stringify'](_0x1c930b[_0x5dde40(0x89)]),delete _0x44e28[_0x5dde40(0x89)]);_0x1c930b[_0x5dde40(0x88)]&&(_0x44e28[_0x5dde40(0x88)]=JSON[_0x5dde40(0x84)](_0x1c930b[_0x5dde40(0x88)]),delete _0x44e28[_0x5dde40(0x88)]);_0x1c930b['wallets']&&(_0x1c930b[_0x5dde40(0x7e)][_0x5dde40(0x9d)]!==undefined&&(_0x44e28[_0x5dde40(0x9d)]=_0x1c930b['wallets'][_0x5dde40(0x9d)]||null),_0x1c930b[_0x5dde40(0x7e)]['usdtTrcWallet']!==undefined&&(_0x44e28[_0x5dde40(0x9e)]=_0x1c930b['wallets'][_0x5dde40(0x9e)]||null),_0x1c930b[_0x5dde40(0x7e)]['usdtErcWallet']!==undefined&&(_0x44e28[_0x5dde40(0x90)]=_0x1c930b[_0x5dde40(0x7e)][_0x5dde40(0x90)]||null),_0x1c930b[_0x5dde40(0x7e)][_0x5dde40(0x8d)]!==undefined&&(_0x44e28[_0x5dde40(0x8d)]=_0x1c930b[_0x5dde40(0x7e)][_0x5dde40(0x8d)]||null),delete _0x44e28[_0x5dde40(0x7e)]);const _0x3262a3=await database_1[_0x5dde40(0x93)]['shop']['update']({'where':{'id':_0x844bfc},'data':_0x44e28,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x3262a3['id'],'fullName':_0x3262a3[_0x5dde40(0x8a)],'username':_0x3262a3[_0x5dde40(0x87)],'telegramId':_0x3262a3[_0x5dde40(0xab)],'merchantUrl':_0x3262a3[_0x5dde40(0x8b)],'gateways':_0x3262a3[_0x5dde40(0x83)]?JSON['parse'](_0x3262a3[_0x5dde40(0x83)]):null,'gatewaySettings':_0x3262a3['gatewaySettings']?JSON[_0x5dde40(0x95)](_0x3262a3[_0x5dde40(0x88)]):null,'publicKey':_0x3262a3[_0x5dde40(0x9a)],'wallets':{'usdtPolygonWallet':_0x3262a3[_0x5dde40(0x9d)],'usdtTrcWallet':_0x3262a3['usdtTrcWallet'],'usdtErcWallet':_0x3262a3[_0x5dde40(0x90)],'usdcPolygonWallet':_0x3262a3[_0x5dde40(0x8d)]},'status':_0x3262a3[_0x5dde40(0x98)],'createdAt':_0x3262a3[_0x5dde40(0x7f)]};}async[a68_0x262b03(0xa2)](_0x5ced70){const _0x4095d6=a68_0x262b03;await database_1['default'][_0x4095d6(0xa0)]['delete']({'where':{'id':_0x5ced70}});}}exports[a68_0x262b03(0xb3)]=UserService;