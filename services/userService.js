'use strict';const a54_0x1038d8=a54_0x5f1c;(function(_0x180f17,_0x427306){const _0x59d09a=a54_0x5f1c,_0x369638=_0x180f17();while(!![]){try{const _0x3a3f9b=parseInt(_0x59d09a(0xf3))/0x1*(-parseInt(_0x59d09a(0xc4))/0x2)+-parseInt(_0x59d09a(0xc1))/0x3*(parseInt(_0x59d09a(0xdb))/0x4)+parseInt(_0x59d09a(0xfa))/0x5*(-parseInt(_0x59d09a(0xd2))/0x6)+-parseInt(_0x59d09a(0xd1))/0x7*(parseInt(_0x59d09a(0xfb))/0x8)+-parseInt(_0x59d09a(0xf5))/0x9*(parseInt(_0x59d09a(0xd6))/0xa)+parseInt(_0x59d09a(0xe6))/0xb+parseInt(_0x59d09a(0xca))/0xc*(parseInt(_0x59d09a(0xe3))/0xd);if(_0x3a3f9b===_0x427306)break;else _0x369638['push'](_0x369638['shift']());}catch(_0x112709){_0x369638['push'](_0x369638['shift']());}}}(a54_0x4aec,0x380f0));function a54_0x5f1c(_0xed8e56,_0x4fa891){const _0x4aecc8=a54_0x4aec();return a54_0x5f1c=function(_0x5f1cab,_0x5627e7){_0x5f1cab=_0x5f1cab-0xc1;let _0x1f06cf=_0x4aecc8[_0x5f1cab];return _0x1f06cf;},a54_0x5f1c(_0xed8e56,_0x4fa891);}var __importDefault=this&&this[a54_0x1038d8(0xe8)]||function(_0x3f7b95){return _0x3f7b95&&_0x3f7b95['__esModule']?_0x3f7b95:{'default':_0x3f7b95};};Object[a54_0x1038d8(0xcc)](exports,a54_0x1038d8(0xd0),{'value':!![]}),exports[a54_0x1038d8(0xee)]=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),crypto_1=__importDefault(require(a54_0x1038d8(0xd4))),database_1=__importDefault(require('../config/database'));class UserService{[a54_0x1038d8(0xe1)](){const _0x43827b=a54_0x1038d8,_0x3968f4=_0x43827b(0xc2)+crypto_1[_0x43827b(0xdc)][_0x43827b(0xc8)](0x20)['toString'](_0x43827b(0xec)),_0x13f26d='sk_'+crypto_1['default'][_0x43827b(0xc8)](0x20)[_0x43827b(0xf6)](_0x43827b(0xec));return{'publicKey':_0x3968f4,'secretKey':_0x13f26d};}async[a54_0x1038d8(0xf1)](_0x107f64){const _0x23224c=a54_0x1038d8,{fullName:_0xbb255d,username:_0x51b0dc,password:_0x5b4906,telegramId:_0x1f1cf0,merchantUrl:_0x5a15ae,gateways:_0x305f65,gatewaySettings:_0xefaf4,wallets:_0x1975dc}=_0x107f64,_0x8098b5=await database_1[_0x23224c(0xdc)]['shop'][_0x23224c(0xce)]({'where':{'username':_0x51b0dc}});if(_0x8098b5)throw new Error(_0x23224c(0xc5));if(_0x1f1cf0){const _0x59fa9d=await database_1[_0x23224c(0xdc)]['shop']['findUnique']({'where':{'telegram':_0x1f1cf0}});if(_0x59fa9d)throw new Error('Telegram\x20username\x20already\x20exists');}const _0x2d8382=await bcryptjs_1[_0x23224c(0xdc)][_0x23224c(0xda)](_0x5b4906,0xc),{publicKey:_0x4db9dd,secretKey:_0x1aad3f}=this['generateApiKeys'](),_0x4af48a=await database_1['default']['shop'][_0x23224c(0xdf)]({'data':{'name':_0xbb255d,'username':_0x51b0dc,'password':_0x2d8382,'telegram':_0x1f1cf0,'shopUrl':_0x5a15ae,'paymentGateways':_0x305f65?JSON[_0x23224c(0xf0)](_0x305f65):null,'gatewaySettings':_0xefaf4?JSON[_0x23224c(0xf0)](_0xefaf4):null,'usdtPolygonWallet':_0x1975dc?.[_0x23224c(0xc7)]||null,'usdtTrcWallet':_0x1975dc?.[_0x23224c(0xe2)]||null,'usdtErcWallet':_0x1975dc?.['usdtErcWallet']||null,'usdcPolygonWallet':_0x1975dc?.[_0x23224c(0xc9)]||null,'publicKey':_0x4db9dd,'secretKey':_0x1aad3f,'status':_0x23224c(0xe5)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x4af48a['id'],'fullName':_0x4af48a[_0x23224c(0xd5)],'username':_0x4af48a['username'],'telegramId':_0x4af48a[_0x23224c(0xe4)],'merchantUrl':_0x4af48a[_0x23224c(0xd3)],'gateways':_0x4af48a[_0x23224c(0xe9)]?JSON[_0x23224c(0xf7)](_0x4af48a['paymentGateways']):null,'gatewaySettings':_0x4af48a[_0x23224c(0xc3)]?JSON[_0x23224c(0xf7)](_0x4af48a[_0x23224c(0xc3)]):null,'publicKey':_0x4af48a['publicKey'],'wallets':{'usdtPolygonWallet':_0x4af48a[_0x23224c(0xc7)],'usdtTrcWallet':_0x4af48a['usdtTrcWallet'],'usdtErcWallet':_0x4af48a[_0x23224c(0xf9)],'usdcPolygonWallet':_0x4af48a[_0x23224c(0xc9)]},'status':_0x4af48a[_0x23224c(0xea)],'createdAt':_0x4af48a[_0x23224c(0xc6)]};}async[a54_0x1038d8(0xd8)](){const _0x154108=a54_0x1038d8,_0x351f7c=await database_1['default'][_0x154108(0xeb)][_0x154108(0xcb)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':'desc'}});return _0x351f7c[_0x154108(0xe0)](_0xff8d8e=>({'id':_0xff8d8e['id'],'fullName':_0xff8d8e['name'],'username':_0xff8d8e[_0x154108(0xe7)],'telegramId':_0xff8d8e[_0x154108(0xe4)],'merchantUrl':_0xff8d8e['shopUrl'],'gateways':_0xff8d8e[_0x154108(0xe9)]?JSON[_0x154108(0xf7)](_0xff8d8e['paymentGateways']):null,'gatewaySettings':_0xff8d8e['gatewaySettings']?JSON[_0x154108(0xf7)](_0xff8d8e[_0x154108(0xc3)]):null,'publicKey':_0xff8d8e[_0x154108(0xd7)],'wallets':{'usdtPolygonWallet':_0xff8d8e[_0x154108(0xc7)],'usdtTrcWallet':_0xff8d8e[_0x154108(0xe2)],'usdtErcWallet':_0xff8d8e[_0x154108(0xf9)],'usdcPolygonWallet':_0xff8d8e[_0x154108(0xc9)]},'status':_0xff8d8e['status'],'createdAt':_0xff8d8e[_0x154108(0xc6)]}));}async[a54_0x1038d8(0xcf)](_0x35c397){const _0x196fd9=a54_0x1038d8,_0x4be923=await database_1[_0x196fd9(0xdc)]['shop'][_0x196fd9(0xce)]({'where':{'id':_0x35c397},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x4be923)return null;return{'id':_0x4be923['id'],'fullName':_0x4be923[_0x196fd9(0xd5)],'username':_0x4be923[_0x196fd9(0xe7)],'telegramId':_0x4be923[_0x196fd9(0xe4)],'merchantUrl':_0x4be923[_0x196fd9(0xd3)],'gateways':_0x4be923['paymentGateways']?JSON[_0x196fd9(0xf7)](_0x4be923[_0x196fd9(0xe9)]):null,'gatewaySettings':_0x4be923[_0x196fd9(0xc3)]?JSON[_0x196fd9(0xf7)](_0x4be923[_0x196fd9(0xc3)]):null,'publicKey':_0x4be923[_0x196fd9(0xd7)],'wallets':{'usdtPolygonWallet':_0x4be923[_0x196fd9(0xc7)],'usdtTrcWallet':_0x4be923[_0x196fd9(0xe2)],'usdtErcWallet':_0x4be923[_0x196fd9(0xf9)],'usdcPolygonWallet':_0x4be923[_0x196fd9(0xc9)]},'status':_0x4be923[_0x196fd9(0xea)],'createdAt':_0x4be923[_0x196fd9(0xc6)]};}async[a54_0x1038d8(0xf4)](_0x33a68e,_0x351f00){const _0x1bcb88=a54_0x1038d8,_0x28aa53={..._0x351f00};_0x351f00[_0x1bcb88(0xd9)]&&(_0x28aa53['password']=await bcryptjs_1[_0x1bcb88(0xdc)][_0x1bcb88(0xda)](_0x351f00[_0x1bcb88(0xd9)],0xc));_0x351f00['fullName']&&(_0x28aa53['name']=_0x351f00['fullName'],delete _0x28aa53[_0x1bcb88(0xef)]);_0x351f00['telegramId']&&(_0x28aa53[_0x1bcb88(0xe4)]=_0x351f00[_0x1bcb88(0xf8)],delete _0x28aa53['telegramId']);_0x351f00[_0x1bcb88(0xcd)]&&(_0x28aa53[_0x1bcb88(0xd3)]=_0x351f00[_0x1bcb88(0xcd)],delete _0x28aa53[_0x1bcb88(0xcd)]);_0x351f00[_0x1bcb88(0xf2)]&&(_0x28aa53['paymentGateways']=JSON[_0x1bcb88(0xf0)](_0x351f00[_0x1bcb88(0xf2)]),delete _0x28aa53[_0x1bcb88(0xf2)]);_0x351f00[_0x1bcb88(0xc3)]&&(_0x28aa53[_0x1bcb88(0xc3)]=JSON[_0x1bcb88(0xf0)](_0x351f00[_0x1bcb88(0xc3)]),delete _0x28aa53['gatewaySettings']);_0x351f00[_0x1bcb88(0xdd)]&&(_0x351f00['wallets'][_0x1bcb88(0xc7)]!==undefined&&(_0x28aa53['usdtPolygonWallet']=_0x351f00[_0x1bcb88(0xdd)]['usdtPolygonWallet']||null),_0x351f00[_0x1bcb88(0xdd)][_0x1bcb88(0xe2)]!==undefined&&(_0x28aa53[_0x1bcb88(0xe2)]=_0x351f00[_0x1bcb88(0xdd)]['usdtTrcWallet']||null),_0x351f00[_0x1bcb88(0xdd)][_0x1bcb88(0xf9)]!==undefined&&(_0x28aa53[_0x1bcb88(0xf9)]=_0x351f00['wallets'][_0x1bcb88(0xf9)]||null),_0x351f00['wallets']['usdcPolygonWallet']!==undefined&&(_0x28aa53[_0x1bcb88(0xc9)]=_0x351f00['wallets'][_0x1bcb88(0xc9)]||null),delete _0x28aa53[_0x1bcb88(0xdd)]);const _0x37efbb=await database_1[_0x1bcb88(0xdc)][_0x1bcb88(0xeb)][_0x1bcb88(0xed)]({'where':{'id':_0x33a68e},'data':_0x28aa53,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x37efbb['id'],'fullName':_0x37efbb[_0x1bcb88(0xd5)],'username':_0x37efbb[_0x1bcb88(0xe7)],'telegramId':_0x37efbb[_0x1bcb88(0xe4)],'merchantUrl':_0x37efbb['shopUrl'],'gateways':_0x37efbb[_0x1bcb88(0xe9)]?JSON[_0x1bcb88(0xf7)](_0x37efbb[_0x1bcb88(0xe9)]):null,'gatewaySettings':_0x37efbb['gatewaySettings']?JSON['parse'](_0x37efbb[_0x1bcb88(0xc3)]):null,'publicKey':_0x37efbb[_0x1bcb88(0xd7)],'wallets':{'usdtPolygonWallet':_0x37efbb['usdtPolygonWallet'],'usdtTrcWallet':_0x37efbb[_0x1bcb88(0xe2)],'usdtErcWallet':_0x37efbb[_0x1bcb88(0xf9)],'usdcPolygonWallet':_0x37efbb[_0x1bcb88(0xc9)]},'status':_0x37efbb[_0x1bcb88(0xea)],'createdAt':_0x37efbb[_0x1bcb88(0xc6)]};}async['deleteUser'](_0x551707){const _0x364600=a54_0x1038d8;await database_1['default'][_0x364600(0xeb)][_0x364600(0xde)]({'where':{'id':_0x551707}});}}exports[a54_0x1038d8(0xee)]=UserService;function a54_0x4aec(){const _0x1adf67=['70BFwrMN','8VWZzuI','99174uQqBkJ','pk_','gatewaySettings','150DKcKyi','Username\x20already\x20exists','createdAt','usdtPolygonWallet','randomBytes','usdcPolygonWallet','36qXLcun','findMany','defineProperty','merchantUrl','findUnique','getUserById','__esModule','298641EKSiam','169644wEuGNb','shopUrl','crypto','name','2015950bZmxjg','publicKey','getAllUsers','password','hash','28JxnEPm','default','wallets','delete','create','map','generateApiKeys','usdtTrcWallet','5163834sIbueC','telegram','ACTIVE','3634807nfDEWW','username','__importDefault','paymentGateways','status','shop','hex','update','UserService','fullName','stringify','createUser','gateways','5613jKMbol','updateUser','9clHAcn','toString','parse','telegramId','usdtErcWallet'];a54_0x4aec=function(){return _0x1adf67;};return a54_0x4aec();}