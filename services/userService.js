'use strict';function a68_0x1516(_0x1dd4a2,_0x11b510){const _0x39fc4e=a68_0x39fc();return a68_0x1516=function(_0x15162f,_0x563c80){_0x15162f=_0x15162f-0xa0;let _0x25d1a2=_0x39fc4e[_0x15162f];return _0x25d1a2;},a68_0x1516(_0x1dd4a2,_0x11b510);}function a68_0x39fc(){const _0x179cf1=['UserService','toString','parse','publicKey','generateApiKeys','usdcPolygonWallet','create','gatewaySettings','553510ILxwMV','deleteUser','updateUser','1536064ycagIN','createUser','createdAt','ACTIVE','findUnique','54zUuzXs','sk_','getUserById','merchantUrl','usdtPolygonWallet','shopUrl','shop','608640pxKAXx','username','update','telegramId','usdtTrcWallet','gateways','1132005dJbpGB','default','hash','hex','16xkTZlC','telegram','wallets','randomBytes','findMany','fullName','418130XZiTNT','password','54312dxmUHu','status','name','67365NVSvrC','2oaFvJS','__importDefault','paymentGateways','../config/database','usdtErcWallet'];a68_0x39fc=function(){return _0x179cf1;};return a68_0x39fc();}const a68_0x14c460=a68_0x1516;(function(_0x121f2f,_0x4efd6e){const _0x8ad069=a68_0x1516,_0x1c9a50=_0x121f2f();while(!![]){try{const _0xf3c567=-parseInt(_0x8ad069(0xc2))/0x1+-parseInt(_0x8ad069(0xc6))/0x2*(parseInt(_0x8ad069(0xc5))/0x3)+parseInt(_0x8ad069(0xba))/0x4*(-parseInt(_0x8ad069(0xc0))/0x5)+-parseInt(_0x8ad069(0xb0))/0x6+parseInt(_0x8ad069(0xb6))/0x7+parseInt(_0x8ad069(0xa4))/0x8+-parseInt(_0x8ad069(0xa9))/0x9*(-parseInt(_0x8ad069(0xa1))/0xa);if(_0xf3c567===_0x4efd6e)break;else _0x1c9a50['push'](_0x1c9a50['shift']());}catch(_0x54e7bf){_0x1c9a50['push'](_0x1c9a50['shift']());}}}(a68_0x39fc,0x2a43e));var __importDefault=this&&this[a68_0x14c460(0xc7)]||function(_0x51d483){return _0x51d483&&_0x51d483['__esModule']?_0x51d483:{'default':_0x51d483};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a68_0x14c460(0xcb)]=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),crypto_1=__importDefault(require('crypto')),database_1=__importDefault(require(a68_0x14c460(0xc9)));class UserService{[a68_0x14c460(0xcf)](){const _0x3b41e7=a68_0x14c460,_0x48c5e0='pk_'+crypto_1[_0x3b41e7(0xb7)][_0x3b41e7(0xbd)](0x20)[_0x3b41e7(0xcc)]('hex'),_0x55fe30=_0x3b41e7(0xaa)+crypto_1['default'][_0x3b41e7(0xbd)](0x20)['toString'](_0x3b41e7(0xb9));return{'publicKey':_0x48c5e0,'secretKey':_0x55fe30};}async[a68_0x14c460(0xa5)](_0x2a2cb8){const _0x4aacf4=a68_0x14c460,{fullName:_0x1da9a5,username:_0x388f40,password:_0x5c4438,telegramId:_0x391c57,merchantUrl:_0x1ec488,gateways:_0x290cd8,gatewaySettings:_0x3f4fc9,wallets:_0x35fff0}=_0x2a2cb8,_0x44ee1b=await database_1[_0x4aacf4(0xb7)][_0x4aacf4(0xaf)][_0x4aacf4(0xa8)]({'where':{'username':_0x388f40}});if(_0x44ee1b)throw new Error('Username\x20already\x20exists');if(_0x391c57){const _0xc84751=await database_1[_0x4aacf4(0xb7)][_0x4aacf4(0xaf)][_0x4aacf4(0xa8)]({'where':{'telegram':_0x391c57}});if(_0xc84751)throw new Error('Telegram\x20username\x20already\x20exists');}const _0x14f2b1=await bcryptjs_1[_0x4aacf4(0xb7)][_0x4aacf4(0xb8)](_0x5c4438,0xc),{publicKey:_0xdf5626,secretKey:_0x57a260}=this[_0x4aacf4(0xcf)](),_0x805b90=await database_1[_0x4aacf4(0xb7)]['shop'][_0x4aacf4(0xd1)]({'data':{'name':_0x1da9a5,'username':_0x388f40,'password':_0x14f2b1,'telegram':_0x391c57,'shopUrl':_0x1ec488,'paymentGateways':_0x290cd8?JSON['stringify'](_0x290cd8):null,'gatewaySettings':_0x3f4fc9?JSON['stringify'](_0x3f4fc9):null,'usdtPolygonWallet':_0x35fff0?.[_0x4aacf4(0xad)]||null,'usdtTrcWallet':_0x35fff0?.['usdtTrcWallet']||null,'usdtErcWallet':_0x35fff0?.[_0x4aacf4(0xca)]||null,'usdcPolygonWallet':_0x35fff0?.[_0x4aacf4(0xd0)]||null,'publicKey':_0xdf5626,'secretKey':_0x57a260,'status':_0x4aacf4(0xa7)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x805b90['id'],'fullName':_0x805b90[_0x4aacf4(0xc4)],'username':_0x805b90[_0x4aacf4(0xb1)],'telegramId':_0x805b90['telegram'],'merchantUrl':_0x805b90[_0x4aacf4(0xae)],'gateways':_0x805b90[_0x4aacf4(0xc8)]?JSON[_0x4aacf4(0xcd)](_0x805b90[_0x4aacf4(0xc8)]):null,'gatewaySettings':_0x805b90[_0x4aacf4(0xa0)]?JSON[_0x4aacf4(0xcd)](_0x805b90[_0x4aacf4(0xa0)]):null,'publicKey':_0x805b90[_0x4aacf4(0xce)],'wallets':{'usdtPolygonWallet':_0x805b90['usdtPolygonWallet'],'usdtTrcWallet':_0x805b90[_0x4aacf4(0xb4)],'usdtErcWallet':_0x805b90[_0x4aacf4(0xca)],'usdcPolygonWallet':_0x805b90['usdcPolygonWallet']},'status':_0x805b90[_0x4aacf4(0xc3)],'createdAt':_0x805b90['createdAt']};}async['getAllUsers'](){const _0xa7cf5d=a68_0x14c460,_0x1c4f33=await database_1[_0xa7cf5d(0xb7)][_0xa7cf5d(0xaf)][_0xa7cf5d(0xbe)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':'desc'}});return _0x1c4f33['map'](_0x4ea789=>({'id':_0x4ea789['id'],'fullName':_0x4ea789[_0xa7cf5d(0xc4)],'username':_0x4ea789[_0xa7cf5d(0xb1)],'telegramId':_0x4ea789[_0xa7cf5d(0xbb)],'merchantUrl':_0x4ea789[_0xa7cf5d(0xae)],'gateways':_0x4ea789[_0xa7cf5d(0xc8)]?JSON[_0xa7cf5d(0xcd)](_0x4ea789[_0xa7cf5d(0xc8)]):null,'gatewaySettings':_0x4ea789['gatewaySettings']?JSON[_0xa7cf5d(0xcd)](_0x4ea789[_0xa7cf5d(0xa0)]):null,'publicKey':_0x4ea789['publicKey'],'wallets':{'usdtPolygonWallet':_0x4ea789['usdtPolygonWallet'],'usdtTrcWallet':_0x4ea789['usdtTrcWallet'],'usdtErcWallet':_0x4ea789[_0xa7cf5d(0xca)],'usdcPolygonWallet':_0x4ea789[_0xa7cf5d(0xd0)]},'status':_0x4ea789[_0xa7cf5d(0xc3)],'createdAt':_0x4ea789[_0xa7cf5d(0xa6)]}));}async[a68_0x14c460(0xab)](_0x4dbb88){const _0x333ec9=a68_0x14c460,_0x2d61ff=await database_1[_0x333ec9(0xb7)]['shop'][_0x333ec9(0xa8)]({'where':{'id':_0x4dbb88},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x2d61ff)return null;return{'id':_0x2d61ff['id'],'fullName':_0x2d61ff[_0x333ec9(0xc4)],'username':_0x2d61ff['username'],'telegramId':_0x2d61ff[_0x333ec9(0xbb)],'merchantUrl':_0x2d61ff[_0x333ec9(0xae)],'gateways':_0x2d61ff[_0x333ec9(0xc8)]?JSON[_0x333ec9(0xcd)](_0x2d61ff[_0x333ec9(0xc8)]):null,'gatewaySettings':_0x2d61ff[_0x333ec9(0xa0)]?JSON[_0x333ec9(0xcd)](_0x2d61ff[_0x333ec9(0xa0)]):null,'publicKey':_0x2d61ff[_0x333ec9(0xce)],'wallets':{'usdtPolygonWallet':_0x2d61ff[_0x333ec9(0xad)],'usdtTrcWallet':_0x2d61ff['usdtTrcWallet'],'usdtErcWallet':_0x2d61ff[_0x333ec9(0xca)],'usdcPolygonWallet':_0x2d61ff[_0x333ec9(0xd0)]},'status':_0x2d61ff['status'],'createdAt':_0x2d61ff[_0x333ec9(0xa6)]};}async[a68_0x14c460(0xa3)](_0x4b6618,_0x226ef7){const _0x38b66c=a68_0x14c460,_0x5a4180={..._0x226ef7};_0x226ef7[_0x38b66c(0xc1)]&&(_0x5a4180[_0x38b66c(0xc1)]=await bcryptjs_1[_0x38b66c(0xb7)][_0x38b66c(0xb8)](_0x226ef7[_0x38b66c(0xc1)],0xc));_0x226ef7['fullName']&&(_0x5a4180['name']=_0x226ef7[_0x38b66c(0xbf)],delete _0x5a4180[_0x38b66c(0xbf)]);_0x226ef7[_0x38b66c(0xb3)]&&(_0x5a4180[_0x38b66c(0xbb)]=_0x226ef7[_0x38b66c(0xb3)],delete _0x5a4180[_0x38b66c(0xb3)]);_0x226ef7[_0x38b66c(0xac)]&&(_0x5a4180[_0x38b66c(0xae)]=_0x226ef7[_0x38b66c(0xac)],delete _0x5a4180[_0x38b66c(0xac)]);_0x226ef7[_0x38b66c(0xb5)]&&(_0x5a4180[_0x38b66c(0xc8)]=JSON['stringify'](_0x226ef7[_0x38b66c(0xb5)]),delete _0x5a4180[_0x38b66c(0xb5)]);_0x226ef7['gatewaySettings']&&(_0x5a4180[_0x38b66c(0xa0)]=JSON['stringify'](_0x226ef7[_0x38b66c(0xa0)]),delete _0x5a4180[_0x38b66c(0xa0)]);_0x226ef7[_0x38b66c(0xbc)]&&(_0x226ef7[_0x38b66c(0xbc)][_0x38b66c(0xad)]!==undefined&&(_0x5a4180[_0x38b66c(0xad)]=_0x226ef7[_0x38b66c(0xbc)][_0x38b66c(0xad)]||null),_0x226ef7[_0x38b66c(0xbc)]['usdtTrcWallet']!==undefined&&(_0x5a4180[_0x38b66c(0xb4)]=_0x226ef7[_0x38b66c(0xbc)][_0x38b66c(0xb4)]||null),_0x226ef7[_0x38b66c(0xbc)][_0x38b66c(0xca)]!==undefined&&(_0x5a4180[_0x38b66c(0xca)]=_0x226ef7['wallets'][_0x38b66c(0xca)]||null),_0x226ef7['wallets'][_0x38b66c(0xd0)]!==undefined&&(_0x5a4180[_0x38b66c(0xd0)]=_0x226ef7[_0x38b66c(0xbc)]['usdcPolygonWallet']||null),delete _0x5a4180[_0x38b66c(0xbc)]);const _0xf3eb5a=await database_1[_0x38b66c(0xb7)]['shop'][_0x38b66c(0xb2)]({'where':{'id':_0x4b6618},'data':_0x5a4180,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0xf3eb5a['id'],'fullName':_0xf3eb5a['name'],'username':_0xf3eb5a[_0x38b66c(0xb1)],'telegramId':_0xf3eb5a[_0x38b66c(0xbb)],'merchantUrl':_0xf3eb5a[_0x38b66c(0xae)],'gateways':_0xf3eb5a[_0x38b66c(0xc8)]?JSON[_0x38b66c(0xcd)](_0xf3eb5a['paymentGateways']):null,'gatewaySettings':_0xf3eb5a['gatewaySettings']?JSON[_0x38b66c(0xcd)](_0xf3eb5a[_0x38b66c(0xa0)]):null,'publicKey':_0xf3eb5a[_0x38b66c(0xce)],'wallets':{'usdtPolygonWallet':_0xf3eb5a['usdtPolygonWallet'],'usdtTrcWallet':_0xf3eb5a[_0x38b66c(0xb4)],'usdtErcWallet':_0xf3eb5a['usdtErcWallet'],'usdcPolygonWallet':_0xf3eb5a[_0x38b66c(0xd0)]},'status':_0xf3eb5a[_0x38b66c(0xc3)],'createdAt':_0xf3eb5a[_0x38b66c(0xa6)]};}async[a68_0x14c460(0xa2)](_0x1471de){const _0x3d1d14=a68_0x14c460;await database_1[_0x3d1d14(0xb7)][_0x3d1d14(0xaf)]['delete']({'where':{'id':_0x1471de}});}}exports[a68_0x14c460(0xcb)]=UserService;