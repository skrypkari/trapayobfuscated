'use strict';const a51_0x4c5b94=a51_0x467f;(function(_0x1d4bac,_0x3245a0){const _0x50a2be=a51_0x467f,_0x4e9f0b=_0x1d4bac();while(!![]){try{const _0x3726ab=parseInt(_0x50a2be(0x1b8))/0x1+-parseInt(_0x50a2be(0x19f))/0x2+-parseInt(_0x50a2be(0x18e))/0x3*(-parseInt(_0x50a2be(0x197))/0x4)+-parseInt(_0x50a2be(0x1a3))/0x5*(parseInt(_0x50a2be(0x1c5))/0x6)+parseInt(_0x50a2be(0x1a8))/0x7*(parseInt(_0x50a2be(0x1a0))/0x8)+parseInt(_0x50a2be(0x1bf))/0x9+-parseInt(_0x50a2be(0x1a7))/0xa*(parseInt(_0x50a2be(0x1b3))/0xb);if(_0x3726ab===_0x3245a0)break;else _0x4e9f0b['push'](_0x4e9f0b['shift']());}catch(_0x2e21e8){_0x4e9f0b['push'](_0x4e9f0b['shift']());}}}(a51_0x3931,0xd83cb));function a51_0x3931(){const _0x367b11=['name','../config/database','createUser','desc','status','65944CoqjNv','usdtPolygonWallet','wallets','gateways','updateUser','shopUrl','usdtTrcWallet','crypto','2451936hUOezB','744NmtAXo','defineProperty','findUnique','1175cyVyHP','paymentGateways','bcryptjs','Username\x20already\x20exists','10IPISOL','23247qjxuQU','usdtErcWallet','stringify','__importDefault','telegramId','UserService','publicKey','hash','toString','merchantUrl','telegram','1177748LSpqoJ','parse','username','ACTIVE','password','152999FXEEti','createdAt','update','map','usdcPolygonWallet','shop','deleteUser','12386592POoyHS','default','hex','randomBytes','findMany','__esModule','8382dhhOAp','getUserById','129ysrpnd','gatewaySettings','delete','fullName'];a51_0x3931=function(){return _0x367b11;};return a51_0x3931();}var __importDefault=this&&this[a51_0x4c5b94(0x1ab)]||function(_0x10ba50){return _0x10ba50&&_0x10ba50['__esModule']?_0x10ba50:{'default':_0x10ba50};};function a51_0x467f(_0x44b3ad,_0x29621f){const _0x3931fb=a51_0x3931();return a51_0x467f=function(_0x467f63,_0x1486c9){_0x467f63=_0x467f63-0x18e;let _0x1a4157=_0x3931fb[_0x467f63];return _0x1a4157;},a51_0x467f(_0x44b3ad,_0x29621f);}Object[a51_0x4c5b94(0x1a1)](exports,a51_0x4c5b94(0x1c4),{'value':!![]}),exports['UserService']=void 0x0;const bcryptjs_1=__importDefault(require(a51_0x4c5b94(0x1a5))),crypto_1=__importDefault(require(a51_0x4c5b94(0x19e))),database_1=__importDefault(require(a51_0x4c5b94(0x193)));class UserService{['generateApiKeys'](){const _0x3ed006=a51_0x4c5b94,_0x537ae7='pk_'+crypto_1[_0x3ed006(0x1c0)][_0x3ed006(0x1c2)](0x20)[_0x3ed006(0x1b0)](_0x3ed006(0x1c1)),_0x104a44='sk_'+crypto_1[_0x3ed006(0x1c0)][_0x3ed006(0x1c2)](0x20)['toString'](_0x3ed006(0x1c1));return{'publicKey':_0x537ae7,'secretKey':_0x104a44};}async[a51_0x4c5b94(0x194)](_0x193ddc){const _0x242689=a51_0x4c5b94,{fullName:_0x410f1c,username:_0x57b686,password:_0xc15b6c,telegramId:_0x525750,merchantUrl:_0x2de06c,gateways:_0x35ac2d,gatewaySettings:_0x926e80,wallets:_0x3a5b7f}=_0x193ddc,_0x201732=await database_1['default'][_0x242689(0x1bd)][_0x242689(0x1a2)]({'where':{'username':_0x57b686}});if(_0x201732)throw new Error(_0x242689(0x1a6));if(_0x525750){const _0x3ed147=await database_1[_0x242689(0x1c0)]['shop']['findUnique']({'where':{'telegram':_0x525750}});if(_0x3ed147)throw new Error('Telegram\x20username\x20already\x20exists');}const _0x5542ae=await bcryptjs_1[_0x242689(0x1c0)][_0x242689(0x1af)](_0xc15b6c,0xc),{publicKey:_0x3f0537,secretKey:_0xde7ea}=this['generateApiKeys'](),_0x58ac05=await database_1[_0x242689(0x1c0)][_0x242689(0x1bd)]['create']({'data':{'name':_0x410f1c,'username':_0x57b686,'password':_0x5542ae,'telegram':_0x525750,'shopUrl':_0x2de06c,'paymentGateways':_0x35ac2d?JSON['stringify'](_0x35ac2d):null,'gatewaySettings':_0x926e80?JSON[_0x242689(0x1aa)](_0x926e80):null,'usdtPolygonWallet':_0x3a5b7f?.['usdtPolygonWallet']||null,'usdtTrcWallet':_0x3a5b7f?.[_0x242689(0x19d)]||null,'usdtErcWallet':_0x3a5b7f?.[_0x242689(0x1a9)]||null,'usdcPolygonWallet':_0x3a5b7f?.[_0x242689(0x1bc)]||null,'publicKey':_0x3f0537,'secretKey':_0xde7ea,'status':_0x242689(0x1b6)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x58ac05['id'],'fullName':_0x58ac05[_0x242689(0x192)],'username':_0x58ac05['username'],'telegramId':_0x58ac05[_0x242689(0x1b2)],'merchantUrl':_0x58ac05['shopUrl'],'gateways':_0x58ac05[_0x242689(0x1a4)]?JSON[_0x242689(0x1b4)](_0x58ac05['paymentGateways']):null,'gatewaySettings':_0x58ac05['gatewaySettings']?JSON['parse'](_0x58ac05['gatewaySettings']):null,'publicKey':_0x58ac05['publicKey'],'wallets':{'usdtPolygonWallet':_0x58ac05[_0x242689(0x198)],'usdtTrcWallet':_0x58ac05[_0x242689(0x19d)],'usdtErcWallet':_0x58ac05[_0x242689(0x1a9)],'usdcPolygonWallet':_0x58ac05[_0x242689(0x1bc)]},'status':_0x58ac05[_0x242689(0x196)],'createdAt':_0x58ac05[_0x242689(0x1b9)]};}async['getAllUsers'](){const _0x5728a8=a51_0x4c5b94,_0x5ac834=await database_1[_0x5728a8(0x1c0)][_0x5728a8(0x1bd)][_0x5728a8(0x1c3)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x5728a8(0x195)}});return _0x5ac834[_0x5728a8(0x1bb)](_0x3f614d=>({'id':_0x3f614d['id'],'fullName':_0x3f614d[_0x5728a8(0x192)],'username':_0x3f614d[_0x5728a8(0x1b5)],'telegramId':_0x3f614d['telegram'],'merchantUrl':_0x3f614d[_0x5728a8(0x19c)],'gateways':_0x3f614d['paymentGateways']?JSON[_0x5728a8(0x1b4)](_0x3f614d[_0x5728a8(0x1a4)]):null,'gatewaySettings':_0x3f614d[_0x5728a8(0x18f)]?JSON['parse'](_0x3f614d[_0x5728a8(0x18f)]):null,'publicKey':_0x3f614d['publicKey'],'wallets':{'usdtPolygonWallet':_0x3f614d[_0x5728a8(0x198)],'usdtTrcWallet':_0x3f614d[_0x5728a8(0x19d)],'usdtErcWallet':_0x3f614d[_0x5728a8(0x1a9)],'usdcPolygonWallet':_0x3f614d[_0x5728a8(0x1bc)]},'status':_0x3f614d['status'],'createdAt':_0x3f614d[_0x5728a8(0x1b9)]}));}async[a51_0x4c5b94(0x1c6)](_0x3d2d35){const _0xa36c22=a51_0x4c5b94,_0x31d51a=await database_1[_0xa36c22(0x1c0)][_0xa36c22(0x1bd)]['findUnique']({'where':{'id':_0x3d2d35},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x31d51a)return null;return{'id':_0x31d51a['id'],'fullName':_0x31d51a[_0xa36c22(0x192)],'username':_0x31d51a[_0xa36c22(0x1b5)],'telegramId':_0x31d51a[_0xa36c22(0x1b2)],'merchantUrl':_0x31d51a[_0xa36c22(0x19c)],'gateways':_0x31d51a[_0xa36c22(0x1a4)]?JSON[_0xa36c22(0x1b4)](_0x31d51a[_0xa36c22(0x1a4)]):null,'gatewaySettings':_0x31d51a[_0xa36c22(0x18f)]?JSON[_0xa36c22(0x1b4)](_0x31d51a[_0xa36c22(0x18f)]):null,'publicKey':_0x31d51a[_0xa36c22(0x1ae)],'wallets':{'usdtPolygonWallet':_0x31d51a['usdtPolygonWallet'],'usdtTrcWallet':_0x31d51a[_0xa36c22(0x19d)],'usdtErcWallet':_0x31d51a[_0xa36c22(0x1a9)],'usdcPolygonWallet':_0x31d51a[_0xa36c22(0x1bc)]},'status':_0x31d51a[_0xa36c22(0x196)],'createdAt':_0x31d51a['createdAt']};}async[a51_0x4c5b94(0x19b)](_0x2a46ec,_0x17a6d6){const _0x169140=a51_0x4c5b94,_0x6a11f2={..._0x17a6d6};_0x17a6d6['password']&&(_0x6a11f2[_0x169140(0x1b7)]=await bcryptjs_1['default'][_0x169140(0x1af)](_0x17a6d6[_0x169140(0x1b7)],0xc));_0x17a6d6[_0x169140(0x191)]&&(_0x6a11f2[_0x169140(0x192)]=_0x17a6d6[_0x169140(0x191)],delete _0x6a11f2[_0x169140(0x191)]);_0x17a6d6['telegramId']&&(_0x6a11f2[_0x169140(0x1b2)]=_0x17a6d6[_0x169140(0x1ac)],delete _0x6a11f2['telegramId']);_0x17a6d6[_0x169140(0x1b1)]&&(_0x6a11f2[_0x169140(0x19c)]=_0x17a6d6['merchantUrl'],delete _0x6a11f2[_0x169140(0x1b1)]);_0x17a6d6[_0x169140(0x19a)]&&(_0x6a11f2['paymentGateways']=JSON[_0x169140(0x1aa)](_0x17a6d6[_0x169140(0x19a)]),delete _0x6a11f2[_0x169140(0x19a)]);_0x17a6d6['gatewaySettings']&&(_0x6a11f2[_0x169140(0x18f)]=JSON[_0x169140(0x1aa)](_0x17a6d6[_0x169140(0x18f)]),delete _0x6a11f2[_0x169140(0x18f)]);_0x17a6d6[_0x169140(0x199)]&&(_0x17a6d6[_0x169140(0x199)]['usdtPolygonWallet']!==undefined&&(_0x6a11f2[_0x169140(0x198)]=_0x17a6d6['wallets'][_0x169140(0x198)]||null),_0x17a6d6['wallets']['usdtTrcWallet']!==undefined&&(_0x6a11f2[_0x169140(0x19d)]=_0x17a6d6[_0x169140(0x199)][_0x169140(0x19d)]||null),_0x17a6d6[_0x169140(0x199)][_0x169140(0x1a9)]!==undefined&&(_0x6a11f2[_0x169140(0x1a9)]=_0x17a6d6['wallets'][_0x169140(0x1a9)]||null),_0x17a6d6[_0x169140(0x199)][_0x169140(0x1bc)]!==undefined&&(_0x6a11f2[_0x169140(0x1bc)]=_0x17a6d6[_0x169140(0x199)]['usdcPolygonWallet']||null),delete _0x6a11f2[_0x169140(0x199)]);const _0x21556f=await database_1[_0x169140(0x1c0)][_0x169140(0x1bd)][_0x169140(0x1ba)]({'where':{'id':_0x2a46ec},'data':_0x6a11f2,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x21556f['id'],'fullName':_0x21556f[_0x169140(0x192)],'username':_0x21556f[_0x169140(0x1b5)],'telegramId':_0x21556f[_0x169140(0x1b2)],'merchantUrl':_0x21556f['shopUrl'],'gateways':_0x21556f[_0x169140(0x1a4)]?JSON['parse'](_0x21556f[_0x169140(0x1a4)]):null,'gatewaySettings':_0x21556f[_0x169140(0x18f)]?JSON['parse'](_0x21556f[_0x169140(0x18f)]):null,'publicKey':_0x21556f[_0x169140(0x1ae)],'wallets':{'usdtPolygonWallet':_0x21556f[_0x169140(0x198)],'usdtTrcWallet':_0x21556f[_0x169140(0x19d)],'usdtErcWallet':_0x21556f['usdtErcWallet'],'usdcPolygonWallet':_0x21556f[_0x169140(0x1bc)]},'status':_0x21556f[_0x169140(0x196)],'createdAt':_0x21556f[_0x169140(0x1b9)]};}async[a51_0x4c5b94(0x1be)](_0x20f18a){const _0x5ca0e8=a51_0x4c5b94;await database_1[_0x5ca0e8(0x1c0)]['shop'][_0x5ca0e8(0x190)]({'where':{'id':_0x20f18a}});}}exports[a51_0x4c5b94(0x1ad)]=UserService;