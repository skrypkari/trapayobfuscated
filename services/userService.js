'use strict';const a89_0x392586=a89_0x56c9;(function(_0x13d673,_0x53ed58){const _0x4f5ba9=a89_0x56c9,_0x234eb2=_0x13d673();while(!![]){try{const _0xbcf413=-parseInt(_0x4f5ba9(0xb0))/0x1+parseInt(_0x4f5ba9(0xa7))/0x2+-parseInt(_0x4f5ba9(0xac))/0x3+-parseInt(_0x4f5ba9(0xae))/0x4+parseInt(_0x4f5ba9(0xbe))/0x5+parseInt(_0x4f5ba9(0xa2))/0x6*(parseInt(_0x4f5ba9(0x93))/0x7)+parseInt(_0x4f5ba9(0xa9))/0x8*(parseInt(_0x4f5ba9(0x8d))/0x9);if(_0xbcf413===_0x53ed58)break;else _0x234eb2['push'](_0x234eb2['shift']());}catch(_0x4792b0){_0x234eb2['push'](_0x234eb2['shift']());}}}(a89_0x2e55,0x2279d));function a89_0x56c9(_0x108889,_0x1dc6a9){_0x108889=_0x108889-0x8d;const _0x2e55d0=a89_0x2e55();let _0x56c936=_0x2e55d0[_0x108889];return _0x56c936;}var __importDefault=this&&this[a89_0x392586(0xba)]||function(_0x5d3fb4){const _0x33bdf9=a89_0x392586;return _0x5d3fb4&&_0x5d3fb4[_0x33bdf9(0xa6)]?_0x5d3fb4:{'default':_0x5d3fb4};};Object[a89_0x392586(0xc1)](exports,a89_0x392586(0xa6),{'value':!![]}),exports[a89_0x392586(0x8e)]=void 0x0;const bcryptjs_1=__importDefault(require(a89_0x392586(0xc0))),crypto_1=__importDefault(require(a89_0x392586(0xb8))),database_1=__importDefault(require(a89_0x392586(0xc6)));class UserService{['generateApiKeys'](){const _0x555799=a89_0x392586,_0x37fd3f=_0x555799(0xa1)+crypto_1['default'][_0x555799(0xa5)](0x20)[_0x555799(0x9b)]('hex'),_0xcac1=_0x555799(0xa3)+crypto_1[_0x555799(0xa8)][_0x555799(0xa5)](0x20)['toString']('hex');return{'publicKey':_0x37fd3f,'secretKey':_0xcac1};}async[a89_0x392586(0xb5)](_0x368010){const _0x2e733e=a89_0x392586,{fullName:_0x14f77c,username:_0x551946,password:_0x3d7b65,telegramId:_0x47f898,merchantUrl:_0x5e0132,gateways:_0x36dea7,gatewaySettings:_0x460a38,wallets:_0x2c929c}=_0x368010,_0x5797e7=await database_1['default'][_0x2e733e(0x97)]['findUnique']({'where':{'username':_0x551946}});if(_0x5797e7)throw new Error('Username\x20already\x20exists');if(_0x47f898){const _0x553173=await database_1[_0x2e733e(0xa8)][_0x2e733e(0x97)]['findUnique']({'where':{'telegram':_0x47f898}});if(_0x553173)throw new Error(_0x2e733e(0xa0));}const _0x4bfe5b=await bcryptjs_1[_0x2e733e(0xa8)][_0x2e733e(0x9a)](_0x3d7b65,0xc),{publicKey:_0x107ecd,secretKey:_0x3f2665}=this[_0x2e733e(0xbb)](),_0x2c9059=await database_1[_0x2e733e(0xa8)]['shop'][_0x2e733e(0xc4)]({'data':{'name':_0x14f77c,'username':_0x551946,'password':_0x4bfe5b,'telegram':_0x47f898,'shopUrl':_0x5e0132,'paymentGateways':_0x36dea7?JSON[_0x2e733e(0xa4)](_0x36dea7):null,'gatewaySettings':_0x460a38?JSON[_0x2e733e(0xa4)](_0x460a38):null,'usdtPolygonWallet':_0x2c929c?.[_0x2e733e(0xc5)]||null,'usdtTrcWallet':_0x2c929c?.['usdtTrcWallet']||null,'usdtErcWallet':_0x2c929c?.[_0x2e733e(0xbd)]||null,'usdcPolygonWallet':_0x2c929c?.['usdcPolygonWallet']||null,'publicKey':_0x107ecd,'secretKey':_0x3f2665,'status':_0x2e733e(0x95)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x2c9059['id'],'fullName':_0x2c9059[_0x2e733e(0x9c)],'username':_0x2c9059['username'],'telegramId':_0x2c9059['telegram'],'merchantUrl':_0x2c9059['shopUrl'],'gateways':_0x2c9059[_0x2e733e(0x98)]?JSON['parse'](_0x2c9059[_0x2e733e(0x98)]):null,'gatewaySettings':_0x2c9059[_0x2e733e(0xb4)]?JSON[_0x2e733e(0x91)](_0x2c9059[_0x2e733e(0xb4)]):null,'publicKey':_0x2c9059[_0x2e733e(0xad)],'wallets':{'usdtPolygonWallet':_0x2c9059['usdtPolygonWallet'],'usdtTrcWallet':_0x2c9059[_0x2e733e(0x99)],'usdtErcWallet':_0x2c9059[_0x2e733e(0xbd)],'usdcPolygonWallet':_0x2c9059[_0x2e733e(0xaf)]},'status':_0x2c9059[_0x2e733e(0x90)],'createdAt':_0x2c9059['createdAt']};}async[a89_0x392586(0xb2)](){const _0x39a114=a89_0x392586,_0x373847=await database_1['default'][_0x39a114(0x97)][_0x39a114(0xbc)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x39a114(0xb1)}});return _0x373847[_0x39a114(0xbf)](_0x5f2c5e=>({'id':_0x5f2c5e['id'],'fullName':_0x5f2c5e[_0x39a114(0x9c)],'username':_0x5f2c5e[_0x39a114(0xb3)],'telegramId':_0x5f2c5e[_0x39a114(0xab)],'merchantUrl':_0x5f2c5e[_0x39a114(0x9e)],'gateways':_0x5f2c5e['paymentGateways']?JSON[_0x39a114(0x91)](_0x5f2c5e[_0x39a114(0x98)]):null,'gatewaySettings':_0x5f2c5e['gatewaySettings']?JSON[_0x39a114(0x91)](_0x5f2c5e[_0x39a114(0xb4)]):null,'publicKey':_0x5f2c5e[_0x39a114(0xad)],'wallets':{'usdtPolygonWallet':_0x5f2c5e[_0x39a114(0xc5)],'usdtTrcWallet':_0x5f2c5e[_0x39a114(0x99)],'usdtErcWallet':_0x5f2c5e['usdtErcWallet'],'usdcPolygonWallet':_0x5f2c5e[_0x39a114(0xaf)]},'status':_0x5f2c5e[_0x39a114(0x90)],'createdAt':_0x5f2c5e[_0x39a114(0xc3)]}));}async[a89_0x392586(0x92)](_0x4655d1){const _0x213260=a89_0x392586,_0xd9b839=await database_1[_0x213260(0xa8)][_0x213260(0x97)][_0x213260(0xb7)]({'where':{'id':_0x4655d1},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0xd9b839)return null;return{'id':_0xd9b839['id'],'fullName':_0xd9b839['name'],'username':_0xd9b839[_0x213260(0xb3)],'telegramId':_0xd9b839[_0x213260(0xab)],'merchantUrl':_0xd9b839[_0x213260(0x9e)],'gateways':_0xd9b839[_0x213260(0x98)]?JSON[_0x213260(0x91)](_0xd9b839[_0x213260(0x98)]):null,'gatewaySettings':_0xd9b839[_0x213260(0xb4)]?JSON['parse'](_0xd9b839['gatewaySettings']):null,'publicKey':_0xd9b839[_0x213260(0xad)],'wallets':{'usdtPolygonWallet':_0xd9b839['usdtPolygonWallet'],'usdtTrcWallet':_0xd9b839[_0x213260(0x99)],'usdtErcWallet':_0xd9b839['usdtErcWallet'],'usdcPolygonWallet':_0xd9b839[_0x213260(0xaf)]},'status':_0xd9b839['status'],'createdAt':_0xd9b839[_0x213260(0xc3)]};}async['updateUser'](_0x520c77,_0x416d64){const _0x1c7859=a89_0x392586,_0x3bfcd9={..._0x416d64};_0x416d64[_0x1c7859(0x96)]&&(_0x3bfcd9[_0x1c7859(0x96)]=await bcryptjs_1[_0x1c7859(0xa8)][_0x1c7859(0x9a)](_0x416d64[_0x1c7859(0x96)],0xc));_0x416d64['fullName']&&(_0x3bfcd9[_0x1c7859(0x9c)]=_0x416d64[_0x1c7859(0x94)],delete _0x3bfcd9[_0x1c7859(0x94)]);_0x416d64[_0x1c7859(0xb6)]&&(_0x3bfcd9['telegram']=_0x416d64['telegramId'],delete _0x3bfcd9[_0x1c7859(0xb6)]);_0x416d64[_0x1c7859(0x9f)]&&(_0x3bfcd9['shopUrl']=_0x416d64[_0x1c7859(0x9f)],delete _0x3bfcd9[_0x1c7859(0x9f)]);_0x416d64['gateways']&&(_0x3bfcd9[_0x1c7859(0x98)]=JSON[_0x1c7859(0xa4)](_0x416d64[_0x1c7859(0xaa)]),delete _0x3bfcd9[_0x1c7859(0xaa)]);_0x416d64[_0x1c7859(0xb4)]&&(_0x3bfcd9['gatewaySettings']=JSON[_0x1c7859(0xa4)](_0x416d64[_0x1c7859(0xb4)]),delete _0x3bfcd9[_0x1c7859(0xb4)]);_0x416d64['wallets']&&(_0x416d64[_0x1c7859(0x8f)][_0x1c7859(0xc5)]!==undefined&&(_0x3bfcd9[_0x1c7859(0xc5)]=_0x416d64[_0x1c7859(0x8f)][_0x1c7859(0xc5)]||null),_0x416d64[_0x1c7859(0x8f)][_0x1c7859(0x99)]!==undefined&&(_0x3bfcd9['usdtTrcWallet']=_0x416d64[_0x1c7859(0x8f)][_0x1c7859(0x99)]||null),_0x416d64[_0x1c7859(0x8f)][_0x1c7859(0xbd)]!==undefined&&(_0x3bfcd9[_0x1c7859(0xbd)]=_0x416d64[_0x1c7859(0x8f)]['usdtErcWallet']||null),_0x416d64[_0x1c7859(0x8f)]['usdcPolygonWallet']!==undefined&&(_0x3bfcd9[_0x1c7859(0xaf)]=_0x416d64[_0x1c7859(0x8f)][_0x1c7859(0xaf)]||null),delete _0x3bfcd9[_0x1c7859(0x8f)]);const _0x4e5f9a=await database_1[_0x1c7859(0xa8)]['shop'][_0x1c7859(0xc2)]({'where':{'id':_0x520c77},'data':_0x3bfcd9,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x4e5f9a['id'],'fullName':_0x4e5f9a[_0x1c7859(0x9c)],'username':_0x4e5f9a[_0x1c7859(0xb3)],'telegramId':_0x4e5f9a[_0x1c7859(0xab)],'merchantUrl':_0x4e5f9a[_0x1c7859(0x9e)],'gateways':_0x4e5f9a[_0x1c7859(0x98)]?JSON[_0x1c7859(0x91)](_0x4e5f9a[_0x1c7859(0x98)]):null,'gatewaySettings':_0x4e5f9a['gatewaySettings']?JSON[_0x1c7859(0x91)](_0x4e5f9a['gatewaySettings']):null,'publicKey':_0x4e5f9a[_0x1c7859(0xad)],'wallets':{'usdtPolygonWallet':_0x4e5f9a[_0x1c7859(0xc5)],'usdtTrcWallet':_0x4e5f9a['usdtTrcWallet'],'usdtErcWallet':_0x4e5f9a[_0x1c7859(0xbd)],'usdcPolygonWallet':_0x4e5f9a[_0x1c7859(0xaf)]},'status':_0x4e5f9a[_0x1c7859(0x90)],'createdAt':_0x4e5f9a[_0x1c7859(0xc3)]};}async[a89_0x392586(0xb9)](_0x4eef61){const _0x19ba58=a89_0x392586;await database_1[_0x19ba58(0xa8)][_0x19ba58(0x97)][_0x19ba58(0x9d)]({'where':{'id':_0x4eef61}});}}exports[a89_0x392586(0x8e)]=UserService;function a89_0x2e55(){const _0xdcdec5=['map','bcryptjs','defineProperty','update','createdAt','create','usdtPolygonWallet','../config/database','54rgRsVJ','UserService','wallets','status','parse','getUserById','10857juraFv','fullName','ACTIVE','password','shop','paymentGateways','usdtTrcWallet','hash','toString','name','delete','shopUrl','merchantUrl','Telegram\x20username\x20already\x20exists','pk_','786ibZYav','sk_','stringify','randomBytes','__esModule','131020VzbqQd','default','316424JNuHtc','gateways','telegram','610683wRKkat','publicKey','184940eqHAuo','usdcPolygonWallet','177982JHzzFJ','desc','getAllUsers','username','gatewaySettings','createUser','telegramId','findUnique','crypto','deleteUser','__importDefault','generateApiKeys','findMany','usdtErcWallet','314910KzNLpM'];a89_0x2e55=function(){return _0xdcdec5;};return a89_0x2e55();}