'use strict';function a65_0x17ad(_0x161d5b,_0x4d3460){const _0x317b8e=a65_0x317b();return a65_0x17ad=function(_0x17ade8,_0x4366d9){_0x17ade8=_0x17ade8-0x92;let _0x5f06f5=_0x317b8e[_0x17ade8];return _0x5f06f5;},a65_0x17ad(_0x161d5b,_0x4d3460);}const a65_0x599edd=a65_0x17ad;(function(_0x13d880,_0x57610d){const _0x14521c=a65_0x17ad,_0x52f9f8=_0x13d880();while(!![]){try{const _0x2af347=parseInt(_0x14521c(0x96))/0x1+-parseInt(_0x14521c(0xb4))/0x2*(-parseInt(_0x14521c(0x99))/0x3)+parseInt(_0x14521c(0xac))/0x4+-parseInt(_0x14521c(0x9d))/0x5+parseInt(_0x14521c(0xc6))/0x6+-parseInt(_0x14521c(0x9e))/0x7*(parseInt(_0x14521c(0x94))/0x8)+-parseInt(_0x14521c(0xc5))/0x9*(parseInt(_0x14521c(0xa3))/0xa);if(_0x2af347===_0x57610d)break;else _0x52f9f8['push'](_0x52f9f8['shift']());}catch(_0x42cdb8){_0x52f9f8['push'](_0x52f9f8['shift']());}}}(a65_0x317b,0xb1ce4));var __importDefault=this&&this[a65_0x599edd(0xb7)]||function(_0x45a4bc){const _0x4f9d82=a65_0x599edd;return _0x45a4bc&&_0x45a4bc[_0x4f9d82(0xa2)]?_0x45a4bc:{'default':_0x45a4bc};};Object['defineProperty'](exports,a65_0x599edd(0xa2),{'value':!![]}),exports['UserService']=void 0x0;const bcryptjs_1=__importDefault(require(a65_0x599edd(0xbd))),crypto_1=__importDefault(require(a65_0x599edd(0xa1))),database_1=__importDefault(require(a65_0x599edd(0xca)));function a65_0x317b(){const _0x5ed2cd=['desc','__importDefault','gatewaySettings','usdtErcWallet','name','telegramId','paymentGateways','bcryptjs','ACTIVE','publicKey','usdtTrcWallet','randomBytes','createUser','deleteUser','gateways','14607477rNgQTL','2148456pIaycR','UserService','parse','shopUrl','../config/database','usdtPolygonWallet','generateApiKeys','updateUser','4167464rsDwcT','hex','1421824cDyNDj','fullName','merchantUrl','99EhBpfS','findMany','username','create','3146120HpJtgU','7cBmIEK','hash','getAllUsers','crypto','__esModule','10csKeca','telegram','shop','wallets','Telegram\x20username\x20already\x20exists','status','toString','password','map','1764412rilhXi','sk_','usdcPolygonWallet','delete','findUnique','createdAt','default','update','77606beTlgS','stringify'];a65_0x317b=function(){return _0x5ed2cd;};return a65_0x317b();}class UserService{['generateApiKeys'](){const _0x6558e1=a65_0x599edd,_0x12b865='pk_'+crypto_1[_0x6558e1(0xb2)][_0x6558e1(0xc1)](0x20)[_0x6558e1(0xa9)](_0x6558e1(0x95)),_0x265b47=_0x6558e1(0xad)+crypto_1[_0x6558e1(0xb2)][_0x6558e1(0xc1)](0x20)[_0x6558e1(0xa9)](_0x6558e1(0x95));return{'publicKey':_0x12b865,'secretKey':_0x265b47};}async[a65_0x599edd(0xc2)](_0x35591f){const _0x5b6b30=a65_0x599edd,{fullName:_0x22f1be,username:_0x495961,password:_0x3e7092,telegramId:_0x1787ed,merchantUrl:_0x55c625,gateways:_0xccb40b,gatewaySettings:_0x5de46a,wallets:_0x384eeb}=_0x35591f,_0x54106d=await database_1[_0x5b6b30(0xb2)][_0x5b6b30(0xa5)][_0x5b6b30(0xb0)]({'where':{'username':_0x495961}});if(_0x54106d)throw new Error('Username\x20already\x20exists');if(_0x1787ed){const _0x5dbc42=await database_1[_0x5b6b30(0xb2)][_0x5b6b30(0xa5)][_0x5b6b30(0xb0)]({'where':{'telegram':_0x1787ed}});if(_0x5dbc42)throw new Error(_0x5b6b30(0xa7));}const _0x1754f3=await bcryptjs_1[_0x5b6b30(0xb2)][_0x5b6b30(0x9f)](_0x3e7092,0xc),{publicKey:_0x751a95,secretKey:_0x43bdf0}=this[_0x5b6b30(0x92)](),_0x12b5c0=await database_1['default']['shop'][_0x5b6b30(0x9c)]({'data':{'name':_0x22f1be,'username':_0x495961,'password':_0x1754f3,'telegram':_0x1787ed,'shopUrl':_0x55c625,'paymentGateways':_0xccb40b?JSON[_0x5b6b30(0xb5)](_0xccb40b):null,'gatewaySettings':_0x5de46a?JSON[_0x5b6b30(0xb5)](_0x5de46a):null,'usdtPolygonWallet':_0x384eeb?.[_0x5b6b30(0xcb)]||null,'usdtTrcWallet':_0x384eeb?.[_0x5b6b30(0xc0)]||null,'usdtErcWallet':_0x384eeb?.['usdtErcWallet']||null,'usdcPolygonWallet':_0x384eeb?.['usdcPolygonWallet']||null,'publicKey':_0x751a95,'secretKey':_0x43bdf0,'status':_0x5b6b30(0xbe)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x12b5c0['id'],'fullName':_0x12b5c0[_0x5b6b30(0xba)],'username':_0x12b5c0[_0x5b6b30(0x9b)],'telegramId':_0x12b5c0[_0x5b6b30(0xa4)],'merchantUrl':_0x12b5c0['shopUrl'],'gateways':_0x12b5c0[_0x5b6b30(0xbc)]?JSON[_0x5b6b30(0xc8)](_0x12b5c0[_0x5b6b30(0xbc)]):null,'gatewaySettings':_0x12b5c0[_0x5b6b30(0xb8)]?JSON['parse'](_0x12b5c0[_0x5b6b30(0xb8)]):null,'publicKey':_0x12b5c0[_0x5b6b30(0xbf)],'wallets':{'usdtPolygonWallet':_0x12b5c0[_0x5b6b30(0xcb)],'usdtTrcWallet':_0x12b5c0[_0x5b6b30(0xc0)],'usdtErcWallet':_0x12b5c0[_0x5b6b30(0xb9)],'usdcPolygonWallet':_0x12b5c0[_0x5b6b30(0xae)]},'status':_0x12b5c0[_0x5b6b30(0xa8)],'createdAt':_0x12b5c0[_0x5b6b30(0xb1)]};}async[a65_0x599edd(0xa0)](){const _0x58078d=a65_0x599edd,_0x23b987=await database_1['default'][_0x58078d(0xa5)][_0x58078d(0x9a)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x58078d(0xb6)}});return _0x23b987[_0x58078d(0xab)](_0x4c2ddb=>({'id':_0x4c2ddb['id'],'fullName':_0x4c2ddb['name'],'username':_0x4c2ddb[_0x58078d(0x9b)],'telegramId':_0x4c2ddb[_0x58078d(0xa4)],'merchantUrl':_0x4c2ddb['shopUrl'],'gateways':_0x4c2ddb[_0x58078d(0xbc)]?JSON[_0x58078d(0xc8)](_0x4c2ddb[_0x58078d(0xbc)]):null,'gatewaySettings':_0x4c2ddb[_0x58078d(0xb8)]?JSON[_0x58078d(0xc8)](_0x4c2ddb[_0x58078d(0xb8)]):null,'publicKey':_0x4c2ddb[_0x58078d(0xbf)],'wallets':{'usdtPolygonWallet':_0x4c2ddb[_0x58078d(0xcb)],'usdtTrcWallet':_0x4c2ddb['usdtTrcWallet'],'usdtErcWallet':_0x4c2ddb[_0x58078d(0xb9)],'usdcPolygonWallet':_0x4c2ddb['usdcPolygonWallet']},'status':_0x4c2ddb['status'],'createdAt':_0x4c2ddb[_0x58078d(0xb1)]}));}async['getUserById'](_0x4d8629){const _0x39df82=a65_0x599edd,_0x232ce1=await database_1[_0x39df82(0xb2)][_0x39df82(0xa5)]['findUnique']({'where':{'id':_0x4d8629},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x232ce1)return null;return{'id':_0x232ce1['id'],'fullName':_0x232ce1[_0x39df82(0xba)],'username':_0x232ce1[_0x39df82(0x9b)],'telegramId':_0x232ce1['telegram'],'merchantUrl':_0x232ce1[_0x39df82(0xc9)],'gateways':_0x232ce1[_0x39df82(0xbc)]?JSON[_0x39df82(0xc8)](_0x232ce1[_0x39df82(0xbc)]):null,'gatewaySettings':_0x232ce1[_0x39df82(0xb8)]?JSON[_0x39df82(0xc8)](_0x232ce1['gatewaySettings']):null,'publicKey':_0x232ce1[_0x39df82(0xbf)],'wallets':{'usdtPolygonWallet':_0x232ce1[_0x39df82(0xcb)],'usdtTrcWallet':_0x232ce1[_0x39df82(0xc0)],'usdtErcWallet':_0x232ce1[_0x39df82(0xb9)],'usdcPolygonWallet':_0x232ce1[_0x39df82(0xae)]},'status':_0x232ce1[_0x39df82(0xa8)],'createdAt':_0x232ce1['createdAt']};}async[a65_0x599edd(0x93)](_0x139f73,_0x3d2e0f){const _0x1b5867=a65_0x599edd,_0x15a9b5={..._0x3d2e0f};_0x3d2e0f[_0x1b5867(0xaa)]&&(_0x15a9b5[_0x1b5867(0xaa)]=await bcryptjs_1[_0x1b5867(0xb2)][_0x1b5867(0x9f)](_0x3d2e0f[_0x1b5867(0xaa)],0xc));_0x3d2e0f[_0x1b5867(0x97)]&&(_0x15a9b5[_0x1b5867(0xba)]=_0x3d2e0f[_0x1b5867(0x97)],delete _0x15a9b5[_0x1b5867(0x97)]);_0x3d2e0f[_0x1b5867(0xbb)]&&(_0x15a9b5['telegram']=_0x3d2e0f[_0x1b5867(0xbb)],delete _0x15a9b5[_0x1b5867(0xbb)]);_0x3d2e0f[_0x1b5867(0x98)]&&(_0x15a9b5[_0x1b5867(0xc9)]=_0x3d2e0f[_0x1b5867(0x98)],delete _0x15a9b5[_0x1b5867(0x98)]);_0x3d2e0f[_0x1b5867(0xc4)]&&(_0x15a9b5[_0x1b5867(0xbc)]=JSON['stringify'](_0x3d2e0f['gateways']),delete _0x15a9b5[_0x1b5867(0xc4)]);_0x3d2e0f['gatewaySettings']&&(_0x15a9b5[_0x1b5867(0xb8)]=JSON[_0x1b5867(0xb5)](_0x3d2e0f['gatewaySettings']),delete _0x15a9b5['gatewaySettings']);_0x3d2e0f[_0x1b5867(0xa6)]&&(_0x3d2e0f['wallets'][_0x1b5867(0xcb)]!==undefined&&(_0x15a9b5[_0x1b5867(0xcb)]=_0x3d2e0f['wallets'][_0x1b5867(0xcb)]||null),_0x3d2e0f[_0x1b5867(0xa6)][_0x1b5867(0xc0)]!==undefined&&(_0x15a9b5[_0x1b5867(0xc0)]=_0x3d2e0f['wallets'][_0x1b5867(0xc0)]||null),_0x3d2e0f[_0x1b5867(0xa6)]['usdtErcWallet']!==undefined&&(_0x15a9b5[_0x1b5867(0xb9)]=_0x3d2e0f[_0x1b5867(0xa6)]['usdtErcWallet']||null),_0x3d2e0f[_0x1b5867(0xa6)][_0x1b5867(0xae)]!==undefined&&(_0x15a9b5[_0x1b5867(0xae)]=_0x3d2e0f[_0x1b5867(0xa6)][_0x1b5867(0xae)]||null),delete _0x15a9b5[_0x1b5867(0xa6)]);const _0x123ab0=await database_1[_0x1b5867(0xb2)]['shop'][_0x1b5867(0xb3)]({'where':{'id':_0x139f73},'data':_0x15a9b5,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x123ab0['id'],'fullName':_0x123ab0[_0x1b5867(0xba)],'username':_0x123ab0['username'],'telegramId':_0x123ab0[_0x1b5867(0xa4)],'merchantUrl':_0x123ab0[_0x1b5867(0xc9)],'gateways':_0x123ab0[_0x1b5867(0xbc)]?JSON['parse'](_0x123ab0['paymentGateways']):null,'gatewaySettings':_0x123ab0[_0x1b5867(0xb8)]?JSON['parse'](_0x123ab0[_0x1b5867(0xb8)]):null,'publicKey':_0x123ab0[_0x1b5867(0xbf)],'wallets':{'usdtPolygonWallet':_0x123ab0[_0x1b5867(0xcb)],'usdtTrcWallet':_0x123ab0[_0x1b5867(0xc0)],'usdtErcWallet':_0x123ab0[_0x1b5867(0xb9)],'usdcPolygonWallet':_0x123ab0[_0x1b5867(0xae)]},'status':_0x123ab0[_0x1b5867(0xa8)],'createdAt':_0x123ab0['createdAt']};}async[a65_0x599edd(0xc3)](_0x25860d){const _0x13d651=a65_0x599edd;await database_1[_0x13d651(0xb2)][_0x13d651(0xa5)][_0x13d651(0xaf)]({'where':{'id':_0x25860d}});}}exports[a65_0x599edd(0xc7)]=UserService;