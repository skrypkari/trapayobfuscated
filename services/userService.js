'use strict';const a59_0x4820ef=a59_0x57d7;(function(_0x581ee2,_0x1d1e1c){const _0x1c5f84=a59_0x57d7,_0x25bab1=_0x581ee2();while(!![]){try{const _0x325927=parseInt(_0x1c5f84(0xbc))/0x1+-parseInt(_0x1c5f84(0xc1))/0x2*(-parseInt(_0x1c5f84(0xbe))/0x3)+parseInt(_0x1c5f84(0xa0))/0x4+parseInt(_0x1c5f84(0xb0))/0x5+parseInt(_0x1c5f84(0xb9))/0x6+parseInt(_0x1c5f84(0x96))/0x7*(-parseInt(_0x1c5f84(0xab))/0x8)+-parseInt(_0x1c5f84(0xb5))/0x9*(parseInt(_0x1c5f84(0xb8))/0xa);if(_0x325927===_0x1d1e1c)break;else _0x25bab1['push'](_0x25bab1['shift']());}catch(_0x5a75fc){_0x25bab1['push'](_0x25bab1['shift']());}}}(a59_0x397b,0x54158));var __importDefault=this&&this[a59_0x4820ef(0x9f)]||function(_0x2d4b99){const _0x57ed9e=a59_0x4820ef;return _0x2d4b99&&_0x2d4b99[_0x57ed9e(0xa5)]?_0x2d4b99:{'default':_0x2d4b99};};function a59_0x397b(){const _0x5ec769=['8253beodeF','getUserById','usdtTrcWallet','10170XXZXGL','2937600yEMFiQ','hex','wallets','273552uNkvEi','shop','708unnklU','map','name','3424xoTlvJ','merchantUrl','username','telegramId','publicKey','telegram','parse','hash','gatewaySettings','update','crypto','findUnique','paymentGateways','desc','42PTldvC','usdcPolygonWallet','toString','UserService','defineProperty','create','../config/database','Telegram\x20username\x20already\x20exists','shopUrl','__importDefault','1991028PdUCdV','status','default','createUser','usdtErcWallet','__esModule','gateways','password','Username\x20already\x20exists','deleteUser','generateApiKeys','750800StvruY','updateUser','bcryptjs','fullName','createdAt','875780TIJqga','usdtPolygonWallet','delete','stringify','randomBytes'];a59_0x397b=function(){return _0x5ec769;};return a59_0x397b();}Object[a59_0x4820ef(0x9a)](exports,a59_0x4820ef(0xa5),{'value':!![]}),exports[a59_0x4820ef(0x99)]=void 0x0;function a59_0x57d7(_0x3170f5,_0x3fa4de){const _0x397bb2=a59_0x397b();return a59_0x57d7=function(_0x57d7cf,_0x21d46c){_0x57d7cf=_0x57d7cf-0x95;let _0x56793c=_0x397bb2[_0x57d7cf];return _0x56793c;},a59_0x57d7(_0x3170f5,_0x3fa4de);}const bcryptjs_1=__importDefault(require(a59_0x4820ef(0xad))),crypto_1=__importDefault(require(a59_0x4820ef(0xcb))),database_1=__importDefault(require(a59_0x4820ef(0x9c)));class UserService{['generateApiKeys'](){const _0xe647c4=a59_0x4820ef,_0x4d8c1e='pk_'+crypto_1[_0xe647c4(0xa2)][_0xe647c4(0xb4)](0x20)[_0xe647c4(0x98)](_0xe647c4(0xba)),_0x11c05c='sk_'+crypto_1[_0xe647c4(0xa2)]['randomBytes'](0x20)['toString']('hex');return{'publicKey':_0x4d8c1e,'secretKey':_0x11c05c};}async[a59_0x4820ef(0xa3)](_0x2359c5){const _0x9aa83f=a59_0x4820ef,{fullName:_0x235a04,username:_0x54d4ba,password:_0x53e746,telegramId:_0x362a64,merchantUrl:_0x15dd8a,gateways:_0x4c1dba,gatewaySettings:_0x386472,wallets:_0x57f96d}=_0x2359c5,_0x4089ba=await database_1[_0x9aa83f(0xa2)]['shop'][_0x9aa83f(0xcc)]({'where':{'username':_0x54d4ba}});if(_0x4089ba)throw new Error(_0x9aa83f(0xa8));if(_0x362a64){const _0x3f15da=await database_1[_0x9aa83f(0xa2)][_0x9aa83f(0xbd)]['findUnique']({'where':{'telegram':_0x362a64}});if(_0x3f15da)throw new Error(_0x9aa83f(0x9d));}const _0x2c76c9=await bcryptjs_1[_0x9aa83f(0xa2)][_0x9aa83f(0xc8)](_0x53e746,0xc),{publicKey:_0x4c3a04,secretKey:_0x40f187}=this[_0x9aa83f(0xaa)](),_0x274348=await database_1['default'][_0x9aa83f(0xbd)][_0x9aa83f(0x9b)]({'data':{'name':_0x235a04,'username':_0x54d4ba,'password':_0x2c76c9,'telegram':_0x362a64,'shopUrl':_0x15dd8a,'paymentGateways':_0x4c1dba?JSON[_0x9aa83f(0xb3)](_0x4c1dba):null,'gatewaySettings':_0x386472?JSON['stringify'](_0x386472):null,'usdtPolygonWallet':_0x57f96d?.['usdtPolygonWallet']||null,'usdtTrcWallet':_0x57f96d?.[_0x9aa83f(0xb7)]||null,'usdtErcWallet':_0x57f96d?.[_0x9aa83f(0xa4)]||null,'usdcPolygonWallet':_0x57f96d?.[_0x9aa83f(0x97)]||null,'publicKey':_0x4c3a04,'secretKey':_0x40f187,'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x274348['id'],'fullName':_0x274348[_0x9aa83f(0xc0)],'username':_0x274348[_0x9aa83f(0xc3)],'telegramId':_0x274348[_0x9aa83f(0xc6)],'merchantUrl':_0x274348['shopUrl'],'gateways':_0x274348[_0x9aa83f(0xcd)]?JSON[_0x9aa83f(0xc7)](_0x274348[_0x9aa83f(0xcd)]):null,'gatewaySettings':_0x274348['gatewaySettings']?JSON['parse'](_0x274348[_0x9aa83f(0xc9)]):null,'publicKey':_0x274348[_0x9aa83f(0xc5)],'wallets':{'usdtPolygonWallet':_0x274348[_0x9aa83f(0xb1)],'usdtTrcWallet':_0x274348[_0x9aa83f(0xb7)],'usdtErcWallet':_0x274348[_0x9aa83f(0xa4)],'usdcPolygonWallet':_0x274348[_0x9aa83f(0x97)]},'status':_0x274348[_0x9aa83f(0xa1)],'createdAt':_0x274348[_0x9aa83f(0xaf)]};}async['getAllUsers'](){const _0x58ba42=a59_0x4820ef,_0x255e2a=await database_1[_0x58ba42(0xa2)][_0x58ba42(0xbd)]['findMany']({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x58ba42(0x95)}});return _0x255e2a[_0x58ba42(0xbf)](_0x8cc519=>({'id':_0x8cc519['id'],'fullName':_0x8cc519[_0x58ba42(0xc0)],'username':_0x8cc519['username'],'telegramId':_0x8cc519['telegram'],'merchantUrl':_0x8cc519[_0x58ba42(0x9e)],'gateways':_0x8cc519[_0x58ba42(0xcd)]?JSON[_0x58ba42(0xc7)](_0x8cc519[_0x58ba42(0xcd)]):null,'gatewaySettings':_0x8cc519[_0x58ba42(0xc9)]?JSON[_0x58ba42(0xc7)](_0x8cc519[_0x58ba42(0xc9)]):null,'publicKey':_0x8cc519[_0x58ba42(0xc5)],'wallets':{'usdtPolygonWallet':_0x8cc519['usdtPolygonWallet'],'usdtTrcWallet':_0x8cc519[_0x58ba42(0xb7)],'usdtErcWallet':_0x8cc519['usdtErcWallet'],'usdcPolygonWallet':_0x8cc519[_0x58ba42(0x97)]},'status':_0x8cc519['status'],'createdAt':_0x8cc519[_0x58ba42(0xaf)]}));}async[a59_0x4820ef(0xb6)](_0x425db2){const _0x2644f5=a59_0x4820ef,_0x3c9fdf=await database_1[_0x2644f5(0xa2)][_0x2644f5(0xbd)][_0x2644f5(0xcc)]({'where':{'id':_0x425db2},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x3c9fdf)return null;return{'id':_0x3c9fdf['id'],'fullName':_0x3c9fdf['name'],'username':_0x3c9fdf[_0x2644f5(0xc3)],'telegramId':_0x3c9fdf['telegram'],'merchantUrl':_0x3c9fdf[_0x2644f5(0x9e)],'gateways':_0x3c9fdf[_0x2644f5(0xcd)]?JSON[_0x2644f5(0xc7)](_0x3c9fdf[_0x2644f5(0xcd)]):null,'gatewaySettings':_0x3c9fdf['gatewaySettings']?JSON[_0x2644f5(0xc7)](_0x3c9fdf['gatewaySettings']):null,'publicKey':_0x3c9fdf[_0x2644f5(0xc5)],'wallets':{'usdtPolygonWallet':_0x3c9fdf[_0x2644f5(0xb1)],'usdtTrcWallet':_0x3c9fdf[_0x2644f5(0xb7)],'usdtErcWallet':_0x3c9fdf[_0x2644f5(0xa4)],'usdcPolygonWallet':_0x3c9fdf[_0x2644f5(0x97)]},'status':_0x3c9fdf[_0x2644f5(0xa1)],'createdAt':_0x3c9fdf[_0x2644f5(0xaf)]};}async[a59_0x4820ef(0xac)](_0x45e6c8,_0x58c2e8){const _0x2e2d65=a59_0x4820ef,_0x726c87={..._0x58c2e8};_0x58c2e8['password']&&(_0x726c87[_0x2e2d65(0xa7)]=await bcryptjs_1['default'][_0x2e2d65(0xc8)](_0x58c2e8['password'],0xc));_0x58c2e8[_0x2e2d65(0xae)]&&(_0x726c87[_0x2e2d65(0xc0)]=_0x58c2e8[_0x2e2d65(0xae)],delete _0x726c87[_0x2e2d65(0xae)]);_0x58c2e8[_0x2e2d65(0xc4)]&&(_0x726c87[_0x2e2d65(0xc6)]=_0x58c2e8[_0x2e2d65(0xc4)],delete _0x726c87[_0x2e2d65(0xc4)]);_0x58c2e8['merchantUrl']&&(_0x726c87[_0x2e2d65(0x9e)]=_0x58c2e8[_0x2e2d65(0xc2)],delete _0x726c87['merchantUrl']);_0x58c2e8[_0x2e2d65(0xa6)]&&(_0x726c87[_0x2e2d65(0xcd)]=JSON[_0x2e2d65(0xb3)](_0x58c2e8[_0x2e2d65(0xa6)]),delete _0x726c87[_0x2e2d65(0xa6)]);_0x58c2e8[_0x2e2d65(0xc9)]&&(_0x726c87['gatewaySettings']=JSON['stringify'](_0x58c2e8[_0x2e2d65(0xc9)]),delete _0x726c87[_0x2e2d65(0xc9)]);_0x58c2e8[_0x2e2d65(0xbb)]&&(_0x58c2e8[_0x2e2d65(0xbb)][_0x2e2d65(0xb1)]!==undefined&&(_0x726c87[_0x2e2d65(0xb1)]=_0x58c2e8[_0x2e2d65(0xbb)][_0x2e2d65(0xb1)]||null),_0x58c2e8[_0x2e2d65(0xbb)][_0x2e2d65(0xb7)]!==undefined&&(_0x726c87['usdtTrcWallet']=_0x58c2e8['wallets'][_0x2e2d65(0xb7)]||null),_0x58c2e8[_0x2e2d65(0xbb)][_0x2e2d65(0xa4)]!==undefined&&(_0x726c87['usdtErcWallet']=_0x58c2e8[_0x2e2d65(0xbb)][_0x2e2d65(0xa4)]||null),_0x58c2e8['wallets'][_0x2e2d65(0x97)]!==undefined&&(_0x726c87[_0x2e2d65(0x97)]=_0x58c2e8[_0x2e2d65(0xbb)][_0x2e2d65(0x97)]||null),delete _0x726c87[_0x2e2d65(0xbb)]);const _0x9befea=await database_1['default'][_0x2e2d65(0xbd)][_0x2e2d65(0xca)]({'where':{'id':_0x45e6c8},'data':_0x726c87,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x9befea['id'],'fullName':_0x9befea[_0x2e2d65(0xc0)],'username':_0x9befea[_0x2e2d65(0xc3)],'telegramId':_0x9befea[_0x2e2d65(0xc6)],'merchantUrl':_0x9befea[_0x2e2d65(0x9e)],'gateways':_0x9befea['paymentGateways']?JSON['parse'](_0x9befea[_0x2e2d65(0xcd)]):null,'gatewaySettings':_0x9befea['gatewaySettings']?JSON['parse'](_0x9befea[_0x2e2d65(0xc9)]):null,'publicKey':_0x9befea[_0x2e2d65(0xc5)],'wallets':{'usdtPolygonWallet':_0x9befea[_0x2e2d65(0xb1)],'usdtTrcWallet':_0x9befea['usdtTrcWallet'],'usdtErcWallet':_0x9befea[_0x2e2d65(0xa4)],'usdcPolygonWallet':_0x9befea[_0x2e2d65(0x97)]},'status':_0x9befea['status'],'createdAt':_0x9befea['createdAt']};}async[a59_0x4820ef(0xa9)](_0x13f078){const _0x3c366a=a59_0x4820ef;await database_1[_0x3c366a(0xa2)]['shop'][_0x3c366a(0xb2)]({'where':{'id':_0x13f078}});}}exports[a59_0x4820ef(0x99)]=UserService;