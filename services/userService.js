'use strict';const a55_0x4558b2=a55_0x549e;(function(_0x5a262c,_0x1779f9){const _0x5355a1=a55_0x549e,_0x801d0a=_0x5a262c();while(!![]){try{const _0x439ef8=parseInt(_0x5355a1(0x175))/0x1*(-parseInt(_0x5355a1(0x194))/0x2)+parseInt(_0x5355a1(0x15d))/0x3+-parseInt(_0x5355a1(0x181))/0x4+parseInt(_0x5355a1(0x17f))/0x5*(parseInt(_0x5355a1(0x18e))/0x6)+parseInt(_0x5355a1(0x179))/0x7*(-parseInt(_0x5355a1(0x17b))/0x8)+-parseInt(_0x5355a1(0x166))/0x9+-parseInt(_0x5355a1(0x185))/0xa*(-parseInt(_0x5355a1(0x168))/0xb);if(_0x439ef8===_0x1779f9)break;else _0x801d0a['push'](_0x801d0a['shift']());}catch(_0x587752){_0x801d0a['push'](_0x801d0a['shift']());}}}(a55_0x4d6b,0x9c648));function a55_0x4d6b(){const _0x53b99b=['hash','fullName','publicKey','crypto','958494MGOVpN','merchantUrl','hex','shopUrl','createUser','password','2ScBuZn','desc','usdtErcWallet','createdAt','create','1183905SjjFpC','randomBytes','wallets','findMany','updateUser','UserService','delete','usdtTrcWallet','../config/database','6584058SyAspu','default','18167919cxRAHQ','username','bcryptjs','deleteUser','name','toString','usdcPolygonWallet','ACTIVE','usdtPolygonWallet','status','shop','paymentGateways','defineProperty','1079941zeMHiz','parse','telegramId','pk_','10507NdYowq','update','6280rDVWtG','__esModule','Username\x20already\x20exists','getAllUsers','35cENnnP','findUnique','4743056QxWkMR','__importDefault','telegram','gateways','20gyGiMV','Telegram\x20username\x20already\x20exists','stringify','gatewaySettings','generateApiKeys'];a55_0x4d6b=function(){return _0x53b99b;};return a55_0x4d6b();}var __importDefault=this&&this[a55_0x4558b2(0x182)]||function(_0x4a5527){const _0x155d02=a55_0x4558b2;return _0x4a5527&&_0x4a5527[_0x155d02(0x17c)]?_0x4a5527:{'default':_0x4a5527};};Object[a55_0x4558b2(0x174)](exports,a55_0x4558b2(0x17c),{'value':!![]}),exports[a55_0x4558b2(0x162)]=void 0x0;const bcryptjs_1=__importDefault(require(a55_0x4558b2(0x16a))),crypto_1=__importDefault(require(a55_0x4558b2(0x18d))),database_1=__importDefault(require(a55_0x4558b2(0x165)));function a55_0x549e(_0x912bc5,_0x18f95d){const _0x4d6bc0=a55_0x4d6b();return a55_0x549e=function(_0x549e3d,_0x449ba2){_0x549e3d=_0x549e3d-0x15d;let _0x5c78bb=_0x4d6bc0[_0x549e3d];return _0x5c78bb;},a55_0x549e(_0x912bc5,_0x18f95d);}class UserService{[a55_0x4558b2(0x189)](){const _0x41e781=a55_0x4558b2,_0x2f0292=_0x41e781(0x178)+crypto_1['default']['randomBytes'](0x20)[_0x41e781(0x16d)](_0x41e781(0x190)),_0x8ed45c='sk_'+crypto_1[_0x41e781(0x167)][_0x41e781(0x15e)](0x20)[_0x41e781(0x16d)](_0x41e781(0x190));return{'publicKey':_0x2f0292,'secretKey':_0x8ed45c};}async[a55_0x4558b2(0x192)](_0x308119){const _0x385bfd=a55_0x4558b2,{fullName:_0x408d9b,username:_0x3d75e2,password:_0xa5213b,telegramId:_0x294b0f,merchantUrl:_0x340d16,gateways:_0x565d5e,gatewaySettings:_0xd95763,wallets:_0x159e8e}=_0x308119,_0x3391fb=await database_1['default']['shop'][_0x385bfd(0x180)]({'where':{'username':_0x3d75e2}});if(_0x3391fb)throw new Error(_0x385bfd(0x17d));if(_0x294b0f){const _0x3db2b2=await database_1[_0x385bfd(0x167)][_0x385bfd(0x172)][_0x385bfd(0x180)]({'where':{'telegram':_0x294b0f}});if(_0x3db2b2)throw new Error(_0x385bfd(0x186));}const _0x4a395f=await bcryptjs_1[_0x385bfd(0x167)][_0x385bfd(0x18a)](_0xa5213b,0xc),{publicKey:_0x1301c2,secretKey:_0x2025fc}=this[_0x385bfd(0x189)](),_0x5d4243=await database_1[_0x385bfd(0x167)][_0x385bfd(0x172)][_0x385bfd(0x198)]({'data':{'name':_0x408d9b,'username':_0x3d75e2,'password':_0x4a395f,'telegram':_0x294b0f,'shopUrl':_0x340d16,'paymentGateways':_0x565d5e?JSON[_0x385bfd(0x187)](_0x565d5e):null,'gatewaySettings':_0xd95763?JSON[_0x385bfd(0x187)](_0xd95763):null,'usdtPolygonWallet':_0x159e8e?.[_0x385bfd(0x170)]||null,'usdtTrcWallet':_0x159e8e?.[_0x385bfd(0x164)]||null,'usdtErcWallet':_0x159e8e?.[_0x385bfd(0x196)]||null,'usdcPolygonWallet':_0x159e8e?.[_0x385bfd(0x16e)]||null,'publicKey':_0x1301c2,'secretKey':_0x2025fc,'status':_0x385bfd(0x16f)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x5d4243['id'],'fullName':_0x5d4243[_0x385bfd(0x16c)],'username':_0x5d4243[_0x385bfd(0x169)],'telegramId':_0x5d4243[_0x385bfd(0x183)],'merchantUrl':_0x5d4243[_0x385bfd(0x191)],'gateways':_0x5d4243[_0x385bfd(0x173)]?JSON[_0x385bfd(0x176)](_0x5d4243[_0x385bfd(0x173)]):null,'gatewaySettings':_0x5d4243[_0x385bfd(0x188)]?JSON[_0x385bfd(0x176)](_0x5d4243[_0x385bfd(0x188)]):null,'publicKey':_0x5d4243[_0x385bfd(0x18c)],'wallets':{'usdtPolygonWallet':_0x5d4243[_0x385bfd(0x170)],'usdtTrcWallet':_0x5d4243[_0x385bfd(0x164)],'usdtErcWallet':_0x5d4243[_0x385bfd(0x196)],'usdcPolygonWallet':_0x5d4243[_0x385bfd(0x16e)]},'status':_0x5d4243[_0x385bfd(0x171)],'createdAt':_0x5d4243[_0x385bfd(0x197)]};}async[a55_0x4558b2(0x17e)](){const _0x4600aa=a55_0x4558b2,_0x30f262=await database_1[_0x4600aa(0x167)][_0x4600aa(0x172)][_0x4600aa(0x160)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x4600aa(0x195)}});return _0x30f262['map'](_0x5fde9f=>({'id':_0x5fde9f['id'],'fullName':_0x5fde9f[_0x4600aa(0x16c)],'username':_0x5fde9f[_0x4600aa(0x169)],'telegramId':_0x5fde9f[_0x4600aa(0x183)],'merchantUrl':_0x5fde9f['shopUrl'],'gateways':_0x5fde9f[_0x4600aa(0x173)]?JSON[_0x4600aa(0x176)](_0x5fde9f['paymentGateways']):null,'gatewaySettings':_0x5fde9f[_0x4600aa(0x188)]?JSON[_0x4600aa(0x176)](_0x5fde9f[_0x4600aa(0x188)]):null,'publicKey':_0x5fde9f[_0x4600aa(0x18c)],'wallets':{'usdtPolygonWallet':_0x5fde9f[_0x4600aa(0x170)],'usdtTrcWallet':_0x5fde9f[_0x4600aa(0x164)],'usdtErcWallet':_0x5fde9f[_0x4600aa(0x196)],'usdcPolygonWallet':_0x5fde9f[_0x4600aa(0x16e)]},'status':_0x5fde9f['status'],'createdAt':_0x5fde9f[_0x4600aa(0x197)]}));}async['getUserById'](_0x4a3d9a){const _0x5ea130=a55_0x4558b2,_0x377e61=await database_1[_0x5ea130(0x167)][_0x5ea130(0x172)][_0x5ea130(0x180)]({'where':{'id':_0x4a3d9a},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x377e61)return null;return{'id':_0x377e61['id'],'fullName':_0x377e61['name'],'username':_0x377e61[_0x5ea130(0x169)],'telegramId':_0x377e61[_0x5ea130(0x183)],'merchantUrl':_0x377e61[_0x5ea130(0x191)],'gateways':_0x377e61[_0x5ea130(0x173)]?JSON[_0x5ea130(0x176)](_0x377e61[_0x5ea130(0x173)]):null,'gatewaySettings':_0x377e61['gatewaySettings']?JSON['parse'](_0x377e61[_0x5ea130(0x188)]):null,'publicKey':_0x377e61[_0x5ea130(0x18c)],'wallets':{'usdtPolygonWallet':_0x377e61[_0x5ea130(0x170)],'usdtTrcWallet':_0x377e61[_0x5ea130(0x164)],'usdtErcWallet':_0x377e61['usdtErcWallet'],'usdcPolygonWallet':_0x377e61['usdcPolygonWallet']},'status':_0x377e61['status'],'createdAt':_0x377e61['createdAt']};}async[a55_0x4558b2(0x161)](_0x5af94e,_0x17ef9a){const _0x4cb073=a55_0x4558b2,_0xc738a9={..._0x17ef9a};_0x17ef9a[_0x4cb073(0x193)]&&(_0xc738a9[_0x4cb073(0x193)]=await bcryptjs_1[_0x4cb073(0x167)]['hash'](_0x17ef9a['password'],0xc));_0x17ef9a[_0x4cb073(0x18b)]&&(_0xc738a9['name']=_0x17ef9a[_0x4cb073(0x18b)],delete _0xc738a9[_0x4cb073(0x18b)]);_0x17ef9a[_0x4cb073(0x177)]&&(_0xc738a9[_0x4cb073(0x183)]=_0x17ef9a[_0x4cb073(0x177)],delete _0xc738a9['telegramId']);_0x17ef9a['merchantUrl']&&(_0xc738a9[_0x4cb073(0x191)]=_0x17ef9a[_0x4cb073(0x18f)],delete _0xc738a9[_0x4cb073(0x18f)]);_0x17ef9a[_0x4cb073(0x184)]&&(_0xc738a9[_0x4cb073(0x173)]=JSON[_0x4cb073(0x187)](_0x17ef9a[_0x4cb073(0x184)]),delete _0xc738a9[_0x4cb073(0x184)]);_0x17ef9a[_0x4cb073(0x188)]&&(_0xc738a9['gatewaySettings']=JSON[_0x4cb073(0x187)](_0x17ef9a[_0x4cb073(0x188)]),delete _0xc738a9[_0x4cb073(0x188)]);_0x17ef9a['wallets']&&(_0x17ef9a['wallets'][_0x4cb073(0x170)]!==undefined&&(_0xc738a9[_0x4cb073(0x170)]=_0x17ef9a[_0x4cb073(0x15f)][_0x4cb073(0x170)]||null),_0x17ef9a[_0x4cb073(0x15f)][_0x4cb073(0x164)]!==undefined&&(_0xc738a9[_0x4cb073(0x164)]=_0x17ef9a['wallets'][_0x4cb073(0x164)]||null),_0x17ef9a['wallets'][_0x4cb073(0x196)]!==undefined&&(_0xc738a9[_0x4cb073(0x196)]=_0x17ef9a[_0x4cb073(0x15f)]['usdtErcWallet']||null),_0x17ef9a[_0x4cb073(0x15f)][_0x4cb073(0x16e)]!==undefined&&(_0xc738a9['usdcPolygonWallet']=_0x17ef9a[_0x4cb073(0x15f)]['usdcPolygonWallet']||null),delete _0xc738a9['wallets']);const _0x5c03b6=await database_1['default'][_0x4cb073(0x172)][_0x4cb073(0x17a)]({'where':{'id':_0x5af94e},'data':_0xc738a9,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x5c03b6['id'],'fullName':_0x5c03b6[_0x4cb073(0x16c)],'username':_0x5c03b6[_0x4cb073(0x169)],'telegramId':_0x5c03b6[_0x4cb073(0x183)],'merchantUrl':_0x5c03b6[_0x4cb073(0x191)],'gateways':_0x5c03b6[_0x4cb073(0x173)]?JSON['parse'](_0x5c03b6[_0x4cb073(0x173)]):null,'gatewaySettings':_0x5c03b6[_0x4cb073(0x188)]?JSON['parse'](_0x5c03b6[_0x4cb073(0x188)]):null,'publicKey':_0x5c03b6[_0x4cb073(0x18c)],'wallets':{'usdtPolygonWallet':_0x5c03b6[_0x4cb073(0x170)],'usdtTrcWallet':_0x5c03b6['usdtTrcWallet'],'usdtErcWallet':_0x5c03b6['usdtErcWallet'],'usdcPolygonWallet':_0x5c03b6[_0x4cb073(0x16e)]},'status':_0x5c03b6[_0x4cb073(0x171)],'createdAt':_0x5c03b6[_0x4cb073(0x197)]};}async[a55_0x4558b2(0x16b)](_0x532ffb){const _0xeaaf43=a55_0x4558b2;await database_1[_0xeaaf43(0x167)][_0xeaaf43(0x172)][_0xeaaf43(0x163)]({'where':{'id':_0x532ffb}});}}exports[a55_0x4558b2(0x162)]=UserService;