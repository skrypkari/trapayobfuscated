'use strict';const a64_0x2672de=a64_0x36da;function a64_0x36da(_0x8359f1,_0x250d6b){const _0x5b8fff=a64_0x5b8f();return a64_0x36da=function(_0x36daf4,_0x158e16){_0x36daf4=_0x36daf4-0xc6;let _0xa277a6=_0x5b8fff[_0x36daf4];return _0xa277a6;},a64_0x36da(_0x8359f1,_0x250d6b);}(function(_0x373829,_0x5e1df2){const _0x4f1833=a64_0x36da,_0x457676=_0x373829();while(!![]){try{const _0x4cb5a0=-parseInt(_0x4f1833(0xc8))/0x1+-parseInt(_0x4f1833(0xeb))/0x2*(parseInt(_0x4f1833(0xf2))/0x3)+parseInt(_0x4f1833(0xe3))/0x4*(-parseInt(_0x4f1833(0xee))/0x5)+-parseInt(_0x4f1833(0xed))/0x6+parseInt(_0x4f1833(0xe4))/0x7*(parseInt(_0x4f1833(0xfb))/0x8)+parseInt(_0x4f1833(0xf3))/0x9+parseInt(_0x4f1833(0xd2))/0xa*(parseInt(_0x4f1833(0xff))/0xb);if(_0x4cb5a0===_0x5e1df2)break;else _0x457676['push'](_0x457676['shift']());}catch(_0x5cde76){_0x457676['push'](_0x457676['shift']());}}}(a64_0x5b8f,0x93086));function a64_0x5b8f(){const _0x418024=['stringify','map','usdtPolygonWallet','11498619YEXohn','generateApiKeys','merchantUrl','usdtTrcWallet','hash','119299wctDSw','createdAt','hex','telegram','usdcPolygonWallet','getAllUsers','updateUser','password','gatewaySettings','toString','10jHxoum','../config/database','delete','shopUrl','shop','fullName','parse','publicKey','telegramId','bcryptjs','gateways','findMany','name','wallets','getUserById','username','update','332EAgYAe','2863WnHDXh','pk_','paymentGateways','__importDefault','__esModule','create','findUnique','384ASrJwf','Telegram\x20username\x20already\x20exists','473844usRsIF','71770XKJlxw','usdtErcWallet','status','Username\x20already\x20exists','6516XDNlGC','2160657liUvbP','ACTIVE','randomBytes','desc','defineProperty','UserService','default','createUser','21976ohFqGl'];a64_0x5b8f=function(){return _0x418024;};return a64_0x5b8f();}var __importDefault=this&&this[a64_0x2672de(0xe7)]||function(_0x1db41e){const _0x89474e=a64_0x2672de;return _0x1db41e&&_0x1db41e[_0x89474e(0xe8)]?_0x1db41e:{'default':_0x1db41e};};Object[a64_0x2672de(0xf7)](exports,a64_0x2672de(0xe8),{'value':!![]}),exports['UserService']=void 0x0;const bcryptjs_1=__importDefault(require(a64_0x2672de(0xdb))),crypto_1=__importDefault(require('crypto')),database_1=__importDefault(require(a64_0x2672de(0xd3)));class UserService{[a64_0x2672de(0x100)](){const _0x11f49d=a64_0x2672de,_0xbdd19d=_0x11f49d(0xe5)+crypto_1[_0x11f49d(0xf9)]['randomBytes'](0x20)[_0x11f49d(0xd1)]('hex'),_0x4efaf8='sk_'+crypto_1[_0x11f49d(0xf9)][_0x11f49d(0xf5)](0x20)[_0x11f49d(0xd1)](_0x11f49d(0xca));return{'publicKey':_0xbdd19d,'secretKey':_0x4efaf8};}async[a64_0x2672de(0xfa)](_0x20d88e){const _0x25b36c=a64_0x2672de,{fullName:_0x42cb37,username:_0x51b644,password:_0x3a6d6c,telegramId:_0x2b27aa,merchantUrl:_0x7adbe3,gateways:_0x1d5c88,gatewaySettings:_0x3cc3cf,wallets:_0xf317eb}=_0x20d88e,_0x28a225=await database_1[_0x25b36c(0xf9)][_0x25b36c(0xd6)]['findUnique']({'where':{'username':_0x51b644}});if(_0x28a225)throw new Error(_0x25b36c(0xf1));if(_0x2b27aa){const _0x25e7d8=await database_1[_0x25b36c(0xf9)][_0x25b36c(0xd6)][_0x25b36c(0xea)]({'where':{'telegram':_0x2b27aa}});if(_0x25e7d8)throw new Error(_0x25b36c(0xec));}const _0x597e92=await bcryptjs_1[_0x25b36c(0xf9)][_0x25b36c(0xc7)](_0x3a6d6c,0xc),{publicKey:_0x1cf1f9,secretKey:_0x373102}=this[_0x25b36c(0x100)](),_0x43a343=await database_1[_0x25b36c(0xf9)]['shop'][_0x25b36c(0xe9)]({'data':{'name':_0x42cb37,'username':_0x51b644,'password':_0x597e92,'telegram':_0x2b27aa,'shopUrl':_0x7adbe3,'paymentGateways':_0x1d5c88?JSON[_0x25b36c(0xfc)](_0x1d5c88):null,'gatewaySettings':_0x3cc3cf?JSON['stringify'](_0x3cc3cf):null,'usdtPolygonWallet':_0xf317eb?.['usdtPolygonWallet']||null,'usdtTrcWallet':_0xf317eb?.[_0x25b36c(0xc6)]||null,'usdtErcWallet':_0xf317eb?.[_0x25b36c(0xef)]||null,'usdcPolygonWallet':_0xf317eb?.[_0x25b36c(0xcc)]||null,'publicKey':_0x1cf1f9,'secretKey':_0x373102,'status':_0x25b36c(0xf4)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x43a343['id'],'fullName':_0x43a343[_0x25b36c(0xde)],'username':_0x43a343[_0x25b36c(0xe1)],'telegramId':_0x43a343[_0x25b36c(0xcb)],'merchantUrl':_0x43a343[_0x25b36c(0xd5)],'gateways':_0x43a343[_0x25b36c(0xe6)]?JSON[_0x25b36c(0xd8)](_0x43a343[_0x25b36c(0xe6)]):null,'gatewaySettings':_0x43a343['gatewaySettings']?JSON[_0x25b36c(0xd8)](_0x43a343[_0x25b36c(0xd0)]):null,'publicKey':_0x43a343['publicKey'],'wallets':{'usdtPolygonWallet':_0x43a343['usdtPolygonWallet'],'usdtTrcWallet':_0x43a343[_0x25b36c(0xc6)],'usdtErcWallet':_0x43a343[_0x25b36c(0xef)],'usdcPolygonWallet':_0x43a343[_0x25b36c(0xcc)]},'status':_0x43a343['status'],'createdAt':_0x43a343[_0x25b36c(0xc9)]};}async[a64_0x2672de(0xcd)](){const _0x37ef76=a64_0x2672de,_0x2c72a2=await database_1['default'][_0x37ef76(0xd6)][_0x37ef76(0xdd)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x37ef76(0xf6)}});return _0x2c72a2[_0x37ef76(0xfd)](_0x3fa272=>({'id':_0x3fa272['id'],'fullName':_0x3fa272[_0x37ef76(0xde)],'username':_0x3fa272['username'],'telegramId':_0x3fa272[_0x37ef76(0xcb)],'merchantUrl':_0x3fa272[_0x37ef76(0xd5)],'gateways':_0x3fa272['paymentGateways']?JSON[_0x37ef76(0xd8)](_0x3fa272[_0x37ef76(0xe6)]):null,'gatewaySettings':_0x3fa272[_0x37ef76(0xd0)]?JSON[_0x37ef76(0xd8)](_0x3fa272[_0x37ef76(0xd0)]):null,'publicKey':_0x3fa272[_0x37ef76(0xd9)],'wallets':{'usdtPolygonWallet':_0x3fa272[_0x37ef76(0xfe)],'usdtTrcWallet':_0x3fa272[_0x37ef76(0xc6)],'usdtErcWallet':_0x3fa272[_0x37ef76(0xef)],'usdcPolygonWallet':_0x3fa272[_0x37ef76(0xcc)]},'status':_0x3fa272['status'],'createdAt':_0x3fa272[_0x37ef76(0xc9)]}));}async[a64_0x2672de(0xe0)](_0x3d9303){const _0x3413cb=a64_0x2672de,_0x1bd941=await database_1[_0x3413cb(0xf9)][_0x3413cb(0xd6)][_0x3413cb(0xea)]({'where':{'id':_0x3d9303},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x1bd941)return null;return{'id':_0x1bd941['id'],'fullName':_0x1bd941[_0x3413cb(0xde)],'username':_0x1bd941[_0x3413cb(0xe1)],'telegramId':_0x1bd941[_0x3413cb(0xcb)],'merchantUrl':_0x1bd941[_0x3413cb(0xd5)],'gateways':_0x1bd941[_0x3413cb(0xe6)]?JSON[_0x3413cb(0xd8)](_0x1bd941[_0x3413cb(0xe6)]):null,'gatewaySettings':_0x1bd941[_0x3413cb(0xd0)]?JSON['parse'](_0x1bd941[_0x3413cb(0xd0)]):null,'publicKey':_0x1bd941['publicKey'],'wallets':{'usdtPolygonWallet':_0x1bd941[_0x3413cb(0xfe)],'usdtTrcWallet':_0x1bd941[_0x3413cb(0xc6)],'usdtErcWallet':_0x1bd941[_0x3413cb(0xef)],'usdcPolygonWallet':_0x1bd941[_0x3413cb(0xcc)]},'status':_0x1bd941[_0x3413cb(0xf0)],'createdAt':_0x1bd941['createdAt']};}async[a64_0x2672de(0xce)](_0x1838a4,_0x1169d8){const _0xcf27e5=a64_0x2672de,_0x2a2117={..._0x1169d8};_0x1169d8['password']&&(_0x2a2117[_0xcf27e5(0xcf)]=await bcryptjs_1[_0xcf27e5(0xf9)]['hash'](_0x1169d8[_0xcf27e5(0xcf)],0xc));_0x1169d8['fullName']&&(_0x2a2117['name']=_0x1169d8[_0xcf27e5(0xd7)],delete _0x2a2117[_0xcf27e5(0xd7)]);_0x1169d8['telegramId']&&(_0x2a2117['telegram']=_0x1169d8[_0xcf27e5(0xda)],delete _0x2a2117[_0xcf27e5(0xda)]);_0x1169d8[_0xcf27e5(0x101)]&&(_0x2a2117[_0xcf27e5(0xd5)]=_0x1169d8[_0xcf27e5(0x101)],delete _0x2a2117[_0xcf27e5(0x101)]);_0x1169d8[_0xcf27e5(0xdc)]&&(_0x2a2117['paymentGateways']=JSON[_0xcf27e5(0xfc)](_0x1169d8[_0xcf27e5(0xdc)]),delete _0x2a2117[_0xcf27e5(0xdc)]);_0x1169d8[_0xcf27e5(0xd0)]&&(_0x2a2117[_0xcf27e5(0xd0)]=JSON[_0xcf27e5(0xfc)](_0x1169d8[_0xcf27e5(0xd0)]),delete _0x2a2117[_0xcf27e5(0xd0)]);_0x1169d8[_0xcf27e5(0xdf)]&&(_0x1169d8[_0xcf27e5(0xdf)]['usdtPolygonWallet']!==undefined&&(_0x2a2117[_0xcf27e5(0xfe)]=_0x1169d8[_0xcf27e5(0xdf)][_0xcf27e5(0xfe)]||null),_0x1169d8[_0xcf27e5(0xdf)][_0xcf27e5(0xc6)]!==undefined&&(_0x2a2117['usdtTrcWallet']=_0x1169d8[_0xcf27e5(0xdf)][_0xcf27e5(0xc6)]||null),_0x1169d8[_0xcf27e5(0xdf)]['usdtErcWallet']!==undefined&&(_0x2a2117[_0xcf27e5(0xef)]=_0x1169d8['wallets'][_0xcf27e5(0xef)]||null),_0x1169d8[_0xcf27e5(0xdf)][_0xcf27e5(0xcc)]!==undefined&&(_0x2a2117[_0xcf27e5(0xcc)]=_0x1169d8[_0xcf27e5(0xdf)][_0xcf27e5(0xcc)]||null),delete _0x2a2117[_0xcf27e5(0xdf)]);const _0x15240b=await database_1[_0xcf27e5(0xf9)][_0xcf27e5(0xd6)][_0xcf27e5(0xe2)]({'where':{'id':_0x1838a4},'data':_0x2a2117,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x15240b['id'],'fullName':_0x15240b[_0xcf27e5(0xde)],'username':_0x15240b[_0xcf27e5(0xe1)],'telegramId':_0x15240b[_0xcf27e5(0xcb)],'merchantUrl':_0x15240b[_0xcf27e5(0xd5)],'gateways':_0x15240b[_0xcf27e5(0xe6)]?JSON[_0xcf27e5(0xd8)](_0x15240b[_0xcf27e5(0xe6)]):null,'gatewaySettings':_0x15240b[_0xcf27e5(0xd0)]?JSON['parse'](_0x15240b[_0xcf27e5(0xd0)]):null,'publicKey':_0x15240b[_0xcf27e5(0xd9)],'wallets':{'usdtPolygonWallet':_0x15240b[_0xcf27e5(0xfe)],'usdtTrcWallet':_0x15240b[_0xcf27e5(0xc6)],'usdtErcWallet':_0x15240b[_0xcf27e5(0xef)],'usdcPolygonWallet':_0x15240b[_0xcf27e5(0xcc)]},'status':_0x15240b[_0xcf27e5(0xf0)],'createdAt':_0x15240b[_0xcf27e5(0xc9)]};}async['deleteUser'](_0x16f628){const _0x2867e8=a64_0x2672de;await database_1['default'][_0x2867e8(0xd6)][_0x2867e8(0xd4)]({'where':{'id':_0x16f628}});}}exports[a64_0x2672de(0xf8)]=UserService;