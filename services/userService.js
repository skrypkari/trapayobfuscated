'use strict';const a57_0x512864=a57_0x1da5;function a57_0x1da5(_0x331c48,_0x4eba9d){const _0x5e51fa=a57_0x5e51();return a57_0x1da5=function(_0x1da501,_0x2b39f2){_0x1da501=_0x1da501-0x69;let _0x2265e4=_0x5e51fa[_0x1da501];return _0x2265e4;},a57_0x1da5(_0x331c48,_0x4eba9d);}(function(_0x535028,_0x2935fc){const _0x3700e4=a57_0x1da5,_0x3eddeb=_0x535028();while(!![]){try{const _0x39bdcf=parseInt(_0x3700e4(0x84))/0x1*(-parseInt(_0x3700e4(0x80))/0x2)+parseInt(_0x3700e4(0x7e))/0x3*(-parseInt(_0x3700e4(0x7b))/0x4)+-parseInt(_0x3700e4(0xa1))/0x5+-parseInt(_0x3700e4(0x94))/0x6+-parseInt(_0x3700e4(0x86))/0x7+-parseInt(_0x3700e4(0xa4))/0x8*(parseInt(_0x3700e4(0x8f))/0x9)+parseInt(_0x3700e4(0x92))/0xa*(parseInt(_0x3700e4(0x6d))/0xb);if(_0x39bdcf===_0x2935fc)break;else _0x3eddeb['push'](_0x3eddeb['shift']());}catch(_0x4fe367){_0x3eddeb['push'](_0x3eddeb['shift']());}}}(a57_0x5e51,0xd2463));var __importDefault=this&&this[a57_0x512864(0x98)]||function(_0x1c676b){const _0x3ca7a8=a57_0x512864;return _0x1c676b&&_0x1c676b[_0x3ca7a8(0x9f)]?_0x1c676b:{'default':_0x1c676b};};Object[a57_0x512864(0x9a)](exports,a57_0x512864(0x9f),{'value':!![]}),exports[a57_0x512864(0x6a)]=void 0x0;function a57_0x5e51(){const _0x527580=['bcryptjs','617kpPPZF','updateUser','4309249YtadcN','telegramId','getAllUsers','username','telegram','name','Username\x20already\x20exists','createdAt','shop','2687562OgWJTD','merchantUrl','paymentGateways','61739560bgwjKG','default','8141598XPWfEX','hash','shopUrl','usdtErcWallet','__importDefault','wallets','defineProperty','deleteUser','delete','publicKey','crypto','__esModule','pk_','433685OfBeUd','createUser','usdtPolygonWallet','40eWrITq','stringify','UserService','map','gatewaySettings','11KsGMWa','randomBytes','generateApiKeys','parse','gateways','password','usdtTrcWallet','update','hex','create','../config/database','status','findMany','ACTIVE','44Ixdgfn','fullName','getUserById','41733JGRBIE','findUnique','5210PSPaFo','usdcPolygonWallet','toString'];a57_0x5e51=function(){return _0x527580;};return a57_0x5e51();}const bcryptjs_1=__importDefault(require(a57_0x512864(0x83))),crypto_1=__importDefault(require(a57_0x512864(0x9e))),database_1=__importDefault(require(a57_0x512864(0x77)));class UserService{[a57_0x512864(0x6f)](){const _0x11368e=a57_0x512864,_0xcb6131=_0x11368e(0xa0)+crypto_1[_0x11368e(0x93)][_0x11368e(0x6e)](0x20)[_0x11368e(0x82)](_0x11368e(0x75)),_0x465bcb='sk_'+crypto_1['default'][_0x11368e(0x6e)](0x20)[_0x11368e(0x82)](_0x11368e(0x75));return{'publicKey':_0xcb6131,'secretKey':_0x465bcb};}async[a57_0x512864(0xa2)](_0x499e5e){const _0x29b817=a57_0x512864,{fullName:_0x27e8e1,username:_0x4f7f64,password:_0x7acb1a,telegramId:_0x4fdebf,merchantUrl:_0xc230b5,gateways:_0xd6c0cc,gatewaySettings:_0x34f017,wallets:_0x1f9e2e}=_0x499e5e,_0x1f6adc=await database_1[_0x29b817(0x93)]['shop']['findUnique']({'where':{'username':_0x4f7f64}});if(_0x1f6adc)throw new Error(_0x29b817(0x8c));if(_0x4fdebf){const _0x21e125=await database_1[_0x29b817(0x93)][_0x29b817(0x8e)][_0x29b817(0x7f)]({'where':{'telegram':_0x4fdebf}});if(_0x21e125)throw new Error('Telegram\x20username\x20already\x20exists');}const _0x426dfd=await bcryptjs_1[_0x29b817(0x93)][_0x29b817(0x95)](_0x7acb1a,0xc),{publicKey:_0x224455,secretKey:_0x5059b6}=this[_0x29b817(0x6f)](),_0x152015=await database_1['default'][_0x29b817(0x8e)][_0x29b817(0x76)]({'data':{'name':_0x27e8e1,'username':_0x4f7f64,'password':_0x426dfd,'telegram':_0x4fdebf,'shopUrl':_0xc230b5,'paymentGateways':_0xd6c0cc?JSON[_0x29b817(0x69)](_0xd6c0cc):null,'gatewaySettings':_0x34f017?JSON[_0x29b817(0x69)](_0x34f017):null,'usdtPolygonWallet':_0x1f9e2e?.[_0x29b817(0xa3)]||null,'usdtTrcWallet':_0x1f9e2e?.[_0x29b817(0x73)]||null,'usdtErcWallet':_0x1f9e2e?.['usdtErcWallet']||null,'usdcPolygonWallet':_0x1f9e2e?.[_0x29b817(0x81)]||null,'publicKey':_0x224455,'secretKey':_0x5059b6,'status':_0x29b817(0x7a)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x152015['id'],'fullName':_0x152015['name'],'username':_0x152015[_0x29b817(0x89)],'telegramId':_0x152015['telegram'],'merchantUrl':_0x152015[_0x29b817(0x96)],'gateways':_0x152015[_0x29b817(0x91)]?JSON[_0x29b817(0x70)](_0x152015[_0x29b817(0x91)]):null,'gatewaySettings':_0x152015[_0x29b817(0x6c)]?JSON[_0x29b817(0x70)](_0x152015[_0x29b817(0x6c)]):null,'publicKey':_0x152015[_0x29b817(0x9d)],'wallets':{'usdtPolygonWallet':_0x152015[_0x29b817(0xa3)],'usdtTrcWallet':_0x152015[_0x29b817(0x73)],'usdtErcWallet':_0x152015[_0x29b817(0x97)],'usdcPolygonWallet':_0x152015['usdcPolygonWallet']},'status':_0x152015[_0x29b817(0x78)],'createdAt':_0x152015[_0x29b817(0x8d)]};}async[a57_0x512864(0x88)](){const _0x37a821=a57_0x512864,_0x4b0306=await database_1[_0x37a821(0x93)][_0x37a821(0x8e)][_0x37a821(0x79)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':'desc'}});return _0x4b0306[_0x37a821(0x6b)](_0x96f501=>({'id':_0x96f501['id'],'fullName':_0x96f501[_0x37a821(0x8b)],'username':_0x96f501[_0x37a821(0x89)],'telegramId':_0x96f501['telegram'],'merchantUrl':_0x96f501['shopUrl'],'gateways':_0x96f501[_0x37a821(0x91)]?JSON[_0x37a821(0x70)](_0x96f501[_0x37a821(0x91)]):null,'gatewaySettings':_0x96f501[_0x37a821(0x6c)]?JSON[_0x37a821(0x70)](_0x96f501[_0x37a821(0x6c)]):null,'publicKey':_0x96f501['publicKey'],'wallets':{'usdtPolygonWallet':_0x96f501[_0x37a821(0xa3)],'usdtTrcWallet':_0x96f501[_0x37a821(0x73)],'usdtErcWallet':_0x96f501[_0x37a821(0x97)],'usdcPolygonWallet':_0x96f501[_0x37a821(0x81)]},'status':_0x96f501[_0x37a821(0x78)],'createdAt':_0x96f501['createdAt']}));}async[a57_0x512864(0x7d)](_0x350856){const _0x20fcea=a57_0x512864,_0x1e817b=await database_1[_0x20fcea(0x93)][_0x20fcea(0x8e)]['findUnique']({'where':{'id':_0x350856},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x1e817b)return null;return{'id':_0x1e817b['id'],'fullName':_0x1e817b[_0x20fcea(0x8b)],'username':_0x1e817b[_0x20fcea(0x89)],'telegramId':_0x1e817b[_0x20fcea(0x8a)],'merchantUrl':_0x1e817b[_0x20fcea(0x96)],'gateways':_0x1e817b['paymentGateways']?JSON[_0x20fcea(0x70)](_0x1e817b[_0x20fcea(0x91)]):null,'gatewaySettings':_0x1e817b[_0x20fcea(0x6c)]?JSON[_0x20fcea(0x70)](_0x1e817b[_0x20fcea(0x6c)]):null,'publicKey':_0x1e817b[_0x20fcea(0x9d)],'wallets':{'usdtPolygonWallet':_0x1e817b[_0x20fcea(0xa3)],'usdtTrcWallet':_0x1e817b['usdtTrcWallet'],'usdtErcWallet':_0x1e817b['usdtErcWallet'],'usdcPolygonWallet':_0x1e817b[_0x20fcea(0x81)]},'status':_0x1e817b[_0x20fcea(0x78)],'createdAt':_0x1e817b[_0x20fcea(0x8d)]};}async[a57_0x512864(0x85)](_0x4fe3c3,_0x53a5a9){const _0x3382b6=a57_0x512864,_0x200609={..._0x53a5a9};_0x53a5a9[_0x3382b6(0x72)]&&(_0x200609[_0x3382b6(0x72)]=await bcryptjs_1[_0x3382b6(0x93)]['hash'](_0x53a5a9[_0x3382b6(0x72)],0xc));_0x53a5a9[_0x3382b6(0x7c)]&&(_0x200609[_0x3382b6(0x8b)]=_0x53a5a9[_0x3382b6(0x7c)],delete _0x200609[_0x3382b6(0x7c)]);_0x53a5a9['telegramId']&&(_0x200609[_0x3382b6(0x8a)]=_0x53a5a9[_0x3382b6(0x87)],delete _0x200609[_0x3382b6(0x87)]);_0x53a5a9['merchantUrl']&&(_0x200609[_0x3382b6(0x96)]=_0x53a5a9[_0x3382b6(0x90)],delete _0x200609[_0x3382b6(0x90)]);_0x53a5a9[_0x3382b6(0x71)]&&(_0x200609[_0x3382b6(0x91)]=JSON[_0x3382b6(0x69)](_0x53a5a9['gateways']),delete _0x200609[_0x3382b6(0x71)]);_0x53a5a9[_0x3382b6(0x6c)]&&(_0x200609[_0x3382b6(0x6c)]=JSON[_0x3382b6(0x69)](_0x53a5a9[_0x3382b6(0x6c)]),delete _0x200609[_0x3382b6(0x6c)]);_0x53a5a9[_0x3382b6(0x99)]&&(_0x53a5a9['wallets'][_0x3382b6(0xa3)]!==undefined&&(_0x200609['usdtPolygonWallet']=_0x53a5a9[_0x3382b6(0x99)][_0x3382b6(0xa3)]||null),_0x53a5a9['wallets'][_0x3382b6(0x73)]!==undefined&&(_0x200609['usdtTrcWallet']=_0x53a5a9[_0x3382b6(0x99)][_0x3382b6(0x73)]||null),_0x53a5a9[_0x3382b6(0x99)][_0x3382b6(0x97)]!==undefined&&(_0x200609[_0x3382b6(0x97)]=_0x53a5a9[_0x3382b6(0x99)]['usdtErcWallet']||null),_0x53a5a9[_0x3382b6(0x99)][_0x3382b6(0x81)]!==undefined&&(_0x200609['usdcPolygonWallet']=_0x53a5a9[_0x3382b6(0x99)]['usdcPolygonWallet']||null),delete _0x200609[_0x3382b6(0x99)]);const _0x110533=await database_1[_0x3382b6(0x93)][_0x3382b6(0x8e)][_0x3382b6(0x74)]({'where':{'id':_0x4fe3c3},'data':_0x200609,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x110533['id'],'fullName':_0x110533[_0x3382b6(0x8b)],'username':_0x110533[_0x3382b6(0x89)],'telegramId':_0x110533[_0x3382b6(0x8a)],'merchantUrl':_0x110533[_0x3382b6(0x96)],'gateways':_0x110533[_0x3382b6(0x91)]?JSON[_0x3382b6(0x70)](_0x110533[_0x3382b6(0x91)]):null,'gatewaySettings':_0x110533['gatewaySettings']?JSON[_0x3382b6(0x70)](_0x110533['gatewaySettings']):null,'publicKey':_0x110533[_0x3382b6(0x9d)],'wallets':{'usdtPolygonWallet':_0x110533[_0x3382b6(0xa3)],'usdtTrcWallet':_0x110533[_0x3382b6(0x73)],'usdtErcWallet':_0x110533[_0x3382b6(0x97)],'usdcPolygonWallet':_0x110533[_0x3382b6(0x81)]},'status':_0x110533['status'],'createdAt':_0x110533[_0x3382b6(0x8d)]};}async[a57_0x512864(0x9b)](_0x115296){const _0x1a4083=a57_0x512864;await database_1[_0x1a4083(0x93)]['shop'][_0x1a4083(0x9c)]({'where':{'id':_0x115296}});}}exports[a57_0x512864(0x6a)]=UserService;