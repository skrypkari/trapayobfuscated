'use strict';const a61_0x3c48f0=a61_0x4cc4;(function(_0x2733ba,_0x143c5f){const _0x48e583=a61_0x4cc4,_0x28ea7f=_0x2733ba();while(!![]){try{const _0x17b6fc=-parseInt(_0x48e583(0x1f7))/0x1+-parseInt(_0x48e583(0x1df))/0x2+-parseInt(_0x48e583(0x1d6))/0x3+-parseInt(_0x48e583(0x1cb))/0x4+parseInt(_0x48e583(0x1e1))/0x5*(parseInt(_0x48e583(0x1e8))/0x6)+parseInt(_0x48e583(0x1fa))/0x7*(parseInt(_0x48e583(0x1c3))/0x8)+parseInt(_0x48e583(0x1c9))/0x9;if(_0x17b6fc===_0x143c5f)break;else _0x28ea7f['push'](_0x28ea7f['shift']());}catch(_0x1c282e){_0x28ea7f['push'](_0x28ea7f['shift']());}}}(a61_0x1459,0x54871));function a61_0x4cc4(_0x3e2a4b,_0x2b1e59){const _0x14592f=a61_0x1459();return a61_0x4cc4=function(_0x4cc40d,_0x130410){_0x4cc40d=_0x4cc40d-0x1c3;let _0x3b526d=_0x14592f[_0x4cc40d];return _0x3b526d;},a61_0x4cc4(_0x3e2a4b,_0x2b1e59);}var __importDefault=this&&this[a61_0x3c48f0(0x1ee)]||function(_0x2bf27b){return _0x2bf27b&&_0x2bf27b['__esModule']?_0x2bf27b:{'default':_0x2bf27b};};Object[a61_0x3c48f0(0x1e0)](exports,a61_0x3c48f0(0x1c4),{'value':!![]}),exports[a61_0x3c48f0(0x1ca)]=void 0x0;function a61_0x1459(){const _0x572b84=['findMany','desc','../config/database','toString','password','6EFpSSc','getUserById','getAllUsers','hash','username','stringify','__importDefault','Username\x20already\x20exists','gatewaySettings','map','bcryptjs','usdtTrcWallet','status','Telegram\x20username\x20already\x20exists','createUser','655330zyHnOF','shopUrl','fullName','665QIsZJs','46088mcBrZn','__esModule','hex','shop','usdcPolygonWallet','gateways','9748629aTqUQE','UserService','2082484SwoSMA','usdtErcWallet','name','telegramId','merchantUrl','wallets','deleteUser','randomBytes','publicKey','paymentGateways','usdtPolygonWallet','1862631UdewEm','update','telegram','generateApiKeys','createdAt','default','create','parse','sk_','286698wFBaLz','defineProperty','3279630deQDFK','findUnique'];a61_0x1459=function(){return _0x572b84;};return a61_0x1459();}const bcryptjs_1=__importDefault(require(a61_0x3c48f0(0x1f2))),crypto_1=__importDefault(require('crypto')),database_1=__importDefault(require(a61_0x3c48f0(0x1e5)));class UserService{[a61_0x3c48f0(0x1d9)](){const _0x2137b9=a61_0x3c48f0,_0x3c2f42='pk_'+crypto_1[_0x2137b9(0x1db)][_0x2137b9(0x1d2)](0x20)[_0x2137b9(0x1e6)](_0x2137b9(0x1c5)),_0x153b88=_0x2137b9(0x1de)+crypto_1[_0x2137b9(0x1db)][_0x2137b9(0x1d2)](0x20)['toString'](_0x2137b9(0x1c5));return{'publicKey':_0x3c2f42,'secretKey':_0x153b88};}async[a61_0x3c48f0(0x1f6)](_0x264cae){const _0x54bd9f=a61_0x3c48f0,{fullName:_0x1662e6,username:_0x51466a,password:_0x388aab,telegramId:_0x5a36b4,merchantUrl:_0x251fdf,gateways:_0x1243df,gatewaySettings:_0x26bb59,wallets:_0x51c047}=_0x264cae,_0x2caaaf=await database_1['default'][_0x54bd9f(0x1c6)]['findUnique']({'where':{'username':_0x51466a}});if(_0x2caaaf)throw new Error(_0x54bd9f(0x1ef));if(_0x5a36b4){const _0x558dd9=await database_1['default']['shop'][_0x54bd9f(0x1e2)]({'where':{'telegram':_0x5a36b4}});if(_0x558dd9)throw new Error(_0x54bd9f(0x1f5));}const _0x52d389=await bcryptjs_1[_0x54bd9f(0x1db)][_0x54bd9f(0x1eb)](_0x388aab,0xc),{publicKey:_0x12d187,secretKey:_0x1f1425}=this[_0x54bd9f(0x1d9)](),_0x252dfd=await database_1[_0x54bd9f(0x1db)]['shop'][_0x54bd9f(0x1dc)]({'data':{'name':_0x1662e6,'username':_0x51466a,'password':_0x52d389,'telegram':_0x5a36b4,'shopUrl':_0x251fdf,'paymentGateways':_0x1243df?JSON[_0x54bd9f(0x1ed)](_0x1243df):null,'gatewaySettings':_0x26bb59?JSON[_0x54bd9f(0x1ed)](_0x26bb59):null,'usdtPolygonWallet':_0x51c047?.[_0x54bd9f(0x1d5)]||null,'usdtTrcWallet':_0x51c047?.[_0x54bd9f(0x1f3)]||null,'usdtErcWallet':_0x51c047?.[_0x54bd9f(0x1cc)]||null,'usdcPolygonWallet':_0x51c047?.[_0x54bd9f(0x1c7)]||null,'publicKey':_0x12d187,'secretKey':_0x1f1425,'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x252dfd['id'],'fullName':_0x252dfd[_0x54bd9f(0x1cd)],'username':_0x252dfd[_0x54bd9f(0x1ec)],'telegramId':_0x252dfd['telegram'],'merchantUrl':_0x252dfd['shopUrl'],'gateways':_0x252dfd['paymentGateways']?JSON[_0x54bd9f(0x1dd)](_0x252dfd[_0x54bd9f(0x1d4)]):null,'gatewaySettings':_0x252dfd['gatewaySettings']?JSON[_0x54bd9f(0x1dd)](_0x252dfd[_0x54bd9f(0x1f0)]):null,'publicKey':_0x252dfd[_0x54bd9f(0x1d3)],'wallets':{'usdtPolygonWallet':_0x252dfd[_0x54bd9f(0x1d5)],'usdtTrcWallet':_0x252dfd[_0x54bd9f(0x1f3)],'usdtErcWallet':_0x252dfd[_0x54bd9f(0x1cc)],'usdcPolygonWallet':_0x252dfd[_0x54bd9f(0x1c7)]},'status':_0x252dfd[_0x54bd9f(0x1f4)],'createdAt':_0x252dfd[_0x54bd9f(0x1da)]};}async[a61_0x3c48f0(0x1ea)](){const _0x3d482d=a61_0x3c48f0,_0x25e5ba=await database_1[_0x3d482d(0x1db)][_0x3d482d(0x1c6)][_0x3d482d(0x1e3)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x3d482d(0x1e4)}});return _0x25e5ba[_0x3d482d(0x1f1)](_0x5a7acd=>({'id':_0x5a7acd['id'],'fullName':_0x5a7acd[_0x3d482d(0x1cd)],'username':_0x5a7acd[_0x3d482d(0x1ec)],'telegramId':_0x5a7acd[_0x3d482d(0x1d8)],'merchantUrl':_0x5a7acd[_0x3d482d(0x1f8)],'gateways':_0x5a7acd['paymentGateways']?JSON[_0x3d482d(0x1dd)](_0x5a7acd[_0x3d482d(0x1d4)]):null,'gatewaySettings':_0x5a7acd[_0x3d482d(0x1f0)]?JSON[_0x3d482d(0x1dd)](_0x5a7acd[_0x3d482d(0x1f0)]):null,'publicKey':_0x5a7acd['publicKey'],'wallets':{'usdtPolygonWallet':_0x5a7acd[_0x3d482d(0x1d5)],'usdtTrcWallet':_0x5a7acd[_0x3d482d(0x1f3)],'usdtErcWallet':_0x5a7acd['usdtErcWallet'],'usdcPolygonWallet':_0x5a7acd['usdcPolygonWallet']},'status':_0x5a7acd[_0x3d482d(0x1f4)],'createdAt':_0x5a7acd[_0x3d482d(0x1da)]}));}async[a61_0x3c48f0(0x1e9)](_0x337fd9){const _0x37e25d=a61_0x3c48f0,_0x1773a7=await database_1[_0x37e25d(0x1db)][_0x37e25d(0x1c6)]['findUnique']({'where':{'id':_0x337fd9},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x1773a7)return null;return{'id':_0x1773a7['id'],'fullName':_0x1773a7[_0x37e25d(0x1cd)],'username':_0x1773a7[_0x37e25d(0x1ec)],'telegramId':_0x1773a7[_0x37e25d(0x1d8)],'merchantUrl':_0x1773a7[_0x37e25d(0x1f8)],'gateways':_0x1773a7[_0x37e25d(0x1d4)]?JSON[_0x37e25d(0x1dd)](_0x1773a7[_0x37e25d(0x1d4)]):null,'gatewaySettings':_0x1773a7[_0x37e25d(0x1f0)]?JSON[_0x37e25d(0x1dd)](_0x1773a7[_0x37e25d(0x1f0)]):null,'publicKey':_0x1773a7[_0x37e25d(0x1d3)],'wallets':{'usdtPolygonWallet':_0x1773a7[_0x37e25d(0x1d5)],'usdtTrcWallet':_0x1773a7[_0x37e25d(0x1f3)],'usdtErcWallet':_0x1773a7[_0x37e25d(0x1cc)],'usdcPolygonWallet':_0x1773a7['usdcPolygonWallet']},'status':_0x1773a7[_0x37e25d(0x1f4)],'createdAt':_0x1773a7[_0x37e25d(0x1da)]};}async['updateUser'](_0x4b9776,_0x22f117){const _0x3d8ebe=a61_0x3c48f0,_0x452e04={..._0x22f117};_0x22f117[_0x3d8ebe(0x1e7)]&&(_0x452e04[_0x3d8ebe(0x1e7)]=await bcryptjs_1[_0x3d8ebe(0x1db)]['hash'](_0x22f117[_0x3d8ebe(0x1e7)],0xc));_0x22f117[_0x3d8ebe(0x1f9)]&&(_0x452e04[_0x3d8ebe(0x1cd)]=_0x22f117[_0x3d8ebe(0x1f9)],delete _0x452e04['fullName']);_0x22f117[_0x3d8ebe(0x1ce)]&&(_0x452e04['telegram']=_0x22f117[_0x3d8ebe(0x1ce)],delete _0x452e04['telegramId']);_0x22f117[_0x3d8ebe(0x1cf)]&&(_0x452e04[_0x3d8ebe(0x1f8)]=_0x22f117[_0x3d8ebe(0x1cf)],delete _0x452e04[_0x3d8ebe(0x1cf)]);_0x22f117['gateways']&&(_0x452e04[_0x3d8ebe(0x1d4)]=JSON[_0x3d8ebe(0x1ed)](_0x22f117[_0x3d8ebe(0x1c8)]),delete _0x452e04[_0x3d8ebe(0x1c8)]);_0x22f117[_0x3d8ebe(0x1f0)]&&(_0x452e04[_0x3d8ebe(0x1f0)]=JSON[_0x3d8ebe(0x1ed)](_0x22f117[_0x3d8ebe(0x1f0)]),delete _0x452e04[_0x3d8ebe(0x1f0)]);_0x22f117[_0x3d8ebe(0x1d0)]&&(_0x22f117[_0x3d8ebe(0x1d0)][_0x3d8ebe(0x1d5)]!==undefined&&(_0x452e04[_0x3d8ebe(0x1d5)]=_0x22f117['wallets'][_0x3d8ebe(0x1d5)]||null),_0x22f117[_0x3d8ebe(0x1d0)][_0x3d8ebe(0x1f3)]!==undefined&&(_0x452e04['usdtTrcWallet']=_0x22f117[_0x3d8ebe(0x1d0)][_0x3d8ebe(0x1f3)]||null),_0x22f117[_0x3d8ebe(0x1d0)]['usdtErcWallet']!==undefined&&(_0x452e04['usdtErcWallet']=_0x22f117[_0x3d8ebe(0x1d0)][_0x3d8ebe(0x1cc)]||null),_0x22f117[_0x3d8ebe(0x1d0)][_0x3d8ebe(0x1c7)]!==undefined&&(_0x452e04['usdcPolygonWallet']=_0x22f117[_0x3d8ebe(0x1d0)][_0x3d8ebe(0x1c7)]||null),delete _0x452e04['wallets']);const _0x2f84e0=await database_1[_0x3d8ebe(0x1db)][_0x3d8ebe(0x1c6)][_0x3d8ebe(0x1d7)]({'where':{'id':_0x4b9776},'data':_0x452e04,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x2f84e0['id'],'fullName':_0x2f84e0[_0x3d8ebe(0x1cd)],'username':_0x2f84e0[_0x3d8ebe(0x1ec)],'telegramId':_0x2f84e0['telegram'],'merchantUrl':_0x2f84e0[_0x3d8ebe(0x1f8)],'gateways':_0x2f84e0['paymentGateways']?JSON['parse'](_0x2f84e0[_0x3d8ebe(0x1d4)]):null,'gatewaySettings':_0x2f84e0[_0x3d8ebe(0x1f0)]?JSON[_0x3d8ebe(0x1dd)](_0x2f84e0[_0x3d8ebe(0x1f0)]):null,'publicKey':_0x2f84e0['publicKey'],'wallets':{'usdtPolygonWallet':_0x2f84e0[_0x3d8ebe(0x1d5)],'usdtTrcWallet':_0x2f84e0[_0x3d8ebe(0x1f3)],'usdtErcWallet':_0x2f84e0[_0x3d8ebe(0x1cc)],'usdcPolygonWallet':_0x2f84e0[_0x3d8ebe(0x1c7)]},'status':_0x2f84e0['status'],'createdAt':_0x2f84e0['createdAt']};}async[a61_0x3c48f0(0x1d1)](_0x2e3d43){const _0x5a342f=a61_0x3c48f0;await database_1['default'][_0x5a342f(0x1c6)]['delete']({'where':{'id':_0x2e3d43}});}}exports[a61_0x3c48f0(0x1ca)]=UserService;