'use strict';const a56_0x671e9a=a56_0x2e73;(function(_0x453d8b,_0x2247d6){const _0x11d80c=a56_0x2e73,_0x49746e=_0x453d8b();while(!![]){try{const _0x408261=parseInt(_0x11d80c(0x98))/0x1*(-parseInt(_0x11d80c(0xc1))/0x2)+parseInt(_0x11d80c(0x9d))/0x3+parseInt(_0x11d80c(0x90))/0x4+parseInt(_0x11d80c(0x92))/0x5+parseInt(_0x11d80c(0xac))/0x6+parseInt(_0x11d80c(0xc5))/0x7*(parseInt(_0x11d80c(0xb4))/0x8)+-parseInt(_0x11d80c(0xa2))/0x9;if(_0x408261===_0x2247d6)break;else _0x49746e['push'](_0x49746e['shift']());}catch(_0x378075){_0x49746e['push'](_0x49746e['shift']());}}}(a56_0x1e44,0x2c63b));function a56_0x2e73(_0x1694fe,_0x4648ce){const _0x1e44f6=a56_0x1e44();return a56_0x2e73=function(_0x2e73ed,_0x4a796a){_0x2e73ed=_0x2e73ed-0x8c;let _0x6cec4=_0x1e44f6[_0x2e73ed];return _0x6cec4;},a56_0x2e73(_0x1694fe,_0x4648ce);}var __importDefault=this&&this['__importDefault']||function(_0x16036e){const _0x28b86e=a56_0x2e73;return _0x16036e&&_0x16036e[_0x28b86e(0xaa)]?_0x16036e:{'default':_0x16036e};};Object[a56_0x671e9a(0xba)](exports,a56_0x671e9a(0xaa),{'value':!![]}),exports[a56_0x671e9a(0xb3)]=void 0x0;const bcryptjs_1=__importDefault(require(a56_0x671e9a(0xbb))),crypto_1=__importDefault(require(a56_0x671e9a(0xa4))),database_1=__importDefault(require(a56_0x671e9a(0xa0)));function a56_0x1e44(){const _0x5d8470=['toString','../config/database','deleteUser','6577722GKuvBu','usdcPolygonWallet','crypto','gateways','telegramId','randomBytes','wallets','hash','__esModule','update','1652274AsWlLn','findMany','default','paymentGateways','usdtPolygonWallet','shop','create','UserService','1258456XetXqw','name','findUnique','password','shopUrl','delete','defineProperty','bcryptjs','usdtErcWallet','getAllUsers','stringify','status','telegram','8102kJDsEI','gatewaySettings','Telegram\x20username\x20already\x20exists','merchantUrl','7CqVXXb','map','Username\x20already\x20exists','parse','createUser','64712HiNcbC','ACTIVE','1391995LjfGHs','hex','pk_','getUserById','publicKey','createdAt','7JcvBuu','generateApiKeys','fullName','username','usdtTrcWallet','641313dJAgrA','updateUser'];a56_0x1e44=function(){return _0x5d8470;};return a56_0x1e44();}class UserService{[a56_0x671e9a(0x99)](){const _0xca7101=a56_0x671e9a,_0x205cce=_0xca7101(0x94)+crypto_1[_0xca7101(0xae)][_0xca7101(0xa7)](0x20)[_0xca7101(0x9f)]('hex'),_0x4b414f='sk_'+crypto_1['default'][_0xca7101(0xa7)](0x20)[_0xca7101(0x9f)](_0xca7101(0x93));return{'publicKey':_0x205cce,'secretKey':_0x4b414f};}async[a56_0x671e9a(0x8f)](_0x5bdc72){const _0x25fb75=a56_0x671e9a,{fullName:_0x27c425,username:_0x2494fb,password:_0xeba9f2,telegramId:_0x1adbc7,merchantUrl:_0x552465,gateways:_0x17aeba,gatewaySettings:_0x3e9ce6,wallets:_0x14391c}=_0x5bdc72,_0x32f536=await database_1[_0x25fb75(0xae)][_0x25fb75(0xb1)][_0x25fb75(0xb6)]({'where':{'username':_0x2494fb}});if(_0x32f536)throw new Error(_0x25fb75(0x8d));if(_0x1adbc7){const _0x38f192=await database_1[_0x25fb75(0xae)][_0x25fb75(0xb1)]['findUnique']({'where':{'telegram':_0x1adbc7}});if(_0x38f192)throw new Error(_0x25fb75(0xc3));}const _0x226382=await bcryptjs_1[_0x25fb75(0xae)][_0x25fb75(0xa9)](_0xeba9f2,0xc),{publicKey:_0x105b2d,secretKey:_0x1ae182}=this['generateApiKeys'](),_0x205ea5=await database_1[_0x25fb75(0xae)][_0x25fb75(0xb1)][_0x25fb75(0xb2)]({'data':{'name':_0x27c425,'username':_0x2494fb,'password':_0x226382,'telegram':_0x1adbc7,'shopUrl':_0x552465,'paymentGateways':_0x17aeba?JSON['stringify'](_0x17aeba):null,'gatewaySettings':_0x3e9ce6?JSON[_0x25fb75(0xbe)](_0x3e9ce6):null,'usdtPolygonWallet':_0x14391c?.[_0x25fb75(0xb0)]||null,'usdtTrcWallet':_0x14391c?.[_0x25fb75(0x9c)]||null,'usdtErcWallet':_0x14391c?.[_0x25fb75(0xbc)]||null,'usdcPolygonWallet':_0x14391c?.['usdcPolygonWallet']||null,'publicKey':_0x105b2d,'secretKey':_0x1ae182,'status':_0x25fb75(0x91)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x205ea5['id'],'fullName':_0x205ea5[_0x25fb75(0xb5)],'username':_0x205ea5[_0x25fb75(0x9b)],'telegramId':_0x205ea5[_0x25fb75(0xc0)],'merchantUrl':_0x205ea5['shopUrl'],'gateways':_0x205ea5[_0x25fb75(0xaf)]?JSON[_0x25fb75(0x8e)](_0x205ea5[_0x25fb75(0xaf)]):null,'gatewaySettings':_0x205ea5[_0x25fb75(0xc2)]?JSON['parse'](_0x205ea5[_0x25fb75(0xc2)]):null,'publicKey':_0x205ea5[_0x25fb75(0x96)],'wallets':{'usdtPolygonWallet':_0x205ea5[_0x25fb75(0xb0)],'usdtTrcWallet':_0x205ea5[_0x25fb75(0x9c)],'usdtErcWallet':_0x205ea5[_0x25fb75(0xbc)],'usdcPolygonWallet':_0x205ea5[_0x25fb75(0xa3)]},'status':_0x205ea5['status'],'createdAt':_0x205ea5[_0x25fb75(0x97)]};}async[a56_0x671e9a(0xbd)](){const _0x97fb04=a56_0x671e9a,_0x277f1f=await database_1[_0x97fb04(0xae)][_0x97fb04(0xb1)][_0x97fb04(0xad)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':'desc'}});return _0x277f1f[_0x97fb04(0x8c)](_0x25c7ce=>({'id':_0x25c7ce['id'],'fullName':_0x25c7ce[_0x97fb04(0xb5)],'username':_0x25c7ce[_0x97fb04(0x9b)],'telegramId':_0x25c7ce[_0x97fb04(0xc0)],'merchantUrl':_0x25c7ce[_0x97fb04(0xb8)],'gateways':_0x25c7ce[_0x97fb04(0xaf)]?JSON[_0x97fb04(0x8e)](_0x25c7ce['paymentGateways']):null,'gatewaySettings':_0x25c7ce['gatewaySettings']?JSON[_0x97fb04(0x8e)](_0x25c7ce[_0x97fb04(0xc2)]):null,'publicKey':_0x25c7ce['publicKey'],'wallets':{'usdtPolygonWallet':_0x25c7ce[_0x97fb04(0xb0)],'usdtTrcWallet':_0x25c7ce[_0x97fb04(0x9c)],'usdtErcWallet':_0x25c7ce[_0x97fb04(0xbc)],'usdcPolygonWallet':_0x25c7ce[_0x97fb04(0xa3)]},'status':_0x25c7ce[_0x97fb04(0xbf)],'createdAt':_0x25c7ce['createdAt']}));}async[a56_0x671e9a(0x95)](_0x18be19){const _0x1a5c2e=a56_0x671e9a,_0x5cb432=await database_1['default']['shop']['findUnique']({'where':{'id':_0x18be19},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x5cb432)return null;return{'id':_0x5cb432['id'],'fullName':_0x5cb432[_0x1a5c2e(0xb5)],'username':_0x5cb432[_0x1a5c2e(0x9b)],'telegramId':_0x5cb432[_0x1a5c2e(0xc0)],'merchantUrl':_0x5cb432[_0x1a5c2e(0xb8)],'gateways':_0x5cb432[_0x1a5c2e(0xaf)]?JSON[_0x1a5c2e(0x8e)](_0x5cb432['paymentGateways']):null,'gatewaySettings':_0x5cb432[_0x1a5c2e(0xc2)]?JSON['parse'](_0x5cb432[_0x1a5c2e(0xc2)]):null,'publicKey':_0x5cb432[_0x1a5c2e(0x96)],'wallets':{'usdtPolygonWallet':_0x5cb432[_0x1a5c2e(0xb0)],'usdtTrcWallet':_0x5cb432[_0x1a5c2e(0x9c)],'usdtErcWallet':_0x5cb432['usdtErcWallet'],'usdcPolygonWallet':_0x5cb432['usdcPolygonWallet']},'status':_0x5cb432[_0x1a5c2e(0xbf)],'createdAt':_0x5cb432[_0x1a5c2e(0x97)]};}async[a56_0x671e9a(0x9e)](_0xec8530,_0x443a19){const _0x507b6e=a56_0x671e9a,_0x255eb2={..._0x443a19};_0x443a19[_0x507b6e(0xb7)]&&(_0x255eb2[_0x507b6e(0xb7)]=await bcryptjs_1[_0x507b6e(0xae)][_0x507b6e(0xa9)](_0x443a19[_0x507b6e(0xb7)],0xc));_0x443a19[_0x507b6e(0x9a)]&&(_0x255eb2[_0x507b6e(0xb5)]=_0x443a19[_0x507b6e(0x9a)],delete _0x255eb2[_0x507b6e(0x9a)]);_0x443a19[_0x507b6e(0xa6)]&&(_0x255eb2['telegram']=_0x443a19[_0x507b6e(0xa6)],delete _0x255eb2[_0x507b6e(0xa6)]);_0x443a19[_0x507b6e(0xc4)]&&(_0x255eb2[_0x507b6e(0xb8)]=_0x443a19[_0x507b6e(0xc4)],delete _0x255eb2[_0x507b6e(0xc4)]);_0x443a19[_0x507b6e(0xa5)]&&(_0x255eb2['paymentGateways']=JSON[_0x507b6e(0xbe)](_0x443a19['gateways']),delete _0x255eb2['gateways']);_0x443a19[_0x507b6e(0xc2)]&&(_0x255eb2[_0x507b6e(0xc2)]=JSON[_0x507b6e(0xbe)](_0x443a19[_0x507b6e(0xc2)]),delete _0x255eb2['gatewaySettings']);_0x443a19[_0x507b6e(0xa8)]&&(_0x443a19['wallets'][_0x507b6e(0xb0)]!==undefined&&(_0x255eb2[_0x507b6e(0xb0)]=_0x443a19[_0x507b6e(0xa8)][_0x507b6e(0xb0)]||null),_0x443a19[_0x507b6e(0xa8)][_0x507b6e(0x9c)]!==undefined&&(_0x255eb2['usdtTrcWallet']=_0x443a19[_0x507b6e(0xa8)][_0x507b6e(0x9c)]||null),_0x443a19[_0x507b6e(0xa8)]['usdtErcWallet']!==undefined&&(_0x255eb2['usdtErcWallet']=_0x443a19[_0x507b6e(0xa8)][_0x507b6e(0xbc)]||null),_0x443a19[_0x507b6e(0xa8)]['usdcPolygonWallet']!==undefined&&(_0x255eb2[_0x507b6e(0xa3)]=_0x443a19['wallets'][_0x507b6e(0xa3)]||null),delete _0x255eb2['wallets']);const _0x95ca75=await database_1[_0x507b6e(0xae)][_0x507b6e(0xb1)][_0x507b6e(0xab)]({'where':{'id':_0xec8530},'data':_0x255eb2,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x95ca75['id'],'fullName':_0x95ca75['name'],'username':_0x95ca75[_0x507b6e(0x9b)],'telegramId':_0x95ca75['telegram'],'merchantUrl':_0x95ca75[_0x507b6e(0xb8)],'gateways':_0x95ca75[_0x507b6e(0xaf)]?JSON[_0x507b6e(0x8e)](_0x95ca75[_0x507b6e(0xaf)]):null,'gatewaySettings':_0x95ca75[_0x507b6e(0xc2)]?JSON[_0x507b6e(0x8e)](_0x95ca75['gatewaySettings']):null,'publicKey':_0x95ca75[_0x507b6e(0x96)],'wallets':{'usdtPolygonWallet':_0x95ca75['usdtPolygonWallet'],'usdtTrcWallet':_0x95ca75['usdtTrcWallet'],'usdtErcWallet':_0x95ca75['usdtErcWallet'],'usdcPolygonWallet':_0x95ca75[_0x507b6e(0xa3)]},'status':_0x95ca75[_0x507b6e(0xbf)],'createdAt':_0x95ca75[_0x507b6e(0x97)]};}async[a56_0x671e9a(0xa1)](_0x49d2a1){const _0x299645=a56_0x671e9a;await database_1[_0x299645(0xae)][_0x299645(0xb1)][_0x299645(0xb9)]({'where':{'id':_0x49d2a1}});}}exports[a56_0x671e9a(0xb3)]=UserService;