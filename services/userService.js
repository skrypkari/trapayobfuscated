'use strict';const a65_0x1b66e7=a65_0x53cf;(function(_0x1d96e8,_0x3f8779){const _0x328df9=a65_0x53cf,_0x227319=_0x1d96e8();while(!![]){try{const _0x3c9b46=-parseInt(_0x328df9(0xf9))/0x1*(-parseInt(_0x328df9(0xf2))/0x2)+parseInt(_0x328df9(0x120))/0x3*(-parseInt(_0x328df9(0x10a))/0x4)+parseInt(_0x328df9(0x101))/0x5+parseInt(_0x328df9(0xf8))/0x6+parseInt(_0x328df9(0x11c))/0x7*(-parseInt(_0x328df9(0x10c))/0x8)+parseInt(_0x328df9(0x113))/0x9+-parseInt(_0x328df9(0x118))/0xa*(parseInt(_0x328df9(0x129))/0xb);if(_0x3c9b46===_0x3f8779)break;else _0x227319['push'](_0x227319['shift']());}catch(_0x1ebe61){_0x227319['push'](_0x227319['shift']());}}}(a65_0x29d1,0x4f305));var __importDefault=this&&this['__importDefault']||function(_0x74352a){const _0x2188d8=a65_0x53cf;return _0x74352a&&_0x74352a[_0x2188d8(0x11f)]?_0x74352a:{'default':_0x74352a};};function a65_0x29d1(){const _0x299b1a=['usdcPolygonWallet','gateways','UserService','name','2838789WtGvUg','publicKey','password','getAllUsers','toString','10wFEzVa','hex','paymentGateways','create','7rVAgAP','createUser','status','__esModule','610536xgKoZO','hash','bcryptjs','generateApiKeys','createdAt','wallets','fullName','shop','randomBytes','1981067rSJgUW','ACTIVE','2038vvVZMZ','Username\x20already\x20exists','merchantUrl','telegramId','desc','findMany','1164204JOlabM','432raCVjN','defineProperty','shopUrl','../config/database','parse','Telegram\x20username\x20already\x20exists','pk_','stringify','373605oqGfIU','default','update','gatewaySettings','usdtPolygonWallet','usdtErcWallet','map','deleteUser','username','4SYgaKD','sk_','2531344uqRJDj','usdtTrcWallet','telegram'];a65_0x29d1=function(){return _0x299b1a;};return a65_0x29d1();}Object[a65_0x1b66e7(0xfa)](exports,a65_0x1b66e7(0x11f),{'value':!![]}),exports[a65_0x1b66e7(0x111)]=void 0x0;const bcryptjs_1=__importDefault(require(a65_0x1b66e7(0x122))),crypto_1=__importDefault(require('crypto')),database_1=__importDefault(require(a65_0x1b66e7(0xfc)));class UserService{[a65_0x1b66e7(0x123)](){const _0x8f1422=a65_0x1b66e7,_0x2cf71c=_0x8f1422(0xff)+crypto_1[_0x8f1422(0x102)]['randomBytes'](0x20)[_0x8f1422(0x117)](_0x8f1422(0x119)),_0x2c63c3=_0x8f1422(0x10b)+crypto_1['default'][_0x8f1422(0x128)](0x20)[_0x8f1422(0x117)](_0x8f1422(0x119));return{'publicKey':_0x2cf71c,'secretKey':_0x2c63c3};}async[a65_0x1b66e7(0x11d)](_0x423cf7){const _0x38acc4=a65_0x1b66e7,{fullName:_0xbdbc6d,username:_0x434ce9,password:_0x542aab,telegramId:_0x353007,merchantUrl:_0x119ae0,gateways:_0x7047d0,gatewaySettings:_0x155b3f,wallets:_0xe5098f}=_0x423cf7,_0x17b97c=await database_1[_0x38acc4(0x102)][_0x38acc4(0x127)]['findUnique']({'where':{'username':_0x434ce9}});if(_0x17b97c)throw new Error(_0x38acc4(0xf3));if(_0x353007){const _0x2e5a5d=await database_1[_0x38acc4(0x102)][_0x38acc4(0x127)]['findUnique']({'where':{'telegram':_0x353007}});if(_0x2e5a5d)throw new Error(_0x38acc4(0xfe));}const _0x27429c=await bcryptjs_1['default'][_0x38acc4(0x121)](_0x542aab,0xc),{publicKey:_0x258a8b,secretKey:_0x23bf6e}=this['generateApiKeys'](),_0x21562b=await database_1[_0x38acc4(0x102)][_0x38acc4(0x127)][_0x38acc4(0x11b)]({'data':{'name':_0xbdbc6d,'username':_0x434ce9,'password':_0x27429c,'telegram':_0x353007,'shopUrl':_0x119ae0,'paymentGateways':_0x7047d0?JSON[_0x38acc4(0x100)](_0x7047d0):null,'gatewaySettings':_0x155b3f?JSON['stringify'](_0x155b3f):null,'usdtPolygonWallet':_0xe5098f?.[_0x38acc4(0x105)]||null,'usdtTrcWallet':_0xe5098f?.['usdtTrcWallet']||null,'usdtErcWallet':_0xe5098f?.[_0x38acc4(0x106)]||null,'usdcPolygonWallet':_0xe5098f?.[_0x38acc4(0x10f)]||null,'publicKey':_0x258a8b,'secretKey':_0x23bf6e,'status':_0x38acc4(0xf1)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x21562b['id'],'fullName':_0x21562b[_0x38acc4(0x112)],'username':_0x21562b[_0x38acc4(0x109)],'telegramId':_0x21562b[_0x38acc4(0x10e)],'merchantUrl':_0x21562b[_0x38acc4(0xfb)],'gateways':_0x21562b[_0x38acc4(0x11a)]?JSON['parse'](_0x21562b[_0x38acc4(0x11a)]):null,'gatewaySettings':_0x21562b[_0x38acc4(0x104)]?JSON['parse'](_0x21562b[_0x38acc4(0x104)]):null,'publicKey':_0x21562b[_0x38acc4(0x114)],'wallets':{'usdtPolygonWallet':_0x21562b[_0x38acc4(0x105)],'usdtTrcWallet':_0x21562b['usdtTrcWallet'],'usdtErcWallet':_0x21562b['usdtErcWallet'],'usdcPolygonWallet':_0x21562b[_0x38acc4(0x10f)]},'status':_0x21562b['status'],'createdAt':_0x21562b['createdAt']};}async[a65_0x1b66e7(0x116)](){const _0x32e502=a65_0x1b66e7,_0x56be7f=await database_1[_0x32e502(0x102)][_0x32e502(0x127)][_0x32e502(0xf7)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x32e502(0xf6)}});return _0x56be7f[_0x32e502(0x107)](_0x2c329f=>({'id':_0x2c329f['id'],'fullName':_0x2c329f[_0x32e502(0x112)],'username':_0x2c329f['username'],'telegramId':_0x2c329f[_0x32e502(0x10e)],'merchantUrl':_0x2c329f[_0x32e502(0xfb)],'gateways':_0x2c329f[_0x32e502(0x11a)]?JSON[_0x32e502(0xfd)](_0x2c329f['paymentGateways']):null,'gatewaySettings':_0x2c329f['gatewaySettings']?JSON['parse'](_0x2c329f['gatewaySettings']):null,'publicKey':_0x2c329f[_0x32e502(0x114)],'wallets':{'usdtPolygonWallet':_0x2c329f['usdtPolygonWallet'],'usdtTrcWallet':_0x2c329f['usdtTrcWallet'],'usdtErcWallet':_0x2c329f[_0x32e502(0x106)],'usdcPolygonWallet':_0x2c329f[_0x32e502(0x10f)]},'status':_0x2c329f[_0x32e502(0x11e)],'createdAt':_0x2c329f['createdAt']}));}async['getUserById'](_0x2c569f){const _0x42738f=a65_0x1b66e7,_0x2ea027=await database_1['default'][_0x42738f(0x127)]['findUnique']({'where':{'id':_0x2c569f},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x2ea027)return null;return{'id':_0x2ea027['id'],'fullName':_0x2ea027[_0x42738f(0x112)],'username':_0x2ea027[_0x42738f(0x109)],'telegramId':_0x2ea027[_0x42738f(0x10e)],'merchantUrl':_0x2ea027[_0x42738f(0xfb)],'gateways':_0x2ea027['paymentGateways']?JSON[_0x42738f(0xfd)](_0x2ea027[_0x42738f(0x11a)]):null,'gatewaySettings':_0x2ea027[_0x42738f(0x104)]?JSON[_0x42738f(0xfd)](_0x2ea027['gatewaySettings']):null,'publicKey':_0x2ea027['publicKey'],'wallets':{'usdtPolygonWallet':_0x2ea027[_0x42738f(0x105)],'usdtTrcWallet':_0x2ea027[_0x42738f(0x10d)],'usdtErcWallet':_0x2ea027[_0x42738f(0x106)],'usdcPolygonWallet':_0x2ea027[_0x42738f(0x10f)]},'status':_0x2ea027[_0x42738f(0x11e)],'createdAt':_0x2ea027['createdAt']};}async['updateUser'](_0x3c31b3,_0x150180){const _0x6be489=a65_0x1b66e7,_0x20904a={..._0x150180};_0x150180[_0x6be489(0x115)]&&(_0x20904a[_0x6be489(0x115)]=await bcryptjs_1[_0x6be489(0x102)][_0x6be489(0x121)](_0x150180[_0x6be489(0x115)],0xc));_0x150180['fullName']&&(_0x20904a[_0x6be489(0x112)]=_0x150180[_0x6be489(0x126)],delete _0x20904a[_0x6be489(0x126)]);_0x150180[_0x6be489(0xf5)]&&(_0x20904a[_0x6be489(0x10e)]=_0x150180['telegramId'],delete _0x20904a[_0x6be489(0xf5)]);_0x150180[_0x6be489(0xf4)]&&(_0x20904a[_0x6be489(0xfb)]=_0x150180[_0x6be489(0xf4)],delete _0x20904a[_0x6be489(0xf4)]);_0x150180[_0x6be489(0x110)]&&(_0x20904a[_0x6be489(0x11a)]=JSON[_0x6be489(0x100)](_0x150180[_0x6be489(0x110)]),delete _0x20904a[_0x6be489(0x110)]);_0x150180[_0x6be489(0x104)]&&(_0x20904a[_0x6be489(0x104)]=JSON[_0x6be489(0x100)](_0x150180[_0x6be489(0x104)]),delete _0x20904a['gatewaySettings']);_0x150180[_0x6be489(0x125)]&&(_0x150180['wallets'][_0x6be489(0x105)]!==undefined&&(_0x20904a['usdtPolygonWallet']=_0x150180[_0x6be489(0x125)][_0x6be489(0x105)]||null),_0x150180['wallets'][_0x6be489(0x10d)]!==undefined&&(_0x20904a[_0x6be489(0x10d)]=_0x150180[_0x6be489(0x125)][_0x6be489(0x10d)]||null),_0x150180[_0x6be489(0x125)]['usdtErcWallet']!==undefined&&(_0x20904a[_0x6be489(0x106)]=_0x150180[_0x6be489(0x125)][_0x6be489(0x106)]||null),_0x150180[_0x6be489(0x125)][_0x6be489(0x10f)]!==undefined&&(_0x20904a[_0x6be489(0x10f)]=_0x150180[_0x6be489(0x125)][_0x6be489(0x10f)]||null),delete _0x20904a[_0x6be489(0x125)]);const _0x346a2b=await database_1[_0x6be489(0x102)][_0x6be489(0x127)][_0x6be489(0x103)]({'where':{'id':_0x3c31b3},'data':_0x20904a,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x346a2b['id'],'fullName':_0x346a2b['name'],'username':_0x346a2b['username'],'telegramId':_0x346a2b[_0x6be489(0x10e)],'merchantUrl':_0x346a2b[_0x6be489(0xfb)],'gateways':_0x346a2b[_0x6be489(0x11a)]?JSON[_0x6be489(0xfd)](_0x346a2b[_0x6be489(0x11a)]):null,'gatewaySettings':_0x346a2b[_0x6be489(0x104)]?JSON[_0x6be489(0xfd)](_0x346a2b[_0x6be489(0x104)]):null,'publicKey':_0x346a2b[_0x6be489(0x114)],'wallets':{'usdtPolygonWallet':_0x346a2b[_0x6be489(0x105)],'usdtTrcWallet':_0x346a2b['usdtTrcWallet'],'usdtErcWallet':_0x346a2b[_0x6be489(0x106)],'usdcPolygonWallet':_0x346a2b[_0x6be489(0x10f)]},'status':_0x346a2b[_0x6be489(0x11e)],'createdAt':_0x346a2b[_0x6be489(0x124)]};}async[a65_0x1b66e7(0x108)](_0x12bfbc){const _0x509e06=a65_0x1b66e7;await database_1[_0x509e06(0x102)]['shop']['delete']({'where':{'id':_0x12bfbc}});}}function a65_0x53cf(_0x5758c3,_0x488246){const _0x29d1d6=a65_0x29d1();return a65_0x53cf=function(_0x53cfe9,_0x2ff302){_0x53cfe9=_0x53cfe9-0xf1;let _0x3e19aa=_0x29d1d6[_0x53cfe9];return _0x3e19aa;},a65_0x53cf(_0x5758c3,_0x488246);}exports['UserService']=UserService;