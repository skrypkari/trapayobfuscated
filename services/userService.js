'use strict';const a51_0x3e9732=a51_0xce60;(function(_0x5ac57f,_0x3cd711){const _0x29237e=a51_0xce60,_0xa6ee9d=_0x5ac57f();while(!![]){try{const _0x574966=parseInt(_0x29237e(0x178))/0x1+-parseInt(_0x29237e(0x194))/0x2*(parseInt(_0x29237e(0x173))/0x3)+-parseInt(_0x29237e(0x1a5))/0x4+parseInt(_0x29237e(0x192))/0x5+-parseInt(_0x29237e(0x193))/0x6*(parseInt(_0x29237e(0x19f))/0x7)+-parseInt(_0x29237e(0x185))/0x8+-parseInt(_0x29237e(0x199))/0x9;if(_0x574966===_0x3cd711)break;else _0xa6ee9d['push'](_0xa6ee9d['shift']());}catch(_0x1fedae){_0xa6ee9d['push'](_0xa6ee9d['shift']());}}}(a51_0x1633,0xec2ea));var __importDefault=this&&this[a51_0x3e9732(0x17f)]||function(_0x105d3c){return _0x105d3c&&_0x105d3c['__esModule']?_0x105d3c:{'default':_0x105d3c};};function a51_0xce60(_0x2c5f31,_0xb8df8b){const _0x16334e=a51_0x1633();return a51_0xce60=function(_0xce601f,_0x172a3d){_0xce601f=_0xce601f-0x171;let _0x264260=_0x16334e[_0xce601f];return _0x264260;},a51_0xce60(_0x2c5f31,_0xb8df8b);}Object['defineProperty'](exports,a51_0x3e9732(0x182),{'value':!![]}),exports[a51_0x3e9732(0x18f)]=void 0x0;function a51_0x1633(){const _0x138a1e=['38KpOgVF','usdtTrcWallet','usdtErcWallet','map','sk_','4650840VrIZMS','parse','hex','paymentGateways','telegramId','publicKey','973LEhthK','crypto','findUnique','getAllUsers','shop','default','746980UFaRKa','findMany','../config/database','fullName','usdcPolygonWallet','77403abyHAG','usdtPolygonWallet','Username\x20already\x20exists','stringify','telegram','901992OdTNsu','generateApiKeys','merchantUrl','deleteUser','hash','name','wallets','__importDefault','gatewaySettings','delete','__esModule','pk_','randomBytes','2370912tJXktp','shopUrl','createdAt','toString','bcryptjs','getUserById','Telegram\x20username\x20already\x20exists','update','password','status','UserService','username','gateways','7957495PEyeee','1554yEAXZi'];a51_0x1633=function(){return _0x138a1e;};return a51_0x1633();}const bcryptjs_1=__importDefault(require(a51_0x3e9732(0x189))),crypto_1=__importDefault(require(a51_0x3e9732(0x1a0))),database_1=__importDefault(require(a51_0x3e9732(0x1a7)));class UserService{[a51_0x3e9732(0x179)](){const _0x2aca5c=a51_0x3e9732,_0x3cb168=_0x2aca5c(0x183)+crypto_1['default'][_0x2aca5c(0x184)](0x20)['toString'](_0x2aca5c(0x19b)),_0x14e058=_0x2aca5c(0x198)+crypto_1[_0x2aca5c(0x1a4)][_0x2aca5c(0x184)](0x20)[_0x2aca5c(0x188)](_0x2aca5c(0x19b));return{'publicKey':_0x3cb168,'secretKey':_0x14e058};}async['createUser'](_0x213553){const _0x3bcb82=a51_0x3e9732,{fullName:_0x43f3ae,username:_0x27eb90,password:_0xd439a7,telegramId:_0x26256f,merchantUrl:_0x1b4227,gateways:_0x9c75da,gatewaySettings:_0x349aca,wallets:_0x587f87}=_0x213553,_0x4c4296=await database_1[_0x3bcb82(0x1a4)][_0x3bcb82(0x1a3)][_0x3bcb82(0x1a1)]({'where':{'username':_0x27eb90}});if(_0x4c4296)throw new Error(_0x3bcb82(0x175));if(_0x26256f){const _0xafc4d1=await database_1[_0x3bcb82(0x1a4)][_0x3bcb82(0x1a3)][_0x3bcb82(0x1a1)]({'where':{'telegram':_0x26256f}});if(_0xafc4d1)throw new Error(_0x3bcb82(0x18b));}const _0x1ebe4e=await bcryptjs_1[_0x3bcb82(0x1a4)][_0x3bcb82(0x17c)](_0xd439a7,0xc),{publicKey:_0x58be07,secretKey:_0x38da29}=this['generateApiKeys'](),_0x459e41=await database_1[_0x3bcb82(0x1a4)][_0x3bcb82(0x1a3)]['create']({'data':{'name':_0x43f3ae,'username':_0x27eb90,'password':_0x1ebe4e,'telegram':_0x26256f,'shopUrl':_0x1b4227,'paymentGateways':_0x9c75da?JSON['stringify'](_0x9c75da):null,'gatewaySettings':_0x349aca?JSON[_0x3bcb82(0x176)](_0x349aca):null,'usdtPolygonWallet':_0x587f87?.[_0x3bcb82(0x174)]||null,'usdtTrcWallet':_0x587f87?.[_0x3bcb82(0x195)]||null,'usdtErcWallet':_0x587f87?.['usdtErcWallet']||null,'usdcPolygonWallet':_0x587f87?.[_0x3bcb82(0x172)]||null,'publicKey':_0x58be07,'secretKey':_0x38da29,'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x459e41['id'],'fullName':_0x459e41['name'],'username':_0x459e41['username'],'telegramId':_0x459e41[_0x3bcb82(0x177)],'merchantUrl':_0x459e41[_0x3bcb82(0x186)],'gateways':_0x459e41['paymentGateways']?JSON[_0x3bcb82(0x19a)](_0x459e41[_0x3bcb82(0x19c)]):null,'gatewaySettings':_0x459e41[_0x3bcb82(0x180)]?JSON['parse'](_0x459e41[_0x3bcb82(0x180)]):null,'publicKey':_0x459e41['publicKey'],'wallets':{'usdtPolygonWallet':_0x459e41[_0x3bcb82(0x174)],'usdtTrcWallet':_0x459e41[_0x3bcb82(0x195)],'usdtErcWallet':_0x459e41[_0x3bcb82(0x196)],'usdcPolygonWallet':_0x459e41[_0x3bcb82(0x172)]},'status':_0x459e41[_0x3bcb82(0x18e)],'createdAt':_0x459e41[_0x3bcb82(0x187)]};}async[a51_0x3e9732(0x1a2)](){const _0xc7df1f=a51_0x3e9732,_0x5a1e91=await database_1[_0xc7df1f(0x1a4)]['shop'][_0xc7df1f(0x1a6)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':'desc'}});return _0x5a1e91[_0xc7df1f(0x197)](_0x26769e=>({'id':_0x26769e['id'],'fullName':_0x26769e[_0xc7df1f(0x17d)],'username':_0x26769e['username'],'telegramId':_0x26769e[_0xc7df1f(0x177)],'merchantUrl':_0x26769e[_0xc7df1f(0x186)],'gateways':_0x26769e[_0xc7df1f(0x19c)]?JSON[_0xc7df1f(0x19a)](_0x26769e[_0xc7df1f(0x19c)]):null,'gatewaySettings':_0x26769e[_0xc7df1f(0x180)]?JSON['parse'](_0x26769e[_0xc7df1f(0x180)]):null,'publicKey':_0x26769e[_0xc7df1f(0x19e)],'wallets':{'usdtPolygonWallet':_0x26769e[_0xc7df1f(0x174)],'usdtTrcWallet':_0x26769e['usdtTrcWallet'],'usdtErcWallet':_0x26769e[_0xc7df1f(0x196)],'usdcPolygonWallet':_0x26769e['usdcPolygonWallet']},'status':_0x26769e[_0xc7df1f(0x18e)],'createdAt':_0x26769e['createdAt']}));}async[a51_0x3e9732(0x18a)](_0x57d8f9){const _0x4f0ff5=a51_0x3e9732,_0xbab5ab=await database_1[_0x4f0ff5(0x1a4)][_0x4f0ff5(0x1a3)][_0x4f0ff5(0x1a1)]({'where':{'id':_0x57d8f9},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0xbab5ab)return null;return{'id':_0xbab5ab['id'],'fullName':_0xbab5ab[_0x4f0ff5(0x17d)],'username':_0xbab5ab[_0x4f0ff5(0x190)],'telegramId':_0xbab5ab['telegram'],'merchantUrl':_0xbab5ab[_0x4f0ff5(0x186)],'gateways':_0xbab5ab['paymentGateways']?JSON[_0x4f0ff5(0x19a)](_0xbab5ab['paymentGateways']):null,'gatewaySettings':_0xbab5ab[_0x4f0ff5(0x180)]?JSON[_0x4f0ff5(0x19a)](_0xbab5ab[_0x4f0ff5(0x180)]):null,'publicKey':_0xbab5ab['publicKey'],'wallets':{'usdtPolygonWallet':_0xbab5ab[_0x4f0ff5(0x174)],'usdtTrcWallet':_0xbab5ab['usdtTrcWallet'],'usdtErcWallet':_0xbab5ab[_0x4f0ff5(0x196)],'usdcPolygonWallet':_0xbab5ab['usdcPolygonWallet']},'status':_0xbab5ab[_0x4f0ff5(0x18e)],'createdAt':_0xbab5ab[_0x4f0ff5(0x187)]};}async['updateUser'](_0x3ea244,_0x17e024){const _0x6c081a=a51_0x3e9732,_0x40564b={..._0x17e024};_0x17e024[_0x6c081a(0x18d)]&&(_0x40564b[_0x6c081a(0x18d)]=await bcryptjs_1['default'][_0x6c081a(0x17c)](_0x17e024[_0x6c081a(0x18d)],0xc));_0x17e024[_0x6c081a(0x171)]&&(_0x40564b[_0x6c081a(0x17d)]=_0x17e024[_0x6c081a(0x171)],delete _0x40564b[_0x6c081a(0x171)]);_0x17e024[_0x6c081a(0x19d)]&&(_0x40564b[_0x6c081a(0x177)]=_0x17e024[_0x6c081a(0x19d)],delete _0x40564b[_0x6c081a(0x19d)]);_0x17e024['merchantUrl']&&(_0x40564b['shopUrl']=_0x17e024[_0x6c081a(0x17a)],delete _0x40564b[_0x6c081a(0x17a)]);_0x17e024[_0x6c081a(0x191)]&&(_0x40564b[_0x6c081a(0x19c)]=JSON['stringify'](_0x17e024[_0x6c081a(0x191)]),delete _0x40564b['gateways']);_0x17e024['gatewaySettings']&&(_0x40564b[_0x6c081a(0x180)]=JSON['stringify'](_0x17e024['gatewaySettings']),delete _0x40564b['gatewaySettings']);_0x17e024[_0x6c081a(0x17e)]&&(_0x17e024[_0x6c081a(0x17e)]['usdtPolygonWallet']!==undefined&&(_0x40564b[_0x6c081a(0x174)]=_0x17e024[_0x6c081a(0x17e)][_0x6c081a(0x174)]||null),_0x17e024['wallets'][_0x6c081a(0x195)]!==undefined&&(_0x40564b[_0x6c081a(0x195)]=_0x17e024['wallets']['usdtTrcWallet']||null),_0x17e024[_0x6c081a(0x17e)]['usdtErcWallet']!==undefined&&(_0x40564b['usdtErcWallet']=_0x17e024[_0x6c081a(0x17e)][_0x6c081a(0x196)]||null),_0x17e024[_0x6c081a(0x17e)][_0x6c081a(0x172)]!==undefined&&(_0x40564b[_0x6c081a(0x172)]=_0x17e024['wallets'][_0x6c081a(0x172)]||null),delete _0x40564b[_0x6c081a(0x17e)]);const _0x147ec7=await database_1[_0x6c081a(0x1a4)][_0x6c081a(0x1a3)][_0x6c081a(0x18c)]({'where':{'id':_0x3ea244},'data':_0x40564b,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x147ec7['id'],'fullName':_0x147ec7[_0x6c081a(0x17d)],'username':_0x147ec7[_0x6c081a(0x190)],'telegramId':_0x147ec7[_0x6c081a(0x177)],'merchantUrl':_0x147ec7[_0x6c081a(0x186)],'gateways':_0x147ec7['paymentGateways']?JSON['parse'](_0x147ec7['paymentGateways']):null,'gatewaySettings':_0x147ec7[_0x6c081a(0x180)]?JSON['parse'](_0x147ec7[_0x6c081a(0x180)]):null,'publicKey':_0x147ec7['publicKey'],'wallets':{'usdtPolygonWallet':_0x147ec7[_0x6c081a(0x174)],'usdtTrcWallet':_0x147ec7[_0x6c081a(0x195)],'usdtErcWallet':_0x147ec7[_0x6c081a(0x196)],'usdcPolygonWallet':_0x147ec7[_0x6c081a(0x172)]},'status':_0x147ec7['status'],'createdAt':_0x147ec7[_0x6c081a(0x187)]};}async[a51_0x3e9732(0x17b)](_0x5e8798){const _0x35ecd4=a51_0x3e9732;await database_1['default']['shop'][_0x35ecd4(0x181)]({'where':{'id':_0x5e8798}});}}exports[a51_0x3e9732(0x18f)]=UserService;