'use strict';const a57_0x2a5b01=a57_0x58f5;function a57_0x9db9(){const _0x1e7348=['findMany','51500RTHheA','desc','Telegram\x20username\x20already\x20exists','parse','randomBytes','defineProperty','delete','findUnique','generateApiKeys','../config/database','hash','bcryptjs','paymentGateways','getAllUsers','createUser','385382TrlJcy','10cEhZRa','hex','shop','UserService','usdcPolygonWallet','update','6dtDdUm','merchantUrl','8RIiBSC','createdAt','gateways','__importDefault','telegram','pk_','username','Username\x20already\x20exists','map','usdtTrcWallet','236nzqLvK','ACTIVE','usdtErcWallet','sk_','shopUrl','wallets','updateUser','password','__esModule','1839057fCYQUK','21MXWgxP','publicKey','telegramId','crypto','4029634xvmJgL','getUserById','usdtPolygonWallet','toString','7813809cyYwwo','stringify','create','57582DxFTKa','gatewaySettings','fullName','status','default','name','20563716wVxnke'];a57_0x9db9=function(){return _0x1e7348;};return a57_0x9db9();}(function(_0x42074e,_0x3cda92){const _0x23f3a7=a57_0x58f5,_0xdc2dc6=_0x42074e();while(!![]){try{const _0x53ab15=-parseInt(_0x23f3a7(0x11c))/0x1+-parseInt(_0x23f3a7(0x144))/0x2*(-parseInt(_0x23f3a7(0x139))/0x3)+parseInt(_0x23f3a7(0x12f))/0x4*(-parseInt(_0x23f3a7(0x14c))/0x5)+parseInt(_0x23f3a7(0x123))/0x6*(parseInt(_0x23f3a7(0x13d))/0x7)+-parseInt(_0x23f3a7(0x125))/0x8*(parseInt(_0x23f3a7(0x141))/0x9)+-parseInt(_0x23f3a7(0x11d))/0xa*(parseInt(_0x23f3a7(0x138))/0xb)+parseInt(_0x23f3a7(0x14a))/0xc;if(_0x53ab15===_0x3cda92)break;else _0xdc2dc6['push'](_0xdc2dc6['shift']());}catch(_0x2dfd49){_0xdc2dc6['push'](_0xdc2dc6['shift']());}}}(a57_0x9db9,0x70e24));var __importDefault=this&&this[a57_0x2a5b01(0x128)]||function(_0x44e24b){const _0x588eca=a57_0x2a5b01;return _0x44e24b&&_0x44e24b[_0x588eca(0x137)]?_0x44e24b:{'default':_0x44e24b};};Object[a57_0x2a5b01(0x112)](exports,a57_0x2a5b01(0x137),{'value':!![]}),exports[a57_0x2a5b01(0x120)]=void 0x0;const bcryptjs_1=__importDefault(require(a57_0x2a5b01(0x118))),crypto_1=__importDefault(require(a57_0x2a5b01(0x13c))),database_1=__importDefault(require(a57_0x2a5b01(0x116)));class UserService{[a57_0x2a5b01(0x115)](){const _0x1c317e=a57_0x2a5b01,_0x28ef4c=_0x1c317e(0x12a)+crypto_1['default']['randomBytes'](0x20)[_0x1c317e(0x140)](_0x1c317e(0x11e)),_0x2a0504=_0x1c317e(0x132)+crypto_1[_0x1c317e(0x148)][_0x1c317e(0x111)](0x20)['toString'](_0x1c317e(0x11e));return{'publicKey':_0x28ef4c,'secretKey':_0x2a0504};}async[a57_0x2a5b01(0x11b)](_0x2c6be6){const _0x3f5f16=a57_0x2a5b01,{fullName:_0x30f1c2,username:_0x454bf1,password:_0x275849,telegramId:_0x3714c0,merchantUrl:_0x5018fd,gateways:_0xd728b0,gatewaySettings:_0x2d47f4,wallets:_0x1abe06}=_0x2c6be6,_0x5a1030=await database_1[_0x3f5f16(0x148)][_0x3f5f16(0x11f)]['findUnique']({'where':{'username':_0x454bf1}});if(_0x5a1030)throw new Error(_0x3f5f16(0x12c));if(_0x3714c0){const _0x53080e=await database_1[_0x3f5f16(0x148)]['shop']['findUnique']({'where':{'telegram':_0x3714c0}});if(_0x53080e)throw new Error(_0x3f5f16(0x10f));}const _0xfaafdb=await bcryptjs_1['default'][_0x3f5f16(0x117)](_0x275849,0xc),{publicKey:_0x536e3a,secretKey:_0x2e9543}=this[_0x3f5f16(0x115)](),_0x474bfe=await database_1[_0x3f5f16(0x148)][_0x3f5f16(0x11f)][_0x3f5f16(0x143)]({'data':{'name':_0x30f1c2,'username':_0x454bf1,'password':_0xfaafdb,'telegram':_0x3714c0,'shopUrl':_0x5018fd,'paymentGateways':_0xd728b0?JSON[_0x3f5f16(0x142)](_0xd728b0):null,'gatewaySettings':_0x2d47f4?JSON[_0x3f5f16(0x142)](_0x2d47f4):null,'usdtPolygonWallet':_0x1abe06?.['usdtPolygonWallet']||null,'usdtTrcWallet':_0x1abe06?.[_0x3f5f16(0x12e)]||null,'usdtErcWallet':_0x1abe06?.[_0x3f5f16(0x131)]||null,'usdcPolygonWallet':_0x1abe06?.['usdcPolygonWallet']||null,'publicKey':_0x536e3a,'secretKey':_0x2e9543,'status':_0x3f5f16(0x130)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x474bfe['id'],'fullName':_0x474bfe[_0x3f5f16(0x149)],'username':_0x474bfe[_0x3f5f16(0x12b)],'telegramId':_0x474bfe[_0x3f5f16(0x129)],'merchantUrl':_0x474bfe['shopUrl'],'gateways':_0x474bfe[_0x3f5f16(0x119)]?JSON[_0x3f5f16(0x110)](_0x474bfe[_0x3f5f16(0x119)]):null,'gatewaySettings':_0x474bfe['gatewaySettings']?JSON['parse'](_0x474bfe[_0x3f5f16(0x145)]):null,'publicKey':_0x474bfe['publicKey'],'wallets':{'usdtPolygonWallet':_0x474bfe[_0x3f5f16(0x13f)],'usdtTrcWallet':_0x474bfe[_0x3f5f16(0x12e)],'usdtErcWallet':_0x474bfe[_0x3f5f16(0x131)],'usdcPolygonWallet':_0x474bfe[_0x3f5f16(0x121)]},'status':_0x474bfe[_0x3f5f16(0x147)],'createdAt':_0x474bfe[_0x3f5f16(0x126)]};}async[a57_0x2a5b01(0x11a)](){const _0xd8bb9e=a57_0x2a5b01,_0x3da522=await database_1[_0xd8bb9e(0x148)][_0xd8bb9e(0x11f)][_0xd8bb9e(0x14b)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0xd8bb9e(0x10e)}});return _0x3da522[_0xd8bb9e(0x12d)](_0x2815ec=>({'id':_0x2815ec['id'],'fullName':_0x2815ec[_0xd8bb9e(0x149)],'username':_0x2815ec[_0xd8bb9e(0x12b)],'telegramId':_0x2815ec[_0xd8bb9e(0x129)],'merchantUrl':_0x2815ec[_0xd8bb9e(0x133)],'gateways':_0x2815ec[_0xd8bb9e(0x119)]?JSON[_0xd8bb9e(0x110)](_0x2815ec[_0xd8bb9e(0x119)]):null,'gatewaySettings':_0x2815ec[_0xd8bb9e(0x145)]?JSON['parse'](_0x2815ec['gatewaySettings']):null,'publicKey':_0x2815ec['publicKey'],'wallets':{'usdtPolygonWallet':_0x2815ec[_0xd8bb9e(0x13f)],'usdtTrcWallet':_0x2815ec[_0xd8bb9e(0x12e)],'usdtErcWallet':_0x2815ec[_0xd8bb9e(0x131)],'usdcPolygonWallet':_0x2815ec['usdcPolygonWallet']},'status':_0x2815ec['status'],'createdAt':_0x2815ec[_0xd8bb9e(0x126)]}));}async[a57_0x2a5b01(0x13e)](_0x27b347){const _0x4744ff=a57_0x2a5b01,_0x4d7df4=await database_1[_0x4744ff(0x148)][_0x4744ff(0x11f)][_0x4744ff(0x114)]({'where':{'id':_0x27b347},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x4d7df4)return null;return{'id':_0x4d7df4['id'],'fullName':_0x4d7df4['name'],'username':_0x4d7df4[_0x4744ff(0x12b)],'telegramId':_0x4d7df4[_0x4744ff(0x129)],'merchantUrl':_0x4d7df4[_0x4744ff(0x133)],'gateways':_0x4d7df4[_0x4744ff(0x119)]?JSON[_0x4744ff(0x110)](_0x4d7df4['paymentGateways']):null,'gatewaySettings':_0x4d7df4[_0x4744ff(0x145)]?JSON[_0x4744ff(0x110)](_0x4d7df4[_0x4744ff(0x145)]):null,'publicKey':_0x4d7df4['publicKey'],'wallets':{'usdtPolygonWallet':_0x4d7df4[_0x4744ff(0x13f)],'usdtTrcWallet':_0x4d7df4[_0x4744ff(0x12e)],'usdtErcWallet':_0x4d7df4[_0x4744ff(0x131)],'usdcPolygonWallet':_0x4d7df4['usdcPolygonWallet']},'status':_0x4d7df4[_0x4744ff(0x147)],'createdAt':_0x4d7df4['createdAt']};}async[a57_0x2a5b01(0x135)](_0xfad5ed,_0x573a3a){const _0x590c02=a57_0x2a5b01,_0x302d46={..._0x573a3a};_0x573a3a[_0x590c02(0x136)]&&(_0x302d46[_0x590c02(0x136)]=await bcryptjs_1[_0x590c02(0x148)][_0x590c02(0x117)](_0x573a3a[_0x590c02(0x136)],0xc));_0x573a3a[_0x590c02(0x146)]&&(_0x302d46[_0x590c02(0x149)]=_0x573a3a['fullName'],delete _0x302d46['fullName']);_0x573a3a[_0x590c02(0x13b)]&&(_0x302d46[_0x590c02(0x129)]=_0x573a3a[_0x590c02(0x13b)],delete _0x302d46[_0x590c02(0x13b)]);_0x573a3a[_0x590c02(0x124)]&&(_0x302d46[_0x590c02(0x133)]=_0x573a3a[_0x590c02(0x124)],delete _0x302d46[_0x590c02(0x124)]);_0x573a3a['gateways']&&(_0x302d46['paymentGateways']=JSON[_0x590c02(0x142)](_0x573a3a[_0x590c02(0x127)]),delete _0x302d46[_0x590c02(0x127)]);_0x573a3a[_0x590c02(0x145)]&&(_0x302d46[_0x590c02(0x145)]=JSON['stringify'](_0x573a3a[_0x590c02(0x145)]),delete _0x302d46[_0x590c02(0x145)]);_0x573a3a[_0x590c02(0x134)]&&(_0x573a3a[_0x590c02(0x134)]['usdtPolygonWallet']!==undefined&&(_0x302d46[_0x590c02(0x13f)]=_0x573a3a['wallets'][_0x590c02(0x13f)]||null),_0x573a3a[_0x590c02(0x134)][_0x590c02(0x12e)]!==undefined&&(_0x302d46[_0x590c02(0x12e)]=_0x573a3a[_0x590c02(0x134)]['usdtTrcWallet']||null),_0x573a3a[_0x590c02(0x134)][_0x590c02(0x131)]!==undefined&&(_0x302d46['usdtErcWallet']=_0x573a3a[_0x590c02(0x134)][_0x590c02(0x131)]||null),_0x573a3a[_0x590c02(0x134)][_0x590c02(0x121)]!==undefined&&(_0x302d46[_0x590c02(0x121)]=_0x573a3a[_0x590c02(0x134)][_0x590c02(0x121)]||null),delete _0x302d46['wallets']);const _0x377158=await database_1['default'][_0x590c02(0x11f)][_0x590c02(0x122)]({'where':{'id':_0xfad5ed},'data':_0x302d46,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x377158['id'],'fullName':_0x377158[_0x590c02(0x149)],'username':_0x377158[_0x590c02(0x12b)],'telegramId':_0x377158[_0x590c02(0x129)],'merchantUrl':_0x377158[_0x590c02(0x133)],'gateways':_0x377158[_0x590c02(0x119)]?JSON[_0x590c02(0x110)](_0x377158['paymentGateways']):null,'gatewaySettings':_0x377158[_0x590c02(0x145)]?JSON[_0x590c02(0x110)](_0x377158['gatewaySettings']):null,'publicKey':_0x377158[_0x590c02(0x13a)],'wallets':{'usdtPolygonWallet':_0x377158['usdtPolygonWallet'],'usdtTrcWallet':_0x377158[_0x590c02(0x12e)],'usdtErcWallet':_0x377158['usdtErcWallet'],'usdcPolygonWallet':_0x377158[_0x590c02(0x121)]},'status':_0x377158[_0x590c02(0x147)],'createdAt':_0x377158['createdAt']};}async['deleteUser'](_0x54da47){const _0x1c1142=a57_0x2a5b01;await database_1[_0x1c1142(0x148)]['shop'][_0x1c1142(0x113)]({'where':{'id':_0x54da47}});}}function a57_0x58f5(_0x3e9282,_0x8c31f8){const _0x9db9b0=a57_0x9db9();return a57_0x58f5=function(_0x58f5d5,_0x2fa649){_0x58f5d5=_0x58f5d5-0x10e;let _0x4a6b41=_0x9db9b0[_0x58f5d5];return _0x4a6b41;},a57_0x58f5(_0x3e9282,_0x8c31f8);}exports[a57_0x2a5b01(0x120)]=UserService;