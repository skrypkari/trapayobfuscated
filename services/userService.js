'use strict';const a56_0x2c0909=a56_0x3748;(function(_0x38739b,_0x24e9d3){const _0x599b93=a56_0x3748,_0x49a9cf=_0x38739b();while(!![]){try{const _0x279638=parseInt(_0x599b93(0x19c))/0x1+parseInt(_0x599b93(0x1a7))/0x2*(-parseInt(_0x599b93(0x1a2))/0x3)+-parseInt(_0x599b93(0x1a5))/0x4*(parseInt(_0x599b93(0x1b2))/0x5)+parseInt(_0x599b93(0x1a0))/0x6+parseInt(_0x599b93(0x198))/0x7*(-parseInt(_0x599b93(0x1a4))/0x8)+parseInt(_0x599b93(0x1b4))/0x9+-parseInt(_0x599b93(0x1bb))/0xa*(-parseInt(_0x599b93(0x1be))/0xb);if(_0x279638===_0x24e9d3)break;else _0x49a9cf['push'](_0x49a9cf['shift']());}catch(_0x2d7e7c){_0x49a9cf['push'](_0x49a9cf['shift']());}}}(a56_0x57fe,0x544fd));var __importDefault=this&&this[a56_0x2c0909(0x1ab)]||function(_0x24b366){const _0x5d6d60=a56_0x2c0909;return _0x24b366&&_0x24b366[_0x5d6d60(0x1c9)]?_0x24b366:{'default':_0x24b366};};function a56_0x3748(_0x37e19c,_0x4df355){const _0x57fe4f=a56_0x57fe();return a56_0x3748=function(_0x374812,_0x1818b0){_0x374812=_0x374812-0x192;let _0x1695b8=_0x57fe4f[_0x374812];return _0x1695b8;},a56_0x3748(_0x37e19c,_0x4df355);}function a56_0x57fe(){const _0x813a3a=['140rbRAzZ','map','33498moEvBj','merchantUrl','name','publicKey','__importDefault','usdtPolygonWallet','usdcPolygonWallet','wallets','update','createdAt','generateApiKeys','43730aZYmrX','usdtTrcWallet','838764sorzyf','Username\x20already\x20exists','pk_','findUnique','username','status','toString','667960JUqYza','createUser','getUserById','44jLEAAt','UserService','gatewaySettings','default','hex','fullName','sk_','telegram','password','bcryptjs','parse','__esModule','shopUrl','findMany','getAllUsers','hash','randomBytes','usdtErcWallet','7lkWrMx','telegramId','delete','Telegram\x20username\x20already\x20exists','328334TUKlwX','gateways','paymentGateways','../config/database','4002102TYTIPm','stringify','6brlGfI','shop','5366256ymTeXy'];a56_0x57fe=function(){return _0x813a3a;};return a56_0x57fe();}Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a56_0x2c0909(0x1bf)]=void 0x0;const bcryptjs_1=__importDefault(require(a56_0x2c0909(0x1c7))),crypto_1=__importDefault(require('crypto')),database_1=__importDefault(require(a56_0x2c0909(0x19f)));class UserService{[a56_0x2c0909(0x1b1)](){const _0x3e8ddd=a56_0x2c0909,_0xe4395a=_0x3e8ddd(0x1b6)+crypto_1[_0x3e8ddd(0x1c1)]['randomBytes'](0x20)['toString'](_0x3e8ddd(0x1c2)),_0x38b71e=_0x3e8ddd(0x1c4)+crypto_1[_0x3e8ddd(0x1c1)][_0x3e8ddd(0x196)](0x20)[_0x3e8ddd(0x1ba)](_0x3e8ddd(0x1c2));return{'publicKey':_0xe4395a,'secretKey':_0x38b71e};}async[a56_0x2c0909(0x1bc)](_0x5b8c35){const _0x14ed58=a56_0x2c0909,{fullName:_0x184170,username:_0x3199db,password:_0x2d9344,telegramId:_0xa0290e,merchantUrl:_0x39d681,gateways:_0x1db30b,gatewaySettings:_0x556cb7,wallets:_0x510d03}=_0x5b8c35,_0x27b13d=await database_1[_0x14ed58(0x1c1)][_0x14ed58(0x1a3)][_0x14ed58(0x1b7)]({'where':{'username':_0x3199db}});if(_0x27b13d)throw new Error(_0x14ed58(0x1b5));if(_0xa0290e){const _0x2c44d2=await database_1[_0x14ed58(0x1c1)][_0x14ed58(0x1a3)]['findUnique']({'where':{'telegram':_0xa0290e}});if(_0x2c44d2)throw new Error(_0x14ed58(0x19b));}const _0xdaf2ce=await bcryptjs_1['default'][_0x14ed58(0x195)](_0x2d9344,0xc),{publicKey:_0x282175,secretKey:_0xdab0b5}=this[_0x14ed58(0x1b1)](),_0x3aab82=await database_1[_0x14ed58(0x1c1)][_0x14ed58(0x1a3)]['create']({'data':{'name':_0x184170,'username':_0x3199db,'password':_0xdaf2ce,'telegram':_0xa0290e,'shopUrl':_0x39d681,'paymentGateways':_0x1db30b?JSON[_0x14ed58(0x1a1)](_0x1db30b):null,'gatewaySettings':_0x556cb7?JSON[_0x14ed58(0x1a1)](_0x556cb7):null,'usdtPolygonWallet':_0x510d03?.[_0x14ed58(0x1ac)]||null,'usdtTrcWallet':_0x510d03?.[_0x14ed58(0x1b3)]||null,'usdtErcWallet':_0x510d03?.['usdtErcWallet']||null,'usdcPolygonWallet':_0x510d03?.['usdcPolygonWallet']||null,'publicKey':_0x282175,'secretKey':_0xdab0b5,'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x3aab82['id'],'fullName':_0x3aab82[_0x14ed58(0x1a9)],'username':_0x3aab82['username'],'telegramId':_0x3aab82['telegram'],'merchantUrl':_0x3aab82['shopUrl'],'gateways':_0x3aab82[_0x14ed58(0x19e)]?JSON[_0x14ed58(0x1c8)](_0x3aab82[_0x14ed58(0x19e)]):null,'gatewaySettings':_0x3aab82[_0x14ed58(0x1c0)]?JSON['parse'](_0x3aab82[_0x14ed58(0x1c0)]):null,'publicKey':_0x3aab82[_0x14ed58(0x1aa)],'wallets':{'usdtPolygonWallet':_0x3aab82[_0x14ed58(0x1ac)],'usdtTrcWallet':_0x3aab82[_0x14ed58(0x1b3)],'usdtErcWallet':_0x3aab82[_0x14ed58(0x197)],'usdcPolygonWallet':_0x3aab82[_0x14ed58(0x1ad)]},'status':_0x3aab82['status'],'createdAt':_0x3aab82[_0x14ed58(0x1b0)]};}async[a56_0x2c0909(0x194)](){const _0x88b8ca=a56_0x2c0909,_0x1c0606=await database_1['default'][_0x88b8ca(0x1a3)][_0x88b8ca(0x193)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':'desc'}});return _0x1c0606[_0x88b8ca(0x1a6)](_0x423bd9=>({'id':_0x423bd9['id'],'fullName':_0x423bd9['name'],'username':_0x423bd9[_0x88b8ca(0x1b8)],'telegramId':_0x423bd9['telegram'],'merchantUrl':_0x423bd9[_0x88b8ca(0x192)],'gateways':_0x423bd9[_0x88b8ca(0x19e)]?JSON['parse'](_0x423bd9[_0x88b8ca(0x19e)]):null,'gatewaySettings':_0x423bd9[_0x88b8ca(0x1c0)]?JSON[_0x88b8ca(0x1c8)](_0x423bd9['gatewaySettings']):null,'publicKey':_0x423bd9[_0x88b8ca(0x1aa)],'wallets':{'usdtPolygonWallet':_0x423bd9[_0x88b8ca(0x1ac)],'usdtTrcWallet':_0x423bd9[_0x88b8ca(0x1b3)],'usdtErcWallet':_0x423bd9[_0x88b8ca(0x197)],'usdcPolygonWallet':_0x423bd9[_0x88b8ca(0x1ad)]},'status':_0x423bd9[_0x88b8ca(0x1b9)],'createdAt':_0x423bd9[_0x88b8ca(0x1b0)]}));}async[a56_0x2c0909(0x1bd)](_0x1f0a53){const _0x83ed1=a56_0x2c0909,_0x298e2d=await database_1[_0x83ed1(0x1c1)][_0x83ed1(0x1a3)][_0x83ed1(0x1b7)]({'where':{'id':_0x1f0a53},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x298e2d)return null;return{'id':_0x298e2d['id'],'fullName':_0x298e2d[_0x83ed1(0x1a9)],'username':_0x298e2d[_0x83ed1(0x1b8)],'telegramId':_0x298e2d['telegram'],'merchantUrl':_0x298e2d[_0x83ed1(0x192)],'gateways':_0x298e2d[_0x83ed1(0x19e)]?JSON[_0x83ed1(0x1c8)](_0x298e2d[_0x83ed1(0x19e)]):null,'gatewaySettings':_0x298e2d['gatewaySettings']?JSON[_0x83ed1(0x1c8)](_0x298e2d[_0x83ed1(0x1c0)]):null,'publicKey':_0x298e2d['publicKey'],'wallets':{'usdtPolygonWallet':_0x298e2d[_0x83ed1(0x1ac)],'usdtTrcWallet':_0x298e2d['usdtTrcWallet'],'usdtErcWallet':_0x298e2d['usdtErcWallet'],'usdcPolygonWallet':_0x298e2d[_0x83ed1(0x1ad)]},'status':_0x298e2d[_0x83ed1(0x1b9)],'createdAt':_0x298e2d[_0x83ed1(0x1b0)]};}async['updateUser'](_0x11e71b,_0x5318c9){const _0x496e37=a56_0x2c0909,_0x158a01={..._0x5318c9};_0x5318c9[_0x496e37(0x1c6)]&&(_0x158a01['password']=await bcryptjs_1[_0x496e37(0x1c1)][_0x496e37(0x195)](_0x5318c9[_0x496e37(0x1c6)],0xc));_0x5318c9[_0x496e37(0x1c3)]&&(_0x158a01[_0x496e37(0x1a9)]=_0x5318c9[_0x496e37(0x1c3)],delete _0x158a01[_0x496e37(0x1c3)]);_0x5318c9[_0x496e37(0x199)]&&(_0x158a01[_0x496e37(0x1c5)]=_0x5318c9[_0x496e37(0x199)],delete _0x158a01[_0x496e37(0x199)]);_0x5318c9[_0x496e37(0x1a8)]&&(_0x158a01[_0x496e37(0x192)]=_0x5318c9[_0x496e37(0x1a8)],delete _0x158a01['merchantUrl']);_0x5318c9[_0x496e37(0x19d)]&&(_0x158a01[_0x496e37(0x19e)]=JSON['stringify'](_0x5318c9[_0x496e37(0x19d)]),delete _0x158a01['gateways']);_0x5318c9[_0x496e37(0x1c0)]&&(_0x158a01[_0x496e37(0x1c0)]=JSON[_0x496e37(0x1a1)](_0x5318c9[_0x496e37(0x1c0)]),delete _0x158a01[_0x496e37(0x1c0)]);_0x5318c9['wallets']&&(_0x5318c9[_0x496e37(0x1ae)][_0x496e37(0x1ac)]!==undefined&&(_0x158a01[_0x496e37(0x1ac)]=_0x5318c9[_0x496e37(0x1ae)][_0x496e37(0x1ac)]||null),_0x5318c9[_0x496e37(0x1ae)][_0x496e37(0x1b3)]!==undefined&&(_0x158a01[_0x496e37(0x1b3)]=_0x5318c9[_0x496e37(0x1ae)][_0x496e37(0x1b3)]||null),_0x5318c9['wallets'][_0x496e37(0x197)]!==undefined&&(_0x158a01[_0x496e37(0x197)]=_0x5318c9[_0x496e37(0x1ae)]['usdtErcWallet']||null),_0x5318c9[_0x496e37(0x1ae)]['usdcPolygonWallet']!==undefined&&(_0x158a01[_0x496e37(0x1ad)]=_0x5318c9[_0x496e37(0x1ae)][_0x496e37(0x1ad)]||null),delete _0x158a01['wallets']);const _0x12d9c6=await database_1[_0x496e37(0x1c1)]['shop'][_0x496e37(0x1af)]({'where':{'id':_0x11e71b},'data':_0x158a01,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x12d9c6['id'],'fullName':_0x12d9c6[_0x496e37(0x1a9)],'username':_0x12d9c6[_0x496e37(0x1b8)],'telegramId':_0x12d9c6[_0x496e37(0x1c5)],'merchantUrl':_0x12d9c6[_0x496e37(0x192)],'gateways':_0x12d9c6['paymentGateways']?JSON[_0x496e37(0x1c8)](_0x12d9c6[_0x496e37(0x19e)]):null,'gatewaySettings':_0x12d9c6[_0x496e37(0x1c0)]?JSON[_0x496e37(0x1c8)](_0x12d9c6[_0x496e37(0x1c0)]):null,'publicKey':_0x12d9c6['publicKey'],'wallets':{'usdtPolygonWallet':_0x12d9c6['usdtPolygonWallet'],'usdtTrcWallet':_0x12d9c6[_0x496e37(0x1b3)],'usdtErcWallet':_0x12d9c6['usdtErcWallet'],'usdcPolygonWallet':_0x12d9c6[_0x496e37(0x1ad)]},'status':_0x12d9c6[_0x496e37(0x1b9)],'createdAt':_0x12d9c6[_0x496e37(0x1b0)]};}async['deleteUser'](_0x29e265){const _0x3a3d4f=a56_0x2c0909;await database_1[_0x3a3d4f(0x1c1)][_0x3a3d4f(0x1a3)][_0x3a3d4f(0x19a)]({'where':{'id':_0x29e265}});}}exports[a56_0x2c0909(0x1bf)]=UserService;