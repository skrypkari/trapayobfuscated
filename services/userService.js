'use strict';const a57_0x22e0ec=a57_0x2b19;function a57_0x2b19(_0x27f871,_0x16476c){const _0x58bc23=a57_0x58bc();return a57_0x2b19=function(_0x2b1932,_0x2abe35){_0x2b1932=_0x2b1932-0x127;let _0x23466b=_0x58bc23[_0x2b1932];return _0x23466b;},a57_0x2b19(_0x27f871,_0x16476c);}(function(_0x6f548b,_0x45dc66){const _0x375e1e=a57_0x2b19,_0x5e899b=_0x6f548b();while(!![]){try{const _0xcd3273=parseInt(_0x375e1e(0x15a))/0x1+-parseInt(_0x375e1e(0x12a))/0x2*(-parseInt(_0x375e1e(0x143))/0x3)+parseInt(_0x375e1e(0x138))/0x4+parseInt(_0x375e1e(0x152))/0x5*(parseInt(_0x375e1e(0x12e))/0x6)+-parseInt(_0x375e1e(0x15e))/0x7+-parseInt(_0x375e1e(0x155))/0x8+-parseInt(_0x375e1e(0x14a))/0x9*(-parseInt(_0x375e1e(0x157))/0xa);if(_0xcd3273===_0x45dc66)break;else _0x5e899b['push'](_0x5e899b['shift']());}catch(_0x3a0039){_0x5e899b['push'](_0x5e899b['shift']());}}}(a57_0x58bc,0x4f70b));var __importDefault=this&&this[a57_0x22e0ec(0x12c)]||function(_0x32d4e5){const _0x962ef8=a57_0x22e0ec;return _0x32d4e5&&_0x32d4e5[_0x962ef8(0x12f)]?_0x32d4e5:{'default':_0x32d4e5};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports['UserService']=void 0x0;function a57_0x58bc(){const _0x4fd3f8=['2642040bpIJgA','createdAt','523610FXTNWU','telegramId','usdtTrcWallet','50661kPoDPG','paymentGateways','getUserById','getAllUsers','3717959RFOYLj','update','name','shopUrl','2NVhwxD','create','__importDefault','merchantUrl','6JgefmU','__esModule','map','generateApiKeys','desc','ACTIVE','updateUser','fullName','status','findUnique','1372000RvoWpw','bcryptjs','password','Username\x20already\x20exists','wallets','UserService','username','../config/database','default','telegram','gateways','296028JjrOqr','randomBytes','usdcPolygonWallet','publicKey','stringify','hex','crypto','90mHdAqA','usdtErcWallet','Telegram\x20username\x20already\x20exists','parse','usdtPolygonWallet','shop','createUser','sk_','854160vLKCdA','gatewaySettings','hash'];a57_0x58bc=function(){return _0x4fd3f8;};return a57_0x58bc();}const bcryptjs_1=__importDefault(require(a57_0x22e0ec(0x139))),crypto_1=__importDefault(require(a57_0x22e0ec(0x149))),database_1=__importDefault(require(a57_0x22e0ec(0x13f)));class UserService{[a57_0x22e0ec(0x131)](){const _0x2689fe=a57_0x22e0ec,_0x410d6b='pk_'+crypto_1['default'][_0x2689fe(0x144)](0x20)['toString'](_0x2689fe(0x148)),_0x5292a3=_0x2689fe(0x151)+crypto_1[_0x2689fe(0x140)][_0x2689fe(0x144)](0x20)['toString'](_0x2689fe(0x148));return{'publicKey':_0x410d6b,'secretKey':_0x5292a3};}async[a57_0x22e0ec(0x150)](_0x10e92a){const _0x429ad6=a57_0x22e0ec,{fullName:_0x1d4766,username:_0x1f7e54,password:_0x1b621b,telegramId:_0x3e0e21,merchantUrl:_0x1b28aa,gateways:_0x39f002,gatewaySettings:_0x349038,wallets:_0x464b2a}=_0x10e92a,_0xba29aa=await database_1[_0x429ad6(0x140)][_0x429ad6(0x14f)][_0x429ad6(0x137)]({'where':{'username':_0x1f7e54}});if(_0xba29aa)throw new Error(_0x429ad6(0x13b));if(_0x3e0e21){const _0x37b5b8=await database_1['default'][_0x429ad6(0x14f)][_0x429ad6(0x137)]({'where':{'telegram':_0x3e0e21}});if(_0x37b5b8)throw new Error(_0x429ad6(0x14c));}const _0xdac5e5=await bcryptjs_1['default'][_0x429ad6(0x154)](_0x1b621b,0xc),{publicKey:_0x33461f,secretKey:_0x2a3390}=this[_0x429ad6(0x131)](),_0x3318ab=await database_1[_0x429ad6(0x140)]['shop'][_0x429ad6(0x12b)]({'data':{'name':_0x1d4766,'username':_0x1f7e54,'password':_0xdac5e5,'telegram':_0x3e0e21,'shopUrl':_0x1b28aa,'paymentGateways':_0x39f002?JSON[_0x429ad6(0x147)](_0x39f002):null,'gatewaySettings':_0x349038?JSON[_0x429ad6(0x147)](_0x349038):null,'usdtPolygonWallet':_0x464b2a?.[_0x429ad6(0x14e)]||null,'usdtTrcWallet':_0x464b2a?.['usdtTrcWallet']||null,'usdtErcWallet':_0x464b2a?.['usdtErcWallet']||null,'usdcPolygonWallet':_0x464b2a?.[_0x429ad6(0x145)]||null,'publicKey':_0x33461f,'secretKey':_0x2a3390,'status':_0x429ad6(0x133)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x3318ab['id'],'fullName':_0x3318ab[_0x429ad6(0x128)],'username':_0x3318ab['username'],'telegramId':_0x3318ab[_0x429ad6(0x141)],'merchantUrl':_0x3318ab[_0x429ad6(0x129)],'gateways':_0x3318ab[_0x429ad6(0x15b)]?JSON[_0x429ad6(0x14d)](_0x3318ab['paymentGateways']):null,'gatewaySettings':_0x3318ab['gatewaySettings']?JSON[_0x429ad6(0x14d)](_0x3318ab[_0x429ad6(0x153)]):null,'publicKey':_0x3318ab[_0x429ad6(0x146)],'wallets':{'usdtPolygonWallet':_0x3318ab[_0x429ad6(0x14e)],'usdtTrcWallet':_0x3318ab[_0x429ad6(0x159)],'usdtErcWallet':_0x3318ab[_0x429ad6(0x14b)],'usdcPolygonWallet':_0x3318ab[_0x429ad6(0x145)]},'status':_0x3318ab[_0x429ad6(0x136)],'createdAt':_0x3318ab[_0x429ad6(0x156)]};}async[a57_0x22e0ec(0x15d)](){const _0x13a38f=a57_0x22e0ec,_0x554c33=await database_1[_0x13a38f(0x140)]['shop']['findMany']({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x13a38f(0x132)}});return _0x554c33[_0x13a38f(0x130)](_0x499676=>({'id':_0x499676['id'],'fullName':_0x499676['name'],'username':_0x499676[_0x13a38f(0x13e)],'telegramId':_0x499676[_0x13a38f(0x141)],'merchantUrl':_0x499676[_0x13a38f(0x129)],'gateways':_0x499676[_0x13a38f(0x15b)]?JSON['parse'](_0x499676[_0x13a38f(0x15b)]):null,'gatewaySettings':_0x499676[_0x13a38f(0x153)]?JSON[_0x13a38f(0x14d)](_0x499676[_0x13a38f(0x153)]):null,'publicKey':_0x499676['publicKey'],'wallets':{'usdtPolygonWallet':_0x499676[_0x13a38f(0x14e)],'usdtTrcWallet':_0x499676[_0x13a38f(0x159)],'usdtErcWallet':_0x499676['usdtErcWallet'],'usdcPolygonWallet':_0x499676[_0x13a38f(0x145)]},'status':_0x499676[_0x13a38f(0x136)],'createdAt':_0x499676['createdAt']}));}async[a57_0x22e0ec(0x15c)](_0x5f601){const _0x2ea0d7=a57_0x22e0ec,_0x49ca06=await database_1[_0x2ea0d7(0x140)]['shop']['findUnique']({'where':{'id':_0x5f601},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x49ca06)return null;return{'id':_0x49ca06['id'],'fullName':_0x49ca06[_0x2ea0d7(0x128)],'username':_0x49ca06[_0x2ea0d7(0x13e)],'telegramId':_0x49ca06[_0x2ea0d7(0x141)],'merchantUrl':_0x49ca06[_0x2ea0d7(0x129)],'gateways':_0x49ca06['paymentGateways']?JSON[_0x2ea0d7(0x14d)](_0x49ca06[_0x2ea0d7(0x15b)]):null,'gatewaySettings':_0x49ca06[_0x2ea0d7(0x153)]?JSON['parse'](_0x49ca06[_0x2ea0d7(0x153)]):null,'publicKey':_0x49ca06[_0x2ea0d7(0x146)],'wallets':{'usdtPolygonWallet':_0x49ca06[_0x2ea0d7(0x14e)],'usdtTrcWallet':_0x49ca06[_0x2ea0d7(0x159)],'usdtErcWallet':_0x49ca06[_0x2ea0d7(0x14b)],'usdcPolygonWallet':_0x49ca06[_0x2ea0d7(0x145)]},'status':_0x49ca06[_0x2ea0d7(0x136)],'createdAt':_0x49ca06['createdAt']};}async[a57_0x22e0ec(0x134)](_0x493714,_0xb8e530){const _0x2fcb80=a57_0x22e0ec,_0x40948b={..._0xb8e530};_0xb8e530[_0x2fcb80(0x13a)]&&(_0x40948b[_0x2fcb80(0x13a)]=await bcryptjs_1['default'][_0x2fcb80(0x154)](_0xb8e530[_0x2fcb80(0x13a)],0xc));_0xb8e530['fullName']&&(_0x40948b['name']=_0xb8e530[_0x2fcb80(0x135)],delete _0x40948b[_0x2fcb80(0x135)]);_0xb8e530[_0x2fcb80(0x158)]&&(_0x40948b[_0x2fcb80(0x141)]=_0xb8e530[_0x2fcb80(0x158)],delete _0x40948b[_0x2fcb80(0x158)]);_0xb8e530[_0x2fcb80(0x12d)]&&(_0x40948b['shopUrl']=_0xb8e530[_0x2fcb80(0x12d)],delete _0x40948b['merchantUrl']);_0xb8e530[_0x2fcb80(0x142)]&&(_0x40948b[_0x2fcb80(0x15b)]=JSON[_0x2fcb80(0x147)](_0xb8e530[_0x2fcb80(0x142)]),delete _0x40948b[_0x2fcb80(0x142)]);_0xb8e530['gatewaySettings']&&(_0x40948b[_0x2fcb80(0x153)]=JSON[_0x2fcb80(0x147)](_0xb8e530[_0x2fcb80(0x153)]),delete _0x40948b[_0x2fcb80(0x153)]);_0xb8e530[_0x2fcb80(0x13c)]&&(_0xb8e530[_0x2fcb80(0x13c)][_0x2fcb80(0x14e)]!==undefined&&(_0x40948b[_0x2fcb80(0x14e)]=_0xb8e530[_0x2fcb80(0x13c)][_0x2fcb80(0x14e)]||null),_0xb8e530['wallets']['usdtTrcWallet']!==undefined&&(_0x40948b[_0x2fcb80(0x159)]=_0xb8e530[_0x2fcb80(0x13c)][_0x2fcb80(0x159)]||null),_0xb8e530['wallets'][_0x2fcb80(0x14b)]!==undefined&&(_0x40948b[_0x2fcb80(0x14b)]=_0xb8e530[_0x2fcb80(0x13c)][_0x2fcb80(0x14b)]||null),_0xb8e530[_0x2fcb80(0x13c)][_0x2fcb80(0x145)]!==undefined&&(_0x40948b['usdcPolygonWallet']=_0xb8e530['wallets'][_0x2fcb80(0x145)]||null),delete _0x40948b[_0x2fcb80(0x13c)]);const _0x3f18ef=await database_1['default']['shop'][_0x2fcb80(0x127)]({'where':{'id':_0x493714},'data':_0x40948b,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x3f18ef['id'],'fullName':_0x3f18ef[_0x2fcb80(0x128)],'username':_0x3f18ef['username'],'telegramId':_0x3f18ef[_0x2fcb80(0x141)],'merchantUrl':_0x3f18ef[_0x2fcb80(0x129)],'gateways':_0x3f18ef['paymentGateways']?JSON[_0x2fcb80(0x14d)](_0x3f18ef[_0x2fcb80(0x15b)]):null,'gatewaySettings':_0x3f18ef[_0x2fcb80(0x153)]?JSON[_0x2fcb80(0x14d)](_0x3f18ef['gatewaySettings']):null,'publicKey':_0x3f18ef[_0x2fcb80(0x146)],'wallets':{'usdtPolygonWallet':_0x3f18ef['usdtPolygonWallet'],'usdtTrcWallet':_0x3f18ef[_0x2fcb80(0x159)],'usdtErcWallet':_0x3f18ef[_0x2fcb80(0x14b)],'usdcPolygonWallet':_0x3f18ef[_0x2fcb80(0x145)]},'status':_0x3f18ef[_0x2fcb80(0x136)],'createdAt':_0x3f18ef[_0x2fcb80(0x156)]};}async['deleteUser'](_0x1b2fd3){const _0x509e0f=a57_0x22e0ec;await database_1['default'][_0x509e0f(0x14f)]['delete']({'where':{'id':_0x1b2fd3}});}}exports[a57_0x22e0ec(0x13d)]=UserService;