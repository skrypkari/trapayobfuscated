'use strict';const a51_0x52e829=a51_0x2b93;(function(_0x51057e,_0x4cfe37){const _0x1b0c52=a51_0x2b93,_0x4d91b1=_0x51057e();while(!![]){try{const _0x3d280f=-parseInt(_0x1b0c52(0x1db))/0x1+-parseInt(_0x1b0c52(0x1cd))/0x2+parseInt(_0x1b0c52(0x1c7))/0x3+parseInt(_0x1b0c52(0x1de))/0x4*(parseInt(_0x1b0c52(0x1cc))/0x5)+-parseInt(_0x1b0c52(0x1ca))/0x6*(parseInt(_0x1b0c52(0x1d0))/0x7)+-parseInt(_0x1b0c52(0x1c1))/0x8+parseInt(_0x1b0c52(0x1d1))/0x9*(parseInt(_0x1b0c52(0x1df))/0xa);if(_0x3d280f===_0x4cfe37)break;else _0x4d91b1['push'](_0x4d91b1['shift']());}catch(_0x2368bc){_0x4d91b1['push'](_0x4d91b1['shift']());}}}(a51_0x37a4,0x1cde5));var __importDefault=this&&this[a51_0x52e829(0x1ed)]||function(_0x19f5b2){const _0x4c4e9d=a51_0x52e829;return _0x19f5b2&&_0x19f5b2[_0x4c4e9d(0x1d9)]?_0x19f5b2:{'default':_0x19f5b2};};Object[a51_0x52e829(0x1dc)](exports,a51_0x52e829(0x1d9),{'value':!![]}),exports['UserService']=void 0x0;const bcryptjs_1=__importDefault(require(a51_0x52e829(0x1e1))),crypto_1=__importDefault(require(a51_0x52e829(0x1e8))),database_1=__importDefault(require(a51_0x52e829(0x1f4)));function a51_0x2b93(_0x1320b3,_0x5d23f1){const _0x37a4b5=a51_0x37a4();return a51_0x2b93=function(_0x2b93a3,_0x23b0f3){_0x2b93a3=_0x2b93a3-0x1be;let _0x27ee02=_0x37a4b5[_0x2b93a3];return _0x27ee02;},a51_0x2b93(_0x1320b3,_0x5d23f1);}class UserService{['generateApiKeys'](){const _0x1b5920=a51_0x52e829,_0x3b102a=_0x1b5920(0x1eb)+crypto_1[_0x1b5920(0x1c0)]['randomBytes'](0x20)['toString'](_0x1b5920(0x1e7)),_0x19d33e='sk_'+crypto_1[_0x1b5920(0x1c0)]['randomBytes'](0x20)[_0x1b5920(0x1f0)]('hex');return{'publicKey':_0x3b102a,'secretKey':_0x19d33e};}async[a51_0x52e829(0x1c5)](_0x4c7d85){const _0x366b8b=a51_0x52e829,{fullName:_0x3a1f7e,username:_0x40af00,password:_0x2857cb,telegramId:_0x4a6d0c,merchantUrl:_0x5d7616,gateways:_0x28fbf2,gatewaySettings:_0x1ed5d4,wallets:_0x113058}=_0x4c7d85,_0x412a0f=await database_1[_0x366b8b(0x1c0)][_0x366b8b(0x1f2)][_0x366b8b(0x1da)]({'where':{'username':_0x40af00}});if(_0x412a0f)throw new Error(_0x366b8b(0x1d8));if(_0x4a6d0c){const _0x31bf75=await database_1[_0x366b8b(0x1c0)][_0x366b8b(0x1f2)][_0x366b8b(0x1da)]({'where':{'telegram':_0x4a6d0c}});if(_0x31bf75)throw new Error('Telegram\x20username\x20already\x20exists');}const _0xd0e1d6=await bcryptjs_1[_0x366b8b(0x1c0)][_0x366b8b(0x1ce)](_0x2857cb,0xc),{publicKey:_0x4e7d0a,secretKey:_0x49428d}=this[_0x366b8b(0x1e9)](),_0x1bb6d1=await database_1[_0x366b8b(0x1c0)]['shop'][_0x366b8b(0x1d6)]({'data':{'name':_0x3a1f7e,'username':_0x40af00,'password':_0xd0e1d6,'telegram':_0x4a6d0c,'shopUrl':_0x5d7616,'paymentGateways':_0x28fbf2?JSON['stringify'](_0x28fbf2):null,'gatewaySettings':_0x1ed5d4?JSON[_0x366b8b(0x1e4)](_0x1ed5d4):null,'usdtPolygonWallet':_0x113058?.[_0x366b8b(0x1f1)]||null,'usdtTrcWallet':_0x113058?.[_0x366b8b(0x1d3)]||null,'usdtErcWallet':_0x113058?.['usdtErcWallet']||null,'usdcPolygonWallet':_0x113058?.[_0x366b8b(0x1d5)]||null,'publicKey':_0x4e7d0a,'secretKey':_0x49428d,'status':_0x366b8b(0x1e5)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x1bb6d1['id'],'fullName':_0x1bb6d1['name'],'username':_0x1bb6d1[_0x366b8b(0x1c2)],'telegramId':_0x1bb6d1['telegram'],'merchantUrl':_0x1bb6d1[_0x366b8b(0x1ec)],'gateways':_0x1bb6d1[_0x366b8b(0x1d2)]?JSON[_0x366b8b(0x1c4)](_0x1bb6d1[_0x366b8b(0x1d2)]):null,'gatewaySettings':_0x1bb6d1[_0x366b8b(0x1e2)]?JSON['parse'](_0x1bb6d1['gatewaySettings']):null,'publicKey':_0x1bb6d1['publicKey'],'wallets':{'usdtPolygonWallet':_0x1bb6d1[_0x366b8b(0x1f1)],'usdtTrcWallet':_0x1bb6d1[_0x366b8b(0x1d3)],'usdtErcWallet':_0x1bb6d1[_0x366b8b(0x1cb)],'usdcPolygonWallet':_0x1bb6d1[_0x366b8b(0x1d5)]},'status':_0x1bb6d1[_0x366b8b(0x1e0)],'createdAt':_0x1bb6d1[_0x366b8b(0x1c9)]};}async[a51_0x52e829(0x1be)](){const _0x304dd8=a51_0x52e829,_0x3d38cb=await database_1[_0x304dd8(0x1c0)]['shop'][_0x304dd8(0x1cf)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':'desc'}});return _0x3d38cb[_0x304dd8(0x1e6)](_0x1b2f24=>({'id':_0x1b2f24['id'],'fullName':_0x1b2f24[_0x304dd8(0x1bf)],'username':_0x1b2f24[_0x304dd8(0x1c2)],'telegramId':_0x1b2f24[_0x304dd8(0x1d7)],'merchantUrl':_0x1b2f24[_0x304dd8(0x1ec)],'gateways':_0x1b2f24['paymentGateways']?JSON[_0x304dd8(0x1c4)](_0x1b2f24[_0x304dd8(0x1d2)]):null,'gatewaySettings':_0x1b2f24[_0x304dd8(0x1e2)]?JSON['parse'](_0x1b2f24[_0x304dd8(0x1e2)]):null,'publicKey':_0x1b2f24['publicKey'],'wallets':{'usdtPolygonWallet':_0x1b2f24['usdtPolygonWallet'],'usdtTrcWallet':_0x1b2f24['usdtTrcWallet'],'usdtErcWallet':_0x1b2f24[_0x304dd8(0x1cb)],'usdcPolygonWallet':_0x1b2f24['usdcPolygonWallet']},'status':_0x1b2f24[_0x304dd8(0x1e0)],'createdAt':_0x1b2f24['createdAt']}));}async[a51_0x52e829(0x1c6)](_0x473f0e){const _0x4efeb4=a51_0x52e829,_0x4138ec=await database_1['default'][_0x4efeb4(0x1f2)]['findUnique']({'where':{'id':_0x473f0e},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x4138ec)return null;return{'id':_0x4138ec['id'],'fullName':_0x4138ec[_0x4efeb4(0x1bf)],'username':_0x4138ec[_0x4efeb4(0x1c2)],'telegramId':_0x4138ec[_0x4efeb4(0x1d7)],'merchantUrl':_0x4138ec[_0x4efeb4(0x1ec)],'gateways':_0x4138ec[_0x4efeb4(0x1d2)]?JSON[_0x4efeb4(0x1c4)](_0x4138ec[_0x4efeb4(0x1d2)]):null,'gatewaySettings':_0x4138ec[_0x4efeb4(0x1e2)]?JSON[_0x4efeb4(0x1c4)](_0x4138ec['gatewaySettings']):null,'publicKey':_0x4138ec[_0x4efeb4(0x1c3)],'wallets':{'usdtPolygonWallet':_0x4138ec[_0x4efeb4(0x1f1)],'usdtTrcWallet':_0x4138ec[_0x4efeb4(0x1d3)],'usdtErcWallet':_0x4138ec[_0x4efeb4(0x1cb)],'usdcPolygonWallet':_0x4138ec[_0x4efeb4(0x1d5)]},'status':_0x4138ec[_0x4efeb4(0x1e0)],'createdAt':_0x4138ec[_0x4efeb4(0x1c9)]};}async['updateUser'](_0x1336d9,_0x4c9465){const _0x4b5242=a51_0x52e829,_0x3c8d34={..._0x4c9465};_0x4c9465[_0x4b5242(0x1d4)]&&(_0x3c8d34[_0x4b5242(0x1d4)]=await bcryptjs_1['default']['hash'](_0x4c9465[_0x4b5242(0x1d4)],0xc));_0x4c9465[_0x4b5242(0x1ea)]&&(_0x3c8d34[_0x4b5242(0x1bf)]=_0x4c9465['fullName'],delete _0x3c8d34['fullName']);_0x4c9465[_0x4b5242(0x1f3)]&&(_0x3c8d34['telegram']=_0x4c9465['telegramId'],delete _0x3c8d34[_0x4b5242(0x1f3)]);_0x4c9465[_0x4b5242(0x1dd)]&&(_0x3c8d34['shopUrl']=_0x4c9465[_0x4b5242(0x1dd)],delete _0x3c8d34[_0x4b5242(0x1dd)]);_0x4c9465[_0x4b5242(0x1e3)]&&(_0x3c8d34['paymentGateways']=JSON[_0x4b5242(0x1e4)](_0x4c9465[_0x4b5242(0x1e3)]),delete _0x3c8d34[_0x4b5242(0x1e3)]);_0x4c9465[_0x4b5242(0x1e2)]&&(_0x3c8d34[_0x4b5242(0x1e2)]=JSON[_0x4b5242(0x1e4)](_0x4c9465[_0x4b5242(0x1e2)]),delete _0x3c8d34[_0x4b5242(0x1e2)]);_0x4c9465[_0x4b5242(0x1c8)]&&(_0x4c9465[_0x4b5242(0x1c8)][_0x4b5242(0x1f1)]!==undefined&&(_0x3c8d34[_0x4b5242(0x1f1)]=_0x4c9465[_0x4b5242(0x1c8)][_0x4b5242(0x1f1)]||null),_0x4c9465[_0x4b5242(0x1c8)][_0x4b5242(0x1d3)]!==undefined&&(_0x3c8d34[_0x4b5242(0x1d3)]=_0x4c9465['wallets'][_0x4b5242(0x1d3)]||null),_0x4c9465[_0x4b5242(0x1c8)][_0x4b5242(0x1cb)]!==undefined&&(_0x3c8d34[_0x4b5242(0x1cb)]=_0x4c9465['wallets'][_0x4b5242(0x1cb)]||null),_0x4c9465['wallets'][_0x4b5242(0x1d5)]!==undefined&&(_0x3c8d34['usdcPolygonWallet']=_0x4c9465[_0x4b5242(0x1c8)]['usdcPolygonWallet']||null),delete _0x3c8d34[_0x4b5242(0x1c8)]);const _0x2455a0=await database_1[_0x4b5242(0x1c0)]['shop']['update']({'where':{'id':_0x1336d9},'data':_0x3c8d34,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x2455a0['id'],'fullName':_0x2455a0['name'],'username':_0x2455a0[_0x4b5242(0x1c2)],'telegramId':_0x2455a0[_0x4b5242(0x1d7)],'merchantUrl':_0x2455a0['shopUrl'],'gateways':_0x2455a0[_0x4b5242(0x1d2)]?JSON['parse'](_0x2455a0[_0x4b5242(0x1d2)]):null,'gatewaySettings':_0x2455a0[_0x4b5242(0x1e2)]?JSON[_0x4b5242(0x1c4)](_0x2455a0[_0x4b5242(0x1e2)]):null,'publicKey':_0x2455a0[_0x4b5242(0x1c3)],'wallets':{'usdtPolygonWallet':_0x2455a0[_0x4b5242(0x1f1)],'usdtTrcWallet':_0x2455a0['usdtTrcWallet'],'usdtErcWallet':_0x2455a0[_0x4b5242(0x1cb)],'usdcPolygonWallet':_0x2455a0[_0x4b5242(0x1d5)]},'status':_0x2455a0[_0x4b5242(0x1e0)],'createdAt':_0x2455a0[_0x4b5242(0x1c9)]};}async[a51_0x52e829(0x1ee)](_0x326cb7){const _0x34903b=a51_0x52e829;await database_1['default'][_0x34903b(0x1f2)][_0x34903b(0x1ef)]({'where':{'id':_0x326cb7}});}}exports['UserService']=UserService;function a51_0x37a4(){const _0x5a9168=['bcryptjs','gatewaySettings','gateways','stringify','ACTIVE','map','hex','crypto','generateApiKeys','fullName','pk_','shopUrl','__importDefault','deleteUser','delete','toString','usdtPolygonWallet','shop','telegramId','../config/database','getAllUsers','name','default','1326440HPYCJA','username','publicKey','parse','createUser','getUserById','327315JsGCOb','wallets','createdAt','120138uuCKhL','usdtErcWallet','570820usNPZA','272516ZsnJLL','hash','findMany','77nNrtsO','12762IqATaR','paymentGateways','usdtTrcWallet','password','usdcPolygonWallet','create','telegram','Username\x20already\x20exists','__esModule','findUnique','44976YAIOwD','defineProperty','merchantUrl','4rvfPBD','3260tdlAMS','status'];a51_0x37a4=function(){return _0x5a9168;};return a51_0x37a4();}