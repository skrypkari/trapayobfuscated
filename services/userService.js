'use strict';const a56_0x31ad68=a56_0x2116;function a56_0x5b85(){const _0xc06ad3=['generateApiKeys','findMany','telegramId','bcryptjs','desc','10pqDcbv','default','delete','gateways','defineProperty','findUnique','publicKey','1087650dJhALA','wallets','name','deleteUser','100353Johgxw','__esModule','2107572ybbaQZ','650252SzVExO','8ubRNfJ','password','status','gatewaySettings','updateUser','parse','pk_','fullName','shop','randomBytes','createUser','shopUrl','crypto','462288JDdqUH','username','usdcPolygonWallet','paymentGateways','hex','UserService','stringify','createdAt','merchantUrl','usdtTrcWallet','toString','telegram','sk_','hash','map','21tUNshe','17347OOpSit','2627700BnGMwm','usdtPolygonWallet','usdtErcWallet'];a56_0x5b85=function(){return _0xc06ad3;};return a56_0x5b85();}(function(_0x86c7f4,_0x26bddd){const _0x12ea8e=a56_0x2116,_0x362fe8=_0x86c7f4();while(!![]){try{const _0x4cffd5=-parseInt(_0x12ea8e(0x7f))/0x1*(parseInt(_0x12ea8e(0x97))/0x2)+-parseInt(_0x12ea8e(0x93))/0x3+-parseInt(_0x12ea8e(0x96))/0x4*(-parseInt(_0x12ea8e(0x88))/0x5)+parseInt(_0x12ea8e(0x95))/0x6+-parseInt(_0x12ea8e(0x7e))/0x7*(parseInt(_0x12ea8e(0x6f))/0x8)+parseInt(_0x12ea8e(0x8f))/0x9+-parseInt(_0x12ea8e(0x80))/0xa;if(_0x4cffd5===_0x26bddd)break;else _0x362fe8['push'](_0x362fe8['shift']());}catch(_0x3af28b){_0x362fe8['push'](_0x362fe8['shift']());}}}(a56_0x5b85,0x3f0df));function a56_0x2116(_0x43b8d0,_0x49dec4){const _0x5b852a=a56_0x5b85();return a56_0x2116=function(_0x211633,_0x5e0fff){_0x211633=_0x211633-0x66;let _0x214842=_0x5b852a[_0x211633];return _0x214842;},a56_0x2116(_0x43b8d0,_0x49dec4);}var __importDefault=this&&this['__importDefault']||function(_0x4a660f){const _0x3f7b64=a56_0x2116;return _0x4a660f&&_0x4a660f[_0x3f7b64(0x94)]?_0x4a660f:{'default':_0x4a660f};};Object[a56_0x31ad68(0x8c)](exports,'__esModule',{'value':!![]}),exports[a56_0x31ad68(0x74)]=void 0x0;const bcryptjs_1=__importDefault(require(a56_0x31ad68(0x86))),crypto_1=__importDefault(require(a56_0x31ad68(0x6e))),database_1=__importDefault(require('../config/database'));class UserService{[a56_0x31ad68(0x83)](){const _0xa3e664=a56_0x31ad68,_0x5c6f4b=_0xa3e664(0x68)+crypto_1[_0xa3e664(0x89)][_0xa3e664(0x6b)](0x20)[_0xa3e664(0x79)](_0xa3e664(0x73)),_0x3fefae=_0xa3e664(0x7b)+crypto_1[_0xa3e664(0x89)][_0xa3e664(0x6b)](0x20)['toString'](_0xa3e664(0x73));return{'publicKey':_0x5c6f4b,'secretKey':_0x3fefae};}async[a56_0x31ad68(0x6c)](_0x131dbd){const _0x331621=a56_0x31ad68,{fullName:_0x23a4d6,username:_0x2d55df,password:_0x326ce7,telegramId:_0x35eaf0,merchantUrl:_0x5f5301,gateways:_0x22820a,gatewaySettings:_0x43df00,wallets:_0x2afb69}=_0x131dbd,_0x15f2c9=await database_1[_0x331621(0x89)]['shop']['findUnique']({'where':{'username':_0x2d55df}});if(_0x15f2c9)throw new Error('Username\x20already\x20exists');if(_0x35eaf0){const _0x450ef4=await database_1[_0x331621(0x89)]['shop']['findUnique']({'where':{'telegram':_0x35eaf0}});if(_0x450ef4)throw new Error('Telegram\x20username\x20already\x20exists');}const _0x15364d=await bcryptjs_1[_0x331621(0x89)][_0x331621(0x7c)](_0x326ce7,0xc),{publicKey:_0x1e463e,secretKey:_0x1e2d58}=this[_0x331621(0x83)](),_0x54186a=await database_1[_0x331621(0x89)][_0x331621(0x6a)]['create']({'data':{'name':_0x23a4d6,'username':_0x2d55df,'password':_0x15364d,'telegram':_0x35eaf0,'shopUrl':_0x5f5301,'paymentGateways':_0x22820a?JSON['stringify'](_0x22820a):null,'gatewaySettings':_0x43df00?JSON[_0x331621(0x75)](_0x43df00):null,'usdtPolygonWallet':_0x2afb69?.[_0x331621(0x81)]||null,'usdtTrcWallet':_0x2afb69?.['usdtTrcWallet']||null,'usdtErcWallet':_0x2afb69?.[_0x331621(0x82)]||null,'usdcPolygonWallet':_0x2afb69?.[_0x331621(0x71)]||null,'publicKey':_0x1e463e,'secretKey':_0x1e2d58,'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x54186a['id'],'fullName':_0x54186a[_0x331621(0x91)],'username':_0x54186a[_0x331621(0x70)],'telegramId':_0x54186a[_0x331621(0x7a)],'merchantUrl':_0x54186a[_0x331621(0x6d)],'gateways':_0x54186a['paymentGateways']?JSON[_0x331621(0x67)](_0x54186a[_0x331621(0x72)]):null,'gatewaySettings':_0x54186a[_0x331621(0x9a)]?JSON['parse'](_0x54186a[_0x331621(0x9a)]):null,'publicKey':_0x54186a[_0x331621(0x8e)],'wallets':{'usdtPolygonWallet':_0x54186a['usdtPolygonWallet'],'usdtTrcWallet':_0x54186a['usdtTrcWallet'],'usdtErcWallet':_0x54186a[_0x331621(0x82)],'usdcPolygonWallet':_0x54186a[_0x331621(0x71)]},'status':_0x54186a[_0x331621(0x99)],'createdAt':_0x54186a[_0x331621(0x76)]};}async['getAllUsers'](){const _0x2529bd=a56_0x31ad68,_0x340a0f=await database_1[_0x2529bd(0x89)][_0x2529bd(0x6a)][_0x2529bd(0x84)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x2529bd(0x87)}});return _0x340a0f[_0x2529bd(0x7d)](_0x2c3417=>({'id':_0x2c3417['id'],'fullName':_0x2c3417[_0x2529bd(0x91)],'username':_0x2c3417['username'],'telegramId':_0x2c3417['telegram'],'merchantUrl':_0x2c3417['shopUrl'],'gateways':_0x2c3417[_0x2529bd(0x72)]?JSON[_0x2529bd(0x67)](_0x2c3417[_0x2529bd(0x72)]):null,'gatewaySettings':_0x2c3417[_0x2529bd(0x9a)]?JSON[_0x2529bd(0x67)](_0x2c3417[_0x2529bd(0x9a)]):null,'publicKey':_0x2c3417[_0x2529bd(0x8e)],'wallets':{'usdtPolygonWallet':_0x2c3417[_0x2529bd(0x81)],'usdtTrcWallet':_0x2c3417[_0x2529bd(0x78)],'usdtErcWallet':_0x2c3417[_0x2529bd(0x82)],'usdcPolygonWallet':_0x2c3417[_0x2529bd(0x71)]},'status':_0x2c3417[_0x2529bd(0x99)],'createdAt':_0x2c3417[_0x2529bd(0x76)]}));}async['getUserById'](_0x382942){const _0x1eccdf=a56_0x31ad68,_0x140b2d=await database_1[_0x1eccdf(0x89)][_0x1eccdf(0x6a)][_0x1eccdf(0x8d)]({'where':{'id':_0x382942},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x140b2d)return null;return{'id':_0x140b2d['id'],'fullName':_0x140b2d['name'],'username':_0x140b2d[_0x1eccdf(0x70)],'telegramId':_0x140b2d[_0x1eccdf(0x7a)],'merchantUrl':_0x140b2d[_0x1eccdf(0x6d)],'gateways':_0x140b2d[_0x1eccdf(0x72)]?JSON[_0x1eccdf(0x67)](_0x140b2d['paymentGateways']):null,'gatewaySettings':_0x140b2d['gatewaySettings']?JSON['parse'](_0x140b2d[_0x1eccdf(0x9a)]):null,'publicKey':_0x140b2d[_0x1eccdf(0x8e)],'wallets':{'usdtPolygonWallet':_0x140b2d[_0x1eccdf(0x81)],'usdtTrcWallet':_0x140b2d[_0x1eccdf(0x78)],'usdtErcWallet':_0x140b2d[_0x1eccdf(0x82)],'usdcPolygonWallet':_0x140b2d[_0x1eccdf(0x71)]},'status':_0x140b2d[_0x1eccdf(0x99)],'createdAt':_0x140b2d[_0x1eccdf(0x76)]};}async[a56_0x31ad68(0x66)](_0x5508d4,_0x17e8c0){const _0x57b2c4=a56_0x31ad68,_0x151448={..._0x17e8c0};_0x17e8c0['password']&&(_0x151448[_0x57b2c4(0x98)]=await bcryptjs_1[_0x57b2c4(0x89)][_0x57b2c4(0x7c)](_0x17e8c0['password'],0xc));_0x17e8c0[_0x57b2c4(0x69)]&&(_0x151448[_0x57b2c4(0x91)]=_0x17e8c0[_0x57b2c4(0x69)],delete _0x151448[_0x57b2c4(0x69)]);_0x17e8c0['telegramId']&&(_0x151448['telegram']=_0x17e8c0[_0x57b2c4(0x85)],delete _0x151448[_0x57b2c4(0x85)]);_0x17e8c0[_0x57b2c4(0x77)]&&(_0x151448[_0x57b2c4(0x6d)]=_0x17e8c0[_0x57b2c4(0x77)],delete _0x151448['merchantUrl']);_0x17e8c0['gateways']&&(_0x151448['paymentGateways']=JSON[_0x57b2c4(0x75)](_0x17e8c0[_0x57b2c4(0x8b)]),delete _0x151448[_0x57b2c4(0x8b)]);_0x17e8c0['gatewaySettings']&&(_0x151448[_0x57b2c4(0x9a)]=JSON[_0x57b2c4(0x75)](_0x17e8c0[_0x57b2c4(0x9a)]),delete _0x151448[_0x57b2c4(0x9a)]);_0x17e8c0[_0x57b2c4(0x90)]&&(_0x17e8c0[_0x57b2c4(0x90)]['usdtPolygonWallet']!==undefined&&(_0x151448['usdtPolygonWallet']=_0x17e8c0[_0x57b2c4(0x90)][_0x57b2c4(0x81)]||null),_0x17e8c0[_0x57b2c4(0x90)][_0x57b2c4(0x78)]!==undefined&&(_0x151448[_0x57b2c4(0x78)]=_0x17e8c0[_0x57b2c4(0x90)][_0x57b2c4(0x78)]||null),_0x17e8c0[_0x57b2c4(0x90)][_0x57b2c4(0x82)]!==undefined&&(_0x151448[_0x57b2c4(0x82)]=_0x17e8c0[_0x57b2c4(0x90)][_0x57b2c4(0x82)]||null),_0x17e8c0[_0x57b2c4(0x90)][_0x57b2c4(0x71)]!==undefined&&(_0x151448['usdcPolygonWallet']=_0x17e8c0['wallets'][_0x57b2c4(0x71)]||null),delete _0x151448['wallets']);const _0x253c18=await database_1[_0x57b2c4(0x89)][_0x57b2c4(0x6a)]['update']({'where':{'id':_0x5508d4},'data':_0x151448,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x253c18['id'],'fullName':_0x253c18['name'],'username':_0x253c18[_0x57b2c4(0x70)],'telegramId':_0x253c18[_0x57b2c4(0x7a)],'merchantUrl':_0x253c18[_0x57b2c4(0x6d)],'gateways':_0x253c18[_0x57b2c4(0x72)]?JSON['parse'](_0x253c18[_0x57b2c4(0x72)]):null,'gatewaySettings':_0x253c18[_0x57b2c4(0x9a)]?JSON[_0x57b2c4(0x67)](_0x253c18[_0x57b2c4(0x9a)]):null,'publicKey':_0x253c18['publicKey'],'wallets':{'usdtPolygonWallet':_0x253c18[_0x57b2c4(0x81)],'usdtTrcWallet':_0x253c18[_0x57b2c4(0x78)],'usdtErcWallet':_0x253c18[_0x57b2c4(0x82)],'usdcPolygonWallet':_0x253c18[_0x57b2c4(0x71)]},'status':_0x253c18[_0x57b2c4(0x99)],'createdAt':_0x253c18[_0x57b2c4(0x76)]};}async[a56_0x31ad68(0x92)](_0x581bce){const _0xc25482=a56_0x31ad68;await database_1[_0xc25482(0x89)][_0xc25482(0x6a)][_0xc25482(0x8a)]({'where':{'id':_0x581bce}});}}exports[a56_0x31ad68(0x74)]=UserService;