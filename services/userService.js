'use strict';const a59_0x3f8dea=a59_0x30a2;function a59_0x30a2(_0x1e81fc,_0x2366e0){const _0x3c4f54=a59_0x3c4f();return a59_0x30a2=function(_0x30a219,_0x479f42){_0x30a219=_0x30a219-0x199;let _0x1a5f27=_0x3c4f54[_0x30a219];return _0x1a5f27;},a59_0x30a2(_0x1e81fc,_0x2366e0);}(function(_0x1a3bb7,_0x552a2f){const _0x185eac=a59_0x30a2,_0x232335=_0x1a3bb7();while(!![]){try{const _0x2238b4=-parseInt(_0x185eac(0x1a0))/0x1*(-parseInt(_0x185eac(0x1c8))/0x2)+-parseInt(_0x185eac(0x19a))/0x3+parseInt(_0x185eac(0x1c6))/0x4+-parseInt(_0x185eac(0x1c1))/0x5*(parseInt(_0x185eac(0x1ac))/0x6)+parseInt(_0x185eac(0x1cd))/0x7+-parseInt(_0x185eac(0x1b9))/0x8+parseInt(_0x185eac(0x1ab))/0x9;if(_0x2238b4===_0x552a2f)break;else _0x232335['push'](_0x232335['shift']());}catch(_0x449619){_0x232335['push'](_0x232335['shift']());}}}(a59_0x3c4f,0x894a6));function a59_0x3c4f(){const _0x462294=['__esModule','deleteUser','shopUrl','updateUser','../config/database','merchantUrl','hex','fullName','12635712ZBwBdx','30tJdsZk','parse','telegram','createUser','Telegram\x20username\x20already\x20exists','shop','pk_','username','randomBytes','usdcPolygonWallet','default','wallets','create','1871736oYHDxO','password','toString','usdtPolygonWallet','findMany','usdtTrcWallet','usdtErcWallet','getAllUsers','569070xCqBac','defineProperty','paymentGateways','publicKey','generateApiKeys','1629496mgozjv','telegramId','274GxwVDz','UserService','gateways','delete','map','2301943HoenCa','status','findUnique','2899425YDDIdz','stringify','createdAt','gatewaySettings','crypto','bcryptjs','1399xSeTXT','sk_','name'];a59_0x3c4f=function(){return _0x462294;};return a59_0x3c4f();}var __importDefault=this&&this['__importDefault']||function(_0x35da70){const _0x2407e2=a59_0x30a2;return _0x35da70&&_0x35da70[_0x2407e2(0x1a3)]?_0x35da70:{'default':_0x35da70};};Object[a59_0x3f8dea(0x1c2)](exports,'__esModule',{'value':!![]}),exports[a59_0x3f8dea(0x1c9)]=void 0x0;const bcryptjs_1=__importDefault(require(a59_0x3f8dea(0x19f))),crypto_1=__importDefault(require(a59_0x3f8dea(0x19e))),database_1=__importDefault(require(a59_0x3f8dea(0x1a7)));class UserService{[a59_0x3f8dea(0x1c5)](){const _0x23e4bc=a59_0x3f8dea,_0x46cc45=_0x23e4bc(0x1b2)+crypto_1['default']['randomBytes'](0x20)[_0x23e4bc(0x1bb)](_0x23e4bc(0x1a9)),_0x16540e=_0x23e4bc(0x1a1)+crypto_1['default'][_0x23e4bc(0x1b4)](0x20)['toString']('hex');return{'publicKey':_0x46cc45,'secretKey':_0x16540e};}async[a59_0x3f8dea(0x1af)](_0x5b2e4e){const _0x2c46bc=a59_0x3f8dea,{fullName:_0x27a6dc,username:_0x80ba4c,password:_0x5830a5,telegramId:_0xca6142,merchantUrl:_0x3baedb,gateways:_0x484e46,gatewaySettings:_0xcfdea5,wallets:_0x19ce18}=_0x5b2e4e,_0x323e4f=await database_1['default'][_0x2c46bc(0x1b1)][_0x2c46bc(0x199)]({'where':{'username':_0x80ba4c}});if(_0x323e4f)throw new Error('Username\x20already\x20exists');if(_0xca6142){const _0x5dedf4=await database_1['default'][_0x2c46bc(0x1b1)][_0x2c46bc(0x199)]({'where':{'telegram':_0xca6142}});if(_0x5dedf4)throw new Error(_0x2c46bc(0x1b0));}const _0xad5ff1=await bcryptjs_1[_0x2c46bc(0x1b6)]['hash'](_0x5830a5,0xc),{publicKey:_0x16ebf1,secretKey:_0x307ef0}=this[_0x2c46bc(0x1c5)](),_0x263dbb=await database_1[_0x2c46bc(0x1b6)][_0x2c46bc(0x1b1)][_0x2c46bc(0x1b8)]({'data':{'name':_0x27a6dc,'username':_0x80ba4c,'password':_0xad5ff1,'telegram':_0xca6142,'shopUrl':_0x3baedb,'paymentGateways':_0x484e46?JSON[_0x2c46bc(0x19b)](_0x484e46):null,'gatewaySettings':_0xcfdea5?JSON[_0x2c46bc(0x19b)](_0xcfdea5):null,'usdtPolygonWallet':_0x19ce18?.[_0x2c46bc(0x1bc)]||null,'usdtTrcWallet':_0x19ce18?.['usdtTrcWallet']||null,'usdtErcWallet':_0x19ce18?.[_0x2c46bc(0x1bf)]||null,'usdcPolygonWallet':_0x19ce18?.[_0x2c46bc(0x1b5)]||null,'publicKey':_0x16ebf1,'secretKey':_0x307ef0,'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x263dbb['id'],'fullName':_0x263dbb[_0x2c46bc(0x1a2)],'username':_0x263dbb[_0x2c46bc(0x1b3)],'telegramId':_0x263dbb[_0x2c46bc(0x1ae)],'merchantUrl':_0x263dbb[_0x2c46bc(0x1a5)],'gateways':_0x263dbb['paymentGateways']?JSON[_0x2c46bc(0x1ad)](_0x263dbb['paymentGateways']):null,'gatewaySettings':_0x263dbb['gatewaySettings']?JSON[_0x2c46bc(0x1ad)](_0x263dbb[_0x2c46bc(0x19d)]):null,'publicKey':_0x263dbb[_0x2c46bc(0x1c4)],'wallets':{'usdtPolygonWallet':_0x263dbb[_0x2c46bc(0x1bc)],'usdtTrcWallet':_0x263dbb['usdtTrcWallet'],'usdtErcWallet':_0x263dbb[_0x2c46bc(0x1bf)],'usdcPolygonWallet':_0x263dbb[_0x2c46bc(0x1b5)]},'status':_0x263dbb[_0x2c46bc(0x1ce)],'createdAt':_0x263dbb[_0x2c46bc(0x19c)]};}async[a59_0x3f8dea(0x1c0)](){const _0xe1ee0=a59_0x3f8dea,_0x54b776=await database_1[_0xe1ee0(0x1b6)][_0xe1ee0(0x1b1)][_0xe1ee0(0x1bd)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':'desc'}});return _0x54b776[_0xe1ee0(0x1cc)](_0x951575=>({'id':_0x951575['id'],'fullName':_0x951575['name'],'username':_0x951575['username'],'telegramId':_0x951575['telegram'],'merchantUrl':_0x951575[_0xe1ee0(0x1a5)],'gateways':_0x951575[_0xe1ee0(0x1c3)]?JSON[_0xe1ee0(0x1ad)](_0x951575[_0xe1ee0(0x1c3)]):null,'gatewaySettings':_0x951575[_0xe1ee0(0x19d)]?JSON[_0xe1ee0(0x1ad)](_0x951575[_0xe1ee0(0x19d)]):null,'publicKey':_0x951575['publicKey'],'wallets':{'usdtPolygonWallet':_0x951575['usdtPolygonWallet'],'usdtTrcWallet':_0x951575[_0xe1ee0(0x1be)],'usdtErcWallet':_0x951575['usdtErcWallet'],'usdcPolygonWallet':_0x951575[_0xe1ee0(0x1b5)]},'status':_0x951575['status'],'createdAt':_0x951575[_0xe1ee0(0x19c)]}));}async['getUserById'](_0x1a7621){const _0x59cca7=a59_0x3f8dea,_0x5a3d89=await database_1[_0x59cca7(0x1b6)]['shop'][_0x59cca7(0x199)]({'where':{'id':_0x1a7621},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x5a3d89)return null;return{'id':_0x5a3d89['id'],'fullName':_0x5a3d89[_0x59cca7(0x1a2)],'username':_0x5a3d89[_0x59cca7(0x1b3)],'telegramId':_0x5a3d89['telegram'],'merchantUrl':_0x5a3d89[_0x59cca7(0x1a5)],'gateways':_0x5a3d89[_0x59cca7(0x1c3)]?JSON['parse'](_0x5a3d89[_0x59cca7(0x1c3)]):null,'gatewaySettings':_0x5a3d89[_0x59cca7(0x19d)]?JSON['parse'](_0x5a3d89[_0x59cca7(0x19d)]):null,'publicKey':_0x5a3d89[_0x59cca7(0x1c4)],'wallets':{'usdtPolygonWallet':_0x5a3d89[_0x59cca7(0x1bc)],'usdtTrcWallet':_0x5a3d89[_0x59cca7(0x1be)],'usdtErcWallet':_0x5a3d89[_0x59cca7(0x1bf)],'usdcPolygonWallet':_0x5a3d89[_0x59cca7(0x1b5)]},'status':_0x5a3d89[_0x59cca7(0x1ce)],'createdAt':_0x5a3d89['createdAt']};}async[a59_0x3f8dea(0x1a6)](_0x5080ae,_0x3008c6){const _0x512a2d=a59_0x3f8dea,_0x2d15ce={..._0x3008c6};_0x3008c6[_0x512a2d(0x1ba)]&&(_0x2d15ce[_0x512a2d(0x1ba)]=await bcryptjs_1['default']['hash'](_0x3008c6[_0x512a2d(0x1ba)],0xc));_0x3008c6[_0x512a2d(0x1aa)]&&(_0x2d15ce[_0x512a2d(0x1a2)]=_0x3008c6[_0x512a2d(0x1aa)],delete _0x2d15ce[_0x512a2d(0x1aa)]);_0x3008c6[_0x512a2d(0x1c7)]&&(_0x2d15ce[_0x512a2d(0x1ae)]=_0x3008c6[_0x512a2d(0x1c7)],delete _0x2d15ce[_0x512a2d(0x1c7)]);_0x3008c6[_0x512a2d(0x1a8)]&&(_0x2d15ce['shopUrl']=_0x3008c6[_0x512a2d(0x1a8)],delete _0x2d15ce[_0x512a2d(0x1a8)]);_0x3008c6[_0x512a2d(0x1ca)]&&(_0x2d15ce[_0x512a2d(0x1c3)]=JSON[_0x512a2d(0x19b)](_0x3008c6[_0x512a2d(0x1ca)]),delete _0x2d15ce['gateways']);_0x3008c6[_0x512a2d(0x19d)]&&(_0x2d15ce[_0x512a2d(0x19d)]=JSON[_0x512a2d(0x19b)](_0x3008c6[_0x512a2d(0x19d)]),delete _0x2d15ce[_0x512a2d(0x19d)]);_0x3008c6['wallets']&&(_0x3008c6[_0x512a2d(0x1b7)][_0x512a2d(0x1bc)]!==undefined&&(_0x2d15ce[_0x512a2d(0x1bc)]=_0x3008c6[_0x512a2d(0x1b7)]['usdtPolygonWallet']||null),_0x3008c6[_0x512a2d(0x1b7)][_0x512a2d(0x1be)]!==undefined&&(_0x2d15ce[_0x512a2d(0x1be)]=_0x3008c6[_0x512a2d(0x1b7)]['usdtTrcWallet']||null),_0x3008c6[_0x512a2d(0x1b7)][_0x512a2d(0x1bf)]!==undefined&&(_0x2d15ce[_0x512a2d(0x1bf)]=_0x3008c6[_0x512a2d(0x1b7)][_0x512a2d(0x1bf)]||null),_0x3008c6[_0x512a2d(0x1b7)][_0x512a2d(0x1b5)]!==undefined&&(_0x2d15ce[_0x512a2d(0x1b5)]=_0x3008c6[_0x512a2d(0x1b7)][_0x512a2d(0x1b5)]||null),delete _0x2d15ce['wallets']);const _0x3dab06=await database_1[_0x512a2d(0x1b6)][_0x512a2d(0x1b1)]['update']({'where':{'id':_0x5080ae},'data':_0x2d15ce,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x3dab06['id'],'fullName':_0x3dab06[_0x512a2d(0x1a2)],'username':_0x3dab06[_0x512a2d(0x1b3)],'telegramId':_0x3dab06['telegram'],'merchantUrl':_0x3dab06[_0x512a2d(0x1a5)],'gateways':_0x3dab06['paymentGateways']?JSON['parse'](_0x3dab06[_0x512a2d(0x1c3)]):null,'gatewaySettings':_0x3dab06[_0x512a2d(0x19d)]?JSON[_0x512a2d(0x1ad)](_0x3dab06[_0x512a2d(0x19d)]):null,'publicKey':_0x3dab06[_0x512a2d(0x1c4)],'wallets':{'usdtPolygonWallet':_0x3dab06[_0x512a2d(0x1bc)],'usdtTrcWallet':_0x3dab06[_0x512a2d(0x1be)],'usdtErcWallet':_0x3dab06['usdtErcWallet'],'usdcPolygonWallet':_0x3dab06[_0x512a2d(0x1b5)]},'status':_0x3dab06[_0x512a2d(0x1ce)],'createdAt':_0x3dab06[_0x512a2d(0x19c)]};}async[a59_0x3f8dea(0x1a4)](_0x3890cb){const _0x1693c8=a59_0x3f8dea;await database_1['default'][_0x1693c8(0x1b1)][_0x1693c8(0x1cb)]({'where':{'id':_0x3890cb}});}}exports[a59_0x3f8dea(0x1c9)]=UserService;