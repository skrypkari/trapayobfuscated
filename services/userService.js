'use strict';function a55_0x52df(){const _0xf19c5d=['randomBytes','telegramId','password','628609Hqahiz','paymentGateways','default','shopUrl','toString','8MEbUNJ','gateways','133357gKYUgZ','usdtTrcWallet','10RPazTO','../config/database','1412UCcApT','hex','13040ZPXiIE','pk_','delete','sk_','findMany','46210116hTvxdP','status','fullName','updateUser','name','stringify','telegram','deleteUser','__esModule','667026WDZZuy','publicKey','__importDefault','findUnique','getUserById','createdAt','402pCosgR','90fjZPEN','parse','create','crypto','65346rHUwMo','desc','usdtPolygonWallet','shop','wallets','UserService','merchantUrl','generateApiKeys','gatewaySettings','hash','Username\x20already\x20exists','13061598XilDiK','defineProperty','usdtErcWallet','username','usdcPolygonWallet'];a55_0x52df=function(){return _0xf19c5d;};return a55_0x52df();}function a55_0x3e0b(_0x329fa4,_0x207b1c){const _0x52df02=a55_0x52df();return a55_0x3e0b=function(_0x3e0b4c,_0x1eac80){_0x3e0b4c=_0x3e0b4c-0x143;let _0x27421a=_0x52df02[_0x3e0b4c];return _0x27421a;},a55_0x3e0b(_0x329fa4,_0x207b1c);}const a55_0x5ed912=a55_0x3e0b;(function(_0x40d7e4,_0x1f4b53){const _0x350e5c=a55_0x3e0b,_0x1a8fde=_0x40d7e4();while(!![]){try{const _0x385348=-parseInt(_0x350e5c(0x17b))/0x1+-parseInt(_0x350e5c(0x164))/0x2*(-parseInt(_0x350e5c(0x168))/0x3)+-parseInt(_0x350e5c(0x14d))/0x4*(parseInt(_0x350e5c(0x14f))/0x5)+-parseInt(_0x350e5c(0x163))/0x6*(parseInt(_0x350e5c(0x149))/0x7)+-parseInt(_0x350e5c(0x147))/0x8*(parseInt(_0x350e5c(0x15d))/0x9)+-parseInt(_0x350e5c(0x14b))/0xa*(parseInt(_0x350e5c(0x173))/0xb)+parseInt(_0x350e5c(0x154))/0xc;if(_0x385348===_0x1f4b53)break;else _0x1a8fde['push'](_0x1a8fde['shift']());}catch(_0x5e09ee){_0x1a8fde['push'](_0x1a8fde['shift']());}}}(a55_0x52df,0xb59ab));var __importDefault=this&&this[a55_0x5ed912(0x15f)]||function(_0x1f0d3b){const _0x475b6c=a55_0x5ed912;return _0x1f0d3b&&_0x1f0d3b[_0x475b6c(0x15c)]?_0x1f0d3b:{'default':_0x1f0d3b};};Object[a55_0x5ed912(0x174)](exports,a55_0x5ed912(0x15c),{'value':!![]}),exports[a55_0x5ed912(0x16d)]=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),crypto_1=__importDefault(require(a55_0x5ed912(0x167))),database_1=__importDefault(require(a55_0x5ed912(0x14c)));class UserService{['generateApiKeys'](){const _0x3e9575=a55_0x5ed912,_0x3ded53=_0x3e9575(0x150)+crypto_1[_0x3e9575(0x144)]['randomBytes'](0x20)[_0x3e9575(0x146)](_0x3e9575(0x14e)),_0x52841b=_0x3e9575(0x152)+crypto_1[_0x3e9575(0x144)][_0x3e9575(0x178)](0x20)[_0x3e9575(0x146)]('hex');return{'publicKey':_0x3ded53,'secretKey':_0x52841b};}async['createUser'](_0x179c0b){const _0x337b49=a55_0x5ed912,{fullName:_0x59451c,username:_0x4280fa,password:_0x24087c,telegramId:_0x1a3e23,merchantUrl:_0x4dab2a,gateways:_0x1cda72,gatewaySettings:_0x482d33,wallets:_0x53ce7d}=_0x179c0b,_0x39b5e9=await database_1[_0x337b49(0x144)][_0x337b49(0x16b)]['findUnique']({'where':{'username':_0x4280fa}});if(_0x39b5e9)throw new Error(_0x337b49(0x172));if(_0x1a3e23){const _0xc31e72=await database_1[_0x337b49(0x144)]['shop'][_0x337b49(0x160)]({'where':{'telegram':_0x1a3e23}});if(_0xc31e72)throw new Error('Telegram\x20username\x20already\x20exists');}const _0x263d89=await bcryptjs_1[_0x337b49(0x144)][_0x337b49(0x171)](_0x24087c,0xc),{publicKey:_0x4bba91,secretKey:_0x40de9d}=this[_0x337b49(0x16f)](),_0x4f1088=await database_1[_0x337b49(0x144)][_0x337b49(0x16b)][_0x337b49(0x166)]({'data':{'name':_0x59451c,'username':_0x4280fa,'password':_0x263d89,'telegram':_0x1a3e23,'shopUrl':_0x4dab2a,'paymentGateways':_0x1cda72?JSON[_0x337b49(0x159)](_0x1cda72):null,'gatewaySettings':_0x482d33?JSON[_0x337b49(0x159)](_0x482d33):null,'usdtPolygonWallet':_0x53ce7d?.['usdtPolygonWallet']||null,'usdtTrcWallet':_0x53ce7d?.['usdtTrcWallet']||null,'usdtErcWallet':_0x53ce7d?.[_0x337b49(0x175)]||null,'usdcPolygonWallet':_0x53ce7d?.[_0x337b49(0x177)]||null,'publicKey':_0x4bba91,'secretKey':_0x40de9d,'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x4f1088['id'],'fullName':_0x4f1088[_0x337b49(0x158)],'username':_0x4f1088[_0x337b49(0x176)],'telegramId':_0x4f1088['telegram'],'merchantUrl':_0x4f1088[_0x337b49(0x145)],'gateways':_0x4f1088[_0x337b49(0x143)]?JSON[_0x337b49(0x165)](_0x4f1088[_0x337b49(0x143)]):null,'gatewaySettings':_0x4f1088[_0x337b49(0x170)]?JSON[_0x337b49(0x165)](_0x4f1088['gatewaySettings']):null,'publicKey':_0x4f1088[_0x337b49(0x15e)],'wallets':{'usdtPolygonWallet':_0x4f1088[_0x337b49(0x16a)],'usdtTrcWallet':_0x4f1088[_0x337b49(0x14a)],'usdtErcWallet':_0x4f1088['usdtErcWallet'],'usdcPolygonWallet':_0x4f1088[_0x337b49(0x177)]},'status':_0x4f1088[_0x337b49(0x155)],'createdAt':_0x4f1088[_0x337b49(0x162)]};}async['getAllUsers'](){const _0x51f08a=a55_0x5ed912,_0x5da598=await database_1['default'][_0x51f08a(0x16b)][_0x51f08a(0x153)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x51f08a(0x169)}});return _0x5da598['map'](_0x5f1bb0=>({'id':_0x5f1bb0['id'],'fullName':_0x5f1bb0[_0x51f08a(0x158)],'username':_0x5f1bb0[_0x51f08a(0x176)],'telegramId':_0x5f1bb0[_0x51f08a(0x15a)],'merchantUrl':_0x5f1bb0[_0x51f08a(0x145)],'gateways':_0x5f1bb0[_0x51f08a(0x143)]?JSON['parse'](_0x5f1bb0[_0x51f08a(0x143)]):null,'gatewaySettings':_0x5f1bb0[_0x51f08a(0x170)]?JSON['parse'](_0x5f1bb0[_0x51f08a(0x170)]):null,'publicKey':_0x5f1bb0[_0x51f08a(0x15e)],'wallets':{'usdtPolygonWallet':_0x5f1bb0[_0x51f08a(0x16a)],'usdtTrcWallet':_0x5f1bb0['usdtTrcWallet'],'usdtErcWallet':_0x5f1bb0[_0x51f08a(0x175)],'usdcPolygonWallet':_0x5f1bb0[_0x51f08a(0x177)]},'status':_0x5f1bb0[_0x51f08a(0x155)],'createdAt':_0x5f1bb0[_0x51f08a(0x162)]}));}async[a55_0x5ed912(0x161)](_0x3e624c){const _0x214003=a55_0x5ed912,_0x184a39=await database_1[_0x214003(0x144)][_0x214003(0x16b)][_0x214003(0x160)]({'where':{'id':_0x3e624c},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x184a39)return null;return{'id':_0x184a39['id'],'fullName':_0x184a39['name'],'username':_0x184a39[_0x214003(0x176)],'telegramId':_0x184a39['telegram'],'merchantUrl':_0x184a39[_0x214003(0x145)],'gateways':_0x184a39['paymentGateways']?JSON[_0x214003(0x165)](_0x184a39[_0x214003(0x143)]):null,'gatewaySettings':_0x184a39[_0x214003(0x170)]?JSON[_0x214003(0x165)](_0x184a39['gatewaySettings']):null,'publicKey':_0x184a39[_0x214003(0x15e)],'wallets':{'usdtPolygonWallet':_0x184a39[_0x214003(0x16a)],'usdtTrcWallet':_0x184a39[_0x214003(0x14a)],'usdtErcWallet':_0x184a39[_0x214003(0x175)],'usdcPolygonWallet':_0x184a39[_0x214003(0x177)]},'status':_0x184a39[_0x214003(0x155)],'createdAt':_0x184a39[_0x214003(0x162)]};}async[a55_0x5ed912(0x157)](_0x2bf645,_0xfe2b62){const _0x588255=a55_0x5ed912,_0x359bc2={..._0xfe2b62};_0xfe2b62[_0x588255(0x17a)]&&(_0x359bc2[_0x588255(0x17a)]=await bcryptjs_1['default'][_0x588255(0x171)](_0xfe2b62[_0x588255(0x17a)],0xc));_0xfe2b62[_0x588255(0x156)]&&(_0x359bc2['name']=_0xfe2b62[_0x588255(0x156)],delete _0x359bc2[_0x588255(0x156)]);_0xfe2b62[_0x588255(0x179)]&&(_0x359bc2[_0x588255(0x15a)]=_0xfe2b62[_0x588255(0x179)],delete _0x359bc2[_0x588255(0x179)]);_0xfe2b62[_0x588255(0x16e)]&&(_0x359bc2[_0x588255(0x145)]=_0xfe2b62[_0x588255(0x16e)],delete _0x359bc2[_0x588255(0x16e)]);_0xfe2b62[_0x588255(0x148)]&&(_0x359bc2['paymentGateways']=JSON['stringify'](_0xfe2b62[_0x588255(0x148)]),delete _0x359bc2['gateways']);_0xfe2b62[_0x588255(0x170)]&&(_0x359bc2[_0x588255(0x170)]=JSON[_0x588255(0x159)](_0xfe2b62['gatewaySettings']),delete _0x359bc2[_0x588255(0x170)]);_0xfe2b62[_0x588255(0x16c)]&&(_0xfe2b62['wallets'][_0x588255(0x16a)]!==undefined&&(_0x359bc2[_0x588255(0x16a)]=_0xfe2b62[_0x588255(0x16c)][_0x588255(0x16a)]||null),_0xfe2b62['wallets'][_0x588255(0x14a)]!==undefined&&(_0x359bc2[_0x588255(0x14a)]=_0xfe2b62['wallets'][_0x588255(0x14a)]||null),_0xfe2b62[_0x588255(0x16c)][_0x588255(0x175)]!==undefined&&(_0x359bc2[_0x588255(0x175)]=_0xfe2b62[_0x588255(0x16c)]['usdtErcWallet']||null),_0xfe2b62['wallets']['usdcPolygonWallet']!==undefined&&(_0x359bc2['usdcPolygonWallet']=_0xfe2b62['wallets'][_0x588255(0x177)]||null),delete _0x359bc2[_0x588255(0x16c)]);const _0x55c227=await database_1['default'][_0x588255(0x16b)]['update']({'where':{'id':_0x2bf645},'data':_0x359bc2,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x55c227['id'],'fullName':_0x55c227['name'],'username':_0x55c227[_0x588255(0x176)],'telegramId':_0x55c227['telegram'],'merchantUrl':_0x55c227[_0x588255(0x145)],'gateways':_0x55c227['paymentGateways']?JSON[_0x588255(0x165)](_0x55c227[_0x588255(0x143)]):null,'gatewaySettings':_0x55c227['gatewaySettings']?JSON['parse'](_0x55c227['gatewaySettings']):null,'publicKey':_0x55c227[_0x588255(0x15e)],'wallets':{'usdtPolygonWallet':_0x55c227[_0x588255(0x16a)],'usdtTrcWallet':_0x55c227[_0x588255(0x14a)],'usdtErcWallet':_0x55c227['usdtErcWallet'],'usdcPolygonWallet':_0x55c227[_0x588255(0x177)]},'status':_0x55c227[_0x588255(0x155)],'createdAt':_0x55c227['createdAt']};}async[a55_0x5ed912(0x15b)](_0x1b471c){const _0x52cdd7=a55_0x5ed912;await database_1[_0x52cdd7(0x144)]['shop'][_0x52cdd7(0x151)]({'where':{'id':_0x1b471c}});}}exports['UserService']=UserService;