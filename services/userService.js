'use strict';const a51_0x176d96=a51_0x161f;(function(_0x2e758f,_0x4a59f6){const _0x61122f=a51_0x161f,_0x47f9c5=_0x2e758f();while(!![]){try{const _0x3182a3=parseInt(_0x61122f(0x1fd))/0x1+-parseInt(_0x61122f(0x1ed))/0x2*(-parseInt(_0x61122f(0x1d3))/0x3)+parseInt(_0x61122f(0x1f2))/0x4*(-parseInt(_0x61122f(0x1cb))/0x5)+parseInt(_0x61122f(0x1fa))/0x6*(-parseInt(_0x61122f(0x1d2))/0x7)+-parseInt(_0x61122f(0x201))/0x8+parseInt(_0x61122f(0x1e7))/0x9*(-parseInt(_0x61122f(0x1ef))/0xa)+-parseInt(_0x61122f(0x1d5))/0xb;if(_0x3182a3===_0x4a59f6)break;else _0x47f9c5['push'](_0x47f9c5['shift']());}catch(_0x46468e){_0x47f9c5['push'](_0x47f9c5['shift']());}}}(a51_0x3ce9,0xcfa1b));function a51_0x3ce9(){const _0x26a56c=['sk_','toString','telegramId','stringify','1688514JbotTD','shopUrl','generateApiKeys','1105526RuKvKw','fullName','delete','UserService','1492528fzlanL','usdtErcWallet','usdcPolygonWallet','gatewaySettings','55bBZKMe','__esModule','updateUser','status','createUser','map','getAllUsers','7lNTieI','72XcFCbR','crypto','4823643HDOdTS','create','name','usdtPolygonWallet','update','wallets','username','publicKey','createdAt','gateways','shop','paymentGateways','hash','../config/database','merchantUrl','ACTIVE','password','findMany','18YLQULd','usdtTrcWallet','defineProperty','telegram','getUserById','parse','73300tgOZfY','randomBytes','633910sleZaH','Username\x20already\x20exists','bcryptjs','36868anbYZV','default','findUnique','hex'];a51_0x3ce9=function(){return _0x26a56c;};return a51_0x3ce9();}var __importDefault=this&&this['__importDefault']||function(_0x556c57){const _0x5efd95=a51_0x161f;return _0x556c57&&_0x556c57[_0x5efd95(0x1cc)]?_0x556c57:{'default':_0x556c57};};Object[a51_0x176d96(0x1e9)](exports,'__esModule',{'value':!![]}),exports[a51_0x176d96(0x200)]=void 0x0;const bcryptjs_1=__importDefault(require(a51_0x176d96(0x1f1))),crypto_1=__importDefault(require(a51_0x176d96(0x1d4))),database_1=__importDefault(require(a51_0x176d96(0x1e2)));function a51_0x161f(_0xb1e5f0,_0x3cfa22){const _0x3ce97a=a51_0x3ce9();return a51_0x161f=function(_0x161faf,_0x25a3bd){_0x161faf=_0x161faf-0x1c8;let _0x169507=_0x3ce97a[_0x161faf];return _0x169507;},a51_0x161f(_0xb1e5f0,_0x3cfa22);}class UserService{[a51_0x176d96(0x1fc)](){const _0x101ac7=a51_0x176d96,_0x394b6a='pk_'+crypto_1[_0x101ac7(0x1f3)][_0x101ac7(0x1ee)](0x20)[_0x101ac7(0x1f7)](_0x101ac7(0x1f5)),_0x59ca00=_0x101ac7(0x1f6)+crypto_1[_0x101ac7(0x1f3)][_0x101ac7(0x1ee)](0x20)[_0x101ac7(0x1f7)]('hex');return{'publicKey':_0x394b6a,'secretKey':_0x59ca00};}async[a51_0x176d96(0x1cf)](_0x43b628){const _0x37612b=a51_0x176d96,{fullName:_0x154dcf,username:_0x67b6a9,password:_0xa11eea,telegramId:_0x26bc9e,merchantUrl:_0x1e639d,gateways:_0x4bba3c,gatewaySettings:_0x197772,wallets:_0x1f238e}=_0x43b628,_0x4ce8f3=await database_1[_0x37612b(0x1f3)][_0x37612b(0x1df)][_0x37612b(0x1f4)]({'where':{'username':_0x67b6a9}});if(_0x4ce8f3)throw new Error(_0x37612b(0x1f0));if(_0x26bc9e){const _0x3a8e8e=await database_1[_0x37612b(0x1f3)][_0x37612b(0x1df)][_0x37612b(0x1f4)]({'where':{'telegram':_0x26bc9e}});if(_0x3a8e8e)throw new Error('Telegram\x20username\x20already\x20exists');}const _0x35551c=await bcryptjs_1[_0x37612b(0x1f3)][_0x37612b(0x1e1)](_0xa11eea,0xc),{publicKey:_0xf927fd,secretKey:_0x38e9e2}=this[_0x37612b(0x1fc)](),_0x4887d9=await database_1[_0x37612b(0x1f3)]['shop'][_0x37612b(0x1d6)]({'data':{'name':_0x154dcf,'username':_0x67b6a9,'password':_0x35551c,'telegram':_0x26bc9e,'shopUrl':_0x1e639d,'paymentGateways':_0x4bba3c?JSON[_0x37612b(0x1f9)](_0x4bba3c):null,'gatewaySettings':_0x197772?JSON['stringify'](_0x197772):null,'usdtPolygonWallet':_0x1f238e?.[_0x37612b(0x1d8)]||null,'usdtTrcWallet':_0x1f238e?.[_0x37612b(0x1e8)]||null,'usdtErcWallet':_0x1f238e?.[_0x37612b(0x1c8)]||null,'usdcPolygonWallet':_0x1f238e?.[_0x37612b(0x1c9)]||null,'publicKey':_0xf927fd,'secretKey':_0x38e9e2,'status':_0x37612b(0x1e4)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x4887d9['id'],'fullName':_0x4887d9[_0x37612b(0x1d7)],'username':_0x4887d9[_0x37612b(0x1db)],'telegramId':_0x4887d9[_0x37612b(0x1ea)],'merchantUrl':_0x4887d9[_0x37612b(0x1fb)],'gateways':_0x4887d9[_0x37612b(0x1e0)]?JSON[_0x37612b(0x1ec)](_0x4887d9[_0x37612b(0x1e0)]):null,'gatewaySettings':_0x4887d9[_0x37612b(0x1ca)]?JSON['parse'](_0x4887d9[_0x37612b(0x1ca)]):null,'publicKey':_0x4887d9['publicKey'],'wallets':{'usdtPolygonWallet':_0x4887d9['usdtPolygonWallet'],'usdtTrcWallet':_0x4887d9[_0x37612b(0x1e8)],'usdtErcWallet':_0x4887d9[_0x37612b(0x1c8)],'usdcPolygonWallet':_0x4887d9[_0x37612b(0x1c9)]},'status':_0x4887d9['status'],'createdAt':_0x4887d9[_0x37612b(0x1dd)]};}async[a51_0x176d96(0x1d1)](){const _0x234405=a51_0x176d96,_0x43d582=await database_1[_0x234405(0x1f3)][_0x234405(0x1df)][_0x234405(0x1e6)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':'desc'}});return _0x43d582[_0x234405(0x1d0)](_0x42ecda=>({'id':_0x42ecda['id'],'fullName':_0x42ecda[_0x234405(0x1d7)],'username':_0x42ecda[_0x234405(0x1db)],'telegramId':_0x42ecda[_0x234405(0x1ea)],'merchantUrl':_0x42ecda['shopUrl'],'gateways':_0x42ecda[_0x234405(0x1e0)]?JSON['parse'](_0x42ecda[_0x234405(0x1e0)]):null,'gatewaySettings':_0x42ecda[_0x234405(0x1ca)]?JSON['parse'](_0x42ecda[_0x234405(0x1ca)]):null,'publicKey':_0x42ecda['publicKey'],'wallets':{'usdtPolygonWallet':_0x42ecda['usdtPolygonWallet'],'usdtTrcWallet':_0x42ecda[_0x234405(0x1e8)],'usdtErcWallet':_0x42ecda['usdtErcWallet'],'usdcPolygonWallet':_0x42ecda['usdcPolygonWallet']},'status':_0x42ecda[_0x234405(0x1ce)],'createdAt':_0x42ecda[_0x234405(0x1dd)]}));}async[a51_0x176d96(0x1eb)](_0x441887){const _0x532674=a51_0x176d96,_0x242b1b=await database_1[_0x532674(0x1f3)][_0x532674(0x1df)][_0x532674(0x1f4)]({'where':{'id':_0x441887},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x242b1b)return null;return{'id':_0x242b1b['id'],'fullName':_0x242b1b['name'],'username':_0x242b1b[_0x532674(0x1db)],'telegramId':_0x242b1b[_0x532674(0x1ea)],'merchantUrl':_0x242b1b['shopUrl'],'gateways':_0x242b1b[_0x532674(0x1e0)]?JSON[_0x532674(0x1ec)](_0x242b1b[_0x532674(0x1e0)]):null,'gatewaySettings':_0x242b1b[_0x532674(0x1ca)]?JSON[_0x532674(0x1ec)](_0x242b1b[_0x532674(0x1ca)]):null,'publicKey':_0x242b1b[_0x532674(0x1dc)],'wallets':{'usdtPolygonWallet':_0x242b1b[_0x532674(0x1d8)],'usdtTrcWallet':_0x242b1b[_0x532674(0x1e8)],'usdtErcWallet':_0x242b1b['usdtErcWallet'],'usdcPolygonWallet':_0x242b1b['usdcPolygonWallet']},'status':_0x242b1b['status'],'createdAt':_0x242b1b[_0x532674(0x1dd)]};}async[a51_0x176d96(0x1cd)](_0x4cb31c,_0x914083){const _0x2b116b=a51_0x176d96,_0x18a42f={..._0x914083};_0x914083[_0x2b116b(0x1e5)]&&(_0x18a42f[_0x2b116b(0x1e5)]=await bcryptjs_1[_0x2b116b(0x1f3)][_0x2b116b(0x1e1)](_0x914083[_0x2b116b(0x1e5)],0xc));_0x914083[_0x2b116b(0x1fe)]&&(_0x18a42f['name']=_0x914083[_0x2b116b(0x1fe)],delete _0x18a42f['fullName']);_0x914083[_0x2b116b(0x1f8)]&&(_0x18a42f[_0x2b116b(0x1ea)]=_0x914083['telegramId'],delete _0x18a42f['telegramId']);_0x914083[_0x2b116b(0x1e3)]&&(_0x18a42f[_0x2b116b(0x1fb)]=_0x914083[_0x2b116b(0x1e3)],delete _0x18a42f[_0x2b116b(0x1e3)]);_0x914083[_0x2b116b(0x1de)]&&(_0x18a42f[_0x2b116b(0x1e0)]=JSON[_0x2b116b(0x1f9)](_0x914083[_0x2b116b(0x1de)]),delete _0x18a42f['gateways']);_0x914083['gatewaySettings']&&(_0x18a42f[_0x2b116b(0x1ca)]=JSON['stringify'](_0x914083[_0x2b116b(0x1ca)]),delete _0x18a42f['gatewaySettings']);_0x914083[_0x2b116b(0x1da)]&&(_0x914083[_0x2b116b(0x1da)]['usdtPolygonWallet']!==undefined&&(_0x18a42f[_0x2b116b(0x1d8)]=_0x914083['wallets'][_0x2b116b(0x1d8)]||null),_0x914083[_0x2b116b(0x1da)]['usdtTrcWallet']!==undefined&&(_0x18a42f[_0x2b116b(0x1e8)]=_0x914083[_0x2b116b(0x1da)][_0x2b116b(0x1e8)]||null),_0x914083[_0x2b116b(0x1da)][_0x2b116b(0x1c8)]!==undefined&&(_0x18a42f['usdtErcWallet']=_0x914083[_0x2b116b(0x1da)][_0x2b116b(0x1c8)]||null),_0x914083[_0x2b116b(0x1da)]['usdcPolygonWallet']!==undefined&&(_0x18a42f['usdcPolygonWallet']=_0x914083['wallets']['usdcPolygonWallet']||null),delete _0x18a42f[_0x2b116b(0x1da)]);const _0x2a17e9=await database_1[_0x2b116b(0x1f3)][_0x2b116b(0x1df)][_0x2b116b(0x1d9)]({'where':{'id':_0x4cb31c},'data':_0x18a42f,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x2a17e9['id'],'fullName':_0x2a17e9[_0x2b116b(0x1d7)],'username':_0x2a17e9['username'],'telegramId':_0x2a17e9[_0x2b116b(0x1ea)],'merchantUrl':_0x2a17e9['shopUrl'],'gateways':_0x2a17e9[_0x2b116b(0x1e0)]?JSON[_0x2b116b(0x1ec)](_0x2a17e9[_0x2b116b(0x1e0)]):null,'gatewaySettings':_0x2a17e9[_0x2b116b(0x1ca)]?JSON[_0x2b116b(0x1ec)](_0x2a17e9[_0x2b116b(0x1ca)]):null,'publicKey':_0x2a17e9[_0x2b116b(0x1dc)],'wallets':{'usdtPolygonWallet':_0x2a17e9[_0x2b116b(0x1d8)],'usdtTrcWallet':_0x2a17e9[_0x2b116b(0x1e8)],'usdtErcWallet':_0x2a17e9['usdtErcWallet'],'usdcPolygonWallet':_0x2a17e9[_0x2b116b(0x1c9)]},'status':_0x2a17e9[_0x2b116b(0x1ce)],'createdAt':_0x2a17e9[_0x2b116b(0x1dd)]};}async['deleteUser'](_0x4f0b34){const _0x2087e8=a51_0x176d96;await database_1[_0x2087e8(0x1f3)][_0x2087e8(0x1df)][_0x2087e8(0x1ff)]({'where':{'id':_0x4f0b34}});}}exports[a51_0x176d96(0x200)]=UserService;