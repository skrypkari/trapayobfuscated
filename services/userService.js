'use strict';function a61_0x118c(_0x1ad796,_0x17054f){const _0x407bc7=a61_0x407b();return a61_0x118c=function(_0x118ceb,_0x9515bd){_0x118ceb=_0x118ceb-0x76;let _0x47eef4=_0x407bc7[_0x118ceb];return _0x47eef4;},a61_0x118c(_0x1ad796,_0x17054f);}const a61_0x51459c=a61_0x118c;(function(_0x2f1591,_0x976a34){const _0x5da826=a61_0x118c,_0x3639a4=_0x2f1591();while(!![]){try{const _0x2a6e8c=-parseInt(_0x5da826(0x78))/0x1*(-parseInt(_0x5da826(0xa4))/0x2)+parseInt(_0x5da826(0x90))/0x3+parseInt(_0x5da826(0x80))/0x4+-parseInt(_0x5da826(0x9b))/0x5*(parseInt(_0x5da826(0xa3))/0x6)+parseInt(_0x5da826(0x7b))/0x7+parseInt(_0x5da826(0x9a))/0x8+-parseInt(_0x5da826(0x7a))/0x9*(parseInt(_0x5da826(0x8b))/0xa);if(_0x2a6e8c===_0x976a34)break;else _0x3639a4['push'](_0x3639a4['shift']());}catch(_0x472ee1){_0x3639a4['push'](_0x3639a4['shift']());}}}(a61_0x407b,0x9982c));var __importDefault=this&&this['__importDefault']||function(_0x25b435){const _0x4d3e14=a61_0x118c;return _0x25b435&&_0x25b435[_0x4d3e14(0xa5)]?_0x25b435:{'default':_0x25b435};};Object[a61_0x51459c(0x8c)](exports,'__esModule',{'value':!![]}),exports['UserService']=void 0x0;function a61_0x407b(){const _0x3f48a9=['shopUrl','358269ZpoYqi','usdtTrcWallet','publicKey','merchantUrl','name','deleteUser','randomBytes','fullName','createdAt','telegramId','4694488AqErMv','1054805SQlkqZ','username','create','desc','generateApiKeys','shop','password','status','6VNVDqW','2uyJdfO','__esModule','delete','gateways','hash','map','toString','usdtErcWallet','hex','1075232bllheZ','usdtPolygonWallet','31536biMfsq','1893332KaWEiN','bcryptjs','stringify','sk_','default','4654044sjZZOh','telegram','gatewaySettings','update','createUser','getAllUsers','updateUser','usdcPolygonWallet','findUnique','paymentGateways','parse','6780QyhSaP','defineProperty','../config/database','wallets'];a61_0x407b=function(){return _0x3f48a9;};return a61_0x407b();}const bcryptjs_1=__importDefault(require(a61_0x51459c(0x7c))),crypto_1=__importDefault(require('crypto')),database_1=__importDefault(require(a61_0x51459c(0x8d)));class UserService{[a61_0x51459c(0x9f)](){const _0x2fd9cf=a61_0x51459c,_0x2b0eba='pk_'+crypto_1[_0x2fd9cf(0x7f)][_0x2fd9cf(0x96)](0x20)[_0x2fd9cf(0xaa)](_0x2fd9cf(0x77)),_0x15ba43=_0x2fd9cf(0x7e)+crypto_1[_0x2fd9cf(0x7f)][_0x2fd9cf(0x96)](0x20)['toString'](_0x2fd9cf(0x77));return{'publicKey':_0x2b0eba,'secretKey':_0x15ba43};}async[a61_0x51459c(0x84)](_0x5cdac4){const _0x46d4ea=a61_0x51459c,{fullName:_0x117a3a,username:_0x58df31,password:_0x363ff5,telegramId:_0x1ce639,merchantUrl:_0x3dbb7d,gateways:_0x3d7088,gatewaySettings:_0x2257f0,wallets:_0x1fa77b}=_0x5cdac4,_0x5bbae8=await database_1[_0x46d4ea(0x7f)][_0x46d4ea(0xa0)]['findUnique']({'where':{'username':_0x58df31}});if(_0x5bbae8)throw new Error('Username\x20already\x20exists');if(_0x1ce639){const _0x50b0b6=await database_1[_0x46d4ea(0x7f)][_0x46d4ea(0xa0)][_0x46d4ea(0x88)]({'where':{'telegram':_0x1ce639}});if(_0x50b0b6)throw new Error('Telegram\x20username\x20already\x20exists');}const _0x181ab1=await bcryptjs_1['default'][_0x46d4ea(0xa8)](_0x363ff5,0xc),{publicKey:_0x1c0638,secretKey:_0x5c808a}=this[_0x46d4ea(0x9f)](),_0x4c6750=await database_1['default'][_0x46d4ea(0xa0)][_0x46d4ea(0x9d)]({'data':{'name':_0x117a3a,'username':_0x58df31,'password':_0x181ab1,'telegram':_0x1ce639,'shopUrl':_0x3dbb7d,'paymentGateways':_0x3d7088?JSON[_0x46d4ea(0x7d)](_0x3d7088):null,'gatewaySettings':_0x2257f0?JSON[_0x46d4ea(0x7d)](_0x2257f0):null,'usdtPolygonWallet':_0x1fa77b?.['usdtPolygonWallet']||null,'usdtTrcWallet':_0x1fa77b?.['usdtTrcWallet']||null,'usdtErcWallet':_0x1fa77b?.['usdtErcWallet']||null,'usdcPolygonWallet':_0x1fa77b?.[_0x46d4ea(0x87)]||null,'publicKey':_0x1c0638,'secretKey':_0x5c808a,'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x4c6750['id'],'fullName':_0x4c6750['name'],'username':_0x4c6750[_0x46d4ea(0x9c)],'telegramId':_0x4c6750[_0x46d4ea(0x81)],'merchantUrl':_0x4c6750[_0x46d4ea(0x8f)],'gateways':_0x4c6750[_0x46d4ea(0x89)]?JSON['parse'](_0x4c6750[_0x46d4ea(0x89)]):null,'gatewaySettings':_0x4c6750[_0x46d4ea(0x82)]?JSON['parse'](_0x4c6750[_0x46d4ea(0x82)]):null,'publicKey':_0x4c6750[_0x46d4ea(0x92)],'wallets':{'usdtPolygonWallet':_0x4c6750[_0x46d4ea(0x79)],'usdtTrcWallet':_0x4c6750[_0x46d4ea(0x91)],'usdtErcWallet':_0x4c6750[_0x46d4ea(0x76)],'usdcPolygonWallet':_0x4c6750[_0x46d4ea(0x87)]},'status':_0x4c6750['status'],'createdAt':_0x4c6750['createdAt']};}async[a61_0x51459c(0x85)](){const _0x250921=a61_0x51459c,_0x60eb5c=await database_1[_0x250921(0x7f)]['shop']['findMany']({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x250921(0x9e)}});return _0x60eb5c[_0x250921(0xa9)](_0x192b9a=>({'id':_0x192b9a['id'],'fullName':_0x192b9a[_0x250921(0x94)],'username':_0x192b9a[_0x250921(0x9c)],'telegramId':_0x192b9a['telegram'],'merchantUrl':_0x192b9a[_0x250921(0x8f)],'gateways':_0x192b9a[_0x250921(0x89)]?JSON['parse'](_0x192b9a[_0x250921(0x89)]):null,'gatewaySettings':_0x192b9a[_0x250921(0x82)]?JSON[_0x250921(0x8a)](_0x192b9a[_0x250921(0x82)]):null,'publicKey':_0x192b9a[_0x250921(0x92)],'wallets':{'usdtPolygonWallet':_0x192b9a['usdtPolygonWallet'],'usdtTrcWallet':_0x192b9a[_0x250921(0x91)],'usdtErcWallet':_0x192b9a[_0x250921(0x76)],'usdcPolygonWallet':_0x192b9a[_0x250921(0x87)]},'status':_0x192b9a[_0x250921(0xa2)],'createdAt':_0x192b9a['createdAt']}));}async['getUserById'](_0xd862d3){const _0x4c1c45=a61_0x51459c,_0x5794f0=await database_1[_0x4c1c45(0x7f)][_0x4c1c45(0xa0)][_0x4c1c45(0x88)]({'where':{'id':_0xd862d3},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x5794f0)return null;return{'id':_0x5794f0['id'],'fullName':_0x5794f0[_0x4c1c45(0x94)],'username':_0x5794f0[_0x4c1c45(0x9c)],'telegramId':_0x5794f0[_0x4c1c45(0x81)],'merchantUrl':_0x5794f0[_0x4c1c45(0x8f)],'gateways':_0x5794f0['paymentGateways']?JSON[_0x4c1c45(0x8a)](_0x5794f0[_0x4c1c45(0x89)]):null,'gatewaySettings':_0x5794f0[_0x4c1c45(0x82)]?JSON[_0x4c1c45(0x8a)](_0x5794f0[_0x4c1c45(0x82)]):null,'publicKey':_0x5794f0['publicKey'],'wallets':{'usdtPolygonWallet':_0x5794f0['usdtPolygonWallet'],'usdtTrcWallet':_0x5794f0[_0x4c1c45(0x91)],'usdtErcWallet':_0x5794f0[_0x4c1c45(0x76)],'usdcPolygonWallet':_0x5794f0[_0x4c1c45(0x87)]},'status':_0x5794f0[_0x4c1c45(0xa2)],'createdAt':_0x5794f0[_0x4c1c45(0x98)]};}async[a61_0x51459c(0x86)](_0x56e9e1,_0x36e75c){const _0x26fcd8=a61_0x51459c,_0x5a370d={..._0x36e75c};_0x36e75c[_0x26fcd8(0xa1)]&&(_0x5a370d[_0x26fcd8(0xa1)]=await bcryptjs_1['default']['hash'](_0x36e75c[_0x26fcd8(0xa1)],0xc));_0x36e75c['fullName']&&(_0x5a370d[_0x26fcd8(0x94)]=_0x36e75c[_0x26fcd8(0x97)],delete _0x5a370d['fullName']);_0x36e75c[_0x26fcd8(0x99)]&&(_0x5a370d['telegram']=_0x36e75c[_0x26fcd8(0x99)],delete _0x5a370d['telegramId']);_0x36e75c[_0x26fcd8(0x93)]&&(_0x5a370d['shopUrl']=_0x36e75c['merchantUrl'],delete _0x5a370d[_0x26fcd8(0x93)]);_0x36e75c[_0x26fcd8(0xa7)]&&(_0x5a370d['paymentGateways']=JSON['stringify'](_0x36e75c[_0x26fcd8(0xa7)]),delete _0x5a370d['gateways']);_0x36e75c[_0x26fcd8(0x82)]&&(_0x5a370d[_0x26fcd8(0x82)]=JSON['stringify'](_0x36e75c[_0x26fcd8(0x82)]),delete _0x5a370d[_0x26fcd8(0x82)]);_0x36e75c[_0x26fcd8(0x8e)]&&(_0x36e75c[_0x26fcd8(0x8e)][_0x26fcd8(0x79)]!==undefined&&(_0x5a370d[_0x26fcd8(0x79)]=_0x36e75c[_0x26fcd8(0x8e)][_0x26fcd8(0x79)]||null),_0x36e75c['wallets'][_0x26fcd8(0x91)]!==undefined&&(_0x5a370d[_0x26fcd8(0x91)]=_0x36e75c[_0x26fcd8(0x8e)][_0x26fcd8(0x91)]||null),_0x36e75c['wallets']['usdtErcWallet']!==undefined&&(_0x5a370d[_0x26fcd8(0x76)]=_0x36e75c['wallets'][_0x26fcd8(0x76)]||null),_0x36e75c[_0x26fcd8(0x8e)]['usdcPolygonWallet']!==undefined&&(_0x5a370d['usdcPolygonWallet']=_0x36e75c[_0x26fcd8(0x8e)][_0x26fcd8(0x87)]||null),delete _0x5a370d[_0x26fcd8(0x8e)]);const _0x4c477f=await database_1[_0x26fcd8(0x7f)]['shop'][_0x26fcd8(0x83)]({'where':{'id':_0x56e9e1},'data':_0x5a370d,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x4c477f['id'],'fullName':_0x4c477f[_0x26fcd8(0x94)],'username':_0x4c477f[_0x26fcd8(0x9c)],'telegramId':_0x4c477f['telegram'],'merchantUrl':_0x4c477f[_0x26fcd8(0x8f)],'gateways':_0x4c477f[_0x26fcd8(0x89)]?JSON[_0x26fcd8(0x8a)](_0x4c477f[_0x26fcd8(0x89)]):null,'gatewaySettings':_0x4c477f['gatewaySettings']?JSON[_0x26fcd8(0x8a)](_0x4c477f[_0x26fcd8(0x82)]):null,'publicKey':_0x4c477f[_0x26fcd8(0x92)],'wallets':{'usdtPolygonWallet':_0x4c477f[_0x26fcd8(0x79)],'usdtTrcWallet':_0x4c477f[_0x26fcd8(0x91)],'usdtErcWallet':_0x4c477f[_0x26fcd8(0x76)],'usdcPolygonWallet':_0x4c477f['usdcPolygonWallet']},'status':_0x4c477f[_0x26fcd8(0xa2)],'createdAt':_0x4c477f['createdAt']};}async[a61_0x51459c(0x95)](_0x3733f8){const _0x2a0480=a61_0x51459c;await database_1[_0x2a0480(0x7f)][_0x2a0480(0xa0)][_0x2a0480(0xa6)]({'where':{'id':_0x3733f8}});}}exports['UserService']=UserService;