'use strict';const a56_0x45b012=a56_0x5b9e;(function(_0x48df2c,_0x2c17f7){const _0x18e00f=a56_0x5b9e,_0x18dcdd=_0x48df2c();while(!![]){try{const _0xa703fb=-parseInt(_0x18e00f(0xbb))/0x1*(-parseInt(_0x18e00f(0xb2))/0x2)+parseInt(_0x18e00f(0xbd))/0x3+-parseInt(_0x18e00f(0xad))/0x4+-parseInt(_0x18e00f(0xc8))/0x5*(parseInt(_0x18e00f(0xce))/0x6)+-parseInt(_0x18e00f(0xda))/0x7*(-parseInt(_0x18e00f(0xbe))/0x8)+-parseInt(_0x18e00f(0xd8))/0x9+parseInt(_0x18e00f(0xae))/0xa;if(_0xa703fb===_0x2c17f7)break;else _0x18dcdd['push'](_0x18dcdd['shift']());}catch(_0x1dd7c8){_0x18dcdd['push'](_0x18dcdd['shift']());}}}(a56_0xe2bd,0x35524));var __importDefault=this&&this[a56_0x45b012(0xd7)]||function(_0x2f7a41){return _0x2f7a41&&_0x2f7a41['__esModule']?_0x2f7a41:{'default':_0x2f7a41};};Object[a56_0x45b012(0xcc)](exports,'__esModule',{'value':!![]}),exports[a56_0x45b012(0xc7)]=void 0x0;const bcryptjs_1=__importDefault(require(a56_0x45b012(0xb5))),crypto_1=__importDefault(require('crypto')),database_1=__importDefault(require(a56_0x45b012(0xaf)));function a56_0xe2bd(){const _0x22a35d=['__importDefault','3448404QscRRd','paymentGateways','35wahhJm','usdtTrcWallet','name','status','ACTIVE','toString','usdcPolygonWallet','findMany','desc','1693680OEXpLO','7727210YuJXcG','../config/database','generateApiKeys','usdtErcWallet','647354fRLMGX','map','findUnique','bcryptjs','username','gatewaySettings','password','create','wallets','1RPEzyf','publicKey','23145JtHzXY','499528OAcbNk','createdAt','delete','telegramId','stringify','shop','shopUrl','merchantUrl','gateways','UserService','72470nOxvVf','getAllUsers','fullName','Username\x20already\x20exists','defineProperty','update','162HxXtQG','hash','parse','randomBytes','updateUser','Telegram\x20username\x20already\x20exists','telegram','default','usdtPolygonWallet'];a56_0xe2bd=function(){return _0x22a35d;};return a56_0xe2bd();}class UserService{[a56_0x45b012(0xb0)](){const _0x3c972b=a56_0x45b012,_0x538b5b='pk_'+crypto_1[_0x3c972b(0xd5)][_0x3c972b(0xd1)](0x20)[_0x3c972b(0xa9)]('hex'),_0x532e75='sk_'+crypto_1[_0x3c972b(0xd5)]['randomBytes'](0x20)['toString']('hex');return{'publicKey':_0x538b5b,'secretKey':_0x532e75};}async['createUser'](_0x4bf1e9){const _0x194eff=a56_0x45b012,{fullName:_0x108e4b,username:_0x47b2d8,password:_0x59a3ef,telegramId:_0x263fb9,merchantUrl:_0x356baf,gateways:_0x4af53f,gatewaySettings:_0x197759,wallets:_0x36f8df}=_0x4bf1e9,_0x317b8c=await database_1[_0x194eff(0xd5)][_0x194eff(0xc3)][_0x194eff(0xb4)]({'where':{'username':_0x47b2d8}});if(_0x317b8c)throw new Error(_0x194eff(0xcb));if(_0x263fb9){const _0x3f5289=await database_1['default'][_0x194eff(0xc3)]['findUnique']({'where':{'telegram':_0x263fb9}});if(_0x3f5289)throw new Error(_0x194eff(0xd3));}const _0xa7ca5=await bcryptjs_1[_0x194eff(0xd5)][_0x194eff(0xcf)](_0x59a3ef,0xc),{publicKey:_0x305f12,secretKey:_0x156ef1}=this[_0x194eff(0xb0)](),_0x582674=await database_1[_0x194eff(0xd5)][_0x194eff(0xc3)][_0x194eff(0xb9)]({'data':{'name':_0x108e4b,'username':_0x47b2d8,'password':_0xa7ca5,'telegram':_0x263fb9,'shopUrl':_0x356baf,'paymentGateways':_0x4af53f?JSON[_0x194eff(0xc2)](_0x4af53f):null,'gatewaySettings':_0x197759?JSON['stringify'](_0x197759):null,'usdtPolygonWallet':_0x36f8df?.[_0x194eff(0xd6)]||null,'usdtTrcWallet':_0x36f8df?.[_0x194eff(0xdb)]||null,'usdtErcWallet':_0x36f8df?.[_0x194eff(0xb1)]||null,'usdcPolygonWallet':_0x36f8df?.[_0x194eff(0xaa)]||null,'publicKey':_0x305f12,'secretKey':_0x156ef1,'status':_0x194eff(0xa8)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x582674['id'],'fullName':_0x582674[_0x194eff(0xdc)],'username':_0x582674['username'],'telegramId':_0x582674[_0x194eff(0xd4)],'merchantUrl':_0x582674[_0x194eff(0xc4)],'gateways':_0x582674['paymentGateways']?JSON[_0x194eff(0xd0)](_0x582674[_0x194eff(0xd9)]):null,'gatewaySettings':_0x582674[_0x194eff(0xb7)]?JSON[_0x194eff(0xd0)](_0x582674[_0x194eff(0xb7)]):null,'publicKey':_0x582674[_0x194eff(0xbc)],'wallets':{'usdtPolygonWallet':_0x582674['usdtPolygonWallet'],'usdtTrcWallet':_0x582674[_0x194eff(0xdb)],'usdtErcWallet':_0x582674[_0x194eff(0xb1)],'usdcPolygonWallet':_0x582674['usdcPolygonWallet']},'status':_0x582674['status'],'createdAt':_0x582674['createdAt']};}async[a56_0x45b012(0xc9)](){const _0xfc35b7=a56_0x45b012,_0x1d2bc2=await database_1[_0xfc35b7(0xd5)][_0xfc35b7(0xc3)][_0xfc35b7(0xab)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0xfc35b7(0xac)}});return _0x1d2bc2[_0xfc35b7(0xb3)](_0x1b5cfb=>({'id':_0x1b5cfb['id'],'fullName':_0x1b5cfb[_0xfc35b7(0xdc)],'username':_0x1b5cfb[_0xfc35b7(0xb6)],'telegramId':_0x1b5cfb[_0xfc35b7(0xd4)],'merchantUrl':_0x1b5cfb[_0xfc35b7(0xc4)],'gateways':_0x1b5cfb[_0xfc35b7(0xd9)]?JSON[_0xfc35b7(0xd0)](_0x1b5cfb[_0xfc35b7(0xd9)]):null,'gatewaySettings':_0x1b5cfb[_0xfc35b7(0xb7)]?JSON['parse'](_0x1b5cfb['gatewaySettings']):null,'publicKey':_0x1b5cfb['publicKey'],'wallets':{'usdtPolygonWallet':_0x1b5cfb['usdtPolygonWallet'],'usdtTrcWallet':_0x1b5cfb[_0xfc35b7(0xdb)],'usdtErcWallet':_0x1b5cfb[_0xfc35b7(0xb1)],'usdcPolygonWallet':_0x1b5cfb[_0xfc35b7(0xaa)]},'status':_0x1b5cfb['status'],'createdAt':_0x1b5cfb[_0xfc35b7(0xbf)]}));}async['getUserById'](_0x2d62a9){const _0x341bb6=a56_0x45b012,_0x5eeb5c=await database_1['default'][_0x341bb6(0xc3)][_0x341bb6(0xb4)]({'where':{'id':_0x2d62a9},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x5eeb5c)return null;return{'id':_0x5eeb5c['id'],'fullName':_0x5eeb5c[_0x341bb6(0xdc)],'username':_0x5eeb5c['username'],'telegramId':_0x5eeb5c[_0x341bb6(0xd4)],'merchantUrl':_0x5eeb5c['shopUrl'],'gateways':_0x5eeb5c[_0x341bb6(0xd9)]?JSON[_0x341bb6(0xd0)](_0x5eeb5c[_0x341bb6(0xd9)]):null,'gatewaySettings':_0x5eeb5c[_0x341bb6(0xb7)]?JSON[_0x341bb6(0xd0)](_0x5eeb5c[_0x341bb6(0xb7)]):null,'publicKey':_0x5eeb5c[_0x341bb6(0xbc)],'wallets':{'usdtPolygonWallet':_0x5eeb5c[_0x341bb6(0xd6)],'usdtTrcWallet':_0x5eeb5c[_0x341bb6(0xdb)],'usdtErcWallet':_0x5eeb5c[_0x341bb6(0xb1)],'usdcPolygonWallet':_0x5eeb5c[_0x341bb6(0xaa)]},'status':_0x5eeb5c[_0x341bb6(0xa7)],'createdAt':_0x5eeb5c['createdAt']};}async[a56_0x45b012(0xd2)](_0x1393f3,_0x432d3b){const _0x551983=a56_0x45b012,_0x50c94d={..._0x432d3b};_0x432d3b[_0x551983(0xb8)]&&(_0x50c94d['password']=await bcryptjs_1[_0x551983(0xd5)]['hash'](_0x432d3b[_0x551983(0xb8)],0xc));_0x432d3b[_0x551983(0xca)]&&(_0x50c94d[_0x551983(0xdc)]=_0x432d3b[_0x551983(0xca)],delete _0x50c94d[_0x551983(0xca)]);_0x432d3b[_0x551983(0xc1)]&&(_0x50c94d['telegram']=_0x432d3b[_0x551983(0xc1)],delete _0x50c94d[_0x551983(0xc1)]);_0x432d3b[_0x551983(0xc5)]&&(_0x50c94d['shopUrl']=_0x432d3b[_0x551983(0xc5)],delete _0x50c94d['merchantUrl']);_0x432d3b['gateways']&&(_0x50c94d['paymentGateways']=JSON[_0x551983(0xc2)](_0x432d3b[_0x551983(0xc6)]),delete _0x50c94d[_0x551983(0xc6)]);_0x432d3b[_0x551983(0xb7)]&&(_0x50c94d[_0x551983(0xb7)]=JSON[_0x551983(0xc2)](_0x432d3b[_0x551983(0xb7)]),delete _0x50c94d['gatewaySettings']);_0x432d3b['wallets']&&(_0x432d3b[_0x551983(0xba)]['usdtPolygonWallet']!==undefined&&(_0x50c94d['usdtPolygonWallet']=_0x432d3b[_0x551983(0xba)][_0x551983(0xd6)]||null),_0x432d3b['wallets']['usdtTrcWallet']!==undefined&&(_0x50c94d[_0x551983(0xdb)]=_0x432d3b[_0x551983(0xba)][_0x551983(0xdb)]||null),_0x432d3b[_0x551983(0xba)][_0x551983(0xb1)]!==undefined&&(_0x50c94d[_0x551983(0xb1)]=_0x432d3b[_0x551983(0xba)]['usdtErcWallet']||null),_0x432d3b['wallets']['usdcPolygonWallet']!==undefined&&(_0x50c94d[_0x551983(0xaa)]=_0x432d3b[_0x551983(0xba)]['usdcPolygonWallet']||null),delete _0x50c94d['wallets']);const _0x2ff3a5=await database_1['default'][_0x551983(0xc3)][_0x551983(0xcd)]({'where':{'id':_0x1393f3},'data':_0x50c94d,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x2ff3a5['id'],'fullName':_0x2ff3a5[_0x551983(0xdc)],'username':_0x2ff3a5['username'],'telegramId':_0x2ff3a5[_0x551983(0xd4)],'merchantUrl':_0x2ff3a5['shopUrl'],'gateways':_0x2ff3a5[_0x551983(0xd9)]?JSON['parse'](_0x2ff3a5['paymentGateways']):null,'gatewaySettings':_0x2ff3a5[_0x551983(0xb7)]?JSON[_0x551983(0xd0)](_0x2ff3a5[_0x551983(0xb7)]):null,'publicKey':_0x2ff3a5['publicKey'],'wallets':{'usdtPolygonWallet':_0x2ff3a5[_0x551983(0xd6)],'usdtTrcWallet':_0x2ff3a5[_0x551983(0xdb)],'usdtErcWallet':_0x2ff3a5[_0x551983(0xb1)],'usdcPolygonWallet':_0x2ff3a5[_0x551983(0xaa)]},'status':_0x2ff3a5[_0x551983(0xa7)],'createdAt':_0x2ff3a5[_0x551983(0xbf)]};}async['deleteUser'](_0x4c4a8e){const _0x3e89fa=a56_0x45b012;await database_1[_0x3e89fa(0xd5)]['shop'][_0x3e89fa(0xc0)]({'where':{'id':_0x4c4a8e}});}}function a56_0x5b9e(_0x185cf1,_0x259501){const _0xe2bd6f=a56_0xe2bd();return a56_0x5b9e=function(_0x5b9e23,_0x3c3c92){_0x5b9e23=_0x5b9e23-0xa7;let _0x26fc13=_0xe2bd6f[_0x5b9e23];return _0x26fc13;},a56_0x5b9e(_0x185cf1,_0x259501);}exports[a56_0x45b012(0xc7)]=UserService;