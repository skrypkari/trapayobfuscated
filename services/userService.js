'use strict';const a60_0x4f3f31=a60_0x1138;(function(_0x16f548,_0x151152){const _0x140819=a60_0x1138,_0x4fe96d=_0x16f548();while(!![]){try{const _0x4ca844=-parseInt(_0x140819(0xd7))/0x1*(parseInt(_0x140819(0xef))/0x2)+-parseInt(_0x140819(0xcf))/0x3*(-parseInt(_0x140819(0xcb))/0x4)+-parseInt(_0x140819(0xe8))/0x5+parseInt(_0x140819(0xbe))/0x6+-parseInt(_0x140819(0xf2))/0x7+-parseInt(_0x140819(0xdd))/0x8*(parseInt(_0x140819(0xc6))/0x9)+-parseInt(_0x140819(0xd1))/0xa*(parseInt(_0x140819(0xc4))/0xb);if(_0x4ca844===_0x151152)break;else _0x4fe96d['push'](_0x4fe96d['shift']());}catch(_0x5056b2){_0x4fe96d['push'](_0x4fe96d['shift']());}}}(a60_0x36f6,0x43b86));var __importDefault=this&&this['__importDefault']||function(_0x257f77){const _0x153c2e=a60_0x1138;return _0x257f77&&_0x257f77[_0x153c2e(0xcd)]?_0x257f77:{'default':_0x257f77};};Object[a60_0x4f3f31(0xc3)](exports,a60_0x4f3f31(0xcd),{'value':!![]}),exports[a60_0x4f3f31(0xce)]=void 0x0;const bcryptjs_1=__importDefault(require(a60_0x4f3f31(0xcc))),crypto_1=__importDefault(require('crypto')),database_1=__importDefault(require('../config/database'));class UserService{['generateApiKeys'](){const _0x409713=a60_0x4f3f31,_0x17d63b='pk_'+crypto_1[_0x409713(0xc7)][_0x409713(0xe6)](0x20)[_0x409713(0xc1)]('hex'),_0x3f4110=_0x409713(0xe9)+crypto_1[_0x409713(0xc7)][_0x409713(0xe6)](0x20)[_0x409713(0xc1)](_0x409713(0xbd));return{'publicKey':_0x17d63b,'secretKey':_0x3f4110};}async[a60_0x4f3f31(0xd0)](_0x4d10fa){const _0x324f90=a60_0x4f3f31,{fullName:_0x61ead4,username:_0x3bfa0b,password:_0x24b933,telegramId:_0x622933,merchantUrl:_0x2e795a,gateways:_0x56d643,gatewaySettings:_0x5f2c4b,wallets:_0x57ed3a}=_0x4d10fa,_0x5937df=await database_1[_0x324f90(0xc7)][_0x324f90(0xc5)][_0x324f90(0xdf)]({'where':{'username':_0x3bfa0b}});if(_0x5937df)throw new Error(_0x324f90(0xec));if(_0x622933){const _0x554c93=await database_1['default'][_0x324f90(0xc5)][_0x324f90(0xdf)]({'where':{'telegram':_0x622933}});if(_0x554c93)throw new Error(_0x324f90(0xea));}const _0x1e5dc0=await bcryptjs_1[_0x324f90(0xc7)][_0x324f90(0xee)](_0x24b933,0xc),{publicKey:_0x20a378,secretKey:_0x59aecc}=this[_0x324f90(0xd9)](),_0x143dea=await database_1[_0x324f90(0xc7)][_0x324f90(0xc5)][_0x324f90(0xe2)]({'data':{'name':_0x61ead4,'username':_0x3bfa0b,'password':_0x1e5dc0,'telegram':_0x622933,'shopUrl':_0x2e795a,'paymentGateways':_0x56d643?JSON[_0x324f90(0xda)](_0x56d643):null,'gatewaySettings':_0x5f2c4b?JSON['stringify'](_0x5f2c4b):null,'usdtPolygonWallet':_0x57ed3a?.[_0x324f90(0xf1)]||null,'usdtTrcWallet':_0x57ed3a?.[_0x324f90(0xd8)]||null,'usdtErcWallet':_0x57ed3a?.['usdtErcWallet']||null,'usdcPolygonWallet':_0x57ed3a?.['usdcPolygonWallet']||null,'publicKey':_0x20a378,'secretKey':_0x59aecc,'status':_0x324f90(0xeb)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x143dea['id'],'fullName':_0x143dea[_0x324f90(0xd4)],'username':_0x143dea[_0x324f90(0xd3)],'telegramId':_0x143dea[_0x324f90(0xed)],'merchantUrl':_0x143dea[_0x324f90(0xdb)],'gateways':_0x143dea[_0x324f90(0xbc)]?JSON['parse'](_0x143dea[_0x324f90(0xbc)]):null,'gatewaySettings':_0x143dea[_0x324f90(0xbf)]?JSON['parse'](_0x143dea[_0x324f90(0xbf)]):null,'publicKey':_0x143dea[_0x324f90(0xe1)],'wallets':{'usdtPolygonWallet':_0x143dea[_0x324f90(0xf1)],'usdtTrcWallet':_0x143dea[_0x324f90(0xd8)],'usdtErcWallet':_0x143dea[_0x324f90(0xc8)],'usdcPolygonWallet':_0x143dea[_0x324f90(0xd5)]},'status':_0x143dea[_0x324f90(0xe7)],'createdAt':_0x143dea[_0x324f90(0xf0)]};}async['getAllUsers'](){const _0x4f36b2=a60_0x4f3f31,_0x361783=await database_1[_0x4f36b2(0xc7)][_0x4f36b2(0xc5)]['findMany']({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':'desc'}});return _0x361783[_0x4f36b2(0xe5)](_0x102863=>({'id':_0x102863['id'],'fullName':_0x102863[_0x4f36b2(0xd4)],'username':_0x102863['username'],'telegramId':_0x102863['telegram'],'merchantUrl':_0x102863[_0x4f36b2(0xdb)],'gateways':_0x102863[_0x4f36b2(0xbc)]?JSON[_0x4f36b2(0xdc)](_0x102863['paymentGateways']):null,'gatewaySettings':_0x102863[_0x4f36b2(0xbf)]?JSON[_0x4f36b2(0xdc)](_0x102863[_0x4f36b2(0xbf)]):null,'publicKey':_0x102863['publicKey'],'wallets':{'usdtPolygonWallet':_0x102863['usdtPolygonWallet'],'usdtTrcWallet':_0x102863[_0x4f36b2(0xd8)],'usdtErcWallet':_0x102863[_0x4f36b2(0xc8)],'usdcPolygonWallet':_0x102863['usdcPolygonWallet']},'status':_0x102863[_0x4f36b2(0xe7)],'createdAt':_0x102863[_0x4f36b2(0xf0)]}));}async[a60_0x4f3f31(0xca)](_0x51520d){const _0x4887a7=a60_0x4f3f31,_0x39a46e=await database_1['default'][_0x4887a7(0xc5)][_0x4887a7(0xdf)]({'where':{'id':_0x51520d},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x39a46e)return null;return{'id':_0x39a46e['id'],'fullName':_0x39a46e['name'],'username':_0x39a46e[_0x4887a7(0xd3)],'telegramId':_0x39a46e[_0x4887a7(0xed)],'merchantUrl':_0x39a46e['shopUrl'],'gateways':_0x39a46e[_0x4887a7(0xbc)]?JSON['parse'](_0x39a46e[_0x4887a7(0xbc)]):null,'gatewaySettings':_0x39a46e[_0x4887a7(0xbf)]?JSON[_0x4887a7(0xdc)](_0x39a46e[_0x4887a7(0xbf)]):null,'publicKey':_0x39a46e[_0x4887a7(0xe1)],'wallets':{'usdtPolygonWallet':_0x39a46e[_0x4887a7(0xf1)],'usdtTrcWallet':_0x39a46e[_0x4887a7(0xd8)],'usdtErcWallet':_0x39a46e[_0x4887a7(0xc8)],'usdcPolygonWallet':_0x39a46e['usdcPolygonWallet']},'status':_0x39a46e[_0x4887a7(0xe7)],'createdAt':_0x39a46e[_0x4887a7(0xf0)]};}async[a60_0x4f3f31(0xd2)](_0x3bc850,_0x58bb5b){const _0x9a9c34=a60_0x4f3f31,_0x376995={..._0x58bb5b};_0x58bb5b[_0x9a9c34(0xc2)]&&(_0x376995[_0x9a9c34(0xc2)]=await bcryptjs_1[_0x9a9c34(0xc7)][_0x9a9c34(0xee)](_0x58bb5b[_0x9a9c34(0xc2)],0xc));_0x58bb5b[_0x9a9c34(0xe3)]&&(_0x376995[_0x9a9c34(0xd4)]=_0x58bb5b[_0x9a9c34(0xe3)],delete _0x376995[_0x9a9c34(0xe3)]);_0x58bb5b['telegramId']&&(_0x376995[_0x9a9c34(0xed)]=_0x58bb5b[_0x9a9c34(0xde)],delete _0x376995[_0x9a9c34(0xde)]);_0x58bb5b['merchantUrl']&&(_0x376995['shopUrl']=_0x58bb5b[_0x9a9c34(0xc9)],delete _0x376995[_0x9a9c34(0xc9)]);_0x58bb5b[_0x9a9c34(0xd6)]&&(_0x376995[_0x9a9c34(0xbc)]=JSON['stringify'](_0x58bb5b['gateways']),delete _0x376995[_0x9a9c34(0xd6)]);_0x58bb5b[_0x9a9c34(0xbf)]&&(_0x376995[_0x9a9c34(0xbf)]=JSON[_0x9a9c34(0xda)](_0x58bb5b[_0x9a9c34(0xbf)]),delete _0x376995['gatewaySettings']);_0x58bb5b[_0x9a9c34(0xc0)]&&(_0x58bb5b[_0x9a9c34(0xc0)][_0x9a9c34(0xf1)]!==undefined&&(_0x376995['usdtPolygonWallet']=_0x58bb5b[_0x9a9c34(0xc0)][_0x9a9c34(0xf1)]||null),_0x58bb5b[_0x9a9c34(0xc0)][_0x9a9c34(0xd8)]!==undefined&&(_0x376995['usdtTrcWallet']=_0x58bb5b[_0x9a9c34(0xc0)][_0x9a9c34(0xd8)]||null),_0x58bb5b['wallets']['usdtErcWallet']!==undefined&&(_0x376995[_0x9a9c34(0xc8)]=_0x58bb5b[_0x9a9c34(0xc0)][_0x9a9c34(0xc8)]||null),_0x58bb5b[_0x9a9c34(0xc0)]['usdcPolygonWallet']!==undefined&&(_0x376995[_0x9a9c34(0xd5)]=_0x58bb5b['wallets']['usdcPolygonWallet']||null),delete _0x376995[_0x9a9c34(0xc0)]);const _0x5df64b=await database_1[_0x9a9c34(0xc7)]['shop']['update']({'where':{'id':_0x3bc850},'data':_0x376995,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x5df64b['id'],'fullName':_0x5df64b[_0x9a9c34(0xd4)],'username':_0x5df64b[_0x9a9c34(0xd3)],'telegramId':_0x5df64b[_0x9a9c34(0xed)],'merchantUrl':_0x5df64b[_0x9a9c34(0xdb)],'gateways':_0x5df64b[_0x9a9c34(0xbc)]?JSON['parse'](_0x5df64b[_0x9a9c34(0xbc)]):null,'gatewaySettings':_0x5df64b[_0x9a9c34(0xbf)]?JSON[_0x9a9c34(0xdc)](_0x5df64b[_0x9a9c34(0xbf)]):null,'publicKey':_0x5df64b[_0x9a9c34(0xe1)],'wallets':{'usdtPolygonWallet':_0x5df64b[_0x9a9c34(0xf1)],'usdtTrcWallet':_0x5df64b[_0x9a9c34(0xd8)],'usdtErcWallet':_0x5df64b[_0x9a9c34(0xc8)],'usdcPolygonWallet':_0x5df64b[_0x9a9c34(0xd5)]},'status':_0x5df64b[_0x9a9c34(0xe7)],'createdAt':_0x5df64b[_0x9a9c34(0xf0)]};}async[a60_0x4f3f31(0xe4)](_0x5d96b8){const _0x403349=a60_0x4f3f31;await database_1['default']['shop'][_0x403349(0xe0)]({'where':{'id':_0x5d96b8}});}}function a60_0x1138(_0x28da9b,_0x33fb49){const _0x36f6c6=a60_0x36f6();return a60_0x1138=function(_0x113852,_0xa4379f){_0x113852=_0x113852-0xbc;let _0x22f353=_0x36f6c6[_0x113852];return _0x22f353;},a60_0x1138(_0x28da9b,_0x33fb49);}exports[a60_0x4f3f31(0xce)]=UserService;function a60_0x36f6(){const _0xbb7ecc=['generateApiKeys','stringify','shopUrl','parse','72uGiDkI','telegramId','findUnique','delete','publicKey','create','fullName','deleteUser','map','randomBytes','status','901025LzBMUW','sk_','Telegram\x20username\x20already\x20exists','ACTIVE','Username\x20already\x20exists','telegram','hash','329304UJEdbq','createdAt','usdtPolygonWallet','38059OKNDGM','paymentGateways','hex','2940774fvUErU','gatewaySettings','wallets','toString','password','defineProperty','22DMLNBe','shop','80559grojUP','default','usdtErcWallet','merchantUrl','getUserById','1568PJJunA','bcryptjs','__esModule','UserService','1686WxKarK','createUser','10990kSwWmQ','updateUser','username','name','usdcPolygonWallet','gateways','1ElwOUX','usdtTrcWallet'];a60_0x36f6=function(){return _0xbb7ecc;};return a60_0x36f6();}