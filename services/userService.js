'use strict';const a56_0x30d9f2=a56_0x3221;(function(_0x4b1f65,_0x283f23){const _0x19285a=a56_0x3221,_0x267c2d=_0x4b1f65();while(!![]){try{const _0xb0e893=-parseInt(_0x19285a(0x1ea))/0x1+parseInt(_0x19285a(0x1ef))/0x2*(parseInt(_0x19285a(0x1d8))/0x3)+-parseInt(_0x19285a(0x1cb))/0x4*(parseInt(_0x19285a(0x1d5))/0x5)+-parseInt(_0x19285a(0x1f0))/0x6*(-parseInt(_0x19285a(0x1c9))/0x7)+parseInt(_0x19285a(0x1d7))/0x8+parseInt(_0x19285a(0x1dc))/0x9+-parseInt(_0x19285a(0x1c3))/0xa*(parseInt(_0x19285a(0x1eb))/0xb);if(_0xb0e893===_0x283f23)break;else _0x267c2d['push'](_0x267c2d['shift']());}catch(_0x19f004){_0x267c2d['push'](_0x267c2d['shift']());}}}(a56_0x35ea,0x7f85e));function a56_0x35ea(){const _0x34512f=['__esModule','UserService','sk_','Username\x20already\x20exists','telegram','2751850KBbkdj','create','paymentGateways','randomBytes','default','password','91hkewPT','crypto','192RxOmfA','hash','__importDefault','pk_','username','usdtPolygonWallet','merchantUrl','usdtErcWallet','update','shopUrl','46665rEcxsq','wallets','3848584AfZSrE','12255sgPwGr','getAllUsers','parse','stringify','3923649yJpNgt','name','bcryptjs','generateApiKeys','usdtTrcWallet','publicKey','createdAt','gateways','map','createUser','usdcPolygonWallet','gatewaySettings','shop','findUnique','213335fKJUAa','44CqhPsr','deleteUser','toString','fullName','342teUxiX','308688zVAeEo','telegramId','hex','updateUser','status'];a56_0x35ea=function(){return _0x34512f;};return a56_0x35ea();}var __importDefault=this&&this[a56_0x30d9f2(0x1cd)]||function(_0x22ec40){return _0x22ec40&&_0x22ec40['__esModule']?_0x22ec40:{'default':_0x22ec40};};Object['defineProperty'](exports,a56_0x30d9f2(0x1f5),{'value':!![]}),exports['UserService']=void 0x0;function a56_0x3221(_0x310c24,_0x29900e){const _0x35ea54=a56_0x35ea();return a56_0x3221=function(_0x322178,_0xa68100){_0x322178=_0x322178-0x1c0;let _0x309fac=_0x35ea54[_0x322178];return _0x309fac;},a56_0x3221(_0x310c24,_0x29900e);}const bcryptjs_1=__importDefault(require(a56_0x30d9f2(0x1de))),crypto_1=__importDefault(require(a56_0x30d9f2(0x1ca))),database_1=__importDefault(require('../config/database'));class UserService{[a56_0x30d9f2(0x1df)](){const _0x5ee52b=a56_0x30d9f2,_0x4a7ea0=_0x5ee52b(0x1ce)+crypto_1['default']['randomBytes'](0x20)['toString'](_0x5ee52b(0x1f2)),_0x3e3642=_0x5ee52b(0x1c0)+crypto_1[_0x5ee52b(0x1c7)][_0x5ee52b(0x1c6)](0x20)[_0x5ee52b(0x1ed)]('hex');return{'publicKey':_0x4a7ea0,'secretKey':_0x3e3642};}async[a56_0x30d9f2(0x1e5)](_0x17bce7){const _0x3cdbee=a56_0x30d9f2,{fullName:_0x599990,username:_0x357a81,password:_0x4cac10,telegramId:_0x3a3e39,merchantUrl:_0x4e7db4,gateways:_0x5c1d14,gatewaySettings:_0x107897,wallets:_0x3d8833}=_0x17bce7,_0x225b69=await database_1[_0x3cdbee(0x1c7)][_0x3cdbee(0x1e8)][_0x3cdbee(0x1e9)]({'where':{'username':_0x357a81}});if(_0x225b69)throw new Error(_0x3cdbee(0x1c1));if(_0x3a3e39){const _0x5840e9=await database_1[_0x3cdbee(0x1c7)][_0x3cdbee(0x1e8)][_0x3cdbee(0x1e9)]({'where':{'telegram':_0x3a3e39}});if(_0x5840e9)throw new Error('Telegram\x20username\x20already\x20exists');}const _0x2db9ec=await bcryptjs_1[_0x3cdbee(0x1c7)][_0x3cdbee(0x1cc)](_0x4cac10,0xc),{publicKey:_0xb730f9,secretKey:_0x43daf9}=this[_0x3cdbee(0x1df)](),_0x47d894=await database_1[_0x3cdbee(0x1c7)][_0x3cdbee(0x1e8)][_0x3cdbee(0x1c4)]({'data':{'name':_0x599990,'username':_0x357a81,'password':_0x2db9ec,'telegram':_0x3a3e39,'shopUrl':_0x4e7db4,'paymentGateways':_0x5c1d14?JSON['stringify'](_0x5c1d14):null,'gatewaySettings':_0x107897?JSON[_0x3cdbee(0x1db)](_0x107897):null,'usdtPolygonWallet':_0x3d8833?.['usdtPolygonWallet']||null,'usdtTrcWallet':_0x3d8833?.[_0x3cdbee(0x1e0)]||null,'usdtErcWallet':_0x3d8833?.[_0x3cdbee(0x1d2)]||null,'usdcPolygonWallet':_0x3d8833?.['usdcPolygonWallet']||null,'publicKey':_0xb730f9,'secretKey':_0x43daf9,'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x47d894['id'],'fullName':_0x47d894[_0x3cdbee(0x1dd)],'username':_0x47d894[_0x3cdbee(0x1cf)],'telegramId':_0x47d894[_0x3cdbee(0x1c2)],'merchantUrl':_0x47d894[_0x3cdbee(0x1d4)],'gateways':_0x47d894[_0x3cdbee(0x1c5)]?JSON['parse'](_0x47d894[_0x3cdbee(0x1c5)]):null,'gatewaySettings':_0x47d894[_0x3cdbee(0x1e7)]?JSON[_0x3cdbee(0x1da)](_0x47d894[_0x3cdbee(0x1e7)]):null,'publicKey':_0x47d894[_0x3cdbee(0x1e1)],'wallets':{'usdtPolygonWallet':_0x47d894[_0x3cdbee(0x1d0)],'usdtTrcWallet':_0x47d894['usdtTrcWallet'],'usdtErcWallet':_0x47d894[_0x3cdbee(0x1d2)],'usdcPolygonWallet':_0x47d894[_0x3cdbee(0x1e6)]},'status':_0x47d894[_0x3cdbee(0x1f4)],'createdAt':_0x47d894['createdAt']};}async[a56_0x30d9f2(0x1d9)](){const _0x25a852=a56_0x30d9f2,_0x6b323f=await database_1['default'][_0x25a852(0x1e8)]['findMany']({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':'desc'}});return _0x6b323f[_0x25a852(0x1e4)](_0x5e39da=>({'id':_0x5e39da['id'],'fullName':_0x5e39da[_0x25a852(0x1dd)],'username':_0x5e39da['username'],'telegramId':_0x5e39da[_0x25a852(0x1c2)],'merchantUrl':_0x5e39da[_0x25a852(0x1d4)],'gateways':_0x5e39da[_0x25a852(0x1c5)]?JSON['parse'](_0x5e39da[_0x25a852(0x1c5)]):null,'gatewaySettings':_0x5e39da[_0x25a852(0x1e7)]?JSON[_0x25a852(0x1da)](_0x5e39da[_0x25a852(0x1e7)]):null,'publicKey':_0x5e39da[_0x25a852(0x1e1)],'wallets':{'usdtPolygonWallet':_0x5e39da['usdtPolygonWallet'],'usdtTrcWallet':_0x5e39da[_0x25a852(0x1e0)],'usdtErcWallet':_0x5e39da['usdtErcWallet'],'usdcPolygonWallet':_0x5e39da[_0x25a852(0x1e6)]},'status':_0x5e39da[_0x25a852(0x1f4)],'createdAt':_0x5e39da[_0x25a852(0x1e2)]}));}async['getUserById'](_0x28ffce){const _0x1d5cdb=a56_0x30d9f2,_0x37355b=await database_1[_0x1d5cdb(0x1c7)][_0x1d5cdb(0x1e8)][_0x1d5cdb(0x1e9)]({'where':{'id':_0x28ffce},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x37355b)return null;return{'id':_0x37355b['id'],'fullName':_0x37355b[_0x1d5cdb(0x1dd)],'username':_0x37355b['username'],'telegramId':_0x37355b[_0x1d5cdb(0x1c2)],'merchantUrl':_0x37355b['shopUrl'],'gateways':_0x37355b[_0x1d5cdb(0x1c5)]?JSON[_0x1d5cdb(0x1da)](_0x37355b[_0x1d5cdb(0x1c5)]):null,'gatewaySettings':_0x37355b[_0x1d5cdb(0x1e7)]?JSON[_0x1d5cdb(0x1da)](_0x37355b[_0x1d5cdb(0x1e7)]):null,'publicKey':_0x37355b[_0x1d5cdb(0x1e1)],'wallets':{'usdtPolygonWallet':_0x37355b[_0x1d5cdb(0x1d0)],'usdtTrcWallet':_0x37355b[_0x1d5cdb(0x1e0)],'usdtErcWallet':_0x37355b[_0x1d5cdb(0x1d2)],'usdcPolygonWallet':_0x37355b[_0x1d5cdb(0x1e6)]},'status':_0x37355b[_0x1d5cdb(0x1f4)],'createdAt':_0x37355b[_0x1d5cdb(0x1e2)]};}async[a56_0x30d9f2(0x1f3)](_0x7636fd,_0x68e0fd){const _0x12c83e=a56_0x30d9f2,_0x47ad40={..._0x68e0fd};_0x68e0fd[_0x12c83e(0x1c8)]&&(_0x47ad40[_0x12c83e(0x1c8)]=await bcryptjs_1['default']['hash'](_0x68e0fd[_0x12c83e(0x1c8)],0xc));_0x68e0fd['fullName']&&(_0x47ad40[_0x12c83e(0x1dd)]=_0x68e0fd[_0x12c83e(0x1ee)],delete _0x47ad40[_0x12c83e(0x1ee)]);_0x68e0fd[_0x12c83e(0x1f1)]&&(_0x47ad40[_0x12c83e(0x1c2)]=_0x68e0fd[_0x12c83e(0x1f1)],delete _0x47ad40[_0x12c83e(0x1f1)]);_0x68e0fd[_0x12c83e(0x1d1)]&&(_0x47ad40[_0x12c83e(0x1d4)]=_0x68e0fd['merchantUrl'],delete _0x47ad40[_0x12c83e(0x1d1)]);_0x68e0fd[_0x12c83e(0x1e3)]&&(_0x47ad40[_0x12c83e(0x1c5)]=JSON[_0x12c83e(0x1db)](_0x68e0fd[_0x12c83e(0x1e3)]),delete _0x47ad40[_0x12c83e(0x1e3)]);_0x68e0fd[_0x12c83e(0x1e7)]&&(_0x47ad40[_0x12c83e(0x1e7)]=JSON[_0x12c83e(0x1db)](_0x68e0fd[_0x12c83e(0x1e7)]),delete _0x47ad40[_0x12c83e(0x1e7)]);_0x68e0fd[_0x12c83e(0x1d6)]&&(_0x68e0fd['wallets'][_0x12c83e(0x1d0)]!==undefined&&(_0x47ad40['usdtPolygonWallet']=_0x68e0fd[_0x12c83e(0x1d6)][_0x12c83e(0x1d0)]||null),_0x68e0fd[_0x12c83e(0x1d6)]['usdtTrcWallet']!==undefined&&(_0x47ad40[_0x12c83e(0x1e0)]=_0x68e0fd[_0x12c83e(0x1d6)][_0x12c83e(0x1e0)]||null),_0x68e0fd[_0x12c83e(0x1d6)][_0x12c83e(0x1d2)]!==undefined&&(_0x47ad40['usdtErcWallet']=_0x68e0fd[_0x12c83e(0x1d6)]['usdtErcWallet']||null),_0x68e0fd['wallets'][_0x12c83e(0x1e6)]!==undefined&&(_0x47ad40[_0x12c83e(0x1e6)]=_0x68e0fd[_0x12c83e(0x1d6)][_0x12c83e(0x1e6)]||null),delete _0x47ad40[_0x12c83e(0x1d6)]);const _0x1a47e0=await database_1[_0x12c83e(0x1c7)][_0x12c83e(0x1e8)][_0x12c83e(0x1d3)]({'where':{'id':_0x7636fd},'data':_0x47ad40,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x1a47e0['id'],'fullName':_0x1a47e0['name'],'username':_0x1a47e0[_0x12c83e(0x1cf)],'telegramId':_0x1a47e0[_0x12c83e(0x1c2)],'merchantUrl':_0x1a47e0[_0x12c83e(0x1d4)],'gateways':_0x1a47e0[_0x12c83e(0x1c5)]?JSON[_0x12c83e(0x1da)](_0x1a47e0[_0x12c83e(0x1c5)]):null,'gatewaySettings':_0x1a47e0['gatewaySettings']?JSON['parse'](_0x1a47e0[_0x12c83e(0x1e7)]):null,'publicKey':_0x1a47e0[_0x12c83e(0x1e1)],'wallets':{'usdtPolygonWallet':_0x1a47e0[_0x12c83e(0x1d0)],'usdtTrcWallet':_0x1a47e0['usdtTrcWallet'],'usdtErcWallet':_0x1a47e0[_0x12c83e(0x1d2)],'usdcPolygonWallet':_0x1a47e0[_0x12c83e(0x1e6)]},'status':_0x1a47e0[_0x12c83e(0x1f4)],'createdAt':_0x1a47e0[_0x12c83e(0x1e2)]};}async[a56_0x30d9f2(0x1ec)](_0x55268f){const _0x551fe7=a56_0x30d9f2;await database_1[_0x551fe7(0x1c7)][_0x551fe7(0x1e8)]['delete']({'where':{'id':_0x55268f}});}}exports[a56_0x30d9f2(0x1f6)]=UserService;