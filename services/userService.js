'use strict';const a57_0x245311=a57_0x3206;(function(_0x276cf3,_0x2ed33d){const _0x535912=a57_0x3206,_0x1d3cc7=_0x276cf3();while(!![]){try{const _0x4eef15=parseInt(_0x535912(0x87))/0x1+parseInt(_0x535912(0x86))/0x2+parseInt(_0x535912(0x8b))/0x3*(-parseInt(_0x535912(0x94))/0x4)+parseInt(_0x535912(0x78))/0x5+-parseInt(_0x535912(0x80))/0x6*(-parseInt(_0x535912(0x98))/0x7)+parseInt(_0x535912(0x7f))/0x8+parseInt(_0x535912(0x9c))/0x9*(-parseInt(_0x535912(0x9a))/0xa);if(_0x4eef15===_0x2ed33d)break;else _0x1d3cc7['push'](_0x1d3cc7['shift']());}catch(_0xee08d8){_0x1d3cc7['push'](_0x1d3cc7['shift']());}}}(a57_0xfda8,0xdd2aa));var __importDefault=this&&this['__importDefault']||function(_0x3323ef){const _0x3a1998=a57_0x3206;return _0x3323ef&&_0x3323ef[_0x3a1998(0x99)]?_0x3323ef:{'default':_0x3323ef};};Object['defineProperty'](exports,a57_0x245311(0x99),{'value':!![]}),exports[a57_0x245311(0x9b)]=void 0x0;const bcryptjs_1=__importDefault(require(a57_0x245311(0x9f))),crypto_1=__importDefault(require('crypto')),database_1=__importDefault(require('../config/database'));function a57_0x3206(_0x1c5ec2,_0x4eb2ef){const _0xfda865=a57_0xfda8();return a57_0x3206=function(_0x320677,_0xcb7e2b){_0x320677=_0x320677-0x71;let _0x1c5393=_0xfda865[_0x320677];return _0x1c5393;},a57_0x3206(_0x1c5ec2,_0x4eb2ef);}class UserService{[a57_0x245311(0x79)](){const _0x33972a=a57_0x245311,_0x1a5046=_0x33972a(0x74)+crypto_1[_0x33972a(0x8d)][_0x33972a(0x95)](0x20)[_0x33972a(0x89)]('hex'),_0x232d38=_0x33972a(0x82)+crypto_1['default']['randomBytes'](0x20)[_0x33972a(0x89)](_0x33972a(0x73));return{'publicKey':_0x1a5046,'secretKey':_0x232d38};}async['createUser'](_0x54be29){const _0x57d87c=a57_0x245311,{fullName:_0x354919,username:_0x488ce5,password:_0x28f95d,telegramId:_0x236a7f,merchantUrl:_0x39005c,gateways:_0x129ca4,gatewaySettings:_0x1b111c,wallets:_0x5b4d78}=_0x54be29,_0x35c54c=await database_1[_0x57d87c(0x8d)][_0x57d87c(0x88)][_0x57d87c(0x92)]({'where':{'username':_0x488ce5}});if(_0x35c54c)throw new Error(_0x57d87c(0x83));if(_0x236a7f){const _0x10f386=await database_1[_0x57d87c(0x8d)][_0x57d87c(0x88)][_0x57d87c(0x92)]({'where':{'telegram':_0x236a7f}});if(_0x10f386)throw new Error('Telegram\x20username\x20already\x20exists');}const _0x42cb0a=await bcryptjs_1['default'][_0x57d87c(0x75)](_0x28f95d,0xc),{publicKey:_0x27fa87,secretKey:_0x456b11}=this[_0x57d87c(0x79)](),_0x44437b=await database_1[_0x57d87c(0x8d)][_0x57d87c(0x88)][_0x57d87c(0x85)]({'data':{'name':_0x354919,'username':_0x488ce5,'password':_0x42cb0a,'telegram':_0x236a7f,'shopUrl':_0x39005c,'paymentGateways':_0x129ca4?JSON[_0x57d87c(0x77)](_0x129ca4):null,'gatewaySettings':_0x1b111c?JSON['stringify'](_0x1b111c):null,'usdtPolygonWallet':_0x5b4d78?.[_0x57d87c(0x84)]||null,'usdtTrcWallet':_0x5b4d78?.['usdtTrcWallet']||null,'usdtErcWallet':_0x5b4d78?.[_0x57d87c(0x91)]||null,'usdcPolygonWallet':_0x5b4d78?.[_0x57d87c(0xa0)]||null,'publicKey':_0x27fa87,'secretKey':_0x456b11,'status':_0x57d87c(0x7b)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x44437b['id'],'fullName':_0x44437b[_0x57d87c(0xa2)],'username':_0x44437b[_0x57d87c(0x76)],'telegramId':_0x44437b['telegram'],'merchantUrl':_0x44437b[_0x57d87c(0x90)],'gateways':_0x44437b[_0x57d87c(0x71)]?JSON[_0x57d87c(0xa1)](_0x44437b[_0x57d87c(0x71)]):null,'gatewaySettings':_0x44437b[_0x57d87c(0x7d)]?JSON[_0x57d87c(0xa1)](_0x44437b[_0x57d87c(0x7d)]):null,'publicKey':_0x44437b[_0x57d87c(0x9e)],'wallets':{'usdtPolygonWallet':_0x44437b['usdtPolygonWallet'],'usdtTrcWallet':_0x44437b[_0x57d87c(0x93)],'usdtErcWallet':_0x44437b[_0x57d87c(0x91)],'usdcPolygonWallet':_0x44437b[_0x57d87c(0xa0)]},'status':_0x44437b[_0x57d87c(0x8c)],'createdAt':_0x44437b[_0x57d87c(0x9d)]};}async['getAllUsers'](){const _0x2eba57=a57_0x245311,_0x2be1b3=await database_1[_0x2eba57(0x8d)][_0x2eba57(0x88)][_0x2eba57(0x7e)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':'desc'}});return _0x2be1b3['map'](_0x1c1740=>({'id':_0x1c1740['id'],'fullName':_0x1c1740[_0x2eba57(0xa2)],'username':_0x1c1740[_0x2eba57(0x76)],'telegramId':_0x1c1740['telegram'],'merchantUrl':_0x1c1740[_0x2eba57(0x90)],'gateways':_0x1c1740['paymentGateways']?JSON[_0x2eba57(0xa1)](_0x1c1740[_0x2eba57(0x71)]):null,'gatewaySettings':_0x1c1740[_0x2eba57(0x7d)]?JSON[_0x2eba57(0xa1)](_0x1c1740['gatewaySettings']):null,'publicKey':_0x1c1740[_0x2eba57(0x9e)],'wallets':{'usdtPolygonWallet':_0x1c1740[_0x2eba57(0x84)],'usdtTrcWallet':_0x1c1740[_0x2eba57(0x93)],'usdtErcWallet':_0x1c1740[_0x2eba57(0x91)],'usdcPolygonWallet':_0x1c1740[_0x2eba57(0xa0)]},'status':_0x1c1740['status'],'createdAt':_0x1c1740[_0x2eba57(0x9d)]}));}async['getUserById'](_0x31b928){const _0x3a5592=a57_0x245311,_0x370a00=await database_1[_0x3a5592(0x8d)]['shop'][_0x3a5592(0x92)]({'where':{'id':_0x31b928},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x370a00)return null;return{'id':_0x370a00['id'],'fullName':_0x370a00[_0x3a5592(0xa2)],'username':_0x370a00[_0x3a5592(0x76)],'telegramId':_0x370a00['telegram'],'merchantUrl':_0x370a00[_0x3a5592(0x90)],'gateways':_0x370a00[_0x3a5592(0x71)]?JSON[_0x3a5592(0xa1)](_0x370a00['paymentGateways']):null,'gatewaySettings':_0x370a00[_0x3a5592(0x7d)]?JSON[_0x3a5592(0xa1)](_0x370a00['gatewaySettings']):null,'publicKey':_0x370a00[_0x3a5592(0x9e)],'wallets':{'usdtPolygonWallet':_0x370a00['usdtPolygonWallet'],'usdtTrcWallet':_0x370a00[_0x3a5592(0x93)],'usdtErcWallet':_0x370a00[_0x3a5592(0x91)],'usdcPolygonWallet':_0x370a00['usdcPolygonWallet']},'status':_0x370a00[_0x3a5592(0x8c)],'createdAt':_0x370a00[_0x3a5592(0x9d)]};}async[a57_0x245311(0x8f)](_0x519dee,_0x3e3726){const _0xc0bdf5=a57_0x245311,_0x496669={..._0x3e3726};_0x3e3726['password']&&(_0x496669[_0xc0bdf5(0x8a)]=await bcryptjs_1[_0xc0bdf5(0x8d)]['hash'](_0x3e3726[_0xc0bdf5(0x8a)],0xc));_0x3e3726[_0xc0bdf5(0x97)]&&(_0x496669[_0xc0bdf5(0xa2)]=_0x3e3726[_0xc0bdf5(0x97)],delete _0x496669['fullName']);_0x3e3726['telegramId']&&(_0x496669[_0xc0bdf5(0x8e)]=_0x3e3726[_0xc0bdf5(0x96)],delete _0x496669['telegramId']);_0x3e3726['merchantUrl']&&(_0x496669[_0xc0bdf5(0x90)]=_0x3e3726[_0xc0bdf5(0x72)],delete _0x496669[_0xc0bdf5(0x72)]);_0x3e3726[_0xc0bdf5(0x81)]&&(_0x496669[_0xc0bdf5(0x71)]=JSON[_0xc0bdf5(0x77)](_0x3e3726['gateways']),delete _0x496669[_0xc0bdf5(0x81)]);_0x3e3726['gatewaySettings']&&(_0x496669[_0xc0bdf5(0x7d)]=JSON[_0xc0bdf5(0x77)](_0x3e3726['gatewaySettings']),delete _0x496669[_0xc0bdf5(0x7d)]);_0x3e3726[_0xc0bdf5(0x7a)]&&(_0x3e3726[_0xc0bdf5(0x7a)][_0xc0bdf5(0x84)]!==undefined&&(_0x496669['usdtPolygonWallet']=_0x3e3726[_0xc0bdf5(0x7a)]['usdtPolygonWallet']||null),_0x3e3726['wallets']['usdtTrcWallet']!==undefined&&(_0x496669[_0xc0bdf5(0x93)]=_0x3e3726[_0xc0bdf5(0x7a)][_0xc0bdf5(0x93)]||null),_0x3e3726[_0xc0bdf5(0x7a)][_0xc0bdf5(0x91)]!==undefined&&(_0x496669[_0xc0bdf5(0x91)]=_0x3e3726[_0xc0bdf5(0x7a)][_0xc0bdf5(0x91)]||null),_0x3e3726[_0xc0bdf5(0x7a)]['usdcPolygonWallet']!==undefined&&(_0x496669[_0xc0bdf5(0xa0)]=_0x3e3726['wallets'][_0xc0bdf5(0xa0)]||null),delete _0x496669[_0xc0bdf5(0x7a)]);const _0x1c72b1=await database_1[_0xc0bdf5(0x8d)][_0xc0bdf5(0x88)]['update']({'where':{'id':_0x519dee},'data':_0x496669,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x1c72b1['id'],'fullName':_0x1c72b1[_0xc0bdf5(0xa2)],'username':_0x1c72b1[_0xc0bdf5(0x76)],'telegramId':_0x1c72b1[_0xc0bdf5(0x8e)],'merchantUrl':_0x1c72b1['shopUrl'],'gateways':_0x1c72b1[_0xc0bdf5(0x71)]?JSON[_0xc0bdf5(0xa1)](_0x1c72b1['paymentGateways']):null,'gatewaySettings':_0x1c72b1[_0xc0bdf5(0x7d)]?JSON[_0xc0bdf5(0xa1)](_0x1c72b1['gatewaySettings']):null,'publicKey':_0x1c72b1['publicKey'],'wallets':{'usdtPolygonWallet':_0x1c72b1[_0xc0bdf5(0x84)],'usdtTrcWallet':_0x1c72b1['usdtTrcWallet'],'usdtErcWallet':_0x1c72b1[_0xc0bdf5(0x91)],'usdcPolygonWallet':_0x1c72b1[_0xc0bdf5(0xa0)]},'status':_0x1c72b1[_0xc0bdf5(0x8c)],'createdAt':_0x1c72b1[_0xc0bdf5(0x9d)]};}async[a57_0x245311(0x7c)](_0x44a2a5){const _0x3c0e61=a57_0x245311;await database_1[_0x3c0e61(0x8d)][_0x3c0e61(0x88)]['delete']({'where':{'id':_0x44a2a5}});}}function a57_0xfda8(){const _0x495e8d=['2393620GCpZFe','randomBytes','telegramId','fullName','168VvWkIV','__esModule','3362570JuajVV','UserService','63IPMVtz','createdAt','publicKey','bcryptjs','usdcPolygonWallet','parse','name','paymentGateways','merchantUrl','hex','pk_','hash','username','stringify','926715pEbuXV','generateApiKeys','wallets','ACTIVE','deleteUser','gatewaySettings','findMany','10334696pSQwcA','12090jzJzCJ','gateways','sk_','Username\x20already\x20exists','usdtPolygonWallet','create','1166420letmFo','1749352fgwXWY','shop','toString','password','3tLskWe','status','default','telegram','updateUser','shopUrl','usdtErcWallet','findUnique','usdtTrcWallet'];a57_0xfda8=function(){return _0x495e8d;};return a57_0xfda8();}exports[a57_0x245311(0x9b)]=UserService;