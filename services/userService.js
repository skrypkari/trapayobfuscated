'use strict';function a89_0x49c6(){const _0xd7dd5f=['shop','wallets','status','name','../config/database','merchantUrl','fullName','906885HsyNMT','ACTIVE','password','stringify','__esModule','username','23573BTIVzd','randomBytes','gatewaySettings','telegramId','11741JnZDoC','hash','gateways','default','findUnique','usdtPolygonWallet','crypto','defineProperty','parse','findMany','pk_','usdtErcWallet','getUserById','1380966ozHLMn','generateApiKeys','3FQsXQa','paymentGateways','162548auFmQr','usdcPolygonWallet','deleteUser','72uhoRqn','1632827pTUIMS','1206aDqTQQ','createdAt','shopUrl','getAllUsers','telegram','__importDefault','publicKey','usdtTrcWallet','toString','sk_','2190wxgzed','update','createUser','Telegram\x20username\x20already\x20exists','hex','UserService','34904qQDjqI'];a89_0x49c6=function(){return _0xd7dd5f;};return a89_0x49c6();}const a89_0x122794=a89_0x59b3;(function(_0x4cfe96,_0x280891){const _0x14fb50=a89_0x59b3,_0x1113d7=_0x4cfe96();while(!![]){try{const _0x588c08=parseInt(_0x14fb50(0xf1))/0x1*(parseInt(_0x14fb50(0xcd))/0x2)+-parseInt(_0x14fb50(0xc8))/0x3*(-parseInt(_0x14fb50(0xca))/0x4)+parseInt(_0x14fb50(0xe7))/0x5+-parseInt(_0x14fb50(0xc6))/0x6+-parseInt(_0x14fb50(0xce))/0x7+parseInt(_0x14fb50(0xdf))/0x8*(parseInt(_0x14fb50(0xcf))/0x9)+parseInt(_0x14fb50(0xd9))/0xa*(-parseInt(_0x14fb50(0xed))/0xb);if(_0x588c08===_0x280891)break;else _0x1113d7['push'](_0x1113d7['shift']());}catch(_0x15ad11){_0x1113d7['push'](_0x1113d7['shift']());}}}(a89_0x49c6,0x48691));function a89_0x59b3(_0x5949fd,_0x30e4e3){_0x5949fd=_0x5949fd-0xc1;const _0x49c682=a89_0x49c6();let _0x59b34a=_0x49c682[_0x5949fd];return _0x59b34a;}var __importDefault=this&&this[a89_0x122794(0xd4)]||function(_0x46e504){const _0xc39c27=a89_0x122794;return _0x46e504&&_0x46e504[_0xc39c27(0xeb)]?_0x46e504:{'default':_0x46e504};};Object[a89_0x122794(0xf8)](exports,a89_0x122794(0xeb),{'value':!![]}),exports[a89_0x122794(0xde)]=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),crypto_1=__importDefault(require(a89_0x122794(0xf7))),database_1=__importDefault(require(a89_0x122794(0xe4)));class UserService{[a89_0x122794(0xc7)](){const _0x80d09f=a89_0x122794,_0x5a98fe=_0x80d09f(0xc3)+crypto_1[_0x80d09f(0xf4)][_0x80d09f(0xee)](0x20)[_0x80d09f(0xd7)]('hex'),_0x2464ff=_0x80d09f(0xd8)+crypto_1[_0x80d09f(0xf4)][_0x80d09f(0xee)](0x20)[_0x80d09f(0xd7)](_0x80d09f(0xdd));return{'publicKey':_0x5a98fe,'secretKey':_0x2464ff};}async[a89_0x122794(0xdb)](_0x511773){const _0x49577f=a89_0x122794,{fullName:_0x1fefb6,username:_0x438344,password:_0x387b62,telegramId:_0x3f94f7,merchantUrl:_0x5957bb,gateways:_0x3a3159,gatewaySettings:_0x557f63,wallets:_0x3d13e6}=_0x511773,_0x54573d=await database_1['default'][_0x49577f(0xe0)][_0x49577f(0xf5)]({'where':{'username':_0x438344}});if(_0x54573d)throw new Error('Username\x20already\x20exists');if(_0x3f94f7){const _0x3305ed=await database_1[_0x49577f(0xf4)][_0x49577f(0xe0)]['findUnique']({'where':{'telegram':_0x3f94f7}});if(_0x3305ed)throw new Error(_0x49577f(0xdc));}const _0x519c16=await bcryptjs_1[_0x49577f(0xf4)][_0x49577f(0xf2)](_0x387b62,0xc),{publicKey:_0x42e00a,secretKey:_0x14401d}=this[_0x49577f(0xc7)](),_0x2315fa=await database_1[_0x49577f(0xf4)][_0x49577f(0xe0)]['create']({'data':{'name':_0x1fefb6,'username':_0x438344,'password':_0x519c16,'telegram':_0x3f94f7,'shopUrl':_0x5957bb,'paymentGateways':_0x3a3159?JSON['stringify'](_0x3a3159):null,'gatewaySettings':_0x557f63?JSON[_0x49577f(0xea)](_0x557f63):null,'usdtPolygonWallet':_0x3d13e6?.[_0x49577f(0xf6)]||null,'usdtTrcWallet':_0x3d13e6?.[_0x49577f(0xd6)]||null,'usdtErcWallet':_0x3d13e6?.[_0x49577f(0xc4)]||null,'usdcPolygonWallet':_0x3d13e6?.['usdcPolygonWallet']||null,'publicKey':_0x42e00a,'secretKey':_0x14401d,'status':_0x49577f(0xe8)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x2315fa['id'],'fullName':_0x2315fa[_0x49577f(0xe3)],'username':_0x2315fa[_0x49577f(0xec)],'telegramId':_0x2315fa[_0x49577f(0xd3)],'merchantUrl':_0x2315fa['shopUrl'],'gateways':_0x2315fa[_0x49577f(0xc9)]?JSON['parse'](_0x2315fa[_0x49577f(0xc9)]):null,'gatewaySettings':_0x2315fa[_0x49577f(0xef)]?JSON[_0x49577f(0xc1)](_0x2315fa[_0x49577f(0xef)]):null,'publicKey':_0x2315fa[_0x49577f(0xd5)],'wallets':{'usdtPolygonWallet':_0x2315fa[_0x49577f(0xf6)],'usdtTrcWallet':_0x2315fa['usdtTrcWallet'],'usdtErcWallet':_0x2315fa[_0x49577f(0xc4)],'usdcPolygonWallet':_0x2315fa[_0x49577f(0xcb)]},'status':_0x2315fa['status'],'createdAt':_0x2315fa['createdAt']};}async[a89_0x122794(0xd2)](){const _0x57e220=a89_0x122794,_0x41ad89=await database_1[_0x57e220(0xf4)][_0x57e220(0xe0)][_0x57e220(0xc2)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':'desc'}});return _0x41ad89['map'](_0x376e93=>({'id':_0x376e93['id'],'fullName':_0x376e93[_0x57e220(0xe3)],'username':_0x376e93[_0x57e220(0xec)],'telegramId':_0x376e93['telegram'],'merchantUrl':_0x376e93[_0x57e220(0xd1)],'gateways':_0x376e93[_0x57e220(0xc9)]?JSON[_0x57e220(0xc1)](_0x376e93[_0x57e220(0xc9)]):null,'gatewaySettings':_0x376e93[_0x57e220(0xef)]?JSON[_0x57e220(0xc1)](_0x376e93[_0x57e220(0xef)]):null,'publicKey':_0x376e93[_0x57e220(0xd5)],'wallets':{'usdtPolygonWallet':_0x376e93[_0x57e220(0xf6)],'usdtTrcWallet':_0x376e93['usdtTrcWallet'],'usdtErcWallet':_0x376e93[_0x57e220(0xc4)],'usdcPolygonWallet':_0x376e93[_0x57e220(0xcb)]},'status':_0x376e93[_0x57e220(0xe2)],'createdAt':_0x376e93[_0x57e220(0xd0)]}));}async[a89_0x122794(0xc5)](_0x36265c){const _0x47be54=a89_0x122794,_0x2e637a=await database_1[_0x47be54(0xf4)][_0x47be54(0xe0)]['findUnique']({'where':{'id':_0x36265c},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x2e637a)return null;return{'id':_0x2e637a['id'],'fullName':_0x2e637a['name'],'username':_0x2e637a['username'],'telegramId':_0x2e637a[_0x47be54(0xd3)],'merchantUrl':_0x2e637a[_0x47be54(0xd1)],'gateways':_0x2e637a['paymentGateways']?JSON['parse'](_0x2e637a[_0x47be54(0xc9)]):null,'gatewaySettings':_0x2e637a[_0x47be54(0xef)]?JSON[_0x47be54(0xc1)](_0x2e637a[_0x47be54(0xef)]):null,'publicKey':_0x2e637a[_0x47be54(0xd5)],'wallets':{'usdtPolygonWallet':_0x2e637a[_0x47be54(0xf6)],'usdtTrcWallet':_0x2e637a[_0x47be54(0xd6)],'usdtErcWallet':_0x2e637a[_0x47be54(0xc4)],'usdcPolygonWallet':_0x2e637a[_0x47be54(0xcb)]},'status':_0x2e637a[_0x47be54(0xe2)],'createdAt':_0x2e637a[_0x47be54(0xd0)]};}async['updateUser'](_0x58ee85,_0x22e7fd){const _0x5dd5a4=a89_0x122794,_0x1725f1={..._0x22e7fd};_0x22e7fd['password']&&(_0x1725f1['password']=await bcryptjs_1[_0x5dd5a4(0xf4)][_0x5dd5a4(0xf2)](_0x22e7fd[_0x5dd5a4(0xe9)],0xc));_0x22e7fd[_0x5dd5a4(0xe6)]&&(_0x1725f1[_0x5dd5a4(0xe3)]=_0x22e7fd[_0x5dd5a4(0xe6)],delete _0x1725f1[_0x5dd5a4(0xe6)]);_0x22e7fd[_0x5dd5a4(0xf0)]&&(_0x1725f1['telegram']=_0x22e7fd['telegramId'],delete _0x1725f1[_0x5dd5a4(0xf0)]);_0x22e7fd[_0x5dd5a4(0xe5)]&&(_0x1725f1['shopUrl']=_0x22e7fd['merchantUrl'],delete _0x1725f1[_0x5dd5a4(0xe5)]);_0x22e7fd['gateways']&&(_0x1725f1[_0x5dd5a4(0xc9)]=JSON[_0x5dd5a4(0xea)](_0x22e7fd[_0x5dd5a4(0xf3)]),delete _0x1725f1[_0x5dd5a4(0xf3)]);_0x22e7fd['gatewaySettings']&&(_0x1725f1[_0x5dd5a4(0xef)]=JSON[_0x5dd5a4(0xea)](_0x22e7fd[_0x5dd5a4(0xef)]),delete _0x1725f1[_0x5dd5a4(0xef)]);_0x22e7fd['wallets']&&(_0x22e7fd[_0x5dd5a4(0xe1)]['usdtPolygonWallet']!==undefined&&(_0x1725f1[_0x5dd5a4(0xf6)]=_0x22e7fd['wallets'][_0x5dd5a4(0xf6)]||null),_0x22e7fd[_0x5dd5a4(0xe1)]['usdtTrcWallet']!==undefined&&(_0x1725f1['usdtTrcWallet']=_0x22e7fd[_0x5dd5a4(0xe1)][_0x5dd5a4(0xd6)]||null),_0x22e7fd[_0x5dd5a4(0xe1)][_0x5dd5a4(0xc4)]!==undefined&&(_0x1725f1[_0x5dd5a4(0xc4)]=_0x22e7fd[_0x5dd5a4(0xe1)][_0x5dd5a4(0xc4)]||null),_0x22e7fd[_0x5dd5a4(0xe1)][_0x5dd5a4(0xcb)]!==undefined&&(_0x1725f1['usdcPolygonWallet']=_0x22e7fd[_0x5dd5a4(0xe1)][_0x5dd5a4(0xcb)]||null),delete _0x1725f1[_0x5dd5a4(0xe1)]);const _0x2de1f7=await database_1[_0x5dd5a4(0xf4)]['shop'][_0x5dd5a4(0xda)]({'where':{'id':_0x58ee85},'data':_0x1725f1,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x2de1f7['id'],'fullName':_0x2de1f7[_0x5dd5a4(0xe3)],'username':_0x2de1f7['username'],'telegramId':_0x2de1f7['telegram'],'merchantUrl':_0x2de1f7[_0x5dd5a4(0xd1)],'gateways':_0x2de1f7['paymentGateways']?JSON['parse'](_0x2de1f7['paymentGateways']):null,'gatewaySettings':_0x2de1f7[_0x5dd5a4(0xef)]?JSON[_0x5dd5a4(0xc1)](_0x2de1f7[_0x5dd5a4(0xef)]):null,'publicKey':_0x2de1f7['publicKey'],'wallets':{'usdtPolygonWallet':_0x2de1f7[_0x5dd5a4(0xf6)],'usdtTrcWallet':_0x2de1f7[_0x5dd5a4(0xd6)],'usdtErcWallet':_0x2de1f7[_0x5dd5a4(0xc4)],'usdcPolygonWallet':_0x2de1f7[_0x5dd5a4(0xcb)]},'status':_0x2de1f7['status'],'createdAt':_0x2de1f7[_0x5dd5a4(0xd0)]};}async[a89_0x122794(0xcc)](_0x228bc7){const _0x5bbcc3=a89_0x122794;await database_1[_0x5bbcc3(0xf4)][_0x5bbcc3(0xe0)]['delete']({'where':{'id':_0x228bc7}});}}exports[a89_0x122794(0xde)]=UserService;