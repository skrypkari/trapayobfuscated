'use strict';const a56_0x3b2961=a56_0x4d35;function a56_0x1624(){const _0x4c04c5=['telegramId','Telegram\x20username\x20already\x20exists','bcryptjs','27MPojXd','Username\x20already\x20exists','3782420AohjWY','createdAt','desc','3447678yuYnoX','publicKey','ACTIVE','username','790104kpJjPp','UserService','usdtTrcWallet','toString','findMany','stringify','findUnique','parse','__importDefault','telegram','usdtPolygonWallet','fullName','getAllUsers','usdtErcWallet','randomBytes','shop','generateApiKeys','gatewaySettings','merchantUrl','3awEzRG','usdcPolygonWallet','name','../config/database','wallets','status','hash','shopUrl','1223291KHeIhJ','hex','create','createUser','paymentGateways','gateways','password','4620572GQTHsn','sk_','pk_','__esModule','default','7smXPcw','677984GjzNvf','4094735oyHvPY'];a56_0x1624=function(){return _0x4c04c5;};return a56_0x1624();}function a56_0x4d35(_0x1d34e4,_0x15221b){const _0x162429=a56_0x1624();return a56_0x4d35=function(_0x4d358d,_0x18a2f8){_0x4d358d=_0x4d358d-0xbc;let _0x34a74d=_0x162429[_0x4d358d];return _0x34a74d;},a56_0x4d35(_0x1d34e4,_0x15221b);}(function(_0x3c4d6d,_0xf4caa0){const _0x5624c5=a56_0x4d35,_0x138991=_0x3c4d6d();while(!![]){try{const _0x4217d5=parseInt(_0x5624c5(0xbe))/0x1+-parseInt(_0x5624c5(0xd9))/0x2+parseInt(_0x5624c5(0xec))/0x3*(-parseInt(_0x5624c5(0xc5))/0x4)+-parseInt(_0x5624c5(0xcc))/0x5+parseInt(_0x5624c5(0xd5))/0x6*(parseInt(_0x5624c5(0xca))/0x7)+parseInt(_0x5624c5(0xcb))/0x8+parseInt(_0x5624c5(0xd0))/0x9*(parseInt(_0x5624c5(0xd2))/0xa);if(_0x4217d5===_0xf4caa0)break;else _0x138991['push'](_0x138991['shift']());}catch(_0x35c356){_0x138991['push'](_0x138991['shift']());}}}(a56_0x1624,0x9e42c));var __importDefault=this&&this[a56_0x3b2961(0xe1)]||function(_0x4436da){const _0x2064e8=a56_0x3b2961;return _0x4436da&&_0x4436da[_0x2064e8(0xc8)]?_0x4436da:{'default':_0x4436da};};Object['defineProperty'](exports,a56_0x3b2961(0xc8),{'value':!![]}),exports[a56_0x3b2961(0xda)]=void 0x0;const bcryptjs_1=__importDefault(require(a56_0x3b2961(0xcf))),crypto_1=__importDefault(require('crypto')),database_1=__importDefault(require(a56_0x3b2961(0xef)));class UserService{['generateApiKeys'](){const _0x54470d=a56_0x3b2961,_0x4b9671=_0x54470d(0xc7)+crypto_1[_0x54470d(0xc9)][_0x54470d(0xe7)](0x20)[_0x54470d(0xdc)](_0x54470d(0xbf)),_0x474eae=_0x54470d(0xc6)+crypto_1[_0x54470d(0xc9)]['randomBytes'](0x20)['toString'](_0x54470d(0xbf));return{'publicKey':_0x4b9671,'secretKey':_0x474eae};}async[a56_0x3b2961(0xc1)](_0x2a14a1){const _0x117eba=a56_0x3b2961,{fullName:_0x4553cb,username:_0x30c8c4,password:_0x217f20,telegramId:_0xe18797,merchantUrl:_0x3445f3,gateways:_0x294aee,gatewaySettings:_0x1cbb60,wallets:_0x1f169a}=_0x2a14a1,_0xb40aac=await database_1[_0x117eba(0xc9)][_0x117eba(0xe8)][_0x117eba(0xdf)]({'where':{'username':_0x30c8c4}});if(_0xb40aac)throw new Error(_0x117eba(0xd1));if(_0xe18797){const _0x59b8a4=await database_1[_0x117eba(0xc9)][_0x117eba(0xe8)][_0x117eba(0xdf)]({'where':{'telegram':_0xe18797}});if(_0x59b8a4)throw new Error(_0x117eba(0xce));}const _0x25e1b1=await bcryptjs_1[_0x117eba(0xc9)][_0x117eba(0xbc)](_0x217f20,0xc),{publicKey:_0x3fba22,secretKey:_0x444b30}=this[_0x117eba(0xe9)](),_0x6e4628=await database_1[_0x117eba(0xc9)]['shop'][_0x117eba(0xc0)]({'data':{'name':_0x4553cb,'username':_0x30c8c4,'password':_0x25e1b1,'telegram':_0xe18797,'shopUrl':_0x3445f3,'paymentGateways':_0x294aee?JSON[_0x117eba(0xde)](_0x294aee):null,'gatewaySettings':_0x1cbb60?JSON[_0x117eba(0xde)](_0x1cbb60):null,'usdtPolygonWallet':_0x1f169a?.[_0x117eba(0xe3)]||null,'usdtTrcWallet':_0x1f169a?.[_0x117eba(0xdb)]||null,'usdtErcWallet':_0x1f169a?.[_0x117eba(0xe6)]||null,'usdcPolygonWallet':_0x1f169a?.[_0x117eba(0xed)]||null,'publicKey':_0x3fba22,'secretKey':_0x444b30,'status':_0x117eba(0xd7)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x6e4628['id'],'fullName':_0x6e4628[_0x117eba(0xee)],'username':_0x6e4628['username'],'telegramId':_0x6e4628[_0x117eba(0xe2)],'merchantUrl':_0x6e4628[_0x117eba(0xbd)],'gateways':_0x6e4628[_0x117eba(0xc2)]?JSON[_0x117eba(0xe0)](_0x6e4628[_0x117eba(0xc2)]):null,'gatewaySettings':_0x6e4628['gatewaySettings']?JSON[_0x117eba(0xe0)](_0x6e4628[_0x117eba(0xea)]):null,'publicKey':_0x6e4628[_0x117eba(0xd6)],'wallets':{'usdtPolygonWallet':_0x6e4628[_0x117eba(0xe3)],'usdtTrcWallet':_0x6e4628[_0x117eba(0xdb)],'usdtErcWallet':_0x6e4628[_0x117eba(0xe6)],'usdcPolygonWallet':_0x6e4628[_0x117eba(0xed)]},'status':_0x6e4628['status'],'createdAt':_0x6e4628['createdAt']};}async[a56_0x3b2961(0xe5)](){const _0x2f8166=a56_0x3b2961,_0x5c1767=await database_1[_0x2f8166(0xc9)][_0x2f8166(0xe8)][_0x2f8166(0xdd)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x2f8166(0xd4)}});return _0x5c1767['map'](_0x4ee6ff=>({'id':_0x4ee6ff['id'],'fullName':_0x4ee6ff['name'],'username':_0x4ee6ff['username'],'telegramId':_0x4ee6ff[_0x2f8166(0xe2)],'merchantUrl':_0x4ee6ff[_0x2f8166(0xbd)],'gateways':_0x4ee6ff['paymentGateways']?JSON[_0x2f8166(0xe0)](_0x4ee6ff[_0x2f8166(0xc2)]):null,'gatewaySettings':_0x4ee6ff['gatewaySettings']?JSON['parse'](_0x4ee6ff[_0x2f8166(0xea)]):null,'publicKey':_0x4ee6ff['publicKey'],'wallets':{'usdtPolygonWallet':_0x4ee6ff[_0x2f8166(0xe3)],'usdtTrcWallet':_0x4ee6ff[_0x2f8166(0xdb)],'usdtErcWallet':_0x4ee6ff['usdtErcWallet'],'usdcPolygonWallet':_0x4ee6ff['usdcPolygonWallet']},'status':_0x4ee6ff[_0x2f8166(0xf1)],'createdAt':_0x4ee6ff['createdAt']}));}async['getUserById'](_0x484eb6){const _0x549a0b=a56_0x3b2961,_0x31a47f=await database_1[_0x549a0b(0xc9)]['shop'][_0x549a0b(0xdf)]({'where':{'id':_0x484eb6},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x31a47f)return null;return{'id':_0x31a47f['id'],'fullName':_0x31a47f[_0x549a0b(0xee)],'username':_0x31a47f[_0x549a0b(0xd8)],'telegramId':_0x31a47f['telegram'],'merchantUrl':_0x31a47f[_0x549a0b(0xbd)],'gateways':_0x31a47f[_0x549a0b(0xc2)]?JSON[_0x549a0b(0xe0)](_0x31a47f[_0x549a0b(0xc2)]):null,'gatewaySettings':_0x31a47f[_0x549a0b(0xea)]?JSON[_0x549a0b(0xe0)](_0x31a47f['gatewaySettings']):null,'publicKey':_0x31a47f['publicKey'],'wallets':{'usdtPolygonWallet':_0x31a47f[_0x549a0b(0xe3)],'usdtTrcWallet':_0x31a47f[_0x549a0b(0xdb)],'usdtErcWallet':_0x31a47f['usdtErcWallet'],'usdcPolygonWallet':_0x31a47f[_0x549a0b(0xed)]},'status':_0x31a47f[_0x549a0b(0xf1)],'createdAt':_0x31a47f[_0x549a0b(0xd3)]};}async['updateUser'](_0x5c5907,_0x5ced31){const _0x4f81fc=a56_0x3b2961,_0x325794={..._0x5ced31};_0x5ced31[_0x4f81fc(0xc4)]&&(_0x325794[_0x4f81fc(0xc4)]=await bcryptjs_1[_0x4f81fc(0xc9)][_0x4f81fc(0xbc)](_0x5ced31['password'],0xc));_0x5ced31[_0x4f81fc(0xe4)]&&(_0x325794[_0x4f81fc(0xee)]=_0x5ced31[_0x4f81fc(0xe4)],delete _0x325794[_0x4f81fc(0xe4)]);_0x5ced31['telegramId']&&(_0x325794[_0x4f81fc(0xe2)]=_0x5ced31[_0x4f81fc(0xcd)],delete _0x325794[_0x4f81fc(0xcd)]);_0x5ced31[_0x4f81fc(0xeb)]&&(_0x325794[_0x4f81fc(0xbd)]=_0x5ced31[_0x4f81fc(0xeb)],delete _0x325794[_0x4f81fc(0xeb)]);_0x5ced31[_0x4f81fc(0xc3)]&&(_0x325794[_0x4f81fc(0xc2)]=JSON[_0x4f81fc(0xde)](_0x5ced31[_0x4f81fc(0xc3)]),delete _0x325794[_0x4f81fc(0xc3)]);_0x5ced31['gatewaySettings']&&(_0x325794[_0x4f81fc(0xea)]=JSON['stringify'](_0x5ced31[_0x4f81fc(0xea)]),delete _0x325794[_0x4f81fc(0xea)]);_0x5ced31[_0x4f81fc(0xf0)]&&(_0x5ced31['wallets'][_0x4f81fc(0xe3)]!==undefined&&(_0x325794[_0x4f81fc(0xe3)]=_0x5ced31['wallets'][_0x4f81fc(0xe3)]||null),_0x5ced31[_0x4f81fc(0xf0)][_0x4f81fc(0xdb)]!==undefined&&(_0x325794[_0x4f81fc(0xdb)]=_0x5ced31[_0x4f81fc(0xf0)][_0x4f81fc(0xdb)]||null),_0x5ced31[_0x4f81fc(0xf0)]['usdtErcWallet']!==undefined&&(_0x325794[_0x4f81fc(0xe6)]=_0x5ced31[_0x4f81fc(0xf0)][_0x4f81fc(0xe6)]||null),_0x5ced31[_0x4f81fc(0xf0)][_0x4f81fc(0xed)]!==undefined&&(_0x325794[_0x4f81fc(0xed)]=_0x5ced31[_0x4f81fc(0xf0)][_0x4f81fc(0xed)]||null),delete _0x325794[_0x4f81fc(0xf0)]);const _0x5dded5=await database_1[_0x4f81fc(0xc9)][_0x4f81fc(0xe8)]['update']({'where':{'id':_0x5c5907},'data':_0x325794,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x5dded5['id'],'fullName':_0x5dded5[_0x4f81fc(0xee)],'username':_0x5dded5[_0x4f81fc(0xd8)],'telegramId':_0x5dded5['telegram'],'merchantUrl':_0x5dded5[_0x4f81fc(0xbd)],'gateways':_0x5dded5[_0x4f81fc(0xc2)]?JSON[_0x4f81fc(0xe0)](_0x5dded5[_0x4f81fc(0xc2)]):null,'gatewaySettings':_0x5dded5['gatewaySettings']?JSON[_0x4f81fc(0xe0)](_0x5dded5[_0x4f81fc(0xea)]):null,'publicKey':_0x5dded5[_0x4f81fc(0xd6)],'wallets':{'usdtPolygonWallet':_0x5dded5[_0x4f81fc(0xe3)],'usdtTrcWallet':_0x5dded5[_0x4f81fc(0xdb)],'usdtErcWallet':_0x5dded5['usdtErcWallet'],'usdcPolygonWallet':_0x5dded5['usdcPolygonWallet']},'status':_0x5dded5[_0x4f81fc(0xf1)],'createdAt':_0x5dded5[_0x4f81fc(0xd3)]};}async['deleteUser'](_0x13b376){const _0x37a5df=a56_0x3b2961;await database_1[_0x37a5df(0xc9)]['shop']['delete']({'where':{'id':_0x13b376}});}}exports[a56_0x3b2961(0xda)]=UserService;