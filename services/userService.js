'use strict';function a51_0x2104(){const _0x5eb9c7=['hash','map','telegram','301NsOjRj','sk_','createdAt','createUser','toString','fullName','getUserById','update','usdtTrcWallet','860307zXIwqp','wallets','generateApiKeys','UserService','1231188LFHuoy','2WacKoL','bcryptjs','randomBytes','__esModule','ACTIVE','crypto','getAllUsers','username','1172496QtJbiu','password','usdtErcWallet','hex','publicKey','Username\x20already\x20exists','findUnique','6912387QfaLJp','../config/database','paymentGateways','name','shopUrl','merchantUrl','parse','telegramId','3106873hyRtXL','usdcPolygonWallet','desc','1752219PoczWT','stringify','status','gatewaySettings','10zqOExW','shop','defineProperty','gateways','usdtPolygonWallet','default','10nblXXp','deleteUser','__importDefault','98704nAAyQk','create','updateUser'];a51_0x2104=function(){return _0x5eb9c7;};return a51_0x2104();}const a51_0x22e4c8=a51_0x44c9;function a51_0x44c9(_0xf5502c,_0x4a08ae){const _0x21048a=a51_0x2104();return a51_0x44c9=function(_0x44c93d,_0x1817f8){_0x44c93d=_0x44c93d-0x120;let _0x23d3c8=_0x21048a[_0x44c93d];return _0x23d3c8;},a51_0x44c9(_0xf5502c,_0x4a08ae);}(function(_0xcb308e,_0xe6e1e){const _0x4a7917=a51_0x44c9,_0x5c2924=_0xcb308e();while(!![]){try{const _0x1514ce=parseInt(_0x4a7917(0x13e))/0x1+parseInt(_0x4a7917(0x143))/0x2*(-parseInt(_0x4a7917(0x122))/0x3)+-parseInt(_0x4a7917(0x14b))/0x4+-parseInt(_0x4a7917(0x12c))/0x5*(-parseInt(_0x4a7917(0x142))/0x6)+parseInt(_0x4a7917(0x135))/0x7*(parseInt(_0x4a7917(0x12f))/0x8)+-parseInt(_0x4a7917(0x152))/0x9*(parseInt(_0x4a7917(0x126))/0xa)+parseInt(_0x4a7917(0x15a))/0xb;if(_0x1514ce===_0xe6e1e)break;else _0x5c2924['push'](_0x5c2924['shift']());}catch(_0x4f806c){_0x5c2924['push'](_0x5c2924['shift']());}}}(a51_0x2104,0x6b0a8));var __importDefault=this&&this[a51_0x22e4c8(0x12e)]||function(_0x3af243){const _0x2dc23e=a51_0x22e4c8;return _0x3af243&&_0x3af243[_0x2dc23e(0x146)]?_0x3af243:{'default':_0x3af243};};Object[a51_0x22e4c8(0x128)](exports,a51_0x22e4c8(0x146),{'value':!![]}),exports[a51_0x22e4c8(0x141)]=void 0x0;const bcryptjs_1=__importDefault(require(a51_0x22e4c8(0x144))),crypto_1=__importDefault(require(a51_0x22e4c8(0x148))),database_1=__importDefault(require(a51_0x22e4c8(0x153)));class UserService{[a51_0x22e4c8(0x140)](){const _0x27f0b9=a51_0x22e4c8,_0x41d4fb='pk_'+crypto_1[_0x27f0b9(0x12b)][_0x27f0b9(0x145)](0x20)[_0x27f0b9(0x139)](_0x27f0b9(0x14e)),_0x3fb316=_0x27f0b9(0x136)+crypto_1[_0x27f0b9(0x12b)]['randomBytes'](0x20)[_0x27f0b9(0x139)](_0x27f0b9(0x14e));return{'publicKey':_0x41d4fb,'secretKey':_0x3fb316};}async[a51_0x22e4c8(0x138)](_0x470c1a){const _0x4af5cd=a51_0x22e4c8,{fullName:_0x443b1a,username:_0x53941c,password:_0x383424,telegramId:_0x27137c,merchantUrl:_0x286ec6,gateways:_0x27dec0,gatewaySettings:_0x27820c,wallets:_0x5a7a15}=_0x470c1a,_0x42eaae=await database_1[_0x4af5cd(0x12b)][_0x4af5cd(0x127)][_0x4af5cd(0x151)]({'where':{'username':_0x53941c}});if(_0x42eaae)throw new Error(_0x4af5cd(0x150));if(_0x27137c){const _0x4940fc=await database_1['default'][_0x4af5cd(0x127)][_0x4af5cd(0x151)]({'where':{'telegram':_0x27137c}});if(_0x4940fc)throw new Error('Telegram\x20username\x20already\x20exists');}const _0x53f266=await bcryptjs_1[_0x4af5cd(0x12b)]['hash'](_0x383424,0xc),{publicKey:_0x41e70f,secretKey:_0x439ada}=this[_0x4af5cd(0x140)](),_0x436072=await database_1['default']['shop'][_0x4af5cd(0x130)]({'data':{'name':_0x443b1a,'username':_0x53941c,'password':_0x53f266,'telegram':_0x27137c,'shopUrl':_0x286ec6,'paymentGateways':_0x27dec0?JSON[_0x4af5cd(0x123)](_0x27dec0):null,'gatewaySettings':_0x27820c?JSON[_0x4af5cd(0x123)](_0x27820c):null,'usdtPolygonWallet':_0x5a7a15?.[_0x4af5cd(0x12a)]||null,'usdtTrcWallet':_0x5a7a15?.[_0x4af5cd(0x13d)]||null,'usdtErcWallet':_0x5a7a15?.[_0x4af5cd(0x14d)]||null,'usdcPolygonWallet':_0x5a7a15?.[_0x4af5cd(0x120)]||null,'publicKey':_0x41e70f,'secretKey':_0x439ada,'status':_0x4af5cd(0x147)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x436072['id'],'fullName':_0x436072[_0x4af5cd(0x155)],'username':_0x436072[_0x4af5cd(0x14a)],'telegramId':_0x436072[_0x4af5cd(0x134)],'merchantUrl':_0x436072[_0x4af5cd(0x156)],'gateways':_0x436072[_0x4af5cd(0x154)]?JSON[_0x4af5cd(0x158)](_0x436072[_0x4af5cd(0x154)]):null,'gatewaySettings':_0x436072[_0x4af5cd(0x125)]?JSON['parse'](_0x436072[_0x4af5cd(0x125)]):null,'publicKey':_0x436072[_0x4af5cd(0x14f)],'wallets':{'usdtPolygonWallet':_0x436072['usdtPolygonWallet'],'usdtTrcWallet':_0x436072[_0x4af5cd(0x13d)],'usdtErcWallet':_0x436072[_0x4af5cd(0x14d)],'usdcPolygonWallet':_0x436072[_0x4af5cd(0x120)]},'status':_0x436072[_0x4af5cd(0x124)],'createdAt':_0x436072['createdAt']};}async[a51_0x22e4c8(0x149)](){const _0x177043=a51_0x22e4c8,_0x5e4be0=await database_1[_0x177043(0x12b)][_0x177043(0x127)]['findMany']({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x177043(0x121)}});return _0x5e4be0[_0x177043(0x133)](_0xa18f12=>({'id':_0xa18f12['id'],'fullName':_0xa18f12[_0x177043(0x155)],'username':_0xa18f12[_0x177043(0x14a)],'telegramId':_0xa18f12['telegram'],'merchantUrl':_0xa18f12[_0x177043(0x156)],'gateways':_0xa18f12[_0x177043(0x154)]?JSON['parse'](_0xa18f12[_0x177043(0x154)]):null,'gatewaySettings':_0xa18f12['gatewaySettings']?JSON[_0x177043(0x158)](_0xa18f12['gatewaySettings']):null,'publicKey':_0xa18f12[_0x177043(0x14f)],'wallets':{'usdtPolygonWallet':_0xa18f12['usdtPolygonWallet'],'usdtTrcWallet':_0xa18f12[_0x177043(0x13d)],'usdtErcWallet':_0xa18f12[_0x177043(0x14d)],'usdcPolygonWallet':_0xa18f12[_0x177043(0x120)]},'status':_0xa18f12[_0x177043(0x124)],'createdAt':_0xa18f12[_0x177043(0x137)]}));}async[a51_0x22e4c8(0x13b)](_0x209616){const _0x33f39e=a51_0x22e4c8,_0x3607d2=await database_1['default'][_0x33f39e(0x127)][_0x33f39e(0x151)]({'where':{'id':_0x209616},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x3607d2)return null;return{'id':_0x3607d2['id'],'fullName':_0x3607d2[_0x33f39e(0x155)],'username':_0x3607d2[_0x33f39e(0x14a)],'telegramId':_0x3607d2[_0x33f39e(0x134)],'merchantUrl':_0x3607d2['shopUrl'],'gateways':_0x3607d2[_0x33f39e(0x154)]?JSON[_0x33f39e(0x158)](_0x3607d2[_0x33f39e(0x154)]):null,'gatewaySettings':_0x3607d2['gatewaySettings']?JSON[_0x33f39e(0x158)](_0x3607d2[_0x33f39e(0x125)]):null,'publicKey':_0x3607d2['publicKey'],'wallets':{'usdtPolygonWallet':_0x3607d2[_0x33f39e(0x12a)],'usdtTrcWallet':_0x3607d2['usdtTrcWallet'],'usdtErcWallet':_0x3607d2[_0x33f39e(0x14d)],'usdcPolygonWallet':_0x3607d2[_0x33f39e(0x120)]},'status':_0x3607d2[_0x33f39e(0x124)],'createdAt':_0x3607d2[_0x33f39e(0x137)]};}async[a51_0x22e4c8(0x131)](_0x52b586,_0x54d5c3){const _0x4f0bda=a51_0x22e4c8,_0x5e2f8c={..._0x54d5c3};_0x54d5c3[_0x4f0bda(0x14c)]&&(_0x5e2f8c['password']=await bcryptjs_1[_0x4f0bda(0x12b)][_0x4f0bda(0x132)](_0x54d5c3[_0x4f0bda(0x14c)],0xc));_0x54d5c3[_0x4f0bda(0x13a)]&&(_0x5e2f8c[_0x4f0bda(0x155)]=_0x54d5c3[_0x4f0bda(0x13a)],delete _0x5e2f8c[_0x4f0bda(0x13a)]);_0x54d5c3['telegramId']&&(_0x5e2f8c[_0x4f0bda(0x134)]=_0x54d5c3['telegramId'],delete _0x5e2f8c[_0x4f0bda(0x159)]);_0x54d5c3[_0x4f0bda(0x157)]&&(_0x5e2f8c[_0x4f0bda(0x156)]=_0x54d5c3[_0x4f0bda(0x157)],delete _0x5e2f8c[_0x4f0bda(0x157)]);_0x54d5c3['gateways']&&(_0x5e2f8c[_0x4f0bda(0x154)]=JSON[_0x4f0bda(0x123)](_0x54d5c3[_0x4f0bda(0x129)]),delete _0x5e2f8c[_0x4f0bda(0x129)]);_0x54d5c3['gatewaySettings']&&(_0x5e2f8c[_0x4f0bda(0x125)]=JSON[_0x4f0bda(0x123)](_0x54d5c3['gatewaySettings']),delete _0x5e2f8c[_0x4f0bda(0x125)]);_0x54d5c3[_0x4f0bda(0x13f)]&&(_0x54d5c3[_0x4f0bda(0x13f)][_0x4f0bda(0x12a)]!==undefined&&(_0x5e2f8c[_0x4f0bda(0x12a)]=_0x54d5c3['wallets'][_0x4f0bda(0x12a)]||null),_0x54d5c3[_0x4f0bda(0x13f)][_0x4f0bda(0x13d)]!==undefined&&(_0x5e2f8c[_0x4f0bda(0x13d)]=_0x54d5c3[_0x4f0bda(0x13f)][_0x4f0bda(0x13d)]||null),_0x54d5c3[_0x4f0bda(0x13f)][_0x4f0bda(0x14d)]!==undefined&&(_0x5e2f8c[_0x4f0bda(0x14d)]=_0x54d5c3['wallets'][_0x4f0bda(0x14d)]||null),_0x54d5c3[_0x4f0bda(0x13f)][_0x4f0bda(0x120)]!==undefined&&(_0x5e2f8c[_0x4f0bda(0x120)]=_0x54d5c3['wallets'][_0x4f0bda(0x120)]||null),delete _0x5e2f8c[_0x4f0bda(0x13f)]);const _0x584f09=await database_1[_0x4f0bda(0x12b)]['shop'][_0x4f0bda(0x13c)]({'where':{'id':_0x52b586},'data':_0x5e2f8c,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x584f09['id'],'fullName':_0x584f09[_0x4f0bda(0x155)],'username':_0x584f09[_0x4f0bda(0x14a)],'telegramId':_0x584f09[_0x4f0bda(0x134)],'merchantUrl':_0x584f09[_0x4f0bda(0x156)],'gateways':_0x584f09[_0x4f0bda(0x154)]?JSON[_0x4f0bda(0x158)](_0x584f09['paymentGateways']):null,'gatewaySettings':_0x584f09[_0x4f0bda(0x125)]?JSON[_0x4f0bda(0x158)](_0x584f09[_0x4f0bda(0x125)]):null,'publicKey':_0x584f09['publicKey'],'wallets':{'usdtPolygonWallet':_0x584f09[_0x4f0bda(0x12a)],'usdtTrcWallet':_0x584f09['usdtTrcWallet'],'usdtErcWallet':_0x584f09[_0x4f0bda(0x14d)],'usdcPolygonWallet':_0x584f09['usdcPolygonWallet']},'status':_0x584f09[_0x4f0bda(0x124)],'createdAt':_0x584f09[_0x4f0bda(0x137)]};}async[a51_0x22e4c8(0x12d)](_0xca00f7){const _0x3053e4=a51_0x22e4c8;await database_1[_0x3053e4(0x12b)][_0x3053e4(0x127)]['delete']({'where':{'id':_0xca00f7}});}}exports['UserService']=UserService;