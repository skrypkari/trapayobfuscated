'use strict';const a56_0x1d2060=a56_0x43a7;(function(_0xb05666,_0x45cb82){const _0x5e83cb=a56_0x43a7,_0x24c930=_0xb05666();while(!![]){try{const _0x45828c=-parseInt(_0x5e83cb(0x171))/0x1+-parseInt(_0x5e83cb(0x190))/0x2*(-parseInt(_0x5e83cb(0x185))/0x3)+parseInt(_0x5e83cb(0x174))/0x4+-parseInt(_0x5e83cb(0x191))/0x5*(-parseInt(_0x5e83cb(0x169))/0x6)+parseInt(_0x5e83cb(0x18f))/0x7+parseInt(_0x5e83cb(0x180))/0x8+parseInt(_0x5e83cb(0x165))/0x9*(-parseInt(_0x5e83cb(0x187))/0xa);if(_0x45828c===_0x45cb82)break;else _0x24c930['push'](_0x24c930['shift']());}catch(_0x27e4fa){_0x24c930['push'](_0x24c930['shift']());}}}(a56_0x10e0,0xa27f0));function a56_0x10e0(){const _0x5188e6=['__esModule','gateways','paymentGateways','../config/database','map','shop','__importDefault','status','toString','telegram','Username\x20already\x20exists','4916280MCjCyw','wallets','findUnique','merchantUrl','updateUser','3vivWgA','shopUrl','1071790aePxfk','Telegram\x20username\x20already\x20exists','usdtErcWallet','createdAt','delete','name','hash','usdtTrcWallet','803523ekAmAD','860582FkWozk','667495iXXEFf','getAllUsers','randomBytes','usdcPolygonWallet','gatewaySettings','fullName','UserService','pk_','stringify','getUserById','63delkaz','username','generateApiKeys','default','6bKbdCP','findMany','publicKey','defineProperty','usdtPolygonWallet','hex','password','telegramId','746561iZfWwb','sk_','parse','3477136PAKDrF'];a56_0x10e0=function(){return _0x5188e6;};return a56_0x10e0();}function a56_0x43a7(_0x1c7876,_0x6b74c5){const _0x10e0c6=a56_0x10e0();return a56_0x43a7=function(_0x43a751,_0x516160){_0x43a751=_0x43a751-0x160;let _0x15bb5b=_0x10e0c6[_0x43a751];return _0x15bb5b;},a56_0x43a7(_0x1c7876,_0x6b74c5);}var __importDefault=this&&this[a56_0x1d2060(0x17b)]||function(_0x1bccc3){const _0x1bf182=a56_0x1d2060;return _0x1bccc3&&_0x1bccc3[_0x1bf182(0x175)]?_0x1bccc3:{'default':_0x1bccc3};};Object[a56_0x1d2060(0x16c)](exports,'__esModule',{'value':!![]}),exports[a56_0x1d2060(0x161)]=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),crypto_1=__importDefault(require('crypto')),database_1=__importDefault(require(a56_0x1d2060(0x178)));class UserService{['generateApiKeys'](){const _0x19b1dc=a56_0x1d2060,_0x217576=_0x19b1dc(0x162)+crypto_1[_0x19b1dc(0x168)][_0x19b1dc(0x193)](0x20)[_0x19b1dc(0x17d)](_0x19b1dc(0x16e)),_0x423e6f=_0x19b1dc(0x172)+crypto_1['default'][_0x19b1dc(0x193)](0x20)['toString'](_0x19b1dc(0x16e));return{'publicKey':_0x217576,'secretKey':_0x423e6f};}async['createUser'](_0x1fb7da){const _0xc69057=a56_0x1d2060,{fullName:_0xf5709e,username:_0x8e88c0,password:_0x5d6264,telegramId:_0x2476c4,merchantUrl:_0x1b74bd,gateways:_0xb448e1,gatewaySettings:_0x16bdcd,wallets:_0x26094a}=_0x1fb7da,_0xf0cb36=await database_1[_0xc69057(0x168)][_0xc69057(0x17a)]['findUnique']({'where':{'username':_0x8e88c0}});if(_0xf0cb36)throw new Error(_0xc69057(0x17f));if(_0x2476c4){const _0xcddf00=await database_1[_0xc69057(0x168)]['shop'][_0xc69057(0x182)]({'where':{'telegram':_0x2476c4}});if(_0xcddf00)throw new Error(_0xc69057(0x188));}const _0x45ca36=await bcryptjs_1[_0xc69057(0x168)][_0xc69057(0x18d)](_0x5d6264,0xc),{publicKey:_0x5ed6ce,secretKey:_0x3a3498}=this[_0xc69057(0x167)](),_0x38210d=await database_1[_0xc69057(0x168)]['shop']['create']({'data':{'name':_0xf5709e,'username':_0x8e88c0,'password':_0x45ca36,'telegram':_0x2476c4,'shopUrl':_0x1b74bd,'paymentGateways':_0xb448e1?JSON[_0xc69057(0x163)](_0xb448e1):null,'gatewaySettings':_0x16bdcd?JSON['stringify'](_0x16bdcd):null,'usdtPolygonWallet':_0x26094a?.[_0xc69057(0x16d)]||null,'usdtTrcWallet':_0x26094a?.[_0xc69057(0x18e)]||null,'usdtErcWallet':_0x26094a?.[_0xc69057(0x189)]||null,'usdcPolygonWallet':_0x26094a?.[_0xc69057(0x194)]||null,'publicKey':_0x5ed6ce,'secretKey':_0x3a3498,'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x38210d['id'],'fullName':_0x38210d[_0xc69057(0x18c)],'username':_0x38210d[_0xc69057(0x166)],'telegramId':_0x38210d[_0xc69057(0x17e)],'merchantUrl':_0x38210d['shopUrl'],'gateways':_0x38210d[_0xc69057(0x177)]?JSON[_0xc69057(0x173)](_0x38210d[_0xc69057(0x177)]):null,'gatewaySettings':_0x38210d[_0xc69057(0x195)]?JSON[_0xc69057(0x173)](_0x38210d[_0xc69057(0x195)]):null,'publicKey':_0x38210d[_0xc69057(0x16b)],'wallets':{'usdtPolygonWallet':_0x38210d[_0xc69057(0x16d)],'usdtTrcWallet':_0x38210d[_0xc69057(0x18e)],'usdtErcWallet':_0x38210d[_0xc69057(0x189)],'usdcPolygonWallet':_0x38210d['usdcPolygonWallet']},'status':_0x38210d[_0xc69057(0x17c)],'createdAt':_0x38210d[_0xc69057(0x18a)]};}async[a56_0x1d2060(0x192)](){const _0x18ddba=a56_0x1d2060,_0x307b87=await database_1[_0x18ddba(0x168)]['shop'][_0x18ddba(0x16a)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':'desc'}});return _0x307b87[_0x18ddba(0x179)](_0x507779=>({'id':_0x507779['id'],'fullName':_0x507779[_0x18ddba(0x18c)],'username':_0x507779[_0x18ddba(0x166)],'telegramId':_0x507779[_0x18ddba(0x17e)],'merchantUrl':_0x507779[_0x18ddba(0x186)],'gateways':_0x507779[_0x18ddba(0x177)]?JSON[_0x18ddba(0x173)](_0x507779[_0x18ddba(0x177)]):null,'gatewaySettings':_0x507779[_0x18ddba(0x195)]?JSON['parse'](_0x507779['gatewaySettings']):null,'publicKey':_0x507779[_0x18ddba(0x16b)],'wallets':{'usdtPolygonWallet':_0x507779[_0x18ddba(0x16d)],'usdtTrcWallet':_0x507779['usdtTrcWallet'],'usdtErcWallet':_0x507779['usdtErcWallet'],'usdcPolygonWallet':_0x507779[_0x18ddba(0x194)]},'status':_0x507779[_0x18ddba(0x17c)],'createdAt':_0x507779['createdAt']}));}async[a56_0x1d2060(0x164)](_0x357ba5){const _0x2c25af=a56_0x1d2060,_0x29843f=await database_1[_0x2c25af(0x168)][_0x2c25af(0x17a)][_0x2c25af(0x182)]({'where':{'id':_0x357ba5},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x29843f)return null;return{'id':_0x29843f['id'],'fullName':_0x29843f['name'],'username':_0x29843f[_0x2c25af(0x166)],'telegramId':_0x29843f[_0x2c25af(0x17e)],'merchantUrl':_0x29843f[_0x2c25af(0x186)],'gateways':_0x29843f[_0x2c25af(0x177)]?JSON['parse'](_0x29843f[_0x2c25af(0x177)]):null,'gatewaySettings':_0x29843f[_0x2c25af(0x195)]?JSON[_0x2c25af(0x173)](_0x29843f['gatewaySettings']):null,'publicKey':_0x29843f[_0x2c25af(0x16b)],'wallets':{'usdtPolygonWallet':_0x29843f[_0x2c25af(0x16d)],'usdtTrcWallet':_0x29843f[_0x2c25af(0x18e)],'usdtErcWallet':_0x29843f[_0x2c25af(0x189)],'usdcPolygonWallet':_0x29843f[_0x2c25af(0x194)]},'status':_0x29843f['status'],'createdAt':_0x29843f[_0x2c25af(0x18a)]};}async[a56_0x1d2060(0x184)](_0x4867cf,_0x4eac6d){const _0x492e41=a56_0x1d2060,_0x425c16={..._0x4eac6d};_0x4eac6d['password']&&(_0x425c16[_0x492e41(0x16f)]=await bcryptjs_1[_0x492e41(0x168)]['hash'](_0x4eac6d[_0x492e41(0x16f)],0xc));_0x4eac6d['fullName']&&(_0x425c16[_0x492e41(0x18c)]=_0x4eac6d[_0x492e41(0x160)],delete _0x425c16[_0x492e41(0x160)]);_0x4eac6d[_0x492e41(0x170)]&&(_0x425c16[_0x492e41(0x17e)]=_0x4eac6d[_0x492e41(0x170)],delete _0x425c16[_0x492e41(0x170)]);_0x4eac6d[_0x492e41(0x183)]&&(_0x425c16[_0x492e41(0x186)]=_0x4eac6d[_0x492e41(0x183)],delete _0x425c16[_0x492e41(0x183)]);_0x4eac6d[_0x492e41(0x176)]&&(_0x425c16[_0x492e41(0x177)]=JSON[_0x492e41(0x163)](_0x4eac6d[_0x492e41(0x176)]),delete _0x425c16['gateways']);_0x4eac6d[_0x492e41(0x195)]&&(_0x425c16[_0x492e41(0x195)]=JSON[_0x492e41(0x163)](_0x4eac6d[_0x492e41(0x195)]),delete _0x425c16[_0x492e41(0x195)]);_0x4eac6d[_0x492e41(0x181)]&&(_0x4eac6d[_0x492e41(0x181)][_0x492e41(0x16d)]!==undefined&&(_0x425c16['usdtPolygonWallet']=_0x4eac6d[_0x492e41(0x181)][_0x492e41(0x16d)]||null),_0x4eac6d['wallets'][_0x492e41(0x18e)]!==undefined&&(_0x425c16[_0x492e41(0x18e)]=_0x4eac6d[_0x492e41(0x181)]['usdtTrcWallet']||null),_0x4eac6d[_0x492e41(0x181)][_0x492e41(0x189)]!==undefined&&(_0x425c16[_0x492e41(0x189)]=_0x4eac6d['wallets'][_0x492e41(0x189)]||null),_0x4eac6d[_0x492e41(0x181)][_0x492e41(0x194)]!==undefined&&(_0x425c16[_0x492e41(0x194)]=_0x4eac6d['wallets']['usdcPolygonWallet']||null),delete _0x425c16[_0x492e41(0x181)]);const _0xfeabb3=await database_1['default'][_0x492e41(0x17a)]['update']({'where':{'id':_0x4867cf},'data':_0x425c16,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0xfeabb3['id'],'fullName':_0xfeabb3[_0x492e41(0x18c)],'username':_0xfeabb3['username'],'telegramId':_0xfeabb3['telegram'],'merchantUrl':_0xfeabb3[_0x492e41(0x186)],'gateways':_0xfeabb3[_0x492e41(0x177)]?JSON[_0x492e41(0x173)](_0xfeabb3[_0x492e41(0x177)]):null,'gatewaySettings':_0xfeabb3[_0x492e41(0x195)]?JSON[_0x492e41(0x173)](_0xfeabb3[_0x492e41(0x195)]):null,'publicKey':_0xfeabb3[_0x492e41(0x16b)],'wallets':{'usdtPolygonWallet':_0xfeabb3['usdtPolygonWallet'],'usdtTrcWallet':_0xfeabb3[_0x492e41(0x18e)],'usdtErcWallet':_0xfeabb3[_0x492e41(0x189)],'usdcPolygonWallet':_0xfeabb3[_0x492e41(0x194)]},'status':_0xfeabb3[_0x492e41(0x17c)],'createdAt':_0xfeabb3[_0x492e41(0x18a)]};}async['deleteUser'](_0x1217a3){const _0x337430=a56_0x1d2060;await database_1[_0x337430(0x168)][_0x337430(0x17a)][_0x337430(0x18b)]({'where':{'id':_0x1217a3}});}}exports['UserService']=UserService;