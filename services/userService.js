'use strict';const a76_0x4ee3f6=a76_0x3d1b;function a76_0x1c79(){const _0x2c580c=['name','createdAt','desc','shopUrl','2918480WkYSBB','usdtErcWallet','usdtPolygonWallet','status','30rCFGBL','bcryptjs','paymentGateways','merchantUrl','84BXULmy','sk_','1785437rrBWfG','fullName','__importDefault','pk_','gatewaySettings','__esModule','toString','usdcPolygonWallet','5148608qaRdEA','Username\x20already\x20exists','username','getUserById','UserService','deleteUser','create','7304RoTgKH','ACTIVE','wallets','365561LJZMhz','delete','getAllUsers','9WASZkG','hex','1263726sRTAaN','gateways','shop','generateApiKeys','default','../config/database','8840GuUPMP','telegramId','telegram','hash','usdtTrcWallet','map','createUser','publicKey','password','randomBytes','parse','39842kHtuzO','stringify','update'];a76_0x1c79=function(){return _0x2c580c;};return a76_0x1c79();}(function(_0xcfd0ab,_0x32b854){const _0x1c6829=a76_0x3d1b,_0x389334=_0xcfd0ab();while(!![]){try{const _0x381a45=-parseInt(_0x1c6829(0xbc))/0x1+-parseInt(_0x1c6829(0xb2))/0x2+-parseInt(_0x1c6829(0xd3))/0x3+-parseInt(_0x1c6829(0xcb))/0x4*(parseInt(_0x1c6829(0xb6))/0x5)+-parseInt(_0x1c6829(0xba))/0x6*(-parseInt(_0x1c6829(0xce))/0x7)+-parseInt(_0x1c6829(0xc4))/0x8*(-parseInt(_0x1c6829(0xd1))/0x9)+parseInt(_0x1c6829(0xd9))/0xa*(parseInt(_0x1c6829(0xe4))/0xb);if(_0x381a45===_0x32b854)break;else _0x389334['push'](_0x389334['shift']());}catch(_0x94c3d7){_0x389334['push'](_0x389334['shift']());}}}(a76_0x1c79,0xdba57));function a76_0x3d1b(_0x4560f9,_0x5eb9f0){_0x4560f9=_0x4560f9-0xac;const _0x1c79b8=a76_0x1c79();let _0x3d1bce=_0x1c79b8[_0x4560f9];return _0x3d1bce;}var __importDefault=this&&this[a76_0x4ee3f6(0xbe)]||function(_0x497775){const _0x3864de=a76_0x4ee3f6;return _0x497775&&_0x497775[_0x3864de(0xc1)]?_0x497775:{'default':_0x497775};};Object['defineProperty'](exports,a76_0x4ee3f6(0xc1),{'value':!![]}),exports[a76_0x4ee3f6(0xc8)]=void 0x0;const bcryptjs_1=__importDefault(require(a76_0x4ee3f6(0xb7))),crypto_1=__importDefault(require('crypto')),database_1=__importDefault(require(a76_0x4ee3f6(0xd8)));class UserService{[a76_0x4ee3f6(0xd6)](){const _0x3b9aa4=a76_0x4ee3f6,_0x58f2e9=_0x3b9aa4(0xbf)+crypto_1[_0x3b9aa4(0xd7)][_0x3b9aa4(0xe2)](0x20)[_0x3b9aa4(0xc2)]('hex'),_0x143c59=_0x3b9aa4(0xbb)+crypto_1[_0x3b9aa4(0xd7)][_0x3b9aa4(0xe2)](0x20)[_0x3b9aa4(0xc2)](_0x3b9aa4(0xd2));return{'publicKey':_0x58f2e9,'secretKey':_0x143c59};}async[a76_0x4ee3f6(0xdf)](_0x4b9940){const _0x52195e=a76_0x4ee3f6,{fullName:_0x2ff02c,username:_0x4e480c,password:_0x3826ee,telegramId:_0x3dc96f,merchantUrl:_0x422372,gateways:_0x1c38cc,gatewaySettings:_0x19ba01,wallets:_0x1fff82}=_0x4b9940,_0x40f30a=await database_1['default']['shop']['findUnique']({'where':{'username':_0x4e480c}});if(_0x40f30a)throw new Error(_0x52195e(0xc5));if(_0x3dc96f){const _0x215b6e=await database_1[_0x52195e(0xd7)][_0x52195e(0xd5)]['findUnique']({'where':{'telegram':_0x3dc96f}});if(_0x215b6e)throw new Error('Telegram\x20username\x20already\x20exists');}const _0x130d72=await bcryptjs_1['default'][_0x52195e(0xdc)](_0x3826ee,0xc),{publicKey:_0x393bf2,secretKey:_0x5dba03}=this[_0x52195e(0xd6)](),_0xaa98f2=await database_1[_0x52195e(0xd7)][_0x52195e(0xd5)][_0x52195e(0xca)]({'data':{'name':_0x2ff02c,'username':_0x4e480c,'password':_0x130d72,'telegram':_0x3dc96f,'shopUrl':_0x422372,'paymentGateways':_0x1c38cc?JSON[_0x52195e(0xac)](_0x1c38cc):null,'gatewaySettings':_0x19ba01?JSON[_0x52195e(0xac)](_0x19ba01):null,'usdtPolygonWallet':_0x1fff82?.[_0x52195e(0xb4)]||null,'usdtTrcWallet':_0x1fff82?.[_0x52195e(0xdd)]||null,'usdtErcWallet':_0x1fff82?.[_0x52195e(0xb3)]||null,'usdcPolygonWallet':_0x1fff82?.[_0x52195e(0xc3)]||null,'publicKey':_0x393bf2,'secretKey':_0x5dba03,'status':_0x52195e(0xcc)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0xaa98f2['id'],'fullName':_0xaa98f2[_0x52195e(0xae)],'username':_0xaa98f2[_0x52195e(0xc6)],'telegramId':_0xaa98f2[_0x52195e(0xdb)],'merchantUrl':_0xaa98f2[_0x52195e(0xb1)],'gateways':_0xaa98f2['paymentGateways']?JSON['parse'](_0xaa98f2[_0x52195e(0xb8)]):null,'gatewaySettings':_0xaa98f2[_0x52195e(0xc0)]?JSON[_0x52195e(0xe3)](_0xaa98f2['gatewaySettings']):null,'publicKey':_0xaa98f2[_0x52195e(0xe0)],'wallets':{'usdtPolygonWallet':_0xaa98f2[_0x52195e(0xb4)],'usdtTrcWallet':_0xaa98f2[_0x52195e(0xdd)],'usdtErcWallet':_0xaa98f2[_0x52195e(0xb3)],'usdcPolygonWallet':_0xaa98f2[_0x52195e(0xc3)]},'status':_0xaa98f2[_0x52195e(0xb5)],'createdAt':_0xaa98f2[_0x52195e(0xaf)]};}async[a76_0x4ee3f6(0xd0)](){const _0xe4c9dd=a76_0x4ee3f6,_0xdf006f=await database_1['default'][_0xe4c9dd(0xd5)]['findMany']({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0xe4c9dd(0xb0)}});return _0xdf006f[_0xe4c9dd(0xde)](_0x76a859=>({'id':_0x76a859['id'],'fullName':_0x76a859[_0xe4c9dd(0xae)],'username':_0x76a859[_0xe4c9dd(0xc6)],'telegramId':_0x76a859['telegram'],'merchantUrl':_0x76a859[_0xe4c9dd(0xb1)],'gateways':_0x76a859['paymentGateways']?JSON[_0xe4c9dd(0xe3)](_0x76a859[_0xe4c9dd(0xb8)]):null,'gatewaySettings':_0x76a859['gatewaySettings']?JSON['parse'](_0x76a859[_0xe4c9dd(0xc0)]):null,'publicKey':_0x76a859['publicKey'],'wallets':{'usdtPolygonWallet':_0x76a859[_0xe4c9dd(0xb4)],'usdtTrcWallet':_0x76a859['usdtTrcWallet'],'usdtErcWallet':_0x76a859['usdtErcWallet'],'usdcPolygonWallet':_0x76a859[_0xe4c9dd(0xc3)]},'status':_0x76a859[_0xe4c9dd(0xb5)],'createdAt':_0x76a859[_0xe4c9dd(0xaf)]}));}async[a76_0x4ee3f6(0xc7)](_0x2d33c9){const _0x5aba28=a76_0x4ee3f6,_0x4a8ae1=await database_1[_0x5aba28(0xd7)]['shop']['findUnique']({'where':{'id':_0x2d33c9},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x4a8ae1)return null;return{'id':_0x4a8ae1['id'],'fullName':_0x4a8ae1[_0x5aba28(0xae)],'username':_0x4a8ae1[_0x5aba28(0xc6)],'telegramId':_0x4a8ae1[_0x5aba28(0xdb)],'merchantUrl':_0x4a8ae1[_0x5aba28(0xb1)],'gateways':_0x4a8ae1['paymentGateways']?JSON['parse'](_0x4a8ae1['paymentGateways']):null,'gatewaySettings':_0x4a8ae1[_0x5aba28(0xc0)]?JSON[_0x5aba28(0xe3)](_0x4a8ae1[_0x5aba28(0xc0)]):null,'publicKey':_0x4a8ae1[_0x5aba28(0xe0)],'wallets':{'usdtPolygonWallet':_0x4a8ae1[_0x5aba28(0xb4)],'usdtTrcWallet':_0x4a8ae1[_0x5aba28(0xdd)],'usdtErcWallet':_0x4a8ae1['usdtErcWallet'],'usdcPolygonWallet':_0x4a8ae1[_0x5aba28(0xc3)]},'status':_0x4a8ae1['status'],'createdAt':_0x4a8ae1['createdAt']};}async['updateUser'](_0x3756f6,_0x5a3dba){const _0xe9dd61=a76_0x4ee3f6,_0x1eea32={..._0x5a3dba};_0x5a3dba[_0xe9dd61(0xe1)]&&(_0x1eea32[_0xe9dd61(0xe1)]=await bcryptjs_1[_0xe9dd61(0xd7)][_0xe9dd61(0xdc)](_0x5a3dba['password'],0xc));_0x5a3dba['fullName']&&(_0x1eea32[_0xe9dd61(0xae)]=_0x5a3dba[_0xe9dd61(0xbd)],delete _0x1eea32[_0xe9dd61(0xbd)]);_0x5a3dba[_0xe9dd61(0xda)]&&(_0x1eea32[_0xe9dd61(0xdb)]=_0x5a3dba[_0xe9dd61(0xda)],delete _0x1eea32['telegramId']);_0x5a3dba[_0xe9dd61(0xb9)]&&(_0x1eea32[_0xe9dd61(0xb1)]=_0x5a3dba[_0xe9dd61(0xb9)],delete _0x1eea32[_0xe9dd61(0xb9)]);_0x5a3dba[_0xe9dd61(0xd4)]&&(_0x1eea32[_0xe9dd61(0xb8)]=JSON['stringify'](_0x5a3dba[_0xe9dd61(0xd4)]),delete _0x1eea32[_0xe9dd61(0xd4)]);_0x5a3dba[_0xe9dd61(0xc0)]&&(_0x1eea32[_0xe9dd61(0xc0)]=JSON[_0xe9dd61(0xac)](_0x5a3dba[_0xe9dd61(0xc0)]),delete _0x1eea32[_0xe9dd61(0xc0)]);_0x5a3dba[_0xe9dd61(0xcd)]&&(_0x5a3dba[_0xe9dd61(0xcd)][_0xe9dd61(0xb4)]!==undefined&&(_0x1eea32[_0xe9dd61(0xb4)]=_0x5a3dba[_0xe9dd61(0xcd)]['usdtPolygonWallet']||null),_0x5a3dba[_0xe9dd61(0xcd)][_0xe9dd61(0xdd)]!==undefined&&(_0x1eea32[_0xe9dd61(0xdd)]=_0x5a3dba['wallets']['usdtTrcWallet']||null),_0x5a3dba[_0xe9dd61(0xcd)][_0xe9dd61(0xb3)]!==undefined&&(_0x1eea32[_0xe9dd61(0xb3)]=_0x5a3dba[_0xe9dd61(0xcd)][_0xe9dd61(0xb3)]||null),_0x5a3dba[_0xe9dd61(0xcd)][_0xe9dd61(0xc3)]!==undefined&&(_0x1eea32[_0xe9dd61(0xc3)]=_0x5a3dba[_0xe9dd61(0xcd)][_0xe9dd61(0xc3)]||null),delete _0x1eea32['wallets']);const _0x535d1d=await database_1['default'][_0xe9dd61(0xd5)][_0xe9dd61(0xad)]({'where':{'id':_0x3756f6},'data':_0x1eea32,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x535d1d['id'],'fullName':_0x535d1d[_0xe9dd61(0xae)],'username':_0x535d1d[_0xe9dd61(0xc6)],'telegramId':_0x535d1d[_0xe9dd61(0xdb)],'merchantUrl':_0x535d1d['shopUrl'],'gateways':_0x535d1d[_0xe9dd61(0xb8)]?JSON[_0xe9dd61(0xe3)](_0x535d1d[_0xe9dd61(0xb8)]):null,'gatewaySettings':_0x535d1d[_0xe9dd61(0xc0)]?JSON[_0xe9dd61(0xe3)](_0x535d1d[_0xe9dd61(0xc0)]):null,'publicKey':_0x535d1d[_0xe9dd61(0xe0)],'wallets':{'usdtPolygonWallet':_0x535d1d[_0xe9dd61(0xb4)],'usdtTrcWallet':_0x535d1d[_0xe9dd61(0xdd)],'usdtErcWallet':_0x535d1d[_0xe9dd61(0xb3)],'usdcPolygonWallet':_0x535d1d[_0xe9dd61(0xc3)]},'status':_0x535d1d[_0xe9dd61(0xb5)],'createdAt':_0x535d1d[_0xe9dd61(0xaf)]};}async[a76_0x4ee3f6(0xc9)](_0x5b5fee){const _0x2c0148=a76_0x4ee3f6;await database_1[_0x2c0148(0xd7)][_0x2c0148(0xd5)][_0x2c0148(0xcf)]({'where':{'id':_0x5b5fee}});}}exports[a76_0x4ee3f6(0xc8)]=UserService;