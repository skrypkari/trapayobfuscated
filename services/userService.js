'use strict';const a80_0x630246=a80_0x1739;function a80_0x1557(){const _0x9e779=['5314850wgUjHO','usdtPolygonWallet','parse','70062TYwUFa','password','defineProperty','4070024UvoekJ','8182284qIpgfC','createUser','usdtTrcWallet','default','randomBytes','status','map','12353643DlcipO','publicKey','toString','210Oujgot','gateways','deleteUser','merchantUrl','UserService','hash','generateApiKeys','telegramId','pk_','create','delete','usdcPolygonWallet','wallets','shopUrl','sk_','fullName','getAllUsers','createdAt','update','name','paymentGateways','8WVBbfa','__importDefault','3PpvYEO','shop','15ziMQbh','username','telegram','ACTIVE','desc','usdtErcWallet','1783265GmNBet','findUnique','gatewaySettings','stringify','50SmmpMN','findMany','bcryptjs','getUserById','50654wNSYCL'];a80_0x1557=function(){return _0x9e779;};return a80_0x1557();}(function(_0x1ecb7a,_0x4fc5eb){const _0x372504=a80_0x1739,_0x414890=_0x1ecb7a();while(!![]){try{const _0x10e326=-parseInt(_0x372504(0x128))/0x1*(parseInt(_0x372504(0x136))/0x2)+-parseInt(_0x372504(0x126))/0x3*(parseInt(_0x372504(0x13d))/0x4)+-parseInt(_0x372504(0x137))/0x5+parseInt(_0x372504(0x13a))/0x6*(parseInt(_0x372504(0x148))/0x7)+parseInt(_0x372504(0x124))/0x8*(parseInt(_0x372504(0x145))/0x9)+-parseInt(_0x372504(0x132))/0xa*(-parseInt(_0x372504(0x12e))/0xb)+parseInt(_0x372504(0x13e))/0xc;if(_0x10e326===_0x4fc5eb)break;else _0x414890['push'](_0x414890['shift']());}catch(_0x865cb3){_0x414890['push'](_0x414890['shift']());}}}(a80_0x1557,0xb852c));var __importDefault=this&&this[a80_0x630246(0x125)]||function(_0x19f71a){return _0x19f71a&&_0x19f71a['__esModule']?_0x19f71a:{'default':_0x19f71a};};Object[a80_0x630246(0x13c)](exports,'__esModule',{'value':!![]}),exports[a80_0x630246(0x14c)]=void 0x0;const bcryptjs_1=__importDefault(require(a80_0x630246(0x134))),crypto_1=__importDefault(require('crypto')),database_1=__importDefault(require('../config/database'));class UserService{['generateApiKeys'](){const _0x44e6b2=a80_0x630246,_0x21be07=_0x44e6b2(0x150)+crypto_1['default'][_0x44e6b2(0x142)](0x20)[_0x44e6b2(0x147)]('hex'),_0x513b3d=_0x44e6b2(0x156)+crypto_1[_0x44e6b2(0x141)][_0x44e6b2(0x142)](0x20)['toString']('hex');return{'publicKey':_0x21be07,'secretKey':_0x513b3d};}async[a80_0x630246(0x13f)](_0x18c6eb){const _0x1e9da0=a80_0x630246,{fullName:_0x43b53d,username:_0x15295d,password:_0x38733d,telegramId:_0x14d457,merchantUrl:_0xdb4338,gateways:_0xb67bf4,gatewaySettings:_0x8e64b7,wallets:_0x11a89e}=_0x18c6eb,_0x3dd6bb=await database_1[_0x1e9da0(0x141)][_0x1e9da0(0x127)][_0x1e9da0(0x12f)]({'where':{'username':_0x15295d}});if(_0x3dd6bb)throw new Error('Username\x20already\x20exists');if(_0x14d457){const _0x5531d1=await database_1[_0x1e9da0(0x141)]['shop'][_0x1e9da0(0x12f)]({'where':{'telegram':_0x14d457}});if(_0x5531d1)throw new Error('Telegram\x20username\x20already\x20exists');}const _0x3506b4=await bcryptjs_1[_0x1e9da0(0x141)][_0x1e9da0(0x14d)](_0x38733d,0xc),{publicKey:_0x896d8,secretKey:_0x11cea7}=this[_0x1e9da0(0x14e)](),_0x4536ac=await database_1[_0x1e9da0(0x141)]['shop'][_0x1e9da0(0x151)]({'data':{'name':_0x43b53d,'username':_0x15295d,'password':_0x3506b4,'telegram':_0x14d457,'shopUrl':_0xdb4338,'paymentGateways':_0xb67bf4?JSON[_0x1e9da0(0x131)](_0xb67bf4):null,'gatewaySettings':_0x8e64b7?JSON['stringify'](_0x8e64b7):null,'usdtPolygonWallet':_0x11a89e?.['usdtPolygonWallet']||null,'usdtTrcWallet':_0x11a89e?.[_0x1e9da0(0x140)]||null,'usdtErcWallet':_0x11a89e?.[_0x1e9da0(0x12d)]||null,'usdcPolygonWallet':_0x11a89e?.['usdcPolygonWallet']||null,'publicKey':_0x896d8,'secretKey':_0x11cea7,'status':_0x1e9da0(0x12b)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x4536ac['id'],'fullName':_0x4536ac['name'],'username':_0x4536ac[_0x1e9da0(0x129)],'telegramId':_0x4536ac[_0x1e9da0(0x12a)],'merchantUrl':_0x4536ac[_0x1e9da0(0x155)],'gateways':_0x4536ac['paymentGateways']?JSON[_0x1e9da0(0x139)](_0x4536ac[_0x1e9da0(0x15c)]):null,'gatewaySettings':_0x4536ac[_0x1e9da0(0x130)]?JSON[_0x1e9da0(0x139)](_0x4536ac[_0x1e9da0(0x130)]):null,'publicKey':_0x4536ac[_0x1e9da0(0x146)],'wallets':{'usdtPolygonWallet':_0x4536ac[_0x1e9da0(0x138)],'usdtTrcWallet':_0x4536ac[_0x1e9da0(0x140)],'usdtErcWallet':_0x4536ac[_0x1e9da0(0x12d)],'usdcPolygonWallet':_0x4536ac[_0x1e9da0(0x153)]},'status':_0x4536ac[_0x1e9da0(0x143)],'createdAt':_0x4536ac[_0x1e9da0(0x159)]};}async[a80_0x630246(0x158)](){const _0x243cbe=a80_0x630246,_0x1c277c=await database_1[_0x243cbe(0x141)][_0x243cbe(0x127)][_0x243cbe(0x133)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x243cbe(0x12c)}});return _0x1c277c[_0x243cbe(0x144)](_0xcf2d34=>({'id':_0xcf2d34['id'],'fullName':_0xcf2d34['name'],'username':_0xcf2d34[_0x243cbe(0x129)],'telegramId':_0xcf2d34[_0x243cbe(0x12a)],'merchantUrl':_0xcf2d34[_0x243cbe(0x155)],'gateways':_0xcf2d34[_0x243cbe(0x15c)]?JSON[_0x243cbe(0x139)](_0xcf2d34[_0x243cbe(0x15c)]):null,'gatewaySettings':_0xcf2d34['gatewaySettings']?JSON[_0x243cbe(0x139)](_0xcf2d34[_0x243cbe(0x130)]):null,'publicKey':_0xcf2d34[_0x243cbe(0x146)],'wallets':{'usdtPolygonWallet':_0xcf2d34[_0x243cbe(0x138)],'usdtTrcWallet':_0xcf2d34[_0x243cbe(0x140)],'usdtErcWallet':_0xcf2d34[_0x243cbe(0x12d)],'usdcPolygonWallet':_0xcf2d34['usdcPolygonWallet']},'status':_0xcf2d34[_0x243cbe(0x143)],'createdAt':_0xcf2d34[_0x243cbe(0x159)]}));}async[a80_0x630246(0x135)](_0x28ed4e){const _0x44af75=a80_0x630246,_0x336a85=await database_1[_0x44af75(0x141)][_0x44af75(0x127)]['findUnique']({'where':{'id':_0x28ed4e},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x336a85)return null;return{'id':_0x336a85['id'],'fullName':_0x336a85[_0x44af75(0x15b)],'username':_0x336a85[_0x44af75(0x129)],'telegramId':_0x336a85[_0x44af75(0x12a)],'merchantUrl':_0x336a85[_0x44af75(0x155)],'gateways':_0x336a85[_0x44af75(0x15c)]?JSON['parse'](_0x336a85[_0x44af75(0x15c)]):null,'gatewaySettings':_0x336a85[_0x44af75(0x130)]?JSON[_0x44af75(0x139)](_0x336a85[_0x44af75(0x130)]):null,'publicKey':_0x336a85[_0x44af75(0x146)],'wallets':{'usdtPolygonWallet':_0x336a85[_0x44af75(0x138)],'usdtTrcWallet':_0x336a85[_0x44af75(0x140)],'usdtErcWallet':_0x336a85[_0x44af75(0x12d)],'usdcPolygonWallet':_0x336a85[_0x44af75(0x153)]},'status':_0x336a85[_0x44af75(0x143)],'createdAt':_0x336a85[_0x44af75(0x159)]};}async['updateUser'](_0x3436e8,_0x2e0779){const _0x4b7a00=a80_0x630246,_0x4d2c3c={..._0x2e0779};_0x2e0779[_0x4b7a00(0x13b)]&&(_0x4d2c3c[_0x4b7a00(0x13b)]=await bcryptjs_1[_0x4b7a00(0x141)][_0x4b7a00(0x14d)](_0x2e0779[_0x4b7a00(0x13b)],0xc));_0x2e0779['fullName']&&(_0x4d2c3c[_0x4b7a00(0x15b)]=_0x2e0779[_0x4b7a00(0x157)],delete _0x4d2c3c[_0x4b7a00(0x157)]);_0x2e0779[_0x4b7a00(0x14f)]&&(_0x4d2c3c[_0x4b7a00(0x12a)]=_0x2e0779[_0x4b7a00(0x14f)],delete _0x4d2c3c[_0x4b7a00(0x14f)]);_0x2e0779[_0x4b7a00(0x14b)]&&(_0x4d2c3c['shopUrl']=_0x2e0779[_0x4b7a00(0x14b)],delete _0x4d2c3c[_0x4b7a00(0x14b)]);_0x2e0779[_0x4b7a00(0x149)]&&(_0x4d2c3c[_0x4b7a00(0x15c)]=JSON[_0x4b7a00(0x131)](_0x2e0779[_0x4b7a00(0x149)]),delete _0x4d2c3c[_0x4b7a00(0x149)]);_0x2e0779[_0x4b7a00(0x130)]&&(_0x4d2c3c['gatewaySettings']=JSON[_0x4b7a00(0x131)](_0x2e0779[_0x4b7a00(0x130)]),delete _0x4d2c3c[_0x4b7a00(0x130)]);_0x2e0779['wallets']&&(_0x2e0779[_0x4b7a00(0x154)][_0x4b7a00(0x138)]!==undefined&&(_0x4d2c3c[_0x4b7a00(0x138)]=_0x2e0779[_0x4b7a00(0x154)][_0x4b7a00(0x138)]||null),_0x2e0779['wallets'][_0x4b7a00(0x140)]!==undefined&&(_0x4d2c3c[_0x4b7a00(0x140)]=_0x2e0779[_0x4b7a00(0x154)][_0x4b7a00(0x140)]||null),_0x2e0779[_0x4b7a00(0x154)]['usdtErcWallet']!==undefined&&(_0x4d2c3c[_0x4b7a00(0x12d)]=_0x2e0779['wallets'][_0x4b7a00(0x12d)]||null),_0x2e0779[_0x4b7a00(0x154)][_0x4b7a00(0x153)]!==undefined&&(_0x4d2c3c[_0x4b7a00(0x153)]=_0x2e0779['wallets'][_0x4b7a00(0x153)]||null),delete _0x4d2c3c[_0x4b7a00(0x154)]);const _0x4aef98=await database_1[_0x4b7a00(0x141)][_0x4b7a00(0x127)][_0x4b7a00(0x15a)]({'where':{'id':_0x3436e8},'data':_0x4d2c3c,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x4aef98['id'],'fullName':_0x4aef98[_0x4b7a00(0x15b)],'username':_0x4aef98[_0x4b7a00(0x129)],'telegramId':_0x4aef98['telegram'],'merchantUrl':_0x4aef98['shopUrl'],'gateways':_0x4aef98[_0x4b7a00(0x15c)]?JSON[_0x4b7a00(0x139)](_0x4aef98[_0x4b7a00(0x15c)]):null,'gatewaySettings':_0x4aef98[_0x4b7a00(0x130)]?JSON[_0x4b7a00(0x139)](_0x4aef98[_0x4b7a00(0x130)]):null,'publicKey':_0x4aef98[_0x4b7a00(0x146)],'wallets':{'usdtPolygonWallet':_0x4aef98[_0x4b7a00(0x138)],'usdtTrcWallet':_0x4aef98[_0x4b7a00(0x140)],'usdtErcWallet':_0x4aef98[_0x4b7a00(0x12d)],'usdcPolygonWallet':_0x4aef98[_0x4b7a00(0x153)]},'status':_0x4aef98['status'],'createdAt':_0x4aef98[_0x4b7a00(0x159)]};}async[a80_0x630246(0x14a)](_0x33546b){const _0x3004f8=a80_0x630246;await database_1[_0x3004f8(0x141)][_0x3004f8(0x127)][_0x3004f8(0x152)]({'where':{'id':_0x33546b}});}}function a80_0x1739(_0x2c4bf0,_0x2e67d7){_0x2c4bf0=_0x2c4bf0-0x124;const _0x1557da=a80_0x1557();let _0x17398c=_0x1557da[_0x2c4bf0];return _0x17398c;}exports[a80_0x630246(0x14c)]=UserService;