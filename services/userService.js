'use strict';function a51_0x282a(_0x2800c5,_0x10303c){const _0x271876=a51_0x2718();return a51_0x282a=function(_0x282a36,_0x4f76d3){_0x282a36=_0x282a36-0x1cb;let _0xcb1be3=_0x271876[_0x282a36];return _0xcb1be3;},a51_0x282a(_0x2800c5,_0x10303c);}function a51_0x2718(){const _0x2e7e11=['name','shop','crypto','updateUser','stringify','6203595ffqfkD','shopUrl','bcryptjs','password','generateApiKeys','360BtaAvu','hex','telegramId','36498vkkLMB','merchantUrl','gatewaySettings','getUserById','15VZrprr','createUser','wallets','desc','delete','deleteUser','map','13762810nGvYJt','usdtPolygonWallet','2900808fikncH','create','paymentGateways','fullName','usdcPolygonWallet','__importDefault','telegram','randomBytes','status','publicKey','findUnique','findMany','7766706gIkpip','7LiKQwR','gateways','toString','1QfcFwn','hash','parse','username','usdtTrcWallet','__esModule','256098wafIfG','78508VDxeun','default','Telegram\x20username\x20already\x20exists','usdtErcWallet','../config/database','8tspDcE','createdAt'];a51_0x2718=function(){return _0x2e7e11;};return a51_0x2718();}const a51_0x356cfd=a51_0x282a;(function(_0x2c22f6,_0x5e6e34){const _0x2fc2db=a51_0x282a,_0x1e914d=_0x2c22f6();while(!![]){try{const _0x3c003f=-parseInt(_0x2fc2db(0x1e6))/0x1*(parseInt(_0x2fc2db(0x1ec))/0x2)+-parseInt(_0x2fc2db(0x1cd))/0x3*(parseInt(_0x2fc2db(0x1ed))/0x4)+parseInt(_0x2fc2db(0x1f9))/0x5+parseInt(_0x2fc2db(0x1e2))/0x6*(parseInt(_0x2fc2db(0x1e3))/0x7)+parseInt(_0x2fc2db(0x1f2))/0x8*(-parseInt(_0x2fc2db(0x1d6))/0x9)+-parseInt(_0x2fc2db(0x1d4))/0xa+-parseInt(_0x2fc2db(0x201))/0xb*(-parseInt(_0x2fc2db(0x1fe))/0xc);if(_0x3c003f===_0x5e6e34)break;else _0x1e914d['push'](_0x1e914d['shift']());}catch(_0x5f2239){_0x1e914d['push'](_0x1e914d['shift']());}}}(a51_0x2718,0xad52d));var __importDefault=this&&this[a51_0x356cfd(0x1db)]||function(_0x41a528){return _0x41a528&&_0x41a528['__esModule']?_0x41a528:{'default':_0x41a528};};Object['defineProperty'](exports,a51_0x356cfd(0x1eb),{'value':!![]}),exports['UserService']=void 0x0;const bcryptjs_1=__importDefault(require(a51_0x356cfd(0x1fb))),crypto_1=__importDefault(require(a51_0x356cfd(0x1f6))),database_1=__importDefault(require(a51_0x356cfd(0x1f1)));class UserService{[a51_0x356cfd(0x1fd)](){const _0x2e9bfb=a51_0x356cfd,_0x52770c='pk_'+crypto_1[_0x2e9bfb(0x1ee)][_0x2e9bfb(0x1dd)](0x20)[_0x2e9bfb(0x1e5)](_0x2e9bfb(0x1ff)),_0x5cab9c='sk_'+crypto_1['default'][_0x2e9bfb(0x1dd)](0x20)[_0x2e9bfb(0x1e5)]('hex');return{'publicKey':_0x52770c,'secretKey':_0x5cab9c};}async[a51_0x356cfd(0x1ce)](_0x76d9d2){const _0x4dbad4=a51_0x356cfd,{fullName:_0x935911,username:_0x2c0667,password:_0x4150b9,telegramId:_0x4315b1,merchantUrl:_0x698729,gateways:_0x2335dc,gatewaySettings:_0x387d81,wallets:_0x3faf84}=_0x76d9d2,_0x2b1688=await database_1[_0x4dbad4(0x1ee)]['shop']['findUnique']({'where':{'username':_0x2c0667}});if(_0x2b1688)throw new Error('Username\x20already\x20exists');if(_0x4315b1){const _0x1dd9db=await database_1[_0x4dbad4(0x1ee)][_0x4dbad4(0x1f5)][_0x4dbad4(0x1e0)]({'where':{'telegram':_0x4315b1}});if(_0x1dd9db)throw new Error(_0x4dbad4(0x1ef));}const _0x231b35=await bcryptjs_1['default'][_0x4dbad4(0x1e7)](_0x4150b9,0xc),{publicKey:_0x1e82b9,secretKey:_0x44e02a}=this[_0x4dbad4(0x1fd)](),_0x10f79e=await database_1[_0x4dbad4(0x1ee)][_0x4dbad4(0x1f5)][_0x4dbad4(0x1d7)]({'data':{'name':_0x935911,'username':_0x2c0667,'password':_0x231b35,'telegram':_0x4315b1,'shopUrl':_0x698729,'paymentGateways':_0x2335dc?JSON[_0x4dbad4(0x1f8)](_0x2335dc):null,'gatewaySettings':_0x387d81?JSON[_0x4dbad4(0x1f8)](_0x387d81):null,'usdtPolygonWallet':_0x3faf84?.[_0x4dbad4(0x1d5)]||null,'usdtTrcWallet':_0x3faf84?.['usdtTrcWallet']||null,'usdtErcWallet':_0x3faf84?.[_0x4dbad4(0x1f0)]||null,'usdcPolygonWallet':_0x3faf84?.[_0x4dbad4(0x1da)]||null,'publicKey':_0x1e82b9,'secretKey':_0x44e02a,'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x10f79e['id'],'fullName':_0x10f79e['name'],'username':_0x10f79e[_0x4dbad4(0x1e9)],'telegramId':_0x10f79e[_0x4dbad4(0x1dc)],'merchantUrl':_0x10f79e[_0x4dbad4(0x1fa)],'gateways':_0x10f79e[_0x4dbad4(0x1d8)]?JSON[_0x4dbad4(0x1e8)](_0x10f79e['paymentGateways']):null,'gatewaySettings':_0x10f79e[_0x4dbad4(0x1cb)]?JSON['parse'](_0x10f79e[_0x4dbad4(0x1cb)]):null,'publicKey':_0x10f79e[_0x4dbad4(0x1df)],'wallets':{'usdtPolygonWallet':_0x10f79e[_0x4dbad4(0x1d5)],'usdtTrcWallet':_0x10f79e[_0x4dbad4(0x1ea)],'usdtErcWallet':_0x10f79e[_0x4dbad4(0x1f0)],'usdcPolygonWallet':_0x10f79e[_0x4dbad4(0x1da)]},'status':_0x10f79e[_0x4dbad4(0x1de)],'createdAt':_0x10f79e[_0x4dbad4(0x1f3)]};}async['getAllUsers'](){const _0x4dff89=a51_0x356cfd,_0x507edb=await database_1[_0x4dff89(0x1ee)][_0x4dff89(0x1f5)][_0x4dff89(0x1e1)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x4dff89(0x1d0)}});return _0x507edb[_0x4dff89(0x1d3)](_0xb47faa=>({'id':_0xb47faa['id'],'fullName':_0xb47faa['name'],'username':_0xb47faa[_0x4dff89(0x1e9)],'telegramId':_0xb47faa[_0x4dff89(0x1dc)],'merchantUrl':_0xb47faa['shopUrl'],'gateways':_0xb47faa[_0x4dff89(0x1d8)]?JSON[_0x4dff89(0x1e8)](_0xb47faa[_0x4dff89(0x1d8)]):null,'gatewaySettings':_0xb47faa[_0x4dff89(0x1cb)]?JSON[_0x4dff89(0x1e8)](_0xb47faa[_0x4dff89(0x1cb)]):null,'publicKey':_0xb47faa[_0x4dff89(0x1df)],'wallets':{'usdtPolygonWallet':_0xb47faa['usdtPolygonWallet'],'usdtTrcWallet':_0xb47faa[_0x4dff89(0x1ea)],'usdtErcWallet':_0xb47faa['usdtErcWallet'],'usdcPolygonWallet':_0xb47faa[_0x4dff89(0x1da)]},'status':_0xb47faa[_0x4dff89(0x1de)],'createdAt':_0xb47faa[_0x4dff89(0x1f3)]}));}async[a51_0x356cfd(0x1cc)](_0x8b04e0){const _0xf8ab11=a51_0x356cfd,_0x263c11=await database_1[_0xf8ab11(0x1ee)][_0xf8ab11(0x1f5)][_0xf8ab11(0x1e0)]({'where':{'id':_0x8b04e0},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x263c11)return null;return{'id':_0x263c11['id'],'fullName':_0x263c11[_0xf8ab11(0x1f4)],'username':_0x263c11[_0xf8ab11(0x1e9)],'telegramId':_0x263c11[_0xf8ab11(0x1dc)],'merchantUrl':_0x263c11[_0xf8ab11(0x1fa)],'gateways':_0x263c11[_0xf8ab11(0x1d8)]?JSON[_0xf8ab11(0x1e8)](_0x263c11[_0xf8ab11(0x1d8)]):null,'gatewaySettings':_0x263c11[_0xf8ab11(0x1cb)]?JSON[_0xf8ab11(0x1e8)](_0x263c11[_0xf8ab11(0x1cb)]):null,'publicKey':_0x263c11[_0xf8ab11(0x1df)],'wallets':{'usdtPolygonWallet':_0x263c11[_0xf8ab11(0x1d5)],'usdtTrcWallet':_0x263c11[_0xf8ab11(0x1ea)],'usdtErcWallet':_0x263c11['usdtErcWallet'],'usdcPolygonWallet':_0x263c11[_0xf8ab11(0x1da)]},'status':_0x263c11[_0xf8ab11(0x1de)],'createdAt':_0x263c11[_0xf8ab11(0x1f3)]};}async[a51_0x356cfd(0x1f7)](_0x3c986f,_0x5e82cb){const _0x4bc4ea=a51_0x356cfd,_0x33894b={..._0x5e82cb};_0x5e82cb[_0x4bc4ea(0x1fc)]&&(_0x33894b['password']=await bcryptjs_1[_0x4bc4ea(0x1ee)][_0x4bc4ea(0x1e7)](_0x5e82cb[_0x4bc4ea(0x1fc)],0xc));_0x5e82cb[_0x4bc4ea(0x1d9)]&&(_0x33894b['name']=_0x5e82cb[_0x4bc4ea(0x1d9)],delete _0x33894b['fullName']);_0x5e82cb[_0x4bc4ea(0x200)]&&(_0x33894b[_0x4bc4ea(0x1dc)]=_0x5e82cb[_0x4bc4ea(0x200)],delete _0x33894b[_0x4bc4ea(0x200)]);_0x5e82cb['merchantUrl']&&(_0x33894b[_0x4bc4ea(0x1fa)]=_0x5e82cb[_0x4bc4ea(0x202)],delete _0x33894b[_0x4bc4ea(0x202)]);_0x5e82cb['gateways']&&(_0x33894b[_0x4bc4ea(0x1d8)]=JSON[_0x4bc4ea(0x1f8)](_0x5e82cb[_0x4bc4ea(0x1e4)]),delete _0x33894b[_0x4bc4ea(0x1e4)]);_0x5e82cb['gatewaySettings']&&(_0x33894b[_0x4bc4ea(0x1cb)]=JSON[_0x4bc4ea(0x1f8)](_0x5e82cb['gatewaySettings']),delete _0x33894b[_0x4bc4ea(0x1cb)]);_0x5e82cb[_0x4bc4ea(0x1cf)]&&(_0x5e82cb[_0x4bc4ea(0x1cf)]['usdtPolygonWallet']!==undefined&&(_0x33894b[_0x4bc4ea(0x1d5)]=_0x5e82cb['wallets'][_0x4bc4ea(0x1d5)]||null),_0x5e82cb[_0x4bc4ea(0x1cf)][_0x4bc4ea(0x1ea)]!==undefined&&(_0x33894b[_0x4bc4ea(0x1ea)]=_0x5e82cb[_0x4bc4ea(0x1cf)][_0x4bc4ea(0x1ea)]||null),_0x5e82cb[_0x4bc4ea(0x1cf)][_0x4bc4ea(0x1f0)]!==undefined&&(_0x33894b['usdtErcWallet']=_0x5e82cb[_0x4bc4ea(0x1cf)][_0x4bc4ea(0x1f0)]||null),_0x5e82cb[_0x4bc4ea(0x1cf)][_0x4bc4ea(0x1da)]!==undefined&&(_0x33894b[_0x4bc4ea(0x1da)]=_0x5e82cb[_0x4bc4ea(0x1cf)][_0x4bc4ea(0x1da)]||null),delete _0x33894b['wallets']);const _0x49290d=await database_1[_0x4bc4ea(0x1ee)][_0x4bc4ea(0x1f5)]['update']({'where':{'id':_0x3c986f},'data':_0x33894b,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x49290d['id'],'fullName':_0x49290d['name'],'username':_0x49290d[_0x4bc4ea(0x1e9)],'telegramId':_0x49290d[_0x4bc4ea(0x1dc)],'merchantUrl':_0x49290d[_0x4bc4ea(0x1fa)],'gateways':_0x49290d[_0x4bc4ea(0x1d8)]?JSON[_0x4bc4ea(0x1e8)](_0x49290d['paymentGateways']):null,'gatewaySettings':_0x49290d[_0x4bc4ea(0x1cb)]?JSON[_0x4bc4ea(0x1e8)](_0x49290d[_0x4bc4ea(0x1cb)]):null,'publicKey':_0x49290d[_0x4bc4ea(0x1df)],'wallets':{'usdtPolygonWallet':_0x49290d[_0x4bc4ea(0x1d5)],'usdtTrcWallet':_0x49290d['usdtTrcWallet'],'usdtErcWallet':_0x49290d[_0x4bc4ea(0x1f0)],'usdcPolygonWallet':_0x49290d[_0x4bc4ea(0x1da)]},'status':_0x49290d[_0x4bc4ea(0x1de)],'createdAt':_0x49290d[_0x4bc4ea(0x1f3)]};}async[a51_0x356cfd(0x1d2)](_0x14c168){const _0x156d69=a51_0x356cfd;await database_1[_0x156d69(0x1ee)]['shop'][_0x156d69(0x1d1)]({'where':{'id':_0x14c168}});}}exports['UserService']=UserService;