'use strict';const a59_0xce1cdb=a59_0x747d;(function(_0x1367d3,_0x12709c){const _0x371d6f=a59_0x747d,_0x52275e=_0x1367d3();while(!![]){try{const _0x6c1250=parseInt(_0x371d6f(0x1e0))/0x1*(parseInt(_0x371d6f(0x1f2))/0x2)+-parseInt(_0x371d6f(0x205))/0x3*(-parseInt(_0x371d6f(0x1ee))/0x4)+parseInt(_0x371d6f(0x203))/0x5+-parseInt(_0x371d6f(0x20d))/0x6*(parseInt(_0x371d6f(0x202))/0x7)+parseInt(_0x371d6f(0x1eb))/0x8+-parseInt(_0x371d6f(0x1df))/0x9+-parseInt(_0x371d6f(0x1fe))/0xa*(parseInt(_0x371d6f(0x20a))/0xb);if(_0x6c1250===_0x12709c)break;else _0x52275e['push'](_0x52275e['shift']());}catch(_0x1c2822){_0x52275e['push'](_0x52275e['shift']());}}}(a59_0x186e,0xe2f94));var __importDefault=this&&this[a59_0xce1cdb(0x207)]||function(_0x26cacf){return _0x26cacf&&_0x26cacf['__esModule']?_0x26cacf:{'default':_0x26cacf};};Object['defineProperty'](exports,a59_0xce1cdb(0x1de),{'value':!![]}),exports['UserService']=void 0x0;function a59_0x747d(_0x23dd41,_0x40f5b5){const _0x186ec0=a59_0x186e();return a59_0x747d=function(_0x747def,_0x1f9b8d){_0x747def=_0x747def-0x1d9;let _0x5080d6=_0x186ec0[_0x747def];return _0x5080d6;},a59_0x747d(_0x23dd41,_0x40f5b5);}const bcryptjs_1=__importDefault(require(a59_0xce1cdb(0x208))),crypto_1=__importDefault(require(a59_0xce1cdb(0x209))),database_1=__importDefault(require(a59_0xce1cdb(0x1e8)));class UserService{[a59_0xce1cdb(0x1f9)](){const _0x2b5ada=a59_0xce1cdb,_0x102494=_0x2b5ada(0x1f4)+crypto_1['default']['randomBytes'](0x20)['toString'](_0x2b5ada(0x1dc)),_0x395f6c=_0x2b5ada(0x210)+crypto_1['default'][_0x2b5ada(0x1ec)](0x20)[_0x2b5ada(0x206)](_0x2b5ada(0x1dc));return{'publicKey':_0x102494,'secretKey':_0x395f6c};}async[a59_0xce1cdb(0x20c)](_0x597881){const _0x2faf98=a59_0xce1cdb,{fullName:_0x3381bd,username:_0x167e50,password:_0xa5a0b3,telegramId:_0x2048dc,merchantUrl:_0x229ad5,gateways:_0x6225f9,gatewaySettings:_0x3a224a,wallets:_0x61723a}=_0x597881,_0x24c092=await database_1[_0x2faf98(0x1e1)][_0x2faf98(0x204)]['findUnique']({'where':{'username':_0x167e50}});if(_0x24c092)throw new Error('Username\x20already\x20exists');if(_0x2048dc){const _0x53d505=await database_1[_0x2faf98(0x1e1)][_0x2faf98(0x204)]['findUnique']({'where':{'telegram':_0x2048dc}});if(_0x53d505)throw new Error('Telegram\x20username\x20already\x20exists');}const _0x44c07f=await bcryptjs_1['default'][_0x2faf98(0x1f1)](_0xa5a0b3,0xc),{publicKey:_0x44e4ff,secretKey:_0xac8b4f}=this['generateApiKeys'](),_0x387e68=await database_1[_0x2faf98(0x1e1)][_0x2faf98(0x204)][_0x2faf98(0x1e5)]({'data':{'name':_0x3381bd,'username':_0x167e50,'password':_0x44c07f,'telegram':_0x2048dc,'shopUrl':_0x229ad5,'paymentGateways':_0x6225f9?JSON['stringify'](_0x6225f9):null,'gatewaySettings':_0x3a224a?JSON['stringify'](_0x3a224a):null,'usdtPolygonWallet':_0x61723a?.[_0x2faf98(0x1ea)]||null,'usdtTrcWallet':_0x61723a?.[_0x2faf98(0x1dd)]||null,'usdtErcWallet':_0x61723a?.[_0x2faf98(0x1ff)]||null,'usdcPolygonWallet':_0x61723a?.[_0x2faf98(0x1fd)]||null,'publicKey':_0x44e4ff,'secretKey':_0xac8b4f,'status':_0x2faf98(0x1f8)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x387e68['id'],'fullName':_0x387e68[_0x2faf98(0x201)],'username':_0x387e68[_0x2faf98(0x1f7)],'telegramId':_0x387e68[_0x2faf98(0x1f3)],'merchantUrl':_0x387e68['shopUrl'],'gateways':_0x387e68[_0x2faf98(0x1d9)]?JSON[_0x2faf98(0x1ef)](_0x387e68[_0x2faf98(0x1d9)]):null,'gatewaySettings':_0x387e68['gatewaySettings']?JSON[_0x2faf98(0x1ef)](_0x387e68[_0x2faf98(0x20f)]):null,'publicKey':_0x387e68[_0x2faf98(0x1fa)],'wallets':{'usdtPolygonWallet':_0x387e68['usdtPolygonWallet'],'usdtTrcWallet':_0x387e68[_0x2faf98(0x1dd)],'usdtErcWallet':_0x387e68[_0x2faf98(0x1ff)],'usdcPolygonWallet':_0x387e68['usdcPolygonWallet']},'status':_0x387e68[_0x2faf98(0x1e6)],'createdAt':_0x387e68['createdAt']};}async['getAllUsers'](){const _0x36e4d1=a59_0xce1cdb,_0x4318e5=await database_1[_0x36e4d1(0x1e1)][_0x36e4d1(0x204)][_0x36e4d1(0x1e4)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x36e4d1(0x1e7)}});return _0x4318e5[_0x36e4d1(0x1da)](_0x4d8d0f=>({'id':_0x4d8d0f['id'],'fullName':_0x4d8d0f[_0x36e4d1(0x201)],'username':_0x4d8d0f[_0x36e4d1(0x1f7)],'telegramId':_0x4d8d0f['telegram'],'merchantUrl':_0x4d8d0f[_0x36e4d1(0x1fc)],'gateways':_0x4d8d0f[_0x36e4d1(0x1d9)]?JSON['parse'](_0x4d8d0f[_0x36e4d1(0x1d9)]):null,'gatewaySettings':_0x4d8d0f['gatewaySettings']?JSON[_0x36e4d1(0x1ef)](_0x4d8d0f[_0x36e4d1(0x20f)]):null,'publicKey':_0x4d8d0f[_0x36e4d1(0x1fa)],'wallets':{'usdtPolygonWallet':_0x4d8d0f['usdtPolygonWallet'],'usdtTrcWallet':_0x4d8d0f[_0x36e4d1(0x1dd)],'usdtErcWallet':_0x4d8d0f[_0x36e4d1(0x1ff)],'usdcPolygonWallet':_0x4d8d0f['usdcPolygonWallet']},'status':_0x4d8d0f[_0x36e4d1(0x1e6)],'createdAt':_0x4d8d0f[_0x36e4d1(0x1f5)]}));}async[a59_0xce1cdb(0x20b)](_0x5c6df7){const _0x12e78a=a59_0xce1cdb,_0x3cbe59=await database_1['default']['shop'][_0x12e78a(0x1db)]({'where':{'id':_0x5c6df7},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x3cbe59)return null;return{'id':_0x3cbe59['id'],'fullName':_0x3cbe59['name'],'username':_0x3cbe59['username'],'telegramId':_0x3cbe59[_0x12e78a(0x1f3)],'merchantUrl':_0x3cbe59['shopUrl'],'gateways':_0x3cbe59[_0x12e78a(0x1d9)]?JSON['parse'](_0x3cbe59[_0x12e78a(0x1d9)]):null,'gatewaySettings':_0x3cbe59[_0x12e78a(0x20f)]?JSON[_0x12e78a(0x1ef)](_0x3cbe59[_0x12e78a(0x20f)]):null,'publicKey':_0x3cbe59[_0x12e78a(0x1fa)],'wallets':{'usdtPolygonWallet':_0x3cbe59[_0x12e78a(0x1ea)],'usdtTrcWallet':_0x3cbe59['usdtTrcWallet'],'usdtErcWallet':_0x3cbe59[_0x12e78a(0x1ff)],'usdcPolygonWallet':_0x3cbe59['usdcPolygonWallet']},'status':_0x3cbe59[_0x12e78a(0x1e6)],'createdAt':_0x3cbe59[_0x12e78a(0x1f5)]};}async[a59_0xce1cdb(0x1ed)](_0x146167,_0x52b38e){const _0x108c37=a59_0xce1cdb,_0x49c68d={..._0x52b38e};_0x52b38e[_0x108c37(0x200)]&&(_0x49c68d[_0x108c37(0x200)]=await bcryptjs_1[_0x108c37(0x1e1)][_0x108c37(0x1f1)](_0x52b38e['password'],0xc));_0x52b38e[_0x108c37(0x1e9)]&&(_0x49c68d['name']=_0x52b38e[_0x108c37(0x1e9)],delete _0x49c68d['fullName']);_0x52b38e['telegramId']&&(_0x49c68d[_0x108c37(0x1f3)]=_0x52b38e[_0x108c37(0x1f6)],delete _0x49c68d[_0x108c37(0x1f6)]);_0x52b38e[_0x108c37(0x1e3)]&&(_0x49c68d[_0x108c37(0x1fc)]=_0x52b38e['merchantUrl'],delete _0x49c68d[_0x108c37(0x1e3)]);_0x52b38e[_0x108c37(0x1e2)]&&(_0x49c68d[_0x108c37(0x1d9)]=JSON['stringify'](_0x52b38e[_0x108c37(0x1e2)]),delete _0x49c68d['gateways']);_0x52b38e[_0x108c37(0x20f)]&&(_0x49c68d[_0x108c37(0x20f)]=JSON[_0x108c37(0x20e)](_0x52b38e[_0x108c37(0x20f)]),delete _0x49c68d['gatewaySettings']);_0x52b38e['wallets']&&(_0x52b38e[_0x108c37(0x1f0)][_0x108c37(0x1ea)]!==undefined&&(_0x49c68d[_0x108c37(0x1ea)]=_0x52b38e[_0x108c37(0x1f0)][_0x108c37(0x1ea)]||null),_0x52b38e[_0x108c37(0x1f0)][_0x108c37(0x1dd)]!==undefined&&(_0x49c68d[_0x108c37(0x1dd)]=_0x52b38e['wallets'][_0x108c37(0x1dd)]||null),_0x52b38e[_0x108c37(0x1f0)][_0x108c37(0x1ff)]!==undefined&&(_0x49c68d[_0x108c37(0x1ff)]=_0x52b38e[_0x108c37(0x1f0)][_0x108c37(0x1ff)]||null),_0x52b38e['wallets'][_0x108c37(0x1fd)]!==undefined&&(_0x49c68d[_0x108c37(0x1fd)]=_0x52b38e['wallets'][_0x108c37(0x1fd)]||null),delete _0x49c68d[_0x108c37(0x1f0)]);const _0x3ad18e=await database_1[_0x108c37(0x1e1)]['shop']['update']({'where':{'id':_0x146167},'data':_0x49c68d,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x3ad18e['id'],'fullName':_0x3ad18e[_0x108c37(0x201)],'username':_0x3ad18e[_0x108c37(0x1f7)],'telegramId':_0x3ad18e['telegram'],'merchantUrl':_0x3ad18e['shopUrl'],'gateways':_0x3ad18e['paymentGateways']?JSON[_0x108c37(0x1ef)](_0x3ad18e[_0x108c37(0x1d9)]):null,'gatewaySettings':_0x3ad18e['gatewaySettings']?JSON[_0x108c37(0x1ef)](_0x3ad18e[_0x108c37(0x20f)]):null,'publicKey':_0x3ad18e['publicKey'],'wallets':{'usdtPolygonWallet':_0x3ad18e[_0x108c37(0x1ea)],'usdtTrcWallet':_0x3ad18e[_0x108c37(0x1dd)],'usdtErcWallet':_0x3ad18e[_0x108c37(0x1ff)],'usdcPolygonWallet':_0x3ad18e[_0x108c37(0x1fd)]},'status':_0x3ad18e[_0x108c37(0x1e6)],'createdAt':_0x3ad18e['createdAt']};}async['deleteUser'](_0x1d754b){const _0x28c0ba=a59_0xce1cdb;await database_1['default'][_0x28c0ba(0x204)][_0x28c0ba(0x1fb)]({'where':{'id':_0x1d754b}});}}function a59_0x186e(){const _0x13af2f=['4240827JRRiHS','1FOooHG','default','gateways','merchantUrl','findMany','create','status','desc','../config/database','fullName','usdtPolygonWallet','14839952gGbvWO','randomBytes','updateUser','4mTyCQV','parse','wallets','hash','432918NEhOBx','telegram','pk_','createdAt','telegramId','username','ACTIVE','generateApiKeys','publicKey','delete','shopUrl','usdcPolygonWallet','445630HFhvNd','usdtErcWallet','password','name','755552XjXVPt','7720015MFJnMl','shop','2871699uQAYFb','toString','__importDefault','bcryptjs','crypto','330LTqKHn','getUserById','createUser','102DbFUJP','stringify','gatewaySettings','sk_','paymentGateways','map','findUnique','hex','usdtTrcWallet','__esModule'];a59_0x186e=function(){return _0x13af2f;};return a59_0x186e();}exports['UserService']=UserService;