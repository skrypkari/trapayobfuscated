'use strict';function a61_0x2838(_0x2e43bc,_0x24c204){const _0x52fc21=a61_0x52fc();return a61_0x2838=function(_0x283802,_0x2b7500){_0x283802=_0x283802-0x1ad;let _0x5ab29f=_0x52fc21[_0x283802];return _0x5ab29f;},a61_0x2838(_0x2e43bc,_0x24c204);}function a61_0x52fc(){const _0x1a9813=['fullName','delete','usdtErcWallet','shopUrl','1408460mAsVmr','getAllUsers','generateApiKeys','defineProperty','9lJLqFN','2411270wEzXrv','ACTIVE','hex','merchantUrl','stringify','UserService','wallets','8674776sFgssL','update','createUser','telegramId','findUnique','password','72BekDrz','map','hash','103874rwzGan','username','usdtTrcWallet','default','status','publicKey','1229664PNcVts','usdtPolygonWallet','parse','desc','88541hNMPfs','bcryptjs','getUserById','Telegram\x20username\x20already\x20exists','shop','6SqJEXr','telegram','createdAt','__esModule','paymentGateways','findMany','updateUser','1349761nHYWxA','pk_','randomBytes','sk_','gateways','name','gatewaySettings','toString','deleteUser','crypto','usdcPolygonWallet','create'];a61_0x52fc=function(){return _0x1a9813;};return a61_0x52fc();}const a61_0x2f3b26=a61_0x2838;(function(_0x23c10e,_0x4a9b89){const _0x22af23=a61_0x2838,_0x62bcfe=_0x23c10e();while(!![]){try{const _0x211d72=parseInt(_0x22af23(0x1e1))/0x1+-parseInt(_0x22af23(0x1d7))/0x2*(-parseInt(_0x22af23(0x1c6))/0x3)+-parseInt(_0x22af23(0x1dd))/0x4+parseInt(_0x22af23(0x1c7))/0x5*(parseInt(_0x22af23(0x1e6))/0x6)+parseInt(_0x22af23(0x1b2))/0x7+parseInt(_0x22af23(0x1ce))/0x8+parseInt(_0x22af23(0x1d4))/0x9*(-parseInt(_0x22af23(0x1c2))/0xa);if(_0x211d72===_0x4a9b89)break;else _0x62bcfe['push'](_0x62bcfe['shift']());}catch(_0x2dd1e5){_0x62bcfe['push'](_0x62bcfe['shift']());}}}(a61_0x52fc,0x8b0f8));var __importDefault=this&&this['__importDefault']||function(_0x8d7b0b){return _0x8d7b0b&&_0x8d7b0b['__esModule']?_0x8d7b0b:{'default':_0x8d7b0b};};Object[a61_0x2f3b26(0x1c5)](exports,a61_0x2f3b26(0x1ae),{'value':!![]}),exports[a61_0x2f3b26(0x1cc)]=void 0x0;const bcryptjs_1=__importDefault(require(a61_0x2f3b26(0x1e2))),crypto_1=__importDefault(require(a61_0x2f3b26(0x1bb))),database_1=__importDefault(require('../config/database'));class UserService{['generateApiKeys'](){const _0x386e54=a61_0x2f3b26,_0xb3ef43=_0x386e54(0x1b3)+crypto_1[_0x386e54(0x1da)][_0x386e54(0x1b4)](0x20)[_0x386e54(0x1b9)](_0x386e54(0x1c9)),_0x46cc2b=_0x386e54(0x1b5)+crypto_1['default'][_0x386e54(0x1b4)](0x20)[_0x386e54(0x1b9)](_0x386e54(0x1c9));return{'publicKey':_0xb3ef43,'secretKey':_0x46cc2b};}async[a61_0x2f3b26(0x1d0)](_0x6ae715){const _0x49960a=a61_0x2f3b26,{fullName:_0x399293,username:_0x153754,password:_0x35e165,telegramId:_0x3de374,merchantUrl:_0xe8d1ba,gateways:_0xaa1a4,gatewaySettings:_0x4644fc,wallets:_0x5e7757}=_0x6ae715,_0xf8417=await database_1[_0x49960a(0x1da)]['shop']['findUnique']({'where':{'username':_0x153754}});if(_0xf8417)throw new Error('Username\x20already\x20exists');if(_0x3de374){const _0x10f7a6=await database_1[_0x49960a(0x1da)][_0x49960a(0x1e5)][_0x49960a(0x1d2)]({'where':{'telegram':_0x3de374}});if(_0x10f7a6)throw new Error(_0x49960a(0x1e4));}const _0x2f65e3=await bcryptjs_1[_0x49960a(0x1da)][_0x49960a(0x1d6)](_0x35e165,0xc),{publicKey:_0x153806,secretKey:_0x3dc672}=this[_0x49960a(0x1c4)](),_0x9ba0f4=await database_1[_0x49960a(0x1da)][_0x49960a(0x1e5)][_0x49960a(0x1bd)]({'data':{'name':_0x399293,'username':_0x153754,'password':_0x2f65e3,'telegram':_0x3de374,'shopUrl':_0xe8d1ba,'paymentGateways':_0xaa1a4?JSON[_0x49960a(0x1cb)](_0xaa1a4):null,'gatewaySettings':_0x4644fc?JSON[_0x49960a(0x1cb)](_0x4644fc):null,'usdtPolygonWallet':_0x5e7757?.['usdtPolygonWallet']||null,'usdtTrcWallet':_0x5e7757?.[_0x49960a(0x1d9)]||null,'usdtErcWallet':_0x5e7757?.[_0x49960a(0x1c0)]||null,'usdcPolygonWallet':_0x5e7757?.[_0x49960a(0x1bc)]||null,'publicKey':_0x153806,'secretKey':_0x3dc672,'status':_0x49960a(0x1c8)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x9ba0f4['id'],'fullName':_0x9ba0f4[_0x49960a(0x1b7)],'username':_0x9ba0f4[_0x49960a(0x1d8)],'telegramId':_0x9ba0f4[_0x49960a(0x1e7)],'merchantUrl':_0x9ba0f4['shopUrl'],'gateways':_0x9ba0f4[_0x49960a(0x1af)]?JSON[_0x49960a(0x1df)](_0x9ba0f4[_0x49960a(0x1af)]):null,'gatewaySettings':_0x9ba0f4['gatewaySettings']?JSON[_0x49960a(0x1df)](_0x9ba0f4[_0x49960a(0x1b8)]):null,'publicKey':_0x9ba0f4['publicKey'],'wallets':{'usdtPolygonWallet':_0x9ba0f4['usdtPolygonWallet'],'usdtTrcWallet':_0x9ba0f4[_0x49960a(0x1d9)],'usdtErcWallet':_0x9ba0f4[_0x49960a(0x1c0)],'usdcPolygonWallet':_0x9ba0f4['usdcPolygonWallet']},'status':_0x9ba0f4[_0x49960a(0x1db)],'createdAt':_0x9ba0f4[_0x49960a(0x1ad)]};}async[a61_0x2f3b26(0x1c3)](){const _0x4bcc15=a61_0x2f3b26,_0x2a9f42=await database_1[_0x4bcc15(0x1da)][_0x4bcc15(0x1e5)][_0x4bcc15(0x1b0)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x4bcc15(0x1e0)}});return _0x2a9f42[_0x4bcc15(0x1d5)](_0x647211=>({'id':_0x647211['id'],'fullName':_0x647211['name'],'username':_0x647211['username'],'telegramId':_0x647211[_0x4bcc15(0x1e7)],'merchantUrl':_0x647211[_0x4bcc15(0x1c1)],'gateways':_0x647211['paymentGateways']?JSON['parse'](_0x647211[_0x4bcc15(0x1af)]):null,'gatewaySettings':_0x647211[_0x4bcc15(0x1b8)]?JSON['parse'](_0x647211[_0x4bcc15(0x1b8)]):null,'publicKey':_0x647211['publicKey'],'wallets':{'usdtPolygonWallet':_0x647211[_0x4bcc15(0x1de)],'usdtTrcWallet':_0x647211[_0x4bcc15(0x1d9)],'usdtErcWallet':_0x647211[_0x4bcc15(0x1c0)],'usdcPolygonWallet':_0x647211[_0x4bcc15(0x1bc)]},'status':_0x647211[_0x4bcc15(0x1db)],'createdAt':_0x647211[_0x4bcc15(0x1ad)]}));}async[a61_0x2f3b26(0x1e3)](_0x552738){const _0xffc730=a61_0x2f3b26,_0x28160b=await database_1[_0xffc730(0x1da)]['shop']['findUnique']({'where':{'id':_0x552738},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x28160b)return null;return{'id':_0x28160b['id'],'fullName':_0x28160b[_0xffc730(0x1b7)],'username':_0x28160b['username'],'telegramId':_0x28160b[_0xffc730(0x1e7)],'merchantUrl':_0x28160b[_0xffc730(0x1c1)],'gateways':_0x28160b[_0xffc730(0x1af)]?JSON['parse'](_0x28160b[_0xffc730(0x1af)]):null,'gatewaySettings':_0x28160b[_0xffc730(0x1b8)]?JSON[_0xffc730(0x1df)](_0x28160b[_0xffc730(0x1b8)]):null,'publicKey':_0x28160b[_0xffc730(0x1dc)],'wallets':{'usdtPolygonWallet':_0x28160b[_0xffc730(0x1de)],'usdtTrcWallet':_0x28160b['usdtTrcWallet'],'usdtErcWallet':_0x28160b[_0xffc730(0x1c0)],'usdcPolygonWallet':_0x28160b[_0xffc730(0x1bc)]},'status':_0x28160b['status'],'createdAt':_0x28160b['createdAt']};}async[a61_0x2f3b26(0x1b1)](_0x5a3df6,_0x4bafd5){const _0x51a1b3=a61_0x2f3b26,_0x52c0a8={..._0x4bafd5};_0x4bafd5['password']&&(_0x52c0a8['password']=await bcryptjs_1[_0x51a1b3(0x1da)][_0x51a1b3(0x1d6)](_0x4bafd5[_0x51a1b3(0x1d3)],0xc));_0x4bafd5[_0x51a1b3(0x1be)]&&(_0x52c0a8[_0x51a1b3(0x1b7)]=_0x4bafd5['fullName'],delete _0x52c0a8[_0x51a1b3(0x1be)]);_0x4bafd5[_0x51a1b3(0x1d1)]&&(_0x52c0a8['telegram']=_0x4bafd5[_0x51a1b3(0x1d1)],delete _0x52c0a8[_0x51a1b3(0x1d1)]);_0x4bafd5[_0x51a1b3(0x1ca)]&&(_0x52c0a8[_0x51a1b3(0x1c1)]=_0x4bafd5['merchantUrl'],delete _0x52c0a8[_0x51a1b3(0x1ca)]);_0x4bafd5[_0x51a1b3(0x1b6)]&&(_0x52c0a8[_0x51a1b3(0x1af)]=JSON[_0x51a1b3(0x1cb)](_0x4bafd5[_0x51a1b3(0x1b6)]),delete _0x52c0a8['gateways']);_0x4bafd5[_0x51a1b3(0x1b8)]&&(_0x52c0a8[_0x51a1b3(0x1b8)]=JSON[_0x51a1b3(0x1cb)](_0x4bafd5[_0x51a1b3(0x1b8)]),delete _0x52c0a8[_0x51a1b3(0x1b8)]);_0x4bafd5[_0x51a1b3(0x1cd)]&&(_0x4bafd5[_0x51a1b3(0x1cd)][_0x51a1b3(0x1de)]!==undefined&&(_0x52c0a8[_0x51a1b3(0x1de)]=_0x4bafd5['wallets'][_0x51a1b3(0x1de)]||null),_0x4bafd5['wallets'][_0x51a1b3(0x1d9)]!==undefined&&(_0x52c0a8[_0x51a1b3(0x1d9)]=_0x4bafd5[_0x51a1b3(0x1cd)][_0x51a1b3(0x1d9)]||null),_0x4bafd5[_0x51a1b3(0x1cd)][_0x51a1b3(0x1c0)]!==undefined&&(_0x52c0a8[_0x51a1b3(0x1c0)]=_0x4bafd5['wallets'][_0x51a1b3(0x1c0)]||null),_0x4bafd5[_0x51a1b3(0x1cd)][_0x51a1b3(0x1bc)]!==undefined&&(_0x52c0a8[_0x51a1b3(0x1bc)]=_0x4bafd5[_0x51a1b3(0x1cd)][_0x51a1b3(0x1bc)]||null),delete _0x52c0a8['wallets']);const _0x264de3=await database_1[_0x51a1b3(0x1da)][_0x51a1b3(0x1e5)][_0x51a1b3(0x1cf)]({'where':{'id':_0x5a3df6},'data':_0x52c0a8,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x264de3['id'],'fullName':_0x264de3[_0x51a1b3(0x1b7)],'username':_0x264de3[_0x51a1b3(0x1d8)],'telegramId':_0x264de3['telegram'],'merchantUrl':_0x264de3['shopUrl'],'gateways':_0x264de3[_0x51a1b3(0x1af)]?JSON['parse'](_0x264de3['paymentGateways']):null,'gatewaySettings':_0x264de3[_0x51a1b3(0x1b8)]?JSON['parse'](_0x264de3[_0x51a1b3(0x1b8)]):null,'publicKey':_0x264de3['publicKey'],'wallets':{'usdtPolygonWallet':_0x264de3[_0x51a1b3(0x1de)],'usdtTrcWallet':_0x264de3[_0x51a1b3(0x1d9)],'usdtErcWallet':_0x264de3['usdtErcWallet'],'usdcPolygonWallet':_0x264de3[_0x51a1b3(0x1bc)]},'status':_0x264de3['status'],'createdAt':_0x264de3['createdAt']};}async[a61_0x2f3b26(0x1ba)](_0x3bce25){const _0x237abf=a61_0x2f3b26;await database_1['default'][_0x237abf(0x1e5)][_0x237abf(0x1bf)]({'where':{'id':_0x3bce25}});}}exports['UserService']=UserService;