'use strict';function a57_0x3273(_0x58adb5,_0x260b6e){const _0x30f3c4=a57_0x30f3();return a57_0x3273=function(_0x327363,_0x2cbd36){_0x327363=_0x327363-0x14c;let _0x22c873=_0x30f3c4[_0x327363];return _0x22c873;},a57_0x3273(_0x58adb5,_0x260b6e);}const a57_0x3d97b5=a57_0x3273;(function(_0x4abd44,_0x5e2323){const _0x3021ba=a57_0x3273,_0xf21936=_0x4abd44();while(!![]){try{const _0x42e9f3=parseInt(_0x3021ba(0x180))/0x1*(-parseInt(_0x3021ba(0x167))/0x2)+-parseInt(_0x3021ba(0x16e))/0x3*(-parseInt(_0x3021ba(0x15b))/0x4)+-parseInt(_0x3021ba(0x168))/0x5*(parseInt(_0x3021ba(0x171))/0x6)+parseInt(_0x3021ba(0x162))/0x7*(parseInt(_0x3021ba(0x16f))/0x8)+parseInt(_0x3021ba(0x157))/0x9*(parseInt(_0x3021ba(0x184))/0xa)+-parseInt(_0x3021ba(0x169))/0xb+parseInt(_0x3021ba(0x182))/0xc*(parseInt(_0x3021ba(0x15f))/0xd);if(_0x42e9f3===_0x5e2323)break;else _0xf21936['push'](_0xf21936['shift']());}catch(_0x22b444){_0xf21936['push'](_0xf21936['shift']());}}}(a57_0x30f3,0x7990e));var __importDefault=this&&this[a57_0x3d97b5(0x156)]||function(_0x1f087c){const _0x166b17=a57_0x3d97b5;return _0x1f087c&&_0x1f087c[_0x166b17(0x159)]?_0x1f087c:{'default':_0x1f087c};};Object['defineProperty'](exports,a57_0x3d97b5(0x159),{'value':!![]}),exports[a57_0x3d97b5(0x15d)]=void 0x0;function a57_0x30f3(){const _0x14e582=['generateApiKeys','__esModule','ACTIVE','120veluwQ','findMany','UserService','paymentGateways','18343bdmBky','crypto','create','29645LENniq','telegramId','gateways','stringify','password','177766rMhpUs','295wOYidF','7421887hvvLpI','delete','Username\x20already\x20exists','shopUrl','usdcPolygonWallet','45753YcLIDE','1528CadxRy','map','28506slFWfr','updateUser','hash','shop','deleteUser','default','randomBytes','gatewaySettings','telegram','findUnique','createdAt','status','merchantUrl','usdtPolygonWallet','wallets','1gIKswx','publicKey','1320RKwrMI','fullName','171740GxJHwh','usdtErcWallet','toString','name','hex','usdtTrcWallet','bcryptjs','desc','sk_','username','../config/database','parse','__importDefault','63QSVDUR'];a57_0x30f3=function(){return _0x14e582;};return a57_0x30f3();}const bcryptjs_1=__importDefault(require(a57_0x3d97b5(0x150))),crypto_1=__importDefault(require(a57_0x3d97b5(0x160))),database_1=__importDefault(require(a57_0x3d97b5(0x154)));class UserService{[a57_0x3d97b5(0x158)](){const _0x3e6a1c=a57_0x3d97b5,_0x2099b3='pk_'+crypto_1[_0x3e6a1c(0x176)]['randomBytes'](0x20)[_0x3e6a1c(0x14c)](_0x3e6a1c(0x14e)),_0x4d1d29=_0x3e6a1c(0x152)+crypto_1[_0x3e6a1c(0x176)][_0x3e6a1c(0x177)](0x20)[_0x3e6a1c(0x14c)](_0x3e6a1c(0x14e));return{'publicKey':_0x2099b3,'secretKey':_0x4d1d29};}async['createUser'](_0x59177f){const _0x328b55=a57_0x3d97b5,{fullName:_0x444fa7,username:_0x4163bd,password:_0x3d16c4,telegramId:_0x392a36,merchantUrl:_0x4c136a,gateways:_0x21967e,gatewaySettings:_0x5281dc,wallets:_0x324bad}=_0x59177f,_0x3ea1ff=await database_1[_0x328b55(0x176)][_0x328b55(0x174)][_0x328b55(0x17a)]({'where':{'username':_0x4163bd}});if(_0x3ea1ff)throw new Error(_0x328b55(0x16b));if(_0x392a36){const _0x5fa741=await database_1[_0x328b55(0x176)]['shop']['findUnique']({'where':{'telegram':_0x392a36}});if(_0x5fa741)throw new Error('Telegram\x20username\x20already\x20exists');}const _0x313b6a=await bcryptjs_1[_0x328b55(0x176)][_0x328b55(0x173)](_0x3d16c4,0xc),{publicKey:_0x56b72a,secretKey:_0x5de919}=this['generateApiKeys'](),_0x1aa841=await database_1[_0x328b55(0x176)]['shop'][_0x328b55(0x161)]({'data':{'name':_0x444fa7,'username':_0x4163bd,'password':_0x313b6a,'telegram':_0x392a36,'shopUrl':_0x4c136a,'paymentGateways':_0x21967e?JSON[_0x328b55(0x165)](_0x21967e):null,'gatewaySettings':_0x5281dc?JSON[_0x328b55(0x165)](_0x5281dc):null,'usdtPolygonWallet':_0x324bad?.['usdtPolygonWallet']||null,'usdtTrcWallet':_0x324bad?.[_0x328b55(0x14f)]||null,'usdtErcWallet':_0x324bad?.[_0x328b55(0x185)]||null,'usdcPolygonWallet':_0x324bad?.[_0x328b55(0x16d)]||null,'publicKey':_0x56b72a,'secretKey':_0x5de919,'status':_0x328b55(0x15a)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x1aa841['id'],'fullName':_0x1aa841[_0x328b55(0x14d)],'username':_0x1aa841[_0x328b55(0x153)],'telegramId':_0x1aa841[_0x328b55(0x179)],'merchantUrl':_0x1aa841[_0x328b55(0x16c)],'gateways':_0x1aa841['paymentGateways']?JSON[_0x328b55(0x155)](_0x1aa841[_0x328b55(0x15e)]):null,'gatewaySettings':_0x1aa841[_0x328b55(0x178)]?JSON[_0x328b55(0x155)](_0x1aa841[_0x328b55(0x178)]):null,'publicKey':_0x1aa841[_0x328b55(0x181)],'wallets':{'usdtPolygonWallet':_0x1aa841[_0x328b55(0x17e)],'usdtTrcWallet':_0x1aa841[_0x328b55(0x14f)],'usdtErcWallet':_0x1aa841['usdtErcWallet'],'usdcPolygonWallet':_0x1aa841['usdcPolygonWallet']},'status':_0x1aa841[_0x328b55(0x17c)],'createdAt':_0x1aa841[_0x328b55(0x17b)]};}async['getAllUsers'](){const _0x4e06d9=a57_0x3d97b5,_0x1cfe35=await database_1[_0x4e06d9(0x176)]['shop'][_0x4e06d9(0x15c)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x4e06d9(0x151)}});return _0x1cfe35[_0x4e06d9(0x170)](_0x191771=>({'id':_0x191771['id'],'fullName':_0x191771[_0x4e06d9(0x14d)],'username':_0x191771['username'],'telegramId':_0x191771[_0x4e06d9(0x179)],'merchantUrl':_0x191771[_0x4e06d9(0x16c)],'gateways':_0x191771[_0x4e06d9(0x15e)]?JSON[_0x4e06d9(0x155)](_0x191771[_0x4e06d9(0x15e)]):null,'gatewaySettings':_0x191771[_0x4e06d9(0x178)]?JSON[_0x4e06d9(0x155)](_0x191771[_0x4e06d9(0x178)]):null,'publicKey':_0x191771['publicKey'],'wallets':{'usdtPolygonWallet':_0x191771[_0x4e06d9(0x17e)],'usdtTrcWallet':_0x191771['usdtTrcWallet'],'usdtErcWallet':_0x191771['usdtErcWallet'],'usdcPolygonWallet':_0x191771[_0x4e06d9(0x16d)]},'status':_0x191771[_0x4e06d9(0x17c)],'createdAt':_0x191771[_0x4e06d9(0x17b)]}));}async['getUserById'](_0x88b7b0){const _0x2896bc=a57_0x3d97b5,_0x2fa4f6=await database_1[_0x2896bc(0x176)]['shop'][_0x2896bc(0x17a)]({'where':{'id':_0x88b7b0},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x2fa4f6)return null;return{'id':_0x2fa4f6['id'],'fullName':_0x2fa4f6[_0x2896bc(0x14d)],'username':_0x2fa4f6[_0x2896bc(0x153)],'telegramId':_0x2fa4f6[_0x2896bc(0x179)],'merchantUrl':_0x2fa4f6[_0x2896bc(0x16c)],'gateways':_0x2fa4f6[_0x2896bc(0x15e)]?JSON[_0x2896bc(0x155)](_0x2fa4f6[_0x2896bc(0x15e)]):null,'gatewaySettings':_0x2fa4f6[_0x2896bc(0x178)]?JSON[_0x2896bc(0x155)](_0x2fa4f6[_0x2896bc(0x178)]):null,'publicKey':_0x2fa4f6[_0x2896bc(0x181)],'wallets':{'usdtPolygonWallet':_0x2fa4f6[_0x2896bc(0x17e)],'usdtTrcWallet':_0x2fa4f6['usdtTrcWallet'],'usdtErcWallet':_0x2fa4f6['usdtErcWallet'],'usdcPolygonWallet':_0x2fa4f6[_0x2896bc(0x16d)]},'status':_0x2fa4f6[_0x2896bc(0x17c)],'createdAt':_0x2fa4f6[_0x2896bc(0x17b)]};}async[a57_0x3d97b5(0x172)](_0x2d24e1,_0x48b334){const _0x3b1703=a57_0x3d97b5,_0x21decf={..._0x48b334};_0x48b334['password']&&(_0x21decf[_0x3b1703(0x166)]=await bcryptjs_1[_0x3b1703(0x176)]['hash'](_0x48b334[_0x3b1703(0x166)],0xc));_0x48b334[_0x3b1703(0x183)]&&(_0x21decf[_0x3b1703(0x14d)]=_0x48b334[_0x3b1703(0x183)],delete _0x21decf[_0x3b1703(0x183)]);_0x48b334[_0x3b1703(0x163)]&&(_0x21decf[_0x3b1703(0x179)]=_0x48b334['telegramId'],delete _0x21decf[_0x3b1703(0x163)]);_0x48b334['merchantUrl']&&(_0x21decf['shopUrl']=_0x48b334[_0x3b1703(0x17d)],delete _0x21decf[_0x3b1703(0x17d)]);_0x48b334[_0x3b1703(0x164)]&&(_0x21decf[_0x3b1703(0x15e)]=JSON['stringify'](_0x48b334[_0x3b1703(0x164)]),delete _0x21decf[_0x3b1703(0x164)]);_0x48b334[_0x3b1703(0x178)]&&(_0x21decf['gatewaySettings']=JSON[_0x3b1703(0x165)](_0x48b334['gatewaySettings']),delete _0x21decf[_0x3b1703(0x178)]);_0x48b334[_0x3b1703(0x17f)]&&(_0x48b334['wallets'][_0x3b1703(0x17e)]!==undefined&&(_0x21decf['usdtPolygonWallet']=_0x48b334['wallets'][_0x3b1703(0x17e)]||null),_0x48b334[_0x3b1703(0x17f)][_0x3b1703(0x14f)]!==undefined&&(_0x21decf[_0x3b1703(0x14f)]=_0x48b334[_0x3b1703(0x17f)][_0x3b1703(0x14f)]||null),_0x48b334[_0x3b1703(0x17f)][_0x3b1703(0x185)]!==undefined&&(_0x21decf[_0x3b1703(0x185)]=_0x48b334['wallets'][_0x3b1703(0x185)]||null),_0x48b334['wallets'][_0x3b1703(0x16d)]!==undefined&&(_0x21decf[_0x3b1703(0x16d)]=_0x48b334[_0x3b1703(0x17f)][_0x3b1703(0x16d)]||null),delete _0x21decf[_0x3b1703(0x17f)]);const _0x4d3a69=await database_1[_0x3b1703(0x176)][_0x3b1703(0x174)]['update']({'where':{'id':_0x2d24e1},'data':_0x21decf,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x4d3a69['id'],'fullName':_0x4d3a69['name'],'username':_0x4d3a69[_0x3b1703(0x153)],'telegramId':_0x4d3a69['telegram'],'merchantUrl':_0x4d3a69[_0x3b1703(0x16c)],'gateways':_0x4d3a69[_0x3b1703(0x15e)]?JSON[_0x3b1703(0x155)](_0x4d3a69[_0x3b1703(0x15e)]):null,'gatewaySettings':_0x4d3a69[_0x3b1703(0x178)]?JSON[_0x3b1703(0x155)](_0x4d3a69[_0x3b1703(0x178)]):null,'publicKey':_0x4d3a69['publicKey'],'wallets':{'usdtPolygonWallet':_0x4d3a69[_0x3b1703(0x17e)],'usdtTrcWallet':_0x4d3a69[_0x3b1703(0x14f)],'usdtErcWallet':_0x4d3a69[_0x3b1703(0x185)],'usdcPolygonWallet':_0x4d3a69['usdcPolygonWallet']},'status':_0x4d3a69[_0x3b1703(0x17c)],'createdAt':_0x4d3a69[_0x3b1703(0x17b)]};}async[a57_0x3d97b5(0x175)](_0x14eeaa){const _0x7e0c07=a57_0x3d97b5;await database_1[_0x7e0c07(0x176)][_0x7e0c07(0x174)][_0x7e0c07(0x16a)]({'where':{'id':_0x14eeaa}});}}exports[a57_0x3d97b5(0x15d)]=UserService;