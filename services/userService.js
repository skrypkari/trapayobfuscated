'use strict';const a56_0x389023=a56_0xcf2d;(function(_0x5c6926,_0x25ab4b){const _0x1ebeb2=a56_0xcf2d,_0x58e972=_0x5c6926();while(!![]){try{const _0x5dd6c8=parseInt(_0x1ebeb2(0x21f))/0x1*(-parseInt(_0x1ebeb2(0x205))/0x2)+-parseInt(_0x1ebeb2(0x203))/0x3+parseInt(_0x1ebeb2(0x210))/0x4*(-parseInt(_0x1ebeb2(0x219))/0x5)+-parseInt(_0x1ebeb2(0x1ed))/0x6*(parseInt(_0x1ebeb2(0x1eb))/0x7)+parseInt(_0x1ebeb2(0x1ec))/0x8+parseInt(_0x1ebeb2(0x223))/0x9+parseInt(_0x1ebeb2(0x21a))/0xa;if(_0x5dd6c8===_0x25ab4b)break;else _0x58e972['push'](_0x58e972['shift']());}catch(_0x31919a){_0x58e972['push'](_0x58e972['shift']());}}}(a56_0x26cf,0x5422e));function a56_0xcf2d(_0x403650,_0x39125d){const _0x26cfd8=a56_0x26cf();return a56_0xcf2d=function(_0xcf2d68,_0x527ee4){_0xcf2d68=_0xcf2d68-0x1ea;let _0x44f191=_0x26cfd8[_0xcf2d68];return _0x44f191;},a56_0xcf2d(_0x403650,_0x39125d);}var __importDefault=this&&this[a56_0x389023(0x20b)]||function(_0x4cf308){const _0x2b312d=a56_0x389023;return _0x4cf308&&_0x4cf308[_0x2b312d(0x202)]?_0x4cf308:{'default':_0x4cf308};};Object[a56_0x389023(0x214)](exports,a56_0x389023(0x202),{'value':!![]}),exports[a56_0x389023(0x20d)]=void 0x0;const bcryptjs_1=__importDefault(require(a56_0x389023(0x20f))),crypto_1=__importDefault(require(a56_0x389023(0x204))),database_1=__importDefault(require(a56_0x389023(0x20e)));function a56_0x26cf(){const _0x14eaf6=['getAllUsers','paymentGateways','__esModule','151881UpzOyn','crypto','615332dgpzeO','updateUser','deleteUser','wallets','telegram','status','__importDefault','create','UserService','../config/database','bcryptjs','4RdaAjL','default','generateApiKeys','usdtErcWallet','defineProperty','usdtTrcWallet','fullName','gatewaySettings','createdAt','2869395bILwVO','9349840nNVsmX','hash','username','desc','map','1qoxGdM','randomBytes','stringify','name','5065263rZMtEE','getUserById','shop','1231874QujukP','2455592ACnKIh','18SKwJBM','findUnique','createUser','ACTIVE','publicKey','update','Username\x20already\x20exists','gateways','pk_','password','parse','sk_','telegramId','merchantUrl','usdcPolygonWallet','shopUrl','findMany','usdtPolygonWallet','toString'];a56_0x26cf=function(){return _0x14eaf6;};return a56_0x26cf();}class UserService{[a56_0x389023(0x212)](){const _0xc1d011=a56_0x389023,_0x1eb242=_0xc1d011(0x1f5)+crypto_1['default']['randomBytes'](0x20)[_0xc1d011(0x1ff)]('hex'),_0x1ccee9=_0xc1d011(0x1f8)+crypto_1[_0xc1d011(0x211)][_0xc1d011(0x220)](0x20)['toString']('hex');return{'publicKey':_0x1eb242,'secretKey':_0x1ccee9};}async[a56_0x389023(0x1ef)](_0x3505c5){const _0xca1d28=a56_0x389023,{fullName:_0x16c2b6,username:_0xaf1c7a,password:_0xc59556,telegramId:_0x1026cd,merchantUrl:_0x147bd1,gateways:_0x4e9614,gatewaySettings:_0x25b896,wallets:_0x3bd643}=_0x3505c5,_0x27d1f9=await database_1[_0xca1d28(0x211)][_0xca1d28(0x1ea)][_0xca1d28(0x1ee)]({'where':{'username':_0xaf1c7a}});if(_0x27d1f9)throw new Error(_0xca1d28(0x1f3));if(_0x1026cd){const _0x2d73db=await database_1[_0xca1d28(0x211)][_0xca1d28(0x1ea)][_0xca1d28(0x1ee)]({'where':{'telegram':_0x1026cd}});if(_0x2d73db)throw new Error('Telegram\x20username\x20already\x20exists');}const _0x23eced=await bcryptjs_1[_0xca1d28(0x211)][_0xca1d28(0x21b)](_0xc59556,0xc),{publicKey:_0x2ac3c4,secretKey:_0x295312}=this['generateApiKeys'](),_0x585b59=await database_1[_0xca1d28(0x211)][_0xca1d28(0x1ea)][_0xca1d28(0x20c)]({'data':{'name':_0x16c2b6,'username':_0xaf1c7a,'password':_0x23eced,'telegram':_0x1026cd,'shopUrl':_0x147bd1,'paymentGateways':_0x4e9614?JSON[_0xca1d28(0x221)](_0x4e9614):null,'gatewaySettings':_0x25b896?JSON[_0xca1d28(0x221)](_0x25b896):null,'usdtPolygonWallet':_0x3bd643?.[_0xca1d28(0x1fe)]||null,'usdtTrcWallet':_0x3bd643?.['usdtTrcWallet']||null,'usdtErcWallet':_0x3bd643?.['usdtErcWallet']||null,'usdcPolygonWallet':_0x3bd643?.['usdcPolygonWallet']||null,'publicKey':_0x2ac3c4,'secretKey':_0x295312,'status':_0xca1d28(0x1f0)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x585b59['id'],'fullName':_0x585b59[_0xca1d28(0x222)],'username':_0x585b59[_0xca1d28(0x21c)],'telegramId':_0x585b59[_0xca1d28(0x209)],'merchantUrl':_0x585b59[_0xca1d28(0x1fc)],'gateways':_0x585b59[_0xca1d28(0x201)]?JSON[_0xca1d28(0x1f7)](_0x585b59[_0xca1d28(0x201)]):null,'gatewaySettings':_0x585b59['gatewaySettings']?JSON[_0xca1d28(0x1f7)](_0x585b59['gatewaySettings']):null,'publicKey':_0x585b59['publicKey'],'wallets':{'usdtPolygonWallet':_0x585b59[_0xca1d28(0x1fe)],'usdtTrcWallet':_0x585b59[_0xca1d28(0x215)],'usdtErcWallet':_0x585b59[_0xca1d28(0x213)],'usdcPolygonWallet':_0x585b59[_0xca1d28(0x1fb)]},'status':_0x585b59[_0xca1d28(0x20a)],'createdAt':_0x585b59[_0xca1d28(0x218)]};}async[a56_0x389023(0x200)](){const _0x4d780c=a56_0x389023,_0x10380f=await database_1['default'][_0x4d780c(0x1ea)][_0x4d780c(0x1fd)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x4d780c(0x21d)}});return _0x10380f[_0x4d780c(0x21e)](_0x285a04=>({'id':_0x285a04['id'],'fullName':_0x285a04[_0x4d780c(0x222)],'username':_0x285a04[_0x4d780c(0x21c)],'telegramId':_0x285a04[_0x4d780c(0x209)],'merchantUrl':_0x285a04['shopUrl'],'gateways':_0x285a04[_0x4d780c(0x201)]?JSON[_0x4d780c(0x1f7)](_0x285a04[_0x4d780c(0x201)]):null,'gatewaySettings':_0x285a04[_0x4d780c(0x217)]?JSON[_0x4d780c(0x1f7)](_0x285a04[_0x4d780c(0x217)]):null,'publicKey':_0x285a04['publicKey'],'wallets':{'usdtPolygonWallet':_0x285a04[_0x4d780c(0x1fe)],'usdtTrcWallet':_0x285a04[_0x4d780c(0x215)],'usdtErcWallet':_0x285a04[_0x4d780c(0x213)],'usdcPolygonWallet':_0x285a04['usdcPolygonWallet']},'status':_0x285a04['status'],'createdAt':_0x285a04[_0x4d780c(0x218)]}));}async[a56_0x389023(0x224)](_0x33183e){const _0x5394c0=a56_0x389023,_0x4a53c0=await database_1[_0x5394c0(0x211)]['shop'][_0x5394c0(0x1ee)]({'where':{'id':_0x33183e},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x4a53c0)return null;return{'id':_0x4a53c0['id'],'fullName':_0x4a53c0['name'],'username':_0x4a53c0[_0x5394c0(0x21c)],'telegramId':_0x4a53c0[_0x5394c0(0x209)],'merchantUrl':_0x4a53c0[_0x5394c0(0x1fc)],'gateways':_0x4a53c0['paymentGateways']?JSON[_0x5394c0(0x1f7)](_0x4a53c0['paymentGateways']):null,'gatewaySettings':_0x4a53c0[_0x5394c0(0x217)]?JSON['parse'](_0x4a53c0[_0x5394c0(0x217)]):null,'publicKey':_0x4a53c0[_0x5394c0(0x1f1)],'wallets':{'usdtPolygonWallet':_0x4a53c0['usdtPolygonWallet'],'usdtTrcWallet':_0x4a53c0[_0x5394c0(0x215)],'usdtErcWallet':_0x4a53c0['usdtErcWallet'],'usdcPolygonWallet':_0x4a53c0[_0x5394c0(0x1fb)]},'status':_0x4a53c0[_0x5394c0(0x20a)],'createdAt':_0x4a53c0['createdAt']};}async[a56_0x389023(0x206)](_0x438b93,_0x4f019c){const _0x4ad008=a56_0x389023,_0x12e247={..._0x4f019c};_0x4f019c[_0x4ad008(0x1f6)]&&(_0x12e247['password']=await bcryptjs_1['default'][_0x4ad008(0x21b)](_0x4f019c[_0x4ad008(0x1f6)],0xc));_0x4f019c[_0x4ad008(0x216)]&&(_0x12e247['name']=_0x4f019c[_0x4ad008(0x216)],delete _0x12e247[_0x4ad008(0x216)]);_0x4f019c['telegramId']&&(_0x12e247['telegram']=_0x4f019c[_0x4ad008(0x1f9)],delete _0x12e247[_0x4ad008(0x1f9)]);_0x4f019c[_0x4ad008(0x1fa)]&&(_0x12e247[_0x4ad008(0x1fc)]=_0x4f019c[_0x4ad008(0x1fa)],delete _0x12e247[_0x4ad008(0x1fa)]);_0x4f019c[_0x4ad008(0x1f4)]&&(_0x12e247[_0x4ad008(0x201)]=JSON[_0x4ad008(0x221)](_0x4f019c[_0x4ad008(0x1f4)]),delete _0x12e247[_0x4ad008(0x1f4)]);_0x4f019c[_0x4ad008(0x217)]&&(_0x12e247[_0x4ad008(0x217)]=JSON['stringify'](_0x4f019c['gatewaySettings']),delete _0x12e247[_0x4ad008(0x217)]);_0x4f019c[_0x4ad008(0x208)]&&(_0x4f019c[_0x4ad008(0x208)][_0x4ad008(0x1fe)]!==undefined&&(_0x12e247[_0x4ad008(0x1fe)]=_0x4f019c['wallets'][_0x4ad008(0x1fe)]||null),_0x4f019c[_0x4ad008(0x208)]['usdtTrcWallet']!==undefined&&(_0x12e247['usdtTrcWallet']=_0x4f019c[_0x4ad008(0x208)][_0x4ad008(0x215)]||null),_0x4f019c[_0x4ad008(0x208)][_0x4ad008(0x213)]!==undefined&&(_0x12e247[_0x4ad008(0x213)]=_0x4f019c[_0x4ad008(0x208)]['usdtErcWallet']||null),_0x4f019c[_0x4ad008(0x208)][_0x4ad008(0x1fb)]!==undefined&&(_0x12e247[_0x4ad008(0x1fb)]=_0x4f019c['wallets'][_0x4ad008(0x1fb)]||null),delete _0x12e247[_0x4ad008(0x208)]);const _0x4855c3=await database_1[_0x4ad008(0x211)][_0x4ad008(0x1ea)][_0x4ad008(0x1f2)]({'where':{'id':_0x438b93},'data':_0x12e247,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x4855c3['id'],'fullName':_0x4855c3[_0x4ad008(0x222)],'username':_0x4855c3[_0x4ad008(0x21c)],'telegramId':_0x4855c3[_0x4ad008(0x209)],'merchantUrl':_0x4855c3[_0x4ad008(0x1fc)],'gateways':_0x4855c3['paymentGateways']?JSON[_0x4ad008(0x1f7)](_0x4855c3['paymentGateways']):null,'gatewaySettings':_0x4855c3[_0x4ad008(0x217)]?JSON[_0x4ad008(0x1f7)](_0x4855c3[_0x4ad008(0x217)]):null,'publicKey':_0x4855c3[_0x4ad008(0x1f1)],'wallets':{'usdtPolygonWallet':_0x4855c3[_0x4ad008(0x1fe)],'usdtTrcWallet':_0x4855c3[_0x4ad008(0x215)],'usdtErcWallet':_0x4855c3[_0x4ad008(0x213)],'usdcPolygonWallet':_0x4855c3['usdcPolygonWallet']},'status':_0x4855c3[_0x4ad008(0x20a)],'createdAt':_0x4855c3[_0x4ad008(0x218)]};}async[a56_0x389023(0x207)](_0x54f245){const _0x5d8386=a56_0x389023;await database_1[_0x5d8386(0x211)][_0x5d8386(0x1ea)]['delete']({'where':{'id':_0x54f245}});}}exports[a56_0x389023(0x20d)]=UserService;