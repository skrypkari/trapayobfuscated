'use strict';const a56_0x4055da=a56_0x2c97;(function(_0x318cc7,_0xd30d2b){const _0x3ce482=a56_0x2c97,_0x1fefbb=_0x318cc7();while(!![]){try{const _0x35438d=-parseInt(_0x3ce482(0x93))/0x1+-parseInt(_0x3ce482(0xb4))/0x2+parseInt(_0x3ce482(0xb5))/0x3*(-parseInt(_0x3ce482(0xa4))/0x4)+-parseInt(_0x3ce482(0xb9))/0x5+-parseInt(_0x3ce482(0x9e))/0x6+-parseInt(_0x3ce482(0x97))/0x7*(parseInt(_0x3ce482(0x9b))/0x8)+parseInt(_0x3ce482(0xbd))/0x9;if(_0x35438d===_0xd30d2b)break;else _0x1fefbb['push'](_0x1fefbb['shift']());}catch(_0x2de12a){_0x1fefbb['push'](_0x1fefbb['shift']());}}}(a56_0x4918,0xf2596));var __importDefault=this&&this['__importDefault']||function(_0x11d28a){const _0x117ef5=a56_0x2c97;return _0x11d28a&&_0x11d28a[_0x117ef5(0xb6)]?_0x11d28a:{'default':_0x11d28a};};function a56_0x2c97(_0x3c5680,_0x1846f2){const _0x49182f=a56_0x4918();return a56_0x2c97=function(_0x2c97bb,_0x1d60d1){_0x2c97bb=_0x2c97bb-0x91;let _0x3c13bd=_0x49182f[_0x2c97bb];return _0x3c13bd;},a56_0x2c97(_0x3c5680,_0x1846f2);}Object[a56_0x4055da(0xa9)](exports,a56_0x4055da(0xb6),{'value':!![]}),exports[a56_0x4055da(0xa8)]=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),crypto_1=__importDefault(require(a56_0x4055da(0xa1))),database_1=__importDefault(require(a56_0x4055da(0x9a)));function a56_0x4918(){const _0x531d4b=['3231156cGNLbj','3qaBnYk','__esModule','getUserById','gatewaySettings','4726490MytMLg','publicKey','findMany','usdtErcWallet','68329881FKctde','parse','sk_','paymentGateways','status','randomBytes','shop','hex','shopUrl','telegramId','961641NbnION','toString','usdtTrcWallet','getAllUsers','14YEwDqW','fullName','usdcPolygonWallet','../config/database','628752TnOFiK','stringify','merchantUrl','9830214tFfHqk','findUnique','delete','crypto','name','wallets','5125892IuUhzr','gateways','desc','createdAt','UserService','defineProperty','telegram','default','Username\x20already\x20exists','generateApiKeys','ACTIVE','hash','pk_','usdtPolygonWallet','password','username'];a56_0x4918=function(){return _0x531d4b;};return a56_0x4918();}class UserService{['generateApiKeys'](){const _0x5a86db=a56_0x4055da,_0x116ee7=_0x5a86db(0xb0)+crypto_1[_0x5a86db(0xab)]['randomBytes'](0x20)[_0x5a86db(0x94)]('hex'),_0x5dfca3=_0x5a86db(0xbf)+crypto_1['default'][_0x5a86db(0xc2)](0x20)[_0x5a86db(0x94)](_0x5a86db(0xc4));return{'publicKey':_0x116ee7,'secretKey':_0x5dfca3};}async['createUser'](_0xab10a7){const _0x1f3e18=a56_0x4055da,{fullName:_0x2a7644,username:_0x5245f4,password:_0x5463fe,telegramId:_0x1c22f7,merchantUrl:_0x69ce55,gateways:_0xd11bd2,gatewaySettings:_0x213635,wallets:_0x4fb7b2}=_0xab10a7,_0x1731c9=await database_1[_0x1f3e18(0xab)][_0x1f3e18(0xc3)][_0x1f3e18(0x9f)]({'where':{'username':_0x5245f4}});if(_0x1731c9)throw new Error(_0x1f3e18(0xac));if(_0x1c22f7){const _0x2428a9=await database_1[_0x1f3e18(0xab)][_0x1f3e18(0xc3)][_0x1f3e18(0x9f)]({'where':{'telegram':_0x1c22f7}});if(_0x2428a9)throw new Error('Telegram\x20username\x20already\x20exists');}const _0x546ad8=await bcryptjs_1[_0x1f3e18(0xab)]['hash'](_0x5463fe,0xc),{publicKey:_0x1fb608,secretKey:_0xbb3e04}=this[_0x1f3e18(0xad)](),_0x47dbe6=await database_1[_0x1f3e18(0xab)]['shop']['create']({'data':{'name':_0x2a7644,'username':_0x5245f4,'password':_0x546ad8,'telegram':_0x1c22f7,'shopUrl':_0x69ce55,'paymentGateways':_0xd11bd2?JSON[_0x1f3e18(0x9c)](_0xd11bd2):null,'gatewaySettings':_0x213635?JSON[_0x1f3e18(0x9c)](_0x213635):null,'usdtPolygonWallet':_0x4fb7b2?.[_0x1f3e18(0xb1)]||null,'usdtTrcWallet':_0x4fb7b2?.[_0x1f3e18(0x95)]||null,'usdtErcWallet':_0x4fb7b2?.['usdtErcWallet']||null,'usdcPolygonWallet':_0x4fb7b2?.['usdcPolygonWallet']||null,'publicKey':_0x1fb608,'secretKey':_0xbb3e04,'status':_0x1f3e18(0xae)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x47dbe6['id'],'fullName':_0x47dbe6[_0x1f3e18(0xa2)],'username':_0x47dbe6[_0x1f3e18(0xb3)],'telegramId':_0x47dbe6[_0x1f3e18(0xaa)],'merchantUrl':_0x47dbe6[_0x1f3e18(0x91)],'gateways':_0x47dbe6['paymentGateways']?JSON[_0x1f3e18(0xbe)](_0x47dbe6[_0x1f3e18(0xc0)]):null,'gatewaySettings':_0x47dbe6['gatewaySettings']?JSON[_0x1f3e18(0xbe)](_0x47dbe6[_0x1f3e18(0xb8)]):null,'publicKey':_0x47dbe6[_0x1f3e18(0xba)],'wallets':{'usdtPolygonWallet':_0x47dbe6[_0x1f3e18(0xb1)],'usdtTrcWallet':_0x47dbe6[_0x1f3e18(0x95)],'usdtErcWallet':_0x47dbe6[_0x1f3e18(0xbc)],'usdcPolygonWallet':_0x47dbe6[_0x1f3e18(0x99)]},'status':_0x47dbe6[_0x1f3e18(0xc1)],'createdAt':_0x47dbe6[_0x1f3e18(0xa7)]};}async[a56_0x4055da(0x96)](){const _0x41c54c=a56_0x4055da,_0xdebd28=await database_1[_0x41c54c(0xab)][_0x41c54c(0xc3)][_0x41c54c(0xbb)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x41c54c(0xa6)}});return _0xdebd28['map'](_0x2e1dec=>({'id':_0x2e1dec['id'],'fullName':_0x2e1dec[_0x41c54c(0xa2)],'username':_0x2e1dec[_0x41c54c(0xb3)],'telegramId':_0x2e1dec[_0x41c54c(0xaa)],'merchantUrl':_0x2e1dec['shopUrl'],'gateways':_0x2e1dec[_0x41c54c(0xc0)]?JSON['parse'](_0x2e1dec['paymentGateways']):null,'gatewaySettings':_0x2e1dec['gatewaySettings']?JSON[_0x41c54c(0xbe)](_0x2e1dec[_0x41c54c(0xb8)]):null,'publicKey':_0x2e1dec[_0x41c54c(0xba)],'wallets':{'usdtPolygonWallet':_0x2e1dec['usdtPolygonWallet'],'usdtTrcWallet':_0x2e1dec[_0x41c54c(0x95)],'usdtErcWallet':_0x2e1dec[_0x41c54c(0xbc)],'usdcPolygonWallet':_0x2e1dec[_0x41c54c(0x99)]},'status':_0x2e1dec[_0x41c54c(0xc1)],'createdAt':_0x2e1dec['createdAt']}));}async[a56_0x4055da(0xb7)](_0x147a7d){const _0x4db6ab=a56_0x4055da,_0x203fd7=await database_1['default'][_0x4db6ab(0xc3)][_0x4db6ab(0x9f)]({'where':{'id':_0x147a7d},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x203fd7)return null;return{'id':_0x203fd7['id'],'fullName':_0x203fd7[_0x4db6ab(0xa2)],'username':_0x203fd7['username'],'telegramId':_0x203fd7[_0x4db6ab(0xaa)],'merchantUrl':_0x203fd7['shopUrl'],'gateways':_0x203fd7[_0x4db6ab(0xc0)]?JSON[_0x4db6ab(0xbe)](_0x203fd7[_0x4db6ab(0xc0)]):null,'gatewaySettings':_0x203fd7[_0x4db6ab(0xb8)]?JSON[_0x4db6ab(0xbe)](_0x203fd7[_0x4db6ab(0xb8)]):null,'publicKey':_0x203fd7[_0x4db6ab(0xba)],'wallets':{'usdtPolygonWallet':_0x203fd7[_0x4db6ab(0xb1)],'usdtTrcWallet':_0x203fd7[_0x4db6ab(0x95)],'usdtErcWallet':_0x203fd7[_0x4db6ab(0xbc)],'usdcPolygonWallet':_0x203fd7[_0x4db6ab(0x99)]},'status':_0x203fd7[_0x4db6ab(0xc1)],'createdAt':_0x203fd7['createdAt']};}async['updateUser'](_0x17072e,_0x42dc4f){const _0x1b468c=a56_0x4055da,_0x78e72e={..._0x42dc4f};_0x42dc4f[_0x1b468c(0xb2)]&&(_0x78e72e['password']=await bcryptjs_1[_0x1b468c(0xab)][_0x1b468c(0xaf)](_0x42dc4f[_0x1b468c(0xb2)],0xc));_0x42dc4f['fullName']&&(_0x78e72e[_0x1b468c(0xa2)]=_0x42dc4f[_0x1b468c(0x98)],delete _0x78e72e['fullName']);_0x42dc4f[_0x1b468c(0x92)]&&(_0x78e72e[_0x1b468c(0xaa)]=_0x42dc4f['telegramId'],delete _0x78e72e[_0x1b468c(0x92)]);_0x42dc4f[_0x1b468c(0x9d)]&&(_0x78e72e[_0x1b468c(0x91)]=_0x42dc4f[_0x1b468c(0x9d)],delete _0x78e72e[_0x1b468c(0x9d)]);_0x42dc4f[_0x1b468c(0xa5)]&&(_0x78e72e['paymentGateways']=JSON['stringify'](_0x42dc4f[_0x1b468c(0xa5)]),delete _0x78e72e[_0x1b468c(0xa5)]);_0x42dc4f['gatewaySettings']&&(_0x78e72e['gatewaySettings']=JSON['stringify'](_0x42dc4f[_0x1b468c(0xb8)]),delete _0x78e72e[_0x1b468c(0xb8)]);_0x42dc4f['wallets']&&(_0x42dc4f[_0x1b468c(0xa3)][_0x1b468c(0xb1)]!==undefined&&(_0x78e72e[_0x1b468c(0xb1)]=_0x42dc4f['wallets'][_0x1b468c(0xb1)]||null),_0x42dc4f[_0x1b468c(0xa3)][_0x1b468c(0x95)]!==undefined&&(_0x78e72e['usdtTrcWallet']=_0x42dc4f['wallets'][_0x1b468c(0x95)]||null),_0x42dc4f[_0x1b468c(0xa3)][_0x1b468c(0xbc)]!==undefined&&(_0x78e72e['usdtErcWallet']=_0x42dc4f['wallets'][_0x1b468c(0xbc)]||null),_0x42dc4f[_0x1b468c(0xa3)][_0x1b468c(0x99)]!==undefined&&(_0x78e72e['usdcPolygonWallet']=_0x42dc4f[_0x1b468c(0xa3)]['usdcPolygonWallet']||null),delete _0x78e72e[_0x1b468c(0xa3)]);const _0x5f5a0d=await database_1[_0x1b468c(0xab)][_0x1b468c(0xc3)]['update']({'where':{'id':_0x17072e},'data':_0x78e72e,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x5f5a0d['id'],'fullName':_0x5f5a0d[_0x1b468c(0xa2)],'username':_0x5f5a0d[_0x1b468c(0xb3)],'telegramId':_0x5f5a0d[_0x1b468c(0xaa)],'merchantUrl':_0x5f5a0d[_0x1b468c(0x91)],'gateways':_0x5f5a0d[_0x1b468c(0xc0)]?JSON[_0x1b468c(0xbe)](_0x5f5a0d[_0x1b468c(0xc0)]):null,'gatewaySettings':_0x5f5a0d[_0x1b468c(0xb8)]?JSON[_0x1b468c(0xbe)](_0x5f5a0d[_0x1b468c(0xb8)]):null,'publicKey':_0x5f5a0d[_0x1b468c(0xba)],'wallets':{'usdtPolygonWallet':_0x5f5a0d[_0x1b468c(0xb1)],'usdtTrcWallet':_0x5f5a0d[_0x1b468c(0x95)],'usdtErcWallet':_0x5f5a0d[_0x1b468c(0xbc)],'usdcPolygonWallet':_0x5f5a0d[_0x1b468c(0x99)]},'status':_0x5f5a0d['status'],'createdAt':_0x5f5a0d[_0x1b468c(0xa7)]};}async['deleteUser'](_0x23891d){const _0x5e627d=a56_0x4055da;await database_1['default']['shop'][_0x5e627d(0xa0)]({'where':{'id':_0x23891d}});}}exports[a56_0x4055da(0xa8)]=UserService;