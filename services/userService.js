'use strict';const a54_0x5bbb21=a54_0xc083;(function(_0x4ba518,_0x1487e3){const _0x4aec99=a54_0xc083,_0x4da0ed=_0x4ba518();while(!![]){try{const _0x45e86e=-parseInt(_0x4aec99(0x1c2))/0x1*(parseInt(_0x4aec99(0x1b8))/0x2)+parseInt(_0x4aec99(0x1be))/0x3*(-parseInt(_0x4aec99(0x1ce))/0x4)+parseInt(_0x4aec99(0x1a4))/0x5*(parseInt(_0x4aec99(0x1ca))/0x6)+parseInt(_0x4aec99(0x1d5))/0x7+-parseInt(_0x4aec99(0x1ab))/0x8*(parseInt(_0x4aec99(0x1c5))/0x9)+parseInt(_0x4aec99(0x1d4))/0xa+parseInt(_0x4aec99(0x1c7))/0xb;if(_0x45e86e===_0x1487e3)break;else _0x4da0ed['push'](_0x4da0ed['shift']());}catch(_0x459c60){_0x4da0ed['push'](_0x4da0ed['shift']());}}}(a54_0x5a42,0x3082c));function a54_0x5a42(){const _0x303816=['wallets','createUser','../config/database','85010WmhnYV','__importDefault','telegram','password','usdtErcWallet','defineProperty','643251yrwxGQ','shopUrl','hex','default','7yVtFvM','findUnique','fullName','115353AjkczP','stringify','3872693dekAsk','findMany','crypto','666sLfmZM','__esModule','merchantUrl','name','4tQgRes','toString','createdAt','Username\x20already\x20exists','gatewaySettings','getUserById','1217490ujKxuI','1940974HFfijJ','map','publicKey','sk_','generateApiKeys','create','1065yyhffd','parse','usdtPolygonWallet','gateways','username','paymentGateways','usdtTrcWallet','40NEMYaN','usdcPolygonWallet','desc','UserService','telegramId','deleteUser','status','shop','Telegram\x20username\x20already\x20exists','hash'];a54_0x5a42=function(){return _0x303816;};return a54_0x5a42();}var __importDefault=this&&this[a54_0x5bbb21(0x1b9)]||function(_0x4a3b3d){const _0x597472=a54_0x5bbb21;return _0x4a3b3d&&_0x4a3b3d[_0x597472(0x1cb)]?_0x4a3b3d:{'default':_0x4a3b3d};};Object[a54_0x5bbb21(0x1bd)](exports,a54_0x5bbb21(0x1cb),{'value':!![]}),exports[a54_0x5bbb21(0x1ae)]=void 0x0;function a54_0xc083(_0x5c979,_0x1eb734){const _0x5a4230=a54_0x5a42();return a54_0xc083=function(_0xc083c,_0x166f47){_0xc083c=_0xc083c-0x1a2;let _0x546c6d=_0x5a4230[_0xc083c];return _0x546c6d;},a54_0xc083(_0x5c979,_0x1eb734);}const bcryptjs_1=__importDefault(require('bcryptjs')),crypto_1=__importDefault(require(a54_0x5bbb21(0x1c9))),database_1=__importDefault(require(a54_0x5bbb21(0x1b7)));class UserService{[a54_0x5bbb21(0x1a2)](){const _0x412930=a54_0x5bbb21,_0x29da58='pk_'+crypto_1[_0x412930(0x1c1)]['randomBytes'](0x20)[_0x412930(0x1cf)](_0x412930(0x1c0)),_0xf53a51=_0x412930(0x1d8)+crypto_1[_0x412930(0x1c1)]['randomBytes'](0x20)[_0x412930(0x1cf)](_0x412930(0x1c0));return{'publicKey':_0x29da58,'secretKey':_0xf53a51};}async[a54_0x5bbb21(0x1b6)](_0x33694f){const _0x1cddef=a54_0x5bbb21,{fullName:_0x202c29,username:_0x15e8ab,password:_0x3d1e6b,telegramId:_0xf9b244,merchantUrl:_0x55ab6c,gateways:_0xc402b4,gatewaySettings:_0xae52ba,wallets:_0x96384b}=_0x33694f,_0xef98e4=await database_1[_0x1cddef(0x1c1)][_0x1cddef(0x1b2)][_0x1cddef(0x1c3)]({'where':{'username':_0x15e8ab}});if(_0xef98e4)throw new Error(_0x1cddef(0x1d1));if(_0xf9b244){const _0x2be45a=await database_1[_0x1cddef(0x1c1)][_0x1cddef(0x1b2)][_0x1cddef(0x1c3)]({'where':{'telegram':_0xf9b244}});if(_0x2be45a)throw new Error(_0x1cddef(0x1b3));}const _0x34e08d=await bcryptjs_1[_0x1cddef(0x1c1)][_0x1cddef(0x1b4)](_0x3d1e6b,0xc),{publicKey:_0x7fcb76,secretKey:_0x56f034}=this['generateApiKeys'](),_0x18ce0b=await database_1[_0x1cddef(0x1c1)]['shop'][_0x1cddef(0x1a3)]({'data':{'name':_0x202c29,'username':_0x15e8ab,'password':_0x34e08d,'telegram':_0xf9b244,'shopUrl':_0x55ab6c,'paymentGateways':_0xc402b4?JSON[_0x1cddef(0x1c6)](_0xc402b4):null,'gatewaySettings':_0xae52ba?JSON[_0x1cddef(0x1c6)](_0xae52ba):null,'usdtPolygonWallet':_0x96384b?.[_0x1cddef(0x1a6)]||null,'usdtTrcWallet':_0x96384b?.[_0x1cddef(0x1aa)]||null,'usdtErcWallet':_0x96384b?.['usdtErcWallet']||null,'usdcPolygonWallet':_0x96384b?.['usdcPolygonWallet']||null,'publicKey':_0x7fcb76,'secretKey':_0x56f034,'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x18ce0b['id'],'fullName':_0x18ce0b[_0x1cddef(0x1cd)],'username':_0x18ce0b[_0x1cddef(0x1a8)],'telegramId':_0x18ce0b[_0x1cddef(0x1ba)],'merchantUrl':_0x18ce0b[_0x1cddef(0x1bf)],'gateways':_0x18ce0b['paymentGateways']?JSON['parse'](_0x18ce0b[_0x1cddef(0x1a9)]):null,'gatewaySettings':_0x18ce0b['gatewaySettings']?JSON[_0x1cddef(0x1a5)](_0x18ce0b[_0x1cddef(0x1d2)]):null,'publicKey':_0x18ce0b[_0x1cddef(0x1d7)],'wallets':{'usdtPolygonWallet':_0x18ce0b[_0x1cddef(0x1a6)],'usdtTrcWallet':_0x18ce0b[_0x1cddef(0x1aa)],'usdtErcWallet':_0x18ce0b[_0x1cddef(0x1bc)],'usdcPolygonWallet':_0x18ce0b[_0x1cddef(0x1ac)]},'status':_0x18ce0b[_0x1cddef(0x1b1)],'createdAt':_0x18ce0b['createdAt']};}async['getAllUsers'](){const _0x9703ab=a54_0x5bbb21,_0x52e0b8=await database_1[_0x9703ab(0x1c1)][_0x9703ab(0x1b2)][_0x9703ab(0x1c8)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x9703ab(0x1ad)}});return _0x52e0b8[_0x9703ab(0x1d6)](_0x338feb=>({'id':_0x338feb['id'],'fullName':_0x338feb[_0x9703ab(0x1cd)],'username':_0x338feb['username'],'telegramId':_0x338feb['telegram'],'merchantUrl':_0x338feb[_0x9703ab(0x1bf)],'gateways':_0x338feb[_0x9703ab(0x1a9)]?JSON[_0x9703ab(0x1a5)](_0x338feb[_0x9703ab(0x1a9)]):null,'gatewaySettings':_0x338feb[_0x9703ab(0x1d2)]?JSON[_0x9703ab(0x1a5)](_0x338feb['gatewaySettings']):null,'publicKey':_0x338feb[_0x9703ab(0x1d7)],'wallets':{'usdtPolygonWallet':_0x338feb['usdtPolygonWallet'],'usdtTrcWallet':_0x338feb['usdtTrcWallet'],'usdtErcWallet':_0x338feb[_0x9703ab(0x1bc)],'usdcPolygonWallet':_0x338feb[_0x9703ab(0x1ac)]},'status':_0x338feb['status'],'createdAt':_0x338feb[_0x9703ab(0x1d0)]}));}async[a54_0x5bbb21(0x1d3)](_0x41f2e5){const _0x161d5d=a54_0x5bbb21,_0x5e185a=await database_1[_0x161d5d(0x1c1)][_0x161d5d(0x1b2)][_0x161d5d(0x1c3)]({'where':{'id':_0x41f2e5},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x5e185a)return null;return{'id':_0x5e185a['id'],'fullName':_0x5e185a[_0x161d5d(0x1cd)],'username':_0x5e185a[_0x161d5d(0x1a8)],'telegramId':_0x5e185a[_0x161d5d(0x1ba)],'merchantUrl':_0x5e185a[_0x161d5d(0x1bf)],'gateways':_0x5e185a[_0x161d5d(0x1a9)]?JSON['parse'](_0x5e185a[_0x161d5d(0x1a9)]):null,'gatewaySettings':_0x5e185a['gatewaySettings']?JSON[_0x161d5d(0x1a5)](_0x5e185a[_0x161d5d(0x1d2)]):null,'publicKey':_0x5e185a[_0x161d5d(0x1d7)],'wallets':{'usdtPolygonWallet':_0x5e185a[_0x161d5d(0x1a6)],'usdtTrcWallet':_0x5e185a[_0x161d5d(0x1aa)],'usdtErcWallet':_0x5e185a[_0x161d5d(0x1bc)],'usdcPolygonWallet':_0x5e185a[_0x161d5d(0x1ac)]},'status':_0x5e185a['status'],'createdAt':_0x5e185a['createdAt']};}async['updateUser'](_0xddafde,_0x5401b2){const _0x4ae7b7=a54_0x5bbb21,_0x2521a1={..._0x5401b2};_0x5401b2[_0x4ae7b7(0x1bb)]&&(_0x2521a1[_0x4ae7b7(0x1bb)]=await bcryptjs_1['default'][_0x4ae7b7(0x1b4)](_0x5401b2[_0x4ae7b7(0x1bb)],0xc));_0x5401b2[_0x4ae7b7(0x1c4)]&&(_0x2521a1[_0x4ae7b7(0x1cd)]=_0x5401b2[_0x4ae7b7(0x1c4)],delete _0x2521a1['fullName']);_0x5401b2['telegramId']&&(_0x2521a1[_0x4ae7b7(0x1ba)]=_0x5401b2[_0x4ae7b7(0x1af)],delete _0x2521a1[_0x4ae7b7(0x1af)]);_0x5401b2['merchantUrl']&&(_0x2521a1[_0x4ae7b7(0x1bf)]=_0x5401b2[_0x4ae7b7(0x1cc)],delete _0x2521a1['merchantUrl']);_0x5401b2[_0x4ae7b7(0x1a7)]&&(_0x2521a1[_0x4ae7b7(0x1a9)]=JSON[_0x4ae7b7(0x1c6)](_0x5401b2[_0x4ae7b7(0x1a7)]),delete _0x2521a1[_0x4ae7b7(0x1a7)]);_0x5401b2['gatewaySettings']&&(_0x2521a1['gatewaySettings']=JSON[_0x4ae7b7(0x1c6)](_0x5401b2[_0x4ae7b7(0x1d2)]),delete _0x2521a1['gatewaySettings']);_0x5401b2[_0x4ae7b7(0x1b5)]&&(_0x5401b2[_0x4ae7b7(0x1b5)]['usdtPolygonWallet']!==undefined&&(_0x2521a1[_0x4ae7b7(0x1a6)]=_0x5401b2['wallets']['usdtPolygonWallet']||null),_0x5401b2[_0x4ae7b7(0x1b5)][_0x4ae7b7(0x1aa)]!==undefined&&(_0x2521a1[_0x4ae7b7(0x1aa)]=_0x5401b2['wallets'][_0x4ae7b7(0x1aa)]||null),_0x5401b2['wallets'][_0x4ae7b7(0x1bc)]!==undefined&&(_0x2521a1['usdtErcWallet']=_0x5401b2[_0x4ae7b7(0x1b5)][_0x4ae7b7(0x1bc)]||null),_0x5401b2[_0x4ae7b7(0x1b5)][_0x4ae7b7(0x1ac)]!==undefined&&(_0x2521a1[_0x4ae7b7(0x1ac)]=_0x5401b2[_0x4ae7b7(0x1b5)]['usdcPolygonWallet']||null),delete _0x2521a1[_0x4ae7b7(0x1b5)]);const _0x52100b=await database_1[_0x4ae7b7(0x1c1)]['shop']['update']({'where':{'id':_0xddafde},'data':_0x2521a1,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x52100b['id'],'fullName':_0x52100b[_0x4ae7b7(0x1cd)],'username':_0x52100b['username'],'telegramId':_0x52100b[_0x4ae7b7(0x1ba)],'merchantUrl':_0x52100b['shopUrl'],'gateways':_0x52100b[_0x4ae7b7(0x1a9)]?JSON[_0x4ae7b7(0x1a5)](_0x52100b[_0x4ae7b7(0x1a9)]):null,'gatewaySettings':_0x52100b[_0x4ae7b7(0x1d2)]?JSON[_0x4ae7b7(0x1a5)](_0x52100b[_0x4ae7b7(0x1d2)]):null,'publicKey':_0x52100b['publicKey'],'wallets':{'usdtPolygonWallet':_0x52100b['usdtPolygonWallet'],'usdtTrcWallet':_0x52100b[_0x4ae7b7(0x1aa)],'usdtErcWallet':_0x52100b[_0x4ae7b7(0x1bc)],'usdcPolygonWallet':_0x52100b[_0x4ae7b7(0x1ac)]},'status':_0x52100b['status'],'createdAt':_0x52100b['createdAt']};}async[a54_0x5bbb21(0x1b0)](_0x4f2e02){const _0x297acf=a54_0x5bbb21;await database_1[_0x297acf(0x1c1)][_0x297acf(0x1b2)]['delete']({'where':{'id':_0x4f2e02}});}}exports[a54_0x5bbb21(0x1ae)]=UserService;