'use strict';const a85_0x5128b5=a85_0xfa43;(function(_0x23585c,_0x56466e){const _0x11aec6=a85_0xfa43,_0x5ae5f9=_0x23585c();while(!![]){try{const _0x1c2e0c=-parseInt(_0x11aec6(0x13d))/0x1+-parseInt(_0x11aec6(0x151))/0x2+parseInt(_0x11aec6(0x132))/0x3+-parseInt(_0x11aec6(0x142))/0x4+-parseInt(_0x11aec6(0x168))/0x5+parseInt(_0x11aec6(0x158))/0x6*(parseInt(_0x11aec6(0x161))/0x7)+parseInt(_0x11aec6(0x145))/0x8*(parseInt(_0x11aec6(0x14a))/0x9);if(_0x1c2e0c===_0x56466e)break;else _0x5ae5f9['push'](_0x5ae5f9['shift']());}catch(_0x26d3c6){_0x5ae5f9['push'](_0x5ae5f9['shift']());}}}(a85_0x666e,0x41747));var __importDefault=this&&this[a85_0x5128b5(0x157)]||function(_0x4cb94d){const _0x3a9492=a85_0x5128b5;return _0x4cb94d&&_0x4cb94d[_0x3a9492(0x13c)]?_0x4cb94d:{'default':_0x4cb94d};};function a85_0xfa43(_0x2e293f,_0x9ecc87){_0x2e293f=_0x2e293f-0x132;const _0x666e7a=a85_0x666e();let _0xfa4386=_0x666e7a[_0x2e293f];return _0xfa4386;}Object[a85_0x5128b5(0x13e)](exports,a85_0x5128b5(0x13c),{'value':!![]}),exports['UserService']=void 0x0;const bcryptjs_1=__importDefault(require(a85_0x5128b5(0x15b))),crypto_1=__importDefault(require('crypto')),database_1=__importDefault(require('../config/database'));class UserService{[a85_0x5128b5(0x13a)](){const _0x2aec45=a85_0x5128b5,_0x430ced='pk_'+crypto_1[_0x2aec45(0x150)][_0x2aec45(0x154)](0x20)[_0x2aec45(0x147)](_0x2aec45(0x141)),_0x2efaf3=_0x2aec45(0x160)+crypto_1[_0x2aec45(0x150)]['randomBytes'](0x20)['toString'](_0x2aec45(0x141));return{'publicKey':_0x430ced,'secretKey':_0x2efaf3};}async[a85_0x5128b5(0x14c)](_0x595d32){const _0xfe6195=a85_0x5128b5,{fullName:_0xdb5d35,username:_0x2637b4,password:_0x2c4c20,telegramId:_0x1edc88,merchantUrl:_0x255684,gateways:_0x46cfbb,gatewaySettings:_0x55ea9b,wallets:_0x13b7ba}=_0x595d32,_0x155324=await database_1[_0xfe6195(0x150)][_0xfe6195(0x159)][_0xfe6195(0x14e)]({'where':{'username':_0x2637b4}});if(_0x155324)throw new Error(_0xfe6195(0x15d));if(_0x1edc88){const _0x585dcf=await database_1[_0xfe6195(0x150)][_0xfe6195(0x159)]['findUnique']({'where':{'telegram':_0x1edc88}});if(_0x585dcf)throw new Error(_0xfe6195(0x167));}const _0x250738=await bcryptjs_1[_0xfe6195(0x150)]['hash'](_0x2c4c20,0xc),{publicKey:_0x3c88f1,secretKey:_0x4e3cfa}=this[_0xfe6195(0x13a)](),_0x259979=await database_1['default'][_0xfe6195(0x159)][_0xfe6195(0x15c)]({'data':{'name':_0xdb5d35,'username':_0x2637b4,'password':_0x250738,'telegram':_0x1edc88,'shopUrl':_0x255684,'paymentGateways':_0x46cfbb?JSON[_0xfe6195(0x15f)](_0x46cfbb):null,'gatewaySettings':_0x55ea9b?JSON['stringify'](_0x55ea9b):null,'usdtPolygonWallet':_0x13b7ba?.['usdtPolygonWallet']||null,'usdtTrcWallet':_0x13b7ba?.['usdtTrcWallet']||null,'usdtErcWallet':_0x13b7ba?.[_0xfe6195(0x14b)]||null,'usdcPolygonWallet':_0x13b7ba?.['usdcPolygonWallet']||null,'publicKey':_0x3c88f1,'secretKey':_0x4e3cfa,'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x259979['id'],'fullName':_0x259979[_0xfe6195(0x156)],'username':_0x259979[_0xfe6195(0x139)],'telegramId':_0x259979[_0xfe6195(0x133)],'merchantUrl':_0x259979['shopUrl'],'gateways':_0x259979[_0xfe6195(0x155)]?JSON[_0xfe6195(0x134)](_0x259979[_0xfe6195(0x155)]):null,'gatewaySettings':_0x259979[_0xfe6195(0x146)]?JSON[_0xfe6195(0x134)](_0x259979['gatewaySettings']):null,'publicKey':_0x259979[_0xfe6195(0x15a)],'wallets':{'usdtPolygonWallet':_0x259979[_0xfe6195(0x148)],'usdtTrcWallet':_0x259979[_0xfe6195(0x135)],'usdtErcWallet':_0x259979[_0xfe6195(0x14b)],'usdcPolygonWallet':_0x259979[_0xfe6195(0x153)]},'status':_0x259979[_0xfe6195(0x165)],'createdAt':_0x259979[_0xfe6195(0x138)]};}async[a85_0x5128b5(0x14f)](){const _0x379000=a85_0x5128b5,_0x1d8391=await database_1[_0x379000(0x150)][_0x379000(0x159)]['findMany']({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x379000(0x136)}});return _0x1d8391[_0x379000(0x143)](_0x5ee659=>({'id':_0x5ee659['id'],'fullName':_0x5ee659['name'],'username':_0x5ee659['username'],'telegramId':_0x5ee659[_0x379000(0x133)],'merchantUrl':_0x5ee659['shopUrl'],'gateways':_0x5ee659[_0x379000(0x155)]?JSON['parse'](_0x5ee659[_0x379000(0x155)]):null,'gatewaySettings':_0x5ee659[_0x379000(0x146)]?JSON[_0x379000(0x134)](_0x5ee659[_0x379000(0x146)]):null,'publicKey':_0x5ee659[_0x379000(0x15a)],'wallets':{'usdtPolygonWallet':_0x5ee659[_0x379000(0x148)],'usdtTrcWallet':_0x5ee659[_0x379000(0x135)],'usdtErcWallet':_0x5ee659['usdtErcWallet'],'usdcPolygonWallet':_0x5ee659[_0x379000(0x153)]},'status':_0x5ee659[_0x379000(0x165)],'createdAt':_0x5ee659[_0x379000(0x138)]}));}async[a85_0x5128b5(0x13b)](_0x3ea296){const _0x10b008=a85_0x5128b5,_0x33b488=await database_1['default']['shop']['findUnique']({'where':{'id':_0x3ea296},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x33b488)return null;return{'id':_0x33b488['id'],'fullName':_0x33b488[_0x10b008(0x156)],'username':_0x33b488['username'],'telegramId':_0x33b488['telegram'],'merchantUrl':_0x33b488[_0x10b008(0x152)],'gateways':_0x33b488[_0x10b008(0x155)]?JSON[_0x10b008(0x134)](_0x33b488[_0x10b008(0x155)]):null,'gatewaySettings':_0x33b488['gatewaySettings']?JSON[_0x10b008(0x134)](_0x33b488['gatewaySettings']):null,'publicKey':_0x33b488[_0x10b008(0x15a)],'wallets':{'usdtPolygonWallet':_0x33b488[_0x10b008(0x148)],'usdtTrcWallet':_0x33b488[_0x10b008(0x135)],'usdtErcWallet':_0x33b488[_0x10b008(0x14b)],'usdcPolygonWallet':_0x33b488[_0x10b008(0x153)]},'status':_0x33b488[_0x10b008(0x165)],'createdAt':_0x33b488[_0x10b008(0x138)]};}async[a85_0x5128b5(0x137)](_0x4069a9,_0x79b545){const _0x5da17a=a85_0x5128b5,_0x5c8d74={..._0x79b545};_0x79b545['password']&&(_0x5c8d74[_0x5da17a(0x164)]=await bcryptjs_1['default'][_0x5da17a(0x162)](_0x79b545[_0x5da17a(0x164)],0xc));_0x79b545['fullName']&&(_0x5c8d74[_0x5da17a(0x156)]=_0x79b545[_0x5da17a(0x13f)],delete _0x5c8d74[_0x5da17a(0x13f)]);_0x79b545[_0x5da17a(0x15e)]&&(_0x5c8d74[_0x5da17a(0x133)]=_0x79b545[_0x5da17a(0x15e)],delete _0x5c8d74[_0x5da17a(0x15e)]);_0x79b545[_0x5da17a(0x144)]&&(_0x5c8d74['shopUrl']=_0x79b545['merchantUrl'],delete _0x5c8d74['merchantUrl']);_0x79b545['gateways']&&(_0x5c8d74[_0x5da17a(0x155)]=JSON[_0x5da17a(0x15f)](_0x79b545[_0x5da17a(0x14d)]),delete _0x5c8d74['gateways']);_0x79b545[_0x5da17a(0x146)]&&(_0x5c8d74[_0x5da17a(0x146)]=JSON[_0x5da17a(0x15f)](_0x79b545[_0x5da17a(0x146)]),delete _0x5c8d74[_0x5da17a(0x146)]);_0x79b545[_0x5da17a(0x166)]&&(_0x79b545[_0x5da17a(0x166)]['usdtPolygonWallet']!==undefined&&(_0x5c8d74['usdtPolygonWallet']=_0x79b545[_0x5da17a(0x166)][_0x5da17a(0x148)]||null),_0x79b545[_0x5da17a(0x166)][_0x5da17a(0x135)]!==undefined&&(_0x5c8d74[_0x5da17a(0x135)]=_0x79b545[_0x5da17a(0x166)]['usdtTrcWallet']||null),_0x79b545['wallets'][_0x5da17a(0x14b)]!==undefined&&(_0x5c8d74['usdtErcWallet']=_0x79b545[_0x5da17a(0x166)][_0x5da17a(0x14b)]||null),_0x79b545[_0x5da17a(0x166)][_0x5da17a(0x153)]!==undefined&&(_0x5c8d74[_0x5da17a(0x153)]=_0x79b545[_0x5da17a(0x166)]['usdcPolygonWallet']||null),delete _0x5c8d74[_0x5da17a(0x166)]);const _0x161362=await database_1[_0x5da17a(0x150)][_0x5da17a(0x159)][_0x5da17a(0x163)]({'where':{'id':_0x4069a9},'data':_0x5c8d74,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x161362['id'],'fullName':_0x161362[_0x5da17a(0x156)],'username':_0x161362[_0x5da17a(0x139)],'telegramId':_0x161362[_0x5da17a(0x133)],'merchantUrl':_0x161362[_0x5da17a(0x152)],'gateways':_0x161362[_0x5da17a(0x155)]?JSON[_0x5da17a(0x134)](_0x161362['paymentGateways']):null,'gatewaySettings':_0x161362[_0x5da17a(0x146)]?JSON['parse'](_0x161362['gatewaySettings']):null,'publicKey':_0x161362[_0x5da17a(0x15a)],'wallets':{'usdtPolygonWallet':_0x161362[_0x5da17a(0x148)],'usdtTrcWallet':_0x161362[_0x5da17a(0x135)],'usdtErcWallet':_0x161362[_0x5da17a(0x14b)],'usdcPolygonWallet':_0x161362['usdcPolygonWallet']},'status':_0x161362[_0x5da17a(0x165)],'createdAt':_0x161362[_0x5da17a(0x138)]};}async[a85_0x5128b5(0x149)](_0x27d657){const _0x422ce5=a85_0x5128b5;await database_1[_0x422ce5(0x150)]['shop']['delete']({'where':{'id':_0x27d657}});}}function a85_0x666e(){const _0x46c204=['default','52726uWENNS','shopUrl','usdcPolygonWallet','randomBytes','paymentGateways','name','__importDefault','6CfZZFx','shop','publicKey','bcryptjs','create','Username\x20already\x20exists','telegramId','stringify','sk_','3444385nXUJVx','hash','update','password','status','wallets','Telegram\x20username\x20already\x20exists','436850oEEGjP','267738FjaDtq','telegram','parse','usdtTrcWallet','desc','updateUser','createdAt','username','generateApiKeys','getUserById','__esModule','34047eAjzob','defineProperty','fullName','UserService','hex','1133292LeRYxQ','map','merchantUrl','943240IkMfas','gatewaySettings','toString','usdtPolygonWallet','deleteUser','9keyBEP','usdtErcWallet','createUser','gateways','findUnique','getAllUsers'];a85_0x666e=function(){return _0x46c204;};return a85_0x666e();}exports[a85_0x5128b5(0x140)]=UserService;