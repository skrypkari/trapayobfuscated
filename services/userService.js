'use strict';const a57_0x39ed60=a57_0x41ac;(function(_0x2f1937,_0x23b633){const _0x28a35d=a57_0x41ac,_0x294495=_0x2f1937();while(!![]){try{const _0x18e272=parseInt(_0x28a35d(0x181))/0x1*(parseInt(_0x28a35d(0x170))/0x2)+parseInt(_0x28a35d(0x156))/0x3+-parseInt(_0x28a35d(0x153))/0x4*(parseInt(_0x28a35d(0x173))/0x5)+parseInt(_0x28a35d(0x179))/0x6*(-parseInt(_0x28a35d(0x158))/0x7)+parseInt(_0x28a35d(0x16e))/0x8+-parseInt(_0x28a35d(0x15b))/0x9*(-parseInt(_0x28a35d(0x165))/0xa)+-parseInt(_0x28a35d(0x163))/0xb;if(_0x18e272===_0x23b633)break;else _0x294495['push'](_0x294495['shift']());}catch(_0x25b1f3){_0x294495['push'](_0x294495['shift']());}}}(a57_0x9c33,0x9068a));function a57_0x9c33(){const _0x5d2335=['3229752WbSJIy','ACTIVE','742fdAySO','toString','stringify','2001627peCOsL','__importDefault','telegramId','getAllUsers','name','gateways','gatewaySettings','findUnique','26570148LGvldK','findMany','50CWLTHC','Telegram\x20username\x20already\x20exists','usdtTrcWallet','fullName','create','shopUrl','status','delete','usdtPolygonWallet','897032snVCOU','wallets','254xiwhnD','pk_','shop','1075315vcTwAL','createdAt','createUser','updateUser','password','map','7596QelWXA','username','randomBytes','merchantUrl','publicKey','update','sk_','hex','8311wLnxWx','paymentGateways','parse','../config/database','usdtErcWallet','UserService','default','hash','generateApiKeys','desc','usdcPolygonWallet','4DNYzdM','telegram','__esModule'];a57_0x9c33=function(){return _0x5d2335;};return a57_0x9c33();}function a57_0x41ac(_0x541fee,_0x2deec8){const _0x9c331=a57_0x9c33();return a57_0x41ac=function(_0x41ac13,_0x2b1ead){_0x41ac13=_0x41ac13-0x152;let _0xb99fd=_0x9c331[_0x41ac13];return _0xb99fd;},a57_0x41ac(_0x541fee,_0x2deec8);}var __importDefault=this&&this[a57_0x39ed60(0x15c)]||function(_0x48d8fa){const _0x129c2f=a57_0x39ed60;return _0x48d8fa&&_0x48d8fa[_0x129c2f(0x155)]?_0x48d8fa:{'default':_0x48d8fa};};Object['defineProperty'](exports,a57_0x39ed60(0x155),{'value':!![]}),exports[a57_0x39ed60(0x186)]=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),crypto_1=__importDefault(require('crypto')),database_1=__importDefault(require(a57_0x39ed60(0x184)));class UserService{[a57_0x39ed60(0x189)](){const _0x408e78=a57_0x39ed60,_0x2fa997=_0x408e78(0x171)+crypto_1['default'][_0x408e78(0x17b)](0x20)[_0x408e78(0x159)](_0x408e78(0x180)),_0x5dc489=_0x408e78(0x17f)+crypto_1[_0x408e78(0x187)][_0x408e78(0x17b)](0x20)['toString']('hex');return{'publicKey':_0x2fa997,'secretKey':_0x5dc489};}async[a57_0x39ed60(0x175)](_0xb5371b){const _0x3e0fe4=a57_0x39ed60,{fullName:_0x655ddf,username:_0x47ca23,password:_0x55e5a6,telegramId:_0xa56bcb,merchantUrl:_0x19073f,gateways:_0x14bc69,gatewaySettings:_0x16d1e5,wallets:_0x532334}=_0xb5371b,_0x5205a8=await database_1[_0x3e0fe4(0x187)][_0x3e0fe4(0x172)][_0x3e0fe4(0x162)]({'where':{'username':_0x47ca23}});if(_0x5205a8)throw new Error('Username\x20already\x20exists');if(_0xa56bcb){const _0x26855=await database_1[_0x3e0fe4(0x187)][_0x3e0fe4(0x172)][_0x3e0fe4(0x162)]({'where':{'telegram':_0xa56bcb}});if(_0x26855)throw new Error(_0x3e0fe4(0x166));}const _0x3159c6=await bcryptjs_1[_0x3e0fe4(0x187)][_0x3e0fe4(0x188)](_0x55e5a6,0xc),{publicKey:_0x584724,secretKey:_0x2ff6de}=this[_0x3e0fe4(0x189)](),_0x1f2fc5=await database_1['default']['shop'][_0x3e0fe4(0x169)]({'data':{'name':_0x655ddf,'username':_0x47ca23,'password':_0x3159c6,'telegram':_0xa56bcb,'shopUrl':_0x19073f,'paymentGateways':_0x14bc69?JSON[_0x3e0fe4(0x15a)](_0x14bc69):null,'gatewaySettings':_0x16d1e5?JSON[_0x3e0fe4(0x15a)](_0x16d1e5):null,'usdtPolygonWallet':_0x532334?.[_0x3e0fe4(0x16d)]||null,'usdtTrcWallet':_0x532334?.['usdtTrcWallet']||null,'usdtErcWallet':_0x532334?.[_0x3e0fe4(0x185)]||null,'usdcPolygonWallet':_0x532334?.[_0x3e0fe4(0x152)]||null,'publicKey':_0x584724,'secretKey':_0x2ff6de,'status':_0x3e0fe4(0x157)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x1f2fc5['id'],'fullName':_0x1f2fc5[_0x3e0fe4(0x15f)],'username':_0x1f2fc5['username'],'telegramId':_0x1f2fc5['telegram'],'merchantUrl':_0x1f2fc5[_0x3e0fe4(0x16a)],'gateways':_0x1f2fc5[_0x3e0fe4(0x182)]?JSON['parse'](_0x1f2fc5['paymentGateways']):null,'gatewaySettings':_0x1f2fc5['gatewaySettings']?JSON['parse'](_0x1f2fc5[_0x3e0fe4(0x161)]):null,'publicKey':_0x1f2fc5[_0x3e0fe4(0x17d)],'wallets':{'usdtPolygonWallet':_0x1f2fc5[_0x3e0fe4(0x16d)],'usdtTrcWallet':_0x1f2fc5[_0x3e0fe4(0x167)],'usdtErcWallet':_0x1f2fc5[_0x3e0fe4(0x185)],'usdcPolygonWallet':_0x1f2fc5[_0x3e0fe4(0x152)]},'status':_0x1f2fc5[_0x3e0fe4(0x16b)],'createdAt':_0x1f2fc5['createdAt']};}async[a57_0x39ed60(0x15e)](){const _0x2838a4=a57_0x39ed60,_0x2e74c3=await database_1[_0x2838a4(0x187)][_0x2838a4(0x172)][_0x2838a4(0x164)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x2838a4(0x18a)}});return _0x2e74c3[_0x2838a4(0x178)](_0x25b761=>({'id':_0x25b761['id'],'fullName':_0x25b761[_0x2838a4(0x15f)],'username':_0x25b761['username'],'telegramId':_0x25b761[_0x2838a4(0x154)],'merchantUrl':_0x25b761[_0x2838a4(0x16a)],'gateways':_0x25b761[_0x2838a4(0x182)]?JSON[_0x2838a4(0x183)](_0x25b761[_0x2838a4(0x182)]):null,'gatewaySettings':_0x25b761[_0x2838a4(0x161)]?JSON[_0x2838a4(0x183)](_0x25b761[_0x2838a4(0x161)]):null,'publicKey':_0x25b761[_0x2838a4(0x17d)],'wallets':{'usdtPolygonWallet':_0x25b761[_0x2838a4(0x16d)],'usdtTrcWallet':_0x25b761[_0x2838a4(0x167)],'usdtErcWallet':_0x25b761[_0x2838a4(0x185)],'usdcPolygonWallet':_0x25b761[_0x2838a4(0x152)]},'status':_0x25b761['status'],'createdAt':_0x25b761[_0x2838a4(0x174)]}));}async['getUserById'](_0x42c4ce){const _0x18e9aa=a57_0x39ed60,_0x3b6f17=await database_1[_0x18e9aa(0x187)][_0x18e9aa(0x172)]['findUnique']({'where':{'id':_0x42c4ce},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x3b6f17)return null;return{'id':_0x3b6f17['id'],'fullName':_0x3b6f17['name'],'username':_0x3b6f17[_0x18e9aa(0x17a)],'telegramId':_0x3b6f17[_0x18e9aa(0x154)],'merchantUrl':_0x3b6f17[_0x18e9aa(0x16a)],'gateways':_0x3b6f17[_0x18e9aa(0x182)]?JSON[_0x18e9aa(0x183)](_0x3b6f17['paymentGateways']):null,'gatewaySettings':_0x3b6f17['gatewaySettings']?JSON['parse'](_0x3b6f17[_0x18e9aa(0x161)]):null,'publicKey':_0x3b6f17[_0x18e9aa(0x17d)],'wallets':{'usdtPolygonWallet':_0x3b6f17[_0x18e9aa(0x16d)],'usdtTrcWallet':_0x3b6f17[_0x18e9aa(0x167)],'usdtErcWallet':_0x3b6f17[_0x18e9aa(0x185)],'usdcPolygonWallet':_0x3b6f17[_0x18e9aa(0x152)]},'status':_0x3b6f17['status'],'createdAt':_0x3b6f17[_0x18e9aa(0x174)]};}async[a57_0x39ed60(0x176)](_0x33ace6,_0x36bb48){const _0x321df8=a57_0x39ed60,_0x1649af={..._0x36bb48};_0x36bb48[_0x321df8(0x177)]&&(_0x1649af[_0x321df8(0x177)]=await bcryptjs_1[_0x321df8(0x187)][_0x321df8(0x188)](_0x36bb48['password'],0xc));_0x36bb48['fullName']&&(_0x1649af[_0x321df8(0x15f)]=_0x36bb48['fullName'],delete _0x1649af[_0x321df8(0x168)]);_0x36bb48[_0x321df8(0x15d)]&&(_0x1649af[_0x321df8(0x154)]=_0x36bb48[_0x321df8(0x15d)],delete _0x1649af['telegramId']);_0x36bb48[_0x321df8(0x17c)]&&(_0x1649af[_0x321df8(0x16a)]=_0x36bb48[_0x321df8(0x17c)],delete _0x1649af[_0x321df8(0x17c)]);_0x36bb48[_0x321df8(0x160)]&&(_0x1649af[_0x321df8(0x182)]=JSON[_0x321df8(0x15a)](_0x36bb48[_0x321df8(0x160)]),delete _0x1649af[_0x321df8(0x160)]);_0x36bb48['gatewaySettings']&&(_0x1649af[_0x321df8(0x161)]=JSON[_0x321df8(0x15a)](_0x36bb48[_0x321df8(0x161)]),delete _0x1649af[_0x321df8(0x161)]);_0x36bb48['wallets']&&(_0x36bb48['wallets']['usdtPolygonWallet']!==undefined&&(_0x1649af['usdtPolygonWallet']=_0x36bb48[_0x321df8(0x16f)][_0x321df8(0x16d)]||null),_0x36bb48[_0x321df8(0x16f)]['usdtTrcWallet']!==undefined&&(_0x1649af[_0x321df8(0x167)]=_0x36bb48[_0x321df8(0x16f)][_0x321df8(0x167)]||null),_0x36bb48['wallets']['usdtErcWallet']!==undefined&&(_0x1649af[_0x321df8(0x185)]=_0x36bb48[_0x321df8(0x16f)][_0x321df8(0x185)]||null),_0x36bb48['wallets']['usdcPolygonWallet']!==undefined&&(_0x1649af[_0x321df8(0x152)]=_0x36bb48[_0x321df8(0x16f)]['usdcPolygonWallet']||null),delete _0x1649af[_0x321df8(0x16f)]);const _0x2f6d5f=await database_1['default'][_0x321df8(0x172)][_0x321df8(0x17e)]({'where':{'id':_0x33ace6},'data':_0x1649af,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x2f6d5f['id'],'fullName':_0x2f6d5f[_0x321df8(0x15f)],'username':_0x2f6d5f[_0x321df8(0x17a)],'telegramId':_0x2f6d5f[_0x321df8(0x154)],'merchantUrl':_0x2f6d5f['shopUrl'],'gateways':_0x2f6d5f[_0x321df8(0x182)]?JSON[_0x321df8(0x183)](_0x2f6d5f[_0x321df8(0x182)]):null,'gatewaySettings':_0x2f6d5f[_0x321df8(0x161)]?JSON[_0x321df8(0x183)](_0x2f6d5f[_0x321df8(0x161)]):null,'publicKey':_0x2f6d5f['publicKey'],'wallets':{'usdtPolygonWallet':_0x2f6d5f['usdtPolygonWallet'],'usdtTrcWallet':_0x2f6d5f[_0x321df8(0x167)],'usdtErcWallet':_0x2f6d5f[_0x321df8(0x185)],'usdcPolygonWallet':_0x2f6d5f[_0x321df8(0x152)]},'status':_0x2f6d5f[_0x321df8(0x16b)],'createdAt':_0x2f6d5f['createdAt']};}async['deleteUser'](_0x2a80b4){const _0x1f5dda=a57_0x39ed60;await database_1['default'][_0x1f5dda(0x172)][_0x1f5dda(0x16c)]({'where':{'id':_0x2a80b4}});}}exports[a57_0x39ed60(0x186)]=UserService;