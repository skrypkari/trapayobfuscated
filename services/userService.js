'use strict';const a51_0x57dc41=a51_0xce97;(function(_0x2b9aed,_0x9e49ee){const _0x530623=a51_0xce97,_0xd6db84=_0x2b9aed();while(!![]){try{const _0x2bc143=-parseInt(_0x530623(0x15a))/0x1*(-parseInt(_0x530623(0x16a))/0x2)+-parseInt(_0x530623(0x160))/0x3+-parseInt(_0x530623(0x175))/0x4+-parseInt(_0x530623(0x150))/0x5*(parseInt(_0x530623(0x177))/0x6)+-parseInt(_0x530623(0x170))/0x7*(-parseInt(_0x530623(0x178))/0x8)+parseInt(_0x530623(0x147))/0x9*(-parseInt(_0x530623(0x167))/0xa)+parseInt(_0x530623(0x159))/0xb;if(_0x2bc143===_0x9e49ee)break;else _0xd6db84['push'](_0xd6db84['shift']());}catch(_0x2f64eb){_0xd6db84['push'](_0xd6db84['shift']());}}}(a51_0x3045,0xb6629));function a51_0x3045(){const _0x2c8d53=['status','4431096EmTuZJ','publicKey','195246HSDPBw','8aDIZfh','__importDefault','fullName','__esModule','hash','parse','usdtErcWallet','shop','telegramId','24039NWBFhV','password','getUserById','ACTIVE','toString','sk_','update','merchantUrl','updateUser','20zXVGbl','map','usdtPolygonWallet','shopUrl','default','createdAt','gateways','wallets','name','14808805aqFQsH','11zdrkIi','username','generateApiKeys','usdcPolygonWallet','UserService','delete','1417290aVvlZB','Username\x20already\x20exists','randomBytes','crypto','findUnique','Telegram\x20username\x20already\x20exists','gatewaySettings','270lpPWzD','stringify','deleteUser','140036okXVeV','usdtTrcWallet','desc','createUser','../config/database','findMany','2891567XmDoSE','paymentGateways','telegram','hex'];a51_0x3045=function(){return _0x2c8d53;};return a51_0x3045();}var __importDefault=this&&this[a51_0x57dc41(0x179)]||function(_0x133c5d){const _0x44f25e=a51_0x57dc41;return _0x133c5d&&_0x133c5d[_0x44f25e(0x141)]?_0x133c5d:{'default':_0x133c5d};};Object['defineProperty'](exports,a51_0x57dc41(0x141),{'value':!![]}),exports[a51_0x57dc41(0x15e)]=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),crypto_1=__importDefault(require(a51_0x57dc41(0x163))),database_1=__importDefault(require(a51_0x57dc41(0x16e)));class UserService{[a51_0x57dc41(0x15c)](){const _0xc3aaaf=a51_0x57dc41,_0x542cf7='pk_'+crypto_1[_0xc3aaaf(0x154)][_0xc3aaaf(0x162)](0x20)[_0xc3aaaf(0x14b)]('hex'),_0x434901=_0xc3aaaf(0x14c)+crypto_1['default'][_0xc3aaaf(0x162)](0x20)[_0xc3aaaf(0x14b)](_0xc3aaaf(0x173));return{'publicKey':_0x542cf7,'secretKey':_0x434901};}async[a51_0x57dc41(0x16d)](_0x2161d2){const _0x587c9f=a51_0x57dc41,{fullName:_0x731b99,username:_0x29cecc,password:_0x85f6dc,telegramId:_0x500e23,merchantUrl:_0x54ac05,gateways:_0x5b0b39,gatewaySettings:_0x2238d4,wallets:_0x50d15c}=_0x2161d2,_0x47de17=await database_1[_0x587c9f(0x154)][_0x587c9f(0x145)][_0x587c9f(0x164)]({'where':{'username':_0x29cecc}});if(_0x47de17)throw new Error(_0x587c9f(0x161));if(_0x500e23){const _0x119014=await database_1[_0x587c9f(0x154)][_0x587c9f(0x145)]['findUnique']({'where':{'telegram':_0x500e23}});if(_0x119014)throw new Error(_0x587c9f(0x165));}const _0x510e2f=await bcryptjs_1[_0x587c9f(0x154)][_0x587c9f(0x142)](_0x85f6dc,0xc),{publicKey:_0x2fa434,secretKey:_0x3c1763}=this['generateApiKeys'](),_0x185a67=await database_1[_0x587c9f(0x154)]['shop']['create']({'data':{'name':_0x731b99,'username':_0x29cecc,'password':_0x510e2f,'telegram':_0x500e23,'shopUrl':_0x54ac05,'paymentGateways':_0x5b0b39?JSON[_0x587c9f(0x168)](_0x5b0b39):null,'gatewaySettings':_0x2238d4?JSON['stringify'](_0x2238d4):null,'usdtPolygonWallet':_0x50d15c?.['usdtPolygonWallet']||null,'usdtTrcWallet':_0x50d15c?.[_0x587c9f(0x16b)]||null,'usdtErcWallet':_0x50d15c?.[_0x587c9f(0x144)]||null,'usdcPolygonWallet':_0x50d15c?.[_0x587c9f(0x15d)]||null,'publicKey':_0x2fa434,'secretKey':_0x3c1763,'status':_0x587c9f(0x14a)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x185a67['id'],'fullName':_0x185a67[_0x587c9f(0x158)],'username':_0x185a67[_0x587c9f(0x15b)],'telegramId':_0x185a67[_0x587c9f(0x172)],'merchantUrl':_0x185a67[_0x587c9f(0x153)],'gateways':_0x185a67[_0x587c9f(0x171)]?JSON[_0x587c9f(0x143)](_0x185a67[_0x587c9f(0x171)]):null,'gatewaySettings':_0x185a67[_0x587c9f(0x166)]?JSON['parse'](_0x185a67['gatewaySettings']):null,'publicKey':_0x185a67[_0x587c9f(0x176)],'wallets':{'usdtPolygonWallet':_0x185a67[_0x587c9f(0x152)],'usdtTrcWallet':_0x185a67[_0x587c9f(0x16b)],'usdtErcWallet':_0x185a67['usdtErcWallet'],'usdcPolygonWallet':_0x185a67[_0x587c9f(0x15d)]},'status':_0x185a67[_0x587c9f(0x174)],'createdAt':_0x185a67[_0x587c9f(0x155)]};}async['getAllUsers'](){const _0x1467df=a51_0x57dc41,_0x4042fb=await database_1[_0x1467df(0x154)][_0x1467df(0x145)][_0x1467df(0x16f)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x1467df(0x16c)}});return _0x4042fb[_0x1467df(0x151)](_0x2e3324=>({'id':_0x2e3324['id'],'fullName':_0x2e3324[_0x1467df(0x158)],'username':_0x2e3324[_0x1467df(0x15b)],'telegramId':_0x2e3324['telegram'],'merchantUrl':_0x2e3324[_0x1467df(0x153)],'gateways':_0x2e3324['paymentGateways']?JSON['parse'](_0x2e3324[_0x1467df(0x171)]):null,'gatewaySettings':_0x2e3324[_0x1467df(0x166)]?JSON[_0x1467df(0x143)](_0x2e3324['gatewaySettings']):null,'publicKey':_0x2e3324['publicKey'],'wallets':{'usdtPolygonWallet':_0x2e3324[_0x1467df(0x152)],'usdtTrcWallet':_0x2e3324[_0x1467df(0x16b)],'usdtErcWallet':_0x2e3324[_0x1467df(0x144)],'usdcPolygonWallet':_0x2e3324[_0x1467df(0x15d)]},'status':_0x2e3324['status'],'createdAt':_0x2e3324['createdAt']}));}async[a51_0x57dc41(0x149)](_0x49b236){const _0x562a55=a51_0x57dc41,_0x397b27=await database_1['default'][_0x562a55(0x145)][_0x562a55(0x164)]({'where':{'id':_0x49b236},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x397b27)return null;return{'id':_0x397b27['id'],'fullName':_0x397b27['name'],'username':_0x397b27['username'],'telegramId':_0x397b27[_0x562a55(0x172)],'merchantUrl':_0x397b27[_0x562a55(0x153)],'gateways':_0x397b27[_0x562a55(0x171)]?JSON[_0x562a55(0x143)](_0x397b27[_0x562a55(0x171)]):null,'gatewaySettings':_0x397b27[_0x562a55(0x166)]?JSON[_0x562a55(0x143)](_0x397b27['gatewaySettings']):null,'publicKey':_0x397b27[_0x562a55(0x176)],'wallets':{'usdtPolygonWallet':_0x397b27['usdtPolygonWallet'],'usdtTrcWallet':_0x397b27[_0x562a55(0x16b)],'usdtErcWallet':_0x397b27[_0x562a55(0x144)],'usdcPolygonWallet':_0x397b27[_0x562a55(0x15d)]},'status':_0x397b27['status'],'createdAt':_0x397b27[_0x562a55(0x155)]};}async[a51_0x57dc41(0x14f)](_0x55d218,_0x2a7cc3){const _0xdec5da=a51_0x57dc41,_0x96f588={..._0x2a7cc3};_0x2a7cc3[_0xdec5da(0x148)]&&(_0x96f588[_0xdec5da(0x148)]=await bcryptjs_1[_0xdec5da(0x154)][_0xdec5da(0x142)](_0x2a7cc3[_0xdec5da(0x148)],0xc));_0x2a7cc3['fullName']&&(_0x96f588[_0xdec5da(0x158)]=_0x2a7cc3[_0xdec5da(0x17a)],delete _0x96f588[_0xdec5da(0x17a)]);_0x2a7cc3[_0xdec5da(0x146)]&&(_0x96f588[_0xdec5da(0x172)]=_0x2a7cc3[_0xdec5da(0x146)],delete _0x96f588[_0xdec5da(0x146)]);_0x2a7cc3[_0xdec5da(0x14e)]&&(_0x96f588[_0xdec5da(0x153)]=_0x2a7cc3[_0xdec5da(0x14e)],delete _0x96f588[_0xdec5da(0x14e)]);_0x2a7cc3['gateways']&&(_0x96f588[_0xdec5da(0x171)]=JSON[_0xdec5da(0x168)](_0x2a7cc3[_0xdec5da(0x156)]),delete _0x96f588[_0xdec5da(0x156)]);_0x2a7cc3[_0xdec5da(0x166)]&&(_0x96f588[_0xdec5da(0x166)]=JSON[_0xdec5da(0x168)](_0x2a7cc3['gatewaySettings']),delete _0x96f588['gatewaySettings']);_0x2a7cc3[_0xdec5da(0x157)]&&(_0x2a7cc3[_0xdec5da(0x157)][_0xdec5da(0x152)]!==undefined&&(_0x96f588[_0xdec5da(0x152)]=_0x2a7cc3[_0xdec5da(0x157)][_0xdec5da(0x152)]||null),_0x2a7cc3['wallets'][_0xdec5da(0x16b)]!==undefined&&(_0x96f588['usdtTrcWallet']=_0x2a7cc3['wallets'][_0xdec5da(0x16b)]||null),_0x2a7cc3[_0xdec5da(0x157)][_0xdec5da(0x144)]!==undefined&&(_0x96f588[_0xdec5da(0x144)]=_0x2a7cc3[_0xdec5da(0x157)][_0xdec5da(0x144)]||null),_0x2a7cc3[_0xdec5da(0x157)][_0xdec5da(0x15d)]!==undefined&&(_0x96f588[_0xdec5da(0x15d)]=_0x2a7cc3[_0xdec5da(0x157)][_0xdec5da(0x15d)]||null),delete _0x96f588['wallets']);const _0x5eb5ed=await database_1[_0xdec5da(0x154)][_0xdec5da(0x145)][_0xdec5da(0x14d)]({'where':{'id':_0x55d218},'data':_0x96f588,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x5eb5ed['id'],'fullName':_0x5eb5ed[_0xdec5da(0x158)],'username':_0x5eb5ed[_0xdec5da(0x15b)],'telegramId':_0x5eb5ed[_0xdec5da(0x172)],'merchantUrl':_0x5eb5ed[_0xdec5da(0x153)],'gateways':_0x5eb5ed[_0xdec5da(0x171)]?JSON[_0xdec5da(0x143)](_0x5eb5ed['paymentGateways']):null,'gatewaySettings':_0x5eb5ed[_0xdec5da(0x166)]?JSON['parse'](_0x5eb5ed[_0xdec5da(0x166)]):null,'publicKey':_0x5eb5ed[_0xdec5da(0x176)],'wallets':{'usdtPolygonWallet':_0x5eb5ed[_0xdec5da(0x152)],'usdtTrcWallet':_0x5eb5ed['usdtTrcWallet'],'usdtErcWallet':_0x5eb5ed[_0xdec5da(0x144)],'usdcPolygonWallet':_0x5eb5ed[_0xdec5da(0x15d)]},'status':_0x5eb5ed[_0xdec5da(0x174)],'createdAt':_0x5eb5ed['createdAt']};}async[a51_0x57dc41(0x169)](_0x43ccbf){const _0x2a4773=a51_0x57dc41;await database_1[_0x2a4773(0x154)]['shop'][_0x2a4773(0x15f)]({'where':{'id':_0x43ccbf}});}}function a51_0xce97(_0x2ae7e2,_0x21f2d3){const _0x304554=a51_0x3045();return a51_0xce97=function(_0xce9791,_0x3f7489){_0xce9791=_0xce9791-0x141;let _0xee10ed=_0x304554[_0xce9791];return _0xee10ed;},a51_0xce97(_0x2ae7e2,_0x21f2d3);}exports[a51_0x57dc41(0x15e)]=UserService;