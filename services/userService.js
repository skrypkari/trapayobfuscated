'use strict';const a50_0x29fd06=a50_0x215f;(function(_0x1932e3,_0x5c698a){const _0x21a9a3=a50_0x215f,_0x1d0d3e=_0x1932e3();while(!![]){try{const _0x2845b4=-parseInt(_0x21a9a3(0xec))/0x1+parseInt(_0x21a9a3(0xd9))/0x2*(parseInt(_0x21a9a3(0xc9))/0x3)+-parseInt(_0x21a9a3(0xea))/0x4*(-parseInt(_0x21a9a3(0xdd))/0x5)+parseInt(_0x21a9a3(0xdf))/0x6*(-parseInt(_0x21a9a3(0xbe))/0x7)+parseInt(_0x21a9a3(0xc3))/0x8+parseInt(_0x21a9a3(0xbd))/0x9*(-parseInt(_0x21a9a3(0xd0))/0xa)+-parseInt(_0x21a9a3(0xc5))/0xb*(-parseInt(_0x21a9a3(0xf3))/0xc);if(_0x2845b4===_0x5c698a)break;else _0x1d0d3e['push'](_0x1d0d3e['shift']());}catch(_0x154167){_0x1d0d3e['push'](_0x1d0d3e['shift']());}}}(a50_0x1eb0,0x1cd60));function a50_0x1eb0(){const _0x8974f4=['status','45672VjafSe','desc','11vIjvNe','usdtErcWallet','ACTIVE','create','18EdQzRL','toString','UserService','../config/database','__importDefault','update','createUser','11870icjoGh','findUnique','usdcPolygonWallet','map','createdAt','gateways','merchantUrl','shop','getUserById','33438UfaJrE','fullName','username','name','7385oViToq','updateUser','6miXblr','stringify','randomBytes','deleteUser','usdtTrcWallet','crypto','findMany','default','getAllUsers','__esModule','publicKey','4GKwPDd','hash','162677JszcpX','Telegram\x20username\x20already\x20exists','wallets','password','telegram','hex','parse','5609508dDVjbI','generateApiKeys','usdtPolygonWallet','telegramId','1350hwtRwc','812840AknDDT','paymentGateways','gatewaySettings','shopUrl'];a50_0x1eb0=function(){return _0x8974f4;};return a50_0x1eb0();}var __importDefault=this&&this[a50_0x29fd06(0xcd)]||function(_0x16e6bb){return _0x16e6bb&&_0x16e6bb['__esModule']?_0x16e6bb:{'default':_0x16e6bb};};Object['defineProperty'](exports,a50_0x29fd06(0xe8),{'value':!![]}),exports[a50_0x29fd06(0xcb)]=void 0x0;function a50_0x215f(_0x4c02ed,_0xcec3fd){const _0x1eb01d=a50_0x1eb0();return a50_0x215f=function(_0x215f82,_0x249e67){_0x215f82=_0x215f82-0xbb;let _0x1167c4=_0x1eb01d[_0x215f82];return _0x1167c4;},a50_0x215f(_0x4c02ed,_0xcec3fd);}const bcryptjs_1=__importDefault(require('bcryptjs')),crypto_1=__importDefault(require(a50_0x29fd06(0xe4))),database_1=__importDefault(require(a50_0x29fd06(0xcc)));class UserService{[a50_0x29fd06(0xf4)](){const _0x23d0a7=a50_0x29fd06,_0x3faaad='pk_'+crypto_1[_0x23d0a7(0xe6)][_0x23d0a7(0xe1)](0x20)[_0x23d0a7(0xca)](_0x23d0a7(0xf1)),_0x4162d4='sk_'+crypto_1[_0x23d0a7(0xe6)]['randomBytes'](0x20)[_0x23d0a7(0xca)]('hex');return{'publicKey':_0x3faaad,'secretKey':_0x4162d4};}async[a50_0x29fd06(0xcf)](_0x42af74){const _0xc38007=a50_0x29fd06,{fullName:_0x2ec0c,username:_0x28163b,password:_0xd64048,telegramId:_0x11bb2c,merchantUrl:_0x29d187,gateways:_0x4e96c4,gatewaySettings:_0x4dd4c1,wallets:_0x1090ac}=_0x42af74,_0x4ef0ff=await database_1[_0xc38007(0xe6)][_0xc38007(0xd7)][_0xc38007(0xd1)]({'where':{'username':_0x28163b}});if(_0x4ef0ff)throw new Error('Username\x20already\x20exists');if(_0x11bb2c){const _0x23a540=await database_1['default']['shop'][_0xc38007(0xd1)]({'where':{'telegram':_0x11bb2c}});if(_0x23a540)throw new Error(_0xc38007(0xed));}const _0x19b6f5=await bcryptjs_1[_0xc38007(0xe6)][_0xc38007(0xeb)](_0xd64048,0xc),{publicKey:_0x55be35,secretKey:_0x5cb5fb}=this['generateApiKeys'](),_0x7db825=await database_1[_0xc38007(0xe6)]['shop'][_0xc38007(0xc8)]({'data':{'name':_0x2ec0c,'username':_0x28163b,'password':_0x19b6f5,'telegram':_0x11bb2c,'shopUrl':_0x29d187,'paymentGateways':_0x4e96c4?JSON[_0xc38007(0xe0)](_0x4e96c4):null,'gatewaySettings':_0x4dd4c1?JSON[_0xc38007(0xe0)](_0x4dd4c1):null,'usdtPolygonWallet':_0x1090ac?.[_0xc38007(0xbb)]||null,'usdtTrcWallet':_0x1090ac?.[_0xc38007(0xe3)]||null,'usdtErcWallet':_0x1090ac?.[_0xc38007(0xc6)]||null,'usdcPolygonWallet':_0x1090ac?.[_0xc38007(0xd2)]||null,'publicKey':_0x55be35,'secretKey':_0x5cb5fb,'status':_0xc38007(0xc7)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x7db825['id'],'fullName':_0x7db825[_0xc38007(0xdc)],'username':_0x7db825[_0xc38007(0xdb)],'telegramId':_0x7db825['telegram'],'merchantUrl':_0x7db825[_0xc38007(0xc1)],'gateways':_0x7db825[_0xc38007(0xbf)]?JSON[_0xc38007(0xf2)](_0x7db825[_0xc38007(0xbf)]):null,'gatewaySettings':_0x7db825[_0xc38007(0xc0)]?JSON[_0xc38007(0xf2)](_0x7db825[_0xc38007(0xc0)]):null,'publicKey':_0x7db825[_0xc38007(0xe9)],'wallets':{'usdtPolygonWallet':_0x7db825['usdtPolygonWallet'],'usdtTrcWallet':_0x7db825[_0xc38007(0xe3)],'usdtErcWallet':_0x7db825[_0xc38007(0xc6)],'usdcPolygonWallet':_0x7db825[_0xc38007(0xd2)]},'status':_0x7db825[_0xc38007(0xc2)],'createdAt':_0x7db825[_0xc38007(0xd4)]};}async[a50_0x29fd06(0xe7)](){const _0x21ebd3=a50_0x29fd06,_0x3a1e4d=await database_1[_0x21ebd3(0xe6)][_0x21ebd3(0xd7)][_0x21ebd3(0xe5)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x21ebd3(0xc4)}});return _0x3a1e4d[_0x21ebd3(0xd3)](_0x5842ce=>({'id':_0x5842ce['id'],'fullName':_0x5842ce[_0x21ebd3(0xdc)],'username':_0x5842ce[_0x21ebd3(0xdb)],'telegramId':_0x5842ce[_0x21ebd3(0xf0)],'merchantUrl':_0x5842ce[_0x21ebd3(0xc1)],'gateways':_0x5842ce['paymentGateways']?JSON[_0x21ebd3(0xf2)](_0x5842ce[_0x21ebd3(0xbf)]):null,'gatewaySettings':_0x5842ce[_0x21ebd3(0xc0)]?JSON['parse'](_0x5842ce['gatewaySettings']):null,'publicKey':_0x5842ce[_0x21ebd3(0xe9)],'wallets':{'usdtPolygonWallet':_0x5842ce['usdtPolygonWallet'],'usdtTrcWallet':_0x5842ce[_0x21ebd3(0xe3)],'usdtErcWallet':_0x5842ce['usdtErcWallet'],'usdcPolygonWallet':_0x5842ce[_0x21ebd3(0xd2)]},'status':_0x5842ce['status'],'createdAt':_0x5842ce['createdAt']}));}async[a50_0x29fd06(0xd8)](_0x2d07d7){const _0x296e1a=a50_0x29fd06,_0x4f6ed9=await database_1[_0x296e1a(0xe6)][_0x296e1a(0xd7)]['findUnique']({'where':{'id':_0x2d07d7},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x4f6ed9)return null;return{'id':_0x4f6ed9['id'],'fullName':_0x4f6ed9[_0x296e1a(0xdc)],'username':_0x4f6ed9[_0x296e1a(0xdb)],'telegramId':_0x4f6ed9[_0x296e1a(0xf0)],'merchantUrl':_0x4f6ed9[_0x296e1a(0xc1)],'gateways':_0x4f6ed9[_0x296e1a(0xbf)]?JSON['parse'](_0x4f6ed9[_0x296e1a(0xbf)]):null,'gatewaySettings':_0x4f6ed9['gatewaySettings']?JSON[_0x296e1a(0xf2)](_0x4f6ed9['gatewaySettings']):null,'publicKey':_0x4f6ed9[_0x296e1a(0xe9)],'wallets':{'usdtPolygonWallet':_0x4f6ed9[_0x296e1a(0xbb)],'usdtTrcWallet':_0x4f6ed9[_0x296e1a(0xe3)],'usdtErcWallet':_0x4f6ed9[_0x296e1a(0xc6)],'usdcPolygonWallet':_0x4f6ed9[_0x296e1a(0xd2)]},'status':_0x4f6ed9[_0x296e1a(0xc2)],'createdAt':_0x4f6ed9[_0x296e1a(0xd4)]};}async[a50_0x29fd06(0xde)](_0x145ea6,_0x3ffe3d){const _0x17fbac=a50_0x29fd06,_0x59e8fe={..._0x3ffe3d};_0x3ffe3d[_0x17fbac(0xef)]&&(_0x59e8fe[_0x17fbac(0xef)]=await bcryptjs_1[_0x17fbac(0xe6)]['hash'](_0x3ffe3d[_0x17fbac(0xef)],0xc));_0x3ffe3d[_0x17fbac(0xda)]&&(_0x59e8fe['name']=_0x3ffe3d[_0x17fbac(0xda)],delete _0x59e8fe['fullName']);_0x3ffe3d[_0x17fbac(0xbc)]&&(_0x59e8fe['telegram']=_0x3ffe3d[_0x17fbac(0xbc)],delete _0x59e8fe[_0x17fbac(0xbc)]);_0x3ffe3d['merchantUrl']&&(_0x59e8fe['shopUrl']=_0x3ffe3d[_0x17fbac(0xd6)],delete _0x59e8fe[_0x17fbac(0xd6)]);_0x3ffe3d[_0x17fbac(0xd5)]&&(_0x59e8fe[_0x17fbac(0xbf)]=JSON[_0x17fbac(0xe0)](_0x3ffe3d[_0x17fbac(0xd5)]),delete _0x59e8fe['gateways']);_0x3ffe3d[_0x17fbac(0xc0)]&&(_0x59e8fe[_0x17fbac(0xc0)]=JSON[_0x17fbac(0xe0)](_0x3ffe3d[_0x17fbac(0xc0)]),delete _0x59e8fe['gatewaySettings']);_0x3ffe3d['wallets']&&(_0x3ffe3d[_0x17fbac(0xee)]['usdtPolygonWallet']!==undefined&&(_0x59e8fe[_0x17fbac(0xbb)]=_0x3ffe3d[_0x17fbac(0xee)][_0x17fbac(0xbb)]||null),_0x3ffe3d[_0x17fbac(0xee)][_0x17fbac(0xe3)]!==undefined&&(_0x59e8fe[_0x17fbac(0xe3)]=_0x3ffe3d[_0x17fbac(0xee)][_0x17fbac(0xe3)]||null),_0x3ffe3d[_0x17fbac(0xee)]['usdtErcWallet']!==undefined&&(_0x59e8fe[_0x17fbac(0xc6)]=_0x3ffe3d[_0x17fbac(0xee)][_0x17fbac(0xc6)]||null),_0x3ffe3d[_0x17fbac(0xee)]['usdcPolygonWallet']!==undefined&&(_0x59e8fe[_0x17fbac(0xd2)]=_0x3ffe3d[_0x17fbac(0xee)][_0x17fbac(0xd2)]||null),delete _0x59e8fe[_0x17fbac(0xee)]);const _0x411cfd=await database_1['default'][_0x17fbac(0xd7)][_0x17fbac(0xce)]({'where':{'id':_0x145ea6},'data':_0x59e8fe,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x411cfd['id'],'fullName':_0x411cfd['name'],'username':_0x411cfd['username'],'telegramId':_0x411cfd[_0x17fbac(0xf0)],'merchantUrl':_0x411cfd[_0x17fbac(0xc1)],'gateways':_0x411cfd[_0x17fbac(0xbf)]?JSON[_0x17fbac(0xf2)](_0x411cfd[_0x17fbac(0xbf)]):null,'gatewaySettings':_0x411cfd['gatewaySettings']?JSON['parse'](_0x411cfd[_0x17fbac(0xc0)]):null,'publicKey':_0x411cfd[_0x17fbac(0xe9)],'wallets':{'usdtPolygonWallet':_0x411cfd['usdtPolygonWallet'],'usdtTrcWallet':_0x411cfd[_0x17fbac(0xe3)],'usdtErcWallet':_0x411cfd[_0x17fbac(0xc6)],'usdcPolygonWallet':_0x411cfd[_0x17fbac(0xd2)]},'status':_0x411cfd[_0x17fbac(0xc2)],'createdAt':_0x411cfd[_0x17fbac(0xd4)]};}async[a50_0x29fd06(0xe2)](_0x4a5bce){const _0x16c32c=a50_0x29fd06;await database_1[_0x16c32c(0xe6)][_0x16c32c(0xd7)]['delete']({'where':{'id':_0x4a5bce}});}}exports[a50_0x29fd06(0xcb)]=UserService;