'use strict';const a68_0x8cca24=a68_0x5625;(function(_0x2bde6f,_0x5bf9ee){const _0x2d52cd=a68_0x5625,_0x3a7f32=_0x2bde6f();while(!![]){try{const _0x987b58=parseInt(_0x2d52cd(0x12b))/0x1*(parseInt(_0x2d52cd(0x144))/0x2)+-parseInt(_0x2d52cd(0x140))/0x3+parseInt(_0x2d52cd(0x12f))/0x4+parseInt(_0x2d52cd(0x127))/0x5+-parseInt(_0x2d52cd(0x111))/0x6+-parseInt(_0x2d52cd(0x120))/0x7*(-parseInt(_0x2d52cd(0x117))/0x8)+parseInt(_0x2d52cd(0x145))/0x9*(-parseInt(_0x2d52cd(0x126))/0xa);if(_0x987b58===_0x5bf9ee)break;else _0x3a7f32['push'](_0x3a7f32['shift']());}catch(_0x2be3a2){_0x3a7f32['push'](_0x3a7f32['shift']());}}}(a68_0x496b,0x7d2e5));function a68_0x5625(_0x201ea1,_0x4b4da6){const _0x496b80=a68_0x496b();return a68_0x5625=function(_0x5625a8,_0x45d094){_0x5625a8=_0x5625a8-0x111;let _0x6704d5=_0x496b80[_0x5625a8];return _0x6704d5;},a68_0x5625(_0x201ea1,_0x4b4da6);}var __importDefault=this&&this[a68_0x8cca24(0x13c)]||function(_0x4f0b19){const _0x130c01=a68_0x8cca24;return _0x4f0b19&&_0x4f0b19[_0x130c01(0x146)]?_0x4f0b19:{'default':_0x4f0b19};};Object[a68_0x8cca24(0x114)](exports,a68_0x8cca24(0x146),{'value':!![]}),exports[a68_0x8cca24(0x116)]=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),crypto_1=__importDefault(require(a68_0x8cca24(0x143))),database_1=__importDefault(require('../config/database'));function a68_0x496b(){const _0x109dc5=['map','password','updateUser','findMany','publicKey','paymentGateways','1571710jETAVn','createdAt','shop','toString','gatewaySettings','usdtPolygonWallet','52670HxPipM','633835YMuFFB','parse','hash','name','7IYeuBy','randomBytes','hex','Username\x20already\x20exists','1935312NOKqlG','usdcPolygonWallet','usdtErcWallet','findUnique','shopUrl','merchantUrl','status','fullName','default','getUserById','username','generateApiKeys','getAllUsers','__importDefault','update','Telegram\x20username\x20already\x20exists','stringify','238533LXvaxL','telegram','wallets','crypto','121318AtkRHy','1305dQjlqn','__esModule','2116986nPhJPc','telegramId','desc','defineProperty','sk_','UserService','24ANfgOC','gateways','usdtTrcWallet'];a68_0x496b=function(){return _0x109dc5;};return a68_0x496b();}class UserService{[a68_0x8cca24(0x13a)](){const _0x9c2fe5=a68_0x8cca24,_0x28b4f8='pk_'+crypto_1[_0x9c2fe5(0x137)][_0x9c2fe5(0x12c)](0x20)[_0x9c2fe5(0x123)](_0x9c2fe5(0x12d)),_0x4ee2d0=_0x9c2fe5(0x115)+crypto_1['default']['randomBytes'](0x20)[_0x9c2fe5(0x123)]('hex');return{'publicKey':_0x28b4f8,'secretKey':_0x4ee2d0};}async['createUser'](_0x2c0ce0){const _0x3ecce1=a68_0x8cca24,{fullName:_0x48261a,username:_0x2cf850,password:_0xbd2dcb,telegramId:_0x3c0dad,merchantUrl:_0x1f7b87,gateways:_0x2241f6,gatewaySettings:_0x23e432,wallets:_0x19b084}=_0x2c0ce0,_0x3d4dab=await database_1[_0x3ecce1(0x137)]['shop'][_0x3ecce1(0x132)]({'where':{'username':_0x2cf850}});if(_0x3d4dab)throw new Error(_0x3ecce1(0x12e));if(_0x3c0dad){const _0x2c05b8=await database_1[_0x3ecce1(0x137)][_0x3ecce1(0x122)][_0x3ecce1(0x132)]({'where':{'telegram':_0x3c0dad}});if(_0x2c05b8)throw new Error(_0x3ecce1(0x13e));}const _0x3f39c4=await bcryptjs_1[_0x3ecce1(0x137)][_0x3ecce1(0x129)](_0xbd2dcb,0xc),{publicKey:_0x4ebae2,secretKey:_0x568be0}=this[_0x3ecce1(0x13a)](),_0x1bcfff=await database_1['default']['shop']['create']({'data':{'name':_0x48261a,'username':_0x2cf850,'password':_0x3f39c4,'telegram':_0x3c0dad,'shopUrl':_0x1f7b87,'paymentGateways':_0x2241f6?JSON[_0x3ecce1(0x13f)](_0x2241f6):null,'gatewaySettings':_0x23e432?JSON[_0x3ecce1(0x13f)](_0x23e432):null,'usdtPolygonWallet':_0x19b084?.[_0x3ecce1(0x125)]||null,'usdtTrcWallet':_0x19b084?.[_0x3ecce1(0x119)]||null,'usdtErcWallet':_0x19b084?.[_0x3ecce1(0x131)]||null,'usdcPolygonWallet':_0x19b084?.[_0x3ecce1(0x130)]||null,'publicKey':_0x4ebae2,'secretKey':_0x568be0,'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x1bcfff['id'],'fullName':_0x1bcfff['name'],'username':_0x1bcfff[_0x3ecce1(0x139)],'telegramId':_0x1bcfff[_0x3ecce1(0x141)],'merchantUrl':_0x1bcfff['shopUrl'],'gateways':_0x1bcfff[_0x3ecce1(0x11f)]?JSON[_0x3ecce1(0x128)](_0x1bcfff['paymentGateways']):null,'gatewaySettings':_0x1bcfff[_0x3ecce1(0x124)]?JSON[_0x3ecce1(0x128)](_0x1bcfff['gatewaySettings']):null,'publicKey':_0x1bcfff[_0x3ecce1(0x11e)],'wallets':{'usdtPolygonWallet':_0x1bcfff[_0x3ecce1(0x125)],'usdtTrcWallet':_0x1bcfff[_0x3ecce1(0x119)],'usdtErcWallet':_0x1bcfff['usdtErcWallet'],'usdcPolygonWallet':_0x1bcfff[_0x3ecce1(0x130)]},'status':_0x1bcfff[_0x3ecce1(0x135)],'createdAt':_0x1bcfff[_0x3ecce1(0x121)]};}async[a68_0x8cca24(0x13b)](){const _0x3a9194=a68_0x8cca24,_0x54db72=await database_1[_0x3a9194(0x137)][_0x3a9194(0x122)][_0x3a9194(0x11d)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x3a9194(0x113)}});return _0x54db72[_0x3a9194(0x11a)](_0x68d5b9=>({'id':_0x68d5b9['id'],'fullName':_0x68d5b9['name'],'username':_0x68d5b9[_0x3a9194(0x139)],'telegramId':_0x68d5b9['telegram'],'merchantUrl':_0x68d5b9['shopUrl'],'gateways':_0x68d5b9[_0x3a9194(0x11f)]?JSON['parse'](_0x68d5b9[_0x3a9194(0x11f)]):null,'gatewaySettings':_0x68d5b9['gatewaySettings']?JSON[_0x3a9194(0x128)](_0x68d5b9[_0x3a9194(0x124)]):null,'publicKey':_0x68d5b9[_0x3a9194(0x11e)],'wallets':{'usdtPolygonWallet':_0x68d5b9[_0x3a9194(0x125)],'usdtTrcWallet':_0x68d5b9[_0x3a9194(0x119)],'usdtErcWallet':_0x68d5b9[_0x3a9194(0x131)],'usdcPolygonWallet':_0x68d5b9[_0x3a9194(0x130)]},'status':_0x68d5b9[_0x3a9194(0x135)],'createdAt':_0x68d5b9[_0x3a9194(0x121)]}));}async[a68_0x8cca24(0x138)](_0x17a499){const _0x1751bb=a68_0x8cca24,_0x4f3ccc=await database_1[_0x1751bb(0x137)][_0x1751bb(0x122)][_0x1751bb(0x132)]({'where':{'id':_0x17a499},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x4f3ccc)return null;return{'id':_0x4f3ccc['id'],'fullName':_0x4f3ccc[_0x1751bb(0x12a)],'username':_0x4f3ccc[_0x1751bb(0x139)],'telegramId':_0x4f3ccc[_0x1751bb(0x141)],'merchantUrl':_0x4f3ccc['shopUrl'],'gateways':_0x4f3ccc[_0x1751bb(0x11f)]?JSON[_0x1751bb(0x128)](_0x4f3ccc[_0x1751bb(0x11f)]):null,'gatewaySettings':_0x4f3ccc[_0x1751bb(0x124)]?JSON[_0x1751bb(0x128)](_0x4f3ccc[_0x1751bb(0x124)]):null,'publicKey':_0x4f3ccc[_0x1751bb(0x11e)],'wallets':{'usdtPolygonWallet':_0x4f3ccc[_0x1751bb(0x125)],'usdtTrcWallet':_0x4f3ccc[_0x1751bb(0x119)],'usdtErcWallet':_0x4f3ccc['usdtErcWallet'],'usdcPolygonWallet':_0x4f3ccc[_0x1751bb(0x130)]},'status':_0x4f3ccc[_0x1751bb(0x135)],'createdAt':_0x4f3ccc[_0x1751bb(0x121)]};}async[a68_0x8cca24(0x11c)](_0x54ffdb,_0x17457f){const _0x1929e3=a68_0x8cca24,_0x52fe65={..._0x17457f};_0x17457f[_0x1929e3(0x11b)]&&(_0x52fe65[_0x1929e3(0x11b)]=await bcryptjs_1['default'][_0x1929e3(0x129)](_0x17457f['password'],0xc));_0x17457f[_0x1929e3(0x136)]&&(_0x52fe65[_0x1929e3(0x12a)]=_0x17457f[_0x1929e3(0x136)],delete _0x52fe65[_0x1929e3(0x136)]);_0x17457f[_0x1929e3(0x112)]&&(_0x52fe65['telegram']=_0x17457f[_0x1929e3(0x112)],delete _0x52fe65[_0x1929e3(0x112)]);_0x17457f['merchantUrl']&&(_0x52fe65[_0x1929e3(0x133)]=_0x17457f[_0x1929e3(0x134)],delete _0x52fe65['merchantUrl']);_0x17457f[_0x1929e3(0x118)]&&(_0x52fe65[_0x1929e3(0x11f)]=JSON[_0x1929e3(0x13f)](_0x17457f[_0x1929e3(0x118)]),delete _0x52fe65['gateways']);_0x17457f[_0x1929e3(0x124)]&&(_0x52fe65['gatewaySettings']=JSON[_0x1929e3(0x13f)](_0x17457f['gatewaySettings']),delete _0x52fe65[_0x1929e3(0x124)]);_0x17457f[_0x1929e3(0x142)]&&(_0x17457f[_0x1929e3(0x142)][_0x1929e3(0x125)]!==undefined&&(_0x52fe65['usdtPolygonWallet']=_0x17457f['wallets'][_0x1929e3(0x125)]||null),_0x17457f['wallets'][_0x1929e3(0x119)]!==undefined&&(_0x52fe65[_0x1929e3(0x119)]=_0x17457f[_0x1929e3(0x142)]['usdtTrcWallet']||null),_0x17457f[_0x1929e3(0x142)][_0x1929e3(0x131)]!==undefined&&(_0x52fe65['usdtErcWallet']=_0x17457f[_0x1929e3(0x142)]['usdtErcWallet']||null),_0x17457f[_0x1929e3(0x142)][_0x1929e3(0x130)]!==undefined&&(_0x52fe65[_0x1929e3(0x130)]=_0x17457f[_0x1929e3(0x142)]['usdcPolygonWallet']||null),delete _0x52fe65[_0x1929e3(0x142)]);const _0x3cf526=await database_1[_0x1929e3(0x137)][_0x1929e3(0x122)][_0x1929e3(0x13d)]({'where':{'id':_0x54ffdb},'data':_0x52fe65,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x3cf526['id'],'fullName':_0x3cf526[_0x1929e3(0x12a)],'username':_0x3cf526['username'],'telegramId':_0x3cf526[_0x1929e3(0x141)],'merchantUrl':_0x3cf526[_0x1929e3(0x133)],'gateways':_0x3cf526['paymentGateways']?JSON[_0x1929e3(0x128)](_0x3cf526[_0x1929e3(0x11f)]):null,'gatewaySettings':_0x3cf526[_0x1929e3(0x124)]?JSON[_0x1929e3(0x128)](_0x3cf526[_0x1929e3(0x124)]):null,'publicKey':_0x3cf526['publicKey'],'wallets':{'usdtPolygonWallet':_0x3cf526['usdtPolygonWallet'],'usdtTrcWallet':_0x3cf526[_0x1929e3(0x119)],'usdtErcWallet':_0x3cf526['usdtErcWallet'],'usdcPolygonWallet':_0x3cf526['usdcPolygonWallet']},'status':_0x3cf526[_0x1929e3(0x135)],'createdAt':_0x3cf526[_0x1929e3(0x121)]};}async['deleteUser'](_0x53ab3f){const _0x4676fd=a68_0x8cca24;await database_1[_0x4676fd(0x137)][_0x4676fd(0x122)]['delete']({'where':{'id':_0x53ab3f}});}}exports[a68_0x8cca24(0x116)]=UserService;