'use strict';function a60_0x4c3e(){const _0x55ee95=['toString','usdtTrcWallet','defineProperty','262364pEOzSt','bcryptjs','usdtErcWallet','getAllUsers','sk_','updateUser','UserService','8969PJkhvo','__importDefault','14705199kBsKRk','status','createUser','ACTIVE','parse','password','gateways','shopUrl','name','publicKey','getUserById','randomBytes','usdtPolygonWallet','wallets','generateApiKeys','deleteUser','telegramId','Username\x20already\x20exists','5piJsjR','shop','907755BOiHgH','merchantUrl','hex','findMany','paymentGateways','fullName','3384762uiJdOJ','delete','74ykXnem','update','hash','2818560GFCamD','default','telegram','map','gatewaySettings','username','../config/database','stringify','findUnique','crypto','createdAt','__esModule','desc','usdcPolygonWallet','2209935uvpfKn'];a60_0x4c3e=function(){return _0x55ee95;};return a60_0x4c3e();}const a60_0x569520=a60_0x5424;function a60_0x5424(_0x34155a,_0x5b9269){const _0x4c3ec4=a60_0x4c3e();return a60_0x5424=function(_0x5424d7,_0x134ff7){_0x5424d7=_0x5424d7-0x156;let _0x480248=_0x4c3ec4[_0x5424d7];return _0x480248;},a60_0x5424(_0x34155a,_0x5b9269);}(function(_0x256b6d,_0x2a5e63){const _0x6162c6=a60_0x5424,_0x12cb3b=_0x256b6d();while(!![]){try{const _0x224612=-parseInt(_0x6162c6(0x165))/0x1*(parseInt(_0x6162c6(0x183))/0x2)+-parseInt(_0x6162c6(0x17b))/0x3+-parseInt(_0x6162c6(0x15e))/0x4+-parseInt(_0x6162c6(0x179))/0x5*(parseInt(_0x6162c6(0x181))/0x6)+-parseInt(_0x6162c6(0x15a))/0x7+parseInt(_0x6162c6(0x186))/0x8+parseInt(_0x6162c6(0x167))/0x9;if(_0x224612===_0x2a5e63)break;else _0x12cb3b['push'](_0x12cb3b['shift']());}catch(_0x2fa129){_0x12cb3b['push'](_0x12cb3b['shift']());}}}(a60_0x4c3e,0x63362));var __importDefault=this&&this[a60_0x569520(0x166)]||function(_0x38fddf){const _0x5d838d=a60_0x569520;return _0x38fddf&&_0x38fddf[_0x5d838d(0x157)]?_0x38fddf:{'default':_0x38fddf};};Object[a60_0x569520(0x15d)](exports,a60_0x569520(0x157),{'value':!![]}),exports[a60_0x569520(0x164)]=void 0x0;const bcryptjs_1=__importDefault(require(a60_0x569520(0x15f))),crypto_1=__importDefault(require(a60_0x569520(0x18f))),database_1=__importDefault(require(a60_0x569520(0x18c)));class UserService{[a60_0x569520(0x175)](){const _0x16799f=a60_0x569520,_0x5d8a0b='pk_'+crypto_1[_0x16799f(0x187)]['randomBytes'](0x20)[_0x16799f(0x15b)](_0x16799f(0x17d)),_0x42c942=_0x16799f(0x162)+crypto_1[_0x16799f(0x187)][_0x16799f(0x172)](0x20)[_0x16799f(0x15b)](_0x16799f(0x17d));return{'publicKey':_0x5d8a0b,'secretKey':_0x42c942};}async[a60_0x569520(0x169)](_0xc44f45){const _0x41d2ea=a60_0x569520,{fullName:_0x16f615,username:_0x1ee339,password:_0x2d6c40,telegramId:_0x3bc6ce,merchantUrl:_0x15a879,gateways:_0x649270,gatewaySettings:_0x49bb5e,wallets:_0xd49c8a}=_0xc44f45,_0x5eba01=await database_1[_0x41d2ea(0x187)][_0x41d2ea(0x17a)][_0x41d2ea(0x18e)]({'where':{'username':_0x1ee339}});if(_0x5eba01)throw new Error(_0x41d2ea(0x178));if(_0x3bc6ce){const _0x56c5db=await database_1[_0x41d2ea(0x187)][_0x41d2ea(0x17a)][_0x41d2ea(0x18e)]({'where':{'telegram':_0x3bc6ce}});if(_0x56c5db)throw new Error('Telegram\x20username\x20already\x20exists');}const _0x4fe330=await bcryptjs_1[_0x41d2ea(0x187)][_0x41d2ea(0x185)](_0x2d6c40,0xc),{publicKey:_0x3c7394,secretKey:_0x52a6e8}=this[_0x41d2ea(0x175)](),_0x586946=await database_1[_0x41d2ea(0x187)]['shop']['create']({'data':{'name':_0x16f615,'username':_0x1ee339,'password':_0x4fe330,'telegram':_0x3bc6ce,'shopUrl':_0x15a879,'paymentGateways':_0x649270?JSON[_0x41d2ea(0x18d)](_0x649270):null,'gatewaySettings':_0x49bb5e?JSON['stringify'](_0x49bb5e):null,'usdtPolygonWallet':_0xd49c8a?.[_0x41d2ea(0x173)]||null,'usdtTrcWallet':_0xd49c8a?.[_0x41d2ea(0x15c)]||null,'usdtErcWallet':_0xd49c8a?.[_0x41d2ea(0x160)]||null,'usdcPolygonWallet':_0xd49c8a?.[_0x41d2ea(0x159)]||null,'publicKey':_0x3c7394,'secretKey':_0x52a6e8,'status':_0x41d2ea(0x16a)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x586946['id'],'fullName':_0x586946[_0x41d2ea(0x16f)],'username':_0x586946[_0x41d2ea(0x18b)],'telegramId':_0x586946[_0x41d2ea(0x188)],'merchantUrl':_0x586946[_0x41d2ea(0x16e)],'gateways':_0x586946[_0x41d2ea(0x17f)]?JSON[_0x41d2ea(0x16b)](_0x586946[_0x41d2ea(0x17f)]):null,'gatewaySettings':_0x586946[_0x41d2ea(0x18a)]?JSON[_0x41d2ea(0x16b)](_0x586946['gatewaySettings']):null,'publicKey':_0x586946[_0x41d2ea(0x170)],'wallets':{'usdtPolygonWallet':_0x586946[_0x41d2ea(0x173)],'usdtTrcWallet':_0x586946[_0x41d2ea(0x15c)],'usdtErcWallet':_0x586946['usdtErcWallet'],'usdcPolygonWallet':_0x586946['usdcPolygonWallet']},'status':_0x586946[_0x41d2ea(0x168)],'createdAt':_0x586946[_0x41d2ea(0x156)]};}async[a60_0x569520(0x161)](){const _0xe74cc1=a60_0x569520,_0x2a76e0=await database_1[_0xe74cc1(0x187)][_0xe74cc1(0x17a)][_0xe74cc1(0x17e)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0xe74cc1(0x158)}});return _0x2a76e0[_0xe74cc1(0x189)](_0x591e24=>({'id':_0x591e24['id'],'fullName':_0x591e24[_0xe74cc1(0x16f)],'username':_0x591e24[_0xe74cc1(0x18b)],'telegramId':_0x591e24[_0xe74cc1(0x188)],'merchantUrl':_0x591e24[_0xe74cc1(0x16e)],'gateways':_0x591e24[_0xe74cc1(0x17f)]?JSON[_0xe74cc1(0x16b)](_0x591e24[_0xe74cc1(0x17f)]):null,'gatewaySettings':_0x591e24[_0xe74cc1(0x18a)]?JSON[_0xe74cc1(0x16b)](_0x591e24[_0xe74cc1(0x18a)]):null,'publicKey':_0x591e24[_0xe74cc1(0x170)],'wallets':{'usdtPolygonWallet':_0x591e24[_0xe74cc1(0x173)],'usdtTrcWallet':_0x591e24[_0xe74cc1(0x15c)],'usdtErcWallet':_0x591e24[_0xe74cc1(0x160)],'usdcPolygonWallet':_0x591e24['usdcPolygonWallet']},'status':_0x591e24[_0xe74cc1(0x168)],'createdAt':_0x591e24['createdAt']}));}async[a60_0x569520(0x171)](_0x12fc1b){const _0x1e5640=a60_0x569520,_0x2b60ad=await database_1[_0x1e5640(0x187)][_0x1e5640(0x17a)][_0x1e5640(0x18e)]({'where':{'id':_0x12fc1b},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x2b60ad)return null;return{'id':_0x2b60ad['id'],'fullName':_0x2b60ad[_0x1e5640(0x16f)],'username':_0x2b60ad['username'],'telegramId':_0x2b60ad['telegram'],'merchantUrl':_0x2b60ad[_0x1e5640(0x16e)],'gateways':_0x2b60ad[_0x1e5640(0x17f)]?JSON[_0x1e5640(0x16b)](_0x2b60ad['paymentGateways']):null,'gatewaySettings':_0x2b60ad[_0x1e5640(0x18a)]?JSON[_0x1e5640(0x16b)](_0x2b60ad['gatewaySettings']):null,'publicKey':_0x2b60ad[_0x1e5640(0x170)],'wallets':{'usdtPolygonWallet':_0x2b60ad[_0x1e5640(0x173)],'usdtTrcWallet':_0x2b60ad[_0x1e5640(0x15c)],'usdtErcWallet':_0x2b60ad[_0x1e5640(0x160)],'usdcPolygonWallet':_0x2b60ad['usdcPolygonWallet']},'status':_0x2b60ad['status'],'createdAt':_0x2b60ad[_0x1e5640(0x156)]};}async[a60_0x569520(0x163)](_0x183074,_0x36e4fa){const _0xb9338d=a60_0x569520,_0x3501c4={..._0x36e4fa};_0x36e4fa[_0xb9338d(0x16c)]&&(_0x3501c4['password']=await bcryptjs_1['default'][_0xb9338d(0x185)](_0x36e4fa[_0xb9338d(0x16c)],0xc));_0x36e4fa[_0xb9338d(0x180)]&&(_0x3501c4['name']=_0x36e4fa['fullName'],delete _0x3501c4[_0xb9338d(0x180)]);_0x36e4fa['telegramId']&&(_0x3501c4[_0xb9338d(0x188)]=_0x36e4fa[_0xb9338d(0x177)],delete _0x3501c4[_0xb9338d(0x177)]);_0x36e4fa[_0xb9338d(0x17c)]&&(_0x3501c4['shopUrl']=_0x36e4fa[_0xb9338d(0x17c)],delete _0x3501c4[_0xb9338d(0x17c)]);_0x36e4fa[_0xb9338d(0x16d)]&&(_0x3501c4['paymentGateways']=JSON[_0xb9338d(0x18d)](_0x36e4fa[_0xb9338d(0x16d)]),delete _0x3501c4['gateways']);_0x36e4fa[_0xb9338d(0x18a)]&&(_0x3501c4[_0xb9338d(0x18a)]=JSON[_0xb9338d(0x18d)](_0x36e4fa[_0xb9338d(0x18a)]),delete _0x3501c4[_0xb9338d(0x18a)]);_0x36e4fa[_0xb9338d(0x174)]&&(_0x36e4fa[_0xb9338d(0x174)][_0xb9338d(0x173)]!==undefined&&(_0x3501c4[_0xb9338d(0x173)]=_0x36e4fa[_0xb9338d(0x174)][_0xb9338d(0x173)]||null),_0x36e4fa[_0xb9338d(0x174)]['usdtTrcWallet']!==undefined&&(_0x3501c4[_0xb9338d(0x15c)]=_0x36e4fa[_0xb9338d(0x174)]['usdtTrcWallet']||null),_0x36e4fa[_0xb9338d(0x174)][_0xb9338d(0x160)]!==undefined&&(_0x3501c4['usdtErcWallet']=_0x36e4fa[_0xb9338d(0x174)][_0xb9338d(0x160)]||null),_0x36e4fa[_0xb9338d(0x174)][_0xb9338d(0x159)]!==undefined&&(_0x3501c4[_0xb9338d(0x159)]=_0x36e4fa[_0xb9338d(0x174)][_0xb9338d(0x159)]||null),delete _0x3501c4[_0xb9338d(0x174)]);const _0xb34dfb=await database_1[_0xb9338d(0x187)][_0xb9338d(0x17a)][_0xb9338d(0x184)]({'where':{'id':_0x183074},'data':_0x3501c4,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0xb34dfb['id'],'fullName':_0xb34dfb[_0xb9338d(0x16f)],'username':_0xb34dfb[_0xb9338d(0x18b)],'telegramId':_0xb34dfb[_0xb9338d(0x188)],'merchantUrl':_0xb34dfb[_0xb9338d(0x16e)],'gateways':_0xb34dfb['paymentGateways']?JSON[_0xb9338d(0x16b)](_0xb34dfb[_0xb9338d(0x17f)]):null,'gatewaySettings':_0xb34dfb[_0xb9338d(0x18a)]?JSON['parse'](_0xb34dfb[_0xb9338d(0x18a)]):null,'publicKey':_0xb34dfb['publicKey'],'wallets':{'usdtPolygonWallet':_0xb34dfb[_0xb9338d(0x173)],'usdtTrcWallet':_0xb34dfb[_0xb9338d(0x15c)],'usdtErcWallet':_0xb34dfb[_0xb9338d(0x160)],'usdcPolygonWallet':_0xb34dfb['usdcPolygonWallet']},'status':_0xb34dfb[_0xb9338d(0x168)],'createdAt':_0xb34dfb[_0xb9338d(0x156)]};}async[a60_0x569520(0x176)](_0x24aae9){const _0x3e19a2=a60_0x569520;await database_1[_0x3e19a2(0x187)][_0x3e19a2(0x17a)][_0x3e19a2(0x182)]({'where':{'id':_0x24aae9}});}}exports[a60_0x569520(0x164)]=UserService;