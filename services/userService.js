'use strict';function a51_0x8f81(){const _0x271388=['deleteUser','pk_','createdAt','update','findUnique','usdtTrcWallet','gatewaySettings','status','desc','name','randomBytes','wallets','bcryptjs','paymentGateways','fullName','usdtErcWallet','664pVVsTv','42yvZIcJ','2280OoLfai','stringify','updateUser','merchantUrl','toString','password','getAllUsers','__esModule','2764358hrKjFi','10464kcTHWo','parse','486935aoJioj','telegram','shopUrl','2654932RNfPOd','defineProperty','generateApiKeys','23851729FIedSC','Username\x20already\x20exists','gateways','username','761709lGvaFr','usdcPolygonWallet','create','findMany','delete','publicKey','createUser','hex','default','usdtPolygonWallet','telegramId','17955lYBxXA','20zZFrYh','shop'];a51_0x8f81=function(){return _0x271388;};return a51_0x8f81();}const a51_0x3056c8=a51_0x2069;(function(_0x2a40e9,_0x57b621){const _0x2f570c=a51_0x2069,_0x1d47fa=_0x2a40e9();while(!![]){try{const _0xe74bf9=-parseInt(_0x2f570c(0x1bc))/0x1+-parseInt(_0x2f570c(0x1af))/0x2+-parseInt(_0x2f570c(0x1b0))/0x3*(parseInt(_0x2f570c(0x1a5))/0x4)+parseInt(_0x2f570c(0x1b2))/0x5*(-parseInt(_0x2f570c(0x1a6))/0x6)+parseInt(_0x2f570c(0x1b5))/0x7+parseInt(_0x2f570c(0x1a7))/0x8*(-parseInt(_0x2f570c(0x1c7))/0x9)+-parseInt(_0x2f570c(0x1c8))/0xa*(-parseInt(_0x2f570c(0x1b8))/0xb);if(_0xe74bf9===_0x57b621)break;else _0x1d47fa['push'](_0x1d47fa['shift']());}catch(_0x343a9c){_0x1d47fa['push'](_0x1d47fa['shift']());}}}(a51_0x8f81,0xb5576));var __importDefault=this&&this['__importDefault']||function(_0x56922a){const _0x17bf5c=a51_0x2069;return _0x56922a&&_0x56922a[_0x17bf5c(0x1ae)]?_0x56922a:{'default':_0x56922a};};Object[a51_0x3056c8(0x1b6)](exports,a51_0x3056c8(0x1ae),{'value':!![]}),exports['UserService']=void 0x0;const bcryptjs_1=__importDefault(require(a51_0x3056c8(0x1a1))),crypto_1=__importDefault(require('crypto')),database_1=__importDefault(require('../config/database'));class UserService{[a51_0x3056c8(0x1b7)](){const _0x270e60=a51_0x3056c8,_0x286265=_0x270e60(0x1cb)+crypto_1[_0x270e60(0x1c4)][_0x270e60(0x19f)](0x20)[_0x270e60(0x1ab)]('hex'),_0x570f69='sk_'+crypto_1[_0x270e60(0x1c4)][_0x270e60(0x19f)](0x20)[_0x270e60(0x1ab)](_0x270e60(0x1c3));return{'publicKey':_0x286265,'secretKey':_0x570f69};}async[a51_0x3056c8(0x1c2)](_0x2f1ea2){const _0x55b296=a51_0x3056c8,{fullName:_0x176082,username:_0x96a16a,password:_0x19eb5e,telegramId:_0x7a176a,merchantUrl:_0x127c65,gateways:_0x57e9d9,gatewaySettings:_0x3ca3d7,wallets:_0x130149}=_0x2f1ea2,_0x1c1131=await database_1[_0x55b296(0x1c4)][_0x55b296(0x1c9)][_0x55b296(0x199)]({'where':{'username':_0x96a16a}});if(_0x1c1131)throw new Error(_0x55b296(0x1b9));if(_0x7a176a){const _0x416012=await database_1[_0x55b296(0x1c4)][_0x55b296(0x1c9)]['findUnique']({'where':{'telegram':_0x7a176a}});if(_0x416012)throw new Error('Telegram\x20username\x20already\x20exists');}const _0xfc5d2=await bcryptjs_1[_0x55b296(0x1c4)]['hash'](_0x19eb5e,0xc),{publicKey:_0x257f04,secretKey:_0x46021a}=this['generateApiKeys'](),_0x4654e7=await database_1['default'][_0x55b296(0x1c9)][_0x55b296(0x1be)]({'data':{'name':_0x176082,'username':_0x96a16a,'password':_0xfc5d2,'telegram':_0x7a176a,'shopUrl':_0x127c65,'paymentGateways':_0x57e9d9?JSON[_0x55b296(0x1a8)](_0x57e9d9):null,'gatewaySettings':_0x3ca3d7?JSON['stringify'](_0x3ca3d7):null,'usdtPolygonWallet':_0x130149?.[_0x55b296(0x1c5)]||null,'usdtTrcWallet':_0x130149?.[_0x55b296(0x19a)]||null,'usdtErcWallet':_0x130149?.[_0x55b296(0x1a4)]||null,'usdcPolygonWallet':_0x130149?.[_0x55b296(0x1bd)]||null,'publicKey':_0x257f04,'secretKey':_0x46021a,'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x4654e7['id'],'fullName':_0x4654e7[_0x55b296(0x19e)],'username':_0x4654e7[_0x55b296(0x1bb)],'telegramId':_0x4654e7[_0x55b296(0x1b3)],'merchantUrl':_0x4654e7[_0x55b296(0x1b4)],'gateways':_0x4654e7['paymentGateways']?JSON[_0x55b296(0x1b1)](_0x4654e7[_0x55b296(0x1a2)]):null,'gatewaySettings':_0x4654e7['gatewaySettings']?JSON[_0x55b296(0x1b1)](_0x4654e7[_0x55b296(0x19b)]):null,'publicKey':_0x4654e7[_0x55b296(0x1c1)],'wallets':{'usdtPolygonWallet':_0x4654e7[_0x55b296(0x1c5)],'usdtTrcWallet':_0x4654e7[_0x55b296(0x19a)],'usdtErcWallet':_0x4654e7[_0x55b296(0x1a4)],'usdcPolygonWallet':_0x4654e7[_0x55b296(0x1bd)]},'status':_0x4654e7[_0x55b296(0x19c)],'createdAt':_0x4654e7['createdAt']};}async[a51_0x3056c8(0x1ad)](){const _0x29f717=a51_0x3056c8,_0x4c21f8=await database_1['default'][_0x29f717(0x1c9)][_0x29f717(0x1bf)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x29f717(0x19d)}});return _0x4c21f8['map'](_0x3a4f4b=>({'id':_0x3a4f4b['id'],'fullName':_0x3a4f4b[_0x29f717(0x19e)],'username':_0x3a4f4b[_0x29f717(0x1bb)],'telegramId':_0x3a4f4b[_0x29f717(0x1b3)],'merchantUrl':_0x3a4f4b[_0x29f717(0x1b4)],'gateways':_0x3a4f4b[_0x29f717(0x1a2)]?JSON[_0x29f717(0x1b1)](_0x3a4f4b[_0x29f717(0x1a2)]):null,'gatewaySettings':_0x3a4f4b[_0x29f717(0x19b)]?JSON[_0x29f717(0x1b1)](_0x3a4f4b[_0x29f717(0x19b)]):null,'publicKey':_0x3a4f4b['publicKey'],'wallets':{'usdtPolygonWallet':_0x3a4f4b['usdtPolygonWallet'],'usdtTrcWallet':_0x3a4f4b[_0x29f717(0x19a)],'usdtErcWallet':_0x3a4f4b[_0x29f717(0x1a4)],'usdcPolygonWallet':_0x3a4f4b[_0x29f717(0x1bd)]},'status':_0x3a4f4b['status'],'createdAt':_0x3a4f4b['createdAt']}));}async['getUserById'](_0x4a0baf){const _0x30dbcc=a51_0x3056c8,_0x22e3b4=await database_1[_0x30dbcc(0x1c4)]['shop'][_0x30dbcc(0x199)]({'where':{'id':_0x4a0baf},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x22e3b4)return null;return{'id':_0x22e3b4['id'],'fullName':_0x22e3b4[_0x30dbcc(0x19e)],'username':_0x22e3b4[_0x30dbcc(0x1bb)],'telegramId':_0x22e3b4['telegram'],'merchantUrl':_0x22e3b4[_0x30dbcc(0x1b4)],'gateways':_0x22e3b4['paymentGateways']?JSON[_0x30dbcc(0x1b1)](_0x22e3b4[_0x30dbcc(0x1a2)]):null,'gatewaySettings':_0x22e3b4[_0x30dbcc(0x19b)]?JSON[_0x30dbcc(0x1b1)](_0x22e3b4['gatewaySettings']):null,'publicKey':_0x22e3b4[_0x30dbcc(0x1c1)],'wallets':{'usdtPolygonWallet':_0x22e3b4[_0x30dbcc(0x1c5)],'usdtTrcWallet':_0x22e3b4[_0x30dbcc(0x19a)],'usdtErcWallet':_0x22e3b4[_0x30dbcc(0x1a4)],'usdcPolygonWallet':_0x22e3b4['usdcPolygonWallet']},'status':_0x22e3b4[_0x30dbcc(0x19c)],'createdAt':_0x22e3b4[_0x30dbcc(0x1cc)]};}async[a51_0x3056c8(0x1a9)](_0x5ac99e,_0x5e0405){const _0x1f6a17=a51_0x3056c8,_0x449cfc={..._0x5e0405};_0x5e0405[_0x1f6a17(0x1ac)]&&(_0x449cfc[_0x1f6a17(0x1ac)]=await bcryptjs_1[_0x1f6a17(0x1c4)]['hash'](_0x5e0405[_0x1f6a17(0x1ac)],0xc));_0x5e0405[_0x1f6a17(0x1a3)]&&(_0x449cfc['name']=_0x5e0405['fullName'],delete _0x449cfc[_0x1f6a17(0x1a3)]);_0x5e0405[_0x1f6a17(0x1c6)]&&(_0x449cfc['telegram']=_0x5e0405[_0x1f6a17(0x1c6)],delete _0x449cfc[_0x1f6a17(0x1c6)]);_0x5e0405[_0x1f6a17(0x1aa)]&&(_0x449cfc[_0x1f6a17(0x1b4)]=_0x5e0405[_0x1f6a17(0x1aa)],delete _0x449cfc[_0x1f6a17(0x1aa)]);_0x5e0405[_0x1f6a17(0x1ba)]&&(_0x449cfc['paymentGateways']=JSON['stringify'](_0x5e0405[_0x1f6a17(0x1ba)]),delete _0x449cfc[_0x1f6a17(0x1ba)]);_0x5e0405[_0x1f6a17(0x19b)]&&(_0x449cfc[_0x1f6a17(0x19b)]=JSON['stringify'](_0x5e0405[_0x1f6a17(0x19b)]),delete _0x449cfc[_0x1f6a17(0x19b)]);_0x5e0405[_0x1f6a17(0x1a0)]&&(_0x5e0405[_0x1f6a17(0x1a0)][_0x1f6a17(0x1c5)]!==undefined&&(_0x449cfc[_0x1f6a17(0x1c5)]=_0x5e0405[_0x1f6a17(0x1a0)]['usdtPolygonWallet']||null),_0x5e0405['wallets'][_0x1f6a17(0x19a)]!==undefined&&(_0x449cfc[_0x1f6a17(0x19a)]=_0x5e0405['wallets'][_0x1f6a17(0x19a)]||null),_0x5e0405[_0x1f6a17(0x1a0)][_0x1f6a17(0x1a4)]!==undefined&&(_0x449cfc[_0x1f6a17(0x1a4)]=_0x5e0405[_0x1f6a17(0x1a0)][_0x1f6a17(0x1a4)]||null),_0x5e0405[_0x1f6a17(0x1a0)][_0x1f6a17(0x1bd)]!==undefined&&(_0x449cfc[_0x1f6a17(0x1bd)]=_0x5e0405['wallets']['usdcPolygonWallet']||null),delete _0x449cfc[_0x1f6a17(0x1a0)]);const _0x340a6d=await database_1['default'][_0x1f6a17(0x1c9)][_0x1f6a17(0x1cd)]({'where':{'id':_0x5ac99e},'data':_0x449cfc,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x340a6d['id'],'fullName':_0x340a6d[_0x1f6a17(0x19e)],'username':_0x340a6d['username'],'telegramId':_0x340a6d[_0x1f6a17(0x1b3)],'merchantUrl':_0x340a6d[_0x1f6a17(0x1b4)],'gateways':_0x340a6d['paymentGateways']?JSON[_0x1f6a17(0x1b1)](_0x340a6d['paymentGateways']):null,'gatewaySettings':_0x340a6d[_0x1f6a17(0x19b)]?JSON[_0x1f6a17(0x1b1)](_0x340a6d[_0x1f6a17(0x19b)]):null,'publicKey':_0x340a6d[_0x1f6a17(0x1c1)],'wallets':{'usdtPolygonWallet':_0x340a6d['usdtPolygonWallet'],'usdtTrcWallet':_0x340a6d[_0x1f6a17(0x19a)],'usdtErcWallet':_0x340a6d['usdtErcWallet'],'usdcPolygonWallet':_0x340a6d[_0x1f6a17(0x1bd)]},'status':_0x340a6d[_0x1f6a17(0x19c)],'createdAt':_0x340a6d[_0x1f6a17(0x1cc)]};}async[a51_0x3056c8(0x1ca)](_0x42fd77){const _0x3387f0=a51_0x3056c8;await database_1[_0x3387f0(0x1c4)][_0x3387f0(0x1c9)][_0x3387f0(0x1c0)]({'where':{'id':_0x42fd77}});}}function a51_0x2069(_0xe1fdd7,_0x28a42d){const _0x8f8186=a51_0x8f81();return a51_0x2069=function(_0x206932,_0x496f12){_0x206932=_0x206932-0x199;let _0x5b79da=_0x8f8186[_0x206932];return _0x5b79da;},a51_0x2069(_0xe1fdd7,_0x28a42d);}exports['UserService']=UserService;