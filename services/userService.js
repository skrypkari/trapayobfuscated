'use strict';function a56_0x4b1d(){const _0x115eeb=['24913572PKhAMi','stringify','fullName','../config/database','parse','update','merchantUrl','usdtErcWallet','usdtPolygonWallet','paymentGateways','crypto','usdcPolygonWallet','25btpRQF','createdAt','desc','gatewaySettings','defineProperty','bcryptjs','create','getAllUsers','263070pJyyGv','890ElveNs','408210fXMFOa','shopUrl','__esModule','shop','gateways','hex','findMany','wallets','name','publicKey','default','status','delete','telegramId','2546523BtrwKV','toString','16YGuGfN','randomBytes','13296XiURQf','__importDefault','1008150HrBzGL','username','UserService','2rflYeL','Telegram\x20username\x20already\x20exists','ACTIVE','110407IJwBsf','getUserById','usdtTrcWallet','telegram','hash','generateApiKeys','findUnique','8LzXsAQ','password'];a56_0x4b1d=function(){return _0x115eeb;};return a56_0x4b1d();}const a56_0x5f3ce3=a56_0x317a;(function(_0x48b8f8,_0x465d7a){const _0x14aef7=a56_0x317a,_0x543c9f=_0x48b8f8();while(!![]){try{const _0x305c6b=parseInt(_0x14aef7(0x1cf))/0x1*(parseInt(_0x14aef7(0x1f1))/0x2)+parseInt(_0x14aef7(0x1ca))/0x3*(parseInt(_0x14aef7(0x201))/0x4)+parseInt(_0x14aef7(0x1e7))/0x5*(parseInt(_0x14aef7(0x1cc))/0x6)+parseInt(_0x14aef7(0x1ff))/0x7*(parseInt(_0x14aef7(0x1d9))/0x8)+parseInt(_0x14aef7(0x1ef))/0x9+-parseInt(_0x14aef7(0x1f0))/0xa*(-parseInt(_0x14aef7(0x1d2))/0xb)+-parseInt(_0x14aef7(0x1db))/0xc;if(_0x305c6b===_0x465d7a)break;else _0x543c9f['push'](_0x543c9f['shift']());}catch(_0x5d1b72){_0x543c9f['push'](_0x543c9f['shift']());}}}(a56_0x4b1d,0x74454));var __importDefault=this&&this[a56_0x5f3ce3(0x1cb)]||function(_0x3efe14){const _0x15b7e1=a56_0x5f3ce3;return _0x3efe14&&_0x3efe14[_0x15b7e1(0x1f3)]?_0x3efe14:{'default':_0x3efe14};};function a56_0x317a(_0x3b4079,_0x35130f){const _0x4b1d18=a56_0x4b1d();return a56_0x317a=function(_0x317a1b,_0x439a3d){_0x317a1b=_0x317a1b-0x1ca;let _0x4e5edc=_0x4b1d18[_0x317a1b];return _0x4e5edc;},a56_0x317a(_0x3b4079,_0x35130f);}Object[a56_0x5f3ce3(0x1eb)](exports,'__esModule',{'value':!![]}),exports[a56_0x5f3ce3(0x1ce)]=void 0x0;const bcryptjs_1=__importDefault(require(a56_0x5f3ce3(0x1ec))),crypto_1=__importDefault(require(a56_0x5f3ce3(0x1e5))),database_1=__importDefault(require(a56_0x5f3ce3(0x1de)));class UserService{['generateApiKeys'](){const _0x3c3a54=a56_0x5f3ce3,_0x4725ac='pk_'+crypto_1[_0x3c3a54(0x1fb)][_0x3c3a54(0x202)](0x20)[_0x3c3a54(0x200)]('hex'),_0x1a16cc='sk_'+crypto_1[_0x3c3a54(0x1fb)][_0x3c3a54(0x202)](0x20)[_0x3c3a54(0x200)](_0x3c3a54(0x1f6));return{'publicKey':_0x4725ac,'secretKey':_0x1a16cc};}async['createUser'](_0x14c4ca){const _0x4015b5=a56_0x5f3ce3,{fullName:_0x5c5cce,username:_0x364457,password:_0x4ab74f,telegramId:_0x11c435,merchantUrl:_0x5d2646,gateways:_0x559887,gatewaySettings:_0x4e0e6d,wallets:_0x14f02b}=_0x14c4ca,_0x56299b=await database_1[_0x4015b5(0x1fb)]['shop'][_0x4015b5(0x1d8)]({'where':{'username':_0x364457}});if(_0x56299b)throw new Error('Username\x20already\x20exists');if(_0x11c435){const _0x5abb31=await database_1[_0x4015b5(0x1fb)][_0x4015b5(0x1f4)][_0x4015b5(0x1d8)]({'where':{'telegram':_0x11c435}});if(_0x5abb31)throw new Error(_0x4015b5(0x1d0));}const _0xa3f629=await bcryptjs_1['default'][_0x4015b5(0x1d6)](_0x4ab74f,0xc),{publicKey:_0x3fa3ef,secretKey:_0x434a66}=this[_0x4015b5(0x1d7)](),_0x97009f=await database_1['default']['shop'][_0x4015b5(0x1ed)]({'data':{'name':_0x5c5cce,'username':_0x364457,'password':_0xa3f629,'telegram':_0x11c435,'shopUrl':_0x5d2646,'paymentGateways':_0x559887?JSON['stringify'](_0x559887):null,'gatewaySettings':_0x4e0e6d?JSON[_0x4015b5(0x1dc)](_0x4e0e6d):null,'usdtPolygonWallet':_0x14f02b?.[_0x4015b5(0x1e3)]||null,'usdtTrcWallet':_0x14f02b?.['usdtTrcWallet']||null,'usdtErcWallet':_0x14f02b?.[_0x4015b5(0x1e2)]||null,'usdcPolygonWallet':_0x14f02b?.[_0x4015b5(0x1e6)]||null,'publicKey':_0x3fa3ef,'secretKey':_0x434a66,'status':_0x4015b5(0x1d1)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x97009f['id'],'fullName':_0x97009f[_0x4015b5(0x1f9)],'username':_0x97009f[_0x4015b5(0x1cd)],'telegramId':_0x97009f[_0x4015b5(0x1d5)],'merchantUrl':_0x97009f[_0x4015b5(0x1f2)],'gateways':_0x97009f['paymentGateways']?JSON[_0x4015b5(0x1df)](_0x97009f['paymentGateways']):null,'gatewaySettings':_0x97009f[_0x4015b5(0x1ea)]?JSON['parse'](_0x97009f[_0x4015b5(0x1ea)]):null,'publicKey':_0x97009f[_0x4015b5(0x1fa)],'wallets':{'usdtPolygonWallet':_0x97009f['usdtPolygonWallet'],'usdtTrcWallet':_0x97009f[_0x4015b5(0x1d4)],'usdtErcWallet':_0x97009f['usdtErcWallet'],'usdcPolygonWallet':_0x97009f[_0x4015b5(0x1e6)]},'status':_0x97009f[_0x4015b5(0x1fc)],'createdAt':_0x97009f['createdAt']};}async[a56_0x5f3ce3(0x1ee)](){const _0x54f9ea=a56_0x5f3ce3,_0x1784a8=await database_1[_0x54f9ea(0x1fb)][_0x54f9ea(0x1f4)][_0x54f9ea(0x1f7)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x54f9ea(0x1e9)}});return _0x1784a8['map'](_0x34d524=>({'id':_0x34d524['id'],'fullName':_0x34d524[_0x54f9ea(0x1f9)],'username':_0x34d524['username'],'telegramId':_0x34d524[_0x54f9ea(0x1d5)],'merchantUrl':_0x34d524['shopUrl'],'gateways':_0x34d524[_0x54f9ea(0x1e4)]?JSON['parse'](_0x34d524[_0x54f9ea(0x1e4)]):null,'gatewaySettings':_0x34d524[_0x54f9ea(0x1ea)]?JSON[_0x54f9ea(0x1df)](_0x34d524[_0x54f9ea(0x1ea)]):null,'publicKey':_0x34d524['publicKey'],'wallets':{'usdtPolygonWallet':_0x34d524[_0x54f9ea(0x1e3)],'usdtTrcWallet':_0x34d524[_0x54f9ea(0x1d4)],'usdtErcWallet':_0x34d524[_0x54f9ea(0x1e2)],'usdcPolygonWallet':_0x34d524[_0x54f9ea(0x1e6)]},'status':_0x34d524['status'],'createdAt':_0x34d524[_0x54f9ea(0x1e8)]}));}async[a56_0x5f3ce3(0x1d3)](_0xe11e54){const _0x4e3c2b=a56_0x5f3ce3,_0x144cbf=await database_1[_0x4e3c2b(0x1fb)][_0x4e3c2b(0x1f4)][_0x4e3c2b(0x1d8)]({'where':{'id':_0xe11e54},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x144cbf)return null;return{'id':_0x144cbf['id'],'fullName':_0x144cbf[_0x4e3c2b(0x1f9)],'username':_0x144cbf[_0x4e3c2b(0x1cd)],'telegramId':_0x144cbf[_0x4e3c2b(0x1d5)],'merchantUrl':_0x144cbf[_0x4e3c2b(0x1f2)],'gateways':_0x144cbf[_0x4e3c2b(0x1e4)]?JSON[_0x4e3c2b(0x1df)](_0x144cbf[_0x4e3c2b(0x1e4)]):null,'gatewaySettings':_0x144cbf[_0x4e3c2b(0x1ea)]?JSON['parse'](_0x144cbf[_0x4e3c2b(0x1ea)]):null,'publicKey':_0x144cbf[_0x4e3c2b(0x1fa)],'wallets':{'usdtPolygonWallet':_0x144cbf[_0x4e3c2b(0x1e3)],'usdtTrcWallet':_0x144cbf[_0x4e3c2b(0x1d4)],'usdtErcWallet':_0x144cbf[_0x4e3c2b(0x1e2)],'usdcPolygonWallet':_0x144cbf['usdcPolygonWallet']},'status':_0x144cbf[_0x4e3c2b(0x1fc)],'createdAt':_0x144cbf[_0x4e3c2b(0x1e8)]};}async['updateUser'](_0x5cc825,_0x325508){const _0x529fa8=a56_0x5f3ce3,_0x109e76={..._0x325508};_0x325508[_0x529fa8(0x1da)]&&(_0x109e76[_0x529fa8(0x1da)]=await bcryptjs_1[_0x529fa8(0x1fb)]['hash'](_0x325508[_0x529fa8(0x1da)],0xc));_0x325508[_0x529fa8(0x1dd)]&&(_0x109e76[_0x529fa8(0x1f9)]=_0x325508['fullName'],delete _0x109e76['fullName']);_0x325508[_0x529fa8(0x1fe)]&&(_0x109e76[_0x529fa8(0x1d5)]=_0x325508[_0x529fa8(0x1fe)],delete _0x109e76[_0x529fa8(0x1fe)]);_0x325508[_0x529fa8(0x1e1)]&&(_0x109e76[_0x529fa8(0x1f2)]=_0x325508[_0x529fa8(0x1e1)],delete _0x109e76[_0x529fa8(0x1e1)]);_0x325508[_0x529fa8(0x1f5)]&&(_0x109e76[_0x529fa8(0x1e4)]=JSON['stringify'](_0x325508['gateways']),delete _0x109e76['gateways']);_0x325508[_0x529fa8(0x1ea)]&&(_0x109e76['gatewaySettings']=JSON['stringify'](_0x325508['gatewaySettings']),delete _0x109e76['gatewaySettings']);_0x325508[_0x529fa8(0x1f8)]&&(_0x325508[_0x529fa8(0x1f8)][_0x529fa8(0x1e3)]!==undefined&&(_0x109e76[_0x529fa8(0x1e3)]=_0x325508[_0x529fa8(0x1f8)][_0x529fa8(0x1e3)]||null),_0x325508['wallets'][_0x529fa8(0x1d4)]!==undefined&&(_0x109e76[_0x529fa8(0x1d4)]=_0x325508[_0x529fa8(0x1f8)][_0x529fa8(0x1d4)]||null),_0x325508[_0x529fa8(0x1f8)]['usdtErcWallet']!==undefined&&(_0x109e76[_0x529fa8(0x1e2)]=_0x325508['wallets'][_0x529fa8(0x1e2)]||null),_0x325508[_0x529fa8(0x1f8)]['usdcPolygonWallet']!==undefined&&(_0x109e76[_0x529fa8(0x1e6)]=_0x325508[_0x529fa8(0x1f8)][_0x529fa8(0x1e6)]||null),delete _0x109e76[_0x529fa8(0x1f8)]);const _0x6b2118=await database_1[_0x529fa8(0x1fb)][_0x529fa8(0x1f4)][_0x529fa8(0x1e0)]({'where':{'id':_0x5cc825},'data':_0x109e76,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x6b2118['id'],'fullName':_0x6b2118[_0x529fa8(0x1f9)],'username':_0x6b2118[_0x529fa8(0x1cd)],'telegramId':_0x6b2118[_0x529fa8(0x1d5)],'merchantUrl':_0x6b2118[_0x529fa8(0x1f2)],'gateways':_0x6b2118[_0x529fa8(0x1e4)]?JSON['parse'](_0x6b2118[_0x529fa8(0x1e4)]):null,'gatewaySettings':_0x6b2118[_0x529fa8(0x1ea)]?JSON[_0x529fa8(0x1df)](_0x6b2118[_0x529fa8(0x1ea)]):null,'publicKey':_0x6b2118[_0x529fa8(0x1fa)],'wallets':{'usdtPolygonWallet':_0x6b2118[_0x529fa8(0x1e3)],'usdtTrcWallet':_0x6b2118[_0x529fa8(0x1d4)],'usdtErcWallet':_0x6b2118[_0x529fa8(0x1e2)],'usdcPolygonWallet':_0x6b2118['usdcPolygonWallet']},'status':_0x6b2118[_0x529fa8(0x1fc)],'createdAt':_0x6b2118[_0x529fa8(0x1e8)]};}async['deleteUser'](_0x6d95a5){const _0x1062c6=a56_0x5f3ce3;await database_1[_0x1062c6(0x1fb)][_0x1062c6(0x1f4)][_0x1062c6(0x1fd)]({'where':{'id':_0x6d95a5}});}}exports[a56_0x5f3ce3(0x1ce)]=UserService;