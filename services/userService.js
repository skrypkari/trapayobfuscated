'use strict';const a76_0x3f3c13=a76_0x2401;function a76_0x2401(_0x3a3667,_0x4965db){_0x3a3667=_0x3a3667-0x199;const _0xe2eb1=a76_0xe2eb();let _0x24010d=_0xe2eb1[_0x3a3667];return _0x24010d;}(function(_0x42a834,_0x49129f){const _0x3bcac0=a76_0x2401,_0x223bf4=_0x42a834();while(!![]){try{const _0x29727f=-parseInt(_0x3bcac0(0x1ca))/0x1+-parseInt(_0x3bcac0(0x1c3))/0x2*(parseInt(_0x3bcac0(0x1a7))/0x3)+-parseInt(_0x3bcac0(0x1b6))/0x4+-parseInt(_0x3bcac0(0x19c))/0x5+-parseInt(_0x3bcac0(0x1ae))/0x6*(-parseInt(_0x3bcac0(0x1cd))/0x7)+parseInt(_0x3bcac0(0x1a8))/0x8*(parseInt(_0x3bcac0(0x1c4))/0x9)+-parseInt(_0x3bcac0(0x1ad))/0xa*(-parseInt(_0x3bcac0(0x1bb))/0xb);if(_0x29727f===_0x49129f)break;else _0x223bf4['push'](_0x223bf4['shift']());}catch(_0x44fe3d){_0x223bf4['push'](_0x223bf4['shift']());}}}(a76_0xe2eb,0xb4e86));var __importDefault=this&&this['__importDefault']||function(_0x5cb6f8){const _0x37f4cb=a76_0x2401;return _0x5cb6f8&&_0x5cb6f8[_0x37f4cb(0x1bd)]?_0x5cb6f8:{'default':_0x5cb6f8};};Object['defineProperty'](exports,a76_0x3f3c13(0x1bd),{'value':!![]}),exports['UserService']=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),crypto_1=__importDefault(require(a76_0x3f3c13(0x1bf))),database_1=__importDefault(require(a76_0x3f3c13(0x1bc)));class UserService{[a76_0x3f3c13(0x1b9)](){const _0xd95612=a76_0x3f3c13,_0x1cf97a=_0xd95612(0x1d0)+crypto_1[_0xd95612(0x1b2)][_0xd95612(0x1cf)](0x20)[_0xd95612(0x1a3)](_0xd95612(0x199)),_0x12c8d7=_0xd95612(0x19b)+crypto_1[_0xd95612(0x1b2)]['randomBytes'](0x20)['toString'](_0xd95612(0x199));return{'publicKey':_0x1cf97a,'secretKey':_0x12c8d7};}async[a76_0x3f3c13(0x1a5)](_0x5eda83){const _0x1f341c=a76_0x3f3c13,{fullName:_0x608d7f,username:_0x2c8dde,password:_0x29b04a,telegramId:_0x4b4824,merchantUrl:_0xa82f8a,gateways:_0x2be7af,gatewaySettings:_0xe3476b,wallets:_0xb0afb8}=_0x5eda83,_0x1c996d=await database_1[_0x1f341c(0x1b2)]['shop'][_0x1f341c(0x1aa)]({'where':{'username':_0x2c8dde}});if(_0x1c996d)throw new Error('Username\x20already\x20exists');if(_0x4b4824){const _0x4299c9=await database_1[_0x1f341c(0x1b2)][_0x1f341c(0x1ce)][_0x1f341c(0x1aa)]({'where':{'telegram':_0x4b4824}});if(_0x4299c9)throw new Error(_0x1f341c(0x1a4));}const _0x2de915=await bcryptjs_1[_0x1f341c(0x1b2)][_0x1f341c(0x1c9)](_0x29b04a,0xc),{publicKey:_0x449a3c,secretKey:_0x15c7ab}=this['generateApiKeys'](),_0x1e6763=await database_1[_0x1f341c(0x1b2)]['shop'][_0x1f341c(0x1b3)]({'data':{'name':_0x608d7f,'username':_0x2c8dde,'password':_0x2de915,'telegram':_0x4b4824,'shopUrl':_0xa82f8a,'paymentGateways':_0x2be7af?JSON['stringify'](_0x2be7af):null,'gatewaySettings':_0xe3476b?JSON['stringify'](_0xe3476b):null,'usdtPolygonWallet':_0xb0afb8?.['usdtPolygonWallet']||null,'usdtTrcWallet':_0xb0afb8?.[_0x1f341c(0x1a9)]||null,'usdtErcWallet':_0xb0afb8?.[_0x1f341c(0x1c8)]||null,'usdcPolygonWallet':_0xb0afb8?.[_0x1f341c(0x1a2)]||null,'publicKey':_0x449a3c,'secretKey':_0x15c7ab,'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x1e6763['id'],'fullName':_0x1e6763[_0x1f341c(0x19e)],'username':_0x1e6763[_0x1f341c(0x1ba)],'telegramId':_0x1e6763[_0x1f341c(0x1a6)],'merchantUrl':_0x1e6763[_0x1f341c(0x1b5)],'gateways':_0x1e6763[_0x1f341c(0x1cc)]?JSON[_0x1f341c(0x1b4)](_0x1e6763['paymentGateways']):null,'gatewaySettings':_0x1e6763['gatewaySettings']?JSON['parse'](_0x1e6763[_0x1f341c(0x19f)]):null,'publicKey':_0x1e6763[_0x1f341c(0x1c7)],'wallets':{'usdtPolygonWallet':_0x1e6763[_0x1f341c(0x19d)],'usdtTrcWallet':_0x1e6763[_0x1f341c(0x1a9)],'usdtErcWallet':_0x1e6763[_0x1f341c(0x1c8)],'usdcPolygonWallet':_0x1e6763[_0x1f341c(0x1a2)]},'status':_0x1e6763[_0x1f341c(0x1b7)],'createdAt':_0x1e6763['createdAt']};}async[a76_0x3f3c13(0x1c5)](){const _0x184fda=a76_0x3f3c13,_0x29aef0=await database_1[_0x184fda(0x1b2)][_0x184fda(0x1ce)][_0x184fda(0x1cb)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':'desc'}});return _0x29aef0[_0x184fda(0x1c1)](_0x4135ca=>({'id':_0x4135ca['id'],'fullName':_0x4135ca[_0x184fda(0x19e)],'username':_0x4135ca['username'],'telegramId':_0x4135ca[_0x184fda(0x1a6)],'merchantUrl':_0x4135ca['shopUrl'],'gateways':_0x4135ca[_0x184fda(0x1cc)]?JSON[_0x184fda(0x1b4)](_0x4135ca[_0x184fda(0x1cc)]):null,'gatewaySettings':_0x4135ca[_0x184fda(0x19f)]?JSON[_0x184fda(0x1b4)](_0x4135ca[_0x184fda(0x19f)]):null,'publicKey':_0x4135ca['publicKey'],'wallets':{'usdtPolygonWallet':_0x4135ca[_0x184fda(0x19d)],'usdtTrcWallet':_0x4135ca[_0x184fda(0x1a9)],'usdtErcWallet':_0x4135ca[_0x184fda(0x1c8)],'usdcPolygonWallet':_0x4135ca['usdcPolygonWallet']},'status':_0x4135ca['status'],'createdAt':_0x4135ca[_0x184fda(0x1af)]}));}async[a76_0x3f3c13(0x1ab)](_0x340419){const _0x21a7ef=a76_0x3f3c13,_0x51b554=await database_1[_0x21a7ef(0x1b2)]['shop'][_0x21a7ef(0x1aa)]({'where':{'id':_0x340419},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x51b554)return null;return{'id':_0x51b554['id'],'fullName':_0x51b554[_0x21a7ef(0x19e)],'username':_0x51b554[_0x21a7ef(0x1ba)],'telegramId':_0x51b554[_0x21a7ef(0x1a6)],'merchantUrl':_0x51b554['shopUrl'],'gateways':_0x51b554['paymentGateways']?JSON['parse'](_0x51b554[_0x21a7ef(0x1cc)]):null,'gatewaySettings':_0x51b554['gatewaySettings']?JSON[_0x21a7ef(0x1b4)](_0x51b554[_0x21a7ef(0x19f)]):null,'publicKey':_0x51b554['publicKey'],'wallets':{'usdtPolygonWallet':_0x51b554[_0x21a7ef(0x19d)],'usdtTrcWallet':_0x51b554[_0x21a7ef(0x1a9)],'usdtErcWallet':_0x51b554[_0x21a7ef(0x1c8)],'usdcPolygonWallet':_0x51b554[_0x21a7ef(0x1a2)]},'status':_0x51b554[_0x21a7ef(0x1b7)],'createdAt':_0x51b554['createdAt']};}async[a76_0x3f3c13(0x19a)](_0x1a141f,_0x3f7aef){const _0x14d821=a76_0x3f3c13,_0x39302d={..._0x3f7aef};_0x3f7aef['password']&&(_0x39302d[_0x14d821(0x1ac)]=await bcryptjs_1[_0x14d821(0x1b2)][_0x14d821(0x1c9)](_0x3f7aef['password'],0xc));_0x3f7aef[_0x14d821(0x1a1)]&&(_0x39302d['name']=_0x3f7aef['fullName'],delete _0x39302d[_0x14d821(0x1a1)]);_0x3f7aef[_0x14d821(0x1b1)]&&(_0x39302d['telegram']=_0x3f7aef[_0x14d821(0x1b1)],delete _0x39302d['telegramId']);_0x3f7aef[_0x14d821(0x1be)]&&(_0x39302d[_0x14d821(0x1b5)]=_0x3f7aef[_0x14d821(0x1be)],delete _0x39302d[_0x14d821(0x1be)]);_0x3f7aef['gateways']&&(_0x39302d[_0x14d821(0x1cc)]=JSON['stringify'](_0x3f7aef[_0x14d821(0x1c2)]),delete _0x39302d[_0x14d821(0x1c2)]);_0x3f7aef[_0x14d821(0x19f)]&&(_0x39302d[_0x14d821(0x19f)]=JSON['stringify'](_0x3f7aef[_0x14d821(0x19f)]),delete _0x39302d[_0x14d821(0x19f)]);_0x3f7aef[_0x14d821(0x1c6)]&&(_0x3f7aef[_0x14d821(0x1c6)][_0x14d821(0x19d)]!==undefined&&(_0x39302d['usdtPolygonWallet']=_0x3f7aef['wallets'][_0x14d821(0x19d)]||null),_0x3f7aef[_0x14d821(0x1c6)][_0x14d821(0x1a9)]!==undefined&&(_0x39302d[_0x14d821(0x1a9)]=_0x3f7aef[_0x14d821(0x1c6)][_0x14d821(0x1a9)]||null),_0x3f7aef['wallets'][_0x14d821(0x1c8)]!==undefined&&(_0x39302d[_0x14d821(0x1c8)]=_0x3f7aef[_0x14d821(0x1c6)]['usdtErcWallet']||null),_0x3f7aef[_0x14d821(0x1c6)][_0x14d821(0x1a2)]!==undefined&&(_0x39302d[_0x14d821(0x1a2)]=_0x3f7aef[_0x14d821(0x1c6)][_0x14d821(0x1a2)]||null),delete _0x39302d[_0x14d821(0x1c6)]);const _0x50eb55=await database_1['default']['shop'][_0x14d821(0x1a0)]({'where':{'id':_0x1a141f},'data':_0x39302d,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x50eb55['id'],'fullName':_0x50eb55['name'],'username':_0x50eb55[_0x14d821(0x1ba)],'telegramId':_0x50eb55['telegram'],'merchantUrl':_0x50eb55['shopUrl'],'gateways':_0x50eb55['paymentGateways']?JSON['parse'](_0x50eb55[_0x14d821(0x1cc)]):null,'gatewaySettings':_0x50eb55['gatewaySettings']?JSON['parse'](_0x50eb55[_0x14d821(0x19f)]):null,'publicKey':_0x50eb55['publicKey'],'wallets':{'usdtPolygonWallet':_0x50eb55['usdtPolygonWallet'],'usdtTrcWallet':_0x50eb55['usdtTrcWallet'],'usdtErcWallet':_0x50eb55['usdtErcWallet'],'usdcPolygonWallet':_0x50eb55['usdcPolygonWallet']},'status':_0x50eb55[_0x14d821(0x1b7)],'createdAt':_0x50eb55['createdAt']};}async[a76_0x3f3c13(0x1b0)](_0x45323d){const _0x4ec473=a76_0x3f3c13;await database_1[_0x4ec473(0x1b2)][_0x4ec473(0x1ce)][_0x4ec473(0x1b8)]({'where':{'id':_0x45323d}});}}function a76_0xe2eb(){const _0x15bd0f=['create','parse','shopUrl','5644772FqcSdd','status','delete','generateApiKeys','username','21524008LWGEqM','../config/database','__esModule','merchantUrl','crypto','UserService','map','gateways','2bhnZiu','90zKZHJh','getAllUsers','wallets','publicKey','usdtErcWallet','hash','616674GQzCKY','findMany','paymentGateways','7ZAfMWX','shop','randomBytes','pk_','hex','updateUser','sk_','3459900RygwUP','usdtPolygonWallet','name','gatewaySettings','update','fullName','usdcPolygonWallet','toString','Telegram\x20username\x20already\x20exists','createUser','telegram','331170qYYmuj','1079368xfDhZi','usdtTrcWallet','findUnique','getUserById','password','10wmcqRR','1591782SIdlvv','createdAt','deleteUser','telegramId','default'];a76_0xe2eb=function(){return _0x15bd0f;};return a76_0xe2eb();}exports[a76_0x3f3c13(0x1c0)]=UserService;