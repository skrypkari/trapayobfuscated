'use strict';const a68_0x1477f2=a68_0x3a74;(function(_0x3f5538,_0x3e29dd){const _0x20b956=a68_0x3a74,_0x2983d6=_0x3f5538();while(!![]){try{const _0x1f56c8=parseInt(_0x20b956(0xba))/0x1+parseInt(_0x20b956(0xb8))/0x2+-parseInt(_0x20b956(0xd2))/0x3*(parseInt(_0x20b956(0xb3))/0x4)+-parseInt(_0x20b956(0xce))/0x5+-parseInt(_0x20b956(0xca))/0x6*(-parseInt(_0x20b956(0xae))/0x7)+-parseInt(_0x20b956(0xda))/0x8+-parseInt(_0x20b956(0xc3))/0x9*(-parseInt(_0x20b956(0xcf))/0xa);if(_0x1f56c8===_0x3e29dd)break;else _0x2983d6['push'](_0x2983d6['shift']());}catch(_0x4b43fe){_0x2983d6['push'](_0x2983d6['shift']());}}}(a68_0x3b65,0xefabf));function a68_0x3b65(){const _0x40ca21=['createUser','gatewaySettings','4414788NMsmTX','__esModule','hex','gateways','8113715dJcUTY','30BSphTv','telegram','findUnique','321NufvhT','bcryptjs','wallets','sk_','password','publicKey','UserService','paymentGateways','9468024TFiAEf','username','randomBytes','status','merchantUrl','findMany','map','generateApiKeys','__importDefault','Username\x20already\x20exists','7NHMyXq','crypto','../config/database','shop','getAllUsers','18232PGizCB','hash','usdtErcWallet','toString','parse','3868384EEylaq','default','946788LUmrYE','name','updateUser','usdtPolygonWallet','usdcPolygonWallet','usdtTrcWallet','delete','telegramId','desc','1976607LTSRdz','createdAt','shopUrl','update','stringify'];a68_0x3b65=function(){return _0x40ca21;};return a68_0x3b65();}var __importDefault=this&&this[a68_0x1477f2(0xac)]||function(_0x876879){const _0x568886=a68_0x1477f2;return _0x876879&&_0x876879[_0x568886(0xcb)]?_0x876879:{'default':_0x876879};};Object['defineProperty'](exports,a68_0x1477f2(0xcb),{'value':!![]}),exports[a68_0x1477f2(0xd8)]=void 0x0;const bcryptjs_1=__importDefault(require(a68_0x1477f2(0xd3))),crypto_1=__importDefault(require(a68_0x1477f2(0xaf))),database_1=__importDefault(require(a68_0x1477f2(0xb0)));function a68_0x3a74(_0x532fa2,_0x55ab78){const _0x3b65eb=a68_0x3b65();return a68_0x3a74=function(_0x3a743c,_0x25efc7){_0x3a743c=_0x3a743c-0xab;let _0x3497e5=_0x3b65eb[_0x3a743c];return _0x3497e5;},a68_0x3a74(_0x532fa2,_0x55ab78);}class UserService{[a68_0x1477f2(0xab)](){const _0x1612fd=a68_0x1477f2,_0x737643='pk_'+crypto_1[_0x1612fd(0xb9)][_0x1612fd(0xdc)](0x20)[_0x1612fd(0xb6)](_0x1612fd(0xcc)),_0x4aeb18=_0x1612fd(0xd5)+crypto_1['default'][_0x1612fd(0xdc)](0x20)[_0x1612fd(0xb6)](_0x1612fd(0xcc));return{'publicKey':_0x737643,'secretKey':_0x4aeb18};}async[a68_0x1477f2(0xc8)](_0x2ecabf){const _0x517e94=a68_0x1477f2,{fullName:_0x4d3b0d,username:_0x4ac9b4,password:_0x3addbf,telegramId:_0x1d64c0,merchantUrl:_0x53ab05,gateways:_0x2b0da7,gatewaySettings:_0x5f4e58,wallets:_0x528d95}=_0x2ecabf,_0x532cb3=await database_1[_0x517e94(0xb9)]['shop'][_0x517e94(0xd1)]({'where':{'username':_0x4ac9b4}});if(_0x532cb3)throw new Error(_0x517e94(0xad));if(_0x1d64c0){const _0x1893d5=await database_1[_0x517e94(0xb9)]['shop'][_0x517e94(0xd1)]({'where':{'telegram':_0x1d64c0}});if(_0x1893d5)throw new Error('Telegram\x20username\x20already\x20exists');}const _0x53eb72=await bcryptjs_1['default'][_0x517e94(0xb4)](_0x3addbf,0xc),{publicKey:_0x147590,secretKey:_0x3618d0}=this['generateApiKeys'](),_0x1a6283=await database_1['default']['shop']['create']({'data':{'name':_0x4d3b0d,'username':_0x4ac9b4,'password':_0x53eb72,'telegram':_0x1d64c0,'shopUrl':_0x53ab05,'paymentGateways':_0x2b0da7?JSON['stringify'](_0x2b0da7):null,'gatewaySettings':_0x5f4e58?JSON[_0x517e94(0xc7)](_0x5f4e58):null,'usdtPolygonWallet':_0x528d95?.[_0x517e94(0xbd)]||null,'usdtTrcWallet':_0x528d95?.['usdtTrcWallet']||null,'usdtErcWallet':_0x528d95?.['usdtErcWallet']||null,'usdcPolygonWallet':_0x528d95?.[_0x517e94(0xbe)]||null,'publicKey':_0x147590,'secretKey':_0x3618d0,'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x1a6283['id'],'fullName':_0x1a6283[_0x517e94(0xbb)],'username':_0x1a6283['username'],'telegramId':_0x1a6283[_0x517e94(0xd0)],'merchantUrl':_0x1a6283[_0x517e94(0xc5)],'gateways':_0x1a6283[_0x517e94(0xd9)]?JSON[_0x517e94(0xb7)](_0x1a6283[_0x517e94(0xd9)]):null,'gatewaySettings':_0x1a6283[_0x517e94(0xc9)]?JSON[_0x517e94(0xb7)](_0x1a6283[_0x517e94(0xc9)]):null,'publicKey':_0x1a6283[_0x517e94(0xd7)],'wallets':{'usdtPolygonWallet':_0x1a6283['usdtPolygonWallet'],'usdtTrcWallet':_0x1a6283[_0x517e94(0xbf)],'usdtErcWallet':_0x1a6283[_0x517e94(0xb5)],'usdcPolygonWallet':_0x1a6283['usdcPolygonWallet']},'status':_0x1a6283[_0x517e94(0xdd)],'createdAt':_0x1a6283[_0x517e94(0xc4)]};}async[a68_0x1477f2(0xb2)](){const _0x6fc2f2=a68_0x1477f2,_0x236867=await database_1[_0x6fc2f2(0xb9)][_0x6fc2f2(0xb1)][_0x6fc2f2(0xdf)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x6fc2f2(0xc2)}});return _0x236867[_0x6fc2f2(0xe0)](_0x52dda0=>({'id':_0x52dda0['id'],'fullName':_0x52dda0[_0x6fc2f2(0xbb)],'username':_0x52dda0['username'],'telegramId':_0x52dda0[_0x6fc2f2(0xd0)],'merchantUrl':_0x52dda0[_0x6fc2f2(0xc5)],'gateways':_0x52dda0[_0x6fc2f2(0xd9)]?JSON[_0x6fc2f2(0xb7)](_0x52dda0['paymentGateways']):null,'gatewaySettings':_0x52dda0[_0x6fc2f2(0xc9)]?JSON[_0x6fc2f2(0xb7)](_0x52dda0[_0x6fc2f2(0xc9)]):null,'publicKey':_0x52dda0['publicKey'],'wallets':{'usdtPolygonWallet':_0x52dda0[_0x6fc2f2(0xbd)],'usdtTrcWallet':_0x52dda0[_0x6fc2f2(0xbf)],'usdtErcWallet':_0x52dda0['usdtErcWallet'],'usdcPolygonWallet':_0x52dda0[_0x6fc2f2(0xbe)]},'status':_0x52dda0['status'],'createdAt':_0x52dda0[_0x6fc2f2(0xc4)]}));}async['getUserById'](_0x559587){const _0x4b1e63=a68_0x1477f2,_0x302a10=await database_1['default'][_0x4b1e63(0xb1)][_0x4b1e63(0xd1)]({'where':{'id':_0x559587},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x302a10)return null;return{'id':_0x302a10['id'],'fullName':_0x302a10[_0x4b1e63(0xbb)],'username':_0x302a10[_0x4b1e63(0xdb)],'telegramId':_0x302a10[_0x4b1e63(0xd0)],'merchantUrl':_0x302a10['shopUrl'],'gateways':_0x302a10['paymentGateways']?JSON[_0x4b1e63(0xb7)](_0x302a10[_0x4b1e63(0xd9)]):null,'gatewaySettings':_0x302a10[_0x4b1e63(0xc9)]?JSON['parse'](_0x302a10[_0x4b1e63(0xc9)]):null,'publicKey':_0x302a10[_0x4b1e63(0xd7)],'wallets':{'usdtPolygonWallet':_0x302a10['usdtPolygonWallet'],'usdtTrcWallet':_0x302a10[_0x4b1e63(0xbf)],'usdtErcWallet':_0x302a10[_0x4b1e63(0xb5)],'usdcPolygonWallet':_0x302a10['usdcPolygonWallet']},'status':_0x302a10[_0x4b1e63(0xdd)],'createdAt':_0x302a10['createdAt']};}async[a68_0x1477f2(0xbc)](_0x134cfb,_0x3578dc){const _0x2ba7a6=a68_0x1477f2,_0x3c2786={..._0x3578dc};_0x3578dc[_0x2ba7a6(0xd6)]&&(_0x3c2786['password']=await bcryptjs_1['default'][_0x2ba7a6(0xb4)](_0x3578dc['password'],0xc));_0x3578dc['fullName']&&(_0x3c2786[_0x2ba7a6(0xbb)]=_0x3578dc['fullName'],delete _0x3c2786['fullName']);_0x3578dc[_0x2ba7a6(0xc1)]&&(_0x3c2786['telegram']=_0x3578dc[_0x2ba7a6(0xc1)],delete _0x3c2786[_0x2ba7a6(0xc1)]);_0x3578dc[_0x2ba7a6(0xde)]&&(_0x3c2786['shopUrl']=_0x3578dc[_0x2ba7a6(0xde)],delete _0x3c2786[_0x2ba7a6(0xde)]);_0x3578dc['gateways']&&(_0x3c2786[_0x2ba7a6(0xd9)]=JSON[_0x2ba7a6(0xc7)](_0x3578dc[_0x2ba7a6(0xcd)]),delete _0x3c2786[_0x2ba7a6(0xcd)]);_0x3578dc[_0x2ba7a6(0xc9)]&&(_0x3c2786[_0x2ba7a6(0xc9)]=JSON['stringify'](_0x3578dc[_0x2ba7a6(0xc9)]),delete _0x3c2786[_0x2ba7a6(0xc9)]);_0x3578dc[_0x2ba7a6(0xd4)]&&(_0x3578dc['wallets'][_0x2ba7a6(0xbd)]!==undefined&&(_0x3c2786[_0x2ba7a6(0xbd)]=_0x3578dc[_0x2ba7a6(0xd4)][_0x2ba7a6(0xbd)]||null),_0x3578dc[_0x2ba7a6(0xd4)]['usdtTrcWallet']!==undefined&&(_0x3c2786['usdtTrcWallet']=_0x3578dc[_0x2ba7a6(0xd4)][_0x2ba7a6(0xbf)]||null),_0x3578dc[_0x2ba7a6(0xd4)][_0x2ba7a6(0xb5)]!==undefined&&(_0x3c2786[_0x2ba7a6(0xb5)]=_0x3578dc[_0x2ba7a6(0xd4)]['usdtErcWallet']||null),_0x3578dc[_0x2ba7a6(0xd4)]['usdcPolygonWallet']!==undefined&&(_0x3c2786[_0x2ba7a6(0xbe)]=_0x3578dc[_0x2ba7a6(0xd4)][_0x2ba7a6(0xbe)]||null),delete _0x3c2786[_0x2ba7a6(0xd4)]);const _0x1b1d98=await database_1['default'][_0x2ba7a6(0xb1)][_0x2ba7a6(0xc6)]({'where':{'id':_0x134cfb},'data':_0x3c2786,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x1b1d98['id'],'fullName':_0x1b1d98[_0x2ba7a6(0xbb)],'username':_0x1b1d98[_0x2ba7a6(0xdb)],'telegramId':_0x1b1d98[_0x2ba7a6(0xd0)],'merchantUrl':_0x1b1d98[_0x2ba7a6(0xc5)],'gateways':_0x1b1d98[_0x2ba7a6(0xd9)]?JSON[_0x2ba7a6(0xb7)](_0x1b1d98[_0x2ba7a6(0xd9)]):null,'gatewaySettings':_0x1b1d98[_0x2ba7a6(0xc9)]?JSON['parse'](_0x1b1d98[_0x2ba7a6(0xc9)]):null,'publicKey':_0x1b1d98[_0x2ba7a6(0xd7)],'wallets':{'usdtPolygonWallet':_0x1b1d98[_0x2ba7a6(0xbd)],'usdtTrcWallet':_0x1b1d98[_0x2ba7a6(0xbf)],'usdtErcWallet':_0x1b1d98['usdtErcWallet'],'usdcPolygonWallet':_0x1b1d98[_0x2ba7a6(0xbe)]},'status':_0x1b1d98[_0x2ba7a6(0xdd)],'createdAt':_0x1b1d98['createdAt']};}async['deleteUser'](_0x4e78c8){const _0x54a746=a68_0x1477f2;await database_1[_0x54a746(0xb9)][_0x54a746(0xb1)][_0x54a746(0xc0)]({'where':{'id':_0x4e78c8}});}}exports[a68_0x1477f2(0xd8)]=UserService;