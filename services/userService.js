'use strict';const a55_0x17f3ce=a55_0x5e76;function a55_0x5b27(){const _0x40e563=['publicKey','hex','Telegram\x20username\x20already\x20exists','parse','5432LphIrZ','merchantUrl','generateApiKeys','updateUser','stringify','usdtPolygonWallet','gateways','fullName','661848TmaQNr','password','808850ybmXXq','8UMZpqg','pk_','desc','delete','default','__importDefault','484876LCZdpd','51050fXHttv','getAllUsers','findMany','shopUrl','../config/database','toString','shop','randomBytes','findUnique','162dzxkbs','createUser','create','usdcPolygonWallet','usdtErcWallet','defineProperty','gatewaySettings','UserService','status','name','102JAkFGD','bcryptjs','ACTIVE','telegram','getUserById','5954663cmMKSH','createdAt','username','map','11277mRPOSi','12MquLOl','deleteUser','usdtTrcWallet','paymentGateways','telegramId','wallets','2048946BYEfjh'];a55_0x5b27=function(){return _0x40e563;};return a55_0x5b27();}(function(_0x3e11ad,_0x4f1ab2){const _0x3c5f82=a55_0x5e76,_0x5890a6=_0x3e11ad();while(!![]){try{const _0x4f05eb=-parseInt(_0x3c5f82(0x15d))/0x1+-parseInt(_0x3c5f82(0x166))/0x2+parseInt(_0x3c5f82(0x150))/0x3*(parseInt(_0x3c5f82(0x160))/0x4)+parseInt(_0x3c5f82(0x167))/0x5*(parseInt(_0x3c5f82(0x140))/0x6)+-parseInt(_0x3c5f82(0x149))/0x7*(-parseInt(_0x3c5f82(0x155))/0x8)+-parseInt(_0x3c5f82(0x170))/0x9*(parseInt(_0x3c5f82(0x15f))/0xa)+-parseInt(_0x3c5f82(0x145))/0xb*(-parseInt(_0x3c5f82(0x14a))/0xc);if(_0x4f05eb===_0x4f1ab2)break;else _0x5890a6['push'](_0x5890a6['shift']());}catch(_0x47537b){_0x5890a6['push'](_0x5890a6['shift']());}}}(a55_0x5b27,0xc6db8));var __importDefault=this&&this[a55_0x17f3ce(0x165)]||function(_0x26ac98){return _0x26ac98&&_0x26ac98['__esModule']?_0x26ac98:{'default':_0x26ac98};};function a55_0x5e76(_0x232956,_0x3055cd){const _0x5b27b3=a55_0x5b27();return a55_0x5e76=function(_0x5e76e5,_0x1a27c2){_0x5e76e5=_0x5e76e5-0x13a;let _0x49df9b=_0x5b27b3[_0x5e76e5];return _0x49df9b;},a55_0x5e76(_0x232956,_0x3055cd);}Object[a55_0x17f3ce(0x13b)](exports,'__esModule',{'value':!![]}),exports[a55_0x17f3ce(0x13d)]=void 0x0;const bcryptjs_1=__importDefault(require(a55_0x17f3ce(0x141))),crypto_1=__importDefault(require('crypto')),database_1=__importDefault(require(a55_0x17f3ce(0x16b)));class UserService{[a55_0x17f3ce(0x157)](){const _0x1fa455=a55_0x17f3ce,_0x596a37=_0x1fa455(0x161)+crypto_1[_0x1fa455(0x164)][_0x1fa455(0x16e)](0x20)[_0x1fa455(0x16c)]('hex'),_0x254eed='sk_'+crypto_1['default'][_0x1fa455(0x16e)](0x20)['toString'](_0x1fa455(0x152));return{'publicKey':_0x596a37,'secretKey':_0x254eed};}async[a55_0x17f3ce(0x171)](_0x27076a){const _0x1c0a95=a55_0x17f3ce,{fullName:_0x5e2bc8,username:_0x41a15e,password:_0x7bb087,telegramId:_0x27a7b9,merchantUrl:_0x1ea81b,gateways:_0x2b4f19,gatewaySettings:_0x107bee,wallets:_0x24ea29}=_0x27076a,_0x138920=await database_1[_0x1c0a95(0x164)]['shop'][_0x1c0a95(0x16f)]({'where':{'username':_0x41a15e}});if(_0x138920)throw new Error('Username\x20already\x20exists');if(_0x27a7b9){const _0x16db82=await database_1[_0x1c0a95(0x164)]['shop'][_0x1c0a95(0x16f)]({'where':{'telegram':_0x27a7b9}});if(_0x16db82)throw new Error(_0x1c0a95(0x153));}const _0x29ad3a=await bcryptjs_1['default']['hash'](_0x7bb087,0xc),{publicKey:_0x2ac6bc,secretKey:_0x2ed5c9}=this[_0x1c0a95(0x157)](),_0x598578=await database_1[_0x1c0a95(0x164)][_0x1c0a95(0x16d)][_0x1c0a95(0x172)]({'data':{'name':_0x5e2bc8,'username':_0x41a15e,'password':_0x29ad3a,'telegram':_0x27a7b9,'shopUrl':_0x1ea81b,'paymentGateways':_0x2b4f19?JSON[_0x1c0a95(0x159)](_0x2b4f19):null,'gatewaySettings':_0x107bee?JSON[_0x1c0a95(0x159)](_0x107bee):null,'usdtPolygonWallet':_0x24ea29?.[_0x1c0a95(0x15a)]||null,'usdtTrcWallet':_0x24ea29?.[_0x1c0a95(0x14c)]||null,'usdtErcWallet':_0x24ea29?.[_0x1c0a95(0x13a)]||null,'usdcPolygonWallet':_0x24ea29?.['usdcPolygonWallet']||null,'publicKey':_0x2ac6bc,'secretKey':_0x2ed5c9,'status':_0x1c0a95(0x142)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x598578['id'],'fullName':_0x598578['name'],'username':_0x598578[_0x1c0a95(0x147)],'telegramId':_0x598578[_0x1c0a95(0x143)],'merchantUrl':_0x598578[_0x1c0a95(0x16a)],'gateways':_0x598578[_0x1c0a95(0x14d)]?JSON[_0x1c0a95(0x154)](_0x598578[_0x1c0a95(0x14d)]):null,'gatewaySettings':_0x598578['gatewaySettings']?JSON[_0x1c0a95(0x154)](_0x598578['gatewaySettings']):null,'publicKey':_0x598578[_0x1c0a95(0x151)],'wallets':{'usdtPolygonWallet':_0x598578[_0x1c0a95(0x15a)],'usdtTrcWallet':_0x598578[_0x1c0a95(0x14c)],'usdtErcWallet':_0x598578[_0x1c0a95(0x13a)],'usdcPolygonWallet':_0x598578[_0x1c0a95(0x173)]},'status':_0x598578[_0x1c0a95(0x13e)],'createdAt':_0x598578[_0x1c0a95(0x146)]};}async[a55_0x17f3ce(0x168)](){const _0x1da493=a55_0x17f3ce,_0xfb1f2e=await database_1[_0x1da493(0x164)][_0x1da493(0x16d)][_0x1da493(0x169)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x1da493(0x162)}});return _0xfb1f2e[_0x1da493(0x148)](_0x290c9f=>({'id':_0x290c9f['id'],'fullName':_0x290c9f['name'],'username':_0x290c9f[_0x1da493(0x147)],'telegramId':_0x290c9f[_0x1da493(0x143)],'merchantUrl':_0x290c9f[_0x1da493(0x16a)],'gateways':_0x290c9f['paymentGateways']?JSON[_0x1da493(0x154)](_0x290c9f['paymentGateways']):null,'gatewaySettings':_0x290c9f['gatewaySettings']?JSON[_0x1da493(0x154)](_0x290c9f[_0x1da493(0x13c)]):null,'publicKey':_0x290c9f[_0x1da493(0x151)],'wallets':{'usdtPolygonWallet':_0x290c9f['usdtPolygonWallet'],'usdtTrcWallet':_0x290c9f['usdtTrcWallet'],'usdtErcWallet':_0x290c9f[_0x1da493(0x13a)],'usdcPolygonWallet':_0x290c9f['usdcPolygonWallet']},'status':_0x290c9f[_0x1da493(0x13e)],'createdAt':_0x290c9f[_0x1da493(0x146)]}));}async[a55_0x17f3ce(0x144)](_0x2d3f7d){const _0x4e6c91=a55_0x17f3ce,_0x5162e5=await database_1[_0x4e6c91(0x164)][_0x4e6c91(0x16d)][_0x4e6c91(0x16f)]({'where':{'id':_0x2d3f7d},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x5162e5)return null;return{'id':_0x5162e5['id'],'fullName':_0x5162e5['name'],'username':_0x5162e5[_0x4e6c91(0x147)],'telegramId':_0x5162e5[_0x4e6c91(0x143)],'merchantUrl':_0x5162e5[_0x4e6c91(0x16a)],'gateways':_0x5162e5[_0x4e6c91(0x14d)]?JSON[_0x4e6c91(0x154)](_0x5162e5[_0x4e6c91(0x14d)]):null,'gatewaySettings':_0x5162e5[_0x4e6c91(0x13c)]?JSON[_0x4e6c91(0x154)](_0x5162e5[_0x4e6c91(0x13c)]):null,'publicKey':_0x5162e5[_0x4e6c91(0x151)],'wallets':{'usdtPolygonWallet':_0x5162e5[_0x4e6c91(0x15a)],'usdtTrcWallet':_0x5162e5[_0x4e6c91(0x14c)],'usdtErcWallet':_0x5162e5['usdtErcWallet'],'usdcPolygonWallet':_0x5162e5[_0x4e6c91(0x173)]},'status':_0x5162e5['status'],'createdAt':_0x5162e5[_0x4e6c91(0x146)]};}async[a55_0x17f3ce(0x158)](_0x43e8b2,_0x18fe5f){const _0x455d9b=a55_0x17f3ce,_0x564a27={..._0x18fe5f};_0x18fe5f['password']&&(_0x564a27[_0x455d9b(0x15e)]=await bcryptjs_1['default']['hash'](_0x18fe5f[_0x455d9b(0x15e)],0xc));_0x18fe5f[_0x455d9b(0x15c)]&&(_0x564a27['name']=_0x18fe5f[_0x455d9b(0x15c)],delete _0x564a27[_0x455d9b(0x15c)]);_0x18fe5f['telegramId']&&(_0x564a27['telegram']=_0x18fe5f[_0x455d9b(0x14e)],delete _0x564a27[_0x455d9b(0x14e)]);_0x18fe5f['merchantUrl']&&(_0x564a27[_0x455d9b(0x16a)]=_0x18fe5f[_0x455d9b(0x156)],delete _0x564a27['merchantUrl']);_0x18fe5f['gateways']&&(_0x564a27[_0x455d9b(0x14d)]=JSON[_0x455d9b(0x159)](_0x18fe5f[_0x455d9b(0x15b)]),delete _0x564a27[_0x455d9b(0x15b)]);_0x18fe5f[_0x455d9b(0x13c)]&&(_0x564a27[_0x455d9b(0x13c)]=JSON[_0x455d9b(0x159)](_0x18fe5f[_0x455d9b(0x13c)]),delete _0x564a27[_0x455d9b(0x13c)]);_0x18fe5f['wallets']&&(_0x18fe5f[_0x455d9b(0x14f)][_0x455d9b(0x15a)]!==undefined&&(_0x564a27[_0x455d9b(0x15a)]=_0x18fe5f[_0x455d9b(0x14f)][_0x455d9b(0x15a)]||null),_0x18fe5f[_0x455d9b(0x14f)][_0x455d9b(0x14c)]!==undefined&&(_0x564a27[_0x455d9b(0x14c)]=_0x18fe5f[_0x455d9b(0x14f)][_0x455d9b(0x14c)]||null),_0x18fe5f[_0x455d9b(0x14f)][_0x455d9b(0x13a)]!==undefined&&(_0x564a27[_0x455d9b(0x13a)]=_0x18fe5f[_0x455d9b(0x14f)][_0x455d9b(0x13a)]||null),_0x18fe5f['wallets'][_0x455d9b(0x173)]!==undefined&&(_0x564a27['usdcPolygonWallet']=_0x18fe5f[_0x455d9b(0x14f)][_0x455d9b(0x173)]||null),delete _0x564a27['wallets']);const _0x2f75cb=await database_1['default'][_0x455d9b(0x16d)]['update']({'where':{'id':_0x43e8b2},'data':_0x564a27,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x2f75cb['id'],'fullName':_0x2f75cb[_0x455d9b(0x13f)],'username':_0x2f75cb[_0x455d9b(0x147)],'telegramId':_0x2f75cb['telegram'],'merchantUrl':_0x2f75cb[_0x455d9b(0x16a)],'gateways':_0x2f75cb['paymentGateways']?JSON['parse'](_0x2f75cb[_0x455d9b(0x14d)]):null,'gatewaySettings':_0x2f75cb[_0x455d9b(0x13c)]?JSON[_0x455d9b(0x154)](_0x2f75cb['gatewaySettings']):null,'publicKey':_0x2f75cb[_0x455d9b(0x151)],'wallets':{'usdtPolygonWallet':_0x2f75cb['usdtPolygonWallet'],'usdtTrcWallet':_0x2f75cb[_0x455d9b(0x14c)],'usdtErcWallet':_0x2f75cb[_0x455d9b(0x13a)],'usdcPolygonWallet':_0x2f75cb['usdcPolygonWallet']},'status':_0x2f75cb[_0x455d9b(0x13e)],'createdAt':_0x2f75cb['createdAt']};}async[a55_0x17f3ce(0x14b)](_0x2186d9){const _0x99cbd5=a55_0x17f3ce;await database_1['default'][_0x99cbd5(0x16d)][_0x99cbd5(0x163)]({'where':{'id':_0x2186d9}});}}exports[a55_0x17f3ce(0x13d)]=UserService;