'use strict';function a76_0x175f(){const _0x33c8e4=['hash','28434CzgPWw','createUser','bcryptjs','1109740CJZtav','generateApiKeys','sk_','merchantUrl','stringify','usdtTrcWallet','gateways','43gGKVhF','telegramId','ACTIVE','hex','randomBytes','UserService','default','5953835FcJWSY','map','create','getUserById','4niPAin','135NKDeWV','defineProperty','Username\x20already\x20exists','getAllUsers','telegram','44DzYZmq','usdcPolygonWallet','name','shopUrl','usdtErcWallet','../config/database','parse','__esModule','paymentGateways','findMany','408936EUizYj','2428rbyArJ','fullName','26155680ImHakG','findUnique','password','gatewaySettings','usdtPolygonWallet','status','username','toString','427EGFSjW','shop','pk_','deleteUser','createdAt','__importDefault','167955oieeZj','publicKey','wallets','desc'];a76_0x175f=function(){return _0x33c8e4;};return a76_0x175f();}const a76_0x24dd8e=a76_0x3e22;(function(_0x3c51f2,_0x129cc7){const _0x504ac9=a76_0x3e22,_0xc8fa35=_0x3c51f2();while(!![]){try{const _0x428aa0=parseInt(_0x504ac9(0x16a))/0x1*(parseInt(_0x504ac9(0x14b))/0x2)+-parseInt(_0x504ac9(0x15b))/0x3*(-parseInt(_0x504ac9(0x13a))/0x4)+parseInt(_0x504ac9(0x136))/0x5+-parseInt(_0x504ac9(0x160))/0x6*(-parseInt(_0x504ac9(0x155))/0x7)+parseInt(_0x504ac9(0x14a))/0x8*(parseInt(_0x504ac9(0x13b))/0x9)+parseInt(_0x504ac9(0x163))/0xa*(parseInt(_0x504ac9(0x140))/0xb)+-parseInt(_0x504ac9(0x14d))/0xc;if(_0x428aa0===_0x129cc7)break;else _0xc8fa35['push'](_0xc8fa35['shift']());}catch(_0x4d1db0){_0xc8fa35['push'](_0xc8fa35['shift']());}}}(a76_0x175f,0x97224));var __importDefault=this&&this[a76_0x24dd8e(0x15a)]||function(_0x3a0aa1){const _0xe17397=a76_0x24dd8e;return _0x3a0aa1&&_0x3a0aa1[_0xe17397(0x147)]?_0x3a0aa1:{'default':_0x3a0aa1};};Object[a76_0x24dd8e(0x13c)](exports,a76_0x24dd8e(0x147),{'value':!![]}),exports[a76_0x24dd8e(0x134)]=void 0x0;const bcryptjs_1=__importDefault(require(a76_0x24dd8e(0x162))),crypto_1=__importDefault(require('crypto')),database_1=__importDefault(require(a76_0x24dd8e(0x145)));function a76_0x3e22(_0x1ffba6,_0x469660){_0x1ffba6=_0x1ffba6-0x134;const _0x175f86=a76_0x175f();let _0x3e223c=_0x175f86[_0x1ffba6];return _0x3e223c;}class UserService{[a76_0x24dd8e(0x164)](){const _0x34f087=a76_0x24dd8e,_0x329e8f=_0x34f087(0x157)+crypto_1[_0x34f087(0x135)][_0x34f087(0x16e)](0x20)['toString'](_0x34f087(0x16d)),_0x2947a0=_0x34f087(0x165)+crypto_1[_0x34f087(0x135)]['randomBytes'](0x20)[_0x34f087(0x154)](_0x34f087(0x16d));return{'publicKey':_0x329e8f,'secretKey':_0x2947a0};}async[a76_0x24dd8e(0x161)](_0x39ffb9){const _0x142164=a76_0x24dd8e,{fullName:_0x51672d,username:_0x25b07b,password:_0x1311b3,telegramId:_0x1d9906,merchantUrl:_0x429578,gateways:_0x26969f,gatewaySettings:_0x42faca,wallets:_0x118175}=_0x39ffb9,_0x3d4389=await database_1['default'][_0x142164(0x156)]['findUnique']({'where':{'username':_0x25b07b}});if(_0x3d4389)throw new Error(_0x142164(0x13d));if(_0x1d9906){const _0x106685=await database_1[_0x142164(0x135)][_0x142164(0x156)][_0x142164(0x14e)]({'where':{'telegram':_0x1d9906}});if(_0x106685)throw new Error('Telegram\x20username\x20already\x20exists');}const _0x1b71a7=await bcryptjs_1[_0x142164(0x135)][_0x142164(0x15f)](_0x1311b3,0xc),{publicKey:_0x1c57ef,secretKey:_0x5c6ec9}=this[_0x142164(0x164)](),_0x23ebe5=await database_1[_0x142164(0x135)]['shop'][_0x142164(0x138)]({'data':{'name':_0x51672d,'username':_0x25b07b,'password':_0x1b71a7,'telegram':_0x1d9906,'shopUrl':_0x429578,'paymentGateways':_0x26969f?JSON['stringify'](_0x26969f):null,'gatewaySettings':_0x42faca?JSON[_0x142164(0x167)](_0x42faca):null,'usdtPolygonWallet':_0x118175?.[_0x142164(0x151)]||null,'usdtTrcWallet':_0x118175?.[_0x142164(0x168)]||null,'usdtErcWallet':_0x118175?.[_0x142164(0x144)]||null,'usdcPolygonWallet':_0x118175?.[_0x142164(0x141)]||null,'publicKey':_0x1c57ef,'secretKey':_0x5c6ec9,'status':_0x142164(0x16c)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x23ebe5['id'],'fullName':_0x23ebe5[_0x142164(0x142)],'username':_0x23ebe5[_0x142164(0x153)],'telegramId':_0x23ebe5['telegram'],'merchantUrl':_0x23ebe5[_0x142164(0x143)],'gateways':_0x23ebe5[_0x142164(0x148)]?JSON[_0x142164(0x146)](_0x23ebe5[_0x142164(0x148)]):null,'gatewaySettings':_0x23ebe5['gatewaySettings']?JSON[_0x142164(0x146)](_0x23ebe5['gatewaySettings']):null,'publicKey':_0x23ebe5[_0x142164(0x15c)],'wallets':{'usdtPolygonWallet':_0x23ebe5[_0x142164(0x151)],'usdtTrcWallet':_0x23ebe5['usdtTrcWallet'],'usdtErcWallet':_0x23ebe5[_0x142164(0x144)],'usdcPolygonWallet':_0x23ebe5[_0x142164(0x141)]},'status':_0x23ebe5[_0x142164(0x152)],'createdAt':_0x23ebe5[_0x142164(0x159)]};}async[a76_0x24dd8e(0x13e)](){const _0x4be0da=a76_0x24dd8e,_0x45d9a1=await database_1['default'][_0x4be0da(0x156)][_0x4be0da(0x149)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x4be0da(0x15e)}});return _0x45d9a1[_0x4be0da(0x137)](_0x5a1f2d=>({'id':_0x5a1f2d['id'],'fullName':_0x5a1f2d['name'],'username':_0x5a1f2d[_0x4be0da(0x153)],'telegramId':_0x5a1f2d[_0x4be0da(0x13f)],'merchantUrl':_0x5a1f2d[_0x4be0da(0x143)],'gateways':_0x5a1f2d[_0x4be0da(0x148)]?JSON['parse'](_0x5a1f2d[_0x4be0da(0x148)]):null,'gatewaySettings':_0x5a1f2d[_0x4be0da(0x150)]?JSON[_0x4be0da(0x146)](_0x5a1f2d[_0x4be0da(0x150)]):null,'publicKey':_0x5a1f2d[_0x4be0da(0x15c)],'wallets':{'usdtPolygonWallet':_0x5a1f2d[_0x4be0da(0x151)],'usdtTrcWallet':_0x5a1f2d[_0x4be0da(0x168)],'usdtErcWallet':_0x5a1f2d['usdtErcWallet'],'usdcPolygonWallet':_0x5a1f2d[_0x4be0da(0x141)]},'status':_0x5a1f2d[_0x4be0da(0x152)],'createdAt':_0x5a1f2d['createdAt']}));}async[a76_0x24dd8e(0x139)](_0x5eaa1e){const _0xcd66db=a76_0x24dd8e,_0x960621=await database_1[_0xcd66db(0x135)]['shop']['findUnique']({'where':{'id':_0x5eaa1e},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x960621)return null;return{'id':_0x960621['id'],'fullName':_0x960621[_0xcd66db(0x142)],'username':_0x960621[_0xcd66db(0x153)],'telegramId':_0x960621[_0xcd66db(0x13f)],'merchantUrl':_0x960621[_0xcd66db(0x143)],'gateways':_0x960621[_0xcd66db(0x148)]?JSON[_0xcd66db(0x146)](_0x960621[_0xcd66db(0x148)]):null,'gatewaySettings':_0x960621['gatewaySettings']?JSON['parse'](_0x960621['gatewaySettings']):null,'publicKey':_0x960621[_0xcd66db(0x15c)],'wallets':{'usdtPolygonWallet':_0x960621[_0xcd66db(0x151)],'usdtTrcWallet':_0x960621[_0xcd66db(0x168)],'usdtErcWallet':_0x960621[_0xcd66db(0x144)],'usdcPolygonWallet':_0x960621[_0xcd66db(0x141)]},'status':_0x960621[_0xcd66db(0x152)],'createdAt':_0x960621['createdAt']};}async['updateUser'](_0x5c2499,_0x347afb){const _0x83ff6a=a76_0x24dd8e,_0x2f9ae1={..._0x347afb};_0x347afb['password']&&(_0x2f9ae1[_0x83ff6a(0x14f)]=await bcryptjs_1['default'][_0x83ff6a(0x15f)](_0x347afb[_0x83ff6a(0x14f)],0xc));_0x347afb['fullName']&&(_0x2f9ae1[_0x83ff6a(0x142)]=_0x347afb[_0x83ff6a(0x14c)],delete _0x2f9ae1[_0x83ff6a(0x14c)]);_0x347afb[_0x83ff6a(0x16b)]&&(_0x2f9ae1['telegram']=_0x347afb[_0x83ff6a(0x16b)],delete _0x2f9ae1['telegramId']);_0x347afb['merchantUrl']&&(_0x2f9ae1[_0x83ff6a(0x143)]=_0x347afb[_0x83ff6a(0x166)],delete _0x2f9ae1[_0x83ff6a(0x166)]);_0x347afb[_0x83ff6a(0x169)]&&(_0x2f9ae1[_0x83ff6a(0x148)]=JSON[_0x83ff6a(0x167)](_0x347afb[_0x83ff6a(0x169)]),delete _0x2f9ae1['gateways']);_0x347afb[_0x83ff6a(0x150)]&&(_0x2f9ae1[_0x83ff6a(0x150)]=JSON[_0x83ff6a(0x167)](_0x347afb[_0x83ff6a(0x150)]),delete _0x2f9ae1[_0x83ff6a(0x150)]);_0x347afb[_0x83ff6a(0x15d)]&&(_0x347afb['wallets'][_0x83ff6a(0x151)]!==undefined&&(_0x2f9ae1[_0x83ff6a(0x151)]=_0x347afb['wallets'][_0x83ff6a(0x151)]||null),_0x347afb[_0x83ff6a(0x15d)]['usdtTrcWallet']!==undefined&&(_0x2f9ae1[_0x83ff6a(0x168)]=_0x347afb['wallets'][_0x83ff6a(0x168)]||null),_0x347afb['wallets'][_0x83ff6a(0x144)]!==undefined&&(_0x2f9ae1['usdtErcWallet']=_0x347afb[_0x83ff6a(0x15d)]['usdtErcWallet']||null),_0x347afb[_0x83ff6a(0x15d)][_0x83ff6a(0x141)]!==undefined&&(_0x2f9ae1[_0x83ff6a(0x141)]=_0x347afb[_0x83ff6a(0x15d)][_0x83ff6a(0x141)]||null),delete _0x2f9ae1[_0x83ff6a(0x15d)]);const _0x3e9fc3=await database_1[_0x83ff6a(0x135)][_0x83ff6a(0x156)]['update']({'where':{'id':_0x5c2499},'data':_0x2f9ae1,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x3e9fc3['id'],'fullName':_0x3e9fc3['name'],'username':_0x3e9fc3[_0x83ff6a(0x153)],'telegramId':_0x3e9fc3[_0x83ff6a(0x13f)],'merchantUrl':_0x3e9fc3['shopUrl'],'gateways':_0x3e9fc3[_0x83ff6a(0x148)]?JSON[_0x83ff6a(0x146)](_0x3e9fc3[_0x83ff6a(0x148)]):null,'gatewaySettings':_0x3e9fc3[_0x83ff6a(0x150)]?JSON[_0x83ff6a(0x146)](_0x3e9fc3[_0x83ff6a(0x150)]):null,'publicKey':_0x3e9fc3[_0x83ff6a(0x15c)],'wallets':{'usdtPolygonWallet':_0x3e9fc3[_0x83ff6a(0x151)],'usdtTrcWallet':_0x3e9fc3[_0x83ff6a(0x168)],'usdtErcWallet':_0x3e9fc3[_0x83ff6a(0x144)],'usdcPolygonWallet':_0x3e9fc3[_0x83ff6a(0x141)]},'status':_0x3e9fc3[_0x83ff6a(0x152)],'createdAt':_0x3e9fc3[_0x83ff6a(0x159)]};}async[a76_0x24dd8e(0x158)](_0x42fddc){const _0x514819=a76_0x24dd8e;await database_1[_0x514819(0x135)][_0x514819(0x156)]['delete']({'where':{'id':_0x42fddc}});}}exports[a76_0x24dd8e(0x134)]=UserService;