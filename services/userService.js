'use strict';function a68_0x2183(){const _0x36e588=['gateways','hash','defineProperty','generateApiKeys','name','default','toString','createdAt','randomBytes','merchantUrl','ACTIVE','wallets','__importDefault','stringify','create','crypto','usdtTrcWallet','status','118004UvqBXD','password','usdtErcWallet','telegramId','findUnique','sk_','3961909GjXSKs','../config/database','161616FgMLVp','paymentGateways','6tkPvew','updateUser','findMany','214810DKaYhM','parse','6303616xGnoIx','365744REblIz','username','pk_','usdcPolygonWallet','update','3466206RAWftG','shop','__esModule','fullName','shopUrl','usdtPolygonWallet','publicKey','desc','UserService','getAllUsers','deleteUser','Telegram\x20username\x20already\x20exists','gatewaySettings','telegram','Username\x20already\x20exists'];a68_0x2183=function(){return _0x36e588;};return a68_0x2183();}const a68_0x54b452=a68_0x1252;(function(_0x11114f,_0x4023bf){const _0x41df86=a68_0x1252,_0x1eb053=_0x11114f();while(!![]){try{const _0x206c95=-parseInt(_0x41df86(0x104))/0x1+-parseInt(_0x41df86(0xfc))/0x2+parseInt(_0x41df86(0xfe))/0x3*(parseInt(_0x41df86(0xf4))/0x4)+-parseInt(_0x41df86(0x101))/0x5+-parseInt(_0x41df86(0x109))/0x6+parseInt(_0x41df86(0xfa))/0x7+parseInt(_0x41df86(0x103))/0x8;if(_0x206c95===_0x4023bf)break;else _0x1eb053['push'](_0x1eb053['shift']());}catch(_0xc0e33a){_0x1eb053['push'](_0x1eb053['shift']());}}}(a68_0x2183,0x5467e));function a68_0x1252(_0x307ada,_0x1dede4){const _0x2183ec=a68_0x2183();return a68_0x1252=function(_0x125240,_0x1f3889){_0x125240=_0x125240-0xdc;let _0x527835=_0x2183ec[_0x125240];return _0x527835;},a68_0x1252(_0x307ada,_0x1dede4);}var __importDefault=this&&this[a68_0x54b452(0xee)]||function(_0x4051a5){const _0x1d1580=a68_0x54b452;return _0x4051a5&&_0x4051a5[_0x1d1580(0x10b)]?_0x4051a5:{'default':_0x4051a5};};Object[a68_0x54b452(0xe4)](exports,a68_0x54b452(0x10b),{'value':!![]}),exports[a68_0x54b452(0x111)]=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),crypto_1=__importDefault(require(a68_0x54b452(0xf1))),database_1=__importDefault(require(a68_0x54b452(0xfb)));class UserService{['generateApiKeys'](){const _0x5d58e2=a68_0x54b452,_0x2d83f9=_0x5d58e2(0x106)+crypto_1[_0x5d58e2(0xe7)][_0x5d58e2(0xea)](0x20)[_0x5d58e2(0xe8)]('hex'),_0x3ca3f9=_0x5d58e2(0xf9)+crypto_1[_0x5d58e2(0xe7)]['randomBytes'](0x20)['toString']('hex');return{'publicKey':_0x2d83f9,'secretKey':_0x3ca3f9};}async['createUser'](_0x1c5839){const _0x2d51f9=a68_0x54b452,{fullName:_0x86807b,username:_0xb57e95,password:_0x5cf417,telegramId:_0x5c7986,merchantUrl:_0x2b3daf,gateways:_0x256a3d,gatewaySettings:_0x44bf2d,wallets:_0x14fdf9}=_0x1c5839,_0x3b9463=await database_1[_0x2d51f9(0xe7)][_0x2d51f9(0x10a)][_0x2d51f9(0xf8)]({'where':{'username':_0xb57e95}});if(_0x3b9463)throw new Error(_0x2d51f9(0xe1));if(_0x5c7986){const _0x1cfd4b=await database_1[_0x2d51f9(0xe7)][_0x2d51f9(0x10a)][_0x2d51f9(0xf8)]({'where':{'telegram':_0x5c7986}});if(_0x1cfd4b)throw new Error(_0x2d51f9(0xde));}const _0x2c87c8=await bcryptjs_1[_0x2d51f9(0xe7)]['hash'](_0x5cf417,0xc),{publicKey:_0x2ec3e3,secretKey:_0x1b8924}=this[_0x2d51f9(0xe5)](),_0x1c0cee=await database_1['default'][_0x2d51f9(0x10a)][_0x2d51f9(0xf0)]({'data':{'name':_0x86807b,'username':_0xb57e95,'password':_0x2c87c8,'telegram':_0x5c7986,'shopUrl':_0x2b3daf,'paymentGateways':_0x256a3d?JSON[_0x2d51f9(0xef)](_0x256a3d):null,'gatewaySettings':_0x44bf2d?JSON[_0x2d51f9(0xef)](_0x44bf2d):null,'usdtPolygonWallet':_0x14fdf9?.['usdtPolygonWallet']||null,'usdtTrcWallet':_0x14fdf9?.[_0x2d51f9(0xf2)]||null,'usdtErcWallet':_0x14fdf9?.[_0x2d51f9(0xf6)]||null,'usdcPolygonWallet':_0x14fdf9?.['usdcPolygonWallet']||null,'publicKey':_0x2ec3e3,'secretKey':_0x1b8924,'status':_0x2d51f9(0xec)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x1c0cee['id'],'fullName':_0x1c0cee['name'],'username':_0x1c0cee[_0x2d51f9(0x105)],'telegramId':_0x1c0cee[_0x2d51f9(0xe0)],'merchantUrl':_0x1c0cee['shopUrl'],'gateways':_0x1c0cee[_0x2d51f9(0xfd)]?JSON[_0x2d51f9(0x102)](_0x1c0cee[_0x2d51f9(0xfd)]):null,'gatewaySettings':_0x1c0cee[_0x2d51f9(0xdf)]?JSON[_0x2d51f9(0x102)](_0x1c0cee[_0x2d51f9(0xdf)]):null,'publicKey':_0x1c0cee[_0x2d51f9(0x10f)],'wallets':{'usdtPolygonWallet':_0x1c0cee[_0x2d51f9(0x10e)],'usdtTrcWallet':_0x1c0cee[_0x2d51f9(0xf2)],'usdtErcWallet':_0x1c0cee[_0x2d51f9(0xf6)],'usdcPolygonWallet':_0x1c0cee[_0x2d51f9(0x107)]},'status':_0x1c0cee[_0x2d51f9(0xf3)],'createdAt':_0x1c0cee[_0x2d51f9(0xe9)]};}async[a68_0x54b452(0xdc)](){const _0x410f6f=a68_0x54b452,_0x561457=await database_1['default'][_0x410f6f(0x10a)][_0x410f6f(0x100)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x410f6f(0x110)}});return _0x561457['map'](_0x1012fe=>({'id':_0x1012fe['id'],'fullName':_0x1012fe['name'],'username':_0x1012fe[_0x410f6f(0x105)],'telegramId':_0x1012fe[_0x410f6f(0xe0)],'merchantUrl':_0x1012fe[_0x410f6f(0x10d)],'gateways':_0x1012fe[_0x410f6f(0xfd)]?JSON[_0x410f6f(0x102)](_0x1012fe['paymentGateways']):null,'gatewaySettings':_0x1012fe[_0x410f6f(0xdf)]?JSON[_0x410f6f(0x102)](_0x1012fe[_0x410f6f(0xdf)]):null,'publicKey':_0x1012fe[_0x410f6f(0x10f)],'wallets':{'usdtPolygonWallet':_0x1012fe[_0x410f6f(0x10e)],'usdtTrcWallet':_0x1012fe['usdtTrcWallet'],'usdtErcWallet':_0x1012fe['usdtErcWallet'],'usdcPolygonWallet':_0x1012fe[_0x410f6f(0x107)]},'status':_0x1012fe['status'],'createdAt':_0x1012fe['createdAt']}));}async['getUserById'](_0x1afde4){const _0x11ab67=a68_0x54b452,_0x4de44a=await database_1[_0x11ab67(0xe7)][_0x11ab67(0x10a)][_0x11ab67(0xf8)]({'where':{'id':_0x1afde4},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x4de44a)return null;return{'id':_0x4de44a['id'],'fullName':_0x4de44a[_0x11ab67(0xe6)],'username':_0x4de44a[_0x11ab67(0x105)],'telegramId':_0x4de44a[_0x11ab67(0xe0)],'merchantUrl':_0x4de44a[_0x11ab67(0x10d)],'gateways':_0x4de44a[_0x11ab67(0xfd)]?JSON['parse'](_0x4de44a['paymentGateways']):null,'gatewaySettings':_0x4de44a[_0x11ab67(0xdf)]?JSON['parse'](_0x4de44a['gatewaySettings']):null,'publicKey':_0x4de44a[_0x11ab67(0x10f)],'wallets':{'usdtPolygonWallet':_0x4de44a[_0x11ab67(0x10e)],'usdtTrcWallet':_0x4de44a['usdtTrcWallet'],'usdtErcWallet':_0x4de44a[_0x11ab67(0xf6)],'usdcPolygonWallet':_0x4de44a[_0x11ab67(0x107)]},'status':_0x4de44a[_0x11ab67(0xf3)],'createdAt':_0x4de44a['createdAt']};}async[a68_0x54b452(0xff)](_0x284ab4,_0x494399){const _0x4f69ea=a68_0x54b452,_0x57c924={..._0x494399};_0x494399[_0x4f69ea(0xf5)]&&(_0x57c924[_0x4f69ea(0xf5)]=await bcryptjs_1['default'][_0x4f69ea(0xe3)](_0x494399[_0x4f69ea(0xf5)],0xc));_0x494399[_0x4f69ea(0x10c)]&&(_0x57c924[_0x4f69ea(0xe6)]=_0x494399[_0x4f69ea(0x10c)],delete _0x57c924[_0x4f69ea(0x10c)]);_0x494399[_0x4f69ea(0xf7)]&&(_0x57c924[_0x4f69ea(0xe0)]=_0x494399[_0x4f69ea(0xf7)],delete _0x57c924[_0x4f69ea(0xf7)]);_0x494399[_0x4f69ea(0xeb)]&&(_0x57c924[_0x4f69ea(0x10d)]=_0x494399['merchantUrl'],delete _0x57c924[_0x4f69ea(0xeb)]);_0x494399[_0x4f69ea(0xe2)]&&(_0x57c924['paymentGateways']=JSON[_0x4f69ea(0xef)](_0x494399[_0x4f69ea(0xe2)]),delete _0x57c924['gateways']);_0x494399[_0x4f69ea(0xdf)]&&(_0x57c924[_0x4f69ea(0xdf)]=JSON[_0x4f69ea(0xef)](_0x494399[_0x4f69ea(0xdf)]),delete _0x57c924[_0x4f69ea(0xdf)]);_0x494399['wallets']&&(_0x494399['wallets'][_0x4f69ea(0x10e)]!==undefined&&(_0x57c924[_0x4f69ea(0x10e)]=_0x494399[_0x4f69ea(0xed)][_0x4f69ea(0x10e)]||null),_0x494399[_0x4f69ea(0xed)]['usdtTrcWallet']!==undefined&&(_0x57c924[_0x4f69ea(0xf2)]=_0x494399[_0x4f69ea(0xed)][_0x4f69ea(0xf2)]||null),_0x494399['wallets'][_0x4f69ea(0xf6)]!==undefined&&(_0x57c924[_0x4f69ea(0xf6)]=_0x494399['wallets'][_0x4f69ea(0xf6)]||null),_0x494399[_0x4f69ea(0xed)]['usdcPolygonWallet']!==undefined&&(_0x57c924[_0x4f69ea(0x107)]=_0x494399[_0x4f69ea(0xed)][_0x4f69ea(0x107)]||null),delete _0x57c924[_0x4f69ea(0xed)]);const _0x3ac5f0=await database_1[_0x4f69ea(0xe7)]['shop'][_0x4f69ea(0x108)]({'where':{'id':_0x284ab4},'data':_0x57c924,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x3ac5f0['id'],'fullName':_0x3ac5f0[_0x4f69ea(0xe6)],'username':_0x3ac5f0[_0x4f69ea(0x105)],'telegramId':_0x3ac5f0['telegram'],'merchantUrl':_0x3ac5f0[_0x4f69ea(0x10d)],'gateways':_0x3ac5f0['paymentGateways']?JSON[_0x4f69ea(0x102)](_0x3ac5f0[_0x4f69ea(0xfd)]):null,'gatewaySettings':_0x3ac5f0[_0x4f69ea(0xdf)]?JSON[_0x4f69ea(0x102)](_0x3ac5f0[_0x4f69ea(0xdf)]):null,'publicKey':_0x3ac5f0[_0x4f69ea(0x10f)],'wallets':{'usdtPolygonWallet':_0x3ac5f0[_0x4f69ea(0x10e)],'usdtTrcWallet':_0x3ac5f0[_0x4f69ea(0xf2)],'usdtErcWallet':_0x3ac5f0[_0x4f69ea(0xf6)],'usdcPolygonWallet':_0x3ac5f0[_0x4f69ea(0x107)]},'status':_0x3ac5f0['status'],'createdAt':_0x3ac5f0[_0x4f69ea(0xe9)]};}async[a68_0x54b452(0xdd)](_0x3e0260){const _0xb56942=a68_0x54b452;await database_1[_0xb56942(0xe7)][_0xb56942(0x10a)]['delete']({'where':{'id':_0x3e0260}});}}exports[a68_0x54b452(0x111)]=UserService;