'use strict';const a56_0x53bcb9=a56_0x5cd6;(function(_0x4b352e,_0x44d4ae){const _0x49b22d=a56_0x5cd6,_0x2c9db7=_0x4b352e();while(!![]){try{const _0x5e2352=-parseInt(_0x49b22d(0xc2))/0x1+-parseInt(_0x49b22d(0xc4))/0x2*(parseInt(_0x49b22d(0xd8))/0x3)+parseInt(_0x49b22d(0xd5))/0x4+parseInt(_0x49b22d(0xd4))/0x5+parseInt(_0x49b22d(0xe0))/0x6*(parseInt(_0x49b22d(0xd9))/0x7)+parseInt(_0x49b22d(0xe5))/0x8*(parseInt(_0x49b22d(0xdb))/0x9)+parseInt(_0x49b22d(0xcd))/0xa*(-parseInt(_0x49b22d(0xde))/0xb);if(_0x5e2352===_0x44d4ae)break;else _0x2c9db7['push'](_0x2c9db7['shift']());}catch(_0x3fe384){_0x2c9db7['push'](_0x2c9db7['shift']());}}}(a56_0x9bb6,0xddfba));function a56_0x9bb6(){const _0x587e3a=['usdcPolygonWallet','Telegram\x20username\x20already\x20exists','getUserById','createUser','telegramId','usdtErcWallet','update','usdtTrcWallet','__esModule','findUnique','../config/database','stringify','hash','shop','wallets','bcryptjs','UserService','Username\x20already\x20exists','206859mVPBkB','deleteUser','1165314HkkKTi','gatewaySettings','sk_','randomBytes','getAllUsers','shopUrl','default','merchantUrl','pk_','34990VeHDPP','username','parse','__importDefault','usdtPolygonWallet','password','telegram','632290DZAbXt','4572540XXdIZC','status','gateways','6RJItpm','151088beXJyd','ACTIVE','9ExwwWX','createdAt','toString','1485QLLSAe','paymentGateways','30AadIWq','hex','create','fullName','generateApiKeys','11010136bVfKCo','publicKey','map','defineProperty','findMany','name'];a56_0x9bb6=function(){return _0x587e3a;};return a56_0x9bb6();}var __importDefault=this&&this[a56_0x53bcb9(0xd0)]||function(_0x1c1d9f){const _0x3e05fb=a56_0x53bcb9;return _0x1c1d9f&&_0x1c1d9f[_0x3e05fb(0xf3)]?_0x1c1d9f:{'default':_0x1c1d9f};};Object[a56_0x53bcb9(0xe8)](exports,a56_0x53bcb9(0xf3),{'value':!![]}),exports[a56_0x53bcb9(0xc0)]=void 0x0;const bcryptjs_1=__importDefault(require(a56_0x53bcb9(0xfa))),crypto_1=__importDefault(require('crypto')),database_1=__importDefault(require(a56_0x53bcb9(0xf5)));class UserService{[a56_0x53bcb9(0xe4)](){const _0x234379=a56_0x53bcb9,_0x52f2d4=_0x234379(0xcc)+crypto_1[_0x234379(0xca)]['randomBytes'](0x20)[_0x234379(0xdd)](_0x234379(0xe1)),_0x56d82b=_0x234379(0xc6)+crypto_1[_0x234379(0xca)][_0x234379(0xc7)](0x20)['toString'](_0x234379(0xe1));return{'publicKey':_0x52f2d4,'secretKey':_0x56d82b};}async[a56_0x53bcb9(0xee)](_0x227973){const _0x2ff5a1=a56_0x53bcb9,{fullName:_0x4bfc1f,username:_0x3e9b90,password:_0x43c7f1,telegramId:_0x4b1807,merchantUrl:_0x20b4e3,gateways:_0x2d0eed,gatewaySettings:_0x5792e4,wallets:_0x19d81c}=_0x227973,_0x31513d=await database_1[_0x2ff5a1(0xca)][_0x2ff5a1(0xf8)]['findUnique']({'where':{'username':_0x3e9b90}});if(_0x31513d)throw new Error(_0x2ff5a1(0xc1));if(_0x4b1807){const _0x54315b=await database_1[_0x2ff5a1(0xca)][_0x2ff5a1(0xf8)][_0x2ff5a1(0xf4)]({'where':{'telegram':_0x4b1807}});if(_0x54315b)throw new Error(_0x2ff5a1(0xec));}const _0x376f8e=await bcryptjs_1[_0x2ff5a1(0xca)][_0x2ff5a1(0xf7)](_0x43c7f1,0xc),{publicKey:_0x1c055c,secretKey:_0x5278df}=this['generateApiKeys'](),_0x22c2ad=await database_1[_0x2ff5a1(0xca)]['shop'][_0x2ff5a1(0xe2)]({'data':{'name':_0x4bfc1f,'username':_0x3e9b90,'password':_0x376f8e,'telegram':_0x4b1807,'shopUrl':_0x20b4e3,'paymentGateways':_0x2d0eed?JSON[_0x2ff5a1(0xf6)](_0x2d0eed):null,'gatewaySettings':_0x5792e4?JSON[_0x2ff5a1(0xf6)](_0x5792e4):null,'usdtPolygonWallet':_0x19d81c?.[_0x2ff5a1(0xd1)]||null,'usdtTrcWallet':_0x19d81c?.[_0x2ff5a1(0xf2)]||null,'usdtErcWallet':_0x19d81c?.[_0x2ff5a1(0xf0)]||null,'usdcPolygonWallet':_0x19d81c?.[_0x2ff5a1(0xeb)]||null,'publicKey':_0x1c055c,'secretKey':_0x5278df,'status':_0x2ff5a1(0xda)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x22c2ad['id'],'fullName':_0x22c2ad[_0x2ff5a1(0xea)],'username':_0x22c2ad[_0x2ff5a1(0xce)],'telegramId':_0x22c2ad[_0x2ff5a1(0xd3)],'merchantUrl':_0x22c2ad[_0x2ff5a1(0xc9)],'gateways':_0x22c2ad[_0x2ff5a1(0xdf)]?JSON['parse'](_0x22c2ad[_0x2ff5a1(0xdf)]):null,'gatewaySettings':_0x22c2ad['gatewaySettings']?JSON[_0x2ff5a1(0xcf)](_0x22c2ad[_0x2ff5a1(0xc5)]):null,'publicKey':_0x22c2ad['publicKey'],'wallets':{'usdtPolygonWallet':_0x22c2ad[_0x2ff5a1(0xd1)],'usdtTrcWallet':_0x22c2ad[_0x2ff5a1(0xf2)],'usdtErcWallet':_0x22c2ad['usdtErcWallet'],'usdcPolygonWallet':_0x22c2ad[_0x2ff5a1(0xeb)]},'status':_0x22c2ad[_0x2ff5a1(0xd6)],'createdAt':_0x22c2ad[_0x2ff5a1(0xdc)]};}async[a56_0x53bcb9(0xc8)](){const _0x257de0=a56_0x53bcb9,_0xf570be=await database_1[_0x257de0(0xca)]['shop'][_0x257de0(0xe9)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':'desc'}});return _0xf570be[_0x257de0(0xe7)](_0x22a73e=>({'id':_0x22a73e['id'],'fullName':_0x22a73e['name'],'username':_0x22a73e[_0x257de0(0xce)],'telegramId':_0x22a73e[_0x257de0(0xd3)],'merchantUrl':_0x22a73e[_0x257de0(0xc9)],'gateways':_0x22a73e[_0x257de0(0xdf)]?JSON[_0x257de0(0xcf)](_0x22a73e[_0x257de0(0xdf)]):null,'gatewaySettings':_0x22a73e[_0x257de0(0xc5)]?JSON[_0x257de0(0xcf)](_0x22a73e[_0x257de0(0xc5)]):null,'publicKey':_0x22a73e[_0x257de0(0xe6)],'wallets':{'usdtPolygonWallet':_0x22a73e['usdtPolygonWallet'],'usdtTrcWallet':_0x22a73e[_0x257de0(0xf2)],'usdtErcWallet':_0x22a73e[_0x257de0(0xf0)],'usdcPolygonWallet':_0x22a73e['usdcPolygonWallet']},'status':_0x22a73e['status'],'createdAt':_0x22a73e['createdAt']}));}async[a56_0x53bcb9(0xed)](_0x59c506){const _0x7a0380=a56_0x53bcb9,_0x2458f9=await database_1[_0x7a0380(0xca)][_0x7a0380(0xf8)][_0x7a0380(0xf4)]({'where':{'id':_0x59c506},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x2458f9)return null;return{'id':_0x2458f9['id'],'fullName':_0x2458f9[_0x7a0380(0xea)],'username':_0x2458f9[_0x7a0380(0xce)],'telegramId':_0x2458f9['telegram'],'merchantUrl':_0x2458f9[_0x7a0380(0xc9)],'gateways':_0x2458f9[_0x7a0380(0xdf)]?JSON[_0x7a0380(0xcf)](_0x2458f9['paymentGateways']):null,'gatewaySettings':_0x2458f9[_0x7a0380(0xc5)]?JSON[_0x7a0380(0xcf)](_0x2458f9[_0x7a0380(0xc5)]):null,'publicKey':_0x2458f9[_0x7a0380(0xe6)],'wallets':{'usdtPolygonWallet':_0x2458f9[_0x7a0380(0xd1)],'usdtTrcWallet':_0x2458f9[_0x7a0380(0xf2)],'usdtErcWallet':_0x2458f9[_0x7a0380(0xf0)],'usdcPolygonWallet':_0x2458f9[_0x7a0380(0xeb)]},'status':_0x2458f9[_0x7a0380(0xd6)],'createdAt':_0x2458f9[_0x7a0380(0xdc)]};}async['updateUser'](_0x2b1343,_0x3dc65f){const _0x21ba70=a56_0x53bcb9,_0x2740c1={..._0x3dc65f};_0x3dc65f[_0x21ba70(0xd2)]&&(_0x2740c1['password']=await bcryptjs_1[_0x21ba70(0xca)][_0x21ba70(0xf7)](_0x3dc65f['password'],0xc));_0x3dc65f[_0x21ba70(0xe3)]&&(_0x2740c1[_0x21ba70(0xea)]=_0x3dc65f['fullName'],delete _0x2740c1['fullName']);_0x3dc65f['telegramId']&&(_0x2740c1[_0x21ba70(0xd3)]=_0x3dc65f[_0x21ba70(0xef)],delete _0x2740c1[_0x21ba70(0xef)]);_0x3dc65f[_0x21ba70(0xcb)]&&(_0x2740c1[_0x21ba70(0xc9)]=_0x3dc65f[_0x21ba70(0xcb)],delete _0x2740c1[_0x21ba70(0xcb)]);_0x3dc65f[_0x21ba70(0xd7)]&&(_0x2740c1['paymentGateways']=JSON[_0x21ba70(0xf6)](_0x3dc65f[_0x21ba70(0xd7)]),delete _0x2740c1[_0x21ba70(0xd7)]);_0x3dc65f[_0x21ba70(0xc5)]&&(_0x2740c1[_0x21ba70(0xc5)]=JSON[_0x21ba70(0xf6)](_0x3dc65f['gatewaySettings']),delete _0x2740c1[_0x21ba70(0xc5)]);_0x3dc65f['wallets']&&(_0x3dc65f[_0x21ba70(0xf9)][_0x21ba70(0xd1)]!==undefined&&(_0x2740c1[_0x21ba70(0xd1)]=_0x3dc65f[_0x21ba70(0xf9)]['usdtPolygonWallet']||null),_0x3dc65f[_0x21ba70(0xf9)][_0x21ba70(0xf2)]!==undefined&&(_0x2740c1[_0x21ba70(0xf2)]=_0x3dc65f['wallets'][_0x21ba70(0xf2)]||null),_0x3dc65f[_0x21ba70(0xf9)][_0x21ba70(0xf0)]!==undefined&&(_0x2740c1[_0x21ba70(0xf0)]=_0x3dc65f[_0x21ba70(0xf9)][_0x21ba70(0xf0)]||null),_0x3dc65f[_0x21ba70(0xf9)][_0x21ba70(0xeb)]!==undefined&&(_0x2740c1[_0x21ba70(0xeb)]=_0x3dc65f['wallets']['usdcPolygonWallet']||null),delete _0x2740c1[_0x21ba70(0xf9)]);const _0x6c55f4=await database_1[_0x21ba70(0xca)][_0x21ba70(0xf8)][_0x21ba70(0xf1)]({'where':{'id':_0x2b1343},'data':_0x2740c1,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x6c55f4['id'],'fullName':_0x6c55f4['name'],'username':_0x6c55f4[_0x21ba70(0xce)],'telegramId':_0x6c55f4[_0x21ba70(0xd3)],'merchantUrl':_0x6c55f4[_0x21ba70(0xc9)],'gateways':_0x6c55f4['paymentGateways']?JSON[_0x21ba70(0xcf)](_0x6c55f4[_0x21ba70(0xdf)]):null,'gatewaySettings':_0x6c55f4['gatewaySettings']?JSON[_0x21ba70(0xcf)](_0x6c55f4[_0x21ba70(0xc5)]):null,'publicKey':_0x6c55f4[_0x21ba70(0xe6)],'wallets':{'usdtPolygonWallet':_0x6c55f4[_0x21ba70(0xd1)],'usdtTrcWallet':_0x6c55f4[_0x21ba70(0xf2)],'usdtErcWallet':_0x6c55f4['usdtErcWallet'],'usdcPolygonWallet':_0x6c55f4[_0x21ba70(0xeb)]},'status':_0x6c55f4[_0x21ba70(0xd6)],'createdAt':_0x6c55f4[_0x21ba70(0xdc)]};}async[a56_0x53bcb9(0xc3)](_0x277331){const _0x570ab0=a56_0x53bcb9;await database_1['default'][_0x570ab0(0xf8)]['delete']({'where':{'id':_0x277331}});}}function a56_0x5cd6(_0x4dbd5c,_0x490d7d){const _0x9bb632=a56_0x9bb6();return a56_0x5cd6=function(_0x5cd624,_0x48844d){_0x5cd624=_0x5cd624-0xc0;let _0x41796c=_0x9bb632[_0x5cd624];return _0x41796c;},a56_0x5cd6(_0x4dbd5c,_0x490d7d);}exports[a56_0x53bcb9(0xc0)]=UserService;