'use strict';const a76_0x12dd12=a76_0x5058;function a76_0x46f7(){const _0x335113=['usdcPolygonWallet','sk_','usdtErcWallet','usdtPolygonWallet','map','deleteUser','delete','stringify','5324848WfgmXj','Username\x20already\x20exists','__importDefault','__esModule','publicKey','createUser','fullName','paymentGateways','create','username','defineProperty','telegramId','ACTIVE','28llhzkC','usdtTrcWallet','1908ElolwS','gatewaySettings','36FnkbPI','bcryptjs','default','3689690CkPdtB','password','hex','wallets','UserService','shop','telegram','476094KeOgPx','gateways','14304890yPLIHu','getUserById','status','../config/database','randomBytes','toString','update','createdAt','parse','desc','15421PUlGRG','merchantUrl','name','3652515jsWXCL','findMany','12044sKmfdB','shopUrl','pk_','hash','findUnique','updateUser','generateApiKeys'];a76_0x46f7=function(){return _0x335113;};return a76_0x46f7();}(function(_0x4ef9cb,_0x2b472b){const _0x249206=a76_0x5058,_0x490757=_0x4ef9cb();while(!![]){try{const _0x54b92f=-parseInt(_0x249206(0x158))/0x1*(parseInt(_0x249206(0x178))/0x2)+parseInt(_0x249206(0x182))/0x3*(parseInt(_0x249206(0x174))/0x4)+parseInt(_0x249206(0x17b))/0x5+-parseInt(_0x249206(0x176))/0x6*(parseInt(_0x249206(0x153))/0x7)+parseInt(_0x249206(0x167))/0x8+parseInt(_0x249206(0x156))/0x9+-parseInt(_0x249206(0x184))/0xa;if(_0x54b92f===_0x2b472b)break;else _0x490757['push'](_0x490757['shift']());}catch(_0x4fe8a3){_0x490757['push'](_0x490757['shift']());}}}(a76_0x46f7,0x8bc0e));function a76_0x5058(_0xbb0e92,_0x195cfe){_0xbb0e92=_0xbb0e92-0x14d;const _0x46f728=a76_0x46f7();let _0x505838=_0x46f728[_0xbb0e92];return _0x505838;}var __importDefault=this&&this[a76_0x12dd12(0x169)]||function(_0x27c9af){const _0x18269c=a76_0x12dd12;return _0x27c9af&&_0x27c9af[_0x18269c(0x16a)]?_0x27c9af:{'default':_0x27c9af};};Object[a76_0x12dd12(0x171)](exports,a76_0x12dd12(0x16a),{'value':!![]}),exports[a76_0x12dd12(0x17f)]=void 0x0;const bcryptjs_1=__importDefault(require(a76_0x12dd12(0x179))),crypto_1=__importDefault(require('crypto')),database_1=__importDefault(require(a76_0x12dd12(0x187)));class UserService{[a76_0x12dd12(0x15e)](){const _0x22cda7=a76_0x12dd12,_0x7f1aee=_0x22cda7(0x15a)+crypto_1[_0x22cda7(0x17a)][_0x22cda7(0x14d)](0x20)[_0x22cda7(0x14e)](_0x22cda7(0x17d)),_0x4184bf=_0x22cda7(0x160)+crypto_1[_0x22cda7(0x17a)][_0x22cda7(0x14d)](0x20)[_0x22cda7(0x14e)](_0x22cda7(0x17d));return{'publicKey':_0x7f1aee,'secretKey':_0x4184bf};}async[a76_0x12dd12(0x16c)](_0x51cb99){const _0x34d7e1=a76_0x12dd12,{fullName:_0x19aa37,username:_0x30edcc,password:_0x5bc87b,telegramId:_0x2513c5,merchantUrl:_0x392f88,gateways:_0xb5dc58,gatewaySettings:_0x3bb96e,wallets:_0x10822a}=_0x51cb99,_0x5da1b4=await database_1['default']['shop'][_0x34d7e1(0x15c)]({'where':{'username':_0x30edcc}});if(_0x5da1b4)throw new Error(_0x34d7e1(0x168));if(_0x2513c5){const _0x338e82=await database_1['default'][_0x34d7e1(0x180)][_0x34d7e1(0x15c)]({'where':{'telegram':_0x2513c5}});if(_0x338e82)throw new Error('Telegram\x20username\x20already\x20exists');}const _0x18f2c2=await bcryptjs_1['default'][_0x34d7e1(0x15b)](_0x5bc87b,0xc),{publicKey:_0x5a1673,secretKey:_0x30bedf}=this[_0x34d7e1(0x15e)](),_0x483b85=await database_1[_0x34d7e1(0x17a)]['shop'][_0x34d7e1(0x16f)]({'data':{'name':_0x19aa37,'username':_0x30edcc,'password':_0x18f2c2,'telegram':_0x2513c5,'shopUrl':_0x392f88,'paymentGateways':_0xb5dc58?JSON[_0x34d7e1(0x166)](_0xb5dc58):null,'gatewaySettings':_0x3bb96e?JSON[_0x34d7e1(0x166)](_0x3bb96e):null,'usdtPolygonWallet':_0x10822a?.[_0x34d7e1(0x162)]||null,'usdtTrcWallet':_0x10822a?.[_0x34d7e1(0x175)]||null,'usdtErcWallet':_0x10822a?.['usdtErcWallet']||null,'usdcPolygonWallet':_0x10822a?.[_0x34d7e1(0x15f)]||null,'publicKey':_0x5a1673,'secretKey':_0x30bedf,'status':_0x34d7e1(0x173)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x483b85['id'],'fullName':_0x483b85[_0x34d7e1(0x155)],'username':_0x483b85['username'],'telegramId':_0x483b85[_0x34d7e1(0x181)],'merchantUrl':_0x483b85['shopUrl'],'gateways':_0x483b85[_0x34d7e1(0x16e)]?JSON[_0x34d7e1(0x151)](_0x483b85[_0x34d7e1(0x16e)]):null,'gatewaySettings':_0x483b85[_0x34d7e1(0x177)]?JSON[_0x34d7e1(0x151)](_0x483b85[_0x34d7e1(0x177)]):null,'publicKey':_0x483b85[_0x34d7e1(0x16b)],'wallets':{'usdtPolygonWallet':_0x483b85[_0x34d7e1(0x162)],'usdtTrcWallet':_0x483b85[_0x34d7e1(0x175)],'usdtErcWallet':_0x483b85['usdtErcWallet'],'usdcPolygonWallet':_0x483b85[_0x34d7e1(0x15f)]},'status':_0x483b85['status'],'createdAt':_0x483b85[_0x34d7e1(0x150)]};}async['getAllUsers'](){const _0x134915=a76_0x12dd12,_0x550214=await database_1[_0x134915(0x17a)][_0x134915(0x180)][_0x134915(0x157)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x134915(0x152)}});return _0x550214[_0x134915(0x163)](_0x3f0d93=>({'id':_0x3f0d93['id'],'fullName':_0x3f0d93[_0x134915(0x155)],'username':_0x3f0d93[_0x134915(0x170)],'telegramId':_0x3f0d93[_0x134915(0x181)],'merchantUrl':_0x3f0d93['shopUrl'],'gateways':_0x3f0d93['paymentGateways']?JSON[_0x134915(0x151)](_0x3f0d93[_0x134915(0x16e)]):null,'gatewaySettings':_0x3f0d93['gatewaySettings']?JSON[_0x134915(0x151)](_0x3f0d93[_0x134915(0x177)]):null,'publicKey':_0x3f0d93[_0x134915(0x16b)],'wallets':{'usdtPolygonWallet':_0x3f0d93[_0x134915(0x162)],'usdtTrcWallet':_0x3f0d93[_0x134915(0x175)],'usdtErcWallet':_0x3f0d93[_0x134915(0x161)],'usdcPolygonWallet':_0x3f0d93[_0x134915(0x15f)]},'status':_0x3f0d93['status'],'createdAt':_0x3f0d93[_0x134915(0x150)]}));}async[a76_0x12dd12(0x185)](_0x12ad36){const _0x13d9d7=a76_0x12dd12,_0xea475d=await database_1[_0x13d9d7(0x17a)][_0x13d9d7(0x180)][_0x13d9d7(0x15c)]({'where':{'id':_0x12ad36},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0xea475d)return null;return{'id':_0xea475d['id'],'fullName':_0xea475d[_0x13d9d7(0x155)],'username':_0xea475d[_0x13d9d7(0x170)],'telegramId':_0xea475d[_0x13d9d7(0x181)],'merchantUrl':_0xea475d[_0x13d9d7(0x159)],'gateways':_0xea475d[_0x13d9d7(0x16e)]?JSON[_0x13d9d7(0x151)](_0xea475d[_0x13d9d7(0x16e)]):null,'gatewaySettings':_0xea475d[_0x13d9d7(0x177)]?JSON[_0x13d9d7(0x151)](_0xea475d[_0x13d9d7(0x177)]):null,'publicKey':_0xea475d[_0x13d9d7(0x16b)],'wallets':{'usdtPolygonWallet':_0xea475d[_0x13d9d7(0x162)],'usdtTrcWallet':_0xea475d[_0x13d9d7(0x175)],'usdtErcWallet':_0xea475d['usdtErcWallet'],'usdcPolygonWallet':_0xea475d[_0x13d9d7(0x15f)]},'status':_0xea475d[_0x13d9d7(0x186)],'createdAt':_0xea475d[_0x13d9d7(0x150)]};}async[a76_0x12dd12(0x15d)](_0x2bd754,_0x4f6e66){const _0x16aa03=a76_0x12dd12,_0x5880ec={..._0x4f6e66};_0x4f6e66['password']&&(_0x5880ec[_0x16aa03(0x17c)]=await bcryptjs_1[_0x16aa03(0x17a)][_0x16aa03(0x15b)](_0x4f6e66[_0x16aa03(0x17c)],0xc));_0x4f6e66[_0x16aa03(0x16d)]&&(_0x5880ec[_0x16aa03(0x155)]=_0x4f6e66[_0x16aa03(0x16d)],delete _0x5880ec['fullName']);_0x4f6e66['telegramId']&&(_0x5880ec[_0x16aa03(0x181)]=_0x4f6e66[_0x16aa03(0x172)],delete _0x5880ec['telegramId']);_0x4f6e66[_0x16aa03(0x154)]&&(_0x5880ec['shopUrl']=_0x4f6e66['merchantUrl'],delete _0x5880ec[_0x16aa03(0x154)]);_0x4f6e66['gateways']&&(_0x5880ec[_0x16aa03(0x16e)]=JSON['stringify'](_0x4f6e66[_0x16aa03(0x183)]),delete _0x5880ec[_0x16aa03(0x183)]);_0x4f6e66[_0x16aa03(0x177)]&&(_0x5880ec[_0x16aa03(0x177)]=JSON[_0x16aa03(0x166)](_0x4f6e66[_0x16aa03(0x177)]),delete _0x5880ec[_0x16aa03(0x177)]);_0x4f6e66[_0x16aa03(0x17e)]&&(_0x4f6e66[_0x16aa03(0x17e)][_0x16aa03(0x162)]!==undefined&&(_0x5880ec['usdtPolygonWallet']=_0x4f6e66[_0x16aa03(0x17e)][_0x16aa03(0x162)]||null),_0x4f6e66[_0x16aa03(0x17e)][_0x16aa03(0x175)]!==undefined&&(_0x5880ec[_0x16aa03(0x175)]=_0x4f6e66[_0x16aa03(0x17e)][_0x16aa03(0x175)]||null),_0x4f6e66[_0x16aa03(0x17e)]['usdtErcWallet']!==undefined&&(_0x5880ec[_0x16aa03(0x161)]=_0x4f6e66[_0x16aa03(0x17e)]['usdtErcWallet']||null),_0x4f6e66['wallets'][_0x16aa03(0x15f)]!==undefined&&(_0x5880ec[_0x16aa03(0x15f)]=_0x4f6e66[_0x16aa03(0x17e)][_0x16aa03(0x15f)]||null),delete _0x5880ec[_0x16aa03(0x17e)]);const _0x50f524=await database_1[_0x16aa03(0x17a)][_0x16aa03(0x180)][_0x16aa03(0x14f)]({'where':{'id':_0x2bd754},'data':_0x5880ec,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x50f524['id'],'fullName':_0x50f524[_0x16aa03(0x155)],'username':_0x50f524[_0x16aa03(0x170)],'telegramId':_0x50f524['telegram'],'merchantUrl':_0x50f524[_0x16aa03(0x159)],'gateways':_0x50f524[_0x16aa03(0x16e)]?JSON[_0x16aa03(0x151)](_0x50f524[_0x16aa03(0x16e)]):null,'gatewaySettings':_0x50f524['gatewaySettings']?JSON['parse'](_0x50f524[_0x16aa03(0x177)]):null,'publicKey':_0x50f524[_0x16aa03(0x16b)],'wallets':{'usdtPolygonWallet':_0x50f524[_0x16aa03(0x162)],'usdtTrcWallet':_0x50f524[_0x16aa03(0x175)],'usdtErcWallet':_0x50f524[_0x16aa03(0x161)],'usdcPolygonWallet':_0x50f524['usdcPolygonWallet']},'status':_0x50f524[_0x16aa03(0x186)],'createdAt':_0x50f524[_0x16aa03(0x150)]};}async[a76_0x12dd12(0x164)](_0x2dbfb2){const _0x1b19be=a76_0x12dd12;await database_1['default'][_0x1b19be(0x180)][_0x1b19be(0x165)]({'where':{'id':_0x2dbfb2}});}}exports[a76_0x12dd12(0x17f)]=UserService;