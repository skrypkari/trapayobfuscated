'use strict';function a54_0xe955(){const _0x8684e0=['fullName','20VtoBtW','206395WYIqkn','username','usdtErcWallet','5635424QuerDm','name','generateApiKeys','bcryptjs','delete','map','update','pk_','deleteUser','updateUser','findUnique','parse','849oHDPPZ','stringify','37686530edeGej','create','toString','telegramId','16109406vdlAwI','usdtTrcWallet','randomBytes','usdcPolygonWallet','1332055ECUNMz','usdtPolygonWallet','createdAt','defineProperty','Username\x20already\x20exists','password','shop','204OqUuKp','wallets','1642929RWgSZN','telegram','shopUrl','default','__esModule','gatewaySettings','publicKey','Telegram\x20username\x20already\x20exists','merchantUrl','1930TcpxCz','UserService','paymentGateways','gateways','../config/database','crypto','hex'];a54_0xe955=function(){return _0x8684e0;};return a54_0xe955();}const a54_0x204896=a54_0x3f4d;(function(_0x3b63c3,_0x362d66){const _0x4b05c4=a54_0x3f4d,_0x4ba8bb=_0x3b63c3();while(!![]){try{const _0xa9cbb=-parseInt(_0x4b05c4(0x1a1))/0x1+parseInt(_0x4b05c4(0x1aa))/0x2*(parseInt(_0x4b05c4(0x18e))/0x3)+-parseInt(_0x4b05c4(0x1b2))/0x4*(parseInt(_0x4b05c4(0x198))/0x5)+-parseInt(_0x4b05c4(0x19f))/0x6*(-parseInt(_0x4b05c4(0x1b3))/0x7)+parseInt(_0x4b05c4(0x1b6))/0x8+-parseInt(_0x4b05c4(0x194))/0x9+parseInt(_0x4b05c4(0x190))/0xa;if(_0xa9cbb===_0x362d66)break;else _0x4ba8bb['push'](_0x4ba8bb['shift']());}catch(_0x42b1ab){_0x4ba8bb['push'](_0x4ba8bb['shift']());}}}(a54_0xe955,0xf02c4));var __importDefault=this&&this['__importDefault']||function(_0x3505a7){const _0x127254=a54_0x3f4d;return _0x3505a7&&_0x3505a7[_0x127254(0x1a5)]?_0x3505a7:{'default':_0x3505a7};};Object[a54_0x204896(0x19b)](exports,'__esModule',{'value':!![]}),exports[a54_0x204896(0x1ab)]=void 0x0;function a54_0x3f4d(_0x1ee954,_0x8bac96){const _0xe95575=a54_0xe955();return a54_0x3f4d=function(_0x3f4db6,_0x59c591){_0x3f4db6=_0x3f4db6-0x18d;let _0x59d878=_0xe95575[_0x3f4db6];return _0x59d878;},a54_0x3f4d(_0x1ee954,_0x8bac96);}const bcryptjs_1=__importDefault(require(a54_0x204896(0x1b9))),crypto_1=__importDefault(require(a54_0x204896(0x1af))),database_1=__importDefault(require(a54_0x204896(0x1ae)));class UserService{[a54_0x204896(0x1b8)](){const _0x5666ff=a54_0x204896,_0x18c9e2=_0x5666ff(0x1bd)+crypto_1[_0x5666ff(0x1a4)][_0x5666ff(0x196)](0x20)[_0x5666ff(0x192)](_0x5666ff(0x1b0)),_0x5dfefe='sk_'+crypto_1[_0x5666ff(0x1a4)][_0x5666ff(0x196)](0x20)[_0x5666ff(0x192)](_0x5666ff(0x1b0));return{'publicKey':_0x18c9e2,'secretKey':_0x5dfefe};}async['createUser'](_0x5cee73){const _0x3a2b5e=a54_0x204896,{fullName:_0x3fa3d7,username:_0x2b6b39,password:_0xe2d37e,telegramId:_0x18e9ea,merchantUrl:_0x252551,gateways:_0x4f1b6f,gatewaySettings:_0x5b637e,wallets:_0x3613a6}=_0x5cee73,_0x44dffe=await database_1['default'][_0x3a2b5e(0x19e)][_0x3a2b5e(0x1c0)]({'where':{'username':_0x2b6b39}});if(_0x44dffe)throw new Error(_0x3a2b5e(0x19c));if(_0x18e9ea){const _0x2ea5cf=await database_1['default'][_0x3a2b5e(0x19e)][_0x3a2b5e(0x1c0)]({'where':{'telegram':_0x18e9ea}});if(_0x2ea5cf)throw new Error(_0x3a2b5e(0x1a8));}const _0x1c4162=await bcryptjs_1[_0x3a2b5e(0x1a4)]['hash'](_0xe2d37e,0xc),{publicKey:_0x25836a,secretKey:_0x5bce50}=this[_0x3a2b5e(0x1b8)](),_0x1d6973=await database_1[_0x3a2b5e(0x1a4)][_0x3a2b5e(0x19e)][_0x3a2b5e(0x191)]({'data':{'name':_0x3fa3d7,'username':_0x2b6b39,'password':_0x1c4162,'telegram':_0x18e9ea,'shopUrl':_0x252551,'paymentGateways':_0x4f1b6f?JSON['stringify'](_0x4f1b6f):null,'gatewaySettings':_0x5b637e?JSON[_0x3a2b5e(0x18f)](_0x5b637e):null,'usdtPolygonWallet':_0x3613a6?.[_0x3a2b5e(0x199)]||null,'usdtTrcWallet':_0x3613a6?.[_0x3a2b5e(0x195)]||null,'usdtErcWallet':_0x3613a6?.[_0x3a2b5e(0x1b5)]||null,'usdcPolygonWallet':_0x3613a6?.[_0x3a2b5e(0x197)]||null,'publicKey':_0x25836a,'secretKey':_0x5bce50,'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x1d6973['id'],'fullName':_0x1d6973[_0x3a2b5e(0x1b7)],'username':_0x1d6973[_0x3a2b5e(0x1b4)],'telegramId':_0x1d6973[_0x3a2b5e(0x1a2)],'merchantUrl':_0x1d6973['shopUrl'],'gateways':_0x1d6973[_0x3a2b5e(0x1ac)]?JSON[_0x3a2b5e(0x18d)](_0x1d6973[_0x3a2b5e(0x1ac)]):null,'gatewaySettings':_0x1d6973[_0x3a2b5e(0x1a6)]?JSON['parse'](_0x1d6973[_0x3a2b5e(0x1a6)]):null,'publicKey':_0x1d6973[_0x3a2b5e(0x1a7)],'wallets':{'usdtPolygonWallet':_0x1d6973[_0x3a2b5e(0x199)],'usdtTrcWallet':_0x1d6973[_0x3a2b5e(0x195)],'usdtErcWallet':_0x1d6973[_0x3a2b5e(0x1b5)],'usdcPolygonWallet':_0x1d6973['usdcPolygonWallet']},'status':_0x1d6973['status'],'createdAt':_0x1d6973[_0x3a2b5e(0x19a)]};}async['getAllUsers'](){const _0x1adae3=a54_0x204896,_0x5d0b94=await database_1[_0x1adae3(0x1a4)][_0x1adae3(0x19e)]['findMany']({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':'desc'}});return _0x5d0b94[_0x1adae3(0x1bb)](_0x500b2c=>({'id':_0x500b2c['id'],'fullName':_0x500b2c[_0x1adae3(0x1b7)],'username':_0x500b2c[_0x1adae3(0x1b4)],'telegramId':_0x500b2c[_0x1adae3(0x1a2)],'merchantUrl':_0x500b2c[_0x1adae3(0x1a3)],'gateways':_0x500b2c[_0x1adae3(0x1ac)]?JSON[_0x1adae3(0x18d)](_0x500b2c[_0x1adae3(0x1ac)]):null,'gatewaySettings':_0x500b2c[_0x1adae3(0x1a6)]?JSON[_0x1adae3(0x18d)](_0x500b2c[_0x1adae3(0x1a6)]):null,'publicKey':_0x500b2c[_0x1adae3(0x1a7)],'wallets':{'usdtPolygonWallet':_0x500b2c[_0x1adae3(0x199)],'usdtTrcWallet':_0x500b2c[_0x1adae3(0x195)],'usdtErcWallet':_0x500b2c['usdtErcWallet'],'usdcPolygonWallet':_0x500b2c[_0x1adae3(0x197)]},'status':_0x500b2c['status'],'createdAt':_0x500b2c[_0x1adae3(0x19a)]}));}async['getUserById'](_0x3452d0){const _0x4204db=a54_0x204896,_0x299668=await database_1[_0x4204db(0x1a4)][_0x4204db(0x19e)][_0x4204db(0x1c0)]({'where':{'id':_0x3452d0},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x299668)return null;return{'id':_0x299668['id'],'fullName':_0x299668['name'],'username':_0x299668[_0x4204db(0x1b4)],'telegramId':_0x299668[_0x4204db(0x1a2)],'merchantUrl':_0x299668['shopUrl'],'gateways':_0x299668['paymentGateways']?JSON[_0x4204db(0x18d)](_0x299668[_0x4204db(0x1ac)]):null,'gatewaySettings':_0x299668[_0x4204db(0x1a6)]?JSON[_0x4204db(0x18d)](_0x299668[_0x4204db(0x1a6)]):null,'publicKey':_0x299668['publicKey'],'wallets':{'usdtPolygonWallet':_0x299668[_0x4204db(0x199)],'usdtTrcWallet':_0x299668[_0x4204db(0x195)],'usdtErcWallet':_0x299668['usdtErcWallet'],'usdcPolygonWallet':_0x299668[_0x4204db(0x197)]},'status':_0x299668['status'],'createdAt':_0x299668[_0x4204db(0x19a)]};}async[a54_0x204896(0x1bf)](_0x385790,_0x1fe20e){const _0x411094=a54_0x204896,_0x366c3b={..._0x1fe20e};_0x1fe20e[_0x411094(0x19d)]&&(_0x366c3b[_0x411094(0x19d)]=await bcryptjs_1[_0x411094(0x1a4)]['hash'](_0x1fe20e[_0x411094(0x19d)],0xc));_0x1fe20e[_0x411094(0x1b1)]&&(_0x366c3b[_0x411094(0x1b7)]=_0x1fe20e[_0x411094(0x1b1)],delete _0x366c3b[_0x411094(0x1b1)]);_0x1fe20e[_0x411094(0x193)]&&(_0x366c3b[_0x411094(0x1a2)]=_0x1fe20e['telegramId'],delete _0x366c3b[_0x411094(0x193)]);_0x1fe20e[_0x411094(0x1a9)]&&(_0x366c3b[_0x411094(0x1a3)]=_0x1fe20e[_0x411094(0x1a9)],delete _0x366c3b[_0x411094(0x1a9)]);_0x1fe20e['gateways']&&(_0x366c3b['paymentGateways']=JSON[_0x411094(0x18f)](_0x1fe20e[_0x411094(0x1ad)]),delete _0x366c3b['gateways']);_0x1fe20e['gatewaySettings']&&(_0x366c3b[_0x411094(0x1a6)]=JSON[_0x411094(0x18f)](_0x1fe20e['gatewaySettings']),delete _0x366c3b['gatewaySettings']);_0x1fe20e[_0x411094(0x1a0)]&&(_0x1fe20e['wallets'][_0x411094(0x199)]!==undefined&&(_0x366c3b['usdtPolygonWallet']=_0x1fe20e[_0x411094(0x1a0)][_0x411094(0x199)]||null),_0x1fe20e[_0x411094(0x1a0)][_0x411094(0x195)]!==undefined&&(_0x366c3b['usdtTrcWallet']=_0x1fe20e[_0x411094(0x1a0)][_0x411094(0x195)]||null),_0x1fe20e['wallets'][_0x411094(0x1b5)]!==undefined&&(_0x366c3b[_0x411094(0x1b5)]=_0x1fe20e[_0x411094(0x1a0)][_0x411094(0x1b5)]||null),_0x1fe20e[_0x411094(0x1a0)][_0x411094(0x197)]!==undefined&&(_0x366c3b['usdcPolygonWallet']=_0x1fe20e['wallets'][_0x411094(0x197)]||null),delete _0x366c3b[_0x411094(0x1a0)]);const _0x3e0476=await database_1['default'][_0x411094(0x19e)][_0x411094(0x1bc)]({'where':{'id':_0x385790},'data':_0x366c3b,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x3e0476['id'],'fullName':_0x3e0476[_0x411094(0x1b7)],'username':_0x3e0476[_0x411094(0x1b4)],'telegramId':_0x3e0476[_0x411094(0x1a2)],'merchantUrl':_0x3e0476['shopUrl'],'gateways':_0x3e0476[_0x411094(0x1ac)]?JSON['parse'](_0x3e0476[_0x411094(0x1ac)]):null,'gatewaySettings':_0x3e0476[_0x411094(0x1a6)]?JSON[_0x411094(0x18d)](_0x3e0476[_0x411094(0x1a6)]):null,'publicKey':_0x3e0476[_0x411094(0x1a7)],'wallets':{'usdtPolygonWallet':_0x3e0476[_0x411094(0x199)],'usdtTrcWallet':_0x3e0476['usdtTrcWallet'],'usdtErcWallet':_0x3e0476[_0x411094(0x1b5)],'usdcPolygonWallet':_0x3e0476[_0x411094(0x197)]},'status':_0x3e0476['status'],'createdAt':_0x3e0476['createdAt']};}async[a54_0x204896(0x1be)](_0x38f9d9){const _0x150a16=a54_0x204896;await database_1[_0x150a16(0x1a4)]['shop'][_0x150a16(0x1ba)]({'where':{'id':_0x38f9d9}});}}exports[a54_0x204896(0x1ab)]=UserService;