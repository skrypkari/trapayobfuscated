'use strict';const a57_0x11b4b6=a57_0x54ab;(function(_0x4d59ff,_0x406994){const _0x408212=a57_0x54ab,_0x418a08=_0x4d59ff();while(!![]){try{const _0x41b9ff=parseInt(_0x408212(0x141))/0x1+parseInt(_0x408212(0x12a))/0x2+parseInt(_0x408212(0x132))/0x3+parseInt(_0x408212(0x142))/0x4+-parseInt(_0x408212(0x112))/0x5*(-parseInt(_0x408212(0x118))/0x6)+-parseInt(_0x408212(0x12d))/0x7*(-parseInt(_0x408212(0x13e))/0x8)+parseInt(_0x408212(0x13f))/0x9*(-parseInt(_0x408212(0x130))/0xa);if(_0x41b9ff===_0x406994)break;else _0x418a08['push'](_0x418a08['shift']());}catch(_0x5e41c7){_0x418a08['push'](_0x418a08['shift']());}}}(a57_0xb905,0x49cc6));function a57_0x54ab(_0x1532bf,_0x464786){const _0xb90561=a57_0xb905();return a57_0x54ab=function(_0x54ab6d,_0x49e14c){_0x54ab6d=_0x54ab6d-0x10c;let _0x5e6a86=_0xb90561[_0x54ab6d];return _0x5e6a86;},a57_0x54ab(_0x1532bf,_0x464786);}var __importDefault=this&&this[a57_0x11b4b6(0x119)]||function(_0x1081ef){const _0x3beda3=a57_0x11b4b6;return _0x1081ef&&_0x1081ef[_0x3beda3(0x111)]?_0x1081ef:{'default':_0x1081ef};};function a57_0xb905(){const _0x48e661=['__esModule','452635COjYWA','wallets','delete','createdAt','toString','password','6SGBhtu','__importDefault','../config/database','ACTIVE','defineProperty','merchantUrl','shop','name','usdtErcWallet','deleteUser','stringify','updateUser','UserService','gateways','paymentGateways','publicKey','username','findMany','221720ejPzQL','gatewaySettings','telegram','152103kixWec','parse','desc','4802170TkPFuR','status','40164kWtePW','usdtTrcWallet','randomBytes','Username\x20already\x20exists','hex','hash','getUserById','shopUrl','pk_','getAllUsers','usdtPolygonWallet','telegramId','16XIFxEQ','9BnPGig','bcryptjs','246687ERCidB','1110300wyWiPC','findUnique','create','fullName','createUser','default','usdcPolygonWallet'];a57_0xb905=function(){return _0x48e661;};return a57_0xb905();}Object[a57_0x11b4b6(0x11c)](exports,a57_0x11b4b6(0x111),{'value':!![]}),exports[a57_0x11b4b6(0x124)]=void 0x0;const bcryptjs_1=__importDefault(require(a57_0x11b4b6(0x140))),crypto_1=__importDefault(require('crypto')),database_1=__importDefault(require(a57_0x11b4b6(0x11a)));class UserService{['generateApiKeys'](){const _0x552abd=a57_0x11b4b6,_0x1d0b6b=_0x552abd(0x13a)+crypto_1[_0x552abd(0x10f)][_0x552abd(0x134)](0x20)['toString'](_0x552abd(0x136)),_0x181bb3='sk_'+crypto_1['default'][_0x552abd(0x134)](0x20)[_0x552abd(0x116)](_0x552abd(0x136));return{'publicKey':_0x1d0b6b,'secretKey':_0x181bb3};}async[a57_0x11b4b6(0x10e)](_0x588fdb){const _0x296a61=a57_0x11b4b6,{fullName:_0x4ef3d4,username:_0x5bfe06,password:_0x12d3c0,telegramId:_0x29cc9e,merchantUrl:_0xf77093,gateways:_0x5e69cb,gatewaySettings:_0x314ded,wallets:_0x5c8fa4}=_0x588fdb,_0x43e48b=await database_1[_0x296a61(0x10f)][_0x296a61(0x11e)][_0x296a61(0x143)]({'where':{'username':_0x5bfe06}});if(_0x43e48b)throw new Error(_0x296a61(0x135));if(_0x29cc9e){const _0x5862e6=await database_1['default'][_0x296a61(0x11e)]['findUnique']({'where':{'telegram':_0x29cc9e}});if(_0x5862e6)throw new Error('Telegram\x20username\x20already\x20exists');}const _0x137bf5=await bcryptjs_1['default']['hash'](_0x12d3c0,0xc),{publicKey:_0x84e8a8,secretKey:_0xb9b562}=this['generateApiKeys'](),_0x3f018d=await database_1[_0x296a61(0x10f)][_0x296a61(0x11e)][_0x296a61(0x10c)]({'data':{'name':_0x4ef3d4,'username':_0x5bfe06,'password':_0x137bf5,'telegram':_0x29cc9e,'shopUrl':_0xf77093,'paymentGateways':_0x5e69cb?JSON[_0x296a61(0x122)](_0x5e69cb):null,'gatewaySettings':_0x314ded?JSON[_0x296a61(0x122)](_0x314ded):null,'usdtPolygonWallet':_0x5c8fa4?.['usdtPolygonWallet']||null,'usdtTrcWallet':_0x5c8fa4?.['usdtTrcWallet']||null,'usdtErcWallet':_0x5c8fa4?.[_0x296a61(0x120)]||null,'usdcPolygonWallet':_0x5c8fa4?.[_0x296a61(0x110)]||null,'publicKey':_0x84e8a8,'secretKey':_0xb9b562,'status':_0x296a61(0x11b)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x3f018d['id'],'fullName':_0x3f018d[_0x296a61(0x11f)],'username':_0x3f018d['username'],'telegramId':_0x3f018d[_0x296a61(0x12c)],'merchantUrl':_0x3f018d['shopUrl'],'gateways':_0x3f018d[_0x296a61(0x126)]?JSON[_0x296a61(0x12e)](_0x3f018d[_0x296a61(0x126)]):null,'gatewaySettings':_0x3f018d[_0x296a61(0x12b)]?JSON[_0x296a61(0x12e)](_0x3f018d['gatewaySettings']):null,'publicKey':_0x3f018d[_0x296a61(0x127)],'wallets':{'usdtPolygonWallet':_0x3f018d['usdtPolygonWallet'],'usdtTrcWallet':_0x3f018d[_0x296a61(0x133)],'usdtErcWallet':_0x3f018d['usdtErcWallet'],'usdcPolygonWallet':_0x3f018d[_0x296a61(0x110)]},'status':_0x3f018d[_0x296a61(0x131)],'createdAt':_0x3f018d[_0x296a61(0x115)]};}async[a57_0x11b4b6(0x13b)](){const _0x4ab326=a57_0x11b4b6,_0x12b5fa=await database_1[_0x4ab326(0x10f)][_0x4ab326(0x11e)][_0x4ab326(0x129)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x4ab326(0x12f)}});return _0x12b5fa['map'](_0x236573=>({'id':_0x236573['id'],'fullName':_0x236573[_0x4ab326(0x11f)],'username':_0x236573[_0x4ab326(0x128)],'telegramId':_0x236573['telegram'],'merchantUrl':_0x236573[_0x4ab326(0x139)],'gateways':_0x236573[_0x4ab326(0x126)]?JSON[_0x4ab326(0x12e)](_0x236573[_0x4ab326(0x126)]):null,'gatewaySettings':_0x236573[_0x4ab326(0x12b)]?JSON['parse'](_0x236573[_0x4ab326(0x12b)]):null,'publicKey':_0x236573[_0x4ab326(0x127)],'wallets':{'usdtPolygonWallet':_0x236573[_0x4ab326(0x13c)],'usdtTrcWallet':_0x236573[_0x4ab326(0x133)],'usdtErcWallet':_0x236573[_0x4ab326(0x120)],'usdcPolygonWallet':_0x236573['usdcPolygonWallet']},'status':_0x236573['status'],'createdAt':_0x236573[_0x4ab326(0x115)]}));}async[a57_0x11b4b6(0x138)](_0x440274){const _0x5cee7a=a57_0x11b4b6,_0xa564ed=await database_1[_0x5cee7a(0x10f)]['shop'][_0x5cee7a(0x143)]({'where':{'id':_0x440274},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0xa564ed)return null;return{'id':_0xa564ed['id'],'fullName':_0xa564ed[_0x5cee7a(0x11f)],'username':_0xa564ed[_0x5cee7a(0x128)],'telegramId':_0xa564ed[_0x5cee7a(0x12c)],'merchantUrl':_0xa564ed['shopUrl'],'gateways':_0xa564ed[_0x5cee7a(0x126)]?JSON[_0x5cee7a(0x12e)](_0xa564ed[_0x5cee7a(0x126)]):null,'gatewaySettings':_0xa564ed['gatewaySettings']?JSON[_0x5cee7a(0x12e)](_0xa564ed[_0x5cee7a(0x12b)]):null,'publicKey':_0xa564ed[_0x5cee7a(0x127)],'wallets':{'usdtPolygonWallet':_0xa564ed[_0x5cee7a(0x13c)],'usdtTrcWallet':_0xa564ed[_0x5cee7a(0x133)],'usdtErcWallet':_0xa564ed[_0x5cee7a(0x120)],'usdcPolygonWallet':_0xa564ed[_0x5cee7a(0x110)]},'status':_0xa564ed['status'],'createdAt':_0xa564ed[_0x5cee7a(0x115)]};}async[a57_0x11b4b6(0x123)](_0x54069d,_0x166d45){const _0x3215ea=a57_0x11b4b6,_0xb7a54e={..._0x166d45};_0x166d45['password']&&(_0xb7a54e['password']=await bcryptjs_1[_0x3215ea(0x10f)][_0x3215ea(0x137)](_0x166d45[_0x3215ea(0x117)],0xc));_0x166d45[_0x3215ea(0x10d)]&&(_0xb7a54e['name']=_0x166d45[_0x3215ea(0x10d)],delete _0xb7a54e['fullName']);_0x166d45[_0x3215ea(0x13d)]&&(_0xb7a54e['telegram']=_0x166d45[_0x3215ea(0x13d)],delete _0xb7a54e[_0x3215ea(0x13d)]);_0x166d45[_0x3215ea(0x11d)]&&(_0xb7a54e['shopUrl']=_0x166d45[_0x3215ea(0x11d)],delete _0xb7a54e[_0x3215ea(0x11d)]);_0x166d45[_0x3215ea(0x125)]&&(_0xb7a54e[_0x3215ea(0x126)]=JSON[_0x3215ea(0x122)](_0x166d45[_0x3215ea(0x125)]),delete _0xb7a54e[_0x3215ea(0x125)]);_0x166d45[_0x3215ea(0x12b)]&&(_0xb7a54e[_0x3215ea(0x12b)]=JSON[_0x3215ea(0x122)](_0x166d45[_0x3215ea(0x12b)]),delete _0xb7a54e['gatewaySettings']);_0x166d45[_0x3215ea(0x113)]&&(_0x166d45[_0x3215ea(0x113)][_0x3215ea(0x13c)]!==undefined&&(_0xb7a54e[_0x3215ea(0x13c)]=_0x166d45['wallets'][_0x3215ea(0x13c)]||null),_0x166d45[_0x3215ea(0x113)]['usdtTrcWallet']!==undefined&&(_0xb7a54e[_0x3215ea(0x133)]=_0x166d45['wallets'][_0x3215ea(0x133)]||null),_0x166d45[_0x3215ea(0x113)][_0x3215ea(0x120)]!==undefined&&(_0xb7a54e['usdtErcWallet']=_0x166d45[_0x3215ea(0x113)][_0x3215ea(0x120)]||null),_0x166d45[_0x3215ea(0x113)][_0x3215ea(0x110)]!==undefined&&(_0xb7a54e[_0x3215ea(0x110)]=_0x166d45[_0x3215ea(0x113)][_0x3215ea(0x110)]||null),delete _0xb7a54e[_0x3215ea(0x113)]);const _0x34131c=await database_1[_0x3215ea(0x10f)][_0x3215ea(0x11e)]['update']({'where':{'id':_0x54069d},'data':_0xb7a54e,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x34131c['id'],'fullName':_0x34131c[_0x3215ea(0x11f)],'username':_0x34131c['username'],'telegramId':_0x34131c[_0x3215ea(0x12c)],'merchantUrl':_0x34131c[_0x3215ea(0x139)],'gateways':_0x34131c[_0x3215ea(0x126)]?JSON[_0x3215ea(0x12e)](_0x34131c[_0x3215ea(0x126)]):null,'gatewaySettings':_0x34131c[_0x3215ea(0x12b)]?JSON[_0x3215ea(0x12e)](_0x34131c[_0x3215ea(0x12b)]):null,'publicKey':_0x34131c['publicKey'],'wallets':{'usdtPolygonWallet':_0x34131c[_0x3215ea(0x13c)],'usdtTrcWallet':_0x34131c[_0x3215ea(0x133)],'usdtErcWallet':_0x34131c[_0x3215ea(0x120)],'usdcPolygonWallet':_0x34131c['usdcPolygonWallet']},'status':_0x34131c[_0x3215ea(0x131)],'createdAt':_0x34131c[_0x3215ea(0x115)]};}async[a57_0x11b4b6(0x121)](_0x4e3012){const _0x530a48=a57_0x11b4b6;await database_1[_0x530a48(0x10f)][_0x530a48(0x11e)][_0x530a48(0x114)]({'where':{'id':_0x4e3012}});}}exports[a57_0x11b4b6(0x124)]=UserService;