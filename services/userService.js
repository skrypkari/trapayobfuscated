'use strict';const a51_0x3c2010=a51_0x3872;(function(_0x15834f,_0x3f822e){const _0x5d07bd=a51_0x3872,_0x2557af=_0x15834f();while(!![]){try{const _0x32bb94=-parseInt(_0x5d07bd(0x1a1))/0x1+parseInt(_0x5d07bd(0x198))/0x2*(parseInt(_0x5d07bd(0x18c))/0x3)+-parseInt(_0x5d07bd(0x1a9))/0x4*(parseInt(_0x5d07bd(0x18d))/0x5)+parseInt(_0x5d07bd(0x1a6))/0x6*(-parseInt(_0x5d07bd(0x18e))/0x7)+parseInt(_0x5d07bd(0x191))/0x8*(parseInt(_0x5d07bd(0x18b))/0x9)+-parseInt(_0x5d07bd(0x17f))/0xa+-parseInt(_0x5d07bd(0x1a0))/0xb*(-parseInt(_0x5d07bd(0x1a7))/0xc);if(_0x32bb94===_0x3f822e)break;else _0x2557af['push'](_0x2557af['shift']());}catch(_0x2ae57e){_0x2557af['push'](_0x2557af['shift']());}}}(a51_0x1fde,0x52270));function a51_0x1fde(){const _0x39be53=['gatewaySettings','../config/database','2061570nMuKTT','usdtTrcWallet','sk_','createUser','map','UserService','password','__importDefault','createdAt','fullName','telegram','shopUrl','18jSNTlv','35754hXXGdn','10FWzhwo','2127713GuiNAx','hex','shop','428936BMEafC','findMany','crypto','delete','Username\x20already\x20exists','merchantUrl','update','14gtbwyQ','usdtErcWallet','toString','generateApiKeys','gateways','findUnique','__esModule','defineProperty','1387067PnKjOS','175898OyLpwJ','publicKey','create','usdcPolygonWallet','hash','6tbOjfD','96aYLaxR','stringify','353852lmObDl','default','deleteUser','telegramId','status','usdtPolygonWallet','Telegram\x20username\x20already\x20exists','updateUser','getUserById','username','name','paymentGateways','parse','wallets','randomBytes'];a51_0x1fde=function(){return _0x39be53;};return a51_0x1fde();}function a51_0x3872(_0x289d58,_0x53d4ec){const _0x1fde96=a51_0x1fde();return a51_0x3872=function(_0x38720d,_0x14ad4b){_0x38720d=_0x38720d-0x17b;let _0x348dfd=_0x1fde96[_0x38720d];return _0x348dfd;},a51_0x3872(_0x289d58,_0x53d4ec);}var __importDefault=this&&this[a51_0x3c2010(0x186)]||function(_0x5f4253){const _0x590250=a51_0x3c2010;return _0x5f4253&&_0x5f4253[_0x590250(0x19e)]?_0x5f4253:{'default':_0x5f4253};};Object[a51_0x3c2010(0x19f)](exports,a51_0x3c2010(0x19e),{'value':!![]}),exports[a51_0x3c2010(0x184)]=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),crypto_1=__importDefault(require(a51_0x3c2010(0x193))),database_1=__importDefault(require(a51_0x3c2010(0x17e)));class UserService{['generateApiKeys'](){const _0xd9f092=a51_0x3c2010,_0xf436f='pk_'+crypto_1['default']['randomBytes'](0x20)[_0xd9f092(0x19a)]('hex'),_0x225418=_0xd9f092(0x181)+crypto_1[_0xd9f092(0x1aa)][_0xd9f092(0x17c)](0x20)[_0xd9f092(0x19a)](_0xd9f092(0x18f));return{'publicKey':_0xf436f,'secretKey':_0x225418};}async[a51_0x3c2010(0x182)](_0x3602eb){const _0x40bf30=a51_0x3c2010,{fullName:_0x1025f3,username:_0x260b40,password:_0xd4a8c0,telegramId:_0x5b539f,merchantUrl:_0x1753dc,gateways:_0x1f90ad,gatewaySettings:_0x2b80b5,wallets:_0x407054}=_0x3602eb,_0x33b0fd=await database_1['default']['shop']['findUnique']({'where':{'username':_0x260b40}});if(_0x33b0fd)throw new Error(_0x40bf30(0x195));if(_0x5b539f){const _0x2f6d46=await database_1[_0x40bf30(0x1aa)][_0x40bf30(0x190)][_0x40bf30(0x19d)]({'where':{'telegram':_0x5b539f}});if(_0x2f6d46)throw new Error(_0x40bf30(0x1af));}const _0x479a47=await bcryptjs_1[_0x40bf30(0x1aa)]['hash'](_0xd4a8c0,0xc),{publicKey:_0x315c44,secretKey:_0x329f01}=this[_0x40bf30(0x19b)](),_0x393a2e=await database_1[_0x40bf30(0x1aa)][_0x40bf30(0x190)][_0x40bf30(0x1a3)]({'data':{'name':_0x1025f3,'username':_0x260b40,'password':_0x479a47,'telegram':_0x5b539f,'shopUrl':_0x1753dc,'paymentGateways':_0x1f90ad?JSON[_0x40bf30(0x1a8)](_0x1f90ad):null,'gatewaySettings':_0x2b80b5?JSON['stringify'](_0x2b80b5):null,'usdtPolygonWallet':_0x407054?.[_0x40bf30(0x1ae)]||null,'usdtTrcWallet':_0x407054?.[_0x40bf30(0x180)]||null,'usdtErcWallet':_0x407054?.[_0x40bf30(0x199)]||null,'usdcPolygonWallet':_0x407054?.[_0x40bf30(0x1a4)]||null,'publicKey':_0x315c44,'secretKey':_0x329f01,'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x393a2e['id'],'fullName':_0x393a2e[_0x40bf30(0x1b3)],'username':_0x393a2e[_0x40bf30(0x1b2)],'telegramId':_0x393a2e[_0x40bf30(0x189)],'merchantUrl':_0x393a2e['shopUrl'],'gateways':_0x393a2e[_0x40bf30(0x1b4)]?JSON[_0x40bf30(0x1b5)](_0x393a2e[_0x40bf30(0x1b4)]):null,'gatewaySettings':_0x393a2e['gatewaySettings']?JSON[_0x40bf30(0x1b5)](_0x393a2e[_0x40bf30(0x17d)]):null,'publicKey':_0x393a2e[_0x40bf30(0x1a2)],'wallets':{'usdtPolygonWallet':_0x393a2e[_0x40bf30(0x1ae)],'usdtTrcWallet':_0x393a2e[_0x40bf30(0x180)],'usdtErcWallet':_0x393a2e['usdtErcWallet'],'usdcPolygonWallet':_0x393a2e[_0x40bf30(0x1a4)]},'status':_0x393a2e[_0x40bf30(0x1ad)],'createdAt':_0x393a2e['createdAt']};}async['getAllUsers'](){const _0x1daebd=a51_0x3c2010,_0x15719c=await database_1['default'][_0x1daebd(0x190)][_0x1daebd(0x192)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':'desc'}});return _0x15719c[_0x1daebd(0x183)](_0x4dafc6=>({'id':_0x4dafc6['id'],'fullName':_0x4dafc6['name'],'username':_0x4dafc6[_0x1daebd(0x1b2)],'telegramId':_0x4dafc6[_0x1daebd(0x189)],'merchantUrl':_0x4dafc6['shopUrl'],'gateways':_0x4dafc6[_0x1daebd(0x1b4)]?JSON[_0x1daebd(0x1b5)](_0x4dafc6[_0x1daebd(0x1b4)]):null,'gatewaySettings':_0x4dafc6['gatewaySettings']?JSON[_0x1daebd(0x1b5)](_0x4dafc6[_0x1daebd(0x17d)]):null,'publicKey':_0x4dafc6[_0x1daebd(0x1a2)],'wallets':{'usdtPolygonWallet':_0x4dafc6[_0x1daebd(0x1ae)],'usdtTrcWallet':_0x4dafc6['usdtTrcWallet'],'usdtErcWallet':_0x4dafc6[_0x1daebd(0x199)],'usdcPolygonWallet':_0x4dafc6[_0x1daebd(0x1a4)]},'status':_0x4dafc6[_0x1daebd(0x1ad)],'createdAt':_0x4dafc6[_0x1daebd(0x187)]}));}async[a51_0x3c2010(0x1b1)](_0x405b29){const _0xa7bb4b=a51_0x3c2010,_0x8be1d=await database_1['default'][_0xa7bb4b(0x190)][_0xa7bb4b(0x19d)]({'where':{'id':_0x405b29},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x8be1d)return null;return{'id':_0x8be1d['id'],'fullName':_0x8be1d['name'],'username':_0x8be1d[_0xa7bb4b(0x1b2)],'telegramId':_0x8be1d[_0xa7bb4b(0x189)],'merchantUrl':_0x8be1d[_0xa7bb4b(0x18a)],'gateways':_0x8be1d['paymentGateways']?JSON[_0xa7bb4b(0x1b5)](_0x8be1d[_0xa7bb4b(0x1b4)]):null,'gatewaySettings':_0x8be1d[_0xa7bb4b(0x17d)]?JSON[_0xa7bb4b(0x1b5)](_0x8be1d[_0xa7bb4b(0x17d)]):null,'publicKey':_0x8be1d[_0xa7bb4b(0x1a2)],'wallets':{'usdtPolygonWallet':_0x8be1d[_0xa7bb4b(0x1ae)],'usdtTrcWallet':_0x8be1d[_0xa7bb4b(0x180)],'usdtErcWallet':_0x8be1d['usdtErcWallet'],'usdcPolygonWallet':_0x8be1d[_0xa7bb4b(0x1a4)]},'status':_0x8be1d['status'],'createdAt':_0x8be1d[_0xa7bb4b(0x187)]};}async[a51_0x3c2010(0x1b0)](_0x33f535,_0xb82648){const _0x2a4d6f=a51_0x3c2010,_0x4d9b21={..._0xb82648};_0xb82648[_0x2a4d6f(0x185)]&&(_0x4d9b21[_0x2a4d6f(0x185)]=await bcryptjs_1[_0x2a4d6f(0x1aa)][_0x2a4d6f(0x1a5)](_0xb82648[_0x2a4d6f(0x185)],0xc));_0xb82648[_0x2a4d6f(0x188)]&&(_0x4d9b21[_0x2a4d6f(0x1b3)]=_0xb82648[_0x2a4d6f(0x188)],delete _0x4d9b21[_0x2a4d6f(0x188)]);_0xb82648[_0x2a4d6f(0x1ac)]&&(_0x4d9b21[_0x2a4d6f(0x189)]=_0xb82648[_0x2a4d6f(0x1ac)],delete _0x4d9b21['telegramId']);_0xb82648[_0x2a4d6f(0x196)]&&(_0x4d9b21['shopUrl']=_0xb82648[_0x2a4d6f(0x196)],delete _0x4d9b21[_0x2a4d6f(0x196)]);_0xb82648['gateways']&&(_0x4d9b21[_0x2a4d6f(0x1b4)]=JSON[_0x2a4d6f(0x1a8)](_0xb82648[_0x2a4d6f(0x19c)]),delete _0x4d9b21[_0x2a4d6f(0x19c)]);_0xb82648[_0x2a4d6f(0x17d)]&&(_0x4d9b21[_0x2a4d6f(0x17d)]=JSON[_0x2a4d6f(0x1a8)](_0xb82648['gatewaySettings']),delete _0x4d9b21[_0x2a4d6f(0x17d)]);_0xb82648[_0x2a4d6f(0x17b)]&&(_0xb82648[_0x2a4d6f(0x17b)][_0x2a4d6f(0x1ae)]!==undefined&&(_0x4d9b21[_0x2a4d6f(0x1ae)]=_0xb82648['wallets'][_0x2a4d6f(0x1ae)]||null),_0xb82648[_0x2a4d6f(0x17b)][_0x2a4d6f(0x180)]!==undefined&&(_0x4d9b21[_0x2a4d6f(0x180)]=_0xb82648[_0x2a4d6f(0x17b)]['usdtTrcWallet']||null),_0xb82648['wallets']['usdtErcWallet']!==undefined&&(_0x4d9b21['usdtErcWallet']=_0xb82648['wallets'][_0x2a4d6f(0x199)]||null),_0xb82648['wallets'][_0x2a4d6f(0x1a4)]!==undefined&&(_0x4d9b21['usdcPolygonWallet']=_0xb82648[_0x2a4d6f(0x17b)][_0x2a4d6f(0x1a4)]||null),delete _0x4d9b21[_0x2a4d6f(0x17b)]);const _0x3faaa1=await database_1[_0x2a4d6f(0x1aa)][_0x2a4d6f(0x190)][_0x2a4d6f(0x197)]({'where':{'id':_0x33f535},'data':_0x4d9b21,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x3faaa1['id'],'fullName':_0x3faaa1['name'],'username':_0x3faaa1['username'],'telegramId':_0x3faaa1['telegram'],'merchantUrl':_0x3faaa1[_0x2a4d6f(0x18a)],'gateways':_0x3faaa1[_0x2a4d6f(0x1b4)]?JSON['parse'](_0x3faaa1[_0x2a4d6f(0x1b4)]):null,'gatewaySettings':_0x3faaa1[_0x2a4d6f(0x17d)]?JSON[_0x2a4d6f(0x1b5)](_0x3faaa1[_0x2a4d6f(0x17d)]):null,'publicKey':_0x3faaa1[_0x2a4d6f(0x1a2)],'wallets':{'usdtPolygonWallet':_0x3faaa1[_0x2a4d6f(0x1ae)],'usdtTrcWallet':_0x3faaa1[_0x2a4d6f(0x180)],'usdtErcWallet':_0x3faaa1[_0x2a4d6f(0x199)],'usdcPolygonWallet':_0x3faaa1['usdcPolygonWallet']},'status':_0x3faaa1[_0x2a4d6f(0x1ad)],'createdAt':_0x3faaa1[_0x2a4d6f(0x187)]};}async[a51_0x3c2010(0x1ab)](_0x5d27c0){const _0x5c7401=a51_0x3c2010;await database_1['default'][_0x5c7401(0x190)][_0x5c7401(0x194)]({'where':{'id':_0x5d27c0}});}}exports[a51_0x3c2010(0x184)]=UserService;