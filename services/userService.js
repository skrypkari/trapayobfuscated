'use strict';function a60_0x3797(_0x35e236,_0x37a93c){const _0xac2d7=a60_0xac2d();return a60_0x3797=function(_0x3797b3,_0x552176){_0x3797b3=_0x3797b3-0xb9;let _0xe5f0e=_0xac2d7[_0x3797b3];return _0xe5f0e;},a60_0x3797(_0x35e236,_0x37a93c);}function a60_0xac2d(){const _0x42a586=['telegram','97038qbuTnW','delete','602SpclBh','getUserById','6691YESJaW','status','487975dcTHAR','publicKey','30qoFQRF','2314528WkdpYx','4490703DyNiNX','desc','createUser','username','crypto','hash','UserService','28LVXdfj','password','usdtTrcWallet','wallets','shop','createdAt','Username\x20already\x20exists','defineProperty','hex','toString','parse','map','usdtPolygonWallet','usdcPolygonWallet','findMany','gatewaySettings','bcryptjs','updateUser','362EUhmZB','1626819jKuuKw','30212358UvGbbe','telegramId','pk_','shopUrl','../config/database','name','usdtErcWallet','__importDefault','gateways','randomBytes','generateApiKeys','merchantUrl','stringify','getAllUsers','default','findUnique','deleteUser','__esModule','paymentGateways','fullName'];a60_0xac2d=function(){return _0x42a586;};return a60_0xac2d();}const a60_0x46f2ff=a60_0x3797;(function(_0x5173b3,_0xd12dd0){const _0x24215b=a60_0x3797,_0x16bb04=_0x5173b3();while(!![]){try{const _0x25a3c7=parseInt(_0x24215b(0xc4))/0x1*(parseInt(_0x24215b(0xe3))/0x2)+parseInt(_0x24215b(0xe4))/0x3+parseInt(_0x24215b(0xd1))/0x4*(-parseInt(_0x24215b(0xc6))/0x5)+parseInt(_0x24215b(0xc0))/0x6*(parseInt(_0x24215b(0xc2))/0x7)+-parseInt(_0x24215b(0xc9))/0x8+-parseInt(_0x24215b(0xca))/0x9*(-parseInt(_0x24215b(0xc8))/0xa)+-parseInt(_0x24215b(0xe5))/0xb;if(_0x25a3c7===_0xd12dd0)break;else _0x16bb04['push'](_0x16bb04['shift']());}catch(_0x4ce7c4){_0x16bb04['push'](_0x16bb04['shift']());}}}(a60_0xac2d,0xe11d0));var __importDefault=this&&this[a60_0x46f2ff(0xec)]||function(_0xc32e94){const _0x2b3941=a60_0x46f2ff;return _0xc32e94&&_0xc32e94[_0x2b3941(0xbc)]?_0xc32e94:{'default':_0xc32e94};};Object[a60_0x46f2ff(0xd8)](exports,a60_0x46f2ff(0xbc),{'value':!![]}),exports[a60_0x46f2ff(0xd0)]=void 0x0;const bcryptjs_1=__importDefault(require(a60_0x46f2ff(0xe1))),crypto_1=__importDefault(require(a60_0x46f2ff(0xce))),database_1=__importDefault(require(a60_0x46f2ff(0xe9)));class UserService{[a60_0x46f2ff(0xef)](){const _0x437833=a60_0x46f2ff,_0x1291f6=_0x437833(0xe7)+crypto_1[_0x437833(0xb9)][_0x437833(0xee)](0x20)[_0x437833(0xda)](_0x437833(0xd9)),_0x1ab458='sk_'+crypto_1['default'][_0x437833(0xee)](0x20)[_0x437833(0xda)](_0x437833(0xd9));return{'publicKey':_0x1291f6,'secretKey':_0x1ab458};}async[a60_0x46f2ff(0xcc)](_0x347329){const _0x2e7c27=a60_0x46f2ff,{fullName:_0x2d6052,username:_0x462c52,password:_0x3ad50e,telegramId:_0x4f8d5,merchantUrl:_0x3b79e5,gateways:_0x52633f,gatewaySettings:_0xfb69a,wallets:_0x222a8f}=_0x347329,_0x15ed35=await database_1['default'][_0x2e7c27(0xd5)][_0x2e7c27(0xba)]({'where':{'username':_0x462c52}});if(_0x15ed35)throw new Error(_0x2e7c27(0xd7));if(_0x4f8d5){const _0x29f785=await database_1[_0x2e7c27(0xb9)]['shop']['findUnique']({'where':{'telegram':_0x4f8d5}});if(_0x29f785)throw new Error('Telegram\x20username\x20already\x20exists');}const _0x1df2ae=await bcryptjs_1[_0x2e7c27(0xb9)]['hash'](_0x3ad50e,0xc),{publicKey:_0x49940b,secretKey:_0x25b006}=this[_0x2e7c27(0xef)](),_0x23e24a=await database_1[_0x2e7c27(0xb9)][_0x2e7c27(0xd5)]['create']({'data':{'name':_0x2d6052,'username':_0x462c52,'password':_0x1df2ae,'telegram':_0x4f8d5,'shopUrl':_0x3b79e5,'paymentGateways':_0x52633f?JSON[_0x2e7c27(0xf1)](_0x52633f):null,'gatewaySettings':_0xfb69a?JSON[_0x2e7c27(0xf1)](_0xfb69a):null,'usdtPolygonWallet':_0x222a8f?.['usdtPolygonWallet']||null,'usdtTrcWallet':_0x222a8f?.[_0x2e7c27(0xd3)]||null,'usdtErcWallet':_0x222a8f?.[_0x2e7c27(0xeb)]||null,'usdcPolygonWallet':_0x222a8f?.['usdcPolygonWallet']||null,'publicKey':_0x49940b,'secretKey':_0x25b006,'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x23e24a['id'],'fullName':_0x23e24a[_0x2e7c27(0xea)],'username':_0x23e24a[_0x2e7c27(0xcd)],'telegramId':_0x23e24a[_0x2e7c27(0xbf)],'merchantUrl':_0x23e24a[_0x2e7c27(0xe8)],'gateways':_0x23e24a[_0x2e7c27(0xbd)]?JSON['parse'](_0x23e24a[_0x2e7c27(0xbd)]):null,'gatewaySettings':_0x23e24a[_0x2e7c27(0xe0)]?JSON['parse'](_0x23e24a[_0x2e7c27(0xe0)]):null,'publicKey':_0x23e24a[_0x2e7c27(0xc7)],'wallets':{'usdtPolygonWallet':_0x23e24a[_0x2e7c27(0xdd)],'usdtTrcWallet':_0x23e24a[_0x2e7c27(0xd3)],'usdtErcWallet':_0x23e24a[_0x2e7c27(0xeb)],'usdcPolygonWallet':_0x23e24a[_0x2e7c27(0xde)]},'status':_0x23e24a[_0x2e7c27(0xc5)],'createdAt':_0x23e24a['createdAt']};}async[a60_0x46f2ff(0xf2)](){const _0x376703=a60_0x46f2ff,_0x1e1856=await database_1[_0x376703(0xb9)][_0x376703(0xd5)][_0x376703(0xdf)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x376703(0xcb)}});return _0x1e1856[_0x376703(0xdc)](_0x5e3b1a=>({'id':_0x5e3b1a['id'],'fullName':_0x5e3b1a[_0x376703(0xea)],'username':_0x5e3b1a[_0x376703(0xcd)],'telegramId':_0x5e3b1a[_0x376703(0xbf)],'merchantUrl':_0x5e3b1a[_0x376703(0xe8)],'gateways':_0x5e3b1a[_0x376703(0xbd)]?JSON[_0x376703(0xdb)](_0x5e3b1a[_0x376703(0xbd)]):null,'gatewaySettings':_0x5e3b1a[_0x376703(0xe0)]?JSON[_0x376703(0xdb)](_0x5e3b1a['gatewaySettings']):null,'publicKey':_0x5e3b1a['publicKey'],'wallets':{'usdtPolygonWallet':_0x5e3b1a[_0x376703(0xdd)],'usdtTrcWallet':_0x5e3b1a['usdtTrcWallet'],'usdtErcWallet':_0x5e3b1a[_0x376703(0xeb)],'usdcPolygonWallet':_0x5e3b1a[_0x376703(0xde)]},'status':_0x5e3b1a['status'],'createdAt':_0x5e3b1a['createdAt']}));}async[a60_0x46f2ff(0xc3)](_0x117c5b){const _0x28f46a=a60_0x46f2ff,_0x184732=await database_1[_0x28f46a(0xb9)][_0x28f46a(0xd5)][_0x28f46a(0xba)]({'where':{'id':_0x117c5b},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x184732)return null;return{'id':_0x184732['id'],'fullName':_0x184732[_0x28f46a(0xea)],'username':_0x184732['username'],'telegramId':_0x184732[_0x28f46a(0xbf)],'merchantUrl':_0x184732[_0x28f46a(0xe8)],'gateways':_0x184732[_0x28f46a(0xbd)]?JSON[_0x28f46a(0xdb)](_0x184732['paymentGateways']):null,'gatewaySettings':_0x184732['gatewaySettings']?JSON[_0x28f46a(0xdb)](_0x184732[_0x28f46a(0xe0)]):null,'publicKey':_0x184732[_0x28f46a(0xc7)],'wallets':{'usdtPolygonWallet':_0x184732['usdtPolygonWallet'],'usdtTrcWallet':_0x184732['usdtTrcWallet'],'usdtErcWallet':_0x184732[_0x28f46a(0xeb)],'usdcPolygonWallet':_0x184732[_0x28f46a(0xde)]},'status':_0x184732[_0x28f46a(0xc5)],'createdAt':_0x184732['createdAt']};}async[a60_0x46f2ff(0xe2)](_0x491dd0,_0xc276c5){const _0x2cab12=a60_0x46f2ff,_0x31df33={..._0xc276c5};_0xc276c5['password']&&(_0x31df33['password']=await bcryptjs_1[_0x2cab12(0xb9)][_0x2cab12(0xcf)](_0xc276c5[_0x2cab12(0xd2)],0xc));_0xc276c5['fullName']&&(_0x31df33[_0x2cab12(0xea)]=_0xc276c5['fullName'],delete _0x31df33[_0x2cab12(0xbe)]);_0xc276c5[_0x2cab12(0xe6)]&&(_0x31df33['telegram']=_0xc276c5[_0x2cab12(0xe6)],delete _0x31df33[_0x2cab12(0xe6)]);_0xc276c5[_0x2cab12(0xf0)]&&(_0x31df33['shopUrl']=_0xc276c5[_0x2cab12(0xf0)],delete _0x31df33[_0x2cab12(0xf0)]);_0xc276c5[_0x2cab12(0xed)]&&(_0x31df33['paymentGateways']=JSON[_0x2cab12(0xf1)](_0xc276c5['gateways']),delete _0x31df33[_0x2cab12(0xed)]);_0xc276c5[_0x2cab12(0xe0)]&&(_0x31df33[_0x2cab12(0xe0)]=JSON[_0x2cab12(0xf1)](_0xc276c5[_0x2cab12(0xe0)]),delete _0x31df33[_0x2cab12(0xe0)]);_0xc276c5['wallets']&&(_0xc276c5[_0x2cab12(0xd4)][_0x2cab12(0xdd)]!==undefined&&(_0x31df33[_0x2cab12(0xdd)]=_0xc276c5[_0x2cab12(0xd4)][_0x2cab12(0xdd)]||null),_0xc276c5['wallets']['usdtTrcWallet']!==undefined&&(_0x31df33['usdtTrcWallet']=_0xc276c5[_0x2cab12(0xd4)][_0x2cab12(0xd3)]||null),_0xc276c5[_0x2cab12(0xd4)]['usdtErcWallet']!==undefined&&(_0x31df33['usdtErcWallet']=_0xc276c5['wallets'][_0x2cab12(0xeb)]||null),_0xc276c5[_0x2cab12(0xd4)][_0x2cab12(0xde)]!==undefined&&(_0x31df33[_0x2cab12(0xde)]=_0xc276c5[_0x2cab12(0xd4)][_0x2cab12(0xde)]||null),delete _0x31df33['wallets']);const _0x590aad=await database_1[_0x2cab12(0xb9)]['shop']['update']({'where':{'id':_0x491dd0},'data':_0x31df33,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x590aad['id'],'fullName':_0x590aad[_0x2cab12(0xea)],'username':_0x590aad[_0x2cab12(0xcd)],'telegramId':_0x590aad[_0x2cab12(0xbf)],'merchantUrl':_0x590aad[_0x2cab12(0xe8)],'gateways':_0x590aad[_0x2cab12(0xbd)]?JSON[_0x2cab12(0xdb)](_0x590aad['paymentGateways']):null,'gatewaySettings':_0x590aad[_0x2cab12(0xe0)]?JSON[_0x2cab12(0xdb)](_0x590aad['gatewaySettings']):null,'publicKey':_0x590aad[_0x2cab12(0xc7)],'wallets':{'usdtPolygonWallet':_0x590aad[_0x2cab12(0xdd)],'usdtTrcWallet':_0x590aad[_0x2cab12(0xd3)],'usdtErcWallet':_0x590aad[_0x2cab12(0xeb)],'usdcPolygonWallet':_0x590aad[_0x2cab12(0xde)]},'status':_0x590aad[_0x2cab12(0xc5)],'createdAt':_0x590aad[_0x2cab12(0xd6)]};}async[a60_0x46f2ff(0xbb)](_0x14f2e5){const _0x4501e9=a60_0x46f2ff;await database_1[_0x4501e9(0xb9)][_0x4501e9(0xd5)][_0x4501e9(0xc1)]({'where':{'id':_0x14f2e5}});}}exports['UserService']=UserService;