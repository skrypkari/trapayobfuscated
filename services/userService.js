'use strict';function a76_0xfc22(_0x46e728,_0x5dab62){_0x46e728=_0x46e728-0x1e1;const _0x4b17ca=a76_0x4b17();let _0xfc22dc=_0x4b17ca[_0x46e728];return _0xfc22dc;}const a76_0x5121d2=a76_0xfc22;(function(_0x160a85,_0x16733a){const _0x5cd73f=a76_0xfc22,_0x239c50=_0x160a85();while(!![]){try{const _0x100feb=-parseInt(_0x5cd73f(0x1ee))/0x1+parseInt(_0x5cd73f(0x1fc))/0x2*(parseInt(_0x5cd73f(0x200))/0x3)+-parseInt(_0x5cd73f(0x1f0))/0x4+-parseInt(_0x5cd73f(0x1e4))/0x5*(-parseInt(_0x5cd73f(0x1f4))/0x6)+-parseInt(_0x5cd73f(0x203))/0x7+parseInt(_0x5cd73f(0x1e2))/0x8+-parseInt(_0x5cd73f(0x1fe))/0x9;if(_0x100feb===_0x16733a)break;else _0x239c50['push'](_0x239c50['shift']());}catch(_0x136c69){_0x239c50['push'](_0x239c50['shift']());}}}(a76_0x4b17,0xc7979));var __importDefault=this&&this['__importDefault']||function(_0x25ac13){return _0x25ac13&&_0x25ac13['__esModule']?_0x25ac13:{'default':_0x25ac13};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports['UserService']=void 0x0;function a76_0x4b17(){const _0x1d9fa7=['username','51561oKmFuO','name','23346LaeIee','desc','paymentGateways','5991482QufEIW','create','../config/database','sk_','usdtTrcWallet','findMany','map','createdAt','merchantUrl','gatewaySettings','hash','usdtPolygonWallet','parse','shop','shopUrl','update','8027648jiuEaZ','stringify','2155vGnmNW','fullName','telegram','updateUser','randomBytes','default','generateApiKeys','wallets','toString','findUnique','908866gRwvxW','getUserById','6237388NKQmSg','telegramId','password','status','21342yYVECj','delete','pk_','usdtErcWallet','usdcPolygonWallet','ACTIVE','hex','publicKey','414BTkfQk'];a76_0x4b17=function(){return _0x1d9fa7;};return a76_0x4b17();}const bcryptjs_1=__importDefault(require('bcryptjs')),crypto_1=__importDefault(require('crypto')),database_1=__importDefault(require(a76_0x5121d2(0x205)));class UserService{[a76_0x5121d2(0x1ea)](){const _0x19824a=a76_0x5121d2,_0x3c3d9b=_0x19824a(0x1f6)+crypto_1['default'][_0x19824a(0x1e8)](0x20)[_0x19824a(0x1ec)]('hex'),_0x54e08b=_0x19824a(0x206)+crypto_1[_0x19824a(0x1e9)][_0x19824a(0x1e8)](0x20)[_0x19824a(0x1ec)](_0x19824a(0x1fa));return{'publicKey':_0x3c3d9b,'secretKey':_0x54e08b};}async['createUser'](_0x24de38){const _0x47a7a0=a76_0x5121d2,{fullName:_0x3173ff,username:_0x4e856a,password:_0x4ac211,telegramId:_0x14cb05,merchantUrl:_0x430fa9,gateways:_0x1fbb48,gatewaySettings:_0x41d3eb,wallets:_0x512043}=_0x24de38,_0x9498d7=await database_1['default'][_0x47a7a0(0x210)][_0x47a7a0(0x1ed)]({'where':{'username':_0x4e856a}});if(_0x9498d7)throw new Error('Username\x20already\x20exists');if(_0x14cb05){const _0x2492ac=await database_1['default'][_0x47a7a0(0x210)][_0x47a7a0(0x1ed)]({'where':{'telegram':_0x14cb05}});if(_0x2492ac)throw new Error('Telegram\x20username\x20already\x20exists');}const _0x3e673a=await bcryptjs_1[_0x47a7a0(0x1e9)][_0x47a7a0(0x20d)](_0x4ac211,0xc),{publicKey:_0x4f729b,secretKey:_0xb16cb7}=this[_0x47a7a0(0x1ea)](),_0x41ad9e=await database_1[_0x47a7a0(0x1e9)][_0x47a7a0(0x210)][_0x47a7a0(0x204)]({'data':{'name':_0x3173ff,'username':_0x4e856a,'password':_0x3e673a,'telegram':_0x14cb05,'shopUrl':_0x430fa9,'paymentGateways':_0x1fbb48?JSON[_0x47a7a0(0x1e3)](_0x1fbb48):null,'gatewaySettings':_0x41d3eb?JSON[_0x47a7a0(0x1e3)](_0x41d3eb):null,'usdtPolygonWallet':_0x512043?.['usdtPolygonWallet']||null,'usdtTrcWallet':_0x512043?.['usdtTrcWallet']||null,'usdtErcWallet':_0x512043?.['usdtErcWallet']||null,'usdcPolygonWallet':_0x512043?.[_0x47a7a0(0x1f8)]||null,'publicKey':_0x4f729b,'secretKey':_0xb16cb7,'status':_0x47a7a0(0x1f9)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x41ad9e['id'],'fullName':_0x41ad9e[_0x47a7a0(0x1ff)],'username':_0x41ad9e[_0x47a7a0(0x1fd)],'telegramId':_0x41ad9e[_0x47a7a0(0x1e6)],'merchantUrl':_0x41ad9e[_0x47a7a0(0x211)],'gateways':_0x41ad9e[_0x47a7a0(0x202)]?JSON[_0x47a7a0(0x20f)](_0x41ad9e[_0x47a7a0(0x202)]):null,'gatewaySettings':_0x41ad9e[_0x47a7a0(0x20c)]?JSON[_0x47a7a0(0x20f)](_0x41ad9e[_0x47a7a0(0x20c)]):null,'publicKey':_0x41ad9e[_0x47a7a0(0x1fb)],'wallets':{'usdtPolygonWallet':_0x41ad9e[_0x47a7a0(0x20e)],'usdtTrcWallet':_0x41ad9e['usdtTrcWallet'],'usdtErcWallet':_0x41ad9e[_0x47a7a0(0x1f7)],'usdcPolygonWallet':_0x41ad9e[_0x47a7a0(0x1f8)]},'status':_0x41ad9e[_0x47a7a0(0x1f3)],'createdAt':_0x41ad9e[_0x47a7a0(0x20a)]};}async['getAllUsers'](){const _0x272454=a76_0x5121d2,_0x27cbfa=await database_1[_0x272454(0x1e9)]['shop'][_0x272454(0x208)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x272454(0x201)}});return _0x27cbfa[_0x272454(0x209)](_0x51535c=>({'id':_0x51535c['id'],'fullName':_0x51535c[_0x272454(0x1ff)],'username':_0x51535c[_0x272454(0x1fd)],'telegramId':_0x51535c[_0x272454(0x1e6)],'merchantUrl':_0x51535c[_0x272454(0x211)],'gateways':_0x51535c[_0x272454(0x202)]?JSON[_0x272454(0x20f)](_0x51535c[_0x272454(0x202)]):null,'gatewaySettings':_0x51535c[_0x272454(0x20c)]?JSON[_0x272454(0x20f)](_0x51535c[_0x272454(0x20c)]):null,'publicKey':_0x51535c[_0x272454(0x1fb)],'wallets':{'usdtPolygonWallet':_0x51535c['usdtPolygonWallet'],'usdtTrcWallet':_0x51535c[_0x272454(0x207)],'usdtErcWallet':_0x51535c['usdtErcWallet'],'usdcPolygonWallet':_0x51535c[_0x272454(0x1f8)]},'status':_0x51535c[_0x272454(0x1f3)],'createdAt':_0x51535c[_0x272454(0x20a)]}));}async[a76_0x5121d2(0x1ef)](_0x32116f){const _0x557c20=a76_0x5121d2,_0x382347=await database_1['default'][_0x557c20(0x210)][_0x557c20(0x1ed)]({'where':{'id':_0x32116f},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x382347)return null;return{'id':_0x382347['id'],'fullName':_0x382347[_0x557c20(0x1ff)],'username':_0x382347[_0x557c20(0x1fd)],'telegramId':_0x382347[_0x557c20(0x1e6)],'merchantUrl':_0x382347[_0x557c20(0x211)],'gateways':_0x382347['paymentGateways']?JSON['parse'](_0x382347['paymentGateways']):null,'gatewaySettings':_0x382347[_0x557c20(0x20c)]?JSON[_0x557c20(0x20f)](_0x382347[_0x557c20(0x20c)]):null,'publicKey':_0x382347[_0x557c20(0x1fb)],'wallets':{'usdtPolygonWallet':_0x382347[_0x557c20(0x20e)],'usdtTrcWallet':_0x382347[_0x557c20(0x207)],'usdtErcWallet':_0x382347[_0x557c20(0x1f7)],'usdcPolygonWallet':_0x382347['usdcPolygonWallet']},'status':_0x382347[_0x557c20(0x1f3)],'createdAt':_0x382347[_0x557c20(0x20a)]};}async[a76_0x5121d2(0x1e7)](_0x1a3350,_0x2bd372){const _0x265f56=a76_0x5121d2,_0x4755bd={..._0x2bd372};_0x2bd372[_0x265f56(0x1f2)]&&(_0x4755bd[_0x265f56(0x1f2)]=await bcryptjs_1[_0x265f56(0x1e9)][_0x265f56(0x20d)](_0x2bd372['password'],0xc));_0x2bd372[_0x265f56(0x1e5)]&&(_0x4755bd[_0x265f56(0x1ff)]=_0x2bd372['fullName'],delete _0x4755bd[_0x265f56(0x1e5)]);_0x2bd372[_0x265f56(0x1f1)]&&(_0x4755bd[_0x265f56(0x1e6)]=_0x2bd372['telegramId'],delete _0x4755bd[_0x265f56(0x1f1)]);_0x2bd372[_0x265f56(0x20b)]&&(_0x4755bd[_0x265f56(0x211)]=_0x2bd372[_0x265f56(0x20b)],delete _0x4755bd['merchantUrl']);_0x2bd372['gateways']&&(_0x4755bd[_0x265f56(0x202)]=JSON[_0x265f56(0x1e3)](_0x2bd372['gateways']),delete _0x4755bd['gateways']);_0x2bd372[_0x265f56(0x20c)]&&(_0x4755bd[_0x265f56(0x20c)]=JSON[_0x265f56(0x1e3)](_0x2bd372['gatewaySettings']),delete _0x4755bd['gatewaySettings']);_0x2bd372[_0x265f56(0x1eb)]&&(_0x2bd372[_0x265f56(0x1eb)]['usdtPolygonWallet']!==undefined&&(_0x4755bd['usdtPolygonWallet']=_0x2bd372['wallets'][_0x265f56(0x20e)]||null),_0x2bd372['wallets'][_0x265f56(0x207)]!==undefined&&(_0x4755bd['usdtTrcWallet']=_0x2bd372[_0x265f56(0x1eb)]['usdtTrcWallet']||null),_0x2bd372[_0x265f56(0x1eb)]['usdtErcWallet']!==undefined&&(_0x4755bd[_0x265f56(0x1f7)]=_0x2bd372[_0x265f56(0x1eb)][_0x265f56(0x1f7)]||null),_0x2bd372[_0x265f56(0x1eb)]['usdcPolygonWallet']!==undefined&&(_0x4755bd[_0x265f56(0x1f8)]=_0x2bd372[_0x265f56(0x1eb)]['usdcPolygonWallet']||null),delete _0x4755bd['wallets']);const _0x55905b=await database_1[_0x265f56(0x1e9)][_0x265f56(0x210)][_0x265f56(0x1e1)]({'where':{'id':_0x1a3350},'data':_0x4755bd,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x55905b['id'],'fullName':_0x55905b[_0x265f56(0x1ff)],'username':_0x55905b[_0x265f56(0x1fd)],'telegramId':_0x55905b[_0x265f56(0x1e6)],'merchantUrl':_0x55905b['shopUrl'],'gateways':_0x55905b[_0x265f56(0x202)]?JSON[_0x265f56(0x20f)](_0x55905b[_0x265f56(0x202)]):null,'gatewaySettings':_0x55905b[_0x265f56(0x20c)]?JSON['parse'](_0x55905b['gatewaySettings']):null,'publicKey':_0x55905b[_0x265f56(0x1fb)],'wallets':{'usdtPolygonWallet':_0x55905b['usdtPolygonWallet'],'usdtTrcWallet':_0x55905b[_0x265f56(0x207)],'usdtErcWallet':_0x55905b[_0x265f56(0x1f7)],'usdcPolygonWallet':_0x55905b[_0x265f56(0x1f8)]},'status':_0x55905b['status'],'createdAt':_0x55905b[_0x265f56(0x20a)]};}async['deleteUser'](_0x2fe93d){const _0x59c662=a76_0x5121d2;await database_1['default'][_0x59c662(0x210)][_0x59c662(0x1f5)]({'where':{'id':_0x2fe93d}});}}exports['UserService']=UserService;