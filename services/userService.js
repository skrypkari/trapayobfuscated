'use strict';const a80_0x25c83d=a80_0x472b;(function(_0x4a4121,_0x2c018b){const _0x2e3c3e=a80_0x472b,_0x2d9294=_0x4a4121();while(!![]){try{const _0x25a42d=parseInt(_0x2e3c3e(0x1e6))/0x1+-parseInt(_0x2e3c3e(0x1cc))/0x2+-parseInt(_0x2e3c3e(0x1de))/0x3+parseInt(_0x2e3c3e(0x1b9))/0x4+parseInt(_0x2e3c3e(0x1bc))/0x5*(parseInt(_0x2e3c3e(0x1d4))/0x6)+parseInt(_0x2e3c3e(0x1eb))/0x7*(-parseInt(_0x2e3c3e(0x1b8))/0x8)+parseInt(_0x2e3c3e(0x1d6))/0x9;if(_0x25a42d===_0x2c018b)break;else _0x2d9294['push'](_0x2d9294['shift']());}catch(_0x4e0148){_0x2d9294['push'](_0x2d9294['shift']());}}}(a80_0x3f0f,0xd7c83));function a80_0x472b(_0x431a88,_0x51da7){_0x431a88=_0x431a88-0x1b6;const _0x3f0f2f=a80_0x3f0f();let _0x472ba8=_0x3f0f2f[_0x431a88];return _0x472ba8;}function a80_0x3f0f(){const _0xec2197=['pk_','168VWGaEr','5001864yfUDLf','merchantUrl','fullName','5KUowbg','gateways','usdtErcWallet','publicKey','defineProperty','telegramId','Username\x20already\x20exists','usdcPolygonWallet','wallets','usdtPolygonWallet','randomBytes','username','paymentGateways','sk_','deleteUser','createUser','1037270eRjBBy','createdAt','status','desc','generateApiKeys','gatewaySettings','bcryptjs','toString','6971682hVBSuP','findUnique','9780660MKLAxD','__esModule','usdtTrcWallet','default','stringify','getUserById','delete','name','4323954OzdimS','crypto','shop','../config/database','findMany','create','UserService','hash','288152mHmVfS','telegram','parse','shopUrl','hex','314503yzUShn','Telegram\x20username\x20already\x20exists','password'];a80_0x3f0f=function(){return _0xec2197;};return a80_0x3f0f();}var __importDefault=this&&this['__importDefault']||function(_0x2b737c){const _0xaf9d18=a80_0x472b;return _0x2b737c&&_0x2b737c[_0xaf9d18(0x1d7)]?_0x2b737c:{'default':_0x2b737c};};Object[a80_0x25c83d(0x1c0)](exports,a80_0x25c83d(0x1d7),{'value':!![]}),exports[a80_0x25c83d(0x1e4)]=void 0x0;const bcryptjs_1=__importDefault(require(a80_0x25c83d(0x1d2))),crypto_1=__importDefault(require(a80_0x25c83d(0x1df))),database_1=__importDefault(require(a80_0x25c83d(0x1e1)));class UserService{[a80_0x25c83d(0x1d0)](){const _0x2fe2db=a80_0x25c83d,_0x3c33f2=_0x2fe2db(0x1b7)+crypto_1[_0x2fe2db(0x1d9)][_0x2fe2db(0x1c6)](0x20)[_0x2fe2db(0x1d3)](_0x2fe2db(0x1ea)),_0x1587de=_0x2fe2db(0x1c9)+crypto_1[_0x2fe2db(0x1d9)][_0x2fe2db(0x1c6)](0x20)[_0x2fe2db(0x1d3)]('hex');return{'publicKey':_0x3c33f2,'secretKey':_0x1587de};}async[a80_0x25c83d(0x1cb)](_0x326747){const _0x57cf37=a80_0x25c83d,{fullName:_0x4070c5,username:_0x24fb0c,password:_0x5d8dd0,telegramId:_0x1ac556,merchantUrl:_0x2db75e,gateways:_0x540cb8,gatewaySettings:_0x47f516,wallets:_0xb393ec}=_0x326747,_0x391111=await database_1[_0x57cf37(0x1d9)][_0x57cf37(0x1e0)][_0x57cf37(0x1d5)]({'where':{'username':_0x24fb0c}});if(_0x391111)throw new Error(_0x57cf37(0x1c2));if(_0x1ac556){const _0x39a083=await database_1[_0x57cf37(0x1d9)][_0x57cf37(0x1e0)][_0x57cf37(0x1d5)]({'where':{'telegram':_0x1ac556}});if(_0x39a083)throw new Error(_0x57cf37(0x1ec));}const _0x198a9d=await bcryptjs_1[_0x57cf37(0x1d9)]['hash'](_0x5d8dd0,0xc),{publicKey:_0x5df8dc,secretKey:_0x50ef27}=this[_0x57cf37(0x1d0)](),_0x107c78=await database_1[_0x57cf37(0x1d9)][_0x57cf37(0x1e0)][_0x57cf37(0x1e3)]({'data':{'name':_0x4070c5,'username':_0x24fb0c,'password':_0x198a9d,'telegram':_0x1ac556,'shopUrl':_0x2db75e,'paymentGateways':_0x540cb8?JSON[_0x57cf37(0x1da)](_0x540cb8):null,'gatewaySettings':_0x47f516?JSON['stringify'](_0x47f516):null,'usdtPolygonWallet':_0xb393ec?.[_0x57cf37(0x1c5)]||null,'usdtTrcWallet':_0xb393ec?.[_0x57cf37(0x1d8)]||null,'usdtErcWallet':_0xb393ec?.[_0x57cf37(0x1be)]||null,'usdcPolygonWallet':_0xb393ec?.[_0x57cf37(0x1c3)]||null,'publicKey':_0x5df8dc,'secretKey':_0x50ef27,'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x107c78['id'],'fullName':_0x107c78[_0x57cf37(0x1dd)],'username':_0x107c78[_0x57cf37(0x1c7)],'telegramId':_0x107c78[_0x57cf37(0x1e7)],'merchantUrl':_0x107c78[_0x57cf37(0x1e9)],'gateways':_0x107c78[_0x57cf37(0x1c8)]?JSON[_0x57cf37(0x1e8)](_0x107c78['paymentGateways']):null,'gatewaySettings':_0x107c78[_0x57cf37(0x1d1)]?JSON[_0x57cf37(0x1e8)](_0x107c78[_0x57cf37(0x1d1)]):null,'publicKey':_0x107c78['publicKey'],'wallets':{'usdtPolygonWallet':_0x107c78['usdtPolygonWallet'],'usdtTrcWallet':_0x107c78[_0x57cf37(0x1d8)],'usdtErcWallet':_0x107c78[_0x57cf37(0x1be)],'usdcPolygonWallet':_0x107c78[_0x57cf37(0x1c3)]},'status':_0x107c78['status'],'createdAt':_0x107c78[_0x57cf37(0x1cd)]};}async['getAllUsers'](){const _0x106ce3=a80_0x25c83d,_0x51e8b9=await database_1[_0x106ce3(0x1d9)][_0x106ce3(0x1e0)][_0x106ce3(0x1e2)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x106ce3(0x1cf)}});return _0x51e8b9['map'](_0x205630=>({'id':_0x205630['id'],'fullName':_0x205630[_0x106ce3(0x1dd)],'username':_0x205630[_0x106ce3(0x1c7)],'telegramId':_0x205630['telegram'],'merchantUrl':_0x205630[_0x106ce3(0x1e9)],'gateways':_0x205630[_0x106ce3(0x1c8)]?JSON[_0x106ce3(0x1e8)](_0x205630[_0x106ce3(0x1c8)]):null,'gatewaySettings':_0x205630['gatewaySettings']?JSON[_0x106ce3(0x1e8)](_0x205630[_0x106ce3(0x1d1)]):null,'publicKey':_0x205630[_0x106ce3(0x1bf)],'wallets':{'usdtPolygonWallet':_0x205630[_0x106ce3(0x1c5)],'usdtTrcWallet':_0x205630[_0x106ce3(0x1d8)],'usdtErcWallet':_0x205630[_0x106ce3(0x1be)],'usdcPolygonWallet':_0x205630[_0x106ce3(0x1c3)]},'status':_0x205630[_0x106ce3(0x1ce)],'createdAt':_0x205630[_0x106ce3(0x1cd)]}));}async[a80_0x25c83d(0x1db)](_0x384b11){const _0x468f10=a80_0x25c83d,_0x45da01=await database_1[_0x468f10(0x1d9)][_0x468f10(0x1e0)][_0x468f10(0x1d5)]({'where':{'id':_0x384b11},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x45da01)return null;return{'id':_0x45da01['id'],'fullName':_0x45da01[_0x468f10(0x1dd)],'username':_0x45da01[_0x468f10(0x1c7)],'telegramId':_0x45da01[_0x468f10(0x1e7)],'merchantUrl':_0x45da01[_0x468f10(0x1e9)],'gateways':_0x45da01['paymentGateways']?JSON[_0x468f10(0x1e8)](_0x45da01['paymentGateways']):null,'gatewaySettings':_0x45da01['gatewaySettings']?JSON[_0x468f10(0x1e8)](_0x45da01[_0x468f10(0x1d1)]):null,'publicKey':_0x45da01[_0x468f10(0x1bf)],'wallets':{'usdtPolygonWallet':_0x45da01[_0x468f10(0x1c5)],'usdtTrcWallet':_0x45da01['usdtTrcWallet'],'usdtErcWallet':_0x45da01[_0x468f10(0x1be)],'usdcPolygonWallet':_0x45da01[_0x468f10(0x1c3)]},'status':_0x45da01['status'],'createdAt':_0x45da01['createdAt']};}async['updateUser'](_0x22da6a,_0x23f387){const _0x4201b5=a80_0x25c83d,_0x36da96={..._0x23f387};_0x23f387[_0x4201b5(0x1b6)]&&(_0x36da96['password']=await bcryptjs_1[_0x4201b5(0x1d9)][_0x4201b5(0x1e5)](_0x23f387[_0x4201b5(0x1b6)],0xc));_0x23f387[_0x4201b5(0x1bb)]&&(_0x36da96['name']=_0x23f387['fullName'],delete _0x36da96[_0x4201b5(0x1bb)]);_0x23f387[_0x4201b5(0x1c1)]&&(_0x36da96[_0x4201b5(0x1e7)]=_0x23f387[_0x4201b5(0x1c1)],delete _0x36da96[_0x4201b5(0x1c1)]);_0x23f387[_0x4201b5(0x1ba)]&&(_0x36da96[_0x4201b5(0x1e9)]=_0x23f387[_0x4201b5(0x1ba)],delete _0x36da96[_0x4201b5(0x1ba)]);_0x23f387[_0x4201b5(0x1bd)]&&(_0x36da96[_0x4201b5(0x1c8)]=JSON[_0x4201b5(0x1da)](_0x23f387[_0x4201b5(0x1bd)]),delete _0x36da96[_0x4201b5(0x1bd)]);_0x23f387[_0x4201b5(0x1d1)]&&(_0x36da96['gatewaySettings']=JSON[_0x4201b5(0x1da)](_0x23f387['gatewaySettings']),delete _0x36da96['gatewaySettings']);_0x23f387[_0x4201b5(0x1c4)]&&(_0x23f387[_0x4201b5(0x1c4)][_0x4201b5(0x1c5)]!==undefined&&(_0x36da96[_0x4201b5(0x1c5)]=_0x23f387['wallets'][_0x4201b5(0x1c5)]||null),_0x23f387[_0x4201b5(0x1c4)][_0x4201b5(0x1d8)]!==undefined&&(_0x36da96['usdtTrcWallet']=_0x23f387[_0x4201b5(0x1c4)][_0x4201b5(0x1d8)]||null),_0x23f387[_0x4201b5(0x1c4)][_0x4201b5(0x1be)]!==undefined&&(_0x36da96['usdtErcWallet']=_0x23f387[_0x4201b5(0x1c4)][_0x4201b5(0x1be)]||null),_0x23f387[_0x4201b5(0x1c4)][_0x4201b5(0x1c3)]!==undefined&&(_0x36da96[_0x4201b5(0x1c3)]=_0x23f387[_0x4201b5(0x1c4)][_0x4201b5(0x1c3)]||null),delete _0x36da96[_0x4201b5(0x1c4)]);const _0x409057=await database_1[_0x4201b5(0x1d9)]['shop']['update']({'where':{'id':_0x22da6a},'data':_0x36da96,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x409057['id'],'fullName':_0x409057[_0x4201b5(0x1dd)],'username':_0x409057['username'],'telegramId':_0x409057['telegram'],'merchantUrl':_0x409057[_0x4201b5(0x1e9)],'gateways':_0x409057[_0x4201b5(0x1c8)]?JSON[_0x4201b5(0x1e8)](_0x409057[_0x4201b5(0x1c8)]):null,'gatewaySettings':_0x409057[_0x4201b5(0x1d1)]?JSON[_0x4201b5(0x1e8)](_0x409057[_0x4201b5(0x1d1)]):null,'publicKey':_0x409057[_0x4201b5(0x1bf)],'wallets':{'usdtPolygonWallet':_0x409057[_0x4201b5(0x1c5)],'usdtTrcWallet':_0x409057['usdtTrcWallet'],'usdtErcWallet':_0x409057[_0x4201b5(0x1be)],'usdcPolygonWallet':_0x409057[_0x4201b5(0x1c3)]},'status':_0x409057['status'],'createdAt':_0x409057['createdAt']};}async[a80_0x25c83d(0x1ca)](_0x165cc9){const _0x254f2d=a80_0x25c83d;await database_1[_0x254f2d(0x1d9)][_0x254f2d(0x1e0)][_0x254f2d(0x1dc)]({'where':{'id':_0x165cc9}});}}exports[a80_0x25c83d(0x1e4)]=UserService;