'use strict';const a60_0x3d1bd1=a60_0x24a9;(function(_0x257a01,_0x20d1f7){const _0x13e774=a60_0x24a9,_0x38ad4e=_0x257a01();while(!![]){try{const _0x205b4a=parseInt(_0x13e774(0xbc))/0x1*(parseInt(_0x13e774(0xb0))/0x2)+-parseInt(_0x13e774(0xb4))/0x3*(parseInt(_0x13e774(0x9e))/0x4)+parseInt(_0x13e774(0x99))/0x5*(parseInt(_0x13e774(0xba))/0x6)+parseInt(_0x13e774(0xb5))/0x7+-parseInt(_0x13e774(0xd0))/0x8+-parseInt(_0x13e774(0xca))/0x9*(parseInt(_0x13e774(0xcb))/0xa)+parseInt(_0x13e774(0xa6))/0xb*(parseInt(_0x13e774(0xc3))/0xc);if(_0x205b4a===_0x20d1f7)break;else _0x38ad4e['push'](_0x38ad4e['shift']());}catch(_0x28af45){_0x38ad4e['push'](_0x38ad4e['shift']());}}}(a60_0x2657,0xb2dbb));var __importDefault=this&&this[a60_0x3d1bd1(0xb7)]||function(_0x2686d7){const _0x492134=a60_0x3d1bd1;return _0x2686d7&&_0x2686d7[_0x492134(0x96)]?_0x2686d7:{'default':_0x2686d7};};Object[a60_0x3d1bd1(0xce)](exports,'__esModule',{'value':!![]}),exports[a60_0x3d1bd1(0xad)]=void 0x0;function a60_0x24a9(_0x4136cf,_0x4ff2e9){const _0x265768=a60_0x2657();return a60_0x24a9=function(_0x24a9ca,_0x423938){_0x24a9ca=_0x24a9ca-0x95;let _0x54dc6e=_0x265768[_0x24a9ca];return _0x54dc6e;},a60_0x24a9(_0x4136cf,_0x4ff2e9);}const bcryptjs_1=__importDefault(require(a60_0x3d1bd1(0xbb))),crypto_1=__importDefault(require('crypto')),database_1=__importDefault(require(a60_0x3d1bd1(0xc1)));function a60_0x2657(){const _0x5c81a9=['usdtTrcWallet','__esModule','create','toString','51755rrhWDs','username','parse','hash','gateways','156ItCrqJ','shop','usdtErcWallet','delete','findUnique','telegramId','telegram','name','220nDPqtZ','stringify','hex','getAllUsers','findMany','updateUser','status','UserService','Telegram\x20username\x20already\x20exists','createdAt','165652AcNvOJ','randomBytes','wallets','getUserById','7911hZPgIu','5381551dmfDAN','map','__importDefault','paymentGateways','publicKey','60AkLNeU','bcryptjs','2ujuGfW','fullName','password','pk_','desc','../config/database','generateApiKeys','612744qlgPpE','ACTIVE','deleteUser','default','gatewaySettings','usdcPolygonWallet','Username\x20already\x20exists','31410kaDudt','1690mjodus','usdtPolygonWallet','sk_','defineProperty','merchantUrl','5071512zCPxUE','shopUrl'];a60_0x2657=function(){return _0x5c81a9;};return a60_0x2657();}class UserService{['generateApiKeys'](){const _0x28d5ef=a60_0x3d1bd1,_0x18f067=_0x28d5ef(0xbf)+crypto_1[_0x28d5ef(0xc6)][_0x28d5ef(0xb1)](0x20)[_0x28d5ef(0x98)](_0x28d5ef(0xa8)),_0x343ac8=_0x28d5ef(0xcd)+crypto_1[_0x28d5ef(0xc6)][_0x28d5ef(0xb1)](0x20)['toString'](_0x28d5ef(0xa8));return{'publicKey':_0x18f067,'secretKey':_0x343ac8};}async['createUser'](_0x24cdac){const _0x98f7cc=a60_0x3d1bd1,{fullName:_0x9eb605,username:_0x4d3acd,password:_0x373835,telegramId:_0x4aa6c1,merchantUrl:_0x150730,gateways:_0x4cad11,gatewaySettings:_0x34a7c4,wallets:_0x43f745}=_0x24cdac,_0x2581bc=await database_1[_0x98f7cc(0xc6)][_0x98f7cc(0x9f)][_0x98f7cc(0xa2)]({'where':{'username':_0x4d3acd}});if(_0x2581bc)throw new Error(_0x98f7cc(0xc9));if(_0x4aa6c1){const _0x5e0015=await database_1[_0x98f7cc(0xc6)][_0x98f7cc(0x9f)][_0x98f7cc(0xa2)]({'where':{'telegram':_0x4aa6c1}});if(_0x5e0015)throw new Error(_0x98f7cc(0xae));}const _0x189fcb=await bcryptjs_1[_0x98f7cc(0xc6)]['hash'](_0x373835,0xc),{publicKey:_0x40008c,secretKey:_0xcafb8f}=this[_0x98f7cc(0xc2)](),_0x4c7546=await database_1[_0x98f7cc(0xc6)]['shop'][_0x98f7cc(0x97)]({'data':{'name':_0x9eb605,'username':_0x4d3acd,'password':_0x189fcb,'telegram':_0x4aa6c1,'shopUrl':_0x150730,'paymentGateways':_0x4cad11?JSON['stringify'](_0x4cad11):null,'gatewaySettings':_0x34a7c4?JSON[_0x98f7cc(0xa7)](_0x34a7c4):null,'usdtPolygonWallet':_0x43f745?.['usdtPolygonWallet']||null,'usdtTrcWallet':_0x43f745?.[_0x98f7cc(0x95)]||null,'usdtErcWallet':_0x43f745?.['usdtErcWallet']||null,'usdcPolygonWallet':_0x43f745?.[_0x98f7cc(0xc8)]||null,'publicKey':_0x40008c,'secretKey':_0xcafb8f,'status':_0x98f7cc(0xc4)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x4c7546['id'],'fullName':_0x4c7546[_0x98f7cc(0xa5)],'username':_0x4c7546[_0x98f7cc(0x9a)],'telegramId':_0x4c7546['telegram'],'merchantUrl':_0x4c7546['shopUrl'],'gateways':_0x4c7546[_0x98f7cc(0xb8)]?JSON['parse'](_0x4c7546[_0x98f7cc(0xb8)]):null,'gatewaySettings':_0x4c7546['gatewaySettings']?JSON['parse'](_0x4c7546['gatewaySettings']):null,'publicKey':_0x4c7546[_0x98f7cc(0xb9)],'wallets':{'usdtPolygonWallet':_0x4c7546[_0x98f7cc(0xcc)],'usdtTrcWallet':_0x4c7546[_0x98f7cc(0x95)],'usdtErcWallet':_0x4c7546[_0x98f7cc(0xa0)],'usdcPolygonWallet':_0x4c7546['usdcPolygonWallet']},'status':_0x4c7546[_0x98f7cc(0xac)],'createdAt':_0x4c7546[_0x98f7cc(0xaf)]};}async[a60_0x3d1bd1(0xa9)](){const _0x4ba456=a60_0x3d1bd1,_0x3a4323=await database_1[_0x4ba456(0xc6)]['shop'][_0x4ba456(0xaa)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x4ba456(0xc0)}});return _0x3a4323[_0x4ba456(0xb6)](_0x895573=>({'id':_0x895573['id'],'fullName':_0x895573[_0x4ba456(0xa5)],'username':_0x895573[_0x4ba456(0x9a)],'telegramId':_0x895573['telegram'],'merchantUrl':_0x895573[_0x4ba456(0xd1)],'gateways':_0x895573[_0x4ba456(0xb8)]?JSON[_0x4ba456(0x9b)](_0x895573['paymentGateways']):null,'gatewaySettings':_0x895573[_0x4ba456(0xc7)]?JSON[_0x4ba456(0x9b)](_0x895573[_0x4ba456(0xc7)]):null,'publicKey':_0x895573[_0x4ba456(0xb9)],'wallets':{'usdtPolygonWallet':_0x895573['usdtPolygonWallet'],'usdtTrcWallet':_0x895573[_0x4ba456(0x95)],'usdtErcWallet':_0x895573[_0x4ba456(0xa0)],'usdcPolygonWallet':_0x895573[_0x4ba456(0xc8)]},'status':_0x895573[_0x4ba456(0xac)],'createdAt':_0x895573['createdAt']}));}async[a60_0x3d1bd1(0xb3)](_0x59caa6){const _0x5be04d=a60_0x3d1bd1,_0x4a529a=await database_1[_0x5be04d(0xc6)][_0x5be04d(0x9f)][_0x5be04d(0xa2)]({'where':{'id':_0x59caa6},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x4a529a)return null;return{'id':_0x4a529a['id'],'fullName':_0x4a529a[_0x5be04d(0xa5)],'username':_0x4a529a[_0x5be04d(0x9a)],'telegramId':_0x4a529a[_0x5be04d(0xa4)],'merchantUrl':_0x4a529a['shopUrl'],'gateways':_0x4a529a[_0x5be04d(0xb8)]?JSON[_0x5be04d(0x9b)](_0x4a529a['paymentGateways']):null,'gatewaySettings':_0x4a529a['gatewaySettings']?JSON['parse'](_0x4a529a[_0x5be04d(0xc7)]):null,'publicKey':_0x4a529a[_0x5be04d(0xb9)],'wallets':{'usdtPolygonWallet':_0x4a529a['usdtPolygonWallet'],'usdtTrcWallet':_0x4a529a['usdtTrcWallet'],'usdtErcWallet':_0x4a529a[_0x5be04d(0xa0)],'usdcPolygonWallet':_0x4a529a['usdcPolygonWallet']},'status':_0x4a529a[_0x5be04d(0xac)],'createdAt':_0x4a529a[_0x5be04d(0xaf)]};}async[a60_0x3d1bd1(0xab)](_0x8e8f88,_0x7f9d12){const _0x10477b=a60_0x3d1bd1,_0x32decf={..._0x7f9d12};_0x7f9d12[_0x10477b(0xbe)]&&(_0x32decf['password']=await bcryptjs_1[_0x10477b(0xc6)][_0x10477b(0x9c)](_0x7f9d12[_0x10477b(0xbe)],0xc));_0x7f9d12[_0x10477b(0xbd)]&&(_0x32decf[_0x10477b(0xa5)]=_0x7f9d12['fullName'],delete _0x32decf[_0x10477b(0xbd)]);_0x7f9d12[_0x10477b(0xa3)]&&(_0x32decf['telegram']=_0x7f9d12['telegramId'],delete _0x32decf[_0x10477b(0xa3)]);_0x7f9d12[_0x10477b(0xcf)]&&(_0x32decf[_0x10477b(0xd1)]=_0x7f9d12[_0x10477b(0xcf)],delete _0x32decf[_0x10477b(0xcf)]);_0x7f9d12[_0x10477b(0x9d)]&&(_0x32decf[_0x10477b(0xb8)]=JSON[_0x10477b(0xa7)](_0x7f9d12['gateways']),delete _0x32decf[_0x10477b(0x9d)]);_0x7f9d12[_0x10477b(0xc7)]&&(_0x32decf[_0x10477b(0xc7)]=JSON['stringify'](_0x7f9d12[_0x10477b(0xc7)]),delete _0x32decf[_0x10477b(0xc7)]);_0x7f9d12['wallets']&&(_0x7f9d12['wallets'][_0x10477b(0xcc)]!==undefined&&(_0x32decf[_0x10477b(0xcc)]=_0x7f9d12['wallets'][_0x10477b(0xcc)]||null),_0x7f9d12[_0x10477b(0xb2)][_0x10477b(0x95)]!==undefined&&(_0x32decf[_0x10477b(0x95)]=_0x7f9d12[_0x10477b(0xb2)][_0x10477b(0x95)]||null),_0x7f9d12[_0x10477b(0xb2)][_0x10477b(0xa0)]!==undefined&&(_0x32decf[_0x10477b(0xa0)]=_0x7f9d12[_0x10477b(0xb2)]['usdtErcWallet']||null),_0x7f9d12['wallets']['usdcPolygonWallet']!==undefined&&(_0x32decf[_0x10477b(0xc8)]=_0x7f9d12[_0x10477b(0xb2)][_0x10477b(0xc8)]||null),delete _0x32decf[_0x10477b(0xb2)]);const _0x151075=await database_1[_0x10477b(0xc6)]['shop']['update']({'where':{'id':_0x8e8f88},'data':_0x32decf,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x151075['id'],'fullName':_0x151075[_0x10477b(0xa5)],'username':_0x151075[_0x10477b(0x9a)],'telegramId':_0x151075['telegram'],'merchantUrl':_0x151075[_0x10477b(0xd1)],'gateways':_0x151075[_0x10477b(0xb8)]?JSON[_0x10477b(0x9b)](_0x151075['paymentGateways']):null,'gatewaySettings':_0x151075[_0x10477b(0xc7)]?JSON[_0x10477b(0x9b)](_0x151075[_0x10477b(0xc7)]):null,'publicKey':_0x151075[_0x10477b(0xb9)],'wallets':{'usdtPolygonWallet':_0x151075[_0x10477b(0xcc)],'usdtTrcWallet':_0x151075[_0x10477b(0x95)],'usdtErcWallet':_0x151075[_0x10477b(0xa0)],'usdcPolygonWallet':_0x151075['usdcPolygonWallet']},'status':_0x151075['status'],'createdAt':_0x151075[_0x10477b(0xaf)]};}async[a60_0x3d1bd1(0xc5)](_0x39ece3){const _0x1e3091=a60_0x3d1bd1;await database_1[_0x1e3091(0xc6)][_0x1e3091(0x9f)][_0x1e3091(0xa1)]({'where':{'id':_0x39ece3}});}}exports[a60_0x3d1bd1(0xad)]=UserService;