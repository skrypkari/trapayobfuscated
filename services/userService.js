'use strict';function a56_0x4717(){const _0x306e5c=['status','sk_','getUserById','472WLkQzU','updateUser','1385622DkdxZi','findMany','shop','3027TtYaNJ','findUnique','toString','hex','6804GiQtWt','__importDefault','2663628NEMyyb','name','delete','password','195QthJmz','usdtTrcWallet','merchantUrl','telegramId','11jJqHHj','map','stringify','default','shopUrl','fullName','17722mitYdD','crypto','gatewaySettings','10IoIpGM','usdcPolygonWallet','pk_','usdtErcWallet','defineProperty','publicKey','wallets','deleteUser','paymentGateways','create','createdAt','__esModule','update','telegram','12JveCFG','hash','352580qPySEQ','parse','randomBytes','12pVrlBr','gateways','usdtPolygonWallet','generateApiKeys','643454ORtFej','UserService','Telegram\x20username\x20already\x20exists','../config/database','Username\x20already\x20exists','username','48iLIqFk'];a56_0x4717=function(){return _0x306e5c;};return a56_0x4717();}const a56_0x3ee5b8=a56_0x2a0e;(function(_0x4ef7f0,_0x2dd363){const _0x137273=a56_0x2a0e,_0x25d455=_0x4ef7f0();while(!![]){try{const _0x528848=-parseInt(_0x137273(0x17b))/0x1*(-parseInt(_0x137273(0x1a2))/0x2)+parseInt(_0x137273(0x18e))/0x3*(-parseInt(_0x137273(0x189))/0x4)+-parseInt(_0x137273(0x178))/0x5*(parseInt(_0x137273(0x176))/0x6)+-parseInt(_0x137273(0x192))/0x7*(-parseInt(_0x137273(0x185))/0x8)+parseInt(_0x137273(0x18b))/0x9*(-parseInt(_0x137273(0x1a5))/0xa)+parseInt(_0x137273(0x19c))/0xb*(-parseInt(_0x137273(0x194))/0xc)+parseInt(_0x137273(0x198))/0xd*(parseInt(_0x137273(0x17f))/0xe);if(_0x528848===_0x2dd363)break;else _0x25d455['push'](_0x25d455['shift']());}catch(_0x5013e5){_0x25d455['push'](_0x25d455['shift']());}}}(a56_0x4717,0x286b6));var __importDefault=this&&this[a56_0x3ee5b8(0x193)]||function(_0x12cce7){const _0x589567=a56_0x3ee5b8;return _0x12cce7&&_0x12cce7[_0x589567(0x173)]?_0x12cce7:{'default':_0x12cce7};};Object[a56_0x3ee5b8(0x1a9)](exports,'__esModule',{'value':!![]}),exports['UserService']=void 0x0;function a56_0x2a0e(_0x21517e,_0x2ae0eb){const _0x47171c=a56_0x4717();return a56_0x2a0e=function(_0x2a0ea4,_0x350d0a){_0x2a0ea4=_0x2a0ea4-0x170;let _0x4ae9ec=_0x47171c[_0x2a0ea4];return _0x4ae9ec;},a56_0x2a0e(_0x21517e,_0x2ae0eb);}const bcryptjs_1=__importDefault(require('bcryptjs')),crypto_1=__importDefault(require(a56_0x3ee5b8(0x1a3))),database_1=__importDefault(require(a56_0x3ee5b8(0x182)));class UserService{[a56_0x3ee5b8(0x17e)](){const _0x1cc94b=a56_0x3ee5b8,_0x16bed3=_0x1cc94b(0x1a7)+crypto_1[_0x1cc94b(0x19f)][_0x1cc94b(0x17a)](0x20)[_0x1cc94b(0x190)](_0x1cc94b(0x191)),_0x469092=_0x1cc94b(0x187)+crypto_1[_0x1cc94b(0x19f)][_0x1cc94b(0x17a)](0x20)[_0x1cc94b(0x190)]('hex');return{'publicKey':_0x16bed3,'secretKey':_0x469092};}async['createUser'](_0x37384c){const _0x46fb1a=a56_0x3ee5b8,{fullName:_0x4bcde0,username:_0x4b5db1,password:_0x131c02,telegramId:_0x1ef56b,merchantUrl:_0x29e85f,gateways:_0x4e9a2b,gatewaySettings:_0x26c8cb,wallets:_0x1000a3}=_0x37384c,_0x3c9134=await database_1[_0x46fb1a(0x19f)][_0x46fb1a(0x18d)][_0x46fb1a(0x18f)]({'where':{'username':_0x4b5db1}});if(_0x3c9134)throw new Error(_0x46fb1a(0x183));if(_0x1ef56b){const _0x563a5e=await database_1['default']['shop']['findUnique']({'where':{'telegram':_0x1ef56b}});if(_0x563a5e)throw new Error(_0x46fb1a(0x181));}const _0x2d5059=await bcryptjs_1[_0x46fb1a(0x19f)][_0x46fb1a(0x177)](_0x131c02,0xc),{publicKey:_0x53750a,secretKey:_0x3afe09}=this['generateApiKeys'](),_0xc62b49=await database_1['default'][_0x46fb1a(0x18d)][_0x46fb1a(0x171)]({'data':{'name':_0x4bcde0,'username':_0x4b5db1,'password':_0x2d5059,'telegram':_0x1ef56b,'shopUrl':_0x29e85f,'paymentGateways':_0x4e9a2b?JSON[_0x46fb1a(0x19e)](_0x4e9a2b):null,'gatewaySettings':_0x26c8cb?JSON['stringify'](_0x26c8cb):null,'usdtPolygonWallet':_0x1000a3?.[_0x46fb1a(0x17d)]||null,'usdtTrcWallet':_0x1000a3?.[_0x46fb1a(0x199)]||null,'usdtErcWallet':_0x1000a3?.[_0x46fb1a(0x1a8)]||null,'usdcPolygonWallet':_0x1000a3?.[_0x46fb1a(0x1a6)]||null,'publicKey':_0x53750a,'secretKey':_0x3afe09,'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0xc62b49['id'],'fullName':_0xc62b49[_0x46fb1a(0x195)],'username':_0xc62b49[_0x46fb1a(0x184)],'telegramId':_0xc62b49['telegram'],'merchantUrl':_0xc62b49[_0x46fb1a(0x1a0)],'gateways':_0xc62b49[_0x46fb1a(0x170)]?JSON[_0x46fb1a(0x179)](_0xc62b49['paymentGateways']):null,'gatewaySettings':_0xc62b49[_0x46fb1a(0x1a4)]?JSON[_0x46fb1a(0x179)](_0xc62b49[_0x46fb1a(0x1a4)]):null,'publicKey':_0xc62b49['publicKey'],'wallets':{'usdtPolygonWallet':_0xc62b49[_0x46fb1a(0x17d)],'usdtTrcWallet':_0xc62b49['usdtTrcWallet'],'usdtErcWallet':_0xc62b49[_0x46fb1a(0x1a8)],'usdcPolygonWallet':_0xc62b49[_0x46fb1a(0x1a6)]},'status':_0xc62b49[_0x46fb1a(0x186)],'createdAt':_0xc62b49['createdAt']};}async['getAllUsers'](){const _0x1b3b2c=a56_0x3ee5b8,_0x290770=await database_1[_0x1b3b2c(0x19f)]['shop'][_0x1b3b2c(0x18c)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':'desc'}});return _0x290770[_0x1b3b2c(0x19d)](_0x3af74c=>({'id':_0x3af74c['id'],'fullName':_0x3af74c[_0x1b3b2c(0x195)],'username':_0x3af74c[_0x1b3b2c(0x184)],'telegramId':_0x3af74c[_0x1b3b2c(0x175)],'merchantUrl':_0x3af74c['shopUrl'],'gateways':_0x3af74c[_0x1b3b2c(0x170)]?JSON[_0x1b3b2c(0x179)](_0x3af74c[_0x1b3b2c(0x170)]):null,'gatewaySettings':_0x3af74c[_0x1b3b2c(0x1a4)]?JSON['parse'](_0x3af74c[_0x1b3b2c(0x1a4)]):null,'publicKey':_0x3af74c[_0x1b3b2c(0x1aa)],'wallets':{'usdtPolygonWallet':_0x3af74c[_0x1b3b2c(0x17d)],'usdtTrcWallet':_0x3af74c[_0x1b3b2c(0x199)],'usdtErcWallet':_0x3af74c['usdtErcWallet'],'usdcPolygonWallet':_0x3af74c['usdcPolygonWallet']},'status':_0x3af74c[_0x1b3b2c(0x186)],'createdAt':_0x3af74c['createdAt']}));}async[a56_0x3ee5b8(0x188)](_0x52360f){const _0x5e2ffe=a56_0x3ee5b8,_0x2df4e2=await database_1[_0x5e2ffe(0x19f)]['shop'][_0x5e2ffe(0x18f)]({'where':{'id':_0x52360f},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x2df4e2)return null;return{'id':_0x2df4e2['id'],'fullName':_0x2df4e2['name'],'username':_0x2df4e2[_0x5e2ffe(0x184)],'telegramId':_0x2df4e2['telegram'],'merchantUrl':_0x2df4e2[_0x5e2ffe(0x1a0)],'gateways':_0x2df4e2[_0x5e2ffe(0x170)]?JSON[_0x5e2ffe(0x179)](_0x2df4e2[_0x5e2ffe(0x170)]):null,'gatewaySettings':_0x2df4e2[_0x5e2ffe(0x1a4)]?JSON[_0x5e2ffe(0x179)](_0x2df4e2[_0x5e2ffe(0x1a4)]):null,'publicKey':_0x2df4e2[_0x5e2ffe(0x1aa)],'wallets':{'usdtPolygonWallet':_0x2df4e2[_0x5e2ffe(0x17d)],'usdtTrcWallet':_0x2df4e2['usdtTrcWallet'],'usdtErcWallet':_0x2df4e2[_0x5e2ffe(0x1a8)],'usdcPolygonWallet':_0x2df4e2[_0x5e2ffe(0x1a6)]},'status':_0x2df4e2[_0x5e2ffe(0x186)],'createdAt':_0x2df4e2[_0x5e2ffe(0x172)]};}async[a56_0x3ee5b8(0x18a)](_0x253520,_0x38484c){const _0x2f9f3b=a56_0x3ee5b8,_0x11db49={..._0x38484c};_0x38484c[_0x2f9f3b(0x197)]&&(_0x11db49[_0x2f9f3b(0x197)]=await bcryptjs_1[_0x2f9f3b(0x19f)][_0x2f9f3b(0x177)](_0x38484c['password'],0xc));_0x38484c[_0x2f9f3b(0x1a1)]&&(_0x11db49[_0x2f9f3b(0x195)]=_0x38484c[_0x2f9f3b(0x1a1)],delete _0x11db49['fullName']);_0x38484c[_0x2f9f3b(0x19b)]&&(_0x11db49[_0x2f9f3b(0x175)]=_0x38484c[_0x2f9f3b(0x19b)],delete _0x11db49[_0x2f9f3b(0x19b)]);_0x38484c[_0x2f9f3b(0x19a)]&&(_0x11db49[_0x2f9f3b(0x1a0)]=_0x38484c['merchantUrl'],delete _0x11db49['merchantUrl']);_0x38484c[_0x2f9f3b(0x17c)]&&(_0x11db49[_0x2f9f3b(0x170)]=JSON['stringify'](_0x38484c['gateways']),delete _0x11db49['gateways']);_0x38484c[_0x2f9f3b(0x1a4)]&&(_0x11db49[_0x2f9f3b(0x1a4)]=JSON[_0x2f9f3b(0x19e)](_0x38484c['gatewaySettings']),delete _0x11db49[_0x2f9f3b(0x1a4)]);_0x38484c['wallets']&&(_0x38484c[_0x2f9f3b(0x1ab)][_0x2f9f3b(0x17d)]!==undefined&&(_0x11db49[_0x2f9f3b(0x17d)]=_0x38484c[_0x2f9f3b(0x1ab)][_0x2f9f3b(0x17d)]||null),_0x38484c[_0x2f9f3b(0x1ab)][_0x2f9f3b(0x199)]!==undefined&&(_0x11db49[_0x2f9f3b(0x199)]=_0x38484c[_0x2f9f3b(0x1ab)][_0x2f9f3b(0x199)]||null),_0x38484c[_0x2f9f3b(0x1ab)][_0x2f9f3b(0x1a8)]!==undefined&&(_0x11db49[_0x2f9f3b(0x1a8)]=_0x38484c['wallets']['usdtErcWallet']||null),_0x38484c[_0x2f9f3b(0x1ab)][_0x2f9f3b(0x1a6)]!==undefined&&(_0x11db49[_0x2f9f3b(0x1a6)]=_0x38484c[_0x2f9f3b(0x1ab)]['usdcPolygonWallet']||null),delete _0x11db49[_0x2f9f3b(0x1ab)]);const _0x73077d=await database_1[_0x2f9f3b(0x19f)][_0x2f9f3b(0x18d)][_0x2f9f3b(0x174)]({'where':{'id':_0x253520},'data':_0x11db49,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x73077d['id'],'fullName':_0x73077d[_0x2f9f3b(0x195)],'username':_0x73077d[_0x2f9f3b(0x184)],'telegramId':_0x73077d['telegram'],'merchantUrl':_0x73077d['shopUrl'],'gateways':_0x73077d['paymentGateways']?JSON['parse'](_0x73077d[_0x2f9f3b(0x170)]):null,'gatewaySettings':_0x73077d[_0x2f9f3b(0x1a4)]?JSON['parse'](_0x73077d['gatewaySettings']):null,'publicKey':_0x73077d[_0x2f9f3b(0x1aa)],'wallets':{'usdtPolygonWallet':_0x73077d[_0x2f9f3b(0x17d)],'usdtTrcWallet':_0x73077d[_0x2f9f3b(0x199)],'usdtErcWallet':_0x73077d[_0x2f9f3b(0x1a8)],'usdcPolygonWallet':_0x73077d[_0x2f9f3b(0x1a6)]},'status':_0x73077d[_0x2f9f3b(0x186)],'createdAt':_0x73077d['createdAt']};}async[a56_0x3ee5b8(0x1ac)](_0x140c6e){const _0x299edf=a56_0x3ee5b8;await database_1[_0x299edf(0x19f)][_0x299edf(0x18d)][_0x299edf(0x196)]({'where':{'id':_0x140c6e}});}}exports[a56_0x3ee5b8(0x180)]=UserService;