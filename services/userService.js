'use strict';const a56_0x38dcce=a56_0xd9b8;(function(_0x3574c7,_0x778de5){const _0x1847f6=a56_0xd9b8,_0x2a6e0d=_0x3574c7();while(!![]){try{const _0x2211f8=parseInt(_0x1847f6(0x1ff))/0x1*(-parseInt(_0x1847f6(0x1e3))/0x2)+-parseInt(_0x1847f6(0x1ec))/0x3*(parseInt(_0x1847f6(0x203))/0x4)+parseInt(_0x1847f6(0x1fb))/0x5*(parseInt(_0x1847f6(0x1de))/0x6)+parseInt(_0x1847f6(0x1ed))/0x7*(parseInt(_0x1847f6(0x209))/0x8)+-parseInt(_0x1847f6(0x1db))/0x9+parseInt(_0x1847f6(0x20d))/0xa+parseInt(_0x1847f6(0x1dc))/0xb;if(_0x2211f8===_0x778de5)break;else _0x2a6e0d['push'](_0x2a6e0d['shift']());}catch(_0x4b0134){_0x2a6e0d['push'](_0x2a6e0d['shift']());}}}(a56_0x4ae9,0x85a8f));var __importDefault=this&&this['__importDefault']||function(_0x5d55f3){const _0xdf931e=a56_0xd9b8;return _0x5d55f3&&_0x5d55f3[_0xdf931e(0x1f5)]?_0x5d55f3:{'default':_0x5d55f3};};Object[a56_0x38dcce(0x1fc)](exports,a56_0x38dcce(0x1f5),{'value':!![]}),exports['UserService']=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),crypto_1=__importDefault(require('crypto')),database_1=__importDefault(require('../config/database'));function a56_0xd9b8(_0x51972a,_0x4d6165){const _0x4ae9d1=a56_0x4ae9();return a56_0xd9b8=function(_0xd9b8ff,_0x38103d){_0xd9b8ff=_0xd9b8ff-0x1d8;let _0x320f7e=_0x4ae9d1[_0xd9b8ff];return _0x320f7e;},a56_0xd9b8(_0x51972a,_0x4d6165);}class UserService{[a56_0x38dcce(0x20b)](){const _0x450e6b=a56_0x38dcce,_0x4b2061=_0x450e6b(0x1ea)+crypto_1[_0x450e6b(0x1fa)][_0x450e6b(0x1e7)](0x20)[_0x450e6b(0x1e0)](_0x450e6b(0x1e8)),_0x522e47=_0x450e6b(0x206)+crypto_1['default'][_0x450e6b(0x1e7)](0x20)[_0x450e6b(0x1e0)](_0x450e6b(0x1e8));return{'publicKey':_0x4b2061,'secretKey':_0x522e47};}async[a56_0x38dcce(0x1e9)](_0x10da3e){const _0x3b6174=a56_0x38dcce,{fullName:_0x56fcd9,username:_0x255b30,password:_0x30747d,telegramId:_0x3e7c0a,merchantUrl:_0xd81ed,gateways:_0xd493ec,gatewaySettings:_0x517200,wallets:_0x28791c}=_0x10da3e,_0x1e1b2a=await database_1['default'][_0x3b6174(0x1f6)][_0x3b6174(0x1da)]({'where':{'username':_0x255b30}});if(_0x1e1b2a)throw new Error(_0x3b6174(0x1f3));if(_0x3e7c0a){const _0x2ad956=await database_1['default'][_0x3b6174(0x1f6)][_0x3b6174(0x1da)]({'where':{'telegram':_0x3e7c0a}});if(_0x2ad956)throw new Error(_0x3b6174(0x1f1));}const _0x448d49=await bcryptjs_1[_0x3b6174(0x1fa)][_0x3b6174(0x1ee)](_0x30747d,0xc),{publicKey:_0x29f6be,secretKey:_0x516cad}=this[_0x3b6174(0x20b)](),_0x47fb41=await database_1[_0x3b6174(0x1fa)][_0x3b6174(0x1f6)][_0x3b6174(0x20e)]({'data':{'name':_0x56fcd9,'username':_0x255b30,'password':_0x448d49,'telegram':_0x3e7c0a,'shopUrl':_0xd81ed,'paymentGateways':_0xd493ec?JSON[_0x3b6174(0x20c)](_0xd493ec):null,'gatewaySettings':_0x517200?JSON['stringify'](_0x517200):null,'usdtPolygonWallet':_0x28791c?.[_0x3b6174(0x210)]||null,'usdtTrcWallet':_0x28791c?.[_0x3b6174(0x1d8)]||null,'usdtErcWallet':_0x28791c?.[_0x3b6174(0x1f2)]||null,'usdcPolygonWallet':_0x28791c?.['usdcPolygonWallet']||null,'publicKey':_0x29f6be,'secretKey':_0x516cad,'status':_0x3b6174(0x1e5)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x47fb41['id'],'fullName':_0x47fb41[_0x3b6174(0x208)],'username':_0x47fb41[_0x3b6174(0x1f0)],'telegramId':_0x47fb41[_0x3b6174(0x1ef)],'merchantUrl':_0x47fb41[_0x3b6174(0x1e1)],'gateways':_0x47fb41['paymentGateways']?JSON[_0x3b6174(0x1dd)](_0x47fb41[_0x3b6174(0x1fd)]):null,'gatewaySettings':_0x47fb41['gatewaySettings']?JSON[_0x3b6174(0x1dd)](_0x47fb41[_0x3b6174(0x1eb)]):null,'publicKey':_0x47fb41[_0x3b6174(0x200)],'wallets':{'usdtPolygonWallet':_0x47fb41[_0x3b6174(0x210)],'usdtTrcWallet':_0x47fb41[_0x3b6174(0x1d8)],'usdtErcWallet':_0x47fb41[_0x3b6174(0x1f2)],'usdcPolygonWallet':_0x47fb41[_0x3b6174(0x1f8)]},'status':_0x47fb41[_0x3b6174(0x1d9)],'createdAt':_0x47fb41[_0x3b6174(0x1f4)]};}async[a56_0x38dcce(0x205)](){const _0x474660=a56_0x38dcce,_0x15208b=await database_1[_0x474660(0x1fa)][_0x474660(0x1f6)][_0x474660(0x211)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':'desc'}});return _0x15208b[_0x474660(0x1e6)](_0x409d7a=>({'id':_0x409d7a['id'],'fullName':_0x409d7a[_0x474660(0x208)],'username':_0x409d7a[_0x474660(0x1f0)],'telegramId':_0x409d7a[_0x474660(0x1ef)],'merchantUrl':_0x409d7a[_0x474660(0x1e1)],'gateways':_0x409d7a[_0x474660(0x1fd)]?JSON[_0x474660(0x1dd)](_0x409d7a['paymentGateways']):null,'gatewaySettings':_0x409d7a['gatewaySettings']?JSON[_0x474660(0x1dd)](_0x409d7a[_0x474660(0x1eb)]):null,'publicKey':_0x409d7a[_0x474660(0x200)],'wallets':{'usdtPolygonWallet':_0x409d7a[_0x474660(0x210)],'usdtTrcWallet':_0x409d7a[_0x474660(0x1d8)],'usdtErcWallet':_0x409d7a['usdtErcWallet'],'usdcPolygonWallet':_0x409d7a[_0x474660(0x1f8)]},'status':_0x409d7a[_0x474660(0x1d9)],'createdAt':_0x409d7a[_0x474660(0x1f4)]}));}async[a56_0x38dcce(0x20a)](_0x3f910e){const _0x2b0ced=a56_0x38dcce,_0x2773b7=await database_1[_0x2b0ced(0x1fa)]['shop'][_0x2b0ced(0x1da)]({'where':{'id':_0x3f910e},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x2773b7)return null;return{'id':_0x2773b7['id'],'fullName':_0x2773b7['name'],'username':_0x2773b7['username'],'telegramId':_0x2773b7[_0x2b0ced(0x1ef)],'merchantUrl':_0x2773b7['shopUrl'],'gateways':_0x2773b7[_0x2b0ced(0x1fd)]?JSON[_0x2b0ced(0x1dd)](_0x2773b7['paymentGateways']):null,'gatewaySettings':_0x2773b7['gatewaySettings']?JSON[_0x2b0ced(0x1dd)](_0x2773b7[_0x2b0ced(0x1eb)]):null,'publicKey':_0x2773b7['publicKey'],'wallets':{'usdtPolygonWallet':_0x2773b7[_0x2b0ced(0x210)],'usdtTrcWallet':_0x2773b7[_0x2b0ced(0x1d8)],'usdtErcWallet':_0x2773b7['usdtErcWallet'],'usdcPolygonWallet':_0x2773b7[_0x2b0ced(0x1f8)]},'status':_0x2773b7[_0x2b0ced(0x1d9)],'createdAt':_0x2773b7[_0x2b0ced(0x1f4)]};}async[a56_0x38dcce(0x202)](_0x4e7865,_0x2b4c4b){const _0x3ccb0a=a56_0x38dcce,_0x245510={..._0x2b4c4b};_0x2b4c4b['password']&&(_0x245510[_0x3ccb0a(0x1e2)]=await bcryptjs_1[_0x3ccb0a(0x1fa)][_0x3ccb0a(0x1ee)](_0x2b4c4b[_0x3ccb0a(0x1e2)],0xc));_0x2b4c4b[_0x3ccb0a(0x201)]&&(_0x245510[_0x3ccb0a(0x208)]=_0x2b4c4b[_0x3ccb0a(0x201)],delete _0x245510['fullName']);_0x2b4c4b[_0x3ccb0a(0x1df)]&&(_0x245510['telegram']=_0x2b4c4b[_0x3ccb0a(0x1df)],delete _0x245510[_0x3ccb0a(0x1df)]);_0x2b4c4b[_0x3ccb0a(0x1e4)]&&(_0x245510[_0x3ccb0a(0x1e1)]=_0x2b4c4b[_0x3ccb0a(0x1e4)],delete _0x245510[_0x3ccb0a(0x1e4)]);_0x2b4c4b[_0x3ccb0a(0x20f)]&&(_0x245510[_0x3ccb0a(0x1fd)]=JSON[_0x3ccb0a(0x20c)](_0x2b4c4b['gateways']),delete _0x245510[_0x3ccb0a(0x20f)]);_0x2b4c4b[_0x3ccb0a(0x1eb)]&&(_0x245510[_0x3ccb0a(0x1eb)]=JSON['stringify'](_0x2b4c4b['gatewaySettings']),delete _0x245510[_0x3ccb0a(0x1eb)]);_0x2b4c4b[_0x3ccb0a(0x1fe)]&&(_0x2b4c4b[_0x3ccb0a(0x1fe)][_0x3ccb0a(0x210)]!==undefined&&(_0x245510['usdtPolygonWallet']=_0x2b4c4b['wallets'][_0x3ccb0a(0x210)]||null),_0x2b4c4b[_0x3ccb0a(0x1fe)][_0x3ccb0a(0x1d8)]!==undefined&&(_0x245510[_0x3ccb0a(0x1d8)]=_0x2b4c4b['wallets']['usdtTrcWallet']||null),_0x2b4c4b['wallets'][_0x3ccb0a(0x1f2)]!==undefined&&(_0x245510['usdtErcWallet']=_0x2b4c4b[_0x3ccb0a(0x1fe)][_0x3ccb0a(0x1f2)]||null),_0x2b4c4b['wallets'][_0x3ccb0a(0x1f8)]!==undefined&&(_0x245510[_0x3ccb0a(0x1f8)]=_0x2b4c4b[_0x3ccb0a(0x1fe)][_0x3ccb0a(0x1f8)]||null),delete _0x245510['wallets']);const _0x27a836=await database_1['default']['shop'][_0x3ccb0a(0x207)]({'where':{'id':_0x4e7865},'data':_0x245510,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x27a836['id'],'fullName':_0x27a836[_0x3ccb0a(0x208)],'username':_0x27a836['username'],'telegramId':_0x27a836['telegram'],'merchantUrl':_0x27a836[_0x3ccb0a(0x1e1)],'gateways':_0x27a836[_0x3ccb0a(0x1fd)]?JSON[_0x3ccb0a(0x1dd)](_0x27a836[_0x3ccb0a(0x1fd)]):null,'gatewaySettings':_0x27a836[_0x3ccb0a(0x1eb)]?JSON[_0x3ccb0a(0x1dd)](_0x27a836[_0x3ccb0a(0x1eb)]):null,'publicKey':_0x27a836['publicKey'],'wallets':{'usdtPolygonWallet':_0x27a836[_0x3ccb0a(0x210)],'usdtTrcWallet':_0x27a836[_0x3ccb0a(0x1d8)],'usdtErcWallet':_0x27a836['usdtErcWallet'],'usdcPolygonWallet':_0x27a836[_0x3ccb0a(0x1f8)]},'status':_0x27a836['status'],'createdAt':_0x27a836[_0x3ccb0a(0x1f4)]};}async[a56_0x38dcce(0x204)](_0x274a2a){const _0x25611f=a56_0x38dcce;await database_1[_0x25611f(0x1fa)][_0x25611f(0x1f6)][_0x25611f(0x1f9)]({'where':{'id':_0x274a2a}});}}function a56_0x4ae9(){const _0x3d70c2=['password','2nDadhV','merchantUrl','ACTIVE','map','randomBytes','hex','createUser','pk_','gatewaySettings','452763xGHXif','1211hgNbkM','hash','telegram','username','Telegram\x20username\x20already\x20exists','usdtErcWallet','Username\x20already\x20exists','createdAt','__esModule','shop','UserService','usdcPolygonWallet','delete','default','25jvIZDG','defineProperty','paymentGateways','wallets','848399HQdHvS','publicKey','fullName','updateUser','8rCvcBf','deleteUser','getAllUsers','sk_','update','name','2168UfOCZZ','getUserById','generateApiKeys','stringify','4438030zIkySE','create','gateways','usdtPolygonWallet','findMany','usdtTrcWallet','status','findUnique','9171765WVySlh','14386196CRWUMB','parse','1101930VjpeZq','telegramId','toString','shopUrl'];a56_0x4ae9=function(){return _0x3d70c2;};return a56_0x4ae9();}exports[a56_0x38dcce(0x1f7)]=UserService;