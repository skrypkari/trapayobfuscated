'use strict';function a56_0x2846(_0x43fd6e,_0x5856c5){const _0x2505fa=a56_0x2505();return a56_0x2846=function(_0x284601,_0x3ce43e){_0x284601=_0x284601-0x145;let _0x3f15d2=_0x2505fa[_0x284601];return _0x3f15d2;},a56_0x2846(_0x43fd6e,_0x5856c5);}const a56_0x542520=a56_0x2846;(function(_0x33dbe0,_0x3bb7c2){const _0x5e4d19=a56_0x2846,_0x3abac8=_0x33dbe0();while(!![]){try{const _0x57f7d2=parseInt(_0x5e4d19(0x161))/0x1+parseInt(_0x5e4d19(0x16b))/0x2+parseInt(_0x5e4d19(0x15e))/0x3*(parseInt(_0x5e4d19(0x15b))/0x4)+-parseInt(_0x5e4d19(0x159))/0x5*(-parseInt(_0x5e4d19(0x157))/0x6)+-parseInt(_0x5e4d19(0x158))/0x7+-parseInt(_0x5e4d19(0x149))/0x8+-parseInt(_0x5e4d19(0x155))/0x9;if(_0x57f7d2===_0x3bb7c2)break;else _0x3abac8['push'](_0x3abac8['shift']());}catch(_0x52e85b){_0x3abac8['push'](_0x3abac8['shift']());}}}(a56_0x2505,0x50846));var __importDefault=this&&this[a56_0x542520(0x164)]||function(_0x1d53fd){const _0x43c827=a56_0x542520;return _0x1d53fd&&_0x1d53fd[_0x43c827(0x14a)]?_0x1d53fd:{'default':_0x1d53fd};};Object[a56_0x542520(0x179)](exports,a56_0x542520(0x14a),{'value':!![]}),exports['UserService']=void 0x0;function a56_0x2505(){const _0x1cf3ad=['Telegram\x20username\x20already\x20exists','usdtErcWallet','gateways','updateUser','usdtPolygonWallet','2783664uiUdxh','__esModule','wallets','crypto','UserService','stringify','randomBytes','findUnique','username','getUserById','status','toString','4365270tntSsm','getAllUsers','6WiXqAo','3262616ryJtoc','3212295IFWrAE','map','3324yZtgGG','publicKey','name','1461uVlBcE','parse','generateApiKeys','265183CTsvHo','gatewaySettings','create','__importDefault','createdAt','pk_','default','paymentGateways','desc','shopUrl','633070EnNqUe','delete','merchantUrl','usdcPolygonWallet','bcryptjs','shop','hash','Username\x20already\x20exists','../config/database','update','telegramId','usdtTrcWallet','deleteUser','fullName','defineProperty','createUser','telegram','hex','password'];a56_0x2505=function(){return _0x1cf3ad;};return a56_0x2505();}const bcryptjs_1=__importDefault(require(a56_0x542520(0x16f))),crypto_1=__importDefault(require(a56_0x542520(0x14c))),database_1=__importDefault(require(a56_0x542520(0x173)));class UserService{[a56_0x542520(0x160)](){const _0x3a9c53=a56_0x542520,_0x13867a=_0x3a9c53(0x166)+crypto_1[_0x3a9c53(0x167)][_0x3a9c53(0x14f)](0x20)[_0x3a9c53(0x154)](_0x3a9c53(0x17c)),_0x1e1f97='sk_'+crypto_1[_0x3a9c53(0x167)][_0x3a9c53(0x14f)](0x20)[_0x3a9c53(0x154)](_0x3a9c53(0x17c));return{'publicKey':_0x13867a,'secretKey':_0x1e1f97};}async[a56_0x542520(0x17a)](_0xd671b2){const _0x14cbeb=a56_0x542520,{fullName:_0x5a7f27,username:_0x46fefa,password:_0xdd0975,telegramId:_0x5a0dd1,merchantUrl:_0x136fbc,gateways:_0xbc4207,gatewaySettings:_0x23fe6a,wallets:_0x5b6f5a}=_0xd671b2,_0x421358=await database_1[_0x14cbeb(0x167)][_0x14cbeb(0x170)]['findUnique']({'where':{'username':_0x46fefa}});if(_0x421358)throw new Error(_0x14cbeb(0x172));if(_0x5a0dd1){const _0x5388a3=await database_1[_0x14cbeb(0x167)][_0x14cbeb(0x170)]['findUnique']({'where':{'telegram':_0x5a0dd1}});if(_0x5388a3)throw new Error(_0x14cbeb(0x17e));}const _0x22fcc1=await bcryptjs_1['default'][_0x14cbeb(0x171)](_0xdd0975,0xc),{publicKey:_0x1b5101,secretKey:_0x29d8ac}=this['generateApiKeys'](),_0x3a8932=await database_1[_0x14cbeb(0x167)][_0x14cbeb(0x170)][_0x14cbeb(0x163)]({'data':{'name':_0x5a7f27,'username':_0x46fefa,'password':_0x22fcc1,'telegram':_0x5a0dd1,'shopUrl':_0x136fbc,'paymentGateways':_0xbc4207?JSON['stringify'](_0xbc4207):null,'gatewaySettings':_0x23fe6a?JSON['stringify'](_0x23fe6a):null,'usdtPolygonWallet':_0x5b6f5a?.[_0x14cbeb(0x148)]||null,'usdtTrcWallet':_0x5b6f5a?.[_0x14cbeb(0x176)]||null,'usdtErcWallet':_0x5b6f5a?.[_0x14cbeb(0x145)]||null,'usdcPolygonWallet':_0x5b6f5a?.[_0x14cbeb(0x16e)]||null,'publicKey':_0x1b5101,'secretKey':_0x29d8ac,'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x3a8932['id'],'fullName':_0x3a8932[_0x14cbeb(0x15d)],'username':_0x3a8932['username'],'telegramId':_0x3a8932['telegram'],'merchantUrl':_0x3a8932['shopUrl'],'gateways':_0x3a8932['paymentGateways']?JSON[_0x14cbeb(0x15f)](_0x3a8932['paymentGateways']):null,'gatewaySettings':_0x3a8932['gatewaySettings']?JSON[_0x14cbeb(0x15f)](_0x3a8932[_0x14cbeb(0x162)]):null,'publicKey':_0x3a8932[_0x14cbeb(0x15c)],'wallets':{'usdtPolygonWallet':_0x3a8932[_0x14cbeb(0x148)],'usdtTrcWallet':_0x3a8932['usdtTrcWallet'],'usdtErcWallet':_0x3a8932[_0x14cbeb(0x145)],'usdcPolygonWallet':_0x3a8932[_0x14cbeb(0x16e)]},'status':_0x3a8932[_0x14cbeb(0x153)],'createdAt':_0x3a8932[_0x14cbeb(0x165)]};}async[a56_0x542520(0x156)](){const _0x1abbd3=a56_0x542520,_0x4c74cf=await database_1[_0x1abbd3(0x167)][_0x1abbd3(0x170)]['findMany']({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x1abbd3(0x169)}});return _0x4c74cf[_0x1abbd3(0x15a)](_0x3bef3b=>({'id':_0x3bef3b['id'],'fullName':_0x3bef3b[_0x1abbd3(0x15d)],'username':_0x3bef3b[_0x1abbd3(0x151)],'telegramId':_0x3bef3b['telegram'],'merchantUrl':_0x3bef3b[_0x1abbd3(0x16a)],'gateways':_0x3bef3b['paymentGateways']?JSON[_0x1abbd3(0x15f)](_0x3bef3b[_0x1abbd3(0x168)]):null,'gatewaySettings':_0x3bef3b[_0x1abbd3(0x162)]?JSON[_0x1abbd3(0x15f)](_0x3bef3b[_0x1abbd3(0x162)]):null,'publicKey':_0x3bef3b[_0x1abbd3(0x15c)],'wallets':{'usdtPolygonWallet':_0x3bef3b[_0x1abbd3(0x148)],'usdtTrcWallet':_0x3bef3b['usdtTrcWallet'],'usdtErcWallet':_0x3bef3b[_0x1abbd3(0x145)],'usdcPolygonWallet':_0x3bef3b[_0x1abbd3(0x16e)]},'status':_0x3bef3b['status'],'createdAt':_0x3bef3b[_0x1abbd3(0x165)]}));}async[a56_0x542520(0x152)](_0x7fae98){const _0x13202c=a56_0x542520,_0x46b233=await database_1[_0x13202c(0x167)][_0x13202c(0x170)][_0x13202c(0x150)]({'where':{'id':_0x7fae98},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x46b233)return null;return{'id':_0x46b233['id'],'fullName':_0x46b233[_0x13202c(0x15d)],'username':_0x46b233['username'],'telegramId':_0x46b233[_0x13202c(0x17b)],'merchantUrl':_0x46b233[_0x13202c(0x16a)],'gateways':_0x46b233[_0x13202c(0x168)]?JSON[_0x13202c(0x15f)](_0x46b233[_0x13202c(0x168)]):null,'gatewaySettings':_0x46b233[_0x13202c(0x162)]?JSON[_0x13202c(0x15f)](_0x46b233[_0x13202c(0x162)]):null,'publicKey':_0x46b233[_0x13202c(0x15c)],'wallets':{'usdtPolygonWallet':_0x46b233['usdtPolygonWallet'],'usdtTrcWallet':_0x46b233[_0x13202c(0x176)],'usdtErcWallet':_0x46b233[_0x13202c(0x145)],'usdcPolygonWallet':_0x46b233[_0x13202c(0x16e)]},'status':_0x46b233[_0x13202c(0x153)],'createdAt':_0x46b233[_0x13202c(0x165)]};}async[a56_0x542520(0x147)](_0x3b7925,_0x5793c9){const _0xb15295=a56_0x542520,_0x5e0034={..._0x5793c9};_0x5793c9[_0xb15295(0x17d)]&&(_0x5e0034[_0xb15295(0x17d)]=await bcryptjs_1['default'][_0xb15295(0x171)](_0x5793c9[_0xb15295(0x17d)],0xc));_0x5793c9[_0xb15295(0x178)]&&(_0x5e0034[_0xb15295(0x15d)]=_0x5793c9[_0xb15295(0x178)],delete _0x5e0034[_0xb15295(0x178)]);_0x5793c9[_0xb15295(0x175)]&&(_0x5e0034[_0xb15295(0x17b)]=_0x5793c9[_0xb15295(0x175)],delete _0x5e0034[_0xb15295(0x175)]);_0x5793c9[_0xb15295(0x16d)]&&(_0x5e0034['shopUrl']=_0x5793c9[_0xb15295(0x16d)],delete _0x5e0034[_0xb15295(0x16d)]);_0x5793c9[_0xb15295(0x146)]&&(_0x5e0034[_0xb15295(0x168)]=JSON[_0xb15295(0x14e)](_0x5793c9[_0xb15295(0x146)]),delete _0x5e0034[_0xb15295(0x146)]);_0x5793c9[_0xb15295(0x162)]&&(_0x5e0034[_0xb15295(0x162)]=JSON['stringify'](_0x5793c9[_0xb15295(0x162)]),delete _0x5e0034[_0xb15295(0x162)]);_0x5793c9[_0xb15295(0x14b)]&&(_0x5793c9[_0xb15295(0x14b)]['usdtPolygonWallet']!==undefined&&(_0x5e0034[_0xb15295(0x148)]=_0x5793c9['wallets'][_0xb15295(0x148)]||null),_0x5793c9['wallets'][_0xb15295(0x176)]!==undefined&&(_0x5e0034[_0xb15295(0x176)]=_0x5793c9['wallets'][_0xb15295(0x176)]||null),_0x5793c9[_0xb15295(0x14b)]['usdtErcWallet']!==undefined&&(_0x5e0034[_0xb15295(0x145)]=_0x5793c9[_0xb15295(0x14b)]['usdtErcWallet']||null),_0x5793c9[_0xb15295(0x14b)][_0xb15295(0x16e)]!==undefined&&(_0x5e0034[_0xb15295(0x16e)]=_0x5793c9[_0xb15295(0x14b)][_0xb15295(0x16e)]||null),delete _0x5e0034[_0xb15295(0x14b)]);const _0x27fd3c=await database_1['default'][_0xb15295(0x170)][_0xb15295(0x174)]({'where':{'id':_0x3b7925},'data':_0x5e0034,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x27fd3c['id'],'fullName':_0x27fd3c['name'],'username':_0x27fd3c[_0xb15295(0x151)],'telegramId':_0x27fd3c[_0xb15295(0x17b)],'merchantUrl':_0x27fd3c[_0xb15295(0x16a)],'gateways':_0x27fd3c[_0xb15295(0x168)]?JSON[_0xb15295(0x15f)](_0x27fd3c[_0xb15295(0x168)]):null,'gatewaySettings':_0x27fd3c['gatewaySettings']?JSON[_0xb15295(0x15f)](_0x27fd3c[_0xb15295(0x162)]):null,'publicKey':_0x27fd3c[_0xb15295(0x15c)],'wallets':{'usdtPolygonWallet':_0x27fd3c[_0xb15295(0x148)],'usdtTrcWallet':_0x27fd3c[_0xb15295(0x176)],'usdtErcWallet':_0x27fd3c[_0xb15295(0x145)],'usdcPolygonWallet':_0x27fd3c['usdcPolygonWallet']},'status':_0x27fd3c[_0xb15295(0x153)],'createdAt':_0x27fd3c[_0xb15295(0x165)]};}async[a56_0x542520(0x177)](_0x48db4e){const _0x5de6dd=a56_0x542520;await database_1[_0x5de6dd(0x167)]['shop'][_0x5de6dd(0x16c)]({'where':{'id':_0x48db4e}});}}exports[a56_0x542520(0x14d)]=UserService;