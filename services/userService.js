'use strict';function a56_0x2235(_0x36c9bb,_0x574800){const _0x20eab7=a56_0x20ea();return a56_0x2235=function(_0x22357b,_0x369f44){_0x22357b=_0x22357b-0x1cf;let _0x441fcf=_0x20eab7[_0x22357b];return _0x441fcf;},a56_0x2235(_0x36c9bb,_0x574800);}const a56_0x505f60=a56_0x2235;function a56_0x20ea(){const _0x296bb9=['getUserById','1337231BAesph','username','17748RPBpLv','Username\x20already\x20exists','merchantUrl','shopUrl','624885CnJhVH','create','createUser','default','bcryptjs','shop','generateApiKeys','gatewaySettings','findUnique','usdtPolygonWallet','8aPDxBE','deleteUser','gateways','crypto','__esModule','updateUser','usdtTrcWallet','stringify','findMany','createdAt','usdcPolygonWallet','4UfGlfS','__importDefault','defineProperty','password','802665weGrUf','usdtErcWallet','parse','Telegram\x20username\x20already\x20exists','558aGPABK','fullName','paymentGateways','toString','UserService','605IFMqKg','90BLHcux','2305GSLxFh','sk_','hash','../config/database','wallets','status','desc','publicKey','telegram','telegramId','193098RVztti','3535698flhhun','name','hex'];a56_0x20ea=function(){return _0x296bb9;};return a56_0x20ea();}(function(_0x3f6755,_0x147861){const _0x48edc8=a56_0x2235,_0x578b22=_0x3f6755();while(!![]){try{const _0x244065=-parseInt(_0x48edc8(0x1f5))/0x1*(-parseInt(_0x48edc8(0x1ee))/0x2)+parseInt(_0x48edc8(0x1ff))/0x3+-parseInt(_0x48edc8(0x1e6))/0x4*(parseInt(_0x48edc8(0x1d1))/0x5)+parseInt(_0x48edc8(0x200))/0x6+-parseInt(_0x48edc8(0x204))/0x7*(-parseInt(_0x48edc8(0x1db))/0x8)+parseInt(_0x48edc8(0x1ea))/0x9*(-parseInt(_0x48edc8(0x1f4))/0xa)+parseInt(_0x48edc8(0x1f3))/0xb*(-parseInt(_0x48edc8(0x206))/0xc);if(_0x244065===_0x147861)break;else _0x578b22['push'](_0x578b22['shift']());}catch(_0x858c5e){_0x578b22['push'](_0x578b22['shift']());}}}(a56_0x20ea,0x74e46));var __importDefault=this&&this[a56_0x505f60(0x1e7)]||function(_0x2b52f6){return _0x2b52f6&&_0x2b52f6['__esModule']?_0x2b52f6:{'default':_0x2b52f6};};Object[a56_0x505f60(0x1e8)](exports,a56_0x505f60(0x1df),{'value':!![]}),exports[a56_0x505f60(0x1f2)]=void 0x0;const bcryptjs_1=__importDefault(require(a56_0x505f60(0x1d5))),crypto_1=__importDefault(require(a56_0x505f60(0x1de))),database_1=__importDefault(require(a56_0x505f60(0x1f8)));class UserService{['generateApiKeys'](){const _0xa3c6a6=a56_0x505f60,_0xaf278e='pk_'+crypto_1[_0xa3c6a6(0x1d4)]['randomBytes'](0x20)[_0xa3c6a6(0x1f1)](_0xa3c6a6(0x202)),_0x5587c9=_0xa3c6a6(0x1f6)+crypto_1[_0xa3c6a6(0x1d4)]['randomBytes'](0x20)[_0xa3c6a6(0x1f1)](_0xa3c6a6(0x202));return{'publicKey':_0xaf278e,'secretKey':_0x5587c9};}async[a56_0x505f60(0x1d3)](_0x3d1052){const _0x32bba2=a56_0x505f60,{fullName:_0x4978bd,username:_0x420c84,password:_0x40645b,telegramId:_0x3844b1,merchantUrl:_0xa48afd,gateways:_0x293455,gatewaySettings:_0x225c3d,wallets:_0x5bb2f9}=_0x3d1052,_0x375153=await database_1[_0x32bba2(0x1d4)]['shop']['findUnique']({'where':{'username':_0x420c84}});if(_0x375153)throw new Error(_0x32bba2(0x207));if(_0x3844b1){const _0x180f7d=await database_1[_0x32bba2(0x1d4)]['shop'][_0x32bba2(0x1d9)]({'where':{'telegram':_0x3844b1}});if(_0x180f7d)throw new Error(_0x32bba2(0x1ed));}const _0x154cc8=await bcryptjs_1['default']['hash'](_0x40645b,0xc),{publicKey:_0x61d3b0,secretKey:_0x3dea53}=this[_0x32bba2(0x1d7)](),_0x16f7d5=await database_1['default']['shop'][_0x32bba2(0x1d2)]({'data':{'name':_0x4978bd,'username':_0x420c84,'password':_0x154cc8,'telegram':_0x3844b1,'shopUrl':_0xa48afd,'paymentGateways':_0x293455?JSON['stringify'](_0x293455):null,'gatewaySettings':_0x225c3d?JSON['stringify'](_0x225c3d):null,'usdtPolygonWallet':_0x5bb2f9?.[_0x32bba2(0x1da)]||null,'usdtTrcWallet':_0x5bb2f9?.[_0x32bba2(0x1e1)]||null,'usdtErcWallet':_0x5bb2f9?.[_0x32bba2(0x1eb)]||null,'usdcPolygonWallet':_0x5bb2f9?.[_0x32bba2(0x1e5)]||null,'publicKey':_0x61d3b0,'secretKey':_0x3dea53,'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x16f7d5['id'],'fullName':_0x16f7d5[_0x32bba2(0x201)],'username':_0x16f7d5[_0x32bba2(0x205)],'telegramId':_0x16f7d5['telegram'],'merchantUrl':_0x16f7d5[_0x32bba2(0x1d0)],'gateways':_0x16f7d5[_0x32bba2(0x1f0)]?JSON[_0x32bba2(0x1ec)](_0x16f7d5[_0x32bba2(0x1f0)]):null,'gatewaySettings':_0x16f7d5[_0x32bba2(0x1d8)]?JSON['parse'](_0x16f7d5[_0x32bba2(0x1d8)]):null,'publicKey':_0x16f7d5[_0x32bba2(0x1fc)],'wallets':{'usdtPolygonWallet':_0x16f7d5[_0x32bba2(0x1da)],'usdtTrcWallet':_0x16f7d5[_0x32bba2(0x1e1)],'usdtErcWallet':_0x16f7d5[_0x32bba2(0x1eb)],'usdcPolygonWallet':_0x16f7d5[_0x32bba2(0x1e5)]},'status':_0x16f7d5[_0x32bba2(0x1fa)],'createdAt':_0x16f7d5[_0x32bba2(0x1e4)]};}async['getAllUsers'](){const _0x3bdb8c=a56_0x505f60,_0x580a52=await database_1[_0x3bdb8c(0x1d4)][_0x3bdb8c(0x1d6)][_0x3bdb8c(0x1e3)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x3bdb8c(0x1fb)}});return _0x580a52['map'](_0x2a0b8c=>({'id':_0x2a0b8c['id'],'fullName':_0x2a0b8c['name'],'username':_0x2a0b8c[_0x3bdb8c(0x205)],'telegramId':_0x2a0b8c[_0x3bdb8c(0x1fd)],'merchantUrl':_0x2a0b8c[_0x3bdb8c(0x1d0)],'gateways':_0x2a0b8c[_0x3bdb8c(0x1f0)]?JSON[_0x3bdb8c(0x1ec)](_0x2a0b8c[_0x3bdb8c(0x1f0)]):null,'gatewaySettings':_0x2a0b8c['gatewaySettings']?JSON['parse'](_0x2a0b8c[_0x3bdb8c(0x1d8)]):null,'publicKey':_0x2a0b8c[_0x3bdb8c(0x1fc)],'wallets':{'usdtPolygonWallet':_0x2a0b8c[_0x3bdb8c(0x1da)],'usdtTrcWallet':_0x2a0b8c[_0x3bdb8c(0x1e1)],'usdtErcWallet':_0x2a0b8c[_0x3bdb8c(0x1eb)],'usdcPolygonWallet':_0x2a0b8c[_0x3bdb8c(0x1e5)]},'status':_0x2a0b8c[_0x3bdb8c(0x1fa)],'createdAt':_0x2a0b8c['createdAt']}));}async[a56_0x505f60(0x203)](_0x3c15ac){const _0x230117=a56_0x505f60,_0x4a9ed0=await database_1[_0x230117(0x1d4)]['shop'][_0x230117(0x1d9)]({'where':{'id':_0x3c15ac},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x4a9ed0)return null;return{'id':_0x4a9ed0['id'],'fullName':_0x4a9ed0[_0x230117(0x201)],'username':_0x4a9ed0[_0x230117(0x205)],'telegramId':_0x4a9ed0[_0x230117(0x1fd)],'merchantUrl':_0x4a9ed0[_0x230117(0x1d0)],'gateways':_0x4a9ed0[_0x230117(0x1f0)]?JSON[_0x230117(0x1ec)](_0x4a9ed0[_0x230117(0x1f0)]):null,'gatewaySettings':_0x4a9ed0[_0x230117(0x1d8)]?JSON[_0x230117(0x1ec)](_0x4a9ed0[_0x230117(0x1d8)]):null,'publicKey':_0x4a9ed0[_0x230117(0x1fc)],'wallets':{'usdtPolygonWallet':_0x4a9ed0[_0x230117(0x1da)],'usdtTrcWallet':_0x4a9ed0[_0x230117(0x1e1)],'usdtErcWallet':_0x4a9ed0[_0x230117(0x1eb)],'usdcPolygonWallet':_0x4a9ed0[_0x230117(0x1e5)]},'status':_0x4a9ed0[_0x230117(0x1fa)],'createdAt':_0x4a9ed0[_0x230117(0x1e4)]};}async[a56_0x505f60(0x1e0)](_0x2ce8e7,_0x38ca1c){const _0x5452b8=a56_0x505f60,_0x30fa14={..._0x38ca1c};_0x38ca1c[_0x5452b8(0x1e9)]&&(_0x30fa14[_0x5452b8(0x1e9)]=await bcryptjs_1[_0x5452b8(0x1d4)][_0x5452b8(0x1f7)](_0x38ca1c['password'],0xc));_0x38ca1c[_0x5452b8(0x1ef)]&&(_0x30fa14[_0x5452b8(0x201)]=_0x38ca1c[_0x5452b8(0x1ef)],delete _0x30fa14['fullName']);_0x38ca1c[_0x5452b8(0x1fe)]&&(_0x30fa14['telegram']=_0x38ca1c[_0x5452b8(0x1fe)],delete _0x30fa14['telegramId']);_0x38ca1c[_0x5452b8(0x1cf)]&&(_0x30fa14[_0x5452b8(0x1d0)]=_0x38ca1c[_0x5452b8(0x1cf)],delete _0x30fa14['merchantUrl']);_0x38ca1c[_0x5452b8(0x1dd)]&&(_0x30fa14[_0x5452b8(0x1f0)]=JSON[_0x5452b8(0x1e2)](_0x38ca1c[_0x5452b8(0x1dd)]),delete _0x30fa14[_0x5452b8(0x1dd)]);_0x38ca1c[_0x5452b8(0x1d8)]&&(_0x30fa14['gatewaySettings']=JSON[_0x5452b8(0x1e2)](_0x38ca1c['gatewaySettings']),delete _0x30fa14[_0x5452b8(0x1d8)]);_0x38ca1c[_0x5452b8(0x1f9)]&&(_0x38ca1c['wallets'][_0x5452b8(0x1da)]!==undefined&&(_0x30fa14['usdtPolygonWallet']=_0x38ca1c[_0x5452b8(0x1f9)][_0x5452b8(0x1da)]||null),_0x38ca1c[_0x5452b8(0x1f9)][_0x5452b8(0x1e1)]!==undefined&&(_0x30fa14[_0x5452b8(0x1e1)]=_0x38ca1c['wallets'][_0x5452b8(0x1e1)]||null),_0x38ca1c[_0x5452b8(0x1f9)][_0x5452b8(0x1eb)]!==undefined&&(_0x30fa14[_0x5452b8(0x1eb)]=_0x38ca1c[_0x5452b8(0x1f9)][_0x5452b8(0x1eb)]||null),_0x38ca1c[_0x5452b8(0x1f9)][_0x5452b8(0x1e5)]!==undefined&&(_0x30fa14[_0x5452b8(0x1e5)]=_0x38ca1c[_0x5452b8(0x1f9)]['usdcPolygonWallet']||null),delete _0x30fa14[_0x5452b8(0x1f9)]);const _0x271de6=await database_1[_0x5452b8(0x1d4)][_0x5452b8(0x1d6)]['update']({'where':{'id':_0x2ce8e7},'data':_0x30fa14,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x271de6['id'],'fullName':_0x271de6[_0x5452b8(0x201)],'username':_0x271de6['username'],'telegramId':_0x271de6[_0x5452b8(0x1fd)],'merchantUrl':_0x271de6[_0x5452b8(0x1d0)],'gateways':_0x271de6[_0x5452b8(0x1f0)]?JSON['parse'](_0x271de6[_0x5452b8(0x1f0)]):null,'gatewaySettings':_0x271de6[_0x5452b8(0x1d8)]?JSON['parse'](_0x271de6['gatewaySettings']):null,'publicKey':_0x271de6[_0x5452b8(0x1fc)],'wallets':{'usdtPolygonWallet':_0x271de6['usdtPolygonWallet'],'usdtTrcWallet':_0x271de6[_0x5452b8(0x1e1)],'usdtErcWallet':_0x271de6[_0x5452b8(0x1eb)],'usdcPolygonWallet':_0x271de6['usdcPolygonWallet']},'status':_0x271de6[_0x5452b8(0x1fa)],'createdAt':_0x271de6['createdAt']};}async[a56_0x505f60(0x1dc)](_0x197ed6){const _0x55a6c3=a56_0x505f60;await database_1['default'][_0x55a6c3(0x1d6)]['delete']({'where':{'id':_0x197ed6}});}}exports[a56_0x505f60(0x1f2)]=UserService;