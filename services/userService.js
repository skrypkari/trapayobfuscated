'use strict';const a54_0x298367=a54_0x1bca;function a54_0x1bca(_0x202165,_0x5adef7){const _0x3e0a2a=a54_0x3e0a();return a54_0x1bca=function(_0x1bcaf4,_0x1d3b98){_0x1bcaf4=_0x1bcaf4-0x112;let _0x231ecb=_0x3e0a2a[_0x1bcaf4];return _0x231ecb;},a54_0x1bca(_0x202165,_0x5adef7);}function a54_0x3e0a(){const _0x4be920=['2854131YQQQAm','merchantUrl','usdtPolygonWallet','telegramId','6448025eQeVbB','paymentGateways','12133290NByKqp','stringify','telegram','getAllUsers','gateways','shop','54XTQLvG','Username\x20already\x20exists','pk_','776328Atklmk','randomBytes','status','shopUrl','hex','usdcPolygonWallet','createdAt','bcryptjs','publicKey','8950907EMSoYK','delete','desc','defineProperty','gatewaySettings','../config/database','parse','createUser','create','default','name','getUserById','6SQEQdN','toString','43559516LMavpt','usdtTrcWallet','hash','usdtErcWallet','Telegram\x20username\x20already\x20exists','4UcZPLL','findUnique','crypto','UserService','password','__importDefault','2oqQkMf','__esModule','785830dkrpuB','fullName','generateApiKeys','wallets','username'];a54_0x3e0a=function(){return _0x4be920;};return a54_0x3e0a();}(function(_0xd81b91,_0x5c9330){const _0x58db21=a54_0x1bca,_0xecbfc0=_0xd81b91();while(!![]){try{const _0x255c99=-parseInt(_0x58db21(0x142))/0x1+parseInt(_0x58db21(0x140))/0x2*(parseInt(_0x58db21(0x147))/0x3)+parseInt(_0x58db21(0x13a))/0x4*(-parseInt(_0x58db21(0x113))/0x5)+parseInt(_0x58db21(0x133))/0x6*(-parseInt(_0x58db21(0x127))/0x7)+parseInt(_0x58db21(0x11e))/0x8*(parseInt(_0x58db21(0x11b))/0x9)+-parseInt(_0x58db21(0x115))/0xa+parseInt(_0x58db21(0x135))/0xb;if(_0x255c99===_0x5c9330)break;else _0xecbfc0['push'](_0xecbfc0['shift']());}catch(_0x5008eb){_0xecbfc0['push'](_0xecbfc0['shift']());}}}(a54_0x3e0a,0xe21a2));var __importDefault=this&&this[a54_0x298367(0x13f)]||function(_0xf7554e){return _0xf7554e&&_0xf7554e['__esModule']?_0xf7554e:{'default':_0xf7554e};};Object[a54_0x298367(0x12a)](exports,a54_0x298367(0x141),{'value':!![]}),exports['UserService']=void 0x0;const bcryptjs_1=__importDefault(require(a54_0x298367(0x125))),crypto_1=__importDefault(require(a54_0x298367(0x13c))),database_1=__importDefault(require(a54_0x298367(0x12c)));class UserService{[a54_0x298367(0x144)](){const _0x27a107=a54_0x298367,_0x5a017e=_0x27a107(0x11d)+crypto_1['default'][_0x27a107(0x11f)](0x20)['toString'](_0x27a107(0x122)),_0x28be29='sk_'+crypto_1[_0x27a107(0x130)][_0x27a107(0x11f)](0x20)[_0x27a107(0x134)](_0x27a107(0x122));return{'publicKey':_0x5a017e,'secretKey':_0x28be29};}async[a54_0x298367(0x12e)](_0x323541){const _0x43b0f7=a54_0x298367,{fullName:_0x155f53,username:_0x218ce3,password:_0xcde675,telegramId:_0x38bb5f,merchantUrl:_0x2e458c,gateways:_0x49f042,gatewaySettings:_0xa08097,wallets:_0xf156b4}=_0x323541,_0x4673b0=await database_1[_0x43b0f7(0x130)]['shop'][_0x43b0f7(0x13b)]({'where':{'username':_0x218ce3}});if(_0x4673b0)throw new Error(_0x43b0f7(0x11c));if(_0x38bb5f){const _0x3f4d92=await database_1[_0x43b0f7(0x130)][_0x43b0f7(0x11a)][_0x43b0f7(0x13b)]({'where':{'telegram':_0x38bb5f}});if(_0x3f4d92)throw new Error(_0x43b0f7(0x139));}const _0x3838c5=await bcryptjs_1[_0x43b0f7(0x130)][_0x43b0f7(0x137)](_0xcde675,0xc),{publicKey:_0xf8cbd1,secretKey:_0x46240c}=this[_0x43b0f7(0x144)](),_0x3c04fe=await database_1['default']['shop'][_0x43b0f7(0x12f)]({'data':{'name':_0x155f53,'username':_0x218ce3,'password':_0x3838c5,'telegram':_0x38bb5f,'shopUrl':_0x2e458c,'paymentGateways':_0x49f042?JSON[_0x43b0f7(0x116)](_0x49f042):null,'gatewaySettings':_0xa08097?JSON[_0x43b0f7(0x116)](_0xa08097):null,'usdtPolygonWallet':_0xf156b4?.[_0x43b0f7(0x149)]||null,'usdtTrcWallet':_0xf156b4?.[_0x43b0f7(0x136)]||null,'usdtErcWallet':_0xf156b4?.[_0x43b0f7(0x138)]||null,'usdcPolygonWallet':_0xf156b4?.[_0x43b0f7(0x123)]||null,'publicKey':_0xf8cbd1,'secretKey':_0x46240c,'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x3c04fe['id'],'fullName':_0x3c04fe[_0x43b0f7(0x131)],'username':_0x3c04fe['username'],'telegramId':_0x3c04fe['telegram'],'merchantUrl':_0x3c04fe[_0x43b0f7(0x121)],'gateways':_0x3c04fe[_0x43b0f7(0x114)]?JSON[_0x43b0f7(0x12d)](_0x3c04fe[_0x43b0f7(0x114)]):null,'gatewaySettings':_0x3c04fe[_0x43b0f7(0x12b)]?JSON['parse'](_0x3c04fe[_0x43b0f7(0x12b)]):null,'publicKey':_0x3c04fe[_0x43b0f7(0x126)],'wallets':{'usdtPolygonWallet':_0x3c04fe[_0x43b0f7(0x149)],'usdtTrcWallet':_0x3c04fe[_0x43b0f7(0x136)],'usdtErcWallet':_0x3c04fe['usdtErcWallet'],'usdcPolygonWallet':_0x3c04fe['usdcPolygonWallet']},'status':_0x3c04fe[_0x43b0f7(0x120)],'createdAt':_0x3c04fe['createdAt']};}async[a54_0x298367(0x118)](){const _0x371982=a54_0x298367,_0x42bfac=await database_1[_0x371982(0x130)][_0x371982(0x11a)]['findMany']({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x371982(0x129)}});return _0x42bfac['map'](_0x500785=>({'id':_0x500785['id'],'fullName':_0x500785[_0x371982(0x131)],'username':_0x500785[_0x371982(0x146)],'telegramId':_0x500785[_0x371982(0x117)],'merchantUrl':_0x500785[_0x371982(0x121)],'gateways':_0x500785['paymentGateways']?JSON['parse'](_0x500785[_0x371982(0x114)]):null,'gatewaySettings':_0x500785[_0x371982(0x12b)]?JSON['parse'](_0x500785[_0x371982(0x12b)]):null,'publicKey':_0x500785[_0x371982(0x126)],'wallets':{'usdtPolygonWallet':_0x500785[_0x371982(0x149)],'usdtTrcWallet':_0x500785[_0x371982(0x136)],'usdtErcWallet':_0x500785['usdtErcWallet'],'usdcPolygonWallet':_0x500785[_0x371982(0x123)]},'status':_0x500785['status'],'createdAt':_0x500785[_0x371982(0x124)]}));}async[a54_0x298367(0x132)](_0x3efa5e){const _0x408635=a54_0x298367,_0x4fc8ce=await database_1[_0x408635(0x130)][_0x408635(0x11a)][_0x408635(0x13b)]({'where':{'id':_0x3efa5e},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x4fc8ce)return null;return{'id':_0x4fc8ce['id'],'fullName':_0x4fc8ce[_0x408635(0x131)],'username':_0x4fc8ce['username'],'telegramId':_0x4fc8ce[_0x408635(0x117)],'merchantUrl':_0x4fc8ce[_0x408635(0x121)],'gateways':_0x4fc8ce['paymentGateways']?JSON[_0x408635(0x12d)](_0x4fc8ce[_0x408635(0x114)]):null,'gatewaySettings':_0x4fc8ce['gatewaySettings']?JSON[_0x408635(0x12d)](_0x4fc8ce['gatewaySettings']):null,'publicKey':_0x4fc8ce[_0x408635(0x126)],'wallets':{'usdtPolygonWallet':_0x4fc8ce[_0x408635(0x149)],'usdtTrcWallet':_0x4fc8ce[_0x408635(0x136)],'usdtErcWallet':_0x4fc8ce[_0x408635(0x138)],'usdcPolygonWallet':_0x4fc8ce['usdcPolygonWallet']},'status':_0x4fc8ce[_0x408635(0x120)],'createdAt':_0x4fc8ce[_0x408635(0x124)]};}async['updateUser'](_0x129d32,_0x17529d){const _0x4c5ca3=a54_0x298367,_0x261a2a={..._0x17529d};_0x17529d['password']&&(_0x261a2a['password']=await bcryptjs_1[_0x4c5ca3(0x130)][_0x4c5ca3(0x137)](_0x17529d[_0x4c5ca3(0x13e)],0xc));_0x17529d[_0x4c5ca3(0x143)]&&(_0x261a2a[_0x4c5ca3(0x131)]=_0x17529d[_0x4c5ca3(0x143)],delete _0x261a2a[_0x4c5ca3(0x143)]);_0x17529d[_0x4c5ca3(0x112)]&&(_0x261a2a[_0x4c5ca3(0x117)]=_0x17529d[_0x4c5ca3(0x112)],delete _0x261a2a[_0x4c5ca3(0x112)]);_0x17529d[_0x4c5ca3(0x148)]&&(_0x261a2a[_0x4c5ca3(0x121)]=_0x17529d[_0x4c5ca3(0x148)],delete _0x261a2a['merchantUrl']);_0x17529d[_0x4c5ca3(0x119)]&&(_0x261a2a[_0x4c5ca3(0x114)]=JSON[_0x4c5ca3(0x116)](_0x17529d[_0x4c5ca3(0x119)]),delete _0x261a2a[_0x4c5ca3(0x119)]);_0x17529d['gatewaySettings']&&(_0x261a2a[_0x4c5ca3(0x12b)]=JSON[_0x4c5ca3(0x116)](_0x17529d['gatewaySettings']),delete _0x261a2a['gatewaySettings']);_0x17529d[_0x4c5ca3(0x145)]&&(_0x17529d['wallets']['usdtPolygonWallet']!==undefined&&(_0x261a2a['usdtPolygonWallet']=_0x17529d[_0x4c5ca3(0x145)][_0x4c5ca3(0x149)]||null),_0x17529d[_0x4c5ca3(0x145)][_0x4c5ca3(0x136)]!==undefined&&(_0x261a2a['usdtTrcWallet']=_0x17529d[_0x4c5ca3(0x145)]['usdtTrcWallet']||null),_0x17529d[_0x4c5ca3(0x145)][_0x4c5ca3(0x138)]!==undefined&&(_0x261a2a[_0x4c5ca3(0x138)]=_0x17529d[_0x4c5ca3(0x145)]['usdtErcWallet']||null),_0x17529d['wallets'][_0x4c5ca3(0x123)]!==undefined&&(_0x261a2a[_0x4c5ca3(0x123)]=_0x17529d['wallets'][_0x4c5ca3(0x123)]||null),delete _0x261a2a[_0x4c5ca3(0x145)]);const _0x211222=await database_1[_0x4c5ca3(0x130)]['shop']['update']({'where':{'id':_0x129d32},'data':_0x261a2a,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x211222['id'],'fullName':_0x211222[_0x4c5ca3(0x131)],'username':_0x211222[_0x4c5ca3(0x146)],'telegramId':_0x211222['telegram'],'merchantUrl':_0x211222['shopUrl'],'gateways':_0x211222[_0x4c5ca3(0x114)]?JSON['parse'](_0x211222[_0x4c5ca3(0x114)]):null,'gatewaySettings':_0x211222[_0x4c5ca3(0x12b)]?JSON[_0x4c5ca3(0x12d)](_0x211222['gatewaySettings']):null,'publicKey':_0x211222[_0x4c5ca3(0x126)],'wallets':{'usdtPolygonWallet':_0x211222[_0x4c5ca3(0x149)],'usdtTrcWallet':_0x211222[_0x4c5ca3(0x136)],'usdtErcWallet':_0x211222['usdtErcWallet'],'usdcPolygonWallet':_0x211222['usdcPolygonWallet']},'status':_0x211222['status'],'createdAt':_0x211222[_0x4c5ca3(0x124)]};}async['deleteUser'](_0xfde12a){const _0x570ffa=a54_0x298367;await database_1[_0x570ffa(0x130)][_0x570ffa(0x11a)][_0x570ffa(0x128)]({'where':{'id':_0xfde12a}});}}exports[a54_0x298367(0x13d)]=UserService;