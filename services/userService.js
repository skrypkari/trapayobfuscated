'use strict';const a54_0x1d700b=a54_0x5b37;function a54_0x5b37(_0x3e2b81,_0x2406f4){const _0x141d2f=a54_0x141d();return a54_0x5b37=function(_0x5b3784,_0x34fa48){_0x5b3784=_0x5b3784-0x15e;let _0x329297=_0x141d2f[_0x5b3784];return _0x329297;},a54_0x5b37(_0x3e2b81,_0x2406f4);}(function(_0x4b6e2d,_0x4cca0f){const _0x1bacc5=a54_0x5b37,_0x3c79c2=_0x4b6e2d();while(!![]){try{const _0x4bb0e5=-parseInt(_0x1bacc5(0x165))/0x1+parseInt(_0x1bacc5(0x187))/0x2*(parseInt(_0x1bacc5(0x16c))/0x3)+parseInt(_0x1bacc5(0x169))/0x4*(parseInt(_0x1bacc5(0x16d))/0x5)+-parseInt(_0x1bacc5(0x180))/0x6*(parseInt(_0x1bacc5(0x189))/0x7)+-parseInt(_0x1bacc5(0x160))/0x8*(parseInt(_0x1bacc5(0x15f))/0x9)+parseInt(_0x1bacc5(0x185))/0xa+-parseInt(_0x1bacc5(0x190))/0xb*(parseInt(_0x1bacc5(0x191))/0xc);if(_0x4bb0e5===_0x4cca0f)break;else _0x3c79c2['push'](_0x3c79c2['shift']());}catch(_0x5b31af){_0x3c79c2['push'](_0x3c79c2['shift']());}}}(a54_0x141d,0xdd2f4));var __importDefault=this&&this[a54_0x1d700b(0x170)]||function(_0x56ace4){const _0x4b3da9=a54_0x1d700b;return _0x56ace4&&_0x56ace4[_0x4b3da9(0x175)]?_0x56ace4:{'default':_0x56ace4};};Object[a54_0x1d700b(0x18a)](exports,a54_0x1d700b(0x175),{'value':!![]}),exports[a54_0x1d700b(0x172)]=void 0x0;const bcryptjs_1=__importDefault(require(a54_0x1d700b(0x179))),crypto_1=__importDefault(require(a54_0x1d700b(0x18b))),database_1=__importDefault(require(a54_0x1d700b(0x18f)));class UserService{[a54_0x1d700b(0x188)](){const _0x133219=a54_0x1d700b,_0x1f4406='pk_'+crypto_1[_0x133219(0x15e)]['randomBytes'](0x20)[_0x133219(0x16f)]('hex'),_0x4a562f='sk_'+crypto_1[_0x133219(0x15e)][_0x133219(0x178)](0x20)[_0x133219(0x16f)](_0x133219(0x182));return{'publicKey':_0x1f4406,'secretKey':_0x4a562f};}async[a54_0x1d700b(0x18c)](_0x13785f){const _0x21ea20=a54_0x1d700b,{fullName:_0x2b3965,username:_0x24e7d7,password:_0x50849b,telegramId:_0x5eb980,merchantUrl:_0x54aa02,gateways:_0x215bcc,gatewaySettings:_0x54eb02,wallets:_0x18af56}=_0x13785f,_0x54157b=await database_1[_0x21ea20(0x15e)]['shop']['findUnique']({'where':{'username':_0x24e7d7}});if(_0x54157b)throw new Error(_0x21ea20(0x174));if(_0x5eb980){const _0x4ca589=await database_1[_0x21ea20(0x15e)][_0x21ea20(0x183)][_0x21ea20(0x166)]({'where':{'telegram':_0x5eb980}});if(_0x4ca589)throw new Error('Telegram\x20username\x20already\x20exists');}const _0x1650a7=await bcryptjs_1[_0x21ea20(0x15e)][_0x21ea20(0x164)](_0x50849b,0xc),{publicKey:_0x5ed912,secretKey:_0x57137f}=this[_0x21ea20(0x188)](),_0xa87e96=await database_1['default']['shop']['create']({'data':{'name':_0x2b3965,'username':_0x24e7d7,'password':_0x1650a7,'telegram':_0x5eb980,'shopUrl':_0x54aa02,'paymentGateways':_0x215bcc?JSON[_0x21ea20(0x161)](_0x215bcc):null,'gatewaySettings':_0x54eb02?JSON[_0x21ea20(0x161)](_0x54eb02):null,'usdtPolygonWallet':_0x18af56?.[_0x21ea20(0x162)]||null,'usdtTrcWallet':_0x18af56?.['usdtTrcWallet']||null,'usdtErcWallet':_0x18af56?.[_0x21ea20(0x181)]||null,'usdcPolygonWallet':_0x18af56?.[_0x21ea20(0x18d)]||null,'publicKey':_0x5ed912,'secretKey':_0x57137f,'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0xa87e96['id'],'fullName':_0xa87e96[_0x21ea20(0x16b)],'username':_0xa87e96[_0x21ea20(0x196)],'telegramId':_0xa87e96[_0x21ea20(0x17c)],'merchantUrl':_0xa87e96[_0x21ea20(0x176)],'gateways':_0xa87e96[_0x21ea20(0x177)]?JSON[_0x21ea20(0x163)](_0xa87e96['paymentGateways']):null,'gatewaySettings':_0xa87e96[_0x21ea20(0x168)]?JSON[_0x21ea20(0x163)](_0xa87e96[_0x21ea20(0x168)]):null,'publicKey':_0xa87e96[_0x21ea20(0x17f)],'wallets':{'usdtPolygonWallet':_0xa87e96[_0x21ea20(0x162)],'usdtTrcWallet':_0xa87e96['usdtTrcWallet'],'usdtErcWallet':_0xa87e96[_0x21ea20(0x181)],'usdcPolygonWallet':_0xa87e96['usdcPolygonWallet']},'status':_0xa87e96[_0x21ea20(0x17d)],'createdAt':_0xa87e96['createdAt']};}async['getAllUsers'](){const _0x9a59d8=a54_0x1d700b,_0x23fc37=await database_1[_0x9a59d8(0x15e)][_0x9a59d8(0x183)][_0x9a59d8(0x193)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x9a59d8(0x194)}});return _0x23fc37['map'](_0x58b50d=>({'id':_0x58b50d['id'],'fullName':_0x58b50d[_0x9a59d8(0x16b)],'username':_0x58b50d['username'],'telegramId':_0x58b50d[_0x9a59d8(0x17c)],'merchantUrl':_0x58b50d[_0x9a59d8(0x176)],'gateways':_0x58b50d[_0x9a59d8(0x177)]?JSON['parse'](_0x58b50d['paymentGateways']):null,'gatewaySettings':_0x58b50d[_0x9a59d8(0x168)]?JSON['parse'](_0x58b50d[_0x9a59d8(0x168)]):null,'publicKey':_0x58b50d[_0x9a59d8(0x17f)],'wallets':{'usdtPolygonWallet':_0x58b50d[_0x9a59d8(0x162)],'usdtTrcWallet':_0x58b50d[_0x9a59d8(0x16e)],'usdtErcWallet':_0x58b50d[_0x9a59d8(0x181)],'usdcPolygonWallet':_0x58b50d[_0x9a59d8(0x18d)]},'status':_0x58b50d[_0x9a59d8(0x17d)],'createdAt':_0x58b50d['createdAt']}));}async[a54_0x1d700b(0x17e)](_0xbee7e5){const _0x2e8b27=a54_0x1d700b,_0x5dd3a2=await database_1[_0x2e8b27(0x15e)][_0x2e8b27(0x183)][_0x2e8b27(0x166)]({'where':{'id':_0xbee7e5},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x5dd3a2)return null;return{'id':_0x5dd3a2['id'],'fullName':_0x5dd3a2[_0x2e8b27(0x16b)],'username':_0x5dd3a2['username'],'telegramId':_0x5dd3a2[_0x2e8b27(0x17c)],'merchantUrl':_0x5dd3a2[_0x2e8b27(0x176)],'gateways':_0x5dd3a2[_0x2e8b27(0x177)]?JSON[_0x2e8b27(0x163)](_0x5dd3a2['paymentGateways']):null,'gatewaySettings':_0x5dd3a2[_0x2e8b27(0x168)]?JSON[_0x2e8b27(0x163)](_0x5dd3a2[_0x2e8b27(0x168)]):null,'publicKey':_0x5dd3a2[_0x2e8b27(0x17f)],'wallets':{'usdtPolygonWallet':_0x5dd3a2[_0x2e8b27(0x162)],'usdtTrcWallet':_0x5dd3a2[_0x2e8b27(0x16e)],'usdtErcWallet':_0x5dd3a2['usdtErcWallet'],'usdcPolygonWallet':_0x5dd3a2['usdcPolygonWallet']},'status':_0x5dd3a2[_0x2e8b27(0x17d)],'createdAt':_0x5dd3a2[_0x2e8b27(0x16a)]};}async[a54_0x1d700b(0x17b)](_0x1b5e9c,_0x382a84){const _0x482762=a54_0x1d700b,_0x201e45={..._0x382a84};_0x382a84['password']&&(_0x201e45[_0x482762(0x167)]=await bcryptjs_1['default'][_0x482762(0x164)](_0x382a84[_0x482762(0x167)],0xc));_0x382a84[_0x482762(0x184)]&&(_0x201e45[_0x482762(0x16b)]=_0x382a84[_0x482762(0x184)],delete _0x201e45[_0x482762(0x184)]);_0x382a84[_0x482762(0x186)]&&(_0x201e45[_0x482762(0x17c)]=_0x382a84[_0x482762(0x186)],delete _0x201e45[_0x482762(0x186)]);_0x382a84['merchantUrl']&&(_0x201e45[_0x482762(0x176)]=_0x382a84[_0x482762(0x17a)],delete _0x201e45[_0x482762(0x17a)]);_0x382a84['gateways']&&(_0x201e45[_0x482762(0x177)]=JSON[_0x482762(0x161)](_0x382a84[_0x482762(0x18e)]),delete _0x201e45[_0x482762(0x18e)]);_0x382a84[_0x482762(0x168)]&&(_0x201e45[_0x482762(0x168)]=JSON[_0x482762(0x161)](_0x382a84[_0x482762(0x168)]),delete _0x201e45[_0x482762(0x168)]);_0x382a84[_0x482762(0x173)]&&(_0x382a84[_0x482762(0x173)][_0x482762(0x162)]!==undefined&&(_0x201e45['usdtPolygonWallet']=_0x382a84[_0x482762(0x173)]['usdtPolygonWallet']||null),_0x382a84[_0x482762(0x173)][_0x482762(0x16e)]!==undefined&&(_0x201e45[_0x482762(0x16e)]=_0x382a84['wallets']['usdtTrcWallet']||null),_0x382a84[_0x482762(0x173)][_0x482762(0x181)]!==undefined&&(_0x201e45[_0x482762(0x181)]=_0x382a84['wallets'][_0x482762(0x181)]||null),_0x382a84[_0x482762(0x173)][_0x482762(0x18d)]!==undefined&&(_0x201e45[_0x482762(0x18d)]=_0x382a84['wallets'][_0x482762(0x18d)]||null),delete _0x201e45[_0x482762(0x173)]);const _0x45f9d2=await database_1['default'][_0x482762(0x183)][_0x482762(0x192)]({'where':{'id':_0x1b5e9c},'data':_0x201e45,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x45f9d2['id'],'fullName':_0x45f9d2[_0x482762(0x16b)],'username':_0x45f9d2[_0x482762(0x196)],'telegramId':_0x45f9d2[_0x482762(0x17c)],'merchantUrl':_0x45f9d2[_0x482762(0x176)],'gateways':_0x45f9d2[_0x482762(0x177)]?JSON[_0x482762(0x163)](_0x45f9d2[_0x482762(0x177)]):null,'gatewaySettings':_0x45f9d2[_0x482762(0x168)]?JSON[_0x482762(0x163)](_0x45f9d2[_0x482762(0x168)]):null,'publicKey':_0x45f9d2[_0x482762(0x17f)],'wallets':{'usdtPolygonWallet':_0x45f9d2[_0x482762(0x162)],'usdtTrcWallet':_0x45f9d2[_0x482762(0x16e)],'usdtErcWallet':_0x45f9d2['usdtErcWallet'],'usdcPolygonWallet':_0x45f9d2[_0x482762(0x18d)]},'status':_0x45f9d2['status'],'createdAt':_0x45f9d2[_0x482762(0x16a)]};}async[a54_0x1d700b(0x171)](_0x125a91){const _0x49f3bf=a54_0x1d700b;await database_1['default'][_0x49f3bf(0x183)][_0x49f3bf(0x195)]({'where':{'id':_0x125a91}});}}exports[a54_0x1d700b(0x172)]=UserService;function a54_0x141d(){const _0x1a3914=['updateUser','telegram','status','getUserById','publicKey','42KtHMUf','usdtErcWallet','hex','shop','fullName','2232140jdaBgG','telegramId','160CIzkPN','generateApiKeys','632821ZRtaNg','defineProperty','crypto','createUser','usdcPolygonWallet','gateways','../config/database','11RINUNx','4072416FjyRtN','update','findMany','desc','delete','username','default','2097567siJYXc','40LarobX','stringify','usdtPolygonWallet','parse','hash','354853qCNWOV','findUnique','password','gatewaySettings','44420eIMnLz','createdAt','name','54519NfMXPo','775NkZCoc','usdtTrcWallet','toString','__importDefault','deleteUser','UserService','wallets','Username\x20already\x20exists','__esModule','shopUrl','paymentGateways','randomBytes','bcryptjs','merchantUrl'];a54_0x141d=function(){return _0x1a3914;};return a54_0x141d();}