'use strict';const a63_0x183e81=a63_0x3a5b;(function(_0x540a81,_0x2ef54b){const _0xed1079=a63_0x3a5b,_0x317616=_0x540a81();while(!![]){try{const _0xb79eb7=-parseInt(_0xed1079(0x133))/0x1*(parseInt(_0xed1079(0x149))/0x2)+-parseInt(_0xed1079(0x139))/0x3*(-parseInt(_0xed1079(0x145))/0x4)+-parseInt(_0xed1079(0x151))/0x5*(parseInt(_0xed1079(0x11b))/0x6)+parseInt(_0xed1079(0x124))/0x7*(parseInt(_0xed1079(0x143))/0x8)+-parseInt(_0xed1079(0x150))/0x9*(-parseInt(_0xed1079(0x12a))/0xa)+-parseInt(_0xed1079(0x146))/0xb*(-parseInt(_0xed1079(0x122))/0xc)+-parseInt(_0xed1079(0x137))/0xd;if(_0xb79eb7===_0x2ef54b)break;else _0x317616['push'](_0x317616['shift']());}catch(_0x232e2f){_0x317616['push'](_0x317616['shift']());}}}(a63_0x58a3,0x38da6));function a63_0x58a3(){const _0x2467ee=['update','hash','paymentGateways','telegram','24363UqlLVo','2215IHuDpR','createdAt','findUnique','default','4254vjekOJ','UserService','create','password','createUser','name','fullName','2106924dgNtEV','shop','133bbYoaw','usdcPolygonWallet','wallets','__importDefault','toString','merchantUrl','1430ttYPLc','status','usdtPolygonWallet','sk_','gateways','randomBytes','hex','defineProperty','username','22273BBxcdY','desc','generateApiKeys','__esModule','6097663wCVnAq','updateUser','1083WZKzwO','usdtErcWallet','stringify','findMany','publicKey','parse','gatewaySettings','bcryptjs','shopUrl','crypto','138800zzjfhR','usdtTrcWallet','1864CvzUOU','11ktJRvm','../config/database','deleteUser','4dxvADG','Telegram\x20username\x20already\x20exists','ACTIVE'];a63_0x58a3=function(){return _0x2467ee;};return a63_0x58a3();}var __importDefault=this&&this[a63_0x183e81(0x127)]||function(_0x4d71ed){const _0x421c1b=a63_0x183e81;return _0x4d71ed&&_0x4d71ed[_0x421c1b(0x136)]?_0x4d71ed:{'default':_0x4d71ed};};Object[a63_0x183e81(0x131)](exports,'__esModule',{'value':!![]}),exports[a63_0x183e81(0x11c)]=void 0x0;const bcryptjs_1=__importDefault(require(a63_0x183e81(0x140))),crypto_1=__importDefault(require(a63_0x183e81(0x142))),database_1=__importDefault(require(a63_0x183e81(0x147)));function a63_0x3a5b(_0x366552,_0x3fd519){const _0x58a3c2=a63_0x58a3();return a63_0x3a5b=function(_0x3a5bc1,_0x56ce1b){_0x3a5bc1=_0x3a5bc1-0x11a;let _0x254a78=_0x58a3c2[_0x3a5bc1];return _0x254a78;},a63_0x3a5b(_0x366552,_0x3fd519);}class UserService{['generateApiKeys'](){const _0x5eadd3=a63_0x183e81,_0x34a155='pk_'+crypto_1['default'][_0x5eadd3(0x12f)](0x20)[_0x5eadd3(0x128)](_0x5eadd3(0x130)),_0xb57dd4=_0x5eadd3(0x12d)+crypto_1[_0x5eadd3(0x11a)][_0x5eadd3(0x12f)](0x20)[_0x5eadd3(0x128)](_0x5eadd3(0x130));return{'publicKey':_0x34a155,'secretKey':_0xb57dd4};}async[a63_0x183e81(0x11f)](_0x157ff5){const _0x282124=a63_0x183e81,{fullName:_0x3578e5,username:_0x323229,password:_0x3f4958,telegramId:_0x21281f,merchantUrl:_0x294264,gateways:_0x3290a6,gatewaySettings:_0x2fda40,wallets:_0x40719e}=_0x157ff5,_0x461ed1=await database_1[_0x282124(0x11a)][_0x282124(0x123)][_0x282124(0x153)]({'where':{'username':_0x323229}});if(_0x461ed1)throw new Error('Username\x20already\x20exists');if(_0x21281f){const _0x57ada7=await database_1[_0x282124(0x11a)]['shop'][_0x282124(0x153)]({'where':{'telegram':_0x21281f}});if(_0x57ada7)throw new Error(_0x282124(0x14a));}const _0x12c2ea=await bcryptjs_1[_0x282124(0x11a)][_0x282124(0x14d)](_0x3f4958,0xc),{publicKey:_0x5a3354,secretKey:_0x4e640f}=this[_0x282124(0x135)](),_0x4c4da8=await database_1[_0x282124(0x11a)][_0x282124(0x123)][_0x282124(0x11d)]({'data':{'name':_0x3578e5,'username':_0x323229,'password':_0x12c2ea,'telegram':_0x21281f,'shopUrl':_0x294264,'paymentGateways':_0x3290a6?JSON[_0x282124(0x13b)](_0x3290a6):null,'gatewaySettings':_0x2fda40?JSON['stringify'](_0x2fda40):null,'usdtPolygonWallet':_0x40719e?.[_0x282124(0x12c)]||null,'usdtTrcWallet':_0x40719e?.[_0x282124(0x144)]||null,'usdtErcWallet':_0x40719e?.[_0x282124(0x13a)]||null,'usdcPolygonWallet':_0x40719e?.[_0x282124(0x125)]||null,'publicKey':_0x5a3354,'secretKey':_0x4e640f,'status':_0x282124(0x14b)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x4c4da8['id'],'fullName':_0x4c4da8[_0x282124(0x120)],'username':_0x4c4da8[_0x282124(0x132)],'telegramId':_0x4c4da8[_0x282124(0x14f)],'merchantUrl':_0x4c4da8[_0x282124(0x141)],'gateways':_0x4c4da8[_0x282124(0x14e)]?JSON[_0x282124(0x13e)](_0x4c4da8[_0x282124(0x14e)]):null,'gatewaySettings':_0x4c4da8[_0x282124(0x13f)]?JSON[_0x282124(0x13e)](_0x4c4da8[_0x282124(0x13f)]):null,'publicKey':_0x4c4da8[_0x282124(0x13d)],'wallets':{'usdtPolygonWallet':_0x4c4da8[_0x282124(0x12c)],'usdtTrcWallet':_0x4c4da8[_0x282124(0x144)],'usdtErcWallet':_0x4c4da8['usdtErcWallet'],'usdcPolygonWallet':_0x4c4da8[_0x282124(0x125)]},'status':_0x4c4da8[_0x282124(0x12b)],'createdAt':_0x4c4da8[_0x282124(0x152)]};}async['getAllUsers'](){const _0x21ac0d=a63_0x183e81,_0x4b6b30=await database_1[_0x21ac0d(0x11a)][_0x21ac0d(0x123)][_0x21ac0d(0x13c)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x21ac0d(0x134)}});return _0x4b6b30['map'](_0x187deb=>({'id':_0x187deb['id'],'fullName':_0x187deb['name'],'username':_0x187deb['username'],'telegramId':_0x187deb['telegram'],'merchantUrl':_0x187deb[_0x21ac0d(0x141)],'gateways':_0x187deb[_0x21ac0d(0x14e)]?JSON[_0x21ac0d(0x13e)](_0x187deb[_0x21ac0d(0x14e)]):null,'gatewaySettings':_0x187deb['gatewaySettings']?JSON[_0x21ac0d(0x13e)](_0x187deb[_0x21ac0d(0x13f)]):null,'publicKey':_0x187deb[_0x21ac0d(0x13d)],'wallets':{'usdtPolygonWallet':_0x187deb[_0x21ac0d(0x12c)],'usdtTrcWallet':_0x187deb[_0x21ac0d(0x144)],'usdtErcWallet':_0x187deb[_0x21ac0d(0x13a)],'usdcPolygonWallet':_0x187deb[_0x21ac0d(0x125)]},'status':_0x187deb[_0x21ac0d(0x12b)],'createdAt':_0x187deb['createdAt']}));}async['getUserById'](_0x41e836){const _0xc019d6=a63_0x183e81,_0x37e853=await database_1[_0xc019d6(0x11a)]['shop'][_0xc019d6(0x153)]({'where':{'id':_0x41e836},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x37e853)return null;return{'id':_0x37e853['id'],'fullName':_0x37e853['name'],'username':_0x37e853[_0xc019d6(0x132)],'telegramId':_0x37e853['telegram'],'merchantUrl':_0x37e853[_0xc019d6(0x141)],'gateways':_0x37e853[_0xc019d6(0x14e)]?JSON['parse'](_0x37e853[_0xc019d6(0x14e)]):null,'gatewaySettings':_0x37e853[_0xc019d6(0x13f)]?JSON[_0xc019d6(0x13e)](_0x37e853[_0xc019d6(0x13f)]):null,'publicKey':_0x37e853[_0xc019d6(0x13d)],'wallets':{'usdtPolygonWallet':_0x37e853['usdtPolygonWallet'],'usdtTrcWallet':_0x37e853[_0xc019d6(0x144)],'usdtErcWallet':_0x37e853[_0xc019d6(0x13a)],'usdcPolygonWallet':_0x37e853[_0xc019d6(0x125)]},'status':_0x37e853[_0xc019d6(0x12b)],'createdAt':_0x37e853[_0xc019d6(0x152)]};}async[a63_0x183e81(0x138)](_0x55dbae,_0x41fa3e){const _0x552bef=a63_0x183e81,_0x22f4a4={..._0x41fa3e};_0x41fa3e[_0x552bef(0x11e)]&&(_0x22f4a4['password']=await bcryptjs_1[_0x552bef(0x11a)][_0x552bef(0x14d)](_0x41fa3e[_0x552bef(0x11e)],0xc));_0x41fa3e[_0x552bef(0x121)]&&(_0x22f4a4[_0x552bef(0x120)]=_0x41fa3e[_0x552bef(0x121)],delete _0x22f4a4[_0x552bef(0x121)]);_0x41fa3e['telegramId']&&(_0x22f4a4[_0x552bef(0x14f)]=_0x41fa3e['telegramId'],delete _0x22f4a4['telegramId']);_0x41fa3e['merchantUrl']&&(_0x22f4a4['shopUrl']=_0x41fa3e[_0x552bef(0x129)],delete _0x22f4a4[_0x552bef(0x129)]);_0x41fa3e[_0x552bef(0x12e)]&&(_0x22f4a4['paymentGateways']=JSON[_0x552bef(0x13b)](_0x41fa3e[_0x552bef(0x12e)]),delete _0x22f4a4[_0x552bef(0x12e)]);_0x41fa3e[_0x552bef(0x13f)]&&(_0x22f4a4[_0x552bef(0x13f)]=JSON['stringify'](_0x41fa3e['gatewaySettings']),delete _0x22f4a4[_0x552bef(0x13f)]);_0x41fa3e[_0x552bef(0x126)]&&(_0x41fa3e[_0x552bef(0x126)]['usdtPolygonWallet']!==undefined&&(_0x22f4a4['usdtPolygonWallet']=_0x41fa3e['wallets'][_0x552bef(0x12c)]||null),_0x41fa3e[_0x552bef(0x126)]['usdtTrcWallet']!==undefined&&(_0x22f4a4[_0x552bef(0x144)]=_0x41fa3e[_0x552bef(0x126)][_0x552bef(0x144)]||null),_0x41fa3e[_0x552bef(0x126)][_0x552bef(0x13a)]!==undefined&&(_0x22f4a4[_0x552bef(0x13a)]=_0x41fa3e['wallets'][_0x552bef(0x13a)]||null),_0x41fa3e[_0x552bef(0x126)]['usdcPolygonWallet']!==undefined&&(_0x22f4a4[_0x552bef(0x125)]=_0x41fa3e['wallets'][_0x552bef(0x125)]||null),delete _0x22f4a4[_0x552bef(0x126)]);const _0x201351=await database_1[_0x552bef(0x11a)]['shop'][_0x552bef(0x14c)]({'where':{'id':_0x55dbae},'data':_0x22f4a4,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x201351['id'],'fullName':_0x201351[_0x552bef(0x120)],'username':_0x201351[_0x552bef(0x132)],'telegramId':_0x201351['telegram'],'merchantUrl':_0x201351['shopUrl'],'gateways':_0x201351[_0x552bef(0x14e)]?JSON[_0x552bef(0x13e)](_0x201351[_0x552bef(0x14e)]):null,'gatewaySettings':_0x201351[_0x552bef(0x13f)]?JSON[_0x552bef(0x13e)](_0x201351['gatewaySettings']):null,'publicKey':_0x201351[_0x552bef(0x13d)],'wallets':{'usdtPolygonWallet':_0x201351[_0x552bef(0x12c)],'usdtTrcWallet':_0x201351[_0x552bef(0x144)],'usdtErcWallet':_0x201351[_0x552bef(0x13a)],'usdcPolygonWallet':_0x201351[_0x552bef(0x125)]},'status':_0x201351[_0x552bef(0x12b)],'createdAt':_0x201351[_0x552bef(0x152)]};}async[a63_0x183e81(0x148)](_0x21b87e){const _0x42b82a=a63_0x183e81;await database_1[_0x42b82a(0x11a)][_0x42b82a(0x123)]['delete']({'where':{'id':_0x21b87e}});}}exports['UserService']=UserService;