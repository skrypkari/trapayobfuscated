'use strict';const a55_0x549b45=a55_0xe6c8;(function(_0x2b52ea,_0x47918f){const _0x110bb7=a55_0xe6c8,_0xc051a2=_0x2b52ea();while(!![]){try{const _0x3f3b8a=parseInt(_0x110bb7(0x1c8))/0x1+parseInt(_0x110bb7(0x1d2))/0x2+-parseInt(_0x110bb7(0x1e2))/0x3+parseInt(_0x110bb7(0x1b9))/0x4+parseInt(_0x110bb7(0x1e8))/0x5*(parseInt(_0x110bb7(0x1d3))/0x6)+parseInt(_0x110bb7(0x1bd))/0x7*(parseInt(_0x110bb7(0x1b5))/0x8)+-parseInt(_0x110bb7(0x1bb))/0x9*(parseInt(_0x110bb7(0x1bf))/0xa);if(_0x3f3b8a===_0x47918f)break;else _0xc051a2['push'](_0xc051a2['shift']());}catch(_0x385ea4){_0xc051a2['push'](_0xc051a2['shift']());}}}(a55_0x1614,0xa8e82));function a55_0xe6c8(_0x2c3aa5,_0x2097ab){const _0x1614db=a55_0x1614();return a55_0xe6c8=function(_0xe6c8b5,_0x1a9173){_0xe6c8b5=_0xe6c8b5-0x1b2;let _0x1ad659=_0x1614db[_0xe6c8b5];return _0x1ad659;},a55_0xe6c8(_0x2c3aa5,_0x2097ab);}var __importDefault=this&&this[a55_0x549b45(0x1cc)]||function(_0x51649c){const _0x2f4ecb=a55_0x549b45;return _0x51649c&&_0x51649c[_0x2f4ecb(0x1be)]?_0x51649c:{'default':_0x51649c};};function a55_0x1614(){const _0xd51ea3=['pk_','generateApiKeys','1383662zRufWo','wallets','createdAt','status','__importDefault','password','findUnique','createUser','sk_','usdtErcWallet','975790hJJHha','83718wUehVh','hex','parse','create','gateways','../config/database','Telegram\x20username\x20already\x20exists','deleteUser','gatewaySettings','UserService','usdtPolygonWallet','stringify','usdtTrcWallet','name','telegramId','2179848yKyRwS','publicKey','fullName','toString','merchantUrl','crypto','95lNcSnB','username','paymentGateways','randomBytes','536giXuIx','shop','bcryptjs','hash','2477116qziNQa','getUserById','801wlImao','telegram','48167cvOkbS','__esModule','202080gRWnhK','usdcPolygonWallet','update','getAllUsers','ACTIVE','shopUrl','default'];a55_0x1614=function(){return _0xd51ea3;};return a55_0x1614();}Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a55_0x549b45(0x1dc)]=void 0x0;const bcryptjs_1=__importDefault(require(a55_0x549b45(0x1b7))),crypto_1=__importDefault(require(a55_0x549b45(0x1e7))),database_1=__importDefault(require(a55_0x549b45(0x1d8)));class UserService{[a55_0x549b45(0x1c7)](){const _0x10d981=a55_0x549b45,_0x13c8bc=_0x10d981(0x1c6)+crypto_1['default'][_0x10d981(0x1b4)](0x20)['toString'](_0x10d981(0x1d4)),_0x4cd518=_0x10d981(0x1d0)+crypto_1[_0x10d981(0x1c5)]['randomBytes'](0x20)[_0x10d981(0x1e5)]('hex');return{'publicKey':_0x13c8bc,'secretKey':_0x4cd518};}async[a55_0x549b45(0x1cf)](_0x3dbf11){const _0x7fe7e4=a55_0x549b45,{fullName:_0x1c6cfc,username:_0x4b283d,password:_0x4ffe45,telegramId:_0x11a235,merchantUrl:_0x16aeb7,gateways:_0x2426b6,gatewaySettings:_0x1f9015,wallets:_0x15805d}=_0x3dbf11,_0x55e176=await database_1[_0x7fe7e4(0x1c5)][_0x7fe7e4(0x1b6)]['findUnique']({'where':{'username':_0x4b283d}});if(_0x55e176)throw new Error('Username\x20already\x20exists');if(_0x11a235){const _0x34d4ef=await database_1['default'][_0x7fe7e4(0x1b6)][_0x7fe7e4(0x1ce)]({'where':{'telegram':_0x11a235}});if(_0x34d4ef)throw new Error(_0x7fe7e4(0x1d9));}const _0x194f71=await bcryptjs_1[_0x7fe7e4(0x1c5)][_0x7fe7e4(0x1b8)](_0x4ffe45,0xc),{publicKey:_0xeb7e53,secretKey:_0x315217}=this[_0x7fe7e4(0x1c7)](),_0xfda137=await database_1[_0x7fe7e4(0x1c5)][_0x7fe7e4(0x1b6)][_0x7fe7e4(0x1d6)]({'data':{'name':_0x1c6cfc,'username':_0x4b283d,'password':_0x194f71,'telegram':_0x11a235,'shopUrl':_0x16aeb7,'paymentGateways':_0x2426b6?JSON[_0x7fe7e4(0x1de)](_0x2426b6):null,'gatewaySettings':_0x1f9015?JSON[_0x7fe7e4(0x1de)](_0x1f9015):null,'usdtPolygonWallet':_0x15805d?.[_0x7fe7e4(0x1dd)]||null,'usdtTrcWallet':_0x15805d?.['usdtTrcWallet']||null,'usdtErcWallet':_0x15805d?.[_0x7fe7e4(0x1d1)]||null,'usdcPolygonWallet':_0x15805d?.[_0x7fe7e4(0x1c0)]||null,'publicKey':_0xeb7e53,'secretKey':_0x315217,'status':_0x7fe7e4(0x1c3)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0xfda137['id'],'fullName':_0xfda137['name'],'username':_0xfda137[_0x7fe7e4(0x1b2)],'telegramId':_0xfda137[_0x7fe7e4(0x1bc)],'merchantUrl':_0xfda137['shopUrl'],'gateways':_0xfda137[_0x7fe7e4(0x1b3)]?JSON[_0x7fe7e4(0x1d5)](_0xfda137[_0x7fe7e4(0x1b3)]):null,'gatewaySettings':_0xfda137['gatewaySettings']?JSON[_0x7fe7e4(0x1d5)](_0xfda137['gatewaySettings']):null,'publicKey':_0xfda137[_0x7fe7e4(0x1e3)],'wallets':{'usdtPolygonWallet':_0xfda137[_0x7fe7e4(0x1dd)],'usdtTrcWallet':_0xfda137[_0x7fe7e4(0x1df)],'usdtErcWallet':_0xfda137[_0x7fe7e4(0x1d1)],'usdcPolygonWallet':_0xfda137[_0x7fe7e4(0x1c0)]},'status':_0xfda137[_0x7fe7e4(0x1cb)],'createdAt':_0xfda137['createdAt']};}async[a55_0x549b45(0x1c2)](){const _0x1e350e=a55_0x549b45,_0x2b3b6f=await database_1['default']['shop']['findMany']({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':'desc'}});return _0x2b3b6f['map'](_0x1bbac5=>({'id':_0x1bbac5['id'],'fullName':_0x1bbac5[_0x1e350e(0x1e0)],'username':_0x1bbac5['username'],'telegramId':_0x1bbac5[_0x1e350e(0x1bc)],'merchantUrl':_0x1bbac5[_0x1e350e(0x1c4)],'gateways':_0x1bbac5[_0x1e350e(0x1b3)]?JSON[_0x1e350e(0x1d5)](_0x1bbac5[_0x1e350e(0x1b3)]):null,'gatewaySettings':_0x1bbac5['gatewaySettings']?JSON[_0x1e350e(0x1d5)](_0x1bbac5[_0x1e350e(0x1db)]):null,'publicKey':_0x1bbac5[_0x1e350e(0x1e3)],'wallets':{'usdtPolygonWallet':_0x1bbac5[_0x1e350e(0x1dd)],'usdtTrcWallet':_0x1bbac5['usdtTrcWallet'],'usdtErcWallet':_0x1bbac5[_0x1e350e(0x1d1)],'usdcPolygonWallet':_0x1bbac5['usdcPolygonWallet']},'status':_0x1bbac5[_0x1e350e(0x1cb)],'createdAt':_0x1bbac5[_0x1e350e(0x1ca)]}));}async[a55_0x549b45(0x1ba)](_0x39a5a3){const _0x160547=a55_0x549b45,_0x57814a=await database_1[_0x160547(0x1c5)][_0x160547(0x1b6)]['findUnique']({'where':{'id':_0x39a5a3},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x57814a)return null;return{'id':_0x57814a['id'],'fullName':_0x57814a[_0x160547(0x1e0)],'username':_0x57814a[_0x160547(0x1b2)],'telegramId':_0x57814a[_0x160547(0x1bc)],'merchantUrl':_0x57814a[_0x160547(0x1c4)],'gateways':_0x57814a['paymentGateways']?JSON['parse'](_0x57814a[_0x160547(0x1b3)]):null,'gatewaySettings':_0x57814a[_0x160547(0x1db)]?JSON[_0x160547(0x1d5)](_0x57814a[_0x160547(0x1db)]):null,'publicKey':_0x57814a['publicKey'],'wallets':{'usdtPolygonWallet':_0x57814a[_0x160547(0x1dd)],'usdtTrcWallet':_0x57814a[_0x160547(0x1df)],'usdtErcWallet':_0x57814a[_0x160547(0x1d1)],'usdcPolygonWallet':_0x57814a[_0x160547(0x1c0)]},'status':_0x57814a[_0x160547(0x1cb)],'createdAt':_0x57814a[_0x160547(0x1ca)]};}async['updateUser'](_0x42539d,_0x37fbae){const _0x55e183=a55_0x549b45,_0xea635d={..._0x37fbae};_0x37fbae[_0x55e183(0x1cd)]&&(_0xea635d[_0x55e183(0x1cd)]=await bcryptjs_1[_0x55e183(0x1c5)][_0x55e183(0x1b8)](_0x37fbae[_0x55e183(0x1cd)],0xc));_0x37fbae[_0x55e183(0x1e4)]&&(_0xea635d['name']=_0x37fbae[_0x55e183(0x1e4)],delete _0xea635d['fullName']);_0x37fbae['telegramId']&&(_0xea635d[_0x55e183(0x1bc)]=_0x37fbae[_0x55e183(0x1e1)],delete _0xea635d[_0x55e183(0x1e1)]);_0x37fbae[_0x55e183(0x1e6)]&&(_0xea635d['shopUrl']=_0x37fbae['merchantUrl'],delete _0xea635d[_0x55e183(0x1e6)]);_0x37fbae['gateways']&&(_0xea635d[_0x55e183(0x1b3)]=JSON[_0x55e183(0x1de)](_0x37fbae[_0x55e183(0x1d7)]),delete _0xea635d[_0x55e183(0x1d7)]);_0x37fbae[_0x55e183(0x1db)]&&(_0xea635d['gatewaySettings']=JSON[_0x55e183(0x1de)](_0x37fbae[_0x55e183(0x1db)]),delete _0xea635d[_0x55e183(0x1db)]);_0x37fbae[_0x55e183(0x1c9)]&&(_0x37fbae[_0x55e183(0x1c9)][_0x55e183(0x1dd)]!==undefined&&(_0xea635d['usdtPolygonWallet']=_0x37fbae['wallets'][_0x55e183(0x1dd)]||null),_0x37fbae[_0x55e183(0x1c9)][_0x55e183(0x1df)]!==undefined&&(_0xea635d[_0x55e183(0x1df)]=_0x37fbae[_0x55e183(0x1c9)]['usdtTrcWallet']||null),_0x37fbae[_0x55e183(0x1c9)][_0x55e183(0x1d1)]!==undefined&&(_0xea635d[_0x55e183(0x1d1)]=_0x37fbae['wallets'][_0x55e183(0x1d1)]||null),_0x37fbae[_0x55e183(0x1c9)][_0x55e183(0x1c0)]!==undefined&&(_0xea635d[_0x55e183(0x1c0)]=_0x37fbae[_0x55e183(0x1c9)][_0x55e183(0x1c0)]||null),delete _0xea635d[_0x55e183(0x1c9)]);const _0x9411a9=await database_1[_0x55e183(0x1c5)][_0x55e183(0x1b6)][_0x55e183(0x1c1)]({'where':{'id':_0x42539d},'data':_0xea635d,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x9411a9['id'],'fullName':_0x9411a9['name'],'username':_0x9411a9[_0x55e183(0x1b2)],'telegramId':_0x9411a9[_0x55e183(0x1bc)],'merchantUrl':_0x9411a9[_0x55e183(0x1c4)],'gateways':_0x9411a9[_0x55e183(0x1b3)]?JSON[_0x55e183(0x1d5)](_0x9411a9[_0x55e183(0x1b3)]):null,'gatewaySettings':_0x9411a9['gatewaySettings']?JSON[_0x55e183(0x1d5)](_0x9411a9[_0x55e183(0x1db)]):null,'publicKey':_0x9411a9[_0x55e183(0x1e3)],'wallets':{'usdtPolygonWallet':_0x9411a9[_0x55e183(0x1dd)],'usdtTrcWallet':_0x9411a9[_0x55e183(0x1df)],'usdtErcWallet':_0x9411a9[_0x55e183(0x1d1)],'usdcPolygonWallet':_0x9411a9['usdcPolygonWallet']},'status':_0x9411a9['status'],'createdAt':_0x9411a9[_0x55e183(0x1ca)]};}async[a55_0x549b45(0x1da)](_0x94c7a5){const _0x4b365b=a55_0x549b45;await database_1[_0x4b365b(0x1c5)][_0x4b365b(0x1b6)]['delete']({'where':{'id':_0x94c7a5}});}}exports['UserService']=UserService;