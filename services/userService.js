'use strict';function a56_0xd45e(_0x55ee8a,_0x3e77f1){const _0x339337=a56_0x3393();return a56_0xd45e=function(_0xd45efe,_0x10a71a){_0xd45efe=_0xd45efe-0xac;let _0x34a031=_0x339337[_0xd45efe];return _0x34a031;},a56_0xd45e(_0x55ee8a,_0x3e77f1);}const a56_0x30b2c1=a56_0xd45e;(function(_0x91fa96,_0x22708d){const _0x4a9b7f=a56_0xd45e,_0x3c9b0b=_0x91fa96();while(!![]){try{const _0x372a40=parseInt(_0x4a9b7f(0xc7))/0x1*(parseInt(_0x4a9b7f(0xb9))/0x2)+-parseInt(_0x4a9b7f(0xbd))/0x3+parseInt(_0x4a9b7f(0xcd))/0x4+parseInt(_0x4a9b7f(0xbc))/0x5+parseInt(_0x4a9b7f(0xd5))/0x6*(-parseInt(_0x4a9b7f(0xdb))/0x7)+-parseInt(_0x4a9b7f(0xc8))/0x8*(-parseInt(_0x4a9b7f(0xbf))/0x9)+parseInt(_0x4a9b7f(0xc4))/0xa*(-parseInt(_0x4a9b7f(0xb5))/0xb);if(_0x372a40===_0x22708d)break;else _0x3c9b0b['push'](_0x3c9b0b['shift']());}catch(_0x55abaa){_0x3c9b0b['push'](_0x3c9b0b['shift']());}}}(a56_0x3393,0x8b13c));var __importDefault=this&&this['__importDefault']||function(_0xe21763){const _0x456b02=a56_0xd45e;return _0xe21763&&_0xe21763[_0x456b02(0xde)]?_0xe21763:{'default':_0xe21763};};Object[a56_0x30b2c1(0xc3)](exports,a56_0x30b2c1(0xde),{'value':!![]}),exports[a56_0x30b2c1(0xb3)]=void 0x0;const bcryptjs_1=__importDefault(require(a56_0x30b2c1(0xcb))),crypto_1=__importDefault(require(a56_0x30b2c1(0xc2))),database_1=__importDefault(require('../config/database'));class UserService{['generateApiKeys'](){const _0x59d4ca=a56_0x30b2c1,_0x309381=_0x59d4ca(0xad)+crypto_1[_0x59d4ca(0xb2)][_0x59d4ca(0xcf)](0x20)[_0x59d4ca(0xdd)]('hex'),_0x5b3d72=_0x59d4ca(0xd2)+crypto_1[_0x59d4ca(0xb2)][_0x59d4ca(0xcf)](0x20)[_0x59d4ca(0xdd)]('hex');return{'publicKey':_0x309381,'secretKey':_0x5b3d72};}async[a56_0x30b2c1(0xd6)](_0x5b79a2){const _0x3feb6b=a56_0x30b2c1,{fullName:_0x49284b,username:_0xead86a,password:_0x3d7c65,telegramId:_0x4e629d,merchantUrl:_0x4632ad,gateways:_0x55c139,gatewaySettings:_0xdbcf47,wallets:_0x59b773}=_0x5b79a2,_0x96a0e0=await database_1[_0x3feb6b(0xb2)]['shop'][_0x3feb6b(0xb6)]({'where':{'username':_0xead86a}});if(_0x96a0e0)throw new Error(_0x3feb6b(0xd8));if(_0x4e629d){const _0x572392=await database_1['default'][_0x3feb6b(0xc6)]['findUnique']({'where':{'telegram':_0x4e629d}});if(_0x572392)throw new Error(_0x3feb6b(0xae));}const _0x4568be=await bcryptjs_1[_0x3feb6b(0xb2)][_0x3feb6b(0xce)](_0x3d7c65,0xc),{publicKey:_0x2bc27d,secretKey:_0x371dac}=this[_0x3feb6b(0xd7)](),_0x264214=await database_1['default'][_0x3feb6b(0xc6)]['create']({'data':{'name':_0x49284b,'username':_0xead86a,'password':_0x4568be,'telegram':_0x4e629d,'shopUrl':_0x4632ad,'paymentGateways':_0x55c139?JSON[_0x3feb6b(0xb0)](_0x55c139):null,'gatewaySettings':_0xdbcf47?JSON[_0x3feb6b(0xb0)](_0xdbcf47):null,'usdtPolygonWallet':_0x59b773?.[_0x3feb6b(0xe1)]||null,'usdtTrcWallet':_0x59b773?.[_0x3feb6b(0xc9)]||null,'usdtErcWallet':_0x59b773?.['usdtErcWallet']||null,'usdcPolygonWallet':_0x59b773?.[_0x3feb6b(0xba)]||null,'publicKey':_0x2bc27d,'secretKey':_0x371dac,'status':_0x3feb6b(0xb1)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x264214['id'],'fullName':_0x264214['name'],'username':_0x264214[_0x3feb6b(0xd0)],'telegramId':_0x264214[_0x3feb6b(0xcc)],'merchantUrl':_0x264214[_0x3feb6b(0xe3)],'gateways':_0x264214['paymentGateways']?JSON[_0x3feb6b(0xd4)](_0x264214[_0x3feb6b(0xac)]):null,'gatewaySettings':_0x264214[_0x3feb6b(0xdf)]?JSON[_0x3feb6b(0xd4)](_0x264214[_0x3feb6b(0xdf)]):null,'publicKey':_0x264214[_0x3feb6b(0xdc)],'wallets':{'usdtPolygonWallet':_0x264214[_0x3feb6b(0xe1)],'usdtTrcWallet':_0x264214['usdtTrcWallet'],'usdtErcWallet':_0x264214[_0x3feb6b(0xaf)],'usdcPolygonWallet':_0x264214[_0x3feb6b(0xba)]},'status':_0x264214['status'],'createdAt':_0x264214[_0x3feb6b(0xe0)]};}async['getAllUsers'](){const _0x155adf=a56_0x30b2c1,_0x4b6106=await database_1[_0x155adf(0xb2)][_0x155adf(0xc6)][_0x155adf(0xd9)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':'desc'}});return _0x4b6106['map'](_0x1b1ea4=>({'id':_0x1b1ea4['id'],'fullName':_0x1b1ea4[_0x155adf(0xda)],'username':_0x1b1ea4[_0x155adf(0xd0)],'telegramId':_0x1b1ea4[_0x155adf(0xcc)],'merchantUrl':_0x1b1ea4[_0x155adf(0xe3)],'gateways':_0x1b1ea4[_0x155adf(0xac)]?JSON[_0x155adf(0xd4)](_0x1b1ea4[_0x155adf(0xac)]):null,'gatewaySettings':_0x1b1ea4[_0x155adf(0xdf)]?JSON[_0x155adf(0xd4)](_0x1b1ea4[_0x155adf(0xdf)]):null,'publicKey':_0x1b1ea4[_0x155adf(0xdc)],'wallets':{'usdtPolygonWallet':_0x1b1ea4[_0x155adf(0xe1)],'usdtTrcWallet':_0x1b1ea4[_0x155adf(0xc9)],'usdtErcWallet':_0x1b1ea4[_0x155adf(0xaf)],'usdcPolygonWallet':_0x1b1ea4[_0x155adf(0xba)]},'status':_0x1b1ea4['status'],'createdAt':_0x1b1ea4['createdAt']}));}async[a56_0x30b2c1(0xb7)](_0xe1c738){const _0x4b8bb6=a56_0x30b2c1,_0x52b8e0=await database_1[_0x4b8bb6(0xb2)]['shop']['findUnique']({'where':{'id':_0xe1c738},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x52b8e0)return null;return{'id':_0x52b8e0['id'],'fullName':_0x52b8e0[_0x4b8bb6(0xda)],'username':_0x52b8e0['username'],'telegramId':_0x52b8e0[_0x4b8bb6(0xcc)],'merchantUrl':_0x52b8e0[_0x4b8bb6(0xe3)],'gateways':_0x52b8e0[_0x4b8bb6(0xac)]?JSON[_0x4b8bb6(0xd4)](_0x52b8e0['paymentGateways']):null,'gatewaySettings':_0x52b8e0[_0x4b8bb6(0xdf)]?JSON[_0x4b8bb6(0xd4)](_0x52b8e0[_0x4b8bb6(0xdf)]):null,'publicKey':_0x52b8e0[_0x4b8bb6(0xdc)],'wallets':{'usdtPolygonWallet':_0x52b8e0[_0x4b8bb6(0xe1)],'usdtTrcWallet':_0x52b8e0[_0x4b8bb6(0xc9)],'usdtErcWallet':_0x52b8e0[_0x4b8bb6(0xaf)],'usdcPolygonWallet':_0x52b8e0[_0x4b8bb6(0xba)]},'status':_0x52b8e0[_0x4b8bb6(0xb4)],'createdAt':_0x52b8e0['createdAt']};}async[a56_0x30b2c1(0xca)](_0x2f8b23,_0x133714){const _0x168572=a56_0x30b2c1,_0x310b8a={..._0x133714};_0x133714[_0x168572(0xc1)]&&(_0x310b8a[_0x168572(0xc1)]=await bcryptjs_1['default'][_0x168572(0xce)](_0x133714[_0x168572(0xc1)],0xc));_0x133714[_0x168572(0xc0)]&&(_0x310b8a[_0x168572(0xda)]=_0x133714[_0x168572(0xc0)],delete _0x310b8a[_0x168572(0xc0)]);_0x133714['telegramId']&&(_0x310b8a['telegram']=_0x133714[_0x168572(0xd1)],delete _0x310b8a[_0x168572(0xd1)]);_0x133714[_0x168572(0xbb)]&&(_0x310b8a[_0x168572(0xe3)]=_0x133714[_0x168572(0xbb)],delete _0x310b8a['merchantUrl']);_0x133714[_0x168572(0xb8)]&&(_0x310b8a[_0x168572(0xac)]=JSON[_0x168572(0xb0)](_0x133714[_0x168572(0xb8)]),delete _0x310b8a[_0x168572(0xb8)]);_0x133714[_0x168572(0xdf)]&&(_0x310b8a['gatewaySettings']=JSON[_0x168572(0xb0)](_0x133714['gatewaySettings']),delete _0x310b8a[_0x168572(0xdf)]);_0x133714['wallets']&&(_0x133714[_0x168572(0xbe)][_0x168572(0xe1)]!==undefined&&(_0x310b8a[_0x168572(0xe1)]=_0x133714['wallets'][_0x168572(0xe1)]||null),_0x133714[_0x168572(0xbe)]['usdtTrcWallet']!==undefined&&(_0x310b8a['usdtTrcWallet']=_0x133714[_0x168572(0xbe)][_0x168572(0xc9)]||null),_0x133714[_0x168572(0xbe)][_0x168572(0xaf)]!==undefined&&(_0x310b8a[_0x168572(0xaf)]=_0x133714[_0x168572(0xbe)][_0x168572(0xaf)]||null),_0x133714[_0x168572(0xbe)][_0x168572(0xba)]!==undefined&&(_0x310b8a[_0x168572(0xba)]=_0x133714[_0x168572(0xbe)][_0x168572(0xba)]||null),delete _0x310b8a[_0x168572(0xbe)]);const _0x2c3bde=await database_1['default']['shop'][_0x168572(0xc5)]({'where':{'id':_0x2f8b23},'data':_0x310b8a,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x2c3bde['id'],'fullName':_0x2c3bde[_0x168572(0xda)],'username':_0x2c3bde['username'],'telegramId':_0x2c3bde[_0x168572(0xcc)],'merchantUrl':_0x2c3bde['shopUrl'],'gateways':_0x2c3bde[_0x168572(0xac)]?JSON[_0x168572(0xd4)](_0x2c3bde[_0x168572(0xac)]):null,'gatewaySettings':_0x2c3bde[_0x168572(0xdf)]?JSON[_0x168572(0xd4)](_0x2c3bde[_0x168572(0xdf)]):null,'publicKey':_0x2c3bde[_0x168572(0xdc)],'wallets':{'usdtPolygonWallet':_0x2c3bde['usdtPolygonWallet'],'usdtTrcWallet':_0x2c3bde[_0x168572(0xc9)],'usdtErcWallet':_0x2c3bde[_0x168572(0xaf)],'usdcPolygonWallet':_0x2c3bde[_0x168572(0xba)]},'status':_0x2c3bde[_0x168572(0xb4)],'createdAt':_0x2c3bde['createdAt']};}async[a56_0x30b2c1(0xe2)](_0x1d32b0){const _0x52d860=a56_0x30b2c1;await database_1[_0x52d860(0xb2)]['shop'][_0x52d860(0xd3)]({'where':{'id':_0x1d32b0}});}}function a56_0x3393(){const _0xe9f62d=['56twdayP','usdcPolygonWallet','merchantUrl','1105165iMkTWk','564759IFtFik','wallets','45NKZhjn','fullName','password','crypto','defineProperty','4270hlrRyT','update','shop','1207FAVbXe','1767608uTypUh','usdtTrcWallet','updateUser','bcryptjs','telegram','890292hPXxIX','hash','randomBytes','username','telegramId','sk_','delete','parse','607998qKDOom','createUser','generateApiKeys','Username\x20already\x20exists','findMany','name','7kUVJsV','publicKey','toString','__esModule','gatewaySettings','createdAt','usdtPolygonWallet','deleteUser','shopUrl','paymentGateways','pk_','Telegram\x20username\x20already\x20exists','usdtErcWallet','stringify','ACTIVE','default','UserService','status','18623XLxmzC','findUnique','getUserById','gateways'];a56_0x3393=function(){return _0xe9f62d;};return a56_0x3393();}exports[a56_0x30b2c1(0xb3)]=UserService;