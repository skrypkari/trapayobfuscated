'use strict';const a57_0x32048a=a57_0x4e08;(function(_0x5dc8aa,_0x2a34a6){const _0x2711e3=a57_0x4e08,_0x2420b2=_0x5dc8aa();while(!![]){try{const _0x3332dd=parseInt(_0x2711e3(0x98))/0x1*(parseInt(_0x2711e3(0xb2))/0x2)+parseInt(_0x2711e3(0x94))/0x3*(parseInt(_0x2711e3(0x9e))/0x4)+parseInt(_0x2711e3(0xa9))/0x5*(parseInt(_0x2711e3(0x8d))/0x6)+parseInt(_0x2711e3(0xa6))/0x7*(-parseInt(_0x2711e3(0x8a))/0x8)+-parseInt(_0x2711e3(0xac))/0x9+parseInt(_0x2711e3(0xb6))/0xa*(-parseInt(_0x2711e3(0x9c))/0xb)+-parseInt(_0x2711e3(0x91))/0xc*(-parseInt(_0x2711e3(0x9d))/0xd);if(_0x3332dd===_0x2a34a6)break;else _0x2420b2['push'](_0x2420b2['shift']());}catch(_0x2a9665){_0x2420b2['push'](_0x2420b2['shift']());}}}(a57_0x5ef8,0x34c46));var __importDefault=this&&this['__importDefault']||function(_0x4bf0f3){const _0x1680a5=a57_0x4e08;return _0x4bf0f3&&_0x4bf0f3[_0x1680a5(0xbc)]?_0x4bf0f3:{'default':_0x4bf0f3};};function a57_0x4e08(_0x4171b3,_0x456fbe){const _0x5ef847=a57_0x5ef8();return a57_0x4e08=function(_0x4e0853,_0x1c922f){_0x4e0853=_0x4e0853-0x88;let _0x54ee74=_0x5ef847[_0x4e0853];return _0x54ee74;},a57_0x4e08(_0x4171b3,_0x456fbe);}Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports['UserService']=void 0x0;const bcryptjs_1=__importDefault(require(a57_0x32048a(0x8c))),crypto_1=__importDefault(require('crypto')),database_1=__importDefault(require(a57_0x32048a(0x95)));class UserService{['generateApiKeys'](){const _0x467dfb=a57_0x32048a,_0x843b6b=_0x467dfb(0xae)+crypto_1[_0x467dfb(0x8b)][_0x467dfb(0xc0)](0x20)[_0x467dfb(0xb5)](_0x467dfb(0xa4)),_0x279568=_0x467dfb(0x9f)+crypto_1['default']['randomBytes'](0x20)['toString'](_0x467dfb(0xa4));return{'publicKey':_0x843b6b,'secretKey':_0x279568};}async['createUser'](_0x23dd30){const _0x1e5b2b=a57_0x32048a,{fullName:_0x41f142,username:_0x45dc7c,password:_0x56a9f3,telegramId:_0x15cf11,merchantUrl:_0x20e854,gateways:_0x3e6fb5,gatewaySettings:_0x5713dc,wallets:_0x1afcbd}=_0x23dd30,_0x4c875b=await database_1[_0x1e5b2b(0x8b)][_0x1e5b2b(0xb1)][_0x1e5b2b(0x8e)]({'where':{'username':_0x45dc7c}});if(_0x4c875b)throw new Error('Username\x20already\x20exists');if(_0x15cf11){const _0x4bf22f=await database_1['default']['shop'][_0x1e5b2b(0x8e)]({'where':{'telegram':_0x15cf11}});if(_0x4bf22f)throw new Error(_0x1e5b2b(0x8f));}const _0x4f7f7f=await bcryptjs_1[_0x1e5b2b(0x8b)][_0x1e5b2b(0xaf)](_0x56a9f3,0xc),{publicKey:_0x53d276,secretKey:_0x39e984}=this[_0x1e5b2b(0xa0)](),_0x30c26f=await database_1['default'][_0x1e5b2b(0xb1)]['create']({'data':{'name':_0x41f142,'username':_0x45dc7c,'password':_0x4f7f7f,'telegram':_0x15cf11,'shopUrl':_0x20e854,'paymentGateways':_0x3e6fb5?JSON[_0x1e5b2b(0x99)](_0x3e6fb5):null,'gatewaySettings':_0x5713dc?JSON[_0x1e5b2b(0x99)](_0x5713dc):null,'usdtPolygonWallet':_0x1afcbd?.['usdtPolygonWallet']||null,'usdtTrcWallet':_0x1afcbd?.[_0x1e5b2b(0x92)]||null,'usdtErcWallet':_0x1afcbd?.[_0x1e5b2b(0xb9)]||null,'usdcPolygonWallet':_0x1afcbd?.[_0x1e5b2b(0xbd)]||null,'publicKey':_0x53d276,'secretKey':_0x39e984,'status':_0x1e5b2b(0x96)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x30c26f['id'],'fullName':_0x30c26f[_0x1e5b2b(0xab)],'username':_0x30c26f[_0x1e5b2b(0xb0)],'telegramId':_0x30c26f[_0x1e5b2b(0x97)],'merchantUrl':_0x30c26f['shopUrl'],'gateways':_0x30c26f[_0x1e5b2b(0xaa)]?JSON[_0x1e5b2b(0xbb)](_0x30c26f[_0x1e5b2b(0xaa)]):null,'gatewaySettings':_0x30c26f[_0x1e5b2b(0xa5)]?JSON['parse'](_0x30c26f[_0x1e5b2b(0xa5)]):null,'publicKey':_0x30c26f[_0x1e5b2b(0xa2)],'wallets':{'usdtPolygonWallet':_0x30c26f['usdtPolygonWallet'],'usdtTrcWallet':_0x30c26f[_0x1e5b2b(0x92)],'usdtErcWallet':_0x30c26f[_0x1e5b2b(0xb9)],'usdcPolygonWallet':_0x30c26f[_0x1e5b2b(0xbd)]},'status':_0x30c26f[_0x1e5b2b(0x9b)],'createdAt':_0x30c26f['createdAt']};}async[a57_0x32048a(0x9a)](){const _0x5a5cf0=a57_0x32048a,_0x429d37=await database_1[_0x5a5cf0(0x8b)][_0x5a5cf0(0xb1)]['findMany']({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x5a5cf0(0xbf)}});return _0x429d37['map'](_0x44865c=>({'id':_0x44865c['id'],'fullName':_0x44865c[_0x5a5cf0(0xab)],'username':_0x44865c[_0x5a5cf0(0xb0)],'telegramId':_0x44865c[_0x5a5cf0(0x97)],'merchantUrl':_0x44865c['shopUrl'],'gateways':_0x44865c[_0x5a5cf0(0xaa)]?JSON['parse'](_0x44865c[_0x5a5cf0(0xaa)]):null,'gatewaySettings':_0x44865c[_0x5a5cf0(0xa5)]?JSON[_0x5a5cf0(0xbb)](_0x44865c['gatewaySettings']):null,'publicKey':_0x44865c[_0x5a5cf0(0xa2)],'wallets':{'usdtPolygonWallet':_0x44865c['usdtPolygonWallet'],'usdtTrcWallet':_0x44865c['usdtTrcWallet'],'usdtErcWallet':_0x44865c[_0x5a5cf0(0xb9)],'usdcPolygonWallet':_0x44865c[_0x5a5cf0(0xbd)]},'status':_0x44865c[_0x5a5cf0(0x9b)],'createdAt':_0x44865c[_0x5a5cf0(0xa7)]}));}async[a57_0x32048a(0x90)](_0x4c2aa5){const _0x279075=a57_0x32048a,_0x218da1=await database_1[_0x279075(0x8b)]['shop'][_0x279075(0x8e)]({'where':{'id':_0x4c2aa5},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x218da1)return null;return{'id':_0x218da1['id'],'fullName':_0x218da1[_0x279075(0xab)],'username':_0x218da1[_0x279075(0xb0)],'telegramId':_0x218da1[_0x279075(0x97)],'merchantUrl':_0x218da1[_0x279075(0xb8)],'gateways':_0x218da1[_0x279075(0xaa)]?JSON['parse'](_0x218da1[_0x279075(0xaa)]):null,'gatewaySettings':_0x218da1['gatewaySettings']?JSON[_0x279075(0xbb)](_0x218da1[_0x279075(0xa5)]):null,'publicKey':_0x218da1[_0x279075(0xa2)],'wallets':{'usdtPolygonWallet':_0x218da1['usdtPolygonWallet'],'usdtTrcWallet':_0x218da1[_0x279075(0x92)],'usdtErcWallet':_0x218da1[_0x279075(0xb9)],'usdcPolygonWallet':_0x218da1[_0x279075(0xbd)]},'status':_0x218da1[_0x279075(0x9b)],'createdAt':_0x218da1['createdAt']};}async[a57_0x32048a(0xa8)](_0x258379,_0x50d0ea){const _0x245d2b=a57_0x32048a,_0xe821b2={..._0x50d0ea};_0x50d0ea['password']&&(_0xe821b2['password']=await bcryptjs_1[_0x245d2b(0x8b)][_0x245d2b(0xaf)](_0x50d0ea[_0x245d2b(0xba)],0xc));_0x50d0ea[_0x245d2b(0x93)]&&(_0xe821b2['name']=_0x50d0ea['fullName'],delete _0xe821b2[_0x245d2b(0x93)]);_0x50d0ea[_0x245d2b(0xa3)]&&(_0xe821b2[_0x245d2b(0x97)]=_0x50d0ea[_0x245d2b(0xa3)],delete _0xe821b2['telegramId']);_0x50d0ea[_0x245d2b(0xad)]&&(_0xe821b2[_0x245d2b(0xb8)]=_0x50d0ea['merchantUrl'],delete _0xe821b2[_0x245d2b(0xad)]);_0x50d0ea[_0x245d2b(0xb7)]&&(_0xe821b2[_0x245d2b(0xaa)]=JSON[_0x245d2b(0x99)](_0x50d0ea[_0x245d2b(0xb7)]),delete _0xe821b2['gateways']);_0x50d0ea[_0x245d2b(0xa5)]&&(_0xe821b2['gatewaySettings']=JSON['stringify'](_0x50d0ea[_0x245d2b(0xa5)]),delete _0xe821b2['gatewaySettings']);_0x50d0ea[_0x245d2b(0xb4)]&&(_0x50d0ea['wallets'][_0x245d2b(0xb3)]!==undefined&&(_0xe821b2[_0x245d2b(0xb3)]=_0x50d0ea['wallets'][_0x245d2b(0xb3)]||null),_0x50d0ea['wallets'][_0x245d2b(0x92)]!==undefined&&(_0xe821b2[_0x245d2b(0x92)]=_0x50d0ea[_0x245d2b(0xb4)][_0x245d2b(0x92)]||null),_0x50d0ea[_0x245d2b(0xb4)][_0x245d2b(0xb9)]!==undefined&&(_0xe821b2[_0x245d2b(0xb9)]=_0x50d0ea['wallets']['usdtErcWallet']||null),_0x50d0ea['wallets'][_0x245d2b(0xbd)]!==undefined&&(_0xe821b2[_0x245d2b(0xbd)]=_0x50d0ea[_0x245d2b(0xb4)][_0x245d2b(0xbd)]||null),delete _0xe821b2[_0x245d2b(0xb4)]);const _0x411d89=await database_1[_0x245d2b(0x8b)][_0x245d2b(0xb1)][_0x245d2b(0xbe)]({'where':{'id':_0x258379},'data':_0xe821b2,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x411d89['id'],'fullName':_0x411d89[_0x245d2b(0xab)],'username':_0x411d89[_0x245d2b(0xb0)],'telegramId':_0x411d89['telegram'],'merchantUrl':_0x411d89['shopUrl'],'gateways':_0x411d89[_0x245d2b(0xaa)]?JSON['parse'](_0x411d89[_0x245d2b(0xaa)]):null,'gatewaySettings':_0x411d89['gatewaySettings']?JSON[_0x245d2b(0xbb)](_0x411d89[_0x245d2b(0xa5)]):null,'publicKey':_0x411d89[_0x245d2b(0xa2)],'wallets':{'usdtPolygonWallet':_0x411d89['usdtPolygonWallet'],'usdtTrcWallet':_0x411d89[_0x245d2b(0x92)],'usdtErcWallet':_0x411d89['usdtErcWallet'],'usdcPolygonWallet':_0x411d89[_0x245d2b(0xbd)]},'status':_0x411d89['status'],'createdAt':_0x411d89['createdAt']};}async[a57_0x32048a(0x89)](_0x5ef8f6){const _0xb49f14=a57_0x32048a;await database_1['default'][_0xb49f14(0xb1)][_0xb49f14(0x88)]({'where':{'id':_0x5ef8f6}});}}function a57_0x5ef8(){const _0x25a869=['default','bcryptjs','486942xKlWBZ','findUnique','Telegram\x20username\x20already\x20exists','getUserById','1250616csRxmA','usdtTrcWallet','fullName','528573FfgZwT','../config/database','ACTIVE','telegram','3dxwGaf','stringify','getAllUsers','status','22LDSgIX','78WzdCFs','8TtYFno','sk_','generateApiKeys','UserService','publicKey','telegramId','hex','gatewaySettings','7LjtdnL','createdAt','updateUser','5HeGDIE','paymentGateways','name','3048525veJpNm','merchantUrl','pk_','hash','username','shop','75226kiPSks','usdtPolygonWallet','wallets','toString','1669870wJOwWa','gateways','shopUrl','usdtErcWallet','password','parse','__esModule','usdcPolygonWallet','update','desc','randomBytes','delete','deleteUser','2262824NlKUXw'];a57_0x5ef8=function(){return _0x25a869;};return a57_0x5ef8();}exports[a57_0x32048a(0xa1)]=UserService;