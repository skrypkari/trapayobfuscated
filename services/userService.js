'use strict';const a61_0x23f4aa=a61_0x2fc6;(function(_0x4e9db6,_0x228e75){const _0x229bb8=a61_0x2fc6,_0x24386b=_0x4e9db6();while(!![]){try{const _0x2fc63d=-parseInt(_0x229bb8(0xf2))/0x1*(-parseInt(_0x229bb8(0xf9))/0x2)+parseInt(_0x229bb8(0xfc))/0x3+-parseInt(_0x229bb8(0x100))/0x4*(parseInt(_0x229bb8(0xfa))/0x5)+-parseInt(_0x229bb8(0x107))/0x6+parseInt(_0x229bb8(0xea))/0x7*(parseInt(_0x229bb8(0x113))/0x8)+parseInt(_0x229bb8(0x110))/0x9*(-parseInt(_0x229bb8(0xfb))/0xa)+parseInt(_0x229bb8(0xde))/0xb*(parseInt(_0x229bb8(0xec))/0xc);if(_0x2fc63d===_0x228e75)break;else _0x24386b['push'](_0x24386b['shift']());}catch(_0x84327){_0x24386b['push'](_0x24386b['shift']());}}}(a61_0x3a66,0x9d3c0));function a61_0x2fc6(_0x20713d,_0x3fb272){const _0x3a66b5=a61_0x3a66();return a61_0x2fc6=function(_0x2fc6e0,_0x4c5d13){_0x2fc6e0=_0x2fc6e0-0xdc;let _0x4eee48=_0x3a66b5[_0x2fc6e0];return _0x4eee48;},a61_0x2fc6(_0x20713d,_0x3fb272);}var __importDefault=this&&this[a61_0x23f4aa(0x111)]||function(_0x5c4483){const _0x1336d6=a61_0x23f4aa;return _0x5c4483&&_0x5c4483[_0x1336d6(0xe1)]?_0x5c4483:{'default':_0x5c4483};};Object[a61_0x23f4aa(0xf8)](exports,a61_0x23f4aa(0xe1),{'value':!![]}),exports[a61_0x23f4aa(0xf1)]=void 0x0;const bcryptjs_1=__importDefault(require(a61_0x23f4aa(0x108))),crypto_1=__importDefault(require(a61_0x23f4aa(0x10d))),database_1=__importDefault(require(a61_0x23f4aa(0xe4)));function a61_0x3a66(){const _0x232b4b=['findUnique','createUser','telegram','gateways','UserService','165qrLaJu','generateApiKeys','username','hash','map','randomBytes','defineProperty','6488HtuMBH','121530ZZAmet','5770wCireR','707001kIkcNR','delete','usdcPolygonWallet','getUserById','60XqjBHT','createdAt','publicKey','default','pk_','shop','stringify','3895596ECOMSJ','bcryptjs','hex','Telegram\x20username\x20already\x20exists','merchantUrl','wallets','crypto','telegramId','gatewaySettings','17928zokzBw','__importDefault','usdtPolygonWallet','10053096FaPEmo','parse','name','8734IGvQsk','Username\x20already\x20exists','paymentGateways','__esModule','deleteUser','desc','../config/database','toString','sk_','shopUrl','usdtErcWallet','usdtTrcWallet','7HEbpXL','fullName','11784jogbYW'];a61_0x3a66=function(){return _0x232b4b;};return a61_0x3a66();}class UserService{['generateApiKeys'](){const _0xc9d58a=a61_0x23f4aa,_0x4eb1b1=_0xc9d58a(0x104)+crypto_1[_0xc9d58a(0x103)][_0xc9d58a(0xf7)](0x20)[_0xc9d58a(0xe5)](_0xc9d58a(0x109)),_0x3b11b0=_0xc9d58a(0xe6)+crypto_1[_0xc9d58a(0x103)][_0xc9d58a(0xf7)](0x20)[_0xc9d58a(0xe5)](_0xc9d58a(0x109));return{'publicKey':_0x4eb1b1,'secretKey':_0x3b11b0};}async[a61_0x23f4aa(0xee)](_0x5285f9){const _0x182f1e=a61_0x23f4aa,{fullName:_0x3cb58b,username:_0x5b7e41,password:_0x288de9,telegramId:_0x1680d2,merchantUrl:_0x21b2cb,gateways:_0x53268f,gatewaySettings:_0x4d2fb6,wallets:_0x3b4717}=_0x5285f9,_0x59182c=await database_1[_0x182f1e(0x103)][_0x182f1e(0x105)][_0x182f1e(0xed)]({'where':{'username':_0x5b7e41}});if(_0x59182c)throw new Error(_0x182f1e(0xdf));if(_0x1680d2){const _0x4192cb=await database_1['default'][_0x182f1e(0x105)][_0x182f1e(0xed)]({'where':{'telegram':_0x1680d2}});if(_0x4192cb)throw new Error(_0x182f1e(0x10a));}const _0x19ea72=await bcryptjs_1['default'][_0x182f1e(0xf5)](_0x288de9,0xc),{publicKey:_0x4e8403,secretKey:_0x533268}=this[_0x182f1e(0xf3)](),_0x18c116=await database_1[_0x182f1e(0x103)][_0x182f1e(0x105)]['create']({'data':{'name':_0x3cb58b,'username':_0x5b7e41,'password':_0x19ea72,'telegram':_0x1680d2,'shopUrl':_0x21b2cb,'paymentGateways':_0x53268f?JSON['stringify'](_0x53268f):null,'gatewaySettings':_0x4d2fb6?JSON[_0x182f1e(0x106)](_0x4d2fb6):null,'usdtPolygonWallet':_0x3b4717?.['usdtPolygonWallet']||null,'usdtTrcWallet':_0x3b4717?.[_0x182f1e(0xe9)]||null,'usdtErcWallet':_0x3b4717?.[_0x182f1e(0xe8)]||null,'usdcPolygonWallet':_0x3b4717?.[_0x182f1e(0xfe)]||null,'publicKey':_0x4e8403,'secretKey':_0x533268,'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x18c116['id'],'fullName':_0x18c116[_0x182f1e(0xdd)],'username':_0x18c116[_0x182f1e(0xf4)],'telegramId':_0x18c116[_0x182f1e(0xef)],'merchantUrl':_0x18c116[_0x182f1e(0xe7)],'gateways':_0x18c116[_0x182f1e(0xe0)]?JSON['parse'](_0x18c116[_0x182f1e(0xe0)]):null,'gatewaySettings':_0x18c116[_0x182f1e(0x10f)]?JSON['parse'](_0x18c116['gatewaySettings']):null,'publicKey':_0x18c116[_0x182f1e(0x102)],'wallets':{'usdtPolygonWallet':_0x18c116[_0x182f1e(0x112)],'usdtTrcWallet':_0x18c116[_0x182f1e(0xe9)],'usdtErcWallet':_0x18c116[_0x182f1e(0xe8)],'usdcPolygonWallet':_0x18c116[_0x182f1e(0xfe)]},'status':_0x18c116['status'],'createdAt':_0x18c116[_0x182f1e(0x101)]};}async['getAllUsers'](){const _0x23bb2e=a61_0x23f4aa,_0x10eb66=await database_1['default'][_0x23bb2e(0x105)]['findMany']({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x23bb2e(0xe3)}});return _0x10eb66[_0x23bb2e(0xf6)](_0x519b14=>({'id':_0x519b14['id'],'fullName':_0x519b14['name'],'username':_0x519b14[_0x23bb2e(0xf4)],'telegramId':_0x519b14[_0x23bb2e(0xef)],'merchantUrl':_0x519b14[_0x23bb2e(0xe7)],'gateways':_0x519b14[_0x23bb2e(0xe0)]?JSON['parse'](_0x519b14['paymentGateways']):null,'gatewaySettings':_0x519b14[_0x23bb2e(0x10f)]?JSON[_0x23bb2e(0xdc)](_0x519b14[_0x23bb2e(0x10f)]):null,'publicKey':_0x519b14[_0x23bb2e(0x102)],'wallets':{'usdtPolygonWallet':_0x519b14[_0x23bb2e(0x112)],'usdtTrcWallet':_0x519b14[_0x23bb2e(0xe9)],'usdtErcWallet':_0x519b14['usdtErcWallet'],'usdcPolygonWallet':_0x519b14[_0x23bb2e(0xfe)]},'status':_0x519b14['status'],'createdAt':_0x519b14[_0x23bb2e(0x101)]}));}async[a61_0x23f4aa(0xff)](_0x9d4e95){const _0x2bac9f=a61_0x23f4aa,_0x50aa89=await database_1['default'][_0x2bac9f(0x105)][_0x2bac9f(0xed)]({'where':{'id':_0x9d4e95},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x50aa89)return null;return{'id':_0x50aa89['id'],'fullName':_0x50aa89[_0x2bac9f(0xdd)],'username':_0x50aa89[_0x2bac9f(0xf4)],'telegramId':_0x50aa89[_0x2bac9f(0xef)],'merchantUrl':_0x50aa89['shopUrl'],'gateways':_0x50aa89[_0x2bac9f(0xe0)]?JSON[_0x2bac9f(0xdc)](_0x50aa89['paymentGateways']):null,'gatewaySettings':_0x50aa89['gatewaySettings']?JSON[_0x2bac9f(0xdc)](_0x50aa89[_0x2bac9f(0x10f)]):null,'publicKey':_0x50aa89[_0x2bac9f(0x102)],'wallets':{'usdtPolygonWallet':_0x50aa89['usdtPolygonWallet'],'usdtTrcWallet':_0x50aa89[_0x2bac9f(0xe9)],'usdtErcWallet':_0x50aa89[_0x2bac9f(0xe8)],'usdcPolygonWallet':_0x50aa89[_0x2bac9f(0xfe)]},'status':_0x50aa89['status'],'createdAt':_0x50aa89[_0x2bac9f(0x101)]};}async['updateUser'](_0x5d4464,_0x1ca1e7){const _0x3eebec=a61_0x23f4aa,_0x460aa5={..._0x1ca1e7};_0x1ca1e7['password']&&(_0x460aa5['password']=await bcryptjs_1['default'][_0x3eebec(0xf5)](_0x1ca1e7['password'],0xc));_0x1ca1e7[_0x3eebec(0xeb)]&&(_0x460aa5[_0x3eebec(0xdd)]=_0x1ca1e7['fullName'],delete _0x460aa5[_0x3eebec(0xeb)]);_0x1ca1e7[_0x3eebec(0x10e)]&&(_0x460aa5['telegram']=_0x1ca1e7[_0x3eebec(0x10e)],delete _0x460aa5['telegramId']);_0x1ca1e7[_0x3eebec(0x10b)]&&(_0x460aa5[_0x3eebec(0xe7)]=_0x1ca1e7[_0x3eebec(0x10b)],delete _0x460aa5[_0x3eebec(0x10b)]);_0x1ca1e7[_0x3eebec(0xf0)]&&(_0x460aa5[_0x3eebec(0xe0)]=JSON[_0x3eebec(0x106)](_0x1ca1e7[_0x3eebec(0xf0)]),delete _0x460aa5[_0x3eebec(0xf0)]);_0x1ca1e7[_0x3eebec(0x10f)]&&(_0x460aa5['gatewaySettings']=JSON[_0x3eebec(0x106)](_0x1ca1e7[_0x3eebec(0x10f)]),delete _0x460aa5[_0x3eebec(0x10f)]);_0x1ca1e7['wallets']&&(_0x1ca1e7[_0x3eebec(0x10c)][_0x3eebec(0x112)]!==undefined&&(_0x460aa5['usdtPolygonWallet']=_0x1ca1e7[_0x3eebec(0x10c)][_0x3eebec(0x112)]||null),_0x1ca1e7[_0x3eebec(0x10c)][_0x3eebec(0xe9)]!==undefined&&(_0x460aa5[_0x3eebec(0xe9)]=_0x1ca1e7[_0x3eebec(0x10c)][_0x3eebec(0xe9)]||null),_0x1ca1e7['wallets'][_0x3eebec(0xe8)]!==undefined&&(_0x460aa5[_0x3eebec(0xe8)]=_0x1ca1e7[_0x3eebec(0x10c)][_0x3eebec(0xe8)]||null),_0x1ca1e7[_0x3eebec(0x10c)][_0x3eebec(0xfe)]!==undefined&&(_0x460aa5[_0x3eebec(0xfe)]=_0x1ca1e7[_0x3eebec(0x10c)][_0x3eebec(0xfe)]||null),delete _0x460aa5[_0x3eebec(0x10c)]);const _0xe0f281=await database_1[_0x3eebec(0x103)][_0x3eebec(0x105)]['update']({'where':{'id':_0x5d4464},'data':_0x460aa5,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0xe0f281['id'],'fullName':_0xe0f281[_0x3eebec(0xdd)],'username':_0xe0f281[_0x3eebec(0xf4)],'telegramId':_0xe0f281[_0x3eebec(0xef)],'merchantUrl':_0xe0f281['shopUrl'],'gateways':_0xe0f281[_0x3eebec(0xe0)]?JSON['parse'](_0xe0f281[_0x3eebec(0xe0)]):null,'gatewaySettings':_0xe0f281[_0x3eebec(0x10f)]?JSON[_0x3eebec(0xdc)](_0xe0f281[_0x3eebec(0x10f)]):null,'publicKey':_0xe0f281[_0x3eebec(0x102)],'wallets':{'usdtPolygonWallet':_0xe0f281['usdtPolygonWallet'],'usdtTrcWallet':_0xe0f281[_0x3eebec(0xe9)],'usdtErcWallet':_0xe0f281[_0x3eebec(0xe8)],'usdcPolygonWallet':_0xe0f281[_0x3eebec(0xfe)]},'status':_0xe0f281['status'],'createdAt':_0xe0f281['createdAt']};}async[a61_0x23f4aa(0xe2)](_0x492155){const _0x3f3a7c=a61_0x23f4aa;await database_1[_0x3f3a7c(0x103)][_0x3f3a7c(0x105)][_0x3f3a7c(0xfd)]({'where':{'id':_0x492155}});}}exports['UserService']=UserService;