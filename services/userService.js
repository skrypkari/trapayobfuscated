'use strict';const a57_0x537140=a57_0x5816;(function(_0x3f1c7b,_0x46b85e){const _0x3a72a6=a57_0x5816,_0x5412b1=_0x3f1c7b();while(!![]){try{const _0x1269b6=-parseInt(_0x3a72a6(0x112))/0x1+-parseInt(_0x3a72a6(0x125))/0x2+-parseInt(_0x3a72a6(0x10a))/0x3+-parseInt(_0x3a72a6(0x10d))/0x4+parseInt(_0x3a72a6(0x118))/0x5*(-parseInt(_0x3a72a6(0x102))/0x6)+-parseInt(_0x3a72a6(0x120))/0x7+parseInt(_0x3a72a6(0x122))/0x8;if(_0x1269b6===_0x46b85e)break;else _0x5412b1['push'](_0x5412b1['shift']());}catch(_0xfb6fae){_0x5412b1['push'](_0x5412b1['shift']());}}}(a57_0x3c77,0x2a012));var __importDefault=this&&this[a57_0x537140(0x12a)]||function(_0x5b8fd8){const _0x10b9c1=a57_0x537140;return _0x5b8fd8&&_0x5b8fd8[_0x10b9c1(0x11a)]?_0x5b8fd8:{'default':_0x5b8fd8};};function a57_0x5816(_0x15f9b6,_0x2c9a65){const _0x3c77fc=a57_0x3c77();return a57_0x5816=function(_0x581609,_0x455a83){_0x581609=_0x581609-0x101;let _0x2a6add=_0x3c77fc[_0x581609];return _0x2a6add;},a57_0x5816(_0x15f9b6,_0x2c9a65);}Object['defineProperty'](exports,a57_0x537140(0x11a),{'value':!![]}),exports['UserService']=void 0x0;function a57_0x3c77(){const _0x356627=['Telegram\x20username\x20already\x20exists','name','crypto','create','350622RvEQat','wallets','updateUser','904412pXBhAk','default','generateApiKeys','randomBytes','publicKey','167410oXwWzW','paymentGateways','UserService','shopUrl','findMany','../config/database','494125FVtPAW','parse','__esModule','getAllUsers','username','telegram','gatewaySettings','fullName','1259846KgKgbx','usdtPolygonWallet','10140552OZmTTK','ACTIVE','hex','415008TVgWnB','usdcPolygonWallet','findUnique','Username\x20already\x20exists','shop','__importDefault','bcryptjs','pk_','deleteUser','gateways','createUser','toString','usdtTrcWallet','createdAt','update','hash','stringify','status','12IRTnBh','usdtErcWallet','password','telegramId'];a57_0x3c77=function(){return _0x356627;};return a57_0x3c77();}const bcryptjs_1=__importDefault(require(a57_0x537140(0x12b))),crypto_1=__importDefault(require(a57_0x537140(0x108))),database_1=__importDefault(require(a57_0x537140(0x117)));class UserService{[a57_0x537140(0x10f)](){const _0x366a26=a57_0x537140,_0x149c61=_0x366a26(0x12c)+crypto_1[_0x366a26(0x10e)][_0x366a26(0x110)](0x20)['toString'](_0x366a26(0x124)),_0x9cd236='sk_'+crypto_1[_0x366a26(0x10e)][_0x366a26(0x110)](0x20)[_0x366a26(0x130)](_0x366a26(0x124));return{'publicKey':_0x149c61,'secretKey':_0x9cd236};}async[a57_0x537140(0x12f)](_0x2ee8a3){const _0x3d0362=a57_0x537140,{fullName:_0x4149d4,username:_0x138113,password:_0x3fa854,telegramId:_0x42b984,merchantUrl:_0x2036e6,gateways:_0x403a5f,gatewaySettings:_0x330bd0,wallets:_0x33f0c3}=_0x2ee8a3,_0x45dbbb=await database_1['default'][_0x3d0362(0x129)]['findUnique']({'where':{'username':_0x138113}});if(_0x45dbbb)throw new Error(_0x3d0362(0x128));if(_0x42b984){const _0x54d108=await database_1[_0x3d0362(0x10e)]['shop'][_0x3d0362(0x127)]({'where':{'telegram':_0x42b984}});if(_0x54d108)throw new Error(_0x3d0362(0x106));}const _0x388302=await bcryptjs_1[_0x3d0362(0x10e)][_0x3d0362(0x134)](_0x3fa854,0xc),{publicKey:_0x31b382,secretKey:_0x23a56a}=this[_0x3d0362(0x10f)](),_0x6a8e4d=await database_1[_0x3d0362(0x10e)][_0x3d0362(0x129)][_0x3d0362(0x109)]({'data':{'name':_0x4149d4,'username':_0x138113,'password':_0x388302,'telegram':_0x42b984,'shopUrl':_0x2036e6,'paymentGateways':_0x403a5f?JSON['stringify'](_0x403a5f):null,'gatewaySettings':_0x330bd0?JSON[_0x3d0362(0x135)](_0x330bd0):null,'usdtPolygonWallet':_0x33f0c3?.[_0x3d0362(0x121)]||null,'usdtTrcWallet':_0x33f0c3?.[_0x3d0362(0x131)]||null,'usdtErcWallet':_0x33f0c3?.[_0x3d0362(0x103)]||null,'usdcPolygonWallet':_0x33f0c3?.[_0x3d0362(0x126)]||null,'publicKey':_0x31b382,'secretKey':_0x23a56a,'status':_0x3d0362(0x123)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x6a8e4d['id'],'fullName':_0x6a8e4d[_0x3d0362(0x107)],'username':_0x6a8e4d[_0x3d0362(0x11c)],'telegramId':_0x6a8e4d[_0x3d0362(0x11d)],'merchantUrl':_0x6a8e4d[_0x3d0362(0x115)],'gateways':_0x6a8e4d[_0x3d0362(0x113)]?JSON[_0x3d0362(0x119)](_0x6a8e4d[_0x3d0362(0x113)]):null,'gatewaySettings':_0x6a8e4d[_0x3d0362(0x11e)]?JSON[_0x3d0362(0x119)](_0x6a8e4d[_0x3d0362(0x11e)]):null,'publicKey':_0x6a8e4d['publicKey'],'wallets':{'usdtPolygonWallet':_0x6a8e4d['usdtPolygonWallet'],'usdtTrcWallet':_0x6a8e4d[_0x3d0362(0x131)],'usdtErcWallet':_0x6a8e4d[_0x3d0362(0x103)],'usdcPolygonWallet':_0x6a8e4d['usdcPolygonWallet']},'status':_0x6a8e4d[_0x3d0362(0x101)],'createdAt':_0x6a8e4d[_0x3d0362(0x132)]};}async[a57_0x537140(0x11b)](){const _0x4b6249=a57_0x537140,_0x24787e=await database_1[_0x4b6249(0x10e)]['shop'][_0x4b6249(0x116)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':'desc'}});return _0x24787e['map'](_0x491184=>({'id':_0x491184['id'],'fullName':_0x491184[_0x4b6249(0x107)],'username':_0x491184['username'],'telegramId':_0x491184[_0x4b6249(0x11d)],'merchantUrl':_0x491184[_0x4b6249(0x115)],'gateways':_0x491184[_0x4b6249(0x113)]?JSON['parse'](_0x491184[_0x4b6249(0x113)]):null,'gatewaySettings':_0x491184['gatewaySettings']?JSON['parse'](_0x491184[_0x4b6249(0x11e)]):null,'publicKey':_0x491184['publicKey'],'wallets':{'usdtPolygonWallet':_0x491184[_0x4b6249(0x121)],'usdtTrcWallet':_0x491184[_0x4b6249(0x131)],'usdtErcWallet':_0x491184[_0x4b6249(0x103)],'usdcPolygonWallet':_0x491184[_0x4b6249(0x126)]},'status':_0x491184['status'],'createdAt':_0x491184[_0x4b6249(0x132)]}));}async['getUserById'](_0x30747d){const _0x1f6f14=a57_0x537140,_0x329ec5=await database_1[_0x1f6f14(0x10e)]['shop'][_0x1f6f14(0x127)]({'where':{'id':_0x30747d},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x329ec5)return null;return{'id':_0x329ec5['id'],'fullName':_0x329ec5[_0x1f6f14(0x107)],'username':_0x329ec5[_0x1f6f14(0x11c)],'telegramId':_0x329ec5['telegram'],'merchantUrl':_0x329ec5[_0x1f6f14(0x115)],'gateways':_0x329ec5['paymentGateways']?JSON[_0x1f6f14(0x119)](_0x329ec5['paymentGateways']):null,'gatewaySettings':_0x329ec5[_0x1f6f14(0x11e)]?JSON[_0x1f6f14(0x119)](_0x329ec5['gatewaySettings']):null,'publicKey':_0x329ec5['publicKey'],'wallets':{'usdtPolygonWallet':_0x329ec5[_0x1f6f14(0x121)],'usdtTrcWallet':_0x329ec5['usdtTrcWallet'],'usdtErcWallet':_0x329ec5[_0x1f6f14(0x103)],'usdcPolygonWallet':_0x329ec5[_0x1f6f14(0x126)]},'status':_0x329ec5[_0x1f6f14(0x101)],'createdAt':_0x329ec5[_0x1f6f14(0x132)]};}async[a57_0x537140(0x10c)](_0x4f5052,_0x48fbde){const _0x1e7d8f=a57_0x537140,_0x29bc4e={..._0x48fbde};_0x48fbde[_0x1e7d8f(0x104)]&&(_0x29bc4e['password']=await bcryptjs_1['default'][_0x1e7d8f(0x134)](_0x48fbde[_0x1e7d8f(0x104)],0xc));_0x48fbde[_0x1e7d8f(0x11f)]&&(_0x29bc4e[_0x1e7d8f(0x107)]=_0x48fbde['fullName'],delete _0x29bc4e[_0x1e7d8f(0x11f)]);_0x48fbde[_0x1e7d8f(0x105)]&&(_0x29bc4e[_0x1e7d8f(0x11d)]=_0x48fbde[_0x1e7d8f(0x105)],delete _0x29bc4e['telegramId']);_0x48fbde['merchantUrl']&&(_0x29bc4e[_0x1e7d8f(0x115)]=_0x48fbde['merchantUrl'],delete _0x29bc4e['merchantUrl']);_0x48fbde[_0x1e7d8f(0x12e)]&&(_0x29bc4e[_0x1e7d8f(0x113)]=JSON[_0x1e7d8f(0x135)](_0x48fbde['gateways']),delete _0x29bc4e[_0x1e7d8f(0x12e)]);_0x48fbde[_0x1e7d8f(0x11e)]&&(_0x29bc4e['gatewaySettings']=JSON[_0x1e7d8f(0x135)](_0x48fbde[_0x1e7d8f(0x11e)]),delete _0x29bc4e[_0x1e7d8f(0x11e)]);_0x48fbde[_0x1e7d8f(0x10b)]&&(_0x48fbde['wallets'][_0x1e7d8f(0x121)]!==undefined&&(_0x29bc4e['usdtPolygonWallet']=_0x48fbde[_0x1e7d8f(0x10b)][_0x1e7d8f(0x121)]||null),_0x48fbde[_0x1e7d8f(0x10b)]['usdtTrcWallet']!==undefined&&(_0x29bc4e[_0x1e7d8f(0x131)]=_0x48fbde['wallets']['usdtTrcWallet']||null),_0x48fbde['wallets'][_0x1e7d8f(0x103)]!==undefined&&(_0x29bc4e[_0x1e7d8f(0x103)]=_0x48fbde['wallets'][_0x1e7d8f(0x103)]||null),_0x48fbde[_0x1e7d8f(0x10b)][_0x1e7d8f(0x126)]!==undefined&&(_0x29bc4e['usdcPolygonWallet']=_0x48fbde[_0x1e7d8f(0x10b)][_0x1e7d8f(0x126)]||null),delete _0x29bc4e[_0x1e7d8f(0x10b)]);const _0x291cf5=await database_1['default'][_0x1e7d8f(0x129)][_0x1e7d8f(0x133)]({'where':{'id':_0x4f5052},'data':_0x29bc4e,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x291cf5['id'],'fullName':_0x291cf5[_0x1e7d8f(0x107)],'username':_0x291cf5[_0x1e7d8f(0x11c)],'telegramId':_0x291cf5[_0x1e7d8f(0x11d)],'merchantUrl':_0x291cf5[_0x1e7d8f(0x115)],'gateways':_0x291cf5[_0x1e7d8f(0x113)]?JSON['parse'](_0x291cf5['paymentGateways']):null,'gatewaySettings':_0x291cf5[_0x1e7d8f(0x11e)]?JSON[_0x1e7d8f(0x119)](_0x291cf5[_0x1e7d8f(0x11e)]):null,'publicKey':_0x291cf5[_0x1e7d8f(0x111)],'wallets':{'usdtPolygonWallet':_0x291cf5[_0x1e7d8f(0x121)],'usdtTrcWallet':_0x291cf5['usdtTrcWallet'],'usdtErcWallet':_0x291cf5[_0x1e7d8f(0x103)],'usdcPolygonWallet':_0x291cf5[_0x1e7d8f(0x126)]},'status':_0x291cf5['status'],'createdAt':_0x291cf5[_0x1e7d8f(0x132)]};}async[a57_0x537140(0x12d)](_0x4b0b73){const _0x4f7958=a57_0x537140;await database_1[_0x4f7958(0x10e)][_0x4f7958(0x129)]['delete']({'where':{'id':_0x4b0b73}});}}exports[a57_0x537140(0x114)]=UserService;