'use strict';const a57_0x4bbd01=a57_0x28ca;(function(_0x1e2be7,_0x5f209f){const _0x2fbed6=a57_0x28ca,_0x30837b=_0x1e2be7();while(!![]){try{const _0x5f312d=-parseInt(_0x2fbed6(0x1a9))/0x1*(parseInt(_0x2fbed6(0x1a3))/0x2)+-parseInt(_0x2fbed6(0x1a6))/0x3+parseInt(_0x2fbed6(0x1b5))/0x4+-parseInt(_0x2fbed6(0x1a5))/0x5*(-parseInt(_0x2fbed6(0x1ce))/0x6)+parseInt(_0x2fbed6(0x1b6))/0x7*(-parseInt(_0x2fbed6(0x1a2))/0x8)+parseInt(_0x2fbed6(0x1ae))/0x9+-parseInt(_0x2fbed6(0x1c1))/0xa*(-parseInt(_0x2fbed6(0x1ca))/0xb);if(_0x5f312d===_0x5f209f)break;else _0x30837b['push'](_0x30837b['shift']());}catch(_0x41f83d){_0x30837b['push'](_0x30837b['shift']());}}}(a57_0x2120,0xf196e));var __importDefault=this&&this['__importDefault']||function(_0x545a65){return _0x545a65&&_0x545a65['__esModule']?_0x545a65:{'default':_0x545a65};};Object[a57_0x4bbd01(0x1b2)](exports,'__esModule',{'value':!![]}),exports['UserService']=void 0x0;const bcryptjs_1=__importDefault(require(a57_0x4bbd01(0x1bd))),crypto_1=__importDefault(require(a57_0x4bbd01(0x1be))),database_1=__importDefault(require(a57_0x4bbd01(0x1d2)));function a57_0x28ca(_0x119f8e,_0x471fc3){const _0x21200d=a57_0x2120();return a57_0x28ca=function(_0x28ca8c,_0x41c5ab){_0x28ca8c=_0x28ca8c-0x1a0;let _0x4842fc=_0x21200d[_0x28ca8c];return _0x4842fc;},a57_0x28ca(_0x119f8e,_0x471fc3);}class UserService{[a57_0x4bbd01(0x1b1)](){const _0x42c042=a57_0x4bbd01,_0x2359dc=_0x42c042(0x1b0)+crypto_1[_0x42c042(0x1c7)]['randomBytes'](0x20)[_0x42c042(0x1d0)](_0x42c042(0x1b7)),_0x58275d=_0x42c042(0x1d5)+crypto_1[_0x42c042(0x1c7)][_0x42c042(0x1a7)](0x20)['toString'](_0x42c042(0x1b7));return{'publicKey':_0x2359dc,'secretKey':_0x58275d};}async['createUser'](_0xefc4c0){const _0x11a9de=a57_0x4bbd01,{fullName:_0x30c50b,username:_0x345409,password:_0x42eb43,telegramId:_0x522fef,merchantUrl:_0x39cd7e,gateways:_0x12b44a,gatewaySettings:_0x2af676,wallets:_0x2484d8}=_0xefc4c0,_0x4d7240=await database_1[_0x11a9de(0x1c7)][_0x11a9de(0x1b8)][_0x11a9de(0x1aa)]({'where':{'username':_0x345409}});if(_0x4d7240)throw new Error(_0x11a9de(0x1c0));if(_0x522fef){const _0x1bcd24=await database_1[_0x11a9de(0x1c7)]['shop'][_0x11a9de(0x1aa)]({'where':{'telegram':_0x522fef}});if(_0x1bcd24)throw new Error(_0x11a9de(0x1c8));}const _0x178116=await bcryptjs_1[_0x11a9de(0x1c7)][_0x11a9de(0x1c4)](_0x42eb43,0xc),{publicKey:_0x4c8fd8,secretKey:_0x55209a}=this['generateApiKeys'](),_0x24bd83=await database_1[_0x11a9de(0x1c7)][_0x11a9de(0x1b8)][_0x11a9de(0x1c3)]({'data':{'name':_0x30c50b,'username':_0x345409,'password':_0x178116,'telegram':_0x522fef,'shopUrl':_0x39cd7e,'paymentGateways':_0x12b44a?JSON[_0x11a9de(0x1af)](_0x12b44a):null,'gatewaySettings':_0x2af676?JSON[_0x11a9de(0x1af)](_0x2af676):null,'usdtPolygonWallet':_0x2484d8?.['usdtPolygonWallet']||null,'usdtTrcWallet':_0x2484d8?.[_0x11a9de(0x1d4)]||null,'usdtErcWallet':_0x2484d8?.['usdtErcWallet']||null,'usdcPolygonWallet':_0x2484d8?.['usdcPolygonWallet']||null,'publicKey':_0x4c8fd8,'secretKey':_0x55209a,'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x24bd83['id'],'fullName':_0x24bd83[_0x11a9de(0x1c5)],'username':_0x24bd83[_0x11a9de(0x1ba)],'telegramId':_0x24bd83[_0x11a9de(0x1c9)],'merchantUrl':_0x24bd83[_0x11a9de(0x1cb)],'gateways':_0x24bd83[_0x11a9de(0x1a4)]?JSON[_0x11a9de(0x1a8)](_0x24bd83[_0x11a9de(0x1a4)]):null,'gatewaySettings':_0x24bd83['gatewaySettings']?JSON[_0x11a9de(0x1a8)](_0x24bd83[_0x11a9de(0x1cf)]):null,'publicKey':_0x24bd83['publicKey'],'wallets':{'usdtPolygonWallet':_0x24bd83[_0x11a9de(0x1d3)],'usdtTrcWallet':_0x24bd83[_0x11a9de(0x1d4)],'usdtErcWallet':_0x24bd83[_0x11a9de(0x1d1)],'usdcPolygonWallet':_0x24bd83[_0x11a9de(0x1ab)]},'status':_0x24bd83[_0x11a9de(0x1a1)],'createdAt':_0x24bd83[_0x11a9de(0x1c6)]};}async[a57_0x4bbd01(0x1bb)](){const _0x3bfeb9=a57_0x4bbd01,_0x370ad6=await database_1['default'][_0x3bfeb9(0x1b8)]['findMany']({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':'desc'}});return _0x370ad6['map'](_0x570b0b=>({'id':_0x570b0b['id'],'fullName':_0x570b0b[_0x3bfeb9(0x1c5)],'username':_0x570b0b[_0x3bfeb9(0x1ba)],'telegramId':_0x570b0b[_0x3bfeb9(0x1c9)],'merchantUrl':_0x570b0b[_0x3bfeb9(0x1cb)],'gateways':_0x570b0b[_0x3bfeb9(0x1a4)]?JSON[_0x3bfeb9(0x1a8)](_0x570b0b[_0x3bfeb9(0x1a4)]):null,'gatewaySettings':_0x570b0b[_0x3bfeb9(0x1cf)]?JSON[_0x3bfeb9(0x1a8)](_0x570b0b['gatewaySettings']):null,'publicKey':_0x570b0b[_0x3bfeb9(0x1ac)],'wallets':{'usdtPolygonWallet':_0x570b0b[_0x3bfeb9(0x1d3)],'usdtTrcWallet':_0x570b0b[_0x3bfeb9(0x1d4)],'usdtErcWallet':_0x570b0b['usdtErcWallet'],'usdcPolygonWallet':_0x570b0b['usdcPolygonWallet']},'status':_0x570b0b['status'],'createdAt':_0x570b0b[_0x3bfeb9(0x1c6)]}));}async['getUserById'](_0x22f2d6){const _0x2ccb91=a57_0x4bbd01,_0x1b8153=await database_1[_0x2ccb91(0x1c7)][_0x2ccb91(0x1b8)][_0x2ccb91(0x1aa)]({'where':{'id':_0x22f2d6},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x1b8153)return null;return{'id':_0x1b8153['id'],'fullName':_0x1b8153[_0x2ccb91(0x1c5)],'username':_0x1b8153[_0x2ccb91(0x1ba)],'telegramId':_0x1b8153[_0x2ccb91(0x1c9)],'merchantUrl':_0x1b8153[_0x2ccb91(0x1cb)],'gateways':_0x1b8153[_0x2ccb91(0x1a4)]?JSON[_0x2ccb91(0x1a8)](_0x1b8153[_0x2ccb91(0x1a4)]):null,'gatewaySettings':_0x1b8153[_0x2ccb91(0x1cf)]?JSON[_0x2ccb91(0x1a8)](_0x1b8153[_0x2ccb91(0x1cf)]):null,'publicKey':_0x1b8153[_0x2ccb91(0x1ac)],'wallets':{'usdtPolygonWallet':_0x1b8153['usdtPolygonWallet'],'usdtTrcWallet':_0x1b8153[_0x2ccb91(0x1d4)],'usdtErcWallet':_0x1b8153['usdtErcWallet'],'usdcPolygonWallet':_0x1b8153[_0x2ccb91(0x1ab)]},'status':_0x1b8153[_0x2ccb91(0x1a1)],'createdAt':_0x1b8153[_0x2ccb91(0x1c6)]};}async[a57_0x4bbd01(0x1c2)](_0x554c01,_0x435a72){const _0x37879d=a57_0x4bbd01,_0xdb7b02={..._0x435a72};_0x435a72[_0x37879d(0x1ad)]&&(_0xdb7b02[_0x37879d(0x1ad)]=await bcryptjs_1[_0x37879d(0x1c7)][_0x37879d(0x1c4)](_0x435a72[_0x37879d(0x1ad)],0xc));_0x435a72[_0x37879d(0x1b4)]&&(_0xdb7b02[_0x37879d(0x1c5)]=_0x435a72['fullName'],delete _0xdb7b02[_0x37879d(0x1b4)]);_0x435a72['telegramId']&&(_0xdb7b02[_0x37879d(0x1c9)]=_0x435a72['telegramId'],delete _0xdb7b02[_0x37879d(0x1cd)]);_0x435a72[_0x37879d(0x1b3)]&&(_0xdb7b02[_0x37879d(0x1cb)]=_0x435a72[_0x37879d(0x1b3)],delete _0xdb7b02[_0x37879d(0x1b3)]);_0x435a72[_0x37879d(0x1bc)]&&(_0xdb7b02[_0x37879d(0x1a4)]=JSON['stringify'](_0x435a72[_0x37879d(0x1bc)]),delete _0xdb7b02[_0x37879d(0x1bc)]);_0x435a72[_0x37879d(0x1cf)]&&(_0xdb7b02[_0x37879d(0x1cf)]=JSON[_0x37879d(0x1af)](_0x435a72[_0x37879d(0x1cf)]),delete _0xdb7b02[_0x37879d(0x1cf)]);_0x435a72[_0x37879d(0x1cc)]&&(_0x435a72[_0x37879d(0x1cc)][_0x37879d(0x1d3)]!==undefined&&(_0xdb7b02[_0x37879d(0x1d3)]=_0x435a72[_0x37879d(0x1cc)][_0x37879d(0x1d3)]||null),_0x435a72[_0x37879d(0x1cc)][_0x37879d(0x1d4)]!==undefined&&(_0xdb7b02[_0x37879d(0x1d4)]=_0x435a72['wallets'][_0x37879d(0x1d4)]||null),_0x435a72[_0x37879d(0x1cc)]['usdtErcWallet']!==undefined&&(_0xdb7b02['usdtErcWallet']=_0x435a72[_0x37879d(0x1cc)][_0x37879d(0x1d1)]||null),_0x435a72[_0x37879d(0x1cc)][_0x37879d(0x1ab)]!==undefined&&(_0xdb7b02[_0x37879d(0x1ab)]=_0x435a72[_0x37879d(0x1cc)]['usdcPolygonWallet']||null),delete _0xdb7b02[_0x37879d(0x1cc)]);const _0x4bbe45=await database_1['default'][_0x37879d(0x1b8)][_0x37879d(0x1bf)]({'where':{'id':_0x554c01},'data':_0xdb7b02,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x4bbe45['id'],'fullName':_0x4bbe45[_0x37879d(0x1c5)],'username':_0x4bbe45['username'],'telegramId':_0x4bbe45[_0x37879d(0x1c9)],'merchantUrl':_0x4bbe45['shopUrl'],'gateways':_0x4bbe45[_0x37879d(0x1a4)]?JSON[_0x37879d(0x1a8)](_0x4bbe45[_0x37879d(0x1a4)]):null,'gatewaySettings':_0x4bbe45[_0x37879d(0x1cf)]?JSON[_0x37879d(0x1a8)](_0x4bbe45[_0x37879d(0x1cf)]):null,'publicKey':_0x4bbe45[_0x37879d(0x1ac)],'wallets':{'usdtPolygonWallet':_0x4bbe45[_0x37879d(0x1d3)],'usdtTrcWallet':_0x4bbe45[_0x37879d(0x1d4)],'usdtErcWallet':_0x4bbe45[_0x37879d(0x1d1)],'usdcPolygonWallet':_0x4bbe45[_0x37879d(0x1ab)]},'status':_0x4bbe45[_0x37879d(0x1a1)],'createdAt':_0x4bbe45[_0x37879d(0x1c6)]};}async['deleteUser'](_0x26bbb6){const _0x323c16=a57_0x4bbd01;await database_1[_0x323c16(0x1c7)][_0x323c16(0x1b8)][_0x323c16(0x1a0)]({'where':{'id':_0x26bbb6}});}}function a57_0x2120(){const _0x31aa28=['3556tDKUqT','hex','shop','UserService','username','getAllUsers','gateways','bcryptjs','crypto','update','Username\x20already\x20exists','4403140FYGPKF','updateUser','create','hash','name','createdAt','default','Telegram\x20username\x20already\x20exists','telegram','33NSNoxI','shopUrl','wallets','telegramId','537834WAdnpL','gatewaySettings','toString','usdtErcWallet','../config/database','usdtPolygonWallet','usdtTrcWallet','sk_','delete','status','3448eeprYm','2126lTJuUa','paymentGateways','10OoDvZG','4289982zgGtAk','randomBytes','parse','1367RjPUAX','findUnique','usdcPolygonWallet','publicKey','password','11933730yEaUgZ','stringify','pk_','generateApiKeys','defineProperty','merchantUrl','fullName','5061692viZvZU'];a57_0x2120=function(){return _0x31aa28;};return a57_0x2120();}exports[a57_0x4bbd01(0x1b9)]=UserService;