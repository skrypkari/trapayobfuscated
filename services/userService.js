'use strict';const a63_0x223800=a63_0x4702;(function(_0x5c0648,_0xf3beb0){const _0x577cac=a63_0x4702,_0x24fe68=_0x5c0648();while(!![]){try{const _0x53af12=-parseInt(_0x577cac(0x16a))/0x1+-parseInt(_0x577cac(0x164))/0x2+parseInt(_0x577cac(0x158))/0x3*(parseInt(_0x577cac(0x151))/0x4)+-parseInt(_0x577cac(0x14e))/0x5+-parseInt(_0x577cac(0x15a))/0x6+parseInt(_0x577cac(0x152))/0x7+parseInt(_0x577cac(0x165))/0x8;if(_0x53af12===_0xf3beb0)break;else _0x24fe68['push'](_0x24fe68['shift']());}catch(_0x33265e){_0x24fe68['push'](_0x24fe68['shift']());}}}(a63_0x5c7f,0x40026));var __importDefault=this&&this[a63_0x223800(0x149)]||function(_0x235844){return _0x235844&&_0x235844['__esModule']?_0x235844:{'default':_0x235844};};function a63_0x4702(_0xfde85f,_0x13d5c0){const _0x5c7f92=a63_0x5c7f();return a63_0x4702=function(_0x47026d,_0x42b356){_0x47026d=_0x47026d-0x140;let _0x22e186=_0x5c7f92[_0x47026d];return _0x22e186;},a63_0x4702(_0xfde85f,_0x13d5c0);}function a63_0x5c7f(){const _0x1f243b=['merchantUrl','shop','randomBytes','../config/database','createUser','gatewaySettings','parse','generateApiKeys','name','toString','update','status','__importDefault','fullName','getUserById','ACTIVE','usdtTrcWallet','979785IyvpCP','bcryptjs','usdcPolygonWallet','1506412ylFWYX','299838MJFCdG','hex','username','__esModule','gateways','paymentGateways','3mcuDJz','delete','1486590pFWdQv','findUnique','telegram','default','wallets','findMany','publicKey','stringify','usdtErcWallet','usdtPolygonWallet','757398PQnbWD','7482424Rnvwbs','getAllUsers','password','createdAt','pk_','270137grOqyc','telegramId','sk_','create','deleteUser','UserService','shopUrl'];a63_0x5c7f=function(){return _0x1f243b;};return a63_0x5c7f();}Object['defineProperty'](exports,a63_0x223800(0x155),{'value':!![]}),exports[a63_0x223800(0x16f)]=void 0x0;const bcryptjs_1=__importDefault(require(a63_0x223800(0x14f))),crypto_1=__importDefault(require('crypto')),database_1=__importDefault(require(a63_0x223800(0x140)));class UserService{['generateApiKeys'](){const _0x3d5d63=a63_0x223800,_0x2ab2e6=_0x3d5d63(0x169)+crypto_1[_0x3d5d63(0x15d)]['randomBytes'](0x20)[_0x3d5d63(0x146)](_0x3d5d63(0x153)),_0xd529a4=_0x3d5d63(0x16c)+crypto_1[_0x3d5d63(0x15d)][_0x3d5d63(0x173)](0x20)[_0x3d5d63(0x146)](_0x3d5d63(0x153));return{'publicKey':_0x2ab2e6,'secretKey':_0xd529a4};}async[a63_0x223800(0x141)](_0x1fefee){const _0x1c1218=a63_0x223800,{fullName:_0x48b40b,username:_0x4949cb,password:_0x22b7f7,telegramId:_0x51e1da,merchantUrl:_0x5eac80,gateways:_0x3794a8,gatewaySettings:_0x21d96a,wallets:_0x3d9196}=_0x1fefee,_0x12299d=await database_1[_0x1c1218(0x15d)][_0x1c1218(0x172)][_0x1c1218(0x15b)]({'where':{'username':_0x4949cb}});if(_0x12299d)throw new Error('Username\x20already\x20exists');if(_0x51e1da){const _0x2c207a=await database_1[_0x1c1218(0x15d)][_0x1c1218(0x172)][_0x1c1218(0x15b)]({'where':{'telegram':_0x51e1da}});if(_0x2c207a)throw new Error('Telegram\x20username\x20already\x20exists');}const _0x151550=await bcryptjs_1[_0x1c1218(0x15d)]['hash'](_0x22b7f7,0xc),{publicKey:_0x42781a,secretKey:_0x573b4c}=this[_0x1c1218(0x144)](),_0x269ec6=await database_1[_0x1c1218(0x15d)]['shop'][_0x1c1218(0x16d)]({'data':{'name':_0x48b40b,'username':_0x4949cb,'password':_0x151550,'telegram':_0x51e1da,'shopUrl':_0x5eac80,'paymentGateways':_0x3794a8?JSON[_0x1c1218(0x161)](_0x3794a8):null,'gatewaySettings':_0x21d96a?JSON['stringify'](_0x21d96a):null,'usdtPolygonWallet':_0x3d9196?.[_0x1c1218(0x163)]||null,'usdtTrcWallet':_0x3d9196?.['usdtTrcWallet']||null,'usdtErcWallet':_0x3d9196?.['usdtErcWallet']||null,'usdcPolygonWallet':_0x3d9196?.[_0x1c1218(0x150)]||null,'publicKey':_0x42781a,'secretKey':_0x573b4c,'status':_0x1c1218(0x14c)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x269ec6['id'],'fullName':_0x269ec6[_0x1c1218(0x145)],'username':_0x269ec6[_0x1c1218(0x154)],'telegramId':_0x269ec6['telegram'],'merchantUrl':_0x269ec6[_0x1c1218(0x170)],'gateways':_0x269ec6[_0x1c1218(0x157)]?JSON[_0x1c1218(0x143)](_0x269ec6[_0x1c1218(0x157)]):null,'gatewaySettings':_0x269ec6[_0x1c1218(0x142)]?JSON[_0x1c1218(0x143)](_0x269ec6[_0x1c1218(0x142)]):null,'publicKey':_0x269ec6[_0x1c1218(0x160)],'wallets':{'usdtPolygonWallet':_0x269ec6[_0x1c1218(0x163)],'usdtTrcWallet':_0x269ec6[_0x1c1218(0x14d)],'usdtErcWallet':_0x269ec6[_0x1c1218(0x162)],'usdcPolygonWallet':_0x269ec6[_0x1c1218(0x150)]},'status':_0x269ec6[_0x1c1218(0x148)],'createdAt':_0x269ec6['createdAt']};}async[a63_0x223800(0x166)](){const _0x8a71c8=a63_0x223800,_0x5a4cc3=await database_1['default'][_0x8a71c8(0x172)][_0x8a71c8(0x15f)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':'desc'}});return _0x5a4cc3['map'](_0xe85816=>({'id':_0xe85816['id'],'fullName':_0xe85816[_0x8a71c8(0x145)],'username':_0xe85816['username'],'telegramId':_0xe85816[_0x8a71c8(0x15c)],'merchantUrl':_0xe85816[_0x8a71c8(0x170)],'gateways':_0xe85816['paymentGateways']?JSON[_0x8a71c8(0x143)](_0xe85816['paymentGateways']):null,'gatewaySettings':_0xe85816[_0x8a71c8(0x142)]?JSON['parse'](_0xe85816[_0x8a71c8(0x142)]):null,'publicKey':_0xe85816['publicKey'],'wallets':{'usdtPolygonWallet':_0xe85816['usdtPolygonWallet'],'usdtTrcWallet':_0xe85816[_0x8a71c8(0x14d)],'usdtErcWallet':_0xe85816[_0x8a71c8(0x162)],'usdcPolygonWallet':_0xe85816[_0x8a71c8(0x150)]},'status':_0xe85816[_0x8a71c8(0x148)],'createdAt':_0xe85816[_0x8a71c8(0x168)]}));}async[a63_0x223800(0x14b)](_0xedfd34){const _0x50c49f=a63_0x223800,_0x1b9e1d=await database_1[_0x50c49f(0x15d)][_0x50c49f(0x172)][_0x50c49f(0x15b)]({'where':{'id':_0xedfd34},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x1b9e1d)return null;return{'id':_0x1b9e1d['id'],'fullName':_0x1b9e1d[_0x50c49f(0x145)],'username':_0x1b9e1d[_0x50c49f(0x154)],'telegramId':_0x1b9e1d[_0x50c49f(0x15c)],'merchantUrl':_0x1b9e1d[_0x50c49f(0x170)],'gateways':_0x1b9e1d[_0x50c49f(0x157)]?JSON[_0x50c49f(0x143)](_0x1b9e1d['paymentGateways']):null,'gatewaySettings':_0x1b9e1d[_0x50c49f(0x142)]?JSON['parse'](_0x1b9e1d[_0x50c49f(0x142)]):null,'publicKey':_0x1b9e1d[_0x50c49f(0x160)],'wallets':{'usdtPolygonWallet':_0x1b9e1d[_0x50c49f(0x163)],'usdtTrcWallet':_0x1b9e1d[_0x50c49f(0x14d)],'usdtErcWallet':_0x1b9e1d['usdtErcWallet'],'usdcPolygonWallet':_0x1b9e1d[_0x50c49f(0x150)]},'status':_0x1b9e1d['status'],'createdAt':_0x1b9e1d[_0x50c49f(0x168)]};}async['updateUser'](_0x3b5702,_0x5a6ed9){const _0x5b4dd8=a63_0x223800,_0x55d49c={..._0x5a6ed9};_0x5a6ed9[_0x5b4dd8(0x167)]&&(_0x55d49c[_0x5b4dd8(0x167)]=await bcryptjs_1[_0x5b4dd8(0x15d)]['hash'](_0x5a6ed9[_0x5b4dd8(0x167)],0xc));_0x5a6ed9[_0x5b4dd8(0x14a)]&&(_0x55d49c[_0x5b4dd8(0x145)]=_0x5a6ed9['fullName'],delete _0x55d49c[_0x5b4dd8(0x14a)]);_0x5a6ed9[_0x5b4dd8(0x16b)]&&(_0x55d49c['telegram']=_0x5a6ed9[_0x5b4dd8(0x16b)],delete _0x55d49c[_0x5b4dd8(0x16b)]);_0x5a6ed9[_0x5b4dd8(0x171)]&&(_0x55d49c['shopUrl']=_0x5a6ed9[_0x5b4dd8(0x171)],delete _0x55d49c[_0x5b4dd8(0x171)]);_0x5a6ed9[_0x5b4dd8(0x156)]&&(_0x55d49c['paymentGateways']=JSON['stringify'](_0x5a6ed9[_0x5b4dd8(0x156)]),delete _0x55d49c['gateways']);_0x5a6ed9[_0x5b4dd8(0x142)]&&(_0x55d49c[_0x5b4dd8(0x142)]=JSON[_0x5b4dd8(0x161)](_0x5a6ed9['gatewaySettings']),delete _0x55d49c[_0x5b4dd8(0x142)]);_0x5a6ed9[_0x5b4dd8(0x15e)]&&(_0x5a6ed9['wallets']['usdtPolygonWallet']!==undefined&&(_0x55d49c['usdtPolygonWallet']=_0x5a6ed9[_0x5b4dd8(0x15e)][_0x5b4dd8(0x163)]||null),_0x5a6ed9[_0x5b4dd8(0x15e)][_0x5b4dd8(0x14d)]!==undefined&&(_0x55d49c['usdtTrcWallet']=_0x5a6ed9[_0x5b4dd8(0x15e)][_0x5b4dd8(0x14d)]||null),_0x5a6ed9[_0x5b4dd8(0x15e)][_0x5b4dd8(0x162)]!==undefined&&(_0x55d49c[_0x5b4dd8(0x162)]=_0x5a6ed9[_0x5b4dd8(0x15e)][_0x5b4dd8(0x162)]||null),_0x5a6ed9[_0x5b4dd8(0x15e)][_0x5b4dd8(0x150)]!==undefined&&(_0x55d49c[_0x5b4dd8(0x150)]=_0x5a6ed9[_0x5b4dd8(0x15e)][_0x5b4dd8(0x150)]||null),delete _0x55d49c[_0x5b4dd8(0x15e)]);const _0x58fd96=await database_1[_0x5b4dd8(0x15d)][_0x5b4dd8(0x172)][_0x5b4dd8(0x147)]({'where':{'id':_0x3b5702},'data':_0x55d49c,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x58fd96['id'],'fullName':_0x58fd96['name'],'username':_0x58fd96[_0x5b4dd8(0x154)],'telegramId':_0x58fd96['telegram'],'merchantUrl':_0x58fd96[_0x5b4dd8(0x170)],'gateways':_0x58fd96[_0x5b4dd8(0x157)]?JSON[_0x5b4dd8(0x143)](_0x58fd96['paymentGateways']):null,'gatewaySettings':_0x58fd96[_0x5b4dd8(0x142)]?JSON[_0x5b4dd8(0x143)](_0x58fd96['gatewaySettings']):null,'publicKey':_0x58fd96[_0x5b4dd8(0x160)],'wallets':{'usdtPolygonWallet':_0x58fd96[_0x5b4dd8(0x163)],'usdtTrcWallet':_0x58fd96[_0x5b4dd8(0x14d)],'usdtErcWallet':_0x58fd96[_0x5b4dd8(0x162)],'usdcPolygonWallet':_0x58fd96[_0x5b4dd8(0x150)]},'status':_0x58fd96[_0x5b4dd8(0x148)],'createdAt':_0x58fd96[_0x5b4dd8(0x168)]};}async[a63_0x223800(0x16e)](_0x1e259b){const _0x337108=a63_0x223800;await database_1[_0x337108(0x15d)][_0x337108(0x172)][_0x337108(0x159)]({'where':{'id':_0x1e259b}});}}exports[a63_0x223800(0x16f)]=UserService;