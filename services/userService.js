'use strict';const a65_0x169036=a65_0x1b19;(function(_0x37944e,_0x227961){const _0x1ed674=a65_0x1b19,_0x32157a=_0x37944e();while(!![]){try{const _0x11d209=-parseInt(_0x1ed674(0x222))/0x1+parseInt(_0x1ed674(0x20f))/0x2*(parseInt(_0x1ed674(0x21d))/0x3)+parseInt(_0x1ed674(0x220))/0x4+-parseInt(_0x1ed674(0x221))/0x5+-parseInt(_0x1ed674(0x205))/0x6+-parseInt(_0x1ed674(0x213))/0x7*(parseInt(_0x1ed674(0x21e))/0x8)+-parseInt(_0x1ed674(0x20e))/0x9*(-parseInt(_0x1ed674(0x1ff))/0xa);if(_0x11d209===_0x227961)break;else _0x32157a['push'](_0x32157a['shift']());}catch(_0x35aa29){_0x32157a['push'](_0x32157a['shift']());}}}(a65_0x1f93,0x5d35f));function a65_0x1f93(){const _0x3ef845=['getUserById','status','findUnique','map','gateways','hex','sk_','username','updateUser','fullName','UserService','wallets','createdAt','paymentGateways','usdtErcWallet','telegram','password','desc','40AfzcGW','publicKey','name','usdcPolygonWallet','crypto','usdtTrcWallet','1529184GKPHfi','delete','parse','randomBytes','merchantUrl','findMany','deleteUser','create','generateApiKeys','3237714CLHxte','12YANsmr','shop','__esModule','toString','7dgBHKq','telegramId','getAllUsers','usdtPolygonWallet','shopUrl','Telegram\x20username\x20already\x20exists','__importDefault','bcryptjs','pk_','hash','289716TiwmqU','5184544ZxxYss','default','499824jbEdut','1105075MAhyoz','637634fltBQE','gatewaySettings','stringify'];a65_0x1f93=function(){return _0x3ef845;};return a65_0x1f93();}var __importDefault=this&&this[a65_0x169036(0x219)]||function(_0x32e973){const _0xe0cec2=a65_0x169036;return _0x32e973&&_0x32e973[_0xe0cec2(0x211)]?_0x32e973:{'default':_0x32e973};};Object['defineProperty'](exports,a65_0x169036(0x211),{'value':!![]}),exports['UserService']=void 0x0;function a65_0x1b19(_0x1438e4,_0x3a4d45){const _0x1f931e=a65_0x1f93();return a65_0x1b19=function(_0x1b19d2,_0x4ca223){_0x1b19d2=_0x1b19d2-0x1ee;let _0x31c807=_0x1f931e[_0x1b19d2];return _0x31c807;},a65_0x1b19(_0x1438e4,_0x3a4d45);}const bcryptjs_1=__importDefault(require(a65_0x169036(0x21a))),crypto_1=__importDefault(require(a65_0x169036(0x203))),database_1=__importDefault(require('../config/database'));class UserService{[a65_0x169036(0x20d)](){const _0x4873d2=a65_0x169036,_0x2d8dba=_0x4873d2(0x21b)+crypto_1[_0x4873d2(0x21f)]['randomBytes'](0x20)[_0x4873d2(0x212)](_0x4873d2(0x1f2)),_0x1d2841=_0x4873d2(0x1f3)+crypto_1[_0x4873d2(0x21f)][_0x4873d2(0x208)](0x20)['toString']('hex');return{'publicKey':_0x2d8dba,'secretKey':_0x1d2841};}async['createUser'](_0x5633bb){const _0x4150d5=a65_0x169036,{fullName:_0x2e83fd,username:_0x26b9b0,password:_0x235bc5,telegramId:_0x297da8,merchantUrl:_0x2c24cb,gateways:_0x1d9dbf,gatewaySettings:_0x3b0800,wallets:_0x3f6d08}=_0x5633bb,_0x57d272=await database_1['default'][_0x4150d5(0x210)][_0x4150d5(0x1ef)]({'where':{'username':_0x26b9b0}});if(_0x57d272)throw new Error('Username\x20already\x20exists');if(_0x297da8){const _0x231604=await database_1[_0x4150d5(0x21f)]['shop'][_0x4150d5(0x1ef)]({'where':{'telegram':_0x297da8}});if(_0x231604)throw new Error(_0x4150d5(0x218));}const _0x16ffd1=await bcryptjs_1[_0x4150d5(0x21f)]['hash'](_0x235bc5,0xc),{publicKey:_0x421c9a,secretKey:_0x101141}=this[_0x4150d5(0x20d)](),_0xc874a2=await database_1[_0x4150d5(0x21f)][_0x4150d5(0x210)][_0x4150d5(0x20c)]({'data':{'name':_0x2e83fd,'username':_0x26b9b0,'password':_0x16ffd1,'telegram':_0x297da8,'shopUrl':_0x2c24cb,'paymentGateways':_0x1d9dbf?JSON[_0x4150d5(0x224)](_0x1d9dbf):null,'gatewaySettings':_0x3b0800?JSON[_0x4150d5(0x224)](_0x3b0800):null,'usdtPolygonWallet':_0x3f6d08?.[_0x4150d5(0x216)]||null,'usdtTrcWallet':_0x3f6d08?.[_0x4150d5(0x204)]||null,'usdtErcWallet':_0x3f6d08?.[_0x4150d5(0x1fb)]||null,'usdcPolygonWallet':_0x3f6d08?.[_0x4150d5(0x202)]||null,'publicKey':_0x421c9a,'secretKey':_0x101141,'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0xc874a2['id'],'fullName':_0xc874a2[_0x4150d5(0x201)],'username':_0xc874a2['username'],'telegramId':_0xc874a2[_0x4150d5(0x1fc)],'merchantUrl':_0xc874a2[_0x4150d5(0x217)],'gateways':_0xc874a2[_0x4150d5(0x1fa)]?JSON['parse'](_0xc874a2[_0x4150d5(0x1fa)]):null,'gatewaySettings':_0xc874a2[_0x4150d5(0x223)]?JSON[_0x4150d5(0x207)](_0xc874a2[_0x4150d5(0x223)]):null,'publicKey':_0xc874a2[_0x4150d5(0x200)],'wallets':{'usdtPolygonWallet':_0xc874a2[_0x4150d5(0x216)],'usdtTrcWallet':_0xc874a2['usdtTrcWallet'],'usdtErcWallet':_0xc874a2[_0x4150d5(0x1fb)],'usdcPolygonWallet':_0xc874a2[_0x4150d5(0x202)]},'status':_0xc874a2[_0x4150d5(0x1ee)],'createdAt':_0xc874a2[_0x4150d5(0x1f9)]};}async[a65_0x169036(0x215)](){const _0x5edf74=a65_0x169036,_0x157ea0=await database_1[_0x5edf74(0x21f)][_0x5edf74(0x210)][_0x5edf74(0x20a)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x5edf74(0x1fe)}});return _0x157ea0[_0x5edf74(0x1f0)](_0x2976a6=>({'id':_0x2976a6['id'],'fullName':_0x2976a6[_0x5edf74(0x201)],'username':_0x2976a6[_0x5edf74(0x1f4)],'telegramId':_0x2976a6[_0x5edf74(0x1fc)],'merchantUrl':_0x2976a6[_0x5edf74(0x217)],'gateways':_0x2976a6[_0x5edf74(0x1fa)]?JSON[_0x5edf74(0x207)](_0x2976a6[_0x5edf74(0x1fa)]):null,'gatewaySettings':_0x2976a6['gatewaySettings']?JSON[_0x5edf74(0x207)](_0x2976a6[_0x5edf74(0x223)]):null,'publicKey':_0x2976a6[_0x5edf74(0x200)],'wallets':{'usdtPolygonWallet':_0x2976a6['usdtPolygonWallet'],'usdtTrcWallet':_0x2976a6[_0x5edf74(0x204)],'usdtErcWallet':_0x2976a6[_0x5edf74(0x1fb)],'usdcPolygonWallet':_0x2976a6[_0x5edf74(0x202)]},'status':_0x2976a6[_0x5edf74(0x1ee)],'createdAt':_0x2976a6[_0x5edf74(0x1f9)]}));}async[a65_0x169036(0x225)](_0x3f8231){const _0x53dcef=a65_0x169036,_0x547624=await database_1['default'][_0x53dcef(0x210)]['findUnique']({'where':{'id':_0x3f8231},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x547624)return null;return{'id':_0x547624['id'],'fullName':_0x547624[_0x53dcef(0x201)],'username':_0x547624[_0x53dcef(0x1f4)],'telegramId':_0x547624[_0x53dcef(0x1fc)],'merchantUrl':_0x547624[_0x53dcef(0x217)],'gateways':_0x547624[_0x53dcef(0x1fa)]?JSON[_0x53dcef(0x207)](_0x547624[_0x53dcef(0x1fa)]):null,'gatewaySettings':_0x547624['gatewaySettings']?JSON[_0x53dcef(0x207)](_0x547624[_0x53dcef(0x223)]):null,'publicKey':_0x547624[_0x53dcef(0x200)],'wallets':{'usdtPolygonWallet':_0x547624['usdtPolygonWallet'],'usdtTrcWallet':_0x547624[_0x53dcef(0x204)],'usdtErcWallet':_0x547624[_0x53dcef(0x1fb)],'usdcPolygonWallet':_0x547624['usdcPolygonWallet']},'status':_0x547624[_0x53dcef(0x1ee)],'createdAt':_0x547624[_0x53dcef(0x1f9)]};}async[a65_0x169036(0x1f5)](_0x45465d,_0x142634){const _0x64850=a65_0x169036,_0x30b848={..._0x142634};_0x142634[_0x64850(0x1fd)]&&(_0x30b848[_0x64850(0x1fd)]=await bcryptjs_1[_0x64850(0x21f)][_0x64850(0x21c)](_0x142634[_0x64850(0x1fd)],0xc));_0x142634[_0x64850(0x1f6)]&&(_0x30b848[_0x64850(0x201)]=_0x142634[_0x64850(0x1f6)],delete _0x30b848['fullName']);_0x142634[_0x64850(0x214)]&&(_0x30b848[_0x64850(0x1fc)]=_0x142634[_0x64850(0x214)],delete _0x30b848['telegramId']);_0x142634['merchantUrl']&&(_0x30b848[_0x64850(0x217)]=_0x142634[_0x64850(0x209)],delete _0x30b848[_0x64850(0x209)]);_0x142634[_0x64850(0x1f1)]&&(_0x30b848[_0x64850(0x1fa)]=JSON[_0x64850(0x224)](_0x142634['gateways']),delete _0x30b848[_0x64850(0x1f1)]);_0x142634[_0x64850(0x223)]&&(_0x30b848[_0x64850(0x223)]=JSON[_0x64850(0x224)](_0x142634[_0x64850(0x223)]),delete _0x30b848['gatewaySettings']);_0x142634[_0x64850(0x1f8)]&&(_0x142634['wallets'][_0x64850(0x216)]!==undefined&&(_0x30b848[_0x64850(0x216)]=_0x142634['wallets'][_0x64850(0x216)]||null),_0x142634[_0x64850(0x1f8)]['usdtTrcWallet']!==undefined&&(_0x30b848[_0x64850(0x204)]=_0x142634[_0x64850(0x1f8)][_0x64850(0x204)]||null),_0x142634['wallets'][_0x64850(0x1fb)]!==undefined&&(_0x30b848[_0x64850(0x1fb)]=_0x142634[_0x64850(0x1f8)][_0x64850(0x1fb)]||null),_0x142634['wallets'][_0x64850(0x202)]!==undefined&&(_0x30b848[_0x64850(0x202)]=_0x142634[_0x64850(0x1f8)][_0x64850(0x202)]||null),delete _0x30b848['wallets']);const _0xcd0e4b=await database_1['default']['shop']['update']({'where':{'id':_0x45465d},'data':_0x30b848,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0xcd0e4b['id'],'fullName':_0xcd0e4b[_0x64850(0x201)],'username':_0xcd0e4b[_0x64850(0x1f4)],'telegramId':_0xcd0e4b[_0x64850(0x1fc)],'merchantUrl':_0xcd0e4b['shopUrl'],'gateways':_0xcd0e4b['paymentGateways']?JSON[_0x64850(0x207)](_0xcd0e4b[_0x64850(0x1fa)]):null,'gatewaySettings':_0xcd0e4b[_0x64850(0x223)]?JSON['parse'](_0xcd0e4b[_0x64850(0x223)]):null,'publicKey':_0xcd0e4b['publicKey'],'wallets':{'usdtPolygonWallet':_0xcd0e4b[_0x64850(0x216)],'usdtTrcWallet':_0xcd0e4b[_0x64850(0x204)],'usdtErcWallet':_0xcd0e4b[_0x64850(0x1fb)],'usdcPolygonWallet':_0xcd0e4b['usdcPolygonWallet']},'status':_0xcd0e4b['status'],'createdAt':_0xcd0e4b[_0x64850(0x1f9)]};}async[a65_0x169036(0x20b)](_0x520798){const _0x565580=a65_0x169036;await database_1['default'][_0x565580(0x210)][_0x565580(0x206)]({'where':{'id':_0x520798}});}}exports[a65_0x169036(0x1f7)]=UserService;