'use strict';const a89_0x507a2e=a89_0x4e44;function a89_0x4e44(_0x3cd172,_0xd9d610){_0x3cd172=_0x3cd172-0x103;const _0x4822fd=a89_0x4822();let _0x4e44fc=_0x4822fd[_0x3cd172];return _0x4e44fc;}(function(_0xab71ad,_0x2daa39){const _0x29d478=a89_0x4e44,_0x263c5d=_0xab71ad();while(!![]){try{const _0x1e654b=-parseInt(_0x29d478(0x10d))/0x1+-parseInt(_0x29d478(0x123))/0x2+-parseInt(_0x29d478(0x122))/0x3*(parseInt(_0x29d478(0x129))/0x4)+-parseInt(_0x29d478(0x12d))/0x5+-parseInt(_0x29d478(0x130))/0x6+-parseInt(_0x29d478(0x106))/0x7+parseInt(_0x29d478(0x138))/0x8*(parseInt(_0x29d478(0x11c))/0x9);if(_0x1e654b===_0x2daa39)break;else _0x263c5d['push'](_0x263c5d['shift']());}catch(_0x18ee5a){_0x263c5d['push'](_0x263c5d['shift']());}}}(a89_0x4822,0x4e8a8));var __importDefault=this&&this[a89_0x507a2e(0x128)]||function(_0x4148bb){const _0x40618b=a89_0x507a2e;return _0x4148bb&&_0x4148bb[_0x40618b(0x12a)]?_0x4148bb:{'default':_0x4148bb};};Object[a89_0x507a2e(0x12e)](exports,a89_0x507a2e(0x12a),{'value':!![]}),exports[a89_0x507a2e(0x126)]=void 0x0;const bcryptjs_1=__importDefault(require(a89_0x507a2e(0x115))),crypto_1=__importDefault(require(a89_0x507a2e(0x11a))),database_1=__importDefault(require(a89_0x507a2e(0x10f)));function a89_0x4822(){const _0xf63986=['ACTIVE','872984xrfhxA','update','sk_','parse','findUnique','publicKey','usdcPolygonWallet','80597eVnqrh','merchantUrl','../config/database','gatewaySettings','toString','wallets','password','paymentGateways','bcryptjs','map','hash','delete','usdtPolygonWallet','crypto','desc','236241cSxgax','username','usdtErcWallet','shop','Telegram\x20username\x20already\x20exists','usdtTrcWallet','1192647PftuTp','887408uWTQfo','createdAt','hex','UserService','default','__importDefault','4jgMaFS','__esModule','randomBytes','generateApiKeys','2571350hucNyI','defineProperty','status','1146810jwzmHV','telegramId','name','getAllUsers','Username\x20already\x20exists','stringify','telegram','updateUser','632xGScvh','fullName','shopUrl'];a89_0x4822=function(){return _0xf63986;};return a89_0x4822();}class UserService{[a89_0x507a2e(0x12c)](){const _0x5a0be0=a89_0x507a2e,_0xaa3cf1='pk_'+crypto_1[_0x5a0be0(0x127)][_0x5a0be0(0x12b)](0x20)[_0x5a0be0(0x111)](_0x5a0be0(0x125)),_0x2949d6=_0x5a0be0(0x108)+crypto_1[_0x5a0be0(0x127)][_0x5a0be0(0x12b)](0x20)[_0x5a0be0(0x111)](_0x5a0be0(0x125));return{'publicKey':_0xaa3cf1,'secretKey':_0x2949d6};}async['createUser'](_0xffe73d){const _0x4f0e51=a89_0x507a2e,{fullName:_0x14464a,username:_0x5296d6,password:_0x25fc7d,telegramId:_0x163e6f,merchantUrl:_0x1168a7,gateways:_0x4ceace,gatewaySettings:_0x1adb8c,wallets:_0x4987a8}=_0xffe73d,_0x3a7cb0=await database_1['default'][_0x4f0e51(0x11f)]['findUnique']({'where':{'username':_0x5296d6}});if(_0x3a7cb0)throw new Error(_0x4f0e51(0x134));if(_0x163e6f){const _0x3b6fd7=await database_1['default'][_0x4f0e51(0x11f)][_0x4f0e51(0x10a)]({'where':{'telegram':_0x163e6f}});if(_0x3b6fd7)throw new Error(_0x4f0e51(0x120));}const _0x1cdbc3=await bcryptjs_1[_0x4f0e51(0x127)]['hash'](_0x25fc7d,0xc),{publicKey:_0x47454a,secretKey:_0x3b4162}=this['generateApiKeys'](),_0x1b2913=await database_1[_0x4f0e51(0x127)][_0x4f0e51(0x11f)]['create']({'data':{'name':_0x14464a,'username':_0x5296d6,'password':_0x1cdbc3,'telegram':_0x163e6f,'shopUrl':_0x1168a7,'paymentGateways':_0x4ceace?JSON[_0x4f0e51(0x135)](_0x4ceace):null,'gatewaySettings':_0x1adb8c?JSON[_0x4f0e51(0x135)](_0x1adb8c):null,'usdtPolygonWallet':_0x4987a8?.[_0x4f0e51(0x119)]||null,'usdtTrcWallet':_0x4987a8?.[_0x4f0e51(0x121)]||null,'usdtErcWallet':_0x4987a8?.[_0x4f0e51(0x11e)]||null,'usdcPolygonWallet':_0x4987a8?.[_0x4f0e51(0x10c)]||null,'publicKey':_0x47454a,'secretKey':_0x3b4162,'status':_0x4f0e51(0x105)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x1b2913['id'],'fullName':_0x1b2913[_0x4f0e51(0x132)],'username':_0x1b2913[_0x4f0e51(0x11d)],'telegramId':_0x1b2913['telegram'],'merchantUrl':_0x1b2913[_0x4f0e51(0x104)],'gateways':_0x1b2913[_0x4f0e51(0x114)]?JSON['parse'](_0x1b2913[_0x4f0e51(0x114)]):null,'gatewaySettings':_0x1b2913[_0x4f0e51(0x110)]?JSON[_0x4f0e51(0x109)](_0x1b2913[_0x4f0e51(0x110)]):null,'publicKey':_0x1b2913[_0x4f0e51(0x10b)],'wallets':{'usdtPolygonWallet':_0x1b2913[_0x4f0e51(0x119)],'usdtTrcWallet':_0x1b2913[_0x4f0e51(0x121)],'usdtErcWallet':_0x1b2913[_0x4f0e51(0x11e)],'usdcPolygonWallet':_0x1b2913[_0x4f0e51(0x10c)]},'status':_0x1b2913[_0x4f0e51(0x12f)],'createdAt':_0x1b2913[_0x4f0e51(0x124)]};}async[a89_0x507a2e(0x133)](){const _0x14b1a3=a89_0x507a2e,_0x52d325=await database_1[_0x14b1a3(0x127)][_0x14b1a3(0x11f)]['findMany']({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x14b1a3(0x11b)}});return _0x52d325[_0x14b1a3(0x116)](_0x1ca941=>({'id':_0x1ca941['id'],'fullName':_0x1ca941[_0x14b1a3(0x132)],'username':_0x1ca941[_0x14b1a3(0x11d)],'telegramId':_0x1ca941['telegram'],'merchantUrl':_0x1ca941['shopUrl'],'gateways':_0x1ca941['paymentGateways']?JSON[_0x14b1a3(0x109)](_0x1ca941[_0x14b1a3(0x114)]):null,'gatewaySettings':_0x1ca941[_0x14b1a3(0x110)]?JSON[_0x14b1a3(0x109)](_0x1ca941[_0x14b1a3(0x110)]):null,'publicKey':_0x1ca941[_0x14b1a3(0x10b)],'wallets':{'usdtPolygonWallet':_0x1ca941['usdtPolygonWallet'],'usdtTrcWallet':_0x1ca941['usdtTrcWallet'],'usdtErcWallet':_0x1ca941[_0x14b1a3(0x11e)],'usdcPolygonWallet':_0x1ca941[_0x14b1a3(0x10c)]},'status':_0x1ca941[_0x14b1a3(0x12f)],'createdAt':_0x1ca941[_0x14b1a3(0x124)]}));}async['getUserById'](_0x114c0d){const _0x22de70=a89_0x507a2e,_0x6069f0=await database_1['default'][_0x22de70(0x11f)][_0x22de70(0x10a)]({'where':{'id':_0x114c0d},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x6069f0)return null;return{'id':_0x6069f0['id'],'fullName':_0x6069f0['name'],'username':_0x6069f0[_0x22de70(0x11d)],'telegramId':_0x6069f0[_0x22de70(0x136)],'merchantUrl':_0x6069f0[_0x22de70(0x104)],'gateways':_0x6069f0[_0x22de70(0x114)]?JSON[_0x22de70(0x109)](_0x6069f0['paymentGateways']):null,'gatewaySettings':_0x6069f0[_0x22de70(0x110)]?JSON[_0x22de70(0x109)](_0x6069f0['gatewaySettings']):null,'publicKey':_0x6069f0[_0x22de70(0x10b)],'wallets':{'usdtPolygonWallet':_0x6069f0[_0x22de70(0x119)],'usdtTrcWallet':_0x6069f0[_0x22de70(0x121)],'usdtErcWallet':_0x6069f0[_0x22de70(0x11e)],'usdcPolygonWallet':_0x6069f0[_0x22de70(0x10c)]},'status':_0x6069f0[_0x22de70(0x12f)],'createdAt':_0x6069f0[_0x22de70(0x124)]};}async[a89_0x507a2e(0x137)](_0x17efa1,_0x5cbbca){const _0x30e2f5=a89_0x507a2e,_0x59cfa3={..._0x5cbbca};_0x5cbbca[_0x30e2f5(0x113)]&&(_0x59cfa3[_0x30e2f5(0x113)]=await bcryptjs_1[_0x30e2f5(0x127)][_0x30e2f5(0x117)](_0x5cbbca[_0x30e2f5(0x113)],0xc));_0x5cbbca[_0x30e2f5(0x103)]&&(_0x59cfa3[_0x30e2f5(0x132)]=_0x5cbbca[_0x30e2f5(0x103)],delete _0x59cfa3[_0x30e2f5(0x103)]);_0x5cbbca[_0x30e2f5(0x131)]&&(_0x59cfa3[_0x30e2f5(0x136)]=_0x5cbbca[_0x30e2f5(0x131)],delete _0x59cfa3[_0x30e2f5(0x131)]);_0x5cbbca['merchantUrl']&&(_0x59cfa3[_0x30e2f5(0x104)]=_0x5cbbca[_0x30e2f5(0x10e)],delete _0x59cfa3[_0x30e2f5(0x10e)]);_0x5cbbca['gateways']&&(_0x59cfa3[_0x30e2f5(0x114)]=JSON[_0x30e2f5(0x135)](_0x5cbbca['gateways']),delete _0x59cfa3['gateways']);_0x5cbbca[_0x30e2f5(0x110)]&&(_0x59cfa3['gatewaySettings']=JSON[_0x30e2f5(0x135)](_0x5cbbca[_0x30e2f5(0x110)]),delete _0x59cfa3['gatewaySettings']);_0x5cbbca[_0x30e2f5(0x112)]&&(_0x5cbbca[_0x30e2f5(0x112)][_0x30e2f5(0x119)]!==undefined&&(_0x59cfa3[_0x30e2f5(0x119)]=_0x5cbbca[_0x30e2f5(0x112)][_0x30e2f5(0x119)]||null),_0x5cbbca[_0x30e2f5(0x112)][_0x30e2f5(0x121)]!==undefined&&(_0x59cfa3[_0x30e2f5(0x121)]=_0x5cbbca[_0x30e2f5(0x112)][_0x30e2f5(0x121)]||null),_0x5cbbca[_0x30e2f5(0x112)][_0x30e2f5(0x11e)]!==undefined&&(_0x59cfa3[_0x30e2f5(0x11e)]=_0x5cbbca[_0x30e2f5(0x112)][_0x30e2f5(0x11e)]||null),_0x5cbbca['wallets']['usdcPolygonWallet']!==undefined&&(_0x59cfa3[_0x30e2f5(0x10c)]=_0x5cbbca['wallets'][_0x30e2f5(0x10c)]||null),delete _0x59cfa3[_0x30e2f5(0x112)]);const _0x126bf6=await database_1['default'][_0x30e2f5(0x11f)][_0x30e2f5(0x107)]({'where':{'id':_0x17efa1},'data':_0x59cfa3,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x126bf6['id'],'fullName':_0x126bf6[_0x30e2f5(0x132)],'username':_0x126bf6['username'],'telegramId':_0x126bf6[_0x30e2f5(0x136)],'merchantUrl':_0x126bf6[_0x30e2f5(0x104)],'gateways':_0x126bf6[_0x30e2f5(0x114)]?JSON[_0x30e2f5(0x109)](_0x126bf6[_0x30e2f5(0x114)]):null,'gatewaySettings':_0x126bf6[_0x30e2f5(0x110)]?JSON[_0x30e2f5(0x109)](_0x126bf6['gatewaySettings']):null,'publicKey':_0x126bf6['publicKey'],'wallets':{'usdtPolygonWallet':_0x126bf6['usdtPolygonWallet'],'usdtTrcWallet':_0x126bf6['usdtTrcWallet'],'usdtErcWallet':_0x126bf6[_0x30e2f5(0x11e)],'usdcPolygonWallet':_0x126bf6[_0x30e2f5(0x10c)]},'status':_0x126bf6[_0x30e2f5(0x12f)],'createdAt':_0x126bf6['createdAt']};}async['deleteUser'](_0x19c380){const _0x4c8e40=a89_0x507a2e;await database_1[_0x4c8e40(0x127)][_0x4c8e40(0x11f)][_0x4c8e40(0x118)]({'where':{'id':_0x19c380}});}}exports[a89_0x507a2e(0x126)]=UserService;