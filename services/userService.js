'use strict';function a56_0x4567(){const _0x21247b=['usdtErcWallet','568611lDEXDg','usdtTrcWallet','bcryptjs','telegram','createUser','deleteUser','2161dISGdv','paymentGateways','pk_','__importDefault','findUnique','telegramId','usdtPolygonWallet','hex','parse','default','usdcPolygonWallet','username','shop','defineProperty','generateApiKeys','toString','__esModule','452ceXTUt','merchantUrl','3346175jqpiQo','shopUrl','fullName','sk_','randomBytes','3795462SjHtUR','getAllUsers','gateways','Username\x20already\x20exists','publicKey','map','2900060dArfhX','createdAt','12219900zUYkPJ','104QKDyxS','wallets','name','hash','delete','create','crypto','stringify','status','470012MZEiYF','gatewaySettings','3bhvoGX','UserService','password','ACTIVE','../config/database'];a56_0x4567=function(){return _0x21247b;};return a56_0x4567();}const a56_0x9d2061=a56_0x14de;(function(_0x47b989,_0x4a2ab9){const _0x3ff2df=a56_0x14de,_0x15e22b=_0x47b989();while(!![]){try{const _0x57b8e8=-parseInt(_0x3ff2df(0x106))/0x1*(parseInt(_0x3ff2df(0xdf))/0x2)+parseInt(_0x3ff2df(0xfa))/0x3*(-parseInt(_0x3ff2df(0xf8))/0x4)+-parseInt(_0x3ff2df(0xe1))/0x5+-parseInt(_0x3ff2df(0xe6))/0x6+parseInt(_0x3ff2df(0xee))/0x7+parseInt(_0x3ff2df(0xef))/0x8*(parseInt(_0x3ff2df(0x100))/0x9)+parseInt(_0x3ff2df(0xec))/0xa;if(_0x57b8e8===_0x4a2ab9)break;else _0x15e22b['push'](_0x15e22b['shift']());}catch(_0x4f6e1a){_0x15e22b['push'](_0x15e22b['shift']());}}}(a56_0x4567,0xe7c54));var __importDefault=this&&this[a56_0x9d2061(0x109)]||function(_0x9b6274){const _0x38c0d2=a56_0x9d2061;return _0x9b6274&&_0x9b6274[_0x38c0d2(0xde)]?_0x9b6274:{'default':_0x9b6274};};Object[a56_0x9d2061(0xdb)](exports,'__esModule',{'value':!![]}),exports[a56_0x9d2061(0xfb)]=void 0x0;function a56_0x14de(_0x14e901,_0x369fa3){const _0x45676d=a56_0x4567();return a56_0x14de=function(_0x14de64,_0x4e4ff5){_0x14de64=_0x14de64-0xd2;let _0x3353e4=_0x45676d[_0x14de64];return _0x3353e4;},a56_0x14de(_0x14e901,_0x369fa3);}const bcryptjs_1=__importDefault(require(a56_0x9d2061(0x102))),crypto_1=__importDefault(require(a56_0x9d2061(0xf5))),database_1=__importDefault(require(a56_0x9d2061(0xfe)));class UserService{[a56_0x9d2061(0xdc)](){const _0x2c0a0f=a56_0x9d2061,_0x3c312a=_0x2c0a0f(0x108)+crypto_1[_0x2c0a0f(0xd7)][_0x2c0a0f(0xe5)](0x20)['toString'](_0x2c0a0f(0xd5)),_0x2d7c89=_0x2c0a0f(0xe4)+crypto_1['default']['randomBytes'](0x20)[_0x2c0a0f(0xdd)]('hex');return{'publicKey':_0x3c312a,'secretKey':_0x2d7c89};}async[a56_0x9d2061(0x104)](_0x4ef299){const _0x206feb=a56_0x9d2061,{fullName:_0x34719,username:_0x25a58b,password:_0x332a6e,telegramId:_0x2d1df7,merchantUrl:_0x3b6eb8,gateways:_0x63025a,gatewaySettings:_0x11437d,wallets:_0x408410}=_0x4ef299,_0x5d00c7=await database_1[_0x206feb(0xd7)][_0x206feb(0xda)][_0x206feb(0xd2)]({'where':{'username':_0x25a58b}});if(_0x5d00c7)throw new Error(_0x206feb(0xe9));if(_0x2d1df7){const _0x1e30bb=await database_1[_0x206feb(0xd7)][_0x206feb(0xda)][_0x206feb(0xd2)]({'where':{'telegram':_0x2d1df7}});if(_0x1e30bb)throw new Error('Telegram\x20username\x20already\x20exists');}const _0x34f5ad=await bcryptjs_1[_0x206feb(0xd7)]['hash'](_0x332a6e,0xc),{publicKey:_0x1a1463,secretKey:_0x5a3e70}=this['generateApiKeys'](),_0x5ea992=await database_1[_0x206feb(0xd7)][_0x206feb(0xda)][_0x206feb(0xf4)]({'data':{'name':_0x34719,'username':_0x25a58b,'password':_0x34f5ad,'telegram':_0x2d1df7,'shopUrl':_0x3b6eb8,'paymentGateways':_0x63025a?JSON['stringify'](_0x63025a):null,'gatewaySettings':_0x11437d?JSON[_0x206feb(0xf6)](_0x11437d):null,'usdtPolygonWallet':_0x408410?.[_0x206feb(0xd4)]||null,'usdtTrcWallet':_0x408410?.[_0x206feb(0x101)]||null,'usdtErcWallet':_0x408410?.[_0x206feb(0xff)]||null,'usdcPolygonWallet':_0x408410?.['usdcPolygonWallet']||null,'publicKey':_0x1a1463,'secretKey':_0x5a3e70,'status':_0x206feb(0xfd)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x5ea992['id'],'fullName':_0x5ea992[_0x206feb(0xf1)],'username':_0x5ea992[_0x206feb(0xd9)],'telegramId':_0x5ea992['telegram'],'merchantUrl':_0x5ea992[_0x206feb(0xe2)],'gateways':_0x5ea992[_0x206feb(0x107)]?JSON['parse'](_0x5ea992[_0x206feb(0x107)]):null,'gatewaySettings':_0x5ea992[_0x206feb(0xf9)]?JSON[_0x206feb(0xd6)](_0x5ea992[_0x206feb(0xf9)]):null,'publicKey':_0x5ea992[_0x206feb(0xea)],'wallets':{'usdtPolygonWallet':_0x5ea992[_0x206feb(0xd4)],'usdtTrcWallet':_0x5ea992[_0x206feb(0x101)],'usdtErcWallet':_0x5ea992['usdtErcWallet'],'usdcPolygonWallet':_0x5ea992['usdcPolygonWallet']},'status':_0x5ea992[_0x206feb(0xf7)],'createdAt':_0x5ea992[_0x206feb(0xed)]};}async[a56_0x9d2061(0xe7)](){const _0x268cf2=a56_0x9d2061,_0x54ada0=await database_1[_0x268cf2(0xd7)][_0x268cf2(0xda)]['findMany']({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':'desc'}});return _0x54ada0[_0x268cf2(0xeb)](_0x2333aa=>({'id':_0x2333aa['id'],'fullName':_0x2333aa['name'],'username':_0x2333aa[_0x268cf2(0xd9)],'telegramId':_0x2333aa[_0x268cf2(0x103)],'merchantUrl':_0x2333aa[_0x268cf2(0xe2)],'gateways':_0x2333aa['paymentGateways']?JSON['parse'](_0x2333aa['paymentGateways']):null,'gatewaySettings':_0x2333aa['gatewaySettings']?JSON[_0x268cf2(0xd6)](_0x2333aa[_0x268cf2(0xf9)]):null,'publicKey':_0x2333aa[_0x268cf2(0xea)],'wallets':{'usdtPolygonWallet':_0x2333aa[_0x268cf2(0xd4)],'usdtTrcWallet':_0x2333aa[_0x268cf2(0x101)],'usdtErcWallet':_0x2333aa[_0x268cf2(0xff)],'usdcPolygonWallet':_0x2333aa[_0x268cf2(0xd8)]},'status':_0x2333aa[_0x268cf2(0xf7)],'createdAt':_0x2333aa[_0x268cf2(0xed)]}));}async['getUserById'](_0xc6315c){const _0x187db4=a56_0x9d2061,_0x369824=await database_1[_0x187db4(0xd7)][_0x187db4(0xda)][_0x187db4(0xd2)]({'where':{'id':_0xc6315c},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x369824)return null;return{'id':_0x369824['id'],'fullName':_0x369824['name'],'username':_0x369824[_0x187db4(0xd9)],'telegramId':_0x369824[_0x187db4(0x103)],'merchantUrl':_0x369824[_0x187db4(0xe2)],'gateways':_0x369824[_0x187db4(0x107)]?JSON[_0x187db4(0xd6)](_0x369824[_0x187db4(0x107)]):null,'gatewaySettings':_0x369824[_0x187db4(0xf9)]?JSON[_0x187db4(0xd6)](_0x369824[_0x187db4(0xf9)]):null,'publicKey':_0x369824['publicKey'],'wallets':{'usdtPolygonWallet':_0x369824[_0x187db4(0xd4)],'usdtTrcWallet':_0x369824[_0x187db4(0x101)],'usdtErcWallet':_0x369824[_0x187db4(0xff)],'usdcPolygonWallet':_0x369824['usdcPolygonWallet']},'status':_0x369824[_0x187db4(0xf7)],'createdAt':_0x369824[_0x187db4(0xed)]};}async['updateUser'](_0xa666ec,_0x285ca9){const _0x1226de=a56_0x9d2061,_0x55d410={..._0x285ca9};_0x285ca9['password']&&(_0x55d410[_0x1226de(0xfc)]=await bcryptjs_1['default'][_0x1226de(0xf2)](_0x285ca9[_0x1226de(0xfc)],0xc));_0x285ca9[_0x1226de(0xe3)]&&(_0x55d410[_0x1226de(0xf1)]=_0x285ca9[_0x1226de(0xe3)],delete _0x55d410[_0x1226de(0xe3)]);_0x285ca9[_0x1226de(0xd3)]&&(_0x55d410[_0x1226de(0x103)]=_0x285ca9['telegramId'],delete _0x55d410[_0x1226de(0xd3)]);_0x285ca9[_0x1226de(0xe0)]&&(_0x55d410[_0x1226de(0xe2)]=_0x285ca9[_0x1226de(0xe0)],delete _0x55d410[_0x1226de(0xe0)]);_0x285ca9['gateways']&&(_0x55d410[_0x1226de(0x107)]=JSON['stringify'](_0x285ca9[_0x1226de(0xe8)]),delete _0x55d410[_0x1226de(0xe8)]);_0x285ca9['gatewaySettings']&&(_0x55d410[_0x1226de(0xf9)]=JSON[_0x1226de(0xf6)](_0x285ca9[_0x1226de(0xf9)]),delete _0x55d410[_0x1226de(0xf9)]);_0x285ca9[_0x1226de(0xf0)]&&(_0x285ca9['wallets'][_0x1226de(0xd4)]!==undefined&&(_0x55d410[_0x1226de(0xd4)]=_0x285ca9[_0x1226de(0xf0)][_0x1226de(0xd4)]||null),_0x285ca9[_0x1226de(0xf0)]['usdtTrcWallet']!==undefined&&(_0x55d410[_0x1226de(0x101)]=_0x285ca9[_0x1226de(0xf0)][_0x1226de(0x101)]||null),_0x285ca9[_0x1226de(0xf0)]['usdtErcWallet']!==undefined&&(_0x55d410[_0x1226de(0xff)]=_0x285ca9['wallets'][_0x1226de(0xff)]||null),_0x285ca9[_0x1226de(0xf0)]['usdcPolygonWallet']!==undefined&&(_0x55d410['usdcPolygonWallet']=_0x285ca9['wallets']['usdcPolygonWallet']||null),delete _0x55d410[_0x1226de(0xf0)]);const _0x48ca9b=await database_1[_0x1226de(0xd7)][_0x1226de(0xda)]['update']({'where':{'id':_0xa666ec},'data':_0x55d410,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x48ca9b['id'],'fullName':_0x48ca9b[_0x1226de(0xf1)],'username':_0x48ca9b['username'],'telegramId':_0x48ca9b['telegram'],'merchantUrl':_0x48ca9b[_0x1226de(0xe2)],'gateways':_0x48ca9b[_0x1226de(0x107)]?JSON[_0x1226de(0xd6)](_0x48ca9b['paymentGateways']):null,'gatewaySettings':_0x48ca9b['gatewaySettings']?JSON[_0x1226de(0xd6)](_0x48ca9b[_0x1226de(0xf9)]):null,'publicKey':_0x48ca9b[_0x1226de(0xea)],'wallets':{'usdtPolygonWallet':_0x48ca9b['usdtPolygonWallet'],'usdtTrcWallet':_0x48ca9b[_0x1226de(0x101)],'usdtErcWallet':_0x48ca9b[_0x1226de(0xff)],'usdcPolygonWallet':_0x48ca9b[_0x1226de(0xd8)]},'status':_0x48ca9b[_0x1226de(0xf7)],'createdAt':_0x48ca9b['createdAt']};}async[a56_0x9d2061(0x105)](_0xc1ac23){const _0x8aacaf=a56_0x9d2061;await database_1[_0x8aacaf(0xd7)][_0x8aacaf(0xda)][_0x8aacaf(0xf3)]({'where':{'id':_0xc1ac23}});}}exports['UserService']=UserService;