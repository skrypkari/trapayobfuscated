'use strict';const a57_0x55c3e4=a57_0x3b80;(function(_0x2aca26,_0x448534){const _0x507a08=a57_0x3b80,_0x2a1a82=_0x2aca26();while(!![]){try{const _0x266130=-parseInt(_0x507a08(0x8b))/0x1+-parseInt(_0x507a08(0xb5))/0x2*(parseInt(_0x507a08(0xb2))/0x3)+-parseInt(_0x507a08(0x97))/0x4+parseInt(_0x507a08(0xa9))/0x5+-parseInt(_0x507a08(0xb4))/0x6+parseInt(_0x507a08(0x8d))/0x7+parseInt(_0x507a08(0x99))/0x8;if(_0x266130===_0x448534)break;else _0x2a1a82['push'](_0x2a1a82['shift']());}catch(_0xe10848){_0x2a1a82['push'](_0x2a1a82['shift']());}}}(a57_0x5867,0x2d4b1));function a57_0x3b80(_0x51d9f1,_0x55fe65){const _0x58677e=a57_0x5867();return a57_0x3b80=function(_0x3b80cf,_0x393ebb){_0x3b80cf=_0x3b80cf-0x85;let _0x593095=_0x58677e[_0x3b80cf];return _0x593095;},a57_0x3b80(_0x51d9f1,_0x55fe65);}function a57_0x5867(){const _0x490c70=['__esModule','pk_','sk_','usdcPolygonWallet','shopUrl','defineProperty','generateApiKeys','findMany','update','gateways','stringify','483120IQIWip','toString','name','createdAt','desc','shop','UserService','__importDefault','default','6mSPlHC','hash','40314mCDahO','121330wEQsQS','publicKey','usdtTrcWallet','status','map','usdtErcWallet','username','crypto','parse','bcryptjs','password','findUnique','65531SpRPjl','createUser','2084684veqnPa','getAllUsers','telegramId','wallets','fullName','usdtPolygonWallet','Telegram\x20username\x20already\x20exists','merchantUrl','gatewaySettings','paymentGateways','652172FTabCA','ACTIVE','1181664YQKBhY','telegram','hex','create','randomBytes'];a57_0x5867=function(){return _0x490c70;};return a57_0x5867();}var __importDefault=this&&this[a57_0x55c3e4(0xb0)]||function(_0xf0f04){const _0x5b80c6=a57_0x55c3e4;return _0xf0f04&&_0xf0f04[_0x5b80c6(0x9e)]?_0xf0f04:{'default':_0xf0f04};};Object[a57_0x55c3e4(0xa3)](exports,a57_0x55c3e4(0x9e),{'value':!![]}),exports[a57_0x55c3e4(0xaf)]=void 0x0;const bcryptjs_1=__importDefault(require(a57_0x55c3e4(0x88))),crypto_1=__importDefault(require(a57_0x55c3e4(0x86))),database_1=__importDefault(require('../config/database'));class UserService{[a57_0x55c3e4(0xa4)](){const _0x1707fe=a57_0x55c3e4,_0x3b5d89=_0x1707fe(0x9f)+crypto_1[_0x1707fe(0xb1)][_0x1707fe(0x9d)](0x20)[_0x1707fe(0xaa)](_0x1707fe(0x9b)),_0x37de16=_0x1707fe(0xa0)+crypto_1[_0x1707fe(0xb1)]['randomBytes'](0x20)[_0x1707fe(0xaa)]('hex');return{'publicKey':_0x3b5d89,'secretKey':_0x37de16};}async[a57_0x55c3e4(0x8c)](_0x585700){const _0x1041dc=a57_0x55c3e4,{fullName:_0x306dc1,username:_0x3e217d,password:_0x3e064f,telegramId:_0x1396c7,merchantUrl:_0x449dce,gateways:_0x4bd424,gatewaySettings:_0x59d98e,wallets:_0x21ef83}=_0x585700,_0xab5ff5=await database_1['default'][_0x1041dc(0xae)][_0x1041dc(0x8a)]({'where':{'username':_0x3e217d}});if(_0xab5ff5)throw new Error('Username\x20already\x20exists');if(_0x1396c7){const _0x3b7045=await database_1[_0x1041dc(0xb1)][_0x1041dc(0xae)][_0x1041dc(0x8a)]({'where':{'telegram':_0x1396c7}});if(_0x3b7045)throw new Error(_0x1041dc(0x93));}const _0x4f6e1c=await bcryptjs_1['default'][_0x1041dc(0xb3)](_0x3e064f,0xc),{publicKey:_0x4ba2df,secretKey:_0x59e5a7}=this['generateApiKeys'](),_0x452fb8=await database_1[_0x1041dc(0xb1)]['shop'][_0x1041dc(0x9c)]({'data':{'name':_0x306dc1,'username':_0x3e217d,'password':_0x4f6e1c,'telegram':_0x1396c7,'shopUrl':_0x449dce,'paymentGateways':_0x4bd424?JSON[_0x1041dc(0xa8)](_0x4bd424):null,'gatewaySettings':_0x59d98e?JSON['stringify'](_0x59d98e):null,'usdtPolygonWallet':_0x21ef83?.[_0x1041dc(0x92)]||null,'usdtTrcWallet':_0x21ef83?.[_0x1041dc(0xb7)]||null,'usdtErcWallet':_0x21ef83?.[_0x1041dc(0xba)]||null,'usdcPolygonWallet':_0x21ef83?.[_0x1041dc(0xa1)]||null,'publicKey':_0x4ba2df,'secretKey':_0x59e5a7,'status':_0x1041dc(0x98)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x452fb8['id'],'fullName':_0x452fb8[_0x1041dc(0xab)],'username':_0x452fb8[_0x1041dc(0x85)],'telegramId':_0x452fb8[_0x1041dc(0x9a)],'merchantUrl':_0x452fb8[_0x1041dc(0xa2)],'gateways':_0x452fb8[_0x1041dc(0x96)]?JSON[_0x1041dc(0x87)](_0x452fb8[_0x1041dc(0x96)]):null,'gatewaySettings':_0x452fb8['gatewaySettings']?JSON[_0x1041dc(0x87)](_0x452fb8[_0x1041dc(0x95)]):null,'publicKey':_0x452fb8[_0x1041dc(0xb6)],'wallets':{'usdtPolygonWallet':_0x452fb8['usdtPolygonWallet'],'usdtTrcWallet':_0x452fb8[_0x1041dc(0xb7)],'usdtErcWallet':_0x452fb8[_0x1041dc(0xba)],'usdcPolygonWallet':_0x452fb8[_0x1041dc(0xa1)]},'status':_0x452fb8[_0x1041dc(0xb8)],'createdAt':_0x452fb8['createdAt']};}async[a57_0x55c3e4(0x8e)](){const _0x3e4146=a57_0x55c3e4,_0x70b112=await database_1[_0x3e4146(0xb1)][_0x3e4146(0xae)][_0x3e4146(0xa5)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x3e4146(0xad)}});return _0x70b112[_0x3e4146(0xb9)](_0x35a74a=>({'id':_0x35a74a['id'],'fullName':_0x35a74a[_0x3e4146(0xab)],'username':_0x35a74a['username'],'telegramId':_0x35a74a[_0x3e4146(0x9a)],'merchantUrl':_0x35a74a['shopUrl'],'gateways':_0x35a74a['paymentGateways']?JSON[_0x3e4146(0x87)](_0x35a74a[_0x3e4146(0x96)]):null,'gatewaySettings':_0x35a74a['gatewaySettings']?JSON[_0x3e4146(0x87)](_0x35a74a[_0x3e4146(0x95)]):null,'publicKey':_0x35a74a[_0x3e4146(0xb6)],'wallets':{'usdtPolygonWallet':_0x35a74a[_0x3e4146(0x92)],'usdtTrcWallet':_0x35a74a[_0x3e4146(0xb7)],'usdtErcWallet':_0x35a74a['usdtErcWallet'],'usdcPolygonWallet':_0x35a74a['usdcPolygonWallet']},'status':_0x35a74a[_0x3e4146(0xb8)],'createdAt':_0x35a74a['createdAt']}));}async['getUserById'](_0x5ac156){const _0x20d740=a57_0x55c3e4,_0x18db0b=await database_1[_0x20d740(0xb1)][_0x20d740(0xae)]['findUnique']({'where':{'id':_0x5ac156},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x18db0b)return null;return{'id':_0x18db0b['id'],'fullName':_0x18db0b['name'],'username':_0x18db0b['username'],'telegramId':_0x18db0b[_0x20d740(0x9a)],'merchantUrl':_0x18db0b['shopUrl'],'gateways':_0x18db0b[_0x20d740(0x96)]?JSON[_0x20d740(0x87)](_0x18db0b[_0x20d740(0x96)]):null,'gatewaySettings':_0x18db0b[_0x20d740(0x95)]?JSON[_0x20d740(0x87)](_0x18db0b[_0x20d740(0x95)]):null,'publicKey':_0x18db0b[_0x20d740(0xb6)],'wallets':{'usdtPolygonWallet':_0x18db0b[_0x20d740(0x92)],'usdtTrcWallet':_0x18db0b[_0x20d740(0xb7)],'usdtErcWallet':_0x18db0b[_0x20d740(0xba)],'usdcPolygonWallet':_0x18db0b[_0x20d740(0xa1)]},'status':_0x18db0b[_0x20d740(0xb8)],'createdAt':_0x18db0b['createdAt']};}async['updateUser'](_0x2d807f,_0x5c8053){const _0x2a4177=a57_0x55c3e4,_0x3b44cb={..._0x5c8053};_0x5c8053['password']&&(_0x3b44cb[_0x2a4177(0x89)]=await bcryptjs_1[_0x2a4177(0xb1)]['hash'](_0x5c8053[_0x2a4177(0x89)],0xc));_0x5c8053[_0x2a4177(0x91)]&&(_0x3b44cb[_0x2a4177(0xab)]=_0x5c8053[_0x2a4177(0x91)],delete _0x3b44cb[_0x2a4177(0x91)]);_0x5c8053[_0x2a4177(0x8f)]&&(_0x3b44cb[_0x2a4177(0x9a)]=_0x5c8053[_0x2a4177(0x8f)],delete _0x3b44cb[_0x2a4177(0x8f)]);_0x5c8053['merchantUrl']&&(_0x3b44cb[_0x2a4177(0xa2)]=_0x5c8053[_0x2a4177(0x94)],delete _0x3b44cb['merchantUrl']);_0x5c8053[_0x2a4177(0xa7)]&&(_0x3b44cb[_0x2a4177(0x96)]=JSON[_0x2a4177(0xa8)](_0x5c8053[_0x2a4177(0xa7)]),delete _0x3b44cb['gateways']);_0x5c8053[_0x2a4177(0x95)]&&(_0x3b44cb['gatewaySettings']=JSON['stringify'](_0x5c8053[_0x2a4177(0x95)]),delete _0x3b44cb[_0x2a4177(0x95)]);_0x5c8053[_0x2a4177(0x90)]&&(_0x5c8053[_0x2a4177(0x90)][_0x2a4177(0x92)]!==undefined&&(_0x3b44cb[_0x2a4177(0x92)]=_0x5c8053[_0x2a4177(0x90)][_0x2a4177(0x92)]||null),_0x5c8053[_0x2a4177(0x90)][_0x2a4177(0xb7)]!==undefined&&(_0x3b44cb[_0x2a4177(0xb7)]=_0x5c8053[_0x2a4177(0x90)][_0x2a4177(0xb7)]||null),_0x5c8053[_0x2a4177(0x90)][_0x2a4177(0xba)]!==undefined&&(_0x3b44cb[_0x2a4177(0xba)]=_0x5c8053[_0x2a4177(0x90)]['usdtErcWallet']||null),_0x5c8053[_0x2a4177(0x90)]['usdcPolygonWallet']!==undefined&&(_0x3b44cb[_0x2a4177(0xa1)]=_0x5c8053[_0x2a4177(0x90)]['usdcPolygonWallet']||null),delete _0x3b44cb[_0x2a4177(0x90)]);const _0x2798c2=await database_1[_0x2a4177(0xb1)][_0x2a4177(0xae)][_0x2a4177(0xa6)]({'where':{'id':_0x2d807f},'data':_0x3b44cb,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x2798c2['id'],'fullName':_0x2798c2[_0x2a4177(0xab)],'username':_0x2798c2[_0x2a4177(0x85)],'telegramId':_0x2798c2[_0x2a4177(0x9a)],'merchantUrl':_0x2798c2[_0x2a4177(0xa2)],'gateways':_0x2798c2[_0x2a4177(0x96)]?JSON[_0x2a4177(0x87)](_0x2798c2[_0x2a4177(0x96)]):null,'gatewaySettings':_0x2798c2[_0x2a4177(0x95)]?JSON[_0x2a4177(0x87)](_0x2798c2[_0x2a4177(0x95)]):null,'publicKey':_0x2798c2['publicKey'],'wallets':{'usdtPolygonWallet':_0x2798c2['usdtPolygonWallet'],'usdtTrcWallet':_0x2798c2['usdtTrcWallet'],'usdtErcWallet':_0x2798c2[_0x2a4177(0xba)],'usdcPolygonWallet':_0x2798c2['usdcPolygonWallet']},'status':_0x2798c2['status'],'createdAt':_0x2798c2[_0x2a4177(0xac)]};}async['deleteUser'](_0x10e1d3){const _0x3b3684=a57_0x55c3e4;await database_1['default'][_0x3b3684(0xae)]['delete']({'where':{'id':_0x10e1d3}});}}exports[a57_0x55c3e4(0xaf)]=UserService;