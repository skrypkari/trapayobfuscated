'use strict';const a51_0x12e94a=a51_0x496e;(function(_0x20b5ff,_0x331c31){const _0x7022ff=a51_0x496e,_0x5c9502=_0x20b5ff();while(!![]){try{const _0x431b31=parseInt(_0x7022ff(0x186))/0x1*(parseInt(_0x7022ff(0x18d))/0x2)+-parseInt(_0x7022ff(0x178))/0x3+parseInt(_0x7022ff(0x196))/0x4*(parseInt(_0x7022ff(0x197))/0x5)+parseInt(_0x7022ff(0x17c))/0x6+-parseInt(_0x7022ff(0x180))/0x7+parseInt(_0x7022ff(0x19e))/0x8+-parseInt(_0x7022ff(0x1a4))/0x9;if(_0x431b31===_0x331c31)break;else _0x5c9502['push'](_0x5c9502['shift']());}catch(_0x169c8){_0x5c9502['push'](_0x5c9502['shift']());}}}(a51_0x5581,0x37584));var __importDefault=this&&this[a51_0x12e94a(0x1aa)]||function(_0x408707){const _0x5fcbf6=a51_0x12e94a;return _0x408707&&_0x408707[_0x5fcbf6(0x19b)]?_0x408707:{'default':_0x408707};};Object['defineProperty'](exports,a51_0x12e94a(0x19b),{'value':!![]}),exports[a51_0x12e94a(0x193)]=void 0x0;const bcryptjs_1=__importDefault(require(a51_0x12e94a(0x1a7))),crypto_1=__importDefault(require(a51_0x12e94a(0x187))),database_1=__importDefault(require(a51_0x12e94a(0x18e)));class UserService{[a51_0x12e94a(0x1ac)](){const _0x398fb6=a51_0x12e94a,_0x44069b='pk_'+crypto_1[_0x398fb6(0x17a)][_0x398fb6(0x183)](0x20)['toString'](_0x398fb6(0x1a2)),_0x50693d=_0x398fb6(0x19c)+crypto_1[_0x398fb6(0x17a)][_0x398fb6(0x183)](0x20)[_0x398fb6(0x1a1)](_0x398fb6(0x1a2));return{'publicKey':_0x44069b,'secretKey':_0x50693d};}async[a51_0x12e94a(0x18b)](_0x3898d5){const _0x168f16=a51_0x12e94a,{fullName:_0x1f0e5c,username:_0x5c786b,password:_0x1b2c64,telegramId:_0x15dce1,merchantUrl:_0x1f86fa,gateways:_0xae0cb4,gatewaySettings:_0x714b5,wallets:_0x463c70}=_0x3898d5,_0x3c9845=await database_1[_0x168f16(0x17a)][_0x168f16(0x179)][_0x168f16(0x1a9)]({'where':{'username':_0x5c786b}});if(_0x3c9845)throw new Error(_0x168f16(0x191));if(_0x15dce1){const _0x2c9975=await database_1[_0x168f16(0x17a)][_0x168f16(0x179)][_0x168f16(0x1a9)]({'where':{'telegram':_0x15dce1}});if(_0x2c9975)throw new Error(_0x168f16(0x176));}const _0x1f9612=await bcryptjs_1[_0x168f16(0x17a)]['hash'](_0x1b2c64,0xc),{publicKey:_0x2c0f09,secretKey:_0x396ef7}=this[_0x168f16(0x1ac)](),_0xb37707=await database_1[_0x168f16(0x17a)][_0x168f16(0x179)][_0x168f16(0x181)]({'data':{'name':_0x1f0e5c,'username':_0x5c786b,'password':_0x1f9612,'telegram':_0x15dce1,'shopUrl':_0x1f86fa,'paymentGateways':_0xae0cb4?JSON['stringify'](_0xae0cb4):null,'gatewaySettings':_0x714b5?JSON[_0x168f16(0x194)](_0x714b5):null,'usdtPolygonWallet':_0x463c70?.[_0x168f16(0x1ab)]||null,'usdtTrcWallet':_0x463c70?.['usdtTrcWallet']||null,'usdtErcWallet':_0x463c70?.[_0x168f16(0x18a)]||null,'usdcPolygonWallet':_0x463c70?.[_0x168f16(0x177)]||null,'publicKey':_0x2c0f09,'secretKey':_0x396ef7,'status':_0x168f16(0x18f)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0xb37707['id'],'fullName':_0xb37707[_0x168f16(0x1a8)],'username':_0xb37707[_0x168f16(0x199)],'telegramId':_0xb37707[_0x168f16(0x17b)],'merchantUrl':_0xb37707['shopUrl'],'gateways':_0xb37707[_0x168f16(0x189)]?JSON['parse'](_0xb37707[_0x168f16(0x189)]):null,'gatewaySettings':_0xb37707[_0x168f16(0x195)]?JSON[_0x168f16(0x192)](_0xb37707[_0x168f16(0x195)]):null,'publicKey':_0xb37707[_0x168f16(0x182)],'wallets':{'usdtPolygonWallet':_0xb37707[_0x168f16(0x1ab)],'usdtTrcWallet':_0xb37707[_0x168f16(0x1a0)],'usdtErcWallet':_0xb37707['usdtErcWallet'],'usdcPolygonWallet':_0xb37707[_0x168f16(0x177)]},'status':_0xb37707[_0x168f16(0x1a5)],'createdAt':_0xb37707[_0x168f16(0x184)]};}async[a51_0x12e94a(0x17d)](){const _0xa60808=a51_0x12e94a,_0x24816a=await database_1['default'][_0xa60808(0x179)]['findMany']({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0xa60808(0x1a6)}});return _0x24816a['map'](_0x20cf0e=>({'id':_0x20cf0e['id'],'fullName':_0x20cf0e['name'],'username':_0x20cf0e['username'],'telegramId':_0x20cf0e['telegram'],'merchantUrl':_0x20cf0e[_0xa60808(0x18c)],'gateways':_0x20cf0e[_0xa60808(0x189)]?JSON[_0xa60808(0x192)](_0x20cf0e[_0xa60808(0x189)]):null,'gatewaySettings':_0x20cf0e['gatewaySettings']?JSON[_0xa60808(0x192)](_0x20cf0e[_0xa60808(0x195)]):null,'publicKey':_0x20cf0e[_0xa60808(0x182)],'wallets':{'usdtPolygonWallet':_0x20cf0e[_0xa60808(0x1ab)],'usdtTrcWallet':_0x20cf0e[_0xa60808(0x1a0)],'usdtErcWallet':_0x20cf0e['usdtErcWallet'],'usdcPolygonWallet':_0x20cf0e['usdcPolygonWallet']},'status':_0x20cf0e[_0xa60808(0x1a5)],'createdAt':_0x20cf0e[_0xa60808(0x184)]}));}async[a51_0x12e94a(0x188)](_0x4a7126){const _0xa78991=a51_0x12e94a,_0x91c1b5=await database_1[_0xa78991(0x17a)][_0xa78991(0x179)][_0xa78991(0x1a9)]({'where':{'id':_0x4a7126},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x91c1b5)return null;return{'id':_0x91c1b5['id'],'fullName':_0x91c1b5['name'],'username':_0x91c1b5[_0xa78991(0x199)],'telegramId':_0x91c1b5[_0xa78991(0x17b)],'merchantUrl':_0x91c1b5['shopUrl'],'gateways':_0x91c1b5[_0xa78991(0x189)]?JSON[_0xa78991(0x192)](_0x91c1b5[_0xa78991(0x189)]):null,'gatewaySettings':_0x91c1b5[_0xa78991(0x195)]?JSON[_0xa78991(0x192)](_0x91c1b5[_0xa78991(0x195)]):null,'publicKey':_0x91c1b5[_0xa78991(0x182)],'wallets':{'usdtPolygonWallet':_0x91c1b5[_0xa78991(0x1ab)],'usdtTrcWallet':_0x91c1b5[_0xa78991(0x1a0)],'usdtErcWallet':_0x91c1b5['usdtErcWallet'],'usdcPolygonWallet':_0x91c1b5[_0xa78991(0x177)]},'status':_0x91c1b5['status'],'createdAt':_0x91c1b5['createdAt']};}async['updateUser'](_0x211c2d,_0x3c812c){const _0x4052c6=a51_0x12e94a,_0x4752b8={..._0x3c812c};_0x3c812c['password']&&(_0x4752b8['password']=await bcryptjs_1[_0x4052c6(0x17a)][_0x4052c6(0x185)](_0x3c812c[_0x4052c6(0x198)],0xc));_0x3c812c[_0x4052c6(0x19d)]&&(_0x4752b8[_0x4052c6(0x1a8)]=_0x3c812c[_0x4052c6(0x19d)],delete _0x4752b8['fullName']);_0x3c812c['telegramId']&&(_0x4752b8['telegram']=_0x3c812c[_0x4052c6(0x17e)],delete _0x4752b8[_0x4052c6(0x17e)]);_0x3c812c[_0x4052c6(0x1a3)]&&(_0x4752b8['shopUrl']=_0x3c812c[_0x4052c6(0x1a3)],delete _0x4752b8[_0x4052c6(0x1a3)]);_0x3c812c[_0x4052c6(0x17f)]&&(_0x4752b8[_0x4052c6(0x189)]=JSON[_0x4052c6(0x194)](_0x3c812c['gateways']),delete _0x4752b8['gateways']);_0x3c812c[_0x4052c6(0x195)]&&(_0x4752b8[_0x4052c6(0x195)]=JSON['stringify'](_0x3c812c['gatewaySettings']),delete _0x4752b8[_0x4052c6(0x195)]);_0x3c812c[_0x4052c6(0x19a)]&&(_0x3c812c[_0x4052c6(0x19a)][_0x4052c6(0x1ab)]!==undefined&&(_0x4752b8[_0x4052c6(0x1ab)]=_0x3c812c[_0x4052c6(0x19a)][_0x4052c6(0x1ab)]||null),_0x3c812c['wallets']['usdtTrcWallet']!==undefined&&(_0x4752b8[_0x4052c6(0x1a0)]=_0x3c812c[_0x4052c6(0x19a)][_0x4052c6(0x1a0)]||null),_0x3c812c[_0x4052c6(0x19a)][_0x4052c6(0x18a)]!==undefined&&(_0x4752b8[_0x4052c6(0x18a)]=_0x3c812c['wallets'][_0x4052c6(0x18a)]||null),_0x3c812c[_0x4052c6(0x19a)][_0x4052c6(0x177)]!==undefined&&(_0x4752b8[_0x4052c6(0x177)]=_0x3c812c['wallets'][_0x4052c6(0x177)]||null),delete _0x4752b8[_0x4052c6(0x19a)]);const _0x44d259=await database_1[_0x4052c6(0x17a)]['shop']['update']({'where':{'id':_0x211c2d},'data':_0x4752b8,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x44d259['id'],'fullName':_0x44d259[_0x4052c6(0x1a8)],'username':_0x44d259[_0x4052c6(0x199)],'telegramId':_0x44d259[_0x4052c6(0x17b)],'merchantUrl':_0x44d259['shopUrl'],'gateways':_0x44d259[_0x4052c6(0x189)]?JSON[_0x4052c6(0x192)](_0x44d259[_0x4052c6(0x189)]):null,'gatewaySettings':_0x44d259['gatewaySettings']?JSON[_0x4052c6(0x192)](_0x44d259[_0x4052c6(0x195)]):null,'publicKey':_0x44d259['publicKey'],'wallets':{'usdtPolygonWallet':_0x44d259['usdtPolygonWallet'],'usdtTrcWallet':_0x44d259[_0x4052c6(0x1a0)],'usdtErcWallet':_0x44d259[_0x4052c6(0x18a)],'usdcPolygonWallet':_0x44d259['usdcPolygonWallet']},'status':_0x44d259[_0x4052c6(0x1a5)],'createdAt':_0x44d259['createdAt']};}async[a51_0x12e94a(0x19f)](_0x291387){const _0x5d2a9a=a51_0x12e94a;await database_1[_0x5d2a9a(0x17a)][_0x5d2a9a(0x179)][_0x5d2a9a(0x190)]({'where':{'id':_0x291387}});}}function a51_0x496e(_0x543a49,_0x478cb1){const _0x558128=a51_0x5581();return a51_0x496e=function(_0x496e86,_0x5308c2){_0x496e86=_0x496e86-0x176;let _0x56fed8=_0x558128[_0x496e86];return _0x56fed8;},a51_0x496e(_0x543a49,_0x478cb1);}exports['UserService']=UserService;function a51_0x5581(){const _0xa0df8e=['shopUrl','124426tPqSCD','../config/database','ACTIVE','delete','Username\x20already\x20exists','parse','UserService','stringify','gatewaySettings','67652VErOkx','80tXkpnc','password','username','wallets','__esModule','sk_','fullName','3167872QWRarM','deleteUser','usdtTrcWallet','toString','hex','merchantUrl','4931496XSvxnN','status','desc','bcryptjs','name','findUnique','__importDefault','usdtPolygonWallet','generateApiKeys','Telegram\x20username\x20already\x20exists','usdcPolygonWallet','270402zNdada','shop','default','telegram','703920eNeUNq','getAllUsers','telegramId','gateways','740467gpVoWz','create','publicKey','randomBytes','createdAt','hash','3KFNaDM','crypto','getUserById','paymentGateways','usdtErcWallet','createUser'];a51_0x5581=function(){return _0xa0df8e;};return a51_0x5581();}