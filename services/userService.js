'use strict';function a55_0x4d41(){const _0x4a56b9=['hash','hex','default','name','status','6008ZuOOmx','1580qBopbH','421416CMNelm','delete','gateways','UserService','gatewaySettings','findUnique','2IwKrLr','username','crypto','12100VmOeFx','4650MIBeQS','updateUser','desc','password','ACTIVE','merchantUrl','usdcPolygonWallet','13644944KHIXXg','__importDefault','shopUrl','deleteUser','Username\x20already\x20exists','createdAt','telegramId','create','wallets','map','usdtErcWallet','publicKey','update','stringify','Telegram\x20username\x20already\x20exists','305243oOiVJB','sk_','usdtTrcWallet','telegram','paymentGateways','findMany','usdtPolygonWallet','6685147bLKhNm','../config/database','7788WAwrCS','72162dAVlYK','randomBytes','6flmlLi','generateApiKeys','bcryptjs','toString','__esModule','parse','shop'];a55_0x4d41=function(){return _0x4a56b9;};return a55_0x4d41();}const a55_0x382c16=a55_0x9cf2;(function(_0x2f01fd,_0x9b6ec1){const _0x28cae4=a55_0x9cf2,_0x4194b1=_0x2f01fd();while(!![]){try{const _0x56685e=parseInt(_0x28cae4(0x1ac))/0x1*(parseInt(_0x28cae4(0x192))/0x2)+-parseInt(_0x28cae4(0x18c))/0x3+parseInt(_0x28cae4(0x18a))/0x4*(-parseInt(_0x28cae4(0x196))/0x5)+-parseInt(_0x28cae4(0x1b8))/0x6*(-parseInt(_0x28cae4(0x1b3))/0x7)+parseInt(_0x28cae4(0x19d))/0x8+parseInt(_0x28cae4(0x1b6))/0x9*(-parseInt(_0x28cae4(0x18b))/0xa)+parseInt(_0x28cae4(0x195))/0xb*(parseInt(_0x28cae4(0x1b5))/0xc);if(_0x56685e===_0x9b6ec1)break;else _0x4194b1['push'](_0x4194b1['shift']());}catch(_0x22d508){_0x4194b1['push'](_0x4194b1['shift']());}}}(a55_0x4d41,0xd5c56));var __importDefault=this&&this[a55_0x382c16(0x19e)]||function(_0x556ae9){const _0x18a9fe=a55_0x382c16;return _0x556ae9&&_0x556ae9[_0x18a9fe(0x1bc)]?_0x556ae9:{'default':_0x556ae9};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a55_0x382c16(0x18f)]=void 0x0;function a55_0x9cf2(_0x5000e4,_0x56829f){const _0x4d41ac=a55_0x4d41();return a55_0x9cf2=function(_0x9cf297,_0x4934ce){_0x9cf297=_0x9cf297-0x188;let _0x2aed79=_0x4d41ac[_0x9cf297];return _0x2aed79;},a55_0x9cf2(_0x5000e4,_0x56829f);}const bcryptjs_1=__importDefault(require(a55_0x382c16(0x1ba))),crypto_1=__importDefault(require(a55_0x382c16(0x194))),database_1=__importDefault(require(a55_0x382c16(0x1b4)));class UserService{['generateApiKeys'](){const _0x2c880c=a55_0x382c16,_0x2b3bb4='pk_'+crypto_1['default'][_0x2c880c(0x1b7)](0x20)['toString'](_0x2c880c(0x1c0)),_0x385853=_0x2c880c(0x1ad)+crypto_1[_0x2c880c(0x1c1)][_0x2c880c(0x1b7)](0x20)[_0x2c880c(0x1bb)](_0x2c880c(0x1c0));return{'publicKey':_0x2b3bb4,'secretKey':_0x385853};}async['createUser'](_0x3076b2){const _0x439f66=a55_0x382c16,{fullName:_0x28b128,username:_0x27f478,password:_0x5a8135,telegramId:_0x5ed62d,merchantUrl:_0x4c6f71,gateways:_0x654036,gatewaySettings:_0x5a1b13,wallets:_0x3ff31f}=_0x3076b2,_0x58c60c=await database_1['default']['shop'][_0x439f66(0x191)]({'where':{'username':_0x27f478}});if(_0x58c60c)throw new Error(_0x439f66(0x1a1));if(_0x5ed62d){const _0x2e12c9=await database_1[_0x439f66(0x1c1)][_0x439f66(0x1be)][_0x439f66(0x191)]({'where':{'telegram':_0x5ed62d}});if(_0x2e12c9)throw new Error(_0x439f66(0x1ab));}const _0x63c159=await bcryptjs_1[_0x439f66(0x1c1)][_0x439f66(0x1bf)](_0x5a8135,0xc),{publicKey:_0x2c5c75,secretKey:_0x36aa68}=this[_0x439f66(0x1b9)](),_0x587560=await database_1[_0x439f66(0x1c1)][_0x439f66(0x1be)][_0x439f66(0x1a4)]({'data':{'name':_0x28b128,'username':_0x27f478,'password':_0x63c159,'telegram':_0x5ed62d,'shopUrl':_0x4c6f71,'paymentGateways':_0x654036?JSON[_0x439f66(0x1aa)](_0x654036):null,'gatewaySettings':_0x5a1b13?JSON[_0x439f66(0x1aa)](_0x5a1b13):null,'usdtPolygonWallet':_0x3ff31f?.[_0x439f66(0x1b2)]||null,'usdtTrcWallet':_0x3ff31f?.[_0x439f66(0x1ae)]||null,'usdtErcWallet':_0x3ff31f?.[_0x439f66(0x1a7)]||null,'usdcPolygonWallet':_0x3ff31f?.[_0x439f66(0x19c)]||null,'publicKey':_0x2c5c75,'secretKey':_0x36aa68,'status':_0x439f66(0x19a)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x587560['id'],'fullName':_0x587560[_0x439f66(0x188)],'username':_0x587560[_0x439f66(0x193)],'telegramId':_0x587560[_0x439f66(0x1af)],'merchantUrl':_0x587560[_0x439f66(0x19f)],'gateways':_0x587560[_0x439f66(0x1b0)]?JSON['parse'](_0x587560['paymentGateways']):null,'gatewaySettings':_0x587560['gatewaySettings']?JSON['parse'](_0x587560[_0x439f66(0x190)]):null,'publicKey':_0x587560[_0x439f66(0x1a8)],'wallets':{'usdtPolygonWallet':_0x587560[_0x439f66(0x1b2)],'usdtTrcWallet':_0x587560[_0x439f66(0x1ae)],'usdtErcWallet':_0x587560[_0x439f66(0x1a7)],'usdcPolygonWallet':_0x587560[_0x439f66(0x19c)]},'status':_0x587560['status'],'createdAt':_0x587560[_0x439f66(0x1a2)]};}async['getAllUsers'](){const _0x11040f=a55_0x382c16,_0x491b08=await database_1['default'][_0x11040f(0x1be)][_0x11040f(0x1b1)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x11040f(0x198)}});return _0x491b08[_0x11040f(0x1a6)](_0x21fe3=>({'id':_0x21fe3['id'],'fullName':_0x21fe3[_0x11040f(0x188)],'username':_0x21fe3[_0x11040f(0x193)],'telegramId':_0x21fe3[_0x11040f(0x1af)],'merchantUrl':_0x21fe3[_0x11040f(0x19f)],'gateways':_0x21fe3['paymentGateways']?JSON[_0x11040f(0x1bd)](_0x21fe3[_0x11040f(0x1b0)]):null,'gatewaySettings':_0x21fe3[_0x11040f(0x190)]?JSON[_0x11040f(0x1bd)](_0x21fe3['gatewaySettings']):null,'publicKey':_0x21fe3['publicKey'],'wallets':{'usdtPolygonWallet':_0x21fe3[_0x11040f(0x1b2)],'usdtTrcWallet':_0x21fe3[_0x11040f(0x1ae)],'usdtErcWallet':_0x21fe3[_0x11040f(0x1a7)],'usdcPolygonWallet':_0x21fe3[_0x11040f(0x19c)]},'status':_0x21fe3['status'],'createdAt':_0x21fe3[_0x11040f(0x1a2)]}));}async['getUserById'](_0x5f280c){const _0x527ee6=a55_0x382c16,_0x21b6d1=await database_1[_0x527ee6(0x1c1)]['shop'][_0x527ee6(0x191)]({'where':{'id':_0x5f280c},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x21b6d1)return null;return{'id':_0x21b6d1['id'],'fullName':_0x21b6d1[_0x527ee6(0x188)],'username':_0x21b6d1[_0x527ee6(0x193)],'telegramId':_0x21b6d1[_0x527ee6(0x1af)],'merchantUrl':_0x21b6d1['shopUrl'],'gateways':_0x21b6d1[_0x527ee6(0x1b0)]?JSON[_0x527ee6(0x1bd)](_0x21b6d1[_0x527ee6(0x1b0)]):null,'gatewaySettings':_0x21b6d1['gatewaySettings']?JSON[_0x527ee6(0x1bd)](_0x21b6d1['gatewaySettings']):null,'publicKey':_0x21b6d1['publicKey'],'wallets':{'usdtPolygonWallet':_0x21b6d1['usdtPolygonWallet'],'usdtTrcWallet':_0x21b6d1['usdtTrcWallet'],'usdtErcWallet':_0x21b6d1[_0x527ee6(0x1a7)],'usdcPolygonWallet':_0x21b6d1[_0x527ee6(0x19c)]},'status':_0x21b6d1[_0x527ee6(0x189)],'createdAt':_0x21b6d1[_0x527ee6(0x1a2)]};}async[a55_0x382c16(0x197)](_0x143c3f,_0xb8e02){const _0x4c83bc=a55_0x382c16,_0x334af7={..._0xb8e02};_0xb8e02['password']&&(_0x334af7[_0x4c83bc(0x199)]=await bcryptjs_1[_0x4c83bc(0x1c1)][_0x4c83bc(0x1bf)](_0xb8e02[_0x4c83bc(0x199)],0xc));_0xb8e02['fullName']&&(_0x334af7[_0x4c83bc(0x188)]=_0xb8e02['fullName'],delete _0x334af7['fullName']);_0xb8e02['telegramId']&&(_0x334af7['telegram']=_0xb8e02[_0x4c83bc(0x1a3)],delete _0x334af7['telegramId']);_0xb8e02[_0x4c83bc(0x19b)]&&(_0x334af7['shopUrl']=_0xb8e02[_0x4c83bc(0x19b)],delete _0x334af7['merchantUrl']);_0xb8e02[_0x4c83bc(0x18e)]&&(_0x334af7[_0x4c83bc(0x1b0)]=JSON[_0x4c83bc(0x1aa)](_0xb8e02[_0x4c83bc(0x18e)]),delete _0x334af7[_0x4c83bc(0x18e)]);_0xb8e02[_0x4c83bc(0x190)]&&(_0x334af7[_0x4c83bc(0x190)]=JSON[_0x4c83bc(0x1aa)](_0xb8e02['gatewaySettings']),delete _0x334af7['gatewaySettings']);_0xb8e02[_0x4c83bc(0x1a5)]&&(_0xb8e02[_0x4c83bc(0x1a5)][_0x4c83bc(0x1b2)]!==undefined&&(_0x334af7[_0x4c83bc(0x1b2)]=_0xb8e02[_0x4c83bc(0x1a5)][_0x4c83bc(0x1b2)]||null),_0xb8e02[_0x4c83bc(0x1a5)]['usdtTrcWallet']!==undefined&&(_0x334af7[_0x4c83bc(0x1ae)]=_0xb8e02[_0x4c83bc(0x1a5)][_0x4c83bc(0x1ae)]||null),_0xb8e02['wallets'][_0x4c83bc(0x1a7)]!==undefined&&(_0x334af7[_0x4c83bc(0x1a7)]=_0xb8e02[_0x4c83bc(0x1a5)][_0x4c83bc(0x1a7)]||null),_0xb8e02[_0x4c83bc(0x1a5)][_0x4c83bc(0x19c)]!==undefined&&(_0x334af7[_0x4c83bc(0x19c)]=_0xb8e02['wallets'][_0x4c83bc(0x19c)]||null),delete _0x334af7['wallets']);const _0xd2de0=await database_1[_0x4c83bc(0x1c1)]['shop'][_0x4c83bc(0x1a9)]({'where':{'id':_0x143c3f},'data':_0x334af7,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0xd2de0['id'],'fullName':_0xd2de0[_0x4c83bc(0x188)],'username':_0xd2de0[_0x4c83bc(0x193)],'telegramId':_0xd2de0[_0x4c83bc(0x1af)],'merchantUrl':_0xd2de0['shopUrl'],'gateways':_0xd2de0[_0x4c83bc(0x1b0)]?JSON[_0x4c83bc(0x1bd)](_0xd2de0[_0x4c83bc(0x1b0)]):null,'gatewaySettings':_0xd2de0[_0x4c83bc(0x190)]?JSON[_0x4c83bc(0x1bd)](_0xd2de0[_0x4c83bc(0x190)]):null,'publicKey':_0xd2de0['publicKey'],'wallets':{'usdtPolygonWallet':_0xd2de0[_0x4c83bc(0x1b2)],'usdtTrcWallet':_0xd2de0[_0x4c83bc(0x1ae)],'usdtErcWallet':_0xd2de0[_0x4c83bc(0x1a7)],'usdcPolygonWallet':_0xd2de0[_0x4c83bc(0x19c)]},'status':_0xd2de0[_0x4c83bc(0x189)],'createdAt':_0xd2de0[_0x4c83bc(0x1a2)]};}async[a55_0x382c16(0x1a0)](_0xeb87b8){const _0x2fb095=a55_0x382c16;await database_1[_0x2fb095(0x1c1)][_0x2fb095(0x1be)][_0x2fb095(0x18d)]({'where':{'id':_0xeb87b8}});}}exports[a55_0x382c16(0x18f)]=UserService;