'use strict';function a57_0x1548(_0x18e7c5,_0x2a6636){const _0x4151f7=a57_0x4151();return a57_0x1548=function(_0x1548c7,_0x4747f5){_0x1548c7=_0x1548c7-0x142;let _0x25ba25=_0x4151f7[_0x1548c7];return _0x25ba25;},a57_0x1548(_0x18e7c5,_0x2a6636);}const a57_0x563aa7=a57_0x1548;function a57_0x4151(){const _0x39826f=['2243200tKBPot','shopUrl','fullName','generateApiKeys','map','publicKey','506703Gkzjij','usdtTrcWallet','725167NsUUGS','update','__esModule','merchantUrl','crypto','delete','../config/database','findUnique','parse','gatewaySettings','5036139PbtKxY','findMany','usdtPolygonWallet','getUserById','status','desc','Telegram\x20username\x20already\x20exists','username','UserService','password','__importDefault','create','pk_','createdAt','hex','2933175Wjyzcl','default','stringify','deleteUser','shop','telegramId','4098438wZyOKG','name','24JVAavv','toString','4656940AnZXxW','paymentGateways','randomBytes','ACTIVE','usdcPolygonWallet','telegram','getAllUsers','usdtErcWallet','wallets','4tpgRzH','gateways'];a57_0x4151=function(){return _0x39826f;};return a57_0x4151();}(function(_0xde9456,_0xc6b1f1){const _0x1ec9d1=a57_0x1548,_0x4e6eae=_0xde9456();while(!![]){try{const _0xe740fc=-parseInt(_0x1ec9d1(0x16d))/0x1+parseInt(_0x1ec9d1(0x165))/0x2+-parseInt(_0x1ec9d1(0x16b))/0x3*(parseInt(_0x1ec9d1(0x163))/0x4)+parseInt(_0x1ec9d1(0x15a))/0x5+parseInt(_0x1ec9d1(0x156))/0x6+parseInt(_0x1ec9d1(0x150))/0x7+-parseInt(_0x1ec9d1(0x158))/0x8*(parseInt(_0x1ec9d1(0x177))/0x9);if(_0xe740fc===_0xc6b1f1)break;else _0x4e6eae['push'](_0x4e6eae['shift']());}catch(_0x42207a){_0x4e6eae['push'](_0x4e6eae['shift']());}}}(a57_0x4151,0x8e2a1));var __importDefault=this&&this[a57_0x563aa7(0x14b)]||function(_0x23065a){const _0xa2ca42=a57_0x563aa7;return _0x23065a&&_0x23065a[_0xa2ca42(0x16f)]?_0x23065a:{'default':_0x23065a};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a57_0x563aa7(0x149)]=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),crypto_1=__importDefault(require(a57_0x563aa7(0x171))),database_1=__importDefault(require(a57_0x563aa7(0x173)));class UserService{[a57_0x563aa7(0x168)](){const _0x62fc1d=a57_0x563aa7,_0x51cd50=_0x62fc1d(0x14d)+crypto_1[_0x62fc1d(0x151)][_0x62fc1d(0x15c)](0x20)[_0x62fc1d(0x159)](_0x62fc1d(0x14f)),_0x574bb0='sk_'+crypto_1[_0x62fc1d(0x151)][_0x62fc1d(0x15c)](0x20)[_0x62fc1d(0x159)]('hex');return{'publicKey':_0x51cd50,'secretKey':_0x574bb0};}async['createUser'](_0x2901ed){const _0x5e0112=a57_0x563aa7,{fullName:_0x2fe90c,username:_0x456021,password:_0x3866aa,telegramId:_0xdd6a57,merchantUrl:_0x48f648,gateways:_0x29140c,gatewaySettings:_0x32fba1,wallets:_0x36950c}=_0x2901ed,_0x3b792d=await database_1[_0x5e0112(0x151)][_0x5e0112(0x154)][_0x5e0112(0x174)]({'where':{'username':_0x456021}});if(_0x3b792d)throw new Error('Username\x20already\x20exists');if(_0xdd6a57){const _0x2aec3a=await database_1[_0x5e0112(0x151)][_0x5e0112(0x154)][_0x5e0112(0x174)]({'where':{'telegram':_0xdd6a57}});if(_0x2aec3a)throw new Error(_0x5e0112(0x147));}const _0x36d22d=await bcryptjs_1[_0x5e0112(0x151)]['hash'](_0x3866aa,0xc),{publicKey:_0x57faae,secretKey:_0x49402d}=this[_0x5e0112(0x168)](),_0x1d50e7=await database_1[_0x5e0112(0x151)][_0x5e0112(0x154)][_0x5e0112(0x14c)]({'data':{'name':_0x2fe90c,'username':_0x456021,'password':_0x36d22d,'telegram':_0xdd6a57,'shopUrl':_0x48f648,'paymentGateways':_0x29140c?JSON[_0x5e0112(0x152)](_0x29140c):null,'gatewaySettings':_0x32fba1?JSON[_0x5e0112(0x152)](_0x32fba1):null,'usdtPolygonWallet':_0x36950c?.[_0x5e0112(0x143)]||null,'usdtTrcWallet':_0x36950c?.[_0x5e0112(0x16c)]||null,'usdtErcWallet':_0x36950c?.[_0x5e0112(0x161)]||null,'usdcPolygonWallet':_0x36950c?.[_0x5e0112(0x15e)]||null,'publicKey':_0x57faae,'secretKey':_0x49402d,'status':_0x5e0112(0x15d)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x1d50e7['id'],'fullName':_0x1d50e7[_0x5e0112(0x157)],'username':_0x1d50e7['username'],'telegramId':_0x1d50e7[_0x5e0112(0x15f)],'merchantUrl':_0x1d50e7[_0x5e0112(0x166)],'gateways':_0x1d50e7[_0x5e0112(0x15b)]?JSON[_0x5e0112(0x175)](_0x1d50e7[_0x5e0112(0x15b)]):null,'gatewaySettings':_0x1d50e7[_0x5e0112(0x176)]?JSON[_0x5e0112(0x175)](_0x1d50e7[_0x5e0112(0x176)]):null,'publicKey':_0x1d50e7[_0x5e0112(0x16a)],'wallets':{'usdtPolygonWallet':_0x1d50e7[_0x5e0112(0x143)],'usdtTrcWallet':_0x1d50e7[_0x5e0112(0x16c)],'usdtErcWallet':_0x1d50e7[_0x5e0112(0x161)],'usdcPolygonWallet':_0x1d50e7[_0x5e0112(0x15e)]},'status':_0x1d50e7[_0x5e0112(0x145)],'createdAt':_0x1d50e7[_0x5e0112(0x14e)]};}async[a57_0x563aa7(0x160)](){const _0x32fb04=a57_0x563aa7,_0x52be46=await database_1['default'][_0x32fb04(0x154)][_0x32fb04(0x142)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x32fb04(0x146)}});return _0x52be46[_0x32fb04(0x169)](_0x429310=>({'id':_0x429310['id'],'fullName':_0x429310[_0x32fb04(0x157)],'username':_0x429310[_0x32fb04(0x148)],'telegramId':_0x429310[_0x32fb04(0x15f)],'merchantUrl':_0x429310[_0x32fb04(0x166)],'gateways':_0x429310[_0x32fb04(0x15b)]?JSON[_0x32fb04(0x175)](_0x429310[_0x32fb04(0x15b)]):null,'gatewaySettings':_0x429310[_0x32fb04(0x176)]?JSON['parse'](_0x429310[_0x32fb04(0x176)]):null,'publicKey':_0x429310[_0x32fb04(0x16a)],'wallets':{'usdtPolygonWallet':_0x429310[_0x32fb04(0x143)],'usdtTrcWallet':_0x429310[_0x32fb04(0x16c)],'usdtErcWallet':_0x429310[_0x32fb04(0x161)],'usdcPolygonWallet':_0x429310[_0x32fb04(0x15e)]},'status':_0x429310['status'],'createdAt':_0x429310[_0x32fb04(0x14e)]}));}async[a57_0x563aa7(0x144)](_0x3aba5a){const _0x308c0a=a57_0x563aa7,_0x3c2b07=await database_1[_0x308c0a(0x151)][_0x308c0a(0x154)]['findUnique']({'where':{'id':_0x3aba5a},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x3c2b07)return null;return{'id':_0x3c2b07['id'],'fullName':_0x3c2b07[_0x308c0a(0x157)],'username':_0x3c2b07['username'],'telegramId':_0x3c2b07[_0x308c0a(0x15f)],'merchantUrl':_0x3c2b07[_0x308c0a(0x166)],'gateways':_0x3c2b07['paymentGateways']?JSON[_0x308c0a(0x175)](_0x3c2b07[_0x308c0a(0x15b)]):null,'gatewaySettings':_0x3c2b07[_0x308c0a(0x176)]?JSON[_0x308c0a(0x175)](_0x3c2b07[_0x308c0a(0x176)]):null,'publicKey':_0x3c2b07['publicKey'],'wallets':{'usdtPolygonWallet':_0x3c2b07['usdtPolygonWallet'],'usdtTrcWallet':_0x3c2b07['usdtTrcWallet'],'usdtErcWallet':_0x3c2b07['usdtErcWallet'],'usdcPolygonWallet':_0x3c2b07[_0x308c0a(0x15e)]},'status':_0x3c2b07[_0x308c0a(0x145)],'createdAt':_0x3c2b07[_0x308c0a(0x14e)]};}async['updateUser'](_0x59aa26,_0x5318e1){const _0x531209=a57_0x563aa7,_0x6e7446={..._0x5318e1};_0x5318e1[_0x531209(0x14a)]&&(_0x6e7446[_0x531209(0x14a)]=await bcryptjs_1[_0x531209(0x151)]['hash'](_0x5318e1[_0x531209(0x14a)],0xc));_0x5318e1['fullName']&&(_0x6e7446[_0x531209(0x157)]=_0x5318e1[_0x531209(0x167)],delete _0x6e7446[_0x531209(0x167)]);_0x5318e1[_0x531209(0x155)]&&(_0x6e7446[_0x531209(0x15f)]=_0x5318e1[_0x531209(0x155)],delete _0x6e7446[_0x531209(0x155)]);_0x5318e1[_0x531209(0x170)]&&(_0x6e7446[_0x531209(0x166)]=_0x5318e1[_0x531209(0x170)],delete _0x6e7446[_0x531209(0x170)]);_0x5318e1[_0x531209(0x164)]&&(_0x6e7446[_0x531209(0x15b)]=JSON[_0x531209(0x152)](_0x5318e1[_0x531209(0x164)]),delete _0x6e7446['gateways']);_0x5318e1[_0x531209(0x176)]&&(_0x6e7446[_0x531209(0x176)]=JSON[_0x531209(0x152)](_0x5318e1[_0x531209(0x176)]),delete _0x6e7446['gatewaySettings']);_0x5318e1['wallets']&&(_0x5318e1[_0x531209(0x162)]['usdtPolygonWallet']!==undefined&&(_0x6e7446['usdtPolygonWallet']=_0x5318e1['wallets'][_0x531209(0x143)]||null),_0x5318e1[_0x531209(0x162)]['usdtTrcWallet']!==undefined&&(_0x6e7446['usdtTrcWallet']=_0x5318e1[_0x531209(0x162)][_0x531209(0x16c)]||null),_0x5318e1[_0x531209(0x162)][_0x531209(0x161)]!==undefined&&(_0x6e7446[_0x531209(0x161)]=_0x5318e1['wallets'][_0x531209(0x161)]||null),_0x5318e1[_0x531209(0x162)][_0x531209(0x15e)]!==undefined&&(_0x6e7446['usdcPolygonWallet']=_0x5318e1['wallets']['usdcPolygonWallet']||null),delete _0x6e7446['wallets']);const _0x36a2b0=await database_1['default']['shop'][_0x531209(0x16e)]({'where':{'id':_0x59aa26},'data':_0x6e7446,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x36a2b0['id'],'fullName':_0x36a2b0[_0x531209(0x157)],'username':_0x36a2b0['username'],'telegramId':_0x36a2b0[_0x531209(0x15f)],'merchantUrl':_0x36a2b0[_0x531209(0x166)],'gateways':_0x36a2b0['paymentGateways']?JSON[_0x531209(0x175)](_0x36a2b0[_0x531209(0x15b)]):null,'gatewaySettings':_0x36a2b0[_0x531209(0x176)]?JSON['parse'](_0x36a2b0['gatewaySettings']):null,'publicKey':_0x36a2b0['publicKey'],'wallets':{'usdtPolygonWallet':_0x36a2b0['usdtPolygonWallet'],'usdtTrcWallet':_0x36a2b0[_0x531209(0x16c)],'usdtErcWallet':_0x36a2b0[_0x531209(0x161)],'usdcPolygonWallet':_0x36a2b0[_0x531209(0x15e)]},'status':_0x36a2b0[_0x531209(0x145)],'createdAt':_0x36a2b0[_0x531209(0x14e)]};}async[a57_0x563aa7(0x153)](_0x303517){const _0x347f7d=a57_0x563aa7;await database_1[_0x347f7d(0x151)][_0x347f7d(0x154)][_0x347f7d(0x172)]({'where':{'id':_0x303517}});}}exports[a57_0x563aa7(0x149)]=UserService;