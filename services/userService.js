'use strict';const a61_0x20d042=a61_0x3080;(function(_0x3574c6,_0x1b6596){const _0xa8697a=a61_0x3080,_0x345510=_0x3574c6();while(!![]){try{const _0x1e3df1=-parseInt(_0xa8697a(0x173))/0x1+parseInt(_0xa8697a(0x143))/0x2*(parseInt(_0xa8697a(0x174))/0x3)+-parseInt(_0xa8697a(0x153))/0x4+parseInt(_0xa8697a(0x144))/0x5*(parseInt(_0xa8697a(0x170))/0x6)+parseInt(_0xa8697a(0x15b))/0x7+parseInt(_0xa8697a(0x141))/0x8+parseInt(_0xa8697a(0x162))/0x9;if(_0x1e3df1===_0x1b6596)break;else _0x345510['push'](_0x345510['shift']());}catch(_0x176c0b){_0x345510['push'](_0x345510['shift']());}}}(a61_0x4595,0xe1e98));var __importDefault=this&&this[a61_0x20d042(0x16e)]||function(_0x1de045){return _0x1de045&&_0x1de045['__esModule']?_0x1de045:{'default':_0x1de045};};Object[a61_0x20d042(0x13e)](exports,'__esModule',{'value':!![]}),exports[a61_0x20d042(0x16a)]=void 0x0;function a61_0x3080(_0x33aa40,_0x318da2){const _0x459508=a61_0x4595();return a61_0x3080=function(_0x308090,_0x563699){_0x308090=_0x308090-0x13e;let _0xedfa77=_0x459508[_0x308090];return _0xedfa77;},a61_0x3080(_0x33aa40,_0x318da2);}const bcryptjs_1=__importDefault(require('bcryptjs')),crypto_1=__importDefault(require(a61_0x20d042(0x14f))),database_1=__importDefault(require(a61_0x20d042(0x156)));function a61_0x4595(){const _0x183c2e=['telegram','parse','generateApiKeys','__importDefault','deleteUser','348RSgXOb','status','Username\x20already\x20exists','1686466TvykQR','33dWtHhP','hex','name','defineProperty','usdcPolygonWallet','createUser','3469912iEDPVx','pk_','302322iFapPa','120990PySJKO','fullName','telegramId','update','ACTIVE','publicKey','password','map','stringify','shop','findMany','crypto','toString','merchantUrl','delete','6870060rsxnnB','usdtTrcWallet','randomBytes','../config/database','updateUser','shopUrl','createdAt','desc','2058665DTBYqF','username','getUserById','default','usdtErcWallet','sk_','usdtPolygonWallet','4817052tgQmPk','wallets','gateways','findUnique','create','hash','paymentGateways','gatewaySettings','UserService'];a61_0x4595=function(){return _0x183c2e;};return a61_0x4595();}class UserService{[a61_0x20d042(0x16d)](){const _0x444df8=a61_0x20d042,_0x3bc812=_0x444df8(0x142)+crypto_1['default']['randomBytes'](0x20)[_0x444df8(0x150)](_0x444df8(0x175)),_0x5ba3c8=_0x444df8(0x160)+crypto_1[_0x444df8(0x15e)][_0x444df8(0x155)](0x20)[_0x444df8(0x150)](_0x444df8(0x175));return{'publicKey':_0x3bc812,'secretKey':_0x5ba3c8};}async[a61_0x20d042(0x140)](_0x57abc9){const _0x195f02=a61_0x20d042,{fullName:_0x1c75e8,username:_0x264bf5,password:_0x3c2c3d,telegramId:_0x5ed084,merchantUrl:_0x48e623,gateways:_0x2f1a78,gatewaySettings:_0x2c6d99,wallets:_0x4c50ff}=_0x57abc9,_0x185fa5=await database_1[_0x195f02(0x15e)][_0x195f02(0x14d)][_0x195f02(0x165)]({'where':{'username':_0x264bf5}});if(_0x185fa5)throw new Error(_0x195f02(0x172));if(_0x5ed084){const _0x23de56=await database_1[_0x195f02(0x15e)][_0x195f02(0x14d)][_0x195f02(0x165)]({'where':{'telegram':_0x5ed084}});if(_0x23de56)throw new Error('Telegram\x20username\x20already\x20exists');}const _0x2a7158=await bcryptjs_1[_0x195f02(0x15e)][_0x195f02(0x167)](_0x3c2c3d,0xc),{publicKey:_0x4dccfd,secretKey:_0x3fbdc6}=this[_0x195f02(0x16d)](),_0x31b718=await database_1[_0x195f02(0x15e)][_0x195f02(0x14d)][_0x195f02(0x166)]({'data':{'name':_0x1c75e8,'username':_0x264bf5,'password':_0x2a7158,'telegram':_0x5ed084,'shopUrl':_0x48e623,'paymentGateways':_0x2f1a78?JSON[_0x195f02(0x14c)](_0x2f1a78):null,'gatewaySettings':_0x2c6d99?JSON[_0x195f02(0x14c)](_0x2c6d99):null,'usdtPolygonWallet':_0x4c50ff?.['usdtPolygonWallet']||null,'usdtTrcWallet':_0x4c50ff?.['usdtTrcWallet']||null,'usdtErcWallet':_0x4c50ff?.['usdtErcWallet']||null,'usdcPolygonWallet':_0x4c50ff?.[_0x195f02(0x13f)]||null,'publicKey':_0x4dccfd,'secretKey':_0x3fbdc6,'status':_0x195f02(0x148)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x31b718['id'],'fullName':_0x31b718[_0x195f02(0x176)],'username':_0x31b718['username'],'telegramId':_0x31b718['telegram'],'merchantUrl':_0x31b718[_0x195f02(0x158)],'gateways':_0x31b718['paymentGateways']?JSON[_0x195f02(0x16c)](_0x31b718[_0x195f02(0x168)]):null,'gatewaySettings':_0x31b718['gatewaySettings']?JSON[_0x195f02(0x16c)](_0x31b718[_0x195f02(0x169)]):null,'publicKey':_0x31b718[_0x195f02(0x149)],'wallets':{'usdtPolygonWallet':_0x31b718[_0x195f02(0x161)],'usdtTrcWallet':_0x31b718[_0x195f02(0x154)],'usdtErcWallet':_0x31b718['usdtErcWallet'],'usdcPolygonWallet':_0x31b718[_0x195f02(0x13f)]},'status':_0x31b718[_0x195f02(0x171)],'createdAt':_0x31b718['createdAt']};}async['getAllUsers'](){const _0x367cbb=a61_0x20d042,_0x4d6a3a=await database_1[_0x367cbb(0x15e)][_0x367cbb(0x14d)][_0x367cbb(0x14e)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x367cbb(0x15a)}});return _0x4d6a3a[_0x367cbb(0x14b)](_0x11f126=>({'id':_0x11f126['id'],'fullName':_0x11f126[_0x367cbb(0x176)],'username':_0x11f126[_0x367cbb(0x15c)],'telegramId':_0x11f126[_0x367cbb(0x16b)],'merchantUrl':_0x11f126[_0x367cbb(0x158)],'gateways':_0x11f126['paymentGateways']?JSON[_0x367cbb(0x16c)](_0x11f126['paymentGateways']):null,'gatewaySettings':_0x11f126[_0x367cbb(0x169)]?JSON[_0x367cbb(0x16c)](_0x11f126[_0x367cbb(0x169)]):null,'publicKey':_0x11f126['publicKey'],'wallets':{'usdtPolygonWallet':_0x11f126[_0x367cbb(0x161)],'usdtTrcWallet':_0x11f126[_0x367cbb(0x154)],'usdtErcWallet':_0x11f126[_0x367cbb(0x15f)],'usdcPolygonWallet':_0x11f126['usdcPolygonWallet']},'status':_0x11f126[_0x367cbb(0x171)],'createdAt':_0x11f126[_0x367cbb(0x159)]}));}async[a61_0x20d042(0x15d)](_0x4e27c8){const _0x400d1d=a61_0x20d042,_0x3bd843=await database_1[_0x400d1d(0x15e)]['shop'][_0x400d1d(0x165)]({'where':{'id':_0x4e27c8},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x3bd843)return null;return{'id':_0x3bd843['id'],'fullName':_0x3bd843[_0x400d1d(0x176)],'username':_0x3bd843[_0x400d1d(0x15c)],'telegramId':_0x3bd843[_0x400d1d(0x16b)],'merchantUrl':_0x3bd843[_0x400d1d(0x158)],'gateways':_0x3bd843[_0x400d1d(0x168)]?JSON[_0x400d1d(0x16c)](_0x3bd843[_0x400d1d(0x168)]):null,'gatewaySettings':_0x3bd843[_0x400d1d(0x169)]?JSON[_0x400d1d(0x16c)](_0x3bd843['gatewaySettings']):null,'publicKey':_0x3bd843['publicKey'],'wallets':{'usdtPolygonWallet':_0x3bd843[_0x400d1d(0x161)],'usdtTrcWallet':_0x3bd843[_0x400d1d(0x154)],'usdtErcWallet':_0x3bd843[_0x400d1d(0x15f)],'usdcPolygonWallet':_0x3bd843['usdcPolygonWallet']},'status':_0x3bd843['status'],'createdAt':_0x3bd843[_0x400d1d(0x159)]};}async[a61_0x20d042(0x157)](_0x3de7a0,_0x179b2f){const _0x9731=a61_0x20d042,_0x50fd79={..._0x179b2f};_0x179b2f['password']&&(_0x50fd79['password']=await bcryptjs_1['default'][_0x9731(0x167)](_0x179b2f[_0x9731(0x14a)],0xc));_0x179b2f[_0x9731(0x145)]&&(_0x50fd79['name']=_0x179b2f['fullName'],delete _0x50fd79['fullName']);_0x179b2f[_0x9731(0x146)]&&(_0x50fd79[_0x9731(0x16b)]=_0x179b2f['telegramId'],delete _0x50fd79[_0x9731(0x146)]);_0x179b2f[_0x9731(0x151)]&&(_0x50fd79[_0x9731(0x158)]=_0x179b2f['merchantUrl'],delete _0x50fd79[_0x9731(0x151)]);_0x179b2f[_0x9731(0x164)]&&(_0x50fd79[_0x9731(0x168)]=JSON[_0x9731(0x14c)](_0x179b2f[_0x9731(0x164)]),delete _0x50fd79['gateways']);_0x179b2f[_0x9731(0x169)]&&(_0x50fd79['gatewaySettings']=JSON[_0x9731(0x14c)](_0x179b2f[_0x9731(0x169)]),delete _0x50fd79[_0x9731(0x169)]);_0x179b2f[_0x9731(0x163)]&&(_0x179b2f['wallets']['usdtPolygonWallet']!==undefined&&(_0x50fd79[_0x9731(0x161)]=_0x179b2f[_0x9731(0x163)]['usdtPolygonWallet']||null),_0x179b2f[_0x9731(0x163)][_0x9731(0x154)]!==undefined&&(_0x50fd79[_0x9731(0x154)]=_0x179b2f[_0x9731(0x163)]['usdtTrcWallet']||null),_0x179b2f[_0x9731(0x163)]['usdtErcWallet']!==undefined&&(_0x50fd79[_0x9731(0x15f)]=_0x179b2f['wallets'][_0x9731(0x15f)]||null),_0x179b2f[_0x9731(0x163)][_0x9731(0x13f)]!==undefined&&(_0x50fd79[_0x9731(0x13f)]=_0x179b2f[_0x9731(0x163)][_0x9731(0x13f)]||null),delete _0x50fd79[_0x9731(0x163)]);const _0x52ff50=await database_1['default']['shop'][_0x9731(0x147)]({'where':{'id':_0x3de7a0},'data':_0x50fd79,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x52ff50['id'],'fullName':_0x52ff50[_0x9731(0x176)],'username':_0x52ff50[_0x9731(0x15c)],'telegramId':_0x52ff50['telegram'],'merchantUrl':_0x52ff50[_0x9731(0x158)],'gateways':_0x52ff50['paymentGateways']?JSON[_0x9731(0x16c)](_0x52ff50[_0x9731(0x168)]):null,'gatewaySettings':_0x52ff50[_0x9731(0x169)]?JSON[_0x9731(0x16c)](_0x52ff50['gatewaySettings']):null,'publicKey':_0x52ff50['publicKey'],'wallets':{'usdtPolygonWallet':_0x52ff50[_0x9731(0x161)],'usdtTrcWallet':_0x52ff50['usdtTrcWallet'],'usdtErcWallet':_0x52ff50[_0x9731(0x15f)],'usdcPolygonWallet':_0x52ff50[_0x9731(0x13f)]},'status':_0x52ff50[_0x9731(0x171)],'createdAt':_0x52ff50['createdAt']};}async[a61_0x20d042(0x16f)](_0x4c1171){const _0x1a65bb=a61_0x20d042;await database_1[_0x1a65bb(0x15e)][_0x1a65bb(0x14d)][_0x1a65bb(0x152)]({'where':{'id':_0x4c1171}});}}exports[a61_0x20d042(0x16a)]=UserService;