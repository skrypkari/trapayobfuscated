'use strict';const a59_0x57ce6e=a59_0x4211;(function(_0x4834bf,_0x41ac4b){const _0x100ad9=a59_0x4211,_0x583e6d=_0x4834bf();while(!![]){try{const _0x34dee6=parseInt(_0x100ad9(0x8f))/0x1+-parseInt(_0x100ad9(0xbb))/0x2+-parseInt(_0x100ad9(0xb4))/0x3*(parseInt(_0x100ad9(0xbc))/0x4)+-parseInt(_0x100ad9(0xbf))/0x5*(-parseInt(_0x100ad9(0x9c))/0x6)+-parseInt(_0x100ad9(0xbe))/0x7+-parseInt(_0x100ad9(0xa1))/0x8+parseInt(_0x100ad9(0xa6))/0x9;if(_0x34dee6===_0x41ac4b)break;else _0x583e6d['push'](_0x583e6d['shift']());}catch(_0x10b3a8){_0x583e6d['push'](_0x583e6d['shift']());}}}(a59_0x320d,0xcdff9));function a59_0x320d(){const _0x5b609e=['getUserById','3ShmzQA','shopUrl','merchantUrl','randomBytes','map','Telegram\x20username\x20already\x20exists','usdcPolygonWallet','804822eCsiuY','6477972FcxibM','paymentGateways','10404905YYTRTQ','4755995RuQSdL','username','telegramId','shop','parse','__esModule','619898KKWBbW','generateApiKeys','usdtTrcWallet','pk_','name','deleteUser','gatewaySettings','status','telegram','publicKey','usdtErcWallet','findUnique','getAllUsers','6sVkNxq','usdtPolygonWallet','stringify','defineProperty','bcryptjs','4776024mHRSGW','hex','crypto','default','update','30401946fXsmKA','sk_','password','createUser','gateways','hash','ACTIVE','create','wallets','createdAt','UserService','fullName','toString'];a59_0x320d=function(){return _0x5b609e;};return a59_0x320d();}var __importDefault=this&&this['__importDefault']||function(_0x37a27f){const _0x525e95=a59_0x4211;return _0x37a27f&&_0x37a27f[_0x525e95(0x8e)]?_0x37a27f:{'default':_0x37a27f};};Object[a59_0x57ce6e(0x9f)](exports,a59_0x57ce6e(0x8e),{'value':!![]}),exports[a59_0x57ce6e(0xb0)]=void 0x0;const bcryptjs_1=__importDefault(require(a59_0x57ce6e(0xa0))),crypto_1=__importDefault(require(a59_0x57ce6e(0xa3))),database_1=__importDefault(require('../config/database'));class UserService{[a59_0x57ce6e(0x90)](){const _0x53e870=a59_0x57ce6e,_0x45cd1d=_0x53e870(0x92)+crypto_1[_0x53e870(0xa4)][_0x53e870(0xb7)](0x20)['toString']('hex'),_0x1b3ff5=_0x53e870(0xa7)+crypto_1[_0x53e870(0xa4)][_0x53e870(0xb7)](0x20)[_0x53e870(0xb2)](_0x53e870(0xa2));return{'publicKey':_0x45cd1d,'secretKey':_0x1b3ff5};}async[a59_0x57ce6e(0xa9)](_0x533bef){const _0x14d5e5=a59_0x57ce6e,{fullName:_0x595b3b,username:_0x4219e4,password:_0xfacc39,telegramId:_0x5cefbe,merchantUrl:_0x4bd0eb,gateways:_0x5052c5,gatewaySettings:_0x3e0edd,wallets:_0xc1b4eb}=_0x533bef,_0x3c1613=await database_1[_0x14d5e5(0xa4)][_0x14d5e5(0xc2)][_0x14d5e5(0x9a)]({'where':{'username':_0x4219e4}});if(_0x3c1613)throw new Error('Username\x20already\x20exists');if(_0x5cefbe){const _0x1f7962=await database_1['default']['shop']['findUnique']({'where':{'telegram':_0x5cefbe}});if(_0x1f7962)throw new Error(_0x14d5e5(0xb9));}const _0x295e86=await bcryptjs_1[_0x14d5e5(0xa4)][_0x14d5e5(0xab)](_0xfacc39,0xc),{publicKey:_0x5af62b,secretKey:_0x57f917}=this[_0x14d5e5(0x90)](),_0x4d8209=await database_1[_0x14d5e5(0xa4)][_0x14d5e5(0xc2)][_0x14d5e5(0xad)]({'data':{'name':_0x595b3b,'username':_0x4219e4,'password':_0x295e86,'telegram':_0x5cefbe,'shopUrl':_0x4bd0eb,'paymentGateways':_0x5052c5?JSON['stringify'](_0x5052c5):null,'gatewaySettings':_0x3e0edd?JSON['stringify'](_0x3e0edd):null,'usdtPolygonWallet':_0xc1b4eb?.[_0x14d5e5(0x9d)]||null,'usdtTrcWallet':_0xc1b4eb?.['usdtTrcWallet']||null,'usdtErcWallet':_0xc1b4eb?.[_0x14d5e5(0x99)]||null,'usdcPolygonWallet':_0xc1b4eb?.[_0x14d5e5(0xba)]||null,'publicKey':_0x5af62b,'secretKey':_0x57f917,'status':_0x14d5e5(0xac)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x4d8209['id'],'fullName':_0x4d8209[_0x14d5e5(0x93)],'username':_0x4d8209[_0x14d5e5(0xc0)],'telegramId':_0x4d8209[_0x14d5e5(0x97)],'merchantUrl':_0x4d8209[_0x14d5e5(0xb5)],'gateways':_0x4d8209[_0x14d5e5(0xbd)]?JSON[_0x14d5e5(0xc3)](_0x4d8209[_0x14d5e5(0xbd)]):null,'gatewaySettings':_0x4d8209[_0x14d5e5(0x95)]?JSON[_0x14d5e5(0xc3)](_0x4d8209[_0x14d5e5(0x95)]):null,'publicKey':_0x4d8209['publicKey'],'wallets':{'usdtPolygonWallet':_0x4d8209['usdtPolygonWallet'],'usdtTrcWallet':_0x4d8209[_0x14d5e5(0x91)],'usdtErcWallet':_0x4d8209[_0x14d5e5(0x99)],'usdcPolygonWallet':_0x4d8209[_0x14d5e5(0xba)]},'status':_0x4d8209[_0x14d5e5(0x96)],'createdAt':_0x4d8209[_0x14d5e5(0xaf)]};}async[a59_0x57ce6e(0x9b)](){const _0x375f6c=a59_0x57ce6e,_0x4854e6=await database_1['default'][_0x375f6c(0xc2)]['findMany']({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':'desc'}});return _0x4854e6[_0x375f6c(0xb8)](_0x5004bd=>({'id':_0x5004bd['id'],'fullName':_0x5004bd[_0x375f6c(0x93)],'username':_0x5004bd[_0x375f6c(0xc0)],'telegramId':_0x5004bd[_0x375f6c(0x97)],'merchantUrl':_0x5004bd['shopUrl'],'gateways':_0x5004bd[_0x375f6c(0xbd)]?JSON[_0x375f6c(0xc3)](_0x5004bd[_0x375f6c(0xbd)]):null,'gatewaySettings':_0x5004bd['gatewaySettings']?JSON[_0x375f6c(0xc3)](_0x5004bd['gatewaySettings']):null,'publicKey':_0x5004bd[_0x375f6c(0x98)],'wallets':{'usdtPolygonWallet':_0x5004bd[_0x375f6c(0x9d)],'usdtTrcWallet':_0x5004bd[_0x375f6c(0x91)],'usdtErcWallet':_0x5004bd[_0x375f6c(0x99)],'usdcPolygonWallet':_0x5004bd[_0x375f6c(0xba)]},'status':_0x5004bd[_0x375f6c(0x96)],'createdAt':_0x5004bd[_0x375f6c(0xaf)]}));}async[a59_0x57ce6e(0xb3)](_0xd07f8f){const _0x7658dd=a59_0x57ce6e,_0x5acfc6=await database_1[_0x7658dd(0xa4)]['shop'][_0x7658dd(0x9a)]({'where':{'id':_0xd07f8f},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x5acfc6)return null;return{'id':_0x5acfc6['id'],'fullName':_0x5acfc6[_0x7658dd(0x93)],'username':_0x5acfc6[_0x7658dd(0xc0)],'telegramId':_0x5acfc6['telegram'],'merchantUrl':_0x5acfc6[_0x7658dd(0xb5)],'gateways':_0x5acfc6[_0x7658dd(0xbd)]?JSON['parse'](_0x5acfc6['paymentGateways']):null,'gatewaySettings':_0x5acfc6[_0x7658dd(0x95)]?JSON[_0x7658dd(0xc3)](_0x5acfc6['gatewaySettings']):null,'publicKey':_0x5acfc6[_0x7658dd(0x98)],'wallets':{'usdtPolygonWallet':_0x5acfc6[_0x7658dd(0x9d)],'usdtTrcWallet':_0x5acfc6[_0x7658dd(0x91)],'usdtErcWallet':_0x5acfc6['usdtErcWallet'],'usdcPolygonWallet':_0x5acfc6['usdcPolygonWallet']},'status':_0x5acfc6[_0x7658dd(0x96)],'createdAt':_0x5acfc6['createdAt']};}async['updateUser'](_0x48ec45,_0x2ae06a){const _0x4faede=a59_0x57ce6e,_0x326186={..._0x2ae06a};_0x2ae06a[_0x4faede(0xa8)]&&(_0x326186[_0x4faede(0xa8)]=await bcryptjs_1[_0x4faede(0xa4)]['hash'](_0x2ae06a['password'],0xc));_0x2ae06a['fullName']&&(_0x326186[_0x4faede(0x93)]=_0x2ae06a[_0x4faede(0xb1)],delete _0x326186[_0x4faede(0xb1)]);_0x2ae06a[_0x4faede(0xc1)]&&(_0x326186[_0x4faede(0x97)]=_0x2ae06a[_0x4faede(0xc1)],delete _0x326186[_0x4faede(0xc1)]);_0x2ae06a['merchantUrl']&&(_0x326186[_0x4faede(0xb5)]=_0x2ae06a[_0x4faede(0xb6)],delete _0x326186[_0x4faede(0xb6)]);_0x2ae06a['gateways']&&(_0x326186[_0x4faede(0xbd)]=JSON[_0x4faede(0x9e)](_0x2ae06a[_0x4faede(0xaa)]),delete _0x326186[_0x4faede(0xaa)]);_0x2ae06a['gatewaySettings']&&(_0x326186[_0x4faede(0x95)]=JSON[_0x4faede(0x9e)](_0x2ae06a[_0x4faede(0x95)]),delete _0x326186[_0x4faede(0x95)]);_0x2ae06a['wallets']&&(_0x2ae06a[_0x4faede(0xae)]['usdtPolygonWallet']!==undefined&&(_0x326186['usdtPolygonWallet']=_0x2ae06a[_0x4faede(0xae)][_0x4faede(0x9d)]||null),_0x2ae06a[_0x4faede(0xae)][_0x4faede(0x91)]!==undefined&&(_0x326186[_0x4faede(0x91)]=_0x2ae06a[_0x4faede(0xae)][_0x4faede(0x91)]||null),_0x2ae06a['wallets'][_0x4faede(0x99)]!==undefined&&(_0x326186[_0x4faede(0x99)]=_0x2ae06a['wallets']['usdtErcWallet']||null),_0x2ae06a[_0x4faede(0xae)]['usdcPolygonWallet']!==undefined&&(_0x326186[_0x4faede(0xba)]=_0x2ae06a['wallets']['usdcPolygonWallet']||null),delete _0x326186[_0x4faede(0xae)]);const _0x586565=await database_1[_0x4faede(0xa4)][_0x4faede(0xc2)][_0x4faede(0xa5)]({'where':{'id':_0x48ec45},'data':_0x326186,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x586565['id'],'fullName':_0x586565[_0x4faede(0x93)],'username':_0x586565[_0x4faede(0xc0)],'telegramId':_0x586565[_0x4faede(0x97)],'merchantUrl':_0x586565[_0x4faede(0xb5)],'gateways':_0x586565[_0x4faede(0xbd)]?JSON['parse'](_0x586565['paymentGateways']):null,'gatewaySettings':_0x586565[_0x4faede(0x95)]?JSON[_0x4faede(0xc3)](_0x586565[_0x4faede(0x95)]):null,'publicKey':_0x586565['publicKey'],'wallets':{'usdtPolygonWallet':_0x586565['usdtPolygonWallet'],'usdtTrcWallet':_0x586565[_0x4faede(0x91)],'usdtErcWallet':_0x586565[_0x4faede(0x99)],'usdcPolygonWallet':_0x586565[_0x4faede(0xba)]},'status':_0x586565[_0x4faede(0x96)],'createdAt':_0x586565[_0x4faede(0xaf)]};}async[a59_0x57ce6e(0x94)](_0x1dc5f8){const _0x506e36=a59_0x57ce6e;await database_1['default'][_0x506e36(0xc2)]['delete']({'where':{'id':_0x1dc5f8}});}}function a59_0x4211(_0x2c20a9,_0x2b5d50){const _0x320d39=a59_0x320d();return a59_0x4211=function(_0x421137,_0x29e076){_0x421137=_0x421137-0x8e;let _0x4552b5=_0x320d39[_0x421137];return _0x4552b5;},a59_0x4211(_0x2c20a9,_0x2b5d50);}exports[a59_0x57ce6e(0xb0)]=UserService;