'use strict';const a61_0x2af871=a61_0x181a;(function(_0x2ce1f7,_0x2dab65){const _0x33a288=a61_0x181a,_0x1b8bd8=_0x2ce1f7();while(!![]){try{const _0x2c3676=-parseInt(_0x33a288(0x15e))/0x1+parseInt(_0x33a288(0x166))/0x2*(parseInt(_0x33a288(0x17d))/0x3)+-parseInt(_0x33a288(0x171))/0x4+-parseInt(_0x33a288(0x180))/0x5*(-parseInt(_0x33a288(0x178))/0x6)+-parseInt(_0x33a288(0x182))/0x7+parseInt(_0x33a288(0x164))/0x8*(-parseInt(_0x33a288(0x17a))/0x9)+parseInt(_0x33a288(0x17b))/0xa*(parseInt(_0x33a288(0x16f))/0xb);if(_0x2c3676===_0x2dab65)break;else _0x1b8bd8['push'](_0x1b8bd8['shift']());}catch(_0x3e23a3){_0x1b8bd8['push'](_0x1b8bd8['shift']());}}}(a61_0x3cd0,0x37b7b));var __importDefault=this&&this[a61_0x2af871(0x159)]||function(_0x32d6b1){const _0x44b21e=a61_0x2af871;return _0x32d6b1&&_0x32d6b1[_0x44b21e(0x157)]?_0x32d6b1:{'default':_0x32d6b1};};Object[a61_0x2af871(0x175)](exports,'__esModule',{'value':!![]}),exports['UserService']=void 0x0;function a61_0x181a(_0x29f024,_0x2ef729){const _0x3cd08c=a61_0x3cd0();return a61_0x181a=function(_0x181aeb,_0x2192df){_0x181aeb=_0x181aeb-0x153;let _0x1376e6=_0x3cd08c[_0x181aeb];return _0x1376e6;},a61_0x181a(_0x29f024,_0x2ef729);}const bcryptjs_1=__importDefault(require(a61_0x2af871(0x154))),crypto_1=__importDefault(require(a61_0x2af871(0x185))),database_1=__importDefault(require('../config/database'));function a61_0x3cd0(){const _0x2bf449=['password','32796zTexVP','telegram','9639VxcCuc','1907690JFjeFC','delete','21315OPLcfH','usdtTrcWallet','gatewaySettings','380WeqJMU','parse','3186659ZAIRHP','stringify','sk_','crypto','publicKey','deleteUser','update','createUser','findMany','hash','bcryptjs','updateUser','status','__esModule','usdcPolygonWallet','__importDefault','name','fullName','desc','toString','201867JWTWSI','wallets','username','UserService','Username\x20already\x20exists','generateApiKeys','1592QcgaMH','Telegram\x20username\x20already\x20exists','114pxYVvx','merchantUrl','default','createdAt','pk_','shop','usdtPolygonWallet','telegramId','paymentGateways','33drkKLk','usdtErcWallet','1177024DwHDZP','shopUrl','randomBytes','gateways','defineProperty','findUnique'];a61_0x3cd0=function(){return _0x2bf449;};return a61_0x3cd0();}class UserService{[a61_0x2af871(0x163)](){const _0x1af419=a61_0x2af871,_0x522bd5=_0x1af419(0x16a)+crypto_1[_0x1af419(0x168)][_0x1af419(0x173)](0x20)[_0x1af419(0x15d)]('hex'),_0x5e1b95=_0x1af419(0x184)+crypto_1[_0x1af419(0x168)]['randomBytes'](0x20)[_0x1af419(0x15d)]('hex');return{'publicKey':_0x522bd5,'secretKey':_0x5e1b95};}async[a61_0x2af871(0x189)](_0x491a02){const _0x245888=a61_0x2af871,{fullName:_0x300c39,username:_0x200521,password:_0x2cce3e,telegramId:_0x573ffc,merchantUrl:_0x174c76,gateways:_0x57845f,gatewaySettings:_0x272936,wallets:_0x2db34c}=_0x491a02,_0x2e0feb=await database_1[_0x245888(0x168)][_0x245888(0x16b)]['findUnique']({'where':{'username':_0x200521}});if(_0x2e0feb)throw new Error(_0x245888(0x162));if(_0x573ffc){const _0x166bf8=await database_1[_0x245888(0x168)][_0x245888(0x16b)][_0x245888(0x176)]({'where':{'telegram':_0x573ffc}});if(_0x166bf8)throw new Error(_0x245888(0x165));}const _0x3c095b=await bcryptjs_1[_0x245888(0x168)]['hash'](_0x2cce3e,0xc),{publicKey:_0x907d46,secretKey:_0x16d971}=this[_0x245888(0x163)](),_0x437ca4=await database_1['default'][_0x245888(0x16b)]['create']({'data':{'name':_0x300c39,'username':_0x200521,'password':_0x3c095b,'telegram':_0x573ffc,'shopUrl':_0x174c76,'paymentGateways':_0x57845f?JSON['stringify'](_0x57845f):null,'gatewaySettings':_0x272936?JSON[_0x245888(0x183)](_0x272936):null,'usdtPolygonWallet':_0x2db34c?.[_0x245888(0x16c)]||null,'usdtTrcWallet':_0x2db34c?.[_0x245888(0x17e)]||null,'usdtErcWallet':_0x2db34c?.[_0x245888(0x170)]||null,'usdcPolygonWallet':_0x2db34c?.[_0x245888(0x158)]||null,'publicKey':_0x907d46,'secretKey':_0x16d971,'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x437ca4['id'],'fullName':_0x437ca4['name'],'username':_0x437ca4[_0x245888(0x160)],'telegramId':_0x437ca4['telegram'],'merchantUrl':_0x437ca4[_0x245888(0x172)],'gateways':_0x437ca4['paymentGateways']?JSON[_0x245888(0x181)](_0x437ca4[_0x245888(0x16e)]):null,'gatewaySettings':_0x437ca4[_0x245888(0x17f)]?JSON[_0x245888(0x181)](_0x437ca4[_0x245888(0x17f)]):null,'publicKey':_0x437ca4[_0x245888(0x186)],'wallets':{'usdtPolygonWallet':_0x437ca4[_0x245888(0x16c)],'usdtTrcWallet':_0x437ca4[_0x245888(0x17e)],'usdtErcWallet':_0x437ca4[_0x245888(0x170)],'usdcPolygonWallet':_0x437ca4[_0x245888(0x158)]},'status':_0x437ca4[_0x245888(0x156)],'createdAt':_0x437ca4['createdAt']};}async['getAllUsers'](){const _0x310326=a61_0x2af871,_0x3a0c2f=await database_1['default'][_0x310326(0x16b)][_0x310326(0x18a)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x310326(0x15c)}});return _0x3a0c2f['map'](_0x55e9b3=>({'id':_0x55e9b3['id'],'fullName':_0x55e9b3[_0x310326(0x15a)],'username':_0x55e9b3[_0x310326(0x160)],'telegramId':_0x55e9b3[_0x310326(0x179)],'merchantUrl':_0x55e9b3['shopUrl'],'gateways':_0x55e9b3[_0x310326(0x16e)]?JSON[_0x310326(0x181)](_0x55e9b3[_0x310326(0x16e)]):null,'gatewaySettings':_0x55e9b3['gatewaySettings']?JSON[_0x310326(0x181)](_0x55e9b3[_0x310326(0x17f)]):null,'publicKey':_0x55e9b3[_0x310326(0x186)],'wallets':{'usdtPolygonWallet':_0x55e9b3[_0x310326(0x16c)],'usdtTrcWallet':_0x55e9b3[_0x310326(0x17e)],'usdtErcWallet':_0x55e9b3[_0x310326(0x170)],'usdcPolygonWallet':_0x55e9b3[_0x310326(0x158)]},'status':_0x55e9b3[_0x310326(0x156)],'createdAt':_0x55e9b3[_0x310326(0x169)]}));}async['getUserById'](_0x11c30f){const _0x2bc6a1=a61_0x2af871,_0x18fee7=await database_1[_0x2bc6a1(0x168)][_0x2bc6a1(0x16b)][_0x2bc6a1(0x176)]({'where':{'id':_0x11c30f},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x18fee7)return null;return{'id':_0x18fee7['id'],'fullName':_0x18fee7[_0x2bc6a1(0x15a)],'username':_0x18fee7[_0x2bc6a1(0x160)],'telegramId':_0x18fee7[_0x2bc6a1(0x179)],'merchantUrl':_0x18fee7[_0x2bc6a1(0x172)],'gateways':_0x18fee7['paymentGateways']?JSON[_0x2bc6a1(0x181)](_0x18fee7[_0x2bc6a1(0x16e)]):null,'gatewaySettings':_0x18fee7[_0x2bc6a1(0x17f)]?JSON[_0x2bc6a1(0x181)](_0x18fee7['gatewaySettings']):null,'publicKey':_0x18fee7[_0x2bc6a1(0x186)],'wallets':{'usdtPolygonWallet':_0x18fee7[_0x2bc6a1(0x16c)],'usdtTrcWallet':_0x18fee7[_0x2bc6a1(0x17e)],'usdtErcWallet':_0x18fee7['usdtErcWallet'],'usdcPolygonWallet':_0x18fee7[_0x2bc6a1(0x158)]},'status':_0x18fee7[_0x2bc6a1(0x156)],'createdAt':_0x18fee7[_0x2bc6a1(0x169)]};}async[a61_0x2af871(0x155)](_0xe6d6e7,_0x3fbd89){const _0x32ab83=a61_0x2af871,_0x3e1db3={..._0x3fbd89};_0x3fbd89['password']&&(_0x3e1db3['password']=await bcryptjs_1['default'][_0x32ab83(0x153)](_0x3fbd89[_0x32ab83(0x177)],0xc));_0x3fbd89[_0x32ab83(0x15b)]&&(_0x3e1db3['name']=_0x3fbd89['fullName'],delete _0x3e1db3[_0x32ab83(0x15b)]);_0x3fbd89[_0x32ab83(0x16d)]&&(_0x3e1db3[_0x32ab83(0x179)]=_0x3fbd89[_0x32ab83(0x16d)],delete _0x3e1db3[_0x32ab83(0x16d)]);_0x3fbd89[_0x32ab83(0x167)]&&(_0x3e1db3['shopUrl']=_0x3fbd89[_0x32ab83(0x167)],delete _0x3e1db3[_0x32ab83(0x167)]);_0x3fbd89[_0x32ab83(0x174)]&&(_0x3e1db3[_0x32ab83(0x16e)]=JSON[_0x32ab83(0x183)](_0x3fbd89[_0x32ab83(0x174)]),delete _0x3e1db3[_0x32ab83(0x174)]);_0x3fbd89['gatewaySettings']&&(_0x3e1db3[_0x32ab83(0x17f)]=JSON[_0x32ab83(0x183)](_0x3fbd89['gatewaySettings']),delete _0x3e1db3[_0x32ab83(0x17f)]);_0x3fbd89[_0x32ab83(0x15f)]&&(_0x3fbd89['wallets']['usdtPolygonWallet']!==undefined&&(_0x3e1db3[_0x32ab83(0x16c)]=_0x3fbd89[_0x32ab83(0x15f)][_0x32ab83(0x16c)]||null),_0x3fbd89[_0x32ab83(0x15f)][_0x32ab83(0x17e)]!==undefined&&(_0x3e1db3[_0x32ab83(0x17e)]=_0x3fbd89[_0x32ab83(0x15f)][_0x32ab83(0x17e)]||null),_0x3fbd89[_0x32ab83(0x15f)]['usdtErcWallet']!==undefined&&(_0x3e1db3[_0x32ab83(0x170)]=_0x3fbd89['wallets'][_0x32ab83(0x170)]||null),_0x3fbd89[_0x32ab83(0x15f)][_0x32ab83(0x158)]!==undefined&&(_0x3e1db3[_0x32ab83(0x158)]=_0x3fbd89[_0x32ab83(0x15f)][_0x32ab83(0x158)]||null),delete _0x3e1db3['wallets']);const _0x56400f=await database_1[_0x32ab83(0x168)][_0x32ab83(0x16b)][_0x32ab83(0x188)]({'where':{'id':_0xe6d6e7},'data':_0x3e1db3,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x56400f['id'],'fullName':_0x56400f[_0x32ab83(0x15a)],'username':_0x56400f[_0x32ab83(0x160)],'telegramId':_0x56400f[_0x32ab83(0x179)],'merchantUrl':_0x56400f[_0x32ab83(0x172)],'gateways':_0x56400f['paymentGateways']?JSON['parse'](_0x56400f[_0x32ab83(0x16e)]):null,'gatewaySettings':_0x56400f[_0x32ab83(0x17f)]?JSON[_0x32ab83(0x181)](_0x56400f[_0x32ab83(0x17f)]):null,'publicKey':_0x56400f[_0x32ab83(0x186)],'wallets':{'usdtPolygonWallet':_0x56400f[_0x32ab83(0x16c)],'usdtTrcWallet':_0x56400f[_0x32ab83(0x17e)],'usdtErcWallet':_0x56400f[_0x32ab83(0x170)],'usdcPolygonWallet':_0x56400f['usdcPolygonWallet']},'status':_0x56400f[_0x32ab83(0x156)],'createdAt':_0x56400f[_0x32ab83(0x169)]};}async[a61_0x2af871(0x187)](_0x1cae09){const _0x2ec02d=a61_0x2af871;await database_1[_0x2ec02d(0x168)]['shop'][_0x2ec02d(0x17c)]({'where':{'id':_0x1cae09}});}}exports[a61_0x2af871(0x161)]=UserService;