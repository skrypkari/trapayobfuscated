'use strict';function a56_0x145d(_0x1f385c,_0x12dbbe){const _0x172ff9=a56_0x172f();return a56_0x145d=function(_0x145d11,_0x350053){_0x145d11=_0x145d11-0x1b6;let _0x217014=_0x172ff9[_0x145d11];return _0x217014;},a56_0x145d(_0x1f385c,_0x12dbbe);}const a56_0x26e932=a56_0x145d;function a56_0x172f(){const _0xe0d323=['parse','toString','288UOOiMO','shop','8cbCdtX','UserService','1557670HcNGLT','gatewaySettings','status','18LhHNoo','getAllUsers','updateUser','map','gateways','hash','usdcPolygonWallet','randomBytes','1179794kuYADH','wallets','password','update','shopUrl','createUser','default','7531910kpKqJf','ACTIVE','2315229ezqfOd','crypto','publicKey','getUserById','fullName','62gmPism','__esModule','paymentGateways','hex','deleteUser','defineProperty','stringify','5422712ggeBUj','Username\x20already\x20exists','merchantUrl','createdAt','__importDefault','usdtPolygonWallet','name','bcryptjs','telegramId','generateApiKeys','username','237664GikrSG','pk_','delete','telegram','findUnique','3190MutNdD','findMany','sk_','usdtErcWallet','usdtTrcWallet'];a56_0x172f=function(){return _0xe0d323;};return a56_0x172f();}(function(_0x25d5f0,_0xe1247a){const _0x341269=a56_0x145d,_0x583dc4=_0x25d5f0();while(!![]){try{const _0x5ea523=-parseInt(_0x341269(0x1ea))/0x1*(parseInt(_0x341269(0x1d3))/0x2)+parseInt(_0x341269(0x1ce))/0x3+-parseInt(_0x341269(0x1b8))/0x4*(parseInt(_0x341269(0x1ba))/0x5)+-parseInt(_0x341269(0x1b6))/0x6*(-parseInt(_0x341269(0x1e5))/0x7)+parseInt(_0x341269(0x1da))/0x8*(-parseInt(_0x341269(0x1bd))/0x9)+parseInt(_0x341269(0x1cc))/0xa+-parseInt(_0x341269(0x1c5))/0xb;if(_0x5ea523===_0xe1247a)break;else _0x583dc4['push'](_0x583dc4['shift']());}catch(_0x2e9e07){_0x583dc4['push'](_0x583dc4['shift']());}}}(a56_0x172f,0xecc0c));var __importDefault=this&&this[a56_0x26e932(0x1de)]||function(_0x2b9e5e){const _0x1a9265=a56_0x26e932;return _0x2b9e5e&&_0x2b9e5e[_0x1a9265(0x1d4)]?_0x2b9e5e:{'default':_0x2b9e5e};};Object[a56_0x26e932(0x1d8)](exports,a56_0x26e932(0x1d4),{'value':!![]}),exports['UserService']=void 0x0;const bcryptjs_1=__importDefault(require(a56_0x26e932(0x1e1))),crypto_1=__importDefault(require(a56_0x26e932(0x1cf))),database_1=__importDefault(require('../config/database'));class UserService{[a56_0x26e932(0x1e3)](){const _0x5db09d=a56_0x26e932,_0x27b88e=_0x5db09d(0x1e6)+crypto_1[_0x5db09d(0x1cb)][_0x5db09d(0x1c4)](0x20)[_0x5db09d(0x1f0)](_0x5db09d(0x1d6)),_0xb83fe6=_0x5db09d(0x1ec)+crypto_1[_0x5db09d(0x1cb)]['randomBytes'](0x20)[_0x5db09d(0x1f0)](_0x5db09d(0x1d6));return{'publicKey':_0x27b88e,'secretKey':_0xb83fe6};}async[a56_0x26e932(0x1ca)](_0x532b68){const _0x5dad53=a56_0x26e932,{fullName:_0x3bf8f3,username:_0x343642,password:_0x33c023,telegramId:_0x38cc52,merchantUrl:_0x16b15f,gateways:_0x2cdaad,gatewaySettings:_0x6ac858,wallets:_0x184c7b}=_0x532b68,_0x7ce8d=await database_1[_0x5dad53(0x1cb)][_0x5dad53(0x1b7)]['findUnique']({'where':{'username':_0x343642}});if(_0x7ce8d)throw new Error(_0x5dad53(0x1db));if(_0x38cc52){const _0x172ebe=await database_1['default'][_0x5dad53(0x1b7)][_0x5dad53(0x1e9)]({'where':{'telegram':_0x38cc52}});if(_0x172ebe)throw new Error('Telegram\x20username\x20already\x20exists');}const _0x34aa0e=await bcryptjs_1[_0x5dad53(0x1cb)][_0x5dad53(0x1c2)](_0x33c023,0xc),{publicKey:_0x51a802,secretKey:_0x3e39a6}=this['generateApiKeys'](),_0x489172=await database_1[_0x5dad53(0x1cb)]['shop']['create']({'data':{'name':_0x3bf8f3,'username':_0x343642,'password':_0x34aa0e,'telegram':_0x38cc52,'shopUrl':_0x16b15f,'paymentGateways':_0x2cdaad?JSON[_0x5dad53(0x1d9)](_0x2cdaad):null,'gatewaySettings':_0x6ac858?JSON[_0x5dad53(0x1d9)](_0x6ac858):null,'usdtPolygonWallet':_0x184c7b?.[_0x5dad53(0x1df)]||null,'usdtTrcWallet':_0x184c7b?.[_0x5dad53(0x1ee)]||null,'usdtErcWallet':_0x184c7b?.[_0x5dad53(0x1ed)]||null,'usdcPolygonWallet':_0x184c7b?.['usdcPolygonWallet']||null,'publicKey':_0x51a802,'secretKey':_0x3e39a6,'status':_0x5dad53(0x1cd)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x489172['id'],'fullName':_0x489172['name'],'username':_0x489172[_0x5dad53(0x1e4)],'telegramId':_0x489172['telegram'],'merchantUrl':_0x489172['shopUrl'],'gateways':_0x489172[_0x5dad53(0x1d5)]?JSON[_0x5dad53(0x1ef)](_0x489172[_0x5dad53(0x1d5)]):null,'gatewaySettings':_0x489172[_0x5dad53(0x1bb)]?JSON[_0x5dad53(0x1ef)](_0x489172[_0x5dad53(0x1bb)]):null,'publicKey':_0x489172['publicKey'],'wallets':{'usdtPolygonWallet':_0x489172[_0x5dad53(0x1df)],'usdtTrcWallet':_0x489172[_0x5dad53(0x1ee)],'usdtErcWallet':_0x489172[_0x5dad53(0x1ed)],'usdcPolygonWallet':_0x489172[_0x5dad53(0x1c3)]},'status':_0x489172[_0x5dad53(0x1bc)],'createdAt':_0x489172[_0x5dad53(0x1dd)]};}async[a56_0x26e932(0x1be)](){const _0x14b303=a56_0x26e932,_0x5cf3e1=await database_1['default'][_0x14b303(0x1b7)][_0x14b303(0x1eb)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':'desc'}});return _0x5cf3e1[_0x14b303(0x1c0)](_0x57b68b=>({'id':_0x57b68b['id'],'fullName':_0x57b68b[_0x14b303(0x1e0)],'username':_0x57b68b[_0x14b303(0x1e4)],'telegramId':_0x57b68b[_0x14b303(0x1e8)],'merchantUrl':_0x57b68b['shopUrl'],'gateways':_0x57b68b[_0x14b303(0x1d5)]?JSON[_0x14b303(0x1ef)](_0x57b68b[_0x14b303(0x1d5)]):null,'gatewaySettings':_0x57b68b[_0x14b303(0x1bb)]?JSON['parse'](_0x57b68b['gatewaySettings']):null,'publicKey':_0x57b68b[_0x14b303(0x1d0)],'wallets':{'usdtPolygonWallet':_0x57b68b['usdtPolygonWallet'],'usdtTrcWallet':_0x57b68b[_0x14b303(0x1ee)],'usdtErcWallet':_0x57b68b[_0x14b303(0x1ed)],'usdcPolygonWallet':_0x57b68b[_0x14b303(0x1c3)]},'status':_0x57b68b[_0x14b303(0x1bc)],'createdAt':_0x57b68b[_0x14b303(0x1dd)]}));}async[a56_0x26e932(0x1d1)](_0x4d87b9){const _0x275966=a56_0x26e932,_0x3801a3=await database_1['default'][_0x275966(0x1b7)]['findUnique']({'where':{'id':_0x4d87b9},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x3801a3)return null;return{'id':_0x3801a3['id'],'fullName':_0x3801a3[_0x275966(0x1e0)],'username':_0x3801a3[_0x275966(0x1e4)],'telegramId':_0x3801a3['telegram'],'merchantUrl':_0x3801a3[_0x275966(0x1c9)],'gateways':_0x3801a3[_0x275966(0x1d5)]?JSON[_0x275966(0x1ef)](_0x3801a3[_0x275966(0x1d5)]):null,'gatewaySettings':_0x3801a3[_0x275966(0x1bb)]?JSON['parse'](_0x3801a3['gatewaySettings']):null,'publicKey':_0x3801a3[_0x275966(0x1d0)],'wallets':{'usdtPolygonWallet':_0x3801a3[_0x275966(0x1df)],'usdtTrcWallet':_0x3801a3[_0x275966(0x1ee)],'usdtErcWallet':_0x3801a3[_0x275966(0x1ed)],'usdcPolygonWallet':_0x3801a3['usdcPolygonWallet']},'status':_0x3801a3[_0x275966(0x1bc)],'createdAt':_0x3801a3['createdAt']};}async[a56_0x26e932(0x1bf)](_0x40ac90,_0x1efe3f){const _0x101c78=a56_0x26e932,_0x5db3f0={..._0x1efe3f};_0x1efe3f[_0x101c78(0x1c7)]&&(_0x5db3f0[_0x101c78(0x1c7)]=await bcryptjs_1['default'][_0x101c78(0x1c2)](_0x1efe3f['password'],0xc));_0x1efe3f[_0x101c78(0x1d2)]&&(_0x5db3f0[_0x101c78(0x1e0)]=_0x1efe3f[_0x101c78(0x1d2)],delete _0x5db3f0[_0x101c78(0x1d2)]);_0x1efe3f[_0x101c78(0x1e2)]&&(_0x5db3f0[_0x101c78(0x1e8)]=_0x1efe3f['telegramId'],delete _0x5db3f0[_0x101c78(0x1e2)]);_0x1efe3f[_0x101c78(0x1dc)]&&(_0x5db3f0[_0x101c78(0x1c9)]=_0x1efe3f['merchantUrl'],delete _0x5db3f0[_0x101c78(0x1dc)]);_0x1efe3f['gateways']&&(_0x5db3f0[_0x101c78(0x1d5)]=JSON[_0x101c78(0x1d9)](_0x1efe3f[_0x101c78(0x1c1)]),delete _0x5db3f0[_0x101c78(0x1c1)]);_0x1efe3f['gatewaySettings']&&(_0x5db3f0['gatewaySettings']=JSON[_0x101c78(0x1d9)](_0x1efe3f['gatewaySettings']),delete _0x5db3f0[_0x101c78(0x1bb)]);_0x1efe3f[_0x101c78(0x1c6)]&&(_0x1efe3f[_0x101c78(0x1c6)][_0x101c78(0x1df)]!==undefined&&(_0x5db3f0[_0x101c78(0x1df)]=_0x1efe3f[_0x101c78(0x1c6)]['usdtPolygonWallet']||null),_0x1efe3f['wallets'][_0x101c78(0x1ee)]!==undefined&&(_0x5db3f0[_0x101c78(0x1ee)]=_0x1efe3f[_0x101c78(0x1c6)][_0x101c78(0x1ee)]||null),_0x1efe3f[_0x101c78(0x1c6)]['usdtErcWallet']!==undefined&&(_0x5db3f0[_0x101c78(0x1ed)]=_0x1efe3f[_0x101c78(0x1c6)][_0x101c78(0x1ed)]||null),_0x1efe3f[_0x101c78(0x1c6)][_0x101c78(0x1c3)]!==undefined&&(_0x5db3f0[_0x101c78(0x1c3)]=_0x1efe3f[_0x101c78(0x1c6)][_0x101c78(0x1c3)]||null),delete _0x5db3f0[_0x101c78(0x1c6)]);const _0x422a96=await database_1[_0x101c78(0x1cb)][_0x101c78(0x1b7)][_0x101c78(0x1c8)]({'where':{'id':_0x40ac90},'data':_0x5db3f0,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x422a96['id'],'fullName':_0x422a96[_0x101c78(0x1e0)],'username':_0x422a96['username'],'telegramId':_0x422a96[_0x101c78(0x1e8)],'merchantUrl':_0x422a96[_0x101c78(0x1c9)],'gateways':_0x422a96[_0x101c78(0x1d5)]?JSON[_0x101c78(0x1ef)](_0x422a96[_0x101c78(0x1d5)]):null,'gatewaySettings':_0x422a96[_0x101c78(0x1bb)]?JSON[_0x101c78(0x1ef)](_0x422a96[_0x101c78(0x1bb)]):null,'publicKey':_0x422a96['publicKey'],'wallets':{'usdtPolygonWallet':_0x422a96[_0x101c78(0x1df)],'usdtTrcWallet':_0x422a96['usdtTrcWallet'],'usdtErcWallet':_0x422a96['usdtErcWallet'],'usdcPolygonWallet':_0x422a96[_0x101c78(0x1c3)]},'status':_0x422a96[_0x101c78(0x1bc)],'createdAt':_0x422a96[_0x101c78(0x1dd)]};}async[a56_0x26e932(0x1d7)](_0xcceec4){const _0x4934e4=a56_0x26e932;await database_1['default'][_0x4934e4(0x1b7)][_0x4934e4(0x1e7)]({'where':{'id':_0xcceec4}});}}exports[a56_0x26e932(0x1b9)]=UserService;