'use strict';function a63_0x4611(_0x49c977,_0x4265fa){const _0x2dd2d3=a63_0x2dd2();return a63_0x4611=function(_0x461118,_0x4f4919){_0x461118=_0x461118-0x1de;let _0x29ed59=_0x2dd2d3[_0x461118];return _0x29ed59;},a63_0x4611(_0x49c977,_0x4265fa);}const a63_0x361f40=a63_0x4611;(function(_0x2f608d,_0x105ff3){const _0x3909f0=a63_0x4611,_0x507114=_0x2f608d();while(!![]){try{const _0x1e1ef9=-parseInt(_0x3909f0(0x1fb))/0x1*(parseInt(_0x3909f0(0x217))/0x2)+-parseInt(_0x3909f0(0x215))/0x3*(-parseInt(_0x3909f0(0x201))/0x4)+parseInt(_0x3909f0(0x1e5))/0x5*(parseInt(_0x3909f0(0x1e2))/0x6)+-parseInt(_0x3909f0(0x205))/0x7*(-parseInt(_0x3909f0(0x1ec))/0x8)+-parseInt(_0x3909f0(0x1ef))/0x9+-parseInt(_0x3909f0(0x1fa))/0xa*(parseInt(_0x3909f0(0x208))/0xb)+parseInt(_0x3909f0(0x20f))/0xc;if(_0x1e1ef9===_0x105ff3)break;else _0x507114['push'](_0x507114['shift']());}catch(_0x3364f8){_0x507114['push'](_0x507114['shift']());}}}(a63_0x2dd2,0xbc8cc));function a63_0x2dd2(){const _0x4c1a7f=['hash','publicKey','845yJvsUM','stringify','sk_','delete','telegramId','findMany','createUser','29984sdjRhc','usdtErcWallet','status','9837144zGYbyd','Telegram\x20username\x20already\x20exists','shop','create','shopUrl','generateApiKeys','pk_','password','bcryptjs','usdtTrcWallet','name','10KLOuaK','3FJSztf','findUnique','usdcPolygonWallet','ACTIVE','createdAt','gateways','4gaioIW','defineProperty','getUserById','getAllUsers','2149aGHIil','desc','telegram','8594421ytIlHh','map','update','gatewaySettings','hex','randomBytes','fullName','23426472DhSAOs','username','parse','toString','__esModule','usdtPolygonWallet','2020293ZhYbFQ','UserService','974262xYSDjN','default','merchantUrl','wallets','paymentGateways','11778thHXax'];a63_0x2dd2=function(){return _0x4c1a7f;};return a63_0x2dd2();}var __importDefault=this&&this['__importDefault']||function(_0x47b52f){return _0x47b52f&&_0x47b52f['__esModule']?_0x47b52f:{'default':_0x47b52f};};Object[a63_0x361f40(0x202)](exports,a63_0x361f40(0x213),{'value':!![]}),exports[a63_0x361f40(0x216)]=void 0x0;const bcryptjs_1=__importDefault(require(a63_0x361f40(0x1f7))),crypto_1=__importDefault(require('crypto')),database_1=__importDefault(require('../config/database'));class UserService{[a63_0x361f40(0x1f4)](){const _0x4122c5=a63_0x361f40,_0x2c7415=_0x4122c5(0x1f5)+crypto_1[_0x4122c5(0x1de)][_0x4122c5(0x20d)](0x20)['toString'](_0x4122c5(0x20c)),_0x3e19ad=_0x4122c5(0x1e7)+crypto_1[_0x4122c5(0x1de)][_0x4122c5(0x20d)](0x20)[_0x4122c5(0x212)](_0x4122c5(0x20c));return{'publicKey':_0x2c7415,'secretKey':_0x3e19ad};}async[a63_0x361f40(0x1eb)](_0x383074){const _0x30c5c9=a63_0x361f40,{fullName:_0x4b3513,username:_0x55f8e9,password:_0x4b34c,telegramId:_0x40a615,merchantUrl:_0x29e6e0,gateways:_0x1fedc5,gatewaySettings:_0x36b5bc,wallets:_0x2a25ed}=_0x383074,_0x224017=await database_1['default'][_0x30c5c9(0x1f1)][_0x30c5c9(0x1fc)]({'where':{'username':_0x55f8e9}});if(_0x224017)throw new Error('Username\x20already\x20exists');if(_0x40a615){const _0x5011b1=await database_1[_0x30c5c9(0x1de)][_0x30c5c9(0x1f1)][_0x30c5c9(0x1fc)]({'where':{'telegram':_0x40a615}});if(_0x5011b1)throw new Error(_0x30c5c9(0x1f0));}const _0x5794dd=await bcryptjs_1['default'][_0x30c5c9(0x1e3)](_0x4b34c,0xc),{publicKey:_0x55274a,secretKey:_0x34a50f}=this[_0x30c5c9(0x1f4)](),_0x4536e5=await database_1['default'][_0x30c5c9(0x1f1)][_0x30c5c9(0x1f2)]({'data':{'name':_0x4b3513,'username':_0x55f8e9,'password':_0x5794dd,'telegram':_0x40a615,'shopUrl':_0x29e6e0,'paymentGateways':_0x1fedc5?JSON['stringify'](_0x1fedc5):null,'gatewaySettings':_0x36b5bc?JSON[_0x30c5c9(0x1e6)](_0x36b5bc):null,'usdtPolygonWallet':_0x2a25ed?.[_0x30c5c9(0x214)]||null,'usdtTrcWallet':_0x2a25ed?.['usdtTrcWallet']||null,'usdtErcWallet':_0x2a25ed?.[_0x30c5c9(0x1ed)]||null,'usdcPolygonWallet':_0x2a25ed?.[_0x30c5c9(0x1fd)]||null,'publicKey':_0x55274a,'secretKey':_0x34a50f,'status':_0x30c5c9(0x1fe)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x4536e5['id'],'fullName':_0x4536e5[_0x30c5c9(0x1f9)],'username':_0x4536e5[_0x30c5c9(0x210)],'telegramId':_0x4536e5['telegram'],'merchantUrl':_0x4536e5[_0x30c5c9(0x1f3)],'gateways':_0x4536e5[_0x30c5c9(0x1e1)]?JSON[_0x30c5c9(0x211)](_0x4536e5[_0x30c5c9(0x1e1)]):null,'gatewaySettings':_0x4536e5['gatewaySettings']?JSON[_0x30c5c9(0x211)](_0x4536e5[_0x30c5c9(0x20b)]):null,'publicKey':_0x4536e5[_0x30c5c9(0x1e4)],'wallets':{'usdtPolygonWallet':_0x4536e5[_0x30c5c9(0x214)],'usdtTrcWallet':_0x4536e5['usdtTrcWallet'],'usdtErcWallet':_0x4536e5[_0x30c5c9(0x1ed)],'usdcPolygonWallet':_0x4536e5[_0x30c5c9(0x1fd)]},'status':_0x4536e5[_0x30c5c9(0x1ee)],'createdAt':_0x4536e5[_0x30c5c9(0x1ff)]};}async[a63_0x361f40(0x204)](){const _0x24a889=a63_0x361f40,_0x1debce=await database_1[_0x24a889(0x1de)]['shop'][_0x24a889(0x1ea)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x24a889(0x206)}});return _0x1debce[_0x24a889(0x209)](_0x39ac40=>({'id':_0x39ac40['id'],'fullName':_0x39ac40['name'],'username':_0x39ac40[_0x24a889(0x210)],'telegramId':_0x39ac40['telegram'],'merchantUrl':_0x39ac40[_0x24a889(0x1f3)],'gateways':_0x39ac40['paymentGateways']?JSON[_0x24a889(0x211)](_0x39ac40[_0x24a889(0x1e1)]):null,'gatewaySettings':_0x39ac40[_0x24a889(0x20b)]?JSON[_0x24a889(0x211)](_0x39ac40[_0x24a889(0x20b)]):null,'publicKey':_0x39ac40[_0x24a889(0x1e4)],'wallets':{'usdtPolygonWallet':_0x39ac40[_0x24a889(0x214)],'usdtTrcWallet':_0x39ac40[_0x24a889(0x1f8)],'usdtErcWallet':_0x39ac40['usdtErcWallet'],'usdcPolygonWallet':_0x39ac40[_0x24a889(0x1fd)]},'status':_0x39ac40[_0x24a889(0x1ee)],'createdAt':_0x39ac40[_0x24a889(0x1ff)]}));}async[a63_0x361f40(0x203)](_0x5d67d7){const _0x164af2=a63_0x361f40,_0x56607f=await database_1[_0x164af2(0x1de)][_0x164af2(0x1f1)][_0x164af2(0x1fc)]({'where':{'id':_0x5d67d7},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x56607f)return null;return{'id':_0x56607f['id'],'fullName':_0x56607f[_0x164af2(0x1f9)],'username':_0x56607f[_0x164af2(0x210)],'telegramId':_0x56607f[_0x164af2(0x207)],'merchantUrl':_0x56607f[_0x164af2(0x1f3)],'gateways':_0x56607f[_0x164af2(0x1e1)]?JSON[_0x164af2(0x211)](_0x56607f[_0x164af2(0x1e1)]):null,'gatewaySettings':_0x56607f[_0x164af2(0x20b)]?JSON[_0x164af2(0x211)](_0x56607f[_0x164af2(0x20b)]):null,'publicKey':_0x56607f[_0x164af2(0x1e4)],'wallets':{'usdtPolygonWallet':_0x56607f['usdtPolygonWallet'],'usdtTrcWallet':_0x56607f[_0x164af2(0x1f8)],'usdtErcWallet':_0x56607f['usdtErcWallet'],'usdcPolygonWallet':_0x56607f[_0x164af2(0x1fd)]},'status':_0x56607f[_0x164af2(0x1ee)],'createdAt':_0x56607f[_0x164af2(0x1ff)]};}async['updateUser'](_0x4ea365,_0x4db4ad){const _0x148db0=a63_0x361f40,_0x39a84b={..._0x4db4ad};_0x4db4ad[_0x148db0(0x1f6)]&&(_0x39a84b[_0x148db0(0x1f6)]=await bcryptjs_1[_0x148db0(0x1de)][_0x148db0(0x1e3)](_0x4db4ad[_0x148db0(0x1f6)],0xc));_0x4db4ad[_0x148db0(0x20e)]&&(_0x39a84b[_0x148db0(0x1f9)]=_0x4db4ad[_0x148db0(0x20e)],delete _0x39a84b[_0x148db0(0x20e)]);_0x4db4ad['telegramId']&&(_0x39a84b[_0x148db0(0x207)]=_0x4db4ad['telegramId'],delete _0x39a84b[_0x148db0(0x1e9)]);_0x4db4ad[_0x148db0(0x1df)]&&(_0x39a84b[_0x148db0(0x1f3)]=_0x4db4ad[_0x148db0(0x1df)],delete _0x39a84b[_0x148db0(0x1df)]);_0x4db4ad[_0x148db0(0x200)]&&(_0x39a84b[_0x148db0(0x1e1)]=JSON[_0x148db0(0x1e6)](_0x4db4ad[_0x148db0(0x200)]),delete _0x39a84b[_0x148db0(0x200)]);_0x4db4ad[_0x148db0(0x20b)]&&(_0x39a84b[_0x148db0(0x20b)]=JSON[_0x148db0(0x1e6)](_0x4db4ad['gatewaySettings']),delete _0x39a84b[_0x148db0(0x20b)]);_0x4db4ad[_0x148db0(0x1e0)]&&(_0x4db4ad['wallets'][_0x148db0(0x214)]!==undefined&&(_0x39a84b[_0x148db0(0x214)]=_0x4db4ad[_0x148db0(0x1e0)][_0x148db0(0x214)]||null),_0x4db4ad[_0x148db0(0x1e0)][_0x148db0(0x1f8)]!==undefined&&(_0x39a84b[_0x148db0(0x1f8)]=_0x4db4ad[_0x148db0(0x1e0)][_0x148db0(0x1f8)]||null),_0x4db4ad[_0x148db0(0x1e0)][_0x148db0(0x1ed)]!==undefined&&(_0x39a84b[_0x148db0(0x1ed)]=_0x4db4ad['wallets'][_0x148db0(0x1ed)]||null),_0x4db4ad[_0x148db0(0x1e0)][_0x148db0(0x1fd)]!==undefined&&(_0x39a84b[_0x148db0(0x1fd)]=_0x4db4ad[_0x148db0(0x1e0)]['usdcPolygonWallet']||null),delete _0x39a84b[_0x148db0(0x1e0)]);const _0x194a2f=await database_1[_0x148db0(0x1de)][_0x148db0(0x1f1)][_0x148db0(0x20a)]({'where':{'id':_0x4ea365},'data':_0x39a84b,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x194a2f['id'],'fullName':_0x194a2f[_0x148db0(0x1f9)],'username':_0x194a2f['username'],'telegramId':_0x194a2f[_0x148db0(0x207)],'merchantUrl':_0x194a2f[_0x148db0(0x1f3)],'gateways':_0x194a2f['paymentGateways']?JSON[_0x148db0(0x211)](_0x194a2f[_0x148db0(0x1e1)]):null,'gatewaySettings':_0x194a2f['gatewaySettings']?JSON[_0x148db0(0x211)](_0x194a2f[_0x148db0(0x20b)]):null,'publicKey':_0x194a2f[_0x148db0(0x1e4)],'wallets':{'usdtPolygonWallet':_0x194a2f[_0x148db0(0x214)],'usdtTrcWallet':_0x194a2f[_0x148db0(0x1f8)],'usdtErcWallet':_0x194a2f[_0x148db0(0x1ed)],'usdcPolygonWallet':_0x194a2f[_0x148db0(0x1fd)]},'status':_0x194a2f[_0x148db0(0x1ee)],'createdAt':_0x194a2f[_0x148db0(0x1ff)]};}async['deleteUser'](_0x1db810){const _0x109472=a63_0x361f40;await database_1[_0x109472(0x1de)][_0x109472(0x1f1)][_0x109472(0x1e8)]({'where':{'id':_0x1db810}});}}exports[a63_0x361f40(0x216)]=UserService;