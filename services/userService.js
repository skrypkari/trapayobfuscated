'use strict';const a51_0x42bb83=a51_0x1d48;(function(_0x117305,_0x314f07){const _0xcff99d=a51_0x1d48,_0x5d98e7=_0x117305();while(!![]){try{const _0x3299da=-parseInt(_0xcff99d(0xb6))/0x1*(parseInt(_0xcff99d(0xd1))/0x2)+parseInt(_0xcff99d(0xc2))/0x3*(parseInt(_0xcff99d(0xdf))/0x4)+parseInt(_0xcff99d(0xd6))/0x5*(-parseInt(_0xcff99d(0xc4))/0x6)+-parseInt(_0xcff99d(0xdc))/0x7+-parseInt(_0xcff99d(0xb3))/0x8+parseInt(_0xcff99d(0xd5))/0x9+parseInt(_0xcff99d(0xca))/0xa;if(_0x3299da===_0x314f07)break;else _0x5d98e7['push'](_0x5d98e7['shift']());}catch(_0x220c38){_0x5d98e7['push'](_0x5d98e7['shift']());}}}(a51_0x5e97,0x7bedb));var __importDefault=this&&this[a51_0x42bb83(0xae)]||function(_0x419aa3){const _0x49506f=a51_0x42bb83;return _0x419aa3&&_0x419aa3[_0x49506f(0xda)]?_0x419aa3:{'default':_0x419aa3};};function a51_0x1d48(_0x1100d8,_0x3db5f9){const _0x5e97fe=a51_0x5e97();return a51_0x1d48=function(_0x1d484e,_0x3bf0eb){_0x1d484e=_0x1d484e-0xac;let _0xa6bdc9=_0x5e97fe[_0x1d484e];return _0xa6bdc9;},a51_0x1d48(_0x1100d8,_0x3db5f9);}function a51_0x5e97(){const _0x27b099=['getAllUsers','__esModule','publicKey','5368482HKvXAc','stringify','gateways','2730368OvKxlo','wallets','Username\x20already\x20exists','paymentGateways','usdcPolygonWallet','Telegram\x20username\x20already\x20exists','__importDefault','username','usdtErcWallet','UserService','parse','1356296EyzGej','delete','getUserById','1654YsrUmZ','toString','defineProperty','usdtTrcWallet','hex','usdtPolygonWallet','shopUrl','gatewaySettings','ACTIVE','generateApiKeys','name','hash','3qQJLOk','createUser','42qVbtBE','sk_','telegram','shop','randomBytes','fullName','17780360lrhwRy','crypto','findMany','createdAt','bcryptjs','default','findUnique','698CNCejI','telegramId','merchantUrl','create','4653225kHbttA','683095pBTTtI','status','password'];a51_0x5e97=function(){return _0x27b099;};return a51_0x5e97();}Object[a51_0x42bb83(0xb8)](exports,a51_0x42bb83(0xda),{'value':!![]}),exports[a51_0x42bb83(0xb1)]=void 0x0;const bcryptjs_1=__importDefault(require(a51_0x42bb83(0xce))),crypto_1=__importDefault(require(a51_0x42bb83(0xcb))),database_1=__importDefault(require('../config/database'));class UserService{[a51_0x42bb83(0xbf)](){const _0x4c11b2=a51_0x42bb83,_0x51bcbd='pk_'+crypto_1[_0x4c11b2(0xcf)][_0x4c11b2(0xc8)](0x20)[_0x4c11b2(0xb7)](_0x4c11b2(0xba)),_0x58ec12=_0x4c11b2(0xc5)+crypto_1['default'][_0x4c11b2(0xc8)](0x20)[_0x4c11b2(0xb7)](_0x4c11b2(0xba));return{'publicKey':_0x51bcbd,'secretKey':_0x58ec12};}async[a51_0x42bb83(0xc3)](_0x1a93d0){const _0x571219=a51_0x42bb83,{fullName:_0x459c6c,username:_0x510aa3,password:_0xc0f022,telegramId:_0x243f3d,merchantUrl:_0xcae8fd,gateways:_0x2d43bc,gatewaySettings:_0x49292f,wallets:_0x518b05}=_0x1a93d0,_0x16b901=await database_1[_0x571219(0xcf)][_0x571219(0xc7)]['findUnique']({'where':{'username':_0x510aa3}});if(_0x16b901)throw new Error(_0x571219(0xe1));if(_0x243f3d){const _0x3865e2=await database_1[_0x571219(0xcf)]['shop'][_0x571219(0xd0)]({'where':{'telegram':_0x243f3d}});if(_0x3865e2)throw new Error(_0x571219(0xad));}const _0x13bb82=await bcryptjs_1[_0x571219(0xcf)][_0x571219(0xc1)](_0xc0f022,0xc),{publicKey:_0xddac03,secretKey:_0x489aa3}=this['generateApiKeys'](),_0x496454=await database_1[_0x571219(0xcf)]['shop'][_0x571219(0xd4)]({'data':{'name':_0x459c6c,'username':_0x510aa3,'password':_0x13bb82,'telegram':_0x243f3d,'shopUrl':_0xcae8fd,'paymentGateways':_0x2d43bc?JSON[_0x571219(0xdd)](_0x2d43bc):null,'gatewaySettings':_0x49292f?JSON[_0x571219(0xdd)](_0x49292f):null,'usdtPolygonWallet':_0x518b05?.[_0x571219(0xbb)]||null,'usdtTrcWallet':_0x518b05?.[_0x571219(0xb9)]||null,'usdtErcWallet':_0x518b05?.[_0x571219(0xb0)]||null,'usdcPolygonWallet':_0x518b05?.[_0x571219(0xac)]||null,'publicKey':_0xddac03,'secretKey':_0x489aa3,'status':_0x571219(0xbe)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x496454['id'],'fullName':_0x496454[_0x571219(0xc0)],'username':_0x496454[_0x571219(0xaf)],'telegramId':_0x496454['telegram'],'merchantUrl':_0x496454[_0x571219(0xbc)],'gateways':_0x496454[_0x571219(0xe2)]?JSON[_0x571219(0xb2)](_0x496454[_0x571219(0xe2)]):null,'gatewaySettings':_0x496454[_0x571219(0xbd)]?JSON[_0x571219(0xb2)](_0x496454[_0x571219(0xbd)]):null,'publicKey':_0x496454[_0x571219(0xdb)],'wallets':{'usdtPolygonWallet':_0x496454['usdtPolygonWallet'],'usdtTrcWallet':_0x496454[_0x571219(0xb9)],'usdtErcWallet':_0x496454['usdtErcWallet'],'usdcPolygonWallet':_0x496454['usdcPolygonWallet']},'status':_0x496454['status'],'createdAt':_0x496454[_0x571219(0xcd)]};}async[a51_0x42bb83(0xd9)](){const _0x4763bd=a51_0x42bb83,_0x25ae66=await database_1['default']['shop'][_0x4763bd(0xcc)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':'desc'}});return _0x25ae66['map'](_0x4a968c=>({'id':_0x4a968c['id'],'fullName':_0x4a968c['name'],'username':_0x4a968c['username'],'telegramId':_0x4a968c[_0x4763bd(0xc6)],'merchantUrl':_0x4a968c[_0x4763bd(0xbc)],'gateways':_0x4a968c['paymentGateways']?JSON[_0x4763bd(0xb2)](_0x4a968c['paymentGateways']):null,'gatewaySettings':_0x4a968c['gatewaySettings']?JSON[_0x4763bd(0xb2)](_0x4a968c[_0x4763bd(0xbd)]):null,'publicKey':_0x4a968c[_0x4763bd(0xdb)],'wallets':{'usdtPolygonWallet':_0x4a968c[_0x4763bd(0xbb)],'usdtTrcWallet':_0x4a968c[_0x4763bd(0xb9)],'usdtErcWallet':_0x4a968c['usdtErcWallet'],'usdcPolygonWallet':_0x4a968c['usdcPolygonWallet']},'status':_0x4a968c[_0x4763bd(0xd7)],'createdAt':_0x4a968c[_0x4763bd(0xcd)]}));}async[a51_0x42bb83(0xb5)](_0x5bc553){const _0x4c74a4=a51_0x42bb83,_0x199d07=await database_1[_0x4c74a4(0xcf)][_0x4c74a4(0xc7)]['findUnique']({'where':{'id':_0x5bc553},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x199d07)return null;return{'id':_0x199d07['id'],'fullName':_0x199d07[_0x4c74a4(0xc0)],'username':_0x199d07['username'],'telegramId':_0x199d07['telegram'],'merchantUrl':_0x199d07['shopUrl'],'gateways':_0x199d07[_0x4c74a4(0xe2)]?JSON[_0x4c74a4(0xb2)](_0x199d07['paymentGateways']):null,'gatewaySettings':_0x199d07['gatewaySettings']?JSON['parse'](_0x199d07['gatewaySettings']):null,'publicKey':_0x199d07['publicKey'],'wallets':{'usdtPolygonWallet':_0x199d07[_0x4c74a4(0xbb)],'usdtTrcWallet':_0x199d07[_0x4c74a4(0xb9)],'usdtErcWallet':_0x199d07[_0x4c74a4(0xb0)],'usdcPolygonWallet':_0x199d07['usdcPolygonWallet']},'status':_0x199d07[_0x4c74a4(0xd7)],'createdAt':_0x199d07[_0x4c74a4(0xcd)]};}async['updateUser'](_0x28416b,_0x1e3516){const _0x2a13a1=a51_0x42bb83,_0x5f03c1={..._0x1e3516};_0x1e3516[_0x2a13a1(0xd8)]&&(_0x5f03c1['password']=await bcryptjs_1['default'][_0x2a13a1(0xc1)](_0x1e3516[_0x2a13a1(0xd8)],0xc));_0x1e3516[_0x2a13a1(0xc9)]&&(_0x5f03c1['name']=_0x1e3516[_0x2a13a1(0xc9)],delete _0x5f03c1['fullName']);_0x1e3516[_0x2a13a1(0xd2)]&&(_0x5f03c1[_0x2a13a1(0xc6)]=_0x1e3516['telegramId'],delete _0x5f03c1[_0x2a13a1(0xd2)]);_0x1e3516[_0x2a13a1(0xd3)]&&(_0x5f03c1[_0x2a13a1(0xbc)]=_0x1e3516[_0x2a13a1(0xd3)],delete _0x5f03c1['merchantUrl']);_0x1e3516['gateways']&&(_0x5f03c1[_0x2a13a1(0xe2)]=JSON[_0x2a13a1(0xdd)](_0x1e3516[_0x2a13a1(0xde)]),delete _0x5f03c1[_0x2a13a1(0xde)]);_0x1e3516['gatewaySettings']&&(_0x5f03c1[_0x2a13a1(0xbd)]=JSON[_0x2a13a1(0xdd)](_0x1e3516[_0x2a13a1(0xbd)]),delete _0x5f03c1[_0x2a13a1(0xbd)]);_0x1e3516[_0x2a13a1(0xe0)]&&(_0x1e3516[_0x2a13a1(0xe0)][_0x2a13a1(0xbb)]!==undefined&&(_0x5f03c1[_0x2a13a1(0xbb)]=_0x1e3516[_0x2a13a1(0xe0)][_0x2a13a1(0xbb)]||null),_0x1e3516['wallets'][_0x2a13a1(0xb9)]!==undefined&&(_0x5f03c1[_0x2a13a1(0xb9)]=_0x1e3516['wallets'][_0x2a13a1(0xb9)]||null),_0x1e3516[_0x2a13a1(0xe0)][_0x2a13a1(0xb0)]!==undefined&&(_0x5f03c1['usdtErcWallet']=_0x1e3516['wallets']['usdtErcWallet']||null),_0x1e3516['wallets'][_0x2a13a1(0xac)]!==undefined&&(_0x5f03c1['usdcPolygonWallet']=_0x1e3516[_0x2a13a1(0xe0)][_0x2a13a1(0xac)]||null),delete _0x5f03c1[_0x2a13a1(0xe0)]);const _0x533259=await database_1[_0x2a13a1(0xcf)]['shop']['update']({'where':{'id':_0x28416b},'data':_0x5f03c1,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x533259['id'],'fullName':_0x533259['name'],'username':_0x533259[_0x2a13a1(0xaf)],'telegramId':_0x533259[_0x2a13a1(0xc6)],'merchantUrl':_0x533259['shopUrl'],'gateways':_0x533259[_0x2a13a1(0xe2)]?JSON['parse'](_0x533259[_0x2a13a1(0xe2)]):null,'gatewaySettings':_0x533259[_0x2a13a1(0xbd)]?JSON[_0x2a13a1(0xb2)](_0x533259[_0x2a13a1(0xbd)]):null,'publicKey':_0x533259[_0x2a13a1(0xdb)],'wallets':{'usdtPolygonWallet':_0x533259[_0x2a13a1(0xbb)],'usdtTrcWallet':_0x533259[_0x2a13a1(0xb9)],'usdtErcWallet':_0x533259['usdtErcWallet'],'usdcPolygonWallet':_0x533259['usdcPolygonWallet']},'status':_0x533259[_0x2a13a1(0xd7)],'createdAt':_0x533259[_0x2a13a1(0xcd)]};}async['deleteUser'](_0x2398da){const _0xdb2159=a51_0x42bb83;await database_1['default']['shop'][_0xdb2159(0xb4)]({'where':{'id':_0x2398da}});}}exports[a51_0x42bb83(0xb1)]=UserService;