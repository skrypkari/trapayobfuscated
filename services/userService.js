'use strict';const a56_0xb4dcbe=a56_0x4b4d;function a56_0x581f(){const _0x95c2a5=['default','telegramId','__importDefault','findMany','findUnique','usdtPolygonWallet','parse','382231QFFCoD','paymentGateways','desc','getAllUsers','shopUrl','status','crypto','1384032XkEJAA','bcryptjs','916994xLiqOe','password','ACTIVE','usdtErcWallet','gateways','UserService','hex','createUser','Telegram\x20username\x20already\x20exists','merchantUrl','stringify','4375HsTvSK','usdcPolygonWallet','5752vsieEF','delete','hash','pk_','fullName','wallets','Username\x20already\x20exists','182470qwyJJP','update','gatewaySettings','../config/database','920454FwZnHH','username','shop','name','623460NWecSX','publicKey','usdtTrcWallet','getUserById','telegram','deleteUser','sk_','createdAt'];a56_0x581f=function(){return _0x95c2a5;};return a56_0x581f();}(function(_0x3e2a0c,_0x35262b){const _0x2b4cbd=a56_0x4b4d,_0x238245=_0x3e2a0c();while(!![]){try{const _0x4d05f4=-parseInt(_0x2b4cbd(0x1d9))/0x1+-parseInt(_0x2b4cbd(0x1e2))/0x2+parseInt(_0x2b4cbd(0x1ca))/0x3+parseInt(_0x2b4cbd(0x1e0))/0x4+parseInt(_0x2b4cbd(0x1f6))/0x5+parseInt(_0x2b4cbd(0x1c6))/0x6+-parseInt(_0x2b4cbd(0x1ed))/0x7*(-parseInt(_0x2b4cbd(0x1ef))/0x8);if(_0x4d05f4===_0x35262b)break;else _0x238245['push'](_0x238245['shift']());}catch(_0x68ff4f){_0x238245['push'](_0x238245['shift']());}}}(a56_0x581f,0x5607a));var __importDefault=this&&this[a56_0xb4dcbe(0x1d4)]||function(_0x5b9dab){return _0x5b9dab&&_0x5b9dab['__esModule']?_0x5b9dab:{'default':_0x5b9dab};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a56_0xb4dcbe(0x1e7)]=void 0x0;const bcryptjs_1=__importDefault(require(a56_0xb4dcbe(0x1e1))),crypto_1=__importDefault(require(a56_0xb4dcbe(0x1df))),database_1=__importDefault(require(a56_0xb4dcbe(0x1f9)));class UserService{['generateApiKeys'](){const _0x29aa7c=a56_0xb4dcbe,_0x276c97=_0x29aa7c(0x1f2)+crypto_1[_0x29aa7c(0x1d2)]['randomBytes'](0x20)['toString'](_0x29aa7c(0x1e8)),_0x27ce22=_0x29aa7c(0x1d0)+crypto_1[_0x29aa7c(0x1d2)]['randomBytes'](0x20)['toString'](_0x29aa7c(0x1e8));return{'publicKey':_0x276c97,'secretKey':_0x27ce22};}async[a56_0xb4dcbe(0x1e9)](_0x3993ed){const _0x2d04fa=a56_0xb4dcbe,{fullName:_0x176127,username:_0x1758c9,password:_0x5bc2e3,telegramId:_0x1c2431,merchantUrl:_0x7729d0,gateways:_0x527baf,gatewaySettings:_0xa88c9f,wallets:_0x2a04ea}=_0x3993ed,_0x40460c=await database_1[_0x2d04fa(0x1d2)][_0x2d04fa(0x1c8)][_0x2d04fa(0x1d6)]({'where':{'username':_0x1758c9}});if(_0x40460c)throw new Error(_0x2d04fa(0x1f5));if(_0x1c2431){const _0x37d09c=await database_1[_0x2d04fa(0x1d2)][_0x2d04fa(0x1c8)][_0x2d04fa(0x1d6)]({'where':{'telegram':_0x1c2431}});if(_0x37d09c)throw new Error(_0x2d04fa(0x1ea));}const _0x1a147c=await bcryptjs_1[_0x2d04fa(0x1d2)][_0x2d04fa(0x1f1)](_0x5bc2e3,0xc),{publicKey:_0x521979,secretKey:_0x918090}=this['generateApiKeys'](),_0x56356b=await database_1[_0x2d04fa(0x1d2)][_0x2d04fa(0x1c8)]['create']({'data':{'name':_0x176127,'username':_0x1758c9,'password':_0x1a147c,'telegram':_0x1c2431,'shopUrl':_0x7729d0,'paymentGateways':_0x527baf?JSON[_0x2d04fa(0x1ec)](_0x527baf):null,'gatewaySettings':_0xa88c9f?JSON[_0x2d04fa(0x1ec)](_0xa88c9f):null,'usdtPolygonWallet':_0x2a04ea?.[_0x2d04fa(0x1d7)]||null,'usdtTrcWallet':_0x2a04ea?.[_0x2d04fa(0x1cc)]||null,'usdtErcWallet':_0x2a04ea?.['usdtErcWallet']||null,'usdcPolygonWallet':_0x2a04ea?.[_0x2d04fa(0x1ee)]||null,'publicKey':_0x521979,'secretKey':_0x918090,'status':_0x2d04fa(0x1e4)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x56356b['id'],'fullName':_0x56356b[_0x2d04fa(0x1c9)],'username':_0x56356b[_0x2d04fa(0x1c7)],'telegramId':_0x56356b[_0x2d04fa(0x1ce)],'merchantUrl':_0x56356b[_0x2d04fa(0x1dd)],'gateways':_0x56356b[_0x2d04fa(0x1da)]?JSON[_0x2d04fa(0x1d8)](_0x56356b[_0x2d04fa(0x1da)]):null,'gatewaySettings':_0x56356b[_0x2d04fa(0x1f8)]?JSON['parse'](_0x56356b['gatewaySettings']):null,'publicKey':_0x56356b['publicKey'],'wallets':{'usdtPolygonWallet':_0x56356b[_0x2d04fa(0x1d7)],'usdtTrcWallet':_0x56356b[_0x2d04fa(0x1cc)],'usdtErcWallet':_0x56356b[_0x2d04fa(0x1e5)],'usdcPolygonWallet':_0x56356b[_0x2d04fa(0x1ee)]},'status':_0x56356b['status'],'createdAt':_0x56356b[_0x2d04fa(0x1d1)]};}async[a56_0xb4dcbe(0x1dc)](){const _0x183655=a56_0xb4dcbe,_0x54c031=await database_1[_0x183655(0x1d2)]['shop'][_0x183655(0x1d5)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x183655(0x1db)}});return _0x54c031['map'](_0x1a93d9=>({'id':_0x1a93d9['id'],'fullName':_0x1a93d9['name'],'username':_0x1a93d9[_0x183655(0x1c7)],'telegramId':_0x1a93d9['telegram'],'merchantUrl':_0x1a93d9[_0x183655(0x1dd)],'gateways':_0x1a93d9[_0x183655(0x1da)]?JSON[_0x183655(0x1d8)](_0x1a93d9[_0x183655(0x1da)]):null,'gatewaySettings':_0x1a93d9[_0x183655(0x1f8)]?JSON[_0x183655(0x1d8)](_0x1a93d9[_0x183655(0x1f8)]):null,'publicKey':_0x1a93d9[_0x183655(0x1cb)],'wallets':{'usdtPolygonWallet':_0x1a93d9[_0x183655(0x1d7)],'usdtTrcWallet':_0x1a93d9[_0x183655(0x1cc)],'usdtErcWallet':_0x1a93d9[_0x183655(0x1e5)],'usdcPolygonWallet':_0x1a93d9[_0x183655(0x1ee)]},'status':_0x1a93d9['status'],'createdAt':_0x1a93d9[_0x183655(0x1d1)]}));}async[a56_0xb4dcbe(0x1cd)](_0x3e5800){const _0x3e177=a56_0xb4dcbe,_0x42ffcc=await database_1[_0x3e177(0x1d2)][_0x3e177(0x1c8)][_0x3e177(0x1d6)]({'where':{'id':_0x3e5800},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x42ffcc)return null;return{'id':_0x42ffcc['id'],'fullName':_0x42ffcc[_0x3e177(0x1c9)],'username':_0x42ffcc[_0x3e177(0x1c7)],'telegramId':_0x42ffcc[_0x3e177(0x1ce)],'merchantUrl':_0x42ffcc['shopUrl'],'gateways':_0x42ffcc[_0x3e177(0x1da)]?JSON['parse'](_0x42ffcc[_0x3e177(0x1da)]):null,'gatewaySettings':_0x42ffcc[_0x3e177(0x1f8)]?JSON['parse'](_0x42ffcc[_0x3e177(0x1f8)]):null,'publicKey':_0x42ffcc[_0x3e177(0x1cb)],'wallets':{'usdtPolygonWallet':_0x42ffcc['usdtPolygonWallet'],'usdtTrcWallet':_0x42ffcc[_0x3e177(0x1cc)],'usdtErcWallet':_0x42ffcc[_0x3e177(0x1e5)],'usdcPolygonWallet':_0x42ffcc[_0x3e177(0x1ee)]},'status':_0x42ffcc[_0x3e177(0x1de)],'createdAt':_0x42ffcc[_0x3e177(0x1d1)]};}async['updateUser'](_0x13469c,_0x57b4a4){const _0x31f4cd=a56_0xb4dcbe,_0x10f810={..._0x57b4a4};_0x57b4a4['password']&&(_0x10f810[_0x31f4cd(0x1e3)]=await bcryptjs_1[_0x31f4cd(0x1d2)][_0x31f4cd(0x1f1)](_0x57b4a4[_0x31f4cd(0x1e3)],0xc));_0x57b4a4[_0x31f4cd(0x1f3)]&&(_0x10f810['name']=_0x57b4a4[_0x31f4cd(0x1f3)],delete _0x10f810[_0x31f4cd(0x1f3)]);_0x57b4a4[_0x31f4cd(0x1d3)]&&(_0x10f810[_0x31f4cd(0x1ce)]=_0x57b4a4[_0x31f4cd(0x1d3)],delete _0x10f810[_0x31f4cd(0x1d3)]);_0x57b4a4[_0x31f4cd(0x1eb)]&&(_0x10f810[_0x31f4cd(0x1dd)]=_0x57b4a4[_0x31f4cd(0x1eb)],delete _0x10f810['merchantUrl']);_0x57b4a4[_0x31f4cd(0x1e6)]&&(_0x10f810['paymentGateways']=JSON[_0x31f4cd(0x1ec)](_0x57b4a4['gateways']),delete _0x10f810[_0x31f4cd(0x1e6)]);_0x57b4a4[_0x31f4cd(0x1f8)]&&(_0x10f810['gatewaySettings']=JSON[_0x31f4cd(0x1ec)](_0x57b4a4[_0x31f4cd(0x1f8)]),delete _0x10f810[_0x31f4cd(0x1f8)]);_0x57b4a4[_0x31f4cd(0x1f4)]&&(_0x57b4a4[_0x31f4cd(0x1f4)]['usdtPolygonWallet']!==undefined&&(_0x10f810[_0x31f4cd(0x1d7)]=_0x57b4a4['wallets'][_0x31f4cd(0x1d7)]||null),_0x57b4a4['wallets']['usdtTrcWallet']!==undefined&&(_0x10f810[_0x31f4cd(0x1cc)]=_0x57b4a4[_0x31f4cd(0x1f4)][_0x31f4cd(0x1cc)]||null),_0x57b4a4[_0x31f4cd(0x1f4)][_0x31f4cd(0x1e5)]!==undefined&&(_0x10f810[_0x31f4cd(0x1e5)]=_0x57b4a4[_0x31f4cd(0x1f4)]['usdtErcWallet']||null),_0x57b4a4['wallets']['usdcPolygonWallet']!==undefined&&(_0x10f810[_0x31f4cd(0x1ee)]=_0x57b4a4[_0x31f4cd(0x1f4)][_0x31f4cd(0x1ee)]||null),delete _0x10f810[_0x31f4cd(0x1f4)]);const _0x15cdb4=await database_1[_0x31f4cd(0x1d2)]['shop'][_0x31f4cd(0x1f7)]({'where':{'id':_0x13469c},'data':_0x10f810,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x15cdb4['id'],'fullName':_0x15cdb4[_0x31f4cd(0x1c9)],'username':_0x15cdb4[_0x31f4cd(0x1c7)],'telegramId':_0x15cdb4[_0x31f4cd(0x1ce)],'merchantUrl':_0x15cdb4[_0x31f4cd(0x1dd)],'gateways':_0x15cdb4['paymentGateways']?JSON[_0x31f4cd(0x1d8)](_0x15cdb4[_0x31f4cd(0x1da)]):null,'gatewaySettings':_0x15cdb4[_0x31f4cd(0x1f8)]?JSON[_0x31f4cd(0x1d8)](_0x15cdb4[_0x31f4cd(0x1f8)]):null,'publicKey':_0x15cdb4[_0x31f4cd(0x1cb)],'wallets':{'usdtPolygonWallet':_0x15cdb4['usdtPolygonWallet'],'usdtTrcWallet':_0x15cdb4[_0x31f4cd(0x1cc)],'usdtErcWallet':_0x15cdb4[_0x31f4cd(0x1e5)],'usdcPolygonWallet':_0x15cdb4[_0x31f4cd(0x1ee)]},'status':_0x15cdb4[_0x31f4cd(0x1de)],'createdAt':_0x15cdb4[_0x31f4cd(0x1d1)]};}async[a56_0xb4dcbe(0x1cf)](_0x3b4d6d){const _0x25d5e5=a56_0xb4dcbe;await database_1[_0x25d5e5(0x1d2)][_0x25d5e5(0x1c8)][_0x25d5e5(0x1f0)]({'where':{'id':_0x3b4d6d}});}}function a56_0x4b4d(_0x50663e,_0x2719a0){const _0x581f80=a56_0x581f();return a56_0x4b4d=function(_0x4b4de7,_0x440fb3){_0x4b4de7=_0x4b4de7-0x1c6;let _0x58a405=_0x581f80[_0x4b4de7];return _0x58a405;},a56_0x4b4d(_0x50663e,_0x2719a0);}exports[a56_0xb4dcbe(0x1e7)]=UserService;