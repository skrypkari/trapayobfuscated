'use strict';const a59_0x12c56d=a59_0x44db;(function(_0x5d435d,_0x25fa30){const _0x10eef8=a59_0x44db,_0x21b65a=_0x5d435d();while(!![]){try{const _0x332e28=-parseInt(_0x10eef8(0x145))/0x1*(parseInt(_0x10eef8(0x140))/0x2)+parseInt(_0x10eef8(0x14c))/0x3+-parseInt(_0x10eef8(0x130))/0x4+parseInt(_0x10eef8(0x13a))/0x5+parseInt(_0x10eef8(0x12f))/0x6*(-parseInt(_0x10eef8(0x128))/0x7)+parseInt(_0x10eef8(0x132))/0x8+parseInt(_0x10eef8(0x154))/0x9;if(_0x332e28===_0x25fa30)break;else _0x21b65a['push'](_0x21b65a['shift']());}catch(_0x5e3f60){_0x21b65a['push'](_0x21b65a['shift']());}}}(a59_0x76d6,0x650ce));function a59_0x44db(_0xe6d4d8,_0x2c7ee2){const _0x76d601=a59_0x76d6();return a59_0x44db=function(_0x44db96,_0x1d7b9f){_0x44db96=_0x44db96-0x11d;let _0x296ba8=_0x76d601[_0x44db96];return _0x296ba8;},a59_0x44db(_0xe6d4d8,_0x2c7ee2);}var __importDefault=this&&this[a59_0x12c56d(0x12d)]||function(_0x4e3739){const _0x4b5fcf=a59_0x12c56d;return _0x4e3739&&_0x4e3739[_0x4b5fcf(0x122)]?_0x4e3739:{'default':_0x4e3739};};Object[a59_0x12c56d(0x14f)](exports,'__esModule',{'value':!![]}),exports[a59_0x12c56d(0x11f)]=void 0x0;const bcryptjs_1=__importDefault(require(a59_0x12c56d(0x129))),crypto_1=__importDefault(require(a59_0x12c56d(0x150))),database_1=__importDefault(require('../config/database'));function a59_0x76d6(){const _0x4e5194=['hex','161DxCNwZ','bcryptjs','password','sk_','pk_','__importDefault','getUserById','122622lnqcGa','1249132fHHjvB','usdcPolygonWallet','4980392LFvpcd','create','publicKey','findMany','hash','desc','name','Username\x20already\x20exists','1462535IsEgSJ','ACTIVE','stringify','merchantUrl','username','usdtTrcWallet','1038080ctNtdZ','createUser','Telegram\x20username\x20already\x20exists','shop','usdtErcWallet','1PphcSp','fullName','randomBytes','wallets','parse','shopUrl','update','1552392IXmOCw','usdtPolygonWallet','telegramId','defineProperty','crypto','createdAt','status','paymentGateways','2544804YgDUoO','default','gatewaySettings','gateways','UserService','telegram','map','__esModule','delete','findUnique','deleteUser','toString'];a59_0x76d6=function(){return _0x4e5194;};return a59_0x76d6();}class UserService{['generateApiKeys'](){const _0xe181a6=a59_0x12c56d,_0x314455=_0xe181a6(0x12c)+crypto_1[_0xe181a6(0x155)][_0xe181a6(0x147)](0x20)[_0xe181a6(0x126)](_0xe181a6(0x127)),_0x2c70c8=_0xe181a6(0x12b)+crypto_1[_0xe181a6(0x155)][_0xe181a6(0x147)](0x20)[_0xe181a6(0x126)](_0xe181a6(0x127));return{'publicKey':_0x314455,'secretKey':_0x2c70c8};}async[a59_0x12c56d(0x141)](_0x1e559d){const _0x16fee4=a59_0x12c56d,{fullName:_0x38f404,username:_0xb98aa7,password:_0x87a2a5,telegramId:_0x51e483,merchantUrl:_0x1dcf91,gateways:_0x39d853,gatewaySettings:_0x1c628c,wallets:_0x52956d}=_0x1e559d,_0x5e2b04=await database_1[_0x16fee4(0x155)][_0x16fee4(0x143)]['findUnique']({'where':{'username':_0xb98aa7}});if(_0x5e2b04)throw new Error(_0x16fee4(0x139));if(_0x51e483){const _0x3fa800=await database_1[_0x16fee4(0x155)][_0x16fee4(0x143)]['findUnique']({'where':{'telegram':_0x51e483}});if(_0x3fa800)throw new Error(_0x16fee4(0x142));}const _0x468c6e=await bcryptjs_1['default'][_0x16fee4(0x136)](_0x87a2a5,0xc),{publicKey:_0x1329ba,secretKey:_0x55f5d3}=this['generateApiKeys'](),_0x420cdf=await database_1['default']['shop'][_0x16fee4(0x133)]({'data':{'name':_0x38f404,'username':_0xb98aa7,'password':_0x468c6e,'telegram':_0x51e483,'shopUrl':_0x1dcf91,'paymentGateways':_0x39d853?JSON[_0x16fee4(0x13c)](_0x39d853):null,'gatewaySettings':_0x1c628c?JSON[_0x16fee4(0x13c)](_0x1c628c):null,'usdtPolygonWallet':_0x52956d?.[_0x16fee4(0x14d)]||null,'usdtTrcWallet':_0x52956d?.[_0x16fee4(0x13f)]||null,'usdtErcWallet':_0x52956d?.[_0x16fee4(0x144)]||null,'usdcPolygonWallet':_0x52956d?.[_0x16fee4(0x131)]||null,'publicKey':_0x1329ba,'secretKey':_0x55f5d3,'status':_0x16fee4(0x13b)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x420cdf['id'],'fullName':_0x420cdf['name'],'username':_0x420cdf[_0x16fee4(0x13e)],'telegramId':_0x420cdf['telegram'],'merchantUrl':_0x420cdf[_0x16fee4(0x14a)],'gateways':_0x420cdf[_0x16fee4(0x153)]?JSON[_0x16fee4(0x149)](_0x420cdf['paymentGateways']):null,'gatewaySettings':_0x420cdf['gatewaySettings']?JSON['parse'](_0x420cdf['gatewaySettings']):null,'publicKey':_0x420cdf[_0x16fee4(0x134)],'wallets':{'usdtPolygonWallet':_0x420cdf[_0x16fee4(0x14d)],'usdtTrcWallet':_0x420cdf[_0x16fee4(0x13f)],'usdtErcWallet':_0x420cdf[_0x16fee4(0x144)],'usdcPolygonWallet':_0x420cdf[_0x16fee4(0x131)]},'status':_0x420cdf[_0x16fee4(0x152)],'createdAt':_0x420cdf['createdAt']};}async['getAllUsers'](){const _0x2df693=a59_0x12c56d,_0x31212f=await database_1[_0x2df693(0x155)]['shop'][_0x2df693(0x135)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x2df693(0x137)}});return _0x31212f[_0x2df693(0x121)](_0x1b55ff=>({'id':_0x1b55ff['id'],'fullName':_0x1b55ff[_0x2df693(0x138)],'username':_0x1b55ff[_0x2df693(0x13e)],'telegramId':_0x1b55ff[_0x2df693(0x120)],'merchantUrl':_0x1b55ff['shopUrl'],'gateways':_0x1b55ff[_0x2df693(0x153)]?JSON[_0x2df693(0x149)](_0x1b55ff['paymentGateways']):null,'gatewaySettings':_0x1b55ff[_0x2df693(0x11d)]?JSON['parse'](_0x1b55ff[_0x2df693(0x11d)]):null,'publicKey':_0x1b55ff['publicKey'],'wallets':{'usdtPolygonWallet':_0x1b55ff[_0x2df693(0x14d)],'usdtTrcWallet':_0x1b55ff['usdtTrcWallet'],'usdtErcWallet':_0x1b55ff['usdtErcWallet'],'usdcPolygonWallet':_0x1b55ff[_0x2df693(0x131)]},'status':_0x1b55ff[_0x2df693(0x152)],'createdAt':_0x1b55ff['createdAt']}));}async[a59_0x12c56d(0x12e)](_0x27a956){const _0x3d22d4=a59_0x12c56d,_0x10c8df=await database_1[_0x3d22d4(0x155)][_0x3d22d4(0x143)][_0x3d22d4(0x124)]({'where':{'id':_0x27a956},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x10c8df)return null;return{'id':_0x10c8df['id'],'fullName':_0x10c8df['name'],'username':_0x10c8df[_0x3d22d4(0x13e)],'telegramId':_0x10c8df[_0x3d22d4(0x120)],'merchantUrl':_0x10c8df['shopUrl'],'gateways':_0x10c8df[_0x3d22d4(0x153)]?JSON[_0x3d22d4(0x149)](_0x10c8df[_0x3d22d4(0x153)]):null,'gatewaySettings':_0x10c8df['gatewaySettings']?JSON[_0x3d22d4(0x149)](_0x10c8df[_0x3d22d4(0x11d)]):null,'publicKey':_0x10c8df[_0x3d22d4(0x134)],'wallets':{'usdtPolygonWallet':_0x10c8df[_0x3d22d4(0x14d)],'usdtTrcWallet':_0x10c8df[_0x3d22d4(0x13f)],'usdtErcWallet':_0x10c8df[_0x3d22d4(0x144)],'usdcPolygonWallet':_0x10c8df['usdcPolygonWallet']},'status':_0x10c8df[_0x3d22d4(0x152)],'createdAt':_0x10c8df['createdAt']};}async['updateUser'](_0x3ec263,_0x4a89f1){const _0x4983fe=a59_0x12c56d,_0x13876e={..._0x4a89f1};_0x4a89f1[_0x4983fe(0x12a)]&&(_0x13876e[_0x4983fe(0x12a)]=await bcryptjs_1[_0x4983fe(0x155)][_0x4983fe(0x136)](_0x4a89f1[_0x4983fe(0x12a)],0xc));_0x4a89f1[_0x4983fe(0x146)]&&(_0x13876e[_0x4983fe(0x138)]=_0x4a89f1[_0x4983fe(0x146)],delete _0x13876e[_0x4983fe(0x146)]);_0x4a89f1[_0x4983fe(0x14e)]&&(_0x13876e[_0x4983fe(0x120)]=_0x4a89f1[_0x4983fe(0x14e)],delete _0x13876e[_0x4983fe(0x14e)]);_0x4a89f1[_0x4983fe(0x13d)]&&(_0x13876e['shopUrl']=_0x4a89f1[_0x4983fe(0x13d)],delete _0x13876e['merchantUrl']);_0x4a89f1['gateways']&&(_0x13876e['paymentGateways']=JSON[_0x4983fe(0x13c)](_0x4a89f1['gateways']),delete _0x13876e[_0x4983fe(0x11e)]);_0x4a89f1[_0x4983fe(0x11d)]&&(_0x13876e[_0x4983fe(0x11d)]=JSON[_0x4983fe(0x13c)](_0x4a89f1[_0x4983fe(0x11d)]),delete _0x13876e['gatewaySettings']);_0x4a89f1['wallets']&&(_0x4a89f1[_0x4983fe(0x148)][_0x4983fe(0x14d)]!==undefined&&(_0x13876e[_0x4983fe(0x14d)]=_0x4a89f1[_0x4983fe(0x148)]['usdtPolygonWallet']||null),_0x4a89f1[_0x4983fe(0x148)]['usdtTrcWallet']!==undefined&&(_0x13876e[_0x4983fe(0x13f)]=_0x4a89f1[_0x4983fe(0x148)][_0x4983fe(0x13f)]||null),_0x4a89f1[_0x4983fe(0x148)][_0x4983fe(0x144)]!==undefined&&(_0x13876e[_0x4983fe(0x144)]=_0x4a89f1[_0x4983fe(0x148)]['usdtErcWallet']||null),_0x4a89f1[_0x4983fe(0x148)][_0x4983fe(0x131)]!==undefined&&(_0x13876e['usdcPolygonWallet']=_0x4a89f1['wallets'][_0x4983fe(0x131)]||null),delete _0x13876e['wallets']);const _0x116124=await database_1[_0x4983fe(0x155)][_0x4983fe(0x143)][_0x4983fe(0x14b)]({'where':{'id':_0x3ec263},'data':_0x13876e,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x116124['id'],'fullName':_0x116124['name'],'username':_0x116124[_0x4983fe(0x13e)],'telegramId':_0x116124[_0x4983fe(0x120)],'merchantUrl':_0x116124[_0x4983fe(0x14a)],'gateways':_0x116124[_0x4983fe(0x153)]?JSON[_0x4983fe(0x149)](_0x116124[_0x4983fe(0x153)]):null,'gatewaySettings':_0x116124[_0x4983fe(0x11d)]?JSON[_0x4983fe(0x149)](_0x116124[_0x4983fe(0x11d)]):null,'publicKey':_0x116124[_0x4983fe(0x134)],'wallets':{'usdtPolygonWallet':_0x116124[_0x4983fe(0x14d)],'usdtTrcWallet':_0x116124[_0x4983fe(0x13f)],'usdtErcWallet':_0x116124['usdtErcWallet'],'usdcPolygonWallet':_0x116124[_0x4983fe(0x131)]},'status':_0x116124[_0x4983fe(0x152)],'createdAt':_0x116124[_0x4983fe(0x151)]};}async[a59_0x12c56d(0x125)](_0x220c8c){const _0x67cd53=a59_0x12c56d;await database_1[_0x67cd53(0x155)][_0x67cd53(0x143)][_0x67cd53(0x123)]({'where':{'id':_0x220c8c}});}}exports[a59_0x12c56d(0x11f)]=UserService;