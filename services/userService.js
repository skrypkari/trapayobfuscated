'use strict';const a56_0x3552ec=a56_0x2cca;function a56_0x2cca(_0x2a2f5c,_0x214c6f){const _0x1782fb=a56_0x1782();return a56_0x2cca=function(_0x2cca15,_0x3a8c7a){_0x2cca15=_0x2cca15-0x181;let _0x5ec30c=_0x1782fb[_0x2cca15];return _0x5ec30c;},a56_0x2cca(_0x2a2f5c,_0x214c6f);}(function(_0x3fe2d2,_0x30d245){const _0x48e6ea=a56_0x2cca,_0x40a06a=_0x3fe2d2();while(!![]){try{const _0xdbb585=parseInt(_0x48e6ea(0x199))/0x1+-parseInt(_0x48e6ea(0x1b4))/0x2+-parseInt(_0x48e6ea(0x19a))/0x3+parseInt(_0x48e6ea(0x1b8))/0x4+parseInt(_0x48e6ea(0x18a))/0x5*(-parseInt(_0x48e6ea(0x18c))/0x6)+parseInt(_0x48e6ea(0x185))/0x7+parseInt(_0x48e6ea(0x1a7))/0x8;if(_0xdbb585===_0x30d245)break;else _0x40a06a['push'](_0x40a06a['shift']());}catch(_0x299602){_0x40a06a['push'](_0x40a06a['shift']());}}}(a56_0x1782,0x1fd55));function a56_0x1782(){const _0x24680f=['telegram','3094696OVAPcN','toString','createdAt','../config/database','map','publicKey','getAllUsers','default','desc','shop','create','randomBytes','merchantUrl','273848lLFbOD','password','generateApiKeys','status','468392xUuhFQ','wallets','deleteUser','shopUrl','__esModule','34461icvSIy','hex','paymentGateways','delete','hash','5fTxpBs','fullName','1404258IrpTEC','Telegram\x20username\x20already\x20exists','updateUser','sk_','update','telegramId','stringify','defineProperty','usdcPolygonWallet','findUnique','__importDefault','pk_','bcryptjs','58483oeWoqy','197955ovCgaZ','gateways','usdtPolygonWallet','usdtTrcWallet','gatewaySettings','UserService','parse','username','usdtErcWallet','name','findMany','Username\x20already\x20exists'];a56_0x1782=function(){return _0x24680f;};return a56_0x1782();}var __importDefault=this&&this[a56_0x3552ec(0x196)]||function(_0xeb1a4d){return _0xeb1a4d&&_0xeb1a4d['__esModule']?_0xeb1a4d:{'default':_0xeb1a4d};};Object[a56_0x3552ec(0x193)](exports,a56_0x3552ec(0x184),{'value':!![]}),exports['UserService']=void 0x0;const bcryptjs_1=__importDefault(require(a56_0x3552ec(0x198))),crypto_1=__importDefault(require('crypto')),database_1=__importDefault(require(a56_0x3552ec(0x1aa)));class UserService{[a56_0x3552ec(0x1b6)](){const _0x59745e=a56_0x3552ec,_0x483aa1=_0x59745e(0x197)+crypto_1['default']['randomBytes'](0x20)[_0x59745e(0x1a8)]('hex'),_0x1992c9=_0x59745e(0x18f)+crypto_1[_0x59745e(0x1ae)][_0x59745e(0x1b2)](0x20)[_0x59745e(0x1a8)](_0x59745e(0x186));return{'publicKey':_0x483aa1,'secretKey':_0x1992c9};}async['createUser'](_0x194ca4){const _0x35ba6b=a56_0x3552ec,{fullName:_0xd7bc1,username:_0x1bd345,password:_0x589b28,telegramId:_0x2ed127,merchantUrl:_0x241fee,gateways:_0x5cdc25,gatewaySettings:_0x2c5675,wallets:_0xbd7072}=_0x194ca4,_0x23d52d=await database_1[_0x35ba6b(0x1ae)]['shop'][_0x35ba6b(0x195)]({'where':{'username':_0x1bd345}});if(_0x23d52d)throw new Error(_0x35ba6b(0x1a5));if(_0x2ed127){const _0x257ea6=await database_1[_0x35ba6b(0x1ae)][_0x35ba6b(0x1b0)]['findUnique']({'where':{'telegram':_0x2ed127}});if(_0x257ea6)throw new Error(_0x35ba6b(0x18d));}const _0x14326d=await bcryptjs_1[_0x35ba6b(0x1ae)]['hash'](_0x589b28,0xc),{publicKey:_0x1c7123,secretKey:_0x46cc63}=this[_0x35ba6b(0x1b6)](),_0x3466c3=await database_1[_0x35ba6b(0x1ae)][_0x35ba6b(0x1b0)][_0x35ba6b(0x1b1)]({'data':{'name':_0xd7bc1,'username':_0x1bd345,'password':_0x14326d,'telegram':_0x2ed127,'shopUrl':_0x241fee,'paymentGateways':_0x5cdc25?JSON[_0x35ba6b(0x192)](_0x5cdc25):null,'gatewaySettings':_0x2c5675?JSON['stringify'](_0x2c5675):null,'usdtPolygonWallet':_0xbd7072?.['usdtPolygonWallet']||null,'usdtTrcWallet':_0xbd7072?.['usdtTrcWallet']||null,'usdtErcWallet':_0xbd7072?.[_0x35ba6b(0x1a2)]||null,'usdcPolygonWallet':_0xbd7072?.[_0x35ba6b(0x194)]||null,'publicKey':_0x1c7123,'secretKey':_0x46cc63,'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x3466c3['id'],'fullName':_0x3466c3[_0x35ba6b(0x1a3)],'username':_0x3466c3[_0x35ba6b(0x1a1)],'telegramId':_0x3466c3['telegram'],'merchantUrl':_0x3466c3[_0x35ba6b(0x183)],'gateways':_0x3466c3[_0x35ba6b(0x187)]?JSON['parse'](_0x3466c3[_0x35ba6b(0x187)]):null,'gatewaySettings':_0x3466c3[_0x35ba6b(0x19e)]?JSON[_0x35ba6b(0x1a0)](_0x3466c3[_0x35ba6b(0x19e)]):null,'publicKey':_0x3466c3[_0x35ba6b(0x1ac)],'wallets':{'usdtPolygonWallet':_0x3466c3['usdtPolygonWallet'],'usdtTrcWallet':_0x3466c3[_0x35ba6b(0x19d)],'usdtErcWallet':_0x3466c3['usdtErcWallet'],'usdcPolygonWallet':_0x3466c3[_0x35ba6b(0x194)]},'status':_0x3466c3[_0x35ba6b(0x1b7)],'createdAt':_0x3466c3[_0x35ba6b(0x1a9)]};}async[a56_0x3552ec(0x1ad)](){const _0xbd78d8=a56_0x3552ec,_0x341842=await database_1[_0xbd78d8(0x1ae)]['shop'][_0xbd78d8(0x1a4)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0xbd78d8(0x1af)}});return _0x341842[_0xbd78d8(0x1ab)](_0xc492b5=>({'id':_0xc492b5['id'],'fullName':_0xc492b5['name'],'username':_0xc492b5[_0xbd78d8(0x1a1)],'telegramId':_0xc492b5[_0xbd78d8(0x1a6)],'merchantUrl':_0xc492b5[_0xbd78d8(0x183)],'gateways':_0xc492b5['paymentGateways']?JSON[_0xbd78d8(0x1a0)](_0xc492b5['paymentGateways']):null,'gatewaySettings':_0xc492b5['gatewaySettings']?JSON[_0xbd78d8(0x1a0)](_0xc492b5[_0xbd78d8(0x19e)]):null,'publicKey':_0xc492b5[_0xbd78d8(0x1ac)],'wallets':{'usdtPolygonWallet':_0xc492b5[_0xbd78d8(0x19c)],'usdtTrcWallet':_0xc492b5['usdtTrcWallet'],'usdtErcWallet':_0xc492b5[_0xbd78d8(0x1a2)],'usdcPolygonWallet':_0xc492b5[_0xbd78d8(0x194)]},'status':_0xc492b5[_0xbd78d8(0x1b7)],'createdAt':_0xc492b5[_0xbd78d8(0x1a9)]}));}async['getUserById'](_0x33bf95){const _0x6ed7b3=a56_0x3552ec,_0x41fa3e=await database_1['default'][_0x6ed7b3(0x1b0)][_0x6ed7b3(0x195)]({'where':{'id':_0x33bf95},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x41fa3e)return null;return{'id':_0x41fa3e['id'],'fullName':_0x41fa3e['name'],'username':_0x41fa3e['username'],'telegramId':_0x41fa3e['telegram'],'merchantUrl':_0x41fa3e[_0x6ed7b3(0x183)],'gateways':_0x41fa3e[_0x6ed7b3(0x187)]?JSON['parse'](_0x41fa3e[_0x6ed7b3(0x187)]):null,'gatewaySettings':_0x41fa3e['gatewaySettings']?JSON['parse'](_0x41fa3e[_0x6ed7b3(0x19e)]):null,'publicKey':_0x41fa3e['publicKey'],'wallets':{'usdtPolygonWallet':_0x41fa3e[_0x6ed7b3(0x19c)],'usdtTrcWallet':_0x41fa3e[_0x6ed7b3(0x19d)],'usdtErcWallet':_0x41fa3e[_0x6ed7b3(0x1a2)],'usdcPolygonWallet':_0x41fa3e[_0x6ed7b3(0x194)]},'status':_0x41fa3e[_0x6ed7b3(0x1b7)],'createdAt':_0x41fa3e[_0x6ed7b3(0x1a9)]};}async[a56_0x3552ec(0x18e)](_0x248f1b,_0x53b620){const _0x47243a=a56_0x3552ec,_0x238d01={..._0x53b620};_0x53b620[_0x47243a(0x1b5)]&&(_0x238d01[_0x47243a(0x1b5)]=await bcryptjs_1['default'][_0x47243a(0x189)](_0x53b620[_0x47243a(0x1b5)],0xc));_0x53b620[_0x47243a(0x18b)]&&(_0x238d01[_0x47243a(0x1a3)]=_0x53b620[_0x47243a(0x18b)],delete _0x238d01['fullName']);_0x53b620[_0x47243a(0x191)]&&(_0x238d01[_0x47243a(0x1a6)]=_0x53b620[_0x47243a(0x191)],delete _0x238d01[_0x47243a(0x191)]);_0x53b620[_0x47243a(0x1b3)]&&(_0x238d01[_0x47243a(0x183)]=_0x53b620[_0x47243a(0x1b3)],delete _0x238d01[_0x47243a(0x1b3)]);_0x53b620[_0x47243a(0x19b)]&&(_0x238d01[_0x47243a(0x187)]=JSON[_0x47243a(0x192)](_0x53b620[_0x47243a(0x19b)]),delete _0x238d01[_0x47243a(0x19b)]);_0x53b620['gatewaySettings']&&(_0x238d01[_0x47243a(0x19e)]=JSON[_0x47243a(0x192)](_0x53b620[_0x47243a(0x19e)]),delete _0x238d01[_0x47243a(0x19e)]);_0x53b620[_0x47243a(0x181)]&&(_0x53b620[_0x47243a(0x181)][_0x47243a(0x19c)]!==undefined&&(_0x238d01[_0x47243a(0x19c)]=_0x53b620[_0x47243a(0x181)][_0x47243a(0x19c)]||null),_0x53b620[_0x47243a(0x181)][_0x47243a(0x19d)]!==undefined&&(_0x238d01[_0x47243a(0x19d)]=_0x53b620[_0x47243a(0x181)][_0x47243a(0x19d)]||null),_0x53b620['wallets'][_0x47243a(0x1a2)]!==undefined&&(_0x238d01['usdtErcWallet']=_0x53b620[_0x47243a(0x181)][_0x47243a(0x1a2)]||null),_0x53b620[_0x47243a(0x181)][_0x47243a(0x194)]!==undefined&&(_0x238d01[_0x47243a(0x194)]=_0x53b620[_0x47243a(0x181)][_0x47243a(0x194)]||null),delete _0x238d01[_0x47243a(0x181)]);const _0x15fb6e=await database_1['default'][_0x47243a(0x1b0)][_0x47243a(0x190)]({'where':{'id':_0x248f1b},'data':_0x238d01,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x15fb6e['id'],'fullName':_0x15fb6e['name'],'username':_0x15fb6e[_0x47243a(0x1a1)],'telegramId':_0x15fb6e[_0x47243a(0x1a6)],'merchantUrl':_0x15fb6e[_0x47243a(0x183)],'gateways':_0x15fb6e['paymentGateways']?JSON[_0x47243a(0x1a0)](_0x15fb6e[_0x47243a(0x187)]):null,'gatewaySettings':_0x15fb6e['gatewaySettings']?JSON[_0x47243a(0x1a0)](_0x15fb6e['gatewaySettings']):null,'publicKey':_0x15fb6e[_0x47243a(0x1ac)],'wallets':{'usdtPolygonWallet':_0x15fb6e[_0x47243a(0x19c)],'usdtTrcWallet':_0x15fb6e[_0x47243a(0x19d)],'usdtErcWallet':_0x15fb6e[_0x47243a(0x1a2)],'usdcPolygonWallet':_0x15fb6e[_0x47243a(0x194)]},'status':_0x15fb6e[_0x47243a(0x1b7)],'createdAt':_0x15fb6e[_0x47243a(0x1a9)]};}async[a56_0x3552ec(0x182)](_0x3fe1c4){const _0x17ff02=a56_0x3552ec;await database_1[_0x17ff02(0x1ae)][_0x17ff02(0x1b0)][_0x17ff02(0x188)]({'where':{'id':_0x3fe1c4}});}}exports[a56_0x3552ec(0x19f)]=UserService;