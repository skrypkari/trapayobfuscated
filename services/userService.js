'use strict';const a61_0x58a23c=a61_0x45e1;(function(_0x143c60,_0x48013e){const _0x3f40a0=a61_0x45e1,_0x1e59f2=_0x143c60();while(!![]){try{const _0x571bb9=-parseInt(_0x3f40a0(0x22c))/0x1*(-parseInt(_0x3f40a0(0x214))/0x2)+parseInt(_0x3f40a0(0x211))/0x3*(parseInt(_0x3f40a0(0x21c))/0x4)+parseInt(_0x3f40a0(0x213))/0x5+parseInt(_0x3f40a0(0x212))/0x6+parseInt(_0x3f40a0(0x203))/0x7*(parseInt(_0x3f40a0(0x220))/0x8)+parseInt(_0x3f40a0(0x229))/0x9*(-parseInt(_0x3f40a0(0x1f5))/0xa)+parseInt(_0x3f40a0(0x209))/0xb*(-parseInt(_0x3f40a0(0x228))/0xc);if(_0x571bb9===_0x48013e)break;else _0x1e59f2['push'](_0x1e59f2['shift']());}catch(_0x40052a){_0x1e59f2['push'](_0x1e59f2['shift']());}}}(a61_0x4b69,0x9847f));function a61_0x45e1(_0x1385b2,_0x30b3d3){const _0x4b69b3=a61_0x4b69();return a61_0x45e1=function(_0x45e16d,_0x5772e7){_0x45e16d=_0x45e16d-0x1f1;let _0x21cd70=_0x4b69b3[_0x45e16d];return _0x21cd70;},a61_0x45e1(_0x1385b2,_0x30b3d3);}var __importDefault=this&&this[a61_0x58a23c(0x20a)]||function(_0x23f10c){const _0x3fc174=a61_0x58a23c;return _0x23f10c&&_0x23f10c[_0x3fc174(0x1f4)]?_0x23f10c:{'default':_0x23f10c};};function a61_0x4b69(){const _0x85d07=['desc','findUnique','password','56xMTypd','createUser','usdtTrcWallet','usdtErcWallet','findMany','username','UserService','ACTIVE','228iRwTqM','15651HSicKG','delete','randomBytes','480xjxmvi','wallets','default','hex','__esModule','1880JDwmbm','map','publicKey','Telegram\x20username\x20already\x20exists','bcryptjs','paymentGateways','merchantUrl','update','shopUrl','telegram','pk_','generateApiKeys','stringify','name','1143317hkpOXf','Username\x20already\x20exists','fullName','getUserById','createdAt','hash','2538206DpbMIF','__importDefault','getAllUsers','usdtPolygonWallet','usdcPolygonWallet','updateUser','parse','shop','663OodRwe','5897754vsafXr','6194835hUeEHM','3818DfxHqy','status','telegramId','gateways','gatewaySettings','toString','deleteUser','crypto','19064kWJiDI'];a61_0x4b69=function(){return _0x85d07;};return a61_0x4b69();}Object['defineProperty'](exports,a61_0x58a23c(0x1f4),{'value':!![]}),exports[a61_0x58a23c(0x226)]=void 0x0;const bcryptjs_1=__importDefault(require(a61_0x58a23c(0x1f9))),crypto_1=__importDefault(require(a61_0x58a23c(0x21b))),database_1=__importDefault(require('../config/database'));class UserService{['generateApiKeys'](){const _0x42bc58=a61_0x58a23c,_0xff3705=_0x42bc58(0x1ff)+crypto_1[_0x42bc58(0x1f2)][_0x42bc58(0x22b)](0x20)[_0x42bc58(0x219)]('hex'),_0x186c02='sk_'+crypto_1[_0x42bc58(0x1f2)][_0x42bc58(0x22b)](0x20)[_0x42bc58(0x219)](_0x42bc58(0x1f3));return{'publicKey':_0xff3705,'secretKey':_0x186c02};}async[a61_0x58a23c(0x221)](_0x492c24){const _0x2c8495=a61_0x58a23c,{fullName:_0x4e8cbc,username:_0x1a4ef7,password:_0x275421,telegramId:_0x1dffd4,merchantUrl:_0x3e9bfa,gateways:_0x3cb53e,gatewaySettings:_0x1a077a,wallets:_0x42315a}=_0x492c24,_0x4e4407=await database_1[_0x2c8495(0x1f2)]['shop']['findUnique']({'where':{'username':_0x1a4ef7}});if(_0x4e4407)throw new Error(_0x2c8495(0x204));if(_0x1dffd4){const _0x1de1f2=await database_1[_0x2c8495(0x1f2)][_0x2c8495(0x210)][_0x2c8495(0x21e)]({'where':{'telegram':_0x1dffd4}});if(_0x1de1f2)throw new Error(_0x2c8495(0x1f8));}const _0x5654de=await bcryptjs_1[_0x2c8495(0x1f2)]['hash'](_0x275421,0xc),{publicKey:_0x568dd3,secretKey:_0x4396a7}=this[_0x2c8495(0x200)](),_0x1c1a24=await database_1['default']['shop']['create']({'data':{'name':_0x4e8cbc,'username':_0x1a4ef7,'password':_0x5654de,'telegram':_0x1dffd4,'shopUrl':_0x3e9bfa,'paymentGateways':_0x3cb53e?JSON[_0x2c8495(0x201)](_0x3cb53e):null,'gatewaySettings':_0x1a077a?JSON[_0x2c8495(0x201)](_0x1a077a):null,'usdtPolygonWallet':_0x42315a?.['usdtPolygonWallet']||null,'usdtTrcWallet':_0x42315a?.[_0x2c8495(0x222)]||null,'usdtErcWallet':_0x42315a?.[_0x2c8495(0x223)]||null,'usdcPolygonWallet':_0x42315a?.[_0x2c8495(0x20d)]||null,'publicKey':_0x568dd3,'secretKey':_0x4396a7,'status':_0x2c8495(0x227)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x1c1a24['id'],'fullName':_0x1c1a24[_0x2c8495(0x202)],'username':_0x1c1a24[_0x2c8495(0x225)],'telegramId':_0x1c1a24[_0x2c8495(0x1fe)],'merchantUrl':_0x1c1a24[_0x2c8495(0x1fd)],'gateways':_0x1c1a24['paymentGateways']?JSON[_0x2c8495(0x20f)](_0x1c1a24['paymentGateways']):null,'gatewaySettings':_0x1c1a24[_0x2c8495(0x218)]?JSON[_0x2c8495(0x20f)](_0x1c1a24[_0x2c8495(0x218)]):null,'publicKey':_0x1c1a24[_0x2c8495(0x1f7)],'wallets':{'usdtPolygonWallet':_0x1c1a24[_0x2c8495(0x20c)],'usdtTrcWallet':_0x1c1a24[_0x2c8495(0x222)],'usdtErcWallet':_0x1c1a24[_0x2c8495(0x223)],'usdcPolygonWallet':_0x1c1a24[_0x2c8495(0x20d)]},'status':_0x1c1a24[_0x2c8495(0x215)],'createdAt':_0x1c1a24[_0x2c8495(0x207)]};}async[a61_0x58a23c(0x20b)](){const _0x255db7=a61_0x58a23c,_0x12bb22=await database_1[_0x255db7(0x1f2)][_0x255db7(0x210)][_0x255db7(0x224)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x255db7(0x21d)}});return _0x12bb22[_0x255db7(0x1f6)](_0x4d504f=>({'id':_0x4d504f['id'],'fullName':_0x4d504f['name'],'username':_0x4d504f[_0x255db7(0x225)],'telegramId':_0x4d504f[_0x255db7(0x1fe)],'merchantUrl':_0x4d504f[_0x255db7(0x1fd)],'gateways':_0x4d504f['paymentGateways']?JSON['parse'](_0x4d504f[_0x255db7(0x1fa)]):null,'gatewaySettings':_0x4d504f[_0x255db7(0x218)]?JSON[_0x255db7(0x20f)](_0x4d504f[_0x255db7(0x218)]):null,'publicKey':_0x4d504f['publicKey'],'wallets':{'usdtPolygonWallet':_0x4d504f[_0x255db7(0x20c)],'usdtTrcWallet':_0x4d504f[_0x255db7(0x222)],'usdtErcWallet':_0x4d504f[_0x255db7(0x223)],'usdcPolygonWallet':_0x4d504f[_0x255db7(0x20d)]},'status':_0x4d504f[_0x255db7(0x215)],'createdAt':_0x4d504f[_0x255db7(0x207)]}));}async[a61_0x58a23c(0x206)](_0x228e6f){const _0x5a4ef9=a61_0x58a23c,_0x4fa74d=await database_1[_0x5a4ef9(0x1f2)][_0x5a4ef9(0x210)]['findUnique']({'where':{'id':_0x228e6f},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x4fa74d)return null;return{'id':_0x4fa74d['id'],'fullName':_0x4fa74d[_0x5a4ef9(0x202)],'username':_0x4fa74d[_0x5a4ef9(0x225)],'telegramId':_0x4fa74d[_0x5a4ef9(0x1fe)],'merchantUrl':_0x4fa74d['shopUrl'],'gateways':_0x4fa74d[_0x5a4ef9(0x1fa)]?JSON['parse'](_0x4fa74d[_0x5a4ef9(0x1fa)]):null,'gatewaySettings':_0x4fa74d['gatewaySettings']?JSON[_0x5a4ef9(0x20f)](_0x4fa74d[_0x5a4ef9(0x218)]):null,'publicKey':_0x4fa74d['publicKey'],'wallets':{'usdtPolygonWallet':_0x4fa74d[_0x5a4ef9(0x20c)],'usdtTrcWallet':_0x4fa74d[_0x5a4ef9(0x222)],'usdtErcWallet':_0x4fa74d[_0x5a4ef9(0x223)],'usdcPolygonWallet':_0x4fa74d[_0x5a4ef9(0x20d)]},'status':_0x4fa74d[_0x5a4ef9(0x215)],'createdAt':_0x4fa74d[_0x5a4ef9(0x207)]};}async[a61_0x58a23c(0x20e)](_0x17c8df,_0xd8cf2){const _0x5c2a10=a61_0x58a23c,_0x14ecaf={..._0xd8cf2};_0xd8cf2[_0x5c2a10(0x21f)]&&(_0x14ecaf[_0x5c2a10(0x21f)]=await bcryptjs_1[_0x5c2a10(0x1f2)][_0x5c2a10(0x208)](_0xd8cf2[_0x5c2a10(0x21f)],0xc));_0xd8cf2[_0x5c2a10(0x205)]&&(_0x14ecaf['name']=_0xd8cf2[_0x5c2a10(0x205)],delete _0x14ecaf['fullName']);_0xd8cf2[_0x5c2a10(0x216)]&&(_0x14ecaf[_0x5c2a10(0x1fe)]=_0xd8cf2[_0x5c2a10(0x216)],delete _0x14ecaf['telegramId']);_0xd8cf2[_0x5c2a10(0x1fb)]&&(_0x14ecaf[_0x5c2a10(0x1fd)]=_0xd8cf2['merchantUrl'],delete _0x14ecaf[_0x5c2a10(0x1fb)]);_0xd8cf2[_0x5c2a10(0x217)]&&(_0x14ecaf[_0x5c2a10(0x1fa)]=JSON[_0x5c2a10(0x201)](_0xd8cf2[_0x5c2a10(0x217)]),delete _0x14ecaf['gateways']);_0xd8cf2[_0x5c2a10(0x218)]&&(_0x14ecaf[_0x5c2a10(0x218)]=JSON[_0x5c2a10(0x201)](_0xd8cf2[_0x5c2a10(0x218)]),delete _0x14ecaf[_0x5c2a10(0x218)]);_0xd8cf2[_0x5c2a10(0x1f1)]&&(_0xd8cf2[_0x5c2a10(0x1f1)]['usdtPolygonWallet']!==undefined&&(_0x14ecaf['usdtPolygonWallet']=_0xd8cf2[_0x5c2a10(0x1f1)][_0x5c2a10(0x20c)]||null),_0xd8cf2[_0x5c2a10(0x1f1)][_0x5c2a10(0x222)]!==undefined&&(_0x14ecaf[_0x5c2a10(0x222)]=_0xd8cf2[_0x5c2a10(0x1f1)]['usdtTrcWallet']||null),_0xd8cf2[_0x5c2a10(0x1f1)][_0x5c2a10(0x223)]!==undefined&&(_0x14ecaf['usdtErcWallet']=_0xd8cf2['wallets']['usdtErcWallet']||null),_0xd8cf2['wallets'][_0x5c2a10(0x20d)]!==undefined&&(_0x14ecaf['usdcPolygonWallet']=_0xd8cf2['wallets'][_0x5c2a10(0x20d)]||null),delete _0x14ecaf[_0x5c2a10(0x1f1)]);const _0xe53105=await database_1[_0x5c2a10(0x1f2)][_0x5c2a10(0x210)][_0x5c2a10(0x1fc)]({'where':{'id':_0x17c8df},'data':_0x14ecaf,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0xe53105['id'],'fullName':_0xe53105[_0x5c2a10(0x202)],'username':_0xe53105[_0x5c2a10(0x225)],'telegramId':_0xe53105[_0x5c2a10(0x1fe)],'merchantUrl':_0xe53105[_0x5c2a10(0x1fd)],'gateways':_0xe53105[_0x5c2a10(0x1fa)]?JSON[_0x5c2a10(0x20f)](_0xe53105[_0x5c2a10(0x1fa)]):null,'gatewaySettings':_0xe53105[_0x5c2a10(0x218)]?JSON[_0x5c2a10(0x20f)](_0xe53105['gatewaySettings']):null,'publicKey':_0xe53105[_0x5c2a10(0x1f7)],'wallets':{'usdtPolygonWallet':_0xe53105[_0x5c2a10(0x20c)],'usdtTrcWallet':_0xe53105['usdtTrcWallet'],'usdtErcWallet':_0xe53105[_0x5c2a10(0x223)],'usdcPolygonWallet':_0xe53105[_0x5c2a10(0x20d)]},'status':_0xe53105[_0x5c2a10(0x215)],'createdAt':_0xe53105[_0x5c2a10(0x207)]};}async[a61_0x58a23c(0x21a)](_0x4c6e87){const _0x4981d3=a61_0x58a23c;await database_1['default'][_0x4981d3(0x210)][_0x4981d3(0x22a)]({'where':{'id':_0x4c6e87}});}}exports[a61_0x58a23c(0x226)]=UserService;