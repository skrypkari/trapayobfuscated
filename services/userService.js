'use strict';const a60_0x22264c=a60_0x17e7;(function(_0x33bf16,_0x3dbea4){const _0x5c7edc=a60_0x17e7,_0x4061aa=_0x33bf16();while(!![]){try{const _0x303aa2=-parseInt(_0x5c7edc(0xfe))/0x1+-parseInt(_0x5c7edc(0x101))/0x2*(parseInt(_0x5c7edc(0x103))/0x3)+parseInt(_0x5c7edc(0x122))/0x4+parseInt(_0x5c7edc(0x105))/0x5+parseInt(_0x5c7edc(0x118))/0x6+-parseInt(_0x5c7edc(0x10a))/0x7+parseInt(_0x5c7edc(0x110))/0x8*(parseInt(_0x5c7edc(0x127))/0x9);if(_0x303aa2===_0x3dbea4)break;else _0x4061aa['push'](_0x4061aa['shift']());}catch(_0x3e69c4){_0x4061aa['push'](_0x4061aa['shift']());}}}(a60_0x2d6c,0x6b849));var __importDefault=this&&this[a60_0x22264c(0x102)]||function(_0x2a1c87){const _0xc90dfe=a60_0x22264c;return _0x2a1c87&&_0x2a1c87[_0xc90dfe(0x130)]?_0x2a1c87:{'default':_0x2a1c87};};Object[a60_0x22264c(0x124)](exports,a60_0x22264c(0x130),{'value':!![]}),exports[a60_0x22264c(0xfc)]=void 0x0;const bcryptjs_1=__importDefault(require(a60_0x22264c(0xfb))),crypto_1=__importDefault(require(a60_0x22264c(0x11c))),database_1=__importDefault(require(a60_0x22264c(0x10e)));function a60_0x2d6c(){const _0xae089f=['126200jmmnXz','default','usdcPolygonWallet','map','hash','parse','deleteUser','shopUrl','1173630wjkXFT','hex','fullName','createdAt','crypto','merchantUrl','update','desc','ACTIVE','stringify','1788800XhSmSo','publicKey','defineProperty','create','usdtPolygonWallet','207eWYlsd','telegram','createUser','Telegram\x20username\x20already\x20exists','usdtErcWallet','status','delete','findMany','usdtTrcWallet','__esModule','paymentGateways','gatewaySettings','getUserById','Username\x20already\x20exists','bcryptjs','UserService','getAllUsers','4461Ikohbu','generateApiKeys','password','682658ysuuOd','__importDefault','3fIuCxH','username','2994175KISMFq','shop','name','telegramId','findUnique','5727974eeNzCK','wallets','gateways','sk_','../config/database','randomBytes'];a60_0x2d6c=function(){return _0xae089f;};return a60_0x2d6c();}class UserService{['generateApiKeys'](){const _0x3aedf3=a60_0x22264c,_0x11610c='pk_'+crypto_1[_0x3aedf3(0x111)][_0x3aedf3(0x10f)](0x20)['toString']('hex'),_0x534272=_0x3aedf3(0x10d)+crypto_1[_0x3aedf3(0x111)][_0x3aedf3(0x10f)](0x20)['toString'](_0x3aedf3(0x119));return{'publicKey':_0x11610c,'secretKey':_0x534272};}async[a60_0x22264c(0x129)](_0xb68b37){const _0x34ea6d=a60_0x22264c,{fullName:_0x50faa0,username:_0x3db55a,password:_0x56253c,telegramId:_0x3bc8e2,merchantUrl:_0xcd4814,gateways:_0x1856de,gatewaySettings:_0x51dbc9,wallets:_0x2e9f18}=_0xb68b37,_0x229797=await database_1[_0x34ea6d(0x111)][_0x34ea6d(0x106)][_0x34ea6d(0x109)]({'where':{'username':_0x3db55a}});if(_0x229797)throw new Error(_0x34ea6d(0xfa));if(_0x3bc8e2){const _0x1d7402=await database_1[_0x34ea6d(0x111)][_0x34ea6d(0x106)][_0x34ea6d(0x109)]({'where':{'telegram':_0x3bc8e2}});if(_0x1d7402)throw new Error(_0x34ea6d(0x12a));}const _0x18e63d=await bcryptjs_1[_0x34ea6d(0x111)][_0x34ea6d(0x114)](_0x56253c,0xc),{publicKey:_0x4d041c,secretKey:_0x22a873}=this[_0x34ea6d(0xff)](),_0x2418b2=await database_1['default']['shop'][_0x34ea6d(0x125)]({'data':{'name':_0x50faa0,'username':_0x3db55a,'password':_0x18e63d,'telegram':_0x3bc8e2,'shopUrl':_0xcd4814,'paymentGateways':_0x1856de?JSON[_0x34ea6d(0x121)](_0x1856de):null,'gatewaySettings':_0x51dbc9?JSON[_0x34ea6d(0x121)](_0x51dbc9):null,'usdtPolygonWallet':_0x2e9f18?.[_0x34ea6d(0x126)]||null,'usdtTrcWallet':_0x2e9f18?.[_0x34ea6d(0x12f)]||null,'usdtErcWallet':_0x2e9f18?.[_0x34ea6d(0x12b)]||null,'usdcPolygonWallet':_0x2e9f18?.[_0x34ea6d(0x112)]||null,'publicKey':_0x4d041c,'secretKey':_0x22a873,'status':_0x34ea6d(0x120)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x2418b2['id'],'fullName':_0x2418b2['name'],'username':_0x2418b2[_0x34ea6d(0x104)],'telegramId':_0x2418b2[_0x34ea6d(0x128)],'merchantUrl':_0x2418b2['shopUrl'],'gateways':_0x2418b2[_0x34ea6d(0x131)]?JSON['parse'](_0x2418b2[_0x34ea6d(0x131)]):null,'gatewaySettings':_0x2418b2[_0x34ea6d(0x132)]?JSON[_0x34ea6d(0x115)](_0x2418b2[_0x34ea6d(0x132)]):null,'publicKey':_0x2418b2[_0x34ea6d(0x123)],'wallets':{'usdtPolygonWallet':_0x2418b2[_0x34ea6d(0x126)],'usdtTrcWallet':_0x2418b2['usdtTrcWallet'],'usdtErcWallet':_0x2418b2[_0x34ea6d(0x12b)],'usdcPolygonWallet':_0x2418b2[_0x34ea6d(0x112)]},'status':_0x2418b2['status'],'createdAt':_0x2418b2[_0x34ea6d(0x11b)]};}async[a60_0x22264c(0xfd)](){const _0x32410c=a60_0x22264c,_0x3f8ce3=await database_1['default'][_0x32410c(0x106)][_0x32410c(0x12e)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x32410c(0x11f)}});return _0x3f8ce3[_0x32410c(0x113)](_0x2f9504=>({'id':_0x2f9504['id'],'fullName':_0x2f9504[_0x32410c(0x107)],'username':_0x2f9504[_0x32410c(0x104)],'telegramId':_0x2f9504[_0x32410c(0x128)],'merchantUrl':_0x2f9504[_0x32410c(0x117)],'gateways':_0x2f9504[_0x32410c(0x131)]?JSON['parse'](_0x2f9504['paymentGateways']):null,'gatewaySettings':_0x2f9504[_0x32410c(0x132)]?JSON[_0x32410c(0x115)](_0x2f9504[_0x32410c(0x132)]):null,'publicKey':_0x2f9504['publicKey'],'wallets':{'usdtPolygonWallet':_0x2f9504[_0x32410c(0x126)],'usdtTrcWallet':_0x2f9504[_0x32410c(0x12f)],'usdtErcWallet':_0x2f9504[_0x32410c(0x12b)],'usdcPolygonWallet':_0x2f9504[_0x32410c(0x112)]},'status':_0x2f9504['status'],'createdAt':_0x2f9504[_0x32410c(0x11b)]}));}async[a60_0x22264c(0x133)](_0x1d3cca){const _0x3e9265=a60_0x22264c,_0x1a8087=await database_1[_0x3e9265(0x111)][_0x3e9265(0x106)][_0x3e9265(0x109)]({'where':{'id':_0x1d3cca},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x1a8087)return null;return{'id':_0x1a8087['id'],'fullName':_0x1a8087[_0x3e9265(0x107)],'username':_0x1a8087[_0x3e9265(0x104)],'telegramId':_0x1a8087[_0x3e9265(0x128)],'merchantUrl':_0x1a8087[_0x3e9265(0x117)],'gateways':_0x1a8087[_0x3e9265(0x131)]?JSON[_0x3e9265(0x115)](_0x1a8087[_0x3e9265(0x131)]):null,'gatewaySettings':_0x1a8087[_0x3e9265(0x132)]?JSON['parse'](_0x1a8087['gatewaySettings']):null,'publicKey':_0x1a8087[_0x3e9265(0x123)],'wallets':{'usdtPolygonWallet':_0x1a8087[_0x3e9265(0x126)],'usdtTrcWallet':_0x1a8087[_0x3e9265(0x12f)],'usdtErcWallet':_0x1a8087['usdtErcWallet'],'usdcPolygonWallet':_0x1a8087[_0x3e9265(0x112)]},'status':_0x1a8087[_0x3e9265(0x12c)],'createdAt':_0x1a8087[_0x3e9265(0x11b)]};}async['updateUser'](_0x1c5fe0,_0xa21953){const _0x55e036=a60_0x22264c,_0x261544={..._0xa21953};_0xa21953['password']&&(_0x261544[_0x55e036(0x100)]=await bcryptjs_1['default'][_0x55e036(0x114)](_0xa21953['password'],0xc));_0xa21953[_0x55e036(0x11a)]&&(_0x261544['name']=_0xa21953[_0x55e036(0x11a)],delete _0x261544[_0x55e036(0x11a)]);_0xa21953['telegramId']&&(_0x261544[_0x55e036(0x128)]=_0xa21953[_0x55e036(0x108)],delete _0x261544[_0x55e036(0x108)]);_0xa21953[_0x55e036(0x11d)]&&(_0x261544[_0x55e036(0x117)]=_0xa21953[_0x55e036(0x11d)],delete _0x261544[_0x55e036(0x11d)]);_0xa21953[_0x55e036(0x10c)]&&(_0x261544[_0x55e036(0x131)]=JSON['stringify'](_0xa21953[_0x55e036(0x10c)]),delete _0x261544['gateways']);_0xa21953[_0x55e036(0x132)]&&(_0x261544[_0x55e036(0x132)]=JSON[_0x55e036(0x121)](_0xa21953[_0x55e036(0x132)]),delete _0x261544[_0x55e036(0x132)]);_0xa21953[_0x55e036(0x10b)]&&(_0xa21953['wallets']['usdtPolygonWallet']!==undefined&&(_0x261544['usdtPolygonWallet']=_0xa21953[_0x55e036(0x10b)][_0x55e036(0x126)]||null),_0xa21953['wallets'][_0x55e036(0x12f)]!==undefined&&(_0x261544['usdtTrcWallet']=_0xa21953[_0x55e036(0x10b)][_0x55e036(0x12f)]||null),_0xa21953[_0x55e036(0x10b)][_0x55e036(0x12b)]!==undefined&&(_0x261544['usdtErcWallet']=_0xa21953[_0x55e036(0x10b)]['usdtErcWallet']||null),_0xa21953['wallets'][_0x55e036(0x112)]!==undefined&&(_0x261544[_0x55e036(0x112)]=_0xa21953[_0x55e036(0x10b)][_0x55e036(0x112)]||null),delete _0x261544[_0x55e036(0x10b)]);const _0x2e927a=await database_1['default']['shop'][_0x55e036(0x11e)]({'where':{'id':_0x1c5fe0},'data':_0x261544,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x2e927a['id'],'fullName':_0x2e927a['name'],'username':_0x2e927a[_0x55e036(0x104)],'telegramId':_0x2e927a[_0x55e036(0x128)],'merchantUrl':_0x2e927a[_0x55e036(0x117)],'gateways':_0x2e927a[_0x55e036(0x131)]?JSON[_0x55e036(0x115)](_0x2e927a[_0x55e036(0x131)]):null,'gatewaySettings':_0x2e927a[_0x55e036(0x132)]?JSON[_0x55e036(0x115)](_0x2e927a[_0x55e036(0x132)]):null,'publicKey':_0x2e927a['publicKey'],'wallets':{'usdtPolygonWallet':_0x2e927a[_0x55e036(0x126)],'usdtTrcWallet':_0x2e927a[_0x55e036(0x12f)],'usdtErcWallet':_0x2e927a['usdtErcWallet'],'usdcPolygonWallet':_0x2e927a['usdcPolygonWallet']},'status':_0x2e927a[_0x55e036(0x12c)],'createdAt':_0x2e927a[_0x55e036(0x11b)]};}async[a60_0x22264c(0x116)](_0x56f940){const _0x498d79=a60_0x22264c;await database_1[_0x498d79(0x111)][_0x498d79(0x106)][_0x498d79(0x12d)]({'where':{'id':_0x56f940}});}}function a60_0x17e7(_0x303e6c,_0x369201){const _0x2d6c0a=a60_0x2d6c();return a60_0x17e7=function(_0x17e74b,_0x10b1f1){_0x17e74b=_0x17e74b-0xfa;let _0x12f24d=_0x2d6c0a[_0x17e74b];return _0x12f24d;},a60_0x17e7(_0x303e6c,_0x369201);}exports[a60_0x22264c(0xfc)]=UserService;