'use strict';const a68_0x5c4c33=a68_0x2665;(function(_0x3cda18,_0x20097b){const _0x4dc7e5=a68_0x2665,_0x5796ae=_0x3cda18();while(!![]){try{const _0x4b76ee=-parseInt(_0x4dc7e5(0x10f))/0x1+parseInt(_0x4dc7e5(0x101))/0x2*(parseInt(_0x4dc7e5(0x105))/0x3)+-parseInt(_0x4dc7e5(0x115))/0x4+-parseInt(_0x4dc7e5(0x122))/0x5+parseInt(_0x4dc7e5(0x12a))/0x6+parseInt(_0x4dc7e5(0x100))/0x7*(parseInt(_0x4dc7e5(0x119))/0x8)+-parseInt(_0x4dc7e5(0x11b))/0x9*(-parseInt(_0x4dc7e5(0x102))/0xa);if(_0x4b76ee===_0x20097b)break;else _0x5796ae['push'](_0x5796ae['shift']());}catch(_0x4bc4c6){_0x5796ae['push'](_0x5796ae['shift']());}}}(a68_0x46fb,0xe45b3));function a68_0x2665(_0x28e0f2,_0x457c86){const _0x46fbaa=a68_0x46fb();return a68_0x2665=function(_0x2665d0,_0x160110){_0x2665d0=_0x2665d0-0xf4;let _0x99c269=_0x46fbaa[_0x2665d0];return _0x99c269;},a68_0x2665(_0x28e0f2,_0x457c86);}var __importDefault=this&&this[a68_0x5c4c33(0x123)]||function(_0x14ebc5){const _0x2df1e4=a68_0x5c4c33;return _0x14ebc5&&_0x14ebc5[_0x2df1e4(0x116)]?_0x14ebc5:{'default':_0x14ebc5};};function a68_0x46fb(){const _0x11e64f=['defineProperty','7001688rIVWPw','name','9ItIUou','username','createUser','gatewaySettings','hex','usdtTrcWallet','crypto','5683555dtjnlp','__importDefault','createdAt','wallets','parse','telegramId','paymentGateways','default','3307128JmXecp','merchantUrl','generateApiKeys','pk_','create','hash','gateways','getUserById','status','updateUser','Telegram\x20username\x20already\x20exists','telegram','toString','usdtErcWallet','desc','7pbJIcu','2mZbVLi','9807140rmZUWt','UserService','sk_','5505411biXaUX','randomBytes','usdtPolygonWallet','findMany','publicKey','fullName','stringify','deleteUser','update','getAllUsers','524857PvcBBM','shop','password','map','findUnique','shopUrl','6581340cWJIeS','__esModule','usdcPolygonWallet'];a68_0x46fb=function(){return _0x11e64f;};return a68_0x46fb();}Object[a68_0x5c4c33(0x118)](exports,'__esModule',{'value':!![]}),exports[a68_0x5c4c33(0x103)]=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),crypto_1=__importDefault(require(a68_0x5c4c33(0x121))),database_1=__importDefault(require('../config/database'));class UserService{[a68_0x5c4c33(0x12c)](){const _0x29b8c1=a68_0x5c4c33,_0x12e5c7=_0x29b8c1(0xf4)+crypto_1[_0x29b8c1(0x129)][_0x29b8c1(0x106)](0x20)[_0x29b8c1(0xfd)]('hex'),_0x12fbeb=_0x29b8c1(0x104)+crypto_1[_0x29b8c1(0x129)]['randomBytes'](0x20)[_0x29b8c1(0xfd)](_0x29b8c1(0x11f));return{'publicKey':_0x12e5c7,'secretKey':_0x12fbeb};}async[a68_0x5c4c33(0x11d)](_0x4e0cad){const _0x37474c=a68_0x5c4c33,{fullName:_0x4ac9d0,username:_0x4635de,password:_0x25c299,telegramId:_0x2e3d37,merchantUrl:_0x51b0ea,gateways:_0x3cce7f,gatewaySettings:_0x5b92f3,wallets:_0x118408}=_0x4e0cad,_0x5e994a=await database_1['default'][_0x37474c(0x110)][_0x37474c(0x113)]({'where':{'username':_0x4635de}});if(_0x5e994a)throw new Error('Username\x20already\x20exists');if(_0x2e3d37){const _0x119fb0=await database_1[_0x37474c(0x129)][_0x37474c(0x110)][_0x37474c(0x113)]({'where':{'telegram':_0x2e3d37}});if(_0x119fb0)throw new Error(_0x37474c(0xfb));}const _0x597f40=await bcryptjs_1[_0x37474c(0x129)][_0x37474c(0xf6)](_0x25c299,0xc),{publicKey:_0x5b3dc8,secretKey:_0x50df63}=this['generateApiKeys'](),_0x57866f=await database_1[_0x37474c(0x129)][_0x37474c(0x110)][_0x37474c(0xf5)]({'data':{'name':_0x4ac9d0,'username':_0x4635de,'password':_0x597f40,'telegram':_0x2e3d37,'shopUrl':_0x51b0ea,'paymentGateways':_0x3cce7f?JSON['stringify'](_0x3cce7f):null,'gatewaySettings':_0x5b92f3?JSON[_0x37474c(0x10b)](_0x5b92f3):null,'usdtPolygonWallet':_0x118408?.['usdtPolygonWallet']||null,'usdtTrcWallet':_0x118408?.['usdtTrcWallet']||null,'usdtErcWallet':_0x118408?.[_0x37474c(0xfe)]||null,'usdcPolygonWallet':_0x118408?.[_0x37474c(0x117)]||null,'publicKey':_0x5b3dc8,'secretKey':_0x50df63,'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x57866f['id'],'fullName':_0x57866f['name'],'username':_0x57866f[_0x37474c(0x11c)],'telegramId':_0x57866f[_0x37474c(0xfc)],'merchantUrl':_0x57866f['shopUrl'],'gateways':_0x57866f[_0x37474c(0x128)]?JSON['parse'](_0x57866f[_0x37474c(0x128)]):null,'gatewaySettings':_0x57866f[_0x37474c(0x11e)]?JSON[_0x37474c(0x126)](_0x57866f[_0x37474c(0x11e)]):null,'publicKey':_0x57866f[_0x37474c(0x109)],'wallets':{'usdtPolygonWallet':_0x57866f[_0x37474c(0x107)],'usdtTrcWallet':_0x57866f[_0x37474c(0x120)],'usdtErcWallet':_0x57866f[_0x37474c(0xfe)],'usdcPolygonWallet':_0x57866f[_0x37474c(0x117)]},'status':_0x57866f[_0x37474c(0xf9)],'createdAt':_0x57866f['createdAt']};}async[a68_0x5c4c33(0x10e)](){const _0x306d29=a68_0x5c4c33,_0xaf90e8=await database_1[_0x306d29(0x129)][_0x306d29(0x110)][_0x306d29(0x108)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x306d29(0xff)}});return _0xaf90e8[_0x306d29(0x112)](_0xbb71aa=>({'id':_0xbb71aa['id'],'fullName':_0xbb71aa[_0x306d29(0x11a)],'username':_0xbb71aa['username'],'telegramId':_0xbb71aa['telegram'],'merchantUrl':_0xbb71aa[_0x306d29(0x114)],'gateways':_0xbb71aa['paymentGateways']?JSON[_0x306d29(0x126)](_0xbb71aa[_0x306d29(0x128)]):null,'gatewaySettings':_0xbb71aa['gatewaySettings']?JSON[_0x306d29(0x126)](_0xbb71aa['gatewaySettings']):null,'publicKey':_0xbb71aa[_0x306d29(0x109)],'wallets':{'usdtPolygonWallet':_0xbb71aa[_0x306d29(0x107)],'usdtTrcWallet':_0xbb71aa['usdtTrcWallet'],'usdtErcWallet':_0xbb71aa[_0x306d29(0xfe)],'usdcPolygonWallet':_0xbb71aa[_0x306d29(0x117)]},'status':_0xbb71aa[_0x306d29(0xf9)],'createdAt':_0xbb71aa[_0x306d29(0x124)]}));}async[a68_0x5c4c33(0xf8)](_0x454ec1){const _0x1f1449=a68_0x5c4c33,_0x506719=await database_1['default']['shop']['findUnique']({'where':{'id':_0x454ec1},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x506719)return null;return{'id':_0x506719['id'],'fullName':_0x506719[_0x1f1449(0x11a)],'username':_0x506719['username'],'telegramId':_0x506719[_0x1f1449(0xfc)],'merchantUrl':_0x506719[_0x1f1449(0x114)],'gateways':_0x506719[_0x1f1449(0x128)]?JSON[_0x1f1449(0x126)](_0x506719['paymentGateways']):null,'gatewaySettings':_0x506719[_0x1f1449(0x11e)]?JSON['parse'](_0x506719['gatewaySettings']):null,'publicKey':_0x506719[_0x1f1449(0x109)],'wallets':{'usdtPolygonWallet':_0x506719[_0x1f1449(0x107)],'usdtTrcWallet':_0x506719[_0x1f1449(0x120)],'usdtErcWallet':_0x506719[_0x1f1449(0xfe)],'usdcPolygonWallet':_0x506719[_0x1f1449(0x117)]},'status':_0x506719[_0x1f1449(0xf9)],'createdAt':_0x506719[_0x1f1449(0x124)]};}async[a68_0x5c4c33(0xfa)](_0x18b556,_0x33c20f){const _0x25be88=a68_0x5c4c33,_0x4d2aef={..._0x33c20f};_0x33c20f[_0x25be88(0x111)]&&(_0x4d2aef[_0x25be88(0x111)]=await bcryptjs_1['default'][_0x25be88(0xf6)](_0x33c20f[_0x25be88(0x111)],0xc));_0x33c20f[_0x25be88(0x10a)]&&(_0x4d2aef['name']=_0x33c20f[_0x25be88(0x10a)],delete _0x4d2aef['fullName']);_0x33c20f[_0x25be88(0x127)]&&(_0x4d2aef[_0x25be88(0xfc)]=_0x33c20f[_0x25be88(0x127)],delete _0x4d2aef[_0x25be88(0x127)]);_0x33c20f['merchantUrl']&&(_0x4d2aef['shopUrl']=_0x33c20f[_0x25be88(0x12b)],delete _0x4d2aef[_0x25be88(0x12b)]);_0x33c20f[_0x25be88(0xf7)]&&(_0x4d2aef[_0x25be88(0x128)]=JSON[_0x25be88(0x10b)](_0x33c20f[_0x25be88(0xf7)]),delete _0x4d2aef[_0x25be88(0xf7)]);_0x33c20f[_0x25be88(0x11e)]&&(_0x4d2aef[_0x25be88(0x11e)]=JSON[_0x25be88(0x10b)](_0x33c20f[_0x25be88(0x11e)]),delete _0x4d2aef[_0x25be88(0x11e)]);_0x33c20f['wallets']&&(_0x33c20f['wallets'][_0x25be88(0x107)]!==undefined&&(_0x4d2aef['usdtPolygonWallet']=_0x33c20f[_0x25be88(0x125)][_0x25be88(0x107)]||null),_0x33c20f[_0x25be88(0x125)][_0x25be88(0x120)]!==undefined&&(_0x4d2aef[_0x25be88(0x120)]=_0x33c20f[_0x25be88(0x125)][_0x25be88(0x120)]||null),_0x33c20f[_0x25be88(0x125)][_0x25be88(0xfe)]!==undefined&&(_0x4d2aef['usdtErcWallet']=_0x33c20f[_0x25be88(0x125)][_0x25be88(0xfe)]||null),_0x33c20f[_0x25be88(0x125)][_0x25be88(0x117)]!==undefined&&(_0x4d2aef[_0x25be88(0x117)]=_0x33c20f['wallets'][_0x25be88(0x117)]||null),delete _0x4d2aef['wallets']);const _0x33f0ca=await database_1[_0x25be88(0x129)][_0x25be88(0x110)][_0x25be88(0x10d)]({'where':{'id':_0x18b556},'data':_0x4d2aef,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x33f0ca['id'],'fullName':_0x33f0ca[_0x25be88(0x11a)],'username':_0x33f0ca['username'],'telegramId':_0x33f0ca[_0x25be88(0xfc)],'merchantUrl':_0x33f0ca[_0x25be88(0x114)],'gateways':_0x33f0ca['paymentGateways']?JSON['parse'](_0x33f0ca[_0x25be88(0x128)]):null,'gatewaySettings':_0x33f0ca[_0x25be88(0x11e)]?JSON[_0x25be88(0x126)](_0x33f0ca[_0x25be88(0x11e)]):null,'publicKey':_0x33f0ca[_0x25be88(0x109)],'wallets':{'usdtPolygonWallet':_0x33f0ca[_0x25be88(0x107)],'usdtTrcWallet':_0x33f0ca[_0x25be88(0x120)],'usdtErcWallet':_0x33f0ca[_0x25be88(0xfe)],'usdcPolygonWallet':_0x33f0ca[_0x25be88(0x117)]},'status':_0x33f0ca[_0x25be88(0xf9)],'createdAt':_0x33f0ca[_0x25be88(0x124)]};}async[a68_0x5c4c33(0x10c)](_0x19427c){const _0x14da33=a68_0x5c4c33;await database_1[_0x14da33(0x129)][_0x14da33(0x110)]['delete']({'where':{'id':_0x19427c}});}}exports[a68_0x5c4c33(0x103)]=UserService;