'use strict';const a51_0xdbec53=a51_0xedd4;(function(_0x106c13,_0x25dccb){const _0x502ad7=a51_0xedd4,_0x25cfa5=_0x106c13();while(!![]){try{const _0x1ca8af=parseInt(_0x502ad7(0x1db))/0x1+-parseInt(_0x502ad7(0x1cd))/0x2+parseInt(_0x502ad7(0x1d8))/0x3*(-parseInt(_0x502ad7(0x1c4))/0x4)+-parseInt(_0x502ad7(0x1c2))/0x5+parseInt(_0x502ad7(0x1d9))/0x6*(parseInt(_0x502ad7(0x1e0))/0x7)+-parseInt(_0x502ad7(0x1ce))/0x8*(parseInt(_0x502ad7(0x1bb))/0x9)+-parseInt(_0x502ad7(0x1eb))/0xa*(-parseInt(_0x502ad7(0x1d0))/0xb);if(_0x1ca8af===_0x25dccb)break;else _0x25cfa5['push'](_0x25cfa5['shift']());}catch(_0x4f5453){_0x25cfa5['push'](_0x25cfa5['shift']());}}}(a51_0x8cc0,0xa9fe2));function a51_0x8cc0(){const _0x1c1460=['desc','556gXfZcQ','parse','ACTIVE','deleteUser','findUnique','default','Username\x20already\x20exists','gateways','generateApiKeys','1951634wbiotc','375864HLppli','getAllUsers','34369819EcUxTj','username','stringify','map','telegram','gatewaySettings','UserService','usdcPolygonWallet','4506ZOgTjj','155742OadprV','shopUrl','170988IFHvJa','usdtErcWallet','publicKey','__importDefault','createUser','7eQiQDL','delete','randomBytes','status','usdtPolygonWallet','findMany','hash','paymentGateways','password','updateUser','createdAt','10gKPOic','toString','fullName','merchantUrl','crypto','defineProperty','usdtTrcWallet','name','81zxozjZ','telegramId','shop','wallets','hex','sk_','__esModule','5088710tlzOiJ'];a51_0x8cc0=function(){return _0x1c1460;};return a51_0x8cc0();}function a51_0xedd4(_0x378e93,_0x245886){const _0x8cc041=a51_0x8cc0();return a51_0xedd4=function(_0xedd40,_0x5be3d0){_0xedd40=_0xedd40-0x1b4;let _0x1f53ef=_0x8cc041[_0xedd40];return _0x1f53ef;},a51_0xedd4(_0x378e93,_0x245886);}var __importDefault=this&&this[a51_0xdbec53(0x1de)]||function(_0x30fc36){const _0x43bd16=a51_0xdbec53;return _0x30fc36&&_0x30fc36[_0x43bd16(0x1c1)]?_0x30fc36:{'default':_0x30fc36};};Object[a51_0xdbec53(0x1b8)](exports,a51_0xdbec53(0x1c1),{'value':!![]}),exports[a51_0xdbec53(0x1d6)]=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),crypto_1=__importDefault(require(a51_0xdbec53(0x1b7))),database_1=__importDefault(require('../config/database'));class UserService{[a51_0xdbec53(0x1cc)](){const _0xd0e7b2=a51_0xdbec53,_0x1c540a='pk_'+crypto_1[_0xd0e7b2(0x1c9)]['randomBytes'](0x20)[_0xd0e7b2(0x1b4)](_0xd0e7b2(0x1bf)),_0x288fa9=_0xd0e7b2(0x1c0)+crypto_1['default'][_0xd0e7b2(0x1e2)](0x20)[_0xd0e7b2(0x1b4)]('hex');return{'publicKey':_0x1c540a,'secretKey':_0x288fa9};}async[a51_0xdbec53(0x1df)](_0x54a7bd){const _0x3843ff=a51_0xdbec53,{fullName:_0x496d17,username:_0x2e5a39,password:_0x3cf443,telegramId:_0x41dea7,merchantUrl:_0x3436c1,gateways:_0x142ac9,gatewaySettings:_0x468f67,wallets:_0x5855ed}=_0x54a7bd,_0x20d3fb=await database_1['default'][_0x3843ff(0x1bd)][_0x3843ff(0x1c8)]({'where':{'username':_0x2e5a39}});if(_0x20d3fb)throw new Error(_0x3843ff(0x1ca));if(_0x41dea7){const _0x35a184=await database_1[_0x3843ff(0x1c9)][_0x3843ff(0x1bd)]['findUnique']({'where':{'telegram':_0x41dea7}});if(_0x35a184)throw new Error('Telegram\x20username\x20already\x20exists');}const _0x4a0931=await bcryptjs_1['default'][_0x3843ff(0x1e6)](_0x3cf443,0xc),{publicKey:_0x29ec90,secretKey:_0x2afc4e}=this[_0x3843ff(0x1cc)](),_0x1b1285=await database_1['default'][_0x3843ff(0x1bd)]['create']({'data':{'name':_0x496d17,'username':_0x2e5a39,'password':_0x4a0931,'telegram':_0x41dea7,'shopUrl':_0x3436c1,'paymentGateways':_0x142ac9?JSON[_0x3843ff(0x1d2)](_0x142ac9):null,'gatewaySettings':_0x468f67?JSON[_0x3843ff(0x1d2)](_0x468f67):null,'usdtPolygonWallet':_0x5855ed?.['usdtPolygonWallet']||null,'usdtTrcWallet':_0x5855ed?.[_0x3843ff(0x1b9)]||null,'usdtErcWallet':_0x5855ed?.[_0x3843ff(0x1dc)]||null,'usdcPolygonWallet':_0x5855ed?.[_0x3843ff(0x1d7)]||null,'publicKey':_0x29ec90,'secretKey':_0x2afc4e,'status':_0x3843ff(0x1c6)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x1b1285['id'],'fullName':_0x1b1285[_0x3843ff(0x1ba)],'username':_0x1b1285[_0x3843ff(0x1d1)],'telegramId':_0x1b1285['telegram'],'merchantUrl':_0x1b1285[_0x3843ff(0x1da)],'gateways':_0x1b1285[_0x3843ff(0x1e7)]?JSON['parse'](_0x1b1285[_0x3843ff(0x1e7)]):null,'gatewaySettings':_0x1b1285[_0x3843ff(0x1d5)]?JSON[_0x3843ff(0x1c5)](_0x1b1285[_0x3843ff(0x1d5)]):null,'publicKey':_0x1b1285['publicKey'],'wallets':{'usdtPolygonWallet':_0x1b1285['usdtPolygonWallet'],'usdtTrcWallet':_0x1b1285['usdtTrcWallet'],'usdtErcWallet':_0x1b1285[_0x3843ff(0x1dc)],'usdcPolygonWallet':_0x1b1285[_0x3843ff(0x1d7)]},'status':_0x1b1285[_0x3843ff(0x1e3)],'createdAt':_0x1b1285['createdAt']};}async[a51_0xdbec53(0x1cf)](){const _0x3b88d3=a51_0xdbec53,_0x3d29e4=await database_1['default'][_0x3b88d3(0x1bd)][_0x3b88d3(0x1e5)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x3b88d3(0x1c3)}});return _0x3d29e4[_0x3b88d3(0x1d3)](_0x2dae9f=>({'id':_0x2dae9f['id'],'fullName':_0x2dae9f[_0x3b88d3(0x1ba)],'username':_0x2dae9f[_0x3b88d3(0x1d1)],'telegramId':_0x2dae9f[_0x3b88d3(0x1d4)],'merchantUrl':_0x2dae9f[_0x3b88d3(0x1da)],'gateways':_0x2dae9f[_0x3b88d3(0x1e7)]?JSON[_0x3b88d3(0x1c5)](_0x2dae9f[_0x3b88d3(0x1e7)]):null,'gatewaySettings':_0x2dae9f[_0x3b88d3(0x1d5)]?JSON[_0x3b88d3(0x1c5)](_0x2dae9f[_0x3b88d3(0x1d5)]):null,'publicKey':_0x2dae9f[_0x3b88d3(0x1dd)],'wallets':{'usdtPolygonWallet':_0x2dae9f['usdtPolygonWallet'],'usdtTrcWallet':_0x2dae9f['usdtTrcWallet'],'usdtErcWallet':_0x2dae9f[_0x3b88d3(0x1dc)],'usdcPolygonWallet':_0x2dae9f[_0x3b88d3(0x1d7)]},'status':_0x2dae9f[_0x3b88d3(0x1e3)],'createdAt':_0x2dae9f[_0x3b88d3(0x1ea)]}));}async['getUserById'](_0x3758ca){const _0x226bc6=a51_0xdbec53,_0x4281ec=await database_1[_0x226bc6(0x1c9)][_0x226bc6(0x1bd)][_0x226bc6(0x1c8)]({'where':{'id':_0x3758ca},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x4281ec)return null;return{'id':_0x4281ec['id'],'fullName':_0x4281ec['name'],'username':_0x4281ec[_0x226bc6(0x1d1)],'telegramId':_0x4281ec[_0x226bc6(0x1d4)],'merchantUrl':_0x4281ec['shopUrl'],'gateways':_0x4281ec[_0x226bc6(0x1e7)]?JSON['parse'](_0x4281ec[_0x226bc6(0x1e7)]):null,'gatewaySettings':_0x4281ec[_0x226bc6(0x1d5)]?JSON['parse'](_0x4281ec[_0x226bc6(0x1d5)]):null,'publicKey':_0x4281ec['publicKey'],'wallets':{'usdtPolygonWallet':_0x4281ec[_0x226bc6(0x1e4)],'usdtTrcWallet':_0x4281ec['usdtTrcWallet'],'usdtErcWallet':_0x4281ec['usdtErcWallet'],'usdcPolygonWallet':_0x4281ec[_0x226bc6(0x1d7)]},'status':_0x4281ec[_0x226bc6(0x1e3)],'createdAt':_0x4281ec[_0x226bc6(0x1ea)]};}async[a51_0xdbec53(0x1e9)](_0x263595,_0x4dbc02){const _0x33161b=a51_0xdbec53,_0xd575a6={..._0x4dbc02};_0x4dbc02[_0x33161b(0x1e8)]&&(_0xd575a6['password']=await bcryptjs_1[_0x33161b(0x1c9)]['hash'](_0x4dbc02[_0x33161b(0x1e8)],0xc));_0x4dbc02[_0x33161b(0x1b5)]&&(_0xd575a6[_0x33161b(0x1ba)]=_0x4dbc02[_0x33161b(0x1b5)],delete _0xd575a6[_0x33161b(0x1b5)]);_0x4dbc02[_0x33161b(0x1bc)]&&(_0xd575a6[_0x33161b(0x1d4)]=_0x4dbc02[_0x33161b(0x1bc)],delete _0xd575a6[_0x33161b(0x1bc)]);_0x4dbc02['merchantUrl']&&(_0xd575a6[_0x33161b(0x1da)]=_0x4dbc02[_0x33161b(0x1b6)],delete _0xd575a6['merchantUrl']);_0x4dbc02[_0x33161b(0x1cb)]&&(_0xd575a6['paymentGateways']=JSON[_0x33161b(0x1d2)](_0x4dbc02[_0x33161b(0x1cb)]),delete _0xd575a6[_0x33161b(0x1cb)]);_0x4dbc02['gatewaySettings']&&(_0xd575a6[_0x33161b(0x1d5)]=JSON[_0x33161b(0x1d2)](_0x4dbc02[_0x33161b(0x1d5)]),delete _0xd575a6[_0x33161b(0x1d5)]);_0x4dbc02[_0x33161b(0x1be)]&&(_0x4dbc02[_0x33161b(0x1be)][_0x33161b(0x1e4)]!==undefined&&(_0xd575a6[_0x33161b(0x1e4)]=_0x4dbc02[_0x33161b(0x1be)]['usdtPolygonWallet']||null),_0x4dbc02['wallets'][_0x33161b(0x1b9)]!==undefined&&(_0xd575a6[_0x33161b(0x1b9)]=_0x4dbc02[_0x33161b(0x1be)][_0x33161b(0x1b9)]||null),_0x4dbc02[_0x33161b(0x1be)][_0x33161b(0x1dc)]!==undefined&&(_0xd575a6[_0x33161b(0x1dc)]=_0x4dbc02[_0x33161b(0x1be)][_0x33161b(0x1dc)]||null),_0x4dbc02[_0x33161b(0x1be)][_0x33161b(0x1d7)]!==undefined&&(_0xd575a6[_0x33161b(0x1d7)]=_0x4dbc02[_0x33161b(0x1be)][_0x33161b(0x1d7)]||null),delete _0xd575a6[_0x33161b(0x1be)]);const _0x4d8203=await database_1['default'][_0x33161b(0x1bd)]['update']({'where':{'id':_0x263595},'data':_0xd575a6,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x4d8203['id'],'fullName':_0x4d8203[_0x33161b(0x1ba)],'username':_0x4d8203[_0x33161b(0x1d1)],'telegramId':_0x4d8203[_0x33161b(0x1d4)],'merchantUrl':_0x4d8203[_0x33161b(0x1da)],'gateways':_0x4d8203[_0x33161b(0x1e7)]?JSON['parse'](_0x4d8203['paymentGateways']):null,'gatewaySettings':_0x4d8203['gatewaySettings']?JSON['parse'](_0x4d8203['gatewaySettings']):null,'publicKey':_0x4d8203[_0x33161b(0x1dd)],'wallets':{'usdtPolygonWallet':_0x4d8203[_0x33161b(0x1e4)],'usdtTrcWallet':_0x4d8203[_0x33161b(0x1b9)],'usdtErcWallet':_0x4d8203[_0x33161b(0x1dc)],'usdcPolygonWallet':_0x4d8203[_0x33161b(0x1d7)]},'status':_0x4d8203[_0x33161b(0x1e3)],'createdAt':_0x4d8203[_0x33161b(0x1ea)]};}async[a51_0xdbec53(0x1c7)](_0x244828){const _0x44bf7f=a51_0xdbec53;await database_1[_0x44bf7f(0x1c9)][_0x44bf7f(0x1bd)][_0x44bf7f(0x1e1)]({'where':{'id':_0x244828}});}}exports[a51_0xdbec53(0x1d6)]=UserService;