'use strict';const a59_0x80ac18=a59_0x1aaa;(function(_0x43bd6a,_0x3fd216){const _0x31014f=a59_0x1aaa,_0x20e5b3=_0x43bd6a();while(!![]){try{const _0x43ff53=parseInt(_0x31014f(0xf8))/0x1*(-parseInt(_0x31014f(0xef))/0x2)+parseInt(_0x31014f(0x124))/0x3+-parseInt(_0x31014f(0xfb))/0x4*(-parseInt(_0x31014f(0xfc))/0x5)+parseInt(_0x31014f(0x118))/0x6*(-parseInt(_0x31014f(0x122))/0x7)+parseInt(_0x31014f(0x108))/0x8*(parseInt(_0x31014f(0xea))/0x9)+parseInt(_0x31014f(0x10a))/0xa*(-parseInt(_0x31014f(0x103))/0xb)+parseInt(_0x31014f(0x101))/0xc*(parseInt(_0x31014f(0xfa))/0xd);if(_0x43ff53===_0x3fd216)break;else _0x20e5b3['push'](_0x20e5b3['shift']());}catch(_0x20205b){_0x20e5b3['push'](_0x20e5b3['shift']());}}}(a59_0x3d43,0xd9f13));function a59_0x1aaa(_0x3e67e0,_0x313305){const _0x3d43ad=a59_0x3d43();return a59_0x1aaa=function(_0x1aaa46,_0x94c2a1){_0x1aaa46=_0x1aaa46-0xea;let _0x1a0286=_0x3d43ad[_0x1aaa46];return _0x1a0286;},a59_0x1aaa(_0x3e67e0,_0x313305);}var __importDefault=this&&this[a59_0x80ac18(0x113)]||function(_0x3d70f0){const _0x18e4d7=a59_0x80ac18;return _0x3d70f0&&_0x3d70f0[_0x18e4d7(0x123)]?_0x3d70f0:{'default':_0x3d70f0};};Object['defineProperty'](exports,a59_0x80ac18(0x123),{'value':!![]}),exports['UserService']=void 0x0;function a59_0x3d43(){const _0x55d107=['ACTIVE','name','desc','update','delete','generateApiKeys','__importDefault','telegram','create','map','hash','576XwTjZZ','stringify','telegramId','toString','usdtTrcWallet','randomBytes','findUnique','parse','paymentGateways','updateUser','77686zcDGwz','__esModule','1143744CSupuq','53595phsxvm','status','createdAt','Username\x20already\x20exists','gatewaySettings','233834yWmbfE','default','shopUrl','usdtErcWallet','../config/database','bcryptjs','getAllUsers','publicKey','sk_','3pfGzqg','gateways','5122975HAglui','4wsRMXW','537640iYIjfq','merchantUrl','Telegram\x20username\x20already\x20exists','hex','findMany','36Hbggqt','password','909766rqrBZw','usdtPolygonWallet','fullName','wallets','usdcPolygonWallet','968IVeSka','deleteUser','10oELkOy','username','shop'];a59_0x3d43=function(){return _0x55d107;};return a59_0x3d43();}const bcryptjs_1=__importDefault(require(a59_0x80ac18(0xf4))),crypto_1=__importDefault(require('crypto')),database_1=__importDefault(require(a59_0x80ac18(0xf3)));class UserService{[a59_0x80ac18(0x112)](){const _0x580037=a59_0x80ac18,_0x25cbf5='pk_'+crypto_1[_0x580037(0xf0)][_0x580037(0x11d)](0x20)[_0x580037(0x11b)](_0x580037(0xff)),_0x5a3a73=_0x580037(0xf7)+crypto_1[_0x580037(0xf0)][_0x580037(0x11d)](0x20)[_0x580037(0x11b)](_0x580037(0xff));return{'publicKey':_0x25cbf5,'secretKey':_0x5a3a73};}async['createUser'](_0x3b0f38){const _0x1d4ecd=a59_0x80ac18,{fullName:_0x340c14,username:_0x3cd1d9,password:_0x7a7217,telegramId:_0x30dd15,merchantUrl:_0xb165e7,gateways:_0x4a98ae,gatewaySettings:_0x5ebf7e,wallets:_0x4f019e}=_0x3b0f38,_0x12c68d=await database_1[_0x1d4ecd(0xf0)]['shop']['findUnique']({'where':{'username':_0x3cd1d9}});if(_0x12c68d)throw new Error(_0x1d4ecd(0xed));if(_0x30dd15){const _0x56679c=await database_1[_0x1d4ecd(0xf0)][_0x1d4ecd(0x10c)][_0x1d4ecd(0x11e)]({'where':{'telegram':_0x30dd15}});if(_0x56679c)throw new Error(_0x1d4ecd(0xfe));}const _0x398c04=await bcryptjs_1[_0x1d4ecd(0xf0)][_0x1d4ecd(0x117)](_0x7a7217,0xc),{publicKey:_0x447091,secretKey:_0x524b36}=this['generateApiKeys'](),_0x5a1715=await database_1[_0x1d4ecd(0xf0)][_0x1d4ecd(0x10c)][_0x1d4ecd(0x115)]({'data':{'name':_0x340c14,'username':_0x3cd1d9,'password':_0x398c04,'telegram':_0x30dd15,'shopUrl':_0xb165e7,'paymentGateways':_0x4a98ae?JSON[_0x1d4ecd(0x119)](_0x4a98ae):null,'gatewaySettings':_0x5ebf7e?JSON[_0x1d4ecd(0x119)](_0x5ebf7e):null,'usdtPolygonWallet':_0x4f019e?.['usdtPolygonWallet']||null,'usdtTrcWallet':_0x4f019e?.['usdtTrcWallet']||null,'usdtErcWallet':_0x4f019e?.[_0x1d4ecd(0xf2)]||null,'usdcPolygonWallet':_0x4f019e?.[_0x1d4ecd(0x107)]||null,'publicKey':_0x447091,'secretKey':_0x524b36,'status':_0x1d4ecd(0x10d)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x5a1715['id'],'fullName':_0x5a1715[_0x1d4ecd(0x10e)],'username':_0x5a1715[_0x1d4ecd(0x10b)],'telegramId':_0x5a1715[_0x1d4ecd(0x114)],'merchantUrl':_0x5a1715[_0x1d4ecd(0xf1)],'gateways':_0x5a1715[_0x1d4ecd(0x120)]?JSON[_0x1d4ecd(0x11f)](_0x5a1715['paymentGateways']):null,'gatewaySettings':_0x5a1715['gatewaySettings']?JSON['parse'](_0x5a1715['gatewaySettings']):null,'publicKey':_0x5a1715[_0x1d4ecd(0xf6)],'wallets':{'usdtPolygonWallet':_0x5a1715[_0x1d4ecd(0x104)],'usdtTrcWallet':_0x5a1715[_0x1d4ecd(0x11c)],'usdtErcWallet':_0x5a1715['usdtErcWallet'],'usdcPolygonWallet':_0x5a1715[_0x1d4ecd(0x107)]},'status':_0x5a1715['status'],'createdAt':_0x5a1715[_0x1d4ecd(0xec)]};}async[a59_0x80ac18(0xf5)](){const _0x49e003=a59_0x80ac18,_0x3c0074=await database_1['default'][_0x49e003(0x10c)][_0x49e003(0x100)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x49e003(0x10f)}});return _0x3c0074[_0x49e003(0x116)](_0x3f29fc=>({'id':_0x3f29fc['id'],'fullName':_0x3f29fc[_0x49e003(0x10e)],'username':_0x3f29fc[_0x49e003(0x10b)],'telegramId':_0x3f29fc[_0x49e003(0x114)],'merchantUrl':_0x3f29fc[_0x49e003(0xf1)],'gateways':_0x3f29fc[_0x49e003(0x120)]?JSON[_0x49e003(0x11f)](_0x3f29fc['paymentGateways']):null,'gatewaySettings':_0x3f29fc[_0x49e003(0xee)]?JSON[_0x49e003(0x11f)](_0x3f29fc[_0x49e003(0xee)]):null,'publicKey':_0x3f29fc['publicKey'],'wallets':{'usdtPolygonWallet':_0x3f29fc[_0x49e003(0x104)],'usdtTrcWallet':_0x3f29fc[_0x49e003(0x11c)],'usdtErcWallet':_0x3f29fc[_0x49e003(0xf2)],'usdcPolygonWallet':_0x3f29fc[_0x49e003(0x107)]},'status':_0x3f29fc[_0x49e003(0xeb)],'createdAt':_0x3f29fc['createdAt']}));}async['getUserById'](_0x2b72dc){const _0x4f5d1c=a59_0x80ac18,_0x22706d=await database_1['default']['shop'][_0x4f5d1c(0x11e)]({'where':{'id':_0x2b72dc},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x22706d)return null;return{'id':_0x22706d['id'],'fullName':_0x22706d[_0x4f5d1c(0x10e)],'username':_0x22706d[_0x4f5d1c(0x10b)],'telegramId':_0x22706d[_0x4f5d1c(0x114)],'merchantUrl':_0x22706d[_0x4f5d1c(0xf1)],'gateways':_0x22706d[_0x4f5d1c(0x120)]?JSON[_0x4f5d1c(0x11f)](_0x22706d[_0x4f5d1c(0x120)]):null,'gatewaySettings':_0x22706d['gatewaySettings']?JSON[_0x4f5d1c(0x11f)](_0x22706d[_0x4f5d1c(0xee)]):null,'publicKey':_0x22706d['publicKey'],'wallets':{'usdtPolygonWallet':_0x22706d[_0x4f5d1c(0x104)],'usdtTrcWallet':_0x22706d[_0x4f5d1c(0x11c)],'usdtErcWallet':_0x22706d[_0x4f5d1c(0xf2)],'usdcPolygonWallet':_0x22706d[_0x4f5d1c(0x107)]},'status':_0x22706d[_0x4f5d1c(0xeb)],'createdAt':_0x22706d[_0x4f5d1c(0xec)]};}async[a59_0x80ac18(0x121)](_0x1f799c,_0x5b26b3){const _0x514d7e=a59_0x80ac18,_0x180840={..._0x5b26b3};_0x5b26b3[_0x514d7e(0x102)]&&(_0x180840[_0x514d7e(0x102)]=await bcryptjs_1[_0x514d7e(0xf0)]['hash'](_0x5b26b3['password'],0xc));_0x5b26b3[_0x514d7e(0x105)]&&(_0x180840[_0x514d7e(0x10e)]=_0x5b26b3[_0x514d7e(0x105)],delete _0x180840[_0x514d7e(0x105)]);_0x5b26b3[_0x514d7e(0x11a)]&&(_0x180840[_0x514d7e(0x114)]=_0x5b26b3[_0x514d7e(0x11a)],delete _0x180840[_0x514d7e(0x11a)]);_0x5b26b3[_0x514d7e(0xfd)]&&(_0x180840[_0x514d7e(0xf1)]=_0x5b26b3[_0x514d7e(0xfd)],delete _0x180840[_0x514d7e(0xfd)]);_0x5b26b3[_0x514d7e(0xf9)]&&(_0x180840[_0x514d7e(0x120)]=JSON[_0x514d7e(0x119)](_0x5b26b3[_0x514d7e(0xf9)]),delete _0x180840['gateways']);_0x5b26b3[_0x514d7e(0xee)]&&(_0x180840[_0x514d7e(0xee)]=JSON[_0x514d7e(0x119)](_0x5b26b3[_0x514d7e(0xee)]),delete _0x180840[_0x514d7e(0xee)]);_0x5b26b3[_0x514d7e(0x106)]&&(_0x5b26b3[_0x514d7e(0x106)][_0x514d7e(0x104)]!==undefined&&(_0x180840[_0x514d7e(0x104)]=_0x5b26b3[_0x514d7e(0x106)][_0x514d7e(0x104)]||null),_0x5b26b3[_0x514d7e(0x106)][_0x514d7e(0x11c)]!==undefined&&(_0x180840['usdtTrcWallet']=_0x5b26b3['wallets'][_0x514d7e(0x11c)]||null),_0x5b26b3[_0x514d7e(0x106)]['usdtErcWallet']!==undefined&&(_0x180840[_0x514d7e(0xf2)]=_0x5b26b3[_0x514d7e(0x106)][_0x514d7e(0xf2)]||null),_0x5b26b3[_0x514d7e(0x106)][_0x514d7e(0x107)]!==undefined&&(_0x180840[_0x514d7e(0x107)]=_0x5b26b3[_0x514d7e(0x106)][_0x514d7e(0x107)]||null),delete _0x180840[_0x514d7e(0x106)]);const _0xa46e80=await database_1[_0x514d7e(0xf0)][_0x514d7e(0x10c)][_0x514d7e(0x110)]({'where':{'id':_0x1f799c},'data':_0x180840,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0xa46e80['id'],'fullName':_0xa46e80['name'],'username':_0xa46e80[_0x514d7e(0x10b)],'telegramId':_0xa46e80[_0x514d7e(0x114)],'merchantUrl':_0xa46e80['shopUrl'],'gateways':_0xa46e80[_0x514d7e(0x120)]?JSON[_0x514d7e(0x11f)](_0xa46e80['paymentGateways']):null,'gatewaySettings':_0xa46e80[_0x514d7e(0xee)]?JSON['parse'](_0xa46e80['gatewaySettings']):null,'publicKey':_0xa46e80['publicKey'],'wallets':{'usdtPolygonWallet':_0xa46e80[_0x514d7e(0x104)],'usdtTrcWallet':_0xa46e80[_0x514d7e(0x11c)],'usdtErcWallet':_0xa46e80[_0x514d7e(0xf2)],'usdcPolygonWallet':_0xa46e80[_0x514d7e(0x107)]},'status':_0xa46e80[_0x514d7e(0xeb)],'createdAt':_0xa46e80[_0x514d7e(0xec)]};}async[a59_0x80ac18(0x109)](_0x3a9ee6){const _0x480c7a=a59_0x80ac18;await database_1[_0x480c7a(0xf0)][_0x480c7a(0x10c)][_0x480c7a(0x111)]({'where':{'id':_0x3a9ee6}});}}exports['UserService']=UserService;