'use strict';const a68_0x31925d=a68_0x24a6;function a68_0x24a6(_0xf86111,_0x5b04a8){const _0x296fc5=a68_0x296f();return a68_0x24a6=function(_0x24a6f8,_0x19df93){_0x24a6f8=_0x24a6f8-0x1ba;let _0x51554=_0x296fc5[_0x24a6f8];return _0x51554;},a68_0x24a6(_0xf86111,_0x5b04a8);}function a68_0x296f(){const _0x5af969=['ACTIVE','generateApiKeys','password','gatewaySettings','default','148xlfQAG','161RnjygV','paymentGateways','__esModule','810OylANK','4011835ccqorA','shopUrl','publicKey','randomBytes','372956pqGbAH','telegram','shop','delete','name','usdcPolygonWallet','65934qCGOfr','stringify','username','112408wzZyeS','hash','telegramId','toString','usdtTrcWallet','getUserById','updateUser','12056swevly','getAllUsers','../config/database','findMany','create','createdAt','status','sk_','map','fullName','hex','Telegram\x20username\x20already\x20exists','defineProperty','usdtPolygonWallet','gateways','usdtErcWallet','findUnique','4530540kJPqjC','desc','deleteUser','bcryptjs','merchantUrl','UserService','wallets','213540Cmycrv','parse'];a68_0x296f=function(){return _0x5af969;};return a68_0x296f();}(function(_0x50b5f6,_0x57c92a){const _0x351936=a68_0x24a6,_0x1a8d14=_0x50b5f6();while(!![]){try{const _0x2f34ca=-parseInt(_0x351936(0x1da))/0x1*(-parseInt(_0x351936(0x1c1))/0x2)+-parseInt(_0x351936(0x1ba))/0x3+-parseInt(_0x351936(0x1ca))/0x4+parseInt(_0x351936(0x1c6))/0x5+-parseInt(_0x351936(0x1eb))/0x6+parseInt(_0x351936(0x1c2))/0x7*(parseInt(_0x351936(0x1d3))/0x8)+parseInt(_0x351936(0x1d0))/0x9*(-parseInt(_0x351936(0x1c5))/0xa);if(_0x2f34ca===_0x57c92a)break;else _0x1a8d14['push'](_0x1a8d14['shift']());}catch(_0x37486c){_0x1a8d14['push'](_0x1a8d14['shift']());}}}(a68_0x296f,0x7b3c1));var __importDefault=this&&this['__importDefault']||function(_0x1ba38b){return _0x1ba38b&&_0x1ba38b['__esModule']?_0x1ba38b:{'default':_0x1ba38b};};Object[a68_0x31925d(0x1e6)](exports,a68_0x31925d(0x1c4),{'value':!![]}),exports[a68_0x31925d(0x1f0)]=void 0x0;const bcryptjs_1=__importDefault(require(a68_0x31925d(0x1ee))),crypto_1=__importDefault(require('crypto')),database_1=__importDefault(require(a68_0x31925d(0x1dc)));class UserService{[a68_0x31925d(0x1bd)](){const _0x38f48f=a68_0x31925d,_0x21cdfd='pk_'+crypto_1[_0x38f48f(0x1c0)][_0x38f48f(0x1c9)](0x20)[_0x38f48f(0x1d6)](_0x38f48f(0x1e4)),_0x366a0d=_0x38f48f(0x1e1)+crypto_1[_0x38f48f(0x1c0)]['randomBytes'](0x20)[_0x38f48f(0x1d6)](_0x38f48f(0x1e4));return{'publicKey':_0x21cdfd,'secretKey':_0x366a0d};}async['createUser'](_0x23a348){const _0x51e0a7=a68_0x31925d,{fullName:_0xb780c9,username:_0x8a8767,password:_0x4e07c8,telegramId:_0x1350a3,merchantUrl:_0x1b85d6,gateways:_0x5c6290,gatewaySettings:_0x3d372c,wallets:_0x52065c}=_0x23a348,_0x562c74=await database_1['default']['shop']['findUnique']({'where':{'username':_0x8a8767}});if(_0x562c74)throw new Error('Username\x20already\x20exists');if(_0x1350a3){const _0x5a19cb=await database_1[_0x51e0a7(0x1c0)][_0x51e0a7(0x1cc)][_0x51e0a7(0x1ea)]({'where':{'telegram':_0x1350a3}});if(_0x5a19cb)throw new Error(_0x51e0a7(0x1e5));}const _0x1acd91=await bcryptjs_1['default'][_0x51e0a7(0x1d4)](_0x4e07c8,0xc),{publicKey:_0x41b5d8,secretKey:_0x2e9adf}=this[_0x51e0a7(0x1bd)](),_0x20c926=await database_1[_0x51e0a7(0x1c0)][_0x51e0a7(0x1cc)][_0x51e0a7(0x1de)]({'data':{'name':_0xb780c9,'username':_0x8a8767,'password':_0x1acd91,'telegram':_0x1350a3,'shopUrl':_0x1b85d6,'paymentGateways':_0x5c6290?JSON['stringify'](_0x5c6290):null,'gatewaySettings':_0x3d372c?JSON['stringify'](_0x3d372c):null,'usdtPolygonWallet':_0x52065c?.['usdtPolygonWallet']||null,'usdtTrcWallet':_0x52065c?.[_0x51e0a7(0x1d7)]||null,'usdtErcWallet':_0x52065c?.[_0x51e0a7(0x1e9)]||null,'usdcPolygonWallet':_0x52065c?.[_0x51e0a7(0x1cf)]||null,'publicKey':_0x41b5d8,'secretKey':_0x2e9adf,'status':_0x51e0a7(0x1bc)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x20c926['id'],'fullName':_0x20c926[_0x51e0a7(0x1ce)],'username':_0x20c926[_0x51e0a7(0x1d2)],'telegramId':_0x20c926[_0x51e0a7(0x1cb)],'merchantUrl':_0x20c926[_0x51e0a7(0x1c7)],'gateways':_0x20c926[_0x51e0a7(0x1c3)]?JSON[_0x51e0a7(0x1bb)](_0x20c926[_0x51e0a7(0x1c3)]):null,'gatewaySettings':_0x20c926['gatewaySettings']?JSON['parse'](_0x20c926[_0x51e0a7(0x1bf)]):null,'publicKey':_0x20c926['publicKey'],'wallets':{'usdtPolygonWallet':_0x20c926[_0x51e0a7(0x1e7)],'usdtTrcWallet':_0x20c926[_0x51e0a7(0x1d7)],'usdtErcWallet':_0x20c926[_0x51e0a7(0x1e9)],'usdcPolygonWallet':_0x20c926[_0x51e0a7(0x1cf)]},'status':_0x20c926['status'],'createdAt':_0x20c926[_0x51e0a7(0x1df)]};}async[a68_0x31925d(0x1db)](){const _0x433794=a68_0x31925d,_0x5860d7=await database_1[_0x433794(0x1c0)][_0x433794(0x1cc)][_0x433794(0x1dd)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x433794(0x1ec)}});return _0x5860d7[_0x433794(0x1e2)](_0x363187=>({'id':_0x363187['id'],'fullName':_0x363187[_0x433794(0x1ce)],'username':_0x363187[_0x433794(0x1d2)],'telegramId':_0x363187[_0x433794(0x1cb)],'merchantUrl':_0x363187[_0x433794(0x1c7)],'gateways':_0x363187[_0x433794(0x1c3)]?JSON['parse'](_0x363187['paymentGateways']):null,'gatewaySettings':_0x363187['gatewaySettings']?JSON[_0x433794(0x1bb)](_0x363187[_0x433794(0x1bf)]):null,'publicKey':_0x363187[_0x433794(0x1c8)],'wallets':{'usdtPolygonWallet':_0x363187[_0x433794(0x1e7)],'usdtTrcWallet':_0x363187[_0x433794(0x1d7)],'usdtErcWallet':_0x363187['usdtErcWallet'],'usdcPolygonWallet':_0x363187[_0x433794(0x1cf)]},'status':_0x363187['status'],'createdAt':_0x363187[_0x433794(0x1df)]}));}async[a68_0x31925d(0x1d8)](_0x134be4){const _0x4afff7=a68_0x31925d,_0x2acb8c=await database_1[_0x4afff7(0x1c0)][_0x4afff7(0x1cc)][_0x4afff7(0x1ea)]({'where':{'id':_0x134be4},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x2acb8c)return null;return{'id':_0x2acb8c['id'],'fullName':_0x2acb8c[_0x4afff7(0x1ce)],'username':_0x2acb8c['username'],'telegramId':_0x2acb8c[_0x4afff7(0x1cb)],'merchantUrl':_0x2acb8c[_0x4afff7(0x1c7)],'gateways':_0x2acb8c[_0x4afff7(0x1c3)]?JSON[_0x4afff7(0x1bb)](_0x2acb8c[_0x4afff7(0x1c3)]):null,'gatewaySettings':_0x2acb8c[_0x4afff7(0x1bf)]?JSON[_0x4afff7(0x1bb)](_0x2acb8c[_0x4afff7(0x1bf)]):null,'publicKey':_0x2acb8c[_0x4afff7(0x1c8)],'wallets':{'usdtPolygonWallet':_0x2acb8c[_0x4afff7(0x1e7)],'usdtTrcWallet':_0x2acb8c['usdtTrcWallet'],'usdtErcWallet':_0x2acb8c[_0x4afff7(0x1e9)],'usdcPolygonWallet':_0x2acb8c[_0x4afff7(0x1cf)]},'status':_0x2acb8c[_0x4afff7(0x1e0)],'createdAt':_0x2acb8c[_0x4afff7(0x1df)]};}async[a68_0x31925d(0x1d9)](_0x1b5d3f,_0x1ed511){const _0x3fe9e4=a68_0x31925d,_0x3e8e9c={..._0x1ed511};_0x1ed511['password']&&(_0x3e8e9c[_0x3fe9e4(0x1be)]=await bcryptjs_1[_0x3fe9e4(0x1c0)][_0x3fe9e4(0x1d4)](_0x1ed511[_0x3fe9e4(0x1be)],0xc));_0x1ed511[_0x3fe9e4(0x1e3)]&&(_0x3e8e9c[_0x3fe9e4(0x1ce)]=_0x1ed511[_0x3fe9e4(0x1e3)],delete _0x3e8e9c[_0x3fe9e4(0x1e3)]);_0x1ed511['telegramId']&&(_0x3e8e9c[_0x3fe9e4(0x1cb)]=_0x1ed511[_0x3fe9e4(0x1d5)],delete _0x3e8e9c['telegramId']);_0x1ed511[_0x3fe9e4(0x1ef)]&&(_0x3e8e9c[_0x3fe9e4(0x1c7)]=_0x1ed511[_0x3fe9e4(0x1ef)],delete _0x3e8e9c[_0x3fe9e4(0x1ef)]);_0x1ed511[_0x3fe9e4(0x1e8)]&&(_0x3e8e9c['paymentGateways']=JSON[_0x3fe9e4(0x1d1)](_0x1ed511[_0x3fe9e4(0x1e8)]),delete _0x3e8e9c[_0x3fe9e4(0x1e8)]);_0x1ed511[_0x3fe9e4(0x1bf)]&&(_0x3e8e9c[_0x3fe9e4(0x1bf)]=JSON[_0x3fe9e4(0x1d1)](_0x1ed511['gatewaySettings']),delete _0x3e8e9c['gatewaySettings']);_0x1ed511['wallets']&&(_0x1ed511[_0x3fe9e4(0x1f1)]['usdtPolygonWallet']!==undefined&&(_0x3e8e9c[_0x3fe9e4(0x1e7)]=_0x1ed511[_0x3fe9e4(0x1f1)][_0x3fe9e4(0x1e7)]||null),_0x1ed511['wallets'][_0x3fe9e4(0x1d7)]!==undefined&&(_0x3e8e9c['usdtTrcWallet']=_0x1ed511[_0x3fe9e4(0x1f1)][_0x3fe9e4(0x1d7)]||null),_0x1ed511[_0x3fe9e4(0x1f1)][_0x3fe9e4(0x1e9)]!==undefined&&(_0x3e8e9c[_0x3fe9e4(0x1e9)]=_0x1ed511[_0x3fe9e4(0x1f1)][_0x3fe9e4(0x1e9)]||null),_0x1ed511[_0x3fe9e4(0x1f1)][_0x3fe9e4(0x1cf)]!==undefined&&(_0x3e8e9c[_0x3fe9e4(0x1cf)]=_0x1ed511[_0x3fe9e4(0x1f1)][_0x3fe9e4(0x1cf)]||null),delete _0x3e8e9c[_0x3fe9e4(0x1f1)]);const _0x5d04ff=await database_1['default']['shop']['update']({'where':{'id':_0x1b5d3f},'data':_0x3e8e9c,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x5d04ff['id'],'fullName':_0x5d04ff[_0x3fe9e4(0x1ce)],'username':_0x5d04ff[_0x3fe9e4(0x1d2)],'telegramId':_0x5d04ff['telegram'],'merchantUrl':_0x5d04ff[_0x3fe9e4(0x1c7)],'gateways':_0x5d04ff['paymentGateways']?JSON[_0x3fe9e4(0x1bb)](_0x5d04ff[_0x3fe9e4(0x1c3)]):null,'gatewaySettings':_0x5d04ff[_0x3fe9e4(0x1bf)]?JSON['parse'](_0x5d04ff[_0x3fe9e4(0x1bf)]):null,'publicKey':_0x5d04ff[_0x3fe9e4(0x1c8)],'wallets':{'usdtPolygonWallet':_0x5d04ff[_0x3fe9e4(0x1e7)],'usdtTrcWallet':_0x5d04ff['usdtTrcWallet'],'usdtErcWallet':_0x5d04ff[_0x3fe9e4(0x1e9)],'usdcPolygonWallet':_0x5d04ff[_0x3fe9e4(0x1cf)]},'status':_0x5d04ff[_0x3fe9e4(0x1e0)],'createdAt':_0x5d04ff[_0x3fe9e4(0x1df)]};}async[a68_0x31925d(0x1ed)](_0x27b800){const _0x5d0628=a68_0x31925d;await database_1['default'][_0x5d0628(0x1cc)][_0x5d0628(0x1cd)]({'where':{'id':_0x27b800}});}}exports['UserService']=UserService;