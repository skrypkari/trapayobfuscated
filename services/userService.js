'use strict';const a89_0x39bacc=a89_0x5a4f;(function(_0x2d9d69,_0x132557){const _0x5ab121=a89_0x5a4f,_0xaaa61a=_0x2d9d69();while(!![]){try{const _0x27e6b2=-parseInt(_0x5ab121(0xe4))/0x1+parseInt(_0x5ab121(0x10c))/0x2+-parseInt(_0x5ab121(0xf2))/0x3+-parseInt(_0x5ab121(0xea))/0x4+-parseInt(_0x5ab121(0xe7))/0x5*(-parseInt(_0x5ab121(0x102))/0x6)+-parseInt(_0x5ab121(0xe0))/0x7*(parseInt(_0x5ab121(0xed))/0x8)+-parseInt(_0x5ab121(0x108))/0x9*(-parseInt(_0x5ab121(0x113))/0xa);if(_0x27e6b2===_0x132557)break;else _0xaaa61a['push'](_0xaaa61a['shift']());}catch(_0x4e3856){_0xaaa61a['push'](_0xaaa61a['shift']());}}}(a89_0x3675,0x995cc));function a89_0x3675(){const _0x2475a7=['status','delete','fullName','ACTIVE','usdtTrcWallet','merchantUrl4','shopUrl4','getUserById','updateUser','168492NVhUcp','usdtErcWallet','desc','parse','username','default','35613umJpxC','publicKey','paymentGateways','merchantUrl','1677980cRlQLw','telegram','createUser','bcryptjs','hex','randomBytes','findUnique','1680OqnJtN','gateways','telegramId','Username\x20already\x20exists','getAllUsers','merchantUrl3','toString','stringify','crypto','28tRcHHm','name','generateApiKeys','shopUrl2','393035tIKrMI','wallets','create','205IfhLVU','__esModule','shopUrl3','1555424sLwzhI','hash','merchantUrl2','709040OWMPiL','createdAt','shopUrl','map','gatewaySettings','2671635NgVpRu','shop','pk_','password','usdtPolygonWallet','usdcPolygonWallet','Telegram\x20username\x20already\x20exists'];a89_0x3675=function(){return _0x2475a7;};return a89_0x3675();}var __importDefault=this&&this['__importDefault']||function(_0x330f5a){const _0x59e278=a89_0x5a4f;return _0x330f5a&&_0x330f5a[_0x59e278(0xe8)]?_0x330f5a:{'default':_0x330f5a};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports['UserService']=void 0x0;function a89_0x5a4f(_0x1f8a53,_0x545e64){_0x1f8a53=_0x1f8a53-0xdc;const _0x36758d=a89_0x3675();let _0x5a4f9e=_0x36758d[_0x1f8a53];return _0x5a4f9e;}const bcryptjs_1=__importDefault(require(a89_0x39bacc(0x10f))),crypto_1=__importDefault(require(a89_0x39bacc(0xdf))),database_1=__importDefault(require('../config/database'));class UserService{[a89_0x39bacc(0xe2)](){const _0x10beb3=a89_0x39bacc,_0x14e5b2=_0x10beb3(0xf4)+crypto_1[_0x10beb3(0x107)][_0x10beb3(0x111)](0x20)[_0x10beb3(0xdd)]('hex'),_0x5b034d='sk_'+crypto_1[_0x10beb3(0x107)][_0x10beb3(0x111)](0x20)[_0x10beb3(0xdd)](_0x10beb3(0x110));return{'publicKey':_0x14e5b2,'secretKey':_0x5b034d};}async[a89_0x39bacc(0x10e)](_0x187ab1){const _0x40b8e3=a89_0x39bacc,{fullName:_0x437991,username:_0x3605c3,password:_0x2e4364,telegramId:_0xbd5f72,merchantUrl:_0x2a95aa,gateways:_0x2fba87,gatewaySettings:_0x1be519,wallets:_0x4553fc}=_0x187ab1,_0x2a98df=await database_1[_0x40b8e3(0x107)][_0x40b8e3(0xf3)][_0x40b8e3(0x112)]({'where':{'username':_0x3605c3}});if(_0x2a98df)throw new Error(_0x40b8e3(0x116));if(_0xbd5f72){const _0x7850b4=await database_1['default'][_0x40b8e3(0xf3)]['findUnique']({'where':{'telegram':_0xbd5f72}});if(_0x7850b4)throw new Error(_0x40b8e3(0xf8));}const _0x4c2464=await bcryptjs_1[_0x40b8e3(0x107)]['hash'](_0x2e4364,0xc),{publicKey:_0x58094e,secretKey:_0x1b7b4d}=this['generateApiKeys'](),_0x473017=await database_1[_0x40b8e3(0x107)][_0x40b8e3(0xf3)][_0x40b8e3(0xe6)]({'data':{'name':_0x437991,'username':_0x3605c3,'password':_0x4c2464,'telegram':_0xbd5f72,'shopUrl':_0x2a95aa,'shopUrl2':_0x187ab1[_0x40b8e3(0xec)]||null,'shopUrl3':_0x187ab1[_0x40b8e3(0xdc)]||null,'shopUrl4':_0x187ab1['merchantUrl4']||null,'paymentGateways':_0x2fba87?JSON[_0x40b8e3(0xde)](_0x2fba87):null,'gatewaySettings':_0x1be519?JSON[_0x40b8e3(0xde)](_0x1be519):null,'usdtPolygonWallet':_0x4553fc?.[_0x40b8e3(0xf6)]||null,'usdtTrcWallet':_0x4553fc?.[_0x40b8e3(0xfd)]||null,'usdtErcWallet':_0x4553fc?.[_0x40b8e3(0x103)]||null,'usdcPolygonWallet':_0x4553fc?.[_0x40b8e3(0xf7)]||null,'publicKey':_0x58094e,'secretKey':_0x1b7b4d,'status':_0x40b8e3(0xfc)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'shopUrl2':!![],'shopUrl3':!![],'shopUrl4':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x473017['id'],'fullName':_0x473017[_0x40b8e3(0xe1)],'username':_0x473017['username'],'telegramId':_0x473017[_0x40b8e3(0x10d)],'merchantUrl':_0x473017[_0x40b8e3(0xef)],'merchantUrl2':_0x473017[_0x40b8e3(0xe3)],'merchantUrl3':_0x473017['shopUrl3'],'merchantUrl4':_0x473017[_0x40b8e3(0xff)],'gateways':_0x473017[_0x40b8e3(0x10a)]?JSON[_0x40b8e3(0x105)](_0x473017['paymentGateways']):null,'gatewaySettings':_0x473017[_0x40b8e3(0xf1)]?JSON[_0x40b8e3(0x105)](_0x473017[_0x40b8e3(0xf1)]):null,'publicKey':_0x473017[_0x40b8e3(0x109)],'wallets':{'usdtPolygonWallet':_0x473017['usdtPolygonWallet'],'usdtTrcWallet':_0x473017[_0x40b8e3(0xfd)],'usdtErcWallet':_0x473017[_0x40b8e3(0x103)],'usdcPolygonWallet':_0x473017[_0x40b8e3(0xf7)]},'status':_0x473017[_0x40b8e3(0xf9)],'createdAt':_0x473017[_0x40b8e3(0xee)]};}async[a89_0x39bacc(0x117)](){const _0x2ff720=a89_0x39bacc,_0x4d293e=await database_1[_0x2ff720(0x107)][_0x2ff720(0xf3)]['findMany']({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'shopUrl2':!![],'shopUrl3':!![],'shopUrl4':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x2ff720(0x104)}});return _0x4d293e[_0x2ff720(0xf0)](_0x58ec7d=>({'id':_0x58ec7d['id'],'fullName':_0x58ec7d[_0x2ff720(0xe1)],'username':_0x58ec7d['username'],'telegramId':_0x58ec7d[_0x2ff720(0x10d)],'merchantUrl':_0x58ec7d[_0x2ff720(0xef)],'merchantUrl2':_0x58ec7d[_0x2ff720(0xe3)],'merchantUrl3':_0x58ec7d[_0x2ff720(0xe9)],'merchantUrl4':_0x58ec7d[_0x2ff720(0xff)],'gateways':_0x58ec7d[_0x2ff720(0x10a)]?JSON['parse'](_0x58ec7d[_0x2ff720(0x10a)]):null,'gatewaySettings':_0x58ec7d['gatewaySettings']?JSON[_0x2ff720(0x105)](_0x58ec7d['gatewaySettings']):null,'publicKey':_0x58ec7d[_0x2ff720(0x109)],'wallets':{'usdtPolygonWallet':_0x58ec7d[_0x2ff720(0xf6)],'usdtTrcWallet':_0x58ec7d[_0x2ff720(0xfd)],'usdtErcWallet':_0x58ec7d['usdtErcWallet'],'usdcPolygonWallet':_0x58ec7d['usdcPolygonWallet']},'status':_0x58ec7d[_0x2ff720(0xf9)],'createdAt':_0x58ec7d['createdAt']}));}async[a89_0x39bacc(0x100)](_0x1fc808){const _0x116a76=a89_0x39bacc,_0x343dd6=await database_1[_0x116a76(0x107)][_0x116a76(0xf3)][_0x116a76(0x112)]({'where':{'id':_0x1fc808},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'shopUrl2':!![],'shopUrl3':!![],'shopUrl4':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x343dd6)return null;return{'id':_0x343dd6['id'],'fullName':_0x343dd6['name'],'username':_0x343dd6[_0x116a76(0x106)],'telegramId':_0x343dd6[_0x116a76(0x10d)],'merchantUrl':_0x343dd6[_0x116a76(0xef)],'merchantUrl2':_0x343dd6[_0x116a76(0xe3)],'merchantUrl3':_0x343dd6['shopUrl3'],'merchantUrl4':_0x343dd6[_0x116a76(0xff)],'gateways':_0x343dd6[_0x116a76(0x10a)]?JSON['parse'](_0x343dd6[_0x116a76(0x10a)]):null,'gatewaySettings':_0x343dd6[_0x116a76(0xf1)]?JSON['parse'](_0x343dd6[_0x116a76(0xf1)]):null,'publicKey':_0x343dd6[_0x116a76(0x109)],'wallets':{'usdtPolygonWallet':_0x343dd6[_0x116a76(0xf6)],'usdtTrcWallet':_0x343dd6[_0x116a76(0xfd)],'usdtErcWallet':_0x343dd6[_0x116a76(0x103)],'usdcPolygonWallet':_0x343dd6['usdcPolygonWallet']},'status':_0x343dd6[_0x116a76(0xf9)],'createdAt':_0x343dd6[_0x116a76(0xee)]};}async[a89_0x39bacc(0x101)](_0x4cd87c,_0x4458e8){const _0xe4085=a89_0x39bacc,_0x252c59={..._0x4458e8};_0x4458e8[_0xe4085(0xf5)]&&(_0x252c59[_0xe4085(0xf5)]=await bcryptjs_1[_0xe4085(0x107)][_0xe4085(0xeb)](_0x4458e8['password'],0xc));_0x4458e8['fullName']&&(_0x252c59[_0xe4085(0xe1)]=_0x4458e8['fullName'],delete _0x252c59[_0xe4085(0xfb)]);_0x4458e8[_0xe4085(0x115)]&&(_0x252c59[_0xe4085(0x10d)]=_0x4458e8[_0xe4085(0x115)],delete _0x252c59[_0xe4085(0x115)]);_0x4458e8[_0xe4085(0x10b)]&&(_0x252c59['shopUrl']=_0x4458e8[_0xe4085(0x10b)],delete _0x252c59[_0xe4085(0x10b)]);_0x4458e8[_0xe4085(0xec)]!==undefined&&(_0x252c59[_0xe4085(0xe3)]=_0x4458e8['merchantUrl2']||null,delete _0x252c59[_0xe4085(0xec)]);_0x4458e8[_0xe4085(0xdc)]!==undefined&&(_0x252c59[_0xe4085(0xe9)]=_0x4458e8[_0xe4085(0xdc)]||null,delete _0x252c59[_0xe4085(0xdc)]);_0x4458e8[_0xe4085(0xfe)]!==undefined&&(_0x252c59[_0xe4085(0xff)]=_0x4458e8['merchantUrl4']||null,delete _0x252c59[_0xe4085(0xfe)]);_0x4458e8[_0xe4085(0x114)]&&(_0x252c59[_0xe4085(0x10a)]=JSON[_0xe4085(0xde)](_0x4458e8[_0xe4085(0x114)]),delete _0x252c59[_0xe4085(0x114)]);_0x4458e8['gatewaySettings']&&(_0x252c59[_0xe4085(0xf1)]=JSON['stringify'](_0x4458e8[_0xe4085(0xf1)]),delete _0x252c59[_0xe4085(0xf1)]);_0x4458e8[_0xe4085(0xe5)]&&(_0x4458e8[_0xe4085(0xe5)][_0xe4085(0xf6)]!==undefined&&(_0x252c59[_0xe4085(0xf6)]=_0x4458e8[_0xe4085(0xe5)][_0xe4085(0xf6)]||null),_0x4458e8['wallets']['usdtTrcWallet']!==undefined&&(_0x252c59['usdtTrcWallet']=_0x4458e8[_0xe4085(0xe5)][_0xe4085(0xfd)]||null),_0x4458e8[_0xe4085(0xe5)][_0xe4085(0x103)]!==undefined&&(_0x252c59['usdtErcWallet']=_0x4458e8[_0xe4085(0xe5)][_0xe4085(0x103)]||null),_0x4458e8[_0xe4085(0xe5)]['usdcPolygonWallet']!==undefined&&(_0x252c59[_0xe4085(0xf7)]=_0x4458e8['wallets']['usdcPolygonWallet']||null),delete _0x252c59['wallets']);const _0x3d9850=await database_1['default'][_0xe4085(0xf3)]['update']({'where':{'id':_0x4cd87c},'data':_0x252c59,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'shopUrl2':!![],'shopUrl3':!![],'shopUrl4':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x3d9850['id'],'fullName':_0x3d9850[_0xe4085(0xe1)],'username':_0x3d9850[_0xe4085(0x106)],'telegramId':_0x3d9850[_0xe4085(0x10d)],'merchantUrl':_0x3d9850[_0xe4085(0xef)],'merchantUrl2':_0x3d9850[_0xe4085(0xe3)],'merchantUrl3':_0x3d9850['shopUrl3'],'merchantUrl4':_0x3d9850[_0xe4085(0xff)],'gateways':_0x3d9850['paymentGateways']?JSON[_0xe4085(0x105)](_0x3d9850[_0xe4085(0x10a)]):null,'gatewaySettings':_0x3d9850[_0xe4085(0xf1)]?JSON['parse'](_0x3d9850[_0xe4085(0xf1)]):null,'publicKey':_0x3d9850[_0xe4085(0x109)],'wallets':{'usdtPolygonWallet':_0x3d9850[_0xe4085(0xf6)],'usdtTrcWallet':_0x3d9850['usdtTrcWallet'],'usdtErcWallet':_0x3d9850[_0xe4085(0x103)],'usdcPolygonWallet':_0x3d9850[_0xe4085(0xf7)]},'status':_0x3d9850[_0xe4085(0xf9)],'createdAt':_0x3d9850[_0xe4085(0xee)]};}async['deleteUser'](_0x11c953){const _0xd51c71=a89_0x39bacc;await database_1[_0xd51c71(0x107)]['shop'][_0xd51c71(0xfa)]({'where':{'id':_0x11c953}});}}exports['UserService']=UserService;