'use strict';const a76_0x282335=a76_0x1b40;(function(_0x52dbc7,_0x1841db){const _0x100abb=a76_0x1b40,_0x457833=_0x52dbc7();while(!![]){try{const _0x1a95f7=-parseInt(_0x100abb(0x193))/0x1+-parseInt(_0x100abb(0x1b9))/0x2*(-parseInt(_0x100abb(0x19f))/0x3)+-parseInt(_0x100abb(0x18a))/0x4+-parseInt(_0x100abb(0x1ab))/0x5*(parseInt(_0x100abb(0x1ba))/0x6)+-parseInt(_0x100abb(0x18b))/0x7+-parseInt(_0x100abb(0x1b3))/0x8+parseInt(_0x100abb(0x196))/0x9;if(_0x1a95f7===_0x1841db)break;else _0x457833['push'](_0x457833['shift']());}catch(_0x387bc0){_0x457833['push'](_0x457833['shift']());}}}(a76_0x16f1,0x5f7d0));var __importDefault=this&&this['__importDefault']||function(_0x235661){const _0x5123d0=a76_0x1b40;return _0x235661&&_0x235661[_0x5123d0(0x1b0)]?_0x235661:{'default':_0x235661};};function a76_0x1b40(_0x35fe59,_0x750857){_0x35fe59=_0x35fe59-0x189;const _0x16f11e=a76_0x16f1();let _0x1b4069=_0x16f11e[_0x35fe59];return _0x1b4069;}Object['defineProperty'](exports,a76_0x282335(0x1b0),{'value':!![]}),exports[a76_0x282335(0x1aa)]=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),crypto_1=__importDefault(require(a76_0x282335(0x19a))),database_1=__importDefault(require(a76_0x282335(0x19e)));function a76_0x16f1(){const _0x1e4aab=['216618DXhPtJ','gatewaySettings','paymentGateways','delete','81024bqxZMQ','4041037Xcalgb','status','default','shop','telegram','name','toString','ACTIVE','607349qhnvev','wallets','publicKey','16393185xeeQNI','password','usdtErcWallet','findUnique','crypto','getAllUsers','usdtTrcWallet','map','../config/database','211263bFxkDT','getUserById','updateUser','generateApiKeys','merchantUrl','hex','sk_','Username\x20already\x20exists','parse','deleteUser','randomBytes','UserService','10XDDSyJ','fullName','telegramId','shopUrl','findMany','__esModule','hash','gateways','2916048iZwZJN','usdtPolygonWallet','stringify','createdAt','username','usdcPolygonWallet','6UMBsZO'];a76_0x16f1=function(){return _0x1e4aab;};return a76_0x16f1();}class UserService{['generateApiKeys'](){const _0x2f3fc2=a76_0x282335,_0xf99fc3='pk_'+crypto_1[_0x2f3fc2(0x18d)][_0x2f3fc2(0x1a9)](0x20)[_0x2f3fc2(0x191)](_0x2f3fc2(0x1a4)),_0xc440b5=_0x2f3fc2(0x1a5)+crypto_1[_0x2f3fc2(0x18d)][_0x2f3fc2(0x1a9)](0x20)[_0x2f3fc2(0x191)](_0x2f3fc2(0x1a4));return{'publicKey':_0xf99fc3,'secretKey':_0xc440b5};}async['createUser'](_0x52e41c){const _0x5d852b=a76_0x282335,{fullName:_0x1b7912,username:_0x2daa00,password:_0x43fbbb,telegramId:_0x4c3b70,merchantUrl:_0x288092,gateways:_0x2e1650,gatewaySettings:_0x90d4e2,wallets:_0x1ad7a1}=_0x52e41c,_0x4c9123=await database_1[_0x5d852b(0x18d)][_0x5d852b(0x18e)]['findUnique']({'where':{'username':_0x2daa00}});if(_0x4c9123)throw new Error(_0x5d852b(0x1a6));if(_0x4c3b70){const _0x34d074=await database_1[_0x5d852b(0x18d)][_0x5d852b(0x18e)][_0x5d852b(0x199)]({'where':{'telegram':_0x4c3b70}});if(_0x34d074)throw new Error('Telegram\x20username\x20already\x20exists');}const _0x528650=await bcryptjs_1[_0x5d852b(0x18d)]['hash'](_0x43fbbb,0xc),{publicKey:_0x18e5f0,secretKey:_0x53daac}=this[_0x5d852b(0x1a2)](),_0x287a30=await database_1['default'][_0x5d852b(0x18e)]['create']({'data':{'name':_0x1b7912,'username':_0x2daa00,'password':_0x528650,'telegram':_0x4c3b70,'shopUrl':_0x288092,'paymentGateways':_0x2e1650?JSON[_0x5d852b(0x1b5)](_0x2e1650):null,'gatewaySettings':_0x90d4e2?JSON[_0x5d852b(0x1b5)](_0x90d4e2):null,'usdtPolygonWallet':_0x1ad7a1?.[_0x5d852b(0x1b4)]||null,'usdtTrcWallet':_0x1ad7a1?.[_0x5d852b(0x19c)]||null,'usdtErcWallet':_0x1ad7a1?.[_0x5d852b(0x198)]||null,'usdcPolygonWallet':_0x1ad7a1?.['usdcPolygonWallet']||null,'publicKey':_0x18e5f0,'secretKey':_0x53daac,'status':_0x5d852b(0x192)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x287a30['id'],'fullName':_0x287a30[_0x5d852b(0x190)],'username':_0x287a30['username'],'telegramId':_0x287a30[_0x5d852b(0x18f)],'merchantUrl':_0x287a30[_0x5d852b(0x1ae)],'gateways':_0x287a30[_0x5d852b(0x1bc)]?JSON['parse'](_0x287a30[_0x5d852b(0x1bc)]):null,'gatewaySettings':_0x287a30[_0x5d852b(0x1bb)]?JSON['parse'](_0x287a30['gatewaySettings']):null,'publicKey':_0x287a30['publicKey'],'wallets':{'usdtPolygonWallet':_0x287a30['usdtPolygonWallet'],'usdtTrcWallet':_0x287a30[_0x5d852b(0x19c)],'usdtErcWallet':_0x287a30['usdtErcWallet'],'usdcPolygonWallet':_0x287a30[_0x5d852b(0x1b8)]},'status':_0x287a30[_0x5d852b(0x18c)],'createdAt':_0x287a30['createdAt']};}async[a76_0x282335(0x19b)](){const _0x36021d=a76_0x282335,_0x2627d1=await database_1[_0x36021d(0x18d)][_0x36021d(0x18e)][_0x36021d(0x1af)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':'desc'}});return _0x2627d1[_0x36021d(0x19d)](_0xa04b15=>({'id':_0xa04b15['id'],'fullName':_0xa04b15[_0x36021d(0x190)],'username':_0xa04b15[_0x36021d(0x1b7)],'telegramId':_0xa04b15[_0x36021d(0x18f)],'merchantUrl':_0xa04b15[_0x36021d(0x1ae)],'gateways':_0xa04b15[_0x36021d(0x1bc)]?JSON[_0x36021d(0x1a7)](_0xa04b15[_0x36021d(0x1bc)]):null,'gatewaySettings':_0xa04b15['gatewaySettings']?JSON['parse'](_0xa04b15[_0x36021d(0x1bb)]):null,'publicKey':_0xa04b15[_0x36021d(0x195)],'wallets':{'usdtPolygonWallet':_0xa04b15['usdtPolygonWallet'],'usdtTrcWallet':_0xa04b15[_0x36021d(0x19c)],'usdtErcWallet':_0xa04b15[_0x36021d(0x198)],'usdcPolygonWallet':_0xa04b15[_0x36021d(0x1b8)]},'status':_0xa04b15[_0x36021d(0x18c)],'createdAt':_0xa04b15[_0x36021d(0x1b6)]}));}async[a76_0x282335(0x1a0)](_0x42cddb){const _0x5ae0b9=a76_0x282335,_0x43abc2=await database_1[_0x5ae0b9(0x18d)][_0x5ae0b9(0x18e)][_0x5ae0b9(0x199)]({'where':{'id':_0x42cddb},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x43abc2)return null;return{'id':_0x43abc2['id'],'fullName':_0x43abc2[_0x5ae0b9(0x190)],'username':_0x43abc2[_0x5ae0b9(0x1b7)],'telegramId':_0x43abc2[_0x5ae0b9(0x18f)],'merchantUrl':_0x43abc2[_0x5ae0b9(0x1ae)],'gateways':_0x43abc2['paymentGateways']?JSON['parse'](_0x43abc2[_0x5ae0b9(0x1bc)]):null,'gatewaySettings':_0x43abc2[_0x5ae0b9(0x1bb)]?JSON[_0x5ae0b9(0x1a7)](_0x43abc2[_0x5ae0b9(0x1bb)]):null,'publicKey':_0x43abc2[_0x5ae0b9(0x195)],'wallets':{'usdtPolygonWallet':_0x43abc2['usdtPolygonWallet'],'usdtTrcWallet':_0x43abc2[_0x5ae0b9(0x19c)],'usdtErcWallet':_0x43abc2[_0x5ae0b9(0x198)],'usdcPolygonWallet':_0x43abc2[_0x5ae0b9(0x1b8)]},'status':_0x43abc2[_0x5ae0b9(0x18c)],'createdAt':_0x43abc2[_0x5ae0b9(0x1b6)]};}async[a76_0x282335(0x1a1)](_0x18b59a,_0x11915a){const _0x5e737f=a76_0x282335,_0xf2134f={..._0x11915a};_0x11915a[_0x5e737f(0x197)]&&(_0xf2134f[_0x5e737f(0x197)]=await bcryptjs_1[_0x5e737f(0x18d)][_0x5e737f(0x1b1)](_0x11915a[_0x5e737f(0x197)],0xc));_0x11915a[_0x5e737f(0x1ac)]&&(_0xf2134f[_0x5e737f(0x190)]=_0x11915a[_0x5e737f(0x1ac)],delete _0xf2134f[_0x5e737f(0x1ac)]);_0x11915a[_0x5e737f(0x1ad)]&&(_0xf2134f[_0x5e737f(0x18f)]=_0x11915a[_0x5e737f(0x1ad)],delete _0xf2134f[_0x5e737f(0x1ad)]);_0x11915a[_0x5e737f(0x1a3)]&&(_0xf2134f[_0x5e737f(0x1ae)]=_0x11915a[_0x5e737f(0x1a3)],delete _0xf2134f[_0x5e737f(0x1a3)]);_0x11915a[_0x5e737f(0x1b2)]&&(_0xf2134f[_0x5e737f(0x1bc)]=JSON[_0x5e737f(0x1b5)](_0x11915a[_0x5e737f(0x1b2)]),delete _0xf2134f[_0x5e737f(0x1b2)]);_0x11915a['gatewaySettings']&&(_0xf2134f[_0x5e737f(0x1bb)]=JSON['stringify'](_0x11915a[_0x5e737f(0x1bb)]),delete _0xf2134f[_0x5e737f(0x1bb)]);_0x11915a[_0x5e737f(0x194)]&&(_0x11915a[_0x5e737f(0x194)][_0x5e737f(0x1b4)]!==undefined&&(_0xf2134f[_0x5e737f(0x1b4)]=_0x11915a[_0x5e737f(0x194)][_0x5e737f(0x1b4)]||null),_0x11915a[_0x5e737f(0x194)]['usdtTrcWallet']!==undefined&&(_0xf2134f[_0x5e737f(0x19c)]=_0x11915a[_0x5e737f(0x194)][_0x5e737f(0x19c)]||null),_0x11915a[_0x5e737f(0x194)][_0x5e737f(0x198)]!==undefined&&(_0xf2134f[_0x5e737f(0x198)]=_0x11915a[_0x5e737f(0x194)]['usdtErcWallet']||null),_0x11915a['wallets'][_0x5e737f(0x1b8)]!==undefined&&(_0xf2134f[_0x5e737f(0x1b8)]=_0x11915a[_0x5e737f(0x194)][_0x5e737f(0x1b8)]||null),delete _0xf2134f[_0x5e737f(0x194)]);const _0x3c42b5=await database_1[_0x5e737f(0x18d)][_0x5e737f(0x18e)]['update']({'where':{'id':_0x18b59a},'data':_0xf2134f,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x3c42b5['id'],'fullName':_0x3c42b5['name'],'username':_0x3c42b5['username'],'telegramId':_0x3c42b5[_0x5e737f(0x18f)],'merchantUrl':_0x3c42b5[_0x5e737f(0x1ae)],'gateways':_0x3c42b5[_0x5e737f(0x1bc)]?JSON[_0x5e737f(0x1a7)](_0x3c42b5['paymentGateways']):null,'gatewaySettings':_0x3c42b5[_0x5e737f(0x1bb)]?JSON[_0x5e737f(0x1a7)](_0x3c42b5[_0x5e737f(0x1bb)]):null,'publicKey':_0x3c42b5[_0x5e737f(0x195)],'wallets':{'usdtPolygonWallet':_0x3c42b5[_0x5e737f(0x1b4)],'usdtTrcWallet':_0x3c42b5[_0x5e737f(0x19c)],'usdtErcWallet':_0x3c42b5[_0x5e737f(0x198)],'usdcPolygonWallet':_0x3c42b5[_0x5e737f(0x1b8)]},'status':_0x3c42b5[_0x5e737f(0x18c)],'createdAt':_0x3c42b5[_0x5e737f(0x1b6)]};}async[a76_0x282335(0x1a8)](_0x3e9fa6){const _0x17e0b6=a76_0x282335;await database_1[_0x17e0b6(0x18d)][_0x17e0b6(0x18e)][_0x17e0b6(0x189)]({'where':{'id':_0x3e9fa6}});}}exports['UserService']=UserService;