'use strict';const a57_0x3a1f72=a57_0x5bc8;(function(_0x47c3a8,_0x1a0b18){const _0x1223c1=a57_0x5bc8,_0x22316b=_0x47c3a8();while(!![]){try{const _0x3d756a=parseInt(_0x1223c1(0x93))/0x1+-parseInt(_0x1223c1(0x9c))/0x2*(parseInt(_0x1223c1(0x94))/0x3)+-parseInt(_0x1223c1(0x99))/0x4+-parseInt(_0x1223c1(0x9e))/0x5+-parseInt(_0x1223c1(0x79))/0x6+parseInt(_0x1223c1(0x78))/0x7*(-parseInt(_0x1223c1(0xa2))/0x8)+parseInt(_0x1223c1(0x95))/0x9*(parseInt(_0x1223c1(0x9d))/0xa);if(_0x3d756a===_0x1a0b18)break;else _0x22316b['push'](_0x22316b['shift']());}catch(_0x4c0f6f){_0x22316b['push'](_0x22316b['shift']());}}}(a57_0x5d03,0x5b2e3));var __importDefault=this&&this[a57_0x3a1f72(0xa1)]||function(_0x1e1ca0){const _0x236268=a57_0x3a1f72;return _0x1e1ca0&&_0x1e1ca0[_0x236268(0x8c)]?_0x1e1ca0:{'default':_0x1e1ca0};};Object[a57_0x3a1f72(0x85)](exports,a57_0x3a1f72(0x8c),{'value':!![]}),exports[a57_0x3a1f72(0x82)]=void 0x0;const bcryptjs_1=__importDefault(require(a57_0x3a1f72(0x76))),crypto_1=__importDefault(require(a57_0x3a1f72(0xa4))),database_1=__importDefault(require(a57_0x3a1f72(0x77)));function a57_0x5d03(){const _0x750710=['shopUrl','map','usdcPolygonWallet','UserService','usdtErcWallet','gateways','defineProperty','gatewaySettings','updateUser','username','delete','merchantUrl','createdAt','__esModule','usdtTrcWallet','name','telegramId','getUserById','paymentGateways','deleteUser','730952sRaFul','141moIbqv','11358513OGKXhF','desc','Username\x20already\x20exists','wallets','1801284JTwris','toString','generateApiKeys','18514oCbvwf','10dCLxlx','902225brnJKI','status','telegram','__importDefault','312MFMuZX','parse','crypto','fullName','createUser','password','randomBytes','findMany','getAllUsers','update','publicKey','hex','bcryptjs','../config/database','78946tlFjsj','683082KiHyDm','hash','stringify','default','usdtPolygonWallet','shop'];a57_0x5d03=function(){return _0x750710;};return a57_0x5d03();}class UserService{['generateApiKeys'](){const _0x4c7c6e=a57_0x3a1f72,_0x3c41c5='pk_'+crypto_1[_0x4c7c6e(0x7c)][_0x4c7c6e(0x70)](0x20)[_0x4c7c6e(0x9a)](_0x4c7c6e(0x75)),_0x3dc7c8='sk_'+crypto_1[_0x4c7c6e(0x7c)][_0x4c7c6e(0x70)](0x20)[_0x4c7c6e(0x9a)](_0x4c7c6e(0x75));return{'publicKey':_0x3c41c5,'secretKey':_0x3dc7c8};}async[a57_0x3a1f72(0xa6)](_0x21f78e){const _0x52a4eb=a57_0x3a1f72,{fullName:_0x3af4bd,username:_0x15c8a5,password:_0xbe5d7e,telegramId:_0x146441,merchantUrl:_0x1b39eb,gateways:_0x1ec435,gatewaySettings:_0x436429,wallets:_0x3236fb}=_0x21f78e,_0x47ae53=await database_1[_0x52a4eb(0x7c)][_0x52a4eb(0x7e)]['findUnique']({'where':{'username':_0x15c8a5}});if(_0x47ae53)throw new Error(_0x52a4eb(0x97));if(_0x146441){const _0x4ffbe3=await database_1[_0x52a4eb(0x7c)][_0x52a4eb(0x7e)]['findUnique']({'where':{'telegram':_0x146441}});if(_0x4ffbe3)throw new Error('Telegram\x20username\x20already\x20exists');}const _0x5701ad=await bcryptjs_1[_0x52a4eb(0x7c)][_0x52a4eb(0x7a)](_0xbe5d7e,0xc),{publicKey:_0x2ff123,secretKey:_0x3784ff}=this[_0x52a4eb(0x9b)](),_0x5b0df0=await database_1[_0x52a4eb(0x7c)][_0x52a4eb(0x7e)]['create']({'data':{'name':_0x3af4bd,'username':_0x15c8a5,'password':_0x5701ad,'telegram':_0x146441,'shopUrl':_0x1b39eb,'paymentGateways':_0x1ec435?JSON['stringify'](_0x1ec435):null,'gatewaySettings':_0x436429?JSON[_0x52a4eb(0x7b)](_0x436429):null,'usdtPolygonWallet':_0x3236fb?.[_0x52a4eb(0x7d)]||null,'usdtTrcWallet':_0x3236fb?.['usdtTrcWallet']||null,'usdtErcWallet':_0x3236fb?.[_0x52a4eb(0x83)]||null,'usdcPolygonWallet':_0x3236fb?.[_0x52a4eb(0x81)]||null,'publicKey':_0x2ff123,'secretKey':_0x3784ff,'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x5b0df0['id'],'fullName':_0x5b0df0[_0x52a4eb(0x8e)],'username':_0x5b0df0[_0x52a4eb(0x88)],'telegramId':_0x5b0df0['telegram'],'merchantUrl':_0x5b0df0[_0x52a4eb(0x7f)],'gateways':_0x5b0df0[_0x52a4eb(0x91)]?JSON[_0x52a4eb(0xa3)](_0x5b0df0[_0x52a4eb(0x91)]):null,'gatewaySettings':_0x5b0df0[_0x52a4eb(0x86)]?JSON[_0x52a4eb(0xa3)](_0x5b0df0[_0x52a4eb(0x86)]):null,'publicKey':_0x5b0df0[_0x52a4eb(0x74)],'wallets':{'usdtPolygonWallet':_0x5b0df0['usdtPolygonWallet'],'usdtTrcWallet':_0x5b0df0['usdtTrcWallet'],'usdtErcWallet':_0x5b0df0['usdtErcWallet'],'usdcPolygonWallet':_0x5b0df0[_0x52a4eb(0x81)]},'status':_0x5b0df0[_0x52a4eb(0x9f)],'createdAt':_0x5b0df0[_0x52a4eb(0x8b)]};}async[a57_0x3a1f72(0x72)](){const _0x55e4d5=a57_0x3a1f72,_0x33fca4=await database_1[_0x55e4d5(0x7c)][_0x55e4d5(0x7e)][_0x55e4d5(0x71)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x55e4d5(0x96)}});return _0x33fca4[_0x55e4d5(0x80)](_0x193532=>({'id':_0x193532['id'],'fullName':_0x193532['name'],'username':_0x193532['username'],'telegramId':_0x193532['telegram'],'merchantUrl':_0x193532[_0x55e4d5(0x7f)],'gateways':_0x193532[_0x55e4d5(0x91)]?JSON[_0x55e4d5(0xa3)](_0x193532[_0x55e4d5(0x91)]):null,'gatewaySettings':_0x193532['gatewaySettings']?JSON[_0x55e4d5(0xa3)](_0x193532[_0x55e4d5(0x86)]):null,'publicKey':_0x193532[_0x55e4d5(0x74)],'wallets':{'usdtPolygonWallet':_0x193532[_0x55e4d5(0x7d)],'usdtTrcWallet':_0x193532[_0x55e4d5(0x8d)],'usdtErcWallet':_0x193532[_0x55e4d5(0x83)],'usdcPolygonWallet':_0x193532[_0x55e4d5(0x81)]},'status':_0x193532[_0x55e4d5(0x9f)],'createdAt':_0x193532[_0x55e4d5(0x8b)]}));}async[a57_0x3a1f72(0x90)](_0x5e959b){const _0x1422cb=a57_0x3a1f72,_0x5875b7=await database_1['default']['shop']['findUnique']({'where':{'id':_0x5e959b},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x5875b7)return null;return{'id':_0x5875b7['id'],'fullName':_0x5875b7[_0x1422cb(0x8e)],'username':_0x5875b7[_0x1422cb(0x88)],'telegramId':_0x5875b7[_0x1422cb(0xa0)],'merchantUrl':_0x5875b7[_0x1422cb(0x7f)],'gateways':_0x5875b7[_0x1422cb(0x91)]?JSON['parse'](_0x5875b7[_0x1422cb(0x91)]):null,'gatewaySettings':_0x5875b7[_0x1422cb(0x86)]?JSON['parse'](_0x5875b7[_0x1422cb(0x86)]):null,'publicKey':_0x5875b7[_0x1422cb(0x74)],'wallets':{'usdtPolygonWallet':_0x5875b7[_0x1422cb(0x7d)],'usdtTrcWallet':_0x5875b7['usdtTrcWallet'],'usdtErcWallet':_0x5875b7['usdtErcWallet'],'usdcPolygonWallet':_0x5875b7[_0x1422cb(0x81)]},'status':_0x5875b7[_0x1422cb(0x9f)],'createdAt':_0x5875b7['createdAt']};}async[a57_0x3a1f72(0x87)](_0x287f07,_0x60ee12){const _0x2eec45=a57_0x3a1f72,_0x33b088={..._0x60ee12};_0x60ee12[_0x2eec45(0xa7)]&&(_0x33b088[_0x2eec45(0xa7)]=await bcryptjs_1[_0x2eec45(0x7c)][_0x2eec45(0x7a)](_0x60ee12['password'],0xc));_0x60ee12[_0x2eec45(0xa5)]&&(_0x33b088['name']=_0x60ee12[_0x2eec45(0xa5)],delete _0x33b088[_0x2eec45(0xa5)]);_0x60ee12[_0x2eec45(0x8f)]&&(_0x33b088[_0x2eec45(0xa0)]=_0x60ee12[_0x2eec45(0x8f)],delete _0x33b088[_0x2eec45(0x8f)]);_0x60ee12[_0x2eec45(0x8a)]&&(_0x33b088['shopUrl']=_0x60ee12[_0x2eec45(0x8a)],delete _0x33b088[_0x2eec45(0x8a)]);_0x60ee12[_0x2eec45(0x84)]&&(_0x33b088[_0x2eec45(0x91)]=JSON['stringify'](_0x60ee12[_0x2eec45(0x84)]),delete _0x33b088[_0x2eec45(0x84)]);_0x60ee12[_0x2eec45(0x86)]&&(_0x33b088[_0x2eec45(0x86)]=JSON[_0x2eec45(0x7b)](_0x60ee12[_0x2eec45(0x86)]),delete _0x33b088[_0x2eec45(0x86)]);_0x60ee12['wallets']&&(_0x60ee12[_0x2eec45(0x98)][_0x2eec45(0x7d)]!==undefined&&(_0x33b088[_0x2eec45(0x7d)]=_0x60ee12[_0x2eec45(0x98)][_0x2eec45(0x7d)]||null),_0x60ee12['wallets']['usdtTrcWallet']!==undefined&&(_0x33b088[_0x2eec45(0x8d)]=_0x60ee12[_0x2eec45(0x98)][_0x2eec45(0x8d)]||null),_0x60ee12[_0x2eec45(0x98)][_0x2eec45(0x83)]!==undefined&&(_0x33b088[_0x2eec45(0x83)]=_0x60ee12['wallets'][_0x2eec45(0x83)]||null),_0x60ee12[_0x2eec45(0x98)]['usdcPolygonWallet']!==undefined&&(_0x33b088[_0x2eec45(0x81)]=_0x60ee12[_0x2eec45(0x98)][_0x2eec45(0x81)]||null),delete _0x33b088[_0x2eec45(0x98)]);const _0x36fa6f=await database_1[_0x2eec45(0x7c)][_0x2eec45(0x7e)][_0x2eec45(0x73)]({'where':{'id':_0x287f07},'data':_0x33b088,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x36fa6f['id'],'fullName':_0x36fa6f[_0x2eec45(0x8e)],'username':_0x36fa6f[_0x2eec45(0x88)],'telegramId':_0x36fa6f[_0x2eec45(0xa0)],'merchantUrl':_0x36fa6f[_0x2eec45(0x7f)],'gateways':_0x36fa6f['paymentGateways']?JSON[_0x2eec45(0xa3)](_0x36fa6f[_0x2eec45(0x91)]):null,'gatewaySettings':_0x36fa6f[_0x2eec45(0x86)]?JSON[_0x2eec45(0xa3)](_0x36fa6f[_0x2eec45(0x86)]):null,'publicKey':_0x36fa6f[_0x2eec45(0x74)],'wallets':{'usdtPolygonWallet':_0x36fa6f[_0x2eec45(0x7d)],'usdtTrcWallet':_0x36fa6f[_0x2eec45(0x8d)],'usdtErcWallet':_0x36fa6f['usdtErcWallet'],'usdcPolygonWallet':_0x36fa6f[_0x2eec45(0x81)]},'status':_0x36fa6f[_0x2eec45(0x9f)],'createdAt':_0x36fa6f['createdAt']};}async[a57_0x3a1f72(0x92)](_0x3854ba){const _0x33d493=a57_0x3a1f72;await database_1[_0x33d493(0x7c)][_0x33d493(0x7e)][_0x33d493(0x89)]({'where':{'id':_0x3854ba}});}}function a57_0x5bc8(_0x39f741,_0xa9deae){const _0x5d0322=a57_0x5d03();return a57_0x5bc8=function(_0x5bc818,_0x6067ac){_0x5bc818=_0x5bc818-0x70;let _0x44a4d1=_0x5d0322[_0x5bc818];return _0x44a4d1;},a57_0x5bc8(_0x39f741,_0xa9deae);}exports['UserService']=UserService;