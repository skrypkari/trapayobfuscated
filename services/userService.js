'use strict';const a57_0x481036=a57_0x12f3;(function(_0x22e760,_0x9c69fc){const _0x20d89e=a57_0x12f3,_0x3887db=_0x22e760();while(!![]){try{const _0x29b5a3=parseInt(_0x20d89e(0x16f))/0x1+parseInt(_0x20d89e(0x13d))/0x2+parseInt(_0x20d89e(0x154))/0x3*(-parseInt(_0x20d89e(0x142))/0x4)+parseInt(_0x20d89e(0x167))/0x5+parseInt(_0x20d89e(0x16c))/0x6*(-parseInt(_0x20d89e(0x144))/0x7)+-parseInt(_0x20d89e(0x164))/0x8*(parseInt(_0x20d89e(0x13c))/0x9)+parseInt(_0x20d89e(0x16b))/0xa;if(_0x29b5a3===_0x9c69fc)break;else _0x3887db['push'](_0x3887db['shift']());}catch(_0x4240eb){_0x3887db['push'](_0x3887db['shift']());}}}(a57_0x5166,0xe492e));var __importDefault=this&&this[a57_0x481036(0x16a)]||function(_0x53e680){return _0x53e680&&_0x53e680['__esModule']?_0x53e680:{'default':_0x53e680};};function a57_0x5166(){const _0x35a8e6=['sk_','wallets','getUserById','create','198UouedH','1629356IsoDsT','desc','gatewaySettings','usdcPolygonWallet','merchantUrl','2347356VfMZnf','defineProperty','12146491etPzIo','crypto','telegram','Telegram\x20username\x20already\x20exists','usdtErcWallet','shopUrl','stringify','shop','map','createdAt','hex','delete','randomBytes','fullName','bcryptjs','createUser','9YyCnhq','toString','telegramId','../config/database','findUnique','status','parse','usdtTrcWallet','name','default','usdtPolygonWallet','updateUser','username','UserService','__esModule','pk_','154424FLGAVp','paymentGateways','findMany','4198065BBiBiD','gateways','publicKey','__importDefault','31379170KOskgW','6Yndtls','generateApiKeys','password','64426KtsEnU'];a57_0x5166=function(){return _0x35a8e6;};return a57_0x5166();}Object[a57_0x481036(0x143)](exports,a57_0x481036(0x162),{'value':!![]}),exports[a57_0x481036(0x161)]=void 0x0;const bcryptjs_1=__importDefault(require(a57_0x481036(0x152))),crypto_1=__importDefault(require(a57_0x481036(0x145))),database_1=__importDefault(require(a57_0x481036(0x157)));function a57_0x12f3(_0x4f4ec5,_0x277723){const _0x516642=a57_0x5166();return a57_0x12f3=function(_0x12f3bb,_0x2ccd83){_0x12f3bb=_0x12f3bb-0x13a;let _0x5d7538=_0x516642[_0x12f3bb];return _0x5d7538;},a57_0x12f3(_0x4f4ec5,_0x277723);}class UserService{[a57_0x481036(0x16d)](){const _0x7dc26a=a57_0x481036,_0x25c309=_0x7dc26a(0x163)+crypto_1[_0x7dc26a(0x15d)][_0x7dc26a(0x150)](0x20)[_0x7dc26a(0x155)](_0x7dc26a(0x14e)),_0x220954=_0x7dc26a(0x170)+crypto_1[_0x7dc26a(0x15d)]['randomBytes'](0x20)['toString'](_0x7dc26a(0x14e));return{'publicKey':_0x25c309,'secretKey':_0x220954};}async[a57_0x481036(0x153)](_0xf3bb4b){const _0x125a28=a57_0x481036,{fullName:_0x366cf3,username:_0x3203fc,password:_0x8aa2ea,telegramId:_0x5a2ce9,merchantUrl:_0x2e78a7,gateways:_0x2e330e,gatewaySettings:_0x4764a9,wallets:_0x159ce2}=_0xf3bb4b,_0x20d496=await database_1[_0x125a28(0x15d)][_0x125a28(0x14b)][_0x125a28(0x158)]({'where':{'username':_0x3203fc}});if(_0x20d496)throw new Error('Username\x20already\x20exists');if(_0x5a2ce9){const _0x663c18=await database_1[_0x125a28(0x15d)]['shop'][_0x125a28(0x158)]({'where':{'telegram':_0x5a2ce9}});if(_0x663c18)throw new Error(_0x125a28(0x147));}const _0x43fbe7=await bcryptjs_1['default']['hash'](_0x8aa2ea,0xc),{publicKey:_0x425e64,secretKey:_0x18069e}=this[_0x125a28(0x16d)](),_0x1411ed=await database_1[_0x125a28(0x15d)][_0x125a28(0x14b)][_0x125a28(0x13b)]({'data':{'name':_0x366cf3,'username':_0x3203fc,'password':_0x43fbe7,'telegram':_0x5a2ce9,'shopUrl':_0x2e78a7,'paymentGateways':_0x2e330e?JSON[_0x125a28(0x14a)](_0x2e330e):null,'gatewaySettings':_0x4764a9?JSON['stringify'](_0x4764a9):null,'usdtPolygonWallet':_0x159ce2?.[_0x125a28(0x15e)]||null,'usdtTrcWallet':_0x159ce2?.['usdtTrcWallet']||null,'usdtErcWallet':_0x159ce2?.[_0x125a28(0x148)]||null,'usdcPolygonWallet':_0x159ce2?.[_0x125a28(0x140)]||null,'publicKey':_0x425e64,'secretKey':_0x18069e,'status':'ACTIVE'},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x1411ed['id'],'fullName':_0x1411ed['name'],'username':_0x1411ed['username'],'telegramId':_0x1411ed[_0x125a28(0x146)],'merchantUrl':_0x1411ed[_0x125a28(0x149)],'gateways':_0x1411ed['paymentGateways']?JSON[_0x125a28(0x15a)](_0x1411ed['paymentGateways']):null,'gatewaySettings':_0x1411ed[_0x125a28(0x13f)]?JSON[_0x125a28(0x15a)](_0x1411ed['gatewaySettings']):null,'publicKey':_0x1411ed[_0x125a28(0x169)],'wallets':{'usdtPolygonWallet':_0x1411ed[_0x125a28(0x15e)],'usdtTrcWallet':_0x1411ed[_0x125a28(0x15b)],'usdtErcWallet':_0x1411ed['usdtErcWallet'],'usdcPolygonWallet':_0x1411ed[_0x125a28(0x140)]},'status':_0x1411ed['status'],'createdAt':_0x1411ed[_0x125a28(0x14d)]};}async['getAllUsers'](){const _0x53dd85=a57_0x481036,_0x1d81dc=await database_1[_0x53dd85(0x15d)]['shop'][_0x53dd85(0x166)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x53dd85(0x13e)}});return _0x1d81dc[_0x53dd85(0x14c)](_0x3f17c6=>({'id':_0x3f17c6['id'],'fullName':_0x3f17c6[_0x53dd85(0x15c)],'username':_0x3f17c6['username'],'telegramId':_0x3f17c6[_0x53dd85(0x146)],'merchantUrl':_0x3f17c6[_0x53dd85(0x149)],'gateways':_0x3f17c6[_0x53dd85(0x165)]?JSON[_0x53dd85(0x15a)](_0x3f17c6[_0x53dd85(0x165)]):null,'gatewaySettings':_0x3f17c6['gatewaySettings']?JSON[_0x53dd85(0x15a)](_0x3f17c6[_0x53dd85(0x13f)]):null,'publicKey':_0x3f17c6['publicKey'],'wallets':{'usdtPolygonWallet':_0x3f17c6['usdtPolygonWallet'],'usdtTrcWallet':_0x3f17c6[_0x53dd85(0x15b)],'usdtErcWallet':_0x3f17c6[_0x53dd85(0x148)],'usdcPolygonWallet':_0x3f17c6[_0x53dd85(0x140)]},'status':_0x3f17c6['status'],'createdAt':_0x3f17c6[_0x53dd85(0x14d)]}));}async[a57_0x481036(0x13a)](_0x259bc7){const _0x37b514=a57_0x481036,_0x58959d=await database_1[_0x37b514(0x15d)][_0x37b514(0x14b)][_0x37b514(0x158)]({'where':{'id':_0x259bc7},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x58959d)return null;return{'id':_0x58959d['id'],'fullName':_0x58959d[_0x37b514(0x15c)],'username':_0x58959d['username'],'telegramId':_0x58959d[_0x37b514(0x146)],'merchantUrl':_0x58959d[_0x37b514(0x149)],'gateways':_0x58959d[_0x37b514(0x165)]?JSON[_0x37b514(0x15a)](_0x58959d[_0x37b514(0x165)]):null,'gatewaySettings':_0x58959d[_0x37b514(0x13f)]?JSON['parse'](_0x58959d[_0x37b514(0x13f)]):null,'publicKey':_0x58959d[_0x37b514(0x169)],'wallets':{'usdtPolygonWallet':_0x58959d[_0x37b514(0x15e)],'usdtTrcWallet':_0x58959d['usdtTrcWallet'],'usdtErcWallet':_0x58959d['usdtErcWallet'],'usdcPolygonWallet':_0x58959d[_0x37b514(0x140)]},'status':_0x58959d[_0x37b514(0x159)],'createdAt':_0x58959d[_0x37b514(0x14d)]};}async[a57_0x481036(0x15f)](_0xffe93a,_0x1b77f9){const _0x24e08b=a57_0x481036,_0x198ded={..._0x1b77f9};_0x1b77f9[_0x24e08b(0x16e)]&&(_0x198ded['password']=await bcryptjs_1[_0x24e08b(0x15d)]['hash'](_0x1b77f9[_0x24e08b(0x16e)],0xc));_0x1b77f9[_0x24e08b(0x151)]&&(_0x198ded[_0x24e08b(0x15c)]=_0x1b77f9[_0x24e08b(0x151)],delete _0x198ded['fullName']);_0x1b77f9[_0x24e08b(0x156)]&&(_0x198ded['telegram']=_0x1b77f9[_0x24e08b(0x156)],delete _0x198ded[_0x24e08b(0x156)]);_0x1b77f9['merchantUrl']&&(_0x198ded[_0x24e08b(0x149)]=_0x1b77f9[_0x24e08b(0x141)],delete _0x198ded[_0x24e08b(0x141)]);_0x1b77f9[_0x24e08b(0x168)]&&(_0x198ded[_0x24e08b(0x165)]=JSON[_0x24e08b(0x14a)](_0x1b77f9['gateways']),delete _0x198ded[_0x24e08b(0x168)]);_0x1b77f9['gatewaySettings']&&(_0x198ded[_0x24e08b(0x13f)]=JSON[_0x24e08b(0x14a)](_0x1b77f9[_0x24e08b(0x13f)]),delete _0x198ded[_0x24e08b(0x13f)]);_0x1b77f9[_0x24e08b(0x171)]&&(_0x1b77f9[_0x24e08b(0x171)][_0x24e08b(0x15e)]!==undefined&&(_0x198ded[_0x24e08b(0x15e)]=_0x1b77f9['wallets'][_0x24e08b(0x15e)]||null),_0x1b77f9[_0x24e08b(0x171)]['usdtTrcWallet']!==undefined&&(_0x198ded[_0x24e08b(0x15b)]=_0x1b77f9['wallets']['usdtTrcWallet']||null),_0x1b77f9['wallets'][_0x24e08b(0x148)]!==undefined&&(_0x198ded[_0x24e08b(0x148)]=_0x1b77f9['wallets'][_0x24e08b(0x148)]||null),_0x1b77f9[_0x24e08b(0x171)][_0x24e08b(0x140)]!==undefined&&(_0x198ded[_0x24e08b(0x140)]=_0x1b77f9[_0x24e08b(0x171)][_0x24e08b(0x140)]||null),delete _0x198ded[_0x24e08b(0x171)]);const _0x280f45=await database_1[_0x24e08b(0x15d)][_0x24e08b(0x14b)]['update']({'where':{'id':_0xffe93a},'data':_0x198ded,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x280f45['id'],'fullName':_0x280f45[_0x24e08b(0x15c)],'username':_0x280f45[_0x24e08b(0x160)],'telegramId':_0x280f45['telegram'],'merchantUrl':_0x280f45[_0x24e08b(0x149)],'gateways':_0x280f45[_0x24e08b(0x165)]?JSON[_0x24e08b(0x15a)](_0x280f45['paymentGateways']):null,'gatewaySettings':_0x280f45[_0x24e08b(0x13f)]?JSON[_0x24e08b(0x15a)](_0x280f45[_0x24e08b(0x13f)]):null,'publicKey':_0x280f45[_0x24e08b(0x169)],'wallets':{'usdtPolygonWallet':_0x280f45[_0x24e08b(0x15e)],'usdtTrcWallet':_0x280f45['usdtTrcWallet'],'usdtErcWallet':_0x280f45[_0x24e08b(0x148)],'usdcPolygonWallet':_0x280f45[_0x24e08b(0x140)]},'status':_0x280f45[_0x24e08b(0x159)],'createdAt':_0x280f45[_0x24e08b(0x14d)]};}async['deleteUser'](_0x36c989){const _0x3512da=a57_0x481036;await database_1[_0x3512da(0x15d)][_0x3512da(0x14b)][_0x3512da(0x14f)]({'where':{'id':_0x36c989}});}}exports[a57_0x481036(0x161)]=UserService;