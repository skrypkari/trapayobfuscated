'use strict';function a59_0x284e(){const _0x29816e=['shop','stringify','telegramId','gatewaySettings','usdtPolygonWallet','6682684lopFNN','1161IyCdNA','default','create','UserService','findUnique','shopUrl','usdtTrcWallet','generateApiKeys','name','bcryptjs','hash','2562yuyodA','__esModule','telegram','wallets','Username\x20already\x20exists','parse','defineProperty','createUser','3418261TUwXBN','map','merchantUrl','paymentGateways','fullName','gateways','33541335pvTOjs','getAllUsers','ACTIVE','delete','usdtErcWallet','hex','password','sk_','randomBytes','pk_','7078460kaIFNX','publicKey','deleteUser','username','status','desc','usdcPolygonWallet','crypto','1962843jjEIHO','11028150kYnoVv','16YmotRL','toString','createdAt'];a59_0x284e=function(){return _0x29816e;};return a59_0x284e();}const a59_0x4ac0c6=a59_0x4e49;(function(_0x2196be,_0xdce5cc){const _0x4b2c0c=a59_0x4e49,_0x908d3=_0x2196be();while(!![]){try{const _0x2bd7a3=parseInt(_0x4b2c0c(0x1fb))/0x1*(parseInt(_0x4b2c0c(0x1d0))/0x2)+parseInt(_0x4b2c0c(0x1f0))/0x3+-parseInt(_0x4b2c0c(0x1fa))/0x4+parseInt(_0x4b2c0c(0x1e8))/0x5+parseInt(_0x4b2c0c(0x1f1))/0x6+parseInt(_0x4b2c0c(0x1d8))/0x7*(parseInt(_0x4b2c0c(0x1f2))/0x8)+-parseInt(_0x4b2c0c(0x1de))/0x9;if(_0x2bd7a3===_0xdce5cc)break;else _0x908d3['push'](_0x908d3['shift']());}catch(_0x187a34){_0x908d3['push'](_0x908d3['shift']());}}}(a59_0x284e,0xede3f));var __importDefault=this&&this['__importDefault']||function(_0x45b925){const _0x2c6240=a59_0x4e49;return _0x45b925&&_0x45b925[_0x2c6240(0x1d1)]?_0x45b925:{'default':_0x45b925};};Object[a59_0x4ac0c6(0x1d6)](exports,a59_0x4ac0c6(0x1d1),{'value':!![]}),exports[a59_0x4ac0c6(0x1c8)]=void 0x0;const bcryptjs_1=__importDefault(require(a59_0x4ac0c6(0x1ce))),crypto_1=__importDefault(require(a59_0x4ac0c6(0x1ef))),database_1=__importDefault(require('../config/database'));class UserService{['generateApiKeys'](){const _0x5dcbd4=a59_0x4ac0c6,_0x528367=_0x5dcbd4(0x1e7)+crypto_1['default'][_0x5dcbd4(0x1e6)](0x20)[_0x5dcbd4(0x1f3)](_0x5dcbd4(0x1e3)),_0x5347a8=_0x5dcbd4(0x1e5)+crypto_1['default'][_0x5dcbd4(0x1e6)](0x20)[_0x5dcbd4(0x1f3)](_0x5dcbd4(0x1e3));return{'publicKey':_0x528367,'secretKey':_0x5347a8};}async[a59_0x4ac0c6(0x1d7)](_0x350b1d){const _0x3be408=a59_0x4ac0c6,{fullName:_0x346713,username:_0x3f1b0a,password:_0x354efe,telegramId:_0x495cd5,merchantUrl:_0x598d6,gateways:_0x4720d7,gatewaySettings:_0x1327f6,wallets:_0x4a2448}=_0x350b1d,_0x15e71c=await database_1[_0x3be408(0x1fc)]['shop'][_0x3be408(0x1c9)]({'where':{'username':_0x3f1b0a}});if(_0x15e71c)throw new Error(_0x3be408(0x1d4));if(_0x495cd5){const _0x5a05e2=await database_1['default'][_0x3be408(0x1f5)][_0x3be408(0x1c9)]({'where':{'telegram':_0x495cd5}});if(_0x5a05e2)throw new Error('Telegram\x20username\x20already\x20exists');}const _0x19b30d=await bcryptjs_1['default'][_0x3be408(0x1cf)](_0x354efe,0xc),{publicKey:_0x46b96b,secretKey:_0x31b2e4}=this[_0x3be408(0x1cc)](),_0x4921fe=await database_1['default'][_0x3be408(0x1f5)][_0x3be408(0x1fd)]({'data':{'name':_0x346713,'username':_0x3f1b0a,'password':_0x19b30d,'telegram':_0x495cd5,'shopUrl':_0x598d6,'paymentGateways':_0x4720d7?JSON['stringify'](_0x4720d7):null,'gatewaySettings':_0x1327f6?JSON[_0x3be408(0x1f6)](_0x1327f6):null,'usdtPolygonWallet':_0x4a2448?.[_0x3be408(0x1f9)]||null,'usdtTrcWallet':_0x4a2448?.[_0x3be408(0x1cb)]||null,'usdtErcWallet':_0x4a2448?.[_0x3be408(0x1e2)]||null,'usdcPolygonWallet':_0x4a2448?.[_0x3be408(0x1ee)]||null,'publicKey':_0x46b96b,'secretKey':_0x31b2e4,'status':_0x3be408(0x1e0)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x4921fe['id'],'fullName':_0x4921fe[_0x3be408(0x1cd)],'username':_0x4921fe[_0x3be408(0x1eb)],'telegramId':_0x4921fe[_0x3be408(0x1d2)],'merchantUrl':_0x4921fe[_0x3be408(0x1ca)],'gateways':_0x4921fe[_0x3be408(0x1db)]?JSON['parse'](_0x4921fe[_0x3be408(0x1db)]):null,'gatewaySettings':_0x4921fe[_0x3be408(0x1f8)]?JSON[_0x3be408(0x1d5)](_0x4921fe['gatewaySettings']):null,'publicKey':_0x4921fe[_0x3be408(0x1e9)],'wallets':{'usdtPolygonWallet':_0x4921fe[_0x3be408(0x1f9)],'usdtTrcWallet':_0x4921fe[_0x3be408(0x1cb)],'usdtErcWallet':_0x4921fe[_0x3be408(0x1e2)],'usdcPolygonWallet':_0x4921fe['usdcPolygonWallet']},'status':_0x4921fe[_0x3be408(0x1ec)],'createdAt':_0x4921fe[_0x3be408(0x1f4)]};}async[a59_0x4ac0c6(0x1df)](){const _0x1bb453=a59_0x4ac0c6,_0x5d6a3a=await database_1[_0x1bb453(0x1fc)]['shop']['findMany']({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x1bb453(0x1ed)}});return _0x5d6a3a[_0x1bb453(0x1d9)](_0x1d140a=>({'id':_0x1d140a['id'],'fullName':_0x1d140a[_0x1bb453(0x1cd)],'username':_0x1d140a['username'],'telegramId':_0x1d140a['telegram'],'merchantUrl':_0x1d140a[_0x1bb453(0x1ca)],'gateways':_0x1d140a[_0x1bb453(0x1db)]?JSON['parse'](_0x1d140a['paymentGateways']):null,'gatewaySettings':_0x1d140a[_0x1bb453(0x1f8)]?JSON[_0x1bb453(0x1d5)](_0x1d140a[_0x1bb453(0x1f8)]):null,'publicKey':_0x1d140a[_0x1bb453(0x1e9)],'wallets':{'usdtPolygonWallet':_0x1d140a['usdtPolygonWallet'],'usdtTrcWallet':_0x1d140a[_0x1bb453(0x1cb)],'usdtErcWallet':_0x1d140a[_0x1bb453(0x1e2)],'usdcPolygonWallet':_0x1d140a[_0x1bb453(0x1ee)]},'status':_0x1d140a['status'],'createdAt':_0x1d140a[_0x1bb453(0x1f4)]}));}async['getUserById'](_0x7de59b){const _0xda17e9=a59_0x4ac0c6,_0x10200f=await database_1['default'][_0xda17e9(0x1f5)][_0xda17e9(0x1c9)]({'where':{'id':_0x7de59b},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x10200f)return null;return{'id':_0x10200f['id'],'fullName':_0x10200f[_0xda17e9(0x1cd)],'username':_0x10200f[_0xda17e9(0x1eb)],'telegramId':_0x10200f['telegram'],'merchantUrl':_0x10200f[_0xda17e9(0x1ca)],'gateways':_0x10200f[_0xda17e9(0x1db)]?JSON[_0xda17e9(0x1d5)](_0x10200f[_0xda17e9(0x1db)]):null,'gatewaySettings':_0x10200f[_0xda17e9(0x1f8)]?JSON[_0xda17e9(0x1d5)](_0x10200f[_0xda17e9(0x1f8)]):null,'publicKey':_0x10200f[_0xda17e9(0x1e9)],'wallets':{'usdtPolygonWallet':_0x10200f[_0xda17e9(0x1f9)],'usdtTrcWallet':_0x10200f['usdtTrcWallet'],'usdtErcWallet':_0x10200f[_0xda17e9(0x1e2)],'usdcPolygonWallet':_0x10200f[_0xda17e9(0x1ee)]},'status':_0x10200f[_0xda17e9(0x1ec)],'createdAt':_0x10200f['createdAt']};}async['updateUser'](_0xa026b8,_0x56b93b){const _0x2a6592=a59_0x4ac0c6,_0x51bcc6={..._0x56b93b};_0x56b93b[_0x2a6592(0x1e4)]&&(_0x51bcc6[_0x2a6592(0x1e4)]=await bcryptjs_1['default'][_0x2a6592(0x1cf)](_0x56b93b[_0x2a6592(0x1e4)],0xc));_0x56b93b[_0x2a6592(0x1dc)]&&(_0x51bcc6['name']=_0x56b93b[_0x2a6592(0x1dc)],delete _0x51bcc6[_0x2a6592(0x1dc)]);_0x56b93b[_0x2a6592(0x1f7)]&&(_0x51bcc6[_0x2a6592(0x1d2)]=_0x56b93b[_0x2a6592(0x1f7)],delete _0x51bcc6[_0x2a6592(0x1f7)]);_0x56b93b[_0x2a6592(0x1da)]&&(_0x51bcc6[_0x2a6592(0x1ca)]=_0x56b93b[_0x2a6592(0x1da)],delete _0x51bcc6[_0x2a6592(0x1da)]);_0x56b93b[_0x2a6592(0x1dd)]&&(_0x51bcc6['paymentGateways']=JSON[_0x2a6592(0x1f6)](_0x56b93b[_0x2a6592(0x1dd)]),delete _0x51bcc6[_0x2a6592(0x1dd)]);_0x56b93b['gatewaySettings']&&(_0x51bcc6[_0x2a6592(0x1f8)]=JSON[_0x2a6592(0x1f6)](_0x56b93b[_0x2a6592(0x1f8)]),delete _0x51bcc6[_0x2a6592(0x1f8)]);_0x56b93b['wallets']&&(_0x56b93b[_0x2a6592(0x1d3)][_0x2a6592(0x1f9)]!==undefined&&(_0x51bcc6[_0x2a6592(0x1f9)]=_0x56b93b[_0x2a6592(0x1d3)][_0x2a6592(0x1f9)]||null),_0x56b93b['wallets'][_0x2a6592(0x1cb)]!==undefined&&(_0x51bcc6['usdtTrcWallet']=_0x56b93b['wallets'][_0x2a6592(0x1cb)]||null),_0x56b93b[_0x2a6592(0x1d3)][_0x2a6592(0x1e2)]!==undefined&&(_0x51bcc6[_0x2a6592(0x1e2)]=_0x56b93b[_0x2a6592(0x1d3)][_0x2a6592(0x1e2)]||null),_0x56b93b[_0x2a6592(0x1d3)][_0x2a6592(0x1ee)]!==undefined&&(_0x51bcc6[_0x2a6592(0x1ee)]=_0x56b93b['wallets']['usdcPolygonWallet']||null),delete _0x51bcc6[_0x2a6592(0x1d3)]);const _0x550a56=await database_1[_0x2a6592(0x1fc)][_0x2a6592(0x1f5)]['update']({'where':{'id':_0xa026b8},'data':_0x51bcc6,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x550a56['id'],'fullName':_0x550a56[_0x2a6592(0x1cd)],'username':_0x550a56[_0x2a6592(0x1eb)],'telegramId':_0x550a56[_0x2a6592(0x1d2)],'merchantUrl':_0x550a56['shopUrl'],'gateways':_0x550a56[_0x2a6592(0x1db)]?JSON[_0x2a6592(0x1d5)](_0x550a56[_0x2a6592(0x1db)]):null,'gatewaySettings':_0x550a56['gatewaySettings']?JSON[_0x2a6592(0x1d5)](_0x550a56['gatewaySettings']):null,'publicKey':_0x550a56[_0x2a6592(0x1e9)],'wallets':{'usdtPolygonWallet':_0x550a56[_0x2a6592(0x1f9)],'usdtTrcWallet':_0x550a56[_0x2a6592(0x1cb)],'usdtErcWallet':_0x550a56[_0x2a6592(0x1e2)],'usdcPolygonWallet':_0x550a56[_0x2a6592(0x1ee)]},'status':_0x550a56[_0x2a6592(0x1ec)],'createdAt':_0x550a56[_0x2a6592(0x1f4)]};}async[a59_0x4ac0c6(0x1ea)](_0x276313){const _0xd4736a=a59_0x4ac0c6;await database_1[_0xd4736a(0x1fc)][_0xd4736a(0x1f5)][_0xd4736a(0x1e1)]({'where':{'id':_0x276313}});}}function a59_0x4e49(_0x2b7749,_0x4ba1ad){const _0x284e4c=a59_0x284e();return a59_0x4e49=function(_0x4e49b2,_0x5acd56){_0x4e49b2=_0x4e49b2-0x1c8;let _0x1ce7cc=_0x284e4c[_0x4e49b2];return _0x1ce7cc;},a59_0x4e49(_0x2b7749,_0x4ba1ad);}exports[a59_0x4ac0c6(0x1c8)]=UserService;