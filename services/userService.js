'use strict';const a61_0x318bfa=a61_0x29e0;(function(_0x1808b8,_0x4c94d7){const _0x4fda0e=a61_0x29e0,_0x53233a=_0x1808b8();while(!![]){try{const _0xda83e3=parseInt(_0x4fda0e(0x203))/0x1*(parseInt(_0x4fda0e(0x1f0))/0x2)+parseInt(_0x4fda0e(0x1fc))/0x3+-parseInt(_0x4fda0e(0x208))/0x4*(parseInt(_0x4fda0e(0x222))/0x5)+-parseInt(_0x4fda0e(0x205))/0x6*(-parseInt(_0x4fda0e(0x20d))/0x7)+parseInt(_0x4fda0e(0x21e))/0x8*(parseInt(_0x4fda0e(0x215))/0x9)+-parseInt(_0x4fda0e(0x21a))/0xa*(-parseInt(_0x4fda0e(0x20e))/0xb)+parseInt(_0x4fda0e(0x212))/0xc*(-parseInt(_0x4fda0e(0x221))/0xd);if(_0xda83e3===_0x4c94d7)break;else _0x53233a['push'](_0x53233a['shift']());}catch(_0x5763e8){_0x53233a['push'](_0x53233a['shift']());}}}(a61_0x5e19,0xadcea));var __importDefault=this&&this[a61_0x318bfa(0x217)]||function(_0x838b58){const _0x1075d7=a61_0x318bfa;return _0x838b58&&_0x838b58[_0x1075d7(0x202)]?_0x838b58:{'default':_0x838b58};};Object[a61_0x318bfa(0x1f2)](exports,a61_0x318bfa(0x202),{'value':!![]}),exports[a61_0x318bfa(0x1f9)]=void 0x0;function a61_0x29e0(_0x59eecb,_0xedc523){const _0x5e1961=a61_0x5e19();return a61_0x29e0=function(_0x29e01d,_0x9ca334){_0x29e01d=_0x29e01d-0x1eb;let _0x2fa464=_0x5e1961[_0x29e01d];return _0x2fa464;},a61_0x29e0(_0x59eecb,_0xedc523);}const bcryptjs_1=__importDefault(require(a61_0x318bfa(0x1f7))),crypto_1=__importDefault(require(a61_0x318bfa(0x220))),database_1=__importDefault(require(a61_0x318bfa(0x206)));class UserService{[a61_0x318bfa(0x20f)](){const _0x5a2bc9=a61_0x318bfa,_0x4c2dae=_0x5a2bc9(0x216)+crypto_1['default'][_0x5a2bc9(0x210)](0x20)['toString'](_0x5a2bc9(0x1f8)),_0x2ef681='sk_'+crypto_1['default'][_0x5a2bc9(0x210)](0x20)[_0x5a2bc9(0x1ed)]('hex');return{'publicKey':_0x4c2dae,'secretKey':_0x2ef681};}async[a61_0x318bfa(0x219)](_0x32ba8f){const _0xcca3b6=a61_0x318bfa,{fullName:_0x58a67d,username:_0x3f65db,password:_0x5a0364,telegramId:_0x46da30,merchantUrl:_0x5707c0,gateways:_0x1a6f71,gatewaySettings:_0x55db4c,wallets:_0x575eed}=_0x32ba8f,_0x11d710=await database_1[_0xcca3b6(0x213)][_0xcca3b6(0x21c)]['findUnique']({'where':{'username':_0x3f65db}});if(_0x11d710)throw new Error(_0xcca3b6(0x218));if(_0x46da30){const _0x2cd52c=await database_1[_0xcca3b6(0x213)]['shop'][_0xcca3b6(0x1f6)]({'where':{'telegram':_0x46da30}});if(_0x2cd52c)throw new Error(_0xcca3b6(0x209));}const _0x272da0=await bcryptjs_1[_0xcca3b6(0x213)]['hash'](_0x5a0364,0xc),{publicKey:_0x46196c,secretKey:_0x459635}=this['generateApiKeys'](),_0x23a971=await database_1[_0xcca3b6(0x213)][_0xcca3b6(0x21c)][_0xcca3b6(0x20c)]({'data':{'name':_0x58a67d,'username':_0x3f65db,'password':_0x272da0,'telegram':_0x46da30,'shopUrl':_0x5707c0,'paymentGateways':_0x1a6f71?JSON[_0xcca3b6(0x21f)](_0x1a6f71):null,'gatewaySettings':_0x55db4c?JSON[_0xcca3b6(0x21f)](_0x55db4c):null,'usdtPolygonWallet':_0x575eed?.['usdtPolygonWallet']||null,'usdtTrcWallet':_0x575eed?.[_0xcca3b6(0x226)]||null,'usdtErcWallet':_0x575eed?.[_0xcca3b6(0x211)]||null,'usdcPolygonWallet':_0x575eed?.[_0xcca3b6(0x1f4)]||null,'publicKey':_0x46196c,'secretKey':_0x459635,'status':_0xcca3b6(0x20b)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x23a971['id'],'fullName':_0x23a971[_0xcca3b6(0x1ec)],'username':_0x23a971['username'],'telegramId':_0x23a971['telegram'],'merchantUrl':_0x23a971[_0xcca3b6(0x224)],'gateways':_0x23a971[_0xcca3b6(0x1f3)]?JSON[_0xcca3b6(0x20a)](_0x23a971[_0xcca3b6(0x1f3)]):null,'gatewaySettings':_0x23a971[_0xcca3b6(0x1ef)]?JSON[_0xcca3b6(0x20a)](_0x23a971[_0xcca3b6(0x1ef)]):null,'publicKey':_0x23a971[_0xcca3b6(0x1f5)],'wallets':{'usdtPolygonWallet':_0x23a971[_0xcca3b6(0x1ee)],'usdtTrcWallet':_0x23a971[_0xcca3b6(0x226)],'usdtErcWallet':_0x23a971[_0xcca3b6(0x211)],'usdcPolygonWallet':_0x23a971[_0xcca3b6(0x1f4)]},'status':_0x23a971['status'],'createdAt':_0x23a971[_0xcca3b6(0x1fa)]};}async[a61_0x318bfa(0x200)](){const _0x3ec60c=a61_0x318bfa,_0x41aa11=await database_1['default'][_0x3ec60c(0x21c)]['findMany']({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x3ec60c(0x204)}});return _0x41aa11[_0x3ec60c(0x201)](_0x32b3f6=>({'id':_0x32b3f6['id'],'fullName':_0x32b3f6[_0x3ec60c(0x1ec)],'username':_0x32b3f6[_0x3ec60c(0x1fe)],'telegramId':_0x32b3f6['telegram'],'merchantUrl':_0x32b3f6[_0x3ec60c(0x224)],'gateways':_0x32b3f6[_0x3ec60c(0x1f3)]?JSON[_0x3ec60c(0x20a)](_0x32b3f6[_0x3ec60c(0x1f3)]):null,'gatewaySettings':_0x32b3f6['gatewaySettings']?JSON[_0x3ec60c(0x20a)](_0x32b3f6[_0x3ec60c(0x1ef)]):null,'publicKey':_0x32b3f6[_0x3ec60c(0x1f5)],'wallets':{'usdtPolygonWallet':_0x32b3f6[_0x3ec60c(0x1ee)],'usdtTrcWallet':_0x32b3f6[_0x3ec60c(0x226)],'usdtErcWallet':_0x32b3f6['usdtErcWallet'],'usdcPolygonWallet':_0x32b3f6[_0x3ec60c(0x1f4)]},'status':_0x32b3f6[_0x3ec60c(0x207)],'createdAt':_0x32b3f6[_0x3ec60c(0x1fa)]}));}async[a61_0x318bfa(0x21b)](_0x441b4a){const _0x20a7b9=a61_0x318bfa,_0x6c35e8=await database_1[_0x20a7b9(0x213)]['shop'][_0x20a7b9(0x1f6)]({'where':{'id':_0x441b4a},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x6c35e8)return null;return{'id':_0x6c35e8['id'],'fullName':_0x6c35e8['name'],'username':_0x6c35e8[_0x20a7b9(0x1fe)],'telegramId':_0x6c35e8['telegram'],'merchantUrl':_0x6c35e8['shopUrl'],'gateways':_0x6c35e8[_0x20a7b9(0x1f3)]?JSON[_0x20a7b9(0x20a)](_0x6c35e8[_0x20a7b9(0x1f3)]):null,'gatewaySettings':_0x6c35e8[_0x20a7b9(0x1ef)]?JSON[_0x20a7b9(0x20a)](_0x6c35e8[_0x20a7b9(0x1ef)]):null,'publicKey':_0x6c35e8[_0x20a7b9(0x1f5)],'wallets':{'usdtPolygonWallet':_0x6c35e8[_0x20a7b9(0x1ee)],'usdtTrcWallet':_0x6c35e8[_0x20a7b9(0x226)],'usdtErcWallet':_0x6c35e8[_0x20a7b9(0x211)],'usdcPolygonWallet':_0x6c35e8[_0x20a7b9(0x1f4)]},'status':_0x6c35e8[_0x20a7b9(0x207)],'createdAt':_0x6c35e8['createdAt']};}async['updateUser'](_0x2abb1a,_0x2ef0c1){const _0x283f57=a61_0x318bfa,_0x912d2a={..._0x2ef0c1};_0x2ef0c1[_0x283f57(0x223)]&&(_0x912d2a[_0x283f57(0x223)]=await bcryptjs_1[_0x283f57(0x213)][_0x283f57(0x1ff)](_0x2ef0c1[_0x283f57(0x223)],0xc));_0x2ef0c1[_0x283f57(0x227)]&&(_0x912d2a[_0x283f57(0x1ec)]=_0x2ef0c1[_0x283f57(0x227)],delete _0x912d2a['fullName']);_0x2ef0c1[_0x283f57(0x1f1)]&&(_0x912d2a[_0x283f57(0x1fb)]=_0x2ef0c1[_0x283f57(0x1f1)],delete _0x912d2a[_0x283f57(0x1f1)]);_0x2ef0c1[_0x283f57(0x21d)]&&(_0x912d2a['shopUrl']=_0x2ef0c1[_0x283f57(0x21d)],delete _0x912d2a[_0x283f57(0x21d)]);_0x2ef0c1[_0x283f57(0x1eb)]&&(_0x912d2a['paymentGateways']=JSON[_0x283f57(0x21f)](_0x2ef0c1[_0x283f57(0x1eb)]),delete _0x912d2a[_0x283f57(0x1eb)]);_0x2ef0c1[_0x283f57(0x1ef)]&&(_0x912d2a[_0x283f57(0x1ef)]=JSON['stringify'](_0x2ef0c1[_0x283f57(0x1ef)]),delete _0x912d2a['gatewaySettings']);_0x2ef0c1[_0x283f57(0x214)]&&(_0x2ef0c1[_0x283f57(0x214)]['usdtPolygonWallet']!==undefined&&(_0x912d2a['usdtPolygonWallet']=_0x2ef0c1[_0x283f57(0x214)][_0x283f57(0x1ee)]||null),_0x2ef0c1[_0x283f57(0x214)]['usdtTrcWallet']!==undefined&&(_0x912d2a[_0x283f57(0x226)]=_0x2ef0c1[_0x283f57(0x214)]['usdtTrcWallet']||null),_0x2ef0c1[_0x283f57(0x214)][_0x283f57(0x211)]!==undefined&&(_0x912d2a[_0x283f57(0x211)]=_0x2ef0c1['wallets'][_0x283f57(0x211)]||null),_0x2ef0c1[_0x283f57(0x214)][_0x283f57(0x1f4)]!==undefined&&(_0x912d2a[_0x283f57(0x1f4)]=_0x2ef0c1['wallets'][_0x283f57(0x1f4)]||null),delete _0x912d2a[_0x283f57(0x214)]);const _0x34f2a4=await database_1[_0x283f57(0x213)][_0x283f57(0x21c)]['update']({'where':{'id':_0x2abb1a},'data':_0x912d2a,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x34f2a4['id'],'fullName':_0x34f2a4['name'],'username':_0x34f2a4[_0x283f57(0x1fe)],'telegramId':_0x34f2a4[_0x283f57(0x1fb)],'merchantUrl':_0x34f2a4['shopUrl'],'gateways':_0x34f2a4[_0x283f57(0x1f3)]?JSON['parse'](_0x34f2a4[_0x283f57(0x1f3)]):null,'gatewaySettings':_0x34f2a4[_0x283f57(0x1ef)]?JSON[_0x283f57(0x20a)](_0x34f2a4[_0x283f57(0x1ef)]):null,'publicKey':_0x34f2a4[_0x283f57(0x1f5)],'wallets':{'usdtPolygonWallet':_0x34f2a4[_0x283f57(0x1ee)],'usdtTrcWallet':_0x34f2a4[_0x283f57(0x226)],'usdtErcWallet':_0x34f2a4[_0x283f57(0x211)],'usdcPolygonWallet':_0x34f2a4[_0x283f57(0x1f4)]},'status':_0x34f2a4[_0x283f57(0x207)],'createdAt':_0x34f2a4[_0x283f57(0x1fa)]};}async[a61_0x318bfa(0x1fd)](_0x10c76d){const _0x51c4b5=a61_0x318bfa;await database_1['default'][_0x51c4b5(0x21c)][_0x51c4b5(0x225)]({'where':{'id':_0x10c76d}});}}function a61_0x5e19(){const _0xbd47c2=['password','shopUrl','delete','usdtTrcWallet','fullName','gateways','name','toString','usdtPolygonWallet','gatewaySettings','377654vkUEoK','telegramId','defineProperty','paymentGateways','usdcPolygonWallet','publicKey','findUnique','bcryptjs','hex','UserService','createdAt','telegram','619542mMPrrT','deleteUser','username','hash','getAllUsers','map','__esModule','1SSPaoS','desc','59358URrqMP','../config/database','status','4TpFgoG','Telegram\x20username\x20already\x20exists','parse','ACTIVE','create','623kyvBkl','11IadNFX','generateApiKeys','randomBytes','usdtErcWallet','14089848UfZKyE','default','wallets','3128976Cbzdmq','pk_','__importDefault','Username\x20already\x20exists','createUser','12647940HtaKkg','getUserById','shop','merchantUrl','8RvOZJy','stringify','crypto','13jpWiJT','5011040lqIyhF'];a61_0x5e19=function(){return _0xbd47c2;};return a61_0x5e19();}exports['UserService']=UserService;