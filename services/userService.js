'use strict';const a55_0x3ace30=a55_0x1284;(function(_0x2667e8,_0x1720c9){const _0x1f38a2=a55_0x1284,_0x51c0a9=_0x2667e8();while(!![]){try{const _0x4fab87=parseInt(_0x1f38a2(0xa4))/0x1+parseInt(_0x1f38a2(0xc9))/0x2+-parseInt(_0x1f38a2(0xa5))/0x3*(parseInt(_0x1f38a2(0xb1))/0x4)+-parseInt(_0x1f38a2(0xb9))/0x5+-parseInt(_0x1f38a2(0xb8))/0x6+parseInt(_0x1f38a2(0xb4))/0x7*(parseInt(_0x1f38a2(0xd9))/0x8)+-parseInt(_0x1f38a2(0xae))/0x9*(-parseInt(_0x1f38a2(0xb2))/0xa);if(_0x4fab87===_0x1720c9)break;else _0x51c0a9['push'](_0x51c0a9['shift']());}catch(_0x4ad421){_0x51c0a9['push'](_0x51c0a9['shift']());}}}(a55_0x3c72,0xd8974));function a55_0x3c72(){const _0x431aef=['Username\x20already\x20exists','UserService','deleteUser','wallets','shopUrl','findMany','919504qbCCcR','hex','name','password','update','merchantUrl','delete','../config/database','usdtErcWallet','usdtTrcWallet','bcryptjs','usdcPolygonWallet','fullName','Telegram\x20username\x20already\x20exists','createUser','usdtPolygonWallet','1835888SvOBXB','default','shop','246950NwiTdd','3OUPtSt','gatewaySettings','publicKey','status','getAllUsers','__esModule','pk_','gateways','stringify','13779UVPqGr','ACTIVE','defineProperty','4006856mojxDB','15870bTpazE','sk_','7hcdcfa','paymentGateways','findUnique','crypto','7004538VnkCwR','1547960saspRP','username','generateApiKeys','telegramId','map','randomBytes','createdAt','telegram','parse','hash'];a55_0x3c72=function(){return _0x431aef;};return a55_0x3c72();}var __importDefault=this&&this['__importDefault']||function(_0x2e82c0){const _0x18a447=a55_0x1284;return _0x2e82c0&&_0x2e82c0[_0x18a447(0xaa)]?_0x2e82c0:{'default':_0x2e82c0};};Object[a55_0x3ace30(0xb0)](exports,a55_0x3ace30(0xaa),{'value':!![]}),exports[a55_0x3ace30(0xc4)]=void 0x0;function a55_0x1284(_0x2dabf8,_0x2f8f33){const _0x3c72ae=a55_0x3c72();return a55_0x1284=function(_0x1284ac,_0x3b37c8){_0x1284ac=_0x1284ac-0xa3;let _0x4c16fd=_0x3c72ae[_0x1284ac];return _0x4c16fd;},a55_0x1284(_0x2dabf8,_0x2f8f33);}const bcryptjs_1=__importDefault(require(a55_0x3ace30(0xd3))),crypto_1=__importDefault(require(a55_0x3ace30(0xb7))),database_1=__importDefault(require(a55_0x3ace30(0xd0)));class UserService{[a55_0x3ace30(0xbb)](){const _0x51fd0=a55_0x3ace30,_0xe4cee8=_0x51fd0(0xab)+crypto_1[_0x51fd0(0xda)][_0x51fd0(0xbe)](0x20)['toString'](_0x51fd0(0xca)),_0x1e5d33=_0x51fd0(0xb3)+crypto_1[_0x51fd0(0xda)]['randomBytes'](0x20)['toString'](_0x51fd0(0xca));return{'publicKey':_0xe4cee8,'secretKey':_0x1e5d33};}async[a55_0x3ace30(0xd7)](_0x4da7b6){const _0x2c2ec0=a55_0x3ace30,{fullName:_0x125874,username:_0x458606,password:_0x4a844c,telegramId:_0x4ba739,merchantUrl:_0x270201,gateways:_0x4abb03,gatewaySettings:_0x45143e,wallets:_0x17d576}=_0x4da7b6,_0x12fba=await database_1[_0x2c2ec0(0xda)]['shop'][_0x2c2ec0(0xb6)]({'where':{'username':_0x458606}});if(_0x12fba)throw new Error(_0x2c2ec0(0xc3));if(_0x4ba739){const _0x2145b4=await database_1[_0x2c2ec0(0xda)][_0x2c2ec0(0xa3)][_0x2c2ec0(0xb6)]({'where':{'telegram':_0x4ba739}});if(_0x2145b4)throw new Error(_0x2c2ec0(0xd6));}const _0x1ee4bc=await bcryptjs_1[_0x2c2ec0(0xda)][_0x2c2ec0(0xc2)](_0x4a844c,0xc),{publicKey:_0x17cfbb,secretKey:_0x56befa}=this[_0x2c2ec0(0xbb)](),_0x17ba5f=await database_1['default'][_0x2c2ec0(0xa3)]['create']({'data':{'name':_0x125874,'username':_0x458606,'password':_0x1ee4bc,'telegram':_0x4ba739,'shopUrl':_0x270201,'paymentGateways':_0x4abb03?JSON[_0x2c2ec0(0xad)](_0x4abb03):null,'gatewaySettings':_0x45143e?JSON['stringify'](_0x45143e):null,'usdtPolygonWallet':_0x17d576?.[_0x2c2ec0(0xd8)]||null,'usdtTrcWallet':_0x17d576?.[_0x2c2ec0(0xd2)]||null,'usdtErcWallet':_0x17d576?.[_0x2c2ec0(0xd1)]||null,'usdcPolygonWallet':_0x17d576?.[_0x2c2ec0(0xd4)]||null,'publicKey':_0x17cfbb,'secretKey':_0x56befa,'status':_0x2c2ec0(0xaf)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x17ba5f['id'],'fullName':_0x17ba5f[_0x2c2ec0(0xcb)],'username':_0x17ba5f[_0x2c2ec0(0xba)],'telegramId':_0x17ba5f[_0x2c2ec0(0xc0)],'merchantUrl':_0x17ba5f[_0x2c2ec0(0xc7)],'gateways':_0x17ba5f[_0x2c2ec0(0xb5)]?JSON[_0x2c2ec0(0xc1)](_0x17ba5f[_0x2c2ec0(0xb5)]):null,'gatewaySettings':_0x17ba5f[_0x2c2ec0(0xa6)]?JSON['parse'](_0x17ba5f[_0x2c2ec0(0xa6)]):null,'publicKey':_0x17ba5f[_0x2c2ec0(0xa7)],'wallets':{'usdtPolygonWallet':_0x17ba5f[_0x2c2ec0(0xd8)],'usdtTrcWallet':_0x17ba5f[_0x2c2ec0(0xd2)],'usdtErcWallet':_0x17ba5f[_0x2c2ec0(0xd1)],'usdcPolygonWallet':_0x17ba5f[_0x2c2ec0(0xd4)]},'status':_0x17ba5f[_0x2c2ec0(0xa8)],'createdAt':_0x17ba5f[_0x2c2ec0(0xbf)]};}async[a55_0x3ace30(0xa9)](){const _0x393c68=a55_0x3ace30,_0x34f142=await database_1[_0x393c68(0xda)]['shop'][_0x393c68(0xc8)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':'desc'}});return _0x34f142[_0x393c68(0xbd)](_0x1493c6=>({'id':_0x1493c6['id'],'fullName':_0x1493c6[_0x393c68(0xcb)],'username':_0x1493c6[_0x393c68(0xba)],'telegramId':_0x1493c6[_0x393c68(0xc0)],'merchantUrl':_0x1493c6[_0x393c68(0xc7)],'gateways':_0x1493c6[_0x393c68(0xb5)]?JSON[_0x393c68(0xc1)](_0x1493c6[_0x393c68(0xb5)]):null,'gatewaySettings':_0x1493c6[_0x393c68(0xa6)]?JSON['parse'](_0x1493c6[_0x393c68(0xa6)]):null,'publicKey':_0x1493c6['publicKey'],'wallets':{'usdtPolygonWallet':_0x1493c6[_0x393c68(0xd8)],'usdtTrcWallet':_0x1493c6[_0x393c68(0xd2)],'usdtErcWallet':_0x1493c6[_0x393c68(0xd1)],'usdcPolygonWallet':_0x1493c6[_0x393c68(0xd4)]},'status':_0x1493c6[_0x393c68(0xa8)],'createdAt':_0x1493c6[_0x393c68(0xbf)]}));}async['getUserById'](_0x509c8a){const _0x410860=a55_0x3ace30,_0x5a007b=await database_1['default'][_0x410860(0xa3)]['findUnique']({'where':{'id':_0x509c8a},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x5a007b)return null;return{'id':_0x5a007b['id'],'fullName':_0x5a007b[_0x410860(0xcb)],'username':_0x5a007b[_0x410860(0xba)],'telegramId':_0x5a007b[_0x410860(0xc0)],'merchantUrl':_0x5a007b[_0x410860(0xc7)],'gateways':_0x5a007b['paymentGateways']?JSON['parse'](_0x5a007b[_0x410860(0xb5)]):null,'gatewaySettings':_0x5a007b[_0x410860(0xa6)]?JSON[_0x410860(0xc1)](_0x5a007b[_0x410860(0xa6)]):null,'publicKey':_0x5a007b[_0x410860(0xa7)],'wallets':{'usdtPolygonWallet':_0x5a007b['usdtPolygonWallet'],'usdtTrcWallet':_0x5a007b['usdtTrcWallet'],'usdtErcWallet':_0x5a007b[_0x410860(0xd1)],'usdcPolygonWallet':_0x5a007b[_0x410860(0xd4)]},'status':_0x5a007b[_0x410860(0xa8)],'createdAt':_0x5a007b[_0x410860(0xbf)]};}async['updateUser'](_0x3c0bf4,_0x4b2487){const _0x4f3f81=a55_0x3ace30,_0xfa18ed={..._0x4b2487};_0x4b2487[_0x4f3f81(0xcc)]&&(_0xfa18ed[_0x4f3f81(0xcc)]=await bcryptjs_1[_0x4f3f81(0xda)][_0x4f3f81(0xc2)](_0x4b2487['password'],0xc));_0x4b2487['fullName']&&(_0xfa18ed[_0x4f3f81(0xcb)]=_0x4b2487[_0x4f3f81(0xd5)],delete _0xfa18ed['fullName']);_0x4b2487['telegramId']&&(_0xfa18ed[_0x4f3f81(0xc0)]=_0x4b2487[_0x4f3f81(0xbc)],delete _0xfa18ed['telegramId']);_0x4b2487[_0x4f3f81(0xce)]&&(_0xfa18ed[_0x4f3f81(0xc7)]=_0x4b2487['merchantUrl'],delete _0xfa18ed[_0x4f3f81(0xce)]);_0x4b2487['gateways']&&(_0xfa18ed[_0x4f3f81(0xb5)]=JSON[_0x4f3f81(0xad)](_0x4b2487[_0x4f3f81(0xac)]),delete _0xfa18ed['gateways']);_0x4b2487[_0x4f3f81(0xa6)]&&(_0xfa18ed['gatewaySettings']=JSON[_0x4f3f81(0xad)](_0x4b2487[_0x4f3f81(0xa6)]),delete _0xfa18ed[_0x4f3f81(0xa6)]);_0x4b2487[_0x4f3f81(0xc6)]&&(_0x4b2487['wallets'][_0x4f3f81(0xd8)]!==undefined&&(_0xfa18ed[_0x4f3f81(0xd8)]=_0x4b2487[_0x4f3f81(0xc6)][_0x4f3f81(0xd8)]||null),_0x4b2487[_0x4f3f81(0xc6)]['usdtTrcWallet']!==undefined&&(_0xfa18ed[_0x4f3f81(0xd2)]=_0x4b2487[_0x4f3f81(0xc6)][_0x4f3f81(0xd2)]||null),_0x4b2487[_0x4f3f81(0xc6)]['usdtErcWallet']!==undefined&&(_0xfa18ed[_0x4f3f81(0xd1)]=_0x4b2487[_0x4f3f81(0xc6)]['usdtErcWallet']||null),_0x4b2487[_0x4f3f81(0xc6)][_0x4f3f81(0xd4)]!==undefined&&(_0xfa18ed[_0x4f3f81(0xd4)]=_0x4b2487['wallets'][_0x4f3f81(0xd4)]||null),delete _0xfa18ed[_0x4f3f81(0xc6)]);const _0x2e3245=await database_1['default']['shop'][_0x4f3f81(0xcd)]({'where':{'id':_0x3c0bf4},'data':_0xfa18ed,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x2e3245['id'],'fullName':_0x2e3245[_0x4f3f81(0xcb)],'username':_0x2e3245[_0x4f3f81(0xba)],'telegramId':_0x2e3245[_0x4f3f81(0xc0)],'merchantUrl':_0x2e3245[_0x4f3f81(0xc7)],'gateways':_0x2e3245['paymentGateways']?JSON[_0x4f3f81(0xc1)](_0x2e3245[_0x4f3f81(0xb5)]):null,'gatewaySettings':_0x2e3245[_0x4f3f81(0xa6)]?JSON[_0x4f3f81(0xc1)](_0x2e3245[_0x4f3f81(0xa6)]):null,'publicKey':_0x2e3245[_0x4f3f81(0xa7)],'wallets':{'usdtPolygonWallet':_0x2e3245[_0x4f3f81(0xd8)],'usdtTrcWallet':_0x2e3245['usdtTrcWallet'],'usdtErcWallet':_0x2e3245[_0x4f3f81(0xd1)],'usdcPolygonWallet':_0x2e3245[_0x4f3f81(0xd4)]},'status':_0x2e3245[_0x4f3f81(0xa8)],'createdAt':_0x2e3245[_0x4f3f81(0xbf)]};}async[a55_0x3ace30(0xc5)](_0x4b0419){const _0x5f3ce=a55_0x3ace30;await database_1[_0x5f3ce(0xda)][_0x5f3ce(0xa3)][_0x5f3ce(0xcf)]({'where':{'id':_0x4b0419}});}}exports[a55_0x3ace30(0xc4)]=UserService;