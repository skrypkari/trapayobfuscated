'use strict';const a68_0x738319=a68_0xb638;function a68_0x146d(){const _0x18e702=['parse','__esModule','publicKey','fullName','59542kDwVnL','telegramId','createdAt','Username\x20already\x20exists','paymentGateways','usdcPolygonWallet','160002UgtCKC','ACTIVE','pk_','hex','hash','756282msAbAR','25vdCmOa','merchantUrl','delete','toString','Telegram\x20username\x20already\x20exists','1364817CUZaYz','getAllUsers','usdtErcWallet','wallets','gateways','randomBytes','password','2341647dVQdrH','generateApiKeys','status','findMany','usdtTrcWallet','defineProperty','stringify','1AkNMSO','__importDefault','createUser','shop','gatewaySettings','UserService','crypto','default','telegram','usdtPolygonWallet','64nslYRL','name','50ajnINQ','shopUrl','username','findUnique','2375549DaiUCB','1865880EuUhQL','create','sk_'];a68_0x146d=function(){return _0x18e702;};return a68_0x146d();}(function(_0x465a50,_0x5073d4){const _0x29ac8e=a68_0xb638,_0x2f906c=_0x465a50();while(!![]){try{const _0x217b28=parseInt(_0x29ac8e(0x128))/0x1*(-parseInt(_0x29ac8e(0x114))/0x2)+-parseInt(_0x29ac8e(0x11a))/0x3+-parseInt(_0x29ac8e(0x139))/0x4+parseInt(_0x29ac8e(0x115))/0x5*(parseInt(_0x29ac8e(0x10f))/0x6)+parseInt(_0x29ac8e(0x140))/0x7*(parseInt(_0x29ac8e(0x132))/0x8)+parseInt(_0x29ac8e(0x121))/0x9+parseInt(_0x29ac8e(0x134))/0xa*(parseInt(_0x29ac8e(0x138))/0xb);if(_0x217b28===_0x5073d4)break;else _0x2f906c['push'](_0x2f906c['shift']());}catch(_0x37cf5e){_0x2f906c['push'](_0x2f906c['shift']());}}}(a68_0x146d,0x3b093));var __importDefault=this&&this[a68_0x738319(0x129)]||function(_0x30c28c){const _0x302aa8=a68_0x738319;return _0x30c28c&&_0x30c28c[_0x302aa8(0x13d)]?_0x30c28c:{'default':_0x30c28c};};Object[a68_0x738319(0x126)](exports,a68_0x738319(0x13d),{'value':!![]}),exports['UserService']=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),crypto_1=__importDefault(require(a68_0x738319(0x12e))),database_1=__importDefault(require('../config/database'));class UserService{[a68_0x738319(0x122)](){const _0x54fc9c=a68_0x738319,_0x213870=_0x54fc9c(0x111)+crypto_1[_0x54fc9c(0x12f)]['randomBytes'](0x20)[_0x54fc9c(0x118)](_0x54fc9c(0x112)),_0x21b8bb=_0x54fc9c(0x13b)+crypto_1[_0x54fc9c(0x12f)][_0x54fc9c(0x11f)](0x20)[_0x54fc9c(0x118)](_0x54fc9c(0x112));return{'publicKey':_0x213870,'secretKey':_0x21b8bb};}async[a68_0x738319(0x12a)](_0x3efb1c){const _0x404834=a68_0x738319,{fullName:_0xc9224b,username:_0x99a6e6,password:_0x3c088e,telegramId:_0x5f484d,merchantUrl:_0x59c4a6,gateways:_0x53ce5b,gatewaySettings:_0x1ab97c,wallets:_0x236633}=_0x3efb1c,_0x5ad963=await database_1[_0x404834(0x12f)][_0x404834(0x12b)]['findUnique']({'where':{'username':_0x99a6e6}});if(_0x5ad963)throw new Error(_0x404834(0x10c));if(_0x5f484d){const _0x58aa35=await database_1[_0x404834(0x12f)][_0x404834(0x12b)][_0x404834(0x137)]({'where':{'telegram':_0x5f484d}});if(_0x58aa35)throw new Error(_0x404834(0x119));}const _0x31ee29=await bcryptjs_1['default']['hash'](_0x3c088e,0xc),{publicKey:_0x13e7dd,secretKey:_0x5edebb}=this[_0x404834(0x122)](),_0x137d8f=await database_1[_0x404834(0x12f)][_0x404834(0x12b)][_0x404834(0x13a)]({'data':{'name':_0xc9224b,'username':_0x99a6e6,'password':_0x31ee29,'telegram':_0x5f484d,'shopUrl':_0x59c4a6,'paymentGateways':_0x53ce5b?JSON['stringify'](_0x53ce5b):null,'gatewaySettings':_0x1ab97c?JSON['stringify'](_0x1ab97c):null,'usdtPolygonWallet':_0x236633?.[_0x404834(0x131)]||null,'usdtTrcWallet':_0x236633?.[_0x404834(0x125)]||null,'usdtErcWallet':_0x236633?.[_0x404834(0x11c)]||null,'usdcPolygonWallet':_0x236633?.['usdcPolygonWallet']||null,'publicKey':_0x13e7dd,'secretKey':_0x5edebb,'status':_0x404834(0x110)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x137d8f['id'],'fullName':_0x137d8f[_0x404834(0x133)],'username':_0x137d8f[_0x404834(0x136)],'telegramId':_0x137d8f['telegram'],'merchantUrl':_0x137d8f['shopUrl'],'gateways':_0x137d8f[_0x404834(0x10d)]?JSON['parse'](_0x137d8f[_0x404834(0x10d)]):null,'gatewaySettings':_0x137d8f[_0x404834(0x12c)]?JSON['parse'](_0x137d8f[_0x404834(0x12c)]):null,'publicKey':_0x137d8f[_0x404834(0x13e)],'wallets':{'usdtPolygonWallet':_0x137d8f[_0x404834(0x131)],'usdtTrcWallet':_0x137d8f[_0x404834(0x125)],'usdtErcWallet':_0x137d8f[_0x404834(0x11c)],'usdcPolygonWallet':_0x137d8f[_0x404834(0x10e)]},'status':_0x137d8f[_0x404834(0x123)],'createdAt':_0x137d8f[_0x404834(0x142)]};}async[a68_0x738319(0x11b)](){const _0x4be15d=a68_0x738319,_0x43e67b=await database_1['default']['shop'][_0x4be15d(0x124)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':'desc'}});return _0x43e67b['map'](_0xe75dbc=>({'id':_0xe75dbc['id'],'fullName':_0xe75dbc[_0x4be15d(0x133)],'username':_0xe75dbc['username'],'telegramId':_0xe75dbc[_0x4be15d(0x130)],'merchantUrl':_0xe75dbc[_0x4be15d(0x135)],'gateways':_0xe75dbc[_0x4be15d(0x10d)]?JSON[_0x4be15d(0x13c)](_0xe75dbc[_0x4be15d(0x10d)]):null,'gatewaySettings':_0xe75dbc[_0x4be15d(0x12c)]?JSON[_0x4be15d(0x13c)](_0xe75dbc[_0x4be15d(0x12c)]):null,'publicKey':_0xe75dbc[_0x4be15d(0x13e)],'wallets':{'usdtPolygonWallet':_0xe75dbc[_0x4be15d(0x131)],'usdtTrcWallet':_0xe75dbc['usdtTrcWallet'],'usdtErcWallet':_0xe75dbc[_0x4be15d(0x11c)],'usdcPolygonWallet':_0xe75dbc[_0x4be15d(0x10e)]},'status':_0xe75dbc[_0x4be15d(0x123)],'createdAt':_0xe75dbc['createdAt']}));}async['getUserById'](_0x5b4cb9){const _0x3d0275=a68_0x738319,_0xcafb7e=await database_1[_0x3d0275(0x12f)]['shop'][_0x3d0275(0x137)]({'where':{'id':_0x5b4cb9},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0xcafb7e)return null;return{'id':_0xcafb7e['id'],'fullName':_0xcafb7e[_0x3d0275(0x133)],'username':_0xcafb7e[_0x3d0275(0x136)],'telegramId':_0xcafb7e['telegram'],'merchantUrl':_0xcafb7e[_0x3d0275(0x135)],'gateways':_0xcafb7e[_0x3d0275(0x10d)]?JSON[_0x3d0275(0x13c)](_0xcafb7e['paymentGateways']):null,'gatewaySettings':_0xcafb7e[_0x3d0275(0x12c)]?JSON[_0x3d0275(0x13c)](_0xcafb7e[_0x3d0275(0x12c)]):null,'publicKey':_0xcafb7e[_0x3d0275(0x13e)],'wallets':{'usdtPolygonWallet':_0xcafb7e[_0x3d0275(0x131)],'usdtTrcWallet':_0xcafb7e['usdtTrcWallet'],'usdtErcWallet':_0xcafb7e['usdtErcWallet'],'usdcPolygonWallet':_0xcafb7e[_0x3d0275(0x10e)]},'status':_0xcafb7e[_0x3d0275(0x123)],'createdAt':_0xcafb7e[_0x3d0275(0x142)]};}async['updateUser'](_0x4ecd35,_0xba945e){const _0x41325a=a68_0x738319,_0x49f4dc={..._0xba945e};_0xba945e[_0x41325a(0x120)]&&(_0x49f4dc[_0x41325a(0x120)]=await bcryptjs_1['default'][_0x41325a(0x113)](_0xba945e[_0x41325a(0x120)],0xc));_0xba945e[_0x41325a(0x13f)]&&(_0x49f4dc[_0x41325a(0x133)]=_0xba945e[_0x41325a(0x13f)],delete _0x49f4dc['fullName']);_0xba945e[_0x41325a(0x141)]&&(_0x49f4dc[_0x41325a(0x130)]=_0xba945e[_0x41325a(0x141)],delete _0x49f4dc['telegramId']);_0xba945e[_0x41325a(0x116)]&&(_0x49f4dc['shopUrl']=_0xba945e[_0x41325a(0x116)],delete _0x49f4dc['merchantUrl']);_0xba945e[_0x41325a(0x11e)]&&(_0x49f4dc[_0x41325a(0x10d)]=JSON[_0x41325a(0x127)](_0xba945e['gateways']),delete _0x49f4dc[_0x41325a(0x11e)]);_0xba945e[_0x41325a(0x12c)]&&(_0x49f4dc[_0x41325a(0x12c)]=JSON[_0x41325a(0x127)](_0xba945e[_0x41325a(0x12c)]),delete _0x49f4dc[_0x41325a(0x12c)]);_0xba945e['wallets']&&(_0xba945e['wallets'][_0x41325a(0x131)]!==undefined&&(_0x49f4dc['usdtPolygonWallet']=_0xba945e[_0x41325a(0x11d)][_0x41325a(0x131)]||null),_0xba945e[_0x41325a(0x11d)]['usdtTrcWallet']!==undefined&&(_0x49f4dc[_0x41325a(0x125)]=_0xba945e[_0x41325a(0x11d)][_0x41325a(0x125)]||null),_0xba945e[_0x41325a(0x11d)]['usdtErcWallet']!==undefined&&(_0x49f4dc[_0x41325a(0x11c)]=_0xba945e[_0x41325a(0x11d)][_0x41325a(0x11c)]||null),_0xba945e[_0x41325a(0x11d)][_0x41325a(0x10e)]!==undefined&&(_0x49f4dc[_0x41325a(0x10e)]=_0xba945e[_0x41325a(0x11d)][_0x41325a(0x10e)]||null),delete _0x49f4dc[_0x41325a(0x11d)]);const _0x2da006=await database_1['default'][_0x41325a(0x12b)]['update']({'where':{'id':_0x4ecd35},'data':_0x49f4dc,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x2da006['id'],'fullName':_0x2da006[_0x41325a(0x133)],'username':_0x2da006[_0x41325a(0x136)],'telegramId':_0x2da006[_0x41325a(0x130)],'merchantUrl':_0x2da006[_0x41325a(0x135)],'gateways':_0x2da006[_0x41325a(0x10d)]?JSON[_0x41325a(0x13c)](_0x2da006[_0x41325a(0x10d)]):null,'gatewaySettings':_0x2da006[_0x41325a(0x12c)]?JSON[_0x41325a(0x13c)](_0x2da006[_0x41325a(0x12c)]):null,'publicKey':_0x2da006[_0x41325a(0x13e)],'wallets':{'usdtPolygonWallet':_0x2da006[_0x41325a(0x131)],'usdtTrcWallet':_0x2da006['usdtTrcWallet'],'usdtErcWallet':_0x2da006[_0x41325a(0x11c)],'usdcPolygonWallet':_0x2da006[_0x41325a(0x10e)]},'status':_0x2da006[_0x41325a(0x123)],'createdAt':_0x2da006[_0x41325a(0x142)]};}async['deleteUser'](_0x41f549){const _0x290f5e=a68_0x738319;await database_1[_0x290f5e(0x12f)][_0x290f5e(0x12b)][_0x290f5e(0x117)]({'where':{'id':_0x41f549}});}}function a68_0xb638(_0x34167a,_0x92173e){const _0x146d05=a68_0x146d();return a68_0xb638=function(_0xb63896,_0x5f1b66){_0xb63896=_0xb63896-0x10c;let _0x1e7cd5=_0x146d05[_0xb63896];return _0x1e7cd5;},a68_0xb638(_0x34167a,_0x92173e);}exports[a68_0x738319(0x12d)]=UserService;