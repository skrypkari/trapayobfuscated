'use strict';const a57_0x4a90a6=a57_0x2789;(function(_0x555123,_0x1d3201){const _0x266d32=a57_0x2789,_0x5cdf17=_0x555123();while(!![]){try{const _0x580ab6=-parseInt(_0x266d32(0xf5))/0x1*(-parseInt(_0x266d32(0xf6))/0x2)+parseInt(_0x266d32(0xfe))/0x3+parseInt(_0x266d32(0xf3))/0x4*(-parseInt(_0x266d32(0xef))/0x5)+parseInt(_0x266d32(0xed))/0x6*(-parseInt(_0x266d32(0x116))/0x7)+parseInt(_0x266d32(0x120))/0x8*(-parseInt(_0x266d32(0xf9))/0x9)+-parseInt(_0x266d32(0x112))/0xa+-parseInt(_0x266d32(0x11a))/0xb*(-parseInt(_0x266d32(0xfc))/0xc);if(_0x580ab6===_0x1d3201)break;else _0x5cdf17['push'](_0x5cdf17['shift']());}catch(_0x4db64c){_0x5cdf17['push'](_0x5cdf17['shift']());}}}(a57_0x407b,0xcc9af));var __importDefault=this&&this[a57_0x4a90a6(0xec)]||function(_0x49f48e){const _0xae7cda=a57_0x4a90a6;return _0x49f48e&&_0x49f48e[_0xae7cda(0x113)]?_0x49f48e:{'default':_0x49f48e};};function a57_0x407b(){const _0x3d2307=['createdAt','findUnique','password','16611950naBRxk','__esModule','getUserById','create','44527tfitQe','shopUrl','ACTIVE','createUser','7568arcgSs','deleteUser','hex','stringify','hash','status','1752EYlRyJ','paymentGateways','usdtPolygonWallet','usdtErcWallet','getAllUsers','__importDefault','1434OCTKrc','generateApiKeys','10nltaQY','../config/database','pk_','usdcPolygonWallet','1513348uHbUrK','telegramId','2IOfCHz','754840DqOZJn','usdtTrcWallet','wallets','66573RGDdDf','default','parse','88356WqFVER','bcryptjs','1726710sjiWtA','gatewaySettings','name','publicKey','shop','gateways','defineProperty','delete','toString','randomBytes','telegram','UserService','crypto','username','merchantUrl','Username\x20already\x20exists','fullName'];a57_0x407b=function(){return _0x3d2307;};return a57_0x407b();}Object[a57_0x4a90a6(0x104)](exports,a57_0x4a90a6(0x113),{'value':!![]}),exports[a57_0x4a90a6(0x109)]=void 0x0;const bcryptjs_1=__importDefault(require(a57_0x4a90a6(0xfd))),crypto_1=__importDefault(require(a57_0x4a90a6(0x10a))),database_1=__importDefault(require(a57_0x4a90a6(0xf0)));class UserService{['generateApiKeys'](){const _0x192230=a57_0x4a90a6,_0x1e5367=_0x192230(0xf1)+crypto_1[_0x192230(0xfa)][_0x192230(0x107)](0x20)[_0x192230(0x106)](_0x192230(0x11c)),_0xa424fd='sk_'+crypto_1['default'][_0x192230(0x107)](0x20)[_0x192230(0x106)](_0x192230(0x11c));return{'publicKey':_0x1e5367,'secretKey':_0xa424fd};}async[a57_0x4a90a6(0x119)](_0xa0ad12){const _0x76b624=a57_0x4a90a6,{fullName:_0x2620cd,username:_0x2ee698,password:_0x54ef42,telegramId:_0x4b1cde,merchantUrl:_0x15715e,gateways:_0x2035b0,gatewaySettings:_0x5d9e91,wallets:_0x5f0f3a}=_0xa0ad12,_0x40dae6=await database_1[_0x76b624(0xfa)][_0x76b624(0x102)][_0x76b624(0x110)]({'where':{'username':_0x2ee698}});if(_0x40dae6)throw new Error(_0x76b624(0x10d));if(_0x4b1cde){const _0x4695ae=await database_1['default'][_0x76b624(0x102)]['findUnique']({'where':{'telegram':_0x4b1cde}});if(_0x4695ae)throw new Error('Telegram\x20username\x20already\x20exists');}const _0x382afd=await bcryptjs_1['default'][_0x76b624(0x11e)](_0x54ef42,0xc),{publicKey:_0x33945a,secretKey:_0x1da74b}=this[_0x76b624(0xee)](),_0x51d866=await database_1['default'][_0x76b624(0x102)][_0x76b624(0x115)]({'data':{'name':_0x2620cd,'username':_0x2ee698,'password':_0x382afd,'telegram':_0x4b1cde,'shopUrl':_0x15715e,'paymentGateways':_0x2035b0?JSON[_0x76b624(0x11d)](_0x2035b0):null,'gatewaySettings':_0x5d9e91?JSON['stringify'](_0x5d9e91):null,'usdtPolygonWallet':_0x5f0f3a?.[_0x76b624(0x122)]||null,'usdtTrcWallet':_0x5f0f3a?.[_0x76b624(0xf7)]||null,'usdtErcWallet':_0x5f0f3a?.[_0x76b624(0xea)]||null,'usdcPolygonWallet':_0x5f0f3a?.[_0x76b624(0xf2)]||null,'publicKey':_0x33945a,'secretKey':_0x1da74b,'status':_0x76b624(0x118)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x51d866['id'],'fullName':_0x51d866[_0x76b624(0x100)],'username':_0x51d866['username'],'telegramId':_0x51d866[_0x76b624(0x108)],'merchantUrl':_0x51d866[_0x76b624(0x117)],'gateways':_0x51d866['paymentGateways']?JSON[_0x76b624(0xfb)](_0x51d866['paymentGateways']):null,'gatewaySettings':_0x51d866[_0x76b624(0xff)]?JSON[_0x76b624(0xfb)](_0x51d866[_0x76b624(0xff)]):null,'publicKey':_0x51d866[_0x76b624(0x101)],'wallets':{'usdtPolygonWallet':_0x51d866['usdtPolygonWallet'],'usdtTrcWallet':_0x51d866['usdtTrcWallet'],'usdtErcWallet':_0x51d866[_0x76b624(0xea)],'usdcPolygonWallet':_0x51d866[_0x76b624(0xf2)]},'status':_0x51d866[_0x76b624(0x11f)],'createdAt':_0x51d866[_0x76b624(0x10f)]};}async[a57_0x4a90a6(0xeb)](){const _0xa8785d=a57_0x4a90a6,_0x568930=await database_1[_0xa8785d(0xfa)][_0xa8785d(0x102)]['findMany']({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':'desc'}});return _0x568930['map'](_0x425538=>({'id':_0x425538['id'],'fullName':_0x425538['name'],'username':_0x425538[_0xa8785d(0x10b)],'telegramId':_0x425538[_0xa8785d(0x108)],'merchantUrl':_0x425538['shopUrl'],'gateways':_0x425538[_0xa8785d(0x121)]?JSON['parse'](_0x425538[_0xa8785d(0x121)]):null,'gatewaySettings':_0x425538[_0xa8785d(0xff)]?JSON[_0xa8785d(0xfb)](_0x425538[_0xa8785d(0xff)]):null,'publicKey':_0x425538['publicKey'],'wallets':{'usdtPolygonWallet':_0x425538[_0xa8785d(0x122)],'usdtTrcWallet':_0x425538[_0xa8785d(0xf7)],'usdtErcWallet':_0x425538['usdtErcWallet'],'usdcPolygonWallet':_0x425538[_0xa8785d(0xf2)]},'status':_0x425538[_0xa8785d(0x11f)],'createdAt':_0x425538[_0xa8785d(0x10f)]}));}async[a57_0x4a90a6(0x114)](_0x14810a){const _0x55bbfe=a57_0x4a90a6,_0x275031=await database_1['default'][_0x55bbfe(0x102)]['findUnique']({'where':{'id':_0x14810a},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x275031)return null;return{'id':_0x275031['id'],'fullName':_0x275031[_0x55bbfe(0x100)],'username':_0x275031[_0x55bbfe(0x10b)],'telegramId':_0x275031[_0x55bbfe(0x108)],'merchantUrl':_0x275031[_0x55bbfe(0x117)],'gateways':_0x275031[_0x55bbfe(0x121)]?JSON['parse'](_0x275031['paymentGateways']):null,'gatewaySettings':_0x275031[_0x55bbfe(0xff)]?JSON[_0x55bbfe(0xfb)](_0x275031[_0x55bbfe(0xff)]):null,'publicKey':_0x275031[_0x55bbfe(0x101)],'wallets':{'usdtPolygonWallet':_0x275031[_0x55bbfe(0x122)],'usdtTrcWallet':_0x275031[_0x55bbfe(0xf7)],'usdtErcWallet':_0x275031[_0x55bbfe(0xea)],'usdcPolygonWallet':_0x275031['usdcPolygonWallet']},'status':_0x275031['status'],'createdAt':_0x275031[_0x55bbfe(0x10f)]};}async['updateUser'](_0x2f4c27,_0x4de5be){const _0x5c4652=a57_0x4a90a6,_0x148d4a={..._0x4de5be};_0x4de5be[_0x5c4652(0x111)]&&(_0x148d4a['password']=await bcryptjs_1[_0x5c4652(0xfa)][_0x5c4652(0x11e)](_0x4de5be[_0x5c4652(0x111)],0xc));_0x4de5be[_0x5c4652(0x10e)]&&(_0x148d4a[_0x5c4652(0x100)]=_0x4de5be[_0x5c4652(0x10e)],delete _0x148d4a[_0x5c4652(0x10e)]);_0x4de5be['telegramId']&&(_0x148d4a[_0x5c4652(0x108)]=_0x4de5be[_0x5c4652(0xf4)],delete _0x148d4a['telegramId']);_0x4de5be[_0x5c4652(0x10c)]&&(_0x148d4a[_0x5c4652(0x117)]=_0x4de5be['merchantUrl'],delete _0x148d4a[_0x5c4652(0x10c)]);_0x4de5be[_0x5c4652(0x103)]&&(_0x148d4a[_0x5c4652(0x121)]=JSON['stringify'](_0x4de5be['gateways']),delete _0x148d4a[_0x5c4652(0x103)]);_0x4de5be[_0x5c4652(0xff)]&&(_0x148d4a[_0x5c4652(0xff)]=JSON[_0x5c4652(0x11d)](_0x4de5be['gatewaySettings']),delete _0x148d4a[_0x5c4652(0xff)]);_0x4de5be['wallets']&&(_0x4de5be[_0x5c4652(0xf8)][_0x5c4652(0x122)]!==undefined&&(_0x148d4a[_0x5c4652(0x122)]=_0x4de5be[_0x5c4652(0xf8)][_0x5c4652(0x122)]||null),_0x4de5be[_0x5c4652(0xf8)][_0x5c4652(0xf7)]!==undefined&&(_0x148d4a['usdtTrcWallet']=_0x4de5be[_0x5c4652(0xf8)]['usdtTrcWallet']||null),_0x4de5be[_0x5c4652(0xf8)][_0x5c4652(0xea)]!==undefined&&(_0x148d4a[_0x5c4652(0xea)]=_0x4de5be[_0x5c4652(0xf8)][_0x5c4652(0xea)]||null),_0x4de5be[_0x5c4652(0xf8)]['usdcPolygonWallet']!==undefined&&(_0x148d4a[_0x5c4652(0xf2)]=_0x4de5be[_0x5c4652(0xf8)]['usdcPolygonWallet']||null),delete _0x148d4a[_0x5c4652(0xf8)]);const _0x4fdaf7=await database_1[_0x5c4652(0xfa)][_0x5c4652(0x102)]['update']({'where':{'id':_0x2f4c27},'data':_0x148d4a,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x4fdaf7['id'],'fullName':_0x4fdaf7[_0x5c4652(0x100)],'username':_0x4fdaf7[_0x5c4652(0x10b)],'telegramId':_0x4fdaf7[_0x5c4652(0x108)],'merchantUrl':_0x4fdaf7[_0x5c4652(0x117)],'gateways':_0x4fdaf7[_0x5c4652(0x121)]?JSON[_0x5c4652(0xfb)](_0x4fdaf7[_0x5c4652(0x121)]):null,'gatewaySettings':_0x4fdaf7[_0x5c4652(0xff)]?JSON[_0x5c4652(0xfb)](_0x4fdaf7[_0x5c4652(0xff)]):null,'publicKey':_0x4fdaf7['publicKey'],'wallets':{'usdtPolygonWallet':_0x4fdaf7[_0x5c4652(0x122)],'usdtTrcWallet':_0x4fdaf7[_0x5c4652(0xf7)],'usdtErcWallet':_0x4fdaf7[_0x5c4652(0xea)],'usdcPolygonWallet':_0x4fdaf7[_0x5c4652(0xf2)]},'status':_0x4fdaf7[_0x5c4652(0x11f)],'createdAt':_0x4fdaf7[_0x5c4652(0x10f)]};}async[a57_0x4a90a6(0x11b)](_0x4dfbbd){const _0x4f1e89=a57_0x4a90a6;await database_1[_0x4f1e89(0xfa)][_0x4f1e89(0x102)][_0x4f1e89(0x105)]({'where':{'id':_0x4dfbbd}});}}function a57_0x2789(_0x3c2f83,_0x491a47){const _0x407b74=a57_0x407b();return a57_0x2789=function(_0x27891f,_0x260254){_0x27891f=_0x27891f-0xea;let _0x5e6551=_0x407b74[_0x27891f];return _0x5e6551;},a57_0x2789(_0x3c2f83,_0x491a47);}exports[a57_0x4a90a6(0x109)]=UserService;