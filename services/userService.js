'use strict';const a50_0x41ac81=a50_0x4b5f;(function(_0x47035b,_0x42950b){const _0x242fff=a50_0x4b5f,_0x56c84b=_0x47035b();while(!![]){try{const _0x5a062b=parseInt(_0x242fff(0xb5))/0x1*(parseInt(_0x242fff(0xac))/0x2)+-parseInt(_0x242fff(0x88))/0x3+parseInt(_0x242fff(0x9a))/0x4*(-parseInt(_0x242fff(0x91))/0x5)+-parseInt(_0x242fff(0x92))/0x6*(-parseInt(_0x242fff(0x85))/0x7)+-parseInt(_0x242fff(0x89))/0x8+-parseInt(_0x242fff(0x9b))/0x9+parseInt(_0x242fff(0x95))/0xa*(parseInt(_0x242fff(0xa8))/0xb);if(_0x5a062b===_0x42950b)break;else _0x56c84b['push'](_0x56c84b['shift']());}catch(_0x4ecaeb){_0x56c84b['push'](_0x56c84b['shift']());}}}(a50_0x4182,0xec874));function a50_0x4b5f(_0x445ae7,_0x1effce){const _0x418254=a50_0x4182();return a50_0x4b5f=function(_0x4b5f77,_0x105061){_0x4b5f77=_0x4b5f77-0x83;let _0x1cb8da=_0x418254[_0x4b5f77];return _0x1cb8da;},a50_0x4b5f(_0x445ae7,_0x1effce);}function a50_0x4182(){const _0x33e45a=['bcryptjs','randomBytes','shopUrl','wallets','227177tMIoKP','hash','generateApiKeys','shop','317919VwpgRg','publicKey','Username\x20already\x20exists','545130TTUOqK','11256776JsZCDZ','merchantUrl','ACTIVE','usdcPolygonWallet','paymentGateways','deleteUser','getUserById','createdAt','2675315myXkXG','216MUYyLA','pk_','username','40RllRwU','parse','usdtTrcWallet','stringify','status','8heFBGf','4563612ieVKpa','usdtErcWallet','__esModule','gatewaySettings','fullName','name','usdtPolygonWallet','Telegram\x20username\x20already\x20exists','sk_','default','findMany','crypto','telegramId','6249738NONSPT','findUnique','updateUser','telegram','2zdDfuH','gateways','desc','password','hex'];a50_0x4182=function(){return _0x33e45a;};return a50_0x4182();}var __importDefault=this&&this['__importDefault']||function(_0x3941d1){const _0xe205b5=a50_0x4b5f;return _0x3941d1&&_0x3941d1[_0xe205b5(0x9d)]?_0x3941d1:{'default':_0x3941d1};};Object['defineProperty'](exports,a50_0x41ac81(0x9d),{'value':!![]}),exports['UserService']=void 0x0;const bcryptjs_1=__importDefault(require(a50_0x41ac81(0xb1))),crypto_1=__importDefault(require(a50_0x41ac81(0xa6))),database_1=__importDefault(require('../config/database'));class UserService{[a50_0x41ac81(0x83)](){const _0x2538ed=a50_0x41ac81,_0x2f47e7=_0x2538ed(0x93)+crypto_1[_0x2538ed(0xa4)]['randomBytes'](0x20)['toString'](_0x2538ed(0xb0)),_0x105872=_0x2538ed(0xa3)+crypto_1['default'][_0x2538ed(0xb2)](0x20)['toString'](_0x2538ed(0xb0));return{'publicKey':_0x2f47e7,'secretKey':_0x105872};}async['createUser'](_0x3a05a8){const _0x2ff806=a50_0x41ac81,{fullName:_0x26bb3f,username:_0x4371e2,password:_0x2c0d0e,telegramId:_0x36ce52,merchantUrl:_0xf353c2,gateways:_0x244085,gatewaySettings:_0x28a7b6,wallets:_0x1a8a97}=_0x3a05a8,_0x3aa9d4=await database_1[_0x2ff806(0xa4)][_0x2ff806(0x84)][_0x2ff806(0xa9)]({'where':{'username':_0x4371e2}});if(_0x3aa9d4)throw new Error(_0x2ff806(0x87));if(_0x36ce52){const _0x324249=await database_1[_0x2ff806(0xa4)][_0x2ff806(0x84)][_0x2ff806(0xa9)]({'where':{'telegram':_0x36ce52}});if(_0x324249)throw new Error(_0x2ff806(0xa2));}const _0x2c84fa=await bcryptjs_1['default'][_0x2ff806(0xb6)](_0x2c0d0e,0xc),{publicKey:_0x1e1d4,secretKey:_0x545d9b}=this[_0x2ff806(0x83)](),_0x464970=await database_1[_0x2ff806(0xa4)][_0x2ff806(0x84)]['create']({'data':{'name':_0x26bb3f,'username':_0x4371e2,'password':_0x2c84fa,'telegram':_0x36ce52,'shopUrl':_0xf353c2,'paymentGateways':_0x244085?JSON[_0x2ff806(0x98)](_0x244085):null,'gatewaySettings':_0x28a7b6?JSON['stringify'](_0x28a7b6):null,'usdtPolygonWallet':_0x1a8a97?.[_0x2ff806(0xa1)]||null,'usdtTrcWallet':_0x1a8a97?.[_0x2ff806(0x97)]||null,'usdtErcWallet':_0x1a8a97?.[_0x2ff806(0x9c)]||null,'usdcPolygonWallet':_0x1a8a97?.[_0x2ff806(0x8c)]||null,'publicKey':_0x1e1d4,'secretKey':_0x545d9b,'status':_0x2ff806(0x8b)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x464970['id'],'fullName':_0x464970[_0x2ff806(0xa0)],'username':_0x464970[_0x2ff806(0x94)],'telegramId':_0x464970[_0x2ff806(0xab)],'merchantUrl':_0x464970['shopUrl'],'gateways':_0x464970[_0x2ff806(0x8d)]?JSON[_0x2ff806(0x96)](_0x464970['paymentGateways']):null,'gatewaySettings':_0x464970['gatewaySettings']?JSON[_0x2ff806(0x96)](_0x464970['gatewaySettings']):null,'publicKey':_0x464970['publicKey'],'wallets':{'usdtPolygonWallet':_0x464970['usdtPolygonWallet'],'usdtTrcWallet':_0x464970[_0x2ff806(0x97)],'usdtErcWallet':_0x464970[_0x2ff806(0x9c)],'usdcPolygonWallet':_0x464970['usdcPolygonWallet']},'status':_0x464970[_0x2ff806(0x99)],'createdAt':_0x464970[_0x2ff806(0x90)]};}async['getAllUsers'](){const _0x3ed25d=a50_0x41ac81,_0x1d73ae=await database_1['default'][_0x3ed25d(0x84)][_0x3ed25d(0xa5)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':_0x3ed25d(0xae)}});return _0x1d73ae['map'](_0x4de6d2=>({'id':_0x4de6d2['id'],'fullName':_0x4de6d2[_0x3ed25d(0xa0)],'username':_0x4de6d2[_0x3ed25d(0x94)],'telegramId':_0x4de6d2[_0x3ed25d(0xab)],'merchantUrl':_0x4de6d2[_0x3ed25d(0xb3)],'gateways':_0x4de6d2[_0x3ed25d(0x8d)]?JSON['parse'](_0x4de6d2['paymentGateways']):null,'gatewaySettings':_0x4de6d2[_0x3ed25d(0x9e)]?JSON[_0x3ed25d(0x96)](_0x4de6d2['gatewaySettings']):null,'publicKey':_0x4de6d2[_0x3ed25d(0x86)],'wallets':{'usdtPolygonWallet':_0x4de6d2['usdtPolygonWallet'],'usdtTrcWallet':_0x4de6d2['usdtTrcWallet'],'usdtErcWallet':_0x4de6d2[_0x3ed25d(0x9c)],'usdcPolygonWallet':_0x4de6d2['usdcPolygonWallet']},'status':_0x4de6d2['status'],'createdAt':_0x4de6d2[_0x3ed25d(0x90)]}));}async[a50_0x41ac81(0x8f)](_0x122ac1){const _0x3c6544=a50_0x41ac81,_0x2d9a2f=await database_1['default']['shop']['findUnique']({'where':{'id':_0x122ac1},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x2d9a2f)return null;return{'id':_0x2d9a2f['id'],'fullName':_0x2d9a2f['name'],'username':_0x2d9a2f['username'],'telegramId':_0x2d9a2f['telegram'],'merchantUrl':_0x2d9a2f[_0x3c6544(0xb3)],'gateways':_0x2d9a2f['paymentGateways']?JSON[_0x3c6544(0x96)](_0x2d9a2f[_0x3c6544(0x8d)]):null,'gatewaySettings':_0x2d9a2f[_0x3c6544(0x9e)]?JSON[_0x3c6544(0x96)](_0x2d9a2f[_0x3c6544(0x9e)]):null,'publicKey':_0x2d9a2f[_0x3c6544(0x86)],'wallets':{'usdtPolygonWallet':_0x2d9a2f['usdtPolygonWallet'],'usdtTrcWallet':_0x2d9a2f[_0x3c6544(0x97)],'usdtErcWallet':_0x2d9a2f[_0x3c6544(0x9c)],'usdcPolygonWallet':_0x2d9a2f[_0x3c6544(0x8c)]},'status':_0x2d9a2f[_0x3c6544(0x99)],'createdAt':_0x2d9a2f[_0x3c6544(0x90)]};}async[a50_0x41ac81(0xaa)](_0x166b1b,_0x2d1a2){const _0x48bcd5=a50_0x41ac81,_0x435c52={..._0x2d1a2};_0x2d1a2[_0x48bcd5(0xaf)]&&(_0x435c52['password']=await bcryptjs_1[_0x48bcd5(0xa4)][_0x48bcd5(0xb6)](_0x2d1a2[_0x48bcd5(0xaf)],0xc));_0x2d1a2['fullName']&&(_0x435c52[_0x48bcd5(0xa0)]=_0x2d1a2[_0x48bcd5(0x9f)],delete _0x435c52['fullName']);_0x2d1a2[_0x48bcd5(0xa7)]&&(_0x435c52['telegram']=_0x2d1a2[_0x48bcd5(0xa7)],delete _0x435c52[_0x48bcd5(0xa7)]);_0x2d1a2[_0x48bcd5(0x8a)]&&(_0x435c52[_0x48bcd5(0xb3)]=_0x2d1a2[_0x48bcd5(0x8a)],delete _0x435c52[_0x48bcd5(0x8a)]);_0x2d1a2[_0x48bcd5(0xad)]&&(_0x435c52[_0x48bcd5(0x8d)]=JSON[_0x48bcd5(0x98)](_0x2d1a2[_0x48bcd5(0xad)]),delete _0x435c52['gateways']);_0x2d1a2[_0x48bcd5(0x9e)]&&(_0x435c52[_0x48bcd5(0x9e)]=JSON['stringify'](_0x2d1a2['gatewaySettings']),delete _0x435c52[_0x48bcd5(0x9e)]);_0x2d1a2[_0x48bcd5(0xb4)]&&(_0x2d1a2[_0x48bcd5(0xb4)][_0x48bcd5(0xa1)]!==undefined&&(_0x435c52[_0x48bcd5(0xa1)]=_0x2d1a2[_0x48bcd5(0xb4)][_0x48bcd5(0xa1)]||null),_0x2d1a2[_0x48bcd5(0xb4)]['usdtTrcWallet']!==undefined&&(_0x435c52[_0x48bcd5(0x97)]=_0x2d1a2[_0x48bcd5(0xb4)][_0x48bcd5(0x97)]||null),_0x2d1a2['wallets'][_0x48bcd5(0x9c)]!==undefined&&(_0x435c52['usdtErcWallet']=_0x2d1a2[_0x48bcd5(0xb4)][_0x48bcd5(0x9c)]||null),_0x2d1a2['wallets']['usdcPolygonWallet']!==undefined&&(_0x435c52[_0x48bcd5(0x8c)]=_0x2d1a2[_0x48bcd5(0xb4)][_0x48bcd5(0x8c)]||null),delete _0x435c52[_0x48bcd5(0xb4)]);const _0x319b2c=await database_1[_0x48bcd5(0xa4)][_0x48bcd5(0x84)]['update']({'where':{'id':_0x166b1b},'data':_0x435c52,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x319b2c['id'],'fullName':_0x319b2c[_0x48bcd5(0xa0)],'username':_0x319b2c[_0x48bcd5(0x94)],'telegramId':_0x319b2c[_0x48bcd5(0xab)],'merchantUrl':_0x319b2c[_0x48bcd5(0xb3)],'gateways':_0x319b2c[_0x48bcd5(0x8d)]?JSON[_0x48bcd5(0x96)](_0x319b2c[_0x48bcd5(0x8d)]):null,'gatewaySettings':_0x319b2c[_0x48bcd5(0x9e)]?JSON[_0x48bcd5(0x96)](_0x319b2c[_0x48bcd5(0x9e)]):null,'publicKey':_0x319b2c[_0x48bcd5(0x86)],'wallets':{'usdtPolygonWallet':_0x319b2c[_0x48bcd5(0xa1)],'usdtTrcWallet':_0x319b2c[_0x48bcd5(0x97)],'usdtErcWallet':_0x319b2c['usdtErcWallet'],'usdcPolygonWallet':_0x319b2c[_0x48bcd5(0x8c)]},'status':_0x319b2c[_0x48bcd5(0x99)],'createdAt':_0x319b2c[_0x48bcd5(0x90)]};}async[a50_0x41ac81(0x8e)](_0x3ee01e){await database_1['default']['shop']['delete']({'where':{'id':_0x3ee01e}});}}exports['UserService']=UserService;