'use strict';function a68_0x12dd(_0x201543,_0x35ae57){const _0x4d9364=a68_0x4d93();return a68_0x12dd=function(_0x12ddad,_0x747a20){_0x12ddad=_0x12ddad-0x17c;let _0x30f255=_0x4d9364[_0x12ddad];return _0x30f255;},a68_0x12dd(_0x201543,_0x35ae57);}const a68_0x321ca1=a68_0x12dd;(function(_0x29430f,_0x3fb9f0){const _0x5b5474=a68_0x12dd,_0x2f9967=_0x29430f();while(!![]){try{const _0xc139dc=-parseInt(_0x5b5474(0x1a6))/0x1+parseInt(_0x5b5474(0x196))/0x2+-parseInt(_0x5b5474(0x1a1))/0x3*(parseInt(_0x5b5474(0x1a5))/0x4)+parseInt(_0x5b5474(0x17f))/0x5+-parseInt(_0x5b5474(0x18e))/0x6+-parseInt(_0x5b5474(0x1aa))/0x7*(-parseInt(_0x5b5474(0x17e))/0x8)+parseInt(_0x5b5474(0x181))/0x9;if(_0xc139dc===_0x3fb9f0)break;else _0x2f9967['push'](_0x2f9967['shift']());}catch(_0x490f40){_0x2f9967['push'](_0x2f9967['shift']());}}}(a68_0x4d93,0xaf5d0));function a68_0x4d93(){const _0x48bcdd=['usdtTrcWallet','update','wallets','stringify','__esModule','shopUrl','3510747BoFdrR','deleteUser','ACTIVE','create','4dIagMQ','152737odhvEq','hash','getUserById','usdtPolygonWallet','55797JJuATg','createUser','createdAt','randomBytes','status','default','paymentGateways','../config/database','password','688HkiIEx','3971255TtFSnI','generateApiKeys','1923165USlQin','fullName','usdtErcWallet','crypto','shop','defineProperty','UserService','merchantUrl','hex','gatewaySettings','findMany','__importDefault','toString','3777378VZNWSB','publicKey','parse','telegram','getAllUsers','telegramId','gateways','name','1954790sqYudf','username','Telegram\x20username\x20already\x20exists','usdcPolygonWallet','findUnique'];a68_0x4d93=function(){return _0x48bcdd;};return a68_0x4d93();}var __importDefault=this&&this[a68_0x321ca1(0x18c)]||function(_0x5a045e){return _0x5a045e&&_0x5a045e['__esModule']?_0x5a045e:{'default':_0x5a045e};};Object[a68_0x321ca1(0x186)](exports,a68_0x321ca1(0x19f),{'value':!![]}),exports[a68_0x321ca1(0x187)]=void 0x0;const bcryptjs_1=__importDefault(require('bcryptjs')),crypto_1=__importDefault(require(a68_0x321ca1(0x184))),database_1=__importDefault(require(a68_0x321ca1(0x17c)));class UserService{[a68_0x321ca1(0x180)](){const _0x225d84=a68_0x321ca1,_0x54a2f7='pk_'+crypto_1[_0x225d84(0x1af)][_0x225d84(0x1ad)](0x20)[_0x225d84(0x18d)](_0x225d84(0x189)),_0x18b285='sk_'+crypto_1[_0x225d84(0x1af)][_0x225d84(0x1ad)](0x20)[_0x225d84(0x18d)](_0x225d84(0x189));return{'publicKey':_0x54a2f7,'secretKey':_0x18b285};}async[a68_0x321ca1(0x1ab)](_0x130c4f){const _0xf01a2d=a68_0x321ca1,{fullName:_0x325693,username:_0x203f10,password:_0x14ae44,telegramId:_0x1064c4,merchantUrl:_0x4987a2,gateways:_0x292c11,gatewaySettings:_0x314c54,wallets:_0x28e02f}=_0x130c4f,_0x41305d=await database_1[_0xf01a2d(0x1af)][_0xf01a2d(0x185)]['findUnique']({'where':{'username':_0x203f10}});if(_0x41305d)throw new Error('Username\x20already\x20exists');if(_0x1064c4){const _0x2d4d55=await database_1['default'][_0xf01a2d(0x185)][_0xf01a2d(0x19a)]({'where':{'telegram':_0x1064c4}});if(_0x2d4d55)throw new Error(_0xf01a2d(0x198));}const _0xc4e3c1=await bcryptjs_1[_0xf01a2d(0x1af)][_0xf01a2d(0x1a7)](_0x14ae44,0xc),{publicKey:_0x28a41a,secretKey:_0x81c5cb}=this['generateApiKeys'](),_0x40a871=await database_1[_0xf01a2d(0x1af)][_0xf01a2d(0x185)][_0xf01a2d(0x1a4)]({'data':{'name':_0x325693,'username':_0x203f10,'password':_0xc4e3c1,'telegram':_0x1064c4,'shopUrl':_0x4987a2,'paymentGateways':_0x292c11?JSON[_0xf01a2d(0x19e)](_0x292c11):null,'gatewaySettings':_0x314c54?JSON[_0xf01a2d(0x19e)](_0x314c54):null,'usdtPolygonWallet':_0x28e02f?.[_0xf01a2d(0x1a9)]||null,'usdtTrcWallet':_0x28e02f?.[_0xf01a2d(0x19b)]||null,'usdtErcWallet':_0x28e02f?.[_0xf01a2d(0x183)]||null,'usdcPolygonWallet':_0x28e02f?.[_0xf01a2d(0x199)]||null,'publicKey':_0x28a41a,'secretKey':_0x81c5cb,'status':_0xf01a2d(0x1a3)},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x40a871['id'],'fullName':_0x40a871[_0xf01a2d(0x195)],'username':_0x40a871[_0xf01a2d(0x197)],'telegramId':_0x40a871[_0xf01a2d(0x191)],'merchantUrl':_0x40a871[_0xf01a2d(0x1a0)],'gateways':_0x40a871[_0xf01a2d(0x1b0)]?JSON[_0xf01a2d(0x190)](_0x40a871[_0xf01a2d(0x1b0)]):null,'gatewaySettings':_0x40a871['gatewaySettings']?JSON[_0xf01a2d(0x190)](_0x40a871[_0xf01a2d(0x18a)]):null,'publicKey':_0x40a871[_0xf01a2d(0x18f)],'wallets':{'usdtPolygonWallet':_0x40a871[_0xf01a2d(0x1a9)],'usdtTrcWallet':_0x40a871[_0xf01a2d(0x19b)],'usdtErcWallet':_0x40a871[_0xf01a2d(0x183)],'usdcPolygonWallet':_0x40a871['usdcPolygonWallet']},'status':_0x40a871[_0xf01a2d(0x1ae)],'createdAt':_0x40a871[_0xf01a2d(0x1ac)]};}async[a68_0x321ca1(0x192)](){const _0x2fa6ae=a68_0x321ca1,_0x250ec1=await database_1['default'][_0x2fa6ae(0x185)][_0x2fa6ae(0x18b)]({'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]},'orderBy':{'createdAt':'desc'}});return _0x250ec1['map'](_0x127ffd=>({'id':_0x127ffd['id'],'fullName':_0x127ffd['name'],'username':_0x127ffd['username'],'telegramId':_0x127ffd[_0x2fa6ae(0x191)],'merchantUrl':_0x127ffd[_0x2fa6ae(0x1a0)],'gateways':_0x127ffd[_0x2fa6ae(0x1b0)]?JSON[_0x2fa6ae(0x190)](_0x127ffd[_0x2fa6ae(0x1b0)]):null,'gatewaySettings':_0x127ffd[_0x2fa6ae(0x18a)]?JSON['parse'](_0x127ffd['gatewaySettings']):null,'publicKey':_0x127ffd[_0x2fa6ae(0x18f)],'wallets':{'usdtPolygonWallet':_0x127ffd[_0x2fa6ae(0x1a9)],'usdtTrcWallet':_0x127ffd['usdtTrcWallet'],'usdtErcWallet':_0x127ffd['usdtErcWallet'],'usdcPolygonWallet':_0x127ffd[_0x2fa6ae(0x199)]},'status':_0x127ffd['status'],'createdAt':_0x127ffd[_0x2fa6ae(0x1ac)]}));}async[a68_0x321ca1(0x1a8)](_0x254792){const _0x273b86=a68_0x321ca1,_0x58b0ee=await database_1[_0x273b86(0x1af)][_0x273b86(0x185)][_0x273b86(0x19a)]({'where':{'id':_0x254792},'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});if(!_0x58b0ee)return null;return{'id':_0x58b0ee['id'],'fullName':_0x58b0ee[_0x273b86(0x195)],'username':_0x58b0ee[_0x273b86(0x197)],'telegramId':_0x58b0ee[_0x273b86(0x191)],'merchantUrl':_0x58b0ee['shopUrl'],'gateways':_0x58b0ee[_0x273b86(0x1b0)]?JSON['parse'](_0x58b0ee[_0x273b86(0x1b0)]):null,'gatewaySettings':_0x58b0ee[_0x273b86(0x18a)]?JSON[_0x273b86(0x190)](_0x58b0ee[_0x273b86(0x18a)]):null,'publicKey':_0x58b0ee[_0x273b86(0x18f)],'wallets':{'usdtPolygonWallet':_0x58b0ee[_0x273b86(0x1a9)],'usdtTrcWallet':_0x58b0ee['usdtTrcWallet'],'usdtErcWallet':_0x58b0ee['usdtErcWallet'],'usdcPolygonWallet':_0x58b0ee[_0x273b86(0x199)]},'status':_0x58b0ee[_0x273b86(0x1ae)],'createdAt':_0x58b0ee[_0x273b86(0x1ac)]};}async['updateUser'](_0x1d91c2,_0x2de3bd){const _0x4ba198=a68_0x321ca1,_0x2e231f={..._0x2de3bd};_0x2de3bd[_0x4ba198(0x17d)]&&(_0x2e231f[_0x4ba198(0x17d)]=await bcryptjs_1[_0x4ba198(0x1af)][_0x4ba198(0x1a7)](_0x2de3bd[_0x4ba198(0x17d)],0xc));_0x2de3bd[_0x4ba198(0x182)]&&(_0x2e231f[_0x4ba198(0x195)]=_0x2de3bd[_0x4ba198(0x182)],delete _0x2e231f[_0x4ba198(0x182)]);_0x2de3bd['telegramId']&&(_0x2e231f[_0x4ba198(0x191)]=_0x2de3bd[_0x4ba198(0x193)],delete _0x2e231f[_0x4ba198(0x193)]);_0x2de3bd[_0x4ba198(0x188)]&&(_0x2e231f[_0x4ba198(0x1a0)]=_0x2de3bd['merchantUrl'],delete _0x2e231f[_0x4ba198(0x188)]);_0x2de3bd[_0x4ba198(0x194)]&&(_0x2e231f['paymentGateways']=JSON[_0x4ba198(0x19e)](_0x2de3bd[_0x4ba198(0x194)]),delete _0x2e231f[_0x4ba198(0x194)]);_0x2de3bd[_0x4ba198(0x18a)]&&(_0x2e231f['gatewaySettings']=JSON[_0x4ba198(0x19e)](_0x2de3bd[_0x4ba198(0x18a)]),delete _0x2e231f[_0x4ba198(0x18a)]);_0x2de3bd[_0x4ba198(0x19d)]&&(_0x2de3bd[_0x4ba198(0x19d)][_0x4ba198(0x1a9)]!==undefined&&(_0x2e231f['usdtPolygonWallet']=_0x2de3bd[_0x4ba198(0x19d)][_0x4ba198(0x1a9)]||null),_0x2de3bd[_0x4ba198(0x19d)][_0x4ba198(0x19b)]!==undefined&&(_0x2e231f['usdtTrcWallet']=_0x2de3bd[_0x4ba198(0x19d)]['usdtTrcWallet']||null),_0x2de3bd[_0x4ba198(0x19d)][_0x4ba198(0x183)]!==undefined&&(_0x2e231f[_0x4ba198(0x183)]=_0x2de3bd[_0x4ba198(0x19d)]['usdtErcWallet']||null),_0x2de3bd[_0x4ba198(0x19d)][_0x4ba198(0x199)]!==undefined&&(_0x2e231f[_0x4ba198(0x199)]=_0x2de3bd['wallets'][_0x4ba198(0x199)]||null),delete _0x2e231f[_0x4ba198(0x19d)]);const _0x3f2dcf=await database_1['default'][_0x4ba198(0x185)][_0x4ba198(0x19c)]({'where':{'id':_0x1d91c2},'data':_0x2e231f,'select':{'id':!![],'name':!![],'username':!![],'telegram':!![],'shopUrl':!![],'paymentGateways':!![],'gatewaySettings':!![],'publicKey':!![],'usdtPolygonWallet':!![],'usdtTrcWallet':!![],'usdtErcWallet':!![],'usdcPolygonWallet':!![],'status':!![],'createdAt':!![]}});return{'id':_0x3f2dcf['id'],'fullName':_0x3f2dcf[_0x4ba198(0x195)],'username':_0x3f2dcf[_0x4ba198(0x197)],'telegramId':_0x3f2dcf[_0x4ba198(0x191)],'merchantUrl':_0x3f2dcf[_0x4ba198(0x1a0)],'gateways':_0x3f2dcf['paymentGateways']?JSON[_0x4ba198(0x190)](_0x3f2dcf[_0x4ba198(0x1b0)]):null,'gatewaySettings':_0x3f2dcf[_0x4ba198(0x18a)]?JSON['parse'](_0x3f2dcf[_0x4ba198(0x18a)]):null,'publicKey':_0x3f2dcf[_0x4ba198(0x18f)],'wallets':{'usdtPolygonWallet':_0x3f2dcf[_0x4ba198(0x1a9)],'usdtTrcWallet':_0x3f2dcf[_0x4ba198(0x19b)],'usdtErcWallet':_0x3f2dcf['usdtErcWallet'],'usdcPolygonWallet':_0x3f2dcf[_0x4ba198(0x199)]},'status':_0x3f2dcf[_0x4ba198(0x1ae)],'createdAt':_0x3f2dcf[_0x4ba198(0x1ac)]};}async[a68_0x321ca1(0x1a2)](_0x4070b7){const _0x44ac70=a68_0x321ca1;await database_1['default'][_0x44ac70(0x185)]['delete']({'where':{'id':_0x4070b7}});}}exports[a68_0x321ca1(0x187)]=UserService;